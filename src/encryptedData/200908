From java-user-return-41612-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 01 00:15:59 2009
Return-Path: <java-user-return-41612-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96431 invoked from network); 1 Aug 2009 00:15:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Aug 2009 00:15:59 -0000
Received: (qmail 75753 invoked by uid 500); 1 Aug 2009 00:15:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75656 invoked by uid 500); 1 Aug 2009 00:15:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75646 invoked by uid 99); 1 Aug 2009 00:15:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 00:15:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.132.246 as permitted sender)
Received: from [209.85.132.246] (HELO an-out-0708.google.com) (209.85.132.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 00:15:48 +0000
Received: by an-out-0708.google.com with SMTP id b2so1108049ana.5
        for <java-user@lucene.apache.org>; Fri, 31 Jul 2009 17:15:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=QhMtga8WXq9KJJUOo94xwr2Kh1BZfuvBPRbosCbe92M=;
        b=FgrUBPbL6EYxTwWjaD9T3T6ogUUp53Wb/ddCBVcxT4ed+W5hqlDNsFYRd02xE4gagL
         GiWXKSEXczysM78p2eOFVa01TIZPvGjoctDyQ39uMZQqiCX9XXy61l7q12jum6e3+vRa
         8Nu5Efel1Pb/OEK2B3RA9xJnV8Xee9g/D4ku0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=P8VdM1ov23q9gSpSSOu5xtDBUNg536XkbugFxvHSeN8swBXJdiNb0yAR61LLBVUX+7
         bet00UlTNFwGMAA2XJocs0pifF0rJPBN9uK9YHXAzynEmGVX5RzpvLxtaKB6OHykM4qi
         9KAOdW5cwr6QOeo7TdFrjZ9Qn9JvL3ejd21Pc=
MIME-Version: 1.0
Received: by 10.100.167.20 with SMTP id p20mr3102032ane.80.1249085727257; Fri, 
	31 Jul 2009 17:15:27 -0700 (PDT)
Date: Fri, 31 Jul 2009 17:15:26 -0700
Message-ID: <9cafbc680907311715i6da98d3du55d3958c69c9ffa4@mail.gmail.com>
Subject: Is it possible to retrieve Terms from a Document?
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I know you can use Field.Store.YES, but I want to inspect the terms /
tokens and their order related to the field name at search time. Is
this possible? Obviously this information is stored in the index, but
I can not find any API to access it. I'm guessing the answer might be
that Terms point to a Document and not the other way around. Is this
right?

eg.
Document doc = .... ;
Term[] terms = doc.getTerms();

Or...
String[] values = doc.getTermValues();

Thanks,
Phil

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41613-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 01 00:41:27 2009
Return-Path: <java-user-return-41613-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5595 invoked from network); 1 Aug 2009 00:27:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Aug 2009 00:27:27 -0000
Received: (qmail 83236 invoked by uid 500); 1 Aug 2009 00:27:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83149 invoked by uid 500); 1 Aug 2009 00:27:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83139 invoked by uid 99); 1 Aug 2009 00:27:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 00:27:25 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jibojohn@mac.com designates 17.148.16.87 as permitted sender)
Received: from [17.148.16.87] (HELO asmtpout012.mac.com) (17.148.16.87)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 00:27:16 +0000
MIME-version: 1.0
Content-transfer-encoding: 7BIT
Content-type: text/plain; charset=US-ASCII; format=flowed
Received: from la0101a-dhcp176.apple.com ([17.214.14.176])
 by asmtp012.mac.com (Sun Java(tm) System Messaging Server 6.3-8.01 (built Dec
 16 2008; 32bit)) with ESMTPSA id <0KNO00M6V98V9930@asmtp012.mac.com> for
 java-user@lucene.apache.org; Fri, 31 Jul 2009 17:26:56 -0700 (PDT)
Message-id: <090CF9D7-5D59-47A5-AD2A-86D4BEC6CD15@mac.com>
From: Jibo John <jibojohn@mac.com>
To: java-user@lucene.apache.org
In-reply-to: <9cafbc680907311701g7c8ff0f1n896c4bed2adda9c9@mail.gmail.com>
Subject: Re: ThreadedIndexWriter vs. IndexWriter
Date: Fri, 31 Jul 2009 17:26:55 -0700
References: <9cafbc680907301111t4768704cy9e4b3092b3d74b17@mail.gmail.com>
 <4A71E4DD.4040601@informatics.jax.org>
 <9cafbc680907301139t272d4103s6c98aff24b7e71ae@mail.gmail.com>
 <4A71E9DF.3030404@informatics.jax.org> <4A722D75.9070806@aconex.com>
 <D8AF0747-AEC3-4E5F-AB52-EF62BA460529@mac.com>
 <9ac0c6aa0907310234h798d406bg8cb23d620b022ef8@mail.gmail.com>
 <161DCF62-1E03-4F1B-A590-76ADD91D5434@mac.com>
 <9ac0c6aa0907311452q4f49f1aeua7314b6059b5973@mail.gmail.com>
 <2BC00C69-41B3-48B3-83E7-CBC6DB452CCC@mac.com>
 <9cafbc680907311701g7c8ff0f1n896c4bed2adda9c9@mail.gmail.com>
X-Mailer: Apple Mail (2.935.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Phil,

It's 5 threads for IndexWriter.

For ThreadedIndexWriter, I used:

writer.num.threads=16
writer.max.thread.queue.size=80

Thanks,
-Jibo

On Jul 31, 2009, at 5:01 PM, Phil Whelan wrote:

> Hi Jibo,
>
> Your mergeFactor is different, and the resulting numFiles (segment
> files) is different. Maybe each thread is responsible for a segment
> file. Just curious - do you have 3 threads?
>
> Phil
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41614-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 01 02:26:47 2009
Return-Path: <java-user-return-41614-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32373 invoked from network); 1 Aug 2009 02:26:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Aug 2009 02:26:47 -0000
Received: (qmail 35605 invoked by uid 500); 1 Aug 2009 02:26:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35520 invoked by uid 500); 1 Aug 2009 02:26:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35510 invoked by uid 99); 1 Aug 2009 02:26:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 02:26:48 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [61.95.162.82] (HELO kecgate06.infosys.com) (61.95.162.82)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 02:26:40 +0000
X-TM-IMSS-Message-ID:<ec8fe9d40003380c@kecgate06.infosys.com>
Received: from blrkechub04.ad.infosys.com ([10.66.236.44]) by kecgate06.infosys.com ([61.95.162.82]) with ESMTP (TREND IMSS SMTP Service 7.0) id ec8fe9d40003380c ; Sat, 1 Aug 2009 07:57:24 +0530
Received: from BLRKECMBX06.ad.infosys.com ([10.66.236.32]) by
 blrkechub04.ad.infosys.com ([10.66.236.44]) with mapi; Sat, 1 Aug 2009
 07:56:16 +0530
From: Allahbaksh Mohammedali Asadullah <Allahbaksh_Asadullah@infosys.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Sat, 1 Aug 2009 07:56:47 +0530
Subject: Tutorial on Lucene on S3
Thread-Topic: Tutorial on Lucene on S3
Thread-Index: AcoST4UARqwyLOTnRl6cYtWhsa9wzQ==
Message-ID: <68959F25CDEBCB4F917D5A253291D73E0EF914ECC8@BLRKECMBX06.ad.infosys.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_000_68959F25CDEBCB4F917D5A253291D73E0EF914ECC8BLRKECMBX06ad_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_68959F25CDEBCB4F917D5A253291D73E0EF914ECC8BLRKECMBX06ad_
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi,
Is=20there=20any=20tutorial=20on=20how=20to=20store=20Lucene=20Index=20in=
=20S3.=20How=20do=20we=20access=20the=20index=20from=20S3.=20Are=20there=
=20any=20wrapper=20=20of=20amazon=20S3.

The=20other=20question=20is=20how=20do=20I=20store=20and=20access=20exist=
ing=20lucene=20index=20on=20Google=20App=20Engine.

Thanks=20in=20advance.
Warm=20Regards,
Allahbaksh








****************=20CAUTION=20-=20Disclaimer=20*****************
This=20e-mail=20contains=20PRIVILEGED=20AND=20CONFIDENTIAL=20INFORMATION=
=20intended=20solely=20
for=20the=20use=20of=20the=20addressee(s).=20If=20you=20are=20not=20the=
=20intended=20recipient,=20please=20
notify=20the=20sender=20by=20e-mail=20and=20delete=20the=20original=20mes=
sage.=20Further,=20you=20are=20not=20
to=20copy,=20disclose,=20or=20distribute=20this=20e-mail=20or=20its=20con=
tents=20to=20any=20other=20person=20and=20
any=20such=20actions=20are=20unlawful.=20This=20e-mail=20may=20contain=20=
viruses.=20Infosys=20has=20taken=20
every=20reasonable=20precaution=20to=20minimize=20this=20risk,=20but=20is=
=20not=20liable=20for=20any=20damage=20
you=20may=20sustain=20as=20a=20result=20of=20any=20virus=20in=20this=20e-=
mail.=20You=20should=20carry=20out=20your=20
own=20virus=20checks=20before=20opening=20the=20e-mail=20or=20attachment.=
=20Infosys=20reserves=20the=20
right=20to=20monitor=20and=20review=20the=20content=20of=20all=20messages=
=20sent=20to=20or=20from=20this=20e-mail=20
address.=20Messages=20sent=20to=20or=20from=20this=20e-mail=20address=20m=
ay=20be=20stored=20on=20the=20
Infosys=20e-mail=20system.
***INFOSYS********=20End=20of=20Disclaimer=20********INFOSYS***

--_000_68959F25CDEBCB4F917D5A253291D73E0EF914ECC8BLRKECMBX06ad_--

From java-user-return-41615-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 01 02:31:24 2009
Return-Path: <java-user-return-41615-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34377 invoked from network); 1 Aug 2009 02:31:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Aug 2009 02:31:24 -0000
Received: (qmail 38647 invoked by uid 500); 1 Aug 2009 02:31:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38571 invoked by uid 500); 1 Aug 2009 02:31:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38561 invoked by uid 99); 1 Aug 2009 02:31:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 02:31:25 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a12.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 02:31:14 +0000
Received: from [10.0.0.176] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a12.g.dreamhost.com (Postfix) with ESMTP id 714DC7FB2
	for <java-user@lucene.apache.org>; Fri, 31 Jul 2009 19:30:52 -0700 (PDT)
Message-Id: <8255AA7B-E0DF-45E7-83B1-A167B02FB2E2@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <9cafbc680907311715i6da98d3du55d3958c69c9ffa4@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v935.3)
Subject: Re: Is it possible to retrieve Terms from a Document?
Date: Fri, 31 Jul 2009 22:30:50 -0400
References: <9cafbc680907311715i6da98d3du55d3958c69c9ffa4@mail.gmail.com>
X-Mailer: Apple Mail (2.935.3)
X-Virus-Checked: Checked by ClamAV on apache.org

See the Term Vector capability. http://www.lucidimagination.com/search/?q=term+vectors#/ 
p:lucene

By default the information is _not_ stored in the index.  You will  
need to add Field.TermVector.YES to your indexing in order for this  
information to be available.

-Grant

On Jul 31, 2009, at 8:15 PM, Phil Whelan wrote:

> Hi,
>
> I know you can use Field.Store.YES, but I want to inspect the terms /
> tokens and their order related to the field name at search time. Is
> this possible? Obviously this information is stored in the index, but
> I can not find any API to access it. I'm guessing the answer might be
> that Terms point to a Document and not the other way around. Is this
> right?
>
> eg.
> Document doc = .... ;
> Term[] terms = doc.getTerms();
>
> Or...
> String[] values = doc.getTermValues();
>
> Thanks,
> Phil
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41616-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 01 09:09:01 2009
Return-Path: <java-user-return-41616-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14631 invoked from network); 1 Aug 2009 09:09:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Aug 2009 09:09:01 -0000
Received: (qmail 81669 invoked by uid 500); 1 Aug 2009 09:09:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81601 invoked by uid 500); 1 Aug 2009 09:09:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81591 invoked by uid 99); 1 Aug 2009 09:09:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 09:09:02 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.217.218] (HELO mail-gx0-f218.google.com) (209.85.217.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 09:08:52 +0000
Received: by gxk18 with SMTP id 18so4126100gxk.5
        for <java-user@lucene.apache.org>; Sat, 01 Aug 2009 02:08:31 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.150.17 with SMTP id c17mr5020930ybo.336.1249117711016; 
	Sat, 01 Aug 2009 02:08:31 -0700 (PDT)
In-Reply-To: <090CF9D7-5D59-47A5-AD2A-86D4BEC6CD15@mac.com>
References: <9cafbc680907301111t4768704cy9e4b3092b3d74b17@mail.gmail.com>
	 <4A71E9DF.3030404@informatics.jax.org> <4A722D75.9070806@aconex.com>
	 <D8AF0747-AEC3-4E5F-AB52-EF62BA460529@mac.com>
	 <9ac0c6aa0907310234h798d406bg8cb23d620b022ef8@mail.gmail.com>
	 <161DCF62-1E03-4F1B-A590-76ADD91D5434@mac.com>
	 <9ac0c6aa0907311452q4f49f1aeua7314b6059b5973@mail.gmail.com>
	 <2BC00C69-41B3-48B3-83E7-CBC6DB452CCC@mac.com>
	 <9cafbc680907311701g7c8ff0f1n896c4bed2adda9c9@mail.gmail.com>
	 <090CF9D7-5D59-47A5-AD2A-86D4BEC6CD15@mac.com>
Date: Sat, 1 Aug 2009 05:08:30 -0400
Message-ID: <9ac0c6aa0908010208g757a9936vd1150bdec47bc9e9@mail.gmail.com>
Subject: Re: ThreadedIndexWriter vs. IndexWriter
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

(Please note that ThreadedIndexWriter is source code available with
the upcoming revision to Lucene in Action.)

Phil, is it possible you are using an older version of the book's
source code?  In particular, can you check whether your version of
ThreadedIndexWriter.java has this:

  public void close(boolean doWait) throws CorruptIndexException, IOException {
    finish();
    super.close(doWait);
  }

(I vaguely remember that being missing from earlier releases, which
could explain what you're seeing).  If you are missing that, can you
download the current code from http://www.manning.com/hatcher3 and try
again?

If that's not the problem... can you post the benchmark alg you are
using in each case?

Mike

On Fri, Jul 31, 2009 at 8:26 PM, Jibo John<jibojohn@mac.com> wrote:
> Hi Phil,
>
> It's 5 threads for IndexWriter.
>
> For ThreadedIndexWriter, I used:
>
> writer.num.threads=16
> writer.max.thread.queue.size=80
>
> Thanks,
> -Jibo
>
> On Jul 31, 2009, at 5:01 PM, Phil Whelan wrote:
>
>> Hi Jibo,
>>
>> Your mergeFactor is different, and the resulting numFiles (segment
>> files) is different. Maybe each thread is responsible for a segment
>> file. Just curious - do you have 3 threads?
>>
>> Phil
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41617-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 01 09:43:46 2009
Return-Path: <java-user-return-41617-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24437 invoked from network); 1 Aug 2009 09:43:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Aug 2009 09:43:46 -0000
Received: (qmail 90631 invoked by uid 500); 1 Aug 2009 09:43:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90541 invoked by uid 500); 1 Aug 2009 09:43:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90531 invoked by uid 99); 1 Aug 2009 09:43:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 09:43:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 09:43:37 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MXB7U-0007IB-1v
	for java-user@lucene.apache.org; Sat, 01 Aug 2009 02:43:16 -0700
Message-ID: <24767693.post@talk.nabble.com>
Date: Sat, 1 Aug 2009 02:43:16 -0700 (PDT)
From: mschipperheyn <m.schipperheyn@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Group by in Lucene ?
In-Reply-To: <7e536b1f0902010700p3ea6f51cnd0cdd7dd408e6f45@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.schipperheyn@gmail.com
References: <7e536b1f0711042157j4b2ee68fld8043344b022095d@mail.gmail.com> <F101D398-9CC5-4053-BFE1-72002F8822EE@apache.org> <7e536b1f0711050449u15b6af6j8456e9c5e89f4364@mail.gmail.com> <C7DED9F8-A524-4735-A1F5-1089DC869CEC@apache.org> <7e536b1f0711060019r32914558ke1e2ee7885e9f1f@mail.gmail.com> <14170395.post@talk.nabble.com> <7e536b1f0901272311v2f8b23bbg169f4bfc508aac90@mail.gmail.com> <21702721.post@talk.nabble.com> <21702742.post@talk.nabble.com> <7e536b1f0901280343q4370a9c3x5c8bb86f9eb65326@mail.gmail.com> <359a92830901280602u26fa2974x17c1337a29cc2609@mail.gmail.com> <498081A9.50105@gmail.com> <7e536b1f0902010700p3ea6f51cnd0cdd7dd408e6f45@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


http://code.google.com/p/bobo-browse

looks like it may be the ticket.

Marc

-- 
View this message in context: http://www.nabble.com/Group-by-in-Lucene---tp13581760p24767693.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41618-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 01 17:03:43 2009
Return-Path: <java-user-return-41618-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33929 invoked from network); 1 Aug 2009 17:03:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Aug 2009 17:03:43 -0000
Received: (qmail 95800 invoked by uid 500); 1 Aug 2009 17:03:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95725 invoked by uid 500); 1 Aug 2009 17:03:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95714 invoked by uid 99); 1 Aug 2009 17:03:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 17:03:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 01 Aug 2009 17:03:34 +0000
Received: by yxe3 with SMTP id 3so2969498yxe.29
        for <java-user@lucene.apache.org>; Sat, 01 Aug 2009 10:03:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=0nYmg2FKX+whJWKJMLXTeUS8Hypc6F3iambxWBcJj8k=;
        b=fuwzDvSsxhWJeJSJrSxOTBwEoTxudKFhhCO05W9hLAOrS9WQ3e7eDQwuBnrmtmU014
         xnXANdTj+b986iZT/Ofifn/QhDePgbcKHFbfVbfBxZHA1hcBTt45Nv1gNNS/GEnc5QWR
         sFl/I875NXFS9mzcjNQnz1dVmnDc+Dvp7FFlo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=CcF1svpY79FPVHPvTzRZz8hyowjUVPUDXzM/h49DI6OJbjcsZUoIRWGGsnFi9ds1PO
         3rQ71Rrw2YOW58nmY7xwq0Jhtp4D6O1FT3L5iVXgw7ItiTShA/oxYPRDH7XR9ledx3R6
         5A4B+Ok6S6UZ40IR5fBxm/Rn1KygAzgRH2594=
MIME-Version: 1.0
Received: by 10.100.216.12 with SMTP id o12mr4252750ang.6.1249146193329; Sat, 
	01 Aug 2009 10:03:13 -0700 (PDT)
In-Reply-To: <9ac0c6aa0908010208g757a9936vd1150bdec47bc9e9@mail.gmail.com>
References: <9cafbc680907301111t4768704cy9e4b3092b3d74b17@mail.gmail.com>
	 <4A722D75.9070806@aconex.com>
	 <D8AF0747-AEC3-4E5F-AB52-EF62BA460529@mac.com>
	 <9ac0c6aa0907310234h798d406bg8cb23d620b022ef8@mail.gmail.com>
	 <161DCF62-1E03-4F1B-A590-76ADD91D5434@mac.com>
	 <9ac0c6aa0907311452q4f49f1aeua7314b6059b5973@mail.gmail.com>
	 <2BC00C69-41B3-48B3-83E7-CBC6DB452CCC@mac.com>
	 <9cafbc680907311701g7c8ff0f1n896c4bed2adda9c9@mail.gmail.com>
	 <090CF9D7-5D59-47A5-AD2A-86D4BEC6CD15@mac.com>
	 <9ac0c6aa0908010208g757a9936vd1150bdec47bc9e9@mail.gmail.com>
Date: Sat, 1 Aug 2009 10:03:13 -0700
Message-ID: <9cafbc680908011003i7d7e8506u18b703a4ca0f8669@mail.gmail.com>
Subject: Re: ThreadedIndexWriter vs. IndexWriter
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Mike,

It's Jibo, not me, having the problem. But thanks for the link. I was
interested to look at the code. Will be buying the book soon.

Phil

On Sat, Aug 1, 2009 at 2:08 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
>
> (Please note that ThreadedIndexWriter is source code available with
> the upcoming revision to Lucene in Action.)
>
> Phil, is it possible you are using an older version of the book's
> source code? =A0In particular, can you check whether your version of
> ThreadedIndexWriter.java has this:
>
> =A0public void close(boolean doWait) throws CorruptIndexException, IOExce=
ption {
> =A0 =A0finish();
> =A0 =A0super.close(doWait);
> =A0}
>
> (I vaguely remember that being missing from earlier releases, which
> could explain what you're seeing). =A0If you are missing that, can you
> download the current code from http://www.manning.com/hatcher3 and try
> again?
>
> If that's not the problem... can you post the benchmark alg you are
> using in each case?
>
> Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41619-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 00:17:59 2009
Return-Path: <java-user-return-41619-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81159 invoked from network); 2 Aug 2009 00:17:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 00:17:59 -0000
Received: (qmail 11801 invoked by uid 500); 2 Aug 2009 00:18:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11709 invoked by uid 500); 2 Aug 2009 00:18:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11699 invoked by uid 99); 2 Aug 2009 00:18:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 00:18:00 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 00:17:50 +0000
Received: by ewy26 with SMTP id 26so3271667ewy.5
        for <java-user@lucene.apache.org>; Sat, 01 Aug 2009 17:17:26 -0700 (PDT)
Received: by 10.210.129.20 with SMTP id b20mr2990379ebd.83.1249172246587;
        Sat, 01 Aug 2009 17:17:26 -0700 (PDT)
Received: from ?62.84.92.150? ([62.84.92.150])
        by mx.google.com with ESMTPS id 10sm6446772eyz.21.2009.08.01.17.17.23
        (version=SSLv3 cipher=RC4-MD5);
        Sat, 01 Aug 2009 17:17:25 -0700 (PDT)
Subject: Re: arabic analyzer
From: walid <walid.bakkar@elementn.com>
To: java-user@lucene.apache.org
In-Reply-To: <8f0ad1f30907240539q5f2e3dbak9b90704ded96ed77@mail.gmail.com>
References: <1248348847.5882.12.camel@mine-lenovo>
	 <8f0ad1f30907230633i4eef7bc2n58a463c446e6d4e5@mail.gmail.com>
	 <1248422813.5499.6.camel@mine-lenovo>
	 <8f0ad1f30907240539q5f2e3dbak9b90704ded96ed77@mail.gmail.com>
Content-Type: text/plain; charset="UTF-8"
Date: Sun, 02 Aug 2009 03:17:19 +0300
Message-Id: <1249172239.5261.4.camel@mine-lenovo>
Mime-Version: 1.0
X-Mailer: Evolution 2.26.1 
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

I guess in that case, my users will be angry :)
the fact is, plural (as an example) is not supported, and that is one of
the most common things that a person doing some search will expect to
not have to worry about.
anyway, will roll it out and see the users' reaction :)

thank you.

-walid 

On Fri, 2009-07-24 at 08:39 -0400, Robert Muir wrote:
> walid, it is true some of what you mentioned (from aramorph) works in
> light stemming version, some does not.
> The problem is that its not clear to me that what aramorph is doing is
> really the best.
> 
> >From the paper I sent you:
> 
> The best stemmer in our experiments, light8-s was very simple and did
> not try to find roots or take into account most of Arabic morphology.
> It is probably not essential for the stemmer to yield the correct
> forms, whether stems or roots.
> It is sufficient for it to group most of the forms that belong together.
> 
> This is what is being used in lucene, light8-s. If you read section
> 5.2.1 of the paper, you will see this method outperforms the
> morphological analysis method you speak of (using the same buckwalter
> dictionary)
> 
> But I also understand this is just a general text IR relevance
> measurement (your specific text might vary), and it does not take into
> account some human factors (it can be better on average, but make
> users angry, that type of thing).
> 
> Another problem I have with this situation is that I'm not sure the
> morph. analysis method is really wrong, just that perhaps aramorph /
> that paper might be indexing the wrong thing. For example, aramorph
> indexes arabic stems, but the latest buckwalter dictionary has
> lemmaID, why not index that?
> 
> anyway, I hope in the future there will be more options, that would be
> a good thing!
> 
> On Fri, Jul 24, 2009 at 4:06 AM, walid<walid.bakkar@elementn.com> wrote:
> > We were using the aramorph library for some time and so we mapped out
> > the set of features it provides, they come as follows:
> >
> > ----------------------------------------------------------------------------------------------------------------------------------------------------------------
> > The ء and ~ are considered unique characters.
> >
> >
 <>              * أ , آ, ا, and إ are distinct
> >
 <>              * و and ؤ are distinct
> >
 <>              * ى and ئ are distinct
> >
> >
> >
> >      * The ا and ة (denoting the feminine adjective) at the end of a
> >        word are optional.
> >
> >      * The ال, ب, ل, ك, بال, كال, لل at the beginning of a word are
> >        optional
> >
> >      * All حركات as well as the ّ (شدّة) are ignored.
> >
> >      * The ي , و , ات , ون denoting the plural form of a word are
> >        optional. If the indexed word ends with a ة its plural, which
> >        replaces the ة with ات , is recognized.
> >
> >
> >
> >
> >
> > The following examples illustrate these rules:
> >
> >
> > Indexed Word
> >
> >
> > Search Term
> >
> >
> > Success
> >
> >
 <>                  الحياة
> >
> >
 <>                  للحياة
> >
> >
> > True
> >
> >
> >
> >
 <> حياة
> >
> >
> > True
> >
> >
> >
> >
 <> حيا
> >
> >
> > False
> >
> >
> >
> >
 <> ألحياة
> >
> >
> > False
> >
> >
> >
> >
 <> إلحياة
> >
> >
> > False
> >
> >
> >
> >
 <> كالحياة
> >
> >
> > True
> >
> >
> >
> >
 <> بالحياة
> >
> >
> > True
> >
> >
> >
> >
 <> بحياة
> >
> >
> > True
> >
> >
> >
> >
 <> لحياة
> >
> >
> > True
> >
> >
 <> دولارا
> >
> >
 <> دولار
> >
> >
> > True
> >
> >
> >
> >
 <> بدولار
> >
> >
> > True
> >
> >
> >
> >
 <> بالدولار
> >
> >
> > True
> >
> >
> >
> >
 <> الدولار
> >
> >
> > True
> >
> >
> >
> >
 <> دؤلارا
> >
> >
> > False
> >
> >
> >
> >
 <> دولأرا
> >
> >
> > False
> >
> >
> >
> >
 <> دولارأ
> >
> >
> > False
> >
> >
 <> الكاتب
> >
> >
 <> كاتب
> >
> >
> > True
> >
> >
> >
> >
 <> لكاتب
> >
> >
> > True
> >
> >
> >
> >
 <> كاتبة
> >
> >
> > True
> >
> >
> >
> >
 <> الكاتبة
> >
> >
> > True
> >
> >
> >
> >
 <> الكاتبات
> >
> >
> > True
> >
> >
> >
> >
 <> كاتبون
> >
> >
> > True
> >
> >
> >
> >
 <> كاتبو \ كاتبي
> >
> >
> > True
> >
> >
> >
> >
 <> كتب
> >
> >
> > False
> >
> >
 <> جميلة
> >
> >
 <> جميلات
> >
> >
> > True
> >
> >
> >
> >
 <> جميل
> >
> >
> > True
> >
> >
> >
> >
 <> الجمال
> >
> >
> > False
> >
> >
 <> بنت
> >
> >
 <> ابنة
> >
> >
> > False
> >
> >
> >
> >
 <> بن
> >
> >
> > True
> >
> >
> >
> >
 <> ابن
> >
> >
> > True
> >
> >
> >
> >
 <> ابنت
> >
> >
> > False
> >
> >
> >
> > ----------------------------------------------------------------------------------------------------------------------------------------------------------------
> >
> > while with the new one, we only got matches for:
> > |
 <> فّ فُ فٌ فف فِِ فٍ ف
> >  and the likes of that.
> >
> > -walid
> >
> > On Thu, 2009-07-23 at 09:33 -0400, Robert Muir wrote:
> >
> >> walid, can you provide any more information other than "very poor result"?
> >>
> >> Others have not measured much difference between morphological
> >> analysis and light stemming:
> >> http://ciir.cs.umass.edu/pubfiles/ir-249.pdf
> >>
> >>
> >> On Thu, Jul 23, 2009 at 7:34 AM, walid<walid.bakkar@elementn.com> wrote:
> >> > http://issues.apache.org/jira/browse/LUCENE-1406
> >> > http://issues.apache.org/jira/browse/LUCENE-153
> >> >
> >> > based on this, there are two options:
> >> > 1- using the aramorph library
> >> > 2- moving the code from trunk to the current release and using the
> >> > provided arabic analyzer
> >> >
> >> > 1- the library works very well in indexing, tokenizing, stemming and
> >> > everything, but causes memory leaks
> >> > 2- the provided library has a very poor result compared to the aramorph
> >> > library.
> >> >
> >> > Is there a plan to have better arabic support with full morphological
> >> > analysis support?
> >> >
> >> > walid
> >> >
> >> >
> >> > ---------------------------------------------------------------------
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >> >
> >>
> >>
> >>
> >
> 
> 
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41620-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 02:10:22 2009
Return-Path: <java-user-return-41620-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14987 invoked from network); 2 Aug 2009 02:10:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 02:10:21 -0000
Received: (qmail 52899 invoked by uid 500); 2 Aug 2009 02:10:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52816 invoked by uid 500); 2 Aug 2009 02:10:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52804 invoked by uid 99); 2 Aug 2009 02:10:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 02:10:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.7] (HELO eastrmmtao101.cox.net) (68.230.240.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 02:10:12 +0000
Received: from eastrmimpo03.cox.net ([68.1.16.126])
          by eastrmmtao101.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090802020951.IYHI22545.eastrmmtao101.cox.net@eastrmimpo03.cox.net>
          for <java-user@lucene.apache.org>; Sat, 1 Aug 2009 22:09:51 -0400
Received: from eastrmwml46 ([172.18.18.217])
	by eastrmimpo03.cox.net with bizsmtp
	id PE9r1c00D4h0NJL02E9rdl; Sat, 01 Aug 2009 22:09:51 -0400
X-VR-Score: -100.00
X-Authority-Analysis: v=1.0 c=1 a=gA02pIXEcKgA:10 a=bcMBx5DovmOKC-H_RS4A:9
 a=ta3bbhxc4sOTHVvJEGdSwKpx_uAA:4
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Sat, 1 Aug 2009 22:09:51 -0400
Message-ID: <20090801220951.OSK7T.16597.imail@eastrmwml46>
Date: Sat, 1 Aug 2009 22:09:51 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: java.io.IOException when trying to list terms in index
 (IndexReader)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I'm starting to work on an app to list all of the terms in the "path" field.  I'm including the beginning of my code below.

When I run this, pointing it to a directory named "index" containing the Lucene indexes, I am getting a java.io.IOException.

Here's the output when I run:

Index in directory :[C:\lucene-devel\lucene-devel\index] was opened successfully!
About to drop into while()...
** ERROR **: Exception while stepping through index: [java.io.IOException: The handle is invalid]

and here's the code:

import java.io.IOException;

import org.apache.lucene.index.IndexReader;
import org.apache.lucene.index.Term;
import org.apache.lucene.index.TermEnum;


public class ReadIndex {

	public static void main(String[] args) {
		IndexReader reader = null;
		TermEnum termsEnumerator = null;
		Term currentTerm = null;
		
		try {
			reader = IndexReader.open(args[0]);
			Term term = new Term("path", "");
			termsEnumerator = reader.terms(term);
		} catch (IOException e) {
			System.out.println("** ERROR **: Exception when opened IndexReader: [" + e + "]");
		} finally {
			try { reader.close(); } catch (IOException e) { /* suck it up */ }
		}
		
		System.out.println("Index in directory :[" + args[0] + "] was opened successfully!");
		
		try {
			System.out.println("About to drop into while()...");
			while (termsEnumerator.next()) {
				System.out.println("About to get terms.Enumerator.term()...");
				currentTerm = termsEnumerator.term();
				System.out.println("Term = [" + currentTerm.text() + "]");
			}
			termsEnumerator.close();
		} catch (Exception e) {
			System.out.println("** ERROR **: Exception while stepping through index: [" + e + "]");
			}
	} // end main()

} // end CLASS ReadIndex

Can anyone tell me what might be causing that exception?

Thanks,
Jim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41621-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 03:10:46 2009
Return-Path: <java-user-return-41621-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29583 invoked from network); 2 Aug 2009 03:10:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 03:10:46 -0000
Received: (qmail 69870 invoked by uid 500); 2 Aug 2009 03:10:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69783 invoked by uid 500); 2 Aug 2009 03:10:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69773 invoked by uid 99); 2 Aug 2009 03:10:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 03:10:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of phil123@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 03:10:39 +0000
Received: by yxe3 with SMTP id 3so3245384yxe.29
        for <java-user@lucene.apache.org>; Sat, 01 Aug 2009 20:10:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=kGx7jgLp9Fh1cR0H1UwbRcnfxuBFwhU4penhKrZVDOA=;
        b=Y/gn33LDxGDUs5nIe2DTqmChnomPZvSw07EYRklU4jjTovJVBD0YGxNLRqCuODckAp
         wzpYX3raT7cgtAsw1VPD9e2EOa7sc4z4fcCXB7gVm9PaPl7U11eEvQZYEAknlP7uabNn
         wdRkY93Bpzv1c50A8JbUblAzYilWA/bbgXF5Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=JOrc26kCSBCUYcqgicfUAgVKFNEB4E2CjtuJFegs/TgUD0zce60U9JLrPcsRGrE4yU
         gUnRRsLEIb/QoGPZPZascsn05kDrOOo0he8N/k87xpaPbDqHQgF8d6Jim4DkVXGWKy5S
         zdDrM4MLBK1v3nKemVbaffu5eDQzO2jXRJWh8=
MIME-Version: 1.0
Received: by 10.100.91.3 with SMTP id o3mr4824862anb.157.1249182618806; Sat, 
	01 Aug 2009 20:10:18 -0700 (PDT)
In-Reply-To: <20090801220951.OSK7T.16597.imail@eastrmwml46>
References: <20090801220951.OSK7T.16597.imail@eastrmwml46>
Date: Sat, 1 Aug 2009 20:10:18 -0700
Message-ID: <9cafbc680908012010t3738dc45n2a23304e4eb89cef@mail.gmail.com>
Subject: Re: java.io.IOException when trying to list terms in index 
	(IndexReader)
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Jim,

I cannot see anything obvious, but both open() and terms() throw
IOException's. You could try putting these in separate try..catch
blocks to see which one it's coming from. Or using e.printStackTrace()
in the catch block will give more info to help you debug what's
happening.

On Sat, Aug 1, 2009 at 7:09 PM, <ohaya@cox.net> wrote:
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0reader =3D IndexReader.ope=
n(args[0]);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Term term =3D new Term("pa=
th", "");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0termsEnumerator =3D reader=
.terms(term);

Cheers,
Phil

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41622-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 03:21:46 2009
Return-Path: <java-user-return-41622-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31708 invoked from network); 2 Aug 2009 03:21:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 03:21:46 -0000
Received: (qmail 78603 invoked by uid 500); 2 Aug 2009 03:21:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78525 invoked by uid 500); 2 Aug 2009 03:21:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78514 invoked by uid 99); 2 Aug 2009 03:21:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 03:21:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.7] (HELO eastrmmtao101.cox.net) (68.230.240.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 03:21:38 +0000
Received: from eastrmimpo03.cox.net ([68.1.16.126])
          by eastrmmtao101.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090802032117.JUDJ22545.eastrmmtao101.cox.net@eastrmimpo03.cox.net>;
          Sat, 1 Aug 2009 23:21:17 -0400
Received: from eastrmwml29 ([172.18.18.217])
	by eastrmimpo03.cox.net with bizsmtp
	id PFMH1c0024h0NJL02FMHpy; Sat, 01 Aug 2009 23:21:17 -0400
X-VR-Score: -200.00
X-Authority-Analysis: v=1.0 c=1 a=0VJv2cbyVxsA:10 a=pGLkceISAAAA:8
 a=kviXuzpPAAAA:8 a=mV9VRH-2AAAA:8 a=b6MWxJbIN1iXbjYdoJ0A:9
 a=7vYw3biV_8W6P4PQDxOzJ3AU6nAA:4 a=MSl-tDqOz04A:10 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Sat, 1 Aug 2009 23:21:17 -0400
Message-ID: <20090801232117.1GI2G.16765.imail@eastrmwml29>
Date: Sat, 1 Aug 2009 23:21:17 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: java.io.IOException when trying to list terms in index
  (IndexReader)
Cc: Phil Whelan <phil123@gmail.com>
In-Reply-To: <9cafbc680908012010t3738dc45n2a23304e4eb89cef@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Phil,

Yes, that exception is not very helpful :)!!

I'll try your suggestions and post back.

Thanks,
Jim


---- Phil Whelan <phil123@gmail.com> wrote:=20
> Hi Jim,
>=20
> I cannot see anything obvious, but both open() and terms() throw
> IOException's. You could try putting these in separate try..catch
> blocks to see which one it's coming from. Or using e.printStackTrace()
> in the catch block will give more info to help you debug what's
> happening.
>=20
> On Sat, Aug 1, 2009 at 7:09 PM, <ohaya@cox.net> wrote:
> > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0reader =3D IndexReader.open(args[0]);
> > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0Term term =3D new Term("path", "");
> > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0termsEnumerator =3D reader.terms(term);
>=20
> Cheers,
> Phil
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41623-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 03:25:28 2009
Return-Path: <java-user-return-41623-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32004 invoked from network); 2 Aug 2009 03:25:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 03:25:28 -0000
Received: (qmail 82142 invoked by uid 500); 2 Aug 2009 03:25:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82054 invoked by uid 500); 2 Aug 2009 03:25:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82044 invoked by uid 99); 2 Aug 2009 03:25:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 03:25:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.59] (HELO eastrmmtao107.cox.net) (68.230.240.59)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 03:25:19 +0000
Received: from eastrmimpo02.cox.net ([68.1.16.120])
          by eastrmmtao107.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090802032457.WYIF22474.eastrmmtao107.cox.net@eastrmimpo02.cox.net>
          for <java-user@lucene.apache.org>; Sat, 1 Aug 2009 23:24:57 -0400
Received: from eastrmwml29 ([172.18.18.217])
	by eastrmimpo02.cox.net with bizsmtp
	id PFQy1c0084h0NJL02FQyKw; Sat, 01 Aug 2009 23:24:58 -0400
X-VR-Score: -100.00
X-Authority-Analysis: v=1.0 c=1 a=0VJv2cbyVxsA:10 a=kviXuzpPAAAA:8
 a=pGLkceISAAAA:8 a=mV9VRH-2AAAA:8 a=62Q_Vx7sml7kwP5QPtYA:9
 a=9Aw4nfE4XZM6dEfh1-MA:7 a=uZC_vFRDxccQ2tmY4dROsm68mMMA:4 a=4vB-4DCPJfMA:10
 a=MSl-tDqOz04A:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Sat, 1 Aug 2009 23:24:59 -0400
Message-ID: <20090801232459.19SUR.16789.imail@eastrmwml29>
Date: Sat, 1 Aug 2009 23:24:59 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: java.io.IOException when trying to list terms in index
 (IndexReader)
In-Reply-To: <20090801232117.1GI2G.16765.imail@eastrmwml29>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Phil,

I posted in haste.  Actually, from the output that I posted, doesn't it it =
look like the .next() itself is throwing the exception?

That is what has been puzzling me.  It looks like it got through the open()=
 and terms() with no problem, then it blew up when calling the next()?

Jim


---- ohaya@cox.net wrote:=20
> Phil,
>=20
> Yes, that exception is not very helpful :)!!
>=20
> I'll try your suggestions and post back.
>=20
> Thanks,
> Jim
>=20
>=20
> ---- Phil Whelan <phil123@gmail.com> wrote:=20
> > Hi Jim,
> >=20
> > I cannot see anything obvious, but both open() and terms() throw
> > IOException's. You could try putting these in separate try..catch
> > blocks to see which one it's coming from. Or using e.printStackTrace()
> > in the catch block will give more info to help you debug what's
> > happening.
> >=20
> > On Sat, Aug 1, 2009 at 7:09 PM, <ohaya@cox.net> wrote:
> > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0=
 =C2=A0 =C2=A0reader =3D IndexReader.open(args[0]);
> > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0=
 =C2=A0 =C2=A0Term term =3D new Term("path", "");
> > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0=
 =C2=A0 =C2=A0termsEnumerator =3D reader.terms(term);
> >=20
> > Cheers,
> > Phil
> >=20
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41624-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 03:28:17 2009
Return-Path: <java-user-return-41624-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32136 invoked from network); 2 Aug 2009 03:28:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 03:28:17 -0000
Received: (qmail 84669 invoked by uid 500); 2 Aug 2009 03:28:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84584 invoked by uid 500); 2 Aug 2009 03:28:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84573 invoked by uid 99); 2 Aug 2009 03:28:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 03:28:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.8] (HELO eastrmmtao102.cox.net) (68.230.240.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 03:28:09 +0000
Received: from eastrmimpo03.cox.net ([68.1.16.126])
          by eastrmmtao102.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090802032748.GWCN22890.eastrmmtao102.cox.net@eastrmimpo03.cox.net>
          for <java-user@lucene.apache.org>; Sat, 1 Aug 2009 23:27:48 -0400
Received: from eastrmwml29 ([172.18.18.217])
	by eastrmimpo03.cox.net with bizsmtp
	id PFTo1c0084h0NJL02FTogA; Sat, 01 Aug 2009 23:27:48 -0400
X-VR-Score: -100.00
X-Authority-Analysis: v=1.0 c=1 a=0VJv2cbyVxsA:10 a=kviXuzpPAAAA:8
 a=pGLkceISAAAA:8 a=mV9VRH-2AAAA:8 a=6EljxMtJtkjcjRkRiM8A:9
 a=SNAi5ER4qem1JLPVi1IA:7 a=LlFzX1PpE3PSNXevYz86JLnr-z8A:4 a=4vB-4DCPJfMA:10
 a=MSl-tDqOz04A:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Sat, 1 Aug 2009 23:27:48 -0400
Message-ID: <20090801232749.I50UF.16806.imail@eastrmwml29>
Date: Sat, 1 Aug 2009 23:27:49 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: java.io.IOException when trying to list terms in index
 (IndexReader)
In-Reply-To: <20090801232459.19SUR.16789.imail@eastrmwml29>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

BTW, the next() method is an abstract method in the Javadocs.  Does that me=
an that I'm suppose to have my own implementation?

Jim


---- ohaya@cox.net wrote:=20
> Phil,
>=20
> I posted in haste.  Actually, from the output that I posted, doesn't it i=
t look like the .next() itself is throwing the exception?
>=20
> That is what has been puzzling me.  It looks like it got through the open=
() and terms() with no problem, then it blew up when calling the next()?
>=20
> Jim
>=20
>=20
> ---- ohaya@cox.net wrote:=20
> > Phil,
> >=20
> > Yes, that exception is not very helpful :)!!
> >=20
> > I'll try your suggestions and post back.
> >=20
> > Thanks,
> > Jim
> >=20
> >=20
> > ---- Phil Whelan <phil123@gmail.com> wrote:=20
> > > Hi Jim,
> > >=20
> > > I cannot see anything obvious, but both open() and terms() throw
> > > IOException's. You could try putting these in separate try..catch
> > > blocks to see which one it's coming from. Or using e.printStackTrace(=
)
> > > in the catch block will give more info to help you debug what's
> > > happening.
> > >=20
> > > On Sat, Aug 1, 2009 at 7:09 PM, <ohaya@cox.net> wrote:
> > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0reader =3D IndexReader.open(args[0]);
> > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0Term term =3D new Term("path", "");
> > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0termsEnumerator =3D reader.terms(term);
> > >=20
> > > Cheers,
> > > Phil
> > >=20
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >=20
> >=20
> >=20
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41625-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 03:38:42 2009
Return-Path: <java-user-return-41625-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33916 invoked from network); 2 Aug 2009 03:38:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 03:38:42 -0000
Received: (qmail 89300 invoked by uid 500); 2 Aug 2009 03:38:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89211 invoked by uid 500); 2 Aug 2009 03:38:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89201 invoked by uid 99); 2 Aug 2009 03:38:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 03:38:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.48] (HELO eastrmmtao106.cox.net) (68.230.240.48)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 03:38:33 +0000
Received: from eastrmimpo03.cox.net ([68.1.16.126])
          by eastrmmtao106.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090802033813.VMFQ29503.eastrmmtao106.cox.net@eastrmimpo03.cox.net>
          for <java-user@lucene.apache.org>; Sat, 1 Aug 2009 23:38:13 -0400
Received: from eastrmwml29 ([172.18.18.217])
	by eastrmimpo03.cox.net with bizsmtp
	id PFeC1c00A4h0NJL02FeCvg; Sat, 01 Aug 2009 23:38:12 -0400
X-VR-Score: -100.00
X-Authority-Analysis: v=1.0 c=1 a=0VJv2cbyVxsA:10 a=kviXuzpPAAAA:8
 a=pGLkceISAAAA:8 a=mV9VRH-2AAAA:8 a=kxXx-E68VWh2Xi5cNygA:9
 a=jDF86_-R8-lk5ejLf4EA:7 a=G5MuE_XRsTv9pzK7MZ9fWbb8qGoA:4 a=4vB-4DCPJfMA:10
 a=MSl-tDqOz04A:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Sat, 1 Aug 2009 23:38:13 -0400
Message-ID: <20090801233813.A1BVP.16865.imail@eastrmwml29>
Date: Sat, 1 Aug 2009 23:38:13 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: java.io.IOException when trying to list terms in index
 (IndexReader)
In-Reply-To: <20090801232749.I50UF.16806.imail@eastrmwml29>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I changed the beginning of the try to:

=09=09try {
=09=09=09System.out.println("About to call .next()...");
=09=09=09boolean foo =3D termsEnumerator.next();
=09=09=09System.out.println("Finished calling first .next()");
=09=09=09System.out.println("About to drop into while()...");
.
.
.

and here's what I got when I ran the app:

Index in directory :[C:\lucene-devel\lucene-devel\index] was opened success=
fully!
About to call .next()...
** ERROR **: Exception while stepping through index: [java.io.IOException: =
The handle is invalid]
java.io.IOException: The handle is invalid
=09at java.io.RandomAccessFile.seek(Native Method)
=09at org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirec=
tory.java:591)
=09at org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInp=
ut.java:136)
=09at org.apache.lucene.index.CompoundFileReader$CSIndexInput.readInternal(=
CompoundFileReader.java:247)
=09at org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.=
java:157)
=09at org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInpu=
t.java:38)
=09at org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
=09at org.apache.lucene.index.TermBuffer.read(TermBuffer.java:64)
=09at org.apache.lucene.index.SegmentTermEnum.next(SegmentTermEnum.java:127=
)
=09at ReadIndex.main(ReadIndex.java:29)

Jim

---- ohaya@cox.net wrote:=20
> Hi,
>=20
> BTW, the next() method is an abstract method in the Javadocs.  Does that =
mean that I'm suppose to have my own implementation?
>=20
> Jim
>=20
>=20
> ---- ohaya@cox.net wrote:=20
> > Phil,
> >=20
> > I posted in haste.  Actually, from the output that I posted, doesn't it=
 it look like the .next() itself is throwing the exception?
> >=20
> > That is what has been puzzling me.  It looks like it got through the op=
en() and terms() with no problem, then it blew up when calling the next()?
> >=20
> > Jim
> >=20
> >=20
> > ---- ohaya@cox.net wrote:=20
> > > Phil,
> > >=20
> > > Yes, that exception is not very helpful :)!!
> > >=20
> > > I'll try your suggestions and post back.
> > >=20
> > > Thanks,
> > > Jim
> > >=20
> > >=20
> > > ---- Phil Whelan <phil123@gmail.com> wrote:=20
> > > > Hi Jim,
> > > >=20
> > > > I cannot see anything obvious, but both open() and terms() throw
> > > > IOException's. You could try putting these in separate try..catch
> > > > blocks to see which one it's coming from. Or using e.printStackTrac=
e()
> > > > in the catch block will give more info to help you debug what's
> > > > happening.
> > > >=20
> > > > On Sat, Aug 1, 2009 at 7:09 PM, <ohaya@cox.net> wrote:
> > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0reader =3D IndexReader.open(args[0]);
> > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0Term term =3D new Term("path", "");
> > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0termsEnumerator =3D reader.terms(term);
> > > >=20
> > > > Cheers,
> > > > Phil
> > > >=20
> > > > -------------------------------------------------------------------=
--
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >=20
> > >=20
> > >=20
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >=20
> >=20
> >=20
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41626-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 04:37:53 2009
Return-Path: <java-user-return-41626-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39744 invoked from network); 2 Aug 2009 04:37:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 04:37:53 -0000
Received: (qmail 5524 invoked by uid 500); 2 Aug 2009 04:37:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5440 invoked by uid 500); 2 Aug 2009 04:37:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5430 invoked by uid 99); 2 Aug 2009 04:37:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 04:37:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.48] (HELO eastrmmtao106.cox.net) (68.230.240.48)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 04:37:43 +0000
Received: from eastrmimpo03.cox.net ([68.1.16.126])
          by eastrmmtao106.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090802043722.WBMR29503.eastrmmtao106.cox.net@eastrmimpo03.cox.net>
          for <java-user@lucene.apache.org>; Sun, 2 Aug 2009 00:37:22 -0400
Received: from eastrmwml29 ([172.18.18.217])
	by eastrmimpo03.cox.net with bizsmtp
	id PGdN1c0064h0NJL02GdNLq; Sun, 02 Aug 2009 00:37:22 -0400
X-VR-Score: -100.00
X-Authority-Analysis: v=1.0 c=1 a=0VJv2cbyVxsA:10 a=kviXuzpPAAAA:8
 a=pGLkceISAAAA:8 a=mV9VRH-2AAAA:8 a=jyhOuHN8AAe3ZbwXhk0A:9
 a=P03jkW4E5NULKNkM0fkA:7 a=ftigoA773Bi3fnRtv3zoEKq2Uw8A:4 a=4vB-4DCPJfMA:10
 a=MSl-tDqOz04A:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Sun, 2 Aug 2009 0:37:22 -0400
Message-ID: <20090802003722.17T40.17181.imail@eastrmwml29>
Date: Sun, 2 Aug 2009 0:37:22 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: java.io.IOException when trying to list terms in index
 (IndexReader)
In-Reply-To: <20090801233813.A1BVP.16865.imail@eastrmwml29>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I don't know what happened, but all of a sudden, it started working :(...

Jim


---- ohaya@cox.net wrote:=20
> Hi,
>=20
> I changed the beginning of the try to:
>=20
> =09=09try {
> =09=09=09System.out.println("About to call .next()...");
> =09=09=09boolean foo =3D termsEnumerator.next();
> =09=09=09System.out.println("Finished calling first .next()");
> =09=09=09System.out.println("About to drop into while()...");
> .
> .
> .
>=20
> and here's what I got when I ran the app:
>=20
> Index in directory :[C:\lucene-devel\lucene-devel\index] was opened succe=
ssfully!
> About to call .next()...
> ** ERROR **: Exception while stepping through index: [java.io.IOException=
: The handle is invalid]
> java.io.IOException: The handle is invalid
> =09at java.io.RandomAccessFile.seek(Native Method)
> =09at org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDir=
ectory.java:591)
> =09at org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexI=
nput.java:136)
> =09at org.apache.lucene.index.CompoundFileReader$CSIndexInput.readInterna=
l(CompoundFileReader.java:247)
> =09at org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInpu=
t.java:157)
> =09at org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexIn=
put.java:38)
> =09at org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
> =09at org.apache.lucene.index.TermBuffer.read(TermBuffer.java:64)
> =09at org.apache.lucene.index.SegmentTermEnum.next(SegmentTermEnum.java:1=
27)
> =09at ReadIndex.main(ReadIndex.java:29)
>=20
> Jim
>=20
> ---- ohaya@cox.net wrote:=20
> > Hi,
> >=20
> > BTW, the next() method is an abstract method in the Javadocs.  Does tha=
t mean that I'm suppose to have my own implementation?
> >=20
> > Jim
> >=20
> >=20
> > ---- ohaya@cox.net wrote:=20
> > > Phil,
> > >=20
> > > I posted in haste.  Actually, from the output that I posted, doesn't =
it it look like the .next() itself is throwing the exception?
> > >=20
> > > That is what has been puzzling me.  It looks like it got through the =
open() and terms() with no problem, then it blew up when calling the next()=
?
> > >=20
> > > Jim
> > >=20
> > >=20
> > > ---- ohaya@cox.net wrote:=20
> > > > Phil,
> > > >=20
> > > > Yes, that exception is not very helpful :)!!
> > > >=20
> > > > I'll try your suggestions and post back.
> > > >=20
> > > > Thanks,
> > > > Jim
> > > >=20
> > > >=20
> > > > ---- Phil Whelan <phil123@gmail.com> wrote:=20
> > > > > Hi Jim,
> > > > >=20
> > > > > I cannot see anything obvious, but both open() and terms() throw
> > > > > IOException's. You could try putting these in separate try..catch
> > > > > blocks to see which one it's coming from. Or using e.printStackTr=
ace()
> > > > > in the catch block will give more info to help you debug what's
> > > > > happening.
> > > > >=20
> > > > > On Sat, Aug 1, 2009 at 7:09 PM, <ohaya@cox.net> wrote:
> > > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0reader =3D IndexReader.open(args[0]);
> > > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0Term term =3D new Term("path", "");
> > > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0termsEnumerator =3D reader.terms(term);
> > > > >=20
> > > > > Cheers,
> > > > > Phil
> > > > >=20
> > > > > -----------------------------------------------------------------=
----
> > > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > > >=20
> > > >=20
> > > >=20
> > > > -------------------------------------------------------------------=
--
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >=20
> > >=20
> > >=20
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >=20
> >=20
> >=20
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41627-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 08:19:00 2009
Return-Path: <java-user-return-41627-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88423 invoked from network); 2 Aug 2009 08:19:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 08:19:00 -0000
Received: (qmail 76141 invoked by uid 500); 2 Aug 2009 08:19:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76066 invoked by uid 500); 2 Aug 2009 08:19:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76056 invoked by uid 99); 2 Aug 2009 08:19:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 08:19:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 08:18:52 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MXWH1-0003jG-FL
	for java-user@lucene.apache.org; Sun, 02 Aug 2009 01:18:31 -0700
Message-ID: <24775753.post@talk.nabble.com>
Date: Sun, 2 Aug 2009 01:18:31 -0700 (PDT)
From: se3g2011 <se3g2011@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: java.io.IOException when trying to list terms in index
 (IndexReader)
In-Reply-To: <20090801233813.A1BVP.16865.imail@eastrmwml29>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: se3g2011@gmail.com
References: <20090801220951.OSK7T.16597.imail@eastrmwml46> <9cafbc680908012010t3738dc45n2a23304e4eb89cef@mail.gmail.com> <20090801232117.1GI2G.16765.imail@eastrmwml29> <20090801232459.19SUR.16789.imail@eastrmwml29> <20090801232749.I50UF.16806.imail@eastrmwml29> <20090801233813.A1BVP.16865.imail@eastrmwml29>
X-Virus-Checked: Checked by ClamAV on apache.org


hi,as you the error messages you listed below,pls put the 'reader.close()'
block to the bottom of method.
i think,if you invoke it first,the infrastructure stream is closed ,so
exceptions is encountered.


ohaya wrote:
>=20
> Hi,
>=20
> I changed the beginning of the try to:
>=20
> =09=09try {
> =09=09=09System.out.println("About to call .next()...");
> =09=09=09boolean foo =3D termsEnumerator.next();
> =09=09=09System.out.println("Finished calling first .next()");
> =09=09=09System.out.println("About to drop into while()...");
> .
> .
> .
>=20
> and here's what I got when I ran the app:
>=20
> Index in directory :[C:\lucene-devel\lucene-devel\index] was opened
> successfully!
> About to call .next()...
> ** ERROR **: Exception while stepping through index: [java.io.IOException=
:
> The handle is invalid]
> java.io.IOException: The handle is invalid
> =09at java.io.RandomAccessFile.seek(Native Method)
> =09at
> org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirectory=
.java:591)
> =09at
> org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.j=
ava:136)
> =09at
> org.apache.lucene.index.CompoundFileReader$CSIndexInput.readInternal(Comp=
oundFileReader.java:247)
> =09at
> org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java=
:157)
> =09at
> org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.ja=
va:38)
> =09at org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
> =09at org.apache.lucene.index.TermBuffer.read(TermBuffer.java:64)
> =09at org.apache.lucene.index.SegmentTermEnum.next(SegmentTermEnum.java:1=
27)
> =09at ReadIndex.main(ReadIndex.java:29)
>=20
> Jim
>=20
> ---- ohaya@cox.net wrote:=20
>> Hi,
>>=20
>> BTW, the next() method is an abstract method in the Javadocs.  Does that
>> mean that I'm suppose to have my own implementation?
>>=20
>> Jim
>>=20
>>=20
>> ---- ohaya@cox.net wrote:=20
>> > Phil,
>> >=20
>> > I posted in haste.  Actually, from the output that I posted, doesn't i=
t
>> it look like the .next() itself is throwing the exception?
>> >=20
>> > That is what has been puzzling me.  It looks like it got through the
>> open() and terms() with no problem, then it blew up when calling the
>> next()?
>> >=20
>> > Jim
>> >=20
>> >=20
>> > ---- ohaya@cox.net wrote:=20
>> > > Phil,
>> > >=20
>> > > Yes, that exception is not very helpful :)!!
>> > >=20
>> > > I'll try your suggestions and post back.
>> > >=20
>> > > Thanks,
>> > > Jim
>> > >=20
>> > >=20
>> > > ---- Phil Whelan <phil123@gmail.com> wrote:=20
>> > > > Hi Jim,
>> > > >=20
>> > > > I cannot see anything obvious, but both open() and terms() throw
>> > > > IOException's. You could try putting these in separate try..catch
>> > > > blocks to see which one it's coming from. Or using
>> e.printStackTrace()
>> > > > in the catch block will give more info to help you debug what's
>> > > > happening.
>> > > >=20
>> > > > On Sat, Aug 1, 2009 at 7:09 PM, <ohaya@cox.net> wrote:
>> > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0reader =3D IndexReader.open(args[0]);
>> > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0Term term =3D new Term("path", "");
>> > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0termsEnumerator =3D reader.terms(term);
>> > > >=20
>> > > > Cheers,
>> > > > Phil
>> > > >=20
>> > > >
>> ---------------------------------------------------------------------
>> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
>> > > >=20
>> > >=20
>> > >=20
>> > > --------------------------------------------------------------------=
-
>> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > > For additional commands, e-mail: java-user-help@lucene.apache.org
>> > >=20
>> >=20
>> >=20
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >=20
>>=20
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/java.io.IOException-whe=
n-trying-to-list-terms-in-index-%28IndexReader%29-tp24774351p24775753.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41628-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 08:32:53 2009
Return-Path: <java-user-return-41628-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89320 invoked from network); 2 Aug 2009 08:32:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 08:32:53 -0000
Received: (qmail 80404 invoked by uid 500); 2 Aug 2009 08:32:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80323 invoked by uid 500); 2 Aug 2009 08:32:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80313 invoked by uid 99); 2 Aug 2009 08:32:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 08:32:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.47] (HELO eastrmmtao105.cox.net) (68.230.240.47)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 08:32:45 +0000
Received: from eastrmimpo02.cox.net ([68.1.16.120])
          by eastrmmtao105.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090802083224.PSLG27200.eastrmmtao105.cox.net@eastrmimpo02.cox.net>
          for <java-user@lucene.apache.org>; Sun, 2 Aug 2009 04:32:24 -0400
Received: from eastrmwml37 ([172.18.18.217])
	by eastrmimpo02.cox.net with bizsmtp
	id PLYQ1c0034h0NJL02LYQjv; Sun, 02 Aug 2009 04:32:24 -0400
X-VR-Score: -30.00
X-Authority-Analysis: v=1.0 c=1 a=Uz--Q7iKZHwA:10 a=WinPX4BehImghh8UL7YA:9
 a=8knHbSDW9SsS8UxP2b1C6pUk-KEA:4
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Sun, 2 Aug 2009 4:32:23 -0400
Message-ID: <20090802043224.9IQHT.16549.imail@eastrmwml37>
Date: Sun, 2 Aug 2009 4:32:24 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Weird discrepancy with term counts vs. terms (off by 1)
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I've noticed a kind of strange problem with term counts and actual terms.

Some background:  I wrote an app that creates an index, including a "path" field.  

I am now working on an app (code was in the previous thread) that, as part of what it does, needs to get a list of all of the "path" fields for documents that were added.

I first noticed the problem that I'm seeing while working on this latter app.  Basically, what I noticed was that while I was adding 13 documents to the index, when I listed the "path" terms, there were only 12 of them.

So then, I reviewed the index using Luke, and what I saw with that was that there were indeed only 12 "path" terms (under "Term Count" on the left), but, when I clicked the "Show Top Terms" in Luke, there were 13 terms listed by Luke.

At this point, I'm very puzzled about all of this :(...

Can anyone explain why the difference in Luke, and, more importantly, what I am only getting 12 (i.e., 1 less than the # of documents added) when I try to programmatically list the terms?

Thanks,
Jim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41629-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 08:56:58 2009
Return-Path: <java-user-return-41629-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91190 invoked from network); 2 Aug 2009 08:56:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 08:56:57 -0000
Received: (qmail 90484 invoked by uid 500); 2 Aug 2009 08:56:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90390 invoked by uid 500); 2 Aug 2009 08:56:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90380 invoked by uid 99); 2 Aug 2009 08:56:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 08:56:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [69.55.225.129] (HELO ehatchersolutions.com) (69.55.225.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 08:56:49 +0000
Received: by ehatchersolutions.com (Postfix, from userid 504)
	id D51AE30EFC13; Sun,  2 Aug 2009 02:56:28 -0600 (MDT)
X-Spam-Checker-Version: SpamAssassin 3.1.1 (2006-03-10) on javelina
X-Spam-Level: 
Received: from [10.0.1.14] (va-71-51-2-147.dhcp.embarqhsd.net [71.51.2.147])
	by ehatchersolutions.com (Postfix) with ESMTP id CEA1E30EFC12
	for <java-user@lucene.apache.org>; Sun,  2 Aug 2009 02:56:27 -0600 (MDT)
Message-Id: <34B8BB27-47B6-4A0D-9050-FEB8C7D84233@ehatchersolutions.com>
From: Erik Hatcher <erik@ehatchersolutions.com>
To: java-user@lucene.apache.org
In-Reply-To: <24767693.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v935.3)
Subject: Re: Group by in Lucene ?
Date: Sun, 2 Aug 2009 04:56:25 -0400
References: <7e536b1f0711042157j4b2ee68fld8043344b022095d@mail.gmail.com> <F101D398-9CC5-4053-BFE1-72002F8822EE@apache.org> <7e536b1f0711050449u15b6af6j8456e9c5e89f4364@mail.gmail.com> <C7DED9F8-A524-4735-A1F5-1089DC869CEC@apache.org> <7e536b1f0711060019r32914558ke1e2ee7885e9f1f@mail.gmail.com> <14170395.post@talk.nabble.com> <7e536b1f0901272311v2f8b23bbg169f4bfc508aac90@mail.gmail.com> <21702721.post@talk.nabble.com> <21702742.post@talk.nabble.com> <7e536b1f0901280343q4370a9c3x5c8bb86f9eb65326@mail.gmail.com> <359a92830901280602u26fa2974x17c1337a29cc2609@mail.gmail.com> <498081A9.50105@gmail.com> <7e536b1f0902010700p3ea6f51cnd0cdd7dd408e6f45@mail.gmail.com> <24767693.post@talk.nabble.com>
X-Mailer: Apple Mail (2.935.3)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-1.0 required=5.0 tests=AWL,BAYES_00,
	RCVD_IN_SORBS_DUL autolearn=no version=3.1.1

Don't overlook Solr: http://lucene.apache.org/solr

	Erik

On Aug 1, 2009, at 5:43 AM, mschipperheyn wrote:

>
> http://code.google.com/p/bobo-browse
>
> looks like it may be the ticket.
>
> Marc
>
> -- 
> View this message in context: http://www.nabble.com/Group-by-in-Lucene---tp13581760p24767693.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41630-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 10:28:22 2009
Return-Path: <java-user-return-41630-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19155 invoked from network); 2 Aug 2009 10:28:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 10:28:22 -0000
Received: (qmail 24723 invoked by uid 500); 2 Aug 2009 10:28:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24642 invoked by uid 500); 2 Aug 2009 10:28:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24632 invoked by uid 99); 2 Aug 2009 10:28:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 10:28:23 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of prashullegaddi@gmail.com designates 209.85.198.231 as permitted sender)
Received: from [209.85.198.231] (HELO rv-out-0506.google.com) (209.85.198.231)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 10:28:11 +0000
Received: by rv-out-0506.google.com with SMTP id b25so861470rvf.5
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 03:27:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=KF7Zil2BPNUuoXhXKbwuZJNd5ciMdMvKUlXa4eL4qP0=;
        b=IDwsZOPUB45FXrucfr1powBYrm58lZLpnDTM06Zi8QGwoTNy1UzgKpuCSObKIt6l9p
         EOlnvqOuylsf1l7H7T8SyESwboLX4/FgcuFKC430W2+oSy1dj+0EWmxoTTdCOD0QD6A5
         4A1UazL+ncwtS641NwTnT6K0toGhl44G++T5c=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=L3bqAhlo8vkZfoR5HId7eJA3Np4MzlxyiSgK9Oh7pTTu07ZdItzwvmtTU/cU0XCZJa
         jd2kfK+SCcM5QYyT5z0DWgXLU8JHXWH7DSNQsSJAxrIsgdRVXxXQwT2+j06cu0lBAxDu
         ngw/YvaxIUTDIj9EW77E/d5qzz4/dEyAOoM2c=
MIME-Version: 1.0
Received: by 10.140.169.4 with SMTP id r4mr2997747rve.265.1249208870585; Sun, 
	02 Aug 2009 03:27:50 -0700 (PDT)
Date: Sun, 2 Aug 2009 15:57:50 +0530
Message-ID: <ac6e61fc0908020327nb0a9ed1k560e9a0056ebeff4@mail.gmail.com>
Subject: Weird behaviour
From: prashant ullegaddi <prashullegaddi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd2c0e0fb462b0470261a01
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd2c0e0fb462b0470261a01
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

I've indexed some 50million documents. I've indexed the target URL of each
document as "url" field by using
StandardAnalyzer with index.ANALYZED. Suppose, there is a wikipedia page
with title:"Rahul Dravid" and
url: http://en.wikipedia.org/wiki/Rahul_Dravid.

But when I search for +title:"Rahul Dravid" +url:"Wikipedia", I'm getting no
results. I get the document(s) when
I search for url:http://en.wikipedia.org/wiki/Rahul_Dravid or url:"
en.wikipedia.org/wiki/Rahul_Dravid". I get
results even when I search for url:"wiki/Rahul_Dravid".

It'd be helpful if somebody can throw some light on this.

-- Prashant.

--000e0cd2c0e0fb462b0470261a01--

From java-user-return-41631-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 10:38:08 2009
Return-Path: <java-user-return-41631-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22003 invoked from network); 2 Aug 2009 10:38:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 10:38:08 -0000
Received: (qmail 32316 invoked by uid 500); 2 Aug 2009 10:38:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32258 invoked by uid 500); 2 Aug 2009 10:38:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32202 invoked by uid 99); 2 Aug 2009 10:38:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 10:38:08 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 10:37:58 +0000
Received: by ewy26 with SMTP id 26so3427637ewy.5
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 03:37:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=FWTMKdBz5VFAveHoJyFx1XOWMc7OwhNJYjj7NW4qXQs=;
        b=bynnLxAulHDx4TSdvPKyCEC6Wsmzkj28wIjSYqiSemOLhximDA09/p6fV5H0Bo7oyS
         xRXc1hCS2NFQeczkzjJo2kAS2FRP1xGkPOHO1wdCBh6X2bXhNTQaGtoF+apqx8EA64rI
         sOY4qpfYE292cWi5ztrxDoqNTPZg6T22ODliQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=AsAHiAxEbViBuWonHYoUummGTYPtAW44VAn0yhLVFyMB/EfLaoeugt3SZ9nh3liR/t
         E4RGeqvTzAy3Vt3RUAiwgNvhaJsYqoDy1Ez1MJGVAzRS4w3n9gQYo0WCoIMt5Kli6HMR
         HRFAk7RpKgSPoEmFkG6AvVNKvnJO85V4tINWA=
MIME-Version: 1.0
Received: by 10.216.53.133 with SMTP id g5mr903681wec.160.1249209457318; Sun, 
	02 Aug 2009 03:37:37 -0700 (PDT)
In-Reply-To: <ac6e61fc0908020327nb0a9ed1k560e9a0056ebeff4@mail.gmail.com>
References: <ac6e61fc0908020327nb0a9ed1k560e9a0056ebeff4@mail.gmail.com>
Date: Sun, 2 Aug 2009 13:37:37 +0300
Message-ID: <786fde50908020337n49ad648bxf6e125305c0dca4e@mail.gmail.com>
Subject: Re: Weird behaviour
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6db76b0f41b0f0470263d2e
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6db76b0f41b0f0470263d2e
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

You write that you index the string under the "url" field. Do you also index
it under "title"? If not, that can explain why title:"Rahul Dravid" does not
work for you.

Also, did you try to look at the index w/ Luke? It will show you what are
the terms in the index.

Another thing which is always good to debug such things is to create a
StandardAnalyzer, then request a tokenStream() from it, passing a
StringReader w/ the text you want to parse. Then just print the tokens
returned.

I've done that, using the version from trunk, w/ Version.2_4, and the tokens
that are extracted are:
(http,0,4,type=<ALPHANUM>)
(en.wikipedia.org,7,23,type=<HOST>)
(wiki,24,28,type=<ALPHANUM>)
(rahul,29,34,type=<ALPHANUM>)
(dravid,35,41,type=<ALPHANUM>)

So:
1) You don't get results for title:"Rahul Dravid" since you index it under
"url" and not "title".
2) url:"wiki/Rahul_Dravid" works, since it looks for a phrase that exists in
the index (look at the last 3 tokens produced by the Analyzer, in the output
above).
3) ur:"<entire string" also works, since you index all of it under the "url"
field.

Does this explain the behavior you see?

Shai

On Sun, Aug 2, 2009 at 1:27 PM, prashant ullegaddi <prashullegaddi@gmail.com
> wrote:

> Hi,
>
> I've indexed some 50million documents. I've indexed the target URL of each
> document as "url" field by using
> StandardAnalyzer with index.ANALYZED. Suppose, there is a wikipedia page
> with title:"Rahul Dravid" and
> url: http://en.wikipedia.org/wiki/Rahul_Dravid.
>
> But when I search for +title:"Rahul Dravid" +url:"Wikipedia", I'm getting
> no
> results. I get the document(s) when
> I search for url:http://en.wikipedia.org/wiki/Rahul_Dravid or url:"
> en.wikipedia.org/wiki/Rahul_Dravid". I get
> results even when I search for url:"wiki/Rahul_Dravid".
>
> It'd be helpful if somebody can throw some light on this.
>
> -- Prashant.
>

--0016e6db76b0f41b0f0470263d2e--

From java-user-return-41632-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 13:48:16 2009
Return-Path: <java-user-return-41632-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72659 invoked from network); 2 Aug 2009 13:48:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 13:48:16 -0000
Received: (qmail 9881 invoked by uid 500); 2 Aug 2009 13:48:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9787 invoked by uid 500); 2 Aug 2009 13:48:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9777 invoked by uid 99); 2 Aug 2009 13:48:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 13:48:17 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of prashullegaddi@gmail.com designates 209.85.222.184 as permitted sender)
Received: from [209.85.222.184] (HELO mail-pz0-f184.google.com) (209.85.222.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 13:48:07 +0000
Received: by pzk14 with SMTP id 14so1728469pzk.29
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 06:47:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=R6j9Vx2705ZXNEMH5j1enb3e588rD1wtkg397qAWNRA=;
        b=R/SeIT1mpVrhsyK+Vjlz17RnKZ2Gl+NB/hrPHMn867/vohD/I9U+4uNlICm+ueu/aw
         vSnpHsrcQt3+Ty+5sQyPHfUmEwsYx9LLt0im7ZA/+ExGx04VRkXuLrK3hA6RUqP8U2Nk
         LF4PSLJr2Z6yD38ThYbMrQ0IToayhBnMibeMk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=K+ibUnni72c5exevZ1wuc50nJSm17yMJyldnZoQsSRrcfe/exZAKmh5q0AOkmcfH6U
         rSP/RO8WnWea/TMEQDtcniC+d6cIlV06GcXXtzp6qs7Nxk5tVFfYsGO4YcmJPv3s/vm2
         lpcZAy/K+Qzft25f3s67WrV9QMlUQcgJK6JmA=
MIME-Version: 1.0
Received: by 10.140.202.20 with SMTP id z20mr2973771rvf.228.1249220867609; 
	Sun, 02 Aug 2009 06:47:47 -0700 (PDT)
In-Reply-To: <786fde50908020337n49ad648bxf6e125305c0dca4e@mail.gmail.com>
References: <ac6e61fc0908020327nb0a9ed1k560e9a0056ebeff4@mail.gmail.com>
	 <786fde50908020337n49ad648bxf6e125305c0dca4e@mail.gmail.com>
Date: Sun, 2 Aug 2009 19:17:47 +0530
Message-ID: <ac6e61fc0908020647k696126e4r7722bcc0065f3f64@mail.gmail.com>
Subject: Re: Weird behaviour
From: prashant ullegaddi <prashullegaddi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd29cb80f54b1047028e64e
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd29cb80f54b1047028e64e
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Firstly, I'm indexing the string in url field only.

I've never used Luke, I don't know how to use.

What I'm trying to do is search for those documents which are from
some particular site, and have a given title.


On Sun, Aug 2, 2009 at 4:07 PM, Shai Erera <serera@gmail.com> wrote:

> You write that you index the string under the "url" field. Do you also
> index
> it under "title"? If not, that can explain why title:"Rahul Dravid" does
> not
> work for you.
>
> Also, did you try to look at the index w/ Luke? It will show you what are
> the terms in the index.
>
> Another thing which is always good to debug such things is to create a
> StandardAnalyzer, then request a tokenStream() from it, passing a
> StringReader w/ the text you want to parse. Then just print the tokens
> returned.
>
> I've done that, using the version from trunk, w/ Version.2_4, and the
> tokens
> that are extracted are:
> (http,0,4,type=<ALPHANUM>)
> (en.wikipedia.org,7,23,type=<HOST>)
> (wiki,24,28,type=<ALPHANUM>)
> (rahul,29,34,type=<ALPHANUM>)
> (dravid,35,41,type=<ALPHANUM>)
>
> So:
> 1) You don't get results for title:"Rahul Dravid" since you index it under
> "url" and not "title".
> 2) url:"wiki/Rahul_Dravid" works, since it looks for a phrase that exists
> in
> the index (look at the last 3 tokens produced by the Analyzer, in the
> output
> above).
> 3) ur:"<entire string" also works, since you index all of it under the
> "url"
> field.
>
> Does this explain the behavior you see?
>
> Shai
>
> On Sun, Aug 2, 2009 at 1:27 PM, prashant ullegaddi <
> prashullegaddi@gmail.com
> > wrote:
>
> > Hi,
> >
> > I've indexed some 50million documents. I've indexed the target URL of
> each
> > document as "url" field by using
> > StandardAnalyzer with index.ANALYZED. Suppose, there is a wikipedia page
> > with title:"Rahul Dravid" and
> > url: http://en.wikipedia.org/wiki/Rahul_Dravid.
> >
> > But when I search for +title:"Rahul Dravid" +url:"Wikipedia", I'm getting
> > no
> > results. I get the document(s) when
> > I search for url:http://en.wikipedia.org/wiki/Rahul_Dravid or url:"
> > en.wikipedia.org/wiki/Rahul_Dravid". I get
> > results even when I search for url:"wiki/Rahul_Dravid".
> >
> > It'd be helpful if somebody can throw some light on this.
> >
> > -- Prashant.
> >
>

--000e0cd29cb80f54b1047028e64e--

From java-user-return-41633-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 15:30:27 2009
Return-Path: <java-user-return-41633-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58760 invoked from network); 2 Aug 2009 15:30:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 15:30:26 -0000
Received: (qmail 25359 invoked by uid 500); 2 Aug 2009 14:28:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25290 invoked by uid 500); 2 Aug 2009 14:28:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25280 invoked by uid 99); 2 Aug 2009 14:28:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 14:28:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.9] (HELO eastrmmtao103.cox.net) (68.230.240.9)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 14:28:22 +0000
Received: from eastrmimpo01.cox.net ([68.1.16.119])
          by eastrmmtao103.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090802142800.MYJF27176.eastrmmtao103.cox.net@eastrmimpo01.cox.net>
          for <java-user@lucene.apache.org>; Sun, 2 Aug 2009 10:28:00 -0400
Received: from eastrmwml10 ([172.18.18.190])
	by eastrmimpo01.cox.net with bizsmtp
	id PSU01c00E463DB802SU0pY; Sun, 02 Aug 2009 10:28:00 -0400
X-VR-Score: -130.00
X-Authority-Analysis: v=1.0 c=1 a=OUoN0dqCuiIA:10 a=kviXuzpPAAAA:8
 a=mV9VRH-2AAAA:8 a=eD_-d0c__EVQn_jlnJgA:9 a=eMUiRI2GFQEP7HIEIlkA:7
 a=fLYQy5nRUDNOsIj6Mwbd0uXMsZsA:4 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Sun, 2 Aug 2009 10:28:01 -0400
Message-ID: <20090802102801.IZY6I.33218.imail@eastrmwml10>
Date: Sun, 2 Aug 2009 10:28:01 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Weird discrepancy with term counts vs. terms (off by 1)
In-Reply-To: <20090802043224.9IQHT.16549.imail@eastrmwml37>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

BTW, my indexer app is basically the same as the demo IndexFiles.java.  Here's part of the main:

    try {
      IndexWriter writer = new IndexWriter(INDEX_DIR, new StandardAnalyzer(), true, IndexWriter.MaxFieldLength.LIMITED);
      System.out.println("Indexing to directory '" +INDEX_DIR+ "'...");
      indexDocs(writer, docDir);
      System.out.println("Optimizing...");
      writer.optimize();
      writer.close();

      Date end = new Date();
      System.out.println(end.getTime() - start.getTime() + " total milliseconds");

    } catch (IOException e) {
      System.out.println(" caught a " + e.getClass() +
       "\n with message: " + e.getMessage());
    }

when I run the indexer, I can see it say it added the document that ends up being "missing" from the terms.

Thanks,
Jim


---- ohaya@cox.net wrote: 
> Hi,
> 
> I've noticed a kind of strange problem with term counts and actual terms.
> 
> Some background:  I wrote an app that creates an index, including a "path" field.  
> 
> I am now working on an app (code was in the previous thread) that, as part of what it does, needs to get a list of all of the "path" fields for documents that were added.
> 
> I first noticed the problem that I'm seeing while working on this latter app.  Basically, what I noticed was that while I was adding 13 documents to the index, when I listed the "path" terms, there were only 12 of them.
> 
> So then, I reviewed the index using Luke, and what I saw with that was that there were indeed only 12 "path" terms (under "Term Count" on the left), but, when I clicked the "Show Top Terms" in Luke, there were 13 terms listed by Luke.
> 
> At this point, I'm very puzzled about all of this :(...
> 
> Can anyone explain why the difference in Luke, and, more importantly, what I am only getting 12 (i.e., 1 less than the # of documents added) when I try to programmatically list the terms?
> 
> Thanks,
> Jim
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41634-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 15:30:37 2009
Return-Path: <java-user-return-41634-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59022 invoked from network); 2 Aug 2009 15:30:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 15:30:37 -0000
Received: (qmail 61799 invoked by uid 500); 2 Aug 2009 15:30:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61731 invoked by uid 500); 2 Aug 2009 15:30:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61721 invoked by uid 99); 2 Aug 2009 15:30:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 15:30:39 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of eransevi@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 15:30:30 +0000
Received: by ey-out-2122.google.com with SMTP id 9so816161eyd.53
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 08:30:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=sxO5OXB7i7Bk/6Uxu8pzwbq1PhUm1+YM9KDvbrCQpRg=;
        b=NoFhqaiVxihxwMCGfrSV20LNTELuGWNsr7ePUhAGz/wEUHX5eqL22yN3GZNLsaU9bK
         ryu8KPVlnhetBukv6aCQpd6rzxu4/cpmpWCwnXub1xoH6nevy8jXhUddc46mEOvdR9tt
         XEYZV+XCHgZXH7J3TAoPhk/0aD+AAXOFWoJWs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=ssezSmXiA3Uzj+mhnkssIO+gszebt3T1R+5amLoAk/8fAA9LbQDmyh9y/KZjdQr5dv
         u9upkGaH9EXHr0GNkNpXmvOTNyatSd+9DmdnkdtLeEr8zgrATa4jBVdDC6fyAp8w83ZL
         q4mY2t7qAkW2g7FmRH5DbAd0omA8qi1ozKVC4=
MIME-Version: 1.0
Received: by 10.210.51.10 with SMTP id y10mr3815077eby.4.1249227010331; Sun, 
	02 Aug 2009 08:30:10 -0700 (PDT)
Date: Sun, 2 Aug 2009 18:30:10 +0300
Message-ID: <74f928500908020830h5d3f4d0aw1f1ed2016c67200@mail.gmail.com>
Subject: score from spans
From: Eran Sevi <eransevi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174bedce31d30a04702a5473
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174bedce31d30a04702a5473
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

How can I get the score of a span that is the result of SpanQuery.getSpans()
? The score should can be the same for each document, but if it's unique per
span, it's even better.

I tried looking for a way to expose this functionality through the Spans
class but it looks too complicated.
I'm not even sure that by default some score calculation is even performed
when using span queries.

I've noticed that some calculations are made using payloads and
BoostingTermQuery but the score result is used internally and can't be
accessed from the Spans results.
I don't want to re-run the query again using a HitCollector and since the
reader is passed to getSpans, I think it should be possible to do what I
want.

Any help on the correct way to expose the span score will be appreciated.

Thanks,
Eran.

--0015174bedce31d30a04702a5473--

From java-user-return-41635-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 15:44:20 2009
Return-Path: <java-user-return-41635-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61842 invoked from network); 2 Aug 2009 15:44:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 15:44:20 -0000
Received: (qmail 70004 invoked by uid 500); 2 Aug 2009 15:44:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69939 invoked by uid 500); 2 Aug 2009 15:44:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69929 invoked by uid 99); 2 Aug 2009 15:44:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 15:44:23 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 15:44:11 +0000
Received: by ewy26 with SMTP id 26so3532365ewy.5
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 08:43:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=cxNLHHGa6PpHPhmXBd3tbB0L7feLjR+wsbo+1+7CD4Q=;
        b=QXIUksupzDRjlf7xHqbl3ntiZWwmD4hfDTUju8NzMrC9F0PiIF8Tp0UqhlV1cQR/ot
         Zqn6OHuBF7QkoaKoUprSvOFLWXzb+f8OILnn/YvK1U3Wn7Vzojqvx5y+9UgBwmbVJqO/
         2dOncZjhfrUVEx9SLnLJsH5gonbNERPdvPFis=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=G6TDn5WtT2shupQpiWvIlFFGttuGHKnUsiZJ1r/Bm5AsLSyAkSWUQoBZwBM+JVYJeb
         yxdBe0Pivnceo135/WK8KKfoZwP+8bO3VNQdVKxo3oYrBIVjpjy7IcqLRtk6ZemeZU2x
         3mhipC2GMgbLnnW+aEDuu/oGYeXoluk40uAk4=
MIME-Version: 1.0
Received: by 10.216.87.147 with SMTP id y19mr182512wee.12.1249227831075; Sun, 
	02 Aug 2009 08:43:51 -0700 (PDT)
In-Reply-To: <ac6e61fc0908020647k696126e4r7722bcc0065f3f64@mail.gmail.com>
References: <ac6e61fc0908020327nb0a9ed1k560e9a0056ebeff4@mail.gmail.com>
	 <786fde50908020337n49ad648bxf6e125305c0dca4e@mail.gmail.com>
	 <ac6e61fc0908020647k696126e4r7722bcc0065f3f64@mail.gmail.com>
Date: Sun, 2 Aug 2009 18:43:51 +0300
Message-ID: <786fde50908020843l490725aar800d406bc8c6d636@mail.gmail.com>
Subject: Re: Weird behaviour
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d645141d63fe04702a850c
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d645141d63fe04702a850c
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

How do you parse/convert the page to a Document object? Are you sure the
title "Rahul Dravid" is extracted properly and put in the "title" field?

You can read about Luke here: http://www.getopt.org/luke/.

Can you do System.out.println(document.toString()) before you add it to the
index, and paste the output here?

Shai

On Sun, Aug 2, 2009 at 4:47 PM, prashant ullegaddi <prashullegaddi@gmail.com
> wrote:

> Firstly, I'm indexing the string in url field only.
>
> I've never used Luke, I don't know how to use.
>
> What I'm trying to do is search for those documents which are from
> some particular site, and have a given title.
>
>
> On Sun, Aug 2, 2009 at 4:07 PM, Shai Erera <serera@gmail.com> wrote:
>
> > You write that you index the string under the "url" field. Do you also
> > index
> > it under "title"? If not, that can explain why title:"Rahul Dravid" does
> > not
> > work for you.
> >
> > Also, did you try to look at the index w/ Luke? It will show you what are
> > the terms in the index.
> >
> > Another thing which is always good to debug such things is to create a
> > StandardAnalyzer, then request a tokenStream() from it, passing a
> > StringReader w/ the text you want to parse. Then just print the tokens
> > returned.
> >
> > I've done that, using the version from trunk, w/ Version.2_4, and the
> > tokens
> > that are extracted are:
> > (http,0,4,type=<ALPHANUM>)
> > (en.wikipedia.org,7,23,type=<HOST>)
> > (wiki,24,28,type=<ALPHANUM>)
> > (rahul,29,34,type=<ALPHANUM>)
> > (dravid,35,41,type=<ALPHANUM>)
> >
> > So:
> > 1) You don't get results for title:"Rahul Dravid" since you index it
> under
> > "url" and not "title".
> > 2) url:"wiki/Rahul_Dravid" works, since it looks for a phrase that exists
> > in
> > the index (look at the last 3 tokens produced by the Analyzer, in the
> > output
> > above).
> > 3) ur:"<entire string" also works, since you index all of it under the
> > "url"
> > field.
> >
> > Does this explain the behavior you see?
> >
> > Shai
> >
> > On Sun, Aug 2, 2009 at 1:27 PM, prashant ullegaddi <
> > prashullegaddi@gmail.com
> > > wrote:
> >
> > > Hi,
> > >
> > > I've indexed some 50million documents. I've indexed the target URL of
> > each
> > > document as "url" field by using
> > > StandardAnalyzer with index.ANALYZED. Suppose, there is a wikipedia
> page
> > > with title:"Rahul Dravid" and
> > > url: http://en.wikipedia.org/wiki/Rahul_Dravid.
> > >
> > > But when I search for +title:"Rahul Dravid" +url:"Wikipedia", I'm
> getting
> > > no
> > > results. I get the document(s) when
> > > I search for url:http://en.wikipedia.org/wiki/Rahul_Dravid or url:"
> > > en.wikipedia.org/wiki/Rahul_Dravid". I get
> > > results even when I search for url:"wiki/Rahul_Dravid".
> > >
> > > It'd be helpful if somebody can throw some light on this.
> > >
> > > -- Prashant.
> > >
> >
>

--0016e6d645141d63fe04702a850c--

From java-user-return-41636-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 16:09:05 2009
Return-Path: <java-user-return-41636-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67593 invoked from network); 2 Aug 2009 16:09:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 16:09:05 -0000
Received: (qmail 79662 invoked by uid 500); 2 Aug 2009 16:09:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79563 invoked by uid 500); 2 Aug 2009 16:09:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79552 invoked by uid 99); 2 Aug 2009 16:09:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 16:09:08 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of phil123@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 16:09:00 +0000
Received: by yxe3 with SMTP id 3so3572731yxe.29
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 09:08:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=g4uQ6yTP47RVdm9m31QYBoHvH+aPPo2EK7/A1+Y/d1E=;
        b=uOoCidKVmooT52xqPMiy1XyS9+R88Ld+4brv840T3FXbE8rc8O2zlCBCiCCW15k5bZ
         CebSN/IaZ8cdGL1vmQdJzW1NQ75xAxY6GccDkvdcj6tL6xozdsuTTGy/Humif6HNBUDT
         4hOourckwSjH/Ft5uAlq8QFFtai0XIRFsqjjk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=i8vn8D8PKRqrjeMHN0+V/8oL9X38R2YgWemev7jeNhppKlIty1Cayl/0oHR4419gnu
         gT8XcZfmES50dCvPZs72/mIZ68rFApIFc4lqo8Vi3drr4H3OjOJ+J59tNYIYh0ajCxKV
         DFVREZD/qsvffR82lDGNEZBwsuAm0jyGR7fKU=
MIME-Version: 1.0
Received: by 10.101.70.14 with SMTP id x14mr5574120ank.78.1249229318941; Sun, 
	02 Aug 2009 09:08:38 -0700 (PDT)
In-Reply-To: <20090802043224.9IQHT.16549.imail@eastrmwml37>
References: <20090802043224.9IQHT.16549.imail@eastrmwml37>
Date: Sun, 2 Aug 2009 09:08:38 -0700
Message-ID: <9cafbc680908020908u42e0f009l2e93995c8c17d15f@mail.gmail.com>
Subject: Re: Weird discrepancy with term counts vs. terms (off by 1)
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Jim,

On Sun, Aug 2, 2009 at 1:32 AM, <ohaya@cox.net> wrote:
> I first noticed the problem that I'm seeing while working on this latter app.  Basically, what I noticed was that while I was adding 13 documents to the index, when I listed the "path" terms, there were only 12 of them.

Field text (the whole "path" in your case) and terms (the tokens of
the field text) are different.

The StandardAnalyzer breaks up words like this...
Field text = "/a/b/c.txt"
Tokens = {"a","b","c","txt"}

So this 1 field of 1 document become 4 terms / tokens (not sure if
there is a difference in this terminology between "terms" and "tokens"
sorry).
Therefore, you're going to have more terms than documents initially,
but as the overlap in term usage increases this changes.

For instance, these 3 paths
"/a/b/c/d.txt","/b/c/d/a.txt","/c/d/a/b.txt" are still only a total of
4 terms, since they share the same terms.

In fact, StandardAnalyzer goes a bit further than that and removes
"stop-words", such as "a" (or "an", "the") as it's designed for
general text searching.

That said, I think you have a point with the next part of your question...

> So then, I reviewed the index using Luke, and what I saw with that was that there were indeed only 12 "path" terms (under "Term Count" on the left), but, when I clicked the "Show Top Terms" in Luke, there were 13 terms listed by Luke.

Yes, I just checked this and this seems to be a bug with Luke. It
always shows 1 less than in "Term Count" than it should. Well spotted.

Cheers,
Phil

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41637-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 16:49:22 2009
Return-Path: <java-user-return-41637-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76540 invoked from network); 2 Aug 2009 16:49:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 16:49:22 -0000
Received: (qmail 94212 invoked by uid 500); 2 Aug 2009 16:49:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94133 invoked by uid 500); 2 Aug 2009 16:49:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94123 invoked by uid 99); 2 Aug 2009 16:49:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 16:49:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 16:49:16 +0000
Received: by yxe3 with SMTP id 3so3591583yxe.29
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 09:48:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=qnvhRWI2m7c2bU3qY1ytTVCTf4FWjz645tTxUxw8gLY=;
        b=TvxVq0BshBNYiKjrMdRm37EXb5VQPczz9RW2ryearCHjebRCMZa+tDUYfMUxbjaJMj
         NWdIDtgya+Df3KxiE1/QWYduMh3pgdbD0K436lUBv3qUK5gW3exTXWlRUBVBkjlBabr+
         lfC9lwOayo8Ifcspr4K/2UyP7ip4/W6nCzd9U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=uhMbfLHf4XqqiOPC194U7ksQAvO+zlwAySL5GX8aKmeGJNmM8bLOeQUY/S84F7qkan
         9obvP35bjqy8OsWV+0NpftBw2LOe/EDlnHC+C9lfPGXi4c4x5h7pwT0GrcsfXPwuQ9NM
         Offosobn61b+X9iGHdsgKd7UV1wKVazteeuS0=
MIME-Version: 1.0
Received: by 10.100.239.4 with SMTP id m4mr28101anh.97.1249231735488; Sun, 02 
	Aug 2009 09:48:55 -0700 (PDT)
In-Reply-To: <9cafbc680908020908u42e0f009l2e93995c8c17d15f@mail.gmail.com>
References: <20090802043224.9IQHT.16549.imail@eastrmwml37>
	 <9cafbc680908020908u42e0f009l2e93995c8c17d15f@mail.gmail.com>
Date: Sun, 2 Aug 2009 09:48:55 -0700
Message-ID: <9cafbc680908020948s5dea6b63x1ce8ac1ff8cd0972@mail.gmail.com>
Subject: Re: Weird discrepancy with term counts vs. terms (off by 1)
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Jim,

On Sun, Aug 2, 2009 at 9:08 AM, Phil Whelan<phil123@gmail.com> wrote:
>
>> So then, I reviewed the index using Luke, and what I saw with that was that there were indeed only 12 "path" terms (under "Term Count" on the left), but, when I clicked the "Show Top Terms" in Luke, there were 13 terms listed by Luke.
>
> Yes, I just checked this and this seems to be a bug with Luke. It
> always shows 1 less than in "Term Count" than it should. Well spotted.

I was able to see why this way happening in the Luke source and I've
submitted the following patch to Andrzej, the author of Luke.

Thanks,
Phil

--- luke.orig/src/org/getopt/luke/Luke.java	2009-03-19 22:41:34.000000000 -0700
+++ luke-src-0.9.2/src/org/getopt/luke/Luke.java	2009-08-02
09:33:24.000000000 -0700
@@ -813,23 +813,18 @@
       setString(iFields, "text", String.valueOf(idxFields.length));
       Object iTerms = find(pOver, "iTerms");
       termCounts.clear();
-      FieldTermCount ftc = new FieldTermCount();
+      FieldTermCount ftc = null;
       TermEnum te = ir.terms();
       numTerms = 0;
       while (te.next()) {
         Term currTerm = te.term();
-        if (ftc.fieldname == null) {
+        if (ftc == null || ftc.fieldname == null || ftc.fieldname !=
currTerm.field()) {
           // initialize
-          ftc.fieldname = currTerm.field();
-          termCounts.put(ftc.fieldname, ftc);
-        }
-        if (ftc.fieldname == currTerm.field()) {
-          ftc.termCount++;
-        } else {
           ftc = new FieldTermCount();
           ftc.fieldname = currTerm.field();
           termCounts.put(ftc.fieldname, ftc);
         }
+        ftc.termCount++;
         numTerms++;
       }
       te.close();

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41638-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 17:14:40 2009
Return-Path: <java-user-return-41638-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80782 invoked from network); 2 Aug 2009 17:14:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 17:14:40 -0000
Received: (qmail 7462 invoked by uid 500); 2 Aug 2009 17:14:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7379 invoked by uid 500); 2 Aug 2009 17:14:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7369 invoked by uid 99); 2 Aug 2009 17:14:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 17:14:43 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of prashullegaddi@gmail.com designates 209.85.200.173 as permitted sender)
Received: from [209.85.200.173] (HELO wf-out-1314.google.com) (209.85.200.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 17:14:32 +0000
Received: by wf-out-1314.google.com with SMTP id 24so832923wfg.20
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 10:14:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ktJfIoQMRo5sp/uuGLmfzmcdWrDobkIpWuJhzfEHk/Y=;
        b=QHRcbPaIm0DD+J5zyxwecjliRgJdFALDRjWV3NJQbs3bbyQugV+zhRoFn6MbD47/aj
         1Cu9w2yHR1QbmYZ1r11n9A7cochVbEphP+NY7SHQWzDfEQ8AwprYe7RuMbe9dKRjRm4l
         2WXTaH+/jjnjzZW4djJ5lcLkpn49r6u3QoShE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=NrkcJFqrMrfLbqwxmahjfRQgWmzO1fj63FkF0aobpGGSL3CBJxZ9ylzuMDqjUf54vy
         pWZU3lKRJxLLQB0X9bR9O6ARM5/luzmCtvKOYJ42gZqsX6Ba0OY6Uf9m2Akw3Vc44oLH
         iDLn/sX4q03qjOHxtZ+BQhIBEbLYeRDfH2Evw=
MIME-Version: 1.0
Received: by 10.140.177.15 with SMTP id z15mr1878567rve.3.1249233251724; Sun, 
	02 Aug 2009 10:14:11 -0700 (PDT)
In-Reply-To: <786fde50908020843l490725aar800d406bc8c6d636@mail.gmail.com>
References: <ac6e61fc0908020327nb0a9ed1k560e9a0056ebeff4@mail.gmail.com>
	 <786fde50908020337n49ad648bxf6e125305c0dca4e@mail.gmail.com>
	 <ac6e61fc0908020647k696126e4r7722bcc0065f3f64@mail.gmail.com>
	 <786fde50908020843l490725aar800d406bc8c6d636@mail.gmail.com>
Date: Sun, 2 Aug 2009 22:44:11 +0530
Message-ID: <ac6e61fc0908021014y48bdf844k1dd5c0ee99106ccb@mail.gmail.com>
Subject: Re: Weird behaviour
From: prashant ullegaddi <prashullegaddi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd2118235eda704702bc848
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd2118235eda704702bc848
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Yes, I'm sure that title:"Rahul Dravid" is extracted properly, and there is
a document relevant to this query as well.
The following query and its results proves it:

Enter query:
Searching for: +title:"rahul dravid" +url:wiki
4 total matching documents
   trec-id: clueweb09-enwp02-13-14368, URL:
http://en.wikipedia.org/wiki/Rahul_Dravid
   trec-id: clueweb09-enwp01-83-11378, URL:
http://en.wikipedia.org/wiki/Rahul_S_Dravid
   trec-id: clueweb09-en0011-08-22737, URL:
http://www.reference.com/browse/wiki/Rahul_Dravid
   trec-id: clueweb09-enwp01-69-13556, URL:
http://en.wikipedia.org/wiki/Rahul_Sharad_Dravid
Press (q)uit or enter number to jump to a page.

But see following query:

Enter query:
+title:"rahul dravid" +url:"wikipedia"
Searching for: +title:"rahul dravid" +url:wikipedia
0 total matching documents
Press (q)uit or enter number to jump to a page.

Isn't it weird?

-- Prashant.

On Sun, Aug 2, 2009 at 9:13 PM, Shai Erera <serera@gmail.com> wrote:

> How do you parse/convert the page to a Document object? Are you sure the
> title "Rahul Dravid" is extracted properly and put in the "title" field?
>
> You can read about Luke here: http://www.getopt.org/luke/.
>
> Can you do System.out.println(document.toString()) before you add it to the
> index, and paste the output here?
>
> Shai
>
> On Sun, Aug 2, 2009 at 4:47 PM, prashant ullegaddi <
> prashullegaddi@gmail.com
> > wrote:
>
> > Firstly, I'm indexing the string in url field only.
> >
> > I've never used Luke, I don't know how to use.
> >
> > What I'm trying to do is search for those documents which are from
> > some particular site, and have a given title.
> >
> >
> > On Sun, Aug 2, 2009 at 4:07 PM, Shai Erera <serera@gmail.com> wrote:
> >
> > > You write that you index the string under the "url" field. Do you also
> > > index
> > > it under "title"? If not, that can explain why title:"Rahul Dravid"
> does
> > > not
> > > work for you.
> > >
> > > Also, did you try to look at the index w/ Luke? It will show you what
> are
> > > the terms in the index.
> > >
> > > Another thing which is always good to debug such things is to create a
> > > StandardAnalyzer, then request a tokenStream() from it, passing a
> > > StringReader w/ the text you want to parse. Then just print the tokens
> > > returned.
> > >
> > > I've done that, using the version from trunk, w/ Version.2_4, and the
> > > tokens
> > > that are extracted are:
> > > (http,0,4,type=<ALPHANUM>)
> > > (en.wikipedia.org,7,23,type=<HOST>)
> > > (wiki,24,28,type=<ALPHANUM>)
> > > (rahul,29,34,type=<ALPHANUM>)
> > > (dravid,35,41,type=<ALPHANUM>)
> > >
> > > So:
> > > 1) You don't get results for title:"Rahul Dravid" since you index it
> > under
> > > "url" and not "title".
> > > 2) url:"wiki/Rahul_Dravid" works, since it looks for a phrase that
> exists
> > > in
> > > the index (look at the last 3 tokens produced by the Analyzer, in the
> > > output
> > > above).
> > > 3) ur:"<entire string" also works, since you index all of it under the
> > > "url"
> > > field.
> > >
> > > Does this explain the behavior you see?
> > >
> > > Shai
> > >
> > > On Sun, Aug 2, 2009 at 1:27 PM, prashant ullegaddi <
> > > prashullegaddi@gmail.com
> > > > wrote:
> > >
> > > > Hi,
> > > >
> > > > I've indexed some 50million documents. I've indexed the target URL of
> > > each
> > > > document as "url" field by using
> > > > StandardAnalyzer with index.ANALYZED. Suppose, there is a wikipedia
> > page
> > > > with title:"Rahul Dravid" and
> > > > url: http://en.wikipedia.org/wiki/Rahul_Dravid.
> > > >
> > > > But when I search for +title:"Rahul Dravid" +url:"Wikipedia", I'm
> > getting
> > > > no
> > > > results. I get the document(s) when
> > > > I search for url:http://en.wikipedia.org/wiki/Rahul_Dravid or url:"
> > > > en.wikipedia.org/wiki/Rahul_Dravid". I get
> > > > results even when I search for url:"wiki/Rahul_Dravid".
> > > >
> > > > It'd be helpful if somebody can throw some light on this.
> > > >
> > > > -- Prashant.
> > > >
> > >
> >
>

--000e0cd2118235eda704702bc848--

From java-user-return-41639-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 17:52:43 2009
Return-Path: <java-user-return-41639-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98789 invoked from network); 2 Aug 2009 17:52:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 17:52:43 -0000
Received: (qmail 36888 invoked by uid 500); 2 Aug 2009 17:52:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36812 invoked by uid 500); 2 Aug 2009 17:52:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36802 invoked by uid 99); 2 Aug 2009 17:52:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 17:52:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of phil123@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 17:52:35 +0000
Received: by ywh26 with SMTP id 26so3783130ywh.5
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 10:52:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=s3ZszrWnJuz/ek9M3HGRvsCvvU6DMIk4Jx7uHmXJWIo=;
        b=ExvvEE3kT0UBY1HfVziXHHp8SjPRCFx+NKY3anSxCq2heQ073XYbpfzSjMysEAZDzg
         nj5d/XrPfR5vp1NlJcYj/cp9hYWq9vreOP0xt1Nl5ES1Od8rDwUvkfWcBaD8EfwL4oYV
         s2fnj2eWSyrw5o84Z+mRRwzH2zUSSj8EKnjU0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=ty0YAmYMGCv8xh+yVzcNE3TTrugSrdHMcXcA2BBcckDeef5Gu+hYUsDvppGkSXQm4Y
         u2Ly1hNsyduH3LtkjD4fiA1BnFTA0LzByCelHbNKzGvvQ9Cu1II5+CUvY/9SG3CKw5Ml
         BVzOTzc1wALBeOBHRb+6B7KLGE0Hi34s8lAxM=
MIME-Version: 1.0
Received: by 10.100.9.3 with SMTP id 3mr5736698ani.154.1249235534920; Sun, 02 
	Aug 2009 10:52:14 -0700 (PDT)
In-Reply-To: <ac6e61fc0908021014y48bdf844k1dd5c0ee99106ccb@mail.gmail.com>
References: <ac6e61fc0908020327nb0a9ed1k560e9a0056ebeff4@mail.gmail.com>
	 <786fde50908020337n49ad648bxf6e125305c0dca4e@mail.gmail.com>
	 <ac6e61fc0908020647k696126e4r7722bcc0065f3f64@mail.gmail.com>
	 <786fde50908020843l490725aar800d406bc8c6d636@mail.gmail.com>
	 <ac6e61fc0908021014y48bdf844k1dd5c0ee99106ccb@mail.gmail.com>
Date: Sun, 2 Aug 2009 10:52:14 -0700
Message-ID: <9cafbc680908021052s6909b50cmb94f528a3a3f3780@mail.gmail.com>
Subject: Re: Weird behaviour
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Prashant,

I agree with Shai, that using Luke and printing out what the Document
looks like before it goes into the index, are going to be your best
bet for debugging this problem.

The problem you're having is that StandardAnalyzer does not break-up
the hostname into separate terms, as it has a special case for
hostnames and acronyms.

This should work...
+title:"rahul dravid" +url:"en.wikipedia.org"

Thanks,
Phil

On Sun, Aug 2, 2009 at 10:14 AM, prashant
ullegaddi<prashullegaddi@gmail.com> wrote:
> Yes, I'm sure that title:"Rahul Dravid" is extracted properly, and there =
is
> a document relevant to this query as well.
> The following query and its results proves it:
>
> Enter query:
> Searching for: +title:"rahul dravid" +url:wiki
> 4 total matching documents
> =A0 trec-id: clueweb09-enwp02-13-14368, URL:
> http://en.wikipedia.org/wiki/Rahul_Dravid
> =A0 trec-id: clueweb09-enwp01-83-11378, URL:
> http://en.wikipedia.org/wiki/Rahul_S_Dravid
> =A0 trec-id: clueweb09-en0011-08-22737, URL:
> http://www.reference.com/browse/wiki/Rahul_Dravid
> =A0 trec-id: clueweb09-enwp01-69-13556, URL:
> http://en.wikipedia.org/wiki/Rahul_Sharad_Dravid
> Press (q)uit or enter number to jump to a page.
>
> But see following query:
>
> Enter query:
> +title:"rahul dravid" +url:"wikipedia"
> Searching for: +title:"rahul dravid" +url:wikipedia
> 0 total matching documents
> Press (q)uit or enter number to jump to a page.
>
> Isn't it weird?
>
> -- Prashant.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41640-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 17:52:57 2009
Return-Path: <java-user-return-41640-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98897 invoked from network); 2 Aug 2009 17:52:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 17:52:57 -0000
Received: (qmail 38579 invoked by uid 500); 2 Aug 2009 17:53:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38518 invoked by uid 500); 2 Aug 2009 17:53:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38508 invoked by uid 99); 2 Aug 2009 17:53:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 17:53:00 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 17:52:49 +0000
Received: by ywh26 with SMTP id 26so3783214ywh.5
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 10:52:28 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.150.17 with SMTP id c17mr7558165ybo.336.1249235547959; 
	Sun, 02 Aug 2009 10:52:27 -0700 (PDT)
In-Reply-To: <9cafbc680908011003i7d7e8506u18b703a4ca0f8669@mail.gmail.com>
References: <9cafbc680907301111t4768704cy9e4b3092b3d74b17@mail.gmail.com>
	 <D8AF0747-AEC3-4E5F-AB52-EF62BA460529@mac.com>
	 <9ac0c6aa0907310234h798d406bg8cb23d620b022ef8@mail.gmail.com>
	 <161DCF62-1E03-4F1B-A590-76ADD91D5434@mac.com>
	 <9ac0c6aa0907311452q4f49f1aeua7314b6059b5973@mail.gmail.com>
	 <2BC00C69-41B3-48B3-83E7-CBC6DB452CCC@mac.com>
	 <9cafbc680907311701g7c8ff0f1n896c4bed2adda9c9@mail.gmail.com>
	 <090CF9D7-5D59-47A5-AD2A-86D4BEC6CD15@mac.com>
	 <9ac0c6aa0908010208g757a9936vd1150bdec47bc9e9@mail.gmail.com>
	 <9cafbc680908011003i7d7e8506u18b703a4ca0f8669@mail.gmail.com>
Date: Sun, 2 Aug 2009 13:52:27 -0400
Message-ID: <9ac0c6aa0908021052t585a2ae5wc8e3d3ad613e3ef9@mail.gmail.com>
Subject: Re: ThreadedIndexWriter vs. IndexWriter
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Woops sorry for the confusion!

Mike

On Sat, Aug 1, 2009 at 1:03 PM, Phil Whelan<phil123@gmail.com> wrote:
> Hi Mike,
>
> It's Jibo, not me, having the problem. But thanks for the link. I was
> interested to look at the code. Will be buying the book soon.
>
> Phil
>
> On Sat, Aug 1, 2009 at 2:08 AM, Michael McCandless
> <lucene@mikemccandless.com> wrote:
>>
>> (Please note that ThreadedIndexWriter is source code available with
>> the upcoming revision to Lucene in Action.)
>>
>> Phil, is it possible you are using an older version of the book's
>> source code? =A0In particular, can you check whether your version of
>> ThreadedIndexWriter.java has this:
>>
>> =A0public void close(boolean doWait) throws CorruptIndexException, IOExc=
eption {
>> =A0 =A0finish();
>> =A0 =A0super.close(doWait);
>> =A0}
>>
>> (I vaguely remember that being missing from earlier releases, which
>> could explain what you're seeing). =A0If you are missing that, can you
>> download the current code from http://www.manning.com/hatcher3 and try
>> again?
>>
>> If that's not the problem... can you post the benchmark alg you are
>> using in each case?
>>
>> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41641-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 17:59:01 2009
Return-Path: <java-user-return-41641-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1156 invoked from network); 2 Aug 2009 17:59:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 17:59:01 -0000
Received: (qmail 40968 invoked by uid 500); 2 Aug 2009 17:59:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40884 invoked by uid 500); 2 Aug 2009 17:59:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40874 invoked by uid 99); 2 Aug 2009 17:59:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 17:59:04 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of prashullegaddi@gmail.com designates 209.85.198.235 as permitted sender)
Received: from [209.85.198.235] (HELO rv-out-0506.google.com) (209.85.198.235)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 17:58:53 +0000
Received: by rv-out-0506.google.com with SMTP id b25so902210rvf.5
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 10:58:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=KehmsjEzBHQ/dNNvieG9tE5HxsKKG6ws7j5dyTbWZmA=;
        b=l+1VtUCQM49Dg7WIJuTdmkBRuYIblnr3jpF/Wjzqz6Zhps/XtSHPT0AMgKYfYfNOuI
         BtpdaRS5k/KR2vtXfsOGaT8jbTCgOwqFa+ZdaqQBjpZLXEEP6qLa4CuFIhJ1pL0ibR+K
         kG1Q3KwZJqrnwOZDWaQZaiBbV1lPPjWs3Lgqo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ABpJM8S/E4ZjpEwn/kt9MaL96/Lha7kRUiHWq73DgHZCFGgdHfENZRO+4//Io3fow0
         NfyM5/2gYgZVqJOL0tPan0zcqDWsbll6Lcro0c+PLwVvhuv2fbgOUM8puZQI8LYAEB2T
         e7VNaZ7KTvPXr9SLFVxZda6bENkw2byxx1TCA=
MIME-Version: 1.0
Received: by 10.140.247.13 with SMTP id u13mr3065240rvh.245.1249235913416; 
	Sun, 02 Aug 2009 10:58:33 -0700 (PDT)
In-Reply-To: <9cafbc680908021052s6909b50cmb94f528a3a3f3780@mail.gmail.com>
References: <ac6e61fc0908020327nb0a9ed1k560e9a0056ebeff4@mail.gmail.com>
	 <786fde50908020337n49ad648bxf6e125305c0dca4e@mail.gmail.com>
	 <ac6e61fc0908020647k696126e4r7722bcc0065f3f64@mail.gmail.com>
	 <786fde50908020843l490725aar800d406bc8c6d636@mail.gmail.com>
	 <ac6e61fc0908021014y48bdf844k1dd5c0ee99106ccb@mail.gmail.com>
	 <9cafbc680908021052s6909b50cmb94f528a3a3f3780@mail.gmail.com>
Date: Sun, 2 Aug 2009 23:28:33 +0530
Message-ID: <ac6e61fc0908021058q125f55d6jfe0ceee72ab25ec8@mail.gmail.com>
Subject: Re: Weird behaviour
From: prashant ullegaddi <prashullegaddi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd10626dc210f04702c6695
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd10626dc210f04702c6695
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Phil,

The query you gave did work. Well, that proves StandardAnalyzer has a
different way
of tokenizing URLs.

Thanks,
Prashant.

On Sun, Aug 2, 2009 at 11:22 PM, Phil Whelan <phil123@gmail.com> wrote:

> Hi Prashant,
>
> I agree with Shai, that using Luke and printing out what the Document
> looks like before it goes into the index, are going to be your best
> bet for debugging this problem.
>
> The problem you're having is that StandardAnalyzer does not break-up
> the hostname into separate terms, as it has a special case for
> hostnames and acronyms.
>
> This should work...
> +title:"rahul dravid" +url:"en.wikipedia.org"
>
> Thanks,
> Phil
>
> On Sun, Aug 2, 2009 at 10:14 AM, prashant
> ullegaddi<prashullegaddi@gmail.com> wrote:
> > Yes, I'm sure that title:"Rahul Dravid" is extracted properly, and there
> is
> > a document relevant to this query as well.
> > The following query and its results proves it:
> >
> > Enter query:
> > Searching for: +title:"rahul dravid" +url:wiki
> > 4 total matching documents
> >   trec-id: clueweb09-enwp02-13-14368, URL:
> > http://en.wikipedia.org/wiki/Rahul_Dravid
> >   trec-id: clueweb09-enwp01-83-11378, URL:
> > http://en.wikipedia.org/wiki/Rahul_S_Dravid
> >   trec-id: clueweb09-en0011-08-22737, URL:
> > http://www.reference.com/browse/wiki/Rahul_Dravid
> >   trec-id: clueweb09-enwp01-69-13556, URL:
> > http://en.wikipedia.org/wiki/Rahul_Sharad_Dravid
> > Press (q)uit or enter number to jump to a page.
> >
> > But see following query:
> >
> > Enter query:
> > +title:"rahul dravid" +url:"wikipedia"
> > Searching for: +title:"rahul dravid" +url:wikipedia
> > 0 total matching documents
> > Press (q)uit or enter number to jump to a page.
> >
> > Isn't it weird?
> >
> > -- Prashant.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd10626dc210f04702c6695--

From java-user-return-41642-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 17:59:09 2009
Return-Path: <java-user-return-41642-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1206 invoked from network); 2 Aug 2009 17:59:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 17:59:08 -0000
Received: (qmail 42690 invoked by uid 500); 2 Aug 2009 17:59:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42637 invoked by uid 500); 2 Aug 2009 17:59:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42627 invoked by uid 99); 2 Aug 2009 17:59:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 17:59:11 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.202.165.36] (HELO smtpauth20.prod.mesa1.secureserver.net) (64.202.165.36)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 02 Aug 2009 17:59:01 +0000
Received: (qmail 12965 invoked from network); 2 Aug 2009 17:58:39 -0000
Received: from unknown (81.219.54.251)
  by smtpauth20.prod.mesa1.secureserver.net (64.202.165.36) with ESMTP; 02 Aug 2009 17:58:38 -0000
Message-ID: <4A75D3C8.2000900@getopt.org>
Date: Sun, 02 Aug 2009 19:58:32 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 2.0.0.22 (Windows/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Weird discrepancy with term counts vs. terms (off by 1)
References: <20090802043224.9IQHT.16549.imail@eastrmwml37>	 <9cafbc680908020908u42e0f009l2e93995c8c17d15f@mail.gmail.com> <9cafbc680908020948s5dea6b63x1ce8ac1ff8cd0972@mail.gmail.com>
In-Reply-To: <9cafbc680908020948s5dea6b63x1ce8ac1ff8cd0972@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Phil Whelan wrote:
> Hi Jim,
> 
> On Sun, Aug 2, 2009 at 9:08 AM, Phil Whelan<phil123@gmail.com> wrote:
>>> So then, I reviewed the index using Luke, and what I saw with that was that there were indeed only 12 "path" terms (under "Term Count" on the left), but, when I clicked the "Show Top Terms" in Luke, there were 13 terms listed by Luke.
>> Yes, I just checked this and this seems to be a bug with Luke. It
>> always shows 1 less than in "Term Count" than it should. Well spotted.
> 
> I was able to see why this way happening in the Luke source and I've
> submitted the following patch to Andrzej, the author of Luke.
> 

Thank you Phil for spotting this bug - this fix will be included in the 
next release of Luke.


-- 
Best regards,
Andrzej Bialecki     <><
  ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41643-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 18:04:09 2009
Return-Path: <java-user-return-41643-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4370 invoked from network); 2 Aug 2009 18:04:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 18:04:08 -0000
Received: (qmail 51017 invoked by uid 500); 2 Aug 2009 18:04:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50963 invoked by uid 500); 2 Aug 2009 18:04:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50953 invoked by uid 99); 2 Aug 2009 18:04:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 18:04:11 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 18:04:02 +0000
Received: by yxe3 with SMTP id 3so3625130yxe.29
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 11:03:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=v3pWf72vgMxaiE1VSvhwDjQpi1LTIk7Tk4Q/BcdTC2U=;
        b=XRbnSQjGO4n10QrIIx9ePljCX+hS5nJdkU6/IsTE7ESTGqnGAH+UyPJTk68kNHvo5b
         h468b+/Elr+W3jZ3c0Q54S7+bkjBQTxhqNTCJca5y4mqb6CHMUT8i2HCNaF/e4wUNY1i
         aDp+bWVeg6bHjJEp/zq6aNiyMKRWHMlfOPiYE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=F0I+DpaCS3f2K3bCwa5yLKh2aYOpzzhki80x45NEzIc6G2hg6HhnATUq+b3pDMwJD/
         A8AImyQCgbIg+dP5/HbG5h52jhjo9fbTn4B2h6Ai5PbyRwSIcepgbFY8YEvbft2sw0yg
         hSglKCx+ukal99zR9U/u8EApbhBwQ184dhD1c=
MIME-Version: 1.0
Received: by 10.101.70.14 with SMTP id x14mr5692028ank.78.1249236221681; Sun, 
	02 Aug 2009 11:03:41 -0700 (PDT)
In-Reply-To: <4A75D3C8.2000900@getopt.org>
References: <20090802043224.9IQHT.16549.imail@eastrmwml37>
	 <9cafbc680908020908u42e0f009l2e93995c8c17d15f@mail.gmail.com>
	 <9cafbc680908020948s5dea6b63x1ce8ac1ff8cd0972@mail.gmail.com>
	 <4A75D3C8.2000900@getopt.org>
Date: Sun, 2 Aug 2009 11:03:41 -0700
Message-ID: <9cafbc680908021103r46722338u2cda1bd9dac00e49@mail.gmail.com>
Subject: Re: Weird discrepancy with term counts vs. terms (off by 1)
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Sun, Aug 2, 2009 at 10:58 AM, Andrzej Bialecki<ab@getopt.org> wrote:
> Thank you Phil for spotting this bug - this fix will be included in the next
> release of Luke.

Glad to help. Thanks for building this great tool!

Phil

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41644-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 18:20:55 2009
Return-Path: <java-user-return-41644-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16481 invoked from network); 2 Aug 2009 18:20:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 18:20:55 -0000
Received: (qmail 60284 invoked by uid 500); 2 Aug 2009 18:20:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60203 invoked by uid 500); 2 Aug 2009 18:20:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60193 invoked by uid 99); 2 Aug 2009 18:20:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 18:20:58 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 18:20:47 +0000
Received: by ewy26 with SMTP id 26so3588636ewy.5
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 11:20:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=zNvUohm6f8hHsib/Hb/frOXYZVd0Q0mHn7bomDwwgTY=;
        b=YzjZaFRFpgf1Yyr4rzE/0emzB5ILN9KuLJ/AFh1uwC/qQJtakM6iOdxE6FZHQX3Ctx
         7SaI6I+2PF67S3DucoGAa8Qy613EQT9kMZq0KvWBPl+U/xdXLolyzhdNXjmiTuMatvEI
         evTPRkfy7hhYoPABOtUymo753QTOcbAqnbBrM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=jadVFtPxcw5rFpkqnSI7ZRliAcb2Hn2zvXu/2oQufcsxKgLraYLAnuiBiUylidkW55
         Igp7Shu2f+X/RrgerSKze3VW5sXC8wlHYtbNSxhF/cWajebd9XeD/OmYnyKw9ssqqRRA
         2YJY/xYNYO55YecdMqtFiOXQojsiWcPLv9hH4=
MIME-Version: 1.0
Received: by 10.216.87.140 with SMTP id y12mr997211wee.4.1249237225683; Sun, 
	02 Aug 2009 11:20:25 -0700 (PDT)
In-Reply-To: <ac6e61fc0908021058q125f55d6jfe0ceee72ab25ec8@mail.gmail.com>
References: <ac6e61fc0908020327nb0a9ed1k560e9a0056ebeff4@mail.gmail.com>
	 <786fde50908020337n49ad648bxf6e125305c0dca4e@mail.gmail.com>
	 <ac6e61fc0908020647k696126e4r7722bcc0065f3f64@mail.gmail.com>
	 <786fde50908020843l490725aar800d406bc8c6d636@mail.gmail.com>
	 <ac6e61fc0908021014y48bdf844k1dd5c0ee99106ccb@mail.gmail.com>
	 <9cafbc680908021052s6909b50cmb94f528a3a3f3780@mail.gmail.com>
	 <ac6e61fc0908021058q125f55d6jfe0ceee72ab25ec8@mail.gmail.com>
Date: Sun, 2 Aug 2009 21:20:25 +0300
Message-ID: <786fde50908021120i1303b5edn4b78c3467e412134@mail.gmail.com>
Subject: Re: Weird behaviour
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d5667a13bd2c04702cb543
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d5667a13bd2c04702cb543
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

You can always create your own Analyzer which creates a TokenStream just
like StandardAnalyzer, but instead of using StandardFilter, write another
TokenFilter which receives the HOST token type, and breaks it further to its
components (e.g., extract "en", "wikipedia" and "org"). You can also return
the original HOST token and its components.

I hope this helps.

Shai

On Sun, Aug 2, 2009 at 8:58 PM, prashant ullegaddi <prashullegaddi@gmail.com
> wrote:

> Hi Phil,
>
> The query you gave did work. Well, that proves StandardAnalyzer has a
> different way
> of tokenizing URLs.
>
> Thanks,
> Prashant.
>
> On Sun, Aug 2, 2009 at 11:22 PM, Phil Whelan <phil123@gmail.com> wrote:
>
> > Hi Prashant,
> >
> > I agree with Shai, that using Luke and printing out what the Document
> > looks like before it goes into the index, are going to be your best
> > bet for debugging this problem.
> >
> > The problem you're having is that StandardAnalyzer does not break-up
> > the hostname into separate terms, as it has a special case for
> > hostnames and acronyms.
> >
> > This should work...
> > +title:"rahul dravid" +url:"en.wikipedia.org"
> >
> > Thanks,
> > Phil
> >
> > On Sun, Aug 2, 2009 at 10:14 AM, prashant
> > ullegaddi<prashullegaddi@gmail.com> wrote:
> > > Yes, I'm sure that title:"Rahul Dravid" is extracted properly, and
> there
> > is
> > > a document relevant to this query as well.
> > > The following query and its results proves it:
> > >
> > > Enter query:
> > > Searching for: +title:"rahul dravid" +url:wiki
> > > 4 total matching documents
> > >   trec-id: clueweb09-enwp02-13-14368, URL:
> > > http://en.wikipedia.org/wiki/Rahul_Dravid
> > >   trec-id: clueweb09-enwp01-83-11378, URL:
> > > http://en.wikipedia.org/wiki/Rahul_S_Dravid
> > >   trec-id: clueweb09-en0011-08-22737, URL:
> > > http://www.reference.com/browse/wiki/Rahul_Dravid
> > >   trec-id: clueweb09-enwp01-69-13556, URL:
> > > http://en.wikipedia.org/wiki/Rahul_Sharad_Dravid
> > > Press (q)uit or enter number to jump to a page.
> > >
> > > But see following query:
> > >
> > > Enter query:
> > > +title:"rahul dravid" +url:"wikipedia"
> > > Searching for: +title:"rahul dravid" +url:wikipedia
> > > 0 total matching documents
> > > Press (q)uit or enter number to jump to a page.
> > >
> > > Isn't it weird?
> > >
> > > -- Prashant.
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--0016e6d5667a13bd2c04702cb543--

From java-user-return-41645-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 18:39:44 2009
Return-Path: <java-user-return-41645-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21477 invoked from network); 2 Aug 2009 18:39:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 18:39:44 -0000
Received: (qmail 74598 invoked by uid 500); 2 Aug 2009 18:39:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74542 invoked by uid 500); 2 Aug 2009 18:39:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74532 invoked by uid 99); 2 Aug 2009 18:39:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 18:39:47 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of prashullegaddi@gmail.com designates 209.85.216.189 as permitted sender)
Received: from [209.85.216.189] (HELO mail-px0-f189.google.com) (209.85.216.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 18:39:36 +0000
Received: by pxi27 with SMTP id 27so2171389pxi.20
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 11:39:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=nFnzSjKDk62504WlJW5+iGWzcx/MAc04wbKchcUJz8Q=;
        b=KBnBFQjV6iUpgR/PEhrjLC+vcdG4ETktelSHQ5CIzwQeQ/ZMXq5PJGYw0BecLtzcWM
         e8EhBH0Eo/1O66NF/oCZTw/BPKc1faHBHiI5Qgqf3Ysr3416c0y1rLOldsYxCeS+5ukw
         +f2ilpT1PySIJfRueq+XcZ4A6w+fpUo+pMzD4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=FiXh1ARzpxgrnCdxh9v9BNsZ0Xv8e3od38JvEtMhEFmtEPkNNI9PMpFJocdcTDJnx6
         QemMVcU5iH+gcFI9UU9p9J0ISvUb6X3u+ZlUJa+JQVnCQo4pkRCfektiFKCLA4LAsml9
         bBve9e3q1T19cYSV5yXynILDfKHZmNvf8h+ho=
MIME-Version: 1.0
Received: by 10.140.169.4 with SMTP id r4mr3149679rve.265.1249238356225; Sun, 
	02 Aug 2009 11:39:16 -0700 (PDT)
In-Reply-To: <786fde50908021120i1303b5edn4b78c3467e412134@mail.gmail.com>
References: <ac6e61fc0908020327nb0a9ed1k560e9a0056ebeff4@mail.gmail.com>
	 <786fde50908020337n49ad648bxf6e125305c0dca4e@mail.gmail.com>
	 <ac6e61fc0908020647k696126e4r7722bcc0065f3f64@mail.gmail.com>
	 <786fde50908020843l490725aar800d406bc8c6d636@mail.gmail.com>
	 <ac6e61fc0908021014y48bdf844k1dd5c0ee99106ccb@mail.gmail.com>
	 <9cafbc680908021052s6909b50cmb94f528a3a3f3780@mail.gmail.com>
	 <ac6e61fc0908021058q125f55d6jfe0ceee72ab25ec8@mail.gmail.com>
	 <786fde50908021120i1303b5edn4b78c3467e412134@mail.gmail.com>
Date: Mon, 3 Aug 2009 00:09:16 +0530
Message-ID: <ac6e61fc0908021139r3bc8430bj3fc0854e7da2c2f3@mail.gmail.com>
Subject: Re: Weird behaviour
From: prashant ullegaddi <prashullegaddi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd2c0e0766ddf04702cf86a
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd2c0e0766ddf04702cf86a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thank you Phil and Shai.

I will write a different Analyzer.

On Sun, Aug 2, 2009 at 11:50 PM, Shai Erera <serera@gmail.com> wrote:

> You can always create your own Analyzer which creates a TokenStream just
> like StandardAnalyzer, but instead of using StandardFilter, write another
> TokenFilter which receives the HOST token type, and breaks it further to
> its
> components (e.g., extract "en", "wikipedia" and "org"). You can also return
> the original HOST token and its components.
>
> I hope this helps.
>
> Shai
>
> On Sun, Aug 2, 2009 at 8:58 PM, prashant ullegaddi <
> prashullegaddi@gmail.com
> > wrote:
>
> > Hi Phil,
> >
> > The query you gave did work. Well, that proves StandardAnalyzer has a
> > different way
> > of tokenizing URLs.
> >
> > Thanks,
> > Prashant.
> >
> > On Sun, Aug 2, 2009 at 11:22 PM, Phil Whelan <phil123@gmail.com> wrote:
> >
> > > Hi Prashant,
> > >
> > > I agree with Shai, that using Luke and printing out what the Document
> > > looks like before it goes into the index, are going to be your best
> > > bet for debugging this problem.
> > >
> > > The problem you're having is that StandardAnalyzer does not break-up
> > > the hostname into separate terms, as it has a special case for
> > > hostnames and acronyms.
> > >
> > > This should work...
> > > +title:"rahul dravid" +url:"en.wikipedia.org"
> > >
> > > Thanks,
> > > Phil
> > >
> > > On Sun, Aug 2, 2009 at 10:14 AM, prashant
> > > ullegaddi<prashullegaddi@gmail.com> wrote:
> > > > Yes, I'm sure that title:"Rahul Dravid" is extracted properly, and
> > there
> > > is
> > > > a document relevant to this query as well.
> > > > The following query and its results proves it:
> > > >
> > > > Enter query:
> > > > Searching for: +title:"rahul dravid" +url:wiki
> > > > 4 total matching documents
> > > >   trec-id: clueweb09-enwp02-13-14368, URL:
> > > > http://en.wikipedia.org/wiki/Rahul_Dravid
> > > >   trec-id: clueweb09-enwp01-83-11378, URL:
> > > > http://en.wikipedia.org/wiki/Rahul_S_Dravid
> > > >   trec-id: clueweb09-en0011-08-22737, URL:
> > > > http://www.reference.com/browse/wiki/Rahul_Dravid
> > > >   trec-id: clueweb09-enwp01-69-13556, URL:
> > > > http://en.wikipedia.org/wiki/Rahul_Sharad_Dravid
> > > > Press (q)uit or enter number to jump to a page.
> > > >
> > > > But see following query:
> > > >
> > > > Enter query:
> > > > +title:"rahul dravid" +url:"wikipedia"
> > > > Searching for: +title:"rahul dravid" +url:wikipedia
> > > > 0 total matching documents
> > > > Press (q)uit or enter number to jump to a page.
> > > >
> > > > Isn't it weird?
> > > >
> > > > -- Prashant.
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
>

--000e0cd2c0e0766ddf04702cf86a--

From java-user-return-41646-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 19:08:29 2009
Return-Path: <java-user-return-41646-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25708 invoked from network); 2 Aug 2009 19:08:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 19:08:29 -0000
Received: (qmail 96898 invoked by uid 500); 2 Aug 2009 19:08:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96807 invoked by uid 500); 2 Aug 2009 19:08:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96797 invoked by uid 99); 2 Aug 2009 19:08:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 19:08:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.132.246 as permitted sender)
Received: from [209.85.132.246] (HELO an-out-0708.google.com) (209.85.132.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 19:08:22 +0000
Received: by an-out-0708.google.com with SMTP id b2so1379638ana.5
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 12:08:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=5D/lhUYH95loZsNw0i+YneIpbb8PV6PXTOboquv37QU=;
        b=PZYRlpk9zJCJFTCBgoI7jdyRFOhvlV2+jYe8bUM7phIiYXWDYV+fLquAvGhjuqkyIU
         sigaJ9LdfwPg/vQRBGlcXhfj4rHobugDcUkXYJtAZMWl43lDFSbHPIRiEtDfIPT8kl3C
         ZAtTEhMzAzP0u7G2Cbc7+R1hjOiv6/w6dNEmg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=hIlVgI2akeGO7VYErCyKxpPmYGofSZ6He2CFOMP7PEqLQhla2QLy/xaFFzhTqPZJgq
         agQWecUc3wcA42uLxS8xnyJWD+6UzwLwvy/m1u03SlRgwVUd2YNqY9/EcfMUCSEVnUUu
         cc3P3qp+6dJB6KnMmC3Zbf6762G1tOLorkpUA=
MIME-Version: 1.0
Received: by 10.100.58.12 with SMTP id g12mr6946393ana.70.1249240081580; Sun, 
	02 Aug 2009 12:08:01 -0700 (PDT)
In-Reply-To: <1249172239.5261.4.camel@mine-lenovo>
References: <1248348847.5882.12.camel@mine-lenovo>
	 <8f0ad1f30907230633i4eef7bc2n58a463c446e6d4e5@mail.gmail.com>
	 <1248422813.5499.6.camel@mine-lenovo>
	 <8f0ad1f30907240539q5f2e3dbak9b90704ded96ed77@mail.gmail.com>
	 <1249172239.5261.4.camel@mine-lenovo>
Date: Sun, 2 Aug 2009 15:08:01 -0400
Message-ID: <8f0ad1f30908021208k34cb5223nd5cd9c6f93ee038d@mail.gmail.com>
Subject: Re: arabic analyzer
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

> the fact is, plural (as an example) is not supported, and that is one of
> the most common things that a person doing some search will expect to

Walid, I'm not sure this is true. Many plurals are supported
(certainly not exceptional cases or broken plurals).
This is no different than the other language analyzers in lucene, even
english stemmers: the most common forms are grouped together and thats
about all you can say :)

maybe in the future we can improve it though for your particular
concern, add simple dictionary mappings for at least the most common
broken plurals, something like that.

-- 
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41647-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 19:12:40 2009
Return-Path: <java-user-return-41647-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26325 invoked from network); 2 Aug 2009 19:12:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 19:12:40 -0000
Received: (qmail 99959 invoked by uid 500); 2 Aug 2009 19:12:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99880 invoked by uid 500); 2 Aug 2009 19:12:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99870 invoked by uid 99); 2 Aug 2009 19:12:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 19:12:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.8] (HELO eastrmmtao102.cox.net) (68.230.240.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 19:12:33 +0000
Received: from eastrmimpo02.cox.net ([68.1.16.120])
          by eastrmmtao102.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090802191212.QYFI22890.eastrmmtao102.cox.net@eastrmimpo02.cox.net>;
          Sun, 2 Aug 2009 15:12:12 -0400
Received: from eastrmwml42 ([172.18.18.217])
	by eastrmimpo02.cox.net with bizsmtp
	id PXCB1c00G4h0NJL02XCBoo; Sun, 02 Aug 2009 15:12:11 -0400
X-VR-Score: -230.00
X-Authority-Analysis: v=1.0 c=1 a=OUoN0dqCuiIA:10 a=pGLkceISAAAA:8
 a=kviXuzpPAAAA:8 a=mV9VRH-2AAAA:8 a=N0LYuqa9cBqrjFFhcNoA:9
 a=lqIivfxqLMYi0Xe5YJEA:7 a=I8p6iX3cpoBh2QKNVYCV74HPR4kA:4 a=MSl-tDqOz04A:10
 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Sun, 2 Aug 2009 15:12:12 -0400
Message-ID: <20090802151212.GBMYU.20255.imail@eastrmwml42>
Date: Sun, 2 Aug 2009 15:12:12 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Weird discrepancy with term counts vs. terms (off by 1)
Cc: Phil Whelan <phil123@gmail.com>
In-Reply-To: <9cafbc680908020908u42e0f009l2e93995c8c17d15f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Phil,

For problem with my app, it wasn't what you suggested (about the tokens, etc.).

For some later things, my indexer creates both a "path" field that is analyzed (and thus tokenized, etc.) and another field, "fullpath", which is not analyzed (and thus, not tokenized).

The problem with my app was that I was create a TermEnum:

Term term = new Term("fullpath", "");
termsEnumerator = reader.terms(term);

and then going immediately into a while loop:

while (termsEnumerator.next()) {
.
.
}

i.e., I was ignoring the 1st term in the TermEnum (since the .next() bumps the TermEnum to the 2nd term, initially).

Anyway, so the code that I ended up with is:

try {
System.out.println("Outside while: About to get 1st termsEnumerator.term()...");
currentTerm = termsEnumerator.term();
currentField = currentTerm.field();
termpathcount++;
System.out.println("Outside while: 1st Field = [" + currentField + "] Term = [" + currentTerm.text() + "]");
System.out.println("Outside while: About to drop into while()...");
while (termsEnumerator.next()) {
	currentTerm = termsEnumerator.term();
	currentField = currentTerm.field();
	if (currentField.equalsIgnoreCase("fullpath")) {
		termpathcount++;
		System.out.println("Count=" + termpathcount + " Field = [" + currentField + "] Term = [" + currentTerm.text() + "]");
	}
} // end while()

termsEnumerator.close();
System.out.println("Matching terms count = " + termpathcount);
} catch (Exception e) {
	System.out.println("** ERROR **: Exception while stepping through index: [" + e + "]");
	e.printStackTrace();
	}

and, that seems to be working perfectly.

Also, thanks for following up re. that Luke problem.  That was one piece of this "puzzle" that was kind of driving me batty :)!!

Jim



---- Phil Whelan <phil123@gmail.com> wrote: 
> Hi Jim,
> 
> On Sun, Aug 2, 2009 at 1:32 AM, <ohaya@cox.net> wrote:
> > I first noticed the problem that I'm seeing while working on this latter app.  Basically, what I noticed was that while I was adding 13 documents to the index, when I listed the "path" terms, there were only 12 of them.
> 
> Field text (the whole "path" in your case) and terms (the tokens of
> the field text) are different.
> 
> The StandardAnalyzer breaks up words like this...
> Field text = "/a/b/c.txt"
> Tokens = {"a","b","c","txt"}
> 
> So this 1 field of 1 document become 4 terms / tokens (not sure if
> there is a difference in this terminology between "terms" and "tokens"
> sorry).
> Therefore, you're going to have more terms than documents initially,
> but as the overlap in term usage increases this changes.
> 
> For instance, these 3 paths
> "/a/b/c/d.txt","/b/c/d/a.txt","/c/d/a/b.txt" are still only a total of
> 4 terms, since they share the same terms.
> 
> In fact, StandardAnalyzer goes a bit further than that and removes
> "stop-words", such as "a" (or "an", "the") as it's designed for
> general text searching.
> 
> That said, I think you have a point with the next part of your question...
> 
> > So then, I reviewed the index using Luke, and what I saw with that was that there were indeed only 12 "path" terms (under "Term Count" on the left), but, when I clicked the "Show Top Terms" in Luke, there were 13 terms listed by Luke.
> 
> Yes, I just checked this and this seems to be a bug with Luke. It
> always shows 1 less than in "Term Count" than it should. Well spotted.
> 
> Cheers,
> Phil
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41648-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 19:16:05 2009
Return-Path: <java-user-return-41648-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26769 invoked from network); 2 Aug 2009 19:16:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 19:16:05 -0000
Received: (qmail 3707 invoked by uid 500); 2 Aug 2009 19:16:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3633 invoked by uid 500); 2 Aug 2009 19:16:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3623 invoked by uid 99); 2 Aug 2009 19:16:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 19:16:08 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.8] (HELO eastrmmtao102.cox.net) (68.230.240.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 19:15:58 +0000
Received: from eastrmimpo02.cox.net ([68.1.16.120])
          by eastrmmtao102.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090802191538.QZIY22890.eastrmmtao102.cox.net@eastrmimpo02.cox.net>;
          Sun, 2 Aug 2009 15:15:38 -0400
Received: from eastrmwml42 ([172.18.18.217])
	by eastrmimpo02.cox.net with bizsmtp
	id PXFd1c00B4h0NJL02XFdTZ; Sun, 02 Aug 2009 15:15:37 -0400
X-VR-Score: -100.00
X-Authority-Analysis: v=1.0 c=1 a=0VJv2cbyVxsA:10 a=pGLkceISAAAA:8
 a=kviXuzpPAAAA:8 a=mV9VRH-2AAAA:8 a=9I5xiGouAAAA:8 a=HVCb-Z0geqLCYqqxaRsA:9
 a=RSOcG1oysqmhd8OOYY8A:7 a=yyg5JDXP_7wMnb54orewxbbHM6IA:4 a=hwWbZOZYdvYA:10
 a=2fPOlPt4dusA:10 a=MSl-tDqOz04A:10 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Sun, 2 Aug 2009 15:15:37 -0400
Message-ID: <20090802151537.0P9G0.20294.imail@eastrmwml42>
Date: Sun, 2 Aug 2009 15:15:37 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: java.io.IOException when trying to list terms in index
 (IndexReader)
Cc: se3g2011 <se3g2011@gmail.com>
In-Reply-To: <24775753.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I thought that, in the code that I posted, there was a close() in the final=
ly?

Or, are you saying that when an IndexReader is opened, that that somehow pe=
rsists in the system, even past my Java app terminating?

FYI, I'm doing this testing on Windows, under Eclipse...

Jim



---- se3g2011 <se3g2011@gmail.com> wrote:=20
>=20
> hi,as you the error messages you listed below,pls put the 'reader.close()=
'
> block to the bottom of method.
> i think,if you invoke it first,the infrastructure stream is closed ,so
> exceptions is encountered.
>=20
>=20
> ohaya wrote:
> >=20
> > Hi,
> >=20
> > I changed the beginning of the try to:
> >=20
> > =09=09try {
> > =09=09=09System.out.println("About to call .next()...");
> > =09=09=09boolean foo =3D termsEnumerator.next();
> > =09=09=09System.out.println("Finished calling first .next()");
> > =09=09=09System.out.println("About to drop into while()...");
> > .
> > .
> > .
> >=20
> > and here's what I got when I ran the app:
> >=20
> > Index in directory :[C:\lucene-devel\lucene-devel\index] was opened
> > successfully!
> > About to call .next()...
> > ** ERROR **: Exception while stepping through index: [java.io.IOExcepti=
on:
> > The handle is invalid]
> > java.io.IOException: The handle is invalid
> > =09at java.io.RandomAccessFile.seek(Native Method)
> > =09at
> > org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirecto=
ry.java:591)
> > =09at
> > org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput=
.java:136)
> > =09at
> > org.apache.lucene.index.CompoundFileReader$CSIndexInput.readInternal(Co=
mpoundFileReader.java:247)
> > =09at
> > org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.ja=
va:157)
> > =09at
> > org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.=
java:38)
> > =09at org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
> > =09at org.apache.lucene.index.TermBuffer.read(TermBuffer.java:64)
> > =09at org.apache.lucene.index.SegmentTermEnum.next(SegmentTermEnum.java=
:127)
> > =09at ReadIndex.main(ReadIndex.java:29)
> >=20
> > Jim
> >=20
> > ---- ohaya@cox.net wrote:=20
> >> Hi,
> >>=20
> >> BTW, the next() method is an abstract method in the Javadocs.  Does th=
at
> >> mean that I'm suppose to have my own implementation?
> >>=20
> >> Jim
> >>=20
> >>=20
> >> ---- ohaya@cox.net wrote:=20
> >> > Phil,
> >> >=20
> >> > I posted in haste.  Actually, from the output that I posted, doesn't=
 it
> >> it look like the .next() itself is throwing the exception?
> >> >=20
> >> > That is what has been puzzling me.  It looks like it got through the
> >> open() and terms() with no problem, then it blew up when calling the
> >> next()?
> >> >=20
> >> > Jim
> >> >=20
> >> >=20
> >> > ---- ohaya@cox.net wrote:=20
> >> > > Phil,
> >> > >=20
> >> > > Yes, that exception is not very helpful :)!!
> >> > >=20
> >> > > I'll try your suggestions and post back.
> >> > >=20
> >> > > Thanks,
> >> > > Jim
> >> > >=20
> >> > >=20
> >> > > ---- Phil Whelan <phil123@gmail.com> wrote:=20
> >> > > > Hi Jim,
> >> > > >=20
> >> > > > I cannot see anything obvious, but both open() and terms() throw
> >> > > > IOException's. You could try putting these in separate try..catc=
h
> >> > > > blocks to see which one it's coming from. Or using
> >> e.printStackTrace()
> >> > > > in the catch block will give more info to help you debug what's
> >> > > > happening.
> >> > > >=20
> >> > > > On Sat, Aug 1, 2009 at 7:09 PM, <ohaya@cox.net> wrote:
> >> > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0=
 =C2=A0 =C2=A0 =C2=A0reader =3D IndexReader.open(args[0]);
> >> > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0=
 =C2=A0 =C2=A0 =C2=A0Term term =3D new Term("path", "");
> >> > > > > =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0=
 =C2=A0 =C2=A0 =C2=A0termsEnumerator =3D reader.terms(term);
> >> > > >=20
> >> > > > Cheers,
> >> > > > Phil
> >> > > >=20
> >> > > >
> >> ---------------------------------------------------------------------
> >> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > > > For additional commands, e-mail: java-user-help@lucene.apache.or=
g
> >> > > >=20
> >> > >=20
> >> > >=20
> >> > > ------------------------------------------------------------------=
---
> >> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> > >=20
> >> >=20
> >> >=20
> >> > --------------------------------------------------------------------=
-
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >=20
> >>=20
> >>=20
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>=20
> >=20
> >=20
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >=20
> >=20
> >=20
>=20
> --=20
> View this message in context: http://www.nabble.com/java.io.IOException-w=
hen-trying-to-list-terms-in-index-%28IndexReader%29-tp24774351p24775753.htm=
l
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41649-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 19:29:25 2009
Return-Path: <java-user-return-41649-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29547 invoked from network); 2 Aug 2009 19:29:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 19:29:25 -0000
Received: (qmail 10619 invoked by uid 500); 2 Aug 2009 19:29:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10531 invoked by uid 500); 2 Aug 2009 19:29:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10520 invoked by uid 99); 2 Aug 2009 19:29:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 19:29:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of phil123@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 19:29:20 +0000
Received: by ywh26 with SMTP id 26so3816552ywh.5
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 12:28:59 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:cc:content-type
         :content-transfer-encoding;
        bh=VKIbvpcTFz98TP5pqn8mXvPraK5tnY0yC2ivM34LBMk=;
        b=sXmsLnKxE2ZFBvL6zqGU2yeV8oLfZCUQ6UxF1i2qKSGejgA7OwGPelyxWJOSSEZgfq
         rJA+Z+5kQ0wgccyDspl5ut0DEEzqNJ9CU5kgO2H4yVayGBXuA90lDFc8Junp+Ou70iFI
         JjSu1hCjvNv3kuGO50S3whav2ZgpvMpOO64SE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type:content-transfer-encoding;
        b=JDYaQZ1zjBIJRjfqr8lz9ZnTVIOAuQK0CCmzBRYitd2L3F9gYbBkWwdJT7w7+axqvD
         AH7fzQszLN9eX6Kcr3rGUmzZ0WHAwmFMyq5nAzxNcgXOHp5Auf4p8KlHEml88+/hLYAD
         7buH/ugL4QUVAIsw7OaFU321a2mdtqyL4qYPA=
MIME-Version: 1.0
Received: by 10.100.167.20 with SMTP id p20mr5738634ane.80.1249241339586; Sun, 
	02 Aug 2009 12:28:59 -0700 (PDT)
In-Reply-To: <20090802151212.GBMYU.20255.imail@eastrmwml42>
References: <9cafbc680908020908u42e0f009l2e93995c8c17d15f@mail.gmail.com>
	 <20090802151212.GBMYU.20255.imail@eastrmwml42>
Date: Sun, 2 Aug 2009 12:28:59 -0700
Message-ID: <9cafbc680908021228t258786d4t7819a2303f601b31@mail.gmail.com>
Subject: Re: Weird discrepancy with term counts vs. terms (off by 1)
From: Phil Whelan <phil123@gmail.com>
To: ohaya@cox.net
Cc: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Jim,

On Sun, Aug 2, 2009 at 12:12 PM, <ohaya@cox.net> wrote:
> i.e., I was ignoring the 1st term in the TermEnum (since the .next() bumps the TermEnum to the 2nd term, initially).

Great! Glad you found the problem. I couldn't see it.

Phil

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41650-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 21:28:51 2009
Return-Path: <java-user-return-41650-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51877 invoked from network); 2 Aug 2009 21:28:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 21:28:51 -0000
Received: (qmail 75947 invoked by uid 500); 2 Aug 2009 21:28:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75853 invoked by uid 500); 2 Aug 2009 21:28:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75843 invoked by uid 99); 2 Aug 2009 21:28:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 21:28:54 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 21:28:44 +0000
Received: by yxe3 with SMTP id 3so3711302yxe.29
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 14:28:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=c621dSuP/Y4DUpK4L6el+Ty96EvfN9m4f2xUPyoWK4Y=;
        b=qvBs4qg9USVxIUHT3AgYpnkdq/wUXq/313gj7PS1+Le8fFWwDZKmP+6/4YnkQObMBb
         LqqQY2FGgf+zQshlPzKDpfivUi7ndbnhL+5Bc0bfZXehfBLaRbljfkmUBJDdGkV1tkrJ
         Krux1EvEan0cSNw3I0gpHgj8DBQRstXFoU3Nw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=GQDn2H/M+V85oHYA8UNdSg/V9O7Dr2v4mNIuQUSnGqrKAM+FjAKYs+N7fh661P04JO
         XO0T/W77m7yF/T99/OXTXXrVusu0kgoOrJI9iNWJfnapswm/9ro1YJYDAkd+yt+sEfLK
         pi06p3DZvEPjXkE3LYwf2ROUs+glX7riuXyoQ=
MIME-Version: 1.0
Received: by 10.231.11.136 with SMTP id t8mr1263782ibt.50.1249248503123; Sun, 
	02 Aug 2009 14:28:23 -0700 (PDT)
In-Reply-To: <20090802151537.0P9G0.20294.imail@eastrmwml42>
References: <24775753.post@talk.nabble.com>
	 <20090802151537.0P9G0.20294.imail@eastrmwml42>
Date: Sun, 2 Aug 2009 17:28:23 -0400
Message-ID: <359a92830908021428r7636997w72d12b5f8cfad9@mail.gmail.com>
Subject: Re: java.io.IOException when trying to list terms in index 
	(IndexReader)
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000325574c1643d21a04702f55b5
X-Virus-Checked: Checked by ClamAV on apache.org

--000325574c1643d21a04702f55b5
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I've seen Eclipse get into weird states, but I don't think that's your
problem.

You open the IndexReader and set up a TermEnum on it. Then, no matter
what you close the underlying IndexReader in the finally block. Then later
you use the TermEnum *even though the underlying reader has been closed*.
You want something like
try {
  open reader
  set up TermEnum
  enumerate terms
  close termEnum
 } catch () {
}
finally {
close reader
}

Getting an IO exception isn't at all strange in this situation, and exactly
when
you throw the exception is indeterminate.

See below.
public class ReadIndex {

       public static void main(String[] args) {
               IndexReader reader = null;
               TermEnum termsEnumerator = null;
               Term currentTerm = null;

               try {
                       reader = IndexReader.open(args[0]);
                       Term term = new Term("path", "");
                       termsEnumerator = reader.terms(term);
               } catch (IOException e) {
                       System.out.println("** ERROR **: Exception when
opened IndexReader: [" + e + "]");
               } finally {
**********
Why close the reader here? You need it later I think.
**********
                       try { reader.close(); } catch (IOException e) { /*
suck it up */ }
               }

               System.out.println("Index in directory :[" + args[0] + "] was
opened successfully!");

               try {
                       System.out.println("About to drop into while()...");
**************
This relies on the underlying reader that has been closed???
**************

                       while (termsEnumerator.next()) {
                               System.out.println("About to get
terms.Enumerator.term()...");
                               currentTerm = termsEnumerator.term();
                               System.out.println("Term = [" +
currentTerm.text() + "]");
                       }
                       termsEnumerator.close();
               } catch (Exception e) {
                       System.out.println("** ERROR **: Exception while
stepping through index: [" + e + "]");
                       }
       } // end main()

} // end CLASS ReadIndex

On Sun, Aug 2, 2009 at 3:15 PM, <ohaya@cox.net> wrote:

> Hi,
>
> I thought that, in the code that I posted, there was a close() in the
> finally?
>
> Or, are you saying that when an IndexReader is opened, that that somehow
> persists in the system, even past my Java app terminating?
>
> FYI, I'm doing this testing on Windows, under Eclipse...
>
> Jim
>
>
>
> ---- se3g2011 <se3g2011@gmail.com> wrote:
> >
> > hi,as you the error messages you listed below,pls put the
> 'reader.close()'
> > block to the bottom of method.
> > i think,if you invoke it first,the infrastructure stream is closed ,so
> > exceptions is encountered.
> >
> >
> > ohaya wrote:
> > >
> > > Hi,
> > >
> > > I changed the beginning of the try to:
> > >
> > >             try {
> > >                     System.out.println("About to call .next()...");
> > >                     boolean foo = termsEnumerator.next();
> > >                     System.out.println("Finished calling first
> .next()");
> > >                     System.out.println("About to drop into
> while()...");
> > > .
> > > .
> > > .
> > >
> > > and here's what I got when I ran the app:
> > >
> > > Index in directory :[C:\lucene-devel\lucene-devel\index] was opened
> > > successfully!
> > > About to call .next()...
> > > ** ERROR **: Exception while stepping through index:
> [java.io.IOException:
> > > The handle is invalid]
> > > java.io.IOException: The handle is invalid
> > >     at java.io.RandomAccessFile.seek(Native Method)
> > >     at
> > >
> org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirectory.java:591)
> > >     at
> > >
> org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.java:136)
> > >     at
> > >
> org.apache.lucene.index.CompoundFileReader$CSIndexInput.readInternal(CompoundFileReader.java:247)
> > >     at
> > >
> org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java:157)
> > >     at
> > >
> org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.java:38)
> > >     at org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
> > >     at org.apache.lucene.index.TermBuffer.read(TermBuffer.java:64)
> > >     at
> org.apache.lucene.index.SegmentTermEnum.next(SegmentTermEnum.java:127)
> > >     at ReadIndex.main(ReadIndex.java:29)
> > >
> > > Jim
> > >
> > > ---- ohaya@cox.net wrote:
> > >> Hi,
> > >>
> > >> BTW, the next() method is an abstract method in the Javadocs.  Does
> that
> > >> mean that I'm suppose to have my own implementation?
> > >>
> > >> Jim
> > >>
> > >>
> > >> ---- ohaya@cox.net wrote:
> > >> > Phil,
> > >> >
> > >> > I posted in haste.  Actually, from the output that I posted, doesn't
> it
> > >> it look like the .next() itself is throwing the exception?
> > >> >
> > >> > That is what has been puzzling me.  It looks like it got through the
> > >> open() and terms() with no problem, then it blew up when calling the
> > >> next()?
> > >> >
> > >> > Jim
> > >> >
> > >> >
> > >> > ---- ohaya@cox.net wrote:
> > >> > > Phil,
> > >> > >
> > >> > > Yes, that exception is not very helpful :)!!
> > >> > >
> > >> > > I'll try your suggestions and post back.
> > >> > >
> > >> > > Thanks,
> > >> > > Jim
> > >> > >
> > >> > >
> > >> > > ---- Phil Whelan <phil123@gmail.com> wrote:
> > >> > > > Hi Jim,
> > >> > > >
> > >> > > > I cannot see anything obvious, but both open() and terms() throw
> > >> > > > IOException's. You could try putting these in separate
> try..catch
> > >> > > > blocks to see which one it's coming from. Or using
> > >> e.printStackTrace()
> > >> > > > in the catch block will give more info to help you debug what's
> > >> > > > happening.
> > >> > > >
> > >> > > > On Sat, Aug 1, 2009 at 7:09 PM, <ohaya@cox.net> wrote:
> > >> > > > >                        reader = IndexReader.open(args[0]);
> > >> > > > >                        Term term = new Term("path", "");
> > >> > > > >                        termsEnumerator = reader.terms(term);
> > >> > > >
> > >> > > > Cheers,
> > >> > > > Phil
> > >> > > >
> > >> > > >
> > >> ---------------------------------------------------------------------
> > >> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> > > > For additional commands, e-mail:
> java-user-help@lucene.apache.org
> > >> > > >
> > >> > >
> > >> > >
> > >> > >
> ---------------------------------------------------------------------
> > >> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >> > >
> > >> >
> > >> >
> > >> >
> ---------------------------------------------------------------------
> > >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >> >
> > >>
> > >>
> > >> ---------------------------------------------------------------------
> > >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> > >
> >
> > --
> > View this message in context:
> http://www.nabble.com/java.io.IOException-when-trying-to-list-terms-in-index-%28IndexReader%29-tp24774351p24775753.html
> > Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000325574c1643d21a04702f55b5--

From java-user-return-41651-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 02 23:29:57 2009
Return-Path: <java-user-return-41651-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84436 invoked from network); 2 Aug 2009 23:29:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Aug 2009 23:29:57 -0000
Received: (qmail 38783 invoked by uid 500); 2 Aug 2009 23:30:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38694 invoked by uid 500); 2 Aug 2009 23:30:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38662 invoked by uid 99); 2 Aug 2009 23:29:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 23:29:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.46] (HELO eastrmmtao104.cox.net) (68.230.240.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Aug 2009 23:29:46 +0000
Received: from eastrmimpo01.cox.net ([68.1.16.119])
          by eastrmmtao104.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090802232924.BHIT22413.eastrmmtao104.cox.net@eastrmimpo01.cox.net>;
          Sun, 2 Aug 2009 19:29:24 -0400
Received: from eastrmwml33 ([172.18.18.217])
	by eastrmimpo01.cox.net with bizsmtp
	id PbVR1c0054h0NJL02bVRDB; Sun, 02 Aug 2009 19:29:25 -0400
X-VR-Score: -300.00
X-Authority-Analysis: v=1.0 c=1 a=0VJv2cbyVxsA:10 a=pGLkceISAAAA:8
 a=kviXuzpPAAAA:8 a=mV9VRH-2AAAA:8 a=9I5xiGouAAAA:8 a=DkUW0oeRqgLo5iwZ-asA:9
 a=fIOIEho_uVsJjNaRSiYA:7 a=w-wHAoeV1vzXJHQgNovT_Xnik_sA:4 a=2fPOlPt4dusA:10
 a=MSl-tDqOz04A:10 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Sun, 2 Aug 2009 19:29:26 -0400
Message-ID: <20090802192926.KE2L5.22811.imail@eastrmwml33>
Date: Sun, 2 Aug 2009 19:29:26 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: java.io.IOException when trying to list terms in index
  (IndexReader)
Cc: Erick Erickson <erickerickson@gmail.com>
In-Reply-To: <359a92830908021428r7636997w72d12b5f8cfad9@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Erick,

It's working now (I removed the finally, and put the close() elsewhere).  Thanks for the explanation.

Jim


---- Erick Erickson <erickerickson@gmail.com> wrote: 
> I've seen Eclipse get into weird states, but I don't think that's your
> problem.
> 
> You open the IndexReader and set up a TermEnum on it. Then, no matter
> what you close the underlying IndexReader in the finally block. Then later
> you use the TermEnum *even though the underlying reader has been closed*.
> You want something like
> try {
>   open reader
>   set up TermEnum
>   enumerate terms
>   close termEnum
>  } catch () {
> }
> finally {
> close reader
> }
> 
> Getting an IO exception isn't at all strange in this situation, and exactly
> when
> you throw the exception is indeterminate.
> 
> See below.
> public class ReadIndex {
> 
>        public static void main(String[] args) {
>                IndexReader reader = null;
>                TermEnum termsEnumerator = null;
>                Term currentTerm = null;
> 
>                try {
>                        reader = IndexReader.open(args[0]);
>                        Term term = new Term("path", "");
>                        termsEnumerator = reader.terms(term);
>                } catch (IOException e) {
>                        System.out.println("** ERROR **: Exception when
> opened IndexReader: [" + e + "]");
>                } finally {
> **********
> Why close the reader here? You need it later I think.
> **********
>                        try { reader.close(); } catch (IOException e) { /*
> suck it up */ }
>                }
> 
>                System.out.println("Index in directory :[" + args[0] + "] was
> opened successfully!");
> 
>                try {
>                        System.out.println("About to drop into while()...");
> **************
> This relies on the underlying reader that has been closed???
> **************
> 
>                        while (termsEnumerator.next()) {
>                                System.out.println("About to get
> terms.Enumerator.term()...");
>                                currentTerm = termsEnumerator.term();
>                                System.out.println("Term = [" +
> currentTerm.text() + "]");
>                        }
>                        termsEnumerator.close();
>                } catch (Exception e) {
>                        System.out.println("** ERROR **: Exception while
> stepping through index: [" + e + "]");
>                        }
>        } // end main()
> 
> } // end CLASS ReadIndex
> 
> On Sun, Aug 2, 2009 at 3:15 PM, <ohaya@cox.net> wrote:
> 
> > Hi,
> >
> > I thought that, in the code that I posted, there was a close() in the
> > finally?
> >
> > Or, are you saying that when an IndexReader is opened, that that somehow
> > persists in the system, even past my Java app terminating?
> >
> > FYI, I'm doing this testing on Windows, under Eclipse...
> >
> > Jim
> >
> >
> >
> > ---- se3g2011 <se3g2011@gmail.com> wrote:
> > >
> > > hi,as you the error messages you listed below,pls put the
> > 'reader.close()'
> > > block to the bottom of method.
> > > i think,if you invoke it first,the infrastructure stream is closed ,so
> > > exceptions is encountered.
> > >
> > >
> > > ohaya wrote:
> > > >
> > > > Hi,
> > > >
> > > > I changed the beginning of the try to:
> > > >
> > > >             try {
> > > >                     System.out.println("About to call .next()...");
> > > >                     boolean foo = termsEnumerator.next();
> > > >                     System.out.println("Finished calling first
> > .next()");
> > > >                     System.out.println("About to drop into
> > while()...");
> > > > .
> > > > .
> > > > .
> > > >
> > > > and here's what I got when I ran the app:
> > > >
> > > > Index in directory :[C:\lucene-devel\lucene-devel\index] was opened
> > > > successfully!
> > > > About to call .next()...
> > > > ** ERROR **: Exception while stepping through index:
> > [java.io.IOException:
> > > > The handle is invalid]
> > > > java.io.IOException: The handle is invalid
> > > >     at java.io.RandomAccessFile.seek(Native Method)
> > > >     at
> > > >
> > org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirectory.java:591)
> > > >     at
> > > >
> > org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.java:136)
> > > >     at
> > > >
> > org.apache.lucene.index.CompoundFileReader$CSIndexInput.readInternal(CompoundFileReader.java:247)
> > > >     at
> > > >
> > org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java:157)
> > > >     at
> > > >
> > org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.java:38)
> > > >     at org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
> > > >     at org.apache.lucene.index.TermBuffer.read(TermBuffer.java:64)
> > > >     at
> > org.apache.lucene.index.SegmentTermEnum.next(SegmentTermEnum.java:127)
> > > >     at ReadIndex.main(ReadIndex.java:29)
> > > >
> > > > Jim
> > > >
> > > > ---- ohaya@cox.net wrote:
> > > >> Hi,
> > > >>
> > > >> BTW, the next() method is an abstract method in the Javadocs.  Does
> > that
> > > >> mean that I'm suppose to have my own implementation?
> > > >>
> > > >> Jim
> > > >>
> > > >>
> > > >> ---- ohaya@cox.net wrote:
> > > >> > Phil,
> > > >> >
> > > >> > I posted in haste.  Actually, from the output that I posted, doesn't
> > it
> > > >> it look like the .next() itself is throwing the exception?
> > > >> >
> > > >> > That is what has been puzzling me.  It looks like it got through the
> > > >> open() and terms() with no problem, then it blew up when calling the
> > > >> next()?
> > > >> >
> > > >> > Jim
> > > >> >
> > > >> >
> > > >> > ---- ohaya@cox.net wrote:
> > > >> > > Phil,
> > > >> > >
> > > >> > > Yes, that exception is not very helpful :)!!
> > > >> > >
> > > >> > > I'll try your suggestions and post back.
> > > >> > >
> > > >> > > Thanks,
> > > >> > > Jim
> > > >> > >
> > > >> > >
> > > >> > > ---- Phil Whelan <phil123@gmail.com> wrote:
> > > >> > > > Hi Jim,
> > > >> > > >
> > > >> > > > I cannot see anything obvious, but both open() and terms() throw
> > > >> > > > IOException's. You could try putting these in separate
> > try..catch
> > > >> > > > blocks to see which one it's coming from. Or using
> > > >> e.printStackTrace()
> > > >> > > > in the catch block will give more info to help you debug what's
> > > >> > > > happening.
> > > >> > > >
> > > >> > > > On Sat, Aug 1, 2009 at 7:09 PM, <ohaya@cox.net> wrote:
> > > >> > > > >                        reader = IndexReader.open(args[0]);
> > > >> > > > >                        Term term = new Term("path", "");
> > > >> > > > >                        termsEnumerator = reader.terms(term);
> > > >> > > >
> > > >> > > > Cheers,
> > > >> > > > Phil
> > > >> > > >
> > > >> > > >
> > > >> ---------------------------------------------------------------------
> > > >> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > >> > > > For additional commands, e-mail:
> > java-user-help@lucene.apache.org
> > > >> > > >
> > > >> > >
> > > >> > >
> > > >> > >
> > ---------------------------------------------------------------------
> > > >> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > >> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >> > >
> > > >> >
> > > >> >
> > > >> >
> > ---------------------------------------------------------------------
> > > >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >> >
> > > >>
> > > >>
> > > >> ---------------------------------------------------------------------
> > > >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >>
> > > >
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >
> > > >
> > >
> > > --
> > > View this message in context:
> > http://www.nabble.com/java.io.IOException-when-trying-to-list-terms-in-index-%28IndexReader%29-tp24774351p24775753.html
> > > Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41652-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 02:44:43 2009
Return-Path: <java-user-return-41652-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42405 invoked from network); 3 Aug 2009 02:44:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 02:44:42 -0000
Received: (qmail 19938 invoked by uid 500); 3 Aug 2009 02:44:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19865 invoked by uid 500); 3 Aug 2009 02:44:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19855 invoked by uid 99); 3 Aug 2009 02:44:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 02:44:45 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Leonard.Gestrin@markettools.com designates 72.5.112.151 as permitted sender)
Received: from [72.5.112.151] (HELO mail.markettools.com) (72.5.112.151)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 02:44:35 +0000
Received: from wdccpmail02.markettools.com ([10.64.64.34]) by
 wdccpcas01.markettools.com ([10.64.64.36]) with mapi; Sun, 2 Aug 2009
 19:44:14 -0700
From: Leonard Gestrin <Leonard.Gestrin@markettools.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Sun, 2 Aug 2009 19:44:12 -0700
Subject: question about 
Thread-Topic: question about 
Thread-Index: AcoT5Eih5IC/CzkkRIi4cOz3QTyYJA==
Message-ID: <D84A89F284EF0443AFC11A7FC41E4C6044C36F91@wdccpmail02.markettools.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_000_D84A89F284EF0443AFC11A7FC41E4C6044C36F91wdccpmail02mark_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_D84A89F284EF0443AFC11A7FC41E4C6044C36F91wdccpmail02mark_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hello,
I have question about KEYWORD type and searching/updating.  I am getting st=
range behavior that I can't quite comprehend.
My index is created using standard analyzer, which used for writing and sea=
rching. It has three fields

userpin - alphanumeric field which is stored as TEXT
documentkey  - alphanumeric field which is stored as TEXT
contents - text of document which is stored as TEXT

When I try to update document I am creating Term to find document by docume=
ntKey and I am using

 org.apache.lucene.index.IndexWriter.updateDocument(term, pDocument);

to do the update.  Lucene fails to find the document by the term and I am g=
etting duplicate documents in the index.
When I changed index to define documentKey as KEYWORD the updates started t=
o work fine.
However, search for documentKey using StandardAnalyzer stopped working.

It appears that lucene is using keywordAnalyzer for searching for the term =
during update, even though the indexer is open with StandardAnalyzer.

The sample values that are stored in documentKeys are: "L2222FAHBHMF", "L22=
22FAHBHAS".
I noticed if documentKey is numeric value, both KeywordAnalyzer and Standar=
dAnalyzer can find the documents by it without any problem thus reader can =
find and indexer can update without any problems. With alphanumeric I cant =
get both to work.
Any help is appreciated.
Thanks
Leonard










--_000_D84A89F284EF0443AFC11A7FC41E4C6044C36F91wdccpmail02mark_--

From java-user-return-41653-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 02:49:55 2009
Return-Path: <java-user-return-41653-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42784 invoked from network); 3 Aug 2009 02:49:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 02:49:55 -0000
Received: (qmail 22464 invoked by uid 500); 3 Aug 2009 02:49:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22384 invoked by uid 500); 3 Aug 2009 02:49:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22374 invoked by uid 99); 3 Aug 2009 02:49:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 02:49:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Leonard.Gestrin@markettools.com designates 72.5.112.151 as permitted sender)
Received: from [72.5.112.151] (HELO mail.markettools.com) (72.5.112.151)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 02:49:50 +0000
Received: from wdccpmail02.markettools.com ([10.64.64.34]) by
 wdccpcas01.markettools.com ([10.64.64.36]) with mapi; Sun, 2 Aug 2009
 19:49:29 -0700
From: Leonard Gestrin <Leonard.Gestrin@markettools.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Sun, 2 Aug 2009 19:49:27 -0700
Subject: question about indexing/searching using standardanalyzer for
 KEYWORD field that contains alphanumeric data
Thread-Topic: question about indexing/searching using standardanalyzer for
 KEYWORD field that contains alphanumeric data
Thread-Index: AcoT5Eih5IC/CzkkRIi4cOz3QTyYJAAAJ1Sw
Message-ID: <D84A89F284EF0443AFC11A7FC41E4C6044C36F92@wdccpmail02.markettools.com>
References: <D84A89F284EF0443AFC11A7FC41E4C6044C36F91@wdccpmail02.markettools.com>
In-Reply-To: <D84A89F284EF0443AFC11A7FC41E4C6044C36F91@wdccpmail02.markettools.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,
I have question about KEYWORD type and searching/updating.  I am getting st=
range behavior that I can't quite comprehend.
My index is created using standard analyzer, which used for writing and sea=
rching. It has three fields

userpin - alphanumeric field which is stored as TEXT
documentkey  - alphanumeric field which is stored as TEXT
contents - text of document which is stored as TEXT

When I try to update document I am creating Term to find document by docume=
ntKey and I am using

 org.apache.lucene.index.IndexWriter.updateDocument(term, pDocument);

to do the update.  Lucene fails to find the document by the term and I am g=
etting duplicate documents in the index.
When I changed index to define documentKey as KEYWORD the updates started t=
o work fine.
However, search for documentKey using StandardAnalyzer stopped working.

It appears that lucene is using keywordAnalyzer for searching for the term =
during update, even though the indexer is open with StandardAnalyzer.

The sample values that are stored in documentKeys are: "L2222FAHBHMF", "L22=
22FAHBHAS".
I noticed if documentKey is numeric value, both KeywordAnalyzer and Standar=
dAnalyzer can find the documents by it without any problem thus reader can =
find and indexer can update without any problems. With alphanumeric I cant =
get both to work.
Any help is appreciated.
Thanks
Leonard










---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41654-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 03:14:50 2009
Return-Path: <java-user-return-41654-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48498 invoked from network); 3 Aug 2009 03:14:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 03:14:49 -0000
Received: (qmail 36001 invoked by uid 500); 3 Aug 2009 03:14:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35912 invoked by uid 500); 3 Aug 2009 03:14:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35902 invoked by uid 99); 3 Aug 2009 03:14:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 03:14:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 03:14:43 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MXo0E-0004I7-Oy
	for java-user@lucene.apache.org; Sun, 02 Aug 2009 20:14:22 -0700
Message-ID: <24784708.post@talk.nabble.com>
Date: Sun, 2 Aug 2009 20:14:22 -0700 (PDT)
From: bourne71 <garylkc@live.com>
To: java-user@lucene.apache.org
Subject: Re: Boosting Search Results
In-Reply-To: <ac6e61fc0907310431x32f963e0s5cac50a93516dafe@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: garylkc@live.com
References: <24753954.post@talk.nabble.com> <ac6e61fc0907310431x32f963e0s5cac50a93516dafe@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks for all the reply. It help me to understand problem better, but is it
possible to create a query that will give additional boost to the results if
and only if both of the word is found inside the results. This will
definitely make sure that the results will be in the higher up of the list.

Can this type of query be created?
-- 
View this message in context: http://www.nabble.com/Boosting-Search-Results-tp24753954p24784708.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41655-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 04:00:23 2009
Return-Path: <java-user-return-41655-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66412 invoked from network); 3 Aug 2009 04:00:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 04:00:23 -0000
Received: (qmail 67572 invoked by uid 500); 3 Aug 2009 04:00:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67497 invoked by uid 500); 3 Aug 2009 04:00:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67487 invoked by uid 99); 3 Aug 2009 04:00:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 04:00:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.61] (HELO web50307.mail.re2.yahoo.com) (206.190.38.61)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 03 Aug 2009 04:00:16 +0000
Received: (qmail 47172 invoked by uid 60001); 3 Aug 2009 03:59:33 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1249271973; bh=d1Z1A/im7kUnqQgNyAx0eA6Uo5OyQB3bctgt+Sh6pXQ=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=K5xCIZPAtGJ0HZEAmW+LOq8WvAaawRiiZpqB1R5okpV65XiB7FLzU87dsbJCz/kW40ESTPZcoI8XXHdzwZ3hqM+xrLAHTKQLvs2Mj7cgcY873Yqpd7C4LgyYEy3u5JiBgoRjPCgJs00t1o66Ex4gbjr+MXsQEaxpCyELKXIL8AA=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=WurHrNUIRTbHCugvpUz9qDMjp55oWE5LQfAZVJXpGrV9uD7ZCMJy6ydq0LdFaqbT6vdOlh/967h/WAfV7c3iM6sdWoTwiMNinW9DPXQoip58HQa3lyyBc+1yKJejREtNAtnLanFG1UFSR6UgXFGiB+XyqbZdTiL/LLCxMQ3Dr2I=;
Message-ID: <358259.47068.qm@web50307.mail.re2.yahoo.com>
X-YMail-OSG: 6HfmxB8VM1ng6l9zYArm8U9kSuO1oRi9LUmgKm.CbA34Zmv3DRtOmEVO70znqXIrX9_V5icYtWIeZXQ5HEjqJgSAqqDd0wkKNBP3lXk9wPaqNPxeavtYkqdCC63yNG0Kcat10.YopvaAni78exdL2YuMygW9PFj4cXHRKsaCNz2wTts2cnJg1A8HSLXWPOkcz_tv.xsN5I1faQeY0QcTxLs5Sfv7U1tjH7SCVV37I_VJxJQXiCy7eL5Q07akGBRQHkMZk84FZZ3zF5LMJcqIvweCiazVrMHBaDDQGU.PL8RCPJJRVkTB2du9obQgfjT6XPwKv6Y-
Received: from [74.73.24.33] by web50307.mail.re2.yahoo.com via HTTP; Sun, 02 Aug 2009 20:59:33 PDT
X-Mailer: YahooMailRC/1358.22 YahooMailWebService/0.7.338.2
References: <24754777.post@talk.nabble.com>
Date: Sun, 2 Aug 2009 20:59:33 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Lucene for dynamic data retrieval
To: java-user@lucene.apache.org
In-Reply-To: <24754777.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Satish,

Lucene doesn't enforce an index schema, so each document can have a different set of fields.  It sounds like you need to write a custom indexer that follows your custom rules and creates Lucene Documents with different Fields, depending on what you want indexed.

You also mention searching and retrieval of data from DB.  This, too, sounds like a custom search application - there is nothing in Lucene that uses a (R)DBMS to retrieve field values.

Otis
--
Sematext is hiring -- http://sematext.com/about/jobs.html?mls
Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR



----- Original Message ----
> From: Findsatish <findsatish@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Friday, July 31, 2009 7:13:47 AM
> Subject: Lucene for dynamic data retrieval
> 
> 
> Hi All,
> I am new to Lucene and I am working on a search application.
> 
> My application needs dynamic data retrieval from the database. That means,
> based on my previous step output, I need to retrieve entries from the DB for
> the next step.
> 
> For example, if my search query contains "Name" field entry, I need to
> retrieve the "Designations" from the DB that are matched with the identified
> "Name" in the query.
>                     if there is no "Name" identified in the query, then I
> need to retrieve ALL the "Designations" from the DB.
> 
> In the next step, if "Designation" is also identified in the query, then I
> need to retrieve the "Departments" from the DB that are matched with this
> "Designation".
>                         if there is no "Designation" identified, then I need
> to retrieve ALL the "Departments" from the DB.
> 
> Like this, there are around 6-7 steps, all are dependent on the previous
> step output.
> 
> In this scenario, I would like to know whether I can use Lucene for creating
> the index? If so, How can I use it?
> 
> Any help is highly appreciated.
> 
> Thanks,
> Satish
> -- 
> View this message in context: 
> http://www.nabble.com/Lucene-for-dynamic-data-retrieval-tp24754777p24754777.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41656-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 04:34:13 2009
Return-Path: <java-user-return-41656-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70102 invoked from network); 3 Aug 2009 04:34:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 04:34:13 -0000
Received: (qmail 84892 invoked by uid 500); 3 Aug 2009 04:34:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84794 invoked by uid 500); 3 Aug 2009 04:34:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84784 invoked by uid 99); 3 Aug 2009 04:34:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 04:34:16 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of prashullegaddi@gmail.com designates 209.85.198.224 as permitted sender)
Received: from [209.85.198.224] (HELO rv-out-0506.google.com) (209.85.198.224)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 04:34:07 +0000
Received: by rv-out-0506.google.com with SMTP id b25so959643rvf.5
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 21:33:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=Aq7IDaHe4MKjuRm+mOS4njqeBAcdpTdy9xvxkRbWxq4=;
        b=hUkGMMmwdbIFW97WDzSPeTqJKU4qnPm1OxU8FHSUANmvPAUdQL/OA3rMKpdOGffzx0
         QqIJHS4eYFla8UNXl2Nvk/H1LYsuzDG235i3T2/E7RoMypsXin8SMnTEF8UwzmlTuU06
         08Ex+mIBE0N8yNRVwgROhEhE9J//i/9Kpw2JQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=xbezTVDhxjq/fOsHFSpd00VsYmEg3aSMvf+1XMPstYxBTYc1fMkzAxD8kLEwtk9HK/
         /fHcIE9XVJEW8o/PPhm/PvN6GSK70LEihKgd6MK/zhWbRCC4wvOeUQUzMwyBo1wTzqrT
         +vyOGbGaHArjwssO0SrlQA2qc0oPZJxSb0ufk=
MIME-Version: 1.0
Received: by 10.141.28.19 with SMTP id f19mr3335756rvj.67.1249274026070; Sun, 
	02 Aug 2009 21:33:46 -0700 (PDT)
Date: Mon, 3 Aug 2009 10:03:46 +0530
Message-ID: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com>
Subject: How to improve search time?
From: prashant ullegaddi <prashullegaddi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1a9068d12f204703546d2
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1a9068d12f204703546d2
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

I've a single index of size 87GB containing around 50M documents. When I
search for any query,
best search time I observed was 8sec. And when query is expanded with
synonyms, search takes
minutes (~ 2-3min). Is there a better way to search so that overall search
time reduces?

Thanks,
Prashant.

--000e0cd1a9068d12f204703546d2--

From java-user-return-41657-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 04:37:01 2009
Return-Path: <java-user-return-41657-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70533 invoked from network); 3 Aug 2009 04:37:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 04:37:01 -0000
Received: (qmail 89675 invoked by uid 500); 3 Aug 2009 04:37:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89590 invoked by uid 500); 3 Aug 2009 04:37:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89580 invoked by uid 99); 3 Aug 2009 04:37:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 04:37:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of phil123@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 04:36:55 +0000
Received: by ywh26 with SMTP id 26so4013505ywh.5
        for <java-user@lucene.apache.org>; Sun, 02 Aug 2009 21:36:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=YutBDuY2gfYJBk/0uJ1Jxmq+/x97DYDFnkZJyFhgcJ8=;
        b=hCN23Ggw8bycM07XY8E8VNQbYX4plsAp7Dk0jVuRxwQ3IcJEYmGH+ayxf79vbhdC3B
         i2cn4TUTtC21gOvY9iovKm+/VClce16WUReC3eYSSLjTZ9DIQLCY7OHTEAYPs/D94edx
         Q2fK7WRUovLSBfwmwOxPCfy86rN7FrutXwljI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=FIlHTWpZ20ieZguxaseV3N4UnNlD0sn/NaveDsJNc5+4vg6Yc5T0Dk0KB1i8PIiMcV
         ZYTuflF5BB/8kxFVHviuwLfA+WqxpvAU8d44CctGbmEcwvtf1+595TnOd0BVPDuYPcBw
         wxztEpDHYZNGwtZ6Di82vsWqk8RS5ulBMKNO4=
MIME-Version: 1.0
Received: by 10.101.70.14 with SMTP id x14mr6315807ank.78.1249274193481; Sun, 
	02 Aug 2009 21:36:33 -0700 (PDT)
In-Reply-To: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com>
References: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com>
Date: Sun, 2 Aug 2009 21:36:33 -0700
Message-ID: <9cafbc680908022136x778bb9d0ve011f8a270098458@mail.gmail.com>
Subject: Re: How to improve search time?
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Prashant,

Take a look at this...
http://wiki.apache.org/lucene-java/ImproveSearchingSpeed

Cheers,
Phil

On Sun, Aug 2, 2009 at 9:33 PM, prashant
ullegaddi<prashullegaddi@gmail.com> wrote:
> Hi,
>
> I've a single index of size 87GB containing around 50M documents. When I
> search for any query,
> best search time I observed was 8sec. And when query is expanded with
> synonyms, search takes
> minutes (~ 2-3min). Is there a better way to search so that overall search
> time reduces?
>
> Thanks,
> Prashant.
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41658-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 05:31:22 2009
Return-Path: <java-user-return-41658-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81415 invoked from network); 3 Aug 2009 05:31:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 05:31:22 -0000
Received: (qmail 26903 invoked by uid 500); 3 Aug 2009 05:31:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26851 invoked by uid 500); 3 Aug 2009 05:31:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26841 invoked by uid 99); 3 Aug 2009 05:31:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 05:31:24 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.39.175] (HELO web50211.mail.re2.yahoo.com) (206.190.39.175)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 03 Aug 2009 05:31:13 +0000
Received: (qmail 20887 invoked by uid 60001); 3 Aug 2009 05:30:50 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1249277450; bh=6qOE/i0jn7al5r0n6876KGFdvqtr1ArURW9lQc0lqlo=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=1ntjauzyqOb1d0WGjxp23o3YRxouX3XR073YUtOi14m4KMtewEtSAQhIWtCm0x0t7TbIjm8RbPJMK4E4CrJYdoF2ENiis5z6BriA9DhQSSFyvb+4ybdGmYAEd1n/Q3oe/WXEkwr1s89HrytQqZQsGMz7OT4cd86yCnvwwZ/oT28=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=VuS2vWb5/hnsr7MISoeoX03tivsB2toTbqPZjySeN/sU0WAi2F8hjDP8zt0GeARlun0oOhiql61pdRugSWPIOoXd/HahjAljdOsIloxZziYsdvSA1S7rFsbt/f+HLhhQhdcDSrcPgxFlKgZkKvnWnBiV+URej9VQy9aduP5Yj+A=;
Message-ID: <305051.19172.qm@web50211.mail.re2.yahoo.com>
X-YMail-OSG: tmwDbLIVM1nprdQgn.q5lFfvrVprukriGm89F5Y4ER8ORu5Eg6p2Bz1k6btRm10gxBSygG2zkbILImpBKtu5QtvdTwUGvVkWL.No8NGfE4Kb_TYyWnOgDb9weM_8WmBtIEoJeQVyE6kpa2ZjlKpJIRsdRpH9RWM4kbS7t6.gKElfq7hu67PNJdryYJzAnhqX_Rw17rZGB63rFx5aqY39i4ooNpr1S_ePusy9E3tjXuh3_vPLozSwzJ0vKZtl8FxMAapnebHQlZJYmnBzBZ.2LswSOr44vhWlnpQvsjNfl35QEcM25QV0pQRPnPioUoeZSA4rE_.TgeL5IKceoqg-
Received: from [213.55.95.61] by web50211.mail.re2.yahoo.com via HTTP; Sun, 02 Aug 2009 22:30:50 PDT
X-Mailer: YahooMailClassic/6.0.19 YahooMailWebService/0.7.338.2
Date: Sun, 2 Aug 2009 22:30:50 -0700 (PDT)
From: henok sahilu <henok_sahilu@yahoo.com>
Subject: Re: Boosting Search Results
To: java-user@lucene.apache.org
In-Reply-To: <24784708.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-910789895-1249277450=:19172"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-910789895-1249277450=:19172
Content-Type: text/plain; charset=us-ascii

hello there 
i like to know about the Boosting Search results thing
thanks


--- On Sun, 8/2/09, bourne71 <garylkc@live.com> wrote:

From: bourne71 <garylkc@live.com>
Subject: Re: Boosting Search Results
To: java-user@lucene.apache.org
Date: Sunday, August 2, 2009, 8:14 PM


Thanks for all the reply. It help me to understand problem better, but is it
possible to create a query that will give additional boost to the results if
and only if both of the word is found inside the results. This will
definitely make sure that the results will be in the higher up of the list.

Can this type of query be created?
-- 
View this message in context: http://www.nabble.com/Boosting-Search-Results-tp24753954p24784708.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org




      
--0-910789895-1249277450=:19172--

From java-user-return-41659-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 09:21:54 2009
Return-Path: <java-user-return-41659-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47254 invoked from network); 3 Aug 2009 09:21:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 09:21:54 -0000
Received: (qmail 7346 invoked by uid 500); 3 Aug 2009 09:21:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7276 invoked by uid 500); 3 Aug 2009 09:21:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7266 invoked by uid 99); 3 Aug 2009 09:21:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 09:21:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 72.14.220.153 as permitted sender)
Received: from [72.14.220.153] (HELO fg-out-1718.google.com) (72.14.220.153)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 09:21:47 +0000
Received: by fg-out-1718.google.com with SMTP id l26so956130fgb.4
        for <java-user@lucene.apache.org>; Mon, 03 Aug 2009 02:21:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=dMvdNdMXvNsyMnFbLyHJYvJkMLe3t5YzL32wndXnxdc=;
        b=JpSVQ2iiziv6WBEIhKRjM+IuXcM8Ki9CL6UPr/qGWIb6BGkc+eCKxsX35FupUEC/tD
         EQC5Jcq0df7QtnJL5bMclziYduFr11BERMnXIJdSEMR6OU7loeNrFlAYzIBWYAIywvIh
         UQTa6ATEBHcWMZNp0DP3/zl93u2vpQXiLV+MM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=JLZn5/83VZQymcV9FQONrVhoYyUENh1YRpqUJk8WCyHfUZ9ox2i/EapnOAFxOXRlsD
         QctC1qhM8KPS8VdunBOhvlVfeCIeGl2bUlU6EAfg8a01j8mEmPdQWmlkxwcw+XRnm4+L
         9hMtC4tAytFbOISUBmDPgM4OrDWFyxJuC43ok=
MIME-Version: 1.0
Received: by 10.86.84.6 with SMTP id h6mr1985315fgb.35.1249291287165; Mon, 03 
	Aug 2009 02:21:27 -0700 (PDT)
In-Reply-To: <D84A89F284EF0443AFC11A7FC41E4C6044C36F92@wdccpmail02.markettools.com>
References: <D84A89F284EF0443AFC11A7FC41E4C6044C36F91@wdccpmail02.markettools.com> 
	<D84A89F284EF0443AFC11A7FC41E4C6044C36F92@wdccpmail02.markettools.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Mon, 3 Aug 2009 10:21:07 +0100
Message-ID: <8c4e68610908030221te112407mbf1eccf85a103154@mail.gmail.com>
Subject: Re: question about indexing/searching using standardanalyzer for 
	KEYWORD field that contains alphanumeric data
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi


Storing documentkey as TEXT will be causing it to be passed through
StandardAnalyzer which will be downcasing it, and the index will be
holding "l2222fahbhmf" rather than "L2222FAHBHMF".  When you changed
it to KEYWORD it will have been stored as is so the
updateDocument(term, doc) call will have worked but searching will
have failed because StandardAnalyzer will have downcased it. Numeric
keys will have worked everywhere because they don't get downcased.

See "Why is it important to use the same analyzer type during indexing
and search?" in the FAQ.

The best solution is probably to store it as KEYWORD and use
PerFieldAnalyzerWrapper to specify KeywordAnalyzer for documentkey.
The javadocs have an example showing what you need.


TEXT and KEYWORD haven't been around in lucene for a while.  You might
like to consider upgrading.  Good practice anyway to mention what
version you are using when asking questions.


--
Ian.


On Mon, Aug 3, 2009 at 3:49 AM, Leonard
Gestrin<Leonard.Gestrin@markettools.com> wrote:
>
> Hello,
> I have question about KEYWORD type and searching/updating. =A0I am gettin=
g strange behavior that I can't quite comprehend.
> My index is created using standard analyzer, which used for writing and s=
earching. It has three fields
>
> userpin - alphanumeric field which is stored as TEXT
> documentkey =A0- alphanumeric field which is stored as TEXT
> contents - text of document which is stored as TEXT
>
> When I try to update document I am creating Term to find document by docu=
mentKey and I am using
>
> =A0org.apache.lucene.index.IndexWriter.updateDocument(term, pDocument);
>
> to do the update. =A0Lucene fails to find the document by the term and I =
am getting duplicate documents in the index.
> When I changed index to define documentKey as KEYWORD the updates started=
 to work fine.
> However, search for documentKey using StandardAnalyzer stopped working.
>
> It appears that lucene is using keywordAnalyzer for searching for the ter=
m during update, even though the indexer is open with StandardAnalyzer.
>
> The sample values that are stored in documentKeys are: "L2222FAHBHMF", "L=
2222FAHBHAS".
> I noticed if documentKey is numeric value, both KeywordAnalyzer and Stand=
ardAnalyzer can find the documents by it without any problem thus reader ca=
n find and indexer can update without any problems. With alphanumeric I can=
t get both to work.
> Any help is appreciated.
> Thanks
> Leonard
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41660-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 09:33:51 2009
Return-Path: <java-user-return-41660-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53875 invoked from network); 3 Aug 2009 09:33:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 09:33:51 -0000
Received: (qmail 24285 invoked by uid 500); 3 Aug 2009 09:33:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24199 invoked by uid 500); 3 Aug 2009 09:33:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24180 invoked by uid 99); 3 Aug 2009 09:33:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 09:33:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 72.14.220.158 as permitted sender)
Received: from [72.14.220.158] (HELO fg-out-1718.google.com) (72.14.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 09:33:40 +0000
Received: by fg-out-1718.google.com with SMTP id l27so441072fgb.4
        for <java-user@lucene.apache.org>; Mon, 03 Aug 2009 02:33:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=leO0f7opJlUajvVj87LHpGggH4+/8MaVkf5YEflFk3M=;
        b=IOF7zG4tiDQ8hGNtPWk32JzM7oTUoOOvYTbD6JH4nmDHfbfTBU/40vbdhrfw88QGp/
         hcP/lmoE41ZzLXDhuSlB05oy8hbZSJmcMUarQUu1G4Val8zQU72G6THgPFmDRAl9mmsK
         gke/U+QBCJTBzplD7axubBdZPcsCQSDWGJ6HU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=frBFx6k+0kz5MzHOHao0maWrgdWRDil/EiidL0jGeMsvgKS0v4v1bxwlvcjqtNvHpe
         +v4bGCQmGJRlAAwgVWndQxFgyTXO59evowvyn4oS9EVPRDvNGQrgPI3uWP0lecDl63/c
         uiudxdbUJkFV3Y2kcEG02+2RmzYfite/45tsM=
MIME-Version: 1.0
Received: by 10.86.84.6 with SMTP id h6mr1989314fgb.35.1249291999111; Mon, 03 
	Aug 2009 02:33:19 -0700 (PDT)
In-Reply-To: <24784708.post@talk.nabble.com>
References: <24753954.post@talk.nabble.com> <ac6e61fc0907310431x32f963e0s5cac50a93516dafe@mail.gmail.com> 
	<24784708.post@talk.nabble.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Mon, 3 Aug 2009 10:32:59 +0100
Message-ID: <8c4e68610908030232n1831a8c8pe10117e6ca61d2b6@mail.gmail.com>
Subject: Re: Boosting Search Results
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

You could write your own Similarity, extending DefaultSimilarity and
overriding whichever methods will help you achieve your aims.

Or how about running 2 searches, the first with both words required
(+word1 +word2) and then a second search where they aren't both
required (word1 word2).  Then merge/dedup the two lists of hits,
keeping the ones from the first search at the top.


--
Ian.

On Mon, Aug 3, 2009 at 4:14 AM, bourne71<garylkc@live.com> wrote:
>
> Thanks for all the reply. It help me to understand problem better, but is it
> possible to create a query that will give additional boost to the results if
> and only if both of the word is found inside the results. This will
> definitely make sure that the results will be in the higher up of the list.
>
> Can this type of query be created?
> --
> View this message in context: http://www.nabble.com/Boosting-Search-Results-tp24753954p24784708.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41661-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 09:52:47 2009
Return-Path: <java-user-return-41661-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62246 invoked from network); 3 Aug 2009 09:52:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 09:52:47 -0000
Received: (qmail 39489 invoked by uid 500); 3 Aug 2009 09:52:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39368 invoked by uid 500); 3 Aug 2009 09:52:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39304 invoked by uid 99); 3 Aug 2009 09:52:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 09:51:56 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 09:51:47 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MXuCU-0002mH-TF
	for java-user@lucene.apache.org; Mon, 03 Aug 2009 02:51:26 -0700
Message-ID: <24788000.post@talk.nabble.com>
Date: Mon, 3 Aug 2009 02:51:26 -0700 (PDT)
From: bourne71 <garylkc@live.com>
To: java-user@lucene.apache.org
Subject: Re: Boosting Search Results
In-Reply-To: <8c4e68610908030232n1831a8c8pe10117e6ca61d2b6@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: garylkc@live.com
References: <24753954.post@talk.nabble.com> <ac6e61fc0907310431x32f963e0s5cac50a93516dafe@mail.gmail.com> <24784708.post@talk.nabble.com> <8c4e68610908030232n1831a8c8pe10117e6ca61d2b6@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hey, thanks for the suggestion.
I think of performing 2 searches as well. Unfortunately I dont know how to
perform a search on the first results return. Could u guide me a little? I
tried to look around for the information but found none

Thanks

Ian Lea wrote:
> 
> You could write your own Similarity, extending DefaultSimilarity and
> overriding whichever methods will help you achieve your aims.
> 
> Or how about running 2 searches, the first with both words required
> (+word1 +word2) and then a second search where they aren't both
> required (word1 word2).  Then merge/dedup the two lists of hits,
> keeping the ones from the first search at the top.
> 
> 
> --
> Ian.
> 
> On Mon, Aug 3, 2009 at 4:14 AM, bourne71<garylkc@live.com> wrote:
>>
>> Thanks for all the reply. It help me to understand problem better, but is
>> it
>> possible to create a query that will give additional boost to the results
>> if
>> and only if both of the word is found inside the results. This will
>> definitely make sure that the results will be in the higher up of the
>> list.
>>
>> Can this type of query be created?
>> --
>> View this message in context:
>> http://www.nabble.com/Boosting-Search-Results-tp24753954p24784708.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Boosting-Search-Results-tp24753954p24788000.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41662-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 10:29:06 2009
Return-Path: <java-user-return-41662-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79948 invoked from network); 3 Aug 2009 10:29:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 10:29:06 -0000
Received: (qmail 80823 invoked by uid 500); 3 Aug 2009 10:29:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80729 invoked by uid 500); 3 Aug 2009 10:29:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80719 invoked by uid 99); 3 Aug 2009 10:29:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 10:29:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 72.14.220.159 as permitted sender)
Received: from [72.14.220.159] (HELO fg-out-1718.google.com) (72.14.220.159)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 10:28:58 +0000
Received: by fg-out-1718.google.com with SMTP id l26so965034fgb.4
        for <java-user@lucene.apache.org>; Mon, 03 Aug 2009 03:28:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=xTlqf1CqkHmMpmf5IIONxnvMJfk+qhjxQnp8ELOvegQ=;
        b=TefYf7KytHVyi00DHiKgraMkoGDNv/JkkNP+7p1CC/nj43qF5elUjK719vtrdFNxTt
         C2M2vtZvJCIbXh6HL7XEobYriUUh4jtATUgNE2ENAEk9+aUt132/rdub4iScKnRwsYva
         DK0txbfEszivCGRC5s9mUkgemSerrxwHfpViU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=w8sfrsgHVCtQ84Mn5xJHmNtgRhniFlIPF8Z5BRF2kCCFo4s+WPfCte8ltf4gOj9gsp
         8thTWBtiwg8cNpuLnbcIe6cbKM/3uvHwkJDRQrjN6Ngps3j+UgF1KO1762KjeiEEcfL2
         eXxr/MIXj4178KasJMYH9B2UW4c4aEl9nFCaQ=
MIME-Version: 1.0
Received: by 10.86.1.1 with SMTP id 1mr2021398fga.42.1249295318072; Mon, 03 
	Aug 2009 03:28:38 -0700 (PDT)
In-Reply-To: <24788000.post@talk.nabble.com>
References: <24753954.post@talk.nabble.com> <ac6e61fc0907310431x32f963e0s5cac50a93516dafe@mail.gmail.com> 
	<24784708.post@talk.nabble.com> <8c4e68610908030232n1831a8c8pe10117e6ca61d2b6@mail.gmail.com> 
	<24788000.post@talk.nabble.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Mon, 3 Aug 2009 11:28:18 +0100
Message-ID: <8c4e68610908030328j40ac2a15w3a9de9e4ce507af9@mail.gmail.com>
Subject: Re: Boosting Search Results
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Sorry, I'm not clear what you don't know how to do.


To spell out the double search suggestion a bit more:

QueryParser qp =3D new QueryParser(...)

Query q1 =3D qp.parse("+word1 +word2");
TopDocs td1 =3D searcher.search(q1, ...)

Query q2 =3D qp.parse("word1 word2");
TopDocs td2 =3D searcher.search(q2);

ScoreDoc[] sd1 =3D td1.scoreDocs;
ScoreDoc[] sd2 =3D td2.scoreDocs;

// Grab all docids from first search
List<Integer> docidl =3D new ArrayList<Integer>();
for (int i1 =3D 0; i1 < sd1.length; i1++) {
  docidl.add(sd1[i1].doc);
}

// Add any docids from second search that are not already on the list
for (int i2 =3D 0; i2 < sd2.length; i2++) {
  int docid =3D sd2[i2].doc);
  if (!docidl.contains(docid)) {
    docidl.add(docid);
  }
}

(code just a suggestion, off the top of my head, may not work, may be
full of bugs, there will be other maybe better ways to do it).

If that doesn't help, perhaps you could rephrase the question.


--
Ian.


On Mon, Aug 3, 2009 at 10:51 AM, bourne71<garylkc@live.com> wrote:
>
> Hey, thanks for the suggestion.
> I think of performing 2 searches as well. Unfortunately I dont know how t=
o
> perform a search on the first results return. Could u guide me a little? =
I
> tried to look around for the information but found none
>
> Thanks
>
> Ian Lea wrote:
>>
>> You could write your own Similarity, extending DefaultSimilarity and
>> overriding whichever methods will help you achieve your aims.
>>
>> Or how about running 2 searches, the first with both words required
>> (+word1 +word2) and then a second search where they aren't both
>> required (word1 word2). =A0Then merge/dedup the two lists of hits,
>> keeping the ones from the first search at the top.
>>
>>
>> --
>> Ian.
>>
>> On Mon, Aug 3, 2009 at 4:14 AM, bourne71<garylkc@live.com> wrote:
>>>
>>> Thanks for all the reply. It help me to understand problem better, but =
is
>>> it
>>> possible to create a query that will give additional boost to the resul=
ts
>>> if
>>> and only if both of the word is found inside the results. This will
>>> definitely make sure that the results will be in the higher up of the
>>> list.
>>>
>>> Can this type of query be created?
>>> --
>>> View this message in context:
>>> http://www.nabble.com/Boosting-Search-Results-tp24753954p24784708.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> --
> View this message in context: http://www.nabble.com/Boosting-Search-Resul=
ts-tp24753954p24788000.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41663-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 13:21:09 2009
Return-Path: <java-user-return-41663-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41611 invoked from network); 3 Aug 2009 13:21:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 13:21:09 -0000
Received: (qmail 97849 invoked by uid 500); 3 Aug 2009 13:21:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97781 invoked by uid 500); 3 Aug 2009 13:21:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97771 invoked by uid 99); 3 Aug 2009 13:21:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 13:21:11 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 13:21:02 +0000
Received: by ywh26 with SMTP id 26so4214069ywh.5
        for <java-user@lucene.apache.org>; Mon, 03 Aug 2009 06:20:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=iukePtEusOu626iPV4ErgMVhZsbu5qQAXQbpuTjoFi4=;
        b=cR3Kwb2otna6i3saLMAVXElguckWFzHwVPi6LY/1uIu2djbPTBy0UBOtYk0L4RqYUV
         +tiUvzm0JpkUJPmK+c8UQn8/bIY2DusPfEfV/SapxpqDXtankjfvFvRqFDFSe9Ovk48V
         x+yCHRKKMbOfHZVO0sSKgKosstNjWd2/3i/nQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=VDdUO7jQob8TLQwYUcRhCvmmAlxaeS1hutU4OLgb7r6pJXIXKIirPf19O4t06M4Vbm
         Eve0Wp4vX3SkbkfU0fOCy9vrfx7jiRUU0vr11IJ7rTlgxS0XdYpNmtD1b1jMYdwm7AEt
         Tw+0iEjDsgXjVK45FdVla4p1R+P4WCQOGfaHQ=
MIME-Version: 1.0
Received: by 10.231.33.137 with SMTP id h9mr1567354ibd.15.1249305640812; Mon, 
	03 Aug 2009 06:20:40 -0700 (PDT)
In-Reply-To: <D84A89F284EF0443AFC11A7FC41E4C6044C36F91@wdccpmail02.markettools.com>
References: <D84A89F284EF0443AFC11A7FC41E4C6044C36F91@wdccpmail02.markettools.com>
Date: Mon, 3 Aug 2009 09:20:40 -0400
Message-ID: <359a92830908030620x4fa56046qfff683c86da05c5d@mail.gmail.com>
Subject: Re: question about
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000325575e5eefc08604703ca2b4
X-Virus-Checked: Checked by ClamAV on apache.org

--000325575e5eefc08604703ca2b4
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

When you construct a Term manually, no analyzers are applied, it'sconstructed
with whatever you put in there, just as you specify it. So,
indeed, it "looks" like a KeywordAnalyzer is being used, but in reality
no analysis is being done.

So what's happening is that when you index with StandardAnalyzer,
your tokens are getting lower-cased and, I assume, you construct
your Terim with upper case, so it's not found.

You probably want to use KeywordAnalyzer for your document IDs
as it's intended to pass through the input without change. Then, as you
see, you'll be able to find things.

See PerFieldAnalyzerWrapper for the way to use different
analyzers on different fields, both an index time and
search time, it might help.

See Luke (google Lucene Luke) for a wonderful tool that
allows you to look at your index and see what's actually
stored as well as what the effect of different analyzers is.

Best
Erick



On Sun, Aug 2, 2009 at 10:44 PM, Leonard Gestrin <
Leonard.Gestrin@markettools.com> wrote:

> Hello,
> I have question about KEYWORD type and searching/updating.  I am getting
> strange behavior that I can't quite comprehend.
> My index is created using standard analyzer, which used for writing and
> searching. It has three fields
>
> userpin - alphanumeric field which is stored as TEXT
> documentkey  - alphanumeric field which is stored as TEXT
> contents - text of document which is stored as TEXT
>
> When I try to update document I am creating Term to find document by
> documentKey and I am using
>
>  org.apache.lucene.index.IndexWriter.updateDocument(term, pDocument);
>
> to do the update.  Lucene fails to find the document by the term and I am
> getting duplicate documents in the index.
> When I changed index to define documentKey as KEYWORD the updates started
> to work fine.
> However, search for documentKey using StandardAnalyzer stopped working.
>
> It appears that lucene is using keywordAnalyzer for searching for the term
> during update, even though the indexer is open with StandardAnalyzer.
>
> The sample values that are stored in documentKeys are: "L2222FAHBHMF",
> "L2222FAHBHAS".
> I noticed if documentKey is numeric value, both KeywordAnalyzer and
> StandardAnalyzer can find the documents by it without any problem thus
> reader can find and indexer can update without any problems. With
> alphanumeric I cant get both to work.
> Any help is appreciated.
> Thanks
> Leonard
>
>
>
>
>
>
>
>
>
>

--000325575e5eefc08604703ca2b4--

From java-user-return-41664-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 16:06:00 2009
Return-Path: <java-user-return-41664-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58584 invoked from network); 3 Aug 2009 16:06:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 16:06:00 -0000
Received: (qmail 37166 invoked by uid 500); 3 Aug 2009 16:06:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37085 invoked by uid 500); 3 Aug 2009 16:06:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37075 invoked by uid 99); 3 Aug 2009 16:06:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 16:06:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 16:05:52 +0000
Received: by ewy26 with SMTP id 26so4168677ewy.5
        for <java-user@lucene.apache.org>; Mon, 03 Aug 2009 09:05:26 -0700 (PDT)
Received: by 10.210.77.13 with SMTP id z13mr7567270eba.26.1249315526422;
        Mon, 03 Aug 2009 09:05:26 -0700 (PDT)
Received: from ?10.0.0.139? ([194.126.15.197])
        by mx.google.com with ESMTPS id 10sm266475eyd.32.2009.08.03.09.05.23
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 03 Aug 2009 09:05:25 -0700 (PDT)
Subject: Re: arabic analyzer
From: walid <walid.bakkar@elementn.com>
To: java-user@lucene.apache.org
In-Reply-To: <8f0ad1f30908021208k34cb5223nd5cd9c6f93ee038d@mail.gmail.com>
References: <1248348847.5882.12.camel@mine-lenovo>
	 <8f0ad1f30907230633i4eef7bc2n58a463c446e6d4e5@mail.gmail.com>
	 <1248422813.5499.6.camel@mine-lenovo>
	 <8f0ad1f30907240539q5f2e3dbak9b90704ded96ed77@mail.gmail.com>
	 <1249172239.5261.4.camel@mine-lenovo>
	 <8f0ad1f30908021208k34cb5223nd5cd9c6f93ee038d@mail.gmail.com>
Content-Type: text/plain; charset="UTF-8"
Date: Mon, 03 Aug 2009 19:05:19 +0300
Message-Id: <1249315519.7368.3.camel@mine-lenovo>
Mime-Version: 1.0
X-Mailer: Evolution 2.26.1 
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hello Robert,

you are so right, plurals based on prefixes and suffixes are working.
Plurals based on inserted "و" do not (باب and ابوب).

The few words i had tested where all of the "insert" type and not the
prefix/suffix.

thank you :)

-walid

On Sun, 2009-08-02 at 15:08 -0400, Robert Muir wrote:
> > the fact is, plural (as an example) is not supported, and that is one of
> > the most common things that a person doing some search will expect to
> 
> Walid, I'm not sure this is true. Many plurals are supported
> (certainly not exceptional cases or broken plurals).
> This is no different than the other language analyzers in lucene, even
> english stemmers: the most common forms are grouped together and thats
> about all you can say :)
> 
> maybe in the future we can improve it though for your particular
> concern, add simple dictionary mappings for at least the most common
> broken plurals, something like that.
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41665-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 16:38:12 2009
Return-Path: <java-user-return-41665-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70546 invoked from network); 3 Aug 2009 16:38:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 16:38:12 -0000
Received: (qmail 95459 invoked by uid 500); 3 Aug 2009 16:38:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95398 invoked by uid 500); 3 Aug 2009 16:38:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95388 invoked by uid 99); 3 Aug 2009 16:38:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 16:38:15 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jibojohn@mac.com designates 17.148.16.87 as permitted sender)
Received: from [17.148.16.87] (HELO asmtpout012.mac.com) (17.148.16.87)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 16:38:03 +0000
MIME-version: 1.0
Content-transfer-encoding: 7BIT
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Received: from la0101a-dhcp214.apple.com ([17.214.14.214])
 by asmtp012.mac.com (Sun Java(tm) System Messaging Server 6.3-8.01 (built Dec
 16 2008; 32bit)) with ESMTPSA id <0KNT00K357IUNG50@asmtp012.mac.com> for
 java-user@lucene.apache.org; Mon, 03 Aug 2009 09:37:43 -0700 (PDT)
Message-id: <483308B7-933B-4496-814C-0715D784836A@mac.com>
From: Jibo John <jibojohn@mac.com>
To: java-user@lucene.apache.org
In-reply-to: <9ac0c6aa0908010208g757a9936vd1150bdec47bc9e9@mail.gmail.com>
Subject: Re: ThreadedIndexWriter vs. IndexWriter
Date: Mon, 03 Aug 2009 09:37:42 -0700
References: <9cafbc680907301111t4768704cy9e4b3092b3d74b17@mail.gmail.com>
 <4A71E9DF.3030404@informatics.jax.org> <4A722D75.9070806@aconex.com>
 <D8AF0747-AEC3-4E5F-AB52-EF62BA460529@mac.com>
 <9ac0c6aa0907310234h798d406bg8cb23d620b022ef8@mail.gmail.com>
 <161DCF62-1E03-4F1B-A590-76ADD91D5434@mac.com>
 <9ac0c6aa0907311452q4f49f1aeua7314b6059b5973@mail.gmail.com>
 <2BC00C69-41B3-48B3-83E7-CBC6DB452CCC@mac.com>
 <9cafbc680907311701g7c8ff0f1n896c4bed2adda9c9@mail.gmail.com>
 <090CF9D7-5D59-47A5-AD2A-86D4BEC6CD15@mac.com>
 <9ac0c6aa0908010208g757a9936vd1150bdec47bc9e9@mail.gmail.com>
X-Mailer: Apple Mail (2.935.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Mike,

Verified that I have the latest source code.
Here are the alg files and the checkindexer output.


----------------------------------------- indexwriter  
alg----------------------------------------------------------------

analyzer=org.apache.lucene.analysis.standard.StandardAnalyzer
doc.maker=org.apache.lucene.benchmark.byTask.feeds.LineDocMaker
directory=FSDirectory

doc.stored = true                                                    #A
docs.file=wikipedia.lines.txt
ram.flush.mb=50
compound=false
merge.factor=5
doc.add.log.step=1000
doc.term.vector=false
doc.term.vector.positions=false
doc.term.vector.offsets=false

{ "Rounds"                                                           #B
  ResetSystemErase
  { "BuildIndex"
   -CreateIndex()
   [ { "AddDocs" AddDoc > : 40000 ] :  
5                                    #C
   -CloseIndex()
  }
  NewRound
} : 1

RepSumByPrefRound BuildIndex                                         #D

-----------------------------------------threadedindexwriter alg  
----------------------------------------------------------------

analyzer=org.apache.lucene.analysis.standard.StandardAnalyzer
doc.maker=org.apache.lucene.benchmark.byTask.feeds.LineDocMaker
directory=FSDirectory

doc.stored = true                                                    #A
docs.file=wikipedia.lines.txt
ram.flush.mb=50
compound=false
merge.factor=5
doc.add.log.step=1000
doc.term.vector=false
doc.term.vector.positions=false
doc.term.vector.offsets=false
writer.num.threads=15
writer.max.thread.queue.size=75
work.dir=work_t


{ "Rounds"                                                           #B
  ResetSystemErase
  { "BuildIndex"
   -CreateThreadedIndex()
    { "AddDocs" AddDoc > : 200000
   -CloseIndex()
  }
  NewRound
} : 1

RepSumByPrefRound BuildIndex                                         #D


-----------------------------------------------threadedindexwriter  
checkindex ----------------------------------------------------------


$ java -classpath /Users/jibo/Desktop/iwork/lucene/java/trunk/build/ 
lucene-core-2.9-dev.jar org.apache.lucene.index.CheckIndex /Users/jibo/ 
Desktop/iwork/lucene/java/trunk/contrib/benchmark/work_t/index

NOTE: testing will be more thorough if you run java with '- 
ea:org.apache.lucene...', so assertions are enabled

Opening index @ /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/ 
benchmark/work_t/index

Segments file=segments_3 numSegments=1 version=FORMAT_DIAGNOSTICS  
[Lucene 2.9]
  1 of 1: name=_p docCount=199941
    compound=true
    hasProx=true
    numFiles=3
    size (MB)=317.1
    diagnostics = {java.version=1.5.0_19, lucene.version=2.9-dev  
779767M - 2009-05-28 17:02:17, os=Mac OS X, os.arch=i386,  
optimize=true, mergeDocStores=false, java.vendor=Apple Inc.,  
os.version=10.5.7, source=merge, mergeFactor=5}
    docStoreOffset=0
    docStoreSegment=_0
    docStoreIsCompoundFile=false
    no deletions
    test: open reader.........OK
    test: fields, norms.......OK [4 fields]
    test: terms, freq, prox...OK [1269552 terms; 67887116 terms/docs  
pairs; 133241176 tokens]
    test: stored fields.......OK [199941 total field count; avg 1  
fields per doc]
    test: term vectors........OK [0 total vector count; avg 0 term/ 
freq vector fields per doc]

No problems were detected with this index.

------------------------------------------indexwriter checkindex  
---------------------------------------------------------------

$ java -classpath /Users/jibo/Desktop/iwork/lucene/java/trunk/build/ 
lucene-core-2.9-dev.jar org.apache.lucene.index.CheckIndex /Users/jibo/ 
Desktop/iwork/lucene/java/trunk/contrib/benchmark/work/index

NOTE: testing will be more thorough if you run java with '- 
ea:org.apache.lucene...', so assertions are enabled

Opening index @ /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/ 
benchmark/work/index

Segments file=segments_a numSegments=1 version=FORMAT_DIAGNOSTICS  
[Lucene 2.9]
  1 of 1: name=_18 docCount=200000
    compound=true
    hasProx=true
    numFiles=1
    size (MB)=427.445
    diagnostics = {java.version=1.5.0_19, lucene.version=2.9-dev  
779767M - 2009-05-28 17:02:17, os=Mac OS X, os.arch=i386,  
optimize=true, mergeDocStores=true, java.vendor=Apple Inc.,  
os.version=10.5.7, source=merge, mergeFactor=4}
    no deletions
    test: open reader.........OK
    test: fields, norms.......OK [4 fields]
    test: terms, freq, prox...OK [3512343 terms; 80020204 terms/docs  
pairs; 163219760 tokens]
    test: stored fields.......OK [200000 total field count; avg 1  
fields per doc]
    test: term vectors........OK [0 total vector count; avg 0 term/ 
freq vector fields per doc]

No problems were detected with this index.

---------------------------------------------------------------------------------------------------------




Thanks,
-Jibo







On Aug 1, 2009, at 2:08 AM, Michael McCandless wrote:

> (Please note that ThreadedIndexWriter is source code available with
> the upcoming revision to Lucene in Action.)
>
> Phil, is it possible you are using an older version of the book's
> source code?  In particular, can you check whether your version of
> ThreadedIndexWriter.java has this:
>
>  public void close(boolean doWait) throws CorruptIndexException,  
> IOException {
>    finish();
>    super.close(doWait);
>  }
>
> (I vaguely remember that being missing from earlier releases, which
> could explain what you're seeing).  If you are missing that, can you
> download the current code from http://www.manning.com/hatcher3 and try
> again?
>
> If that's not the problem... can you post the benchmark alg you are
> using in each case?
>
> Mike
>
> On Fri, Jul 31, 2009 at 8:26 PM, Jibo John<jibojohn@mac.com> wrote:
>> Hi Phil,
>>
>> It's 5 threads for IndexWriter.
>>
>> For ThreadedIndexWriter, I used:
>>
>> writer.num.threads=16
>> writer.max.thread.queue.size=80
>>
>> Thanks,
>> -Jibo
>>
>> On Jul 31, 2009, at 5:01 PM, Phil Whelan wrote:
>>
>>> Hi Jibo,
>>>
>>> Your mergeFactor is different, and the resulting numFiles (segment
>>> files) is different. Maybe each thread is responsible for a segment
>>> file. Just curious - do you have 3 threads?
>>>
>>> Phil
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41666-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 16:40:20 2009
Return-Path: <java-user-return-41666-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71186 invoked from network); 3 Aug 2009 16:40:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 16:40:20 -0000
Received: (qmail 98192 invoked by uid 500); 3 Aug 2009 16:40:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98113 invoked by uid 500); 3 Aug 2009 16:40:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98103 invoked by uid 99); 3 Aug 2009 16:40:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 16:40:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.217.218 as permitted sender)
Received: from [209.85.217.218] (HELO mail-gx0-f218.google.com) (209.85.217.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 16:40:15 +0000
Received: by gxk18 with SMTP id 18so5449740gxk.5
        for <java-user@lucene.apache.org>; Mon, 03 Aug 2009 09:39:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=kpj31LZUfmC+5Op2DjSDxPPH2MnvXm4yoSni7/a/KMY=;
        b=H194UeNKsdc3HSOfUv0pKna5HbM4jUup0lxsC8K+ZDqBlqXT7twjf8XXYc7eqLaW34
         iFwOi0qJmSAPhpNTGvBTUdHPYmOCUk7FSuSjM9cz3yBO3nXNJldv8Q+kqlyKYnyVNCa7
         B0Hb/bnbELecdPq1mjG8vS3hLB9V1OkE/a7qM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=ZuEcBsgTIT77vhmtRj/VPoau1sQUE0RrHMrEbMAR6/pFRQ8IobuJU6Q9Fa6ASvJW1x
         5p1diMYulnIL845jItlfncZ2kCbxf9d69JKkimLQhNEvM1+t4Oq3PxVGeFUv19WdtddZ
         LiKGjXgiDRGJKnWwqY/8V9B3SvGsTadUnr7yg=
MIME-Version: 1.0
Received: by 10.100.154.17 with SMTP id b17mr7237368ane.83.1249317594716; Mon, 
	03 Aug 2009 09:39:54 -0700 (PDT)
In-Reply-To: <1249315519.7368.3.camel@mine-lenovo>
References: <1248348847.5882.12.camel@mine-lenovo>
	 <8f0ad1f30907230633i4eef7bc2n58a463c446e6d4e5@mail.gmail.com>
	 <1248422813.5499.6.camel@mine-lenovo>
	 <8f0ad1f30907240539q5f2e3dbak9b90704ded96ed77@mail.gmail.com>
	 <1249172239.5261.4.camel@mine-lenovo>
	 <8f0ad1f30908021208k34cb5223nd5cd9c6f93ee038d@mail.gmail.com>
	 <1249315519.7368.3.camel@mine-lenovo>
Date: Mon, 3 Aug 2009 12:39:54 -0400
Message-ID: <8f0ad1f30908030939m422065aal56188d9723f14bac@mail.gmail.com>
Subject: Re: arabic analyzer
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Walid, thanks for your feedback.

fyi I created an issue with some minor improvements (such as lam-lam
prefix) to the arabic analyzer:
http://issues.apache.org/jira/browse/LUCENE-1758

I also tried to improve the stopwords list, but your Arabic is surely
much better than mine. If you are interested, have a look perhaps you
could double check :)


On Mon, Aug 3, 2009 at 12:05 PM, walid<walid.bakkar@elementn.com> wrote:
> Hello Robert,
>
> you are so right, plurals based on prefixes and suffixes are working.
> Plurals based on inserted "=D9=88" do not (=D8=A8=D8=A7=D8=A8 and =D8=A7=
=D8=A8=D9=88=D8=A8).
>
> The few words i had tested where all of the "insert" type and not the
> prefix/suffix.
>
> thank you :)
>
> -walid
>
> On Sun, 2009-08-02 at 15:08 -0400, Robert Muir wrote:
>> > the fact is, plural (as an example) is not supported, and that is one =
of
>> > the most common things that a person doing some search will expect to
>>
>> Walid, I'm not sure this is true. Many plurals are supported
>> (certainly not exceptional cases or broken plurals).
>> This is no different than the other language analyzers in lucene, even
>> english stemmers: the most common forms are grouped together and thats
>> about all you can say :)
>>
>> maybe in the future we can improve it though for your particular
>> concern, add simple dictionary mappings for at least the most common
>> broken plurals, something like that.
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41667-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 17:35:34 2009
Return-Path: <java-user-return-41667-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93603 invoked from network); 3 Aug 2009 17:35:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 17:35:34 -0000
Received: (qmail 92807 invoked by uid 500); 3 Aug 2009 17:35:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92709 invoked by uid 500); 3 Aug 2009 17:35:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92699 invoked by uid 99); 3 Aug 2009 17:35:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 17:35:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Leonard.Gestrin@markettools.com designates 72.5.112.151 as permitted sender)
Received: from [72.5.112.151] (HELO mail.markettools.com) (72.5.112.151)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 17:35:28 +0000
Received: from wdccpmail02.markettools.com ([10.64.64.34]) by
 wdccpcas01.markettools.com ([10.64.64.36]) with mapi; Mon, 3 Aug 2009
 10:35:08 -0700
From: Leonard Gestrin <Leonard.Gestrin@markettools.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 3 Aug 2009 10:35:09 -0700
Subject: RE: question about indexing/searching using standardanalyzer for
 	KEYWORD field that contains alphanumeric data
Thread-Topic: question about indexing/searching using standardanalyzer for
 	KEYWORD field that contains alphanumeric data
Thread-Index: AcoUG9non7PfcOL9TbutHomIqtjIsgAQlmig
Message-ID: <D84A89F284EF0443AFC11A7FC41E4C6044C37153@wdccpmail02.markettools.com>
References: <D84A89F284EF0443AFC11A7FC41E4C6044C36F91@wdccpmail02.markettools.com>
 	<D84A89F284EF0443AFC11A7FC41E4C6044C36F92@wdccpmail02.markettools.com>
 <8c4e68610908030221te112407mbf1eccf85a103154@mail.gmail.com>
In-Reply-To: <8c4e68610908030221te112407mbf1eccf85a103154@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Ian
Thank you for reply.
I have recently upgraded the application to lucene 2.4.1

I did not realize that during update operation standard analyzer was not in=
voked on the term same way as it's done for searching even though indexer i=
s open using it. I am a newbie on lucene (I inherited project) - I will do =
some reading as you suggested.
Thanks
Leonard





-----Original Message-----
From: Ian Lea [mailto:ian.lea@gmail.com]=20
Sent: Monday, August 03, 2009 2:21 AM
To: java-user@lucene.apache.org
Subject: Re: question about indexing/searching using standardanalyzer for K=
EYWORD field that contains alphanumeric data

Hi


Storing documentkey as TEXT will be causing it to be passed through
StandardAnalyzer which will be downcasing it, and the index will be
holding "l2222fahbhmf" rather than "L2222FAHBHMF".  When you changed
it to KEYWORD it will have been stored as is so the
updateDocument(term, doc) call will have worked but searching will
have failed because StandardAnalyzer will have downcased it. Numeric
keys will have worked everywhere because they don't get downcased.

See "Why is it important to use the same analyzer type during indexing
and search?" in the FAQ.

The best solution is probably to store it as KEYWORD and use
PerFieldAnalyzerWrapper to specify KeywordAnalyzer for documentkey.
The javadocs have an example showing what you need.


TEXT and KEYWORD haven't been around in lucene for a while.  You might
like to consider upgrading.  Good practice anyway to mention what
version you are using when asking questions.


--
Ian.


On Mon, Aug 3, 2009 at 3:49 AM, Leonard
Gestrin<Leonard.Gestrin@markettools.com> wrote:
>
> Hello,
> I have question about KEYWORD type and searching/updating. =A0I am gettin=
g strange behavior that I can't quite comprehend.
> My index is created using standard analyzer, which used for writing and s=
earching. It has three fields
>
> userpin - alphanumeric field which is stored as TEXT
> documentkey =A0- alphanumeric field which is stored as TEXT
> contents - text of document which is stored as TEXT
>
> When I try to update document I am creating Term to find document by docu=
mentKey and I am using
>
> =A0org.apache.lucene.index.IndexWriter.updateDocument(term, pDocument);
>
> to do the update. =A0Lucene fails to find the document by the term and I =
am getting duplicate documents in the index.
> When I changed index to define documentKey as KEYWORD the updates started=
 to work fine.
> However, search for documentKey using StandardAnalyzer stopped working.
>
> It appears that lucene is using keywordAnalyzer for searching for the ter=
m during update, even though the indexer is open with StandardAnalyzer.
>
> The sample values that are stored in documentKeys are: "L2222FAHBHMF", "L=
2222FAHBHAS".
> I noticed if documentKey is numeric value, both KeywordAnalyzer and Stand=
ardAnalyzer can find the documents by it without any problem thus reader ca=
n find and indexer can update without any problems. With alphanumeric I can=
t get both to work.
> Any help is appreciated.
> Thanks
> Leonard
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41668-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 03 17:37:23 2009
Return-Path: <java-user-return-41668-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94883 invoked from network); 3 Aug 2009 17:37:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Aug 2009 17:37:22 -0000
Received: (qmail 97274 invoked by uid 500); 3 Aug 2009 17:37:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97179 invoked by uid 500); 3 Aug 2009 17:37:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97169 invoked by uid 99); 3 Aug 2009 17:37:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 17:37:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Leonard.Gestrin@markettools.com designates 72.5.112.151 as permitted sender)
Received: from [72.5.112.151] (HELO mail.markettools.com) (72.5.112.151)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Aug 2009 17:37:16 +0000
Received: from wdccpmail02.markettools.com ([10.64.64.34]) by
 wdccpcas01.markettools.com ([10.64.64.36]) with mapi; Mon, 3 Aug 2009
 10:36:54 -0700
From: Leonard Gestrin <Leonard.Gestrin@markettools.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 3 Aug 2009 10:36:55 -0700
Subject: RE: question about
Thread-Topic: question about
Thread-Index: AcoUPUYhqWngD8yGTK6LIzHwvDSwJgAI7Llg
Message-ID: <D84A89F284EF0443AFC11A7FC41E4C6044C37159@wdccpmail02.markettools.com>
References: <D84A89F284EF0443AFC11A7FC41E4C6044C36F91@wdccpmail02.markettools.com>
 <359a92830908030620x4fa56046qfff683c86da05c5d@mail.gmail.com>
In-Reply-To: <359a92830908030620x4fa56046qfff683c86da05c5d@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Thank you

-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]=20
Sent: Monday, August 03, 2009 6:21 AM
To: java-user@lucene.apache.org
Subject: Re: question about

When you construct a Term manually, no analyzers are applied, it'sconstruct=
ed
with whatever you put in there, just as you specify it. So,
indeed, it "looks" like a KeywordAnalyzer is being used, but in reality
no analysis is being done.

So what's happening is that when you index with StandardAnalyzer,
your tokens are getting lower-cased and, I assume, you construct
your Terim with upper case, so it's not found.

You probably want to use KeywordAnalyzer for your document IDs
as it's intended to pass through the input without change. Then, as you
see, you'll be able to find things.

See PerFieldAnalyzerWrapper for the way to use different
analyzers on different fields, both an index time and
search time, it might help.

See Luke (google Lucene Luke) for a wonderful tool that
allows you to look at your index and see what's actually
stored as well as what the effect of different analyzers is.

Best
Erick



On Sun, Aug 2, 2009 at 10:44 PM, Leonard Gestrin <
Leonard.Gestrin@markettools.com> wrote:

> Hello,
> I have question about KEYWORD type and searching/updating.  I am getting
> strange behavior that I can't quite comprehend.
> My index is created using standard analyzer, which used for writing and
> searching. It has three fields
>
> userpin - alphanumeric field which is stored as TEXT
> documentkey  - alphanumeric field which is stored as TEXT
> contents - text of document which is stored as TEXT
>
> When I try to update document I am creating Term to find document by
> documentKey and I am using
>
>  org.apache.lucene.index.IndexWriter.updateDocument(term, pDocument);
>
> to do the update.  Lucene fails to find the document by the term and I am
> getting duplicate documents in the index.
> When I changed index to define documentKey as KEYWORD the updates started
> to work fine.
> However, search for documentKey using StandardAnalyzer stopped working.
>
> It appears that lucene is using keywordAnalyzer for searching for the ter=
m
> during update, even though the indexer is open with StandardAnalyzer.
>
> The sample values that are stored in documentKeys are: "L2222FAHBHMF",
> "L2222FAHBHAS".
> I noticed if documentKey is numeric value, both KeywordAnalyzer and
> StandardAnalyzer can find the documents by it without any problem thus
> reader can find and indexer can update without any problems. With
> alphanumeric I cant get both to work.
> Any help is appreciated.
> Thanks
> Leonard
>
>
>
>
>
>
>
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41669-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 01:36:32 2009
Return-Path: <java-user-return-41669-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17000 invoked from network); 4 Aug 2009 01:36:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 01:36:31 -0000
Received: (qmail 20798 invoked by uid 500); 4 Aug 2009 01:36:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20720 invoked by uid 500); 4 Aug 2009 01:36:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20710 invoked by uid 99); 4 Aug 2009 01:36:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 01:36:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 01:36:24 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MY8wd-0005rB-2b
	for java-user@lucene.apache.org; Mon, 03 Aug 2009 18:36:03 -0700
Message-ID: <24800970.post@talk.nabble.com>
Date: Mon, 3 Aug 2009 18:36:03 -0700 (PDT)
From: bourne71 <garylkc@live.com>
To: java-user@lucene.apache.org
Subject: Re: Boosting Search Results
In-Reply-To: <8c4e68610908030328j40ac2a15w3a9de9e4ce507af9@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: garylkc@live.com
References: <24753954.post@talk.nabble.com> <ac6e61fc0907310431x32f963e0s5cac50a93516dafe@mail.gmail.com> <24784708.post@talk.nabble.com> <8c4e68610908030232n1831a8c8pe10117e6ca61d2b6@mail.gmail.com> <24788000.post@talk.nabble.com> <8c4e68610908030328j40ac2a15w3a9de9e4ce507af9@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Sorry...I mean the double searching part. That is the part I dont understan=
d
how to do...since after retrieving the 1st results, I am not sure how to
search it again.


Ian Lea wrote:
>=20
> Sorry, I'm not clear what you don't know how to do.
>=20
>=20
> To spell out the double search suggestion a bit more:
>=20
> QueryParser qp =3D new QueryParser(...)
>=20
> Query q1 =3D qp.parse("+word1 +word2");
> TopDocs td1 =3D searcher.search(q1, ...)
>=20
> Query q2 =3D qp.parse("word1 word2");
> TopDocs td2 =3D searcher.search(q2);
>=20
> ScoreDoc[] sd1 =3D td1.scoreDocs;
> ScoreDoc[] sd2 =3D td2.scoreDocs;
>=20
> // Grab all docids from first search
> List<Integer> docidl =3D new ArrayList<Integer>();
> for (int i1 =3D 0; i1 < sd1.length; i1++) {
>   docidl.add(sd1[i1].doc);
> }
>=20
> // Add any docids from second search that are not already on the list
> for (int i2 =3D 0; i2 < sd2.length; i2++) {
>   int docid =3D sd2[i2].doc);
>   if (!docidl.contains(docid)) {
>     docidl.add(docid);
>   }
> }
>=20
> (code just a suggestion, off the top of my head, may not work, may be
> full of bugs, there will be other maybe better ways to do it).
>=20
> If that doesn't help, perhaps you could rephrase the question.
>=20
>=20
> --
> Ian.
>=20
>=20
> On Mon, Aug 3, 2009 at 10:51 AM, bourne71<garylkc@live.com> wrote:
>>
>> Hey, thanks for the suggestion.
>> I think of performing 2 searches as well. Unfortunately I dont know how
>> to
>> perform a search on the first results return. Could u guide me a little?
>> I
>> tried to look around for the information but found none
>>
>> Thanks
>>
>> Ian Lea wrote:
>>>
>>> You could write your own Similarity, extending DefaultSimilarity and
>>> overriding whichever methods will help you achieve your aims.
>>>
>>> Or how about running 2 searches, the first with both words required
>>> (+word1 +word2) and then a second search where they aren't both
>>> required (word1 word2). =C2=A0Then merge/dedup the two lists of hits,
>>> keeping the ones from the first search at the top.
>>>
>>>
>>> --
>>> Ian.
>>>
>>> On Mon, Aug 3, 2009 at 4:14 AM, bourne71<garylkc@live.com> wrote:
>>>>
>>>> Thanks for all the reply. It help me to understand problem better, but
>>>> is
>>>> it
>>>> possible to create a query that will give additional boost to the
>>>> results
>>>> if
>>>> and only if both of the word is found inside the results. This will
>>>> definitely make sure that the results will be in the higher up of the
>>>> list.
>>>>
>>>> Can this type of query be created?
>>>> --
>>>> View this message in context:
>>>> http://www.nabble.com/Boosting-Search-Results-tp24753954p24784708.html
>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Boosting-Search-Results-tp24753954p24788000.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Boosting-Search-Results=
-tp24753954p24800970.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41670-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 03:08:45 2009
Return-Path: <java-user-return-41670-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53240 invoked from network); 4 Aug 2009 03:08:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 03:08:45 -0000
Received: (qmail 90602 invoked by uid 500); 4 Aug 2009 03:08:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90533 invoked by uid 500); 4 Aug 2009 03:08:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90523 invoked by uid 99); 4 Aug 2009 03:08:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 03:08:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.58] (HELO web50304.mail.re2.yahoo.com) (206.190.38.58)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 04 Aug 2009 03:08:36 +0000
Received: (qmail 31031 invoked by uid 60001); 4 Aug 2009 03:08:14 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1249355294; bh=m+bHa9cuf9YOwsX7p3Pmr5+p6LxlT3XwMa9XXbgtZew=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=L25GKdQ/0wqEpbeuLe7tA1ccNNQgC7Eu5xhgKlKr/BM7HicgH+oON0xfBYFL1jpCeekRAnVeG54Dc1DFlIK/QgZo78fjNNCDglgtyMAfwj9tq7C3hs1knNEJQucgZiJg/ibCrhVe6NGCF4Rqwi1LSJmXg6Wpwp5zDMLDHkcx63Y=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=Z0osGf2l7pd5UyVKpKYC0Dqp+IT4ftQ6ttyLDdeGz+BhRarsfmCv6ilOyp/Mu83PT9VdzScLVR526DbSOdStIqRM08gg2kQq6asG0dWRrZZPEcDj14LQBylvbXBCcL6xZUJVq/T+6BdwBPc6SSgS7hZwQYsYNDuiBgM5fuRtx1g=;
Message-ID: <810678.30380.qm@web50304.mail.re2.yahoo.com>
X-YMail-OSG: lq1LT5kVM1ku1f2GrX0WrULIOkwd2LE4jEr5VJ8JhFiys88zVai1GrkuvMAnrC4vEYzHIghSmdXw.X4KlmPXN4.NJvBu6tGKnrF9V0HxAnnjX0lucJUIf0epSOUY_KWZKAwTXxQ4OJt6Vr6w7m0_kwDmoACixmPws0kmdtViIklWdp1QXy0mldsehrtl.8ZNTrPt6y4cCm6lq4tT89ePmB3POYvvyI.NXwQNYtAi0tD8TIDNsV5RwjgXw31fqIUKg7YY8Od9wopzouHh7S76x5lmCtLIR2Sq7QwitnK6D.2pqiqavwOsejxNQXc2eLlzk0LTVhvyITx7vSkTe_zh.9pSCmXyOVfKY9.UAA--
Received: from [74.73.24.33] by web50304.mail.re2.yahoo.com via HTTP; Mon, 03 Aug 2009 20:08:14 PDT
X-Mailer: YahooMailRC/1358.22 YahooMailWebService/0.7.338.2
References: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com>
Date: Mon, 3 Aug 2009 20:08:14 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: How to improve search time?
To: java-user@lucene.apache.org
In-Reply-To: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

With such a large index be prepared to put it on a server with lots of RAM (even if you follow all the tips from the Wiki).
When reporting performance numbers, you really ought to tell us about your hardware, types of queries, etc.

Otis
--
Sematext is hiring -- http://sematext.com/about/jobs.html?mls
Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR



----- Original Message ----
> From: prashant ullegaddi <prashullegaddi@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Monday, August 3, 2009 12:33:46 AM
> Subject: How to improve search time?
> 
> Hi,
> 
> I've a single index of size 87GB containing around 50M documents. When I
> search for any query,
> best search time I observed was 8sec. And when query is expanded with
> synonyms, search takes
> minutes (~ 2-3min). Is there a better way to search so that overall search
> time reduces?
> 
> Thanks,
> Prashant.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41671-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 04:39:04 2009
Return-Path: <java-user-return-41671-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67658 invoked from network); 4 Aug 2009 04:39:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 04:39:03 -0000
Received: (qmail 51875 invoked by uid 500); 4 Aug 2009 04:39:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51789 invoked by uid 500); 4 Aug 2009 04:39:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51764 invoked by uid 99); 4 Aug 2009 04:39:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 04:39:06 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of prashullegaddi@gmail.com designates 209.85.222.192 as permitted sender)
Received: from [209.85.222.192] (HELO mail-pz0-f192.google.com) (209.85.222.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 04:38:55 +0000
Received: by pzk30 with SMTP id 30so2883728pzk.5
        for <java-user@lucene.apache.org>; Mon, 03 Aug 2009 21:38:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=6rqAxYtEY+xMPE6mx6NqRBwpdUqUc1MPIM27cXQ/smQ=;
        b=ln/STXeUHKQtm8OSntrFlMqn0yz1zAhrIANpqtsLyLylQRVMNXHc7VIrpmnRVWof8f
         TUBnHLjt6/FYxVlE+i3j1+B1Ewo3NuJDXeg/IiqONX9ouaUHg8caUmiRMTMCBbSjzyL2
         PVbbnRmROq11CpcEDt+zrwQbuPrL6pGmq9XGQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=GkpTyyswfs54xIf/YWk6ih2YFwNGeWNS7STWvU+H3HW+IDsie+AI6LKYYMLAqqq+Em
         8bs2hndWDb/HQUHGODs6u0rT7L3tCIl5b8lkNHwTB3L8Cx6xP3pfNqqXD3vmcMHiywTF
         CyUY1i3vLCDUpdVs5lBiHmi5OOKd0NYI2TjLs=
MIME-Version: 1.0
Received: by 10.140.202.20 with SMTP id z20mr4494474rvf.228.1249360714099; 
	Mon, 03 Aug 2009 21:38:34 -0700 (PDT)
In-Reply-To: <810678.30380.qm@web50304.mail.re2.yahoo.com>
References: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com>
	 <810678.30380.qm@web50304.mail.re2.yahoo.com>
Date: Tue, 4 Aug 2009 10:08:34 +0530
Message-ID: <ac6e61fc0908032138v126c6926u7e9d1245836fd2da@mail.gmail.com>
Subject: Re: How to improve search time?
From: prashant ullegaddi <prashullegaddi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd29cb88f6ecd047049757a
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd29cb88f6ecd047049757a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I'm running it on Quadcore, 2.4GHz each, 4GB RAM.

Prashant.

On Tue, Aug 4, 2009 at 8:38 AM, Otis Gospodnetic <otis_gospodnetic@yahoo.com
> wrote:

> With such a large index be prepared to put it on a server with lots of RAM
> (even if you follow all the tips from the Wiki).
> When reporting performance numbers, you really ought to tell us about your
> hardware, types of queries, etc.
>
> Otis
> --
> Sematext is hiring -- http://sematext.com/about/jobs.html?mls
> Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
>
>
>
> ----- Original Message ----
> > From: prashant ullegaddi <prashullegaddi@gmail.com>
> > To: java-user@lucene.apache.org
> > Sent: Monday, August 3, 2009 12:33:46 AM
> > Subject: How to improve search time?
> >
> > Hi,
> >
> > I've a single index of size 87GB containing around 50M documents. When I
> > search for any query,
> > best search time I observed was 8sec. And when query is expanded with
> > synonyms, search takes
> > minutes (~ 2-3min). Is there a better way to search so that overall
> search
> > time reduces?
> >
> > Thanks,
> > Prashant.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd29cb88f6ecd047049757a--

From java-user-return-41672-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 05:18:49 2009
Return-Path: <java-user-return-41672-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74253 invoked from network); 4 Aug 2009 05:18:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 05:18:49 -0000
Received: (qmail 78755 invoked by uid 500); 4 Aug 2009 05:18:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78682 invoked by uid 500); 4 Aug 2009 05:18:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78672 invoked by uid 99); 4 Aug 2009 05:18:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 05:18:51 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anshumg@gmail.com designates 209.85.212.191 as permitted sender)
Received: from [209.85.212.191] (HELO mail-vw0-f191.google.com) (209.85.212.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 05:18:42 +0000
Received: by vws29 with SMTP id 29so1337457vws.20
        for <java-user@lucene.apache.org>; Mon, 03 Aug 2009 22:18:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=iBq1mJIRNHGicIDvNunH74K0JgVFX39t5E1qZzDLSXk=;
        b=G8zl9s44ANhcuvlIXNX2ElduOVyNWmSvL6WtCfezE281Y5gL2BCeGKDI+nRdj0q1uJ
         eLNRmGizJCK+ldQsk7jZhaj7OIK7FwU69TklnlA2zv0/nZiYjmUE7u4k8yczeEpCsyyu
         cjauz484zywF0Pd93/NqoDMkxlE2goKrWlW9U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=W2DDNR8gOXXZDk6dTxNY2RzY//z+eZvR6TCUmwGa5NQ9JGJ+ykSXR3qimRBLHLIVhI
         HuLghdrmcMKdHdDpa0w+QVn2NhCvntr+8QNwVlLX+HsSuJbsLS3QrTdsKKc74/Wyy76G
         2HRK/C4aL/EwO5iVTGpiwv0fUP5q3F4Kigr0w=
MIME-Version: 1.0
Received: by 10.220.90.199 with SMTP id j7mr6022541vcm.57.1249363101699; Mon, 
	03 Aug 2009 22:18:21 -0700 (PDT)
In-Reply-To: <ac6e61fc0908032138v126c6926u7e9d1245836fd2da@mail.gmail.com>
References: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com>
	 <810678.30380.qm@web50304.mail.re2.yahoo.com>
	 <ac6e61fc0908032138v126c6926u7e9d1245836fd2da@mail.gmail.com>
Date: Tue, 4 Aug 2009 10:48:21 +0530
Message-ID: <867513fe0908032218r552b34f1vf4c0431b17de0571@mail.gmail.com>
Subject: Re: How to improve search time?
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e645b9bedf507404704a0333
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e645b9bedf507404704a0333
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Prashant,
8 seconds as the minimum time is a little too much, though considering
you're using just 4G of RAM its still ok.
I would advice you to break your index into smaller indexes, perhaps
selectively query the indexes (if that's possible for your application) and
use a parallelmultisearcher. Its just something that you might try and like.
All said and done, parallelizing would only get you a bell-curve like
performance graph, so you'd have to figure out the sweet spot there.

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Tue, Aug 4, 2009 at 10:08 AM, prashant ullegaddi <
prashullegaddi@gmail.com> wrote:

> I'm running it on Quadcore, 2.4GHz each, 4GB RAM.
>
> Prashant.
>
> On Tue, Aug 4, 2009 at 8:38 AM, Otis Gospodnetic <
> otis_gospodnetic@yahoo.com
> > wrote:
>
> > With such a large index be prepared to put it on a server with lots of
> RAM
> > (even if you follow all the tips from the Wiki).
> > When reporting performance numbers, you really ought to tell us about
> your
> > hardware, types of queries, etc.
> >
> > Otis
> > --
> > Sematext is hiring -- http://sematext.com/about/jobs.html?mls
> > Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
> >
> >
> >
> > ----- Original Message ----
> > > From: prashant ullegaddi <prashullegaddi@gmail.com>
> > > To: java-user@lucene.apache.org
> > > Sent: Monday, August 3, 2009 12:33:46 AM
> > > Subject: How to improve search time?
> > >
> > > Hi,
> > >
> > > I've a single index of size 87GB containing around 50M documents. When
> I
> > > search for any query,
> > > best search time I observed was 8sec. And when query is expanded with
> > > synonyms, search takes
> > > minutes (~ 2-3min). Is there a better way to search so that overall
> > search
> > > time reduces?
> > >
> > > Thanks,
> > > Prashant.
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--0016e645b9bedf507404704a0333--

From java-user-return-41673-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 05:32:40 2009
Return-Path: <java-user-return-41673-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80326 invoked from network); 4 Aug 2009 05:32:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 05:32:40 -0000
Received: (qmail 88879 invoked by uid 500); 4 Aug 2009 05:32:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88801 invoked by uid 500); 4 Aug 2009 05:32:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88791 invoked by uid 99); 4 Aug 2009 05:32:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 05:32:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 05:32:33 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MYCdA-0005Yg-UK
	for java-user@lucene.apache.org; Mon, 03 Aug 2009 22:32:12 -0700
Message-ID: <24802552.post@talk.nabble.com>
Date: Mon, 3 Aug 2009 22:32:12 -0700 (PDT)
From: "m.harig" <m.harig@gmail.com>
To: java-user@lucene.apache.org
Subject: Searching doubt
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.harig@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


hello all

          thanks for lucene............ this is my doubt , am searching for
a keyword "about us" from my lucene index , am not getting the results what
i want , since the urls are formed like the below 

                                http://www........./aboutus/.....abc/
                                http://www........./aboutus/.....xyz/
                                http://www........./aboutus/.....def/

         if i search "aboutus" , the results coming up correctly. Please
any1 suggest me how to handle this situation. 
-- 
View this message in context: http://www.nabble.com/Searching-doubt-tp24802552p24802552.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41674-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 06:20:51 2009
Return-Path: <java-user-return-41674-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4909 invoked from network); 4 Aug 2009 06:20:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 06:20:51 -0000
Received: (qmail 22087 invoked by uid 500); 4 Aug 2009 06:20:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22001 invoked by uid 500); 4 Aug 2009 06:20:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21991 invoked by uid 99); 4 Aug 2009 06:20:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 06:20:54 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of anshumg@gmail.com designates 209.85.221.203 as permitted sender)
Received: from [209.85.221.203] (HELO mail-qy0-f203.google.com) (209.85.221.203)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 06:20:43 +0000
Received: by qyk41 with SMTP id 41so4811457qyk.29
        for <java-user@lucene.apache.org>; Mon, 03 Aug 2009 23:20:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=EhEUqKr+ZEHRlJHPvqrvyrtvh2p9bKdnKgsLlp1v65M=;
        b=MvkOfmbFrFkbGp+/PlA9y+YM6D43a6ZID6JdIkcqP75P5nak1IWj4CgxLYYVcj7JKS
         Sj0LK0Gjk2pq4VKSa2cslYVmYzHiefHyEJ0Fdhj/Hg25+F9CPqZS+4FlC6BCnA8znC5M
         MInaGRmG7dCMLxRVS707VKj+/wh7u/7nK9XwI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ipA/xiLekkzP94az9tl36cQpuiPi7pQy1XqkVZI5ERSA+/paYCswxAD2ydHMmpSQem
         bu7sX0vgEpmg8ntdKcIXVdsCI+qbuIHLf//NjL3T8gIliBMjSjZnZqypqdWL2iTbZhHM
         dwQLg3IYgdrTMmYKGtANEg30Yth9LVXKNLl98=
MIME-Version: 1.0
Received: by 10.220.96.67 with SMTP id g3mr6022128vcn.63.1249366821956; Mon, 
	03 Aug 2009 23:20:21 -0700 (PDT)
In-Reply-To: <24802552.post@talk.nabble.com>
References: <24802552.post@talk.nabble.com>
Date: Tue, 4 Aug 2009 11:50:21 +0530
Message-ID: <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com>
Subject: Re: Searching doubt
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e646991c9ded2a04704ae1e3
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e646991c9ded2a04704ae1e3
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Harig,
What you are trying to do is search for 2 tokens as one. You'd have to index
the url as you want for the token to be searchable. Else you might try a
wildcard query .

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Tue, Aug 4, 2009 at 11:02 AM, m.harig <m.harig@gmail.com> wrote:

>
> hello all
>
>          thanks for lucene............ this is my doubt , am searching for
> a keyword "about us" from my lucene index , am not getting the results what
> i want , since the urls are formed like the below
>
>                                http://www........./aboutus/.....abc/
>                                http://www........./aboutus/.....xyz/
>                                http://www........./aboutus/.....def/
>
>         if i search "aboutus" , the results coming up correctly. Please
> any1 suggest me how to handle this situation.
> --
> View this message in context:
> http://www.nabble.com/Searching-doubt-tp24802552p24802552.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e646991c9ded2a04704ae1e3--

From java-user-return-41675-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 06:46:40 2009
Return-Path: <java-user-return-41675-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11775 invoked from network); 4 Aug 2009 06:46:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 06:46:40 -0000
Received: (qmail 40489 invoked by uid 500); 4 Aug 2009 06:46:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40394 invoked by uid 500); 4 Aug 2009 06:46:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40384 invoked by uid 99); 4 Aug 2009 06:46:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 06:46:43 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 06:46:32 +0000
Received: by ewy26 with SMTP id 26so4646227ewy.5
        for <java-user@lucene.apache.org>; Mon, 03 Aug 2009 23:46:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=9M6tatq+mryNGcpnL2nVkQRRWAUnXH1DQ/KdZpO7Vt8=;
        b=nSmpEXzj0m0cxqfID1e+CJprP/wx62KHokpSH5z+fIoT7E10Gf7cOHou6YUKDNGuxh
         mLkKY1hUlUwVtwn/NPjiFGysQnhDHrHcypdtEpfAtWYxbi9sHwnzfFWwVejFVenh0mIk
         jc3P8u05mr9SAgAV8MBCCyoBza3AuJ85biPNk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=CpOsEM9ASw56zympe3x4se5ykHWxbny8JXZqD1WDt4EOxZ6jRHm2WCBbtac20wX5YI
         v1YMcfVZk/YCuIkY/y5LHkDXZNhM4XuA+AoeqoPEISEsVShEcIxgnnFZA08EnWnvjHr7
         0TSZngH4IJjDs60Qxs2dr8S2rcchHz91J+Qx0=
MIME-Version: 1.0
Received: by 10.216.87.71 with SMTP id x49mr1435725wee.11.1249368371757; Mon, 
	03 Aug 2009 23:46:11 -0700 (PDT)
In-Reply-To: <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com>
References: <24802552.post@talk.nabble.com>
	 <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com>
Date: Tue, 4 Aug 2009 09:46:11 +0300
Message-ID: <786fde50908032346p6c2369ddje5aec4bc1959a092@mail.gmail.com>
Subject: Re: Searching doubt
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d63f8afe055604704b3df0
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d63f8afe055604704b3df0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I can think of another approach - during indexing, capture the word
"aboutus" and index it as "about us" and "aboutus" in the same position.
That way both queries will work. You'd need to write your own TokenFilter,
maybe a SynonymTokenFilter (since this reminds me of "synonyms" usage) that
accept a list of words and their "matching counterparts" ... something along
those lines.

Another thing, which is basically the same, but from the other side -->
check the query string for such words and replace them w/ what you want. So
you can search for "about us" in the query string and replace it w/
"aboutus".

I prefer the first approach since it's much more performing, but is more
complicated than the second one. It will also allow you to handle other
cases like that.

Shai

On Tue, Aug 4, 2009 at 9:20 AM, Anshum <anshumg@gmail.com> wrote:

> Hi Harig,
> What you are trying to do is search for 2 tokens as one. You'd have to
> index
> the url as you want for the token to be searchable. Else you might try a
> wildcard query .
>
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
>
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
>
>
> On Tue, Aug 4, 2009 at 11:02 AM, m.harig <m.harig@gmail.com> wrote:
>
> >
> > hello all
> >
> >          thanks for lucene............ this is my doubt , am searching
> for
> > a keyword "about us" from my lucene index , am not getting the results
> what
> > i want , since the urls are formed like the below
> >
> >                                http://www........./aboutus/.....abc/
> >                                http://www........./aboutus/.....xyz/
> >                                http://www........./aboutus/.....def/
> >
> >         if i search "aboutus" , the results coming up correctly. Please
> > any1 suggest me how to handle this situation.
> > --
> > View this message in context:
> > http://www.nabble.com/Searching-doubt-tp24802552p24802552.html
> > Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--0016e6d63f8afe055604704b3df0--

From java-user-return-41676-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 06:47:04 2009
Return-Path: <java-user-return-41676-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11847 invoked from network); 4 Aug 2009 06:47:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 06:47:04 -0000
Received: (qmail 42199 invoked by uid 500); 4 Aug 2009 06:47:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42117 invoked by uid 500); 4 Aug 2009 06:47:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42107 invoked by uid 99); 4 Aug 2009 06:47:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 06:47:07 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 06:46:57 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MYDnB-00081v-0C
	for java-user@lucene.apache.org; Mon, 03 Aug 2009 23:46:37 -0700
Message-ID: <24803073.post@talk.nabble.com>
Date: Mon, 3 Aug 2009 23:46:37 -0700 (PDT)
From: "m.harig" <m.harig@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Searching doubt
In-Reply-To: <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.harig@gmail.com
References: <24802552.post@talk.nabble.com> <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks
            
           This is my codw snippet

               IndexSearcher searcher = new IndexSearcher(indexDir);
		Analyzer analyzer = new StopAnalyzer();

		WildcardQuery query = new WildcardQuery(new Term(DEFAULT_FIELD)); 
                searcher.search(query); 

 but its returning 0 hits as results , where am i wrong? please help me out
of this.

-- 
View this message in context: http://www.nabble.com/Searching-doubt-tp24802552p24803073.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41677-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 06:55:15 2009
Return-Path: <java-user-return-41677-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13927 invoked from network); 4 Aug 2009 06:55:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 06:55:15 -0000
Received: (qmail 62436 invoked by uid 500); 4 Aug 2009 06:55:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62351 invoked by uid 500); 4 Aug 2009 06:55:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62341 invoked by uid 99); 4 Aug 2009 06:55:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 06:55:17 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 06:55:06 +0000
Received: by ewy26 with SMTP id 26so4649557ewy.5
        for <java-user@lucene.apache.org>; Mon, 03 Aug 2009 23:54:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=zaSR7tgOJVOO46gJ06yEpPLdGVaitOeT9mO64Gdl8TA=;
        b=m7f5XtxeqEziHvRP4qL5mEBkqergC0y7WTx3chzdgf8YRskWPEh9LBMsNO2KJXn24T
         bIkCHYoU9IDGwXghVF66Tc/iUKb10NWxOczlmIXEhilOGo/+r3jOFkcChw+CzJts91Tr
         55Vw0USHqgJ4lyiKDWcI85gdwHrP17UkFBGFk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=wQ7CszsurcYyfOOlHASJb55Kit3MH919b8kNBvI/NGIBHSpSr+Fac7KdmvgQEauxAd
         Zx3GSJ9TUTNRjYT2P+Qgk7UYR1daX+KrCfr8hJyGSgJa3sNLlOEM6fZpiMbe1EZkjmGT
         MVKJc5y6+QMOMmXnAb3g5ioviXPTH0KkQY4Dg=
MIME-Version: 1.0
Received: by 10.216.13.194 with SMTP id b44mr1370647web.139.1249368886426; 
	Mon, 03 Aug 2009 23:54:46 -0700 (PDT)
In-Reply-To: <24803073.post@talk.nabble.com>
References: <24802552.post@talk.nabble.com>
	 <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com>
	 <24803073.post@talk.nabble.com>
Date: Tue, 4 Aug 2009 09:54:46 +0300
Message-ID: <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com>
Subject: Re: Searching doubt
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64c1bbeab3b5e04704b5cff
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64c1bbeab3b5e04704b5cff
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I don't see that you use the Analyzer anywhere (i.e. it's created by not
used?).

Also, the wildcard query you create may be very inefficient, as it will
expand all the terms under the DEFAULT_FIELD. If the DEFAULT_FIELD is the
field where all your "default searchable" terms are indexed, there could be
tens of thousands to millions of terms (depends on how many documents you
add).

Also, what exactly do you expect that this query will return? All docs? Is
the word "aboutus" there?

Maybe you should do the following:
WildcardQuery wq = new WildcardQuery(new Term(DEFAULT_FIELD, "about"));
searcher.search(wq);

This should work, if the urls are indexed under the DEFAULT_FIELD.

Shai

On Tue, Aug 4, 2009 at 9:46 AM, m.harig <m.harig@gmail.com> wrote:

>
> Thanks
>
>           This is my codw snippet
>
>               IndexSearcher searcher = new IndexSearcher(indexDir);
>                Analyzer analyzer = new StopAnalyzer();
>
>                WildcardQuery query = new WildcardQuery(new
> Term(DEFAULT_FIELD));
>                searcher.search(query);
>
>  but its returning 0 hits as results , where am i wrong? please help me out
> of this.
>
> --
> View this message in context:
> http://www.nabble.com/Searching-doubt-tp24802552p24803073.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64c1bbeab3b5e04704b5cff--

From java-user-return-41678-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 07:19:21 2009
Return-Path: <java-user-return-41678-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17324 invoked from network); 4 Aug 2009 07:19:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 07:19:21 -0000
Received: (qmail 79368 invoked by uid 500); 4 Aug 2009 07:19:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79294 invoked by uid 500); 4 Aug 2009 07:19:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79277 invoked by uid 99); 4 Aug 2009 07:19:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 07:19:24 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of prashullegaddi@gmail.com designates 209.85.198.239 as permitted sender)
Received: from [209.85.198.239] (HELO rv-out-0506.google.com) (209.85.198.239)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 07:19:14 +0000
Received: by rv-out-0506.google.com with SMTP id b25so1170732rvf.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 00:18:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=z/Kycj27ZLRgzy0QCcS/tKlOqO5DKPesLpHqT6f4Kbg=;
        b=inxI5Wr7GcPFJ2oiLb/CZuNgr1aQ5DGEfPgDC2wFX2dLSGfhtq2oWDEcMDU/hkVOzg
         jLFw3RzdB6GZQ5FMOSKCn7YU9m4y1rcOTSAn2AN+YOnnY5qlv4tZc1QUEdZJWGsk/BCU
         mcUKPArxhdAQDJMMnLc0eXZZThtVHHGFbRaz4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=FsMOVIOM35Z3lqRlRq+WlBdF0aclfpPsLVcyNtgNYIbkDH0jm+UL54cdmBYcXZ08eN
         nmzzVWXLErPA2e5bj8QeK0KVq6779SXgZ/BmKJfHp9DNy6H2n1t5fmXYFro4hwLIdmLR
         NmBV9hZfSjVcbRRNXPylQkXumKHUNMaq0fxr8=
MIME-Version: 1.0
Received: by 10.141.21.3 with SMTP id y3mr4704350rvi.279.1249370334432; Tue, 
	04 Aug 2009 00:18:54 -0700 (PDT)
In-Reply-To: <867513fe0908032218r552b34f1vf4c0431b17de0571@mail.gmail.com>
References: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com>
	 <810678.30380.qm@web50304.mail.re2.yahoo.com>
	 <ac6e61fc0908032138v126c6926u7e9d1245836fd2da@mail.gmail.com>
	 <867513fe0908032218r552b34f1vf4c0431b17de0571@mail.gmail.com>
Date: Tue, 4 Aug 2009 12:48:54 +0530
Message-ID: <ac6e61fc0908040018y73392a0ax74497dc1515a3564@mail.gmail.com>
Subject: Re: How to improve search time?
From: prashant ullegaddi <prashullegaddi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1a234fa0c5404704bb2f3
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1a234fa0c5404704bb2f3
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I did that as well. Actually, we had 32 indexes initially. We searched them.
It was even horrible.
After that I merged them into 4 indexes. And did the same. No gain!

Then, I had to merge 32 indexes into one.

On Tue, Aug 4, 2009 at 10:48 AM, Anshum <anshumg@gmail.com> wrote:

> Hi Prashant,
> 8 seconds as the minimum time is a little too much, though considering
> you're using just 4G of RAM its still ok.
> I would advice you to break your index into smaller indexes, perhaps
> selectively query the indexes (if that's possible for your application) and
> use a parallelmultisearcher. Its just something that you might try and
> like.
> All said and done, parallelizing would only get you a bell-curve like
> performance graph, so you'd have to figure out the sweet spot there.
>
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
>
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
>
>
> On Tue, Aug 4, 2009 at 10:08 AM, prashant ullegaddi <
> prashullegaddi@gmail.com> wrote:
>
> > I'm running it on Quadcore, 2.4GHz each, 4GB RAM.
> >
> > Prashant.
> >
> > On Tue, Aug 4, 2009 at 8:38 AM, Otis Gospodnetic <
> > otis_gospodnetic@yahoo.com
> > > wrote:
> >
> > > With such a large index be prepared to put it on a server with lots of
> > RAM
> > > (even if you follow all the tips from the Wiki).
> > > When reporting performance numbers, you really ought to tell us about
> > your
> > > hardware, types of queries, etc.
> > >
> > > Otis
> > > --
> > > Sematext is hiring -- http://sematext.com/about/jobs.html?mls
> > > Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
> > >
> > >
> > >
> > > ----- Original Message ----
> > > > From: prashant ullegaddi <prashullegaddi@gmail.com>
> > > > To: java-user@lucene.apache.org
> > > > Sent: Monday, August 3, 2009 12:33:46 AM
> > > > Subject: How to improve search time?
> > > >
> > > > Hi,
> > > >
> > > > I've a single index of size 87GB containing around 50M documents.
> When
> > I
> > > > search for any query,
> > > > best search time I observed was 8sec. And when query is expanded with
> > > > synonyms, search takes
> > > > minutes (~ 2-3min). Is there a better way to search so that overall
> > > search
> > > > time reduces?
> > > >
> > > > Thanks,
> > > > Prashant.
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
>

--000e0cd1a234fa0c5404704bb2f3--

From java-user-return-41679-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 07:29:53 2009
Return-Path: <java-user-return-41679-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18810 invoked from network); 4 Aug 2009 07:29:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 07:29:53 -0000
Received: (qmail 89809 invoked by uid 500); 4 Aug 2009 07:29:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89748 invoked by uid 500); 4 Aug 2009 07:29:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89738 invoked by uid 99); 4 Aug 2009 07:29:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 07:29:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 07:29:46 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MYESc-0001O8-AP
	for java-user@lucene.apache.org; Tue, 04 Aug 2009 00:29:26 -0700
Message-ID: <24803560.post@talk.nabble.com>
Date: Tue, 4 Aug 2009 00:29:26 -0700 (PDT)
From: "m.harig" <m.harig@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Searching doubt
In-Reply-To: <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.harig@gmail.com
References: <24802552.post@talk.nabble.com> <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com> <24803073.post@talk.nabble.com> <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks for your reply, 

  my original code snippet is

                 IndexSearcher searcher = new IndexSearcher(indexDir);
		Analyzer analyzer = new StopAnalyzer();

		BooleanClause.Occur[] flags = { BooleanClause.Occur.SHOULD,
				BooleanClause.Occur.SHOULD, BooleanClause.Occur.SHOULD,
				BooleanClause.Occur.SHOULD, BooleanClause.Occur.SHOULD };

		// for multiple keyword search
		Query query = MultiFieldQueryParser.parse(qryStr, new String[] {
				"title", "path", "contents", "summary", "size" }, flags,
				analyzer);

		Hits hits = getHits(qryStr, searcher, query, "path");


		for (int inc = 0; inc < hits.length(); inc++) {

			Document doc = hits.doc(inc);
				///////

		}
          

         // private method to get hits by using phrase query
	
	private Hits getHits(String qryStr, Searcher searcher, Query queryNorm,
			String phraseQryTerm) throws Exception {

		Hits hits = null;

		// for single word search
		PhraseQuery queryPhrase = new PhraseQuery();
		queryPhrase.setBoost(4.0f);
		queryPhrase.setSlop(1);
		queryPhrase.add(new Term(phraseQryTerm, qryStr.toLowerCase()));

		hits = searcher.search(queryPhrase);

		return hits;
	}


   if i use this code for my search , it gives me the unwanted search hits , 

      as i mentioned , if i search for "about us" , this is an example ,
there may be more number of urls like this ,  for example , "credit cards" ,
"book marks" , how do i handle it ?
-- 
View this message in context: http://www.nabble.com/Searching-doubt-tp24802552p24803560.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41680-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 08:01:54 2009
Return-Path: <java-user-return-41680-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24413 invoked from network); 4 Aug 2009 08:01:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 08:01:54 -0000
Received: (qmail 19665 invoked by uid 500); 4 Aug 2009 08:01:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19582 invoked by uid 500); 4 Aug 2009 08:01:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19571 invoked by uid 99); 4 Aug 2009 08:01:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 08:01:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of shashi.mit@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 08:01:46 +0000
Received: by ywh26 with SMTP id 26so4983982ywh.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 01:01:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=hRMoG1bIIrICuKUucieMhJbwGmXTCjvxvDfEFGvIKos=;
        b=CSGu2l55kfM7TMcZFLUg5gfh6Y85w8wF4Cgw71OfFfUhtRXYJTc62DHLAx6pkheiBT
         khZ6NOsuxVlqfp5mVvvx0EeKH01bndSSX9e+Ir/vohcKo8r8z+LMd5kCO5Ikpxn94TlJ
         2oMW6yV3dhO1FUKrHQfEPu6C/Qyob56ah74SQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=MD33koEXKhy+kqUWPnWorS5alWXj7QzpdwQnyD1EZMK7tDlEFIGelj2dGZzUVgqBl9
         WjgOvrHDjTpcCGJCKYPkTeTpfJu49dwzGplMjASVTbfdJjgi//jjgVZMq8c6yqU2FPLq
         9ThftrKwPbRnZYY/DPkKu9gqiWcBIADJaxQvM=
MIME-Version: 1.0
Received: by 10.150.203.2 with SMTP id a2mr393671ybg.22.1249372885084; Tue, 04 
	Aug 2009 01:01:25 -0700 (PDT)
In-Reply-To: <ac6e61fc0908040018y73392a0ax74497dc1515a3564@mail.gmail.com>
References: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com> 
	<810678.30380.qm@web50304.mail.re2.yahoo.com> <ac6e61fc0908032138v126c6926u7e9d1245836fd2da@mail.gmail.com> 
	<867513fe0908032218r552b34f1vf4c0431b17de0571@mail.gmail.com> 
	<ac6e61fc0908040018y73392a0ax74497dc1515a3564@mail.gmail.com>
From: Shashi Kant <shashi.mit@gmail.com>
Date: Tue, 4 Aug 2009 04:01:05 -0400
Message-ID: <4d19a3630908040101l5a89bff2g1f900ea1f515c4eb@mail.gmail.com>
Subject: Re: How to improve search time?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Prashant, I have had better luck with even larger sized indices on
similar platforms. Could you elaborate what types of queries you are
running, Multifield? Boolean? combinations? etc. Also you might want
to remove unnecessary stored fields from the index and move them to a
relational db to squeeze out better performance.


Shashi


On Tue, Aug 4, 2009 at 3:18 AM, prashant
ullegaddi<prashullegaddi@gmail.com> wrote:
> I did that as well. Actually, we had 32 indexes initially. We searched them.
> It was even horrible.
> After that I merged them into 4 indexes. And did the same. No gain!
>
> Then, I had to merge 32 indexes into one.
>
> On Tue, Aug 4, 2009 at 10:48 AM, Anshum <anshumg@gmail.com> wrote:
>
>> Hi Prashant,
>> 8 seconds as the minimum time is a little too much, though considering
>> you're using just 4G of RAM its still ok.
>> I would advice you to break your index into smaller indexes, perhaps
>> selectively query the indexes (if that's possible for your application) and
>> use a parallelmultisearcher. Its just something that you might try and
>> like.
>> All said and done, parallelizing would only get you a bell-curve like
>> performance graph, so you'd have to figure out the sweet spot there.
>>
>> --
>> Anshum Gupta
>> Naukri Labs!
>> http://ai-cafe.blogspot.com
>>
>> The facts expressed here belong to everybody, the opinions to me. The
>> distinction is yours to draw............
>>
>>
>> On Tue, Aug 4, 2009 at 10:08 AM, prashant ullegaddi <
>> prashullegaddi@gmail.com> wrote:
>>
>> > I'm running it on Quadcore, 2.4GHz each, 4GB RAM.
>> >
>> > Prashant.
>> >
>> > On Tue, Aug 4, 2009 at 8:38 AM, Otis Gospodnetic <
>> > otis_gospodnetic@yahoo.com
>> > > wrote:
>> >
>> > > With such a large index be prepared to put it on a server with lots of
>> > RAM
>> > > (even if you follow all the tips from the Wiki).
>> > > When reporting performance numbers, you really ought to tell us about
>> > your
>> > > hardware, types of queries, etc.
>> > >
>> > > Otis
>> > > --
>> > > Sematext is hiring -- http://sematext.com/about/jobs.html?mls
>> > > Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
>> > >
>> > >
>> > >
>> > > ----- Original Message ----
>> > > > From: prashant ullegaddi <prashullegaddi@gmail.com>
>> > > > To: java-user@lucene.apache.org
>> > > > Sent: Monday, August 3, 2009 12:33:46 AM
>> > > > Subject: How to improve search time?
>> > > >
>> > > > Hi,
>> > > >
>> > > > I've a single index of size 87GB containing around 50M documents.
>> When
>> > I
>> > > > search for any query,
>> > > > best search time I observed was 8sec. And when query is expanded with
>> > > > synonyms, search takes
>> > > > minutes (~ 2-3min). Is there a better way to search so that overall
>> > > search
>> > > > time reduces?
>> > > >
>> > > > Thanks,
>> > > > Prashant.
>> > >
>> > >
>> > > ---------------------------------------------------------------------
>> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > > For additional commands, e-mail: java-user-help@lucene.apache.org
>> > >
>> > >
>> >
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41681-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 08:28:39 2009
Return-Path: <java-user-return-41681-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29597 invoked from network); 4 Aug 2009 08:28:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 08:28:38 -0000
Received: (qmail 49348 invoked by uid 500); 4 Aug 2009 08:28:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49260 invoked by uid 500); 4 Aug 2009 08:28:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49250 invoked by uid 99); 4 Aug 2009 08:28:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 08:28:41 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 08:28:30 +0000
Received: by ewy22 with SMTP id 22so3376528ewy.28
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 01:28:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ciZhjRF+xzlbV1rvHM+f4DriDsq1gIxOWkAz59n6/Hc=;
        b=bEEHCMhJ+hbs6hgLmpWoNH3B4qEmlNASDfs+yVyZTb3HmuAj+WYOxMBWK9h0FT0zLr
         00+bJefJ7T5YbkP1zJCDDESDg4XSNhQlIWSqG71yRs31dR/3gqOpYqJTyWS3WUQwCP6o
         SLaDR4H4lubO3CBIprh4UkATzEDaahDIjLwGI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=oZitHzgPv2vrFoE3jgQadz+ctqFdCgoz4pUsEjwjVsdI4pNlbBUK4VJmhaFMLgtjAw
         U+FfG/yYH+nZrdu9vjtzNMhuNn22Avg0TLYrKpDXQn+Xl5fPEN67ry3o798YzqBZRaFy
         hI+npmR8jfKcYsXdakigHIAm3jPK2rybW6Vtw=
MIME-Version: 1.0
Received: by 10.216.35.204 with SMTP id u54mr1329605wea.182.1249374489960; 
	Tue, 04 Aug 2009 01:28:09 -0700 (PDT)
In-Reply-To: <24803560.post@talk.nabble.com>
References: <24802552.post@talk.nabble.com>
	 <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com>
	 <24803073.post@talk.nabble.com>
	 <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com>
	 <24803560.post@talk.nabble.com>
Date: Tue, 4 Aug 2009 11:28:09 +0300
Message-ID: <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com>
Subject: Re: Searching doubt
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016365ee910aa609304704caa03
X-Virus-Checked: Checked by ClamAV on apache.org

--0016365ee910aa609304704caa03
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Well, if you have more cases like "aboutus", then I think the TokenFilter
approach will help you. You should create your own Analyzer which receives
another Analyzer as argument, and impl it's tokenStream() like this (it's
the general idea):

public TokenStream tokenStream(String fld, Reader reader) {
  TokenStream ts = wrappedAnalyzer.tokenStream(fld, reader);
  ts = new SynonymTokenFilter(ts);
  return ts;
}

You can look in contrib/highlighter for a SynonymAnalyzer (an inner class of
HighlighterTest.java). Maybe you can copy some of the code from there.

The idea for this SynonymTokenFilter is to get a map like this:
aboutus --> [about us]
creditcards --> [credit cards], [visa] (the latter is just an example for
another synonym you can use)
....
Then when the filter encounters a Token, it looks it up in the map and
replaces it w/ the ones in the map, or returns it and its synonyms. You
should make sure all synonyms are placed in the same position (i.e.,
setPositionIncrement(0)).

If you know these strings appear just in a "url" field, you can apply this
token filter for just the url field, and save a lot of unnecessary token
lookups in the map. To do this, you should extend Analyzer and override
tokenStream and return this filter for just the "url" field (notice
tokenStream receives the field name as arg).

Hope this helps,

Shai

On Tue, Aug 4, 2009 at 10:29 AM, m.harig <m.harig@gmail.com> wrote:

>
> Thanks for your reply,
>
>  my original code snippet is
>
>                 IndexSearcher searcher = new IndexSearcher(indexDir);
>                Analyzer analyzer = new StopAnalyzer();
>
>                 BooleanClause.Occur[] flags = { BooleanClause.Occur.SHOULD,
>                                BooleanClause.Occur.SHOULD,
> BooleanClause.Occur.SHOULD,
>                                BooleanClause.Occur.SHOULD,
> BooleanClause.Occur.SHOULD };
>
>                // for multiple keyword search
>                Query query = MultiFieldQueryParser.parse(qryStr, new
> String[] {
>                                "title", "path", "contents", "summary",
> "size" }, flags,
>                                analyzer);
>
>                Hits hits = getHits(qryStr, searcher, query, "path");
>
>
>                for (int inc = 0; inc < hits.length(); inc++) {
>
>                        Document doc = hits.doc(inc);
>                                ///////
>
>                }
>
>
>         // private method to get hits by using phrase query
>
>        private Hits getHits(String qryStr, Searcher searcher, Query
> queryNorm,
>                        String phraseQryTerm) throws Exception {
>
>                Hits hits = null;
>
>                // for single word search
>                PhraseQuery queryPhrase = new PhraseQuery();
>                queryPhrase.setBoost(4.0f);
>                queryPhrase.setSlop(1);
>                queryPhrase.add(new Term(phraseQryTerm,
> qryStr.toLowerCase()));
>
>                hits = searcher.search(queryPhrase);
>
>                return hits;
>        }
>
>
>   if i use this code for my search , it gives me the unwanted search hits ,
>
>      as i mentioned , if i search for "about us" , this is an example ,
> there may be more number of urls like this ,  for example , "credit cards"
> ,
> "book marks" , how do i handle it ?
> --
> View this message in context:
> http://www.nabble.com/Searching-doubt-tp24802552p24803560.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016365ee910aa609304704caa03--

From java-user-return-41682-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 09:04:43 2009
Return-Path: <java-user-return-41682-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37843 invoked from network); 4 Aug 2009 09:04:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 09:04:42 -0000
Received: (qmail 95032 invoked by uid 500); 4 Aug 2009 09:04:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94964 invoked by uid 500); 4 Aug 2009 09:04:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94954 invoked by uid 99); 4 Aug 2009 09:04:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 09:04:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [202.86.5.88] (HELO smtp101.mail.in.yahoo.com) (202.86.5.88)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 04 Aug 2009 09:04:32 +0000
Received: (qmail 77199 invoked from network); 4 Aug 2009 09:04:10 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:References:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=E6D5/36KmFfPfMaeRF91FYbp+bFDRt8ZLO+k96WQpnqXd5tj97En5BeOj7jzJ1TMa9+kP7Oj/ha4LQONvVvHB0hVaRkZ4/UJUk+c2Rs/9Vm2x09tlByGAiwFVZbJed35eqhPoFD52tXLTeBcU6JglPElBpr42vQeTbuND6xG9/E=  ;
Received: from  (emailgane@203.98.194.130 with login)
        by smtp101.mail.in.yahoo.com with SMTP; 04 Aug 2009 14:34:07 +0530 IST
X-Yahoo-SMTP: JObyHkuswBBrNSLZp.Ycd7Boqpr_GQ--
X-YMail-OSG: Rtlhh7oVM1ksmrmg6XNnBbJXpsxz7VNXpsS6jYkJZ3bxqvGBLDjitGMASpy39NI04uzUQREOGcAyblH6eJZEzBcSHtS8UIvDDF0xwGfd5Xg.LSyb.hBjc0wV_lfcjSgAuPwcDHAAqGFUEKIczJKV5JPeJr4KJG14AIDVWe205f9OIhjK8xxtrgAULRjv9cDFMkwHsrziq9K1s3Re8IahXMIVtsyo0Y27pUY-
X-Yahoo-Newman-Property: ymail-3
Message-ID: <00cb01ca14e2$85f857d0$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
References: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com> <810678.30380.qm@web50304.mail.re2.yahoo.com> <ac6e61fc0908032138v126c6926u7e9d1245836fd2da@mail.gmail.com> <867513fe0908032218r552b34f1vf4c0431b17de0571@mail.gmail.com> <ac6e61fc0908040018y73392a0ax74497dc1515a3564@mail.gmail.com> <4d19a3630908040101l5a89bff2g1f900ea1f515c4eb@mail.gmail.com>
Subject: Re: How to improve search time?
Date: Tue, 4 Aug 2009 14:34:01 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

Hello Shashi,

Could you please provide me your DB related information. How big the db =
size,  memory etc.=20

I am currently having 100 million records splitted in 10 indexes in the =
same system. I am using ParallelSearcher and search speed is also good.=20

Regards
Ganesh

----- Original Message -----=20
From: "Shashi Kant" <shashi.mit@gmail.com>
To: <java-user@lucene.apache.org>
Sent: Tuesday, August 04, 2009 1:31 PM
Subject: Re: How to improve search time?


> Prashant, I have had better luck with even larger sized indices on
> similar platforms. Could you elaborate what types of queries you are
> running, Multifield? Boolean? combinations? etc. Also you might want
> to remove unnecessary stored fields from the index and move them to a
> relational db to squeeze out better performance.
>=20
>=20
> Shashi
>=20
>=20
> On Tue, Aug 4, 2009 at 3:18 AM, prashant
> ullegaddi<prashullegaddi@gmail.com> wrote:
>> I did that as well. Actually, we had 32 indexes initially. We =
searched them.
>> It was even horrible.
>> After that I merged them into 4 indexes. And did the same. No gain!
>>
>> Then, I had to merge 32 indexes into one.
>>
>> On Tue, Aug 4, 2009 at 10:48 AM, Anshum <anshumg@gmail.com> wrote:
>>
>>> Hi Prashant,
>>> 8 seconds as the minimum time is a little too much, though =
considering
>>> you're using just 4G of RAM its still ok.
>>> I would advice you to break your index into smaller indexes, perhaps
>>> selectively query the indexes (if that's possible for your =
application) and
>>> use a parallelmultisearcher. Its just something that you might try =
and
>>> like.
>>> All said and done, parallelizing would only get you a bell-curve =
like
>>> performance graph, so you'd have to figure out the sweet spot there.
>>>
>>> --
>>> Anshum Gupta
>>> Naukri Labs!
>>> http://ai-cafe.blogspot.com
>>>
>>> The facts expressed here belong to everybody, the opinions to me. =
The
>>> distinction is yours to draw............
>>>
>>>
>>> On Tue, Aug 4, 2009 at 10:08 AM, prashant ullegaddi <
>>> prashullegaddi@gmail.com> wrote:
>>>
>>> > I'm running it on Quadcore, 2.4GHz each, 4GB RAM.
>>> >
>>> > Prashant.
>>> >
>>> > On Tue, Aug 4, 2009 at 8:38 AM, Otis Gospodnetic <
>>> > otis_gospodnetic@yahoo.com
>>> > > wrote:
>>> >
>>> > > With such a large index be prepared to put it on a server with =
lots of
>>> > RAM
>>> > > (even if you follow all the tips from the Wiki).
>>> > > When reporting performance numbers, you really ought to tell us =
about
>>> > your
>>> > > hardware, types of queries, etc.
>>> > >
>>> > > Otis
>>> > > --
>>> > > Sematext is hiring -- http://sematext.com/about/jobs.html?mls
>>> > > Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
>>> > >
>>> > >
>>> > >
>>> > > ----- Original Message ----
>>> > > > From: prashant ullegaddi <prashullegaddi@gmail.com>
>>> > > > To: java-user@lucene.apache.org
>>> > > > Sent: Monday, August 3, 2009 12:33:46 AM
>>> > > > Subject: How to improve search time?
>>> > > >
>>> > > > Hi,
>>> > > >
>>> > > > I've a single index of size 87GB containing around 50M =
documents.
>>> When
>>> > I
>>> > > > search for any query,
>>> > > > best search time I observed was 8sec. And when query is =
expanded with
>>> > > > synonyms, search takes
>>> > > > minutes (~ 2-3min). Is there a better way to search so that =
overall
>>> > > search
>>> > > > time reduces?
>>> > > >
>>> > > > Thanks,
>>> > > > Prashant.
>>> > >
>>> > >
>>> > > =
---------------------------------------------------------------------
>>> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> > > For additional commands, e-mail: =
java-user-help@lucene.apache.org
>>> > >
>>> > >
>>> >
>>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41683-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 09:28:40 2009
Return-Path: <java-user-return-41683-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48649 invoked from network); 4 Aug 2009 09:28:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 09:28:39 -0000
Received: (qmail 37893 invoked by uid 500); 4 Aug 2009 09:28:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37824 invoked by uid 500); 4 Aug 2009 09:28:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37810 invoked by uid 99); 4 Aug 2009 09:28:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 09:28:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.94] (HELO smtp107.mail.in.yahoo.com) (202.86.5.94)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 04 Aug 2009 09:28:31 +0000
Received: (qmail 40251 invoked from network); 4 Aug 2009 09:28:07 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=nJtS07yZkkbx86cViflyq9P2f77Mnbn1yMe32tOIAEDRSIp4FDgNmMvPWoO6FDyHTC8ARZPz/B+UTywl67BxxrTcN57OFgMEdJfKiT8gOCR9MGhUz8asUgKGo6dPzJEaqdzmJ7OgB5Ml0Ih3TGkeqyAjT4njvYJXCkCxI9Kt1BE=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp107.mail.in.yahoo.com with SMTP; 4 Aug 2009 09:28:06 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: 9MqH5qEVM1l0yYUgWElDc4ppk59xkzfGh0kGURrDKt.BjtRE1c7EQz85LnYqd8mWWU9Fq4DtbUIJQA89b_ng_WwiDmidTBcFfoNqueDhQYJVvZmwHwsrFD45S96GcY_WluXfXoor8koMBTjmJr47tt.ERaNFha9MRMOkAFcByYh4Zswe_UqaswqQa9UiUw--
X-Yahoo-Newman-Property: ymail-3
Message-ID: <00d401ca14e5$dffe9430$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
Subject: Indexed Field impact on Memory
Date: Tue, 4 Aug 2009 14:58:03 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

Hello all,

I am having a indexed field, If i am not using this field for any search =
query. Whether this field consume memory?=20

If this field is part of filter query, then there would be any impact in =
memory consumption?=20

I am going to break / shorten the Date Time field and one field might be =
used for sorting and other might be used for filter query and stored.=20

Regards
Ganesh
   
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41684-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 09:50:58 2009
Return-Path: <java-user-return-41684-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62444 invoked from network); 4 Aug 2009 09:50:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 09:50:58 -0000
Received: (qmail 65813 invoked by uid 500); 4 Aug 2009 09:51:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65728 invoked by uid 500); 4 Aug 2009 09:51:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65718 invoked by uid 99); 4 Aug 2009 09:51:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 09:51:01 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 131.246.120.220 is neither permitted nor denied by domain of christian.reuschling@gmail.com)
Received: from [131.246.120.220] (HELO mailgw1.uni-kl.de) (131.246.120.220)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 09:50:52 +0000
Received: from dfki.uni-kl.de (dfki-1002.dfki.uni-kl.de [131.246.195.2])
	by mailgw1.uni-kl.de (8.13.8/8.13.8/Debian-3) with ESMTP id n749oU1A016335
	for <java-user@lucene.apache.org>; Tue, 4 Aug 2009 11:50:30 +0200
Received: from serv-4100.kl.dfki.de (serv-4100.kl.dfki.de [192.168.41.180])
	by dfki.uni-kl.de (8.13.8+Sun/8.11.4) with ESMTP id n749oU7b006099
	for <java-user@lucene.apache.org>; Tue, 4 Aug 2009 11:50:30 +0200 (CEST)
Received: from pc-4176.kl.dfki.de (pc-4176.kl.dfki.de [192.168.41.166])
	by serv-4100.kl.dfki.de (8.13.8+Sun/8.13.8) with ESMTP id n749oTTo013172
	for <java-user@lucene.apache.org>; Tue, 4 Aug 2009 11:50:30 +0200 (CEST)
Date: Tue, 4 Aug 2009 11:50:16 +0200
From: Christian Reuschling <christian.reuschling@gmail.com>
To: <java-user@lucene.apache.org>
Subject: ParallelMultiSearcher and idf
Message-ID: <20090804115016.64b58dfe@pc-4176.kl.dfki.de>
X-Mailer: Claws Mail 3.7.0 (GTK+ 2.14.4; i586-suse-linux-gnu)
Mime-Version: 1.0
Content-Type: multipart/signed; boundary="Sig_/AJzMw.WVyoBOp4gJwlsdOD+";
 protocol="application/pgp-signature"; micalg=PGP-SHA1
X-Virus-Checked: Checked by ClamAV on apache.org

--Sig_/AJzMw.WVyoBOp4gJwlsdOD+
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: quoted-printable

Hello,

when searching over multiple indices, we create one IndexReader for each in=
dex,
and wrap them into a MultiReader, that we use for IndexSearcher creation.

This is fine for searching multiple indices on one machine, but in the case=
 the
indices are distributed over the (intra)net, this scenario has several lack=
s:

- searching/scoring/sorting is 100% on the client machine, so you need all =
the
  ram and cpu power at every client.
- all the data necessary for scoring must go over the net - so the traffic
  should be significantly higher
- thus, there is a lack of overall performance

Nevertheless, creating a MultiReader and making a searcher out of it has one
advantage (at least can be an advantage depending on the scenario): The
document freqiencies of a term will be summed up, and thus it is 100%
transparent for scoring whether the indices are splittet or not.

I'm wondering whether there is the possibility to get the advantages of both
scenarios, e.g. by first summing up the query terms-related document
frequencies, and sending them together with the query to every (remote)sear=
cher
of ParallelMultiSearcher, for scoring.

Maybe this is exactly what ParallelMultiSearcher does, and I haven't seen i=
t?


Thanks for clarification!

Chris

--Sig_/AJzMw.WVyoBOp4gJwlsdOD+
Content-Type: application/pgp-signature; name=signature.asc
Content-Disposition: attachment; filename=signature.asc

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.9 (GNU/Linux)

iEYEARECAAYFAkp4BGIACgkQ6EqMXq+WZg/LAwCgsvGomE+njcUNSj26LaO57hmg
N3QAoIY8FSiX0ZnanK5E5ebQCh+doMUt
=Ey7G
-----END PGP SIGNATURE-----

--Sig_/AJzMw.WVyoBOp4gJwlsdOD+--

From java-user-return-41685-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 10:00:16 2009
Return-Path: <java-user-return-41685-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65654 invoked from network); 4 Aug 2009 10:00:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 10:00:16 -0000
Received: (qmail 75487 invoked by uid 500); 4 Aug 2009 10:00:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75417 invoked by uid 500); 4 Aug 2009 10:00:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75399 invoked by uid 99); 4 Aug 2009 10:00:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 10:00:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 10:00:10 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MYGo9-0007pP-Fo
	for java-user@lucene.apache.org; Tue, 04 Aug 2009 02:59:49 -0700
Message-ID: <24805609.post@talk.nabble.com>
Date: Tue, 4 Aug 2009 02:59:49 -0700 (PDT)
From: "m.harig" <m.harig@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Searching doubt
In-Reply-To: <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.harig@gmail.com
References: <24802552.post@talk.nabble.com> <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com> <24803073.post@talk.nabble.com> <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com> <24803560.post@talk.nabble.com> <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks ,

              i've noticed that , but the code is for known tokens, how do i
do it for dynamic tokens , meaning , i don't know the urls , someone picked
up the urls and i'll index it. Is there any technique to use while indexing
? am using lucene 2.4.0 version. Please suggest me.
-- 
View this message in context: http://www.nabble.com/Searching-doubt-tp24802552p24805609.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41686-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 10:56:40 2009
Return-Path: <java-user-return-41686-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90184 invoked from network); 4 Aug 2009 10:56:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 10:56:39 -0000
Received: (qmail 35811 invoked by uid 500); 4 Aug 2009 10:56:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35718 invoked by uid 500); 4 Aug 2009 10:56:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35707 invoked by uid 99); 4 Aug 2009 10:56:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 10:56:42 +0000
X-ASF-Spam-Status: No, hits=4.3 required=10.0
	tests=FU_COMMON_SUBS2,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 74.125.78.27 as permitted sender)
Received: from [74.125.78.27] (HELO ey-out-2122.google.com) (74.125.78.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 10:56:31 +0000
Received: by ey-out-2122.google.com with SMTP id 9so1096640eyd.53
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 03:56:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=BlWUDgQQmTku39kpBjpIZ4JOOyMVYTBkFI+NrmDz81I=;
        b=Al/2x7lRbHR60dKACcVMMPRVcrwmuC01i4bFj1+FnXyuv1pHC7vCakZB8gv6JCbXdf
         aVkGGcsurg0lUa9KExUxq0YMn4tjRImcvdjgM61pf6Ju9oovXpjdsrDL+tHZ9LmfJMsF
         dD3MLn5StWWLV7XhMJkncduLX4MPypfR3S/lA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=WGbfhwaPj4SiEXEwfDbuMjyPHoFYaJPgMrTUeGhlMeDcpVzdJYEwoghhBDYx5jdf3U
         YvbDNS+EkO+JL1oOT52VxbDlFtcuRrYZ3SpXcqJ0TFZ4DVEwvvyaN5RELIkFkqEZz4Yo
         0yHz1txKPltNAb37ci1SNsw1VbDyTbA5zSjes=
MIME-Version: 1.0
Received: by 10.216.87.71 with SMTP id x49mr1472489wee.11.1249383370820; Tue, 
	04 Aug 2009 03:56:10 -0700 (PDT)
In-Reply-To: <24805609.post@talk.nabble.com>
References: <24802552.post@talk.nabble.com>
	 <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com>
	 <24803073.post@talk.nabble.com>
	 <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com>
	 <24803560.post@talk.nabble.com>
	 <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com>
	 <24805609.post@talk.nabble.com>
Date: Tue, 4 Aug 2009 13:56:10 +0300
Message-ID: <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com>
Subject: Re: Searching doubt
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d63f8a018d0804704ebcd0
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d63f8a018d0804704ebcd0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

If you don't know which tokens you'll face, then it's really a much harder
problem. If you know where the token is, e.g. it's always in
http://some.example.site/a/b/<here will be the token to break>/index.html,
then it eases the task a bit. Otherwise you'll need to search every single
token produced. I can think of several ways to break "aboutus" to "about
us", or any other sequence for that matter:

1) Break it to "a boutus", "ab outus" ... "about us", "aboutu s", index all
of them in the same position. Expensive though. This I'd recommend only if
you know where this token is located (otherwise it will explode your term
dictionary).

2) Use a dictionary (real dictionary), and search it for every substring,
e.g. "a", "ab", "abo" ... "about" etc. If you find a match, split it there.
This needs some fine tuning, like checking if the rest is also a word and if
the full string is also a word, so that you don't break up meaningful words.
You'll need to get a dictionary for that.

The key though - do you know exactly where this token is? Otherwise, every
solution will be a killer to performance.

Shai

On Tue, Aug 4, 2009 at 12:59 PM, m.harig <m.harig@gmail.com> wrote:

>
> Thanks ,
>
>              i've noticed that , but the code is for known tokens, how do i
> do it for dynamic tokens , meaning , i don't know the urls , someone picked
> up the urls and i'll index it. Is there any technique to use while indexing
> ? am using lucene 2.4.0 version. Please suggest me.
> --
> View this message in context:
> http://www.nabble.com/Searching-doubt-tp24802552p24805609.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d63f8a018d0804704ebcd0--

From java-user-return-41687-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 11:22:25 2009
Return-Path: <java-user-return-41687-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94419 invoked from network); 4 Aug 2009 11:22:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 11:22:25 -0000
Received: (qmail 51505 invoked by uid 500); 4 Aug 2009 11:22:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51425 invoked by uid 500); 4 Aug 2009 11:22:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51415 invoked by uid 99); 4 Aug 2009 11:22:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 11:22:28 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of prashullegaddi@gmail.com designates 209.85.198.239 as permitted sender)
Received: from [209.85.198.239] (HELO rv-out-0506.google.com) (209.85.198.239)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 11:22:18 +0000
Received: by rv-out-0506.google.com with SMTP id b25so1199516rvf.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 04:21:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=PdIWxiiupG2hiZuJGRaXj4B3iAZSMv6eYZQhSmze5Y0=;
        b=A9tU1skVH9X+6Bct9gGhYSCaCwzYdksv5VI5IqmBLj4vTq4Hl0kUJQDDVhu4B4yocL
         +tHH4YZt68TvmP2FCsQjGVFl2WMx5JDS+7wajiDCg44ocTeICdLm1g4cPbMGeypRWc3B
         mKGKwu5vCNJlYCIP5zMO0UqBZnWcjE4QJqCt0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=kf0FBmhE4PygPTES24x8qXj/Czhwo96RirqXxr08IYg+svvC0qAbt0LWALbYrfIxdX
         uJeZeFs8pqhRERxBg7OlhHVgLsPkH2EciRdsqwTS+eL4DJbEtDirS7qJxuXISUOHdtW5
         q1R89UNG55CUYNS0Lq/3pnNbi2VecomwjHYLM=
MIME-Version: 1.0
Received: by 10.141.28.19 with SMTP id f19mr5117551rvj.67.1249384918379; Tue, 
	04 Aug 2009 04:21:58 -0700 (PDT)
In-Reply-To: <4d19a3630908040101l5a89bff2g1f900ea1f515c4eb@mail.gmail.com>
References: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com>
	 <810678.30380.qm@web50304.mail.re2.yahoo.com>
	 <ac6e61fc0908032138v126c6926u7e9d1245836fd2da@mail.gmail.com>
	 <867513fe0908032218r552b34f1vf4c0431b17de0571@mail.gmail.com>
	 <ac6e61fc0908040018y73392a0ax74497dc1515a3564@mail.gmail.com>
	 <4d19a3630908040101l5a89bff2g1f900ea1f515c4eb@mail.gmail.com>
Date: Tue, 4 Aug 2009 16:51:58 +0530
Message-ID: <ac6e61fc0908040421r709637e5v1cbee00411f6243a@mail.gmail.com>
Subject: Re: How to improve search time?
From: prashant ullegaddi <prashullegaddi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1a9063f6e5f04704f182d
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1a9063f6e5f04704f182d
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Shahi,

Our queries are free text queries. But they will be expanded into:
Multifield, Boolean.
We are also expanding the original query using SynExpand of lucene. A simple
query
gets expanded to say a query of page size.

And we are not storing any other fields except key (document IDs), target
URLs and titles.

Prashant.

On Tue, Aug 4, 2009 at 1:31 PM, Shashi Kant <shashi.mit@gmail.com> wrote:

> Prashant, I have had better luck with even larger sized indices on
> similar platforms. Could you elaborate what types of queries you are
> running, Multifield? Boolean? combinations? etc. Also you might want
> to remove unnecessary stored fields from the index and move them to a
> relational db to squeeze out better performance.
>
>
> Shashi
>
>
> On Tue, Aug 4, 2009 at 3:18 AM, prashant
> ullegaddi<prashullegaddi@gmail.com> wrote:
> > I did that as well. Actually, we had 32 indexes initially. We searched
> them.
> > It was even horrible.
> > After that I merged them into 4 indexes. And did the same. No gain!
> >
> > Then, I had to merge 32 indexes into one.
> >
> > On Tue, Aug 4, 2009 at 10:48 AM, Anshum <anshumg@gmail.com> wrote:
> >
> >> Hi Prashant,
> >> 8 seconds as the minimum time is a little too much, though considering
> >> you're using just 4G of RAM its still ok.
> >> I would advice you to break your index into smaller indexes, perhaps
> >> selectively query the indexes (if that's possible for your application)
> and
> >> use a parallelmultisearcher. Its just something that you might try and
> >> like.
> >> All said and done, parallelizing would only get you a bell-curve like
> >> performance graph, so you'd have to figure out the sweet spot there.
> >>
> >> --
> >> Anshum Gupta
> >> Naukri Labs!
> >> http://ai-cafe.blogspot.com
> >>
> >> The facts expressed here belong to everybody, the opinions to me. The
> >> distinction is yours to draw............
> >>
> >>
> >> On Tue, Aug 4, 2009 at 10:08 AM, prashant ullegaddi <
> >> prashullegaddi@gmail.com> wrote:
> >>
> >> > I'm running it on Quadcore, 2.4GHz each, 4GB RAM.
> >> >
> >> > Prashant.
> >> >
> >> > On Tue, Aug 4, 2009 at 8:38 AM, Otis Gospodnetic <
> >> > otis_gospodnetic@yahoo.com
> >> > > wrote:
> >> >
> >> > > With such a large index be prepared to put it on a server with lots
> of
> >> > RAM
> >> > > (even if you follow all the tips from the Wiki).
> >> > > When reporting performance numbers, you really ought to tell us
> about
> >> > your
> >> > > hardware, types of queries, etc.
> >> > >
> >> > > Otis
> >> > > --
> >> > > Sematext is hiring -- http://sematext.com/about/jobs.html?mls
> >> > > Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
> >> > >
> >> > >
> >> > >
> >> > > ----- Original Message ----
> >> > > > From: prashant ullegaddi <prashullegaddi@gmail.com>
> >> > > > To: java-user@lucene.apache.org
> >> > > > Sent: Monday, August 3, 2009 12:33:46 AM
> >> > > > Subject: How to improve search time?
> >> > > >
> >> > > > Hi,
> >> > > >
> >> > > > I've a single index of size 87GB containing around 50M documents.
> >> When
> >> > I
> >> > > > search for any query,
> >> > > > best search time I observed was 8sec. And when query is expanded
> with
> >> > > > synonyms, search takes
> >> > > > minutes (~ 2-3min). Is there a better way to search so that
> overall
> >> > > search
> >> > > > time reduces?
> >> > > >
> >> > > > Thanks,
> >> > > > Prashant.
> >> > >
> >> > >
> >> > >
> ---------------------------------------------------------------------
> >> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> > >
> >> > >
> >> >
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd1a9063f6e5f04704f182d--

From java-user-return-41688-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 11:31:58 2009
Return-Path: <java-user-return-41688-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95786 invoked from network); 4 Aug 2009 11:31:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 11:31:57 -0000
Received: (qmail 68011 invoked by uid 500); 4 Aug 2009 11:32:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67950 invoked by uid 500); 4 Aug 2009 11:32:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67940 invoked by uid 99); 4 Aug 2009 11:32:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 11:32:00 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 72.14.220.157 as permitted sender)
Received: from [72.14.220.157] (HELO fg-out-1718.google.com) (72.14.220.157)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 11:31:50 +0000
Received: by fg-out-1718.google.com with SMTP id l27so645848fgb.4
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 04:31:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=UrH6+TtzCh1MRVzpPBsAtLuO2TipEtFalNxDtfLQVkU=;
        b=po0+lGQH5wRJT1n2WFXEuF4BY0ipx607BFTcoIu8aKLr3XWUxWY3k5mI6VT3DSNmaj
         4Quq0dKzssX1PaMFlB8SpCCWvc1LQ5A2F4iypGA8LglTjzMB+8svZv65d3ddTLsk8lLK
         c5lQZcYIN/xx09t6Qyl7PRKNw/1iIoyb9vbiY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=OOkHUOCR70XVb8ChY/mii7WJacEfaODq9JyjikROQ1HpBnhe/9gVhAySJPzXEyllTc
         0b3kHiu4oujGlr7IbU0iuiaOWgvFh8UP27m/OcFfAz5QhiH/2Yp8VnHKS7kfdPJfW7XN
         7BRp/KdgSJewskf6YbCUyOHqFsydmAQm0VdEA=
MIME-Version: 1.0
Received: by 10.86.49.8 with SMTP id w8mr2581029fgw.37.1249385489084; Tue, 04 
	Aug 2009 04:31:29 -0700 (PDT)
In-Reply-To: <ac6e61fc0908040421r709637e5v1cbee00411f6243a@mail.gmail.com>
References: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com> 
	<810678.30380.qm@web50304.mail.re2.yahoo.com> <ac6e61fc0908032138v126c6926u7e9d1245836fd2da@mail.gmail.com> 
	<867513fe0908032218r552b34f1vf4c0431b17de0571@mail.gmail.com> 
	<ac6e61fc0908040018y73392a0ax74497dc1515a3564@mail.gmail.com> 
	<4d19a3630908040101l5a89bff2g1f900ea1f515c4eb@mail.gmail.com> 
	<ac6e61fc0908040421r709637e5v1cbee00411f6243a@mail.gmail.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Tue, 4 Aug 2009 12:31:09 +0100
Message-ID: <8c4e68610908040431nda7fceya6c97768a69d8a36@mail.gmail.com>
Subject: Re: How to improve search time?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Still surprising that your searches are taking so long.

Have you worked through everything on
http://wiki.apache.org/lucene-java/ImproveSearchingSpeed, suggested by
someone earlier in this thread?  Are you sure that the problem is
really with lucene? Is it the search itself that takes a long time, or
retrieving data for the hits?  What does query.toString() look like?
How many hits does a search typically match?  Is a search on document
id effectively instant?

You have to supply more detail if you want better answers.


--
Ian.


On Tue, Aug 4, 2009 at 12:21 PM, prashant
ullegaddi<prashullegaddi@gmail.com> wrote:
> Shahi,
>
> Our queries are free text queries. But they will be expanded into:
> Multifield, Boolean.
> We are also expanding the original query using SynExpand of lucene. A simple
> query
> gets expanded to say a query of page size.
>
> And we are not storing any other fields except key (document IDs), target
> URLs and titles.
>
> Prashant.
>
> On Tue, Aug 4, 2009 at 1:31 PM, Shashi Kant <shashi.mit@gmail.com> wrote:
>
>> Prashant, I have had better luck with even larger sized indices on
>> similar platforms. Could you elaborate what types of queries you are
>> running, Multifield? Boolean? combinations? etc. Also you might want
>> to remove unnecessary stored fields from the index and move them to a
>> relational db to squeeze out better performance.
>>
>>
>> Shashi
>>
>>
>> On Tue, Aug 4, 2009 at 3:18 AM, prashant
>> ullegaddi<prashullegaddi@gmail.com> wrote:
>> > I did that as well. Actually, we had 32 indexes initially. We searched
>> them.
>> > It was even horrible.
>> > After that I merged them into 4 indexes. And did the same. No gain!
>> >
>> > Then, I had to merge 32 indexes into one.
>> >
>> > On Tue, Aug 4, 2009 at 10:48 AM, Anshum <anshumg@gmail.com> wrote:
>> >
>> >> Hi Prashant,
>> >> 8 seconds as the minimum time is a little too much, though considering
>> >> you're using just 4G of RAM its still ok.
>> >> I would advice you to break your index into smaller indexes, perhaps
>> >> selectively query the indexes (if that's possible for your application)
>> and
>> >> use a parallelmultisearcher. Its just something that you might try and
>> >> like.
>> >> All said and done, parallelizing would only get you a bell-curve like
>> >> performance graph, so you'd have to figure out the sweet spot there.
>> >>
>> >> --
>> >> Anshum Gupta
>> >> Naukri Labs!
>> >> http://ai-cafe.blogspot.com
>> >>
>> >> The facts expressed here belong to everybody, the opinions to me. The
>> >> distinction is yours to draw............
>> >>
>> >>
>> >> On Tue, Aug 4, 2009 at 10:08 AM, prashant ullegaddi <
>> >> prashullegaddi@gmail.com> wrote:
>> >>
>> >> > I'm running it on Quadcore, 2.4GHz each, 4GB RAM.
>> >> >
>> >> > Prashant.
>> >> >
>> >> > On Tue, Aug 4, 2009 at 8:38 AM, Otis Gospodnetic <
>> >> > otis_gospodnetic@yahoo.com
>> >> > > wrote:
>> >> >
>> >> > > With such a large index be prepared to put it on a server with lots
>> of
>> >> > RAM
>> >> > > (even if you follow all the tips from the Wiki).
>> >> > > When reporting performance numbers, you really ought to tell us
>> about
>> >> > your
>> >> > > hardware, types of queries, etc.
>> >> > >
>> >> > > Otis
>> >> > > --
>> >> > > Sematext is hiring -- http://sematext.com/about/jobs.html?mls
>> >> > > Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
>> >> > >
>> >> > >
>> >> > >
>> >> > > ----- Original Message ----
>> >> > > > From: prashant ullegaddi <prashullegaddi@gmail.com>
>> >> > > > To: java-user@lucene.apache.org
>> >> > > > Sent: Monday, August 3, 2009 12:33:46 AM
>> >> > > > Subject: How to improve search time?
>> >> > > >
>> >> > > > Hi,
>> >> > > >
>> >> > > > I've a single index of size 87GB containing around 50M documents.
>> >> When
>> >> > I
>> >> > > > search for any query,
>> >> > > > best search time I observed was 8sec. And when query is expanded
>> with
>> >> > > > synonyms, search takes
>> >> > > > minutes (~ 2-3min). Is there a better way to search so that
>> overall
>> >> > > search
>> >> > > > time reduces?
>> >> > > >
>> >> > > > Thanks,
>> >> > > > Prashant.
>> >> > >
>> >> > >
>> >> > >
>> ---------------------------------------------------------------------
>> >> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> > > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >> > >
>> >> > >
>> >> >
>> >>
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41689-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 12:56:03 2009
Return-Path: <java-user-return-41689-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32465 invoked from network); 4 Aug 2009 12:56:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 12:56:03 -0000
Received: (qmail 77840 invoked by uid 500); 4 Aug 2009 12:56:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77765 invoked by uid 500); 4 Aug 2009 12:56:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77755 invoked by uid 99); 4 Aug 2009 12:56:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 12:56:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 12:55:53 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n74CtQVo022166
	for <java-user@lucene.apache.org>; Tue, 4 Aug 2009 08:55:29 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <4A782FBD.2040708@informatics.jax.org>
Date: Tue, 04 Aug 2009 08:55:25 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.22 (Windows/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: How to improve search time?
References: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com> 	<810678.30380.qm@web50304.mail.re2.yahoo.com> <ac6e61fc0908032138v126c6926u7e9d1245836fd2da@mail.gmail.com> 	<867513fe0908032218r552b34f1vf4c0431b17de0571@mail.gmail.com> 	<ac6e61fc0908040018y73392a0ax74497dc1515a3564@mail.gmail.com> 	<4d19a3630908040101l5a89bff2g1f900ea1f515c4eb@mail.gmail.com> 	<ac6e61fc0908040421r709637e5v1cbee00411f6243a@mail.gmail.com> <8c4e68610908040431nda7fceya6c97768a69d8a36@mail.gmail.com>
In-Reply-To: <8c4e68610908040431nda7fceya6c97768a69d8a36@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.5.7.378829, Antispam-Engine: 2.7.2.376379, Antispam-Data: 2009.8.4.124216
X-PerlMx-Spam: Gauge=IIIIIIII, Probability=8%, Report='
 BLOGSPOT_URI 0.05, KNOWN_FREEWEB_URI 0.05, BODY_SIZE_5000_5999 0, BODY_SIZE_7000_LESS 0, ECARD_KNOWN_DOMAINS 0, TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __C230066_P5 0, __CANPHARM_UNSUB_LINK 0, __CP_URI_IN_BODY 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __FRAUD_419_BODY_WEBMAIL 0, __FRAUD_419_WEBMAIL 0, __HAS_MSGID 0, __KNOWN_FREEWEB_URI1 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __MOZILLA_MSGID 0, __SANE_MSGID 0, __TO_MALFORMED_2 0, __URI_NS , __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

Also, how long does it take Luke to do a search against the same index.

That way you can remove any of the timing that your application is 
adding into the mix.

If Luke doesn't take the minimum of 8 seconds... then you know its an 
issue with your app.  (or at least a large part of it)

Matt

Ian Lea wrote:
> Still surprising that your searches are taking so long.
>
> Have you worked through everything on
> http://wiki.apache.org/lucene-java/ImproveSearchingSpeed, suggested by
> someone earlier in this thread?  Are you sure that the problem is
> really with lucene? Is it the search itself that takes a long time, or
> retrieving data for the hits?  What does query.toString() look like?
> How many hits does a search typically match?  Is a search on document
> id effectively instant?
>
> You have to supply more detail if you want better answers.
>
>
> --
> Ian.
>
>
> On Tue, Aug 4, 2009 at 12:21 PM, prashant
> ullegaddi<prashullegaddi@gmail.com> wrote:
>   
>> Shahi,
>>
>> Our queries are free text queries. But they will be expanded into:
>> Multifield, Boolean.
>> We are also expanding the original query using SynExpand of lucene. A simple
>> query
>> gets expanded to say a query of page size.
>>
>> And we are not storing any other fields except key (document IDs), target
>> URLs and titles.
>>
>> Prashant.
>>
>> On Tue, Aug 4, 2009 at 1:31 PM, Shashi Kant <shashi.mit@gmail.com> wrote:
>>
>>     
>>> Prashant, I have had better luck with even larger sized indices on
>>> similar platforms. Could you elaborate what types of queries you are
>>> running, Multifield? Boolean? combinations? etc. Also you might want
>>> to remove unnecessary stored fields from the index and move them to a
>>> relational db to squeeze out better performance.
>>>
>>>
>>> Shashi
>>>
>>>
>>> On Tue, Aug 4, 2009 at 3:18 AM, prashant
>>> ullegaddi<prashullegaddi@gmail.com> wrote:
>>>       
>>>> I did that as well. Actually, we had 32 indexes initially. We searched
>>>>         
>>> them.
>>>       
>>>> It was even horrible.
>>>> After that I merged them into 4 indexes. And did the same. No gain!
>>>>
>>>> Then, I had to merge 32 indexes into one.
>>>>
>>>> On Tue, Aug 4, 2009 at 10:48 AM, Anshum <anshumg@gmail.com> wrote:
>>>>
>>>>         
>>>>> Hi Prashant,
>>>>> 8 seconds as the minimum time is a little too much, though considering
>>>>> you're using just 4G of RAM its still ok.
>>>>> I would advice you to break your index into smaller indexes, perhaps
>>>>> selectively query the indexes (if that's possible for your application)
>>>>>           
>>> and
>>>       
>>>>> use a parallelmultisearcher. Its just something that you might try and
>>>>> like.
>>>>> All said and done, parallelizing would only get you a bell-curve like
>>>>> performance graph, so you'd have to figure out the sweet spot there.
>>>>>
>>>>> --
>>>>> Anshum Gupta
>>>>> Naukri Labs!
>>>>> http://ai-cafe.blogspot.com
>>>>>
>>>>> The facts expressed here belong to everybody, the opinions to me. The
>>>>> distinction is yours to draw............
>>>>>
>>>>>
>>>>> On Tue, Aug 4, 2009 at 10:08 AM, prashant ullegaddi <
>>>>> prashullegaddi@gmail.com> wrote:
>>>>>
>>>>>           
>>>>>> I'm running it on Quadcore, 2.4GHz each, 4GB RAM.
>>>>>>
>>>>>> Prashant.
>>>>>>
>>>>>> On Tue, Aug 4, 2009 at 8:38 AM, Otis Gospodnetic <
>>>>>> otis_gospodnetic@yahoo.com
>>>>>>             
>>>>>>> wrote:
>>>>>>>               
>>>>>>> With such a large index be prepared to put it on a server with lots
>>>>>>>               
>>> of
>>>       
>>>>>> RAM
>>>>>>             
>>>>>>> (even if you follow all the tips from the Wiki).
>>>>>>> When reporting performance numbers, you really ought to tell us
>>>>>>>               
>>> about
>>>       
>>>>>> your
>>>>>>             
>>>>>>> hardware, types of queries, etc.
>>>>>>>
>>>>>>> Otis
>>>>>>> --
>>>>>>> Sematext is hiring -- http://sematext.com/about/jobs.html?mls
>>>>>>> Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> ----- Original Message ----
>>>>>>>               
>>>>>>>> From: prashant ullegaddi <prashullegaddi@gmail.com>
>>>>>>>> To: java-user@lucene.apache.org
>>>>>>>> Sent: Monday, August 3, 2009 12:33:46 AM
>>>>>>>> Subject: How to improve search time?
>>>>>>>>
>>>>>>>> Hi,
>>>>>>>>
>>>>>>>> I've a single index of size 87GB containing around 50M documents.
>>>>>>>>                 
>>>>> When
>>>>>           
>>>>>> I
>>>>>>             
>>>>>>>> search for any query,
>>>>>>>> best search time I observed was 8sec. And when query is expanded
>>>>>>>>                 
>>> with
>>>       
>>>>>>>> synonyms, search takes
>>>>>>>> minutes (~ 2-3min). Is there a better way to search so that
>>>>>>>>                 
>>> overall
>>>       
>>>>>>> search
>>>>>>>               
>>>>>>>> time reduces?
>>>>>>>>
>>>>>>>> Thanks,
>>>>>>>> Prashant.
>>>>>>>>                 
>>>>>>>
>>>>>>>               
>>> ---------------------------------------------------------------------
>>>       
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>
>>>>>>>
>>>>>>>               
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>       
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


-- 
Matthew Hall
Software Engineer
Mouse Genome Informatics
mhall@informatics.jax.org
(207) 288-6012



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41690-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 13:18:27 2009
Return-Path: <java-user-return-41690-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45920 invoked from network); 4 Aug 2009 13:18:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 13:18:27 -0000
Received: (qmail 14902 invoked by uid 500); 4 Aug 2009 13:18:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14828 invoked by uid 500); 4 Aug 2009 13:18:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14818 invoked by uid 99); 4 Aug 2009 13:18:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 13:18:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of shashi.mit@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 13:18:18 +0000
Received: by ywh26 with SMTP id 26so5144878ywh.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 06:17:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=3kVzjW4rTARla8C5a0XTV4EmbA9ZUT0eP5X7XC32h2o=;
        b=lgYvBCm1T2lowLABOs3kW3j7NsqamWTFK8kdcC+STKcyATQ4zRUlUCA6yllpbdiGTg
         Won4SE0DWMgHXU3q7WJNEkpu7T+l9PJEl+TMQExnq07zZGY0+TSj7BQYSbmlpBAg67Ek
         glBnV2JaP99H3AXgwXt62QZcMUHLpEIPoxv7g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=BVM19IkLVsdJbBpdK3I2TXGod6pq9VMnLuKlh3W0UchbQwisDf3jzgXHMYX+x6cRme
         ywwe1hOez0mZau6RC+RhnQbDRGEOltUpxT2EIAYEcZFZ8gfy1Fn7MaQEL495+AsWQBeX
         Fxarj7qkeA/vMpnm/+J2oB3nhRlHib8x5JU94=
MIME-Version: 1.0
Received: by 10.151.148.6 with SMTP id a6mr13154442ybo.113.1249391877101; Tue, 
	04 Aug 2009 06:17:57 -0700 (PDT)
In-Reply-To: <4A782FBD.2040708@informatics.jax.org>
References: <ac6e61fc0908022133g214bc0d3x452828b284f533fa@mail.gmail.com> 
	<810678.30380.qm@web50304.mail.re2.yahoo.com> <ac6e61fc0908032138v126c6926u7e9d1245836fd2da@mail.gmail.com> 
	<867513fe0908032218r552b34f1vf4c0431b17de0571@mail.gmail.com> 
	<ac6e61fc0908040018y73392a0ax74497dc1515a3564@mail.gmail.com> 
	<4d19a3630908040101l5a89bff2g1f900ea1f515c4eb@mail.gmail.com> 
	<ac6e61fc0908040421r709637e5v1cbee00411f6243a@mail.gmail.com> 
	<8c4e68610908040431nda7fceya6c97768a69d8a36@mail.gmail.com> 
	<4A782FBD.2040708@informatics.jax.org>
From: Shashi Kant <shashi.mit@gmail.com>
Date: Tue, 4 Aug 2009 09:17:37 -0400
Message-ID: <4d19a3630908040617q50e2787bja54614386f707e25@mail.gmail.com>
Subject: Re: How to improve search time?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

To add to all these excellent suggestions: I would suggest creating a
"baby index" out of the master index -  pull out say 1000 docs into a
test index and query. Helps in narrowing down the problem.


On Tue, Aug 4, 2009 at 8:55 AM, Matthew Hall<mhall@informatics.jax.org> wro=
te:
> Also, how long does it take Luke to do a search against the same index.
>
> That way you can remove any of the timing that your application is adding
> into the mix.
>
> If Luke doesn't take the minimum of 8 seconds... then you know its an iss=
ue
> with your app. =A0(or at least a large part of it)
>
> Matt
>
> Ian Lea wrote:
>>
>> Still surprising that your searches are taking so long.
>>
>> Have you worked through everything on
>> http://wiki.apache.org/lucene-java/ImproveSearchingSpeed, suggested by
>> someone earlier in this thread? =A0Are you sure that the problem is
>> really with lucene? Is it the search itself that takes a long time, or
>> retrieving data for the hits? =A0What does query.toString() look like?
>> How many hits does a search typically match? =A0Is a search on document
>> id effectively instant?
>>
>> You have to supply more detail if you want better answers.
>>
>>
>> --
>> Ian.
>>
>>
>> On Tue, Aug 4, 2009 at 12:21 PM, prashant
>> ullegaddi<prashullegaddi@gmail.com> wrote:
>>
>>>
>>> Shahi,
>>>
>>> Our queries are free text queries. But they will be expanded into:
>>> Multifield, Boolean.
>>> We are also expanding the original query using SynExpand of lucene. A
>>> simple
>>> query
>>> gets expanded to say a query of page size.
>>>
>>> And we are not storing any other fields except key (document IDs), targ=
et
>>> URLs and titles.
>>>
>>> Prashant.
>>>
>>> On Tue, Aug 4, 2009 at 1:31 PM, Shashi Kant <shashi.mit@gmail.com> wrot=
e:
>>>
>>>
>>>>
>>>> Prashant, I have had better luck with even larger sized indices on
>>>> similar platforms. Could you elaborate what types of queries you are
>>>> running, Multifield? Boolean? combinations? etc. Also you might want
>>>> to remove unnecessary stored fields from the index and move them to a
>>>> relational db to squeeze out better performance.
>>>>
>>>>
>>>> Shashi
>>>>
>>>>
>>>> On Tue, Aug 4, 2009 at 3:18 AM, prashant
>>>> ullegaddi<prashullegaddi@gmail.com> wrote:
>>>>
>>>>>
>>>>> I did that as well. Actually, we had 32 indexes initially. We searche=
d
>>>>>
>>>>
>>>> them.
>>>>
>>>>>
>>>>> It was even horrible.
>>>>> After that I merged them into 4 indexes. And did the same. No gain!
>>>>>
>>>>> Then, I had to merge 32 indexes into one.
>>>>>
>>>>> On Tue, Aug 4, 2009 at 10:48 AM, Anshum <anshumg@gmail.com> wrote:
>>>>>
>>>>>
>>>>>>
>>>>>> Hi Prashant,
>>>>>> 8 seconds as the minimum time is a little too much, though consideri=
ng
>>>>>> you're using just 4G of RAM its still ok.
>>>>>> I would advice you to break your index into smaller indexes, perhaps
>>>>>> selectively query the indexes (if that's possible for your
>>>>>> application)
>>>>>>
>>>>
>>>> and
>>>>
>>>>>>
>>>>>> use a parallelmultisearcher. Its just something that you might try a=
nd
>>>>>> like.
>>>>>> All said and done, parallelizing would only get you a bell-curve lik=
e
>>>>>> performance graph, so you'd have to figure out the sweet spot there.
>>>>>>
>>>>>> --
>>>>>> Anshum Gupta
>>>>>> Naukri Labs!
>>>>>> http://ai-cafe.blogspot.com
>>>>>>
>>>>>> The facts expressed here belong to everybody, the opinions to me. Th=
e
>>>>>> distinction is yours to draw............
>>>>>>
>>>>>>
>>>>>> On Tue, Aug 4, 2009 at 10:08 AM, prashant ullegaddi <
>>>>>> prashullegaddi@gmail.com> wrote:
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> I'm running it on Quadcore, 2.4GHz each, 4GB RAM.
>>>>>>>
>>>>>>> Prashant.
>>>>>>>
>>>>>>> On Tue, Aug 4, 2009 at 8:38 AM, Otis Gospodnetic <
>>>>>>> otis_gospodnetic@yahoo.com
>>>>>>>
>>>>>>>>
>>>>>>>> wrote:
>>>>>>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0With such a large index be prepared to =
put it on a
>>>>>>>> server with lots
>>>>>>>>
>>>>
>>>> of
>>>>
>>>>>>>
>>>>>>> RAM
>>>>>>>
>>>>>>>>
>>>>>>>> (even if you follow all the tips from the Wiki).
>>>>>>>> When reporting performance numbers, you really ought to tell us
>>>>>>>>
>>>>
>>>> about
>>>>
>>>>>>>
>>>>>>> your
>>>>>>>
>>>>>>>>
>>>>>>>> hardware, types of queries, etc.
>>>>>>>>
>>>>>>>> Otis
>>>>>>>> --
>>>>>>>> Sematext is hiring -- http://sematext.com/about/jobs.html?mls
>>>>>>>> Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>> ----- Original Message ----
>>>>>>>>
>>>>>>>>>
>>>>>>>>> From: prashant ullegaddi <prashullegaddi@gmail.com>
>>>>>>>>> To: java-user@lucene.apache.org
>>>>>>>>> Sent: Monday, August 3, 2009 12:33:46 AM
>>>>>>>>> Subject: How to improve search time?
>>>>>>>>>
>>>>>>>>> Hi,
>>>>>>>>>
>>>>>>>>> I've a single index of size 87GB containing around 50M documents.
>>>>>>>>>
>>>>>>
>>>>>> When
>>>>>>
>>>>>>>
>>>>>>> I
>>>>>>>
>>>>>>>>>
>>>>>>>>> search for any query,
>>>>>>>>> best search time I observed was 8sec. And when query is expanded
>>>>>>>>>
>>>>
>>>> with
>>>>
>>>>>>>>>
>>>>>>>>> synonyms, search takes
>>>>>>>>> minutes (~ 2-3min). Is there a better way to search so that
>>>>>>>>>
>>>>
>>>> overall
>>>>
>>>>>>>>
>>>>>>>> search
>>>>>>>>
>>>>>>>>>
>>>>>>>>> time reduces?
>>>>>>>>>
>>>>>>>>> Thanks,
>>>>>>>>> Prashant.
>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>>
>>>>>>>>
>>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> --
> Matthew Hall
> Software Engineer
> Mouse Genome Informatics
> mhall@informatics.jax.org
> (207) 288-6012
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20

Phone# (617) 714-4775
Cell# (617) 642-6745
Google Voice# (617) 575-9264

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41691-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 14:20:57 2009
Return-Path: <java-user-return-41691-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88860 invoked from network); 4 Aug 2009 14:20:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 14:20:57 -0000
Received: (qmail 21711 invoked by uid 500); 4 Aug 2009 14:20:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21597 invoked by uid 500); 4 Aug 2009 14:20:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21537 invoked by uid 99); 4 Aug 2009 14:20:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 14:20:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.242] (HELO web50309.mail.re2.yahoo.com) (206.190.38.242)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 04 Aug 2009 14:20:45 +0000
Received: (qmail 76110 invoked by uid 60001); 4 Aug 2009 14:20:24 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1249395624; bh=WOCiw5tqnwtfAGGtjHqznEu6NY5610izanVXEVV4jLw=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=eeKvNyslBTV69ZXRmARU9K1wxLMVLwBRxG5s92ojS0BPJrQ/P0YGSk98z37ZU2kvlXOBoyWEnNByAH42XOwTR/kGsaAxhHDekdmhrGLw9IZsN1CGWRlzc2fjPquzPUSGz7wlnSUk7VOznkK3h9so2tVfEHInhwUcql3syCa460c=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=KKB8MiOXCtYF0co2u2AQIXPxtyvwL96mf9Jbj0e82oIpjq+XKFoPdA5s8wJ+7FMmmy6pph+W5xeCQuf0wAaT07Iqqj+e8m6mx2W1FQpiTwiDIQ4ECoCtJT/vPhaEBmzXALpdmqbcgZWZUGTf9FmlvWuRpLwcJnNVvHQ3LXhBSFU=;
Message-ID: <180060.75297.qm@web50309.mail.re2.yahoo.com>
X-YMail-OSG: i5mqP4IVM1n3Q2DKgiTB37Bpr_EbluEgSwaGN9ueUNGmbKts7WzGC4SrL_QBEtnBHNzB.IrKpnCmFyiqy8554.x9S_ZRPFrrCxeC26ppeCEqgNvqxOC066hUsLk317h74U.aRUqcZvc9HMBUCmAcmga2K.aHoVSZhfKvwaHjO9oib30gB4snttEiCKOyXJt3jHgYk1l7eEXcfLQgTiKHlMdps3fbAb.BYBpv19jBPYJ8fbXK8lE7CTzbNzF97liESmpfV3ke0RfvAOQSq0MRLFk5xojiu2GEWHniExVUQ2qUf611rjP44V4hW06O58ZTnmMe1w.Fhmj2JDRa37mGjy.MusQnLFuIufBhSs0b
Received: from [167.206.188.3] by web50309.mail.re2.yahoo.com via HTTP; Tue, 04 Aug 2009 07:20:23 PDT
X-Mailer: YahooMailRC/1358.22 YahooMailWebService/0.7.338.2
References: <20090804115016.64b58dfe@pc-4176.kl.dfki.de>
Date: Tue, 4 Aug 2009 07:20:23 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: ParallelMultiSearcher and idf
To: java-user@lucene.apache.org
In-Reply-To: <20090804115016.64b58dfe@pc-4176.kl.dfki.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Christian,

You didn't mention Solr, so I'm not sure if you are aware of it.  Maybe Solr meets your needs?

 Otis
--
Sematext is hiring -- http://sematext.com/about/jobs.html?mls
Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR



----- Original Message ----
> From: Christian Reuschling <christian.reuschling@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Tuesday, August 4, 2009 5:50:16 AM
> Subject: ParallelMultiSearcher and idf
> 
> Hello,
> 
> when searching over multiple indices, we create one IndexReader for each index,
> and wrap them into a MultiReader, that we use for IndexSearcher creation.
> 
> This is fine for searching multiple indices on one machine, but in the case the
> indices are distributed over the (intra)net, this scenario has several lacks:
> 
> - searching/scoring/sorting is 100% on the client machine, so you need all the
>   ram and cpu power at every client.
> - all the data necessary for scoring must go over the net - so the traffic
>   should be significantly higher
> - thus, there is a lack of overall performance
> 
> Nevertheless, creating a MultiReader and making a searcher out of it has one
> advantage (at least can be an advantage depending on the scenario): The
> document freqiencies of a term will be summed up, and thus it is 100%
> transparent for scoring whether the indices are splittet or not.
> 
> I'm wondering whether there is the possibility to get the advantages of both
> scenarios, e.g. by first summing up the query terms-related document
> frequencies, and sending them together with the query to every (remote)searcher
> of ParallelMultiSearcher, for scoring.
> 
> Maybe this is exactly what ParallelMultiSearcher does, and I haven't seen it?
> 
> 
> Thanks for clarification!
> 
> Chris


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41692-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 14:40:05 2009
Return-Path: <java-user-return-41692-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3432 invoked from network); 4 Aug 2009 14:40:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 14:40:05 -0000
Received: (qmail 63337 invoked by uid 500); 4 Aug 2009 14:40:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63271 invoked by uid 500); 4 Aug 2009 14:40:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63261 invoked by uid 99); 4 Aug 2009 14:40:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 14:40:08 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.57] (HELO web50303.mail.re2.yahoo.com) (206.190.38.57)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 04 Aug 2009 14:39:56 +0000
Received: (qmail 72128 invoked by uid 60001); 4 Aug 2009 14:39:35 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1249396775; bh=51iD1JnGzl9bsNqwj+wtCKU8bKinLwaldb6jNfYF/aQ=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=2YeXh/S/KWDoJEHYkquCShpYyg21TP5cXgufO6hxZbdjA+fYjrSitpRC3Evl5Vn0jE6CwRLC6EO10ZqNKkqF3T7EqCH2p6Y0F6e2dRyt2jwUXzXyPGbkjguSVMRyMqu0zEv7EmmUllEDT/gB+ZjQAQP++txjO3+L9vnG0HRQft4=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=nBjjooSnKOF1Vu3SNxzDYrKQmsjRNmVihNjA0/KOQ5r1tNqsGJXgLgwcC9RVT72sN2tKEg4PTTeYYxzyjFdg4hBQB6ccszR+oyV1kJ7g3/eQ8PK8uxXjLhDXrwkOErhfXueY4U7ymC25n9Y2+ExZyOzILUO+U3fctS88JbG/sQY=;
Message-ID: <658029.71508.qm@web50303.mail.re2.yahoo.com>
X-YMail-OSG: QCaWZbMVM1ls4bqDsScCDWPJNYXndDfMM8wsr0ONP.FjBAzncodBjZaL3_r_bUGzxvKNXMAmvwQdypo44yJ261.ISSx5HnqKKX1xo220PYaBYZMbl7cSHKOjtZMumEv33F7VLnLVots0eWC83u3OJIIKE_VIZcSfWZx.HSfNt1O3BNdflJ3FWKKe7II5mPBf_lJsr9iAzxTv0gZH2yxj1T4ktGmO6nI.cy0X6PvoQmsc4MXDCKAvsQgTJ5xznRPsHEZNP0Ss7yLc_9JUj8kymF38HX1m0CD3kSfzZFnFPKm4yeP7dt1d2PoV5eivgylFOad7iE.VFzZBv736WIlBc833OUrJMZJo0tAGfGz5
Received: from [167.206.188.3] by web50303.mail.re2.yahoo.com via HTTP; Tue, 04 Aug 2009 07:39:35 PDT
X-Mailer: YahooMailRC/1358.22 YahooMailWebService/0.7.338.2
References: <D84A89F284EF0443AFC11A7FC41E4C6044C36F91@wdccpmail02.markettools.com> <D84A89F284EF0443AFC11A7FC41E4C6044C36F92@wdccpmail02.markettools.com>
Date: Tue, 4 Aug 2009 07:39:35 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: question about indexing/searching using standardanalyzer for KEYWORD field that contains alphanumeric data
To: java-user@lucene.apache.org
In-Reply-To: <D84A89F284EF0443AFC11A7FC41E4C6044C36F92@wdccpmail02.markettools.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Leonard,

Make sure the "key" or "id" fields are not analyzed and that should solve your problems.
You are using some older version of Lucene?

Otis
--
Sematext is hiring -- http://sematext.com/about/jobs.html?mls
Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR



----- Original Message ----
> From: Leonard Gestrin <Leonard.Gestrin@markettools.com>
> To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
> Sent: Sunday, August 2, 2009 10:49:27 PM
> Subject: question about indexing/searching using standardanalyzer for KEYWORD field that contains alphanumeric data
> 
> 
> Hello,
> I have question about KEYWORD type and searching/updating.  I am getting strange 
> behavior that I can't quite comprehend.
> My index is created using standard analyzer, which used for writing and 
> searching. It has three fields
> 
> userpin - alphanumeric field which is stored as TEXT
> documentkey  - alphanumeric field which is stored as TEXT
> contents - text of document which is stored as TEXT
> 
> When I try to update document I am creating Term to find document by documentKey 
> and I am using
> 
> org.apache.lucene.index.IndexWriter.updateDocument(term, pDocument);
> 
> to do the update.  Lucene fails to find the document by the term and I am 
> getting duplicate documents in the index.
> When I changed index to define documentKey as KEYWORD the updates started to 
> work fine.
> However, search for documentKey using StandardAnalyzer stopped working.
> 
> It appears that lucene is using keywordAnalyzer for searching for the term 
> during update, even though the indexer is open with StandardAnalyzer.
> 
> The sample values that are stored in documentKeys are: "L2222FAHBHMF", 
> "L2222FAHBHAS".
> I noticed if documentKey is numeric value, both KeywordAnalyzer and 
> StandardAnalyzer can find the documents by it without any problem thus reader 
> can find and indexer can update without any problems. With alphanumeric I cant 
> get both to work.
> Any help is appreciated.
> Thanks
> Leonard
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41693-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 15:00:52 2009
Return-Path: <java-user-return-41693-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9001 invoked from network); 4 Aug 2009 15:00:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 15:00:51 -0000
Received: (qmail 89933 invoked by uid 500); 4 Aug 2009 15:00:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89852 invoked by uid 500); 4 Aug 2009 15:00:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89842 invoked by uid 99); 4 Aug 2009 15:00:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:00:54 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: 131.246.120.220 is neither permitted nor denied by domain of christian.reuschling@gmail.com)
Received: from [131.246.120.220] (HELO mailgw1.uni-kl.de) (131.246.120.220)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:00:42 +0000
Received: from dfki.uni-kl.de (dfki-1002.dfki.uni-kl.de [131.246.195.2])
	by mailgw1.uni-kl.de (8.13.8/8.13.8/Debian-3) with ESMTP id n74F0MM8030780
	for <java-user@lucene.apache.org>; Tue, 4 Aug 2009 17:00:22 +0200
Received: from serv-4100.kl.dfki.de (serv-4100.kl.dfki.de [192.168.41.180])
	by dfki.uni-kl.de (8.13.8+Sun/8.11.4) with ESMTP id n74F0Lfs011070
	for <java-user@lucene.apache.org>; Tue, 4 Aug 2009 17:00:22 +0200 (CEST)
Received: from pc-4176.kl.dfki.de (pc-4176.kl.dfki.de [192.168.41.166])
	by serv-4100.kl.dfki.de (8.13.8+Sun/8.13.8) with ESMTP id n74F0LDT022049
	for <java-user@lucene.apache.org>; Tue, 4 Aug 2009 17:00:21 +0200 (CEST)
Date: Tue, 4 Aug 2009 17:00:13 +0200
From: Christian Reuschling <christian.reuschling@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: ParallelMultiSearcher and idf
Message-ID: <20090804170013.6d9b5753@pc-4176.kl.dfki.de>
In-Reply-To: <180060.75297.qm@web50309.mail.re2.yahoo.com>
References: <20090804115016.64b58dfe@pc-4176.kl.dfki.de>
	<180060.75297.qm@web50309.mail.re2.yahoo.com>
X-Mailer: Claws Mail 3.7.0 (GTK+ 2.14.4; i586-suse-linux-gnu)
Mime-Version: 1.0
Content-Type: multipart/signed; boundary="Sig_/sOR9p3xZ45/4VYPxU2Ey1NF";
 protocol="application/pgp-signature"; micalg=PGP-SHA1
X-Virus-Checked: Checked by ClamAV on apache.org

--Sig_/sOR9p3xZ45/4VYPxU2Ey1NF
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: quoted-printable

Hi Otis,

thanks for the answer - I'm aware of Solr, but it seems this is - according=
 to
its abstraction level - too generalized for us. Solr seems to be nice in the
case you want to use the black box, and won't be aware of 'what is under the
hood'.
But maybe I'm totaly wrong. At least, it would be from interest how Solr
realizes its distributed search, in the case it makes something different
than using the core-Lucene ParallelMultiSearcher with RemoteSearchables. Ma=
ybe
on this list somebody knows the answer.





On Tue, 4 Aug 2009 07:20:23 -0700 (PDT)
Otis Gospodnetic <otis_gospodnetic@yahoo.com> wrote:

> Hi Christian,
>=20
> You didn't mention Solr, so I'm not sure if you are aware of it.  Maybe S=
olr
> meets your needs?
>=20
>  Otis
> --
> Sematext is hiring -- http://sematext.com/about/jobs.html?mls
> Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
>=20
>=20
>=20
> ----- Original Message ----
> > From: Christian Reuschling <christian.reuschling@gmail.com>
> > To: java-user@lucene.apache.org
> > Sent: Tuesday, August 4, 2009 5:50:16 AM
> > Subject: ParallelMultiSearcher and idf
> >=20
> > Hello,
> >=20
> > when searching over multiple indices, we create one IndexReader for each
> > index, and wrap them into a MultiReader, that we use for IndexSearcher
> > creation.
> >=20
> > This is fine for searching multiple indices on one machine, but in the =
case
> > the indices are distributed over the (intra)net, this scenario has seve=
ral
> > lacks:
> >=20
> > - searching/scoring/sorting is 100% on the client machine, so you need =
all
> > the ram and cpu power at every client.
> > - all the data necessary for scoring must go over the net - so the traf=
fic
> >   should be significantly higher
> > - thus, there is a lack of overall performance
> >=20
> > Nevertheless, creating a MultiReader and making a searcher out of it ha=
s one
> > advantage (at least can be an advantage depending on the scenario): The
> > document freqiencies of a term will be summed up, and thus it is 100%
> > transparent for scoring whether the indices are splittet or not.
> >=20
> > I'm wondering whether there is the possibility to get the advantages of=
 both
> > scenarios, e.g. by first summing up the query terms-related document
> > frequencies, and sending them together with the query to every
> > (remote)searcher of ParallelMultiSearcher, for scoring.
> >=20
> > Maybe this is exactly what ParallelMultiSearcher does, and I haven't se=
en
> > it?
> >=20
> >=20
> > Thanks for clarification!
> >=20
> > Chris
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


--Sig_/sOR9p3xZ45/4VYPxU2Ey1NF
Content-Type: application/pgp-signature; name=signature.asc
Content-Disposition: attachment; filename=signature.asc

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.9 (GNU/Linux)

iEYEARECAAYFAkp4TQIACgkQ6EqMXq+WZg8fZwCeN9/2HPmq0lz/cJ7Lf1wXf73y
Mj8An1NrCd4Enofu5pp7ILuux+4GXhtF
=EZ/s
-----END PGP SIGNATURE-----

--Sig_/sOR9p3xZ45/4VYPxU2Ey1NF--

From java-user-return-41694-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 15:01:32 2009
Return-Path: <java-user-return-41694-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9299 invoked from network); 4 Aug 2009 15:01:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 15:01:32 -0000
Received: (qmail 92276 invoked by uid 500); 4 Aug 2009 15:01:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92179 invoked by uid 500); 4 Aug 2009 15:01:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92169 invoked by uid 99); 4 Aug 2009 15:01:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:01:34 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of eransevi@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:01:26 +0000
Received: by ewy26 with SMTP id 26so4957108ewy.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 08:01:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=Cgb/lmIUBPyl7gCKW2e8ezT114aZkdRdDngVP7OVJwk=;
        b=YHcVXC3zpXyKFtF1sYJIue2yhN1EdJdaKML6Q1d1z2adBYNoOL/F4Z7f6tTFVLfpeR
         2FgJFx+uRb03Lc6xPWLB10anCD5NHcleoD877bf+BLQ9aMmgyK13qayeSRjFgskd3RrO
         I4bN4oPVPCWHcJY+41dBB7LEcBI8CCqCLI1ZA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=lP+w4sEcTQa70jdzqZUclcemxwWecV9/OokMqOpm4J4e3WwDcI8zFBua+G4Znf0qFL
         73ojJ/y7s0slNK6Bu/62KCK9VrHy+W15RoY16LKJMkeuV5LB7cBnIUlSvnlYEGzMQ33l
         4OukTwg7RBLWHSt6km2SxLfI3Jy3HKBMOURUQ=
MIME-Version: 1.0
Received: by 10.210.57.15 with SMTP id f15mr6811459eba.54.1249398065348; Tue, 
	04 Aug 2009 08:01:05 -0700 (PDT)
Date: Tue, 4 Aug 2009 18:01:05 +0300
Message-ID: <74f928500908040801k382b5892tb549415a5f56b9c9@mail.gmail.com>
Subject: Is it possible to receive a score when using span queries?
From: Eran Sevi <eransevi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174bdc7ade3f8d0470522770
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174bdc7ade3f8d0470522770
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,
Does anyone knows of how to retrieve such score for any kind of span queries
(especially SpanNearQueries) ?

Thanks,
Eran.

--0015174bdc7ade3f8d0470522770--

From java-user-return-41695-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 15:19:56 2009
Return-Path: <java-user-return-41695-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16668 invoked from network); 4 Aug 2009 15:19:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 15:19:56 -0000
Received: (qmail 27960 invoked by uid 500); 4 Aug 2009 15:19:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27900 invoked by uid 500); 4 Aug 2009 15:19:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27890 invoked by uid 99); 4 Aug 2009 15:19:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:19:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:19:49 +0000
Received: by ywh26 with SMTP id 26so5269507ywh.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 08:19:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=j67JFV57GCZuBimOelzjTQgZ+jxq6aVcM2UYljrnOZQ=;
        b=LPKCiHNK/56Hr0b0ihxkXSYgn3XpuanC8cv1rehT+8hWjXuj+vxYuwxtbVaqXXZLaL
         7QiTcTVxQU1fONZ/bmZBSpva3MdlClb8s7ACb7CxP7MkPmqMGgUKYMweVIZgkcBmbRXa
         0+fQBBwgVw2hAMmpq2ArkDLP6GG4bDW6JIQKM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=gkPP05xccFVThQtc9DOeEqXVP33N6LSMeitOT0TKkOAoxma2zdkquvg2IobpGQikcT
         beitsbPRVq5b/cfCo/GxenPMSGlsj1DL3acCi83RF8+mA8iaNunrwq83k4li1MVuHs0l
         RtBBbM3wY4cDTNUosDTqZc/QWB8q2jit68ROQ=
MIME-Version: 1.0
Received: by 10.100.254.19 with SMTP id b19mr8803107ani.22.1249399147103; Tue, 
	04 Aug 2009 08:19:07 -0700 (PDT)
In-Reply-To: <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com>
References: <24802552.post@talk.nabble.com>
	 <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com>
	 <24803073.post@talk.nabble.com>
	 <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com>
	 <24803560.post@talk.nabble.com>
	 <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com>
	 <24805609.post@talk.nabble.com>
	 <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com>
Date: Tue, 4 Aug 2009 08:19:06 -0700
Message-ID: <9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com>
Subject: Re: Searching doubt
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, Aug 4, 2009 at 3:56 AM, Shai Erera<serera@gmail.com> wrote:
> 2) Use a dictionary (real dictionary), and search it for every substring,
> e.g. "a", "ab", "abo" ... "about" etc. If you find a match, split it there.
> This needs some fine tuning, like checking if the rest is also a word and if
> the full string is also a word, so that you don't break up meaningful words.
> You'll need to get a dictionary for that.

I do not have a solution to this, but it strikes me as very similar to
they way you traverse Japanese to break words, since that has no
spaces. Is there a Japanese tokenizer and, if so, does it handle this?
If so, you could replace the Japanese dictionary with an English
dictionary. Just a random thought had that might / might not help.

Phil

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41696-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 15:28:39 2009
Return-Path: <java-user-return-41696-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20342 invoked from network); 4 Aug 2009 15:28:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 15:28:39 -0000
Received: (qmail 46832 invoked by uid 500); 4 Aug 2009 15:28:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46751 invoked by uid 500); 4 Aug 2009 15:28:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46741 invoked by uid 99); 4 Aug 2009 15:28:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:28:42 +0000
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.68.4.129] (HELO wbm7.pair.net) (209.68.4.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:28:33 +0000
Received: by wbm7.pair.net (Postfix, from userid 65534)
	id 436E610520; Tue,  4 Aug 2009 11:27:44 -0400 (EDT)
Received: from 38.103.17.250 ([38.103.17.250])
        (SquirrelMail authenticated user darren@ontrenet.com)
        by webmail7.pair.com with HTTP;
        Tue, 4 Aug 2009 11:27:43 -0400 (EDT)
Message-ID: <39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com>
In-Reply-To: <9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com>
References: <24802552.post@talk.nabble.com> 
    <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com> 
    <24803073.post@talk.nabble.com> 
    <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com> 
    <24803560.post@talk.nabble.com> 
    <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com> 
    <24805609.post@talk.nabble.com> 
    <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com>
    <9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com>
Date: Tue, 4 Aug 2009 11:27:43 -0400 (EDT)
Subject: Re: Searching doubt
From: darren@ontrenet.com
To: java-user@lucene.apache.org
User-Agent: SquirrelMail/1.4.5
MIME-Version: 1.0
Content-Type: text/plain;charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Priority: 3 (Normal)
Importance: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Just catching this thread, but if I understand what is being asked I can
share how I do multi-word phrase matching. If that's not what's wanted,
pardons!

Ok, I load an entire dictionary into a lucene index, phrases and all.

When I'm scanning some text, I do lookups in this dictionary index using
one word at a time with the word _at the beginning_ of the indexed field
only. This returns all words/phrases beginning with the word I searched
for.

I then scan the rest of the input text and compare it to the longest
matching phrase in my lucene results. That then becomes a meaningful
token.

Input text:
"The President of the United States lives in the White House"

Tokens:
"The"
"President of the United States"
"lives"
"in"
"the"
"White House"

Term: "President"
Result:
"President of a Company"
"President"
"President of the United States"

Take the longest match.

HTH,
Darren



> On Tue, Aug 4, 2009 at 3:56 AM, Shai Erera<serera@gmail.com> wrote:
>> 2) Use a dictionary (real dictionary), and search it for every
>> substring,
>> e.g. "a", "ab", "abo" ... "about" etc. If you find a match, split it
>> there.
>> This needs some fine tuning, like checking if the rest is also a word
>> and if
>> the full string is also a word, so that you don't break up meaningful
>> words.
>> You'll need to get a dictionary for that.
>
> I do not have a solution to this, but it strikes me as very similar to
> they way you traverse Japanese to break words, since that has no
> spaces. Is there a Japanese tokenizer and, if so, does it handle this?
> If so, you could replace the Japanese dictionary with an English
> dictionary. Just a random thought had that might / might not help.
>
> Phil
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41697-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 15:32:15 2009
Return-Path: <java-user-return-41697-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22288 invoked from network); 4 Aug 2009 15:32:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 15:32:15 -0000
Received: (qmail 56784 invoked by uid 500); 4 Aug 2009 15:32:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56709 invoked by uid 500); 4 Aug 2009 15:32:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56699 invoked by uid 99); 4 Aug 2009 15:32:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:32:17 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:32:08 +0000
Received: by ewy26 with SMTP id 26so4984104ewy.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 08:31:48 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=yFKao/1VQGx+hsU23mV8l05oRe8bpVOnkZr5+22I+TY=;
        b=WIAyW+UAMWhtqyuJbjW8jg4/t4C5+TegTm541io9vm2iZN/vDDAzYvX+shxKz4Ee9t
         5DWYd5Cug5JBGNN8oMMxdn7DO+566eHu7xI+az1QbGGEN5EioPu9RPeOeWqdQCjg8TEv
         jfLJkqSac35G8bBgJSYQFUcrsABkM718e9E8g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=qgJU2IkXgU2EhUblHkdWXiHHrReCLkKeHQqt4mZnBj5r/UNeY8mhivPKBnI/RDXH2w
         U9zyMzIlGJxBk++FGBbvtSQscbQl1gbmURNf86LxKlXRFRniv3XAy+Yzl8/5r0AcqnuK
         E9YWI3oKoTuaEbl2WTYS4rjeY9AJPWhOp0Q6M=
MIME-Version: 1.0
Received: by 10.216.35.204 with SMTP id u54mr1403610wea.182.1249399906699; 
	Tue, 04 Aug 2009 08:31:46 -0700 (PDT)
In-Reply-To: <39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com>
References: <24802552.post@talk.nabble.com>
	 <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com>
	 <24803073.post@talk.nabble.com>
	 <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com>
	 <24803560.post@talk.nabble.com>
	 <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com>
	 <24805609.post@talk.nabble.com>
	 <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com>
	 <9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com>
	 <39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com>
Date: Tue, 4 Aug 2009 18:31:46 +0300
Message-ID: <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
Subject: Re: Searching doubt
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016365ee9109f0a9004705295be
X-Virus-Checked: Checked by ClamAV on apache.org

--0016365ee9109f0a9004705295be
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Darren,

The question was, how given a string "aboutus" in a document, you can return
that document as a result to the query "about us" (note the space). So we're
mostly discussing how to detect and then break the word "aboutus" to two
words.

What you wrote though seems interesting as well, only I think not related to
Harig's original question. Maybe he'll be interested in that too though.

Shai

On Tue, Aug 4, 2009 at 6:27 PM, <darren@ontrenet.com> wrote:

> Just catching this thread, but if I understand what is being asked I can
> share how I do multi-word phrase matching. If that's not what's wanted,
> pardons!
>
> Ok, I load an entire dictionary into a lucene index, phrases and all.
>
> When I'm scanning some text, I do lookups in this dictionary index using
> one word at a time with the word _at the beginning_ of the indexed field
> only. This returns all words/phrases beginning with the word I searched
> for.
>
> I then scan the rest of the input text and compare it to the longest
> matching phrase in my lucene results. That then becomes a meaningful
> token.
>
> Input text:
> "The President of the United States lives in the White House"
>
> Tokens:
> "The"
> "President of the United States"
> "lives"
> "in"
> "the"
> "White House"
>
> Term: "President"
> Result:
> "President of a Company"
> "President"
> "President of the United States"
>
> Take the longest match.
>
> HTH,
> Darren
>
>
>
> > On Tue, Aug 4, 2009 at 3:56 AM, Shai Erera<serera@gmail.com> wrote:
> >> 2) Use a dictionary (real dictionary), and search it for every
> >> substring,
> >> e.g. "a", "ab", "abo" ... "about" etc. If you find a match, split it
> >> there.
> >> This needs some fine tuning, like checking if the rest is also a word
> >> and if
> >> the full string is also a word, so that you don't break up meaningful
> >> words.
> >> You'll need to get a dictionary for that.
> >
> > I do not have a solution to this, but it strikes me as very similar to
> > they way you traverse Japanese to break words, since that has no
> > spaces. Is there a Japanese tokenizer and, if so, does it handle this?
> > If so, you could replace the Japanese dictionary with an English
> > dictionary. Just a random thought had that might / might not help.
> >
> > Phil
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016365ee9109f0a9004705295be--

From java-user-return-41698-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 15:34:15 2009
Return-Path: <java-user-return-41698-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22946 invoked from network); 4 Aug 2009 15:34:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 15:34:15 -0000
Received: (qmail 61565 invoked by uid 500); 4 Aug 2009 15:34:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61495 invoked by uid 500); 4 Aug 2009 15:34:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61485 invoked by uid 99); 4 Aug 2009 15:34:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:34:17 +0000
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.68.4.129] (HELO wbm7.pair.net) (209.68.4.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:34:08 +0000
Received: by wbm7.pair.net (Postfix, from userid 65534)
	id 2C13710520; Tue,  4 Aug 2009 11:33:46 -0400 (EDT)
Received: from 38.103.17.250 ([38.103.17.250])
        (SquirrelMail authenticated user darren@ontrenet.com)
        by webmail7.pair.com with HTTP;
        Tue, 4 Aug 2009 11:33:46 -0400 (EDT)
Message-ID: <55198.38.103.17.250.1249400026.squirrel@webmail7.pair.com>
In-Reply-To: <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
References: <24802552.post@talk.nabble.com> 
    <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com> 
    <24803073.post@talk.nabble.com> 
    <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com> 
    <24803560.post@talk.nabble.com> 
    <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com> 
    <24805609.post@talk.nabble.com> 
    <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com> 
    <9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com> 
    <39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com>
    <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
Date: Tue, 4 Aug 2009 11:33:46 -0400 (EDT)
Subject: Re: Searching doubt
From: darren@ontrenet.com
To: java-user@lucene.apache.org
Cc: java-user@lucene.apache.org
User-Agent: SquirrelMail/1.4.5
MIME-Version: 1.0
Content-Type: text/plain;charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Priority: 3 (Normal)
Importance: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Ahhhh, ok. Interesting problem there as well.

I'll think on that one some too!

cheers.

> Hi Darren,
>
> The question was, how given a string "aboutus" in a document, you can
> return
> that document as a result to the query "about us" (note the space). So
> we're
> mostly discussing how to detect and then break the word "aboutus" to two
> words.
>
> What you wrote though seems interesting as well, only I think not related
> to
> Harig's original question. Maybe he'll be interested in that too though.
>
> Shai
>
> On Tue, Aug 4, 2009 at 6:27 PM, <darren@ontrenet.com> wrote:
>
>> Just catching this thread, but if I understand what is being asked I can
>> share how I do multi-word phrase matching. If that's not what's wanted,
>> pardons!
>>
>> Ok, I load an entire dictionary into a lucene index, phrases and all.
>>
>> When I'm scanning some text, I do lookups in this dictionary index using
>> one word at a time with the word _at the beginning_ of the indexed field
>> only. This returns all words/phrases beginning with the word I searched
>> for.
>>
>> I then scan the rest of the input text and compare it to the longest
>> matching phrase in my lucene results. That then becomes a meaningful
>> token.
>>
>> Input text:
>> "The President of the United States lives in the White House"
>>
>> Tokens:
>> "The"
>> "President of the United States"
>> "lives"
>> "in"
>> "the"
>> "White House"
>>
>> Term: "President"
>> Result:
>> "President of a Company"
>> "President"
>> "President of the United States"
>>
>> Take the longest match.
>>
>> HTH,
>> Darren
>>
>>
>>
>> > On Tue, Aug 4, 2009 at 3:56 AM, Shai Erera<serera@gmail.com> wrote:
>> >> 2) Use a dictionary (real dictionary), and search it for every
>> >> substring,
>> >> e.g. "a", "ab", "abo" ... "about" etc. If you find a match, split it
>> >> there.
>> >> This needs some fine tuning, like checking if the rest is also a word
>> >> and if
>> >> the full string is also a word, so that you don't break up meaningful
>> >> words.
>> >> You'll need to get a dictionary for that.
>> >
>> > I do not have a solution to this, but it strikes me as very similar to
>> > they way you traverse Japanese to break words, since that has no
>> > spaces. Is there a Japanese tokenizer and, if so, does it handle this?
>> > If so, you could replace the Japanese dictionary with an English
>> > dictionary. Just a random thought had that might / might not help.
>> >
>> > Phil
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41699-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 15:38:07 2009
Return-Path: <java-user-return-41699-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23986 invoked from network); 4 Aug 2009 15:38:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 15:38:07 -0000
Received: (qmail 66837 invoked by uid 500); 4 Aug 2009 15:38:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66747 invoked by uid 500); 4 Aug 2009 15:38:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66737 invoked by uid 99); 4 Aug 2009 15:38:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:38:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:38:00 +0000
Received: by ywh26 with SMTP id 26so5289234ywh.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 08:37:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=h4UNuvBBkwFFG72PMsndxcJP2S6AapIHIbDioEItU9M=;
        b=udoQB8Tywa5xmLLMVsjSLbUn9ycM4H+W5Tnfed4zdFcakc7WRH44e1fUe486RobLDf
         8uNzzq/59sZu9Xyo/hMupVuoLSWr3RbgfItieAwBYUkMHFcq+N7rSCc3h0/ZH+oeQfss
         +2esqcJ0wgtUNIZ+YRMRrs91snUbBgReBzmxw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=nuT/DzUmaQigiWpq+syyB9IpPaRU+honyUNH5yDLz5q3zMqpxkvIzg06OoNPpa1SWQ
         xUUvDyOGDnu6lpG5KNH+mWthLxnwMHRllqHRg8rTQ08lOmNKriVjgOy1WcLnNcVS3+ny
         3PYTHBr4tTInMQuFMGd0t4rs9bh17v1QQZRW8=
MIME-Version: 1.0
Received: by 10.100.45.13 with SMTP id s13mr9834293ans.193.1249400259342; Tue, 
	04 Aug 2009 08:37:39 -0700 (PDT)
In-Reply-To: <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
References: <24802552.post@talk.nabble.com> <24803073.post@talk.nabble.com>
	 <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com>
	 <24803560.post@talk.nabble.com>
	 <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com>
	 <24805609.post@talk.nabble.com>
	 <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com>
	 <9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com>
	 <39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com>
	 <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
Date: Tue, 4 Aug 2009 08:37:39 -0700
Message-ID: <9cafbc680908040837t5e113320p1f8a050848530610@mail.gmail.com>
Subject: Re: Searching doubt
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, Aug 4, 2009 at 8:31 AM, Shai Erera<serera@gmail.com> wrote:
> Hi Darren,
>
> The question was, how given a string "aboutus" in a document, you can return
> that document as a result to the query "about us" (note the space). So we're
> mostly discussing how to detect and then break the word "aboutus" to two
> words.

When traversing Japanese text you have a use a similar algorithm to
searching a maze (keep left and retrace your steps). It's possible to
go a long way along sentence before you find the tokens you've already
picked out are invalid. Rough example...

thereallibrary
there allibrary
there all i brary (fail)
the reallibrary
the real library

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41700-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 15:40:57 2009
Return-Path: <java-user-return-41700-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25010 invoked from network); 4 Aug 2009 15:40:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 15:40:57 -0000
Received: (qmail 77251 invoked by uid 500); 4 Aug 2009 15:41:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77191 invoked by uid 500); 4 Aug 2009 15:41:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77181 invoked by uid 99); 4 Aug 2009 15:41:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:41:00 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.8] (HELO eastrmmtao102.cox.net) (68.230.240.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:40:50 +0000
Received: from eastrmimpo02.cox.net ([68.1.16.120])
          by eastrmmtao102.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090804154030.ZRYG22890.eastrmmtao102.cox.net@eastrmimpo02.cox.net>
          for <java-user@lucene.apache.org>; Tue, 4 Aug 2009 11:40:30 -0400
Received: from eastrmwml31 ([172.18.18.217])
	by eastrmimpo02.cox.net with bizsmtp
	id QFgV1c0064h0NJL02FgVV6; Tue, 04 Aug 2009 11:40:29 -0400
X-VR-Score: -10.00
X-Authority-Analysis: v=1.0 c=1 a=01nZEAzwi9gA:10 a=6rvF9n616tb2p4LhmBYA:9
 a=mTaYiAYiJ8MXJQY82eUA:7 a=lHzmR4VZ50E__quAlJStG_WKt9oA:4
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Tue, 4 Aug 2009 11:40:29 -0400
Message-ID: <20090804114029.ATIS8.4210.imail@eastrmwml31>
Date: Tue, 4 Aug 2009 11:40:29 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Slightly Off-topic:  How to decide whether or not to add a
 document?
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I have an app to initially create a Lucene index, and to populate it with documents.  I'm now working on that app to insert new documents into that Lucene index.

In general, this new app, which is based loosely on the demo apps (e.g., IndexFiles.java), is working, i.e., I can run it with a "create" parameter, and it creates a good/valid index from the documents, and then I can run it with an "insert" parameter, and it inserts new documents into the index.

[As I mentioned in an earlier thread, we only have a requirement to insert new documents into the index, no requirements for deleting documents or updating documents that have already been indexed).

Ok, as I said, that works so far.

However, in our case, the processes that are creating the documents that we are indexing are fairly long-lived, and write fairly large documents, and I'm worried that when an insert operation is run, some of the potential documents may still be being written to, and we wouldn't want the indexer to insert the document into the Lucene index until the document is "complete".

As you know, the way that the demos such as IndexFiles work is that they call a method called IndexDocs().  IndexDocs() then recursively walks the directory tree, and calling the writer to add to the index.

In this loop, IndexDocs() does a few checks (isDirectory(), canRead), and I think that it would "pick up" (find) some documents that are still "in progress" (being written to, and not closed) in our case.

I was wondering if anyone here has a situation similar to this (having to index large documents that may be "in progress/being written to"), and how you handle this situation?

FYI, this is on Redhat Linux (and on Windows in my test environment).

Thanks!

Jim


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41701-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 15:43:18 2009
Return-Path: <java-user-return-41701-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25695 invoked from network); 4 Aug 2009 15:43:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 15:43:18 -0000
Received: (qmail 81480 invoked by uid 500); 4 Aug 2009 15:43:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81396 invoked by uid 500); 4 Aug 2009 15:43:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81386 invoked by uid 99); 4 Aug 2009 15:43:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:43:21 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:43:13 +0000
Received: by ewy26 with SMTP id 26so4993820ewy.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 08:42:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=KqpQ9x6fL3Jf65KHqJWxC4T7/p5shKKFUA+vPIxU4cQ=;
        b=Y34/p+TtVooRlPiPg+N8FSkgkNpJkABotc8UcIzWdJHeFT/1PjfHuZVIj7NULaw7Pf
         q/TLLAKJLjb223diXsgRIrAhzUJZSGdE9y0Fw9uz4J28jOOyMnSgmXDEcY6OsjZyf063
         k6ci/qFUzoHVTZeDUukL7GqCCZaw8wAgrXH9o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=n1KKFtzPZTOKMZ5EZYOp0OrRg8xbbxGn+v1wYewQbHH3/ov2HRQdpA2toekjZ35pe8
         c2U3TYVq6Kc7RzZc/p3jNOSUzAEcOoNSeD+KeffuDSdYQrTvhYeD9S1RKNWUFjNEuDTr
         GH0pMUwtvA57DV48ZOJjBfRrL4JkBSUwJF+2s=
MIME-Version: 1.0
Received: by 10.216.87.71 with SMTP id x49mr1531466wee.11.1249400571803; Tue, 
	04 Aug 2009 08:42:51 -0700 (PDT)
In-Reply-To: <9cafbc680908040837t5e113320p1f8a050848530610@mail.gmail.com>
References: <24802552.post@talk.nabble.com>
	 <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com>
	 <24803560.post@talk.nabble.com>
	 <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com>
	 <24805609.post@talk.nabble.com>
	 <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com>
	 <9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com>
	 <39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com>
	 <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
	 <9cafbc680908040837t5e113320p1f8a050848530610@mail.gmail.com>
Date: Tue, 4 Aug 2009 18:42:51 +0300
Message-ID: <786fde50908040842m2e4a6034k8a61027265f65b48@mail.gmail.com>
Subject: Re: Searching doubt
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d63f8a43ba33047052bd22
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d63f8a43ba33047052bd22
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Interesting ... I don't have access to a Japanese dictionary, so I just
extract bi-grams. But I guess that in this case, if one can access an
English dictionary (are you aware of an "open-source" one, or free one
BTW?), one can use the method you mention.

But still, doing this for every Token you meet is extremely expensive (for
Japanese is all you can do, but this case is rather special), so I'd first
make sure I can pinpoint the very small number of possible tokens I should
process like that.

Shai

On Tue, Aug 4, 2009 at 6:37 PM, Phil Whelan <phil123@gmail.com> wrote:

> On Tue, Aug 4, 2009 at 8:31 AM, Shai Erera<serera@gmail.com> wrote:
> > Hi Darren,
> >
> > The question was, how given a string "aboutus" in a document, you can
> return
> > that document as a result to the query "about us" (note the space). So
> we're
> > mostly discussing how to detect and then break the word "aboutus" to two
> > words.
>
> When traversing Japanese text you have a use a similar algorithm to
> searching a maze (keep left and retrace your steps). It's possible to
> go a long way along sentence before you find the tokens you've already
> picked out are invalid. Rough example...
>
> thereallibrary
> there allibrary
> there all i brary (fail)
> the reallibrary
> the real library
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d63f8a43ba33047052bd22--

From java-user-return-41702-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 15:56:33 2009
Return-Path: <java-user-return-41702-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28138 invoked from network); 4 Aug 2009 15:56:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 15:56:33 -0000
Received: (qmail 95120 invoked by uid 500); 4 Aug 2009 15:56:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95036 invoked by uid 500); 4 Aug 2009 15:56:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95026 invoked by uid 99); 4 Aug 2009 15:56:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:56:35 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 72.14.220.152 as permitted sender)
Received: from [72.14.220.152] (HELO fg-out-1718.google.com) (72.14.220.152)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 15:56:26 +0000
Received: by fg-out-1718.google.com with SMTP id l27so694214fgb.4
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 08:56:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=b6KhCjmXEFV4b2YR6QOypsMsttdlQziyjTT+BPhaUNc=;
        b=NLx7oG6FwDbr/QWe2/ki/W67ueUO3jSN+3SRTBJXFxrWXug3ZNVx2Yixd4SYRYl4Cb
         +pPwaqfJ7FAoo6EsJ67nd0CYuSJz0ihJNSxYd0QGqnLbd9wdPjnXMDMdKE6mAqA6Ky1I
         Cb91SULpizz8ful5DdVod8PDLrCVTCAaKjCC0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=eqtJHYk5Hr8xgY0osaJL7x1toldP5U/ie62r7x/SNp/GWOYTJRjtD3agZ5nGnfWJ7W
         PktzjZ2GogVI3o87mSmhQIhu/vjpp8MC+alaJiO9anh2QQ/+uUuq+X6vrQm6uztJ/jmZ
         aqEAQTFYJ65qam9AzdIt3vJ+qhaRyQ6fHgQyU=
MIME-Version: 1.0
Received: by 10.86.87.1 with SMTP id k1mr2700506fgb.74.1249401366091; Tue, 04 
	Aug 2009 08:56:06 -0700 (PDT)
In-Reply-To: <20090804114029.ATIS8.4210.imail@eastrmwml31>
References: <20090804114029.ATIS8.4210.imail@eastrmwml31>
From: Ian Lea <ian.lea@gmail.com>
Date: Tue, 4 Aug 2009 16:55:46 +0100
Message-ID: <8c4e68610908040855u736e0dddh2f0f44f6baf74970@mail.gmail.com>
Subject: Re: Slightly Off-topic: How to decide whether or not to add a 
	document?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

A few suggestions:

. Queue the docs once they are complete using something like JMS.

. Get the document producers to write to e.g. xxx.tmp and rename to
e.g. xxx.txt at the end

. Get the document producers to write to a tmp folder and move to e.g.
input/ when done

. Find a file, store size, sleep for a while, check size and if changed, sk=
ip

I've used all these at one time or another for assorted, mainly
non-lucene, apps, and they are all workable.


--
Ian.


On Tue, Aug 4, 2009 at 4:40 PM, <ohaya@cox.net> wrote:
> Hi,
>
> I have an app to initially create a Lucene index, and to populate it with=
 documents. =A0I'm now working on that app to insert new documents into tha=
t Lucene index.
>
> In general, this new app, which is based loosely on the demo apps (e.g., =
IndexFiles.java), is working, i.e., I can run it with a "create" parameter,=
 and it creates a good/valid index from the documents, and then I can run i=
t with an "insert" parameter, and it inserts new documents into the index.
>
> [As I mentioned in an earlier thread, we only have a requirement to inser=
t new documents into the index, no requirements for deleting documents or u=
pdating documents that have already been indexed).
>
> Ok, as I said, that works so far.
>
> However, in our case, the processes that are creating the documents that =
we are indexing are fairly long-lived, and write fairly large documents, an=
d I'm worried that when an insert operation is run, some of the potential d=
ocuments may still be being written to, and we wouldn't want the indexer to=
 insert the document into the Lucene index until the document is "complete"=
.
>
> As you know, the way that the demos such as IndexFiles work is that they =
call a method called IndexDocs(). =A0IndexDocs() then recursively walks the=
 directory tree, and calling the writer to add to the index.
>
> In this loop, IndexDocs() does a few checks (isDirectory(), canRead), and=
 I think that it would "pick up" (find) some documents that are still "in p=
rogress" (being written to, and not closed) in our case.
>
> I was wondering if anyone here has a situation similar to this (having to=
 index large documents that may be "in progress/being written to"), and how=
 you handle this situation?
>
> FYI, this is on Redhat Linux (and on Windows in my test environment).
>
> Thanks!
>
> Jim
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41703-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 16:00:49 2009
Return-Path: <java-user-return-41703-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29101 invoked from network); 4 Aug 2009 16:00:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 16:00:49 -0000
Received: (qmail 1411 invoked by uid 500); 4 Aug 2009 16:00:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1340 invoked by uid 500); 4 Aug 2009 16:00:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1330 invoked by uid 99); 4 Aug 2009 16:00:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 16:00:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.220.225 as permitted sender)
Received: from [209.85.220.225] (HELO mail-fx0-f225.google.com) (209.85.220.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 16:00:43 +0000
Received: by fxm25 with SMTP id 25so4302505fxm.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 09:00:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=+1VG82mIrQmVwgGv8wFwLPOGx39/rFoZWFqCbrOzRRw=;
        b=KcoTFy8/80Aynkpjf/hBIa8r8q2XEpoMSgTe22ipWvmW73iEuAamQuAAecqSHWoXPu
         94XTxjTeS/ZbYCH0oqninkX+qk58JNV5GYY6/5ZtdKHeiDQzHSf60bfAiYqjA3JFNePr
         2wUY5a0Rx95ZjNW209bPlectpTPl1klOcDX7A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=iyWR7e2zurxv6IbZgT95RzpWlbRThLvez/gsX84p00bYc1JJUZwZLuNZOVwEbmfcI3
         5TF8g2I183E9uIL4nrNqvbmX1GAGf67LHb1pmeGNjo7UI+Lot3f6IdnWV7wCtvXZLtyD
         ajmU/mM1YzB1GkLM8zzO1LZ4SuMlzTkHFuisQ=
MIME-Version: 1.0
Received: by 10.86.49.8 with SMTP id w8mr2832527fgw.37.1249401622321; Tue, 04 
	Aug 2009 09:00:22 -0700 (PDT)
In-Reply-To: <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
References: <24802552.post@talk.nabble.com> <24803073.post@talk.nabble.com> 
	<786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com> 
	<24803560.post@talk.nabble.com> <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com> 
	<24805609.post@talk.nabble.com> <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com> 
	<9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com> 
	<39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com> 
	<786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Tue, 4 Aug 2009 17:00:02 +0100
Message-ID: <8c4e68610908040900t22f8763drcee07a09731e6b16@mail.gmail.com>
Subject: Re: Searching doubt
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

> The question was, how given a string "aboutus" in a document, you can return
> that document as a result to the query "about us" (note the space). So we're
> mostly discussing how to detect and then break the word "aboutus" to two
> words.

I haven't really been following this thread so apologies if way off
target, but reading the above makes me wonder if it can simply be
reversed: remove the space from "about us" and search on that.


--
Ian.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41704-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 16:03:45 2009
Return-Path: <java-user-return-41704-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31491 invoked from network); 4 Aug 2009 16:03:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 16:03:45 -0000
Received: (qmail 10203 invoked by uid 500); 4 Aug 2009 16:03:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10104 invoked by uid 500); 4 Aug 2009 16:03:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10068 invoked by uid 99); 4 Aug 2009 16:03:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 16:03:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.59] (HELO eastrmmtao107.cox.net) (68.230.240.59)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 16:03:37 +0000
Received: from eastrmimpo02.cox.net ([68.1.16.120])
          by eastrmmtao107.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090804160317.PUDM22474.eastrmmtao107.cox.net@eastrmimpo02.cox.net>;
          Tue, 4 Aug 2009 12:03:17 -0400
Received: from eastrmwml31 ([172.18.18.217])
	by eastrmimpo02.cox.net with bizsmtp
	id QG3F1c00N4h0NJL02G3FGH; Tue, 04 Aug 2009 12:03:15 -0400
X-VR-Score: -210.00
X-Authority-Analysis: v=1.0 c=1 a=X8TF0b0RfGQA:10 a=pGLkceISAAAA:8
 a=kviXuzpPAAAA:8 a=mV9VRH-2AAAA:8 a=_8Hbv8UCzi99xXCFcPcA:9
 a=dIce76YGhe0lIoWzWiQA:7 a=Woa83iRHcA3hXJqiIjFHkuiCiyQA:4 a=MSl-tDqOz04A:10
 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Tue, 4 Aug 2009 12:03:16 -0400
Message-ID: <20090804120316.GBI2D.4626.imail@eastrmwml31>
Date: Tue, 4 Aug 2009 12:03:16 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Slightly Off-topic: How to decide whether or not to add a
  document?
Cc: Ian Lea <ian.lea@gmail.com>
In-Reply-To: <8c4e68610908040855u736e0dddh2f0f44f6baf74970@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Ian,

Thanks for the quick response.

I forgot to mention, but in our case, the "producers" is part of a commerci=
al package, so we don't have a way to get them to change anything, so I thi=
nk the 1st 3 suggestions are not feasible for us.

I have considered something like the 4th suggestion (check file size, timeo=
ut, and check file size again).  I'm worried that it would impact the overa=
ll index insertion process, but that unless there's something better, that =
may be our best option :(...

Thanks again,
Jim


---- Ian Lea <ian.lea@gmail.com> wrote:=20
> A few suggestions:
>=20
> . Queue the docs once they are complete using something like JMS.
>=20
> . Get the document producers to write to e.g. xxx.tmp and rename to
> e.g. xxx.txt at the end
>=20
> . Get the document producers to write to a tmp folder and move to e.g.
> input/ when done
>=20
> . Find a file, store size, sleep for a while, check size and if changed, =
skip
>=20
> I've used all these at one time or another for assorted, mainly
> non-lucene, apps, and they are all workable.
>=20
>=20
> --
> Ian.
>=20
>=20
> On Tue, Aug 4, 2009 at 4:40 PM, <ohaya@cox.net> wrote:
> > Hi,
> >
> > I have an app to initially create a Lucene index, and to populate it wi=
th documents. =C2=A0I'm now working on that app to insert new documents int=
o that Lucene index.
> >
> > In general, this new app, which is based loosely on the demo apps (e.g.=
, IndexFiles.java), is working, i.e., I can run it with a "create" paramete=
r, and it creates a good/valid index from the documents, and then I can run=
 it with an "insert" parameter, and it inserts new documents into the index=
.
> >
> > [As I mentioned in an earlier thread, we only have a requirement to ins=
ert new documents into the index, no requirements for deleting documents or=
 updating documents that have already been indexed).
> >
> > Ok, as I said, that works so far.
> >
> > However, in our case, the processes that are creating the documents tha=
t we are indexing are fairly long-lived, and write fairly large documents, =
and I'm worried that when an insert operation is run, some of the potential=
 documents may still be being written to, and we wouldn't want the indexer =
to insert the document into the Lucene index until the document is "complet=
e".
> >
> > As you know, the way that the demos such as IndexFiles work is that the=
y call a method called IndexDocs(). =C2=A0IndexDocs() then recursively walk=
s the directory tree, and calling the writer to add to the index.
> >
> > In this loop, IndexDocs() does a few checks (isDirectory(), canRead), a=
nd I think that it would "pick up" (find) some documents that are still "in=
 progress" (being written to, and not closed) in our case.
> >
> > I was wondering if anyone here has a situation similar to this (having =
to index large documents that may be "in progress/being written to"), and h=
ow you handle this situation?
> >
> > FYI, this is on Redhat Linux (and on Windows in my test environment).
> >
> > Thanks!
> >
> > Jim
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41705-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 16:08:41 2009
Return-Path: <java-user-return-41705-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32188 invoked from network); 4 Aug 2009 16:08:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 16:08:41 -0000
Received: (qmail 14138 invoked by uid 500); 4 Aug 2009 16:08:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14067 invoked by uid 500); 4 Aug 2009 16:08:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14057 invoked by uid 99); 4 Aug 2009 16:08:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 16:08:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.47] (HELO eastrmmtao105.cox.net) (68.230.240.47)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 16:08:34 +0000
Received: from eastrmimpo01.cox.net ([68.1.16.119])
          by eastrmmtao105.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090804160812.GJJO27200.eastrmmtao105.cox.net@eastrmimpo01.cox.net>
          for <java-user@lucene.apache.org>; Tue, 4 Aug 2009 12:08:12 -0400
Received: from eastrmwml31 ([172.18.18.217])
	by eastrmimpo01.cox.net with bizsmtp
	id QG8D1c00E4h0NJL02G8DH2; Tue, 04 Aug 2009 12:08:13 -0400
X-VR-Score: -110.00
X-Authority-Analysis: v=1.0 c=1 a=X8TF0b0RfGQA:10 a=kviXuzpPAAAA:8
 a=pGLkceISAAAA:8 a=mV9VRH-2AAAA:8 a=W9YjaFDG_9LNwLeeLQQA:9
 a=-RPCrUNk-rgILQvlY50A:7 a=5IkI5o0zvObpMTi4qkZTyZzu5J0A:4 a=4vB-4DCPJfMA:10
 a=MSl-tDqOz04A:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Tue, 4 Aug 2009 12:08:14 -0400
Message-ID: <20090804120814.6IX2T.4705.imail@eastrmwml31>
Date: Tue, 4 Aug 2009 12:08:14 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Slightly Off-topic: How to decide whether or not to add a
 document?
In-Reply-To: <20090804120316.GBI2D.4626.imail@eastrmwml31>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Ian,

One question about the 4th alternative:  I was wondering how you implemente=
d the sleep() in Java, esp. in such a way as not to mess up any of the Luce=
ne stuff (in case there's threading)?

Right now, my indexer/inserter app doesn't explicitly do any threading stuf=
f.

Thanks,
Jim


---- ohaya@cox.net wrote:=20
> Hi Ian,
>=20
> Thanks for the quick response.
>=20
> I forgot to mention, but in our case, the "producers" is part of a commer=
cial package, so we don't have a way to get them to change anything, so I t=
hink the 1st 3 suggestions are not feasible for us.
>=20
> I have considered something like the 4th suggestion (check file size, tim=
eout, and check file size again).  I'm worried that it would impact the ove=
rall index insertion process, but that unless there's something better, tha=
t may be our best option :(...
>=20
> Thanks again,
> Jim
>=20
>=20
> ---- Ian Lea <ian.lea@gmail.com> wrote:=20
> > A few suggestions:
> >=20
> > . Queue the docs once they are complete using something like JMS.
> >=20
> > . Get the document producers to write to e.g. xxx.tmp and rename to
> > e.g. xxx.txt at the end
> >=20
> > . Get the document producers to write to a tmp folder and move to e.g.
> > input/ when done
> >=20
> > . Find a file, store size, sleep for a while, check size and if changed=
, skip
> >=20
> > I've used all these at one time or another for assorted, mainly
> > non-lucene, apps, and they are all workable.
> >=20
> >=20
> > --
> > Ian.
> >=20
> >=20
> > On Tue, Aug 4, 2009 at 4:40 PM, <ohaya@cox.net> wrote:
> > > Hi,
> > >
> > > I have an app to initially create a Lucene index, and to populate it =
with documents. =C2=A0I'm now working on that app to insert new documents i=
nto that Lucene index.
> > >
> > > In general, this new app, which is based loosely on the demo apps (e.=
g., IndexFiles.java), is working, i.e., I can run it with a "create" parame=
ter, and it creates a good/valid index from the documents, and then I can r=
un it with an "insert" parameter, and it inserts new documents into the ind=
ex.
> > >
> > > [As I mentioned in an earlier thread, we only have a requirement to i=
nsert new documents into the index, no requirements for deleting documents =
or updating documents that have already been indexed).
> > >
> > > Ok, as I said, that works so far.
> > >
> > > However, in our case, the processes that are creating the documents t=
hat we are indexing are fairly long-lived, and write fairly large documents=
, and I'm worried that when an insert operation is run, some of the potenti=
al documents may still be being written to, and we wouldn't want the indexe=
r to insert the document into the Lucene index until the document is "compl=
ete".
> > >
> > > As you know, the way that the demos such as IndexFiles work is that t=
hey call a method called IndexDocs(). =C2=A0IndexDocs() then recursively wa=
lks the directory tree, and calling the writer to add to the index.
> > >
> > > In this loop, IndexDocs() does a few checks (isDirectory(), canRead),=
 and I think that it would "pick up" (find) some documents that are still "=
in progress" (being written to, and not closed) in our case.
> > >
> > > I was wondering if anyone here has a situation similar to this (havin=
g to index large documents that may be "in progress/being written to"), and=
 how you handle this situation?
> > >
> > > FYI, this is on Redhat Linux (and on Windows in my test environment).
> > >
> > > Thanks!
> > >
> > > Jim
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >=20
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41706-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 16:20:43 2009
Return-Path: <java-user-return-41706-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37330 invoked from network); 4 Aug 2009 16:20:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 16:20:43 -0000
Received: (qmail 31692 invoked by uid 500); 4 Aug 2009 16:20:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31616 invoked by uid 500); 4 Aug 2009 16:20:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31604 invoked by uid 99); 4 Aug 2009 16:20:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 16:20:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 16:20:35 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n74GKB85008571
	for <java-user@lucene.apache.org>; Tue, 4 Aug 2009 12:20:13 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <4A785FBB.2020603@informatics.jax.org>
Date: Tue, 04 Aug 2009 12:20:11 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.22 (Windows/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Searching doubt
References: <24802552.post@talk.nabble.com> <24803073.post@talk.nabble.com> 	<786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com> 	<24803560.post@talk.nabble.com> <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com> 	<24805609.post@talk.nabble.com> <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com> 	<9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com> 	<39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com> 	<786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com> <8c4e68610908040900t22f8763drcee07a09731e6b16@mail.gmail.com>
In-Reply-To: <8c4e68610908040900t22f8763drcee07a09731e6b16@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.5.7.378829, Antispam-Engine: 2.7.2.376379, Antispam-Data: 2009.8.4.160616
X-PerlMx-Spam: Gauge=IIIIIIII, Probability=8%, Report='
 LEO_OBFU_SUBJ_RE 0.1, BODY_SIZE_1000_LESS 0, BODY_SIZE_2000_LESS 0, BODY_SIZE_5000_LESS 0, BODY_SIZE_7000_LESS 0, BODY_SIZE_900_999 0, TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __C230066_P5 0, __CANPHARM_UNSUB_LINK 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __HAS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __MOZILLA_MSGID 0, __SANE_MSGID 0, __TO_MALFORMED_2 0, __URI_NS , __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

Well.. search on both anyhow.

"about us" OR "aboutus" should hit the spot I think.

Matt

Ian Lea wrote:
>> The question was, how given a string "aboutus" in a document, you can return
>> that document as a result to the query "about us" (note the space). So we're
>> mostly discussing how to detect and then break the word "aboutus" to two
>> words.
>>     
>
> I haven't really been following this thread so apologies if way off
> target, but reading the above makes me wonder if it can simply be
> reversed: remove the space from "about us" and search on that.
>
>
> --
> Ian.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


-- 
Matthew Hall
Software Engineer
Mouse Genome Informatics
mhall@informatics.jax.org
(207) 288-6012



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41707-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 16:35:05 2009
Return-Path: <java-user-return-41707-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41640 invoked from network); 4 Aug 2009 16:35:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 16:35:05 -0000
Received: (qmail 43886 invoked by uid 500); 4 Aug 2009 16:35:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43798 invoked by uid 500); 4 Aug 2009 16:35:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43788 invoked by uid 99); 4 Aug 2009 16:35:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 16:35:07 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [74.6.114.33] (HELO web1101.biz.mail.sk1.yahoo.com) (74.6.114.33)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 04 Aug 2009 16:34:58 +0000
Received: (qmail 53604 invoked by uid 60001); 4 Aug 2009 16:34:36 -0000
Message-ID: <644213.53491.qm@web1101.biz.mail.sk1.yahoo.com>
X-YMail-OSG: M_VHWxAVM1l2G8LVRay66C8aYbhPERiw3pZidMjYOcoM3KXkHQiib8fF
Received: from [97.116.3.138] by web1101.biz.mail.sk1.yahoo.com via HTTP; Tue, 04 Aug 2009 09:34:34 PDT
X-Mailer: YahooMailRC/1358.21 YahooMailWebService/0.7.289.10
References: <24802552.post@talk.nabble.com>  <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com>  <24803073.post@talk.nabble.com>  <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com>  <24803560.post@talk.nabble.com>  <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com>  <24805609.post@talk.nabble.com>  <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com>  <9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com>  <39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com> <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
Date: Tue, 4 Aug 2009 09:34:34 -0700 (PDT)
From: N Hira <nhira@cognocys.com>
Subject: Re: Searching doubt
To: java-user@lucene.apache.org
In-Reply-To: <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org


Good summary, Shai.

I've missed some of this thread as well, but does anyone know what happened to the suggestion about query manipulation?

e.g., query (about us) => query("about us", "aboutus")
    query(credit card) => query("credit card", "creditcard")

Regards,

-h



----- Original Message ----
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Sent: Tuesday, August 4, 2009 10:31:46 AM
Subject: Re: Searching doubt

Hi Darren,

The question was, how given a string "aboutus" in a document, you can return
that document as a result to the query "about us" (note the space). So we're
mostly discussing how to detect and then break the word "aboutus" to two
words.

What you wrote though seems interesting as well, only I think not related to
Harig's original question. Maybe he'll be interested in that too though.

Shai

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41708-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 17:01:01 2009
Return-Path: <java-user-return-41708-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48337 invoked from network); 4 Aug 2009 17:01:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 17:01:01 -0000
Received: (qmail 99697 invoked by uid 500); 4 Aug 2009 17:01:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99607 invoked by uid 500); 4 Aug 2009 17:01:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99597 invoked by uid 99); 4 Aug 2009 17:01:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 17:01:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 72.14.220.152 as permitted sender)
Received: from [72.14.220.152] (HELO fg-out-1718.google.com) (72.14.220.152)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 17:00:56 +0000
Received: by fg-out-1718.google.com with SMTP id l26so1219994fgb.4
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 10:00:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=JABs4zWp9G6X1F3GmKPdsgVfyXzr61qkDYHo0N1ZI9o=;
        b=x/7MPW+RqumBdeJBD5FKQkH6HLa0po0s4gRU3ShaMEhTL+h3Dhw5wJqZPd8Ddu6kYw
         SkvruISyhVP415ZCv2hi9LEPar4cNj7J5CaWgqkBbRWe0wprfOTVa+C01GYXsbnhL/xL
         9YQOuxhtUrdaXFvf2OV0MZbWjd1zAsSmjH6NQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=nbyzNw8lpsBkMK/ENlvdOoQsnx6lZWjiCOWOIQDPfgJ+7ijaysSAuM8/i710IKtgXa
         rmd91Re4QjISlPeUxtOuSQdZ+RWy84Uq7A4QPE6xCoNnbMBhIdHWy5BYSfwh4RSOfOab
         dRmTGF2Abory3J8w//3g2hY/0uUmFT5OoTCAM=
MIME-Version: 1.0
Received: by 10.86.35.18 with SMTP id i18mr2932346fgi.8.1249405234749; Tue, 04 
	Aug 2009 10:00:34 -0700 (PDT)
In-Reply-To: <20090804120814.6IX2T.4705.imail@eastrmwml31>
References: <20090804120316.GBI2D.4626.imail@eastrmwml31> <20090804120814.6IX2T.4705.imail@eastrmwml31>
From: Ian Lea <ian.lea@gmail.com>
Date: Tue, 4 Aug 2009 18:00:14 +0100
Message-ID: <8c4e68610908041000j41105d16n7b9cf42900fdf50f@mail.gmail.com>
Subject: Re: Slightly Off-topic: How to decide whether or not to add a 
	document?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Jim


The sleep is simply

	    try { Thread.sleep(millis); }
	    catch (InterruptedException ie) { }

No threading issues that I'm aware of, despite the method living in
the Thread class.

But you're right about it possibly impacting performance, if you've
got to sleep for a reasonable amount of time for each doc, if you've
got loads of docs.  You can improve it by getting a list of possible
files + size + lastmod + whatever, sleeping, then checking them all
again i.e. only sleep once for each pass rather than once per file.

Yet another option is to forget about sleeping and check the lastmod
timestamp and only index the doc if was finished some time ago.

And yet another ... make the producer write to /a/b/c and have a
standalone non-lucene job that reads /a/b/c doing whatever checks you
like, moving files to your input directory.


That's more than enough options from me.


--
Ian.

On Tue, Aug 4, 2009 at 5:08 PM, <ohaya@cox.net> wrote:
> Ian,
>
> One question about the 4th alternative: =A0I was wondering how you implem=
ented the sleep() in Java, esp. in such a way as not to mess up any of the =
Lucene stuff (in case there's threading)?
>
> Right now, my indexer/inserter app doesn't explicitly do any threading st=
uff.
>
> Thanks,
> Jim
>
>
> ---- ohaya@cox.net wrote:
>> Hi Ian,
>>
>> Thanks for the quick response.
>>
>> I forgot to mention, but in our case, the "producers" is part of a comme=
rcial package, so we don't have a way to get them to change anything, so I =
think the 1st 3 suggestions are not feasible for us.
>>
>> I have considered something like the 4th suggestion (check file size, ti=
meout, and check file size again). =A0I'm worried that it would impact the =
overall index insertion process, but that unless there's something better, =
that may be our best option :(...
>>
>> Thanks again,
>> Jim
>>
>>
>> ---- Ian Lea <ian.lea@gmail.com> wrote:
>> > A few suggestions:
>> >
>> > . Queue the docs once they are complete using something like JMS.
>> >
>> > . Get the document producers to write to e.g. xxx.tmp and rename to
>> > e.g. xxx.txt at the end
>> >
>> > . Get the document producers to write to a tmp folder and move to e.g.
>> > input/ when done
>> >
>> > . Find a file, store size, sleep for a while, check size and if change=
d, skip
>> >
>> > I've used all these at one time or another for assorted, mainly
>> > non-lucene, apps, and they are all workable.
>> >
>> >
>> > --
>> > Ian.
>> >
>> >
>> > On Tue, Aug 4, 2009 at 4:40 PM, <ohaya@cox.net> wrote:
>> > > Hi,
>> > >
>> > > I have an app to initially create a Lucene index, and to populate it=
 with documents. =A0I'm now working on that app to insert new documents int=
o that Lucene index.
>> > >
>> > > In general, this new app, which is based loosely on the demo apps (e=
.g., IndexFiles.java), is working, i.e., I can run it with a "create" param=
eter, and it creates a good/valid index from the documents, and then I can =
run it with an "insert" parameter, and it inserts new documents into the in=
dex.
>> > >
>> > > [As I mentioned in an earlier thread, we only have a requirement to =
insert new documents into the index, no requirements for deleting documents=
 or updating documents that have already been indexed).
>> > >
>> > > Ok, as I said, that works so far.
>> > >
>> > > However, in our case, the processes that are creating the documents =
that we are indexing are fairly long-lived, and write fairly large document=
s, and I'm worried that when an insert operation is run, some of the potent=
ial documents may still be being written to, and we wouldn't want the index=
er to insert the document into the Lucene index until the document is "comp=
lete".
>> > >
>> > > As you know, the way that the demos such as IndexFiles work is that =
they call a method called IndexDocs(). =A0IndexDocs() then recursively walk=
s the directory tree, and calling the writer to add to the index.
>> > >
>> > > In this loop, IndexDocs() does a few checks (isDirectory(), canRead)=
, and I think that it would "pick up" (find) some documents that are still =
"in progress" (being written to, and not closed) in our case.
>> > >
>> > > I was wondering if anyone here has a situation similar to this (havi=
ng to index large documents that may be "in progress/being written to"), an=
d how you handle this situation?
>> > >
>> > > FYI, this is on Redhat Linux (and on Windows in my test environment)=
.
>> > >
>> > > Thanks!
>> > >
>> > > Jim
>> > >
>> > >
>> > > --------------------------------------------------------------------=
-
>> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > > For additional commands, e-mail: java-user-help@lucene.apache.org
>> > >
>> > >
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41709-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 17:21:26 2009
Return-Path: <java-user-return-41709-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53941 invoked from network); 4 Aug 2009 17:21:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 17:21:26 -0000
Received: (qmail 28331 invoked by uid 500); 4 Aug 2009 17:21:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28263 invoked by uid 500); 4 Aug 2009 17:21:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28253 invoked by uid 99); 4 Aug 2009 17:21:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 17:21:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.8] (HELO eastrmmtao102.cox.net) (68.230.240.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 17:21:18 +0000
Received: from eastrmimpo03.cox.net ([68.1.16.126])
          by eastrmmtao102.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090804172058.BMLI22890.eastrmmtao102.cox.net@eastrmimpo03.cox.net>;
          Tue, 4 Aug 2009 13:20:58 -0400
Received: from eastrmwml31 ([172.18.18.217])
	by eastrmimpo03.cox.net with bizsmtp
	id QHLx1c0014h0NJL02HLxlg; Tue, 04 Aug 2009 13:20:57 -0400
X-VR-Score: -210.00
X-Authority-Analysis: v=1.0 c=1 a=X8TF0b0RfGQA:10 a=pGLkceISAAAA:8
 a=kviXuzpPAAAA:8 a=mV9VRH-2AAAA:8 a=6dFzR1OxWKM26LUDdMkA:9
 a=JKYHCxIVTAlY8Rj5wU8A:7 a=Ujt-UYSWvT6MZi1QDQaHrQr410wA:4 a=MSl-tDqOz04A:10
 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Tue, 4 Aug 2009 13:20:57 -0400
Message-ID: <20090804132058.ZIJ20.5853.imail@eastrmwml31>
Date: Tue, 4 Aug 2009 13:20:58 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Slightly Off-topic: How to decide whether or not to add a
  document?
Cc: Ian Lea <ian.lea@gmail.com>
In-Reply-To: <8c4e68610908041000j41105d16n7b9cf42900fdf50f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Ian,

Ok, thanks for the additional info.

I've implemented  check for both file.lastModified and file.length(), and i=
t seems to work in my dev environment (Windows), so I'll have to test on a =
"real" system.

Thanks again,
Jim


---- Ian Lea <ian.lea@gmail.com> wrote:=20
> Jim
>=20
>=20
> The sleep is simply
>=20
> =09    try { Thread.sleep(millis); }
> =09    catch (InterruptedException ie) { }
>=20
> No threading issues that I'm aware of, despite the method living in
> the Thread class.
>=20
> But you're right about it possibly impacting performance, if you've
> got to sleep for a reasonable amount of time for each doc, if you've
> got loads of docs.  You can improve it by getting a list of possible
> files + size + lastmod + whatever, sleeping, then checking them all
> again i.e. only sleep once for each pass rather than once per file.
>=20
> Yet another option is to forget about sleeping and check the lastmod
> timestamp and only index the doc if was finished some time ago.
>=20
> And yet another ... make the producer write to /a/b/c and have a
> standalone non-lucene job that reads /a/b/c doing whatever checks you
> like, moving files to your input directory.
>=20
>=20
> That's more than enough options from me.
>=20
>=20
> --
> Ian.
>=20
> On Tue, Aug 4, 2009 at 5:08 PM, <ohaya@cox.net> wrote:
> > Ian,
> >
> > One question about the 4th alternative: =C2=A0I was wondering how you i=
mplemented the sleep() in Java, esp. in such a way as not to mess up any of=
 the Lucene stuff (in case there's threading)?
> >
> > Right now, my indexer/inserter app doesn't explicitly do any threading =
stuff.
> >
> > Thanks,
> > Jim
> >
> >
> > ---- ohaya@cox.net wrote:
> >> Hi Ian,
> >>
> >> Thanks for the quick response.
> >>
> >> I forgot to mention, but in our case, the "producers" is part of a com=
mercial package, so we don't have a way to get them to change anything, so =
I think the 1st 3 suggestions are not feasible for us.
> >>
> >> I have considered something like the 4th suggestion (check file size, =
timeout, and check file size again). =C2=A0I'm worried that it would impact=
 the overall index insertion process, but that unless there's something bet=
ter, that may be our best option :(...
> >>
> >> Thanks again,
> >> Jim
> >>
> >>
> >> ---- Ian Lea <ian.lea@gmail.com> wrote:
> >> > A few suggestions:
> >> >
> >> > . Queue the docs once they are complete using something like JMS.
> >> >
> >> > . Get the document producers to write to e.g. xxx.tmp and rename to
> >> > e.g. xxx.txt at the end
> >> >
> >> > . Get the document producers to write to a tmp folder and move to e.=
g.
> >> > input/ when done
> >> >
> >> > . Find a file, store size, sleep for a while, check size and if chan=
ged, skip
> >> >
> >> > I've used all these at one time or another for assorted, mainly
> >> > non-lucene, apps, and they are all workable.
> >> >
> >> >
> >> > --
> >> > Ian.
> >> >
> >> >
> >> > On Tue, Aug 4, 2009 at 4:40 PM, <ohaya@cox.net> wrote:
> >> > > Hi,
> >> > >
> >> > > I have an app to initially create a Lucene index, and to populate =
it with documents. =C2=A0I'm now working on that app to insert new document=
s into that Lucene index.
> >> > >
> >> > > In general, this new app, which is based loosely on the demo apps =
(e.g., IndexFiles.java), is working, i.e., I can run it with a "create" par=
ameter, and it creates a good/valid index from the documents, and then I ca=
n run it with an "insert" parameter, and it inserts new documents into the =
index.
> >> > >
> >> > > [As I mentioned in an earlier thread, we only have a requirement t=
o insert new documents into the index, no requirements for deleting documen=
ts or updating documents that have already been indexed).
> >> > >
> >> > > Ok, as I said, that works so far.
> >> > >
> >> > > However, in our case, the processes that are creating the document=
s that we are indexing are fairly long-lived, and write fairly large docume=
nts, and I'm worried that when an insert operation is run, some of the pote=
ntial documents may still be being written to, and we wouldn't want the ind=
exer to insert the document into the Lucene index until the document is "co=
mplete".
> >> > >
> >> > > As you know, the way that the demos such as IndexFiles work is tha=
t they call a method called IndexDocs(). =C2=A0IndexDocs() then recursively=
 walks the directory tree, and calling the writer to add to the index.
> >> > >
> >> > > In this loop, IndexDocs() does a few checks (isDirectory(), canRea=
d), and I think that it would "pick up" (find) some documents that are stil=
l "in progress" (being written to, and not closed) in our case.
> >> > >
> >> > > I was wondering if anyone here has a situation similar to this (ha=
ving to index large documents that may be "in progress/being written to"), =
and how you handle this situation?
> >> > >
> >> > > FYI, this is on Redhat Linux (and on Windows in my test environmen=
t).
> >> > >
> >> > > Thanks!
> >> > >
> >> > > Jim
> >> > >
> >> > >
> >> > > ------------------------------------------------------------------=
---
> >> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> > >
> >> > >
> >> >
> >> > --------------------------------------------------------------------=
-
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41710-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 17:30:36 2009
Return-Path: <java-user-return-41710-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59403 invoked from network); 4 Aug 2009 17:30:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 17:30:36 -0000
Received: (qmail 40279 invoked by uid 500); 4 Aug 2009 17:30:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40231 invoked by uid 500); 4 Aug 2009 17:30:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40221 invoked by uid 99); 4 Aug 2009 17:30:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 17:30:39 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aminmc@gmail.com designates 74.125.78.27 as permitted sender)
Received: from [74.125.78.27] (HELO ey-out-2122.google.com) (74.125.78.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 17:30:31 +0000
Received: by ey-out-2122.google.com with SMTP id 9so13599eyd.53
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 10:30:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:cc:content-type;
        bh=Jq6+sw1W98NGSN36qadS+ceHmec+jf0E6/VLso5gqnE=;
        b=luCxavIz7MKIZ98XwC1eKnVCM44XDmPEHDfxPf2v/JgQaVGaagOpORG/yQH5T4dABM
         TvUpK0dxjMAKkwfTj824lGNbP4Qn+KNGp2wY2+oMLw6cv4/jFz4E7re0RH66MmPsR6Jm
         obdWxradiFXVS2KPb3ZFCuch3giLb/Yhc8YGw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        b=qE/kGze09xIWFzWC4WT2lVnTd+0q5LV8JH7jdSSIXnU/hMJcl9EGGQsPKmRB+AOBzQ
         6+NC6/0YQKKHGAwYZ4BhIWpWexmWV9lU/5KSw8xv6TMmy090NoZ5KFYwrsH20QFhu2qf
         0k4CXwj9DY+zvyaCv/8MrpJC7UX1HNsMhGDMU=
MIME-Version: 1.0
Received: by 10.216.49.194 with SMTP id x44mr1462166web.130.1249407009310; 
	Tue, 04 Aug 2009 10:30:09 -0700 (PDT)
In-Reply-To: <20090804132058.ZIJ20.5853.imail@eastrmwml31>
References: <8c4e68610908041000j41105d16n7b9cf42900fdf50f@mail.gmail.com>
	 <20090804132058.ZIJ20.5853.imail@eastrmwml31>
Date: Tue, 4 Aug 2009 18:30:09 +0100
Message-ID: <6f4104d80908041030x21c7758bq446d7f8ba6bc728b@mail.gmail.com>
Subject: Re: Slightly Off-topic: How to decide whether or not to add a 
	document?
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: java-user@lucene.apache.org
Cc: ohaya@cox.net
Content-Type: multipart/alternative; boundary=0016367f9b14f847920470543cfa
X-Virus-Checked: Checked by ClamAV on apache.org

--0016367f9b14f847920470543cfa
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I've been working on a indexing solution using Spring integration and
lucene. the example project uses jms to create work items (index add or
update) and then a service that polls for work to do. I should have this
complete soon and will be putting it on google code.  Not much of help right
now but hopefully when it's done then it should give you and idea and
probably you can tweak to your requirements.
Cheers
Amin

On Tue, Aug 4, 2009 at 6:20 PM, <ohaya@cox.net> wrote:

> Hi Ian,
>
> Ok, thanks for the additional info.
>
> I've implemented  check for both file.lastModified and file.length(), and
> it seems to work in my dev environment (Windows), so I'll have to test on a
> "real" system.
>
> Thanks again,
> Jim
>
>
> ---- Ian Lea <ian.lea@gmail.com> wrote:
> > Jim
> >
> >
> > The sleep is simply
> >
> >           try { Thread.sleep(millis); }
> >           catch (InterruptedException ie) { }
> >
> > No threading issues that I'm aware of, despite the method living in
> > the Thread class.
> >
> > But you're right about it possibly impacting performance, if you've
> > got to sleep for a reasonable amount of time for each doc, if you've
> > got loads of docs.  You can improve it by getting a list of possible
> > files + size + lastmod + whatever, sleeping, then checking them all
> > again i.e. only sleep once for each pass rather than once per file.
> >
> > Yet another option is to forget about sleeping and check the lastmod
> > timestamp and only index the doc if was finished some time ago.
> >
> > And yet another ... make the producer write to /a/b/c and have a
> > standalone non-lucene job that reads /a/b/c doing whatever checks you
> > like, moving files to your input directory.
> >
> >
> > That's more than enough options from me.
> >
> >
> > --
> > Ian.
> >
> > On Tue, Aug 4, 2009 at 5:08 PM, <ohaya@cox.net> wrote:
> > > Ian,
> > >
> > > One question about the 4th alternative:  I was wondering how you
> implemented the sleep() in Java, esp. in such a way as not to mess up any of
> the Lucene stuff (in case there's threading)?
> > >
> > > Right now, my indexer/inserter app doesn't explicitly do any threading
> stuff.
> > >
> > > Thanks,
> > > Jim
> > >
> > >
> > > ---- ohaya@cox.net wrote:
> > >> Hi Ian,
> > >>
> > >> Thanks for the quick response.
> > >>
> > >> I forgot to mention, but in our case, the "producers" is part of a
> commercial package, so we don't have a way to get them to change anything,
> so I think the 1st 3 suggestions are not feasible for us.
> > >>
> > >> I have considered something like the 4th suggestion (check file size,
> timeout, and check file size again).  I'm worried that it would impact the
> overall index insertion process, but that unless there's something better,
> that may be our best option :(...
> > >>
> > >> Thanks again,
> > >> Jim
> > >>
> > >>
> > >> ---- Ian Lea <ian.lea@gmail.com> wrote:
> > >> > A few suggestions:
> > >> >
> > >> > . Queue the docs once they are complete using something like JMS.
> > >> >
> > >> > . Get the document producers to write to e.g. xxx.tmp and rename to
> > >> > e.g. xxx.txt at the end
> > >> >
> > >> > . Get the document producers to write to a tmp folder and move to
> e.g.
> > >> > input/ when done
> > >> >
> > >> > . Find a file, store size, sleep for a while, check size and if
> changed, skip
> > >> >
> > >> > I've used all these at one time or another for assorted, mainly
> > >> > non-lucene, apps, and they are all workable.
> > >> >
> > >> >
> > >> > --
> > >> > Ian.
> > >> >
> > >> >
> > >> > On Tue, Aug 4, 2009 at 4:40 PM, <ohaya@cox.net> wrote:
> > >> > > Hi,
> > >> > >
> > >> > > I have an app to initially create a Lucene index, and to populate
> it with documents.  I'm now working on that app to insert new documents into
> that Lucene index.
> > >> > >
> > >> > > In general, this new app, which is based loosely on the demo apps
> (e.g., IndexFiles.java), is working, i.e., I can run it with a "create"
> parameter, and it creates a good/valid index from the documents, and then I
> can run it with an "insert" parameter, and it inserts new documents into the
> index.
> > >> > >
> > >> > > [As I mentioned in an earlier thread, we only have a requirement
> to insert new documents into the index, no requirements for deleting
> documents or updating documents that have already been indexed).
> > >> > >
> > >> > > Ok, as I said, that works so far.
> > >> > >
> > >> > > However, in our case, the processes that are creating the
> documents that we are indexing are fairly long-lived, and write fairly large
> documents, and I'm worried that when an insert operation is run, some of the
> potential documents may still be being written to, and we wouldn't want the
> indexer to insert the document into the Lucene index until the document is
> "complete".
> > >> > >
> > >> > > As you know, the way that the demos such as IndexFiles work is
> that they call a method called IndexDocs().  IndexDocs() then recursively
> walks the directory tree, and calling the writer to add to the index.
> > >> > >
> > >> > > In this loop, IndexDocs() does a few checks (isDirectory(),
> canRead), and I think that it would "pick up" (find) some documents that are
> still "in progress" (being written to, and not closed) in our case.
> > >> > >
> > >> > > I was wondering if anyone here has a situation similar to this
> (having to index large documents that may be "in progress/being written
> to"), and how you handle this situation?
> > >> > >
> > >> > > FYI, this is on Redhat Linux (and on Windows in my test
> environment).
> > >> > >
> > >> > > Thanks!
> > >> > >
> > >> > > Jim
> > >> > >
> > >> > >
> > >> > >
> ---------------------------------------------------------------------
> > >> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >> > >
> > >> > >
> > >> >
> > >> >
> ---------------------------------------------------------------------
> > >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >> >
> > >>
> > >>
> > >> ---------------------------------------------------------------------
> > >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016367f9b14f847920470543cfa--

From java-user-return-41711-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 17:52:30 2009
Return-Path: <java-user-return-41711-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70273 invoked from network); 4 Aug 2009 17:52:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 17:52:30 -0000
Received: (qmail 66627 invoked by uid 500); 4 Aug 2009 17:52:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66540 invoked by uid 500); 4 Aug 2009 17:52:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66530 invoked by uid 99); 4 Aug 2009 17:52:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 17:52:32 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a10.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 17:52:21 +0000
Received: from [10.0.0.11] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a10.g.dreamhost.com (Postfix) with ESMTP id 73A0357519
	for <java-user@lucene.apache.org>; Tue,  4 Aug 2009 10:51:59 -0700 (PDT)
Message-Id: <70FA860F-B368-462B-A510-FBA44FB1806D@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <74f928500908020830h5d3f4d0aw1f1ed2016c67200@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v935.3)
Subject: Re: score from spans
Date: Tue, 4 Aug 2009 13:51:58 -0400
References: <74f928500908020830h5d3f4d0aw1f1ed2016c67200@mail.gmail.com>
X-Mailer: Apple Mail (2.935.3)
X-Virus-Checked: Checked by ClamAV on apache.org

A SpanQuery is a Query, so if you do a search for it, you will get  
scores.  However, the mechanism is a bit complicated, b/c actually  
getting the Spans is separate from doing the query.  I agree there  
could be tighter integration.  However, what you could do is use  
Spans.skipTo to move to the document you are examining in the search  
results.

-Grant

On Aug 2, 2009, at 11:30 AM, Eran Sevi wrote:

> Hi,
>
> How can I get the score of a span that is the result of  
> SpanQuery.getSpans()
> ? The score should can be the same for each document, but if it's  
> unique per
> span, it's even better.
>
> I tried looking for a way to expose this functionality through the  
> Spans
> class but it looks too complicated.
> I'm not even sure that by default some score calculation is even  
> performed
> when using span queries.
>
> I've noticed that some calculations are made using payloads and
> BoostingTermQuery but the score result is used internally and can't be
> accessed from the Spans results.
> I don't want to re-run the query again using a HitCollector and  
> since the
> reader is passed to getSpans, I think it should be possible to do  
> what I
> want.
>
> Any help on the correct way to expose the span score will be  
> appreciated.
>
> Thanks,
> Eran.

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41712-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 18:46:06 2009
Return-Path: <java-user-return-41712-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 389 invoked from network); 4 Aug 2009 18:46:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 18:46:06 -0000
Received: (qmail 53145 invoked by uid 500); 4 Aug 2009 18:46:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53059 invoked by uid 500); 4 Aug 2009 18:46:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53049 invoked by uid 99); 4 Aug 2009 18:46:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 18:46:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lafadev@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 18:45:58 +0000
Received: by ywh26 with SMTP id 26so5469234ywh.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 11:45:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=aBqi7+RlUI/QHQAnYnsmKjnA0lMT0DxecgZFFcW3KzA=;
        b=fYayose3ssb1/xm5O3bOIKcw9ww+KytE3P6SseC/xVKeOZzuODHEemT4x3+0wcxU64
         ZTvMfBy27PAUPHkWmVNrvqxt0fTbEifbBF0Jy7iElhGbSMvApH6niVfiy5be6vhKV4GN
         ouBZ014PEzP57uKBinDshmLE1JIMOhZ9XSzio=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=sFTfnE6nJqJy2B6yHkAv5RY4TL96AoEGCEjZl0fS4pTkbFkKe7CWdYaIE0S+2Y2/Rp
         m+Zo/6stU1CjTmJcIk9ym3NOIywo1R+D88i0BbzhDg22QTvxF9Q5GcMrH7SZoOCg8xHh
         Ak7XtEX3tbhgV0e0608FK5zqrxb9qxbbLVUsw=
Received: by 10.90.113.11 with SMTP id l11mr3140028agc.97.1249411537437;
        Tue, 04 Aug 2009 11:45:37 -0700 (PDT)
Received: from ?9.30.38.143? ([32.97.110.56])
        by mx.google.com with ESMTPS id 40sm224080aga.38.2009.08.04.11.45.35
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 04 Aug 2009 11:45:36 -0700 (PDT)
Message-ID: <4A7881CD.5090500@gmail.com>
Date: Tue, 04 Aug 2009 11:45:33 -0700
From: Luis Alves <lafadev@gmail.com>
User-Agent: Thunderbird 2.0.0.22 (X11/20090608)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: How do you Parse a query to convert numbers to strings
References: <4a704181.0ab6660a.0944.ffffdc05@mx.google.com> <4A7060A7.3070303@fastmail.fm>
In-Reply-To: <4A7060A7.3070303@fastmail.fm>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Paul,

In 2.9, you can use the "new query parser" in contrib.

You should look at:

original.config.FieldBoostMapAttribute           
original.config.FieldBoostMapFCListener        
original.processors.BoostQueryNodeProcessor
original.builders.BoostQueryNodeBuilder

this code implements boost values per field.

or look at:

original.config.FieldDateResolutionMapAttribute
original.config.FieldDateResolutionFCListener
original.processors.ParametricRangeQueryNodeProcessor
original.builders.RangeQueryNodeBuilder

this code implements DateResolution per field.

You would have to implement something similar.
You will need and Attribute, (FieldConfig)FCListener a Processor,
and you might need a new Builder or not.

And finally you can look at TestSpanQueryParserSimpleSample junit
to learn how assemble it together and change the new query parser
to use your own changes.

I hope this helps :)

-- 
-Lafa



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41713-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 19:55:52 2009
Return-Path: <java-user-return-41713-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31822 invoked from network); 4 Aug 2009 19:55:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 19:55:52 -0000
Received: (qmail 86218 invoked by uid 500); 4 Aug 2009 19:55:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86136 invoked by uid 500); 4 Aug 2009 19:55:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86126 invoked by uid 99); 4 Aug 2009 19:55:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 19:55:55 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 19:55:47 +0000
Received: by ey-out-2122.google.com with SMTP id 9so36232eyd.53
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 12:55:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=qcX5xIqf2BWwdXutzI/knYAnNMxfXiKU9rHqhCfFAD8=;
        b=VKlaK6NiMMFoiBrDDERnxR0crrzfCoZC0gzmGQlciCIDtQPxOU0AR3aUhdOlKdOJR8
         3+PW+KM9PMrs/11I3l91Mw6rGelTVRirwZydrVg/1xANaJts3kGBq0T1HZw3KR9qJc9t
         iGtfNOuDVMVdCylnryZbnhCq/fm74GyhP/aIc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=FrgjoJmUB3LHQsZSAtOBhfcNkSxx6le+AGCtEMk5KqmTJk/fZKDN6pr9QvvgmPzcOX
         J1OUALnw/v/+S4aw+jBwXYZrtG79oEnHcjF2qsG7V75/w/n5ooD2Sn3BSa4gjh9tzlDb
         QfmrWQTSPnfwe0/x6ze5qS9br7RD0TSf0gAwU=
MIME-Version: 1.0
Received: by 10.216.91.10 with SMTP id g10mr1540847wef.71.1249415725558; Tue, 
	04 Aug 2009 12:55:25 -0700 (PDT)
In-Reply-To: <644213.53491.qm@web1101.biz.mail.sk1.yahoo.com>
References: <24802552.post@talk.nabble.com>
	 <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com>
	 <24803560.post@talk.nabble.com>
	 <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com>
	 <24805609.post@talk.nabble.com>
	 <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com>
	 <9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com>
	 <39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com>
	 <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
	 <644213.53491.qm@web1101.biz.mail.sk1.yahoo.com>
Date: Tue, 4 Aug 2009 22:55:25 +0300
Message-ID: <786fde50908041255m3164cd3foc2d5538f6dd6e9a8@mail.gmail.com>
Subject: Re: Searching doubt
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d77e3c7fad72047056442b
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d77e3c7fad72047056442b
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I had suggested that in my first response, but I think Harig's problem is
that those words are not known in advance. Therefore, facing the query
"about us" and converting it to "aboutus" is simple, but what about queries
like "united states", or "united states of america"? Should they be
'grouped' together always? And if the query contains more than 2 words,
should every couple be grouped? That will lead to n^2 terms to process for
each query, which is very expensive.

The dictionary approach can work in both directions. I.e., query("about us")
--> query("aboutus", "about us") can work as well if someone creates a
mapping from "about us" to "aboutus". But this dictionary need to be built
in advance, or at least add terms to it as you encounter more cases.

Harig - I don't think there's a magic solution here. If you don't know what
to expect, you can only do a "best effort" solution. There were a couple of
suggestions proposed, and I think you should evaluate them and decide what
can work for you. If you prefer any particular solution over the others,
then let us know and we'll try to help further.

>From all the solutions proposed, my personal preference is to use a
dictionary and during indexing try to break those words according to
dictionary terms. If that's not possible (e.g. there isn't a dictionary you
can use), you can try to break the words into sub strings. But I'd
definitely would go for a solution on the indexing side, since usually we
prefer to pay more during indexing than during search.

BTW, another solution that pops into mind is to use an NGram Analyzer, that
will extract 'grams' of words. So the word "aboutus" will be converted
(using N=3) to: "abo", "bou", "out", "utu", "tus". Then the query "about us"
will be converted (using N=3 again) to: "abo", "bou", "out", "us" (assuming
you split words on whitespace) and this document will match. The downside of
this is that other documents will match too (e.g. documents with the word
"out"), but you can improve the scoring by running the following query
"about us \"about\" \"us\"". Notice that the last two words are put in a
phrase. So docs that contain the word "about" will be scored higher than
docs that contain just the word "out". Also, notice that with this approach,
the default search operator is recommended to be OR, as requesting AND on
NGrams may hurt recall severely.

Shai

On Tue, Aug 4, 2009 at 7:34 PM, N Hira <nhira@cognocys.com> wrote:

>
> Good summary, Shai.
>
> I've missed some of this thread as well, but does anyone know what happened
> to the suggestion about query manipulation?
>
> e.g., query (about us) => query("about us", "aboutus")
>    query(credit card) => query("credit card", "creditcard")
>
> Regards,
>
> -h
>
>
>
> ----- Original Message ----
> From: Shai Erera <serera@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Tuesday, August 4, 2009 10:31:46 AM
> Subject: Re: Searching doubt
>
> Hi Darren,
>
> The question was, how given a string "aboutus" in a document, you can
> return
> that document as a result to the query "about us" (note the space). So
> we're
> mostly discussing how to detect and then break the word "aboutus" to two
> words.
>
> What you wrote though seems interesting as well, only I think not related
> to
> Harig's original question. Maybe he'll be interested in that too though.
>
> Shai
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d77e3c7fad72047056442b--

From java-user-return-41714-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 21:40:53 2009
Return-Path: <java-user-return-41714-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84867 invoked from network); 4 Aug 2009 21:40:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 21:40:53 -0000
Received: (qmail 63462 invoked by uid 500); 4 Aug 2009 21:40:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63394 invoked by uid 500); 4 Aug 2009 21:40:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63383 invoked by uid 99); 4 Aug 2009 21:40:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 21:40:53 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of adrianocrestani@gmail.com designates 209.85.221.203 as permitted sender)
Received: from [209.85.221.203] (HELO mail-qy0-f203.google.com) (209.85.221.203)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 21:40:44 +0000
Received: by qyk41 with SMTP id 41so5369558qyk.29
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 14:40:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:from:date
         :x-google-sender-auth:message-id:subject:to:content-type;
        bh=pZbD1OrZa4jLfLa2OpEyK1X1aopZ9b1e5ucdyIwuIKA=;
        b=QlR97z8F2Zylgj+1Wax0dpqAtD5lv0ysv0w7Wpnlcjn6k0+jznLz8QlkzlV0fghGha
         XnYYqKUI39pHSOFCz4ZCyLhw+HQeMRfGuSpMQAcNUl5J30M048qPSLO+azpQ0y3KOzex
         2ahXUKsT6rAxpVwTaLcyp+UiRG4rpq07YMX8g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:from:date:x-google-sender-auth:message-id
         :subject:to:content-type;
        b=uiKVh0XTmLztDAtb7mQK1XsAqvqSguMrT3eNVOgOog1azfhd3CI2+VG8RRTli3hrUC
         G8gXVNyv8ccQBK39Qt9gAck0NHkFGJ87kXpa+PCZHNReL2WoFIaAX1LQMOudQUjrVUwy
         tiDG8d2aXYJSxodh5GL51aT7oRFVhKZbhs/dA=
MIME-Version: 1.0
Sender: adrianocrestani@gmail.com
Received: by 10.229.80.1 with SMTP id r1mr2172389qck.93.1249422022803; Tue, 04 
	Aug 2009 14:40:22 -0700 (PDT)
From: Adriano Crestani <adrianocrestani@apache.org>
Date: Tue, 4 Aug 2009 14:40:00 -0700
X-Google-Sender-Auth: eefb1a808d2210bc
Message-ID: <55e2bf7e0908041440m586cf979n276bd40ebae302f@mail.gmail.com>
Subject: Nightly build link is broken
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364ee590d804a8047057bb95
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364ee590d804a8047057bb95
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

I was trying to download a nightly build jar, so I went to Lucene website
and clicked on the link that redirected to:

http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/

and I got a "Firefox can't establish a connection to the server at
lucene.zones.apache.org:8080".

Is the link broken or the server is down?

Thanks,
Adriano Crestani

--0016364ee590d804a8047057bb95--

From java-user-return-41715-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 04 22:35:24 2009
Return-Path: <java-user-return-41715-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15739 invoked from network); 4 Aug 2009 22:35:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Aug 2009 22:35:24 -0000
Received: (qmail 26209 invoked by uid 500); 4 Aug 2009 22:35:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26133 invoked by uid 500); 4 Aug 2009 22:35:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26122 invoked by uid 99); 4 Aug 2009 22:35:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 22:35:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Aug 2009 22:35:17 +0000
Received: by yxe3 with SMTP id 3so5911344yxe.29
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 15:34:56 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.107.8 with SMTP id j8mr5234810ybm.344.1249425295597; Tue, 
	04 Aug 2009 15:34:55 -0700 (PDT)
In-Reply-To: <55e2bf7e0908041440m586cf979n276bd40ebae302f@mail.gmail.com>
References: <55e2bf7e0908041440m586cf979n276bd40ebae302f@mail.gmail.com>
Date: Tue, 4 Aug 2009 18:34:55 -0400
Message-ID: <9ac0c6aa0908041534g491259bl5082118b082bae0e@mail.gmail.com>
Subject: Re: Nightly build link is broken
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hmmm... that link is old.  The right one is:

  http://hudson.zones.apache.org/hudson/view/Lucene/job/Lucene-trunk/

Which page did you find that link on?

Mike

On Tue, Aug 4, 2009 at 5:40 PM, Adriano
Crestani<adrianocrestani@apache.org> wrote:
> Hi,
>
> I was trying to download a nightly build jar, so I went to Lucene website
> and clicked on the link that redirected to:
>
> http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/
>
> and I got a "Firefox can't establish a connection to the server at
> lucene.zones.apache.org:8080".
>
> Is the link broken or the server is down?
>
> Thanks,
> Adriano Crestani
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41716-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 00:20:00 2009
Return-Path: <java-user-return-41716-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64609 invoked from network); 5 Aug 2009 00:20:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 00:20:00 -0000
Received: (qmail 44840 invoked by uid 500); 5 Aug 2009 00:20:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44751 invoked by uid 500); 5 Aug 2009 00:20:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44741 invoked by uid 99); 5 Aug 2009 00:20:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 00:20:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of phil123@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 00:19:51 +0000
Received: by ywh26 with SMTP id 26so5754628ywh.5
        for <java-user@lucene.apache.org>; Tue, 04 Aug 2009 17:19:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=R24AuZBjeyTO2/3fCuwkNcupM87Q4p+K8pmapiPOzXs=;
        b=BrgGL+8JV6rQrMwbmuIWdt84XqY/K0b6o95ZzfPN0v7c9nqzY+Gpo5VR8mxjJHyKMT
         uSgFVCDa1wx8h93bSQYLDT3E3R/429DvTXqazM+RBf62UhivcO1ObOdhLarIK+COfxDk
         iHcmSrA6YUsR2WMcxILYgQoguYBJvrwdmk6/k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=d+jLgpDMUpu5OsGqLsa/FUgrx2YSqiJQmwquWdEM3ROYrLi0xaqXMKiNoRzO+u7r2R
         Roq3NyiGYw2XGWLAEYw7TUSofLNsUWTbttAOmYkQ3edmVLB01heqjQdJTdUl6nFDn3VS
         x1Lc6g0h1scmMLtPY6A7gs7mxgKQEmURJgc/s=
MIME-Version: 1.0
Received: by 10.100.254.19 with SMTP id b19mr9552395ani.22.1249431569638; Tue, 
	04 Aug 2009 17:19:29 -0700 (PDT)
In-Reply-To: <786fde50908040842m2e4a6034k8a61027265f65b48@mail.gmail.com>
References: <24802552.post@talk.nabble.com> <24803560.post@talk.nabble.com>
	 <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com>
	 <24805609.post@talk.nabble.com>
	 <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com>
	 <9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com>
	 <39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com>
	 <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com>
	 <9cafbc680908040837t5e113320p1f8a050848530610@mail.gmail.com>
	 <786fde50908040842m2e4a6034k8a61027265f65b48@mail.gmail.com>
Date: Tue, 4 Aug 2009 17:19:29 -0700
Message-ID: <9cafbc680908041719w49e175eex8ecbf18000bad141@mail.gmail.com>
Subject: Re: Searching doubt
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

(sorry, tangent. I'll be quick)

On Tue, Aug 4, 2009 at 8:42 AM, Shai Erera<serera@gmail.com> wrote:
> Interesting ... I don't have access to a Japanese dictionary, so I just
> extract bi-grams.

Shai - if you're interested in parsing Japanese, check out Kakasi. It
can split into words and convert Kanji->Katakana/Hirugana/Romaji -
after which I would index them all.
http://kakasi.namazu.org/
http://www.kawao.com/java/kakasi/api/com/kawao/kakasi/Kakasi.html
http://kakasi.namazu.org/stable/kakasi-2.3.4.tar.gz <-- contain GPL
Japanese dictionary

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41717-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 03:50:59 2009
Return-Path: <java-user-return-41717-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99342 invoked from network); 5 Aug 2009 03:50:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 03:50:59 -0000
Received: (qmail 31865 invoked by uid 500); 5 Aug 2009 03:51:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31780 invoked by uid 500); 5 Aug 2009 03:51:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31763 invoked by uid 99); 5 Aug 2009 03:51:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 03:51:00 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bradfordstephens@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 03:50:52 +0000
Received: by ywh26 with SMTP id 26so5891006ywh.5
        for <multiple recipients>; Tue, 04 Aug 2009 20:50:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=5VumxwmL9CISoyCAW1XdISB4hHrSRxtULEC+y1XcYO0=;
        b=Z/3eLeeCZ7xuQL3iFkCCX3NPRyGofEg5VlT0QgCA5dGU4Q1oDNeqjFqX4hVVZ9fn+y
         Uuw9fnfm4wj5fZv9fb6xRtmiawx2SKbQ3QXSt4yJ5xuAciB8dQfz/Kybtyu5VMiyaGq+
         f/hf825LkEkslQwJYVf2SlQ3BpWsbCWapVxog=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=WvBaVpis4t+1bh2P41SDeubuRj8p+rjAhRJbvCfK6ErSEGeGPecvGb7/lNFNgWL4wJ
         1eTxxudpCsPaUg/1F2xeGpBMwP8k313chWoHkR++p8TZ2+1DcUAzHLKlTn69XkZIDptX
         yiif/yoP2QvgzqtZY6Vrp9LQAZvBzdUiYudEU=
MIME-Version: 1.0
Received: by 10.90.101.17 with SMTP id y17mr3435601agb.116.1249444231427; Tue, 
	04 Aug 2009 20:50:31 -0700 (PDT)
Date: Tue, 4 Aug 2009 20:50:31 -0700
Message-ID: <860544ed0908042050ucb88f87w590ad4014a7ab3f1@mail.gmail.com>
Subject: A Presentation on Building a Hadoop + Lucene System Architecture
From: Bradford Stephens <bradfordstephens@gmail.com>
To: core-user@hadoop.apache.org, hbase-user@hadoop.apache.org, 
	pig-user@hadoop.apache.org, solr-user@lucene.apache.org, 
	java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hey all,

I just wanted to send a link to a presentation I made on how my
company is building its entire core BI infrastructure around Hadoop,
HBase, Lucene, and more. It features a decent amount of practical
advice: from rules for approaching scalability problems, to why we
chose certain aspects of the Hadoop Ecosystem. Perhaps you can use it
as justification for their decisions, or as a jumping-off point to
utilizing it in the real world.

I hope you find it helpful! You can catch it at my blog:
http://www.roadtofailure.com . There's also a few inflammatory
articles, such as "Social Media Kills the RDBMS".

Ask me if you have any questions :)

-- 
http://www.hadoopconsulting.com -- Making Hadoop and your web apps
that use it scale
http://www.roadtofailure.com -- The Fringes of Scalability, Social
Media, and Computer Science

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41718-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 04:19:21 2009
Return-Path: <java-user-return-41718-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7521 invoked from network); 5 Aug 2009 04:19:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 04:19:21 -0000
Received: (qmail 52820 invoked by uid 500); 5 Aug 2009 04:19:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52719 invoked by uid 500); 5 Aug 2009 04:19:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52709 invoked by uid 99); 5 Aug 2009 04:19:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 04:19:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 04:19:16 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MYXxn-0005jD-8d
	for java-user@lucene.apache.org; Tue, 04 Aug 2009 21:18:55 -0700
Message-ID: <24820550.post@talk.nabble.com>
Date: Tue, 4 Aug 2009 21:18:55 -0700 (PDT)
From: "m.harig" <m.harig@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Searching doubt
In-Reply-To: <786fde50908041255m3164cd3foc2d5538f6dd6e9a8@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.harig@gmail.com
References: <24802552.post@talk.nabble.com> <867513fe0908032320m61fd55f7qa6b40ca9c625a343@mail.gmail.com> <24803073.post@talk.nabble.com> <786fde50908032354m656b2260u6f1fa44feee1987c@mail.gmail.com> <24803560.post@talk.nabble.com> <786fde50908040128p67c2ca6en3c23ad7550280a1b@mail.gmail.com> <24805609.post@talk.nabble.com> <786fde50908040356v15db635buf3063d5b7a45a5f1@mail.gmail.com> <9cafbc680908040819v17d76a27u7c256b7065c815bf@mail.gmail.com> <39397.38.103.17.250.1249399663.squirrel@webmail7.pair.com> <786fde50908040831x7fda78dcnf7b5136ad54c924e@mail.gmail.com> <644213.53491.qm@web1101.biz.mail.sk1.yahoo.com> <786fde50908041255m3164cd3foc2d5538f6dd6e9a8@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks all,

            but how nutch handle this problem? am aware of nutch but not in
depth. If i search the keyword "about us" , nutch gives me exactly what i
want. Is there any scoring techinques? please let me know.
-- 
View this message in context: http://www.nabble.com/Searching-doubt-tp24802552p24820550.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41719-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 04:37:06 2009
Return-Path: <java-user-return-41719-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12834 invoked from network); 5 Aug 2009 04:37:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 04:37:05 -0000
Received: (qmail 64308 invoked by uid 500); 5 Aug 2009 04:37:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64226 invoked by uid 500); 5 Aug 2009 04:37:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64216 invoked by uid 99); 5 Aug 2009 04:37:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 04:37:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 04:37:02 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MYYEz-0006HM-8S
	for java-user@lucene.apache.org; Tue, 04 Aug 2009 21:36:41 -0700
Message-ID: <24820655.post@talk.nabble.com>
Date: Tue, 4 Aug 2009 21:36:41 -0700 (PDT)
From: "m.harig" <m.harig@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: A Presentation on Building a Hadoop + Lucene System
 Architecture
In-Reply-To: <860544ed0908042050ucb88f87w590ad4014a7ab3f1@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.harig@gmail.com
References: <860544ed0908042050ucb88f87w590ad4014a7ab3f1@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hello 

              Do you've any idea about the integration of Lucene with Hadoop


BrickMcLargeHuge wrote:
> 
> Hey all,
> 
> I just wanted to send a link to a presentation I made on how my
> company is building its entire core BI infrastructure around Hadoop,
> HBase, Lucene, and more. It features a decent amount of practical
> advice: from rules for approaching scalability problems, to why we
> chose certain aspects of the Hadoop Ecosystem. Perhaps you can use it
> as justification for their decisions, or as a jumping-off point to
> utilizing it in the real world.
> 
> I hope you find it helpful! You can catch it at my blog:
> http://www.roadtofailure.com . There's also a few inflammatory
> articles, such as "Social Media Kills the RDBMS".
> 
> Ask me if you have any questions :)
> 
> -- 
> http://www.hadoopconsulting.com -- Making Hadoop and your web apps
> that use it scale
> http://www.roadtofailure.com -- The Fringes of Scalability, Social
> Media, and Computer Science
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/A-Presentation-on-Building-a-Hadoop-%2B-Lucene-System-Architecture-tp24820349p24820655.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41720-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 07:59:13 2009
Return-Path: <java-user-return-41720-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71892 invoked from network); 5 Aug 2009 07:59:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 07:59:13 -0000
Received: (qmail 96692 invoked by uid 500); 5 Aug 2009 07:59:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96607 invoked by uid 500); 5 Aug 2009 07:59:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96597 invoked by uid 99); 5 Aug 2009 07:59:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 07:59:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.225 as permitted sender)
Received: from [209.85.220.225] (HELO mail-fx0-f225.google.com) (209.85.220.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 07:59:06 +0000
Received: by fxm25 with SMTP id 25so4686921fxm.5
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 00:58:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=9GndsHEffVgbZOuXVNLLlGwAjv+9f1bgxWzWByfQjxA=;
        b=DAO/9Kpsiqa8+OUQBMsQ47SJsURlbyzKJAif2vdVLF3lK38iyZ/w19am5PFJN493Gt
         JSVOiRxvJCfw47ubES0g+72HoC8vt63a3yiUjgXS6HOL0J0Bw2r9B+kLSXlLtZxWAd39
         psE16sNU0MvkOYQ6kPTbbQsmEoApuYgjEHZxg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=WgbZpxpxl7ezjTyyKKUzuNrjgW+C0U4WOSk5G4x3Gu2NRKvRhDxRn1wJ8qkqFyo4pb
         UTeWI8pBjXCTQqBSAOGJAa4HE7OyJw/E9MSRIza0OPgfQDexXdkmDozWHnBe9qhyPguo
         A4zsglZ8mEjwXf49l1Jj/eAsgMmoj5rxK1044=
MIME-Version: 1.0
Received: by 10.204.122.200 with SMTP id m8mr606162bkr.176.1249459125149; Wed, 
	05 Aug 2009 00:58:45 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <20090804170013.6d9b5753@pc-4176.kl.dfki.de>
References: <20090804115016.64b58dfe@pc-4176.kl.dfki.de>
	 <180060.75297.qm@web50309.mail.re2.yahoo.com>
	 <20090804170013.6d9b5753@pc-4176.kl.dfki.de>
Date: Wed, 5 Aug 2009 09:58:45 +0200
Message-ID: <f18c9dde0908050058j57c3a790u27a0b16c73625837@mail.gmail.com>
Subject: Re: ParallelMultiSearcher and idf
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hey Christian,

you might wanna look at distributed solr
(http://wiki.apache.org/solr/DistributedSearch) or if you haven't done
so have a look at the Katta project
(http://katta.sourceforge.net/documentation/how-katta-works) maybe
this can help you out.
About distributed IDF and Scoring have a look at this link:
http://wunderwood.org/most_casual_observer/2007/04/progressive_reranking.ht=
ml

Simon

On Tue, Aug 4, 2009 at 5:00 PM, Christian
Reuschling<christian.reuschling@gmail.com> wrote:
> Hi Otis,
>
> thanks for the answer - I'm aware of Solr, but it seems this is - accordi=
ng to
> its abstraction level - too generalized for us. Solr seems to be nice in =
the
> case you want to use the black box, and won't be aware of 'what is under =
the
> hood'.
> But maybe I'm totaly wrong. At least, it would be from interest how Solr
> realizes its distributed search, in the case it makes something different
> than using the core-Lucene ParallelMultiSearcher with RemoteSearchables. =
Maybe
> on this list somebody knows the answer.
>
>
>
>
>
> On Tue, 4 Aug 2009 07:20:23 -0700 (PDT)
> Otis Gospodnetic <otis_gospodnetic@yahoo.com> wrote:
>
>> Hi Christian,
>>
>> You didn't mention Solr, so I'm not sure if you are aware of it. =C2=A0M=
aybe Solr
>> meets your needs?
>>
>> =C2=A0Otis
>> --
>> Sematext is hiring -- http://sematext.com/about/jobs.html?mls
>> Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
>>
>>
>>
>> ----- Original Message ----
>> > From: Christian Reuschling <christian.reuschling@gmail.com>
>> > To: java-user@lucene.apache.org
>> > Sent: Tuesday, August 4, 2009 5:50:16 AM
>> > Subject: ParallelMultiSearcher and idf
>> >
>> > Hello,
>> >
>> > when searching over multiple indices, we create one IndexReader for ea=
ch
>> > index, and wrap them into a MultiReader, that we use for IndexSearcher
>> > creation.
>> >
>> > This is fine for searching multiple indices on one machine, but in the=
 case
>> > the indices are distributed over the (intra)net, this scenario has sev=
eral
>> > lacks:
>> >
>> > - searching/scoring/sorting is 100% on the client machine, so you need=
 all
>> > the ram and cpu power at every client.
>> > - all the data necessary for scoring must go over the net - so the tra=
ffic
>> > =C2=A0 should be significantly higher
>> > - thus, there is a lack of overall performance
>> >
>> > Nevertheless, creating a MultiReader and making a searcher out of it h=
as one
>> > advantage (at least can be an advantage depending on the scenario): Th=
e
>> > document freqiencies of a term will be summed up, and thus it is 100%
>> > transparent for scoring whether the indices are splittet or not.
>> >
>> > I'm wondering whether there is the possibility to get the advantages o=
f both
>> > scenarios, e.g. by first summing up the query terms-related document
>> > frequencies, and sending them together with the query to every
>> > (remote)searcher of ParallelMultiSearcher, for scoring.
>> >
>> > Maybe this is exactly what ParallelMultiSearcher does, and I haven't s=
een
>> > it?
>> >
>> >
>> > Thanks for clarification!
>> >
>> > Chris
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41721-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 15:36:50 2009
Return-Path: <java-user-return-41721-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79441 invoked from network); 5 Aug 2009 15:36:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 15:36:50 -0000
Received: (qmail 68149 invoked by uid 500); 5 Aug 2009 15:36:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68085 invoked by uid 500); 5 Aug 2009 15:36:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68066 invoked by uid 99); 5 Aug 2009 15:36:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 15:36:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bradfordstephens@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 15:36:42 +0000
Received: by yxe3 with SMTP id 3so256971yxe.29
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 08:36:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=TlP0wsFMqA+p2wvmEhhln13HrUSnC0V92S5fhNX5eV8=;
        b=B4WCtkh9CrNRT/oqfBPKAlQmKtDs8QuLieChrCUJe1E5WYWrjqoQkZdqfyBDRVkd6f
         cC4WtUnyrk5dn7021K15f5V2IW+QxcO59bLgzG7s3dp8QsoYVG/1McJwaq0OU0BFHxdj
         zmmk2QR5lNI+HjqDeBMy0qc8pIMB5MEEKnips=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=DCAKTFKq90qP6Z/YrlM2pMM+4YIJnDtsAYx862ngRcbut14nxZT80pLGkm42u3A0Fg
         LX//uEwCJ8PCalNh8osaveds+GUUCHQbYyCcO0YFPCVn7jstpRQ5geuSknwozUUqHC24
         1zumO/KeKjedSHk3+W78OfUCPJHKGkcnYzvsI=
MIME-Version: 1.0
Received: by 10.100.111.15 with SMTP id j15mr10898065anc.79.1249486577206; 
	Wed, 05 Aug 2009 08:36:17 -0700 (PDT)
In-Reply-To: <24820655.post@talk.nabble.com>
References: <860544ed0908042050ucb88f87w590ad4014a7ab3f1@mail.gmail.com>
	 <24820655.post@talk.nabble.com>
Date: Wed, 5 Aug 2009 08:36:16 -0700
Message-ID: <860544ed0908050836i5fbd10ddx72a883d55a505478@mail.gmail.com>
Subject: Re: A Presentation on Building a Hadoop + Lucene System Architecture
From: Bradford Stephens <bradfordstephens@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Yes, we do index generation with Hadoop, and search with Katta, which
is distributed Lucene :) What are you trying to do?

On Tue, Aug 4, 2009 at 9:36 PM, m.harig<m.harig@gmail.com> wrote:
>
> Hello
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0Do you've any idea about the integration of Lu=
cene with Hadoop
>
>
> BrickMcLargeHuge wrote:
>>
>> Hey all,
>>
>> I just wanted to send a link to a presentation I made on how my
>> company is building its entire core BI infrastructure around Hadoop,
>> HBase, Lucene, and more. It features a decent amount of practical
>> advice: from rules for approaching scalability problems, to why we
>> chose certain aspects of the Hadoop Ecosystem. Perhaps you can use it
>> as justification for their decisions, or as a jumping-off point to
>> utilizing it in the real world.
>>
>> I hope you find it helpful! You can catch it at my blog:
>> http://www.roadtofailure.com . There's also a few inflammatory
>> articles, such as "Social Media Kills the RDBMS".
>>
>> Ask me if you have any questions :)
>>
>> --
>> http://www.hadoopconsulting.com -- Making Hadoop and your web apps
>> that use it scale
>> http://www.roadtofailure.com -- The Fringes of Scalability, Social
>> Media, and Computer Science
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> --
> View this message in context: http://www.nabble.com/A-Presentation-on-Bui=
lding-a-Hadoop-%2B-Lucene-System-Architecture-tp24820349p24820655.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
http://www.roadtofailure.com -- The Fringes of Scalability, Social
Media, and Computer Science

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41722-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 16:15:13 2009
Return-Path: <java-user-return-41722-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95226 invoked from network); 5 Aug 2009 16:15:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 16:15:09 -0000
Received: (qmail 49392 invoked by uid 500); 5 Aug 2009 16:15:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49312 invoked by uid 500); 5 Aug 2009 16:15:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49302 invoked by uid 99); 5 Aug 2009 16:15:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 16:15:14 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of nigelspleen@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 16:15:04 +0000
Received: by fxm2 with SMTP id 2so204903fxm.28
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 09:14:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=UJlodQcNAwpY1YBLkNgxVZkrT4LNT4ILgdlmDUuwj/4=;
        b=cYqs1kwHJR/If6XdFozC7qDloL5wzWB8aUhC9luNkFR6NCvYSHmF8ocbzDx1n6Fmky
         uaNOehROz6zgWMWm03gGB2h0KUbgGzmwzKgyA31ZozTGgC1Ym+fQhvHdpqJFiA+he063
         1K2M6Ac1kmDJ4rrXIY6s4MU2teuicnZ7z2SwI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=Bf7KbVdR/aroxfAoYm2ruEiDrBZSzLVhYZ0K6yAp9rf4AHt1U/vhkFKf8Zi41rSy1C
         bflf3ycEabZAbKCadmiaYPDKyKnTpltFB8gNxdThRVdTlnH71n01c+LUawkIZ64eblyy
         qMJQB9sEyABg0zvg4qQzOFO9mTSfI/FXwee3c=
MIME-Version: 1.0
Received: by 10.204.63.193 with SMTP id c1mr1085746bki.20.1249488526502; Wed, 
	05 Aug 2009 09:08:46 -0700 (PDT)
Date: Wed, 5 Aug 2009 12:08:46 -0400
Message-ID: <843920a30908050908pf9e2abciff36861614c0813e@mail.gmail.com>
Subject: Efficient optimization of large indexes?
From: Nigel <nigelspleen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c5bdc4c5ea1704706737d9
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5bdc4c5ea1704706737d9
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

We periodically optimize large indexes (100 - 200gb) by calling
IndexWriter.optimize().  It takes a heck of a long time, and I'm wondering
if a more efficient solution might be the following:

- Create a new empty index on a different filesystem
- Set a merge policy for the new index so it puts everything into one giant
segment (not sure how to do this off-hand, but I assume it's possible)
- Enumerate all documents in the unoptimized index and add them to the new
index

Having the reads and writes happening on different disks obviously helps.
But I don't if merging is inherently a lot more efficient compared to just
adding new docs -- if so, that could outweigh the I/O gains.

Thanks,
Chris

--001636c5bdc4c5ea1704706737d9--

From java-user-return-41723-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 16:17:20 2009
Return-Path: <java-user-return-41723-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96449 invoked from network); 5 Aug 2009 16:17:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 16:17:20 -0000
Received: (qmail 52844 invoked by uid 500); 5 Aug 2009 16:17:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52775 invoked by uid 500); 5 Aug 2009 16:17:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52765 invoked by uid 99); 5 Aug 2009 16:17:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 16:17:24 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of prashullegaddi@gmail.com designates 209.85.198.239 as permitted sender)
Received: from [209.85.198.239] (HELO rv-out-0506.google.com) (209.85.198.239)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 16:17:15 +0000
Received: by rv-out-0506.google.com with SMTP id b25so51087rvf.5
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 09:16:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=h+tBK5UcodH05yhC3e3Y1GWvVjxTwJrq395VoeUMZGs=;
        b=S/drAL7/8seZjVg7PHSk4lrmlLuGVnTKp2CyZobmAm3FpHl+i984OOy7ltodJXRCrm
         5QzKbRQGMRtpgX3X4hAHXeyvh1ZbzXG9co8VuIMYdf2QC/WltV6WTWb+P0lrVe7s8NK2
         L58WlwOjlPdDnAoUCUufUAoMn0HI1TRnVZdc4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=lqd4QfIBoH5HJMkev+qjhyOL64siZNr+n58ZMsI3opi+E6nsYDclErAWwXXBGiErpY
         OWUTjfdPdxMCRB7xGsv7RhGY88IZXlVNKYgHOnakSAvCHNcYGX4o63c4rucAaybxmwjq
         oZt+efRlKNth26rdib1t4p/g1pTdVKqGKXbdk=
MIME-Version: 1.0
Received: by 10.140.225.1 with SMTP id x1mr362179rvg.237.1249489014529; Wed, 
	05 Aug 2009 09:16:54 -0700 (PDT)
Date: Wed, 5 Aug 2009 21:46:54 +0530
Message-ID: <ac6e61fc0908050916w4b315716tf502eba5f793599b@mail.gmail.com>
Subject: What happens after merging?
From: prashant ullegaddi <prashullegaddi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd211c8dca16304706754af
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd211c8dca16304706754af
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

I've some indexes. As you all know, each has these files:
_0.fdt  _0.fdx  _hqy.fnm  _hqy.frq  _hqy.nrm  _hqy.prx  _hqy.tii  _hqy.tis
segments_2  segments.gen

Once I merge those indexes into single index by (IndexWriter's
addIndexes()), the merged index has
only 3 files:
_0.cfs  segments_2  segments.gen

Search works fine. I out of interest want to know what happened in the
background. Where frequency
data (earlier present in *.frq) is stored? Where proximity info (*.prx) is
stored? What happened to those
files? Why there is only one compound file *.cfs?

Thanks,
Prashant.

--000e0cd211c8dca16304706754af--

From java-user-return-41724-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 16:27:09 2009
Return-Path: <java-user-return-41724-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99551 invoked from network); 5 Aug 2009 16:27:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 16:27:09 -0000
Received: (qmail 73139 invoked by uid 500); 5 Aug 2009 16:27:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73067 invoked by uid 500); 5 Aug 2009 16:27:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73057 invoked by uid 99); 5 Aug 2009 16:27:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 16:27:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of tsuraan@gmail.com designates 209.85.212.191 as permitted sender)
Received: from [209.85.212.191] (HELO mail-vw0-f191.google.com) (209.85.212.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 16:27:07 +0000
Received: by vws29 with SMTP id 29so182184vws.20
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 09:26:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=CeVzPQ7ue7vtT2M9/MQnuhBsqeEd2BA1BJPtNUmvMa4=;
        b=EpPoUM3LQEFQjxMTyy5ENHCtgkWVGx3pQ9I9eh5el6SkbKAGGiJgmsl25LC92PwRzE
         wpetApXR2SO0UuuG783N8bmb5H9SPuysBtFXHC1gG4itsWl+nudV0aKOHz7z1XK1yg0A
         gypClUPOjg6Y99/CVkJs1VGftUY0F0X7bXCkA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=Bj+cHJFR0VvbAMXniZSAYVlR6mULo94pqgFJ4t1RzuB/SyZ3+FmLU29lP0Dh5np75E
         LONbzevQsYx39bRG7zQiywMhBL3Piw3MWX0g/j4kgc2EVY0ggSPg4wQC1RRqe1yedijk
         ClHUDaFGcxFFprAq0szZ2Hsxexe6goKyR/79o=
MIME-Version: 1.0
Received: by 10.220.92.11 with SMTP id p11mr8601018vcm.56.1249489606237; Wed, 
	05 Aug 2009 09:26:46 -0700 (PDT)
Date: Wed, 5 Aug 2009 11:26:46 -0500
Message-ID: <84fb38e30908050926m25eef231oe7b0b859a8460b72@mail.gmail.com>
Subject: org.apache.lucene.index.MergePolicy$MergeException
From: tsuraan <tsuraan@gmail.com>
To: java-user <java-user@lucene.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I'm getting the exception
"org.apache.lucene.index.MergePolicy$MergeException: segment "_0
exists in external directory yet the MergeScheduler executed the merge
in a separate thread".  According to this:

http://mail-archives.apache.org/mod_mbox/lucene-java-user/200809.mbox/<BD2A1C59-F3DD-414A-9124-DB2EE7EE4D33%40mikemccandless.com>

that only happens with addIndexesNoOptimize.  If I replace
addIndexesNoOptimize with just addIndexes, will that fix the problem,
or is the suggestion in that reply (use SerialMergeScheduler somehow)
the only solution?

Using Lucene 2.3.2 with Java 1.6, in Linux, if that matters.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41725-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 16:30:13 2009
Return-Path: <java-user-return-41725-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 207 invoked from network); 5 Aug 2009 16:30:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 16:30:13 -0000
Received: (qmail 78077 invoked by uid 500); 5 Aug 2009 16:30:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77981 invoked by uid 500); 5 Aug 2009 16:30:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77971 invoked by uid 99); 5 Aug 2009 16:30:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 16:30:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 16:30:06 +0000
Received: by fxm2 with SMTP id 2so214716fxm.28
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 09:29:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=1kKOBuPXIN0nTMDL5nM+rQ07DUCzPZtNKJlVgzMVdMw=;
        b=Hu0MtYIyX6uKso+qw/HCewcVUG3mdtOZn2QPSJgZE4vzVY7yLhCT1NOv8lILoBJi19
         5IGGzI7IjUFtiUWMxdUWs+2b7qC6K8fgsWV5pe5td0uxb4ijQBK4J3Yk52U+JUGsD2Dq
         gazzHXqDSYKVf7YNPzSH57LKzV7zGe5qVomb8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=UFrChELf59tQOPtpnHPRYsgkoR0CCH2t7xEsaJRkC0Wq72reqOsFevgayzFcY5cuba
         iLTkOZqpPot0yPeSm0CQtel47HADlFEI/CpyG/YAB2n6uWq3STpNzHgV+sRBXnwEUHWQ
         cN02gz5vtQcTyBBuHGus52t6p5LWVYfOO9rmE=
MIME-Version: 1.0
Received: by 10.204.123.83 with SMTP id o19mr1080491bkr.12.1249489785776; Wed, 
	05 Aug 2009 09:29:45 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <ac6e61fc0908050916w4b315716tf502eba5f793599b@mail.gmail.com>
References: <ac6e61fc0908050916w4b315716tf502eba5f793599b@mail.gmail.com>
Date: Wed, 5 Aug 2009 18:29:45 +0200
Message-ID: <f18c9dde0908050929k35fca5c2s53a827901f359280@mail.gmail.com>
Subject: Re: What happens after merging?
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi there,
when you use addIndexes() the IndexWriter merges the provided indexes
it as well as the index the IndexWriter was opened on into one single
index. It seem like you are using compound file system with the
IndexWriter you add your other indexes too. This instance takes all
documents and their data and writes them into one index - just like
adding all documents you have in the other indexes to one single
IndexWriter. Eventually the IndexWriter will run
IndexWriter#optimize(). While the IndexWriter add document to the
target index it might create one or more segments depending on your
configuration (#maxMergeDoc() and friends). The optimze call will
merge those segments into a signle one (if default MergePolicy is set
- other policies can do different things).

hope that helps...

Simon

On Wed, Aug 5, 2009 at 6:16 PM, prashant
ullegaddi<prashullegaddi@gmail.com> wrote:
> Hi,
>
> I've some indexes. As you all know, each has these files:
> _0.fdt =C2=A0_0.fdx =C2=A0_hqy.fnm =C2=A0_hqy.frq =C2=A0_hqy.nrm =C2=A0_h=
qy.prx =C2=A0_hqy.tii =C2=A0_hqy.tis
> segments_2 =C2=A0segments.gen
>
> Once I merge those indexes into single index by (IndexWriter's
> addIndexes()), the merged index has
> only 3 files:
> _0.cfs =C2=A0segments_2 =C2=A0segments.gen
>
> Search works fine. I out of interest want to know what happened in the
> background. Where frequency
> data (earlier present in *.frq) is stored? Where proximity info (*.prx) i=
s
> stored? What happened to those
> files? Why there is only one compound file *.cfs?
>
> Thanks,
> Prashant.
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41726-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 16:32:09 2009
Return-Path: <java-user-return-41726-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 410 invoked from network); 5 Aug 2009 16:32:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 16:32:09 -0000
Received: (qmail 80906 invoked by uid 500); 5 Aug 2009 16:32:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80825 invoked by uid 500); 5 Aug 2009 16:32:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80815 invoked by uid 99); 5 Aug 2009 16:32:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 16:32:14 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.217.218] (HELO mail-gx0-f218.google.com) (209.85.217.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 16:32:05 +0000
Received: by gxk18 with SMTP id 18so261338gxk.5
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 09:31:44 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.205.18 with SMTP id c18mr3808252ybg.319.1249489903587; 
	Wed, 05 Aug 2009 09:31:43 -0700 (PDT)
In-Reply-To: <84fb38e30908050926m25eef231oe7b0b859a8460b72@mail.gmail.com>
References: <84fb38e30908050926m25eef231oe7b0b859a8460b72@mail.gmail.com>
Date: Wed, 5 Aug 2009 12:31:43 -0400
Message-ID: <9ac0c6aa0908050931q36d12e91sbc84907f1381eb@mail.gmail.com>
Subject: Re: org.apache.lucene.index.MergePolicy$MergeException
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Switching to addIndexes instead, or using SerialMergeScheduler, or
upgrading to 2.4.1, should all work.

Mike

On Wed, Aug 5, 2009 at 12:26 PM, tsuraan<tsuraan@gmail.com> wrote:
> I'm getting the exception
> "org.apache.lucene.index.MergePolicy$MergeException: segment "_0
> exists in external directory yet the MergeScheduler executed the merge
> in a separate thread". =A0According to this:
>
> http://mail-archives.apache.org/mod_mbox/lucene-java-user/200809.mbox/<BD=
2A1C59-F3DD-414A-9124-DB2EE7EE4D33%40mikemccandless.com>
>
> that only happens with addIndexesNoOptimize. =A0If I replace
> addIndexesNoOptimize with just addIndexes, will that fix the problem,
> or is the suggestion in that reply (use SerialMergeScheduler somehow)
> the only solution?
>
> Using Lucene 2.3.2 with Java 1.6, in Linux, if that matters.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41727-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 17:38:46 2009
Return-Path: <java-user-return-41727-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26818 invoked from network); 5 Aug 2009 17:38:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 17:38:46 -0000
Received: (qmail 58492 invoked by uid 500); 5 Aug 2009 17:30:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58442 invoked by uid 500); 5 Aug 2009 17:30:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58420 invoked by uid 99); 5 Aug 2009 17:30:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 17:30:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bradfordstephens@gmail.com designates 209.85.217.218 as permitted sender)
Received: from [209.85.217.218] (HELO mail-gx0-f218.google.com) (209.85.217.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 17:30:17 +0000
Received: by gxk18 with SMTP id 18so306243gxk.5
        for <multiple recipients>; Wed, 05 Aug 2009 10:29:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=BybqNUmZ51XjCraEXh4SZUF8AvmE1FmQzMTuRfRXPBU=;
        b=jSRWlonKIyovVFZMVQQEKBrIMokVOeOegdv3/bprUAJ5uh1RhUWZVRkpiYWujX0y6o
         TYSLlcLAmEm8AaH3w/y68WhNzT31WV2R1N4h1q0Dx86TgrRJRr/sYSgrzNkErZ2NjpND
         XkB7eB1TtMibk1UwTBi4qbH73bcNFqkLL26SE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=rj6N89SpX+zkNRF4aVU5SkG6e8JsEZLj9CW7Rt2yMe+7IyRUIv6TpG/+cRUEcVnWIh
         ASC/+lLp8YL4UEaeGalpTnl8sE2KnvZqsriU5tnyhTl/8uLNDqca/kRDWjjo+nHEn7y1
         jtLbaOn+SqlK7xMLf8S3IkCOjyagktmwFRPsI=
MIME-Version: 1.0
Received: by 10.90.84.2 with SMTP id h2mr4163609agb.10.1249493396490; Wed, 05 
	Aug 2009 10:29:56 -0700 (PDT)
In-Reply-To: <860544ed0907291652j3318349emc8e66864f2436958@mail.gmail.com>
References: <860544ed0907271216p7b3169dcree68278ca111bd7a@mail.gmail.com>
	 <860544ed0907281125l579a379dr4888708139ce19db@mail.gmail.com>
	 <860544ed0907291652j3318349emc8e66864f2436958@mail.gmail.com>
Date: Wed, 5 Aug 2009 10:29:56 -0700
Message-ID: <860544ed0908051029n64f8e68eo654015e8e853e55b@mail.gmail.com>
Subject: Re: THIS WEEK: PNW Hadoop, HBase / Apache Cloud Stack Users' Meeting, 
	Wed Jul 29th, Seattle
From: Bradford Stephens <bradfordstephens@gmail.com>
To: core-user@hadoop.apache.org, solr-user@lucene.apache.org, 
	java-user@lucene.apache.org, hbase-user@hadoop.apache.org, 
	Bradford Stephens <bstephens@visibletechnologies.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

A big "thanks" to everyone who came out despite the heat! Hope to see
you again the last week of August, probably at UW.

On Wed, Jul 29, 2009 at 4:52 PM, Bradford
Stephens<bradfordstephens@gmail.com> wrote:
> Don't forget this is tonight! Excited to see everyone there.
>
> On Tue, Jul 28, 2009 at 11:25 AM, Bradford
> Stephens<bradfordstephens@gmail.com> wrote:
>> Hey everyone,
>>
>> SLIGHT change of plans.
>>
>> A few people have asked me to move to a place with Air Conditioning,
>> since the temperature's in the 90's this week. So, here we go:
>>
>> Big Time Brewing Company
>> 4133 University Way NE
>> Seattle, WA 98105
>>
>> Call me at 904-415-3009 if you have any questions.
>>
>>
>> On Mon, Jul 27, 2009 at 12:16 PM, Bradford
>> Stephens<bradfordstephens@gmail.com> wrote:
>>> Hello again!
>>>
>>> Yes, I know some of us are still recovering from OSCON. It's time for
>>> another delicious meetup to chat about Hadoop, HBase, Solr, Lucene,
>>> and more!
>>>
>>> UW is quite a pain for us to access until August, so we're changing
>>> the venue to one pretty close:
>>>
>>> Piccolo's Pizza
>>> 5301 Roosevelt Way NE
>>> (between 53rd St & 55th St)
>>>
>>> 6:45pm - 8:30 (or when we get bored)!
>>>
>>> As usual, people are more than welcome to give talks, whether they're
>>> long-format or lightning. I'd also really like to start thinking about
>>> hackathons, perhaps we could have one next month?
>>>
>>> I'll be talking about HBase .20 and the possibility of low-latency
>>> HBase Analytics. I'd be very excited to hear what people are up to!
>>>
>>> Contact me if there's any questions: 904-415-3009
>>>
>>> Cheers,
>>> Bradford
>>>
>>> --
>>> http://www.roadtofailure.com -- The Fringes of Scalability, Social
>>> Media, and Computer Science
>>>
>>
>>
>>
>> --
>> http://www.roadtofailure.com -- The Fringes of Scalability, Social
>> Media, and Computer Science
>>
>
>
>
> --
> http://www.roadtofailure.com -- The Fringes of Scalability, Social
> Media, and Computer Science
>



-- 
http://www.roadtofailure.com -- The Fringes of Scalability, Social
Media, and Computer Science

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41728-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 18:04:31 2009
Return-Path: <java-user-return-41728-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43847 invoked from network); 5 Aug 2009 18:04:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 18:04:31 -0000
Received: (qmail 35091 invoked by uid 500); 5 Aug 2009 18:04:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35018 invoked by uid 500); 5 Aug 2009 18:04:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35008 invoked by uid 99); 5 Aug 2009 18:04:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 18:04:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of tsuraan@gmail.com designates 209.85.221.203 as permitted sender)
Received: from [209.85.221.203] (HELO mail-qy0-f203.google.com) (209.85.221.203)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 18:04:27 +0000
Received: by qyk41 with SMTP id 41so281577qyk.29
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 11:04:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=P40CBz0ckASLWOSO0z0UpQAJ2hSeMrsc2HWNWhOfJ54=;
        b=LcHUXBif3gW4CY6/ugfekqSV63qa4FuLnJ2miE+iAv8O/vmlKx+KpUXfUGyyjX8+XA
         l2dqExv1lA7akNe9nmMcPAbSblg8hrcKwF5Sma8gxwTLrAgFm9j7WouVrVDYYFUUN1lx
         CsM8Go+8PpHdZtW2cJcg7MbkRhBpR31CcT7vE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=jEoT+qkDt1af873WnbnzgYeqidBNEdJOoSvn44vAGRIJNtVewp68rEsToKxIxhu/xm
         iBZH1xLEAPufcW/mttiXVuZfmmRBWNH0FsCyUa6mXO6SW3IqHEPN+vEgDcvEY9Kpxm3o
         rtCAgS5vIb2DA3r3JOzyxwP7iIjQjzpHETRbY=
MIME-Version: 1.0
Received: by 10.229.96.142 with SMTP id h14mr2531324qcn.99.1249495446235; Wed, 
	05 Aug 2009 11:04:06 -0700 (PDT)
In-Reply-To: <9ac0c6aa0908050931q36d12e91sbc84907f1381eb@mail.gmail.com>
References: <84fb38e30908050926m25eef231oe7b0b859a8460b72@mail.gmail.com>
	 <9ac0c6aa0908050931q36d12e91sbc84907f1381eb@mail.gmail.com>
Date: Wed, 5 Aug 2009 13:04:06 -0500
Message-ID: <84fb38e30908051104i27617830t1fa54acfc53668c3@mail.gmail.com>
Subject: Re: org.apache.lucene.index.MergePolicy$MergeException
From: tsuraan <tsuraan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On 05/08/2009, Michael McCandless <lucene@mikemccandless.com> wrote:
> Switching to addIndexes instead, or using SerialMergeScheduler, or
> upgrading to 2.4.1, should all work.

Thanks!  We'll be switching to 2.9 once it's ready.  From past
experience, lucene upgrades are simple and painless, but I don't think
I can do a 2.4.1 upgrade right now.  My code's (for some reason) doing
an optimize right after the addIndexesNoOptimize call, so it's
definitely not a problem to just switch to using plain addIndexes
instead.  Funny how code seems to grow warts like that...

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41729-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 18:07:36 2009
Return-Path: <java-user-return-41729-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45529 invoked from network); 5 Aug 2009 18:07:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 18:07:36 -0000
Received: (qmail 39206 invoked by uid 500); 5 Aug 2009 18:07:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39154 invoked by uid 500); 5 Aug 2009 18:07:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39100 invoked by uid 99); 5 Aug 2009 18:07:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 18:07:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of adrianocrestani@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 18:07:32 +0000
Received: by qw-out-2122.google.com with SMTP id 8so113768qwh.53
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 11:07:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=zwTCT1ontMxDWOXgDyJkfFEt8NoMcrRM526Z61CccVM=;
        b=WQVHWENkIEsuGGxGvoOmYcZqHV+xJByG271Z/lNAQWa1pnjWJAMB575mSzRb/WUsBs
         YeAAdrfOO7Ac8/ue9ovz4nMhUXiNlgOXtoorY+5SU4EgTHPc9+p0fOfWjyuoJ7nc/o6j
         P0aE1QCaYNZszbmcGxBcK6ylgWlDRQRupFC4A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=EaJDe1/S0IePxe0wJtegpqYLCjiAh/AbqjuUeXnws14bb1gRMviQJs324R9wo5qyl4
         kC71dR5Jx8q487++3F8pqcyiKNAi6BkfpdGy5XMzfHszRxGSLlMhywOP+/MSvI00x1hg
         flo2kuI26WbaO+Th8kfi7z1YLp0Cpxs0ZWr6k=
MIME-Version: 1.0
Received: by 10.229.84.6 with SMTP id h6mr2600602qcl.19.1249495631187; Wed, 05 
	Aug 2009 11:07:11 -0700 (PDT)
In-Reply-To: <9ac0c6aa0908041534g491259bl5082118b082bae0e@mail.gmail.com>
References: <55e2bf7e0908041440m586cf979n276bd40ebae302f@mail.gmail.com> 
	<9ac0c6aa0908041534g491259bl5082118b082bae0e@mail.gmail.com>
From: Adriano Crestani <adrianocrestani@gmail.com>
Date: Wed, 5 Aug 2009 11:06:45 -0700
Message-ID: <55e2bf7e0908051106s5d2a1af0vcb01ea0416b7abc5@mail.gmail.com>
Subject: Re: Nightly build link is broken
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163646c2e23f2a26047068df02
X-Virus-Checked: Checked by ClamAV on apache.org

--00163646c2e23f2a26047068df02
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Now I see it was in the news session on the main page: 3 January 2007 -
Nightly Source builds
available<http://lucene.apache.org/java/docs/#3+January+2007+-+Nightly+Source+builds+available>.
It makes sense that the new is out of date. However, is there any other
place the link to nightly builds can be found by users?

On Tue, Aug 4, 2009 at 3:34 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> Hmmm... that link is old.  The right one is:
>
>  http://hudson.zones.apache.org/hudson/view/Lucene/job/Lucene-trunk/
>
> Which page did you find that link on?
>
> Mike
>
> On Tue, Aug 4, 2009 at 5:40 PM, Adriano
> Crestani<adrianocrestani@apache.org> wrote:
> > Hi,
> >
> > I was trying to download a nightly build jar, so I went to Lucene website
> > and clicked on the link that redirected to:
> >
> > http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/
> >
> > and I got a "Firefox can't establish a connection to the server at
> > lucene.zones.apache.org:8080".
> >
> > Is the link broken or the server is down?
> >
> > Thanks,
> > Adriano Crestani
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00163646c2e23f2a26047068df02--

From java-user-return-41730-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 18:11:49 2009
Return-Path: <java-user-return-41730-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47387 invoked from network); 5 Aug 2009 18:11:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 18:11:49 -0000
Received: (qmail 46027 invoked by uid 500); 5 Aug 2009 18:11:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45971 invoked by uid 500); 5 Aug 2009 18:11:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45961 invoked by uid 99); 5 Aug 2009 18:11:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 18:11:53 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of adrianocrestani@gmail.com designates 209.85.221.203 as permitted sender)
Received: from [209.85.221.203] (HELO mail-qy0-f203.google.com) (209.85.221.203)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 18:11:45 +0000
Received: by qyk41 with SMTP id 41so287489qyk.29
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 11:11:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=NJI8fziob7zqDbuzP9KUsrKs72xlTywlE2VlfPbqX0U=;
        b=pdwiZAK2COn1QId6Tt5IpUO16WImBI+cZ2d1LM6ek4xrpl9IYtpkW1vPd00usyV9DH
         XzmyDs8S3xnUxzOqsCa+g/u39730fcG54QwnZtYrQochTpidxjaCM+t/t9emMSHwbyw4
         fs/l6StjoJTZnXbNa6GesPBypNYbmY+Gl0Rzo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=Pp1XxpQO9QLPX4RfyXtBNbmwQ9KVd02bzh9Hv8oKJfnQPK8JMufkAxd0AWevbuDNUA
         qLXr0AOIKk6PVCxIw10QbWeoN0wI1z/40I9au2px/312V/TUTSQvqAB+6OIKOJC9IWJa
         LUMCghbPrQWSZQkAeIc6Hhzmls5VZp7gF7zhU=
MIME-Version: 1.0
Received: by 10.229.80.1 with SMTP id r1mr2680386qck.93.1249495884555; Wed, 05 
	Aug 2009 11:11:24 -0700 (PDT)
In-Reply-To: <55e2bf7e0908051106s5d2a1af0vcb01ea0416b7abc5@mail.gmail.com>
References: <55e2bf7e0908041440m586cf979n276bd40ebae302f@mail.gmail.com> 
	<9ac0c6aa0908041534g491259bl5082118b082bae0e@mail.gmail.com> 
	<55e2bf7e0908051106s5d2a1af0vcb01ea0416b7abc5@mail.gmail.com>
From: Adriano Crestani <adrianocrestani@gmail.com>
Date: Wed, 5 Aug 2009 11:10:00 -0700
Message-ID: <55e2bf7e0908051110m10430b5i3bde5fda1466c2e@mail.gmail.com>
Subject: Re: Nightly build link is broken
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364ee59058e940047068eeea
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364ee59058e940047068eeea
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

The new link also does not work. Is it working for you?

On Wed, Aug 5, 2009 at 11:06 AM, Adriano Crestani <adrianocrestani@gmail.com
> wrote:

> Now I see it was in the news session on the main page: 3 January 2007 -
> Nightly Source builds available<http://lucene.apache.org/java/docs/#3+January+2007+-+Nightly+Source+builds+available>.
> It makes sense that the new is out of date. However, is there any other
> place the link to nightly builds can be found by users?
>
>
> On Tue, Aug 4, 2009 at 3:34 PM, Michael McCandless <
> lucene@mikemccandless.com> wrote:
>
>> Hmmm... that link is old.  The right one is:
>>
>>  http://hudson.zones.apache.org/hudson/view/Lucene/job/Lucene-trunk/
>>
>> Which page did you find that link on?
>>
>> Mike
>>
>> On Tue, Aug 4, 2009 at 5:40 PM, Adriano
>> Crestani<adrianocrestani@apache.org> wrote:
>> > Hi,
>> >
>> > I was trying to download a nightly build jar, so I went to Lucene
>> website
>> > and clicked on the link that redirected to:
>> >
>> > http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/
>> >
>> > and I got a "Firefox can't establish a connection to the server at
>> > lucene.zones.apache.org:8080".
>> >
>> > Is the link broken or the server is down?
>> >
>> > Thanks,
>> > Adriano Crestani
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

--0016364ee59058e940047068eeea--

From java-user-return-41731-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 18:56:03 2009
Return-Path: <java-user-return-41731-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73608 invoked from network); 5 Aug 2009 18:56:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 18:56:03 -0000
Received: (qmail 92516 invoked by uid 500); 5 Aug 2009 18:56:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92429 invoked by uid 500); 5 Aug 2009 18:56:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92419 invoked by uid 99); 5 Aug 2009 18:56:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 18:56:08 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 18:55:58 +0000
Received: by yxe3 with SMTP id 3so436574yxe.29
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 11:55:37 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.146.21 with SMTP id y21mr14875768ybn.304.1249498537272; 
	Wed, 05 Aug 2009 11:55:37 -0700 (PDT)
In-Reply-To: <55e2bf7e0908051110m10430b5i3bde5fda1466c2e@mail.gmail.com>
References: <55e2bf7e0908041440m586cf979n276bd40ebae302f@mail.gmail.com>
	 <9ac0c6aa0908041534g491259bl5082118b082bae0e@mail.gmail.com>
	 <55e2bf7e0908051106s5d2a1af0vcb01ea0416b7abc5@mail.gmail.com>
	 <55e2bf7e0908051110m10430b5i3bde5fda1466c2e@mail.gmail.com>
Date: Wed, 5 Aug 2009 14:55:37 -0400
Message-ID: <9ac0c6aa0908051155x1c5271dcs5a1b963718fa457a@mail.gmail.com>
Subject: Re: Nightly build link is broken
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hmm... not working for me either.  Looks like it's currently down:

    http://monitoring.apache.org/status/

I expect infra is working on fixing it...

Mike

On Wed, Aug 5, 2009 at 2:10 PM, Adriano
Crestani<adrianocrestani@gmail.com> wrote:
> The new link also does not work. Is it working for you?
>
> On Wed, Aug 5, 2009 at 11:06 AM, Adriano Crestani <adrianocrestani@gmail.=
com
>> wrote:
>
>> Now I see it was in the news session on the main page: 3 January 2007 -
>> Nightly Source builds available<http://lucene.apache.org/java/docs/#3+Ja=
nuary+2007+-+Nightly+Source+builds+available>.
>> It makes sense that the new is out of date. However, is there any other
>> place the link to nightly builds can be found by users?
>>
>>
>> On Tue, Aug 4, 2009 at 3:34 PM, Michael McCandless <
>> lucene@mikemccandless.com> wrote:
>>
>>> Hmmm... that link is old. =A0The right one is:
>>>
>>> =A0http://hudson.zones.apache.org/hudson/view/Lucene/job/Lucene-trunk/
>>>
>>> Which page did you find that link on?
>>>
>>> Mike
>>>
>>> On Tue, Aug 4, 2009 at 5:40 PM, Adriano
>>> Crestani<adrianocrestani@apache.org> wrote:
>>> > Hi,
>>> >
>>> > I was trying to download a nightly build jar, so I went to Lucene
>>> website
>>> > and clicked on the link that redirected to:
>>> >
>>> > http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/
>>> >
>>> > and I got a "Firefox can't establish a connection to the server at
>>> > lucene.zones.apache.org:8080".
>>> >
>>> > Is the link broken or the server is down?
>>> >
>>> > Thanks,
>>> > Adriano Crestani
>>> >
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41732-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 19:50:55 2009
Return-Path: <java-user-return-41732-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90960 invoked from network); 5 Aug 2009 19:50:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 19:50:55 -0000
Received: (qmail 76835 invoked by uid 500); 5 Aug 2009 19:51:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76765 invoked by uid 500); 5 Aug 2009 19:51:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76755 invoked by uid 99); 5 Aug 2009 19:51:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 19:51:00 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 19:50:51 +0000
Received: by yxe3 with SMTP id 3so484839yxe.29
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 12:50:29 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.154.18 with SMTP id g18mr16327191ybo.97.1249501828744; 
	Wed, 05 Aug 2009 12:50:28 -0700 (PDT)
In-Reply-To: <843920a30908050908pf9e2abciff36861614c0813e@mail.gmail.com>
References: <843920a30908050908pf9e2abciff36861614c0813e@mail.gmail.com>
Date: Wed, 5 Aug 2009 15:50:28 -0400
Message-ID: <9ac0c6aa0908051250m456998bbve6e8be67de9f3009@mail.gmail.com>
Subject: Re: Efficient optimization of large indexes?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Aug 5, 2009 at 12:08 PM, Nigel<nigelspleen@gmail.com> wrote:
> We periodically optimize large indexes (100 - 200gb) by calling
> IndexWriter.optimize().  It takes a heck of a long time, and I'm wondering
> if a more efficient solution might be the following:
>
> - Create a new empty index on a different filesystem
> - Set a merge policy for the new index so it puts everything into one giant
> segment (not sure how to do this off-hand, but I assume it's possible)
> - Enumerate all documents in the unoptimized index and add them to the new
> index

Actually IndexWriter must periodically flush, which will always
create new segments, which will then always require merging.  Ie
there's no way to just add everything to only one segment in one
shot.

(Though: addIndexes(IndexReader[]) does one single merge, ie, ignores
mergeFactor and merges all of the incoming readers at once).

> Having the reads and writes happening on different disks obviously helps.
> But I don't if merging is inherently a lot more efficient compared to just
> adding new docs -- if so, that could outweigh the I/O gains.

True, but I'd be surprised if you net/net got better performance
(since you're paying the indexing cost again).

Merge performance does seem rather slow... I recently profiled it and
was suprised to find that the merging of terms dict & postings was cpu
bound, even on a modern CPU (core i7 920) and with 3 merges running
concurrently.  I think most of the CPU cost comes from the pqueue
that's used to do the merge sort, plus read/writeVInt.  When Lucene
[eventually] switches to PForDelta, that should be more CPU friendly.

Also, it's tons of IO because for each merge it must read every single
byte and write nearly every single byte, so that's ~2X bytes moved.
Then, if you have more segments in your index than your mergeFactor,
multiple such merges are needed and you're looking at, at least, 4X
your index size in net bytes moved.  If you have CFS enabled, it's 8X
the index size.

Some ideas:

  * Switch to SSD

  * Play w/ mergeFactor; maybe also try different sizes for
    MERGE_READ_BUFFER_SIZE in IndexWriter (it's private now so you'd
    have to change the sources, but if something works well, post
    back!)

  * If possible, make sure you always add the same fields to your
    docs, in the same order (this results in consistent numbering of
    field name -> number).  This is very much an unexpected
    gotchya... the merging of stored fields and term vectors is much,
    much faster if the field numbers are identical.  LUCENE-1737 is
    open to fix Lucene so it consistently numbers automatically, but
    it's somewhat tricky because many places in Lucene assume the
    field names are densely packed.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41733-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 21:12:02 2009
Return-Path: <java-user-return-41733-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27193 invoked from network); 5 Aug 2009 21:12:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 21:12:02 -0000
Received: (qmail 97312 invoked by uid 500); 5 Aug 2009 21:12:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97230 invoked by uid 500); 5 Aug 2009 21:12:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97220 invoked by uid 99); 5 Aug 2009 21:12:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 21:12:06 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [132.249.20.114] (HELO postal.sdsc.edu) (132.249.20.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 21:11:56 +0000
Received: from mta.ad.sdsc.edu (mta.ad.sdsc.edu [132.249.69.68])
	by postal.sdsc.edu (8.11.7/8.11.7/server/78) with ESMTP id n75LBYH22678
	for <java-user@lucene.apache.org>; Wed, 5 Aug 2009 14:11:34 -0700 (PDT)
Received: from MBX.ad.sdsc.edu ([fe80::85f9:e068:7dc0:4fe0]) by
 mta.ad.sdsc.edu ([132.249.69.68]) with mapi; Wed, 5 Aug 2009 14:11:29 -0700
From: Christopher Condit <condit@sdsc.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Wed, 5 Aug 2009 14:11:27 -0700
Subject: RE: Analysis Question
Thread-Topic: Analysis Question
Thread-Index: AcoKM7EwA286tmMsQLmWW5siUeggvAAGNb2gAvDNzkA=
Message-ID: <BAFDED91EF7D5A43A30F897D6C94B1283B4D6F4D26@MBX.ad.sdsc.edu>
References: <008201ca0a33$b1f0d240$15d276c0$@com>
 <BAFDED91EF7D5A43A30F897D6C94B128388101B218@MBX.ad.sdsc.edu>
In-Reply-To: <BAFDED91EF7D5A43A30F897D6C94B128388101B218@MBX.ad.sdsc.edu>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Perhaps a better question: let's say I have a few thousand terms or phrases=
. I want to prefer documents with these phrases in my search results over d=
ocuments that do not have these terms or phrases. What's the best way to ac=
complish this?
Thanks,
-Chris

> -----Original Message-----
> From: Christopher Condit [mailto:condit@sdsc.edu]
> Sent: Tuesday, July 21, 2009 2:48 PM
> To: java-user@lucene.apache.org
> Subject: Analysis Question
>=20
> I'm trying to implement an analyzer that will compute a score based on
> vocabulary terms in the indexed content (ie a document field with more
> terms in the vocabulary will score higher). Although I can see the
> tokens I can't seem to access the document from the analyzer to set a
> new field on it after I compute the value. Is there a way to do this
> from an Analyzer? Or is there another preferred way to do this?
> Thanks,
> -Chris
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41734-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 22:32:26 2009
Return-Path: <java-user-return-41734-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74441 invoked from network); 5 Aug 2009 22:32:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 22:32:26 -0000
Received: (qmail 98317 invoked by uid 500); 5 Aug 2009 22:32:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98239 invoked by uid 500); 5 Aug 2009 22:32:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98218 invoked by uid 99); 5 Aug 2009 22:32:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 22:32:30 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul.fuehring@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 22:32:22 +0000
Received: by ewy26 with SMTP id 26so506310ewy.5
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 15:32:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=Xnpj+5mHI0GSZvE/IcdQw/JR496QhEY/BsEBuKYd/XY=;
        b=vrhN4OUfo7gewGJDECDaomamPW2wGTTE0TnMDbM78UUXhK447jBYA2UKPbbsQCxv7i
         4ZDZ3ax0czOzN3Ov3UPadB1ZKxnjtpvDS/vv/9G7KRei8x0pV0Q4niNvTRUSBkHAB0HD
         cLayMhDA/NK8Ug9tULGaqLz6Ya6HUiSHAjPkg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=hVYbiYx1mZsBFOgxIv1Gn7h+4FBiCiLLqNilPasGejjA9HnBct6EV7c6vwpAD1s0T4
         VRAi7DMeMj8Y+6fHjD/cvtfD85Jyd9FtvP8QUSENds9oxwJVxy1s65QBrLFggEDOivgp
         vd7QMw5PqdJyhKfsRQCvs+vuIygs96j4wDbvA=
MIME-Version: 1.0
Received: by 10.216.11.66 with SMTP id 44mr1726450wew.146.1249511521284; Wed, 
	05 Aug 2009 15:32:01 -0700 (PDT)
Date: Thu, 6 Aug 2009 00:32:01 +0200
Message-ID: <e4ae55b90908051532v1bfa4535s81a0a2855ccd2b71@mail.gmail.com>
Subject: DuplicateFilter.java
From: Paul <paul.fuehring@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163646da6c5e71d504706c92b4
X-Virus-Checked: Checked by ClamAV on apache.org

--00163646da6c5e71d504706c92b4
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

I'm looking for a way to filter out duplicates of a search result and found
this class in the javadoc [1]. However, it is not included in the 2.4.1
source [2]. There seem to be some other classes missing or inconsistencies
as well.
[1]
http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/DuplicateFilter.html
[2]
http://svn.apache.org/viewvc/lucene/java/branches/lucene_2_4/src/java/org/apache/lucene/search/

Thanks,
Paul.

--00163646da6c5e71d504706c92b4--

From java-user-return-41735-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 05 22:37:47 2009
Return-Path: <java-user-return-41735-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78403 invoked from network); 5 Aug 2009 22:37:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Aug 2009 22:37:46 -0000
Received: (qmail 16250 invoked by uid 500); 5 Aug 2009 22:37:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16184 invoked by uid 500); 5 Aug 2009 22:37:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16174 invoked by uid 99); 5 Aug 2009 22:37:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 22:37:51 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.12.71] (HELO mx2.syr.edu) (128.230.12.71)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 05 Aug 2009 22:37:40 +0000
Received: from suex07-hub-01.ad.syr.edu (suex07-hub-01.ad.syr.edu [128.230.108.195])
	by mx2.syr.edu (8.14.3/8.14.3) with ESMTP id n75MbJXV007142
	for <java-user@lucene.apache.org>; Wed, 5 Aug 2009 18:37:19 -0400
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-01.ad.syr.edu ([2002:80e6:6cc3::80e6:6cc3]) with mapi; Wed, 5 Aug
 2009 18:37:19 -0400
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Wed, 5 Aug 2009 18:37:16 -0400
Subject: RE: DuplicateFilter.java
Thread-Topic: DuplicateFilter.java
Thread-Index: AcoWHKQyUICnjE68RaecsShgLA4qhgAAG0jw
Message-ID: <2D127F11DC79714E9B6A43AC9458147F1BD65C18@suex07-mbx-03.ad.syr.edu>
References: <e4ae55b90908051532v1bfa4535s81a0a2855ccd2b71@mail.gmail.com>
In-Reply-To: <e4ae55b90908051532v1bfa4535s81a0a2855ccd2b71@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.8161:2.4.5,1.2.40,4.0.166 definitions=2009-08-05_11:2009-07-24,2009-08-05,2009-08-05 signatures=0
X-Proofpoint-Spam-Reason: safe
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Paul,

This class is under contrib/queries/:

http://svn.apache.org/viewvc/lucene/java/branches/lucene_2_4/contrib/querie=
s/src/java/org/apache/lucene/search/

Steve

> -----Original Message-----
> From: Paul [mailto:paul.fuehring@gmail.com]
> Sent: Wednesday, August 05, 2009 6:32 PM
> To: java-user@lucene.apache.org
> Subject: DuplicateFilter.java
>=20
> Hi,
>=20
> I'm looking for a way to filter out duplicates of a search result and
> found
> this class in the javadoc [1]. However, it is not included in the 2.4.1
> source [2]. There seem to be some other classes missing or
> inconsistencies
> as well.
> [1]
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Duplicat=
eFilter.html
> [2]
> http://svn.apache.org/viewvc/lucene/java/branches/lucene_2_4/src/java/org=
/apache/lucene/search/
>=20
> Thanks,
> Paul.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41736-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 05:28:08 2009
Return-Path: <java-user-return-41736-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83951 invoked from network); 6 Aug 2009 05:28:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 05:28:08 -0000
Received: (qmail 18291 invoked by uid 500); 6 Aug 2009 05:28:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18221 invoked by uid 500); 6 Aug 2009 05:28:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18211 invoked by uid 99); 6 Aug 2009 05:28:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 05:28:13 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of adrianocrestani@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 05:28:05 +0000
Received: by qw-out-2122.google.com with SMTP id 8so265590qwh.53
        for <java-user@lucene.apache.org>; Wed, 05 Aug 2009 22:27:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=d2hJkAizU4LxxqgKi5i8LNa9MqKUAWureaooi67Mhuo=;
        b=W/o+eMRLMrifvs7yVLdAz5XDCS2TEni7NRMi6JCwLtVRfWjJzF7gF4kEcnsSFHBhLa
         Si9JgsBC1HZgqc8cEXm9UBC6oAuMPs0rndNvudkNQ71PUX9R/lcq9iqkciGcuUxLPqFW
         CRZ/J9OQ3U5yEnOVTVawCb3zwZwLG7XUGf1Qw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=HgyZ0X+KWA+HyMkunIDPnPgOBfmj+M17jmvhwJY3jqHYgvyhmlq2owMBatvF+C87Fx
         lPkhwNcdHYL3YPraGM6j0Nc6RVLuJhwyR86nSI+sqX6lG/tElDGO+CH2vGgcZsIL8GjG
         sRWpA/Od6pgr+4QE6sEBLKzqGv8l0RmMZkW1o=
MIME-Version: 1.0
Received: by 10.229.96.132 with SMTP id h4mr2740357qcn.65.1249536463118; Wed, 
	05 Aug 2009 22:27:43 -0700 (PDT)
In-Reply-To: <9ac0c6aa0908051155x1c5271dcs5a1b963718fa457a@mail.gmail.com>
References: <55e2bf7e0908041440m586cf979n276bd40ebae302f@mail.gmail.com> 
	<9ac0c6aa0908041534g491259bl5082118b082bae0e@mail.gmail.com> 
	<55e2bf7e0908051106s5d2a1af0vcb01ea0416b7abc5@mail.gmail.com> 
	<55e2bf7e0908051110m10430b5i3bde5fda1466c2e@mail.gmail.com> 
	<9ac0c6aa0908051155x1c5271dcs5a1b963718fa457a@mail.gmail.com>
From: Adriano Crestani <adrianocrestani@gmail.com>
Date: Wed, 5 Aug 2009 22:27:23 -0700
Message-ID: <55e2bf7e0908052227s5b754e6anc49ee3c0374436c0@mail.gmail.com>
Subject: Re: Nightly build link is broken
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163642737704a1070470726103
X-Virus-Checked: Checked by ClamAV on apache.org

--00163642737704a1070470726103
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

The server is up again :D

Thank you guys!

On Wed, Aug 5, 2009 at 11:55 AM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> Hmm... not working for me either.  Looks like it's currently down:
>
>    http://monitoring.apache.org/status/
>
> I expect infra is working on fixing it...
>
> Mike
>
> On Wed, Aug 5, 2009 at 2:10 PM, Adriano
> Crestani<adrianocrestani@gmail.com> wrote:
> > The new link also does not work. Is it working for you?
> >
> > On Wed, Aug 5, 2009 at 11:06 AM, Adriano Crestani <
> adrianocrestani@gmail.com
> >> wrote:
> >
> >> Now I see it was in the news session on the main page: 3 January 2007 -
> >> Nightly Source builds available<
> http://lucene.apache.org/java/docs/#3+January+2007+-+Nightly+Source+builds+available
> >.
> >> It makes sense that the new is out of date. However, is there any other
> >> place the link to nightly builds can be found by users?
> >>
> >>
> >> On Tue, Aug 4, 2009 at 3:34 PM, Michael McCandless <
> >> lucene@mikemccandless.com> wrote:
> >>
> >>> Hmmm... that link is old.  The right one is:
> >>>
> >>>  http://hudson.zones.apache.org/hudson/view/Lucene/job/Lucene-trunk/
> >>>
> >>> Which page did you find that link on?
> >>>
> >>> Mike
> >>>
> >>> On Tue, Aug 4, 2009 at 5:40 PM, Adriano
> >>> Crestani<adrianocrestani@apache.org> wrote:
> >>> > Hi,
> >>> >
> >>> > I was trying to download a nightly build jar, so I went to Lucene
> >>> website
> >>> > and clicked on the link that redirected to:
> >>> >
> >>> > http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/
> >>> >
> >>> > and I got a "Firefox can't establish a connection to the server at
> >>> > lucene.zones.apache.org:8080".
> >>> >
> >>> > Is the link broken or the server is down?
> >>> >
> >>> > Thanks,
> >>> > Adriano Crestani
> >>> >
> >>>
> >>> ---------------------------------------------------------------------
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>>
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00163642737704a1070470726103--

From java-user-return-41737-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 09:03:08 2009
Return-Path: <java-user-return-41737-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51970 invoked from network); 6 Aug 2009 09:03:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 09:03:08 -0000
Received: (qmail 74644 invoked by uid 500); 6 Aug 2009 09:03:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74561 invoked by uid 500); 6 Aug 2009 09:03:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74551 invoked by uid 99); 6 Aug 2009 09:03:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 09:03:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.94] (HELO smtp107.mail.in.yahoo.com) (202.86.5.94)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 06 Aug 2009 09:03:01 +0000
Received: (qmail 72434 invoked from network); 6 Aug 2009 09:02:37 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=WJXxWS2SdLPU8WOMF3Pv1EKehFfMX9Y+06OmMf3/vYLhJeMgwg/Jx81D5iNTRrgjn4QPYgu32V992bwM0PaK8eiq80s3+VZNV1jymtQfJhr8alpEFjTMVoSbHZ9fOTcSy0fahz5byKGrxoisQ6bb8NGsKjeYgixwuSUvpPqGjRE=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp107.mail.in.yahoo.com with SMTP; 6 Aug 2009 09:02:34 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: qhoEre4VM1mQWgZ86Ud_KllVtbA3Q_kZY.YNs2Cu833X7eDTVbtEpx8zf8UoFWrrrZBaKyiRbV0LJJ6VHgnvVJSQZs.hfT99bJsEvVpfzKiHNA_h3xw_.oWi.2ABENwXoEg.JxRsRB0CZPoVyib9ng0Ib6kIbk1XeOkWU5INRoQOUQEKFEvc0Txe0R.o
X-Yahoo-Newman-Property: ymail-3
Message-ID: <001201ca1674$a3bab4a0$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
Subject: Same field could be part of Query and filter
Date: Thu, 6 Aug 2009 14:32:22 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

Hello all,

I am having a field UserID, for every record. The results will be =
filtered for every User based on this field. We have a feature of group =
admin where a admin could view all records of a set of Users. I could =
manage to do by filtering on the set of IDs.=20

I have doubt in the below scenerio:
When a admin of 3 Users want to view only one particular User records. =
In this case he may give full UserID or some prefix. I need to use this =
field as part of Query and also Filter will have 3 Users.=20
Filter: User1@domain.com, User2@domain.com User3@domain.com
Query: User1=20

Whether this approach will work fine? Is there any other better approach =
to handle this group admin? Please note group members may change often =
and i cannot index group name or ID along with the record.=20

Regards
Ganesh 
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41738-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 09:25:59 2009
Return-Path: <java-user-return-41738-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61772 invoked from network); 6 Aug 2009 09:25:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 09:25:59 -0000
Received: (qmail 12460 invoked by uid 500); 6 Aug 2009 09:26:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12383 invoked by uid 500); 6 Aug 2009 09:26:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12373 invoked by uid 99); 6 Aug 2009 09:26:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 09:26:04 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of anshumg@gmail.com designates 209.85.212.185 as permitted sender)
Received: from [209.85.212.185] (HELO mail-vw0-f185.google.com) (209.85.212.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 09:25:54 +0000
Received: by vws15 with SMTP id 15so656110vws.5
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 02:25:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ebIMxRmbbC7KJK/e1WEAqSuvfejIIlAjkUrxSF3aODc=;
        b=Tan5KIaXrvvUtYEARZKDFrr8eWQr0Wqxgt8pudphx+GWbrytQMH3rfLT3VME9mJHwu
         TmFNLGK3t91yfmp2WLvISje/uHr8XaAgPFWHnJ4ceu6MFnSaPafsH7uLP1HoQWYKJsIF
         qodRAZeBm/u1qXB5zaWmCo9V5bwD6+lpx7MZo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=OPg8nXpyIPTsyIdipIIQqa3W4NdLbvG9oRhY5QzmIMSvVIq99MQUeJhnztB2Ialw+C
         h9rVNvK9kQKQBNTGuMexmIalt/A4BTtdKc1odVShutZvVcPnBXecmiL2e3sfi9OeeV3O
         49FdgnauO1bdg0Jc/Sb2M/3x0edNiLHh0hk4Y=
MIME-Version: 1.0
Received: by 10.220.94.129 with SMTP id z1mr9940935vcm.39.1249550733626; Thu, 
	06 Aug 2009 02:25:33 -0700 (PDT)
In-Reply-To: <BAFDED91EF7D5A43A30F897D6C94B1283B4D6F4D26@MBX.ad.sdsc.edu>
References: <008201ca0a33$b1f0d240$15d276c0$@com>
	 <BAFDED91EF7D5A43A30F897D6C94B128388101B218@MBX.ad.sdsc.edu>
	 <BAFDED91EF7D5A43A30F897D6C94B1283B4D6F4D26@MBX.ad.sdsc.edu>
Date: Thu, 6 Aug 2009 14:55:33 +0530
Message-ID: <867513fe0908060225y7fb34e0p86358cd83424cc4c@mail.gmail.com>
Subject: Re: Analysis Question
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e644ccb89b509b047075b337
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e644ccb89b509b047075b337
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Cristopher,
You might want to look at writing a custom analyzer or something and add a
document boost (while indexing) for documents containing those terms.

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Thu, Aug 6, 2009 at 2:41 AM, Christopher Condit <condit@sdsc.edu> wrote:

> Perhaps a better question: let's say I have a few thousand terms or
> phrases. I want to prefer documents with these phrases in my search results
> over documents that do not have these terms or phrases. What's the best way
> to accomplish this?
> Thanks,
> -Chris
>
> > -----Original Message-----
> > From: Christopher Condit [mailto:condit@sdsc.edu]
> > Sent: Tuesday, July 21, 2009 2:48 PM
> > To: java-user@lucene.apache.org
> > Subject: Analysis Question
> >
> > I'm trying to implement an analyzer that will compute a score based on
> > vocabulary terms in the indexed content (ie a document field with more
> > terms in the vocabulary will score higher). Although I can see the
> > tokens I can't seem to access the document from the analyzer to set a
> > new field on it after I compute the value. Is there a way to do this
> > from an Analyzer? Or is there another preferred way to do this?
> > Thanks,
> > -Chris
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e644ccb89b509b047075b337--

From java-user-return-41739-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 09:59:34 2009
Return-Path: <java-user-return-41739-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84004 invoked from network); 6 Aug 2009 09:59:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 09:59:34 -0000
Received: (qmail 60432 invoked by uid 500); 6 Aug 2009 09:59:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60372 invoked by uid 500); 6 Aug 2009 09:59:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60362 invoked by uid 99); 6 Aug 2009 09:59:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 09:59:38 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of savvas.andreas.moysidis@googlemail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 09:59:28 +0000
Received: by fxm2 with SMTP id 2so680584fxm.28
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 02:59:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=/A7slfVjtaUSSQcMRzrJKaPZRpOeFybsOVRfOP9Tn4g=;
        b=m/FlMfplHqGN8ojASwky2eY5XnBCp4daZKVoRZoXMe9KWiSnYUQWsOHoiNNLs9re9c
         HsnZmXxT7hAblrtCZdtzEHiktn6dJojsGwX78mXRzJ8DSWMM+23UZMZkEoFP94of+bZp
         XB2i0y1qaZGd+G5Y7IJs2R6JJhcyeuM/KHhts=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=r2aUfSPONklqIG9IVB99exzO68d2LgkGmZtp3jfE6GpQJkGNx1OR3b2tLtmDzOYJ9N
         ojlwKFAjBilDMdylDee9wh2eGYguYgvQ17Lc/1QJmi9iLK8qMZ5/ARwv38hblaXIbZmP
         qg5NndkPgvOKeXXYmylhj/k8EKGwXcIfU5P+o=
MIME-Version: 1.0
Received: by 10.86.96.18 with SMTP id t18mr3047256fgb.32.1249552747441; Thu, 
	06 Aug 2009 02:59:07 -0700 (PDT)
Date: Thu, 6 Aug 2009 10:59:07 +0100
Message-ID: <eac5aec20908060259h26dbff7br7acc5b8358fb23d8@mail.gmail.com>
Subject: Paging in a Lucene search
From: Savvas-Andreas Moysidis <savvas.andreas.moysidis@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd28680a3b05c0470762bf0
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd28680a3b05c0470762bf0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hello,

I'd like to ask if anybody has any thoughts on the best strategy to use when
implementing a paging scenario in a Lucene search.

In order to implement my paging list before the view is rendered I need to
know the total number of documents this particular search would return but I
still need to only load the documents of the specific page that has been
requested.

I'm thinking of using the search variant of :

*TopFieldDocs search(Query query, Filter filter, int n,Sort sort);*

since I need sorting and filtering and passing indeaxReader.maxDoc() for n.
Will that create an array of size indeaxReader.maxDoc() ?

After the search is finished I can retrieve only the documents I'm
interested by using the sub-list of TopFieldDocs I've worked out.

In the HitCollector docs :

http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/HitCollector.html
I can see a way to use a BitSet but I'm not quite sure how this can be used
to retrieve documents.

Any alternatives/better ideas?


thanks,
Savvas

--000e0cd28680a3b05c0470762bf0--

From java-user-return-41740-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 10:03:05 2009
Return-Path: <java-user-return-41740-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87479 invoked from network); 6 Aug 2009 10:03:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 10:03:05 -0000
Received: (qmail 65341 invoked by uid 500); 6 Aug 2009 10:03:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65253 invoked by uid 500); 6 Aug 2009 10:03:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65243 invoked by uid 99); 6 Aug 2009 10:03:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 10:03:09 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 10:03:01 +0000
Received: by ewy26 with SMTP id 26so795139ewy.5
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 03:02:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=qVKSweI3yvJHlfV194PbRu962Kozxr5tlialfB8isgE=;
        b=CScCcUHbpE1nBCReNgs9aRG+FuvLb276WMIHk0Oh8A9ZueiSP4yj3IYVUXpNAmLLe0
         pyO9ziNaGI9K7EVGJPyk935glOpikQCPLp3JXJtA4cVW83INell1VQRJ3JEkTyCHAEih
         rPHOTbap7DXfL73pew2pQnGdiB9xsZVqLHa6g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=fGBnC6BtD5lFWXVyEGzxg8w7JfGoPgplVuURIsba3ab/Y1FWd9mpqPv8NJn949yi6O
         9GYJKCXNWuEVjhbIF1Z7rUUYZHHnUzamaDu3lOMlmYqT8hIsuX7IUBOVI8bNrchExHf3
         ysNa2xcDCMq3qLSw64fH2WRY9Jd2OZh/6ASWc=
MIME-Version: 1.0
Received: by 10.216.13.194 with SMTP id b44mr1958685web.139.1249552960299; 
	Thu, 06 Aug 2009 03:02:40 -0700 (PDT)
In-Reply-To: <eac5aec20908060259h26dbff7br7acc5b8358fb23d8@mail.gmail.com>
References: <eac5aec20908060259h26dbff7br7acc5b8358fb23d8@mail.gmail.com>
Date: Thu, 6 Aug 2009 13:02:40 +0300
Message-ID: <786fde50908060302t40b8d18cxb2b0b0551101a6b6@mail.gmail.com>
Subject: Re: Paging in a Lucene search
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64c1bbe53a27d04707638ba
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64c1bbe53a27d04707638ba
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

If you pass reader.maxDoc(), it will create a heap (array) of size
reader.maxDoc() and is not recommended.
Instead, if you display the first page of results, you should pass 10
(assuming you display 10 results).
You can call TopFieldDocs.totalHits to get the total number of matching
results.

Then if you want to display the second page of results, pass 20, and take
results 11-20 and so on.

Does that help?

Shai

On Thu, Aug 6, 2009 at 12:59 PM, Savvas-Andreas Moysidis <
savvas.andreas.moysidis@googlemail.com> wrote:

> Hello,
>
> I'd like to ask if anybody has any thoughts on the best strategy to use
> when
> implementing a paging scenario in a Lucene search.
>
> In order to implement my paging list before the view is rendered I need to
> know the total number of documents this particular search would return but
> I
> still need to only load the documents of the specific page that has been
> requested.
>
> I'm thinking of using the search variant of :
>
> *TopFieldDocs search(Query query, Filter filter, int n,Sort sort);*
>
> since I need sorting and filtering and passing indeaxReader.maxDoc() for n.
> Will that create an array of size indeaxReader.maxDoc() ?
>
> After the search is finished I can retrieve only the documents I'm
> interested by using the sub-list of TopFieldDocs I've worked out.
>
> In the HitCollector docs :
>
>
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/HitCollector.html
> I can see a way to use a BitSet but I'm not quite sure how this can be used
> to retrieve documents.
>
> Any alternatives/better ideas?
>
>
> thanks,
> Savvas
>

--0016e64c1bbe53a27d04707638ba--

From java-user-return-41741-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 12:21:20 2009
Return-Path: <java-user-return-41741-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34398 invoked from network); 6 Aug 2009 12:21:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 12:21:20 -0000
Received: (qmail 21363 invoked by uid 500); 6 Aug 2009 12:21:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21273 invoked by uid 500); 6 Aug 2009 12:21:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21263 invoked by uid 99); 6 Aug 2009 12:21:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 12:21:25 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [207.126.144.147] (HELO eu1sys200aog119.obsmtp.com) (207.126.144.147)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 06 Aug 2009 12:21:12 +0000
Received: from source ([193.36.230.160]) by eu1sys200aob119.postini.com ([207.126.147.11]) with SMTP
	ID DSNKSnrKoqNbDd3+Xc1B4T/pIQ+fp4x6lz0D@postini.com; Thu, 06 Aug 2009 12:20:52 UTC
Received: from blackex05.detica.com (unverified) by mail02.detica.com 
    (Content Technologies SMTPRS 4.3.19) with ESMTP id 
    <T8ffc473ae00a09010b32b0@mail02.detica.com> for 
    <java-user@lucene.apache.org>; Thu, 6 Aug 2009 13:20:49 +0100
Received: from uksrpblkexb01.detica.com ([10.1.1.38]) by blackex05.detica.com 
    with Microsoft SMTPSVC (6.0.3790.3959); Thu, 6 Aug 2009 13:20:49 +0100
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative; 
    boundary="----_=_NextPart_001_01CA1690.5588109D"
Subject: MatchAllDocsQuery concurrency issue
Date: Thu, 6 Aug 2009 13:19:53 +0100
Message-ID: <8163028120305742991D2FB7F19412AB63537A@uksrpblkexb01.detica.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: MatchAllDocsQuery concurrency issue
Thread-Index: AcoWkDPupsJkFpzzQJiC6YKijdJdLQ==
From: "Carl Austin" <Carl.austin@detica.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 06 Aug 2009 12:20:49.0292 (UTC) 
    FILETIME=[5522B4C0:01CA1690]
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01CA1690.5588109D
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi,

I have been seeing an issue running MatchAllDocsQueries concurrently.
Running one against a test index is very fast (70 ms). Running two
concurrently can take 5-25 seconds on the same test index! This issue
doesn't occur with any other type of query I have used.
Because of this, I have put together a few test classes to demonstrate
this in a simple manner. These recreate the issue with only the most
basic Lucene api usage.

I have incldued the code for the classes below in this email. Just run
TestIndexCreator with a single argument of where to create the test
index. This will create an index with 999999 documents in, each document
having only 1 field with the value "testing" in that field. Only one
unique term for the whole index.
Then run the class Test with the same argument as the index creator.
This will run a 4 tests with a 5 second wait between each. The first
runs a single term query for "testing". The second a single match all
docs query. The third 2 concurrent term queries and the fourth 2
concurrent match all docs queries. It is the fourth that takes a
relatively long time to complete.
On a larger index I have here it can take 8 minutes to run just 2 match
all docs queries concurrently.

I look forward to hearing further on this. I can provide this in Jar for
if wished, though I don't know if you can attach to these emails.

Thanks

Carl


Source Code:

import org.apache.lucene.analysis.KeywordAnalyzer;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.document.Field.Index;
import org.apache.lucene.document.Field.Store;
import org.apache.lucene.index.IndexReader;
import org.apache.lucene.index.IndexWriter;


public class TestIndexCreator {

=09
	public static void main(String[] args) throws Exception
	{
		if (!IndexReader.indexExists(args[0]))
		{
			IndexWriter w =3D new IndexWriter(args[0], new
KeywordAnalyzer(), true);
			for(int i =3D0; i < 1000000; i++)
			{
				Document doc =3D new Document();
				doc.add(new Field("testfield",
"testing", Store.YES, Index.ANALYZED));
				w.addDocument(doc);
				if (i % 10000 =3D=3D 0)
				{
					System.out.println(i);
				}
			}
			w.optimize();
			w.close();
		}
	}
=09
}

import java.io.IOException;

import org.apache.lucene.index.IndexReader;
import org.apache.lucene.index.Term;
import org.apache.lucene.search.IndexSearcher;
import org.apache.lucene.search.MatchAllDocsQuery;
import org.apache.lucene.search.Query;
import org.apache.lucene.search.TermQuery;
import org.apache.lucene.search.TopDocCollector;

	class TestThread implements Runnable
	{
		private IndexReader r;
		private int x;
		private Test callback;
		private boolean termSearches;
	=09
		public TestThread(IndexReader r, int x, Test callback,
boolean termSearches)
		{
			this.r =3D r;
			this.x =3D x;
			this.callback =3D callback;
			this.termSearches =3D termSearches;
		}

		public void run() {
			long time =3D System.currentTimeMillis();
			System.out.println("Thread " + x + " start");
			IndexSearcher s =3D new IndexSearcher(r);
			Query q =3D null;
			if (termSearches)
			{
				q =3D new TermQuery(new Term("testfield",
"testing"));
			}
			else
			{
				q =3D new MatchAllDocsQuery();

			}
			TopDocCollector col =3D new TopDocCollector(50);=20
			try {
				s.search(q, col);
			} catch (IOException e) {
				e.printStackTrace();
			}
			System.out.println("Time taken for " + x + " =3D "
+ (System.currentTimeMillis() - time));
			callback.callback();
		}
	=09
	}
=09
import java.io.IOException;

import org.apache.lucene.index.CorruptIndexException;
import org.apache.lucene.index.IndexReader;


public class Test {

	private IndexReader r;
	private int noSearches =3D 0;

	public static void main(String[] args)
	{
		System.out.println("Running Single TermQuery Search");
		Test t =3D new Test(args[0]);
		try {
			t.runSearches(1, true);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		try {
			Thread.sleep(5000);
		} catch (InterruptedException e1) {
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}
		System.out.println("Running Single MatchAllDocs
Search");
		t =3D new Test(args[0]);
		try {
			t.runSearches(1, false);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		try {
			Thread.sleep(5000);
		} catch (InterruptedException e1) {
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}
		System.out.println("Running two concurrent TermQuery
Searches");
		t =3D new Test(args[0]);
		try {
			t.runSearches(2, true);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		try {
			Thread.sleep(5000);
		} catch (InterruptedException e1) {
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}
		System.out.println("Running two concurrent MatchAllDocs
Searches");
		t =3D new Test(args[0]);
		try {
			t.runSearches(2, false);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	=09
	}
=09
	public Test(String index)
	{
		try {
			r =3D IndexReader.open(index);
		} catch (CorruptIndexException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
=09
	public void runSearches(int no, boolean termSearches) throws
Exception
	{
		noSearches =3D no;
		for (int i =3D 0; i < no; i++)
		{
			Thread t1 =3D new Thread(new TestThread(r, i,
this, termSearches));
			t1.start();
		}
	}
=09
	public void callback()
	{
		noSearches--;
		if (noSearches =3D=3D 0)
		{
			try {
				r.close();
			} catch (IOException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}
	}
=09
}



This message should be regarded as confidential. If you have received this =
email in error please notify the sender and destroy it immediately.
Statements of intent shall only become binding when confirmed in hard copy =
by an authorised signatory.  The contents of this email may relate to deali=
ngs with other companies within the Detica Limited group of companies.

Detica Limited is registered in England under No: 1337451.

Registered offices: Surrey Research Park, Guildford, Surrey, GU2 7YP, Engla=
nd.


------_=_NextPart_001_01CA1690.5588109D--

From java-user-return-41742-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 12:26:23 2009
Return-Path: <java-user-return-41742-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35960 invoked from network); 6 Aug 2009 12:26:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 12:26:23 -0000
Received: (qmail 34060 invoked by uid 500); 6 Aug 2009 12:26:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33999 invoked by uid 500); 6 Aug 2009 12:26:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33989 invoked by uid 99); 6 Aug 2009 12:26:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 12:26:27 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 12:26:19 +0000
Received: by ywh26 with SMTP id 26so1128706ywh.5
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 05:25:57 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.141.16 with SMTP id t16mr17984665ybn.266.1249561556260; 
	Thu, 06 Aug 2009 05:25:56 -0700 (PDT)
In-Reply-To: <8163028120305742991D2FB7F19412AB63537A@uksrpblkexb01.detica.com>
References: <8163028120305742991D2FB7F19412AB63537A@uksrpblkexb01.detica.com>
Date: Thu, 6 Aug 2009 08:25:56 -0400
Message-ID: <9ac0c6aa0908060525k3301c663t8de3204c616f7ab9@mail.gmail.com>
Subject: Re: MatchAllDocsQuery concurrency issue
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Most likely you're hitting this issue:

    https://issues.apache.org/jira/browse/LUCENE-1316

Which is fixed in 2.9.  Can you try running with 2.9 to confirm?

Mike

On Thu, Aug 6, 2009 at 8:19 AM, Carl Austin<Carl.austin@detica.com> wrote:
> Hi,
>
> I have been seeing an issue running MatchAllDocsQueries concurrently.
> Running one against a test index is very fast (70 ms). Running two
> concurrently can take 5-25 seconds on the same test index! This issue
> doesn't occur with any other type of query I have used.
> Because of this, I have put together a few test classes to demonstrate
> this in a simple manner. These recreate the issue with only the most
> basic Lucene api usage.
>
> I have incldued the code for the classes below in this email. Just run
> TestIndexCreator with a single argument of where to create the test
> index. This will create an index with 999999 documents in, each document
> having only 1 field with the value "testing" in that field. Only one
> unique term for the whole index.
> Then run the class Test with the same argument as the index creator.
> This will run a 4 tests with a 5 second wait between each. The first
> runs a single term query for "testing". The second a single match all
> docs query. The third 2 concurrent term queries and the fourth 2
> concurrent match all docs queries. It is the fourth that takes a
> relatively long time to complete.
> On a larger index I have here it can take 8 minutes to run just 2 match
> all docs queries concurrently.
>
> I look forward to hearing further on this. I can provide this in Jar for
> if wished, though I don't know if you can attach to these emails.
>
> Thanks
>
> Carl
>
>
> Source Code:
>
> import org.apache.lucene.analysis.KeywordAnalyzer;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.document.Field.Index;
> import org.apache.lucene.document.Field.Store;
> import org.apache.lucene.index.IndexReader;
> import org.apache.lucene.index.IndexWriter;
>
>
> public class TestIndexCreator {
>
>
> =A0 =A0 =A0 =A0public static void main(String[] args) throws Exception
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (!IndexReader.indexExists(args[0]))
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexWriter w =3D new Inde=
xWriter(args[0], new
> KeywordAnalyzer(), true);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0for(int i =3D0; i < 100000=
0; i++)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Document d=
oc =3D new Document();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0doc.add(ne=
w Field("testfield",
> "testing", Store.YES, Index.ANALYZED));
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0w.addDocum=
ent(doc);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (i % 10=
000 =3D=3D 0)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0System.out.println(i);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0w.optimize();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0w.close();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
>
> }
>
> import java.io.IOException;
>
> import org.apache.lucene.index.IndexReader;
> import org.apache.lucene.index.Term;
> import org.apache.lucene.search.IndexSearcher;
> import org.apache.lucene.search.MatchAllDocsQuery;
> import org.apache.lucene.search.Query;
> import org.apache.lucene.search.TermQuery;
> import org.apache.lucene.search.TopDocCollector;
>
> =A0 =A0 =A0 =A0class TestThread implements Runnable
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private IndexReader r;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private int x;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private Test callback;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private boolean termSearches;
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public TestThread(IndexReader r, int x, Te=
st callback,
> boolean termSearches)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.r =3D r;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.x =3D x;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.callback =3D callback=
;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.termSearches =3D term=
Searches;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public void run() {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0long time =3D System.curre=
ntTimeMillis();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Thread=
 " + x + " start");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexSearcher s =3D new In=
dexSearcher(r);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Query q =3D null;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (termSearches)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0q =3D new =
TermQuery(new Term("testfield",
> "testing"));
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0else
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0q =3D new =
MatchAllDocsQuery();
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0TopDocCollector col =3D ne=
w TopDocCollector(50);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0s.search(q=
, col);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printSta=
ckTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Time t=
aken for " + x + " =3D "
> + (System.currentTimeMillis() - time));
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0callback.callback();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0}
>
> import java.io.IOException;
>
> import org.apache.lucene.index.CorruptIndexException;
> import org.apache.lucene.index.IndexReader;
>
>
> public class Test {
>
> =A0 =A0 =A0 =A0private IndexReader r;
> =A0 =A0 =A0 =A0private int noSearches =3D 0;
>
> =A0 =A0 =A0 =A0public static void main(String[] args)
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running Single TermQue=
ry Search");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Test t =3D new Test(args[0]);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(1, true);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated cat=
ch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated cat=
ch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running Single MatchAl=
lDocs
> Search");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(1, false);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated cat=
ch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated cat=
ch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running two concurrent=
 TermQuery
> Searches");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(2, true);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated cat=
ch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated cat=
ch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running two concurrent=
 MatchAllDocs
> Searches");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(2, false);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated cat=
ch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0public Test(String index)
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0r =3D IndexReader.open(ind=
ex);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (CorruptIndexException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated cat=
ch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated cat=
ch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0public void runSearches(int no, boolean termSearches) thro=
ws
> Exception
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0noSearches =3D no;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0for (int i =3D 0; i < no; i++)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread t1 =3D new Thread(n=
ew TestThread(r, i,
> this, termSearches));
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t1.start();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0public void callback()
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0noSearches--;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (noSearches =3D=3D 0)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0r.close();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Au=
to-generated catch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printSta=
ckTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
>
> }
>
>
>
> This message should be regarded as confidential. If you have received thi=
s email in error please notify the sender and destroy it immediately.
> Statements of intent shall only become binding when confirmed in hard cop=
y by an authorised signatory. =A0The contents of this email may relate to d=
ealings with other companies within the Detica Limited group of companies.
>
> Detica Limited is registered in England under No: 1337451.
>
> Registered offices: Surrey Research Park, Guildford, Surrey, GU2 7YP, Eng=
land.
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41743-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 12:42:39 2009
Return-Path: <java-user-return-41743-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44635 invoked from network); 6 Aug 2009 12:42:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 12:42:39 -0000
Received: (qmail 62584 invoked by uid 500); 6 Aug 2009 12:42:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62513 invoked by uid 500); 6 Aug 2009 12:42:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62503 invoked by uid 99); 6 Aug 2009 12:42:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 12:42:44 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [207.126.144.113] (HELO eu1sys200aog102.obsmtp.com) (207.126.144.113)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 06 Aug 2009 12:42:34 +0000
Received: from source ([193.36.230.160]) by eu1sys200aob102.postini.com ([207.126.147.11]) with SMTP
	ID DSNKSnrPo0waMcXjxsnXthHuJgvGAZ+SbA/p@postini.com; Thu, 06 Aug 2009 12:42:14 UTC
Received: from blackex05.detica.com (unverified) by mail01.detica.com
 (Content Technologies SMTPRS 4.3.19) with ESMTP id <T8ffc5ac7440a09010a7cc@mail01.detica.com> for <java-user@lucene.apache.org>;
 Thu, 6 Aug 2009 13:42:11 +0100
Received: from uksrpblkexb01.detica.com ([10.1.1.38]) by blackex05.detica.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 6 Aug 2009 13:42:10 +0100
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: MatchAllDocsQuery concurrency issue
Date: Thu, 6 Aug 2009 13:41:14 +0100
Message-ID: <8163028120305742991D2FB7F19412AB635394@uksrpblkexb01.detica.com>
In-Reply-To: <9ac0c6aa0908060525k3301c663t8de3204c616f7ab9@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: MatchAllDocsQuery concurrency issue
Thread-Index: AcoWkSE5FviCmFB4QDOBEK+DYGsDJQAAVGIA
From: "Carl Austin" <Carl.austin@detica.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 06 Aug 2009 12:42:10.0298 (UTC) FILETIME=[50ACB5A0:01CA1693]
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Mike,

Running this with the 2.9 build does resolve the issue it would seem.

Unfortunately I can't move to 2.9, especially as it isn't in release =
yet. Is there a work-around for 2.4 known that will allow me to get =
around this issue as I notice the patches change some underlying classes =
such as MultiSegmentReader? What I am doing does regularly have the =
chance to call this query concurrently multiple times, which cause quite =
an issue.

Thanks

Carl

-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: 06 August 2009 13:26
To: java-user@lucene.apache.org
Subject: Re: MatchAllDocsQuery concurrency issue

Most likely you're hitting this issue:

    https://issues.apache.org/jira/browse/LUCENE-1316

Which is fixed in 2.9.  Can you try running with 2.9 to confirm?

Mike

On Thu, Aug 6, 2009 at 8:19 AM, Carl Austin<Carl.austin@detica.com> =
wrote:
> Hi,
>
> I have been seeing an issue running MatchAllDocsQueries concurrently.
> Running one against a test index is very fast (70 ms). Running two=20
> concurrently can take 5-25 seconds on the same test index! This issue=20
> doesn't occur with any other type of query I have used.
> Because of this, I have put together a few test classes to demonstrate =

> this in a simple manner. These recreate the issue with only the most=20
> basic Lucene api usage.
>
> I have incldued the code for the classes below in this email. Just run =

> TestIndexCreator with a single argument of where to create the test=20
> index. This will create an index with 999999 documents in, each=20
> document having only 1 field with the value "testing" in that field.=20
> Only one unique term for the whole index.
> Then run the class Test with the same argument as the index creator.
> This will run a 4 tests with a 5 second wait between each. The first=20
> runs a single term query for "testing". The second a single match all=20
> docs query. The third 2 concurrent term queries and the fourth 2=20
> concurrent match all docs queries. It is the fourth that takes a=20
> relatively long time to complete.
> On a larger index I have here it can take 8 minutes to run just 2=20
> match all docs queries concurrently.
>
> I look forward to hearing further on this. I can provide this in Jar=20
> for if wished, though I don't know if you can attach to these emails.
>
> Thanks
>
> Carl
>
>
> Source Code:
>
> import org.apache.lucene.analysis.KeywordAnalyzer;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field; import=20
> org.apache.lucene.document.Field.Index;
> import org.apache.lucene.document.Field.Store;
> import org.apache.lucene.index.IndexReader;
> import org.apache.lucene.index.IndexWriter;
>
>
> public class TestIndexCreator {
>
>
> =A0 =A0 =A0 =A0public static void main(String[] args) throws Exception
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (!IndexReader.indexExists(args[0]))
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexWriter w =3D new =
IndexWriter(args[0], new=20
> KeywordAnalyzer(), true);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0for(int i =3D0; i < =
1000000; i++)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0Document doc =3D new Document();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0doc.add(new Field("testfield",=20
> "testing", Store.YES, Index.ANALYZED));
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0w.addDocument(doc);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (i % =
10000 =3D=3D 0)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0System.out.println(i);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0w.optimize();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0w.close();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
>
> }
>
> import java.io.IOException;
>
> import org.apache.lucene.index.IndexReader;
> import org.apache.lucene.index.Term;
> import org.apache.lucene.search.IndexSearcher;
> import org.apache.lucene.search.MatchAllDocsQuery;
> import org.apache.lucene.search.Query; import=20
> org.apache.lucene.search.TermQuery;
> import org.apache.lucene.search.TopDocCollector;
>
> =A0 =A0 =A0 =A0class TestThread implements Runnable
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private IndexReader r;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private int x;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private Test callback;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private boolean termSearches;
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public TestThread(IndexReader r, int x, =
Test callback,=20
> boolean termSearches)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.r =3D r;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.x =3D x;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.callback =3D =
callback;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.termSearches =3D =
termSearches;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public void run() {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0long time =3D =
System.currentTimeMillis();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0System.out.println("Thread " + x + " start");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexSearcher s =3D new =
IndexSearcher(r);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Query q =3D null;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (termSearches)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0q =3D =
new TermQuery(new Term("testfield",=20
> "testing"));
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0else
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0q =3D =
new MatchAllDocsQuery();
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0TopDocCollector col =3D =
new TopDocCollector(50);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0s.search(q, col);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) =
{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0System.out.println("Time taken for " + x + " =3D "
> + (System.currentTimeMillis() - time));
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0callback.callback();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0}
>
> import java.io.IOException;
>
> import org.apache.lucene.index.CorruptIndexException;
> import org.apache.lucene.index.IndexReader;
>
>
> public class Test {
>
> =A0 =A0 =A0 =A0private IndexReader r;
> =A0 =A0 =A0 =A0private int noSearches =3D 0;
>
> =A0 =A0 =A0 =A0public static void main(String[] args)
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running Single =
TermQuery Search");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Test t =3D new Test(args[0]);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(1, true);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running Single =
MatchAllDocs=20
> Search");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(1, =
false);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running two =
concurrent TermQuery=20
> Searches");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(2, true);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running two =
concurrent MatchAllDocs=20
> Searches");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(2, =
false);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0public Test(String index)
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0r =3D =
IndexReader.open(index);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (CorruptIndexException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0public void runSearches(int no, boolean termSearches) =
throws=20
> Exception
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0noSearches =3D no;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0for (int i =3D 0; i < no; i++)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread t1 =3D new =
Thread(new TestThread(r, i,=20
> this, termSearches));
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t1.start();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0public void callback()
> =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0noSearches--;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (noSearches =3D=3D 0)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0r.close();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) =
{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO =
Auto-generated catch block
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0e.printStackTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
>
> }
>
>
>
> This message should be regarded as confidential. If you have received =
this email in error please notify the sender and destroy it immediately.
> Statements of intent shall only become binding when confirmed in hard =
copy by an authorised signatory. =A0The contents of this email may =
relate to dealings with other companies within the Detica Limited group =
of companies.
>
> Detica Limited is registered in England under No: 1337451.
>
> Registered offices: Surrey Research Park, Guildford, Surrey, GU2 7YP, =
England.
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41744-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 12:52:18 2009
Return-Path: <java-user-return-41744-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46873 invoked from network); 6 Aug 2009 12:52:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 12:52:18 -0000
Received: (qmail 77388 invoked by uid 500); 6 Aug 2009 12:52:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77317 invoked by uid 500); 6 Aug 2009 12:52:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77307 invoked by uid 99); 6 Aug 2009 12:52:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 12:52:23 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 12:52:13 +0000
Received: by ywh26 with SMTP id 26so1145994ywh.5
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 05:51:51 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.157.11 with SMTP id f11mr17826342ybe.267.1249563111062; 
	Thu, 06 Aug 2009 05:51:51 -0700 (PDT)
In-Reply-To: <8163028120305742991D2FB7F19412AB635394@uksrpblkexb01.detica.com>
References: <9ac0c6aa0908060525k3301c663t8de3204c616f7ab9@mail.gmail.com>
	 <8163028120305742991D2FB7F19412AB635394@uksrpblkexb01.detica.com>
Date: Thu, 6 Aug 2009 08:51:51 -0400
Message-ID: <9ac0c6aa0908060551i2add2d25j15047a38fc93ed90@mail.gmail.com>
Subject: Re: MatchAllDocsQuery concurrency issue
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Opening your IndexReader with readOnly=3Dtrue should also fix it, I think.

Mike

On Thu, Aug 6, 2009 at 8:41 AM, Carl Austin<Carl.austin@detica.com> wrote:
> Thanks Mike,
>
> Running this with the 2.9 build does resolve the issue it would seem.
>
> Unfortunately I can't move to 2.9, especially as it isn't in release yet.=
 Is there a work-around for 2.4 known that will allow me to get around this=
 issue as I notice the patches change some underlying classes such as Multi=
SegmentReader? What I am doing does regularly have the chance to call this =
query concurrently multiple times, which cause quite an issue.
>
> Thanks
>
> Carl
>
> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: 06 August 2009 13:26
> To: java-user@lucene.apache.org
> Subject: Re: MatchAllDocsQuery concurrency issue
>
> Most likely you're hitting this issue:
>
> =A0 =A0https://issues.apache.org/jira/browse/LUCENE-1316
>
> Which is fixed in 2.9. =A0Can you try running with 2.9 to confirm?
>
> Mike
>
> On Thu, Aug 6, 2009 at 8:19 AM, Carl Austin<Carl.austin@detica.com> wrote=
:
>> Hi,
>>
>> I have been seeing an issue running MatchAllDocsQueries concurrently.
>> Running one against a test index is very fast (70 ms). Running two
>> concurrently can take 5-25 seconds on the same test index! This issue
>> doesn't occur with any other type of query I have used.
>> Because of this, I have put together a few test classes to demonstrate
>> this in a simple manner. These recreate the issue with only the most
>> basic Lucene api usage.
>>
>> I have incldued the code for the classes below in this email. Just run
>> TestIndexCreator with a single argument of where to create the test
>> index. This will create an index with 999999 documents in, each
>> document having only 1 field with the value "testing" in that field.
>> Only one unique term for the whole index.
>> Then run the class Test with the same argument as the index creator.
>> This will run a 4 tests with a 5 second wait between each. The first
>> runs a single term query for "testing". The second a single match all
>> docs query. The third 2 concurrent term queries and the fourth 2
>> concurrent match all docs queries. It is the fourth that takes a
>> relatively long time to complete.
>> On a larger index I have here it can take 8 minutes to run just 2
>> match all docs queries concurrently.
>>
>> I look forward to hearing further on this. I can provide this in Jar
>> for if wished, though I don't know if you can attach to these emails.
>>
>> Thanks
>>
>> Carl
>>
>>
>> Source Code:
>>
>> import org.apache.lucene.analysis.KeywordAnalyzer;
>> import org.apache.lucene.document.Document;
>> import org.apache.lucene.document.Field; import
>> org.apache.lucene.document.Field.Index;
>> import org.apache.lucene.document.Field.Store;
>> import org.apache.lucene.index.IndexReader;
>> import org.apache.lucene.index.IndexWriter;
>>
>>
>> public class TestIndexCreator {
>>
>>
>> =A0 =A0 =A0 =A0public static void main(String[] args) throws Exception
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (!IndexReader.indexExists(args[0]))
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexWriter w =3D new Ind=
exWriter(args[0], new
>> KeywordAnalyzer(), true);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0for(int i =3D0; i < 10000=
00; i++)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Document =
doc =3D new Document();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0doc.add(n=
ew Field("testfield",
>> "testing", Store.YES, Index.ANALYZED));
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0w.addDocu=
ment(doc);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (i % 1=
0000 =3D=3D 0)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0System.out.println(i);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0w.optimize();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0w.close();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0}
>>
>> }
>>
>> import java.io.IOException;
>>
>> import org.apache.lucene.index.IndexReader;
>> import org.apache.lucene.index.Term;
>> import org.apache.lucene.search.IndexSearcher;
>> import org.apache.lucene.search.MatchAllDocsQuery;
>> import org.apache.lucene.search.Query; import
>> org.apache.lucene.search.TermQuery;
>> import org.apache.lucene.search.TopDocCollector;
>>
>> =A0 =A0 =A0 =A0class TestThread implements Runnable
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private IndexReader r;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private int x;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private Test callback;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private boolean termSearches;
>>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public TestThread(IndexReader r, int x, T=
est callback,
>> boolean termSearches)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.r =3D r;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.x =3D x;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.callback =3D callbac=
k;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.termSearches =3D ter=
mSearches;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public void run() {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0long time =3D System.curr=
entTimeMillis();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Threa=
d " + x + " start");
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexSearcher s =3D new I=
ndexSearcher(r);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Query q =3D null;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (termSearches)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0q =3D new=
 TermQuery(new Term("testfield",
>> "testing"));
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0else
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0q =3D new=
 MatchAllDocsQuery();
>>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0TopDocCollector col =3D n=
ew TopDocCollector(50);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0s.search(=
q, col);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printSt=
ackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Time =
taken for " + x + " =3D "
>> + (System.currentTimeMillis() - time));
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0callback.callback();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0}
>>
>> import java.io.IOException;
>>
>> import org.apache.lucene.index.CorruptIndexException;
>> import org.apache.lucene.index.IndexReader;
>>
>>
>> public class Test {
>>
>> =A0 =A0 =A0 =A0private IndexReader r;
>> =A0 =A0 =A0 =A0private int noSearches =3D 0;
>>
>> =A0 =A0 =A0 =A0public static void main(String[] args)
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running Single TermQu=
ery Search");
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Test t =3D new Test(args[0]);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(1, true);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated ca=
tch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated ca=
tch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running Single MatchA=
llDocs
>> Search");
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(1, false);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated ca=
tch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated ca=
tch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running two concurren=
t TermQuery
>> Searches");
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(2, true);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated ca=
tch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated ca=
tch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running two concurren=
t MatchAllDocs
>> Searches");
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(2, false);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated ca=
tch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0public Test(String index)
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0r =3D IndexReader.open(in=
dex);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (CorruptIndexException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated ca=
tch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated ca=
tch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0public void runSearches(int no, boolean termSearches) thr=
ows
>> Exception
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0noSearches =3D no;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0for (int i =3D 0; i < no; i++)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread t1 =3D new Thread(=
new TestThread(r, i,
>> this, termSearches));
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t1.start();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0public void callback()
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0noSearches--;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (noSearches =3D=3D 0)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0r.close()=
;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO A=
uto-generated catch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printSt=
ackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0}
>>
>> }
>>
>>
>>
>> This message should be regarded as confidential. If you have received th=
is email in error please notify the sender and destroy it immediately.
>> Statements of intent shall only become binding when confirmed in hard co=
py by an authorised signatory. =A0The contents of this email may relate to =
dealings with other companies within the Detica Limited group of companies.
>>
>> Detica Limited is registered in England under No: 1337451.
>>
>> Registered offices: Surrey Research Park, Guildford, Surrey, GU2 7YP, En=
gland.
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41745-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 13:07:25 2009
Return-Path: <java-user-return-41745-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50675 invoked from network); 6 Aug 2009 13:07:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 13:07:25 -0000
Received: (qmail 85472 invoked by uid 500); 6 Aug 2009 13:06:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85198 invoked by uid 500); 6 Aug 2009 13:06:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84503 invoked by uid 99); 6 Aug 2009 13:04:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 13:04:39 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of peterlkeegan@gmail.com designates 74.125.78.25 as permitted sender)
Received: from [74.125.78.25] (HELO ey-out-2122.google.com) (74.125.78.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 13:04:29 +0000
Received: by ey-out-2122.google.com with SMTP id 9so333662eyd.53
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 06:04:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=8ah1s4sWCj4M0aAA3TwL8yLLrPuLmvUJZjg4HT/d+y8=;
        b=UyPTRDjdXYfspp0UHHSX5E1Li+avfEZe/P43XmcM/Ixw+aslnswfjKtDwyIZTFp6uY
         dDZwb2jeYlNuTKDqNXz8d1TYzmPdeY5JQk1Y1hJe9KZpqrUlWHdEHNE4ZbOAs3C1ffOt
         nwmFE6aM4rwLGH1jivICXeZqgSnun1PxHj8Hg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=pnSAhH31k/539YEPGfTnCRFdkTzuF4Js+sK1Y5gxi2eYjQBcHKHebHzNmX2FVTEIRj
         rQ3R6gY1YBXfUmA9zH+A7E9ghJSFY70rzHZK1hDjIdDL7DhaX0MQ7K6ETHakYegKZDPO
         5g4zmqH/5nnYgUPDHoW8lg1IIEkvp1wKLqtpY=
MIME-Version: 1.0
Received: by 10.211.179.6 with SMTP id g6mr9745292ebp.49.1249563849003; Thu, 
	06 Aug 2009 06:04:09 -0700 (PDT)
In-Reply-To: <9ac0c6aa0908060551i2add2d25j15047a38fc93ed90@mail.gmail.com>
References: <9ac0c6aa0908060525k3301c663t8de3204c616f7ab9@mail.gmail.com>
	 <8163028120305742991D2FB7F19412AB635394@uksrpblkexb01.detica.com>
	 <9ac0c6aa0908060551i2add2d25j15047a38fc93ed90@mail.gmail.com>
Date: Thu, 6 Aug 2009 09:04:08 -0400
Message-ID: <e994873a0908060604j5cc5e8e8v136eb45020577ef7@mail.gmail.com>
Subject: Re: MatchAllDocsQuery concurrency issue
From: Peter Keegan <peterlkeegan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c1dc85813d6047078c12a
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c1dc85813d6047078c12a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Or you could try this patch:
*LUCENE-1316<https://issues.apache.org/jira/browse/LUCENE-1316>
*
Peter*

*
On Thu, Aug 6, 2009 at 8:51 AM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> Opening your IndexReader with readOnly=true should also fix it, I think.
>
> Mike
>
> On Thu, Aug 6, 2009 at 8:41 AM, Carl Austin<Carl.austin@detica.com> wrote:
> > Thanks Mike,
> >
> > Running this with the 2.9 build does resolve the issue it would seem.
> >
> > Unfortunately I can't move to 2.9, especially as it isn't in release yet.
> Is there a work-around for 2.4 known that will allow me to get around this
> issue as I notice the patches change some underlying classes such as
> MultiSegmentReader? What I am doing does regularly have the chance to call
> this query concurrently multiple times, which cause quite an issue.
> >
> > Thanks
> >
> > Carl
> >
> > -----Original Message-----
> > From: Michael McCandless [mailto:lucene@mikemccandless.com]
> > Sent: 06 August 2009 13:26
> > To: java-user@lucene.apache.org
> > Subject: Re: MatchAllDocsQuery concurrency issue
> >
> > Most likely you're hitting this issue:
> >
> >    https://issues.apache.org/jira/browse/LUCENE-1316
> >
> > Which is fixed in 2.9.  Can you try running with 2.9 to confirm?
> >
> > Mike
> >
> > On Thu, Aug 6, 2009 at 8:19 AM, Carl Austin<Carl.austin@detica.com>
> wrote:
> >> Hi,
> >>
> >> I have been seeing an issue running MatchAllDocsQueries concurrently.
> >> Running one against a test index is very fast (70 ms). Running two
> >> concurrently can take 5-25 seconds on the same test index! This issue
> >> doesn't occur with any other type of query I have used.
> >> Because of this, I have put together a few test classes to demonstrate
> >> this in a simple manner. These recreate the issue with only the most
> >> basic Lucene api usage.
> >>
> >> I have incldued the code for the classes below in this email. Just run
> >> TestIndexCreator with a single argument of where to create the test
> >> index. This will create an index with 999999 documents in, each
> >> document having only 1 field with the value "testing" in that field.
> >> Only one unique term for the whole index.
> >> Then run the class Test with the same argument as the index creator.
> >> This will run a 4 tests with a 5 second wait between each. The first
> >> runs a single term query for "testing". The second a single match all
> >> docs query. The third 2 concurrent term queries and the fourth 2
> >> concurrent match all docs queries. It is the fourth that takes a
> >> relatively long time to complete.
> >> On a larger index I have here it can take 8 minutes to run just 2
> >> match all docs queries concurrently.
> >>
> >> I look forward to hearing further on this. I can provide this in Jar
> >> for if wished, though I don't know if you can attach to these emails.
> >>
> >> Thanks
> >>
> >> Carl
> >>
> >>
> >> Source Code:
> >>
> >> import org.apache.lucene.analysis.KeywordAnalyzer;
> >> import org.apache.lucene.document.Document;
> >> import org.apache.lucene.document.Field; import
> >> org.apache.lucene.document.Field.Index;
> >> import org.apache.lucene.document.Field.Store;
> >> import org.apache.lucene.index.IndexReader;
> >> import org.apache.lucene.index.IndexWriter;
> >>
> >>
> >> public class TestIndexCreator {
> >>
> >>
> >>        public static void main(String[] args) throws Exception
> >>        {
> >>                if (!IndexReader.indexExists(args[0]))
> >>                {
> >>                        IndexWriter w = new IndexWriter(args[0], new
> >> KeywordAnalyzer(), true);
> >>                        for(int i =0; i < 1000000; i++)
> >>                        {
> >>                                Document doc = new Document();
> >>                                doc.add(new Field("testfield",
> >> "testing", Store.YES, Index.ANALYZED));
> >>                                w.addDocument(doc);
> >>                                if (i % 10000 == 0)
> >>                                {
> >>                                        System.out.println(i);
> >>                                }
> >>                        }
> >>                        w.optimize();
> >>                        w.close();
> >>                }
> >>        }
> >>
> >> }
> >>
> >> import java.io.IOException;
> >>
> >> import org.apache.lucene.index.IndexReader;
> >> import org.apache.lucene.index.Term;
> >> import org.apache.lucene.search.IndexSearcher;
> >> import org.apache.lucene.search.MatchAllDocsQuery;
> >> import org.apache.lucene.search.Query; import
> >> org.apache.lucene.search.TermQuery;
> >> import org.apache.lucene.search.TopDocCollector;
> >>
> >>        class TestThread implements Runnable
> >>        {
> >>                private IndexReader r;
> >>                private int x;
> >>                private Test callback;
> >>                private boolean termSearches;
> >>
> >>                public TestThread(IndexReader r, int x, Test callback,
> >> boolean termSearches)
> >>                {
> >>                        this.r = r;
> >>                        this.x = x;
> >>                        this.callback = callback;
> >>                        this.termSearches = termSearches;
> >>                }
> >>
> >>                public void run() {
> >>                        long time = System.currentTimeMillis();
> >>                        System.out.println("Thread " + x + " start");
> >>                        IndexSearcher s = new IndexSearcher(r);
> >>                        Query q = null;
> >>                        if (termSearches)
> >>                        {
> >>                                q = new TermQuery(new Term("testfield",
> >> "testing"));
> >>                        }
> >>                        else
> >>                        {
> >>                                q = new MatchAllDocsQuery();
> >>
> >>                        }
> >>                        TopDocCollector col = new TopDocCollector(50);
> >>                        try {
> >>                                s.search(q, col);
> >>                        } catch (IOException e) {
> >>                                e.printStackTrace();
> >>                        }
> >>                        System.out.println("Time taken for " + x + " = "
> >> + (System.currentTimeMillis() - time));
> >>                        callback.callback();
> >>                }
> >>
> >>        }
> >>
> >> import java.io.IOException;
> >>
> >> import org.apache.lucene.index.CorruptIndexException;
> >> import org.apache.lucene.index.IndexReader;
> >>
> >>
> >> public class Test {
> >>
> >>        private IndexReader r;
> >>        private int noSearches = 0;
> >>
> >>        public static void main(String[] args)
> >>        {
> >>                System.out.println("Running Single TermQuery Search");
> >>                Test t = new Test(args[0]);
> >>                try {
> >>                        t.runSearches(1, true);
> >>                } catch (Exception e) {
> >>                        // TODO Auto-generated catch block
> >>                        e.printStackTrace();
> >>                }
> >>                try {
> >>                        Thread.sleep(5000);
> >>                } catch (InterruptedException e1) {
> >>                        // TODO Auto-generated catch block
> >>                        e1.printStackTrace();
> >>                }
> >>                System.out.println("Running Single MatchAllDocs
> >> Search");
> >>                t = new Test(args[0]);
> >>                try {
> >>                        t.runSearches(1, false);
> >>                } catch (Exception e) {
> >>                        // TODO Auto-generated catch block
> >>                        e.printStackTrace();
> >>                }
> >>                try {
> >>                        Thread.sleep(5000);
> >>                } catch (InterruptedException e1) {
> >>                        // TODO Auto-generated catch block
> >>                        e1.printStackTrace();
> >>                }
> >>                System.out.println("Running two concurrent TermQuery
> >> Searches");
> >>                t = new Test(args[0]);
> >>                try {
> >>                        t.runSearches(2, true);
> >>                } catch (Exception e) {
> >>                        // TODO Auto-generated catch block
> >>                        e.printStackTrace();
> >>                }
> >>                try {
> >>                        Thread.sleep(5000);
> >>                } catch (InterruptedException e1) {
> >>                        // TODO Auto-generated catch block
> >>                        e1.printStackTrace();
> >>                }
> >>                System.out.println("Running two concurrent MatchAllDocs
> >> Searches");
> >>                t = new Test(args[0]);
> >>                try {
> >>                        t.runSearches(2, false);
> >>                } catch (Exception e) {
> >>                        // TODO Auto-generated catch block
> >>                        e.printStackTrace();
> >>                }
> >>
> >>        }
> >>
> >>        public Test(String index)
> >>        {
> >>                try {
> >>                        r = IndexReader.open(index);
> >>                } catch (CorruptIndexException e) {
> >>                        // TODO Auto-generated catch block
> >>                        e.printStackTrace();
> >>                } catch (IOException e) {
> >>                        // TODO Auto-generated catch block
> >>                        e.printStackTrace();
> >>                }
> >>        }
> >>
> >>        public void runSearches(int no, boolean termSearches) throws
> >> Exception
> >>        {
> >>                noSearches = no;
> >>                for (int i = 0; i < no; i++)
> >>                {
> >>                        Thread t1 = new Thread(new TestThread(r, i,
> >> this, termSearches));
> >>                        t1.start();
> >>                }
> >>        }
> >>
> >>        public void callback()
> >>        {
> >>                noSearches--;
> >>                if (noSearches == 0)
> >>                {
> >>                        try {
> >>                                r.close();
> >>                        } catch (IOException e) {
> >>                                // TODO Auto-generated catch block
> >>                                e.printStackTrace();
> >>                        }
> >>                }
> >>        }
> >>
> >> }
> >>
> >>
> >>
> >> This message should be regarded as confidential. If you have received
> this email in error please notify the sender and destroy it immediately.
> >> Statements of intent shall only become binding when confirmed in hard
> copy by an authorised signatory.  The contents of this email may relate to
> dealings with other companies within the Detica Limited group of companies.
> >>
> >> Detica Limited is registered in England under No: 1337451.
> >>
> >> Registered offices: Surrey Research Park, Guildford, Surrey, GU2 7YP,
> England.
> >>
> >>
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174c1dc85813d6047078c12a--

From java-user-return-41746-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 13:09:55 2009
Return-Path: <java-user-return-41746-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52375 invoked from network); 6 Aug 2009 13:09:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 13:09:55 -0000
Received: (qmail 25556 invoked by uid 500); 6 Aug 2009 13:09:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25516 invoked by uid 500); 6 Aug 2009 13:09:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25506 invoked by uid 99); 6 Aug 2009 13:09:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 13:09:58 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [207.126.144.143] (HELO eu1sys200aog117.obsmtp.com) (207.126.144.143)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 06 Aug 2009 13:09:49 +0000
Received: from source ([193.36.230.160]) by eu1sys200aob117.postini.com ([207.126.147.11]) with SMTP
	ID DSNKSnrWBu0XBXq6hlIS1qM6h+W6VUg6D+2x@postini.com; Thu, 06 Aug 2009 13:09:28 UTC
Received: from blackex04.detica.com (unverified) by mail01.detica.com
 (Content Technologies SMTPRS 4.3.19) with ESMTP id <T8ffc73b9da0a09010a7cc@mail01.detica.com> for <java-user@lucene.apache.org>;
 Thu, 6 Aug 2009 14:09:25 +0100
Received: from uksrpblkexb01.detica.com ([10.1.1.38]) by blackex04.detica.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 6 Aug 2009 14:09:25 +0100
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: MatchAllDocsQuery concurrency issue
Date: Thu, 6 Aug 2009 14:08:30 +0100
Message-ID: <8163028120305742991D2FB7F19412AB6353AF@uksrpblkexb01.detica.com>
In-Reply-To: <9ac0c6aa0908060551i2add2d25j15047a38fc93ed90@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: MatchAllDocsQuery concurrency issue
Thread-Index: AcoWlMCfJIdQybEySw2/rZbfhrPMnwAAhQ7g
From: "Carl Austin" <Carl.austin@detica.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 06 Aug 2009 13:09:25.0478 (UTC) FILETIME=[1F516060:01CA1697]
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks for the quick responses Mike.

I have changed our readers to read only, and that works nicely. I =
perfered that to patching the lucene we have been using and testing with =
for some time.

Thanks again for the help.

Carl

-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: 06 August 2009 13:52
To: java-user@lucene.apache.org
Subject: Re: MatchAllDocsQuery concurrency issue

Opening your IndexReader with readOnly=3Dtrue should also fix it, I =
think.

Mike

On Thu, Aug 6, 2009 at 8:41 AM, Carl Austin<Carl.austin@detica.com> =
wrote:
> Thanks Mike,
>
> Running this with the 2.9 build does resolve the issue it would seem.
>
> Unfortunately I can't move to 2.9, especially as it isn't in release =
yet. Is there a work-around for 2.4 known that will allow me to get =
around this issue as I notice the patches change some underlying classes =
such as MultiSegmentReader? What I am doing does regularly have the =
chance to call this query concurrently multiple times, which cause quite =
an issue.
>
> Thanks
>
> Carl
>
> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: 06 August 2009 13:26
> To: java-user@lucene.apache.org
> Subject: Re: MatchAllDocsQuery concurrency issue
>
> Most likely you're hitting this issue:
>
> =A0 =A0https://issues.apache.org/jira/browse/LUCENE-1316
>
> Which is fixed in 2.9. =A0Can you try running with 2.9 to confirm?
>
> Mike
>
> On Thu, Aug 6, 2009 at 8:19 AM, Carl Austin<Carl.austin@detica.com> =
wrote:
>> Hi,
>>
>> I have been seeing an issue running MatchAllDocsQueries concurrently.
>> Running one against a test index is very fast (70 ms). Running two=20
>> concurrently can take 5-25 seconds on the same test index! This issue =

>> doesn't occur with any other type of query I have used.
>> Because of this, I have put together a few test classes to=20
>> demonstrate this in a simple manner. These recreate the issue with=20
>> only the most basic Lucene api usage.
>>
>> I have incldued the code for the classes below in this email. Just=20
>> run TestIndexCreator with a single argument of where to create the=20
>> test index. This will create an index with 999999 documents in, each=20
>> document having only 1 field with the value "testing" in that field.
>> Only one unique term for the whole index.
>> Then run the class Test with the same argument as the index creator.
>> This will run a 4 tests with a 5 second wait between each. The first=20
>> runs a single term query for "testing". The second a single match all =

>> docs query. The third 2 concurrent term queries and the fourth 2=20
>> concurrent match all docs queries. It is the fourth that takes a=20
>> relatively long time to complete.
>> On a larger index I have here it can take 8 minutes to run just 2=20
>> match all docs queries concurrently.
>>
>> I look forward to hearing further on this. I can provide this in Jar=20
>> for if wished, though I don't know if you can attach to these emails.
>>
>> Thanks
>>
>> Carl
>>
>>
>> Source Code:
>>
>> import org.apache.lucene.analysis.KeywordAnalyzer;
>> import org.apache.lucene.document.Document;
>> import org.apache.lucene.document.Field; import=20
>> org.apache.lucene.document.Field.Index;
>> import org.apache.lucene.document.Field.Store;
>> import org.apache.lucene.index.IndexReader;
>> import org.apache.lucene.index.IndexWriter;
>>
>>
>> public class TestIndexCreator {
>>
>>
>> =A0 =A0 =A0 =A0public static void main(String[] args) throws =
Exception
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (!IndexReader.indexExists(args[0]))
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexWriter w =3D new =
IndexWriter(args[0], new=20
>> KeywordAnalyzer(), true);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0for(int i =3D0; i < =
1000000; i++)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0Document doc =3D new Document();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0doc.add(new Field("testfield",=20
>> "testing", Store.YES, Index.ANALYZED));
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0w.addDocument(doc);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (i =
% 10000 =3D=3D 0)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0System.out.println(i);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0w.optimize();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0w.close();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0}
>>
>> }
>>
>> import java.io.IOException;
>>
>> import org.apache.lucene.index.IndexReader;
>> import org.apache.lucene.index.Term;
>> import org.apache.lucene.search.IndexSearcher;
>> import org.apache.lucene.search.MatchAllDocsQuery;
>> import org.apache.lucene.search.Query; import=20
>> org.apache.lucene.search.TermQuery;
>> import org.apache.lucene.search.TopDocCollector;
>>
>> =A0 =A0 =A0 =A0class TestThread implements Runnable
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private IndexReader r;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private int x;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private Test callback;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0private boolean termSearches;
>>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public TestThread(IndexReader r, int =
x, Test callback,=20
>> boolean termSearches)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.r =3D r;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.x =3D x;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.callback =3D =
callback;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0this.termSearches =3D =
termSearches;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public void run() {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0long time =3D =
System.currentTimeMillis();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0System.out.println("Thread " + x + " start");
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexSearcher s =3D =
new IndexSearcher(r);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Query q =3D null;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (termSearches)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0q =3D =
new TermQuery(new=20
>> Term("testfield", "testing"));
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0else
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0q =3D =
new MatchAllDocsQuery();
>>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0TopDocCollector col =
=3D new TopDocCollector(50);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0s.search(q, col);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException =
e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0System.out.println("Time taken for " + x + " =3D "
>> + (System.currentTimeMillis() - time));
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0callback.callback();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0}
>>
>> import java.io.IOException;
>>
>> import org.apache.lucene.index.CorruptIndexException;
>> import org.apache.lucene.index.IndexReader;
>>
>>
>> public class Test {
>>
>> =A0 =A0 =A0 =A0private IndexReader r;
>> =A0 =A0 =A0 =A0private int noSearches =3D 0;
>>
>> =A0 =A0 =A0 =A0public static void main(String[] args)
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running Single =
TermQuery Search");
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Test t =3D new Test(args[0]);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(1, =
true);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running Single =
MatchAllDocs=20
>> Search");
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(1, =
false);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running two =
concurrent TermQuery=20
>> Searches");
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(2, =
true);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread.sleep(5000);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (InterruptedException e1) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e1.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Running two =
concurrent=20
>> MatchAllDocs Searches");
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t =3D new Test(args[0]);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t.runSearches(2, =
false);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Exception e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0public Test(String index)
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0r =3D =
IndexReader.open(index);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (CorruptIndexException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// TODO Auto-generated =
catch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0public void runSearches(int no, boolean termSearches) =
throws=20
>> Exception
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0noSearches =3D no;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0for (int i =3D 0; i < no; i++)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Thread t1 =3D new =
Thread(new TestThread(r, i,=20
>> this, termSearches));
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0t1.start();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0public void callback()
>> =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0noSearches--;
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (noSearches =3D=3D 0)
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0r.close();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException =
e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// =
TODO Auto-generated catch block
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0e.printStackTrace();
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> =A0 =A0 =A0 =A0}
>>
>> }
>>
>>
>>
>> This message should be regarded as confidential. If you have received =
this email in error please notify the sender and destroy it immediately.
>> Statements of intent shall only become binding when confirmed in hard =
copy by an authorised signatory. =A0The contents of this email may =
relate to dealings with other companies within the Detica Limited group =
of companies.
>>
>> Detica Limited is registered in England under No: 1337451.
>>
>> Registered offices: Surrey Research Park, Guildford, Surrey, GU2 7YP, =
England.
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41747-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 14:03:58 2009
Return-Path: <java-user-return-41747-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86265 invoked from network); 6 Aug 2009 14:03:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 14:03:58 -0000
Received: (qmail 34431 invoked by uid 500); 6 Aug 2009 14:04:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34354 invoked by uid 500); 6 Aug 2009 14:04:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34344 invoked by uid 99); 6 Aug 2009 14:04:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 14:04:03 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.27 as permitted sender)
Received: from [66.111.4.27] (HELO out3.smtp.messagingengine.com) (66.111.4.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 14:03:52 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id D6409F68
	for <java-user@lucene.apache.org>; Thu,  6 Aug 2009 10:03:31 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute1.internal (MEProxy); Thu, 06 Aug 2009 10:03:31 -0400
X-Sasl-enc: cVrorlGwgib4EDAuD7TgQuKhx29UBjScy7he9igHVSwW 1249567411
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 3228834F4
	for <java-user@lucene.apache.org>; Thu,  6 Aug 2009 10:03:31 -0400 (EDT)
Message-ID: <4A7AE2B2.8010908@fastmail.fm>
Date: Thu, 06 Aug 2009 15:03:30 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.22 (Macintosh/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: StandardFilter not handling dots as exptected ?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org


Hi want the query "R.E.S" to match "R.E.S"

I use StandardFilter in my analyzer below and the description says:

    'Splits words at punctuation characters, removing punctuation. 
However, a dot that's not followed by whitespace is considered part of a 
token. '

so I thought that R.E.S. would become searchable as R.E.S, and the 
search would work, but it doesn't whereas searching for "R.E.S" does 
return a hit .

thanks Paul

public class StandardUnaccentAnalyzer extends Analyzer {

    public TokenStream tokenStream(String fieldName, Reader reader) {
        StandardTokenizer tokenStream = new StandardTokenizer(reader);
        TokenStream result = new StandardFilter(tokenStream);
        result = new LowerCaseFilter(result);
        return result;
    }
   
    private static final class SavedStreams {
        StandardTokenizer tokenStream;
        TokenStream filteredTokenStream;
    }
   
    public TokenStream reusableTokenStream(String fieldName, Reader 
reader) throws IOException {
        SavedStreams streams = (SavedStreams)getPreviousTokenStream();
        if (streams == null) {
            streams = new SavedStreams();
            setPreviousTokenStream(streams);
            streams.tokenStream = new StandardTokenizer(reader);
            streams.filteredTokenStream = new 
StandardFilter(streams.tokenStream);
            streams.filteredTokenStream = new 
LowerCaseFilter(streams.filteredTokenStream);
        }
        else {
            streams.tokenStream.reset(reader);
        }
        return streams.filteredTokenStream;
    }

}

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41748-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 14:36:48 2009
Return-Path: <java-user-return-41748-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6227 invoked from network); 6 Aug 2009 14:36:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 14:36:46 -0000
Received: (qmail 67034 invoked by uid 500); 6 Aug 2009 14:28:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66998 invoked by uid 500); 6 Aug 2009 14:28:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66964 invoked by uid 99); 6 Aug 2009 14:28:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 14:28:20 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.211.177 as permitted sender)
Received: from [209.85.211.177] (HELO mail-yw0-f177.google.com) (209.85.211.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 14:28:10 +0000
Received: by ywh7 with SMTP id 7so1137010ywh.21
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 07:27:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=B2ZeWI4Uoaz2Db8prnSKKlWmtJB7PyDI4SsOUd1dOHc=;
        b=QecoRJKM/plAAv4c2gKFODLiOOgVOiaZ5gzb7S665CKylEmF0ALdEpnEk/N7muqk6b
         aWFsVUl2Iyc0tksXXYv0Rs3ynij3iHBoUAaf2dkWdJa4xg1AsY3h8xp10NMqFlTpy/Td
         hJvn5vy1dCFE4CQLC6KiCykeMuhBPqcX2rrq4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=sVz4wkuOTMF/q6PGe24lFrZFklWf6WDZq8qkooyDFBsGjapaEJbtg9W3OmKfoAylXx
         TDnzr830sW/VlhlJ4Vh0nn6yCCbP5TSgC7B7Ts1AiIxAJJHF1CT7uU6yuXDMHluBTHOk
         9ccbulOWojoiJij66kxljA8CHZQyrUz20Xw9k=
MIME-Version: 1.0
Received: by 10.231.11.130 with SMTP id t2mr3408547ibt.51.1249568868931; Thu, 
	06 Aug 2009 07:27:48 -0700 (PDT)
In-Reply-To: <4A7AE2B2.8010908@fastmail.fm>
References: <4A7AE2B2.8010908@fastmail.fm>
Date: Thu, 6 Aug 2009 10:27:48 -0400
Message-ID: <359a92830908060727y69100acdy414f6e292dbcb5d4@mail.gmail.com>
Subject: Re: StandardFilter not handling dots as exptected ?
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: multipart/alternative; boundary=000325574c968e1a4f047079ec32
X-Virus-Checked: Checked by ClamAV on apache.org

--000325574c968e1a4f047079ec32
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I don't see anything obvious in the code.
Are you using the same analzer at query time as at index time?
I'd also get a copy of Luke and examine your index to see what
is actually getting put in it, and query.toString might help.

Best
Erick

On Thu, Aug 6, 2009 at 10:03 AM, Paul Taylor <paul_t100@fastmail.fm> wrote:

>
> Hi want the query "R.E.S" to match "R.E.S"
>
> I use StandardFilter in my analyzer below and the description says:
>
>   'Splits words at punctuation characters, removing punctuation. However, a
> dot that's not followed by whitespace is considered part of a token. '
>
> so I thought that R.E.S. would become searchable as R.E.S, and the search
> would work, but it doesn't whereas searching for "R.E.S" does return a hit .
>
> thanks Paul
>
> public class StandardUnaccentAnalyzer extends Analyzer {
>
>   public TokenStream tokenStream(String fieldName, Reader reader) {
>       StandardTokenizer tokenStream = new StandardTokenizer(reader);
>       TokenStream result = new StandardFilter(tokenStream);
>       result = new LowerCaseFilter(result);
>       return result;
>   }
>     private static final class SavedStreams {
>       StandardTokenizer tokenStream;
>       TokenStream filteredTokenStream;
>   }
>     public TokenStream reusableTokenStream(String fieldName, Reader reader)
> throws IOException {
>       SavedStreams streams = (SavedStreams)getPreviousTokenStream();
>       if (streams == null) {
>           streams = new SavedStreams();
>           setPreviousTokenStream(streams);
>           streams.tokenStream = new StandardTokenizer(reader);
>           streams.filteredTokenStream = new
> StandardFilter(streams.tokenStream);
>           streams.filteredTokenStream = new
> LowerCaseFilter(streams.filteredTokenStream);
>       }
>       else {
>           streams.tokenStream.reset(reader);
>       }
>       return streams.filteredTokenStream;
>   }
>
> }
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000325574c968e1a4f047079ec32--

From java-user-return-41749-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 14:46:24 2009
Return-Path: <java-user-return-41749-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13498 invoked from network); 6 Aug 2009 14:46:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 14:46:24 -0000
Received: (qmail 23741 invoked by uid 500); 6 Aug 2009 14:46:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23685 invoked by uid 500); 6 Aug 2009 14:46:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23647 invoked by uid 99); 6 Aug 2009 14:46:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 14:46:29 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.27 as permitted sender)
Received: from [66.111.4.27] (HELO out3.smtp.messagingengine.com) (66.111.4.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 14:46:20 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 50D98209D;
	Thu,  6 Aug 2009 10:45:59 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute2.internal (MEProxy); Thu, 06 Aug 2009 10:45:59 -0400
X-Sasl-enc: J6IMV6NDHDWtkJu+Hxoub3hIcbGH6W73YSUp4IQaZAQ0 1249569958
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 84BD43510;
	Thu,  6 Aug 2009 10:45:58 -0400 (EDT)
Message-ID: <4A7AECA5.5040100@fastmail.fm>
Date: Thu, 06 Aug 2009 15:45:57 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.22 (Macintosh/20090605)
MIME-Version: 1.0
To: Erick Erickson <erickerickson@gmail.com>
CC: java-user@lucene.apache.org
Subject: Re: StandardFilter not handling dots as exptected ?
References: <4A7AE2B2.8010908@fastmail.fm> <359a92830908060727y69100acdy414f6e292dbcb5d4@mail.gmail.com>
In-Reply-To: <359a92830908060727y69100acdy414f6e292dbcb5d4@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Erick Erickson wrote:
> I don't see anything obvious in the code.
>
> Are you using the same analzer at query time as at index time?
Yes, I do I have created a testcase now, that fails


import org.apache.lucene.analysis.Analyzer;
import org.apache.lucene.store.RAMDirectory;
import org.apache.lucene.index.IndexWriter;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.search.IndexSearcher;
import org.apache.lucene.search.Query;
import org.apache.lucene.search.Hits;
import org.apache.lucene.queryParser.QueryParser;
import junit.framework.TestCase;

public class RESTest extends TestCase {
    public void testMatchAcronymns() throws Exception {
        Analyzer analyzer = new StandardUnaccentAnalyzer();
        RAMDirectory dir = new RAMDirectory();
        IndexWriter writer = new IndexWriter(dir, analyzer, true, 
IndexWriter.MaxFieldLength.LIMITED);
        Document doc = new Document();
        doc.add(new Field("name", "R.E.S.", Field.Store.YES, 
Field.Index.ANALYZED));
        writer.addDocument(doc);
        writer.close();

        IndexSearcher searcher = new IndexSearcher(dir);
        Query q = new QueryParser("name", analyzer).parse("R.E.S");
        System.out.println(q.toString());
        Hits hits = searcher.search(q);
        assertEquals(1, hits.length());
    }
}
>
> I'd also get a copy of Luke and examine your index to see what
> is actually getting put in it, and query.toString might help.
>
Query to string returns
name:r.e.s

Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41750-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 14:56:35 2009
Return-Path: <java-user-return-41750-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21759 invoked from network); 6 Aug 2009 14:56:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 14:56:35 -0000
Received: (qmail 38979 invoked by uid 500); 6 Aug 2009 14:56:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38892 invoked by uid 500); 6 Aug 2009 14:56:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38882 invoked by uid 99); 6 Aug 2009 14:56:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 14:56:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 14:56:30 +0000
Received: by fg-out-1718.google.com with SMTP id 22so232725fge.4
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 07:56:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=Q4HuGZBh8ppEvXK/OzF2VRk6/bQaaGgXy5e2MUF1JKI=;
        b=BZVV2l0S81tjsWm18nSHbEN3npSUYhK9yKLGgJSpQRkcoICbT8Lb+Vk0J9AC4Pi/80
         CQkkGSaOocZdczGAonFvPFHVJuL99WpNFDGSljFhUAaYUoIMW2KEBJl2KnDaqM9pYciS
         dCKbx1PWfapr8I5BKspJJHjisRydx2XJdQNkw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=XJtP2gf1r55+pH5iUnTnDCYepyvwq9PUCSiNat4t27zmUYmZGRjyscYlZxbgypoysZ
         +TB6mdTfUW7bYdvJfpAb+3euoRMZZf4ZyYW3VtQcJ2KyqZiPrR2ppdbgVYAudHd81Y6u
         5OPAg59TFoEPb0vwCMMDJlxkZ1Q1Yexkiwkp8=
MIME-Version: 1.0
Received: by 10.86.86.8 with SMTP id j8mr67083fgb.70.1249570570589; Thu, 06 
	Aug 2009 07:56:10 -0700 (PDT)
In-Reply-To: <4A7AECA5.5040100@fastmail.fm>
References: <4A7AE2B2.8010908@fastmail.fm> <359a92830908060727y69100acdy414f6e292dbcb5d4@mail.gmail.com> 
	<4A7AECA5.5040100@fastmail.fm>
From: Ian Lea <ian.lea@gmail.com>
Date: Thu, 6 Aug 2009 15:55:49 +0100
Message-ID: <8c4e68610908060755m60ef6eccg4c4ff7170f8c7a1b@mail.gmail.com>
Subject: Re: StandardFilter not handling dots as exptected ?
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

See https://issues.apache.org/jira/browse/LUCENE-1068 which appears to
be talking about the same sort of thing, and
StandardAnalyzer.setReplaceInvalidAcronym(b).

Quite how you deal with this in your own analyzer is left as an exercise ..=
.


--
Ian.



On Thu, Aug 6, 2009 at 3:45 PM, Paul Taylor<paul_t100@fastmail.fm> wrote:
> Erick Erickson wrote:
>>
>> I don't see anything obvious in the code.
>>
>> Are you using the same analzer at query time as at index time?
>
> Yes, I do I have created a testcase now, that fails
>
>
> import org.apache.lucene.analysis.Analyzer;
> import org.apache.lucene.store.RAMDirectory;
> import org.apache.lucene.index.IndexWriter;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.search.IndexSearcher;
> import org.apache.lucene.search.Query;
> import org.apache.lucene.search.Hits;
> import org.apache.lucene.queryParser.QueryParser;
> import junit.framework.TestCase;
>
> public class RESTest extends TestCase {
> =A0 public void testMatchAcronymns() throws Exception {
> =A0 =A0 =A0 Analyzer analyzer =3D new StandardUnaccentAnalyzer();
> =A0 =A0 =A0 RAMDirectory dir =3D new RAMDirectory();
> =A0 =A0 =A0 IndexWriter writer =3D new IndexWriter(dir, analyzer, true,
> IndexWriter.MaxFieldLength.LIMITED);
> =A0 =A0 =A0 Document doc =3D new Document();
> =A0 =A0 =A0 doc.add(new Field("name", "R.E.S.", Field.Store.YES,
> Field.Index.ANALYZED));
> =A0 =A0 =A0 writer.addDocument(doc);
> =A0 =A0 =A0 writer.close();
>
> =A0 =A0 =A0 IndexSearcher searcher =3D new IndexSearcher(dir);
> =A0 =A0 =A0 Query q =3D new QueryParser("name", analyzer).parse("R.E.S");
> =A0 =A0 =A0 System.out.println(q.toString());
> =A0 =A0 =A0 Hits hits =3D searcher.search(q);
> =A0 =A0 =A0 assertEquals(1, hits.length());
> =A0 }
> }
>>
>> I'd also get a copy of Luke and examine your index to see what
>> is actually getting put in it, and query.toString might help.
>>
> Query to string returns
> name:r.e.s
>
> Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41751-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 15:12:03 2009
Return-Path: <java-user-return-41751-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24745 invoked from network); 6 Aug 2009 15:12:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 15:12:03 -0000
Received: (qmail 45226 invoked by uid 500); 6 Aug 2009 14:57:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45204 invoked by uid 500); 6 Aug 2009 14:57:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45194 invoked by uid 99); 6 Aug 2009 14:57:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 14:57:49 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 74.125.78.27 as permitted sender)
Received: from [74.125.78.27] (HELO ey-out-2122.google.com) (74.125.78.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 14:57:41 +0000
Received: by ey-out-2122.google.com with SMTP id 9so353322eyd.53
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 07:57:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=1sReSE2mPYTCBMwv/B6LS4BpkhcoU5lQjjBBzrPWR44=;
        b=EKzwvdeB+n9yTBQBsq7gm1+DTZyuh8zUBKQ1r78ZvuyxM0J9rDpfIJo9rk5BCDILb+
         pp3IUKTyrihlukGjT0cr7gNRqEJ8t5d9TXzuGgXOlxNc2/eKYfo85VZ42fCvUARPNvjI
         FP+o6jjgX9CdolcZsDvmJT595tXC4HCJ+KkbI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=M8i0rw+T2Yu5rhbaNWFNn49aN7K3rpuPP1QOSV+2xFT7UB295fwPtkVjrYFWqlzxzZ
         qFN3Kbggr7JOejYq7V8XrgxpA0xXYwbMvr5S4FfmG8aXXRR0FiqLTj9FWUyVvSAPEK0h
         RmF3KTTwpi11lAIFb5tOqxCLEQwQ675MW/7Wk=
MIME-Version: 1.0
Received: by 10.216.13.194 with SMTP id b44mr2013938web.139.1249570639870; 
	Thu, 06 Aug 2009 07:57:19 -0700 (PDT)
In-Reply-To: <4A7AECA5.5040100@fastmail.fm>
References: <4A7AE2B2.8010908@fastmail.fm>
	 <359a92830908060727y69100acdy414f6e292dbcb5d4@mail.gmail.com>
	 <4A7AECA5.5040100@fastmail.fm>
Date: Thu, 6 Aug 2009 17:57:19 +0300
Message-ID: <786fde50908060757o3ff5b05t16bf7c667d3d91d@mail.gmail.com>
Subject: Re: StandardFilter not handling dots as exptected ?
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: multipart/alternative; boundary=0016e64c1bbe1c7b0404707a5609
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64c1bbe1c7b0404707a5609
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I see you index R.E.S. and search for R.E.S (note the dot that's missing in
the query at the end). Can you try to query w/ the dot?

On Thu, Aug 6, 2009 at 5:45 PM, Paul Taylor <paul_t100@fastmail.fm> wrote:

> Erick Erickson wrote:
>
>> I don't see anything obvious in the code.
>>
>> Are you using the same analzer at query time as at index time?
>>
> Yes, I do I have created a testcase now, that fails
>
>
> import org.apache.lucene.analysis.Analyzer;
> import org.apache.lucene.store.RAMDirectory;
> import org.apache.lucene.index.IndexWriter;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.search.IndexSearcher;
> import org.apache.lucene.search.Query;
> import org.apache.lucene.search.Hits;
> import org.apache.lucene.queryParser.QueryParser;
> import junit.framework.TestCase;
>
> public class RESTest extends TestCase {
>   public void testMatchAcronymns() throws Exception {
>       Analyzer analyzer = new StandardUnaccentAnalyzer();
>       RAMDirectory dir = new RAMDirectory();
>       IndexWriter writer = new IndexWriter(dir, analyzer, true,
> IndexWriter.MaxFieldLength.LIMITED);
>       Document doc = new Document();
>       doc.add(new Field("name", "R.E.S.", Field.Store.YES,
> Field.Index.ANALYZED));
>       writer.addDocument(doc);
>       writer.close();
>
>       IndexSearcher searcher = new IndexSearcher(dir);
>       Query q = new QueryParser("name", analyzer).parse("R.E.S");
>       System.out.println(q.toString());
>       Hits hits = searcher.search(q);
>       assertEquals(1, hits.length());
>   }
> }
>
>>
>> I'd also get a copy of Luke and examine your index to see what
>> is actually getting put in it, and query.toString might help.
>>
>>  Query to string returns
> name:r.e.s
>
> Paul
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64c1bbe1c7b0404707a5609--

From java-user-return-41752-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 15:19:42 2009
Return-Path: <java-user-return-41752-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29068 invoked from network); 6 Aug 2009 15:19:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 15:19:32 -0000
Received: (qmail 48531 invoked by uid 500); 6 Aug 2009 15:12:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47065 invoked by uid 500); 6 Aug 2009 15:12:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46068 invoked by uid 99); 6 Aug 2009 15:02:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 15:02:15 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.29 as permitted sender)
Received: from [66.111.4.29] (HELO out5.smtp.messagingengine.com) (66.111.4.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 15:02:04 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id AE27F1578;
	Thu,  6 Aug 2009 11:01:43 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute2.internal (MEProxy); Thu, 06 Aug 2009 11:01:43 -0400
X-Sasl-enc: 103IkAXVeh4YNgvhh87s3ys9B9bBc/D7WsmoZyHmXiwl 1249570903
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id D27783525;
	Thu,  6 Aug 2009 11:01:42 -0400 (EDT)
Message-ID: <4A7AF056.9060406@fastmail.fm>
Date: Thu, 06 Aug 2009 16:01:42 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.22 (Macintosh/20090605)
MIME-Version: 1.0
To: Shai Erera <serera@gmail.com>
CC: java-user@lucene.apache.org
Subject: Re: StandardFilter not handling dots as exptected ?
References: <4A7AE2B2.8010908@fastmail.fm>	 <359a92830908060727y69100acdy414f6e292dbcb5d4@mail.gmail.com>	 <4A7AECA5.5040100@fastmail.fm> <786fde50908060757o3ff5b05t16bf7c667d3d91d@mail.gmail.com>
In-Reply-To: <786fde50908060757o3ff5b05t16bf7c667d3d91d@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Shai Erera wrote:
> I see you index R.E.S. and search for R.E.S (note the dot that's 
> missing in the query at the end). Can you try to query w/ the dot?
Yes if you search with the dot it works (i mentioned this in the first 
email) so it appears when the field is being indexed its no tremoving 
the last dot.
>
> On Thu, Aug 6, 2009 at 5:45 PM, Paul Taylor <paul_t100@fastmail.fm 
> <mailto:paul_t100@fastmail.fm>> wrote:
>
>     Erick Erickson wrote:
>
>         I don't see anything obvious in the code.
>
>         Are you using the same analzer at query time as at index time?
>
>     Yes, I do I have created a testcase now, that fails
>
>
>     import org.apache.lucene.analysis.Analyzer;
>     import org.apache.lucene.store.RAMDirectory;
>     import org.apache.lucene.index.IndexWriter;
>     import org.apache.lucene.document.Document;
>     import org.apache.lucene.document.Field;
>     import org.apache.lucene.search.IndexSearcher;
>     import org.apache.lucene.search.Query;
>     import org.apache.lucene.search.Hits;
>     import org.apache.lucene.queryParser.QueryParser;
>     import junit.framework.TestCase;
>
>     public class RESTest extends TestCase {
>       public void testMatchAcronymns() throws Exception {
>           Analyzer analyzer = new StandardUnaccentAnalyzer();
>           RAMDirectory dir = new RAMDirectory();
>           IndexWriter writer = new IndexWriter(dir, analyzer, true,
>     IndexWriter.MaxFieldLength.LIMITED);
>           Document doc = new Document();
>           doc.add(new Field("name", "R.E.S.", Field.Store.YES,
>     Field.Index.ANALYZED));
>           writer.addDocument(doc);
>           writer.close();
>
>           IndexSearcher searcher = new IndexSearcher(dir);
>           Query q = new QueryParser("name", analyzer).parse("R.E.S");
>           System.out.println(q.toString());
>           Hits hits = searcher.search(q);
>           assertEquals(1, hits.length());
>
>       }
>     }
>
>
>         I'd also get a copy of Luke and examine your index to see what
>         is actually getting put in it, and query.toString might help.
>
>     Query to string returns
>     name:r.e.s
>
>     Paul
>
>
>     ---------------------------------------------------------------------
>     To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>     <mailto:java-user-unsubscribe@lucene.apache.org>
>     For additional commands, e-mail: java-user-help@lucene.apache.org
>     <mailto:java-user-help@lucene.apache.org>
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41753-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 15:21:17 2009
Return-Path: <java-user-return-41753-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37170 invoked from network); 6 Aug 2009 15:21:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 15:21:17 -0000
Received: (qmail 94750 invoked by uid 500); 6 Aug 2009 15:21:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94710 invoked by uid 500); 6 Aug 2009 15:21:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94699 invoked by uid 99); 6 Aug 2009 15:21:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 15:21:20 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.26 as permitted sender)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 15:21:10 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 9AF8D28F4;
	Thu,  6 Aug 2009 11:20:49 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute1.internal (MEProxy); Thu, 06 Aug 2009 11:20:49 -0400
X-Sasl-enc: 9FEyBoRNxKkEDywXKkLQf7uLgDY/bpvz0Sr4/lw8ALOB 1249572049
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id B2EE53541;
	Thu,  6 Aug 2009 11:20:48 -0400 (EDT)
Message-ID: <4A7AF4CF.8080801@fastmail.fm>
Date: Thu, 06 Aug 2009 16:20:47 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.22 (Macintosh/20090605)
MIME-Version: 1.0
To: Ian Lea <ian.lea@gmail.com>
CC: java-user@lucene.apache.org
Subject: Re: StandardFilter not handling dots as exptected ?
References: <4A7AE2B2.8010908@fastmail.fm> <359a92830908060727y69100acdy414f6e292dbcb5d4@mail.gmail.com> 	<4A7AECA5.5040100@fastmail.fm> <8c4e68610908060755m60ef6eccg4c4ff7170f8c7a1b@mail.gmail.com>
In-Reply-To: <8c4e68610908060755m60ef6eccg4c4ff7170f8c7a1b@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Ian Lea wrote:
> See https://issues.apache.org/jira/browse/LUCENE-1068 which appears to
> be talking about the same sort of thing, and
> StandardAnalyzer.setReplaceInvalidAcronym(b).
>
> Quite how you deal with this in your own analyzer is left as an exercise ...
>   

Yes I think you are right, though dont understand it fully


        TokenStream ts = analyzer.tokenStream("content", new 
StringReader("R.E.S."));
        Token t;
        while ((t = ts.next()) != null) { System.out.println("R.E.S. 
parsed to :"+t); }


        ts = analyzer.tokenStream("content", new StringReader("R.E.S"));
        while ((t = ts.next()) != null) { System.out.println("R.E.S 
parsed to :"+t); }
        }

this code outputs

R.E.S. parsed to :(res,0,6,type=<ACRONYM>)
R.E.S parsed to :(r.e.s,0,5,type=<HOST>)

so from my perspective I cannot see
it thinks R.E.S is a HOST it should be an acronym, but also for the one 
that is an acronym I thought it end up as r.e.s not res

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41754-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 16:20:55 2009
Return-Path: <java-user-return-41754-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69432 invoked from network); 6 Aug 2009 16:20:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 16:20:55 -0000
Received: (qmail 6050 invoked by uid 500); 6 Aug 2009 16:21:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5977 invoked by uid 500); 6 Aug 2009 16:20:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5967 invoked by uid 99); 6 Aug 2009 16:20:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 16:20:59 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.26 as permitted sender)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 16:20:49 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 70C753CF1;
	Thu,  6 Aug 2009 12:20:28 -0400 (EDT)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Thu, 06 Aug 2009 12:20:28 -0400
X-Sasl-enc: 2gFzg3c2Y+/QFEnkFRGX9AJLKMOzKr5aFYzDe2ai6Z9g 1249575628
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id C125C29FD2;
	Thu,  6 Aug 2009 12:20:27 -0400 (EDT)
Message-ID: <4A7B02CA.8070700@fastmail.fm>
Date: Thu, 06 Aug 2009 17:20:26 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.22 (Macintosh/20090605)
MIME-Version: 1.0
To: Lucene Users <java-user@lucene.apache.org>
CC: Shai Erera <serera@gmail.com>
Subject: Re: StandardFilter not handling dots as exptected ?
References: <4A7AE2B2.8010908@fastmail.fm>	 <359a92830908060727y69100acdy414f6e292dbcb5d4@mail.gmail.com>	 <4A7AECA5.5040100@fastmail.fm>	 <786fde50908060757o3ff5b05t16bf7c667d3d91d@mail.gmail.com>	 <4A7AF056.9060406@fastmail.fm> <786fde50908060817j7233796dm87fcb161a370f789@mail.gmail.com>
In-Reply-To: <786fde50908060817j7233796dm87fcb161a370f789@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Shai Erera wrote:
> No actually I think that's how the ACRONYM rule is defined:
> R.E.S. is detected as ACRONYM, and therefore is converted to RES.
> R.E.S is not detected as ACRONYM and therefore remains as R.E.S
> Hence the mismatch.
Hi looking at your suggestion of 
https://issues.apache.org/jira/browse/LUCENE-1068

ACRONYM = {LETTER} "." ({LETTER} ".")+

it demands a trailing dot, perhaps I need this instead

ACRONYM = {LETTER} ("." {LETTER} )+

Paul


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41755-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 19:37:48 2009
Return-Path: <java-user-return-41755-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67617 invoked from network); 6 Aug 2009 19:37:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 19:37:48 -0000
Received: (qmail 85851 invoked by uid 500); 6 Aug 2009 19:37:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85764 invoked by uid 500); 6 Aug 2009 19:37:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85750 invoked by uid 99); 6 Aug 2009 19:37:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 19:37:53 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [132.249.20.114] (HELO postal.sdsc.edu) (132.249.20.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 19:37:42 +0000
Received: from mta.ad.sdsc.edu (mta.ad.sdsc.edu [132.249.69.68])
	by postal.sdsc.edu (8.11.7/8.11.7/server/78) with ESMTP id n76JbKH28512;
	Thu, 6 Aug 2009 12:37:20 -0700 (PDT)
Received: from MBX.ad.sdsc.edu ([fe80::85f9:e068:7dc0:4fe0]) by
 mta.ad.sdsc.edu ([132.249.69.68]) with mapi; Thu, 6 Aug 2009 12:37:15 -0700
From: Christopher Condit <condit@sdsc.edu>
To: "anshumg@gmail.com" <anshumg@gmail.com>,
   "java-user@lucene.apache.org"
	<java-user@lucene.apache.org>
Date: Thu, 6 Aug 2009 12:37:13 -0700
Subject: RE: Analysis Question
Thread-Topic: Analysis Question
Thread-Index: AcoWd/Jf8xEZn/tRRx+9/HRjGqKPWwAVIRAg
Message-ID: <BAFDED91EF7D5A43A30F897D6C94B1283B4D6F4D57@MBX.ad.sdsc.edu>
References: <008201ca0a33$b1f0d240$15d276c0$@com>
	 <BAFDED91EF7D5A43A30F897D6C94B128388101B218@MBX.ad.sdsc.edu>
	 <BAFDED91EF7D5A43A30F897D6C94B1283B4D6F4D26@MBX.ad.sdsc.edu>
 <867513fe0908060225y7fb34e0p86358cd83424cc4c@mail.gmail.com>
In-Reply-To: <867513fe0908060225y7fb34e0p86358cd83424cc4c@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Anshum-
> You might want to look at writing a custom analyzer or something and
> add a
> document boost (while indexing) for documents containing those terms.

Do you know how to access the document from an analyzer? It seems to only h=
ave access to the field...

Thanks,
-Chris


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41756-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 19:46:50 2009
Return-Path: <java-user-return-41756-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69861 invoked from network); 6 Aug 2009 19:46:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 19:46:49 -0000
Received: (qmail 97655 invoked by uid 500); 6 Aug 2009 19:46:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97535 invoked by uid 500); 6 Aug 2009 19:46:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97516 invoked by uid 99); 6 Aug 2009 19:46:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 19:46:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bradfordstephens@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 19:46:42 +0000
Received: by yxe3 with SMTP id 3so1508827yxe.29
        for <multiple recipients>; Thu, 06 Aug 2009 12:46:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=EqlRg7VMYyne/rqPhbcBGthjmr9bVT3HW/YF3MIu0VM=;
        b=OmbguQAKHaQD/A8zGuzznnAcojQzCLcBYJHJjZvRWJh77Kpgk85yiuP54GSvK0fZg5
         YHvifiG/Mqp9QGbsy+8d0LRb8jm+mkpeBcwE5LUkI48NX2dYiPCBSeR/ZSBSMmJC7PnF
         4YCpOw7YulwYo3Suvn1FPjX1du20uI7920JBA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=P3++ZQwvlWisMg8XIP5YWJTCFWF44+BTmL7AZyvqo48v98d8cwwwK0dd4UoG/BgZQd
         VGVsjcg6xIMqPBN+C0RnZ3rJUAAYKgo8oG7gNsp1vD8NEtUyduLgh15GWYxxUhkQar6o
         EFkqEhlT3XXkdSAlONc0pskwkrb9JDjbe6Ddk=
MIME-Version: 1.0
Received: by 10.90.34.10 with SMTP id h10mr174863agh.96.1249587981540; Thu, 06 
	Aug 2009 12:46:21 -0700 (PDT)
Date: Thu, 6 Aug 2009 12:46:21 -0700
Message-ID: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
Subject: Language Detection for Analysis?
From: Bradford Stephens <bradfordstephens@gmail.com>
To: solr-user@lucene.apache.org, java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hey there,

We're trying to add foreign language support into our new search
engine -- languages like Arabic, Farsi, and Urdu (that don't work with
standard analyzers). But our data source doesn't tell us which
languages we're actually collecting -- we just get blocks of text. Has
anyone here worked on language detection so we can figure out what
analyzers to use? Are there commercial solutions?

Much appreciated!

-- 
http://www.roadtofailure.com -- The Fringes of Scalability, Social
Media, and Computer Science

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41757-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 19:55:45 2009
Return-Path: <java-user-return-41757-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71650 invoked from network); 6 Aug 2009 19:55:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 19:55:45 -0000
Received: (qmail 15912 invoked by uid 500); 6 Aug 2009 19:55:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15833 invoked by uid 500); 6 Aug 2009 19:55:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15808 invoked by uid 99); 6 Aug 2009 19:55:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 19:55:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 19:55:35 +0000
Received: by qw-out-2122.google.com with SMTP id 8so463875qwh.53
        for <multiple recipients>; Thu, 06 Aug 2009 12:55:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:cc:content-type
         :content-transfer-encoding;
        bh=JnXr3Gh4uA1NDKeimZ++FDwvbsSoKKURNywiulSRpik=;
        b=J99cHV/vW71a/pCRqw8a65/oszFq6ROx/oQKt3PAy7Lxk+ifoddb7Q/bi8WQ0EDUFw
         hysW77YuMBBcw6oloWRM9vtg4gY+TTwoloQN7YZufT8du31CoBz2Ujp9syhnS7O8GLG3
         geEJbGxouwwWb0vQduBNqZU/PJEqQ2exfWZf8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type:content-transfer-encoding;
        b=WkTUSHm+z9N9y559Ulqswu9SIDgYeCccoydiiS/kzmqOiYtLo1xIvHgoAuNEiN1ul9
         OHzFeCsusyFI//+QDcSOEMbULioqAIm1mkogE//GQ4u2f13FZlBcXiJo5PQ/gfYYZoBK
         mOwPdon4i0O4lkVX+5rMjaXTVllHokx/yngvE=
MIME-Version: 1.0
Received: by 10.229.80.18 with SMTP id r18mr351960qck.73.1249588514409; Thu, 
	06 Aug 2009 12:55:14 -0700 (PDT)
In-Reply-To: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
References: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
Date: Thu, 6 Aug 2009 15:55:14 -0400
Message-ID: <8f0ad1f30908061255m70212637s1d788dd49f20a0aa@mail.gmail.com>
Subject: Re: Language Detection for Analysis?
From: Robert Muir <rcmuir@gmail.com>
To: solr-user@lucene.apache.org
Cc: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Bradford, there is an arabic analyzer in trunk. for farsi there is
currently a patch available:
http://issues.apache.org/jira/browse/LUCENE-1628

one option is not to detect languages at all.
it could be hard for short queries due to the languages you mentioned
borrowing from each other.
but you do not want to apply things like stemming to the wrong language.

instead, you could use ArabicTokenizer + ArabicNormalizationFilter +
PersianNormalizationFilter and just treat it at the script level.

On Thu, Aug 6, 2009 at 3:46 PM, Bradford
Stephens<bradfordstephens@gmail.com> wrote:
> Hey there,
>
> We're trying to add foreign language support into our new search
> engine -- languages like Arabic, Farsi, and Urdu (that don't work with
> standard analyzers). But our data source doesn't tell us which
> languages we're actually collecting -- we just get blocks of text. Has
> anyone here worked on language detection so we can figure out what
> analyzers to use? Are there commercial solutions?
>
> Much appreciated!
>
> --
> http://www.roadtofailure.com -- The Fringes of Scalability, Social
> Media, and Computer Science
>



-- 
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41758-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 20:04:14 2009
Return-Path: <java-user-return-41758-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73665 invoked from network); 6 Aug 2009 20:04:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 20:04:14 -0000
Received: (qmail 33974 invoked by uid 500); 6 Aug 2009 20:04:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33893 invoked by uid 500); 6 Aug 2009 20:04:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33882 invoked by uid 99); 6 Aug 2009 20:04:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 20:04:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.59] (HELO eastrmmtao107.cox.net) (68.230.240.59)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 20:04:08 +0000
Received: from eastrmimpo02.cox.net ([68.1.16.120])
          by eastrmmtao107.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090806200347.FUIX22474.eastrmmtao107.cox.net@eastrmimpo02.cox.net>
          for <java-user@lucene.apache.org>; Thu, 6 Aug 2009 16:03:47 -0400
Received: from eastrmwml33 ([172.18.18.217])
	by eastrmimpo02.cox.net with bizsmtp
	id R83n1c00B4h0NJL0283nUr; Thu, 06 Aug 2009 16:03:47 -0400
X-VR-Score: 0.00
X-Authority-Analysis: v=1.0 c=1 a=d37SQXLgtgoA:10 a=Amc90oGVR36Mf-YDrw8A:9
 a=taEufZwW1GCHruqek3CZ7fYpDZQA:4
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Thu, 6 Aug 2009 16:03:47 -0400
Message-ID: <20090806160347.OP4RU.42535.imail@eastrmwml33>
Date: Thu, 6 Aug 2009 16:03:47 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Why does this search succeed with web app, but not Luke?
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

In my indexer app (based on the IndexFiles.java demo), I am adding the "path" field:

    doc.add(new Field("path", f.getPath(), Field.Store.YES, Field.Index.ANALYZED));

Per Luke, the full path (e.g., "c:\....\xxxx.yyy") gets parsed, and one of the terms (again, per Luke) is "xxxx", i.e., the actual file name, but without the extension.

Then, when I search with Luke for "path:xxxx", that succeeds, as expected, and when I search with Luke for "path:xxxx.yyy", that fails, as expected.

But, if I search using the demo web app, for "path:xxxx.yyy", it succeeds.

Since the Luke search for "path:xxxx.yyy" fails, I don't understand why the web app search for "path:xxxx.yyy" would succeed?

Thanks,
Jim




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41759-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 20:06:19 2009
Return-Path: <java-user-return-41759-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74435 invoked from network); 6 Aug 2009 20:06:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 20:06:19 -0000
Received: (qmail 41303 invoked by uid 500); 6 Aug 2009 20:06:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41216 invoked by uid 500); 6 Aug 2009 20:06:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41206 invoked by uid 99); 6 Aug 2009 20:06:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 20:06:24 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 20:06:13 +0000
Received: by ewy26 with SMTP id 26so1234421ewy.5
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 13:05:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ySdWmEG4EQlhw9SXG5/9wGPrvlFBB48j5cPClejGDrw=;
        b=LysxS3nl+gT1bC4BSkHVtFquGXmhfrKggTC8M1UbBGFj5W0PPu5holwRoa5oLneehs
         1BIT5PPeNJX0tk4YranlaTc8G58zr8Od94l6A27QZA7/1aRxRxHLl3UB65q3SsaDxBLK
         N3zI73zabg4pNdKAYhSueGJ5SaqV1ieOcK6z0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=CRXPsL8V/pzaK/s8SjlWk+gT6pcn3gm/pNXNGN68gImBmLHRmNLF7QnWoFFgcg59ZT
         LixnScWg2yGAFXufUJ1rXMU/o71z3dOLdsZbbdU/BAiBc4F7j6w6FRYRa9QRQgZ2eiKj
         DHDiy/v9MEQTODogcxVXClD51e5rX/AghZcHY=
MIME-Version: 1.0
Received: by 10.216.88.71 with SMTP id z49mr50232wee.90.1249589152060; Thu, 06 
	Aug 2009 13:05:52 -0700 (PDT)
In-Reply-To: <8f0ad1f30908061255m70212637s1d788dd49f20a0aa@mail.gmail.com>
References: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
	 <8f0ad1f30908061255m70212637s1d788dd49f20a0aa@mail.gmail.com>
Date: Thu, 6 Aug 2009 23:05:52 +0300
Message-ID: <786fde50908061305m64e4ffa9kfcdcc170b7229194@mail.gmail.com>
Subject: Re: Language Detection for Analysis?
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6dab0ec861e9b04707ea522
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6dab0ec861e9b04707ea522
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Robert - can you elaborate on what you mean by "just treat it at the script
level"?

On Thu, Aug 6, 2009 at 10:55 PM, Robert Muir <rcmuir@gmail.com> wrote:

> Bradford, there is an arabic analyzer in trunk. for farsi there is
> currently a patch available:
> http://issues.apache.org/jira/browse/LUCENE-1628
>
> one option is not to detect languages at all.
> it could be hard for short queries due to the languages you mentioned
> borrowing from each other.
> but you do not want to apply things like stemming to the wrong language.
>
> instead, you could use ArabicTokenizer + ArabicNormalizationFilter +
> PersianNormalizationFilter and just treat it at the script level.
>
> On Thu, Aug 6, 2009 at 3:46 PM, Bradford
> Stephens<bradfordstephens@gmail.com> wrote:
> > Hey there,
> >
> > We're trying to add foreign language support into our new search
> > engine -- languages like Arabic, Farsi, and Urdu (that don't work with
> > standard analyzers). But our data source doesn't tell us which
> > languages we're actually collecting -- we just get blocks of text. Has
> > anyone here worked on language detection so we can figure out what
> > analyzers to use? Are there commercial solutions?
> >
> > Much appreciated!
> >
> > --
> > http://www.roadtofailure.com -- The Fringes of Scalability, Social
> > Media, and Computer Science
> >
>
>
>
> --
> Robert Muir
> rcmuir@gmail.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6dab0ec861e9b04707ea522--

From java-user-return-41760-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 20:11:01 2009
Return-Path: <java-user-return-41760-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75741 invoked from network); 6 Aug 2009 20:11:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 20:11:01 -0000
Received: (qmail 49586 invoked by uid 500); 6 Aug 2009 20:11:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49539 invoked by uid 500); 6 Aug 2009 20:11:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49509 invoked by uid 99); 6 Aug 2009 20:11:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 20:11:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.221.203 as permitted sender)
Received: from [209.85.221.203] (HELO mail-qy0-f203.google.com) (209.85.221.203)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 20:10:54 +0000
Received: by qyk41 with SMTP id 41so1156980qyk.29
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 13:10:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=nO6DYroaZexbZ0o1HALc1dkqoIqkpnSu2zgHLn7tpnU=;
        b=fl6oAEowbs0x7nNHdqDQ4+y0X98Cz++X71mMSfr2Y+eKfMlN79e0Lv6fq9wyIZ/Xx/
         CgY4o7jtyr7igsEkLQi/SqyW7IS09DmIw+bkhmCEmm/zoNhSW+DHuW6IHsP5cUk4aX5I
         qFE9o1f+pHawMi0FhKLDHcvIFYF+TQ1hOrb3c=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=WYmjM5pHXavvegz3q3rbuR38NELFDnw91A8wNQAmrQWbReHW8IRLTRfvredwKGot6e
         p9JeikWPJzoUNcA/BblOEiC57/xYHm5vwdxOiVH7xsYgA/JeA0JfjGzroTyf8E6HBvSE
         SZDTbHZ2h/YbkRPjj/HL+1Uv5mbwljC6VbKPM=
MIME-Version: 1.0
Received: by 10.229.109.202 with SMTP id k10mr374450qcp.58.1249589433285; Thu, 
	06 Aug 2009 13:10:33 -0700 (PDT)
In-Reply-To: <786fde50908061305m64e4ffa9kfcdcc170b7229194@mail.gmail.com>
References: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
	 <8f0ad1f30908061255m70212637s1d788dd49f20a0aa@mail.gmail.com>
	 <786fde50908061305m64e4ffa9kfcdcc170b7229194@mail.gmail.com>
Date: Thu, 6 Aug 2009 16:10:33 -0400
Message-ID: <8f0ad1f30908061310j298fa42ai8f8b773a78be37c3@mail.gmail.com>
Subject: Re: Language Detection for Analysis?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Shai, I mean doing language-agnostic things that apply to all of these
since they are based on the same writing system, like normalizing all
yeh characters (arabic yeh, farsi yeh, alef maksura) to the same form,
removing harakat, the kinds of things in ArabicNormalizationFilter and
PersianNormalizationFilter.

A parallel to this is doing "lowercase" to english, french, dutch,
etc. Its a good idea.

at least in the arabic case you can see here the precision/recall
tradeoffs of doing just normalization as I mentioned versus stemming :
http://www.mtholyoke.edu/~lballest/Pubs/arab_stem05.pdf
the benefit you see from stemming would assume you could language
detect 100% accurately, since applying arabic stemming as is will be
terrible on average for persian

so I would definitely start with ArabicTokenizer +
ArabicNormalizationFilter + PersianNormalizationFilter.

i think you could also adjust the source code, for example I would
probably very light stemming at least keeping leading =D9=88 prefix for all
these languages at least.
selectively applying some of the persian "stopwords" such as =D9=87=D8=A7 p=
lural
would probably be ok across all of these as well.

so I really have to wonder if the more complex approach at the end of
the day would give you better results on average than doing
normalization and maybe very light stemming/stopwords...


Hope this helps,
Robert

On Thu, Aug 6, 2009 at 4:05 PM, Shai Erera<serera@gmail.com> wrote:
> Robert - can you elaborate on what you mean by "just treat it at the scri=
pt
> level"?
>
> On Thu, Aug 6, 2009 at 10:55 PM, Robert Muir <rcmuir@gmail.com> wrote:
>
>> Bradford, there is an arabic analyzer in trunk. for farsi there is
>> currently a patch available:
>> http://issues.apache.org/jira/browse/LUCENE-1628
>>
>> one option is not to detect languages at all.
>> it could be hard for short queries due to the languages you mentioned
>> borrowing from each other.
>> but you do not want to apply things like stemming to the wrong language.
>>
>> instead, you could use ArabicTokenizer + ArabicNormalizationFilter +
>> PersianNormalizationFilter and just treat it at the script level.
>>
>> On Thu, Aug 6, 2009 at 3:46 PM, Bradford
>> Stephens<bradfordstephens@gmail.com> wrote:
>> > Hey there,
>> >
>> > We're trying to add foreign language support into our new search
>> > engine -- languages like Arabic, Farsi, and Urdu (that don't work with
>> > standard analyzers). But our data source doesn't tell us which
>> > languages we're actually collecting -- we just get blocks of text. Has
>> > anyone here worked on language detection so we can figure out what
>> > analyzers to use? Are there commercial solutions?
>> >
>> > Much appreciated!
>> >
>> > --
>> > http://www.roadtofailure.com -- The Fringes of Scalability, Social
>> > Media, and Computer Science
>> >
>>
>>
>>
>> --
>> Robert Muir
>> rcmuir@gmail.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>



--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41761-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 20:13:09 2009
Return-Path: <java-user-return-41761-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76184 invoked from network); 6 Aug 2009 20:13:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 20:13:09 -0000
Received: (qmail 55436 invoked by uid 500); 6 Aug 2009 20:13:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55368 invoked by uid 500); 6 Aug 2009 20:13:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55358 invoked by uid 99); 6 Aug 2009 20:13:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 20:13:14 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.29 as permitted sender)
Received: from [66.111.4.29] (HELO out5.smtp.messagingengine.com) (66.111.4.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 20:13:04 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 89DCC9BF9;
	Thu,  6 Aug 2009 16:12:42 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute2.internal (MEProxy); Thu, 06 Aug 2009 16:12:42 -0400
X-Sasl-enc: 9rcJEIWnw84xrqqWY61ou7cZU5wtwzX5jg6LPIliyaLt 1249589562
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id D47A03934;
	Thu,  6 Aug 2009 16:12:41 -0400 (EDT)
Message-ID: <4A7B3938.6090805@fastmail.fm>
Date: Thu, 06 Aug 2009 21:12:40 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.22 (Macintosh/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
CC: Shai Erera <serera@gmail.com>
Subject: Re: StandardFilter not handling dots as exptected ?
References: <4A7AE2B2.8010908@fastmail.fm>	 <359a92830908060727y69100acdy414f6e292dbcb5d4@mail.gmail.com>	 <4A7AECA5.5040100@fastmail.fm>	 <786fde50908060757o3ff5b05t16bf7c667d3d91d@mail.gmail.com>	 <4A7AF056.9060406@fastmail.fm> <786fde50908060817j7233796dm87fcb161a370f789@mail.gmail.com> <4A7B02CA.8070700@fastmail.fm>
In-Reply-To: <4A7B02CA.8070700@fastmail.fm>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Paul Taylor wrote:
> Shai Erera wrote:
>> No actually I think that's how the ACRONYM rule is defined:
>> R.E.S. is detected as ACRONYM, and therefore is converted to RES.
>> R.E.S is not detected as ACRONYM and therefore remains as R.E.S
>> Hence the mismatch.
> Hi looking at your suggestion of 
> https://issues.apache.org/jira/browse/LUCENE-1068
>
> ACRONYM = {LETTER} "." ({LETTER} ".")+
>
> it demands a trailing dot, perhaps I need this instead
>
> ACRONYM = {LETTER} ("." {LETTER} )+
>
> Paul
Ok, I raised a RFE at https://issues.apache.org/jira/browse/LUCENE-1787 
,what do you think ?


Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41762-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 20:16:33 2009
Return-Path: <java-user-return-41762-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76845 invoked from network); 6 Aug 2009 20:16:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 20:16:32 -0000
Received: (qmail 59945 invoked by uid 500); 6 Aug 2009 20:16:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59860 invoked by uid 500); 6 Aug 2009 20:16:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59848 invoked by uid 99); 6 Aug 2009 20:16:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 20:16:37 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 20:16:27 +0000
Received: by ewy26 with SMTP id 26so1241596ewy.5
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 13:16:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=KCIZoFsCgFf19v6Z1SRlqzJBFKY19BEEyL9d2AQ7VnM=;
        b=etv36QabL4m9/VMPbdU20PmL2TETuKI8RGeGnFAERKJPRRCQ5sQ0xgcCNVP/b1QGKN
         5fblISeqIXcv9VjvC/djIxQxMR11csBs7UiRuJdd+BjPwdOORO1YJueyosBJTeRA+jJ6
         AN0bEJDQK+P8hIMSwkLTSz8+/trzajNrBFaqM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=C9D6iTAuLXqchvJ8/p6qQngEv5annDznvFeaTJJgdE6S7WjgzPfnQUbDnEJOgyLp8c
         V3rP3jbtKK26v7xyrxBrY1GgoDCwVGYsb9DJnljfjlA80dicl1KRHxnvcXPhcwDX0RCU
         c5jK+ExiNhVnUr5KqmJcgrtRHdBJ7ii9Xk5eU=
MIME-Version: 1.0
Received: by 10.216.3.195 with SMTP id 45mr65623weh.8.1249589765950; Thu, 06 
	Aug 2009 13:16:05 -0700 (PDT)
In-Reply-To: <8f0ad1f30908061310j298fa42ai8f8b773a78be37c3@mail.gmail.com>
References: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
	 <8f0ad1f30908061255m70212637s1d788dd49f20a0aa@mail.gmail.com>
	 <786fde50908061305m64e4ffa9kfcdcc170b7229194@mail.gmail.com>
	 <8f0ad1f30908061310j298fa42ai8f8b773a78be37c3@mail.gmail.com>
Date: Thu, 6 Aug 2009 23:16:05 +0300
Message-ID: <786fde50908061316t2535e13ev68922d1c8a369f2e@mail.gmail.com>
Subject: Re: Language Detection for Analysis?
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016367fa26e1d4dff04707ecaf4
X-Virus-Checked: Checked by ClamAV on apache.org

--0016367fa26e1d4dff04707ecaf4
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Thanks Robert for the explanation. I thought that you meant something
different, like doing stemming in some sophisticated manner by somehow
detecting the language. Doing these normalizations makes sense of course,
especially if the letters look similar.

Thanks again,

Shai

On Thu, Aug 6, 2009 at 11:10 PM, Robert Muir <rcmuir@gmail.com> wrote:

> Shai, I mean doing language-agnostic things that apply to all of these
> since they are based on the same writing system, like normalizing all
> yeh characters (arabic yeh, farsi yeh, alef maksura) to the same form,
> removing harakat, the kinds of things in ArabicNormalizationFilter and
> PersianNormalizationFilter.
>
> A parallel to this is doing "lowercase" to english, french, dutch,
> etc. Its a good idea.
>
> at least in the arabic case you can see here the precision/recall
> tradeoffs of doing just normalization as I mentioned versus stemming :
> http://www.mtholyoke.edu/~lballest/Pubs/arab_stem05.pdf<http://www.mtholy=
oke.edu/%7Elballest/Pubs/arab_stem05.pdf>
> the benefit you see from stemming would assume you could language
> detect 100% accurately, since applying arabic stemming as is will be
> terrible on average for persian
>
> so I would definitely start with ArabicTokenizer +
> ArabicNormalizationFilter + PersianNormalizationFilter.
>
> i think you could also adjust the source code, for example I would
> probably very light stemming at least keeping leading =D9=88 prefix for a=
ll
> these languages at least.
> selectively applying some of the persian "stopwords" such as =D9=87=D8=A7=
 plural
> would probably be ok across all of these as well.
>
> so I really have to wonder if the more complex approach at the end of
> the day would give you better results on average than doing
> normalization and maybe very light stemming/stopwords...
>
>
> Hope this helps,
> Robert
>
> On Thu, Aug 6, 2009 at 4:05 PM, Shai Erera<serera@gmail.com> wrote:
> > Robert - can you elaborate on what you mean by "just treat it at the
> script
> > level"?
> >
> > On Thu, Aug 6, 2009 at 10:55 PM, Robert Muir <rcmuir@gmail.com> wrote:
> >
> >> Bradford, there is an arabic analyzer in trunk. for farsi there is
> >> currently a patch available:
> >> http://issues.apache.org/jira/browse/LUCENE-1628
> >>
> >> one option is not to detect languages at all.
> >> it could be hard for short queries due to the languages you mentioned
> >> borrowing from each other.
> >> but you do not want to apply things like stemming to the wrong languag=
e.
> >>
> >> instead, you could use ArabicTokenizer + ArabicNormalizationFilter +
> >> PersianNormalizationFilter and just treat it at the script level.
> >>
> >> On Thu, Aug 6, 2009 at 3:46 PM, Bradford
> >> Stephens<bradfordstephens@gmail.com> wrote:
> >> > Hey there,
> >> >
> >> > We're trying to add foreign language support into our new search
> >> > engine -- languages like Arabic, Farsi, and Urdu (that don't work wi=
th
> >> > standard analyzers). But our data source doesn't tell us which
> >> > languages we're actually collecting -- we just get blocks of text. H=
as
> >> > anyone here worked on language detection so we can figure out what
> >> > analyzers to use? Are there commercial solutions?
> >> >
> >> > Much appreciated!
> >> >
> >> > --
> >> > http://www.roadtofailure.com -- The Fringes of Scalability, Social
> >> > Media, and Computer Science
> >> >
> >>
> >>
> >>
> >> --
> >> Robert Muir
> >> rcmuir@gmail.com
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
>
>
> --
> Robert Muir
> rcmuir@gmail.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016367fa26e1d4dff04707ecaf4--

From java-user-return-41763-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 21:30:32 2009
Return-Path: <java-user-return-41763-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95900 invoked from network); 6 Aug 2009 21:30:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 21:30:32 -0000
Received: (qmail 44694 invoked by uid 500); 6 Aug 2009 21:30:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44597 invoked by uid 500); 6 Aug 2009 21:30:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44586 invoked by uid 99); 6 Aug 2009 21:30:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 21:30:37 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of nigelspleen@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 21:30:27 +0000
Received: by fxm2 with SMTP id 2so1082140fxm.28
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 14:30:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Enbkpr7YLyMmbRqj5oywLocnIBmBsQmuMo9TLCmkhLU=;
        b=gHL9mxeDoxneESrPR7deLhczepuHpB9wNOkv0SFZaX1FhOJHvuwClGeyiE6vo/vrAd
         aHA2yovh49peq7R0leQ2S4GDoXEAS2b1dnmUKWOONjCOeAT+Se3V/EirGh9S1svS6/Bq
         WI0EvqZj4s9PQ9R17OyEPX39KleBujWGSFPnE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=dUmf+XDhKB9VZOqoNq/twaj3w8wjGUg83v/aTLPM+Tex3FcXocjXJVBtn8hnhKxngV
         kc6qe10/W2mCrj2tWnXQiFFfEHkGKa20INkaNJOqhESCkkhUAInILyaJA+4Pfk7C3Iwi
         XKYPL/cEWYEACrIGsxBdnx2dlOp3/CP2ffeqc=
MIME-Version: 1.0
Received: by 10.204.114.18 with SMTP id c18mr1726435bkq.211.1249594207122; 
	Thu, 06 Aug 2009 14:30:07 -0700 (PDT)
In-Reply-To: <9ac0c6aa0908051250m456998bbve6e8be67de9f3009@mail.gmail.com>
References: <843920a30908050908pf9e2abciff36861614c0813e@mail.gmail.com>
	 <9ac0c6aa0908051250m456998bbve6e8be67de9f3009@mail.gmail.com>
Date: Thu, 6 Aug 2009 17:30:07 -0400
Message-ID: <843920a30908061430p60001011v19982560764aa814@mail.gmail.com>
Subject: Re: Efficient optimization of large indexes?
From: Nigel <nigelspleen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636b43297d4343004707fd289
X-Virus-Checked: Checked by ClamAV on apache.org

--001636b43297d4343004707fd289
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

On Wed, Aug 5, 2009 at 3:50 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> On Wed, Aug 5, 2009 at 12:08 PM, Nigel<nigelspleen@gmail.com> wrote:
> > We periodically optimize large indexes (100 - 200gb) by calling
> > IndexWriter.optimize().  It takes a heck of a long time, and I'm
> wondering
> > if a more efficient solution might be the following:
> >
> > - Create a new empty index on a different filesystem
> > - Set a merge policy for the new index so it puts everything into one
> giant
> > segment (not sure how to do this off-hand, but I assume it's possible)
> > - Enumerate all documents in the unoptimized index and add them to the
> new
> > index
>
> Actually IndexWriter must periodically flush, which will always
> create new segments, which will then always require merging.  Ie
> there's no way to just add everything to only one segment in one
> shot.
>

Hmm, that makes sense now that you mention it.  And if you have to merge in
the end anyway, there's no point to my idea of adding docs to a new index.

But addIndexes(IndexReader[]) as you suggest would solve that problem.


> Merge performance does seem rather slow... I recently profiled it and
> was suprised to find that the merging of terms dict & postings was cpu
> bound, even on a modern CPU (core i7 920) and with 3 merges running
> concurrently.  I think most of the CPU cost comes from the pqueue
> that's used to do the merge sort, plus read/writeVInt.  When Lucene
> [eventually] switches to PForDelta, that should be more CPU friendly.


That's interesting.  I recently did one of our big merges on a different
server that has the same disks as the one I was using before, but a faster
processor.  It seemed like the merge was quite a bit faster than usual
(though it's possible I was fooled by other factors).

Also, it's tons of IO because for each merge it must read every single
> byte and write nearly every single byte, so that's ~2X bytes moved.
> Then, if you have more segments in your index than your mergeFactor,
> multiple such merges are needed and you're looking at, at least, 4X
> your index size in net bytes moved.  If you have CFS enabled, it's 8X
> the index size.


Not to get too sidetracked, but this reminds me of another question I meant
to ask.  We use the compound format right now.  Our merge factor is
relatively low, so switching to the non-compound format would certainly be
possible without running into problems with too many open files.  Is there
any significant speed different between compound and non-compound for
indexing, searching, or merging?  (Searching for us would be the most
important by far.)


>   * If possible, make sure you always add the same fields to your
>    docs, in the same order (this results in consistent numbering of
>    field name -> number).  This is very much an unexpected
>    gotchya... the merging of stored fields and term vectors is much,
>    much faster if the field numbers are identical.  LUCENE-1737 is
>    open to fix Lucene so it consistently numbers automatically, but
>    it's somewhat tricky because many places in Lucene assume the
>    field names are densely packed.
>

We generally do this already, but some of our fields are nullable and so for
some documents the number-to-name mapping will be different.  Is there any
value in adding dummy values like "NULL" in these cases?  That presumably
adds overhead of its own, though.

Thanks,
Chris

--001636b43297d4343004707fd289--

From java-user-return-41764-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 06 23:09:52 2009
Return-Path: <java-user-return-41764-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36913 invoked from network); 6 Aug 2009 23:09:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Aug 2009 23:09:52 -0000
Received: (qmail 69436 invoked by uid 500); 6 Aug 2009 23:09:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69352 invoked by uid 500); 6 Aug 2009 23:09:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69342 invoked by uid 99); 6 Aug 2009 23:09:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 23:09:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 06 Aug 2009 23:09:48 +0000
Received: by yxe3 with SMTP id 3so1650462yxe.29
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 16:09:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=0HhimgOS/qYM9H+sjesQ24LxiSSktPmshi0vqlZLQ6U=;
        b=rlaLwSIkAI25MfMYmRV0gWyXrDzXdQzgsnjDOXgi4T+WLt001VwrVs2b/4w4Uf0JS/
         T7v0MHaNOHhdu+5qtuZJV4TZTt4IxuuEMBgQ6u1odf2JKQxqa9SjUyUMNvCGPDGaPsoz
         0f3rC04cvDFvMidCN8Ml1iTbr2b9F4vIiYzWs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=t6Dazbx7lwmkz+Utlcb9YyeayB1fkZxpyQsj3lC1KhwCbLNeoFAA1m8V9v7T10oa5x
         kLkY8R8hYuhph9W7GL/Mmm/RgVJVPB3rEIZjE8EVhbjbcOEHkgTNgah6bgaGp2rvmCxL
         gop2wjd9lgTEhBj6Nzgmx4CnxvdMqF7C9T/TE=
MIME-Version: 1.0
Received: by 10.231.35.205 with SMTP id q13mr486821ibd.17.1249600167377; Thu, 
	06 Aug 2009 16:09:27 -0700 (PDT)
In-Reply-To: <20090806160347.OP4RU.42535.imail@eastrmwml33>
References: <20090806160347.OP4RU.42535.imail@eastrmwml33>
Date: Thu, 6 Aug 2009 16:09:27 -0700
Message-ID: <9cafbc680908061609s61e5e52ake4723d1e0fb29425@mail.gmail.com>
Subject: Re: Why does this search succeed with web app, but not Luke?
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Jim,

Are you using the same Analyzer for indexing and searching? xxxx.yyy
will be seem as a HOSTNAME by StandardAnalyzer and will keep it as one
term, whereas another indexer might split this into 2 terms. This
should not matter either way as long as you are using the same
Analyzer for both indexing and searching.

I would expect this to pass unless you are using NOT_ANALYZED, or the
WhitespaceAnalyzer, or something else that would not split on "/".
    path:xxxx.yyy

In Luke, do you see 2 terms "xxxx" and "yyy", or just "xxxx.yyy", or
something else?

Thanks,
Phil

On Thu, Aug 6, 2009 at 1:03 PM, <ohaya@cox.net> wrote:
> Hi,
>
> In my indexer app (based on the IndexFiles.java demo), I am adding the "p=
ath" field:
>
> =A0 =A0doc.add(new Field("path", f.getPath(), Field.Store.YES, Field.Inde=
x.ANALYZED));
>
> Per Luke, the full path (e.g., "c:\....\xxxx.yyy") gets parsed, and one o=
f the terms (again, per Luke) is "xxxx", i.e., the actual file name, but wi=
thout the extension.
>
> Then, when I search with Luke for "path:xxxx", that succeeds, as expected=
, and when I search with Luke for "path:xxxx.yyy", that fails, as expected.
>
> But, if I search using the demo web app, for "path:xxxx.yyy", it succeeds=
.
>
> Since the Luke search for "path:xxxx.yyy" fails, I don't understand why t=
he web app search for "path:xxxx.yyy" would succeed?
>
> Thanks,
> Jim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41765-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 01:07:16 2009
Return-Path: <java-user-return-41765-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66318 invoked from network); 7 Aug 2009 01:07:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 01:07:16 -0000
Received: (qmail 49037 invoked by uid 500); 7 Aug 2009 01:07:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48947 invoked by uid 500); 7 Aug 2009 01:07:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48937 invoked by uid 99); 7 Aug 2009 01:07:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 01:07:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.9] (HELO eastrmmtao103.cox.net) (68.230.240.9)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 01:07:11 +0000
Received: from eastrmimpo02.cox.net ([68.1.16.120])
          by eastrmmtao103.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090807010650.VORY27176.eastrmmtao103.cox.net@eastrmimpo02.cox.net>;
          Thu, 6 Aug 2009 21:06:50 -0400
Received: from eastrmwml31 ([172.18.18.217])
	by eastrmimpo02.cox.net with bizsmtp
	id RD6q1c0014h0NJL02D6qpD; Thu, 06 Aug 2009 21:06:50 -0400
X-VR-Score: -200.00
X-Authority-Analysis: v=1.0 c=1 a=wTB1bo__o_gA:10 a=pGLkceISAAAA:8
 a=kviXuzpPAAAA:8 a=mV9VRH-2AAAA:8 a=nquDRAdU3AgKmG4kwNAA:9
 a=gpwQO1JBZK7Fp80PPE8A:7 a=AbxGfRDjmQQULIeSR1YQhEJo_hUA:4 a=MSl-tDqOz04A:10
 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Thu, 6 Aug 2009 21:06:50 -0400
Message-ID: <20090806210650.ZA58J.45587.imail@eastrmwml31>
Date: Thu, 6 Aug 2009 21:06:50 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Why does this search succeed with web app, but not Luke?
Cc: Phil Whelan <phil123@gmail.com>
In-Reply-To: <9cafbc680908061609s61e5e52ake4723d1e0fb29425@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Phil,

Both my indexer and the webapp are basically from the Lucene demos, the ind=
exer starting with the IndexFiles.java demo code, so I think they're both u=
sing the StandardAnalyzer.

What appears in Luke, when I select "path" is just the filename part, witho=
ut the extension, i.e., the "xxxx" part. =20

That's why I said in my original post that I was kind of surprised that doi=
ng a web query for "path:xxxx.yyy" succeeded, i.e, in the path field in the=
 index, there is no "xxxx.yyy", just "xxxx".

Jim

---- Phil Whelan <phil123@gmail.com> wrote:=20
> Hi Jim,
>=20
> Are you using the same Analyzer for indexing and searching? xxxx.yyy
> will be seem as a HOSTNAME by StandardAnalyzer and will keep it as one
> term, whereas another indexer might split this into 2 terms. This
> should not matter either way as long as you are using the same
> Analyzer for both indexing and searching.
>=20
> I would expect this to pass unless you are using NOT_ANALYZED, or the
> WhitespaceAnalyzer, or something else that would not split on "/".
>     path:xxxx.yyy
>=20
> In Luke, do you see 2 terms "xxxx" and "yyy", or just "xxxx.yyy", or
> something else?
>=20
> Thanks,
> Phil
>=20
> On Thu, Aug 6, 2009 at 1:03 PM, <ohaya@cox.net> wrote:
> > Hi,
> >
> > In my indexer app (based on the IndexFiles.java demo), I am adding the =
"path" field:
> >
> > =C2=A0 =C2=A0doc.add(new Field("path", f.getPath(), Field.Store.YES, Fi=
eld.Index.ANALYZED));
> >
> > Per Luke, the full path (e.g., "c:\....\xxxx.yyy") gets parsed, and one=
 of the terms (again, per Luke) is "xxxx", i.e., the actual file name, but =
without the extension.
> >
> > Then, when I search with Luke for "path:xxxx", that succeeds, as expect=
ed, and when I search with Luke for "path:xxxx.yyy", that fails, as expecte=
d.
> >
> > But, if I search using the demo web app, for "path:xxxx.yyy", it succee=
ds.
> >
> > Since the Luke search for "path:xxxx.yyy" fails, I don't understand why=
 the web app search for "path:xxxx.yyy" would succeed?
> >
> > Thanks,
> > Jim
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41766-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 01:27:52 2009
Return-Path: <java-user-return-41766-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73487 invoked from network); 7 Aug 2009 01:27:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 01:27:52 -0000
Received: (qmail 62079 invoked by uid 500); 7 Aug 2009 01:27:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61985 invoked by uid 500); 7 Aug 2009 01:27:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61975 invoked by uid 99); 7 Aug 2009 01:27:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 01:27:56 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.8] (HELO eastrmmtao102.cox.net) (68.230.240.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 01:27:46 +0000
Received: from eastrmimpo02.cox.net ([68.1.16.120])
          by eastrmmtao102.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090807012726.UTNJ22890.eastrmmtao102.cox.net@eastrmimpo02.cox.net>
          for <java-user@lucene.apache.org>; Thu, 6 Aug 2009 21:27:26 -0400
Received: from eastrmwml31 ([172.18.18.217])
	by eastrmimpo02.cox.net with bizsmtp
	id RDTR1c0024h0NJL02DTReE; Thu, 06 Aug 2009 21:27:25 -0400
X-VR-Score: -100.00
X-Authority-Analysis: v=1.0 c=1 a=wTB1bo__o_gA:10 a=kviXuzpPAAAA:8
 a=pGLkceISAAAA:8 a=mV9VRH-2AAAA:8 a=4M-xpD7ORuIP3r-vIigA:9
 a=R_ybp-JUJkpa_EJDcIkA:7 a=AK2WweC_w1npttmbvtlKV97sKpgA:4 a=4vB-4DCPJfMA:10
 a=MSl-tDqOz04A:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Thu, 6 Aug 2009 21:27:25 -0400
Message-ID: <20090806212725.QOTOB.45829.imail@eastrmwml31>
Date: Thu, 6 Aug 2009 21:27:25 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Why does this search succeed with web app, but not Luke?
In-Reply-To: <20090806210650.ZA58J.45587.imail@eastrmwml31>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Phil,

I need to be more precise...

The files that I have are at, say:

C:\dir1\dir2\

so, for example, I have

C:\dir1\dir2\file-1-1.dat
C:\dir1\dir2\file-1-2.dat
C:\dir1\dir2\file-1-3.dat
C:\dir1\dir2\file-1-4.dat
C:\dir1\dir2\file-1-5.dat

After indexing, and, using Luke, I look at the "path" field, and I see term=
s like (not in this order):

C
dir1
dir2
dat
file-1-1
file-1-2
file-1-3
file-1-4
file-1-5

Notice that there is no (for example) term like "file-1-2.dat".

I'm assuming this is because the analyzer is breaking that into "file-1-2" =
and "dat".

As I said, based on the terms in Luke, I would have expected a web app quer=
y on:

path:file-1-2

to succeed, and a query on:

path:file-1-2.dat

to fail.

But, instead both of those succeed when I do a web query.

Jim


---- ohaya@cox.net wrote:=20
> Phil,
>=20
> Both my indexer and the webapp are basically from the Lucene demos, the i=
ndexer starting with the IndexFiles.java demo code, so I think they're both=
 using the StandardAnalyzer.
>=20
> What appears in Luke, when I select "path" is just the filename part, wit=
hout the extension, i.e., the "xxxx" part. =20
>=20
> That's why I said in my original post that I was kind of surprised that d=
oing a web query for "path:xxxx.yyy" succeeded, i.e, in the path field in t=
he index, there is no "xxxx.yyy", just "xxxx".
>=20
> Jim
>=20
> ---- Phil Whelan <phil123@gmail.com> wrote:=20
> > Hi Jim,
> >=20
> > Are you using the same Analyzer for indexing and searching? xxxx.yyy
> > will be seem as a HOSTNAME by StandardAnalyzer and will keep it as one
> > term, whereas another indexer might split this into 2 terms. This
> > should not matter either way as long as you are using the same
> > Analyzer for both indexing and searching.
> >=20
> > I would expect this to pass unless you are using NOT_ANALYZED, or the
> > WhitespaceAnalyzer, or something else that would not split on "/".
> >     path:xxxx.yyy
> >=20
> > In Luke, do you see 2 terms "xxxx" and "yyy", or just "xxxx.yyy", or
> > something else?
> >=20
> > Thanks,
> > Phil
> >=20
> > On Thu, Aug 6, 2009 at 1:03 PM, <ohaya@cox.net> wrote:
> > > Hi,
> > >
> > > In my indexer app (based on the IndexFiles.java demo), I am adding th=
e "path" field:
> > >
> > > =C2=A0 =C2=A0doc.add(new Field("path", f.getPath(), Field.Store.YES, =
Field.Index.ANALYZED));
> > >
> > > Per Luke, the full path (e.g., "c:\....\xxxx.yyy") gets parsed, and o=
ne of the terms (again, per Luke) is "xxxx", i.e., the actual file name, bu=
t without the extension.
> > >
> > > Then, when I search with Luke for "path:xxxx", that succeeds, as expe=
cted, and when I search with Luke for "path:xxxx.yyy", that fails, as expec=
ted.
> > >
> > > But, if I search using the demo web app, for "path:xxxx.yyy", it succ=
eeds.
> > >
> > > Since the Luke search for "path:xxxx.yyy" fails, I don't understand w=
hy the web app search for "path:xxxx.yyy" would succeed?
> > >
> > > Thanks,
> > > Jim
> >=20
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41767-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 02:10:09 2009
Return-Path: <java-user-return-41767-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90683 invoked from network); 7 Aug 2009 02:10:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 02:10:09 -0000
Received: (qmail 93451 invoked by uid 500); 7 Aug 2009 02:10:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93367 invoked by uid 500); 7 Aug 2009 02:10:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93355 invoked by uid 99); 7 Aug 2009 02:10:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 02:10:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.132.246 as permitted sender)
Received: from [209.85.132.246] (HELO an-out-0708.google.com) (209.85.132.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 02:10:04 +0000
Received: by an-out-0708.google.com with SMTP id b2so281871ana.5
        for <java-user@lucene.apache.org>; Thu, 06 Aug 2009 19:09:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=FsLdw+hUAXFACVFd/LQAu+JqbsC5caDeeS2RIJqmuKA=;
        b=itd/yK6pT98B3s8k64OfsGH3fPUJLbugRgGW/iMfar6Zew8o5hZG1Ivt91NTbi+sLL
         xHEu4HI3baAK4G30GBRleXnTgvi/WS5flFTUK/be3+cuaZnfHC7J661oo3wTI+T9O7Q5
         5rD1yhVT5tHxwtyJjBImu5KVPtwf8uOD6/Jw4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=fEOBjD+avZGBCFWwNEALYS2qQnt4E6c9Cg1vGMu0euRrpc8iHhWBHofY0uW8aCQVbO
         3L6NHFb765IxECBbX99vqs8BzTcPMJyzOVg5nlCO/RtOtD9hN6kDl9cI/iN6JQMYI1ao
         edx61AQHEYIp0wR3yQQ1pPlf7g1UxEZEF5pOg=
MIME-Version: 1.0
Received: by 10.100.191.7 with SMTP id o7mr12485944anf.33.1249610983682; Thu, 
	06 Aug 2009 19:09:43 -0700 (PDT)
In-Reply-To: <20090806212725.QOTOB.45829.imail@eastrmwml31>
References: <20090806210650.ZA58J.45587.imail@eastrmwml31>
	 <20090806212725.QOTOB.45829.imail@eastrmwml31>
Date: Thu, 6 Aug 2009 19:09:43 -0700
Message-ID: <9cafbc680908061909n3a4c01fp62e349cc89104b62@mail.gmail.com>
Subject: Re: Why does this search succeed with web app, but not Luke?
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Jim,

> As I said, based on the terms in Luke, I would have expected a web app qu=
ery on:
>
> path:file-1-2
>
> to succeed, and a query on:
>
> path:file-1-2.dat
> to fail.
>
> But, instead both of those succeed when I do a web query.

This query will also pass through the same (hopefully) Analyzer and
will be broken into terms. So the query will actually be for
"file-1-2" and "dat" where "file-1-2" is followed immediately by
"dat".

In indexing the terms position is stored, so
"C:\dir1\dir2\file-1-1.dat" becomes...
[0] c
[1] dir1
[2] dir2
[3] file-1-1
[4] dat

"file-1-1" is followed by "dat", so there is a match.

Does that make sense?

Cheers,
Phil

>
> Jim
>
>
> ---- ohaya@cox.net wrote:
>> Phil,
>>
>> Both my indexer and the webapp are basically from the Lucene demos, the =
indexer starting with the IndexFiles.java demo code, so I think they're bot=
h using the StandardAnalyzer.
>>
>> What appears in Luke, when I select "path" is just the filename part, wi=
thout the extension, i.e., the "xxxx" part.
>>
>> That's why I said in my original post that I was kind of surprised that =
doing a web query for "path:xxxx.yyy" succeeded, i.e, in the path field in =
the index, there is no "xxxx.yyy", just "xxxx".
>>
>> Jim
>>
>> ---- Phil Whelan <phil123@gmail.com> wrote:
>> > Hi Jim,
>> >
>> > Are you using the same Analyzer for indexing and searching? xxxx.yyy
>> > will be seem as a HOSTNAME by StandardAnalyzer and will keep it as one
>> > term, whereas another indexer might split this into 2 terms. This
>> > should not matter either way as long as you are using the same
>> > Analyzer for both indexing and searching.
>> >
>> > I would expect this to pass unless you are using NOT_ANALYZED, or the
>> > WhitespaceAnalyzer, or something else that would not split on "/".
>> > =A0 =A0 path:xxxx.yyy
>> >
>> > In Luke, do you see 2 terms "xxxx" and "yyy", or just "xxxx.yyy", or
>> > something else?
>> >
>> > Thanks,
>> > Phil
>> >
>> > On Thu, Aug 6, 2009 at 1:03 PM, <ohaya@cox.net> wrote:
>> > > Hi,
>> > >
>> > > In my indexer app (based on the IndexFiles.java demo), I am adding t=
he "path" field:
>> > >
>> > > =A0 =A0doc.add(new Field("path", f.getPath(), Field.Store.YES, Field=
.Index.ANALYZED));
>> > >
>> > > Per Luke, the full path (e.g., "c:\....\xxxx.yyy") gets parsed, and =
one of the terms (again, per Luke) is "xxxx", i.e., the actual file name, b=
ut without the extension.
>> > >
>> > > Then, when I search with Luke for "path:xxxx", that succeeds, as exp=
ected, and when I search with Luke for "path:xxxx.yyy", that fails, as expe=
cted.
>> > >
>> > > But, if I search using the demo web app, for "path:xxxx.yyy", it suc=
ceeds.
>> > >
>> > > Since the Luke search for "path:xxxx.yyy" fails, I don't understand =
why the web app search for "path:xxxx.yyy" would succeed?
>> > >
>> > > Thanks,
>> > > Jim
>> >

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41768-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 03:52:17 2009
Return-Path: <java-user-return-41768-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14137 invoked from network); 7 Aug 2009 03:52:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 03:52:17 -0000
Received: (qmail 76325 invoked by uid 500); 7 Aug 2009 03:52:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76248 invoked by uid 500); 7 Aug 2009 03:52:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76185 invoked by uid 99); 7 Aug 2009 03:52:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 03:52:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.59] (HELO web50305.mail.re2.yahoo.com) (206.190.38.59)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 07 Aug 2009 03:52:09 +0000
Received: (qmail 31445 invoked by uid 60001); 7 Aug 2009 03:51:48 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1249617108; bh=BPOCbMNmWpipoVlPn0WIWLpzeNpgOIutQ9MHSxq/SXg=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=hI5b5axMXg8qjcTXxOu0OCrsWfmw9/JNzMZTLbKAknEwnBXfwaKBieDMdpBuuWpddUJDS1wNjQQjb2gS9S7AzU4mKgtlPSnSTbgWy7f7jd10QJQFMGJbK9EJhTwWDNKMiU0vBHPyb5LjEeJlbEqaNofMa9yaB3rVsJangrU9XOk=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=s0zvYp64N9Fvr0mL76U5LTtwik0qaTqG6V5QoESPo2/cyHD7p2vW86sOfOzQ8aUdMF653KWFirof3VdzQ4J+plGR/M2fhyRcqRfph4PsPVPVr/Dz0MW8T1LbPTwRSVk6e+8zNO53Zn22efVhGDigp9vJKRiLH2S/RfoZTizohx0=;
Message-ID: <648018.31297.qm@web50305.mail.re2.yahoo.com>
X-YMail-OSG: 5fMLhbsVM1nhLBA1Xod.jDOOTiQ3qa.3WoZzmySdf0Inzh9zpqcsCcu7PgiN52e06p1ah6f_Hv8Q4Nxzh.Q9E4Mf.lsd..o710lFZ6CfxqbR1rmgiY0hSS2Xq3YIvS7nuHecSE6z8xL7D3lJhGgHHoyyzFHfvhTllzk2.oVgIZrCb.2YotOHfJ9_iOHVWctW_s7AYmqMYEw217KfT5d7Cm3waBwRHjo2dXNNAZZ54ETYFAfPQ.dKN3f1ZflauxMrxs8C31SKjJbLvrMiGN67QD6.EDxXeQChiCCL1ZECy1ZYgh20PonWD24IvdnMAXXmTrrhrX1tmHRaIviaEgVm7pcvHoU9A7FgUfU8mg--
Received: from [74.73.15.78] by web50305.mail.re2.yahoo.com via HTTP; Thu, 06 Aug 2009 20:51:48 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
References: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
Date: Thu, 6 Aug 2009 20:51:48 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Language Detection for Analysis?
To: java-user@lucene.apache.org, solr-user@lucene.apache.org
In-Reply-To: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Bradford,

If I may:

Have a look at http://www.sematext.com/products/language-identifier/index.html
And/or http://www.sematext.com/products/multilingual-indexer/index.html

 Otis
--
Sematext is hiring -- http://sematext.com/about/jobs.html?mls
Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR



----- Original Message ----
> From: Bradford Stephens <bradfordstephens@gmail.com>
> To: solr-user@lucene.apache.org; java-user@lucene.apache.org
> Sent: Thursday, August 6, 2009 3:46:21 PM
> Subject: Language Detection for Analysis?
> 
> Hey there,
> 
> We're trying to add foreign language support into our new search
> engine -- languages like Arabic, Farsi, and Urdu (that don't work with
> standard analyzers). But our data source doesn't tell us which
> languages we're actually collecting -- we just get blocks of text. Has
> anyone here worked on language detection so we can figure out what
> analyzers to use? Are there commercial solutions?
> 
> Much appreciated!
> 
> -- 
> http://www.roadtofailure.com -- The Fringes of Scalability, Social
> Media, and Computer Science
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41769-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 04:36:27 2009
Return-Path: <java-user-return-41769-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20381 invoked from network); 7 Aug 2009 04:36:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 04:36:27 -0000
Received: (qmail 99766 invoked by uid 500); 7 Aug 2009 04:36:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99661 invoked by uid 500); 7 Aug 2009 04:36:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99651 invoked by uid 99); 7 Aug 2009 04:36:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 04:36:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.7] (HELO eastrmmtao101.cox.net) (68.230.240.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 04:36:21 +0000
Received: from eastrmimpo03.cox.net ([68.1.16.126])
          by eastrmmtao101.cox.net
          (InterMail vM.8.00.01.00 201-2244-105-20090324) with ESMTP
          id <20090807043600.MADN27901.eastrmmtao101.cox.net@eastrmimpo03.cox.net>;
          Fri, 7 Aug 2009 00:36:00 -0400
Received: from eastrmwml37 ([172.18.18.217])
	by eastrmimpo03.cox.net with bizsmtp
	id RGc01c0014h0NJL02Gc0mi; Fri, 07 Aug 2009 00:36:00 -0400
X-VR-Score: -200.00
X-Authority-Analysis: v=1.0 c=1 a=wTB1bo__o_gA:10 a=pGLkceISAAAA:8
 a=kviXuzpPAAAA:8 a=mV9VRH-2AAAA:8 a=nXw-GSGfkkrdqTIljbIA:9
 a=HOW7uqtyeDTjE-HVCRoA:7 a=zx05POk9I6w_COCdyzr9bZstW5QA:4 a=MSl-tDqOz04A:10
 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Fri, 7 Aug 2009 0:36:00 -0400
Message-ID: <20090807003600.986OW.45601.imail@eastrmwml37>
Date: Fri, 7 Aug 2009 0:36:00 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Why does this search succeed with web app, but not Luke?
Cc: Phil Whelan <phil123@gmail.com>
In-Reply-To: <9cafbc680908061909n3a4c01fp62e349cc89104b62@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Phil,

Well, kind of... but...

Then, why, when I do the search in Luke, do I get the results I cited:

xxxx  =3D=3D> succeeds

xxxx.yyy  =3D=3D> fails (no results)

I guess that I've been assuming that the search in Luke is "correct" and I'=
ve been using that to "test my understanding", but maybe that's an invalid =
assumption?

Jim





---- Phil Whelan <phil123@gmail.com> wrote:=20
> Hi Jim,
>=20
> > As I said, based on the terms in Luke, I would have expected a web app =
query on:
> >
> > path:file-1-2
> >
> > to succeed, and a query on:
> >
> > path:file-1-2.dat
> > to fail.
> >
> > But, instead both of those succeed when I do a web query.
>=20
> This query will also pass through the same (hopefully) Analyzer and
> will be broken into terms. So the query will actually be for
> "file-1-2" and "dat" where "file-1-2" is followed immediately by
> "dat".
>=20
> In indexing the terms position is stored, so
> "C:\dir1\dir2\file-1-1.dat" becomes...
> [0] c
> [1] dir1
> [2] dir2
> [3] file-1-1
> [4] dat
>=20
> "file-1-1" is followed by "dat", so there is a match.
>=20
> Does that make sense?
>=20
> Cheers,
> Phil
>=20
> >
> > Jim
> >
> >
> > ---- ohaya@cox.net wrote:
> >> Phil,
> >>
> >> Both my indexer and the webapp are basically from the Lucene demos, th=
e indexer starting with the IndexFiles.java demo code, so I think they're b=
oth using the StandardAnalyzer.
> >>
> >> What appears in Luke, when I select "path" is just the filename part, =
without the extension, i.e., the "xxxx" part.
> >>
> >> That's why I said in my original post that I was kind of surprised tha=
t doing a web query for "path:xxxx.yyy" succeeded, i.e, in the path field i=
n the index, there is no "xxxx.yyy", just "xxxx".
> >>
> >> Jim
> >>
> >> ---- Phil Whelan <phil123@gmail.com> wrote:
> >> > Hi Jim,
> >> >
> >> > Are you using the same Analyzer for indexing and searching? xxxx.yyy
> >> > will be seem as a HOSTNAME by StandardAnalyzer and will keep it as o=
ne
> >> > term, whereas another indexer might split this into 2 terms. This
> >> > should not matter either way as long as you are using the same
> >> > Analyzer for both indexing and searching.
> >> >
> >> > I would expect this to pass unless you are using NOT_ANALYZED, or th=
e
> >> > WhitespaceAnalyzer, or something else that would not split on "/".
> >> > =C2=A0 =C2=A0 path:xxxx.yyy
> >> >
> >> > In Luke, do you see 2 terms "xxxx" and "yyy", or just "xxxx.yyy", or
> >> > something else?
> >> >
> >> > Thanks,
> >> > Phil
> >> >
> >> > On Thu, Aug 6, 2009 at 1:03 PM, <ohaya@cox.net> wrote:
> >> > > Hi,
> >> > >
> >> > > In my indexer app (based on the IndexFiles.java demo), I am adding=
 the "path" field:
> >> > >
> >> > > =C2=A0 =C2=A0doc.add(new Field("path", f.getPath(), Field.Store.YE=
S, Field.Index.ANALYZED));
> >> > >
> >> > > Per Luke, the full path (e.g., "c:\....\xxxx.yyy") gets parsed, an=
d one of the terms (again, per Luke) is "xxxx", i.e., the actual file name,=
 but without the extension.
> >> > >
> >> > > Then, when I search with Luke for "path:xxxx", that succeeds, as e=
xpected, and when I search with Luke for "path:xxxx.yyy", that fails, as ex=
pected.
> >> > >
> >> > > But, if I search using the demo web app, for "path:xxxx.yyy", it s=
ucceeds.
> >> > >
> >> > > Since the Luke search for "path:xxxx.yyy" fails, I don't understan=
d why the web app search for "path:xxxx.yyy" would succeed?
> >> > >
> >> > > Thanks,
> >> > > Jim
> >> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41770-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 05:16:40 2009
Return-Path: <java-user-return-41770-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26923 invoked from network); 7 Aug 2009 05:16:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 05:16:40 -0000
Received: (qmail 27763 invoked by uid 500); 7 Aug 2009 05:16:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27674 invoked by uid 500); 7 Aug 2009 05:16:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27663 invoked by uid 99); 7 Aug 2009 05:16:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 05:16:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.95] (HELO smtp108.mail.in.yahoo.com) (202.86.5.95)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 07 Aug 2009 05:16:33 +0000
Received: (qmail 78121 invoked from network); 7 Aug 2009 05:16:09 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:References:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=Sr5Kqhx+yEMPZFbtREFNA2iE8YIUlT2k+1KWrMxP/Yskvpr1/41e+e4L1XfUVcVmTsJXE1Z1ZICWHdMtmk9r078OoiWe5npUuxeNhk/bgg4c/IeZvWwMvgfHeCRq2P+TSM3h/MX8vQrnOhVAw05epf8VlfDjwTKV3H4H+rfs638=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp108.mail.in.yahoo.com with SMTP; 7 Aug 2009 05:16:07 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: 6cAdWiEVM1mvvGdNCbmxpxfK.MX3vkO1NkqQDBCT9ZdoqllIKrrDcYk_lm9tSCkrBFB_x8Hz29fdTXwVhGcF463ohLHeJRjQat0OlJigW2O5fys99L2HZfWSW67l9w25obcR1HSy9NKLSDPUI3ikZPhiVzhb9VSDkM45WVN0m5rn9My4fEkBi_L_BUkqBcKcBFD5tSGn7adPQUzffXalnFBJhmVPLJzd
X-Yahoo-Newman-Property: ymail-3
Message-ID: <005601ca171e$2cb18690$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
References: <001201ca1674$a3bab4a0$710bc30a@sv.us.sonicwall.com>
Subject: Re: Same field could be part of Query and filter
Date: Fri, 7 Aug 2009 10:45:59 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

Any idea on this.Basically i require Filter of Filters.=20

I want a single field to be part of Filter and Query
Filter: User1@domain.com, User2@domain.com User3@domain.com
Query: User1@domain.com OR User1

My requirement a group admin of 3 Users could view only 3 members data =
and he should also perform some search to retrieve data corresponds to =
any single User.=20

Any suggestions are highly appreciated.=20

Regards
Ganesh

----- Original Message -----=20
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
Sent: Thursday, August 06, 2009 2:32 PM
Subject: Same field could be part of Query and filter


Hello all,

I am having a field UserID, for every record. The results will be =
filtered for every User based on this field. We have a feature of group =
admin where a admin could view all records of a set of Users. I could =
manage to do by filtering on the set of IDs.=20

I have doubt in the below scenerio:
When a admin of 3 Users want to view only one particular User records. =
In this case he may give full UserID or some prefix. I need to use this =
field as part of Query and also Filter will have 3 Users.=20
Filter: User1@domain.com, User2@domain.com User3@domain.com
Query: User1=20

Whether this approach will work fine? Is there any other better approach =
to handle this group admin? Please note group members may change often =
and i cannot index group name or ID along with the record.=20

Regards
Ganesh=20
Send instant messages to your online friends =
http://in.messenger.yahoo.com=20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41771-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 09:26:46 2009
Return-Path: <java-user-return-41771-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98806 invoked from network); 7 Aug 2009 09:26:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 09:26:46 -0000
Received: (qmail 47434 invoked by uid 500); 7 Aug 2009 09:26:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47344 invoked by uid 500); 7 Aug 2009 09:26:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47334 invoked by uid 99); 7 Aug 2009 09:26:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 09:26:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 72.14.220.155 as permitted sender)
Received: from [72.14.220.155] (HELO fg-out-1718.google.com) (72.14.220.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 09:26:43 +0000
Received: by fg-out-1718.google.com with SMTP id l27so68863fgb.4
        for <java-user@lucene.apache.org>; Fri, 07 Aug 2009 02:26:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=Z/DIo9eaQUjxsYqEPhBmdErV1NWGkjKY7oTZ/vdYvyo=;
        b=iZKIlZqCdjz9DeTC99NznXoD8e6f4SXU4rs6nLe6SOIMn6Ts1tfw8zDpSc05F8I518
         YG4w79tHc8tAcNPOprqt2/jvO66mE52Um4uS9ozQsdgEDlnjToRrgcwhufWOjeKPBc7L
         NJN0OqzUwVcGYNzxmNBPs6PEM9k8BLvqnQx30=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=unyA6AyKbWhpMpYmbl3E0ImUF5cttCaBByfYQqVtPIb/w/ovTlRq5jbCnAqulO0X+m
         88mJegOQnSuGjJ8NYL4p6JeqmpG3o/1Of/tzEs36KhT3FP9pDv+JkTNcnY79UyzFt7Wd
         VhXYRFtZuOYa3Li0wJMH3A30zv7FwwJZCpPFI=
MIME-Version: 1.0
Received: by 10.86.51.20 with SMTP id y20mr724646fgy.72.1249637182137; Fri, 07 
	Aug 2009 02:26:22 -0700 (PDT)
In-Reply-To: <BAFDED91EF7D5A43A30F897D6C94B1283B4D6F4D57@MBX.ad.sdsc.edu>
References: <008201ca0a33$b1f0d240$15d276c0$@com> <BAFDED91EF7D5A43A30F897D6C94B128388101B218@MBX.ad.sdsc.edu> 
	<BAFDED91EF7D5A43A30F897D6C94B1283B4D6F4D26@MBX.ad.sdsc.edu> 
	<867513fe0908060225y7fb34e0p86358cd83424cc4c@mail.gmail.com> 
	<BAFDED91EF7D5A43A30F897D6C94B1283B4D6F4D57@MBX.ad.sdsc.edu>
From: Ian Lea <ian.lea@gmail.com>
Date: Fri, 7 Aug 2009 10:26:02 +0100
Message-ID: <8c4e68610908070226h6e2a4bf9m558ac2a0a14e2c7c@mail.gmail.com>
Subject: Re: Analysis Question
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

You could write your own analyzer that worked out a boost as it
analyzed the document fields and had a getBoost() method that you
would call to get the value to add to the document as a separate
field.  If you write your own you can pass it what you like and it can
do whatever you want.


--
Ian.

On Thu, Aug 6, 2009 at 8:37 PM, Christopher Condit<condit@sdsc.edu> wrote:
> Hi Anshum-
>> You might want to look at writing a custom analyzer or something and
>> add a
>> document boost (while indexing) for documents containing those terms.
>
> Do you know how to access the document from an analyzer? It seems to only have access to the field...
>
> Thanks,
> -Chris
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41772-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 10:22:40 2009
Return-Path: <java-user-return-41772-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29780 invoked from network); 7 Aug 2009 10:22:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 10:22:40 -0000
Received: (qmail 6901 invoked by uid 500); 7 Aug 2009 10:22:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6816 invoked by uid 500); 7 Aug 2009 10:22:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6806 invoked by uid 99); 7 Aug 2009 10:22:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 10:22:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 72.14.220.158 as permitted sender)
Received: from [72.14.220.158] (HELO fg-out-1718.google.com) (72.14.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 10:22:35 +0000
Received: by fg-out-1718.google.com with SMTP id 22so369999fge.4
        for <java-user@lucene.apache.org>; Fri, 07 Aug 2009 03:22:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=SGinFx2pFN5JW4PiJaetNfL064hrlPrQskE4QOtjrck=;
        b=iQ50BlSAz0KDiBJjOI5paVsXtvWnDti2Cq5YjNasjH4ZQi/Qr/aqbiYwyGCivoj7vP
         03ehVYMR9UTHrR1BGB97KtLESIIG7CMpVs/ADPVZCGF4B/F6RbQGFddw+3Uceozu5fRs
         LAiQ4ne64TpmLgLRp1rELhv7GDn5V4aWAEhy4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=ak5zWTbjRmq4bB8TvKWw65vsAt3aNu+c0b8xDhFIIRYeXY72mTqNW0bl1hDFbmpCIs
         1Yo4op2vOZaRbFiJcOKiFHttdwcLi10bHx1tOlF2gauUk8PiwbR48uqsKlosfca/+jqD
         783R0dHIdUq2uhOsezeCHPegrBaH0nvX6vCsw=
MIME-Version: 1.0
Received: by 10.86.76.4 with SMTP id y4mr793868fga.22.1249640535087; Fri, 07 
	Aug 2009 03:22:15 -0700 (PDT)
In-Reply-To: <20090807003600.986OW.45601.imail@eastrmwml37>
References: <9cafbc680908061909n3a4c01fp62e349cc89104b62@mail.gmail.com> 
	<20090807003600.986OW.45601.imail@eastrmwml37>
From: Ian Lea <ian.lea@gmail.com>
Date: Fri, 7 Aug 2009 11:21:55 +0100
Message-ID: <8c4e68610908070321s2790c687md1a10feea81e208a@mail.gmail.com>
Subject: Re: Why does this search succeed with web app, but not Luke?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

It is a good general assumption that Luke is correct.

Can you confirm that you are using StandardAnalyzer everywhere, for
indexing and searching?  This sort of issue is often caused by using
different analyzers.

What does Luke show as the indexed terms for path?  In a little index
I've just created with StandardAnalyzer and file paths Luke is showing
xxx.yyy as a term and not xxx.  The opposite to what you have.

There was a thread yesterday about acronyms which might be relevant.
As might writing a tiny self-contained program that indexes a few
paths and displays the terms that have been indexed and runs a few
searches.


--
Ian.


On Fri, Aug 7, 2009 at 5:36 AM, <ohaya@cox.net> wrote:
> Hi Phil,
>
> Well, kind of... but...
>
> Then, why, when I do the search in Luke, do I get the results I cited:
>
> xxxx =A0=3D=3D> succeeds
>
> xxxx.yyy =A0=3D=3D> fails (no results)
>
> I guess that I've been assuming that the search in Luke is "correct" and =
I've been using that to "test my understanding", but maybe that's an invali=
d assumption?
>
> Jim
>
>
>
>
>
> ---- Phil Whelan <phil123@gmail.com> wrote:
>> Hi Jim,
>>
>> > As I said, based on the terms in Luke, I would have expected a web app=
 query on:
>> >
>> > path:file-1-2
>> >
>> > to succeed, and a query on:
>> >
>> > path:file-1-2.dat
>> > to fail.
>> >
>> > But, instead both of those succeed when I do a web query.
>>
>> This query will also pass through the same (hopefully) Analyzer and
>> will be broken into terms. So the query will actually be for
>> "file-1-2" and "dat" where "file-1-2" is followed immediately by
>> "dat".
>>
>> In indexing the terms position is stored, so
>> "C:\dir1\dir2\file-1-1.dat" becomes...
>> [0] c
>> [1] dir1
>> [2] dir2
>> [3] file-1-1
>> [4] dat
>>
>> "file-1-1" is followed by "dat", so there is a match.
>>
>> Does that make sense?
>>
>> Cheers,
>> Phil
>>
>> >
>> > Jim
>> >
>> >
>> > ---- ohaya@cox.net wrote:
>> >> Phil,
>> >>
>> >> Both my indexer and the webapp are basically from the Lucene demos, t=
he indexer starting with the IndexFiles.java demo code, so I think they're =
both using the StandardAnalyzer.
>> >>
>> >> What appears in Luke, when I select "path" is just the filename part,=
 without the extension, i.e., the "xxxx" part.
>> >>
>> >> That's why I said in my original post that I was kind of surprised th=
at doing a web query for "path:xxxx.yyy" succeeded, i.e, in the path field =
in the index, there is no "xxxx.yyy", just "xxxx".
>> >>
>> >> Jim
>> >>
>> >> ---- Phil Whelan <phil123@gmail.com> wrote:
>> >> > Hi Jim,
>> >> >
>> >> > Are you using the same Analyzer for indexing and searching? xxxx.yy=
y
>> >> > will be seem as a HOSTNAME by StandardAnalyzer and will keep it as =
one
>> >> > term, whereas another indexer might split this into 2 terms. This
>> >> > should not matter either way as long as you are using the same
>> >> > Analyzer for both indexing and searching.
>> >> >
>> >> > I would expect this to pass unless you are using NOT_ANALYZED, or t=
he
>> >> > WhitespaceAnalyzer, or something else that would not split on "/".
>> >> > =A0 =A0 path:xxxx.yyy
>> >> >
>> >> > In Luke, do you see 2 terms "xxxx" and "yyy", or just "xxxx.yyy", o=
r
>> >> > something else?
>> >> >
>> >> > Thanks,
>> >> > Phil
>> >> >
>> >> > On Thu, Aug 6, 2009 at 1:03 PM, <ohaya@cox.net> wrote:
>> >> > > Hi,
>> >> > >
>> >> > > In my indexer app (based on the IndexFiles.java demo), I am addin=
g the "path" field:
>> >> > >
>> >> > > =A0 =A0doc.add(new Field("path", f.getPath(), Field.Store.YES, Fi=
eld.Index.ANALYZED));
>> >> > >
>> >> > > Per Luke, the full path (e.g., "c:\....\xxxx.yyy") gets parsed, a=
nd one of the terms (again, per Luke) is "xxxx", i.e., the actual file name=
, but without the extension.
>> >> > >
>> >> > > Then, when I search with Luke for "path:xxxx", that succeeds, as =
expected, and when I search with Luke for "path:xxxx.yyy", that fails, as e=
xpected.
>> >> > >
>> >> > > But, if I search using the demo web app, for "path:xxxx.yyy", it =
succeeds.
>> >> > >
>> >> > > Since the Luke search for "path:xxxx.yyy" fails, I don't understa=
nd why the web app search for "path:xxxx.yyy" would succeed?
>> >> > >
>> >> > > Thanks,
>> >> > > Jim
>> >> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41773-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 10:27:43 2009
Return-Path: <java-user-return-41773-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32278 invoked from network); 7 Aug 2009 10:27:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 10:27:43 -0000
Received: (qmail 14076 invoked by uid 500); 7 Aug 2009 10:27:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13995 invoked by uid 500); 7 Aug 2009 10:27:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13984 invoked by uid 99); 7 Aug 2009 10:27:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 10:27:47 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.202.165.38] (HELO smtpauth21.prod.mesa1.secureserver.net) (64.202.165.38)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 07 Aug 2009 10:27:37 +0000
Received: (qmail 15844 invoked from network); 7 Aug 2009 10:27:13 -0000
Received: from unknown (81.219.54.251)
  by smtpauth21.prod.mesa1.secureserver.net (64.202.165.38) with ESMTP; 07 Aug 2009 10:27:13 -0000
Message-ID: <4A7C017C.1010201@getopt.org>
Date: Fri, 07 Aug 2009 12:27:08 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 2.0.0.22 (Windows/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Why does this search succeed with web app, but not Luke?
References: <20090807003600.986OW.45601.imail@eastrmwml37>
In-Reply-To: <20090807003600.986OW.45601.imail@eastrmwml37>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

ohaya@cox.net wrote:
> Hi Phil,
> 
> Well, kind of... but...
> 
> Then, why, when I do the search in Luke, do I get the results I cited:
> 
> xxxx  ==> succeeds
> 
> xxxx.yyy  ==> fails (no results)
> 
> I guess that I've been assuming that the search in Luke is "correct" and I've been using that to "test my understanding", but maybe that's an invalid assumption?

Luke has some bugs, that's for sure, but not as many as one would think 
;) I recommend the following exercise:

* first, check what the "Rewritten" query looks like, in both cases. 
This could be enlightening, because depending on the choice of default 
field and query analyzer results could differ dramatically.

* then, if a query succeeds in matching one or more documents, open this 
document and view its fields using "Reconstruct & edit", especially the 
"Tokenized" version of the field. At this point any potential mismatch 
in query terms vs. analyzed tokens in the field should become apparent.

-- 
Best regards,
Andrzej Bialecki     <><
  ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41774-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 11:11:16 2009
Return-Path: <java-user-return-41774-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47772 invoked from network); 7 Aug 2009 11:11:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 11:11:16 -0000
Received: (qmail 65307 invoked by uid 500); 7 Aug 2009 11:11:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65227 invoked by uid 500); 7 Aug 2009 11:11:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65217 invoked by uid 99); 7 Aug 2009 11:11:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 11:11:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 11:11:11 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MZNLW-00016A-Sx
	for java-user@lucene.apache.org; Fri, 07 Aug 2009 04:10:50 -0700
Message-ID: <24862928.post@talk.nabble.com>
Date: Fri, 7 Aug 2009 04:10:50 -0700 (PDT)
From: "m.harig" <m.harig@gmail.com>
To: java-user@lucene.apache.org
Subject: reading index
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.harig@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


hello all,

              thanks to lucene. Am using lucene 2.4.0 for my application. My
doubt is , can i read the index for many number of times? i mean , i've a
search application which reads the index , which is 300MB in size, am
reading my index at every time the user hits the page . Is it good to read
index at every time? or else is there any caching technique to handle  this?
-- 
View this message in context: http://www.nabble.com/reading-index-tp24862928p24862928.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41775-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 11:17:58 2009
Return-Path: <java-user-return-41775-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49297 invoked from network); 7 Aug 2009 11:17:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 11:17:58 -0000
Received: (qmail 78495 invoked by uid 500); 7 Aug 2009 11:18:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78429 invoked by uid 500); 7 Aug 2009 11:18:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78419 invoked by uid 99); 7 Aug 2009 11:18:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 11:18:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 72.14.220.153 as permitted sender)
Received: from [72.14.220.153] (HELO fg-out-1718.google.com) (72.14.220.153)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 11:17:55 +0000
Received: by fg-out-1718.google.com with SMTP id l27so82054fgb.4
        for <java-user@lucene.apache.org>; Fri, 07 Aug 2009 04:17:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=rCCdGwiQweg/iscHx6WkyyZGd0R95teK+o2VocqErmI=;
        b=k5qYDO2bh1nPuuk6DyFjERhwupopR668UXG1E3doNO4TTe4WLPk1oEhjifJyr2VCjn
         eVeCV+m+pUkV1BvnIfkBDTNvqQUaSyFHlqhOPe8Dwev9kGcybVAW5/OcQV549elgjdLg
         ACS25KpVuJh8l2ueWmQ8QCxnymOgcp4NWyudA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=YOIT6d4lzhIxBlD4FuUZp/FaJsYYbTkl2BJBdcj3ramAT7Ip3a64zqiImMWpVmQ98J
         9F2ejW2p5Rs2XgH5nLy9UUJdBO1BzLh+yFZqZbmfLv8/rE6fqYgFGWFhB34ya5mciKr/
         xVGR3Id2mULM5oOIOVFgKHeyqZgl4s5+dOCw0=
MIME-Version: 1.0
Received: by 10.86.31.17 with SMTP id e17mr842836fge.47.1249643854059; Fri, 07 
	Aug 2009 04:17:34 -0700 (PDT)
In-Reply-To: <24862928.post@talk.nabble.com>
References: <24862928.post@talk.nabble.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Fri, 7 Aug 2009 12:17:14 +0100
Message-ID: <8c4e68610908070417x6de77451w621b184d85baa523@mail.gmail.com>
Subject: Re: reading index
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

It's not clear to me what you mean by reading the index every time.
If you mean that you open a new searcher for every search, then no,
it's not good.

If you mean that every search or paging request gets passed to lucene
then that is standard practice and is fine.

See http://wiki.apache.org/lucene-java/ImproveSearchingSpeed for loads
of good advice.


--
Ian.


On Fri, Aug 7, 2009 at 12:10 PM, m.harig<m.harig@gmail.com> wrote:
>
> hello all,
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0thanks to lucene. Am using lucene 2.4.0 for my=
 application. My
> doubt is , can i read the index for many number of times? i mean , i've a
> search application which reads the index , which is 300MB in size, am
> reading my index at every time the user hits the page . Is it good to rea=
d
> index at every time? or else is there any caching technique to handle =A0=
this?
> --

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41776-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 11:53:00 2009
Return-Path: <java-user-return-41776-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55065 invoked from network); 7 Aug 2009 11:53:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 11:53:00 -0000
Received: (qmail 3494 invoked by uid 500); 7 Aug 2009 11:53:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3414 invoked by uid 500); 7 Aug 2009 11:53:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3404 invoked by uid 99); 7 Aug 2009 11:53:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 11:53:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.94] (HELO smtp107.mail.in.yahoo.com) (202.86.5.94)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 07 Aug 2009 11:52:53 +0000
Received: (qmail 12956 invoked from network); 7 Aug 2009 11:52:30 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=OPyumdWt5xbN5lvscuS1Ua6wLs45pQh62gQ3NSkoCiSBaulCkGM5wW2TNnPHfKAuvr9Yk/yiNNdS6hNqsIE8pXe88H89QyUm0TZ94TPu0bB0R6predjlUsb8gumO1GKMT7MqrAN+UcW7YgG/OH6H5PnzycWQ2KyOvMbROZYWfCU=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp107.mail.in.yahoo.com with SMTP; 7 Aug 2009 11:52:29 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: SVRJLcEVM1mwNkli__VeyQVf1YssagnHeCe8jN1TQDatauru.WhplGSs_Oic3zAhM60ayiV.60_tQNnIO1j._.g1R38P8FDu9RG2G9P3Jh.rQyVHw0JSIP6aLfqmG6UKVx5D6pKAaIS2DXrMd4OSd.WI0Ra2sDPpBgl6eKQ78y_zrwbzQ8f0al0R75La
X-Yahoo-Newman-Property: ymail-3
Message-ID: <00a101ca1755$852f0270$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
Subject: Group Admin
Date: Fri, 7 Aug 2009 17:22:16 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

Hello all,

I am having a field UserID, for every record. The results will be =
filtered for every User based on this field. We have a feature of group =
admin where a admin could view all records of a set of Users. My =
requirement is a group admin of 3 Users could view only 3 members data =
and he should also perform some search to retrieve data corresponds to =
any single User.=20

I have doubt in the below scenerio:
Filter: User1@domain.com, User2@domain.com User3@domain.com
Query: User1@domain.com OR User1

Whether single field be part of Query and Filter?

Is there any better solution to handle this?
=20
Please note group members may change often and i cannot index group name =
or ID along with the record.=20

Regards
Ganesh=20

Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41777-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 12:37:53 2009
Return-Path: <java-user-return-41777-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71710 invoked from network); 7 Aug 2009 12:37:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 12:37:53 -0000
Received: (qmail 54415 invoked by uid 500); 7 Aug 2009 12:37:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54351 invoked by uid 500); 7 Aug 2009 12:37:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54341 invoked by uid 99); 7 Aug 2009 12:37:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 12:37:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 12:37:47 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n77CbL8H023579
	for <java-user@lucene.apache.org>; Fri, 7 Aug 2009 08:37:25 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <4A7C2000.7000405@informatics.jax.org>
Date: Fri, 07 Aug 2009 08:37:20 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.22 (Windows/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Why does this search succeed with web app, but not Luke?
References: <20090807003600.986OW.45601.imail@eastrmwml37> <4A7C017C.1010201@getopt.org>
In-Reply-To: <4A7C017C.1010201@getopt.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.5.7.378829, Antispam-Engine: 2.7.2.376379, Antispam-Data: 2009.8.7.122417
X-PerlMx-Spam: Gauge=IIIIIIII, Probability=8%, Report='
 BODY_SIZE_1300_1399 0, BODY_SIZE_2000_LESS 0, BODY_SIZE_5000_LESS 0, BODY_SIZE_7000_LESS 0, TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __C230066_P5 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __HAS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __MOZILLA_MSGID 0, __SANE_MSGID 0, __TO_MALFORMED_2 0, __URI_NS , __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

Luke defaults to KeywordAnalyzer when you do a search on it.  You have 
to specifically choose StandardAnalyzer.  You are probably already doing 
this, but I figure its worth a check.

Matt

Andrzej Bialecki wrote:
> ohaya@cox.net wrote:
>> Hi Phil,
>>
>> Well, kind of... but...
>>
>> Then, why, when I do the search in Luke, do I get the results I cited:
>>
>> xxxx  ==> succeeds
>>
>> xxxx.yyy  ==> fails (no results)
>>
>> I guess that I've been assuming that the search in Luke is "correct" 
>> and I've been using that to "test my understanding", but maybe that's 
>> an invalid assumption?
>
> Luke has some bugs, that's for sure, but not as many as one would 
> think ;) I recommend the following exercise:
>
> * first, check what the "Rewritten" query looks like, in both cases. 
> This could be enlightening, because depending on the choice of default 
> field and query analyzer results could differ dramatically.
>
> * then, if a query succeeds in matching one or more documents, open 
> this document and view its fields using "Reconstruct & edit", 
> especially the "Tokenized" version of the field. At this point any 
> potential mismatch in query terms vs. analyzed tokens in the field 
> should become apparent.
>


-- 
Matthew Hall
Software Engineer
Mouse Genome Informatics
mhall@informatics.jax.org
(207) 288-6012



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41778-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 13:00:38 2009
Return-Path: <java-user-return-41778-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77826 invoked from network); 7 Aug 2009 13:00:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 13:00:38 -0000
Received: (qmail 2527 invoked by uid 500); 7 Aug 2009 13:00:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2450 invoked by uid 500); 7 Aug 2009 13:00:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2399 invoked by uid 99); 7 Aug 2009 13:00:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 13:00:39 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a16.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 13:00:28 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a16.g.dreamhost.com (Postfix) with ESMTP id 9D9E57B3D3;
	Fri,  7 Aug 2009 06:00:06 -0700 (PDT)
Cc: solr-user@lucene.apache.org
Message-Id: <E760475E-F3D1-4CE2-95DC-72CD53B39593@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Language Detection for Analysis?
Date: Fri, 7 Aug 2009 09:00:05 -0400
References: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

There are several free Language Detection libraries out there, as well  
as a few commercial ones.  I think Karl Wettin has even written one as  
a plugin for Lucene.  Nutch also has one, AIUI.  I would just Google  
"language detection".

Also see http://www.lucidimagination.com/search/?q=language+detection,  
as this has been brought up many times before and I'm sure there are  
links in the archives.

On Aug 6, 2009, at 3:46 PM, Bradford Stephens wrote:

> Hey there,
>
> We're trying to add foreign language support into our new search
> engine -- languages like Arabic, Farsi, and Urdu (that don't work with
> standard analyzers). But our data source doesn't tell us which
> languages we're actually collecting -- we just get blocks of text. Has
> anyone here worked on language detection so we can figure out what
> analyzers to use? Are there commercial solutions?
>
> Much appreciated!
>
> -- 
> http://www.roadtofailure.com -- The Fringes of Scalability, Social
> Media, and Computer Science
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41779-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 13:04:49 2009
Return-Path: <java-user-return-41779-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79026 invoked from network); 7 Aug 2009 13:04:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 13:04:49 -0000
Received: (qmail 12185 invoked by uid 500); 7 Aug 2009 13:04:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12113 invoked by uid 500); 7 Aug 2009 13:04:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12103 invoked by uid 99); 7 Aug 2009 13:04:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 13:04:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.9] (HELO eastrmmtao103.cox.net) (68.230.240.9)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 13:04:39 +0000
Received: from eastrmimpo03.cox.net ([68.1.16.126])
          by eastrmmtao103.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090807130418.EDJK27176.eastrmmtao103.cox.net@eastrmimpo03.cox.net>;
          Fri, 7 Aug 2009 09:04:18 -0400
Received: from eastrmwml31 ([172.18.18.217])
	by eastrmimpo03.cox.net with bizsmtp
	id RR4J1c0024h0NJL02R4JPk; Fri, 07 Aug 2009 09:04:18 -0400
X-VR-Score: -200.00
X-Authority-Analysis: v=1.0 c=1 a=wTB1bo__o_gA:10 a=pGLkceISAAAA:8
 a=kviXuzpPAAAA:8 a=mV9VRH-2AAAA:8 a=4LA2vbobW45slbrDcEkA:9
 a=Kfa04o7uaCmm5LTuss4A:7 a=MGAC5Z7U-uuS2fYfJtyCmPaA-KwA:4 a=MSl-tDqOz04A:10
 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Fri, 7 Aug 2009 9:04:18 -0400
Message-ID: <20090807090418.6LOT7.49197.imail@eastrmwml31>
Date: Fri, 7 Aug 2009 9:04:18 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Why does this search succeed with web app, but not Luke?
Cc: Ian Lea <ian.lea@gmail.com>
In-Reply-To: <8c4e68610908070321s2790c687md1a10feea81e208a@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Ian,

I just re-confirmed that StandardAnalyzer is used in both my indexer app an=
d in the query/search web app.

The actual file paths look like:

C:\lucene-devel\dat\xxxxxxxxxxxxxxxx.dat
or
C:\lucene-devel\data\testdir\\xxxxxxxxxxxxxxxx.dat

For field "path", Luke shows:

lucene
data
c
devel
dat
testdir
xxxxxxxxxxxxxxxxxxxxxxxxxxx
.
.
zzzzzzzzzzzzzzzzzzzzzzzzzzzz


where "xxxxxxxxxxxxxxxx" and "zzzzzzzzzzzzzzzzz" are the left part (to the =
left of the ".") of filenames.

So, it seems like you're correct, that what you're seeing is the opposite f=
rom what I'm seeing :(??

Again, the actual code in my indexer has:

 doc.add(new Field("path", f.getPath(), Field.Store.YES, Field.Index.ANALYZ=
ED));

(and again, the indexer uses StandardAnalyzer).

Is that different from what you did in your "little" index test?

Jim




---- Ian Lea <ian.lea@gmail.com> wrote:=20
> It is a good general assumption that Luke is correct.
>=20
> Can you confirm that you are using StandardAnalyzer everywhere, for
> indexing and searching?  This sort of issue is often caused by using
> different analyzers.
>=20
> What does Luke show as the indexed terms for path?  In a little index
> I've just created with StandardAnalyzer and file paths Luke is showing
> xxx.yyy as a term and not xxx.  The opposite to what you have.
>=20
> There was a thread yesterday about acronyms which might be relevant.
> As might writing a tiny self-contained program that indexes a few
> paths and displays the terms that have been indexed and runs a few
> searches.
>=20
>=20
> --
> Ian.
>=20
>=20
> On Fri, Aug 7, 2009 at 5:36 AM, <ohaya@cox.net> wrote:
> > Hi Phil,
> >
> > Well, kind of... but...
> >
> > Then, why, when I do the search in Luke, do I get the results I cited:
> >
> > xxxx =C2=A0=3D=3D> succeeds
> >
> > xxxx.yyy =C2=A0=3D=3D> fails (no results)
> >
> > I guess that I've been assuming that the search in Luke is "correct" an=
d I've been using that to "test my understanding", but maybe that's an inva=
lid assumption?
> >
> > Jim
> >
> >
> >
> >
> >
> > ---- Phil Whelan <phil123@gmail.com> wrote:
> >> Hi Jim,
> >>
> >> > As I said, based on the terms in Luke, I would have expected a web a=
pp query on:
> >> >
> >> > path:file-1-2
> >> >
> >> > to succeed, and a query on:
> >> >
> >> > path:file-1-2.dat
> >> > to fail.
> >> >
> >> > But, instead both of those succeed when I do a web query.
> >>
> >> This query will also pass through the same (hopefully) Analyzer and
> >> will be broken into terms. So the query will actually be for
> >> "file-1-2" and "dat" where "file-1-2" is followed immediately by
> >> "dat".
> >>
> >> In indexing the terms position is stored, so
> >> "C:\dir1\dir2\file-1-1.dat" becomes...
> >> [0] c
> >> [1] dir1
> >> [2] dir2
> >> [3] file-1-1
> >> [4] dat
> >>
> >> "file-1-1" is followed by "dat", so there is a match.
> >>
> >> Does that make sense?
> >>
> >> Cheers,
> >> Phil
> >>
> >> >
> >> > Jim
> >> >
> >> >
> >> > ---- ohaya@cox.net wrote:
> >> >> Phil,
> >> >>
> >> >> Both my indexer and the webapp are basically from the Lucene demos,=
 the indexer starting with the IndexFiles.java demo code, so I think they'r=
e both using the StandardAnalyzer.
> >> >>
> >> >> What appears in Luke, when I select "path" is just the filename par=
t, without the extension, i.e., the "xxxx" part.
> >> >>
> >> >> That's why I said in my original post that I was kind of surprised =
that doing a web query for "path:xxxx.yyy" succeeded, i.e, in the path fiel=
d in the index, there is no "xxxx.yyy", just "xxxx".
> >> >>
> >> >> Jim
> >> >>
> >> >> ---- Phil Whelan <phil123@gmail.com> wrote:
> >> >> > Hi Jim,
> >> >> >
> >> >> > Are you using the same Analyzer for indexing and searching? xxxx.=
yyy
> >> >> > will be seem as a HOSTNAME by StandardAnalyzer and will keep it a=
s one
> >> >> > term, whereas another indexer might split this into 2 terms. This
> >> >> > should not matter either way as long as you are using the same
> >> >> > Analyzer for both indexing and searching.
> >> >> >
> >> >> > I would expect this to pass unless you are using NOT_ANALYZED, or=
 the
> >> >> > WhitespaceAnalyzer, or something else that would not split on "/"=
.
> >> >> > =C2=A0 =C2=A0 path:xxxx.yyy
> >> >> >
> >> >> > In Luke, do you see 2 terms "xxxx" and "yyy", or just "xxxx.yyy",=
 or
> >> >> > something else?
> >> >> >
> >> >> > Thanks,
> >> >> > Phil
> >> >> >
> >> >> > On Thu, Aug 6, 2009 at 1:03 PM, <ohaya@cox.net> wrote:
> >> >> > > Hi,
> >> >> > >
> >> >> > > In my indexer app (based on the IndexFiles.java demo), I am add=
ing the "path" field:
> >> >> > >
> >> >> > > =C2=A0 =C2=A0doc.add(new Field("path", f.getPath(), Field.Store=
.YES, Field.Index.ANALYZED));
> >> >> > >
> >> >> > > Per Luke, the full path (e.g., "c:\....\xxxx.yyy") gets parsed,=
 and one of the terms (again, per Luke) is "xxxx", i.e., the actual file na=
me, but without the extension.
> >> >> > >
> >> >> > > Then, when I search with Luke for "path:xxxx", that succeeds, a=
s expected, and when I search with Luke for "path:xxxx.yyy", that fails, as=
 expected.
> >> >> > >
> >> >> > > But, if I search using the demo web app, for "path:xxxx.yyy", i=
t succeeds.
> >> >> > >
> >> >> > > Since the Luke search for "path:xxxx.yyy" fails, I don't unders=
tand why the web app search for "path:xxxx.yyy" would succeed?
> >> >> > >
> >> >> > > Thanks,
> >> >> > > Jim
> >> >> >
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41780-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 13:19:07 2009
Return-Path: <java-user-return-41780-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82276 invoked from network); 7 Aug 2009 13:19:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 13:19:07 -0000
Received: (qmail 35546 invoked by uid 500); 7 Aug 2009 13:19:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35487 invoked by uid 500); 7 Aug 2009 13:19:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35477 invoked by uid 99); 7 Aug 2009 13:19:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 13:19:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.59] (HELO eastrmmtao107.cox.net) (68.230.240.59)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 13:19:00 +0000
Received: from eastrmimpo03.cox.net ([68.1.16.126])
          by eastrmmtao107.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090807131838.STZL22474.eastrmmtao107.cox.net@eastrmimpo03.cox.net>;
          Fri, 7 Aug 2009 09:18:38 -0400
Received: from eastrmwml31 ([172.18.18.217])
	by eastrmimpo03.cox.net with bizsmtp
	id RRJf1c0084h0NJL02RJfK4; Fri, 07 Aug 2009 09:18:39 -0400
X-VR-Score: -200.00
X-Authority-Analysis: v=1.0 c=1 a=wTB1bo__o_gA:10 a=jZg1KOQpAAAA:8
 a=kviXuzpPAAAA:8 a=ILaJjJbXAAAA:8 a=mV9VRH-2AAAA:8 a=hGmxhEaYKHy6IWQyLAoA:9
 a=1hc6DXUPPnIpu-KQAA1aK3sx31oA:4 a=FC_DRKn5ziYA:10 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Fri, 7 Aug 2009 9:18:39 -0400
Message-ID: <20090807091840.TUWUH.49360.imail@eastrmwml31>
Date: Fri, 7 Aug 2009 9:18:40 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Why does this search succeed with web app, but not Luke?
Cc: Andrzej Bialecki <ab@getopt.org>
In-Reply-To: <4A7C017C.1010201@getopt.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Andrzej,

Hah!  

I tried as you suggested using Luke, and I found at least part of my problem.  Luke was defaulting to KeywordAnalyzer.  

I changed that to StandardAnalyzer, and did queries for:

path:xxxxxxxxxxxxxxxxxxxxx

and

path:xxxxxxxxxxxxxxxxxxxxxx.dat

For the first, the Rewritten was:

path:xxxxxxxxxxxxxxxxxxxxx

and found 1 document.

For the 2nd, the Rewritten was:

path:"xxxxxxxxxxxxxxxxxxxxxx.dat"

and found 1 document.

So, at least now the Luke search results are the same as what I'm seeing in the luceneweb web query.

With the 2nd query, I did "Explain structure" and it shows:

Term 0: field='path' text='xxxxxxxxxxxxxxxxxx'
Term 1: field='path' text='dat'

So, going back to Phil Whelan's explanation in his email yesterday:

====================================
This query will also pass through the same (hopefully) Analyzer and 
will be broken into terms. So the query will actually be for 
"file-1-2" and "dat" where "file-1-2" is followed immediately by 
"dat". 
 
In indexing the terms position is stored, so 
"C:\dir1\dir2\file-1-1.dat" becomes... 
[0] c 
[1] dir1 
[2] dir2 
[3] file-1-1 
[4] dat 
 
"file-1-1" is followed by "dat", so there is a match. 
========================================

I think the above explains things.

So, the bottom line was that with Luke, it was using KeywordAnalyzer.

When I switched Luke to using StandardAnalyzer, the Luke query results matched my web query results.

THANKS!!  I feel better now :)...

Later,
Jim

---- Andrzej Bialecki <ab@getopt.org> wrote: 
> ohaya@cox.net wrote:
> > Hi Phil,
> > 
> > Well, kind of... but...
> > 
> > Then, why, when I do the search in Luke, do I get the results I cited:
> > 
> > xxxx  ==> succeeds
> > 
> > xxxx.yyy  ==> fails (no results)
> > 
> > I guess that I've been assuming that the search in Luke is "correct" and I've been using that to "test my understanding", but maybe that's an invalid assumption?
> 
> Luke has some bugs, that's for sure, but not as many as one would think 
> ;) I recommend the following exercise:
> 
> * first, check what the "Rewritten" query looks like, in both cases. 
> This could be enlightening, because depending on the choice of default 
> field and query analyzer results could differ dramatically.
> 
> * then, if a query succeeds in matching one or more documents, open this 
> document and view its fields using "Reconstruct & edit", especially the 
> "Tokenized" version of the field. At this point any potential mismatch 
> in query terms vs. analyzed tokens in the field should become apparent.
> 
> -- 
> Best regards,
> Andrzej Bialecki     <><
>   ___. ___ ___ ___ _ _   __________________________________
> [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
> ___|||__||  \|  ||  |  Embedded Unix, System Integration
> http://www.sigram.com  Contact: info at sigram dot com
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41781-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 13:22:12 2009
Return-Path: <java-user-return-41781-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82993 invoked from network); 7 Aug 2009 13:22:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 13:22:12 -0000
Received: (qmail 43097 invoked by uid 500); 7 Aug 2009 13:22:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43034 invoked by uid 500); 7 Aug 2009 13:22:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43024 invoked by uid 99); 7 Aug 2009 13:22:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 13:22:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.8] (HELO eastrmmtao102.cox.net) (68.230.240.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 13:22:07 +0000
Received: from eastrmimpo02.cox.net ([68.1.16.120])
          by eastrmmtao102.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090807132147.CJLT22890.eastrmmtao102.cox.net@eastrmimpo02.cox.net>;
          Fri, 7 Aug 2009 09:21:47 -0400
Received: from eastrmwml31 ([172.18.18.217])
	by eastrmimpo02.cox.net with bizsmtp
	id RRMm1c0044h0NJL02RMmH5; Fri, 07 Aug 2009 09:21:46 -0400
X-VR-Score: -200.00
X-Authority-Analysis: v=1.0 c=1 a=wTB1bo__o_gA:10 a=5FlMPbC-AAAA:8
 a=kviXuzpPAAAA:8 a=mV9VRH-2AAAA:8 a=94t4TgFdMVrEydgbME0A:9
 a=JnD7aRziyw2EOUDNbDcA:7 a=bnIjpQkGuIfZSptrFjK-r-zLuLwA:4 a=9IoNP7fiwc0A:10
 a=snjK10GI3ygA:10 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Fri, 7 Aug 2009 9:21:46 -0400
Message-ID: <20090807092147.GERGV.49387.imail@eastrmwml31>
Date: Fri, 7 Aug 2009 9:21:47 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Why does this search succeed with web app, but not Luke?
Cc: Matthew Hall <mhall@informatics.jax.org>
In-Reply-To: <4A7C2000.7000405@informatics.jax.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Matt,

Good catch!  As I just posted, I *just* noticed that (Luke use Keyword Analyzer) :)!!!

Once I switched Luke to using Standard Analyzer, the Luke search results matched my web query results.

Thanks!

Jim



---- Matthew Hall <mhall@informatics.jax.org> wrote: 
> Luke defaults to KeywordAnalyzer when you do a search on it.  You have 
> to specifically choose StandardAnalyzer.  You are probably already doing 
> this, but I figure its worth a check.
> 
> Matt
> 
> Andrzej Bialecki wrote:
> > ohaya@cox.net wrote:
> >> Hi Phil,
> >>
> >> Well, kind of... but...
> >>
> >> Then, why, when I do the search in Luke, do I get the results I cited:
> >>
> >> xxxx  ==> succeeds
> >>
> >> xxxx.yyy  ==> fails (no results)
> >>
> >> I guess that I've been assuming that the search in Luke is "correct" 
> >> and I've been using that to "test my understanding", but maybe that's 
> >> an invalid assumption?
> >
> > Luke has some bugs, that's for sure, but not as many as one would 
> > think ;) I recommend the following exercise:
> >
> > * first, check what the "Rewritten" query looks like, in both cases. 
> > This could be enlightening, because depending on the choice of default 
> > field and query analyzer results could differ dramatically.
> >
> > * then, if a query succeeds in matching one or more documents, open 
> > this document and view its fields using "Reconstruct & edit", 
> > especially the "Tokenized" version of the field. At this point any 
> > potential mismatch in query terms vs. analyzed tokens in the field 
> > should become apparent.
> >
> 
> 
> -- 
> Matthew Hall
> Software Engineer
> Mouse Genome Informatics
> mhall@informatics.jax.org
> (207) 288-6012
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41782-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 14:35:53 2009
Return-Path: <java-user-return-41782-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21649 invoked from network); 7 Aug 2009 14:35:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 14:35:53 -0000
Received: (qmail 73097 invoked by uid 500); 7 Aug 2009 14:35:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72971 invoked by uid 500); 7 Aug 2009 14:35:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72741 invoked by uid 99); 7 Aug 2009 14:35:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 14:35:50 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of gresh@us.ibm.com designates 32.97.182.139 as permitted sender)
Received: from [32.97.182.139] (HELO e9.ny.us.ibm.com) (32.97.182.139)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 14:35:38 +0000
Received: from d01relay02.pok.ibm.com (d01relay02.pok.ibm.com [9.56.227.234])
	by e9.ny.us.ibm.com (8.14.3/8.13.1) with ESMTP id n77EYZUb028581
	for <java-user@lucene.apache.org>; Fri, 7 Aug 2009 10:34:35 -0400
Received: from d01av04.pok.ibm.com (d01av04.pok.ibm.com [9.56.224.64])
	by d01relay02.pok.ibm.com (8.13.8/8.13.8/NCO v10.0) with ESMTP id n77EZDpH181974
	for <java-user@lucene.apache.org>; Fri, 7 Aug 2009 10:35:13 -0400
Received: from d01av04.pok.ibm.com (loopback [127.0.0.1])
	by d01av04.pok.ibm.com (8.12.11.20060308/8.13.3) with ESMTP id n77EZC1U032306
	for <java-user@lucene.apache.org>; Fri, 7 Aug 2009 10:35:12 -0400
Received: from d01ml605.pok.ibm.com (d01ml605.pok.ibm.com [9.56.227.91])
	by d01av04.pok.ibm.com (8.12.11.20060308/8.12.11) with ESMTP id n77EZBeG032064
	for <java-user@lucene.apache.org>; Fri, 7 Aug 2009 10:35:11 -0400
To: java-user@lucene.apache.org
MIME-Version: 1.0
Subject: Is there a way for me to handle a multiword synonym correctly?
X-KeepSent: 9EE28971:13C52970-8525760B:00492E01;
 type=4; name=$KeepSent
X-Mailer: Lotus Notes Release 8.0.2 HF623 January 16, 2009
From: Donna L Gresh <gresh@us.ibm.com>
Message-ID: <OF9EE28971.13C52970-ON8525760B.00492E01-8525760B.00500726@us.ibm.com>
Date: Fri, 7 Aug 2009 10:35:10 -0400
X-MIMETrack: Serialize by Router on D01ML605/01/M/IBM(Build V851_07072009|July 07, 2009) at
 08/07/2009 10:35:10,
	Serialize complete at 08/07/2009 10:35:10
Content-Type: multipart/alternative; boundary="=_alternative 0050027C8525760B_="
X-Virus-Checked: Checked by ClamAV on apache.org

--=_alternative 0050027C8525760B_=
Content-Type: text/plain; charset="US-ASCII"

I saw some discussion on the board but I'm not sure I've got quite the 
same problem. As an example, I have a query that might be a technical 
skill:

SAP EM FIN AM

I would like that to match a document that has *either* SAP.EM.FIN.AM or 
"SAP EM FIN AM" (in that order and all together, not spread out through 
the document).

The approach I had tried was at index time if I saw SAP.EM.FIN.AM I would 
consider "SAP EM FIN AM" a synonym for it, using the Lucene in Action 
example. Luke shows me that I have two terms in the index for this 
document: SAP.EM.FIN.AM and "SAP EM FIN AM" (one term). Thus it appears 
differently in the index than if it had been organically found as just the 
string of tokens, in which case there would be separate terms for SAP, EM, 
and so on. 

At query time if I look for "SAP EM FIN AM" it is formed as a phrase query 
with a slop of 0 which does *not* match the one term version "SAP EM FIN 
AM". (For that matter a simple boolean query doesn't find it either) Luke 
confirms the fact that the phrase query does not find my synonym term. The 
query "SAP EM FIN AM" finds *only* documents that originally had those 
separated tokens in them.

Is there a way to handle this situation such that at index time I can turn 
SAP.EM.FIN.AM into something that will be found with a query for "SAP EM 
FIN AM"?

Thanks for any pointers

Donna 

--=_alternative 0050027C8525760B_=--

From java-user-return-41783-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 14:43:13 2009
Return-Path: <java-user-return-41783-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24938 invoked from network); 7 Aug 2009 14:43:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 14:43:13 -0000
Received: (qmail 83189 invoked by uid 500); 7 Aug 2009 14:43:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83109 invoked by uid 500); 7 Aug 2009 14:43:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83096 invoked by uid 99); 7 Aug 2009 14:43:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 14:43:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 14:43:09 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n77EgiCU002732
	for <java-user@lucene.apache.org>; Fri, 7 Aug 2009 10:42:47 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <4A7C3D64.7030806@informatics.jax.org>
Date: Fri, 07 Aug 2009 10:42:44 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.22 (Windows/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Is there a way for me to handle a multiword synonym correctly?
References: <OF9EE28971.13C52970-ON8525760B.00492E01-8525760B.00500726@us.ibm.com>
In-Reply-To: <OF9EE28971.13C52970-ON8525760B.00492E01-8525760B.00500726@us.ibm.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.5.7.378829, Antispam-Engine: 2.7.2.376379, Antispam-Data: 2009.8.7.142718
X-PerlMx-Spam: Gauge=IIIIIIII, Probability=8%, Report='
 BODY_SIZE_2000_2999 0, BODY_SIZE_5000_LESS 0, BODY_SIZE_7000_LESS 0, TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __C230066_P5 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __HAS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __MOZILLA_MSGID 0, __SANE_MSGID 0, __TO_MALFORMED_2 0, __URI_NS , __URI_NS_NXDOMAIN , __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

Create a field that is specifically for this type of matches.

What you could then do is at indexing time manipulate your data in such 
a way that it can be matched in a punctuation irrelevant way.

So in this field you would convert all non letter characters into 
spaces, and reduce all white space instances to single ones ("     " 
becomes " ") , you could also likely lowercase it at the same time.

Then at search time perform a special search against this field that 
does the same thing to the query string.  At this point plain old phrase 
queries should work for you.

Our corpus contains remarkably obnoxious items in it like: Rara<^tm3.1Ipc>

So we need to be able to do very similar things as you are describing, 
the above mentioned technique worked like a charm.

Matt

Donna L Gresh wrote:
> I saw some discussion on the board but I'm not sure I've got quite the 
> same problem. As an example, I have a query that might be a technical 
> skill:
>
> SAP EM FIN AM
>
> I would like that to match a document that has *either* SAP.EM.FIN.AM or 
> "SAP EM FIN AM" (in that order and all together, not spread out through 
> the document).
>
> The approach I had tried was at index time if I saw SAP.EM.FIN.AM I would 
> consider "SAP EM FIN AM" a synonym for it, using the Lucene in Action 
> example. Luke shows me that I have two terms in the index for this 
> document: SAP.EM.FIN.AM and "SAP EM FIN AM" (one term). Thus it appears 
> differently in the index than if it had been organically found as just the 
> string of tokens, in which case there would be separate terms for SAP, EM, 
> and so on. 
>
> At query time if I look for "SAP EM FIN AM" it is formed as a phrase query 
> with a slop of 0 which does *not* match the one term version "SAP EM FIN 
> AM". (For that matter a simple boolean query doesn't find it either) Luke 
> confirms the fact that the phrase query does not find my synonym term. The 
> query "SAP EM FIN AM" finds *only* documents that originally had those 
> separated tokens in them.
>
> Is there a way to handle this situation such that at index time I can turn 
> SAP.EM.FIN.AM into something that will be found with a query for "SAP EM 
> FIN AM"?
>
> Thanks for any pointers
>
> Donna 
>
>   


-- 
Matthew Hall
Software Engineer
Mouse Genome Informatics
mhall@informatics.jax.org
(207) 288-6012



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41784-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 14:50:35 2009
Return-Path: <java-user-return-41784-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26965 invoked from network); 7 Aug 2009 14:50:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 14:50:35 -0000
Received: (qmail 94730 invoked by uid 500); 7 Aug 2009 14:50:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94660 invoked by uid 500); 7 Aug 2009 14:50:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94648 invoked by uid 99); 7 Aug 2009 14:50:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 14:50:40 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [207.126.144.139] (HELO eu1sys200aog115.obsmtp.com) (207.126.144.139)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 07 Aug 2009 14:50:30 +0000
Received: from source ([193.36.230.160]) by eu1sys200aob115.postini.com ([207.126.147.11]) with SMTP
	ID DSNKSnw/IQAgFhznWwW859SHHrzVoyEkdqxF@postini.com; Fri, 07 Aug 2009 14:50:10 UTC
Received: from blackex05.detica.com (unverified) by mail01.detica.com 
    (Content Technologies SMTPRS 4.3.19) with ESMTP id 
    <T9001f64ac50a09010a7cc@mail01.detica.com> for 
    <java-user@lucene.apache.org>; Fri, 7 Aug 2009 15:50:08 +0100
Received: from uksrpblkexb01.detica.com ([10.1.1.38]) by blackex05.detica.com 
    with Microsoft SMTPSVC (6.0.3790.3959); Fri, 7 Aug 2009 15:50:08 +0100
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Is there a way for me to handle a multiword synonym correctly?
Date: Fri, 7 Aug 2009 15:50:08 +0100
Message-ID: <8163028120305742991D2FB7F19412AB63564F@uksrpblkexb01.detica.com>
In-Reply-To: 
    <OF9EE28971.13C52970-ON8525760B.00492E01-8525760B.00500726@us.ibm.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: Is there a way for me to handle a multiword synonym correctly?
Thread-Index: AcoXbHNAewcrZPddTiCTWKlce5rJAAAAIj4w
From: "Carl Austin" <Carl.austin@detica.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 07 Aug 2009 14:50:08.0207 (UTC) 
    FILETIME=[5B7A65F0:01CA176E]
X-Virus-Checked: Checked by ClamAV on apache.org

I may be over simplifying here but in this case don't you just need to
use an analyzer that breaks the word "SAP.EM.FIN.AM" on full stops and
throws them out, so that it is indexed as terms "SAP" "EM" "FIN" "AM".
This is the same as it will index "SAP EM FIN AM" as long as you break
on whitespace too. I.E SimpleAnalyzer (runs of letter characters are
tokens)

Then the query for "SAP EM FIN AM" will match both.

Carl


-----Original Message-----
From: Donna L Gresh [mailto:gresh@us.ibm.com]=20
Sent: 07 August 2009 15:35
To: java-user@lucene.apache.org
Subject: Is there a way for me to handle a multiword synonym correctly?

I saw some discussion on the board but I'm not sure I've got quite the
same problem. As an example, I have a query that might be a technical
skill:

SAP EM FIN AM

I would like that to match a document that has *either* SAP.EM.FIN.AM or
"SAP EM FIN AM" (in that order and all together, not spread out through
the document).

The approach I had tried was at index time if I saw SAP.EM.FIN.AM I
would consider "SAP EM FIN AM" a synonym for it, using the Lucene in
Action example. Luke shows me that I have two terms in the index for
this
document: SAP.EM.FIN.AM and "SAP EM FIN AM" (one term). Thus it appears
differently in the index than if it had been organically found as just
the string of tokens, in which case there would be separate terms for
SAP, EM, and so on.=20

At query time if I look for "SAP EM FIN AM" it is formed as a phrase
query with a slop of 0 which does *not* match the one term version "SAP
EM FIN AM". (For that matter a simple boolean query doesn't find it
either) Luke confirms the fact that the phrase query does not find my
synonym term. The query "SAP EM FIN AM" finds *only* documents that
originally had those separated tokens in them.

Is there a way to handle this situation such that at index time I can
turn SAP.EM.FIN.AM into something that will be found with a query for
"SAP EM FIN AM"?

Thanks for any pointers

Donna=20



This message should be regarded as confidential. If you have received this =
email in error please notify the sender and destroy it immediately.
Statements of intent shall only become binding when confirmed in hard copy =
by an authorised signatory.  The contents of this email may relate to deali=
ngs with other companies within the Detica Limited group of companies.

Detica Limited is registered in England under No: 1337451.

Registered offices: Surrey Research Park, Guildford, Surrey, GU2 7YP, Engla=
nd.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41785-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 15:37:40 2009
Return-Path: <java-user-return-41785-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45082 invoked from network); 7 Aug 2009 15:37:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 15:37:40 -0000
Received: (qmail 91949 invoked by uid 500); 7 Aug 2009 15:37:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91904 invoked by uid 500); 7 Aug 2009 15:37:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91797 invoked by uid 99); 7 Aug 2009 15:37:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 15:37:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 15:37:36 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MZRVL-0004Jx-FM
	for java-user@lucene.apache.org; Fri, 07 Aug 2009 08:37:15 -0700
Message-ID: <24866995.post@talk.nabble.com>
Date: Fri, 7 Aug 2009 08:37:15 -0700 (PDT)
From: "m.harig" <m.harig@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: reading index
In-Reply-To: <8c4e68610908070417x6de77451w621b184d85baa523@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.harig@gmail.com
References: <24862928.post@talk.nabble.com> <8c4e68610908070417x6de77451w621b184d85baa523@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks,    
               this is my code snippet

              public void doSearch(){
                ..............................

                Query query =
.................................................

                IndexSearcher searcher = new IndexSearcher(directory);
                Hits hits = searcher.search(query);

               for(int i=start;i<end;i++){
                   
                       // getting doc to display fields    
               
               }
               
               searcher.close();
                }

          am calling this method everytime when a user tries to search a
keyword. is it correct or wrong? If wrong please anyone tell me how to do
it?
-- 
View this message in context: http://www.nabble.com/reading-index-tp24862928p24866995.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41786-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 16:08:17 2009
Return-Path: <java-user-return-41786-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54300 invoked from network); 7 Aug 2009 16:08:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 16:08:16 -0000
Received: (qmail 48176 invoked by uid 500); 7 Aug 2009 16:08:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48103 invoked by uid 500); 7 Aug 2009 16:08:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48089 invoked by uid 99); 7 Aug 2009 16:08:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 16:08:21 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 16:08:11 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 4B830D36001
	for <java-user@lucene.apache.org>; Fri,  7 Aug 2009 18:07:48 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id ykYj80wvS91s for <java-user@lucene.apache.org>;
	Fri,  7 Aug 2009 18:07:38 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id DF010D36002
	for <java-user@lucene.apache.org>; Fri,  7 Aug 2009 18:07:37 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <24862928.post@talk.nabble.com> <8c4e68610908070417x6de77451w621b184d85baa523@mail.gmail.com> <24866995.post@talk.nabble.com>
Subject: RE: reading index
Date: Fri, 7 Aug 2009 18:07:37 +0200
Message-ID: <50DD6B4E1DDB4CBF93BC0E48B16464C1@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
In-Reply-To: <24866995.post@talk.nabble.com>
Thread-Index: AcoXdQlp5OvcjuWOTaeyISkB7T2CcQAAx10g
X-Virus-Checked: Checked by ClamAV on apache.org

You should *not* create a new Searcher for every request. Open the Searcher
one time (e.g. in your servlets init() method) and keep it open. Close it on
we application shutdown.

If your index changes inbetween, you should reopen it (e.g. by testing for
IndexReader.isCurrent() and if not, reopening it). Searcher is threadsafe,
so no worries.

IndexSearcher has no reopen method, so you must reopen the underlying
reader. A strategy to do that is to open the IndexReader one time (not the
IndexSearcher), and reopen it as needed. Then create an IndexSearcher from
it (which is no cost at all, as IndexSearcher is just a wrapper around
IndexReader). So use the ctor of IndexSearcher that takes an IndexReader.
You can create a new IndexSearcher on top of an IndexReader for each
request, there is not problem with it (because it is a thin wrapper). The
important thing is only, that a reopened Reader needs a new IndexSearcher.
This is done by using a fresh instance for each request. Another possibility
is to also reuse the IndexSearcher, but replace it with a new one after each
reopen of the IndexReader.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: m.harig [mailto:m.harig@gmail.com]
> Sent: Friday, August 07, 2009 5:37 PM
> To: java-user@lucene.apache.org
> Subject: Re: reading index
> 
> 
> Thanks,
>                this is my code snippet
> 
>               public void doSearch(){
>                 ..............................
> 
>                 Query query =
> .................................................
> 
>                 IndexSearcher searcher = new IndexSearcher(directory);
>                 Hits hits = searcher.search(query);
> 
>                for(int i=start;i<end;i++){
> 
>                        // getting doc to display fields
> 
>                }
> 
>                searcher.close();
>                 }
> 
>           am calling this method everytime when a user tries to search a
> keyword. is it correct or wrong? If wrong please anyone tell me how to do
> it?
> --
> View this message in context: http://www.nabble.com/reading-index-
> tp24862928p24866995.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41787-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 16:15:44 2009
Return-Path: <java-user-return-41787-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55785 invoked from network); 7 Aug 2009 16:15:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 16:15:44 -0000
Received: (qmail 63580 invoked by uid 500); 7 Aug 2009 16:15:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63512 invoked by uid 500); 7 Aug 2009 16:15:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63502 invoked by uid 99); 7 Aug 2009 16:15:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 16:15:49 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.217.218] (HELO mail-gx0-f218.google.com) (209.85.217.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 16:15:40 +0000
Received: by gxk18 with SMTP id 18so1998801gxk.5
        for <java-user@lucene.apache.org>; Fri, 07 Aug 2009 09:15:17 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.215.10 with SMTP id n10mr2708286ybg.269.1249661717680; 
	Fri, 07 Aug 2009 09:15:17 -0700 (PDT)
In-Reply-To: <843920a30908061430p60001011v19982560764aa814@mail.gmail.com>
References: <843920a30908050908pf9e2abciff36861614c0813e@mail.gmail.com>
	 <9ac0c6aa0908051250m456998bbve6e8be67de9f3009@mail.gmail.com>
	 <843920a30908061430p60001011v19982560764aa814@mail.gmail.com>
Date: Fri, 7 Aug 2009 12:15:17 -0400
Message-ID: <9ac0c6aa0908070915g6adc7a48hda47d3c8d43321b@mail.gmail.com>
Subject: Re: Efficient optimization of large indexes?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Aug 6, 2009 at 5:30 PM, Nigel<nigelspleen@gmail.com> wrote:
>> Actually IndexWriter must periodically flush, which will always
>> create new segments, which will then always require merging. =A0Ie
>> there's no way to just add everything to only one segment in one
>> shot.
>>
>
> Hmm, that makes sense now that you mention it. =A0And if you have to merg=
e in
> the end anyway, there's no point to my idea of adding docs to a new index=
.

Well it's worth a shot at least ;)

> But addIndexes(IndexReader[]) as you suggest would solve that problem.

Right.  You could also set a massive mergeFactor to achieve the same thing.

>> Merge performance does seem rather slow... I recently profiled it and
>> was suprised to find that the merging of terms dict & postings was cpu
>> bound, even on a modern CPU (core i7 920) and with 3 merges running
>> concurrently. =A0I think most of the CPU cost comes from the pqueue
>> that's used to do the merge sort, plus read/writeVInt. =A0When Lucene
>> [eventually] switches to PForDelta, that should be more CPU friendly.
>
> That's interesting. =A0I recently did one of our big merges on a differen=
t
> server that has the same disks as the one I was using before, but a faste=
r
> processor. =A0It seemed like the merge was quite a bit faster than usual
> (though it's possible I was fooled by other factors).

OK... so that supports the "merging is cpu bound" hypothesis.

> Also, it's tons of IO because for each merge it must read every single
>> byte and write nearly every single byte, so that's ~2X bytes moved.
>> Then, if you have more segments in your index than your mergeFactor,
>> multiple such merges are needed and you're looking at, at least, 4X
>> your index size in net bytes moved. =A0If you have CFS enabled, it's 8X
>> the index size.
>
> Not to get too sidetracked, but this reminds me of another question I mea=
nt
> to ask. =A0We use the compound format right now. =A0Our merge factor is
> relatively low, so switching to the non-compound format would certainly b=
e
> possible without running into problems with too many open files. =A0Is th=
ere
> any significant speed different between compound and non-compound for
> indexing, searching, or merging? =A0(Searching for us would be the most
> important by far.)

Both indexing and searching should be faster if you don't use CFS.
For indexing it'll be a small impact... I'm less sure about searching
but I'd also expect the impact to be smallish.  If you test it, please
post back!

>> =A0 * If possible, make sure you always add the same fields to your
>> =A0 =A0docs, in the same order (this results in consistent numbering of
>> =A0 =A0field name -> number). =A0This is very much an unexpected
>> =A0 =A0gotchya... the merging of stored fields and term vectors is much,
>> =A0 =A0much faster if the field numbers are identical. =A0LUCENE-1737 is
>> =A0 =A0open to fix Lucene so it consistently numbers automatically, but
>> =A0 =A0it's somewhat tricky because many places in Lucene assume the
>> =A0 =A0field names are densely packed.
>
> We generally do this already, but some of our fields are nullable and so =
for
> some documents the number-to-name mapping will be different. =A0Is there =
any
> value in adding dummy values like "NULL" in these cases? =A0That presumab=
ly
> adds overhead of its own, though.

If you store fields and term vectors then adding null fields should
speed up merging substantially and likely won't have much impact on
indexing time, time to retrieve docs, searching time or index size, I
think.  Post back :)

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41788-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 16:15:55 2009
Return-Path: <java-user-return-41788-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55861 invoked from network); 7 Aug 2009 16:15:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 16:15:55 -0000
Received: (qmail 65305 invoked by uid 500); 7 Aug 2009 16:16:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65246 invoked by uid 500); 7 Aug 2009 16:16:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65236 invoked by uid 99); 7 Aug 2009 16:16:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 16:16:00 +0000
X-ASF-Spam-Status: No, hits=-1.8 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of gresh@us.ibm.com designates 32.97.182.144 as permitted sender)
Received: from [32.97.182.144] (HELO e4.ny.us.ibm.com) (32.97.182.144)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 16:15:50 +0000
Received: from d01relay04.pok.ibm.com (d01relay04.pok.ibm.com [9.56.227.236])
	by e4.ny.us.ibm.com (8.14.3/8.13.1) with ESMTP id n77G9Gaj009463
	for <java-user@lucene.apache.org>; Fri, 7 Aug 2009 12:09:16 -0400
Received: from d01av01.pok.ibm.com (d01av01.pok.ibm.com [9.56.224.215])
	by d01relay04.pok.ibm.com (8.13.8/8.13.8/NCO v10.0) with ESMTP id n77GFJQ9246174
	for <java-user@lucene.apache.org>; Fri, 7 Aug 2009 12:15:19 -0400
Received: from d01av01.pok.ibm.com (loopback [127.0.0.1])
	by d01av01.pok.ibm.com (8.12.11.20060308/8.13.3) with ESMTP id n77GFJev010062
	for <java-user@lucene.apache.org>; Fri, 7 Aug 2009 12:15:19 -0400
Received: from d01ml605.pok.ibm.com (d01ml605.pok.ibm.com [9.56.227.91])
	by d01av01.pok.ibm.com (8.12.11.20060308/8.12.11) with ESMTP id n77GFJYq010059
	for <java-user@lucene.apache.org>; Fri, 7 Aug 2009 12:15:19 -0400
In-Reply-To: <8163028120305742991D2FB7F19412AB63564F@uksrpblkexb01.detica.com>
References: <OF9EE28971.13C52970-ON8525760B.00492E01-8525760B.00500726@us.ibm.com> <8163028120305742991D2FB7F19412AB63564F@uksrpblkexb01.detica.com>
To: java-user@lucene.apache.org
MIME-Version: 1.0
Subject: RE: Is there a way for me to handle a multiword synonym correctly?
X-KeepSent: CE8608F2:4B92977B-8525760B:00590F05;
 type=4; name=$KeepSent
X-Mailer: Lotus Notes Release 8.0.2 HF623 January 16, 2009
From: Donna L Gresh <gresh@us.ibm.com>
Message-ID: <OFCE8608F2.4B92977B-ON8525760B.00590F05-8525760B.00593232@us.ibm.com>
Date: Fri, 7 Aug 2009 12:15:18 -0400
X-MIMETrack: Serialize by Router on D01ML605/01/M/IBM(Build V851_07072009|July 07, 2009) at
 08/07/2009 12:15:18,
	Serialize complete at 08/07/2009 12:15:18
Content-Type: multipart/alternative; boundary="=_alternative 00592F0F8525760B_="
X-Virus-Checked: Checked by ClamAV on apache.org

--=_alternative 00592F0F8525760B_=
Content-Type: text/plain; charset="US-ASCII"

I have to think about this a bit, but that may work. I just have to make 
sure no "undesirable" side effects occur. I certainly want to be able to 
search for a phrase and not have it match all the individual bits, but 
that should already work using the mechanism I already have in place.

Donna 


"Carl Austin" <Carl.austin@detica.com> wrote on 08/07/2009 10:50:08 AM:

> [image removed] 
> 
> RE: Is there a way for me to handle a multiword synonym correctly?
> 
> Carl Austin 
> 
> to:
> 
> java-user
> 
> 08/07/2009 10:50 AM
> 
> Please respond to java-user
> 
> I may be over simplifying here but in this case don't you just need to
> use an analyzer that breaks the word "SAP.EM.FIN.AM" on full stops and
> throws them out, so that it is indexed as terms "SAP" "EM" "FIN" "AM".
> This is the same as it will index "SAP EM FIN AM" as long as you break
> on whitespace too. I.E SimpleAnalyzer (runs of letter characters are
> tokens)
> 
> Then the query for "SAP EM FIN AM" will match both.
> 
> Carl
> 
> 
> -----Original Message-----
> From: Donna L Gresh [mailto:gresh@us.ibm.com] 
> Sent: 07 August 2009 15:35
> To: java-user@lucene.apache.org
> Subject: Is there a way for me to handle a multiword synonym correctly?
> 
> I saw some discussion on the board but I'm not sure I've got quite the
> same problem. As an example, I have a query that might be a technical
> skill:
> 
> SAP EM FIN AM
> 
> I would like that to match a document that has *either* SAP.EM.FIN.AM or
> "SAP EM FIN AM" (in that order and all together, not spread out through
> the document).
> 
> The approach I had tried was at index time if I saw SAP.EM.FIN.AM I
> would consider "SAP EM FIN AM" a synonym for it, using the Lucene in
> Action example. Luke shows me that I have two terms in the index for
> this
> document: SAP.EM.FIN.AM and "SAP EM FIN AM" (one term). Thus it appears
> differently in the index than if it had been organically found as just
> the string of tokens, in which case there would be separate terms for
> SAP, EM, and so on. 
> 
> At query time if I look for "SAP EM FIN AM" it is formed as a phrase
> query with a slop of 0 which does *not* match the one term version "SAP
> EM FIN AM". (For that matter a simple boolean query doesn't find it
> either) Luke confirms the fact that the phrase query does not find my
> synonym term. The query "SAP EM FIN AM" finds *only* documents that
> originally had those separated tokens in them.
> 
> Is there a way to handle this situation such that at index time I can
> turn SAP.EM.FIN.AM into something that will be found with a query for
> "SAP EM FIN AM"?
> 
> Thanks for any pointers
> 
> Donna 
> 
> 
> 
> This message should be regarded as confidential. If you have 
> received this email in error please notify the sender and destroy it
> immediately.
> Statements of intent shall only become binding when confirmed in 
> hard copy by an authorised signatory.  The contents of this email 
> may relate to dealings with other companies within the Detica 
> Limited group of companies.
> 
> Detica Limited is registered in England under No: 1337451.
> 
> Registered offices: Surrey Research Park, Guildford, Surrey, GU2 7YP, 
England.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

--=_alternative 00592F0F8525760B_=--

From java-user-return-41789-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 19:28:55 2009
Return-Path: <java-user-return-41789-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42388 invoked from network); 7 Aug 2009 19:28:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 19:28:55 -0000
Received: (qmail 53208 invoked by uid 500); 7 Aug 2009 19:29:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53123 invoked by uid 500); 7 Aug 2009 19:28:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53113 invoked by uid 99); 7 Aug 2009 19:28:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 19:28:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.9] (HELO eastrmmtao103.cox.net) (68.230.240.9)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 19:28:50 +0000
Received: from eastrmimpo01.cox.net ([68.1.16.119])
          by eastrmmtao103.cox.net
          (InterMail vM.7.08.02.01 201-2186-121-102-20070209) with ESMTP
          id <20090807192829.KEZP27176.eastrmmtao103.cox.net@eastrmimpo01.cox.net>
          for <java-user@lucene.apache.org>; Fri, 7 Aug 2009 15:28:29 -0400
Received: from eastrmwml33 ([172.18.18.217])
	by eastrmimpo01.cox.net with bizsmtp
	id RXUU1c00A4h0NJL02XUUme; Fri, 07 Aug 2009 15:28:28 -0400
X-VR-Score: -40.00
X-Authority-Analysis: v=1.0 c=1 a=agOsGYEG5KMA:10 a=CEo4xBtPnbSo-CxTT78A:9
 a=Ays9VUHh20Sw4oUZnVIYDBx7CTsA:4
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Fri, 7 Aug 2009 15:28:29 -0400
Message-ID: <20090807152829.BR8KF.56934.imail@eastrmwml33>
Date: Fri, 7 Aug 2009 15:28:29 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: StandardAnalyzer and Windows vs. Linux "path"
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I've been doing development of my indexer app, which uses StandardAnalyzer on a WIndows machine, and today, I deployed an initial  onto a Redhat Linux (RHEL) machine.

On my development machine, I have the files that are being indexed in something like:

C:\lucene-devel\files\dir1\xxxxxxx.dat
C:\lucene-devel\files\dir1\dir2\yyyyyyyy.dat
etc.

As mentioned in an earlier thread, when I look at the resulting index on my development system, at the "path" field, I get terms like:

xxxxxxxxxxx
yyyyyyyyyyy

When I deployed on RHEL today, the files are in:

/lucene-devel/files/dir1/xxxxxxxxx.dat
/lucene-devel/files/dir1/dir2/yyyyyyyyyy.dat

and, the index (using Luke) is showing:

dir1/xxxxxxx.dat
dir2/yyyyyyyy.dat

As best I can tell, what's appearing in the "path" field is:

<name_of_dir_above_file>/<filename>

vs. (on Windows):

<filename>

Is this difference because of the StandardAnalyzer processing of "\" for Windows vs. "/" for RHEL?

Is there any way to compensate for this difference, so that when i do testing in my development environment I get results that would reflect what happens on RHEL?

Thanks,
Jim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41790-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 07 19:41:28 2009
Return-Path: <java-user-return-41790-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44282 invoked from network); 7 Aug 2009 19:41:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Aug 2009 19:41:28 -0000
Received: (qmail 70470 invoked by uid 500); 7 Aug 2009 19:41:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70398 invoked by uid 500); 7 Aug 2009 19:41:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70388 invoked by uid 99); 7 Aug 2009 19:41:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Aug 2009 19:41:32 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [198.147.192.8] (HELO babbler.bmc.com) (198.147.192.8)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 07 Aug 2009 19:41:23 +0000
Received: from hou-ec-02.adprod.bmc.com (hou-ec-02.adprod.bmc.com [172.17.1.111])
	by babbler.bmc.com (Postfix) with ESMTP id 04DEE13009A
	for <java-user@lucene.apache.org>; Fri,  7 Aug 2009 14:40:51 -0500 (CDT)
Received: from HOU-HTPRD-01.adprod.bmc.com ([192.168.249.9]) by hou-ec-02.adprod.bmc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 7 Aug 2009 14:40:50 -0500
Received: from HOUCCRPRD02.adprod.bmc.com ([192.168.249.5]) by
 HOU-HTPRD-01.adprod.bmc.com ([192.168.249.9]) with mapi; Fri, 7 Aug 2009
 14:40:50 -0500
From: "Woolf, Ross" <Ross_Woolf@BMC.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 7 Aug 2009 14:40:48 -0500
Subject: UNC speed vs DOS path speed
Thread-Topic: UNC speed vs DOS path speed
Thread-Index: AcoXlvbCWEnH3NR7To6Yo97KAcUUjA==
Message-ID: <B26FDDF34B0ECA4D8614D9EB4F3374ED12BBFFDCAD@HOUCCRPRD02.adprod.bmc.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
x-tm-as-product-ver: SMEX-8.0.0.1285-5.600.1016-16810.004
x-tm-as-result: No--44.915700-0.000000-31
x-tm-as-user-approved-sender: Yes
x-tm-as-user-blocked-sender: No
Content-Type: multipart/alternative;
	boundary="_000_B26FDDF34B0ECA4D8614D9EB4F3374ED12BBFFDCADHOUCCRPRD02ad_"
MIME-Version: 1.0
X-OriginalArrivalTime: 07 Aug 2009 19:40:50.0895 (UTC) FILETIME=[F8215DF0:01CA1796]
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_B26FDDF34B0ECA4D8614D9EB4F3374ED12BBFFDCADHOUCCRPRD02ad_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

On a Windows machine I have noticed that using a UNC path instead of a DOS =
path when instantiating an index writer causes the performance to slow cons=
iderably, even when the UNC is to the same location as DOS path.  Is anyone=
 aware of this and why?   Is there anything that can be done to improve per=
formance when using a UNC path?

Example:
In this example I am indexing about 3000 documents.  If I instantiate Index=
Writer with the path \\localhost\general\index  and index the documents it =
takes almost 2 minutes to index these documents.  If instead, I use the DOS=
 path C:\test\general\index, which is to the exact location as the localhos=
t UNC path, it only takes 14 seconds to index the same 3000 documents.

I realize that using the UNC path causes the involvement of the IP stack, b=
ut I'm surprised at the difference of speed.  Is there anything in Lucene i=
tself that would account for the difference in speed, or is it in the Java =
layer itself?

Any help would be appreciated on understanding this behavior and knowing if=
 there is anything that can be done to bring the UNC path speed closer to t=
he DOS path speed.

--_000_B26FDDF34B0ECA4D8614D9EB4F3374ED12BBFFDCADHOUCCRPRD02ad_--

From java-user-return-41791-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 08 05:44:43 2009
Return-Path: <java-user-return-41791-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5417 invoked from network); 8 Aug 2009 05:44:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Aug 2009 05:44:43 -0000
Received: (qmail 96528 invoked by uid 500); 8 Aug 2009 05:44:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96433 invoked by uid 500); 8 Aug 2009 05:44:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96423 invoked by uid 99); 8 Aug 2009 05:44:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Aug 2009 05:44:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Aug 2009 05:44:37 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MZej1-0000Ge-Vd
	for java-user@lucene.apache.org; Fri, 07 Aug 2009 22:44:15 -0700
Message-ID: <24875308.post@talk.nabble.com>
Date: Fri, 7 Aug 2009 22:44:15 -0700 (PDT)
From: mitu2009 <musicfreaque@gmail.com>
To: java-user@lucene.apache.org
Subject: Handling synonyms using Lucene
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: musicfreaque@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

What is the best way to handle synonyms (phrases) using Lucene? Especially,
when I need to execute queries like :a OR b OR c NOT d

How about adding a new field called "synonyms" to each document while
indexing? This field's value would have a list of all synonyms. It would be
added to a document only when that document has any of the synonyms.

I would then execute an "OR" search query which would look for search
keyword in this field alongwith other fields.

Can this approach work well for any kind of query?

Please suggest.

Thanks.

-- 
View this message in context: http://www.nabble.com/Handling-synonyms-using-Lucene-tp24875308p24875308.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41792-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 08 05:52:03 2009
Return-Path: <java-user-return-41792-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7769 invoked from network); 8 Aug 2009 05:52:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Aug 2009 05:52:02 -0000
Received: (qmail 511 invoked by uid 500); 8 Aug 2009 05:52:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 427 invoked by uid 500); 8 Aug 2009 05:52:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 417 invoked by uid 99); 8 Aug 2009 05:52:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Aug 2009 05:52:07 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anshumg@gmail.com designates 209.85.212.191 as permitted sender)
Received: from [209.85.212.191] (HELO mail-vw0-f191.google.com) (209.85.212.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Aug 2009 05:51:58 +0000
Received: by vws29 with SMTP id 29so1902913vws.20
        for <java-user@lucene.apache.org>; Fri, 07 Aug 2009 22:51:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=lJJlOdWOYOt25LfcPVNFnNRuSyh6pljY+pNycthf8xg=;
        b=wu6jlMqViujuhKKCeFRxnj9kMGZBwjXLZ0yYKTNMW1GnwLJMN/BFXw/BQtOFGCc4ff
         lhKnv+KUwSTkMqm9pB3i3QRyFrv7y+Us0wZuMBRxrmro03xtiEH6Pcs2muHZRNJR3TlE
         spTUXNGw3hES1TIvDKNQVa2bLV9j3aZO3VMoU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=P+/X0q7JkYKaTZzWqyd0O2NvVk2MFX4z8fCbxQMCadD4WEo2w3PF2bbI1R3aO2xuSJ
         I3+yTs5UFoV5KysSRcIFWsKef5LiGRP8o51e9w2WBV0HQSaoDeiS4AViixk7+h4tl0Fw
         vGcNbrNSdu2QJqpNOXutFZ2vnhYijC8lfqVYo=
MIME-Version: 1.0
Received: by 10.220.73.69 with SMTP id p5mr1891591vcj.94.1249710697295; Fri, 
	07 Aug 2009 22:51:37 -0700 (PDT)
In-Reply-To: <24875308.post@talk.nabble.com>
References: <24875308.post@talk.nabble.com>
Date: Sat, 8 Aug 2009 11:21:37 +0530
Message-ID: <867513fe0908072251m194708c4kfd7ea79c2deb8f84@mail.gmail.com>
Subject: Re: Handling synonyms using Lucene
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636284cfe2f2fff04709af27f
X-Virus-Checked: Checked by ClamAV on apache.org

--001636284cfe2f2fff04709af27f
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Mitu,
Though your approach would work I'd suggest you build a custom analyzer
instead. Perhaps that'd be a bettter approach.

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Sat, Aug 8, 2009 at 11:14 AM, mitu2009 <musicfreaque@gmail.com> wrote:

>
> Hi,
>
> What is the best way to handle synonyms (phrases) using Lucene? Especially,
> when I need to execute queries like :a OR b OR c NOT d
>
> How about adding a new field called "synonyms" to each document while
> indexing? This field's value would have a list of all synonyms. It would be
> added to a document only when that document has any of the synonyms.
>
> I would then execute an "OR" search query which would look for search
> keyword in this field alongwith other fields.
>
> Can this approach work well for any kind of query?
>
> Please suggest.
>
> Thanks.
>
> --
> View this message in context:
> http://www.nabble.com/Handling-synonyms-using-Lucene-tp24875308p24875308.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636284cfe2f2fff04709af27f--

From java-user-return-41793-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 08 07:19:02 2009
Return-Path: <java-user-return-41793-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33830 invoked from network); 8 Aug 2009 07:19:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Aug 2009 07:19:02 -0000
Received: (qmail 31979 invoked by uid 500); 8 Aug 2009 07:19:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31895 invoked by uid 500); 8 Aug 2009 07:19:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31885 invoked by uid 99); 8 Aug 2009 07:19:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Aug 2009 07:19:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 08 Aug 2009 07:18:56 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MZgCJ-0003Bg-RG
	for java-user@lucene.apache.org; Sat, 08 Aug 2009 00:18:35 -0700
Message-ID: <24875673.post@talk.nabble.com>
Date: Sat, 8 Aug 2009 00:18:35 -0700 (PDT)
From: "m.harig" <m.harig@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: reading index
In-Reply-To: <50DD6B4E1DDB4CBF93BC0E48B16464C1@VEGA>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.harig@gmail.com
References: <24862928.post@talk.nabble.com> <8c4e68610908070417x6de77451w621b184d85baa523@mail.gmail.com> <24866995.post@talk.nabble.com> <50DD6B4E1DDB4CBF93BC0E48B16464C1@VEGA>
X-Virus-Checked: Checked by ClamAV on apache.org


Hello 

  Will my reader.reopen() method work on windows machine when the index get
updated? i mean my tomcat server will allow the reader to update my index?
please help me.
-- 
View this message in context: http://www.nabble.com/reading-index-tp24862928p24875673.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41794-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 09 08:43:53 2009
Return-Path: <java-user-return-41794-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51734 invoked from network); 9 Aug 2009 08:43:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Aug 2009 08:43:53 -0000
Received: (qmail 86768 invoked by uid 500); 9 Aug 2009 08:43:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86671 invoked by uid 500); 9 Aug 2009 08:43:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 78308 invoked by uid 99); 6 Aug 2009 23:20:30 -0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucastex@gmail.com designates 74.125.92.26 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:cc:content-type;
        bh=CQAJn8SnUxSlp92wTzCM8xBvJDC6tRiPOozUkuvZzZg=;
        b=aiBnnurzqdmNzCnKtZBU7Ji7dEqFYHDcT/ojNVrOD6BLNRoWN/9hbwhlLFPG24C3//
         nVQpqK6qm8o6Kkmi80KJixJ4Mp5n478H1KVB4vmUnDLLPK4BwGYloxQYeC1mqJGq4Tgm
         IDwzNrzK7tK7PhfN6501Ucjs1iOsY3vjk3vq0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :cc:content-type;
        b=nNqCHnmcUmARRnOXejrtPmfOmZU63mpFatseioLTOoG2ZGrl/b5XTqHnW6yGHIVqRG
         XA05uuGZCCB5bY3kSW+H5GWeik8rt2g3hKAovlaRGU2jfbWPtpbH/5hiUJBS92F/tBh7
         Fa6vJb5C/C+a4Rv6mn4/ItDplVUnWSNWdpD7A=
MIME-Version: 1.0
In-Reply-To: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
References: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
From: "Lucas F. A. Teixeira" <lucastex@gmail.com>
Date: Thu, 6 Aug 2009 20:19:38 -0300
Message-ID: <2a3b272c0908061619w5a0a40fagc76197aa6eb34fba@mail.gmail.com>
Subject: Re: Language Detection for Analysis?
To: solr-user@lucene.apache.org
Cc: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364ef3c8af96940470815b1d
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364ef3c8af96940470815b1d
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Google Translate just released (last week) its language API with translatio=
n
and LANGUAGE DETECTION.
:)

It's very simple to use, and you can query it with some text to define witc=
h
language is it.

Here is a simple example using groovy, but all you need is the url to
query: http://groovyconsole.appspot.com/view.groovy?id=3D16


[]s,

Lucas Frare Teixeira .=B7.
- lucastex@gmail.com
- blog.lucastex.com
- twitter.com/lucastex


On Thu, Aug 6, 2009 at 4:46 PM, Bradford Stephens <
bradfordstephens@gmail.com> wrote:

> Hey there,
>
> We're trying to add foreign language support into our new search
> engine -- languages like Arabic, Farsi, and Urdu (that don't work with
> standard analyzers). But our data source doesn't tell us which
> languages we're actually collecting -- we just get blocks of text. Has
> anyone here worked on language detection so we can figure out what
> analyzers to use? Are there commercial solutions?
>
> Much appreciated!
>
> --
> http://www.roadtofailure.com -- The Fringes of Scalability, Social
> Media, and Computer Science
>

--0016364ef3c8af96940470815b1d--

From java-user-return-41795-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 09 09:11:01 2009
Return-Path: <java-user-return-41795-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54842 invoked from network); 9 Aug 2009 09:11:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Aug 2009 09:11:00 -0000
Received: (qmail 96357 invoked by uid 500); 9 Aug 2009 09:11:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96279 invoked by uid 500); 9 Aug 2009 09:11:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96269 invoked by uid 99); 9 Aug 2009 09:11:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 09 Aug 2009 09:11:05 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of eransevi@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 09 Aug 2009 09:10:56 +0000
Received: by ewy26 with SMTP id 26so2596066ewy.5
        for <java-user@lucene.apache.org>; Sun, 09 Aug 2009 02:10:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Qr5+fVMwQSkET+FH4h/SPCzFddj6BOTrROHiVCISJco=;
        b=Rdgi3zeuTihIbIxqo3q2MD2e7wmLCzoJ0ZOwA0bOZ+4HpJp9qOjUDfqvUxxR7eUO+p
         bjZcMfRT2LTnLpzTwNcOb9w4+tLIZ7UmE1uQQUm+nw92E0Zk7EpukzgHBewqy3kRQMlC
         MGS5R6/79UpkTFSYXt+JA+3+TCeTsefZu7Czc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=xUT2eI7iPwoplqF9tnR8SGGv6FT1G4XpwhMtZi/SDnpTrXst1AtfjHfgbq97a2AhWE
         9eGrSIe7BFYAlEVXsV8MfpMuUOImFrVsXjXbV7XuJNwlIZn1X0l7bY3IxhbCabuPT9rJ
         LlQuEPrBYvg5a8lDjuQeAPt7em0QKOAlAM5A4=
MIME-Version: 1.0
Received: by 10.210.81.3 with SMTP id e3mr1622086ebb.18.1249809034924; Sun, 09 
	Aug 2009 02:10:34 -0700 (PDT)
In-Reply-To: <70FA860F-B368-462B-A510-FBA44FB1806D@apache.org>
References: <74f928500908020830h5d3f4d0aw1f1ed2016c67200@mail.gmail.com>
	 <70FA860F-B368-462B-A510-FBA44FB1806D@apache.org>
Date: Sun, 9 Aug 2009 12:10:34 +0300
Message-ID: <74f928500908090210x1da86971ibad538f6fba97227@mail.gmail.com>
Subject: Re: score from spans
From: Eran Sevi <eransevi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c15f09052ed0470b1d7fe
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c15f09052ed0470b1d7fe
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks for the answer.

I tried to further understand the weight and score mechanism when running a
span query search.
I noticed that indeed the SpanScorer and SpanWeight are being called and
some score is returned but it seems to me that these basic implementations
are more appropriate for the basic SpanTermQuery.
For the other types of span queries, the inner queries scores and weights
are not taken into account - for example if I run a simple SpanOrQuery and
boost one of it's child SpanTermQuery, the boost is not taken into account.

It seems to me that some recursive calculation is required in order to take
into account all the weights and scores of the span's sub queries.
I'm trying to come up with a correct implementation for SpanOrQuery,
SpanNearQuery, SpanNotQuery based on similiar calculations of BooleanQuery.

Do you have a better idea on how to achieve the correct scoring? the score
calculations are quite complex for each case of span queries so any help is
appreciated.

Thanks, Eran.

On Tue, Aug 4, 2009 at 8:51 PM, Grant Ingersoll <gsingers@apache.org> wrote:

> A SpanQuery is a Query, so if you do a search for it, you will get scores.
>  However, the mechanism is a bit complicated, b/c actually getting the Spans
> is separate from doing the query.  I agree there could be tighter
> integration.  However, what you could do is use Spans.skipTo to move to the
> document you are examining in the search results.
>
> -Grant
>
>
> On Aug 2, 2009, at 11:30 AM, Eran Sevi wrote:
>
> Hi,
>>
>> How can I get the score of a span that is the result of
>> SpanQuery.getSpans()
>> ? The score should can be the same for each document, but if it's unique
>> per
>> span, it's even better.
>>
>> I tried looking for a way to expose this functionality through the Spans
>> class but it looks too complicated.
>> I'm not even sure that by default some score calculation is even performed
>> when using span queries.
>>
>> I've noticed that some calculations are made using payloads and
>> BoostingTermQuery but the score result is used internally and can't be
>> accessed from the Spans results.
>> I don't want to re-run the query again using a HitCollector and since the
>> reader is passed to getSpans, I think it should be possible to do what I
>> want.
>>
>> Any help on the correct way to expose the span score will be appreciated.
>>
>> Thanks,
>> Eran.
>>
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) using
> Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174c15f09052ed0470b1d7fe--

From java-user-return-41796-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 09 16:02:11 2009
Return-Path: <java-user-return-41796-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55102 invoked from network); 9 Aug 2009 16:02:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Aug 2009 16:02:11 -0000
Received: (qmail 84750 invoked by uid 500); 9 Aug 2009 16:02:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84672 invoked by uid 500); 9 Aug 2009 16:02:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84662 invoked by uid 99); 9 Aug 2009 16:02:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 09 Aug 2009 16:02:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 09 Aug 2009 16:02:05 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MaAq8-0004da-S3
	for java-user@lucene.apache.org; Sun, 09 Aug 2009 09:01:44 -0700
Message-ID: <24888495.post@talk.nabble.com>
Date: Sun, 9 Aug 2009 09:01:44 -0700 (PDT)
From: mitu2009 <musicfreaque@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Handling synonyms using Lucene
In-Reply-To: <867513fe0908072251m194708c4kfd7ea79c2deb8f84@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: musicfreaque@gmail.com
References: <24875308.post@talk.nabble.com> <867513fe0908072251m194708c4kfd7ea79c2deb8f84@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Just wanted to add this my original question:
FYI, The synonyms in my application are totally custom and not from English
dictionary...ie. "Global Leader in Finance" could also mean "Top Investment
Bank" or "Fortune 500 Finance company" etc etc.


Anshum-2 wrote:
> 
> Hi Mitu,
> Though your approach would work I'd suggest you build a custom analyzer
> instead. Perhaps that'd be a bettter approach.
> 
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
> 
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
> 
> 
> On Sat, Aug 8, 2009 at 11:14 AM, mitu2009 <musicfreaque@gmail.com> wrote:
> 
>>
>> Hi,
>>
>> What is the best way to handle synonyms (phrases) using Lucene?
>> Especially,
>> when I need to execute queries like :a OR b OR c NOT d
>>
>> How about adding a new field called "synonyms" to each document while
>> indexing? This field's value would have a list of all synonyms. It would
>> be
>> added to a document only when that document has any of the synonyms.
>>
>> I would then execute an "OR" search query which would look for search
>> keyword in this field alongwith other fields.
>>
>> Can this approach work well for any kind of query?
>>
>> Please suggest.
>>
>> Thanks.
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Handling-synonyms-using-Lucene-tp24875308p24875308.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Handling-synonyms-using-Lucene-tp24875308p24888495.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41797-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 10 07:23:45 2009
Return-Path: <java-user-return-41797-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85187 invoked from network); 10 Aug 2009 07:23:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Aug 2009 07:23:45 -0000
Received: (qmail 3446 invoked by uid 500); 10 Aug 2009 07:23:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3370 invoked by uid 500); 10 Aug 2009 07:23:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3360 invoked by uid 99); 10 Aug 2009 07:23:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Aug 2009 07:23:49 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lmenaria@chambal.com designates 209.85.222.186 as permitted sender)
Received: from [209.85.222.186] (HELO mail-pz0-f186.google.com) (209.85.222.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Aug 2009 07:23:39 +0000
Received: by pzk16 with SMTP id 16so2705504pzk.20
        for <java-user@lucene.apache.org>; Mon, 10 Aug 2009 00:23:17 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.161.3 with SMTP id n3mr974686wfo.179.1249888997422; Mon, 
	10 Aug 2009 00:23:17 -0700 (PDT)
Date: Mon, 10 Aug 2009 12:53:17 +0530
Message-ID: <1324e4e20908100023v78d2d1b1jb4d0473815c24737@mail.gmail.com>
Subject: Taking too much time in optimization
From: Laxmilal Menariya <lmenaria@chambal.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636e8ff43b336ec0470c4757c
X-Virus-Checked: Checked by ClamAV on apache.org

--001636e8ff43b336ec0470c4757c
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hello everyone,

I have created a sample application & indexing files properties, have index
appx 107K files.

I am getting OutofMemoryError after 100K while indexing,  got the cause from
MaxBuffereddocs=100K, but after that I am calling optimize() method, this is
taking too much time appx 12-HRS, and index size is more than 500GB, its too
large.

I am using Lucene 2.4.0. Could some one please let me know what wrong with
my configuration.

My Configuration is :

      lucWriter = new IndexWriter("C:\\Laxmilal", new KeywordAnalyzer(),
true);
      lucWriter.setMergeFactor((int) 1000);
      lucWriter.setMaxMergeDocs((int) 2147483647);
      lucWriter.setMaxBufferedDocs((int) 100000);


-- 
Thanks,
Laxmilal Menariya

http://www.bucketexplorer.com/
http://www.sdbexplorer.com/
http://www.chambal.com/

--001636e8ff43b336ec0470c4757c--

From java-user-return-41798-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 10 08:00:37 2009
Return-Path: <java-user-return-41798-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91448 invoked from network); 10 Aug 2009 08:00:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Aug 2009 08:00:37 -0000
Received: (qmail 33370 invoked by uid 500); 10 Aug 2009 08:00:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33320 invoked by uid 500); 10 Aug 2009 08:00:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33310 invoked by uid 99); 10 Aug 2009 08:00:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Aug 2009 08:00:41 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of claudio.gennaro@isti.cnr.it designates 194.119.192.6 as permitted sender)
Received: from [194.119.192.6] (HELO ITANIUM.ISTI.CNR.IT) (194.119.192.6)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Aug 2009 08:00:32 +0000
Received: from conversionlocal.isti.cnr.it by mx.isti.cnr.it (PMDF V6.4 #31598)
 id <01NCCQEOWGW09X3ZW7@mx.isti.cnr.it> for java-user@lucene.apache.org; Mon,
 10 Aug 2009 09:59:03 +0200
Received: from ultralisca ([217.201.15.143])
 by mx.isti.cnr.it (PMDF V6.4 #31599)
 with ESMTPA id <01NCCQB4UV8Q9S3VXS@mx.isti.cnr.it> for
 java-user@lucene.apache.org; Mon, 10 Aug 2009 09:59:03 +0200
Date: Mon, 10 Aug 2009 09:55:56 +0200
From: Claudio Gennaro <claudio.gennaro@isti.cnr.it>
Subject: sumOfSquaredWeights for lengthNorm
To: java-user@lucene.apache.org
Message-id: <001e01ca1990$6d4c9180$47e5b480$%gennaro@isti.cnr.it>
MIME-version: 1.0
X-Mailer: Microsoft Office Outlook 12.0
Content-type: multipart/alternative;
 boundary="Boundary_(ID_hf/vOB2nC+4sPHPqSLtGdg)"
Content-language: it
Thread-Index: AcoZj/33UOSpqntRTtWrUvXMPCJPkQ==
X-INSM-ip-source: 217.201.15.143 Auth Done
X-Virus-Checked: Checked by ClamAV on apache.org

--Boundary_(ID_hf/vOB2nC+4sPHPqSLtGdg)
Content-type: text/plain;	charset="us-ascii"
Content-transfer-encoding: 7bit

Dear all,

 

I read a very old message on the list about the use of sumOfSquaredWeights
in lengthNorm (Mon, 06 Mar 2006 19:06:28 GMT from Eugene). I just wanted to
do the same, i.e., to override the Similarity class of Lucene in order to
normalize the term weights of a doc with the sum of the squares of doc term
frequencies in the doc. 

 

Cheers

 

Claudio

 


--Boundary_(ID_hf/vOB2nC+4sPHPqSLtGdg)--

From java-user-return-41799-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 10 13:18:05 2009
Return-Path: <java-user-return-41799-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3251 invoked from network); 10 Aug 2009 13:18:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Aug 2009 13:18:05 -0000
Received: (qmail 48763 invoked by uid 500); 10 Aug 2009 13:18:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48685 invoked by uid 500); 10 Aug 2009 13:18:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48675 invoked by uid 99); 10 Aug 2009 13:18:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Aug 2009 13:18:10 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.177] (HELO spunkymail-a18.g.dreamhost.com) (208.97.132.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Aug 2009 13:18:00 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a18.g.dreamhost.com (Postfix) with ESMTP id 6B0815B532
	for <java-user@lucene.apache.org>; Mon, 10 Aug 2009 06:17:40 -0700 (PDT)
Message-Id: <E3C71F9E-DC2A-42C3-8E30-8B2FC0013CD8@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <001e01ca1990$6d4c9180$47e5b480$%gennaro@isti.cnr.it>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: sumOfSquaredWeights for lengthNorm
Date: Mon, 10 Aug 2009 09:17:39 -0400
References: <001e01ca1990$6d4c9180$47e5b480$%gennaro@isti.cnr.it>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

You can override the Similarity class and set it on both the  
IndexWriter and the IndexReader.   Is that your question?

On Aug 10, 2009, at 3:55 AM, Claudio Gennaro wrote:

> Dear all,
>
>
>
> I read a very old message on the list about the use of  
> sumOfSquaredWeights
> in lengthNorm (Mon, 06 Mar 2006 19:06:28 GMT from Eugene). I just  
> wanted to
> do the same, i.e., to override the Similarity class of Lucene in  
> order to
> normalize the term weights of a doc with the sum of the squares of  
> doc term
> frequencies in the doc.
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41800-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 10 13:59:03 2009
Return-Path: <java-user-return-41800-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23585 invoked from network); 10 Aug 2009 13:59:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Aug 2009 13:59:02 -0000
Received: (qmail 13801 invoked by uid 500); 10 Aug 2009 13:59:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13764 invoked by uid 500); 10 Aug 2009 13:59:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13739 invoked by uid 99); 10 Aug 2009 13:59:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Aug 2009 13:59:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of claudio.gennaro@isti.cnr.it designates 194.119.192.6 as permitted sender)
Received: from [194.119.192.6] (HELO ITANIUM.ISTI.CNR.IT) (194.119.192.6)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Aug 2009 13:58:56 +0000
Received: from conversionlocal.isti.cnr.it by mx.isti.cnr.it (PMDF V6.4 #31598)
 id <01NCD2XQ815C9VWC76@mx.isti.cnr.it> for java-user@lucene.apache.org; Mon,
 10 Aug 2009 15:58:00 +0200 (MEST)
Received: from ultralisca ([217.201.17.16])
 by mx.isti.cnr.it (PMDF V6.4 #31599) with ESMTPA id
 <01NCD2XFZJBA9S3WL7@mx.isti.cnr.it> for java-user@lucene.apache.org; Mon,
 10 Aug 2009 15:58:00 +0200
Date: Mon, 10 Aug 2009 15:57:43 +0200
From: Claudio Gennaro <claudio.gennaro@isti.cnr.it>
Subject: R: sumOfSquaredWeights for lengthNorm
In-reply-to: <E3C71F9E-DC2A-42C3-8E30-8B2FC0013CD8@apache.org>
To: java-user@lucene.apache.org
Message-id: <000001ca19c2$8fe17df0$afa479d0$%gennaro@isti.cnr.it>
MIME-version: 1.0
X-Mailer: Microsoft Office Outlook 12.0
Content-type: text/plain; charset=iso-8859-1
Content-language: it
Content-transfer-encoding: quoted-printable
Thread-Index: AcoZvQZgxUDRmpm6SJyqq6YbZo87twAA8olA
X-INSM-ip-source: 217.201.17.16 Auth Done
References: <001e01ca1990$6d4c9180$47e5b480$%gennaro@isti.cnr.it>
 <E3C71F9E-DC2A-42C3-8E30-8B2FC0013CD8@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Yes, this is probably the right way, but the problem is how. The method
lengthNorm(String fieldName, int numTerms) of the Similarity Class takes =
as
input parameter only the number of terms of the current doc being =
indexed.
Instead, I need the evaluate the sum of the squared of the distinct term
frequencies.

Claudio

-----Messaggio originale-----
Da: Grant Ingersoll [mailto:gsingers@apache.org]=20
Inviato: luned=EC 10 agosto 2009 15.18
A: java-user@lucene.apache.org
Oggetto: Re: sumOfSquaredWeights for lengthNorm

You can override the Similarity class and set it on both the =20
IndexWriter and the IndexReader.   Is that your question?

On Aug 10, 2009, at 3:55 AM, Claudio Gennaro wrote:

> Dear all,
>
>
>
> I read a very old message on the list about the use of =20
> sumOfSquaredWeights
> in lengthNorm (Mon, 06 Mar 2006 19:06:28 GMT from Eugene). I just =20
> wanted to
> do the same, i.e., to override the Similarity class of Lucene in =20
> order to
> normalize the term weights of a doc with the sum of the squares of =20
> doc term
> frequencies in the doc.
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41801-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 10 19:00:14 2009
Return-Path: <java-user-return-41801-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58531 invoked from network); 10 Aug 2009 19:00:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Aug 2009 19:00:13 -0000
Received: (qmail 26623 invoked by uid 500); 10 Aug 2009 19:00:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26549 invoked by uid 500); 10 Aug 2009 19:00:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26539 invoked by uid 99); 10 Aug 2009 19:00:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Aug 2009 19:00:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Kuro@basistech.com designates 199.88.205.136 as permitted sender)
Received: from [199.88.205.136] (HELO mailer.basistech.com) (199.88.205.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Aug 2009 19:00:07 +0000
Received: from mail.basistech.com (internal.basistech.net [10.1.250.1])
	by mailer.basistech.com (Postfix) with ESMTP id 84B38368CB
	for <java-user@lucene.apache.org>; Mon, 10 Aug 2009 14:59:44 -0400 (EDT)
X-DKIM: Sendmail DKIM Filter v2.8.3 mailer.basistech.com 84B38368CB
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=basistech.com;
	s=basis09jul; t=1249930784;
	bh=UNXDhtRGIi1lrgA7eg7HEI3QyZZ8feCK+018MlDDSCs=;
	h=From:To:Date:Subject:Message-ID:References:In-Reply-To:
	 Content-Type:Content-Transfer-Encoding:MIME-Version;
	b=y0L+YSa2KQftmqJH8URmc8ZgeV+0+VKnQo0wBdBlb5jpqb5iWCd4IO+zGlQSOQT+y
	 /ztUBtkUYdCMaZzqQy1c/OBgCRScA2oVZGSWzM9svI/KvJbmqHPVYN3QtHjE/Wgicz
	 DwWSE3DJylOAhfq4O1pMfpZHb9VlC+JTQHgDzpX4=
Received: from MSG-BOX.basistech.net ([::1]) by MSG-BOX.basistech.net ([::1])
 with mapi; Mon, 10 Aug 2009 14:59:46 -0400
From: Teruhiko Kurosaka <Kuro@basistech.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 10 Aug 2009 14:59:46 -0400
Subject: RE: Language Detection for Analysis?
Thread-Topic: Language Detection for Analysis?
Thread-Index: AcoWzqkvfjrCKrChQPylRNKLDcWgTgDHXvCQ
Message-ID: <CAE8639A6FAB3D4AA7973D5897B325185C4CEBE573@MSG-BOX.basistech.net>
References: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
In-Reply-To: <860544ed0908061246h49485a65se5b1acc5719343e9@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

A shameless self-promotion:
http://basistech.com/language-identification/
No, it's not free. Sorry.

We have Lucene-compatible Tokenizers for those languages too:
http://basistech.com/lucene/How-to-build-a-multilingual-search-engine.pdf

Contact me if you have questions.
-kuro =20

> -----Original Message-----
> From: Bradford Stephens [mailto:bradfordstephens@gmail.com]=20
> Sent: Thursday, August 06, 2009 12:46 PM
> To: solr-user@lucene.apache.org; java-user@lucene.apache.org
> Subject: Language Detection for Analysis?
>=20
> Hey there,
>=20
> We're trying to add foreign language support into our new=20
> search engine -- languages like Arabic, Farsi, and Urdu (that=20
> don't work with standard analyzers). But our data source=20
> doesn't tell us which languages we're actually collecting --=20
> we just get blocks of text. Has anyone here worked on=20
> language detection so we can figure out what analyzers to=20
> use? Are there commercial solutions?
>=20
> Much appreciated!

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41802-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 00:38:33 2009
Return-Path: <java-user-return-41802-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65775 invoked from network); 11 Aug 2009 00:38:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 00:38:33 -0000
Received: (qmail 10067 invoked by uid 500); 11 Aug 2009 00:38:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9993 invoked by uid 500); 11 Aug 2009 00:38:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9983 invoked by uid 99); 11 Aug 2009 00:38:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 00:38:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.60] (HELO web50306.mail.re2.yahoo.com) (206.190.38.60)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 11 Aug 2009 00:38:27 +0000
Received: (qmail 51295 invoked by uid 60001); 11 Aug 2009 00:38:06 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1249951086; bh=4ZmLeUv1RiSMqJSNJSv404h8ptcZh/ebxs+fd1bDx+0=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=QvJGc4bcNUfWEgCnOZiuL3LZlIFTMF3rFuIK8s4MPL2CO67pwrs+q8etwCzbsouqNGxN4nz4udI+70UsSE5UV6TNg6niFUVwjrr9g7f1EqBZXlUx7PPbgl2gp4+cXuFts3aGQ2/oULHdTSpouVQa0IlLL7EVV1Iu78EQz9brlXE=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=wyPX4O++g22mZ4RZe6Iu2M+0urcr6XOmedIaAQsulOlReefphHoT7xcpCmroKOafuzno5P96zggDFqJtWjQAZ4rtbqX6O4r07jbGt924b99uwD/qcIwC18ItUbTlWB0trFOSmfmuxc6DpOI+7u3vkCqmBGo5eQCRR+xEEq7zdLo=;
Message-ID: <68558.49916.qm@web50306.mail.re2.yahoo.com>
X-YMail-OSG: 89BAflkVM1mXN_1qVs6vKu6qZGIUSRQLw3r_IhzJaRXcPE12wQrf66jfotIgDWlG1JQaxIIl37RS8TGgmE9.BcCnSVkBdMjqf8X9v_RpWtncixIdl5_O4tJ1L4EDQltvZ0DHeyURksdSYdYXcu6Jaig7zqcciQZG7CuGJJ_7nwO7ZcjbbRO3lO5pelnhSge0fq7D_DZFJgriNpdXpM88KBJXFfNhQ6KuvSCoybMbxm0bupo_5.mSMcqtRyuW.XvRAdTOt6E2sJ.KXjKJycntZdkHsbFSGHRmJ3IxaTfbpObeabz9.mxtkgGVeTebCHjvFcI0eifZ.I32Wy2n5Q--
Received: from [74.73.24.33] by web50306.mail.re2.yahoo.com via HTTP; Mon, 10 Aug 2009 17:38:05 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
References: <1324e4e20908100023v78d2d1b1jb4d0473815c24737@mail.gmail.com>
Date: Mon, 10 Aug 2009 17:38:05 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Taking too much time in optimization
To: java-user@lucene.apache.org
In-Reply-To: <1324e4e20908100023v78d2d1b1jb4d0473815c24737@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

That mergeFactor is too high.  I suggest going back to default (10).
maxBufferedDocs is an old and not very accurate setting (imagine what happens with the JVM heap if your indexer hits a SUPER LARGE document).  Use setRamBufferSizeMB instead.

Otis
--
Sematext is hiring -- http://sematext.com/about/jobs.html?mls
Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR



----- Original Message ----
> From: Laxmilal Menariya <lmenaria@chambal.com>
> To: java-user@lucene.apache.org
> Sent: Monday, August 10, 2009 3:23:17 AM
> Subject: Taking too much time in optimization
> 
> Hello everyone,
> 
> I have created a sample application & indexing files properties, have index
> appx 107K files.
> 
> I am getting OutofMemoryError after 100K while indexing,  got the cause from
> MaxBuffereddocs=100K, but after that I am calling optimize() method, this is
> taking too much time appx 12-HRS, and index size is more than 500GB, its too
> large.
> 
> I am using Lucene 2.4.0. Could some one please let me know what wrong with
> my configuration.
> 
> My Configuration is :
> 
>       lucWriter = new IndexWriter("C:\\Laxmilal", new KeywordAnalyzer(),
> true);
>       lucWriter.setMergeFactor((int) 1000);
>       lucWriter.setMaxMergeDocs((int) 2147483647);
>       lucWriter.setMaxBufferedDocs((int) 100000);
> 
> 
> -- 
> Thanks,
> Laxmilal Menariya
> 
> http://www.bucketexplorer.com/
> http://www.sdbexplorer.com/
> http://www.chambal.com/


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41803-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 01:22:02 2009
Return-Path: <java-user-return-41803-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75343 invoked from network); 11 Aug 2009 01:22:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 01:22:02 -0000
Received: (qmail 38191 invoked by uid 500); 11 Aug 2009 01:22:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38097 invoked by uid 500); 11 Aug 2009 01:22:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38087 invoked by uid 99); 11 Aug 2009 01:22:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 01:22:06 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a4.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 01:21:57 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a4.g.dreamhost.com (Postfix) with ESMTP id ABE803BA08
	for <java-user@lucene.apache.org>; Mon, 10 Aug 2009 18:21:36 -0700 (PDT)
Message-Id: <F4B7B4C6-A2AA-4064-832A-B3FA6EF197BA@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <74f928500908090210x1da86971ibad538f6fba97227@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: score from spans
Date: Mon, 10 Aug 2009 21:21:36 -0400
References: <74f928500908020830h5d3f4d0aw1f1ed2016c67200@mail.gmail.com> <70FA860F-B368-462B-A510-FBA44FB1806D@apache.org> <74f928500908090210x1da86971ibad538f6fba97227@mail.gmail.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


On Aug 9, 2009, at 5:10 AM, Eran Sevi wrote:

> Thanks for the answer.
>
> I tried to further understand the weight and score mechanism when  
> running a
> span query search.
> I noticed that indeed the SpanScorer and SpanWeight are being called  
> and
> some score is returned but it seems to me that these basic  
> implementations
> are more appropriate for the basic SpanTermQuery.
> For the other types of span queries, the inner queries scores and  
> weights
> are not taken into account - for example if I run a simple  
> SpanOrQuery and
> boost one of it's child SpanTermQuery, the boost is not taken into  
> account.
>
> It seems to me that some recursive calculation is required in order  
> to take
> into account all the weights and scores of the span's sub queries.
> I'm trying to come up with a correct implementation for SpanOrQuery,
> SpanNearQuery, SpanNotQuery based on similiar calculations of  
> BooleanQuery.
>
> Do you have a better idea on how to achieve the correct scoring? the  
> score
> calculations are quite complex for each case of span queries so any  
> help is
> appreciated.
>

This will need to be implemented.  It's funny, but I didn't realize  
this was the case until the other day when I was looking deeper into  
payload capabilities.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41804-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 01:28:52 2009
Return-Path: <java-user-return-41804-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79291 invoked from network); 11 Aug 2009 01:28:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 01:28:52 -0000
Received: (qmail 45632 invoked by uid 500); 11 Aug 2009 01:28:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45554 invoked by uid 500); 11 Aug 2009 01:28:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45544 invoked by uid 99); 11 Aug 2009 01:28:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 01:28:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.221.203 as permitted sender)
Received: from [209.85.221.203] (HELO mail-qy0-f203.google.com) (209.85.221.203)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 01:28:44 +0000
Received: by qyk41 with SMTP id 41so3244942qyk.29
        for <java-user@lucene.apache.org>; Mon, 10 Aug 2009 18:28:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=gyKsThLhdwL6arSKbKSfoWme4jHHA+V+wIVXcEDO8yA=;
        b=pf/n2cW4JT2au2jUmzZr1Oa4LBtG0+tb/cLIGq9XdJBQ+9cW6udi+YF7dR0faYu4Ov
         7APFIFsr8ncJ89HD9q6rKzFc0A0gNACHGkueldoR0OX0BvsHnLwkBaS9C8K5nKzazB1Z
         gWFywRPe71WrQYbFR98gdn4qRJsG3uauziJus=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=CQmLh38Zhcmld4I+UAjkQWb7LyhZD2ETougjJRfuYodyPmIlh0nAcvgEKKTZtcwPNo
         PKrwTMzf6PcJtPGMiRAiwWzFW1XENdATTm2wZUNf7sf2/f0LFjK7mwdtm4XcksCgO+t0
         x++LGeYB7dIOXatHWuecNmUUcVoClgJb+BMac=
Received: by 10.224.60.139 with SMTP id p11mr3813332qah.38.1249954100420;
        Mon, 10 Aug 2009 18:28:20 -0700 (PDT)
Received: from ?192.168.1.102? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 6sm1228824qwd.18.2009.08.10.18.28.19
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 10 Aug 2009 18:28:19 -0700 (PDT)
Message-ID: <4A80C935.4040605@gmail.com>
Date: Mon, 10 Aug 2009 21:28:21 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.22 (X11/20090608)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: score from spans
References: <74f928500908020830h5d3f4d0aw1f1ed2016c67200@mail.gmail.com>	 <70FA860F-B368-462B-A510-FBA44FB1806D@apache.org> <74f928500908090210x1da86971ibad538f6fba97227@mail.gmail.com>
In-Reply-To: <74f928500908090210x1da86971ibad538f6fba97227@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hey Eran,

I've started work on this in the past - you are right, it gets 
complicated quick! Its also likely to bring with it a sizable 
performance cost.

We already have an issue in JIRA for this that is quite old: 
https://issues.apache.org/jira/browse/LUCENE-533

If you get any work going, don't be shy to start posting code there, and 
perhaps you can get some additional eyes/help as you go.

I think in the end, it might have to be an optional mode, if we get the 
code produced.

-- 
- Mark

http://www.lucidimagination.com



Eran Sevi wrote:
> Thanks for the answer.
>
> I tried to further understand the weight and score mechanism when running a
> span query search.
> I noticed that indeed the SpanScorer and SpanWeight are being called and
> some score is returned but it seems to me that these basic implementations
> are more appropriate for the basic SpanTermQuery.
> For the other types of span queries, the inner queries scores and weights
> are not taken into account - for example if I run a simple SpanOrQuery and
> boost one of it's child SpanTermQuery, the boost is not taken into account.
>
> It seems to me that some recursive calculation is required in order to take
> into account all the weights and scores of the span's sub queries.
> I'm trying to come up with a correct implementation for SpanOrQuery,
> SpanNearQuery, SpanNotQuery based on similiar calculations of BooleanQuery.
>
> Do you have a better idea on how to achieve the correct scoring? the score
> calculations are quite complex for each case of span queries so any help is
> appreciated.
>
> Thanks, Eran.
>
> On Tue, Aug 4, 2009 at 8:51 PM, Grant Ingersoll <gsingers@apache.org> wrote:
>
>   
>> A SpanQuery is a Query, so if you do a search for it, you will get scores.
>>  However, the mechanism is a bit complicated, b/c actually getting the Spans
>> is separate from doing the query.  I agree there could be tighter
>> integration.  However, what you could do is use Spans.skipTo to move to the
>> document you are examining in the search results.
>>
>> -Grant
>>
>>
>> On Aug 2, 2009, at 11:30 AM, Eran Sevi wrote:
>>
>> Hi,
>>     
>>> How can I get the score of a span that is the result of
>>> SpanQuery.getSpans()
>>> ? The score should can be the same for each document, but if it's unique
>>> per
>>> span, it's even better.
>>>
>>> I tried looking for a way to expose this functionality through the Spans
>>> class but it looks too complicated.
>>> I'm not even sure that by default some score calculation is even performed
>>> when using span queries.
>>>
>>> I've noticed that some calculations are made using payloads and
>>> BoostingTermQuery but the score result is used internally and can't be
>>> accessed from the Spans results.
>>> I don't want to re-run the query again using a HitCollector and since the
>>> reader is passed to getSpans, I think it should be possible to do what I
>>> want.
>>>
>>> Any help on the correct way to expose the span score will be appreciated.
>>>
>>> Thanks,
>>> Eran.
>>>
>>>       
>> --------------------------
>> Grant Ingersoll
>> http://www.lucidimagination.com/
>>
>> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) using
>> Solr/Lucene:
>> http://www.lucidimagination.com/search
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
>   





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41805-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 03:45:03 2009
Return-Path: <java-user-return-41805-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30067 invoked from network); 11 Aug 2009 03:45:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 03:45:03 -0000
Received: (qmail 16148 invoked by uid 500); 11 Aug 2009 03:45:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16048 invoked by uid 500); 11 Aug 2009 03:45:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16037 invoked by uid 99); 11 Aug 2009 03:45:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 03:45:07 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of shichuanwuhan@gmail.com designates 209.85.200.169 as permitted sender)
Received: from [209.85.200.169] (HELO wf-out-1314.google.com) (209.85.200.169)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 03:44:59 +0000
Received: by wf-out-1314.google.com with SMTP id 24so1186846wfg.20
        for <java-user@lucene.apache.org>; Mon, 10 Aug 2009 20:44:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=AWLMD8eyIR1zlocTeNi4mGEgpG/ZAhfrqkGfIgMRBac=;
        b=uLefEguH2HCje10cvGxbQd9mflDXSLD+NVqzAbxgnvIMGrc67q5Av65AanAVVlv0I6
         1YCH33e9GAwPwEfRtR7KIbU+w7XeGvtOvh3XTzgQj+3JDDW5FZpMKERpImvqKc+u7RK9
         9fv5+JwtyiPvcBVD7yRunDPa9Z4vwRJZUAPbo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=axcBQlhOInq4qFerJSZk+GkecIFIQ2hy2JmPZXwBdoaa2uaLvhblPutjdAS8h3pIlW
         hgnlNqXC8pOohE8UgJ23uB/immApC9O0adp7xI/HEeg/Y5X/Tv5PRlu6NTMh8FsfnHqo
         vyvDJjzE4jpIjNbRVbw1Sni8LqfHl86HRmlCA=
MIME-Version: 1.0
Received: by 10.142.225.20 with SMTP id x20mr714261wfg.255.1249962279242; Mon, 
	10 Aug 2009 20:44:39 -0700 (PDT)
Date: Tue, 11 Aug 2009 11:44:39 +0800
Message-ID: <1c3e185f0908102044j3f30896bua95ba433460cfaa8@mail.gmail.com>
Subject: How to solve this problem
From: =?GB2312?B?yq+0qA==?= <shichuanwuhan@gmail.com>
To: lucene mailing list <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=000e0cd28cf0a30deb0470d58520
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd28cf0a30deb0470d58520
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,
      I am a newbie in lucene and am trying the 'indexing and searching'
demo of lucene 1.4.3 using kaffe 1.0.6. After inputing the query, an error
occurs as follows:

       Query: stringSearching for: string
java.lang.NoSuchMethodError:
org/apache/lucene/search/Searcher.search(Lorg/apache/lucene/search/Query;Lorg/apache/lucene/search/Filter;I)Lorg/apache/
        at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:64)
        at org.apache.lucene.search.Hits.<init>(Hits.java:43)
        at org.apache.lucene.search.Searcher.search(Searcher.java:33)
        at org.apache.lucene.search.Searcher.search(Searcher.java:27)
        at org.apache.lucene.demo.SearchFiles.main(SearchFiles.java:49)

        However, when I use kaffe 1.1.0, it works well. I google for the
error information and it is said there is something wrong with my jar
package. Could anybody give some suggestion? Thanks.

-- 
Best regards,

Shi Chuan

--000e0cd28cf0a30deb0470d58520--

From java-user-return-41806-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 04:22:24 2009
Return-Path: <java-user-return-41806-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35028 invoked from network); 11 Aug 2009 04:22:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 04:22:24 -0000
Received: (qmail 41260 invoked by uid 500); 11 Aug 2009 04:22:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41159 invoked by uid 500); 11 Aug 2009 04:22:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41149 invoked by uid 99); 11 Aug 2009 04:22:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 04:22:29 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lmenaria@chambal.com designates 209.85.200.172 as permitted sender)
Received: from [209.85.200.172] (HELO wf-out-1314.google.com) (209.85.200.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 04:22:17 +0000
Received: by wf-out-1314.google.com with SMTP id 24so1194335wfg.20
        for <java-user@lucene.apache.org>; Mon, 10 Aug 2009 21:21:54 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.135.7 with SMTP id i7mr391584wfd.294.1249964514843; Mon, 
	10 Aug 2009 21:21:54 -0700 (PDT)
In-Reply-To: <68558.49916.qm@web50306.mail.re2.yahoo.com>
References: <1324e4e20908100023v78d2d1b1jb4d0473815c24737@mail.gmail.com>
	 <68558.49916.qm@web50306.mail.re2.yahoo.com>
Date: Tue, 11 Aug 2009 09:51:54 +0530
Message-ID: <1324e4e20908102121m3bc13745x21335c9bb9993a2d@mail.gmail.com>
Subject: Re: Taking too much time in optimization
From: Laxmilal Menariya <lmenaria@chambal.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd32d2ae39edc0470d60abf
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd32d2ae39edc0470d60abf
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks, I will try.

On Tue, Aug 11, 2009 at 6:08 AM, Otis Gospodnetic <
otis_gospodnetic@yahoo.com> wrote:

> Hi,
>
> That mergeFactor is too high.  I suggest going back to default (10).
> maxBufferedDocs is an old and not very accurate setting (imagine what
> happens with the JVM heap if your indexer hits a SUPER LARGE document).  Use
> setRamBufferSizeMB instead.
>
> Otis
> --
> Sematext is hiring -- http://sematext.com/about/jobs.html?mls
> Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR
>
>
>
> ----- Original Message ----
> > From: Laxmilal Menariya <lmenaria@chambal.com>
> > To: java-user@lucene.apache.org
> > Sent: Monday, August 10, 2009 3:23:17 AM
> > Subject: Taking too much time in optimization
> >
> > Hello everyone,
> >
> > I have created a sample application & indexing files properties, have
> index
> > appx 107K files.
> >
> > I am getting OutofMemoryError after 100K while indexing,  got the cause
> from
> > MaxBuffereddocs=100K, but after that I am calling optimize() method, this
> is
> > taking too much time appx 12-HRS, and index size is more than 500GB, its
> too
> > large.
> >
> > I am using Lucene 2.4.0. Could some one please let me know what wrong
> with
> > my configuration.
> >
> > My Configuration is :
> >
> >       lucWriter = new IndexWriter("C:\\Laxmilal", new KeywordAnalyzer(),
> > true);
> >       lucWriter.setMergeFactor((int) 1000);
> >       lucWriter.setMaxMergeDocs((int) 2147483647);
> >       lucWriter.setMaxBufferedDocs((int) 100000);
> >
> >
> > --
> > Thanks,
> > Laxmilal Menariya
> >
> > http://www.bucketexplorer.com/
> > http://www.sdbexplorer.com/
> > http://www.chambal.com/
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Thanks,
Laxmilal Menariya

http://www.bucketexplorer.com/
http://www.sdbexplorer.com/
http://www.chambal.com/

--000e0cd32d2ae39edc0470d60abf--

From java-user-return-41807-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 04:48:08 2009
Return-Path: <java-user-return-41807-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37236 invoked from network); 11 Aug 2009 04:48:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 04:48:08 -0000
Received: (qmail 52117 invoked by uid 500); 11 Aug 2009 04:48:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52021 invoked by uid 500); 11 Aug 2009 04:48:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52011 invoked by uid 99); 11 Aug 2009 04:48:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 04:48:12 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of alexander.aristov@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 04:48:03 +0000
Received: by ewy26 with SMTP id 26so3732000ewy.5
        for <java-user@lucene.apache.org>; Mon, 10 Aug 2009 21:47:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=tAgk0HNDledvsaM1qQeEbTgqD4dIT/CwXpr5VDLwr0Y=;
        b=no7JvVE645QgKsedBuzAQjlhXifKYaVFMUZaUyoHhGlmSv5SvwijbdLZILspu4edH3
         CuhdP7BhJfyQSAsKKpMq4jv/Duc6+aorDw662nWbjWcL5EJGdo7ET1n3fEidhLp9LBSH
         5VVywzutrSgV4PuJLH0QELR0z09cZbD63P4Cg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=n/UMVhBtceFviePPrWBRp89Yk6MZ7MHqmKcW1pL89OywhHReO284l2olUGD7TXhB0G
         flWKacc43CR8i3tdHRgI3grtbc/7ImfScSw15FsbiQyfSxM5MpYhriIFuTadnxBKmJne
         GdiWeuOgzB41eGr40F5XGg9bqgoZL8fPi2FRw=
MIME-Version: 1.0
Received: by 10.216.85.199 with SMTP id u49mr1170571wee.79.1249966063129; Mon, 
	10 Aug 2009 21:47:43 -0700 (PDT)
In-Reply-To: <1c3e185f0908102044j3f30896bua95ba433460cfaa8@mail.gmail.com>
References: <1c3e185f0908102044j3f30896bua95ba433460cfaa8@mail.gmail.com>
From: Alexander Aristov <alexander.aristov@gmail.com>
Date: Tue, 11 Aug 2009 08:47:23 +0400
Message-ID: <11975c90908102147n2aa76f94s2cec04d882cf8fa@mail.gmail.com>
Subject: Re: How to solve this problem
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6dab0b42c93bb0470d66781
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6dab0b42c93bb0470d66781
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

I suspect that you might use incompatible versions of lucene and kaffe.
Though I have never worked with kaffe before and so might be wrong.

Best Regards
Alexander Aristov


2009/8/11 =E7=9F=B3=E5=B7=9D <shichuanwuhan@gmail.com>

> Hi,
>      I am a newbie in lucene and am trying the 'indexing and searching'
> demo of lucene 1.4.3 using kaffe 1.0.6. After inputing the query, an erro=
r
> occurs as follows:
>
>       Query: stringSearching for: string
> java.lang.NoSuchMethodError:
>
> org/apache/lucene/search/Searcher.search(Lorg/apache/lucene/search/Query;=
Lorg/apache/lucene/search/Filter;I)Lorg/apache/
>        at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:64)
>        at org.apache.lucene.search.Hits.<init>(Hits.java:43)
>        at org.apache.lucene.search.Searcher.search(Searcher.java:33)
>        at org.apache.lucene.search.Searcher.search(Searcher.java:27)
>        at org.apache.lucene.demo.SearchFiles.main(SearchFiles.java:49)
>
>        However, when I use kaffe 1.1.0, it works well. I google for the
> error information and it is said there is something wrong with my jar
> package. Could anybody give some suggestion? Thanks.
>
> --
> Best regards,
>
> Shi Chuan
>

--0016e6dab0b42c93bb0470d66781--

From java-user-return-41808-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 07:08:45 2009
Return-Path: <java-user-return-41808-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88970 invoked from network); 11 Aug 2009 07:08:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 07:08:45 -0000
Received: (qmail 78295 invoked by uid 500); 11 Aug 2009 07:08:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78214 invoked by uid 500); 11 Aug 2009 07:08:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78204 invoked by uid 99); 11 Aug 2009 07:08:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 07:08:49 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [212.27.42.2] (HELO smtp2-g21.free.fr) (212.27.42.2)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 07:08:40 +0000
Received: from smtp2-g21.free.fr (localhost [127.0.0.1])
	by smtp2-g21.free.fr (Postfix) with ESMTP id 119544B00AA
	for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 09:08:12 +0200 (CEST)
Received: from [192.168.123.11] (che33-2-82-225-177-85.fbx.proxad.net [82.225.177.85])
	by smtp2-g21.free.fr (Postfix) with ESMTP id 21C2C4B00EA
	for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 09:08:10 +0200 (CEST)
Message-ID: <4A811738.6050007@ajlsm.com>
Date: Tue, 11 Aug 2009 09:01:12 +0200
From: Malo Pichot <malo.pichot@ajlsm.com>
User-Agent: Thunderbird 2.0.0.22 (X11/20090608)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: How to solve this problem
References: <1c3e185f0908102044j3f30896bua95ba433460cfaa8@mail.gmail.com>
In-Reply-To: <1c3e185f0908102044j3f30896bua95ba433460cfaa8@mail.gmail.com>
X-Enigmail-Version: 0.95.7
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

石川 a écrit :
> Hi,
>       I am a newbie in lucene and am trying the 'indexing and searching'
> demo of lucene 1.4.3 using kaffe 1.0.6. After inputing the query, an error
> occurs as follows:
> 
>        Query: stringSearching for: string
> java.lang.NoSuchMethodError:
> org/apache/lucene/search/Searcher.search(Lorg/apache/lucene/search/Query;Lorg/apache/lucene/search/Filter;I)Lorg/apache/
>         at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:64)
>         at org.apache.lucene.search.Hits.<init>(Hits.java:43)
>         at org.apache.lucene.search.Searcher.search(Searcher.java:33)
>         at org.apache.lucene.search.Searcher.search(Searcher.java:27)
>         at org.apache.lucene.demo.SearchFiles.main(SearchFiles.java:49)
> 
>         However, when I use kaffe 1.1.0, it works well. I google for the
> error information and it is said there is something wrong with my jar
> package. Could anybody give some suggestion? Thanks.


Hello,

I think you use a wrong version of JVM, not the same version that has
been used to compile your Lune JAR.

Malo

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41809-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 08:27:28 2009
Return-Path: <java-user-return-41809-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14694 invoked from network); 11 Aug 2009 08:27:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 08:27:28 -0000
Received: (qmail 69885 invoked by uid 500); 11 Aug 2009 08:27:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69804 invoked by uid 500); 11 Aug 2009 08:27:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69794 invoked by uid 99); 11 Aug 2009 08:27:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 08:27:32 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of shichuanwuhan@gmail.com designates 209.85.200.171 as permitted sender)
Received: from [209.85.200.171] (HELO wf-out-1314.google.com) (209.85.200.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 08:27:24 +0000
Received: by wf-out-1314.google.com with SMTP id 24so1244749wfg.20
        for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 01:27:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=U8tR6UPn4e+Varb5EZs28Gusrjm55hsO6QR4GkgKfzM=;
        b=w+FEtTknoCBA6tmbWlI7t76hftr9bNb+RQphV1hb9NB4qjTCGxbTlTHB5xfCGdPi6j
         x2JsOb/n3G+gi6TUfAL1cqGrShmp0ZXcM8tuJWGj6YLSq/xQz8kCphOOoTWa4IKn88Tp
         c9Uk1QOpqtjeAkoX/kMQhyXUzylb4yzR147kk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ngzqIRcEvhkzPlkMNtqPEHaVJiSy3dq/Q3BxdBQjf309MoPfifqCLNCnud/5AXLTZJ
         Pf9SmhOHH4tYydFIftV95oxNgzcp4WnZK/VnCVAbvGuilCebOXFkt22Btng0DD4K44e9
         x/w2TQ7OxcHB8MO9He4kn6O1BcBI+zVZSxaXw=
MIME-Version: 1.0
Received: by 10.143.5.17 with SMTP id h17mr1005502wfi.164.1249979224421; Tue, 
	11 Aug 2009 01:27:04 -0700 (PDT)
In-Reply-To: <4A811738.6050007@ajlsm.com>
References: <1c3e185f0908102044j3f30896bua95ba433460cfaa8@mail.gmail.com>
	 <4A811738.6050007@ajlsm.com>
Date: Tue, 11 Aug 2009 16:27:04 +0800
Message-ID: <1c3e185f0908110127na272b3bo87e12a25eb784dad@mail.gmail.com>
Subject: Re: How to solve this problem
From: Chuan SHI <shichuanwuhan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636e0a821a5f6e50470d977e7
X-Virus-Checked: Checked by ClamAV on apache.org

--001636e0a821a5f6e50470d977e7
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: quoted-printable

Yeah you are quite right, Malo. I recompile lucene143 with lower jdk and it
works. Thank you.

2009/8/11 Malo Pichot <malo.pichot@ajlsm.com>

> =CA=AF=B4=A8 a =A8=A6crit :
> > Hi,
> >       I am a newbie in lucene and am trying the 'indexing and searching=
'
> > demo of lucene 1.4.3 using kaffe 1.0.6. After inputing the query, an
> error
> > occurs as follows:
> >
> >        Query: stringSearching for: string
> > java.lang.NoSuchMethodError:
> >
> org/apache/lucene/search/Searcher.search(Lorg/apache/lucene/search/Query;=
Lorg/apache/lucene/search/Filter;I)Lorg/apache/
> >         at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:64)
> >         at org.apache.lucene.search.Hits.<init>(Hits.java:43)
> >         at org.apache.lucene.search.Searcher.search(Searcher.java:33)
> >         at org.apache.lucene.search.Searcher.search(Searcher.java:27)
> >         at org.apache.lucene.demo.SearchFiles.main(SearchFiles.java:49)
> >
> >         However, when I use kaffe 1.1.0, it works well. I google for th=
e
> > error information and it is said there is something wrong with my jar
> > package. Could anybody give some suggestion? Thanks.
>
>
> Hello,
>
> I think you use a wrong version of JVM, not the same version that has
> been used to compile your Lune JAR.
>
> Malo
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


--=20
Best regards,

Chuan SHI

--001636e0a821a5f6e50470d977e7--

From java-user-return-41810-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 08:29:18 2009
Return-Path: <java-user-return-41810-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15362 invoked from network); 11 Aug 2009 08:29:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 08:29:17 -0000
Received: (qmail 75643 invoked by uid 500); 11 Aug 2009 08:29:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75578 invoked by uid 500); 11 Aug 2009 08:29:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75568 invoked by uid 99); 11 Aug 2009 08:29:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 08:29:22 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of shichuanwuhan@gmail.com designates 209.85.222.186 as permitted sender)
Received: from [209.85.222.186] (HELO mail-pz0-f186.google.com) (209.85.222.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 08:29:12 +0000
Received: by pzk16 with SMTP id 16so3369818pzk.20
        for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 01:28:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=KKYrCIsoVuG/IjuA6v/5pTfmF4KQuxVpfwpItMAW0So=;
        b=EvjBojX4vfDDeeWCMYFuSFwuOaWRJ5q1TeXvwKPH2312lJtB+5SBFipkhJ/GpWKIiI
         qRnuGR/7IkAiVmxioO1EpoEyZARl0VHqX/Ny6RniNTxHHdW4fSLh+69sEo9zoImD2gh2
         9/uJBnkf+nJGgixY0Am4uA57N+8mIG/orhFTE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=sijHhRxUtnF9vD+f03ZQOVEje9gOmi+ycbAXX8V2B5umWUqmqH86SKhV9f6GLR1zjb
         eeosL71wld4rEIYEWvgf35lsrHNmYmXlPOT+vO2nalrKT8ot9VrDuSCCm1/bJKlTPMuS
         9f2IA6PhdYCkY+dzf8CZxVGL1WMxZwDcjM6Cs=
MIME-Version: 1.0
Received: by 10.142.13.13 with SMTP id 13mr1141383wfm.119.1249979331439; Tue, 
	11 Aug 2009 01:28:51 -0700 (PDT)
In-Reply-To: <11975c90908102147n2aa76f94s2cec04d882cf8fa@mail.gmail.com>
References: <1c3e185f0908102044j3f30896bua95ba433460cfaa8@mail.gmail.com>
	 <11975c90908102147n2aa76f94s2cec04d882cf8fa@mail.gmail.com>
Date: Tue, 11 Aug 2009 16:28:51 +0800
Message-ID: <1c3e185f0908110128g1202b6a9g7a606c79d3a3ec4f@mail.gmail.com>
Subject: Re: How to solve this problem
From: Chuan SHI <shichuanwuhan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd5097a06ec770470d97ec6
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd5097a06ec770470d97ec6
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: quoted-printable

Although you have not worked with kaffe, your suggestion is right. Thank
you.

2009/8/11 Alexander Aristov <alexander.aristov@gmail.com>

> I suspect that you might use incompatible versions of lucene and kaffe.
> Though I have never worked with kaffe before and so might be wrong.
>
> Best Regards
> Alexander Aristov
>
>
> 2009/8/11 =CA=AF=B4=A8 <shichuanwuhan@gmail.com>
>
> > Hi,
> >      I am a newbie in lucene and am trying the 'indexing and searching'
> > demo of lucene 1.4.3 using kaffe 1.0.6. After inputing the query, an
> error
> > occurs as follows:
> >
> >       Query: stringSearching for: string
> > java.lang.NoSuchMethodError:
> >
> >
> org/apache/lucene/search/Searcher.search(Lorg/apache/lucene/search/Query;=
Lorg/apache/lucene/search/Filter;I)Lorg/apache/
> >        at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:64)
> >        at org.apache.lucene.search.Hits.<init>(Hits.java:43)
> >        at org.apache.lucene.search.Searcher.search(Searcher.java:33)
> >        at org.apache.lucene.search.Searcher.search(Searcher.java:27)
> >        at org.apache.lucene.demo.SearchFiles.main(SearchFiles.java:49)
> >
> >        However, when I use kaffe 1.1.0, it works well. I google for the
> > error information and it is said there is something wrong with my jar
> > package. Could anybody give some suggestion? Thanks.
> >
> > --
> > Best regards,
> >
> > Shi Chuan
> >
>



--=20
Best regards,

Chuan SHI

--000e0cd5097a06ec770470d97ec6--

From java-user-return-41811-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 08:51:39 2009
Return-Path: <java-user-return-41811-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24438 invoked from network); 11 Aug 2009 08:51:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 08:51:39 -0000
Received: (qmail 16266 invoked by uid 500); 11 Aug 2009 08:51:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16185 invoked by uid 500); 11 Aug 2009 08:51:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16175 invoked by uid 99); 11 Aug 2009 08:51:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 08:51:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 08:51:34 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Man4D-0006Ck-0r
	for java-user@lucene.apache.org; Tue, 11 Aug 2009 01:50:49 -0700
Message-ID: <24913967.post@talk.nabble.com>
Date: Tue, 11 Aug 2009 01:50:49 -0700 (PDT)
From: bourne71 <garylkc@live.com>
To: java-user@lucene.apache.org
Subject: Query Boosting
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: garylkc@live.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I am fairly new to Lucene and have encounter a problem with the search
function i am trying to create using Lucene.  When I search, lets say "news
sharing", then the results return and display.

Its fine up to this point until I check the ranking. Some results, although
match only 1 of the 2 keywords, will have higher ranking. The problem is
like describe below:

Page 1
news - Total found 23
sharing - Total found 0

Page 2
news - Total found 1
sharing - Total found 21

This is understandable why Page 1 got better ranking, bcs it has more
keyword found. But this will make the results return to be less relevant

My current query is like the following:
(url:sharing^2.0 content:sharing title:sharing^1.5) (url:news^2.0
content:news title:news^1.5) url:"sharing news"~2147483647^2.0
content:"sharing news"~2147483647 title:"sharing news"~2147483647^1.5 

Is there anyway I can add an additional query that will give an additional
boost to results that has both the keyword in it?
-- 
View this message in context: http://www.nabble.com/Query-Boosting-tp24913967p24913967.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41812-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 09:53:06 2009
Return-Path: <java-user-return-41812-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54982 invoked from network); 11 Aug 2009 09:53:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 09:53:06 -0000
Received: (qmail 76387 invoked by uid 500); 11 Aug 2009 09:53:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76300 invoked by uid 500); 11 Aug 2009 09:53:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76290 invoked by uid 99); 11 Aug 2009 09:53:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 09:53:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 09:53:00 +0000
Received: by fxm2 with SMTP id 2so3171525fxm.28
        for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 02:52:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=Oj3UQuSHw8SdzLRqHY85HZ7X8g1J4Wkcvy0i1DsjuTg=;
        b=u2E7vPe7gPPBAjVQ7mi7atEqK9T4oXIrk/W+eJHw/r0QIkePP7IBLHw1sbNjNGP1aq
         LqALiTiIyWHnZ+ssTl+orFwIDjExeinZgg2EC231+fshzh1xxdXG8US2UdnfLNmDVU7Q
         o35KUMQzEZb1e2iqD2iswwnDI0dAw+xz7B6+M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=hRMz4mNCVClEQ8hoYczaoACtjS/KS9JMDHsa+H05eHmtV5Vp4le8CHRjroRNmhdphx
         PG9LgiM1l+FHq3nbBg2Hs4Q2p+k990sQXHldLPl+PzNA6acZ6G2GsyEDxAzNSFno09Hw
         JCHQIYgpDIBOzojm3QJZ1G+Ukmo0pTMW+lLwc=
MIME-Version: 1.0
Received: by 10.239.161.132 with SMTP id h4mr610049hbd.14.1249984358550; Tue, 
	11 Aug 2009 02:52:38 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <24913967.post@talk.nabble.com>
References: <24913967.post@talk.nabble.com>
Date: Tue, 11 Aug 2009 11:52:38 +0200
Message-ID: <f18c9dde0908110252k7042745ga008b9c965cc1f09@mail.gmail.com>
Subject: Re: Query Boosting
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi there,

well, where to start from.... I would suggest you look at the output
of Query#explain() first to see how the score is calculated. You might
use a simpler query to get started with it as this might be quite
cryptic if you see it the first time.
To completely understand what the output means have a closer look to
the javadoc of the class Similarity
(http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/search/Simi=
larity.html)
this will explain how the score is calculated in the very detail.
Once you understand what is going on during the scoring process I
would suggest you revise your boosting. I don't know if you have field
boost set but it seems it would make more sense in your usecase as far
as I can tell.
In general make sure you understand what the different boosts are used
for - this snippet from the wiki might help you:
<snip>
What is the difference between field (or document) boosting and query boost=
ing?

Index time field boosts (field.setBoost(boost)) are a way to express
things like "this document's title is worth twice as much as the title
of most documents". Query time boosts (query.setBoost(boost)) are a
way to express "I care about matches on this clause of my query twice
as much as I do about matches on other clauses of my query".

Index time field boosts are worthless if you set them on every document.

Index time document boosts (doc.setBoost(float)) are equivalent to
setting a field boost on ever field in that document.
</snip> (http://wiki.apache.org/lucene-java/LuceneFAQ#head-246300129b9d3bf7=
3f597facec54ac2ee54e15d7)

hope that helps to get started with scoring etc.

simon


On Tue, Aug 11, 2009 at 10:50 AM, bourne71<garylkc@live.com> wrote:
>
> Hi,
>
> I am fairly new to Lucene and have encounter a problem with the search
> function i am trying to create using Lucene. =C2=A0When I search, lets sa=
y "news
> sharing", then the results return and display.
>
> Its fine up to this point until I check the ranking. Some results, althou=
gh
> match only 1 of the 2 keywords, will have higher ranking. The problem is
> like describe below:
>
> Page 1
> news - Total found 23
> sharing - Total found 0
>
> Page 2
> news - Total found 1
> sharing - Total found 21
>
> This is understandable why Page 1 got better ranking, bcs it has more
> keyword found. But this will make the results return to be less relevant
>
> My current query is like the following:
> (url:sharing^2.0 content:sharing title:sharing^1.5) (url:news^2.0
> content:news title:news^1.5) url:"sharing news"~2147483647^2.0
> content:"sharing news"~2147483647 title:"sharing news"~2147483647^1.5
>
> Is there anyway I can add an additional query that will give an additiona=
l
> boost to results that has both the keyword in it?
> --
> View this message in context: http://www.nabble.com/Query-Boosting-tp2491=
3967p24913967.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41813-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 10:14:03 2009
Return-Path: <java-user-return-41813-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65694 invoked from network); 11 Aug 2009 10:14:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 10:14:03 -0000
Received: (qmail 4384 invoked by uid 500); 11 Aug 2009 10:14:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4300 invoked by uid 500); 11 Aug 2009 10:14:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4270 invoked by uid 99); 11 Aug 2009 10:14:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 10:14:07 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.217.218] (HELO mail-gx0-f218.google.com) (209.85.217.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 10:13:56 +0000
Received: by gxk18 with SMTP id 18so4398326gxk.5
        for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 03:13:35 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.212.10 with SMTP id k10mr1182630ybg.288.1249985614950; 
	Tue, 11 Aug 2009 03:13:34 -0700 (PDT)
In-Reply-To: <483308B7-933B-4496-814C-0715D784836A@mac.com>
References: <9cafbc680907301111t4768704cy9e4b3092b3d74b17@mail.gmail.com>
	 <D8AF0747-AEC3-4E5F-AB52-EF62BA460529@mac.com>
	 <9ac0c6aa0907310234h798d406bg8cb23d620b022ef8@mail.gmail.com>
	 <161DCF62-1E03-4F1B-A590-76ADD91D5434@mac.com>
	 <9ac0c6aa0907311452q4f49f1aeua7314b6059b5973@mail.gmail.com>
	 <2BC00C69-41B3-48B3-83E7-CBC6DB452CCC@mac.com>
	 <9cafbc680907311701g7c8ff0f1n896c4bed2adda9c9@mail.gmail.com>
	 <090CF9D7-5D59-47A5-AD2A-86D4BEC6CD15@mac.com>
	 <9ac0c6aa0908010208g757a9936vd1150bdec47bc9e9@mail.gmail.com>
	 <483308B7-933B-4496-814C-0715D784836A@mac.com>
Date: Tue, 11 Aug 2009 06:13:34 -0400
Message-ID: <9ac0c6aa0908110313p23fcb7f1uc9ee1018c7ab4256@mail.gmail.com>
Subject: Re: ThreadedIndexWriter vs. IndexWriter
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I'm baffled why you're losing docs w/ ThreadedIndexWriter.

One question: your Lucene core JAR seems to be newer than the last
MEAP update.  Did you update it manually?

Also, your indexes were optimized, but your algs don't have an
optimize step -- did you separately run an optimize?

Could you zip up the whole shebang (ThreadedIndexWriter.java,
CreateThreadedIndexTask.java, the algs) & post?  Please CC me directly
so I can grab the zip file... thanks.

Mike

On Mon, Aug 3, 2009 at 12:37 PM, Jibo John<jibojohn@mac.com> wrote:
> Mike,
>
> Verified that I have the latest source code.
> Here are the alg files and the checkindexer output.
>
>
> ----------------------------------------- indexwriter
> alg----------------------------------------------------------------
>
> analyzer=3Dorg.apache.lucene.analysis.standard.StandardAnalyzer
> doc.maker=3Dorg.apache.lucene.benchmark.byTask.feeds.LineDocMaker
> directory=3DFSDirectory
>
> doc.stored =3D true =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0#A
> docs.file=3Dwikipedia.lines.txt
> ram.flush.mb=3D50
> compound=3Dfalse
> merge.factor=3D5
> doc.add.log.step=3D1000
> doc.term.vector=3Dfalse
> doc.term.vector.positions=3Dfalse
> doc.term.vector.offsets=3Dfalse
>
> { "Rounds" =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #B
> =A0ResetSystemErase
> =A0{ "BuildIndex"
> =A0-CreateIndex()
> =A0[ { "AddDocs" AddDoc > : 40000 ] : 5 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0#C
> =A0-CloseIndex()
> =A0}
> =A0NewRound
> } : 1
>
> RepSumByPrefRound BuildIndex =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #D
>
> -----------------------------------------threadedindexwriter alg
> ----------------------------------------------------------------
>
> analyzer=3Dorg.apache.lucene.analysis.standard.StandardAnalyzer
> doc.maker=3Dorg.apache.lucene.benchmark.byTask.feeds.LineDocMaker
> directory=3DFSDirectory
>
> doc.stored =3D true =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0#A
> docs.file=3Dwikipedia.lines.txt
> ram.flush.mb=3D50
> compound=3Dfalse
> merge.factor=3D5
> doc.add.log.step=3D1000
> doc.term.vector=3Dfalse
> doc.term.vector.positions=3Dfalse
> doc.term.vector.offsets=3Dfalse
> writer.num.threads=3D15
> writer.max.thread.queue.size=3D75
> work.dir=3Dwork_t
>
>
> { "Rounds" =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #B
> =A0ResetSystemErase
> =A0{ "BuildIndex"
> =A0-CreateThreadedIndex()
> =A0 { "AddDocs" AddDoc > : 200000
> =A0-CloseIndex()
> =A0}
> =A0NewRound
> } : 1
>
> RepSumByPrefRound BuildIndex =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #D
>
>
> -----------------------------------------------threadedindexwriter
> checkindex ----------------------------------------------------------
>
>
> $ java -classpath
> /Users/jibo/Desktop/iwork/lucene/java/trunk/build/lucene-core-2.9-dev.jar
> org.apache.lucene.index.CheckIndex
> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work_t/inde=
x
>
> NOTE: testing will be more thorough if you run java with
> '-ea:org.apache.lucene...', so assertions are enabled
>
> Opening index @
> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work_t/inde=
x
>
> Segments file=3Dsegments_3 numSegments=3D1 version=3DFORMAT_DIAGNOSTICS [=
Lucene
> 2.9]
> =A01 of 1: name=3D_p docCount=3D199941
> =A0 compound=3Dtrue
> =A0 hasProx=3Dtrue
> =A0 numFiles=3D3
> =A0 size (MB)=3D317.1
> =A0 diagnostics =3D {java.version=3D1.5.0_19, lucene.version=3D2.9-dev 77=
9767M -
> 2009-05-28 17:02:17, os=3DMac OS X, os.arch=3Di386, optimize=3Dtrue,
> mergeDocStores=3Dfalse, java.vendor=3DApple Inc., os.version=3D10.5.7,
> source=3Dmerge, mergeFactor=3D5}
> =A0 docStoreOffset=3D0
> =A0 docStoreSegment=3D_0
> =A0 docStoreIsCompoundFile=3Dfalse
> =A0 no deletions
> =A0 test: open reader.........OK
> =A0 test: fields, norms.......OK [4 fields]
> =A0 test: terms, freq, prox...OK [1269552 terms; 67887116 terms/docs pair=
s;
> 133241176 tokens]
> =A0 test: stored fields.......OK [199941 total field count; avg 1 fields =
per
> doc]
> =A0 test: term vectors........OK [0 total vector count; avg 0 term/freq v=
ector
> fields per doc]
>
> No problems were detected with this index.
>
> ------------------------------------------indexwriter checkindex
> ---------------------------------------------------------------
>
> $ java -classpath
> /Users/jibo/Desktop/iwork/lucene/java/trunk/build/lucene-core-2.9-dev.jar
> org.apache.lucene.index.CheckIndex
> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work/index
>
> NOTE: testing will be more thorough if you run java with
> '-ea:org.apache.lucene...', so assertions are enabled
>
> Opening index @
> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work/index
>
> Segments file=3Dsegments_a numSegments=3D1 version=3DFORMAT_DIAGNOSTICS [=
Lucene
> 2.9]
> =A01 of 1: name=3D_18 docCount=3D200000
> =A0 compound=3Dtrue
> =A0 hasProx=3Dtrue
> =A0 numFiles=3D1
> =A0 size (MB)=3D427.445
> =A0 diagnostics =3D {java.version=3D1.5.0_19, lucene.version=3D2.9-dev 77=
9767M -
> 2009-05-28 17:02:17, os=3DMac OS X, os.arch=3Di386, optimize=3Dtrue,
> mergeDocStores=3Dtrue, java.vendor=3DApple Inc., os.version=3D10.5.7,
> source=3Dmerge, mergeFactor=3D4}
> =A0 no deletions
> =A0 test: open reader.........OK
> =A0 test: fields, norms.......OK [4 fields]
> =A0 test: terms, freq, prox...OK [3512343 terms; 80020204 terms/docs pair=
s;
> 163219760 tokens]
> =A0 test: stored fields.......OK [200000 total field count; avg 1 fields =
per
> doc]
> =A0 test: term vectors........OK [0 total vector count; avg 0 term/freq v=
ector
> fields per doc]
>
> No problems were detected with this index.
>
> -------------------------------------------------------------------------=
--------------------------------
>
>
>
>
> Thanks,
> -Jibo
>
>
>
>
>
>
>
> On Aug 1, 2009, at 2:08 AM, Michael McCandless wrote:
>
>> (Please note that ThreadedIndexWriter is source code available with
>> the upcoming revision to Lucene in Action.)
>>
>> Phil, is it possible you are using an older version of the book's
>> source code? =A0In particular, can you check whether your version of
>> ThreadedIndexWriter.java has this:
>>
>> =A0public void close(boolean doWait) throws CorruptIndexException,
>> IOException {
>> =A0 finish();
>> =A0 super.close(doWait);
>> =A0}
>>
>> (I vaguely remember that being missing from earlier releases, which
>> could explain what you're seeing). =A0If you are missing that, can you
>> download the current code from http://www.manning.com/hatcher3 and try
>> again?
>>
>> If that's not the problem... can you post the benchmark alg you are
>> using in each case?
>>
>> Mike
>>
>> On Fri, Jul 31, 2009 at 8:26 PM, Jibo John<jibojohn@mac.com> wrote:
>>>
>>> Hi Phil,
>>>
>>> It's 5 threads for IndexWriter.
>>>
>>> For ThreadedIndexWriter, I used:
>>>
>>> writer.num.threads=3D16
>>> writer.max.thread.queue.size=3D80
>>>
>>> Thanks,
>>> -Jibo
>>>
>>> On Jul 31, 2009, at 5:01 PM, Phil Whelan wrote:
>>>
>>>> Hi Jibo,
>>>>
>>>> Your mergeFactor is different, and the resulting numFiles (segment
>>>> files) is different. Maybe each thread is responsible for a segment
>>>> file. Just curious - do you have 3 threads?
>>>>
>>>> Phil
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41814-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 15:34:01 2009
Return-Path: <java-user-return-41814-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37842 invoked from network); 11 Aug 2009 15:34:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 15:34:01 -0000
Received: (qmail 47022 invoked by uid 500); 11 Aug 2009 15:34:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46943 invoked by uid 500); 11 Aug 2009 15:34:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46933 invoked by uid 99); 11 Aug 2009 15:34:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 15:34:06 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of nigelspleen@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 15:33:56 +0000
Received: by fxm2 with SMTP id 2so3372328fxm.28
        for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 08:33:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=JCTXnUdOCMEoORh+bGdg1Dx8cH4yfTVYG37Wk9PFmus=;
        b=uDoklD2qjgihdb9JXk5F+26ax9XPI4Pc32tenCU6jA2H0EAxvbEqulhZEQEAmlUhOe
         u5CKTF4ywk4HtfDNUjT3HMm4xP//HuVOA4GNacRKEbunvk0Cqoom/hlPm+YDxx98GN25
         1DLtUPjo1DWd/1zQ9DKYYZKT1qgEgbHA5Wz/I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=f10WzpasJv9M7if0Lpgycgbs+cwnEoyRhRIqjQtNK7UnAzOhWk0D6yO81kh2tQLOJz
         bq0C1bwx97T2mc8nvrlLKwkzwXKXkTjdthoOg/YK7RFEWpzsaZaX+8gEdmW2Wrt6SD+e
         CRjvongrYoMMHNwtDsmEZJ42dkMY9FvOZLwV0=
MIME-Version: 1.0
Received: by 10.204.52.5 with SMTP id f5mr981147bkg.208.1250004816103; Tue, 11 
	Aug 2009 08:33:36 -0700 (PDT)
In-Reply-To: <9ac0c6aa0908070915g6adc7a48hda47d3c8d43321b@mail.gmail.com>
References: <843920a30908050908pf9e2abciff36861614c0813e@mail.gmail.com>
	 <9ac0c6aa0908051250m456998bbve6e8be67de9f3009@mail.gmail.com>
	 <843920a30908061430p60001011v19982560764aa814@mail.gmail.com>
	 <9ac0c6aa0908070915g6adc7a48hda47d3c8d43321b@mail.gmail.com>
Date: Tue, 11 Aug 2009 11:33:36 -0400
Message-ID: <843920a30908110833n34be2b2r750f2310a40e359b@mail.gmail.com>
Subject: Re: Efficient optimization of large indexes?
From: Nigel <nigelspleen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c5a9bd0809b00470df6de8
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5a9bd0809b00470df6de8
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Mike, thanks very much for your comments!  I won't have time to try these
ideas for a little while but when I do I'll definitely post the results.

On Fri, Aug 7, 2009 at 12:15 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> On Thu, Aug 6, 2009 at 5:30 PM, Nigel<nigelspleen@gmail.com> wrote:
> >> Actually IndexWriter must periodically flush, which will always
> >> create new segments, which will then always require merging.  Ie
> >> there's no way to just add everything to only one segment in one
> >> shot.
> >>
> >
> > Hmm, that makes sense now that you mention it.  And if you have to merge
> in
> > the end anyway, there's no point to my idea of adding docs to a new
> index.
>
> Well it's worth a shot at least ;)
>
> > But addIndexes(IndexReader[]) as you suggest would solve that problem.
>
> Right.  You could also set a massive mergeFactor to achieve the same thing.
>
> >> Merge performance does seem rather slow... I recently profiled it and
> >> was suprised to find that the merging of terms dict & postings was cpu
> >> bound, even on a modern CPU (core i7 920) and with 3 merges running
> >> concurrently.  I think most of the CPU cost comes from the pqueue
> >> that's used to do the merge sort, plus read/writeVInt.  When Lucene
> >> [eventually] switches to PForDelta, that should be more CPU friendly.
> >
> > That's interesting.  I recently did one of our big merges on a different
> > server that has the same disks as the one I was using before, but a
> faster
> > processor.  It seemed like the merge was quite a bit faster than usual
> > (though it's possible I was fooled by other factors).
>
> OK... so that supports the "merging is cpu bound" hypothesis.
>
> > Also, it's tons of IO because for each merge it must read every single
> >> byte and write nearly every single byte, so that's ~2X bytes moved.
> >> Then, if you have more segments in your index than your mergeFactor,
> >> multiple such merges are needed and you're looking at, at least, 4X
> >> your index size in net bytes moved.  If you have CFS enabled, it's 8X
> >> the index size.
> >
> > Not to get too sidetracked, but this reminds me of another question I
> meant
> > to ask.  We use the compound format right now.  Our merge factor is
> > relatively low, so switching to the non-compound format would certainly
> be
> > possible without running into problems with too many open files.  Is
> there
> > any significant speed different between compound and non-compound for
> > indexing, searching, or merging?  (Searching for us would be the most
> > important by far.)
>
> Both indexing and searching should be faster if you don't use CFS.
> For indexing it'll be a small impact... I'm less sure about searching
> but I'd also expect the impact to be smallish.  If you test it, please
> post back!
>
> >>   * If possible, make sure you always add the same fields to your
> >>    docs, in the same order (this results in consistent numbering of
> >>    field name -> number).  This is very much an unexpected
> >>    gotchya... the merging of stored fields and term vectors is much,
> >>    much faster if the field numbers are identical.  LUCENE-1737 is
> >>    open to fix Lucene so it consistently numbers automatically, but
> >>    it's somewhat tricky because many places in Lucene assume the
> >>    field names are densely packed.
> >
> > We generally do this already, but some of our fields are nullable and so
> for
> > some documents the number-to-name mapping will be different.  Is there
> any
> > value in adding dummy values like "NULL" in these cases?  That presumably
> > adds overhead of its own, though.
>
> If you store fields and term vectors then adding null fields should
> speed up merging substantially and likely won't have much impact on
> indexing time, time to retrieve docs, searching time or index size, I
> think.  Post back :)
>
> Mike
>
>

--001636c5a9bd0809b00470df6de8--

From java-user-return-41815-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 16:44:39 2009
Return-Path: <java-user-return-41815-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58962 invoked from network); 11 Aug 2009 16:44:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 16:44:37 -0000
Received: (qmail 16779 invoked by uid 500); 11 Aug 2009 16:40:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16754 invoked by uid 500); 11 Aug 2009 16:40:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16744 invoked by uid 99); 11 Aug 2009 16:40:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 16:40:38 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jibojohn@mac.com designates 17.148.16.93 as permitted sender)
Received: from [17.148.16.93] (HELO asmtpout018.mac.com) (17.148.16.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 16:40:27 +0000
MIME-version: 1.0
Content-type: multipart/mixed; boundary="Boundary_(ID_Ej1S5bNqpkB/SDh+PGRdgA)"
Received: from la0101a-dhcp176.apple.com ([17.214.14.176])
 by asmtp018.mac.com (Sun Java(tm) System Messaging Server 6.3-8.01 (built Dec
 16 2008; 32bit)) with ESMTPSA id <0KO800H0V0YDOZ80@asmtp018.mac.com> for
 java-user@lucene.apache.org; Tue, 11 Aug 2009 09:40:07 -0700 (PDT)
Cc: Michael McCandless <lucene@mikemccandless.com>
Message-id: <DDBC7B8B-E102-475C-B595-9B91654E5F58@mac.com>
From: Jibo John <jibojohn@mac.com>
To: java-user@lucene.apache.org
In-reply-to: <9ac0c6aa0908110313p23fcb7f1uc9ee1018c7ab4256@mail.gmail.com>
Subject: Re: ThreadedIndexWriter vs. IndexWriter
Date: Tue, 11 Aug 2009 09:39:49 -0700
References: <9cafbc680907301111t4768704cy9e4b3092b3d74b17@mail.gmail.com>
 <D8AF0747-AEC3-4E5F-AB52-EF62BA460529@mac.com>
 <9ac0c6aa0907310234h798d406bg8cb23d620b022ef8@mail.gmail.com>
 <161DCF62-1E03-4F1B-A590-76ADD91D5434@mac.com>
 <9ac0c6aa0907311452q4f49f1aeua7314b6059b5973@mail.gmail.com>
 <2BC00C69-41B3-48B3-83E7-CBC6DB452CCC@mac.com>
 <9cafbc680907311701g7c8ff0f1n896c4bed2adda9c9@mail.gmail.com>
 <090CF9D7-5D59-47A5-AD2A-86D4BEC6CD15@mac.com>
 <9ac0c6aa0908010208g757a9936vd1150bdec47bc9e9@mail.gmail.com>
 <483308B7-933B-4496-814C-0715D784836A@mac.com>
 <9ac0c6aa0908110313p23fcb7f1uc9ee1018c7ab4256@mail.gmail.com>
X-Mailer: Apple Mail (2.935.3)
X-Virus-Checked: Checked by ClamAV on apache.org

--Boundary_(ID_Ej1S5bNqpkB/SDh+PGRdgA)
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-transfer-encoding: 7BIT

Mike,

I wasn't exactly using the lucene core jar from MEAP.

I have been building lucene from the source, and running the tests  
under lucene/java/trunk/contrib/benchmark/ (checked out 2 weeks ago, I  
guess)  and, also under  lucene/java/tags/lucene_2_4_1/contrib/ 
benchmark/.
In both cases, copied CreateThreadedIndexTask to  
org.apache.lucene.benchmark.byTask.tasks and ThreadedIndexWriter to  
org.apache.lucene.index.

I have observed the issue in both the versions of lucene.

Indexes were optimized separately using Lucli.


PFA the classes and the alg.


--Boundary_(ID_Ej1S5bNqpkB/SDh+PGRdgA)
Content-type: application/zip; x-unix-mode=0644; name=ti.zip
Content-transfer-encoding: base64
Content-disposition: attachment; filename=ti.zip

UEsDBAoAAAAAAJJMCzsAAAAAAAAAAAAAAAADABAAdGkvVVgMAA2egUoUnoFK9QEUAFBLAwQUAAgA
CACQTAs7AAAAAAAAAAAAAAAAHwAQAHRpL0NyZWF0ZVRocmVhZGVkSW5kZXhUYXNrLmphdmFVWAwA
IZ6BSg+egUr1ARQAnZJNj9owEIbv+RWjPQWETFv1hjisll0JiW2riqrnwRkSL4md2uMSttr/XofE
bRBsq8UHW7Lf95kPT41yhzmBsbnAGmVBovSSNIkNaVlUaHdic1ij2wkOm5sliapqYxme8CcKZcTy
830jqWZl9Cy+ndOUzqgRy3b/bhWT/a92XVjCjLITz+ums3S/kN1+9XqBjP+IdWbzrEon7ozeqjzE
m47HcAtt6cAFMhyMB4kavCPYWlMBgjSardpM/6ASGANgmZuQdFEBG5ChFKagvVCUgPE0SWq/KZUE
WaJzcHeUn2jb3IAaJp3F97/3v5IEoCe84k0H7QDbnaNghLCcr8mm8XIW7l4GQKUZMrMyuZLpKDTB
mr2Dwaf3kAt8mENO3F+mRzBA19m2ae0xj1oRlN1TFA5aBPvumIOm/aUepgPKQlmSbOwhHU2OoDet
AehWY3l4DvBrOGw9XWHr2tJGT2+6ooX2leBjye5mAh+vSeYCtcKmp4ofnjwJp54p8D+8G02i7e2B
hmP9iM2DojJbkc65EN8+rZaPy/X9Is7B6QwLRzxw96PQJTvpC+id8YtOHb02aoi91fC+G+aX5DdQ
SwcItmz7EbsBAADnBAAAUEsDBAoAAAAAAJlMCzsAAAAAAAAAAAAAAAAJABAAX19NQUNPU1gvVVgM
ACGegUohnoFK9QEUAFBLAwQKAAAAAACZTAs7AAAAAAAAAAAAAAAADAAQAF9fTUFDT1NYL3RpL1VY
DAAhnoFKIZ6BSvUBFABQSwMEFAAIAAgAkEwLOwAAAAAAAAAAAAAAACoAEABfX01BQ09TWC90aS8u
X0NyZWF0ZVRocmVhZGVkSW5kZXhUYXNrLmphdmFVWAwAIZ6BSg+egUr1ARQAjVDLSsNAFL2Jigou
utGFIGSTheDUaWaaTJoipmkCLRSlFuquTOtgY/NqM7ryH/QTBH/GT/BzHGmg0pUH7pNzuJwLeyf7
oAMM+My4uTPujQq/OzhUYQFomapq1j7gX/BHo+HZ+8ttpfhS8b1F0av9G4A5y9M6L4pE1FMh+QOX
vLUYdHtSpOO5WIlolaelompjlXoAxxv+8pmveCbjTMC0SOJSYvyp6TuT2mk/nuZGP59nRvtJtddr
vlJeDWU8qbVTUZb8UbRMEjDXCXAYBiho0ghRnznIJayDMCWEdLFPmWtv9CYJD47OL9YuNK2ys7tl
b7G8xAoe5azhigbxBjxOPOz4AcaRuhRZHURt5iMWBR3kWMRvhtiOqN14/fMNpYEfUEsHCKziyv4g
AQAAoAEAAFBLAwQUAAgACACSTAs7AAAAAAAAAAAAAAAAGwAQAHRpL1RocmVhZGVkSW5kZXhXcml0
ZXIuamF2YVVYDAAhnoFKE56BSvUBFADNV9uO2zYQfddXTGGgkBeu9F43Bby2i6TY7Ca10+QtoKWx
xSxNCiTlSwL/e4e6mb5tve22iB5kmRyemTmcC5mz5JEtEJReRCxnSYaRKBKUGHGZ4qYfBHyZK23h
C1uxiKvozcN4k2BuuZL7ydPVxiqN0YhrTOhr278smaqkWKK00aj+eEK2tCl6494fNbeo/1Z2qLQu
clsu8Qy/uIpJJraGm2jgPr5eoWGKenlEU2G5iBIlk0Jr59k008jSd0qJ8QaTggjpPynfSE1Qr3iC
TwtP+RI/SG6flhpozba3QiWPXC7eF1gQahDf3MBIq/wnLkFjLliCbgNgrjR4JIPNmIXCoIFlISzP
BQZwAzTs3DI9KEjWSSFkSqU9sApKboClKabQ7LCJ4CYOgryYCZ5AIpgxUFGDqa8ONxZlag5M+BYE
ALnmK2YRjvipDXH89n2xSsPvagbEjChdM/BHISWbCYRvcP6J40HgfptwdOb3y5EmJIC1seGGXQBA
iqIKBDdSe0iaQx+ldyDaO8XrkpuVETajEKQl8Gqvvh5thGnq0I5mVQXvVvo27XzLVoqnoAsZdi/S
cI6Y20aP3raWAvA5hK1RP7wCWQjR9eYricasswJwLg4iU+T0LvKUNrPhMWzZKwltmet7aDtAYfBK
eArRPfYFyArwf3HpxRzxzQ8auITZJIPQq+HAFfqGxzFMH0YPP8NWFZTtxoJQC/gR0CRMuKRyMQao
tdL7AFAYUc5JO7HUTaaaykg42RqLy4gEW0N2bRzuyiytQvGMQ2HbNiDl2s+THswoyZFJSGiVxR7V
GUvkL6dNKXL/l2xTVrgJ/0oSPlNv2eY3jiK9Q7mwGSznott4QTVErQ2c7RcE4jFWkVWSHpb2kVmN
OQ6x8ndfkygTJa7htAmEcOGJ46G36b573rcncafkIno7+PT5z8HdhzGVmbolRPeD+4fJePhwP5r4
8s6c04bwS1Mafw0PGZwzisLuMcCpP9GQCYGaYMw7RXu7DbslGf52l5XHD1W/QF6uRnE8OmI1wlIr
hs4WV2nL5HV5WL1J9VmM3SXSr3oaO/49xjV8+KF/yM3z+GCnZMD3zMdRfSyLrC0r5KVouZaPCuW7
jw/4R4Qch8vzSPlvg+TIoUQog3T6eG7VnXPJTRbWNbZqfDXW2UpTzTVNI1UfGbcvqbVGPKtbKyFm
1BBfyM093F5bfdAt1TVrrj7RxfH4ODxMVthUrWWjeZ1xgaHVhXdGOD38eQBsTXS48OSSOX/Ci62p
bkvdrpcvM8J5bI8L7WlFUoA63jD1ji0Hp5aqF0X1Zaf6F3bpglavDM8eQnbuBhR0BvBaCbpuKInt
VcVdYWZY3V+Czi2lGV1+CFXAWulHN0tTdCWsM7NdF3SGMCzPAjWtkBMtQWcEr9nqYAzqVIQvahZ0
xjAh6g048g9W0oXpL1BLBwg7bNhYMQQAAKMPAABQSwMEFAAIAAgAkkwLOwAAAAAAAAAAAAAAACYA
EABfX01BQ09TWC90aS8uX1RocmVhZGVkSW5kZXhXcml0ZXIuamF2YVVYDAAhnoFKE56BSvUBFACN
UMtKw0AUvamKFVx0owtByKYLwakTZ/KYpohJOoEWilAL1VWZ1sHG5tUmuvIf9BMEf8ZP8HMcaaDS
lQfu63DO4lzYO96HGsBAzPSbW/1Or/DLwYGqSwAtVVPd2gf8C95oNDx9f7mvHF+qvrcktYp/A2jO
sqQl8jyWrUSW4kGUor0YdHulTMZzuZLhKksKJdXGqvUAjjb65bNYibSMUgnTPI6KEuNPrbYzaZz0
o2mm97N5qnee1Hq91ivn1bCMJo1OIotCPMp2kwQOswPMeYACk4aIeo6NGHF8hCkhpIs96jBr428S
Xj88O1+n0LQqzu5WvMXyAiu4VDgGkwZ1ByKKXc4s0zbtEHUDShHlnoF8y+aIMRZywzQJ9v3XP99Q
HvgBUEsHCHI+sWghAQAAoAEAAFBLAwQUAAgACACSTAs7AAAAAAAAAAAAAAAAEgAQAHRpL3RocmVh
ZGluZGV4LmFsZ1VYDAAhnoFKFJ6BSvUBFACdkUFrGzEQhe/6FcK5NIcOScEUAirYdQuFthRv7mUs
zcbCK2mrkWqvg/97pPWahtJCGx3E8N684dMIPXbDkaIK8QGwR70l6LImT4DVYsvACb3BaKCZisUU
EiZocLj7Y3xDXm8dxh1shnvkHbREhuGz9bQK+ktNiSsdfCKfgEOOmv57SjPGhLGRdApxUB+b1aUW
csTjUpORSqaYSb7gXC3GQQyt7Ujt7c72ZCxCVxAY0iGJiA7aLvMW3EbNb4QOrg/ZG9VixyQcxQeC
FiuVmo9QiaKDnyPn1PSbCn1gm2zw/Bc/tC1Turj7aIsJPjtI20hoWN3OL6rDw6TCj0yZgO2R1Nvi
h7LWsjtVi+9JlI09ytm6ovPsJau6bGwphZRrKoDNwInch4hMVSvjl9l25pM3dJhVRb5+X8gS3Y+A
dHZeXY9WbV8YU/654JwL+U7eyTc39UzpLjA9C53q9ZX24yukOJX22yKJNfVNdsvhW6T27P0C+feH
raQQT1BLBwiCATx3eQEAADIDAABQSwMEFAAIAAgAkkwLOwAAAAAAAAAAAAAAAB0AEABfX01BQ09T
WC90aS8uX3RocmVhZGluZGV4LmFsZ1VYDAAhnoFKFJ6BSvUBFABjYBVjZ2BiYPBNTFbwD1aIUIAC
kBgDJxAbMTAw5gNpIJ9xIQNRwDEkJEh2QlkMVMcJIL6JpoQJKj6BgUE1OT9XL7GgICdVLze1JDEl
sSTRKtvXxbMkNTc8I7Uo1a0oP7cYqJQxAkh4MjCIItQXliYWJeaVZOalMiQV5GQWlxgYLGZkYo4X
kPLKTMpX8MrPyFOwyQIyHSDqgTrtghNz0uMFbHJTi4sT01OtVI2dDcwsDI0Mzd10zQ1N3HRNTF1d
dC0dnV10DVzNTZyc3QxMDAxMEAaoGrty8GjqQrzByAj1Dwua/3IK9Q2AwNok0cLQMtXQ1No3MTPH
2sTV1NzZ2dxZ18LMwBRok5mLrqOJubGus4WTq5Obi5GZgaN5DVJwAPUwAABQSwcIrtk7CyMBAACh
AQAAUEsBAhUDCgAAAAAAkkwLOwAAAAAAAAAAAAAAAAMADAAAAAAAAAAAQO1BAAAAAHRpL1VYCAAN
noFKFJ6BSlBLAQIVAxQACAAIAJBMCzu2bPsRuwEAAOcEAAAfAAwAAAAAAAAAAECkgTEAAAB0aS9D
cmVhdGVUaHJlYWRlZEluZGV4VGFzay5qYXZhVVgIACGegUoPnoFKUEsBAhUDCgAAAAAAmUwLOwAA
AAAAAAAAAAAAAAkADAAAAAAAAAAAQP1BSQIAAF9fTUFDT1NYL1VYCAAhnoFKIZ6BSlBLAQIVAwoA
AAAAAJlMCzsAAAAAAAAAAAAAAAAMAAwAAAAAAAAAAED9QYACAABfX01BQ09TWC90aS9VWAgAIZ6B
SiGegUpQSwECFQMUAAgACACQTAs7rOLK/iABAACgAQAAKgAMAAAAAAAAAABApIG6AgAAX19NQUNP
U1gvdGkvLl9DcmVhdGVUaHJlYWRlZEluZGV4VGFzay5qYXZhVVgIACGegUoPnoFKUEsBAhUDFAAI
AAgAkkwLOzts2FgxBAAAow8AABsADAAAAAAAAAAAQKSBQgQAAHRpL1RocmVhZGVkSW5kZXhXcml0
ZXIuamF2YVVYCAAhnoFKE56BSlBLAQIVAxQACAAIAJJMCztyPrFoIQEAAKABAAAmAAwAAAAAAAAA
AECkgcwIAABfX01BQ09TWC90aS8uX1RocmVhZGVkSW5kZXhXcml0ZXIuamF2YVVYCAAhnoFKE56B
SlBLAQIVAxQACAAIAJJMCzuCATx3eQEAADIDAAASAAwAAAAAAAAAAECkgVEKAAB0aS90aHJlYWRp
bmRleC5hbGdVWAgAIZ6BShSegUpQSwECFQMUAAgACACSTAs7rtk7CyMBAAChAQAAHQAMAAAAAAAA
AABApIEaDAAAX19NQUNPU1gvdGkvLl90aHJlYWRpbmRleC5hbGdVWAgAIZ6BShSegUpQSwUGAAAA
AAkACQDbAgAAmA0AAAAA

--Boundary_(ID_Ej1S5bNqpkB/SDh+PGRdgA)
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-transfer-encoding: 7BIT





Thank you for your help with this one.

-Jibo




On Aug 11, 2009, at 3:13 AM, Michael McCandless wrote:

> I'm baffled why you're losing docs w/ ThreadedIndexWriter.
>
> One question: your Lucene core JAR seems to be newer than the last
> MEAP update.  Did you update it manually?
>
> Also, your indexes were optimized, but your algs don't have an
> optimize step -- did you separately run an optimize?
>
> Could you zip up the whole shebang (ThreadedIndexWriter.java,
> CreateThreadedIndexTask.java, the algs) & post?  Please CC me directly
> so I can grab the zip file... thanks.
>
> Mike
>
> On Mon, Aug 3, 2009 at 12:37 PM, Jibo John<jibojohn@mac.com> wrote:
>> Mike,
>>
>> Verified that I have the latest source code.
>> Here are the alg files and the checkindexer output.
>>
>>
>> ----------------------------------------- indexwriter
>> alg----------------------------------------------------------------
>>
>> analyzer=org.apache.lucene.analysis.standard.StandardAnalyzer
>> doc.maker=org.apache.lucene.benchmark.byTask.feeds.LineDocMaker
>> directory=FSDirectory
>>
>> doc.stored =  
>> true                                                    #A
>> docs.file=wikipedia.lines.txt
>> ram.flush.mb=50
>> compound=false
>> merge.factor=5
>> doc.add.log.step=1000
>> doc.term.vector=false
>> doc.term.vector.positions=false
>> doc.term.vector.offsets=false
>>
>> { "Rounds 
>> "                                                           #B
>>  ResetSystemErase
>>  { "BuildIndex"
>>  -CreateIndex()
>>  [ { "AddDocs" AddDoc > : 40000 ] :  
>> 5                                    #C
>>  -CloseIndex()
>>  }
>>  NewRound
>> } : 1
>>
>> RepSumByPrefRound  
>> BuildIndex                                         #D
>>
>> -----------------------------------------threadedindexwriter alg
>> ----------------------------------------------------------------
>>
>> analyzer=org.apache.lucene.analysis.standard.StandardAnalyzer
>> doc.maker=org.apache.lucene.benchmark.byTask.feeds.LineDocMaker
>> directory=FSDirectory
>>
>> doc.stored =  
>> true                                                    #A
>> docs.file=wikipedia.lines.txt
>> ram.flush.mb=50
>> compound=false
>> merge.factor=5
>> doc.add.log.step=1000
>> doc.term.vector=false
>> doc.term.vector.positions=false
>> doc.term.vector.offsets=false
>> writer.num.threads=15
>> writer.max.thread.queue.size=75
>> work.dir=work_t
>>
>>
>> { "Rounds 
>> "                                                           #B
>>  ResetSystemErase
>>  { "BuildIndex"
>>  -CreateThreadedIndex()
>>   { "AddDocs" AddDoc > : 200000
>>  -CloseIndex()
>>  }
>>  NewRound
>> } : 1
>>
>> RepSumByPrefRound  
>> BuildIndex                                         #D
>>
>>
>> -----------------------------------------------threadedindexwriter
>> checkindex ----------------------------------------------------------
>>
>>
>> $ java -classpath
>> /Users/jibo/Desktop/iwork/lucene/java/trunk/build/lucene-core-2.9- 
>> dev.jar
>> org.apache.lucene.index.CheckIndex
>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/ 
>> work_t/index
>>
>> NOTE: testing will be more thorough if you run java with
>> '-ea:org.apache.lucene...', so assertions are enabled
>>
>> Opening index @
>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/ 
>> work_t/index
>>
>> Segments file=segments_3 numSegments=1 version=FORMAT_DIAGNOSTICS  
>> [Lucene
>> 2.9]
>>  1 of 1: name=_p docCount=199941
>>   compound=true
>>   hasProx=true
>>   numFiles=3
>>   size (MB)=317.1
>>   diagnostics = {java.version=1.5.0_19, lucene.version=2.9-dev  
>> 779767M -
>> 2009-05-28 17:02:17, os=Mac OS X, os.arch=i386, optimize=true,
>> mergeDocStores=false, java.vendor=Apple Inc., os.version=10.5.7,
>> source=merge, mergeFactor=5}
>>   docStoreOffset=0
>>   docStoreSegment=_0
>>   docStoreIsCompoundFile=false
>>   no deletions
>>   test: open reader.........OK
>>   test: fields, norms.......OK [4 fields]
>>   test: terms, freq, prox...OK [1269552 terms; 67887116 terms/docs  
>> pairs;
>> 133241176 tokens]
>>   test: stored fields.......OK [199941 total field count; avg 1  
>> fields per
>> doc]
>>   test: term vectors........OK [0 total vector count; avg 0 term/ 
>> freq vector
>> fields per doc]
>>
>> No problems were detected with this index.
>>
>> ------------------------------------------indexwriter checkindex
>> ---------------------------------------------------------------
>>
>> $ java -classpath
>> /Users/jibo/Desktop/iwork/lucene/java/trunk/build/lucene-core-2.9- 
>> dev.jar
>> org.apache.lucene.index.CheckIndex
>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work/ 
>> index
>>
>> NOTE: testing will be more thorough if you run java with
>> '-ea:org.apache.lucene...', so assertions are enabled
>>
>> Opening index @
>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work/ 
>> index
>>
>> Segments file=segments_a numSegments=1 version=FORMAT_DIAGNOSTICS  
>> [Lucene
>> 2.9]
>>  1 of 1: name=_18 docCount=200000
>>   compound=true
>>   hasProx=true
>>   numFiles=1
>>   size (MB)=427.445
>>   diagnostics = {java.version=1.5.0_19, lucene.version=2.9-dev  
>> 779767M -
>> 2009-05-28 17:02:17, os=Mac OS X, os.arch=i386, optimize=true,
>> mergeDocStores=true, java.vendor=Apple Inc., os.version=10.5.7,
>> source=merge, mergeFactor=4}
>>   no deletions
>>   test: open reader.........OK
>>   test: fields, norms.......OK [4 fields]
>>   test: terms, freq, prox...OK [3512343 terms; 80020204 terms/docs  
>> pairs;
>> 163219760 tokens]
>>   test: stored fields.......OK [200000 total field count; avg 1  
>> fields per
>> doc]
>>   test: term vectors........OK [0 total vector count; avg 0 term/ 
>> freq vector
>> fields per doc]
>>
>> No problems were detected with this index.
>>
>> ---------------------------------------------------------------------------------------------------------
>>
>>
>>
>>
>> Thanks,
>> -Jibo
>>
>>
>>
>>
>>
>>
>>
>> On Aug 1, 2009, at 2:08 AM, Michael McCandless wrote:
>>
>>> (Please note that ThreadedIndexWriter is source code available with
>>> the upcoming revision to Lucene in Action.)
>>>
>>> Phil, is it possible you are using an older version of the book's
>>> source code?  In particular, can you check whether your version of
>>> ThreadedIndexWriter.java has this:
>>>
>>>  public void close(boolean doWait) throws CorruptIndexException,
>>> IOException {
>>>   finish();
>>>   super.close(doWait);
>>>  }
>>>
>>> (I vaguely remember that being missing from earlier releases, which
>>> could explain what you're seeing).  If you are missing that, can you
>>> download the current code from http://www.manning.com/hatcher3 and  
>>> try
>>> again?
>>>
>>> If that's not the problem... can you post the benchmark alg you are
>>> using in each case?
>>>
>>> Mike
>>>
>>> On Fri, Jul 31, 2009 at 8:26 PM, Jibo John<jibojohn@mac.com> wrote:
>>>>
>>>> Hi Phil,
>>>>
>>>> It's 5 threads for IndexWriter.
>>>>
>>>> For ThreadedIndexWriter, I used:
>>>>
>>>> writer.num.threads=16
>>>> writer.max.thread.queue.size=80
>>>>
>>>> Thanks,
>>>> -Jibo
>>>>
>>>> On Jul 31, 2009, at 5:01 PM, Phil Whelan wrote:
>>>>
>>>>> Hi Jibo,
>>>>>
>>>>> Your mergeFactor is different, and the resulting numFiles (segment
>>>>> files) is different. Maybe each thread is responsible for a  
>>>>> segment
>>>>> file. Just curious - do you have 3 threads?
>>>>>
>>>>> Phil
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>



--Boundary_(ID_Ej1S5bNqpkB/SDh+PGRdgA)
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--Boundary_(ID_Ej1S5bNqpkB/SDh+PGRdgA)--

From java-user-return-41816-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 18:19:47 2009
Return-Path: <java-user-return-41816-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19366 invoked from network); 11 Aug 2009 18:19:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 18:19:47 -0000
Received: (qmail 38986 invoked by uid 500); 11 Aug 2009 18:19:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38910 invoked by uid 500); 11 Aug 2009 18:19:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38900 invoked by uid 99); 11 Aug 2009 18:19:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 18:19:51 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.179] (HELO mail-yw0-f179.google.com) (209.85.211.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 18:19:42 +0000
Received: by ywh9 with SMTP id 9so48384ywh.29
        for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 11:19:20 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.230.8 with SMTP id c8mr7464398ybh.302.1250014355084; Tue, 
	11 Aug 2009 11:12:35 -0700 (PDT)
In-Reply-To: <DDBC7B8B-E102-475C-B595-9B91654E5F58@mac.com>
References: <9cafbc680907301111t4768704cy9e4b3092b3d74b17@mail.gmail.com>
	 <161DCF62-1E03-4F1B-A590-76ADD91D5434@mac.com>
	 <9ac0c6aa0907311452q4f49f1aeua7314b6059b5973@mail.gmail.com>
	 <2BC00C69-41B3-48B3-83E7-CBC6DB452CCC@mac.com>
	 <9cafbc680907311701g7c8ff0f1n896c4bed2adda9c9@mail.gmail.com>
	 <090CF9D7-5D59-47A5-AD2A-86D4BEC6CD15@mac.com>
	 <9ac0c6aa0908010208g757a9936vd1150bdec47bc9e9@mail.gmail.com>
	 <483308B7-933B-4496-814C-0715D784836A@mac.com>
	 <9ac0c6aa0908110313p23fcb7f1uc9ee1018c7ab4256@mail.gmail.com>
	 <DDBC7B8B-E102-475C-B595-9B91654E5F58@mac.com>
Date: Tue, 11 Aug 2009 14:12:35 -0400
Message-ID: <9ac0c6aa0908111112q64b86e46o20297da020c4fd0e@mail.gmail.com>
Subject: Re: ThreadedIndexWriter vs. IndexWriter
From: Michael McCandless <lucene@mikemccandless.com>
To: Jibo John <jibojohn@mac.com>, java-user@lucene.apache.org
Content-Type: multipart/mixed; boundary=000e0cd406c09954550470e1a5f0
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd406c09954550470e1a5f0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

OK I found the problem!

It was losing docs from the queue, when shutting down the thread pool,
because we were calling super's addDocument(doc) not addDocument(doc,
analyzer).  IndexWriter was simply forwarding that call to
ThreadedIndexWriter's addDocument(doc, analyzer) which in turn would
do nothing because the thread pool was already told to shut down.
Larger queues made it much more likely to happen.

Can you try the new version (attached)?

Also, make sure you add 'doc.reuse.fields=3Dfalse' to your alg (on
trunk).

Mike

On Tue, Aug 11, 2009 at 12:39 PM, Jibo John<jibojohn@mac.com> wrote:
> Mike,
>
> I wasn't exactly using the lucene core jar from MEAP.
>
> I have been building lucene from the source, and running the tests under
> lucene/java/trunk/contrib/benchmark/ (checked out 2 weeks ago, I guess)
> =A0and, also under =A0lucene/java/tags/lucene_2_4_1/contrib/benchmark/.
> In both cases, copied CreateThreadedIndexTask to
> org.apache.lucene.benchmark.byTask.tasks and ThreadedIndexWriter to
> org.apache.lucene.index.
>
> I have observed the issue in both the versions of lucene.
>
> Indexes were optimized separately using Lucli.
>
>
> PFA the classes and the alg.
>
>
>
>
>
>
> Thank you for your help with this one.
>
> -Jibo
>
>
>
>
> On Aug 11, 2009, at 3:13 AM, Michael McCandless wrote:
>
>> I'm baffled why you're losing docs w/ ThreadedIndexWriter.
>>
>> One question: your Lucene core JAR seems to be newer than the last
>> MEAP update. =A0Did you update it manually?
>>
>> Also, your indexes were optimized, but your algs don't have an
>> optimize step -- did you separately run an optimize?
>>
>> Could you zip up the whole shebang (ThreadedIndexWriter.java,
>> CreateThreadedIndexTask.java, the algs) & post? =A0Please CC me directly
>> so I can grab the zip file... thanks.
>>
>> Mike
>>
>> On Mon, Aug 3, 2009 at 12:37 PM, Jibo John<jibojohn@mac.com> wrote:
>>>
>>> Mike,
>>>
>>> Verified that I have the latest source code.
>>> Here are the alg files and the checkindexer output.
>>>
>>>
>>> ----------------------------------------- indexwriter
>>> alg----------------------------------------------------------------
>>>
>>> analyzer=3Dorg.apache.lucene.analysis.standard.StandardAnalyzer
>>> doc.maker=3Dorg.apache.lucene.benchmark.byTask.feeds.LineDocMaker
>>> directory=3DFSDirectory
>>>
>>> doc.stored =3D true =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0=
 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0#A
>>> docs.file=3Dwikipedia.lines.txt
>>> ram.flush.mb=3D50
>>> compound=3Dfalse
>>> merge.factor=3D5
>>> doc.add.log.step=3D1000
>>> doc.term.vector=3Dfalse
>>> doc.term.vector.positions=3Dfalse
>>> doc.term.vector.offsets=3Dfalse
>>>
>>> { "Rounds" =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #B
>>> =A0ResetSystemErase
>>> =A0{ "BuildIndex"
>>> =A0-CreateIndex()
>>> =A0[ { "AddDocs" AddDoc > : 40000 ] : 5
>>> =A0#C
>>> =A0-CloseIndex()
>>> =A0}
>>> =A0NewRound
>>> } : 1
>>>
>>> RepSumByPrefRound BuildIndex =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #D
>>>
>>> -----------------------------------------threadedindexwriter alg
>>> ----------------------------------------------------------------
>>>
>>> analyzer=3Dorg.apache.lucene.analysis.standard.StandardAnalyzer
>>> doc.maker=3Dorg.apache.lucene.benchmark.byTask.feeds.LineDocMaker
>>> directory=3DFSDirectory
>>>
>>> doc.stored =3D true =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0=
 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0#A
>>> docs.file=3Dwikipedia.lines.txt
>>> ram.flush.mb=3D50
>>> compound=3Dfalse
>>> merge.factor=3D5
>>> doc.add.log.step=3D1000
>>> doc.term.vector=3Dfalse
>>> doc.term.vector.positions=3Dfalse
>>> doc.term.vector.offsets=3Dfalse
>>> writer.num.threads=3D15
>>> writer.max.thread.queue.size=3D75
>>> work.dir=3Dwork_t
>>>
>>>
>>> { "Rounds" =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #B
>>> =A0ResetSystemErase
>>> =A0{ "BuildIndex"
>>> =A0-CreateThreadedIndex()
>>> =A0{ "AddDocs" AddDoc > : 200000
>>> =A0-CloseIndex()
>>> =A0}
>>> =A0NewRound
>>> } : 1
>>>
>>> RepSumByPrefRound BuildIndex =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #D
>>>
>>>
>>> -----------------------------------------------threadedindexwriter
>>> checkindex ----------------------------------------------------------
>>>
>>>
>>> $ java -classpath
>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/build/lucene-core-2.9-dev.j=
ar
>>> org.apache.lucene.index.CheckIndex
>>>
>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work_t/in=
dex
>>>
>>> NOTE: testing will be more thorough if you run java with
>>> '-ea:org.apache.lucene...', so assertions are enabled
>>>
>>> Opening index @
>>>
>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work_t/in=
dex
>>>
>>> Segments file=3Dsegments_3 numSegments=3D1 version=3DFORMAT_DIAGNOSTICS=
 [Lucene
>>> 2.9]
>>> =A01 of 1: name=3D_p docCount=3D199941
>>> =A0compound=3Dtrue
>>> =A0hasProx=3Dtrue
>>> =A0numFiles=3D3
>>> =A0size (MB)=3D317.1
>>> =A0diagnostics =3D {java.version=3D1.5.0_19, lucene.version=3D2.9-dev 7=
79767M -
>>> 2009-05-28 17:02:17, os=3DMac OS X, os.arch=3Di386, optimize=3Dtrue,
>>> mergeDocStores=3Dfalse, java.vendor=3DApple Inc., os.version=3D10.5.7,
>>> source=3Dmerge, mergeFactor=3D5}
>>> =A0docStoreOffset=3D0
>>> =A0docStoreSegment=3D_0
>>> =A0docStoreIsCompoundFile=3Dfalse
>>> =A0no deletions
>>> =A0test: open reader.........OK
>>> =A0test: fields, norms.......OK [4 fields]
>>> =A0test: terms, freq, prox...OK [1269552 terms; 67887116 terms/docs pai=
rs;
>>> 133241176 tokens]
>>> =A0test: stored fields.......OK [199941 total field count; avg 1 fields=
 per
>>> doc]
>>> =A0test: term vectors........OK [0 total vector count; avg 0 term/freq
>>> vector
>>> fields per doc]
>>>
>>> No problems were detected with this index.
>>>
>>> ------------------------------------------indexwriter checkindex
>>> ---------------------------------------------------------------
>>>
>>> $ java -classpath
>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/build/lucene-core-2.9-dev.j=
ar
>>> org.apache.lucene.index.CheckIndex
>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work/inde=
x
>>>
>>> NOTE: testing will be more thorough if you run java with
>>> '-ea:org.apache.lucene...', so assertions are enabled
>>>
>>> Opening index @
>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work/inde=
x
>>>
>>> Segments file=3Dsegments_a numSegments=3D1 version=3DFORMAT_DIAGNOSTICS=
 [Lucene
>>> 2.9]
>>> =A01 of 1: name=3D_18 docCount=3D200000
>>> =A0compound=3Dtrue
>>> =A0hasProx=3Dtrue
>>> =A0numFiles=3D1
>>> =A0size (MB)=3D427.445
>>> =A0diagnostics =3D {java.version=3D1.5.0_19, lucene.version=3D2.9-dev 7=
79767M -
>>> 2009-05-28 17:02:17, os=3DMac OS X, os.arch=3Di386, optimize=3Dtrue,
>>> mergeDocStores=3Dtrue, java.vendor=3DApple Inc., os.version=3D10.5.7,
>>> source=3Dmerge, mergeFactor=3D4}
>>> =A0no deletions
>>> =A0test: open reader.........OK
>>> =A0test: fields, norms.......OK [4 fields]
>>> =A0test: terms, freq, prox...OK [3512343 terms; 80020204 terms/docs pai=
rs;
>>> 163219760 tokens]
>>> =A0test: stored fields.......OK [200000 total field count; avg 1 fields=
 per
>>> doc]
>>> =A0test: term vectors........OK [0 total vector count; avg 0 term/freq
>>> vector
>>> fields per doc]
>>>
>>> No problems were detected with this index.
>>>
>>>
>>> -----------------------------------------------------------------------=
----------------------------------
>>>
>>>
>>>
>>>
>>> Thanks,
>>> -Jibo
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> On Aug 1, 2009, at 2:08 AM, Michael McCandless wrote:
>>>
>>>> (Please note that ThreadedIndexWriter is source code available with
>>>> the upcoming revision to Lucene in Action.)
>>>>
>>>> Phil, is it possible you are using an older version of the book's
>>>> source code? =A0In particular, can you check whether your version of
>>>> ThreadedIndexWriter.java has this:
>>>>
>>>> =A0public void close(boolean doWait) throws CorruptIndexException,
>>>> IOException {
>>>> =A0finish();
>>>> =A0super.close(doWait);
>>>> =A0}
>>>>
>>>> (I vaguely remember that being missing from earlier releases, which
>>>> could explain what you're seeing). =A0If you are missing that, can you
>>>> download the current code from http://www.manning.com/hatcher3 and try
>>>> again?
>>>>
>>>> If that's not the problem... can you post the benchmark alg you are
>>>> using in each case?
>>>>
>>>> Mike
>>>>
>>>> On Fri, Jul 31, 2009 at 8:26 PM, Jibo John<jibojohn@mac.com> wrote:
>>>>>
>>>>> Hi Phil,
>>>>>
>>>>> It's 5 threads for IndexWriter.
>>>>>
>>>>> For ThreadedIndexWriter, I used:
>>>>>
>>>>> writer.num.threads=3D16
>>>>> writer.max.thread.queue.size=3D80
>>>>>
>>>>> Thanks,
>>>>> -Jibo
>>>>>
>>>>> On Jul 31, 2009, at 5:01 PM, Phil Whelan wrote:
>>>>>
>>>>>> Hi Jibo,
>>>>>>
>>>>>> Your mergeFactor is different, and the resulting numFiles (segment
>>>>>> files) is different. Maybe each thread is responsible for a segment
>>>>>> file. Just curious - do you have 3 threads?
>>>>>>
>>>>>> Phil
>>>>>>
>>>>>> --------------------------------------------------------------------=
-
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
>


--000e0cd406c09954550470e1a5f0
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--000e0cd406c09954550470e1a5f0--

From java-user-return-41817-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 20:14:12 2009
Return-Path: <java-user-return-41817-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62502 invoked from network); 11 Aug 2009 20:14:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 20:14:11 -0000
Received: (qmail 78575 invoked by uid 500); 11 Aug 2009 20:14:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78488 invoked by uid 500); 11 Aug 2009 20:14:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78478 invoked by uid 99); 11 Aug 2009 20:14:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 20:14:16 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jibojohn@mac.com designates 17.148.16.97 as permitted sender)
Received: from [17.148.16.97] (HELO asmtpout022.mac.com) (17.148.16.97)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 20:14:05 +0000
MIME-version: 1.0
Content-transfer-encoding: 7BIT
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Received: from la0101a-dhcp176.apple.com ([17.214.14.176])
 by asmtp022.mac.com (Sun Java(tm) System Messaging Server 6.3-8.01 (built Dec
 16 2008; 32bit)) with ESMTPSA id <0KO800F28AUTV010@asmtp022.mac.com> for
 java-user@lucene.apache.org; Tue, 11 Aug 2009 13:13:45 -0700 (PDT)
Message-id: <88546292-CE1D-474E-9E6A-5506DEFE57C6@mac.com>
From: Jibo John <jibojohn@mac.com>
To: java-user@lucene.apache.org
In-reply-to: <9ac0c6aa0908111112q64b86e46o20297da020c4fd0e@mail.gmail.com>
Subject: Re: ThreadedIndexWriter vs. IndexWriter
Date: Tue, 11 Aug 2009 13:13:41 -0700
References: <9cafbc680907301111t4768704cy9e4b3092b3d74b17@mail.gmail.com>
 <161DCF62-1E03-4F1B-A590-76ADD91D5434@mac.com>
 <9ac0c6aa0907311452q4f49f1aeua7314b6059b5973@mail.gmail.com>
 <2BC00C69-41B3-48B3-83E7-CBC6DB452CCC@mac.com>
 <9cafbc680907311701g7c8ff0f1n896c4bed2adda9c9@mail.gmail.com>
 <090CF9D7-5D59-47A5-AD2A-86D4BEC6CD15@mac.com>
 <9ac0c6aa0908010208g757a9936vd1150bdec47bc9e9@mail.gmail.com>
 <483308B7-933B-4496-814C-0715D784836A@mac.com>
 <9ac0c6aa0908110313p23fcb7f1uc9ee1018c7ab4256@mail.gmail.com>
 <DDBC7B8B-E102-475C-B595-9B91654E5F58@mac.com>
 <9ac0c6aa0908111112q64b86e46o20297da020c4fd0e@mail.gmail.com>
X-Mailer: Apple Mail (2.935.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Mike,

Yes, it works perfect !

I did observe a dip in the indexing throughput (1855 recs/sec vs. 2200  
recs/sec previously), but, more importantly, no data is lost this time.

Thanks for helping me nail this down.

-Jibo



On Aug 11, 2009, at 11:12 AM, Michael McCandless wrote:

> OK I found the problem!
>
> It was losing docs from the queue, when shutting down the thread pool,
> because we were calling super's addDocument(doc) not addDocument(doc,
> analyzer).  IndexWriter was simply forwarding that call to
> ThreadedIndexWriter's addDocument(doc, analyzer) which in turn would
> do nothing because the thread pool was already told to shut down.
> Larger queues made it much more likely to happen.
>
> Can you try the new version (attached)?
>
> Also, make sure you add 'doc.reuse.fields=false' to your alg (on
> trunk).
>
> Mike
>
> On Tue, Aug 11, 2009 at 12:39 PM, Jibo John<jibojohn@mac.com> wrote:
>> Mike,
>>
>> I wasn't exactly using the lucene core jar from MEAP.
>>
>> I have been building lucene from the source, and running the tests  
>> under
>> lucene/java/trunk/contrib/benchmark/ (checked out 2 weeks ago, I  
>> guess)
>>  and, also under  lucene/java/tags/lucene_2_4_1/contrib/benchmark/.
>> In both cases, copied CreateThreadedIndexTask to
>> org.apache.lucene.benchmark.byTask.tasks and ThreadedIndexWriter to
>> org.apache.lucene.index.
>>
>> I have observed the issue in both the versions of lucene.
>>
>> Indexes were optimized separately using Lucli.
>>
>>
>> PFA the classes and the alg.
>>
>>
>>
>>
>>
>>
>> Thank you for your help with this one.
>>
>> -Jibo
>>
>>
>>
>>
>> On Aug 11, 2009, at 3:13 AM, Michael McCandless wrote:
>>
>>> I'm baffled why you're losing docs w/ ThreadedIndexWriter.
>>>
>>> One question: your Lucene core JAR seems to be newer than the last
>>> MEAP update.  Did you update it manually?
>>>
>>> Also, your indexes were optimized, but your algs don't have an
>>> optimize step -- did you separately run an optimize?
>>>
>>> Could you zip up the whole shebang (ThreadedIndexWriter.java,
>>> CreateThreadedIndexTask.java, the algs) & post?  Please CC me  
>>> directly
>>> so I can grab the zip file... thanks.
>>>
>>> Mike
>>>
>>> On Mon, Aug 3, 2009 at 12:37 PM, Jibo John<jibojohn@mac.com> wrote:
>>>>
>>>> Mike,
>>>>
>>>> Verified that I have the latest source code.
>>>> Here are the alg files and the checkindexer output.
>>>>
>>>>
>>>> ----------------------------------------- indexwriter
>>>> alg----------------------------------------------------------------
>>>>
>>>> analyzer=org.apache.lucene.analysis.standard.StandardAnalyzer
>>>> doc.maker=org.apache.lucene.benchmark.byTask.feeds.LineDocMaker
>>>> directory=FSDirectory
>>>>
>>>> doc.stored =  
>>>> true                                                    #A
>>>> docs.file=wikipedia.lines.txt
>>>> ram.flush.mb=50
>>>> compound=false
>>>> merge.factor=5
>>>> doc.add.log.step=1000
>>>> doc.term.vector=false
>>>> doc.term.vector.positions=false
>>>> doc.term.vector.offsets=false
>>>>
>>>> { "Rounds 
>>>> "                                                           #B
>>>>  ResetSystemErase
>>>>  { "BuildIndex"
>>>>  -CreateIndex()
>>>>  [ { "AddDocs" AddDoc > : 40000 ] : 5
>>>>  #C
>>>>  -CloseIndex()
>>>>  }
>>>>  NewRound
>>>> } : 1
>>>>
>>>> RepSumByPrefRound  
>>>> BuildIndex                                         #D
>>>>
>>>> -----------------------------------------threadedindexwriter alg
>>>> ----------------------------------------------------------------
>>>>
>>>> analyzer=org.apache.lucene.analysis.standard.StandardAnalyzer
>>>> doc.maker=org.apache.lucene.benchmark.byTask.feeds.LineDocMaker
>>>> directory=FSDirectory
>>>>
>>>> doc.stored =  
>>>> true                                                    #A
>>>> docs.file=wikipedia.lines.txt
>>>> ram.flush.mb=50
>>>> compound=false
>>>> merge.factor=5
>>>> doc.add.log.step=1000
>>>> doc.term.vector=false
>>>> doc.term.vector.positions=false
>>>> doc.term.vector.offsets=false
>>>> writer.num.threads=15
>>>> writer.max.thread.queue.size=75
>>>> work.dir=work_t
>>>>
>>>>
>>>> { "Rounds 
>>>> "                                                           #B
>>>>  ResetSystemErase
>>>>  { "BuildIndex"
>>>>  -CreateThreadedIndex()
>>>>  { "AddDocs" AddDoc > : 200000
>>>>  -CloseIndex()
>>>>  }
>>>>  NewRound
>>>> } : 1
>>>>
>>>> RepSumByPrefRound  
>>>> BuildIndex                                         #D
>>>>
>>>>
>>>> -----------------------------------------------threadedindexwriter
>>>> checkindex  
>>>> ----------------------------------------------------------
>>>>
>>>>
>>>> $ java -classpath
>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/build/lucene-core-2.9- 
>>>> dev.jar
>>>> org.apache.lucene.index.CheckIndex
>>>>
>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/ 
>>>> work_t/index
>>>>
>>>> NOTE: testing will be more thorough if you run java with
>>>> '-ea:org.apache.lucene...', so assertions are enabled
>>>>
>>>> Opening index @
>>>>
>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/ 
>>>> work_t/index
>>>>
>>>> Segments file=segments_3 numSegments=1 version=FORMAT_DIAGNOSTICS  
>>>> [Lucene
>>>> 2.9]
>>>>  1 of 1: name=_p docCount=199941
>>>>  compound=true
>>>>  hasProx=true
>>>>  numFiles=3
>>>>  size (MB)=317.1
>>>>  diagnostics = {java.version=1.5.0_19, lucene.version=2.9-dev  
>>>> 779767M -
>>>> 2009-05-28 17:02:17, os=Mac OS X, os.arch=i386, optimize=true,
>>>> mergeDocStores=false, java.vendor=Apple Inc., os.version=10.5.7,
>>>> source=merge, mergeFactor=5}
>>>>  docStoreOffset=0
>>>>  docStoreSegment=_0
>>>>  docStoreIsCompoundFile=false
>>>>  no deletions
>>>>  test: open reader.........OK
>>>>  test: fields, norms.......OK [4 fields]
>>>>  test: terms, freq, prox...OK [1269552 terms; 67887116 terms/docs  
>>>> pairs;
>>>> 133241176 tokens]
>>>>  test: stored fields.......OK [199941 total field count; avg 1  
>>>> fields per
>>>> doc]
>>>>  test: term vectors........OK [0 total vector count; avg 0 term/ 
>>>> freq
>>>> vector
>>>> fields per doc]
>>>>
>>>> No problems were detected with this index.
>>>>
>>>> ------------------------------------------indexwriter checkindex
>>>> ---------------------------------------------------------------
>>>>
>>>> $ java -classpath
>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/build/lucene-core-2.9- 
>>>> dev.jar
>>>> org.apache.lucene.index.CheckIndex
>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/ 
>>>> work/index
>>>>
>>>> NOTE: testing will be more thorough if you run java with
>>>> '-ea:org.apache.lucene...', so assertions are enabled
>>>>
>>>> Opening index @
>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/ 
>>>> work/index
>>>>
>>>> Segments file=segments_a numSegments=1 version=FORMAT_DIAGNOSTICS  
>>>> [Lucene
>>>> 2.9]
>>>>  1 of 1: name=_18 docCount=200000
>>>>  compound=true
>>>>  hasProx=true
>>>>  numFiles=1
>>>>  size (MB)=427.445
>>>>  diagnostics = {java.version=1.5.0_19, lucene.version=2.9-dev  
>>>> 779767M -
>>>> 2009-05-28 17:02:17, os=Mac OS X, os.arch=i386, optimize=true,
>>>> mergeDocStores=true, java.vendor=Apple Inc., os.version=10.5.7,
>>>> source=merge, mergeFactor=4}
>>>>  no deletions
>>>>  test: open reader.........OK
>>>>  test: fields, norms.......OK [4 fields]
>>>>  test: terms, freq, prox...OK [3512343 terms; 80020204 terms/docs  
>>>> pairs;
>>>> 163219760 tokens]
>>>>  test: stored fields.......OK [200000 total field count; avg 1  
>>>> fields per
>>>> doc]
>>>>  test: term vectors........OK [0 total vector count; avg 0 term/ 
>>>> freq
>>>> vector
>>>> fields per doc]
>>>>
>>>> No problems were detected with this index.
>>>>
>>>>
>>>> ---------------------------------------------------------------------------------------------------------
>>>>
>>>>
>>>>
>>>>
>>>> Thanks,
>>>> -Jibo
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> On Aug 1, 2009, at 2:08 AM, Michael McCandless wrote:
>>>>
>>>>> (Please note that ThreadedIndexWriter is source code available  
>>>>> with
>>>>> the upcoming revision to Lucene in Action.)
>>>>>
>>>>> Phil, is it possible you are using an older version of the book's
>>>>> source code?  In particular, can you check whether your version of
>>>>> ThreadedIndexWriter.java has this:
>>>>>
>>>>>  public void close(boolean doWait) throws CorruptIndexException,
>>>>> IOException {
>>>>>  finish();
>>>>>  super.close(doWait);
>>>>>  }
>>>>>
>>>>> (I vaguely remember that being missing from earlier releases,  
>>>>> which
>>>>> could explain what you're seeing).  If you are missing that, can  
>>>>> you
>>>>> download the current code from http://www.manning.com/hatcher3  
>>>>> and try
>>>>> again?
>>>>>
>>>>> If that's not the problem... can you post the benchmark alg you  
>>>>> are
>>>>> using in each case?
>>>>>
>>>>> Mike
>>>>>
>>>>> On Fri, Jul 31, 2009 at 8:26 PM, Jibo John<jibojohn@mac.com>  
>>>>> wrote:
>>>>>>
>>>>>> Hi Phil,
>>>>>>
>>>>>> It's 5 threads for IndexWriter.
>>>>>>
>>>>>> For ThreadedIndexWriter, I used:
>>>>>>
>>>>>> writer.num.threads=16
>>>>>> writer.max.thread.queue.size=80
>>>>>>
>>>>>> Thanks,
>>>>>> -Jibo
>>>>>>
>>>>>> On Jul 31, 2009, at 5:01 PM, Phil Whelan wrote:
>>>>>>
>>>>>>> Hi Jibo,
>>>>>>>
>>>>>>> Your mergeFactor is different, and the resulting numFiles  
>>>>>>> (segment
>>>>>>> files) is different. Maybe each thread is responsible for a  
>>>>>>> segment
>>>>>>> file. Just curious - do you have 3 threads?
>>>>>>>
>>>>>>> Phil
>>>>>>>
>>>>>>> ---------------------------------------------------------------------
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user- 
>>>>>>> help@lucene.apache.org
>>>>>>>
>>>>>>
>>>>>>
>>>>>> ---------------------------------------------------------------------
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41818-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 21:28:08 2009
Return-Path: <java-user-return-41818-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88377 invoked from network); 11 Aug 2009 21:28:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 21:28:08 -0000
Received: (qmail 32280 invoked by uid 500); 11 Aug 2009 21:28:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32219 invoked by uid 500); 11 Aug 2009 21:28:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32209 invoked by uid 99); 11 Aug 2009 21:28:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 21:28:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 21:28:03 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Maysg-0004Zd-L6
	for java-user@lucene.apache.org; Tue, 11 Aug 2009 14:27:42 -0700
Message-ID: <24926082.post@talk.nabble.com>
Date: Tue, 11 Aug 2009 14:27:42 -0700 (PDT)
From: xs2Abhishek <abhishek@ontinc.com>
To: java-user@lucene.apache.org
Subject: How to tune Analyzer for Text Extraction
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: abhishek@ontinc.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I am trying to make a decision on weather or not I can use Lucene for my
requirements, which mainly include data tagging. I have to be able to parse
or index a .txt file and then be able to extract text accordingly. For e.g
if the input document has some text like: "Location: New York" , so for this
input I should be able to extract "New York" if key word Location is
present. I am trying to learn about Lucene and looked into
"tokensFromAnalysis(analyzer, text)". But i'm still not sure how I could
extract data using lucene. Can I use queries to extract this piece of
information?

Any help on this would be appreciated.

Thanks,
Abhishek
-- 
View this message in context: http://www.nabble.com/How-to-tune-Analyzer-for-Text-Extraction-tp24926082p24926082.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41819-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 21:39:27 2009
Return-Path: <java-user-return-41819-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96142 invoked from network); 11 Aug 2009 21:39:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 21:39:27 -0000
Received: (qmail 77746 invoked by uid 500); 11 Aug 2009 21:39:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77670 invoked by uid 500); 11 Aug 2009 21:39:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77660 invoked by uid 99); 11 Aug 2009 21:39:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 21:39:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of michael.wechner@wyona.com designates 195.226.6.75 as permitted sender)
Received: from [195.226.6.75] (HELO server1.example.com) (195.226.6.75)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 21:39:21 +0000
Received: from michael-wechners-mac-mini.local (unknown [81.62.46.101])
	by server1.example.com (Postfix) with ESMTP id 42C0210CA18
	for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 23:46:05 +0200 (CEST)
Message-ID: <4A81E4F2.7050802@wyona.com>
Date: Tue, 11 Aug 2009 23:38:58 +0200
From: Michael Wechner <michael.wechner@wyona.com>
User-Agent: Thunderbird 2.0.0.22 (Macintosh/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: How to tune Analyzer for Text Extraction
References: <24926082.post@talk.nabble.com>
In-Reply-To: <24926082.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

xs2Abhishek schrieb:
> Hi,
>
> I am trying to make a decision on weather or not I can use Lucene for my
> requirements, which mainly include data tagging. I have to be able to parse
> or index a .txt file and then be able to extract text accordingly. For e.g
> if the input document has some text like: "Location: New York" , so for this
> input I should be able to extract "New York" if key word Location is
> present. I am trying to learn about Lucene and looked into
> "tokensFromAnalysis(analyzer, text)". But i'm still not sure how I could
> extract data using lucene. Can I use queries to extract this piece of
> information?
>   

before feeding the content into Lucene you might want to pre-parse your 
content with Apache Tika or something similar.

Cheers

Michael
> Any help on this would be appreciated.
>
> Thanks,
> Abhishek
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41820-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 11 23:21:57 2009
Return-Path: <java-user-return-41820-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35291 invoked from network); 11 Aug 2009 23:21:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Aug 2009 23:21:57 -0000
Received: (qmail 73563 invoked by uid 500); 11 Aug 2009 23:22:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73489 invoked by uid 500); 11 Aug 2009 23:22:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73479 invoked by uid 99); 11 Aug 2009 23:22:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 23:22:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Aug 2009 23:21:50 +0000
Received: by yxe3 with SMTP id 3so5911658yxe.29
        for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 16:21:28 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.216.1 with SMTP id o1mr11584968ybg.324.1250031358832; Tue, 
	11 Aug 2009 15:55:58 -0700 (PDT)
In-Reply-To: <88546292-CE1D-474E-9E6A-5506DEFE57C6@mac.com>
References: <9cafbc680907301111t4768704cy9e4b3092b3d74b17@mail.gmail.com>
	 <2BC00C69-41B3-48B3-83E7-CBC6DB452CCC@mac.com>
	 <9cafbc680907311701g7c8ff0f1n896c4bed2adda9c9@mail.gmail.com>
	 <090CF9D7-5D59-47A5-AD2A-86D4BEC6CD15@mac.com>
	 <9ac0c6aa0908010208g757a9936vd1150bdec47bc9e9@mail.gmail.com>
	 <483308B7-933B-4496-814C-0715D784836A@mac.com>
	 <9ac0c6aa0908110313p23fcb7f1uc9ee1018c7ab4256@mail.gmail.com>
	 <DDBC7B8B-E102-475C-B595-9B91654E5F58@mac.com>
	 <9ac0c6aa0908111112q64b86e46o20297da020c4fd0e@mail.gmail.com>
	 <88546292-CE1D-474E-9E6A-5506DEFE57C6@mac.com>
Date: Tue, 11 Aug 2009 18:55:58 -0400
Message-ID: <9ac0c6aa0908111555m3fdabe6dyd4c13c10c34d95ed@mail.gmail.com>
Subject: Re: ThreadedIndexWriter vs. IndexWriter
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Phew!  Thank you for raising this... it was a sneaky one.

Mike

On Tue, Aug 11, 2009 at 4:13 PM, Jibo John<jibojohn@mac.com> wrote:
> Mike,
>
> Yes, it works perfect !
>
> I did observe a dip in the indexing throughput (1855 recs/sec vs. 2200
> recs/sec previously), but, more importantly, no data is lost this time.
>
> Thanks for helping me nail this down.
>
> -Jibo
>
>
>
> On Aug 11, 2009, at 11:12 AM, Michael McCandless wrote:
>
>> OK I found the problem!
>>
>> It was losing docs from the queue, when shutting down the thread pool,
>> because we were calling super's addDocument(doc) not addDocument(doc,
>> analyzer). =A0IndexWriter was simply forwarding that call to
>> ThreadedIndexWriter's addDocument(doc, analyzer) which in turn would
>> do nothing because the thread pool was already told to shut down.
>> Larger queues made it much more likely to happen.
>>
>> Can you try the new version (attached)?
>>
>> Also, make sure you add 'doc.reuse.fields=3Dfalse' to your alg (on
>> trunk).
>>
>> Mike
>>
>> On Tue, Aug 11, 2009 at 12:39 PM, Jibo John<jibojohn@mac.com> wrote:
>>>
>>> Mike,
>>>
>>> I wasn't exactly using the lucene core jar from MEAP.
>>>
>>> I have been building lucene from the source, and running the tests unde=
r
>>> lucene/java/trunk/contrib/benchmark/ (checked out 2 weeks ago, I guess)
>>> =A0and, also under =A0lucene/java/tags/lucene_2_4_1/contrib/benchmark/.
>>> In both cases, copied CreateThreadedIndexTask to
>>> org.apache.lucene.benchmark.byTask.tasks and ThreadedIndexWriter to
>>> org.apache.lucene.index.
>>>
>>> I have observed the issue in both the versions of lucene.
>>>
>>> Indexes were optimized separately using Lucli.
>>>
>>>
>>> PFA the classes and the alg.
>>>
>>>
>>>
>>>
>>>
>>>
>>> Thank you for your help with this one.
>>>
>>> -Jibo
>>>
>>>
>>>
>>>
>>> On Aug 11, 2009, at 3:13 AM, Michael McCandless wrote:
>>>
>>>> I'm baffled why you're losing docs w/ ThreadedIndexWriter.
>>>>
>>>> One question: your Lucene core JAR seems to be newer than the last
>>>> MEAP update. =A0Did you update it manually?
>>>>
>>>> Also, your indexes were optimized, but your algs don't have an
>>>> optimize step -- did you separately run an optimize?
>>>>
>>>> Could you zip up the whole shebang (ThreadedIndexWriter.java,
>>>> CreateThreadedIndexTask.java, the algs) & post? =A0Please CC me direct=
ly
>>>> so I can grab the zip file... thanks.
>>>>
>>>> Mike
>>>>
>>>> On Mon, Aug 3, 2009 at 12:37 PM, Jibo John<jibojohn@mac.com> wrote:
>>>>>
>>>>> Mike,
>>>>>
>>>>> Verified that I have the latest source code.
>>>>> Here are the alg files and the checkindexer output.
>>>>>
>>>>>
>>>>> ----------------------------------------- indexwriter
>>>>> alg----------------------------------------------------------------
>>>>>
>>>>> analyzer=3Dorg.apache.lucene.analysis.standard.StandardAnalyzer
>>>>> doc.maker=3Dorg.apache.lucene.benchmark.byTask.feeds.LineDocMaker
>>>>> directory=3DFSDirectory
>>>>>
>>>>> doc.stored =3D true =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0#A
>>>>> docs.file=3Dwikipedia.lines.txt
>>>>> ram.flush.mb=3D50
>>>>> compound=3Dfalse
>>>>> merge.factor=3D5
>>>>> doc.add.log.step=3D1000
>>>>> doc.term.vector=3Dfalse
>>>>> doc.term.vector.positions=3Dfalse
>>>>> doc.term.vector.offsets=3Dfalse
>>>>>
>>>>> { "Rounds" =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #B
>>>>> =A0ResetSystemErase
>>>>> =A0{ "BuildIndex"
>>>>> =A0-CreateIndex()
>>>>> =A0[ { "AddDocs" AddDoc > : 40000 ] : 5
>>>>> =A0#C
>>>>> =A0-CloseIndex()
>>>>> =A0}
>>>>> =A0NewRound
>>>>> } : 1
>>>>>
>>>>> RepSumByPrefRound BuildIndex =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #D
>>>>>
>>>>> -----------------------------------------threadedindexwriter alg
>>>>> ----------------------------------------------------------------
>>>>>
>>>>> analyzer=3Dorg.apache.lucene.analysis.standard.StandardAnalyzer
>>>>> doc.maker=3Dorg.apache.lucene.benchmark.byTask.feeds.LineDocMaker
>>>>> directory=3DFSDirectory
>>>>>
>>>>> doc.stored =3D true =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0#A
>>>>> docs.file=3Dwikipedia.lines.txt
>>>>> ram.flush.mb=3D50
>>>>> compound=3Dfalse
>>>>> merge.factor=3D5
>>>>> doc.add.log.step=3D1000
>>>>> doc.term.vector=3Dfalse
>>>>> doc.term.vector.positions=3Dfalse
>>>>> doc.term.vector.offsets=3Dfalse
>>>>> writer.num.threads=3D15
>>>>> writer.max.thread.queue.size=3D75
>>>>> work.dir=3Dwork_t
>>>>>
>>>>>
>>>>> { "Rounds" =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #B
>>>>> =A0ResetSystemErase
>>>>> =A0{ "BuildIndex"
>>>>> =A0-CreateThreadedIndex()
>>>>> =A0{ "AddDocs" AddDoc > : 200000
>>>>> =A0-CloseIndex()
>>>>> =A0}
>>>>> =A0NewRound
>>>>> } : 1
>>>>>
>>>>> RepSumByPrefRound BuildIndex =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 #D
>>>>>
>>>>>
>>>>> -----------------------------------------------threadedindexwriter
>>>>> checkindex ----------------------------------------------------------
>>>>>
>>>>>
>>>>> $ java -classpath
>>>>>
>>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/build/lucene-core-2.9-dev=
.jar
>>>>> org.apache.lucene.index.CheckIndex
>>>>>
>>>>>
>>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work_t/=
index
>>>>>
>>>>> NOTE: testing will be more thorough if you run java with
>>>>> '-ea:org.apache.lucene...', so assertions are enabled
>>>>>
>>>>> Opening index @
>>>>>
>>>>>
>>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work_t/=
index
>>>>>
>>>>> Segments file=3Dsegments_3 numSegments=3D1 version=3DFORMAT_DIAGNOSTI=
CS
>>>>> [Lucene
>>>>> 2.9]
>>>>> =A01 of 1: name=3D_p docCount=3D199941
>>>>> =A0compound=3Dtrue
>>>>> =A0hasProx=3Dtrue
>>>>> =A0numFiles=3D3
>>>>> =A0size (MB)=3D317.1
>>>>> =A0diagnostics =3D {java.version=3D1.5.0_19, lucene.version=3D2.9-dev=
 779767M -
>>>>> 2009-05-28 17:02:17, os=3DMac OS X, os.arch=3Di386, optimize=3Dtrue,
>>>>> mergeDocStores=3Dfalse, java.vendor=3DApple Inc., os.version=3D10.5.7=
,
>>>>> source=3Dmerge, mergeFactor=3D5}
>>>>> =A0docStoreOffset=3D0
>>>>> =A0docStoreSegment=3D_0
>>>>> =A0docStoreIsCompoundFile=3Dfalse
>>>>> =A0no deletions
>>>>> =A0test: open reader.........OK
>>>>> =A0test: fields, norms.......OK [4 fields]
>>>>> =A0test: terms, freq, prox...OK [1269552 terms; 67887116 terms/docs
>>>>> pairs;
>>>>> 133241176 tokens]
>>>>> =A0test: stored fields.......OK [199941 total field count; avg 1 fiel=
ds
>>>>> per
>>>>> doc]
>>>>> =A0test: term vectors........OK [0 total vector count; avg 0 term/fre=
q
>>>>> vector
>>>>> fields per doc]
>>>>>
>>>>> No problems were detected with this index.
>>>>>
>>>>> ------------------------------------------indexwriter checkindex
>>>>> ---------------------------------------------------------------
>>>>>
>>>>> $ java -classpath
>>>>>
>>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/build/lucene-core-2.9-dev=
.jar
>>>>> org.apache.lucene.index.CheckIndex
>>>>>
>>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work/in=
dex
>>>>>
>>>>> NOTE: testing will be more thorough if you run java with
>>>>> '-ea:org.apache.lucene...', so assertions are enabled
>>>>>
>>>>> Opening index @
>>>>>
>>>>> /Users/jibo/Desktop/iwork/lucene/java/trunk/contrib/benchmark/work/in=
dex
>>>>>
>>>>> Segments file=3Dsegments_a numSegments=3D1 version=3DFORMAT_DIAGNOSTI=
CS
>>>>> [Lucene
>>>>> 2.9]
>>>>> =A01 of 1: name=3D_18 docCount=3D200000
>>>>> =A0compound=3Dtrue
>>>>> =A0hasProx=3Dtrue
>>>>> =A0numFiles=3D1
>>>>> =A0size (MB)=3D427.445
>>>>> =A0diagnostics =3D {java.version=3D1.5.0_19, lucene.version=3D2.9-dev=
 779767M -
>>>>> 2009-05-28 17:02:17, os=3DMac OS X, os.arch=3Di386, optimize=3Dtrue,
>>>>> mergeDocStores=3Dtrue, java.vendor=3DApple Inc., os.version=3D10.5.7,
>>>>> source=3Dmerge, mergeFactor=3D4}
>>>>> =A0no deletions
>>>>> =A0test: open reader.........OK
>>>>> =A0test: fields, norms.......OK [4 fields]
>>>>> =A0test: terms, freq, prox...OK [3512343 terms; 80020204 terms/docs
>>>>> pairs;
>>>>> 163219760 tokens]
>>>>> =A0test: stored fields.......OK [200000 total field count; avg 1 fiel=
ds
>>>>> per
>>>>> doc]
>>>>> =A0test: term vectors........OK [0 total vector count; avg 0 term/fre=
q
>>>>> vector
>>>>> fields per doc]
>>>>>
>>>>> No problems were detected with this index.
>>>>>
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------=
------------------------------------
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> Thanks,
>>>>> -Jibo
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> On Aug 1, 2009, at 2:08 AM, Michael McCandless wrote:
>>>>>
>>>>>> (Please note that ThreadedIndexWriter is source code available with
>>>>>> the upcoming revision to Lucene in Action.)
>>>>>>
>>>>>> Phil, is it possible you are using an older version of the book's
>>>>>> source code? =A0In particular, can you check whether your version of
>>>>>> ThreadedIndexWriter.java has this:
>>>>>>
>>>>>> =A0public void close(boolean doWait) throws CorruptIndexException,
>>>>>> IOException {
>>>>>> =A0finish();
>>>>>> =A0super.close(doWait);
>>>>>> =A0}
>>>>>>
>>>>>> (I vaguely remember that being missing from earlier releases, which
>>>>>> could explain what you're seeing). =A0If you are missing that, can y=
ou
>>>>>> download the current code from http://www.manning.com/hatcher3 and t=
ry
>>>>>> again?
>>>>>>
>>>>>> If that's not the problem... can you post the benchmark alg you are
>>>>>> using in each case?
>>>>>>
>>>>>> Mike
>>>>>>
>>>>>> On Fri, Jul 31, 2009 at 8:26 PM, Jibo John<jibojohn@mac.com> wrote:
>>>>>>>
>>>>>>> Hi Phil,
>>>>>>>
>>>>>>> It's 5 threads for IndexWriter.
>>>>>>>
>>>>>>> For ThreadedIndexWriter, I used:
>>>>>>>
>>>>>>> writer.num.threads=3D16
>>>>>>> writer.max.thread.queue.size=3D80
>>>>>>>
>>>>>>> Thanks,
>>>>>>> -Jibo
>>>>>>>
>>>>>>> On Jul 31, 2009, at 5:01 PM, Phil Whelan wrote:
>>>>>>>
>>>>>>>> Hi Jibo,
>>>>>>>>
>>>>>>>> Your mergeFactor is different, and the resulting numFiles (segment
>>>>>>>> files) is different. Maybe each thread is responsible for a segmen=
t
>>>>>>>> file. Just curious - do you have 3 threads?
>>>>>>>>
>>>>>>>> Phil
>>>>>>>>
>>>>>>>>
>>>>>>>> ------------------------------------------------------------------=
---
>>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> -------------------------------------------------------------------=
--
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> --------------------------------------------------------------------=
-
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>>
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41821-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 01:56:58 2009
Return-Path: <java-user-return-41821-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97432 invoked from network); 12 Aug 2009 01:56:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 01:56:57 -0000
Received: (qmail 1495 invoked by uid 500); 12 Aug 2009 01:57:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1423 invoked by uid 500); 12 Aug 2009 01:57:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1413 invoked by uid 99); 12 Aug 2009 01:57:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 01:57:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 01:56:52 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mb34p-0005d6-Sg
	for java-user@lucene.apache.org; Tue, 11 Aug 2009 18:56:31 -0700
Message-ID: <24928789.post@talk.nabble.com>
Date: Tue, 11 Aug 2009 18:56:31 -0700 (PDT)
From: bourne71 <garylkc@live.com>
To: java-user@lucene.apache.org
Subject: Re: Query Boosting
In-Reply-To: <f18c9dde0908110252k7042745ga008b9c965cc1f09@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: garylkc@live.com
References: <24913967.post@talk.nabble.com> <f18c9dde0908110252k7042745ga008b9c965cc1f09@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


thanks, I understand how boosting works, what I need will be a boost in the
query that will increase the score of a page if all keywords/query is found
in the page to increase its ranking.

I tried all sort of combination and it did not work. Anyone can provide any
suggestion?


Simon Willnauer wrote:
>=20
> Hi there,
>=20
> well, where to start from.... I would suggest you look at the output
> of Query#explain() first to see how the score is calculated. You might
> use a simpler query to get started with it as this might be quite
> cryptic if you see it the first time.
> To completely understand what the output means have a closer look to
> the javadoc of the class Similarity
> (http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/search/Si=
milarity.html)
> this will explain how the score is calculated in the very detail.
> Once you understand what is going on during the scoring process I
> would suggest you revise your boosting. I don't know if you have field
> boost set but it seems it would make more sense in your usecase as far
> as I can tell.
> In general make sure you understand what the different boosts are used
> for - this snippet from the wiki might help you:
> <snip>
> What is the difference between field (or document) boosting and query
> boosting?
>=20
> Index time field boosts (field.setBoost(boost)) are a way to express
> things like "this document's title is worth twice as much as the title
> of most documents". Query time boosts (query.setBoost(boost)) are a
> way to express "I care about matches on this clause of my query twice
> as much as I do about matches on other clauses of my query".
>=20
> Index time field boosts are worthless if you set them on every document.
>=20
> Index time document boosts (doc.setBoost(float)) are equivalent to
> setting a field boost on ever field in that document.
> </snip>
> (http://wiki.apache.org/lucene-java/LuceneFAQ#head-246300129b9d3bf73f597f=
acec54ac2ee54e15d7)
>=20
> hope that helps to get started with scoring etc.
>=20
> simon
>=20
>=20
> On Tue, Aug 11, 2009 at 10:50 AM, bourne71<garylkc@live.com> wrote:
>>
>> Hi,
>>
>> I am fairly new to Lucene and have encounter a problem with the search
>> function i am trying to create using Lucene. =C2=A0When I search, lets s=
ay
>> "news
>> sharing", then the results return and display.
>>
>> Its fine up to this point until I check the ranking. Some results,
>> although
>> match only 1 of the 2 keywords, will have higher ranking. The problem is
>> like describe below:
>>
>> Page 1
>> news - Total found 23
>> sharing - Total found 0
>>
>> Page 2
>> news - Total found 1
>> sharing - Total found 21
>>
>> This is understandable why Page 1 got better ranking, bcs it has more
>> keyword found. But this will make the results return to be less relevant
>>
>> My current query is like the following:
>> (url:sharing^2.0 content:sharing title:sharing^1.5) (url:news^2.0
>> content:news title:news^1.5) url:"sharing news"~2147483647^2.0
>> content:"sharing news"~2147483647 title:"sharing news"~2147483647^1.5
>>
>> Is there anyway I can add an additional query that will give an
>> additional
>> boost to results that has both the keyword in it?
>> --
>> View this message in context:
>> http://www.nabble.com/Query-Boosting-tp24913967p24913967.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Query-Boosting-tp249139=
67p24928789.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41822-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 03:20:32 2009
Return-Path: <java-user-return-41822-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25942 invoked from network); 12 Aug 2009 03:20:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 03:20:31 -0000
Received: (qmail 16136 invoked by uid 500); 12 Aug 2009 03:20:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16061 invoked by uid 500); 12 Aug 2009 03:20:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16040 invoked by uid 99); 12 Aug 2009 03:20:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 03:20:36 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ihasmax@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 03:20:28 +0000
Received: by fxm2 with SMTP id 2so3692565fxm.28
        for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 20:20:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=7xZnOiLq+J6wCUaBS7bRL5XFjt0fO0r6P4GMBMbfUTw=;
        b=F6yMWsSBRwlGOHrI6MEWdiq2ELyzn7KAvTvMYX/WU7az4Ncz1E/EfBFOclIfcnAITr
         +N5TJv1ewJO1g2iQG3ZrHOYXD8UfG3qFL3Kfa0vSE32ycCpv4xqPBH+fjKQu2Buz8yDC
         M+N9Hj7G6YbLIgsICoLDpHjRaosJc0zSuwBHQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=oKo4DUZYwnBmMC/Uhy9Kjoqc3pYB3rSOwsy3ilhw+uDKFtGfSMAJxEQPuevAQk1Q/a
         WCMOsmxrt5teDTLi8XLu1g7jlsivTyRUsZDn15MHBYQFRzQC1iUBb5zeWAhtPSQ9C68a
         KZs7h/zvsrXninHvb8xbARt0JIMckNN+sdx38=
MIME-Version: 1.0
Received: by 10.103.161.5 with SMTP id n5mr481903muo.73.1250047206881; Tue, 11 
	Aug 2009 20:20:06 -0700 (PDT)
Date: Tue, 11 Aug 2009 22:20:06 -0500
Message-ID: <3836ec640908112020x1b0c7c6bg9ed453bcb287966a@mail.gmail.com>
Subject: Different Analyzers
From: Max Lynch <ihasmax@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6498750b7fba70470e94b98
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6498750b7fba70470e94b98
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I just want to see if it's safe to use two different analyzers for the
following situation:

I have an index that I want to preserve case with so I can do case-sensitive
searches with my WhitespaceAnalyzer.  However, I also want to do case
insensitive searches.

What I did was create a custom Analyzer that creates a LowerCaseFilter with
a WhitespaceTokenizer, and use that analyzer to search when I want case
insensitive searching, and use the default WhitespaceAnalyzer when I want
case sensitive.

Is this the right approach, or should I change something?

Thanks,
Max

--0016e6498750b7fba70470e94b98--

From java-user-return-41823-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 03:31:56 2009
Return-Path: <java-user-return-41823-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29941 invoked from network); 12 Aug 2009 03:31:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 03:31:56 -0000
Received: (qmail 51966 invoked by uid 500); 12 Aug 2009 03:32:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51879 invoked by uid 500); 12 Aug 2009 03:32:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51869 invoked by uid 99); 12 Aug 2009 03:32:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 03:32:01 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 03:31:51 +0000
Received: by ewy26 with SMTP id 26so4527759ewy.5
        for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 20:31:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=lUT3MnqZOjnErgq3QCJwvB4Napx/qYmNNoxD6NMB3PU=;
        b=T5uX6dzg8//oggdPW4KfL3qiTl6JJdmWySbVQMmxXaE4UyBUYQuAzL+5oFHbPFvi7P
         TiAFdX9JO9NGQtboeLIqQv2tIqSVy+MOIGT/PxfZbExGbguqdC+I72TtzGRp7EzvjUd4
         n+yzEtqN829p2Tww9iXcBSc1+khTgZkkNBGZE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ZZjTYxDLpTe8WWynslXoaStEgt+CT3KGvjmJzZk6fGqqSFPNslIRvKdTEBKybhuKJh
         FCyyl13KgGJURGGhkRnytJIllWYTrGD4E19ay0C0QWir9W7y97HCHl8YVDvEyPDhMqBk
         XenRSANCcsD2U3rAVST5FCVuN0e5e1bJurrvU=
MIME-Version: 1.0
Received: by 10.216.54.194 with SMTP id i44mr1445356wec.93.1250047891303; Tue, 
	11 Aug 2009 20:31:31 -0700 (PDT)
In-Reply-To: <3836ec640908112020x1b0c7c6bg9ed453bcb287966a@mail.gmail.com>
References: <3836ec640908112020x1b0c7c6bg9ed453bcb287966a@mail.gmail.com>
Date: Wed, 12 Aug 2009 06:31:31 +0300
Message-ID: <786fde50908112031y1f73f86fnc4cb7b990a048113@mail.gmail.com>
Subject: Re: Different Analyzers
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6dbea5a836d700470e97433
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6dbea5a836d700470e97433
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

you should also make sure the data is indexed twice, once w/ the original
case and once w/o. It's like putting a TokenFilter after WhitespaceTokenizer
which returns two tokens - lowercased and the original, both in the same
position (set posIncr to 0).

On Wed, Aug 12, 2009 at 6:20 AM, Max Lynch <ihasmax@gmail.com> wrote:

> I just want to see if it's safe to use two different analyzers for the
> following situation:
>
> I have an index that I want to preserve case with so I can do
> case-sensitive
> searches with my WhitespaceAnalyzer.  However, I also want to do case
> insensitive searches.
>
> What I did was create a custom Analyzer that creates a LowerCaseFilter with
> a WhitespaceTokenizer, and use that analyzer to search when I want case
> insensitive searching, and use the default WhitespaceAnalyzer when I want
> case sensitive.
>
> Is this the right approach, or should I change something?
>
> Thanks,
> Max
>

--0016e6dbea5a836d700470e97433--

From java-user-return-41824-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 03:38:27 2009
Return-Path: <java-user-return-41824-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31575 invoked from network); 12 Aug 2009 03:38:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 03:38:27 -0000
Received: (qmail 60392 invoked by uid 500); 12 Aug 2009 03:38:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60320 invoked by uid 500); 12 Aug 2009 03:38:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60310 invoked by uid 99); 12 Aug 2009 03:38:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 03:38:31 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 03:38:22 +0000
Received: by ey-out-2122.google.com with SMTP id 9so1149966eyd.53
        for <java-user@lucene.apache.org>; Tue, 11 Aug 2009 20:38:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=5H0K2wR5ESo+wC7yl1MjDbstpfGUiih11uHblJpo/JM=;
        b=nrBr2mPkJcu2kv4+j5gMsYT40ZG2ILSQNz5TpO1ggR0KSk9OeG17G60mxMg9412vy1
         RIgR2zI8Z/X3xeeZNst6Zq0AuDyQOT4RvKO9r9aAa+st+OtlC3UPzmvVe/97kCjSCUgV
         DgsYG3CrPoAB3w7PScaCX06ytBT9sdsZDEbuk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=u3lmHloyB6QD7sPUbixerQIiSqSAE5750Yy6S7cYSIEBFS98S7P4VkUZ/Lc5E/AO+U
         Cw73qb1JI0RLMcQyCZkznyoeNiLN6PT2nhAlEkK/bzFmp7HIksZpmG9/Pfe0U/b1EGUu
         Fx3k2k5FaYLoGH5nICYyrNYPV1fnOwEcWqdfw=
MIME-Version: 1.0
Received: by 10.216.85.18 with SMTP id t18mr1460903wee.82.1250048280876; Tue, 
	11 Aug 2009 20:38:00 -0700 (PDT)
In-Reply-To: <24926082.post@talk.nabble.com>
References: <24926082.post@talk.nabble.com>
Date: Wed, 12 Aug 2009 06:38:00 +0300
Message-ID: <786fde50908112038j74e8289aif816af3a2d064c75@mail.gmail.com>
Subject: Re: How to tune Analyzer for Text Extraction
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d77f78bbd8d60470e98b55
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d77f78bbd8d60470e98b55
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

If this file has a predefined construct, e.g.:
title: someting
location: new york
....
then you can write a simple parser that extracts that information.

But I think otherwise this falls outside the scope of Lucene, unless I
misunderstood you.

If I had to give it a long shot though, I'd try to index all the data using
WhitespaceAnalyzer, and then query for "Location". I'd also use the
Highlighter in contrib to find matching segments of text, and take whatever
has come after "Location". You should know though how much to take after
Location ...

Maybe if you post here a sample input, it'll trigger something in me :).

Shai

On Wed, Aug 12, 2009 at 12:27 AM, xs2Abhishek <abhishek@ontinc.com> wrote:

>
> Hi,
>
> I am trying to make a decision on weather or not I can use Lucene for my
> requirements, which mainly include data tagging. I have to be able to parse
> or index a .txt file and then be able to extract text accordingly. For e.g
> if the input document has some text like: "Location: New York" , so for
> this
> input I should be able to extract "New York" if key word Location is
> present. I am trying to learn about Lucene and looked into
> "tokensFromAnalysis(analyzer, text)". But i'm still not sure how I could
> extract data using lucene. Can I use queries to extract this piece of
> information?
>
> Any help on this would be appreciated.
>
> Thanks,
> Abhishek
> --
> View this message in context:
> http://www.nabble.com/How-to-tune-Analyzer-for-Text-Extraction-tp24926082p24926082.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d77f78bbd8d60470e98b55--

From java-user-return-41825-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 09:09:42 2009
Return-Path: <java-user-return-41825-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38380 invoked from network); 12 Aug 2009 09:09:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 09:09:42 -0000
Received: (qmail 59537 invoked by uid 500); 12 Aug 2009 09:09:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59438 invoked by uid 500); 12 Aug 2009 09:09:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59410 invoked by uid 99); 12 Aug 2009 09:09:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 09:09:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.49.14] (HELO web52904.mail.re2.yahoo.com) (206.190.49.14)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 12 Aug 2009 09:09:30 +0000
Received: (qmail 26651 invoked by uid 60001); 12 Aug 2009 09:09:09 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1250068149; bh=wf7gnfFFCaKS2AZSQk9/pSBMADe4dom8Lh9APWdyQ4o=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=z+C1s16kszgvV/bTIugy1pK4BMJ2YyvGZ4Hz3ijHS2xbq/QoD1R+UMHu261D+h/+COj46XxlzB0oOwqIWpssGxunHYErKKTdEzJEo3OcaJD06o4P1S78shKfRK4sRy9fcTaDhfIal+7/8BlRlBaywutmArqn9jAJOS+Kqb6hjWs=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=SCb8MRbJrq1mPNxp7rqxGlHgQ2ujnbolA9xPaAkClgeY+cU3PMwMcha5pXzydlOTfE+MYSHtBpNtbhbIq3SEDl27t/7XpLziJbjiDk/uKIUpm2434Sp54/+R2wVLwRgth7ysX6NoD49cSYqwlq7UZ0i0HjrH6AkzpjTASr64TeQ=;
Message-ID: <711352.25749.qm@web52904.mail.re2.yahoo.com>
X-YMail-OSG: m2ucUo8VM1l0ocfCuXpRLsu.jcMTaMwJ4PTi2T6RBxRlWBJI4PXb29L_ZVqo55R5Ky6vI1ZTt2ydXkOo2Ny7S91FRJmsvrSiFXTpW65kFWYFiWcTzA.dCF.yifiM9n3Akq1WPkqs8.ESvjITgzYSXPMax_80Z88HGPf4qw.88GLOYxAudBQ2kMZQrnQ2Z8EPoPlqaZq4YeLN_5tBY_qH4r.cLqLNh69IuzEusda7XhKde.Lpojcw_Puhs7mH2tVDqpfJpb8GUwfNX838J6Fh35EFHqq0akvDhSYzTFJVVyXpzCuTn5OS1P2R.b.mi6ztMP7oThss5bWo
Received: from [193.140.184.100] by web52904.mail.re2.yahoo.com via HTTP; Wed, 12 Aug 2009 02:09:09 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.2
Date: Wed, 12 Aug 2009 02:09:09 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Query Boosting
To: java-user@lucene.apache.org
In-Reply-To: <24928789.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org


> thanks, I understand how boosting works, what I need will
> be a boost in the query that will increase the score of a page if all
> keywords/query is found in the page to increase its ranking.

You can find answer of your question in the last two messages at this thread:

http://www.nabble.com/Generating-Query-for-Multiple-Clauses-in-a-Single-Field-td24694748.html


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41826-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 09:09:42 2009
Return-Path: <java-user-return-41826-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38390 invoked from network); 12 Aug 2009 09:09:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 09:09:42 -0000
Received: (qmail 59572 invoked by uid 500); 12 Aug 2009 09:09:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59447 invoked by uid 500); 12 Aug 2009 09:09:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59404 invoked by uid 99); 12 Aug 2009 09:09:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 09:09:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 09:09:29 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mb9pV-00031g-07
	for java-user@lucene.apache.org; Wed, 12 Aug 2009 02:09:09 -0700
Message-ID: <24931880.post@talk.nabble.com>
Date: Wed, 12 Aug 2009 02:09:09 -0700 (PDT)
From: bourne71 <garylkc@live.com>
To: java-user@lucene.apache.org
Subject: Generating Query
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: garylkc@live.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I am trying to build a query that looks like the following:
url:(+news +politics)^1.5 content:(+news +politics)^2.0

But I can't seems to find any reference to it. I try hardcoding it like the
following:
BooleanQuery query = new BooleanQuery();
query.add(new TermQuery(new Term(field, "+news +politics")),
BooleanClause.Occur.SHOULD);

But with this, the query doesn't seems to provide any response or effect. By
right its suppose to boost the field of the page that contain both of the
word in it.

Can anyone advise me on how to create this type of query? Thanks
-- 
View this message in context: http://www.nabble.com/Generating-Query-tp24931880p24931880.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41827-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 09:24:30 2009
Return-Path: <java-user-return-41827-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50079 invoked from network); 12 Aug 2009 09:24:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 09:24:30 -0000
Received: (qmail 82444 invoked by uid 500); 12 Aug 2009 09:24:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82350 invoked by uid 500); 12 Aug 2009 09:24:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82340 invoked by uid 99); 12 Aug 2009 09:24:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 09:24:34 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of adrianocrestani@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 09:24:25 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1653297qwh.53
        for <java-user@lucene.apache.org>; Wed, 12 Aug 2009 02:24:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=QWMjOSgGHur91OPNpVN88C1aCZrAtd0TNHRUKzA/NTg=;
        b=LqNasPesiesmW184ec9bA8Wpqmu5sX7D6oTsYbL5/IMV75wUwiWXD6eb5bUBxZZj4M
         fRevkYXtZbANePijDQfL9z9wvecxxDGmgtkswtHCvswktwYs0bMhGWfqlisH1qDq+sLG
         +9i31ObdWxGLqJgbu2ztitQOc+z6lIVpwfW6c=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=XfLPjiHrzHOBCqi5SgqMwSl2+NrZHXfPr8r8lN7zPCF1dvVWYlilqBCNWuUHaBkqg6
         HRtwfESCeIiSHGBIL/LHPfnquyvwG8wEjaRB+Q7yL5okyjg5oCcfevl32gZ26jbCp9bQ
         FyVZcQp+v2hkB2Vt9SW4J2PvFP5LuGqTDtLzM=
MIME-Version: 1.0
Received: by 10.229.53.208 with SMTP id n16mr177397qcg.90.1250069044128; Wed, 
	12 Aug 2009 02:24:04 -0700 (PDT)
In-Reply-To: <24931880.post@talk.nabble.com>
References: <24931880.post@talk.nabble.com>
From: Adriano Crestani <adrianocrestani@gmail.com>
Date: Wed, 12 Aug 2009 02:23:44 -0700
Message-ID: <55e2bf7e0908120223v505f8fd3wd75d77444360d6ac@mail.gmail.com>
Subject: Re: Generating Query
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151774083a5222860470ee61c9
X-Virus-Checked: Checked by ClamAV on apache.org

--00151774083a5222860470ee61c9
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Try this:

     BooleanQuery b1 =  new BooleanQuery();
     b1.add(new TermQuery(new Term("url", "news")),
BooleanClause.Occur.MUST);
     b1.add(new TermQuery(new Term("url", "politics")),
BooleanClause.Occur.MUST);
     b1.setBoost(1.5f);

     BooleanQuery b2 =  new BooleanQuery();
     b2.add(new TermQuery(new Term("content", "news")),
BooleanClause.Occur.MUST);
     b2.add(new TermQuery(new Term("content", "politics")),
BooleanClause.Occur.MUST);
     b2.setBoost(2f);

     BooleanQuery finalQuery =  new BooleanQuery();
     finalQuery.add(b1, BooleanClause.Occur.SHOULD);
     finalQuery.add(b2, BooleanClause.Occur.SHOULD);

     System.out.println(finalQuery.toString());

On Wed, Aug 12, 2009 at 2:09 AM, bourne71 <garylkc@live.com> wrote:

>
> Hi,
>
> I am trying to build a query that looks like the following:
> url:(+news +politics)^1.5 content:(+news +politics)^2.0
>
> But I can't seems to find any reference to it. I try hardcoding it like the
> following:
> BooleanQuery query = new BooleanQuery();
> query.add(new TermQuery(new Term(field, "+news +politics")),
> BooleanClause.Occur.SHOULD);
>
> But with this, the query doesn't seems to provide any response or effect.
> By
> right its suppose to boost the field of the page that contain both of the
> word in it.
>
> Can anyone advise me on how to create this type of query? Thanks
> --
> View this message in context:
> http://www.nabble.com/Generating-Query-tp24931880p24931880.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00151774083a5222860470ee61c9--

From java-user-return-41828-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 09:27:49 2009
Return-Path: <java-user-return-41828-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53714 invoked from network); 12 Aug 2009 09:27:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 09:27:49 -0000
Received: (qmail 89031 invoked by uid 500); 12 Aug 2009 09:27:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88979 invoked by uid 500); 12 Aug 2009 09:27:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88969 invoked by uid 99); 12 Aug 2009 09:27:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 09:27:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.49.22] (HELO web52912.mail.re2.yahoo.com) (206.190.49.22)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 12 Aug 2009 09:27:44 +0000
Received: (qmail 38707 invoked by uid 60001); 12 Aug 2009 09:27:23 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1250069243; bh=OK7UqwBYOyxXwwt0yzfpdesJxrXBS55JZ0h+2OmSbzU=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=owZdAgnU++oVuxSHnXrkDk6/ftkanQIPL50rF0uNs5OBcsqdSarY/7WA2jqFZcEoBFVsK1Y7MyZxOKycz30WsAUzzXDVrZkc5G7J/9uQz12/xPNhk18oiOaiATk/Bu/aav7CwEdSyspWkyS8HIHrg2bxTGr5u8FTPHDVBi5khA0=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=dJg6XaBXNKS5II4MwxrozIj+xc5a9uhfvABp8zSIeTvF45OkLL54LSIekt+i4dvW2Tu5a7ZwgBXSrLX82ZMPoB8nE+R/EclOlwNzvvvqQivaVY56VbQeGTBiyMykW7m/te7O4L/dOyRFVBkCNEIiHruxUK/A+LdCzFCIGU2XdJY=;
Message-ID: <391442.37864.qm@web52912.mail.re2.yahoo.com>
X-YMail-OSG: tzw.FkQVM1kzew5uTSZ7UENtAwa1ZYJvPzVWXSOsIvx85blUlvL85.tAaWdbp18uZyuIZ9fvRDAN24aiSLcv_VFTLe5Fl.vWGXb227nLAzrwzc2BQSLtTRKmOBuopwO7_AtPjP5JfFS_0.ep_Ma21_jv6NEowxHAwZIoTnRbfM7xCKyaaOWEAdjsWX784XwPFKkYhAea703C_rXPew2ApEL78F6s.98MpeaKzOHbeh2kwfXR6AAfK.JvgT8leUERn..ywDk6xN4kootIgVho1LCWlw08wEVj2gR73sDivTXpiv0ywVtND_zDWUeapyvRckxD..o-
Received: from [193.140.184.100] by web52912.mail.re2.yahoo.com via HTTP; Wed, 12 Aug 2009 02:27:23 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.2
Date: Wed, 12 Aug 2009 02:27:23 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Generating Query
To: java-user@lucene.apache.org
In-Reply-To: <24931880.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> I am trying to build a query that looks like the
> following:
> url:(+news +politics)^1.5 content:(+news +politics)^2.0
> 
> But I can't seems to find any reference to it. I try
> hardcoding it like the
> following:
> BooleanQuery query = new BooleanQuery();
> query.add(new TermQuery(new Term(field, "+news
> +politics")),
> BooleanClause.Occur.SHOULD);

Query t1 = new TermQuery(new Term("url", "news"));
Query t2 = new TermQuery(new Term("url", "politics"));

Query t3 = new TermQuery(new Term("content", "news"));
Query t4 = new TermQuery(new Term("content", "politics"));

BooleanQuery b1 = new BooleanQuery();
b1.add(t1, BooleanClause.Occur.MUST);
b1.add(t2, BooleanClause.Occur.MUST);
b1.setBoost(1.5f);

BooleanQuery b2 = new BooleanQuery();
b2.add(t3, BooleanClause.Occur.MUST);
b2.add(t4, BooleanClause.Occur.MUST);
b2.setBoost(2.0f);
        
BooleanQuery finalQuery = new BooleanQuery();
finalQuery.add(b1,BooleanClause.Occur.SHOULD);
finalQuery.add(b2,BooleanClause.Occur.SHOULD); 


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41829-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 09:51:36 2009
Return-Path: <java-user-return-41829-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77573 invoked from network); 12 Aug 2009 09:51:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 09:51:35 -0000
Received: (qmail 20769 invoked by uid 500); 12 Aug 2009 09:51:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20686 invoked by uid 500); 12 Aug 2009 09:51:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20676 invoked by uid 99); 12 Aug 2009 09:51:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 09:51:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aminmc@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 09:51:32 +0000
Received: by ewy26 with SMTP id 26so4684118ewy.5
        for <java-user@lucene.apache.org>; Wed, 12 Aug 2009 02:51:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=uSWe6rS7GohpjLtYvJKTN9c0ZbSVwEkClM0mnZmsNb8=;
        b=sSVOGoCjP/JM40k4Dg3/sA/Pe3HDZLESCcXuvYl9BulQ6qMw+/rBQcxR9hOEBMRwKi
         v3P1+ocOYneY3h9+DnF+PXQTeLwDXFfhSEsnhlaqBuStk8xn6UdIlY2q/Bzoh9FGZ1Bs
         nwlhWY9KAGRZ/bKAPVW/YwK41xRWByeYKhZLA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=CkhrhHOUikK4/9vWhSYfhc/fFanilRgCh65pSBw0AGGpdU1sQL4Vyvnc0xjoyTUPRk
         WvKTg7L7rWepu0zPpMWMHUfAsekxzBwR7RZRmEI2B7uinjxgt9IjxeNRGEBEmzseoYhy
         g/oeSWPpnOz86HWvq0AajMxaMXq9rc4H+NhHA=
MIME-Version: 1.0
Received: by 10.216.86.211 with SMTP id w61mr1528945wee.6.1250070671218; Wed, 
	12 Aug 2009 02:51:11 -0700 (PDT)
In-Reply-To: <6f4104d80908120109i62ccb2e0rcbb74dde3c8184b0@mail.gmail.com>
References: <6f4104d80908120109i62ccb2e0rcbb74dde3c8184b0@mail.gmail.com>
Date: Wed, 12 Aug 2009 10:51:11 +0100
Message-ID: <6f4104d80908120251p2901829fk2bf4152b659fb0a4@mail.gmail.com>
Subject: Fwd: Contribute to Lucene
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d785534d589a0470eec281
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d785534d589a0470eec281
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi

I would like to contribute/help in the development of Lucene and I'm not
sure where to start.  I understand Lucene is a mature project with some
really great contributors and I was wondering whether you can advise me on
where to start.  I would be happy to do any documentation, fix bugs or
anything.

I am currently developing a reference project for using Spring Integration
for Lucene indexing and I have done some other projects one of them being an
Integration between GigaSpaces and Hibernate Search.


Kind Regards

Amin Mohammed-Coleman

--0016e6d785534d589a0470eec281--

From java-user-return-41830-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 11:29:34 2009
Return-Path: <java-user-return-41830-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21395 invoked from network); 12 Aug 2009 11:29:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 11:29:34 -0000
Received: (qmail 57908 invoked by uid 500); 12 Aug 2009 11:29:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57867 invoked by uid 500); 12 Aug 2009 11:29:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57855 invoked by uid 99); 12 Aug 2009 11:29:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 11:29:39 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.207] (HELO spunkymail-a4.g.dreamhost.com) (208.97.132.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 11:29:27 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a4.g.dreamhost.com (Postfix) with ESMTP id 17D3B3B9F1
	for <java-user@lucene.apache.org>; Wed, 12 Aug 2009 04:29:05 -0700 (PDT)
Message-Id: <A93D296C-A577-4F4A-8E09-3B7ED6CD6C71@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <6f4104d80908120251p2901829fk2bf4152b659fb0a4@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Contribute to Lucene
Date: Wed, 12 Aug 2009 07:29:05 -0400
References: <6f4104d80908120109i62ccb2e0rcbb74dde3c8184b0@mail.gmail.com> <6f4104d80908120251p2901829fk2bf4152b659fb0a4@mail.gmail.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


On Aug 12, 2009, at 5:51 AM, Amin Mohammed-Coleman wrote:

> Hi
>
> I would like to contribute/help in the development of Lucene and I'm  
> not
> sure where to start.  I understand Lucene is a mature project with  
> some
> really great contributors and I was wondering whether you can advise  
> me on
> where to start.  I would be happy to do any documentation, fix bugs or
> anything.
>

http://wiki.apache.org/lucene-java/HowToContribute is the best place  
to start.  Usually, I just tell people to scratch their own itches.   
Fix or add to things that you use.  Also, we are nearing 2.9 release,  
so it would
be great to have as many eyeballs as possible on that.  There is a lot  
of new goodness coming in 2.9, so it will be particularly important to  
get good feedback, as this will help set the stage
for us to finally drop JDK 1.4 support as well as add in more flexible  
indexing/search capabilities (new analysis capabilities, etc.)   
Additionally, it has some cool new per segment stuff that should help  
people
with near real time needs have better performance.  Finally, there are  
a few back incompatible changes, so feedback on them would also be  
great.


-Grant

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41831-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 11:32:08 2009
Return-Path: <java-user-return-41831-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21686 invoked from network); 12 Aug 2009 11:32:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 11:32:08 -0000
Received: (qmail 60698 invoked by uid 500); 12 Aug 2009 11:32:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60625 invoked by uid 500); 12 Aug 2009 11:32:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60615 invoked by uid 99); 12 Aug 2009 11:32:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 11:32:13 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.177] (HELO spunkymail-a16.g.dreamhost.com) (208.97.132.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 11:32:02 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a16.g.dreamhost.com (Postfix) with ESMTP id 03DEC7B3EC
	for <java-user@lucene.apache.org>; Wed, 12 Aug 2009 04:31:41 -0700 (PDT)
Message-Id: <AB994912-9439-47A5-9C9B-2EEA045BBA4E@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <24926082.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: How to tune Analyzer for Text Extraction
Date: Wed, 12 Aug 2009 07:31:41 -0400
References: <24926082.post@talk.nabble.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


On Aug 11, 2009, at 5:27 PM, xs2Abhishek wrote:

>
> Hi,
>
> I am trying to make a decision on weather or not I can use Lucene  
> for my
> requirements, which mainly include data tagging. I have to be able  
> to parse
> or index a .txt file and then be able to extract text accordingly.  
> For e.g
> if the input document has some text like: "Location: New York" , so  
> for this
> input I should be able to extract "New York" if key word Location is
> present. I am trying to learn about Lucene and looked into
> "tokensFromAnalysis(analyzer, text)". But i'm still not sure how I  
> could
> extract data using lucene. Can I use queries to extract this piece of
> information?
>

You will likely need to write your own TokenFilter that can do the  
extraction.  It is feasible to plug in something like OpenNLP or other  
extraction toolkits into the Analysis stream and then provide these  
capabilities.  That, combined with the Tee/Sink Tokenizer/TokenFilter  
capabilities can make for some lightweight, but still powerful  
extraction capabilities.  You might also look at UIMA, which is in the  
Apache Incubator.


> Any help on this would be appreciated.
>
> Thanks,
> Abhishek
> -- 
> View this message in context: http://www.nabble.com/How-to-tune-Analyzer-for-Text-Extraction-tp24926082p24926082.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41832-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 12:23:53 2009
Return-Path: <java-user-return-41832-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44986 invoked from network); 12 Aug 2009 12:23:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 12:23:53 -0000
Received: (qmail 49229 invoked by uid 500); 12 Aug 2009 12:23:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49147 invoked by uid 500); 12 Aug 2009 12:23:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49136 invoked by uid 99); 12 Aug 2009 12:23:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 12:23:57 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists.digitalpebble@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 12:23:47 +0000
Received: by bwz10 with SMTP id 10so2580805bwz.5
        for <java-user@lucene.apache.org>; Wed, 12 Aug 2009 05:23:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=x6RNWbnPXgn0HZuSNSLNu9sEeUGkHHddGu5cwE8mnAo=;
        b=vRgyaqKJaT3/uJdxapIr9gtakSDbEzzSUferqGx72nGuPECkruR6PwbbCVoG0dvty7
         SVaS4kn4H1Gb8tG6EkHhslp1GeaTFkZ9z6t6k+nqB2KxX4WBufeKMm8Sz+B2MpKxfUpZ
         1k6m6x/tnctY/wLp0mlpYk7lrRtOGhaAuZQyU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=tAB1uNNg5obYFUiiPLKAzAX3Zjb75y4JgNOoKflFNHH14f/O0kTOt3ao2A0tIbgYGW
         PU0OTlXLTMkxOvk2ljpR6Ux9tVDXuPlbn648ORxNIrhjB0Hdjtot/nQNOeycYjacspZi
         EcFOUV6CrFtP9vzGRfBcdHmA4j2C4DuRZcCEk=
MIME-Version: 1.0
Received: by 10.239.141.159 with SMTP id c31mr2511hba.147.1250079803843; Wed, 
	12 Aug 2009 05:23:23 -0700 (PDT)
In-Reply-To: <24926082.post@talk.nabble.com>
References: <24926082.post@talk.nabble.com>
Date: Wed, 12 Aug 2009 13:23:23 +0100
Message-ID: <16d405e0908120523p6057c6afuda4b24f0194ecda3@mail.gmail.com>
Subject: Re: How to tune Analyzer for Text Extraction
From: Julien Nioche <lists.digitalpebble@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f6c75aa625800470f0e2eb
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f6c75aa625800470f0e2eb
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

you should also have a look at GATE (http://gate.ac.uk) which comes with a
NER application called ANNIE. You could use it to analyse your docs before
indexing them with Lucene or SOLR.

As Grant mentioned, UIMA can also be used for that as there are a number of
NER annotators available for it (OpenCalais, Stanford NER)

Julien

-- 
DigitalPebble Ltd
http://www.digitalpebble.com

2009/8/11 xs2Abhishek <abhishek@ontinc.com>

>
> Hi,
>
> I am trying to make a decision on weather or not I can use Lucene for my
> requirements, which mainly include data tagging. I have to be able to parse
> or index a .txt file and then be able to extract text accordingly. For e.g
> if the input document has some text like: "Location: New York" , so for
> this
> input I should be able to extract "New York" if key word Location is
> present. I am trying to learn about Lucene and looked into
> "tokensFromAnalysis(analyzer, text)". But i'm still not sure how I could
> extract data using lucene. Can I use queries to extract this piece of
> information?
>
> Any help on this would be appreciated.
>
> Thanks,
> Abhishek
> --
> View this message in context:
> http://www.nabble.com/How-to-tune-Analyzer-for-Text-Extraction-tp24926082p24926082.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001485f6c75aa625800470f0e2eb--

From java-user-return-41833-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 13:59:23 2009
Return-Path: <java-user-return-41833-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94879 invoked from network); 12 Aug 2009 13:59:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 13:59:22 -0000
Received: (qmail 12405 invoked by uid 500); 12 Aug 2009 13:59:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12236 invoked by uid 500); 12 Aug 2009 13:59:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12182 invoked by uid 99); 12 Aug 2009 13:59:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 13:59:21 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.119] (HELO spunkymail-a4.g.dreamhost.com) (208.97.132.119)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 13:59:08 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a4.g.dreamhost.com (Postfix) with ESMTP id 50CC63B9FF;
	Wed, 12 Aug 2009 06:58:45 -0700 (PDT)
Message-Id: <C7696030-4454-405A-B5EA-49DDCCC3DE30@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: general@lucene.apache.org, solr-user@lucene.apache.org,
	nutch-user@lucene.apache.org, mahout-user@lucene.apache.org,
	java-user@lucene.apache.org, tika-user@lucene.apache.org,
	openrelevance-user@lucene.apache.org, droids-dev@incubator.apache.org
Content-Type: multipart/alternative; boundary=Apple-Mail-332--952098535
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Fwd: Sign up for ApacheCon US by 14 August and save up to $500!
Date: Wed, 12 Aug 2009 09:58:44 -0400
References: <195427.8837.qm@web30801.mail.mud.yahoo.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail-332--952098535
Content-Type: text/plain;
	charset=US-ASCII;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: 7bit

Forwarding the ApacheCon announcement.  Also note we have a lot of  
Lucene ecosystem talks and a meetup scheduled, as well as training on  
both Lucene and Solr, so I hope you will join us.

Cheers,
Grant

Begin forwarded message:

> From: Sally Khudairi <sk@apache.org>
> Date: August 7, 2009 9:55:10 PM EDT
> To: announce@apache.org, announce@apachecon.com
> Subject: Sign up for ApacheCon US by 14 August and save up to $500!
> Reply-To: planners-2009-us@apachecon.com
> Reply-To: sk@apache.org
>
>
> Sign up for ApacheCon US by 14 August and save up to $500!
>
> This year's ApacheCon US promises to deliver our most extensive  
> program to date, and largest anticipated gathering of the global  
> Apache community to celebrate the ASF's milestone 10th Anniversary.  
> The San Francisco Bay Area is where the very first ASF official user  
> conference was held, and we hope that you will join us in  
> celebrating the ASF's success!
>
> Apache members, code contributors, users, developers, system  
> administrators, business managers, service providers, and vendors  
> will convene 2-6 November in Oakland, California, for a week of  
> training, presentations, sharing and hacking. ApacheCon US 2009  
> features new content tracks, MeetUps, and GetTogethers, as well as a  
> number of events open to the public free of charge, such as the  
> Hackathon and 2-day BarCampApache, in appreciation of their support  
> over the past decade.
>
> Be sure to register by 14 August to save up to $500! To sign up,  
> visit http://www.us.apachecon.com/
>
> Those wishing to attend ApacheCon, but may be unable to do so due to  
> financial reasons are encouraged to apply for Travel Assistance by  
> completing the form at http://www.apache.org/travel/ Financial  
> support for flights, accommodation, subsistence, and conference fees  
> are availablAnyone involved in Open Source is welcome to apply for  
> financial support for flights, accommodation, subsistence and  
> Conference fees. Hurry, applications close on 17 August.
>
> Conference sponsor, exhibitor, and community partnerships are also  
> available: please contact Delia Frees at delia@apachecon.com for  
> details.
>
> # # #
>
>
>


--Apple-Mail-332--952098535--

From java-user-return-41834-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 15:23:07 2009
Return-Path: <java-user-return-41834-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37227 invoked from network); 12 Aug 2009 15:23:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 15:23:07 -0000
Received: (qmail 14971 invoked by uid 500); 12 Aug 2009 15:23:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14892 invoked by uid 500); 12 Aug 2009 15:23:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14860 invoked by uid 99); 12 Aug 2009 15:23:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 15:23:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 15:22:59 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbFew-0001Hl-PW
	for java-user@lucene.apache.org; Wed, 12 Aug 2009 08:22:38 -0700
Message-ID: <24938899.post@talk.nabble.com>
Date: Wed, 12 Aug 2009 08:22:38 -0700 (PDT)
From: xs2Abhishek <abhishek@ontinc.com>
To: java-user@lucene.apache.org
Subject: Re: How to tune Analyzer for Text Extraction
In-Reply-To: <16d405e0908120523p6057c6afuda4b24f0194ecda3@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: abhishek@ontinc.com
References: <24926082.post@talk.nabble.com> <16d405e0908120523p6057c6afuda4b24f0194ecda3@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

Thanks for your replies, it really helped me a lot.

Thanks&Regards,
Abhishek

-- 
View this message in context: http://www.nabble.com/How-to-tune-Analyzer-for-Text-Extraction-tp24926082p24938899.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41835-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 19:33:57 2009
Return-Path: <java-user-return-41835-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56256 invoked from network); 12 Aug 2009 19:33:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 19:33:57 -0000
Received: (qmail 73171 invoked by uid 500); 12 Aug 2009 19:34:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73107 invoked by uid 500); 12 Aug 2009 19:34:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73097 invoked by uid 99); 12 Aug 2009 19:34:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 19:34:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 19:33:52 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbJZk-0002vm-01
	for java-user@lucene.apache.org; Wed, 12 Aug 2009 12:33:32 -0700
Message-ID: <24943133.post@talk.nabble.com>
Date: Wed, 12 Aug 2009 12:33:31 -0700 (PDT)
From: xs2Abhishek <abhishek@ontinc.com>
To: java-user@lucene.apache.org
Subject: Re: How to tune Analyzer for Text Extraction
In-Reply-To: <786fde50908112038j74e8289aif816af3a2d064c75@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: abhishek@ontinc.com
References: <24926082.post@talk.nabble.com> <786fde50908112038j74e8289aif816af3a2d064c75@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

Well you completely understood my problem:wistle:, the point you mentioned
about how much to extract after the word Location is something i'll have to
figure out. So lets say that the input to my system would be:-
"
Location : Montvale, NJ 
Duration : 7 months
"
Now the problem is when the input changes to :-
"
located in Montvale,NJ... For a duration of 7 months
"

After reading about Lucene and some other API's like GATE as replied to this
post, i'd like to know that weather this kind of extraction is possible by
Lucene or not?
Ques2) I have been reading some documentation of Lucene but I could not
figure out a way to extract data from index. For e.g Lets say that I
successfully found the word "location" in an indexed document, but how can I
extract next 15 characters or some text after the word "location".

Thanks & Regards,
Abhishek
-- 
View this message in context: http://www.nabble.com/How-to-tune-Analyzer-for-Text-Extraction-tp24926082p24943133.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41836-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 20:01:51 2009
Return-Path: <java-user-return-41836-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65659 invoked from network); 12 Aug 2009 20:01:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 20:01:51 -0000
Received: (qmail 93150 invoked by uid 500); 12 Aug 2009 19:47:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93123 invoked by uid 500); 12 Aug 2009 19:47:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93113 invoked by uid 99); 12 Aug 2009 19:47:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 19:47:11 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of christian.bongiorno@gmail.com designates 209.85.211.179 as permitted sender)
Received: from [209.85.211.179] (HELO mail-yw0-f179.google.com) (209.85.211.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 19:47:02 +0000
Received: by ywh9 with SMTP id 9so2203ywh.29
        for <java-user@lucene.apache.org>; Wed, 12 Aug 2009 12:46:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        bh=ppw24PQpNvjW6mWZ6uIwfBx6L6RgJbZ1XMMrM68hdQo=;
        b=CEQrPBSIsXTHdthlbojSO5N1/GtO6FPHVMV78zTQr0Vh5GBk+3k2RiReIJvXGZ59cm
         UWSWAVgmNw8hxFu0nlYc/nScz7Al8FPHiHrOtRG51tlFrCklKgiTgNspueSxXGC7lo5k
         Vix1UWdHtpY+DFmv6kucgSBbG6TRwUdyN/rbk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:date:x-google-sender-auth:message-id:subject
         :from:to:content-type;
        b=vhi2giTJViUTfdsLH6xpFT/kMpBOPMApoy+d/84RgMyOz2n9VO2+uyXAYzlSHBlTem
         VVdL8uJvrfY4iPTH4iy36Lq0gjwUySxqfSGujqLD12TTLJngcufXd8jX+WBvXr65jX3g
         faTzNLTSFuTtpiv0eTUA7WNVruG03Lc5KCwOE=
MIME-Version: 1.0
Sender: christian.bongiorno@gmail.com
Received: by 10.91.134.17 with SMTP id l17mr224956agn.94.1250106400020; Wed, 
	12 Aug 2009 12:46:40 -0700 (PDT)
Date: Wed, 12 Aug 2009 12:46:39 -0700
X-Google-Sender-Auth: 385ccf920a96f6ad
Message-ID: <11a518030908121246i2657ca68sb25e438015436fe9@mail.gmail.com>
Subject: term query boost problem
From: Christian Bongiorno <christian@bongiorno.org>
To: java-user <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=0016e6878a64e79a3c0470f713e0
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6878a64e79a3c0470f713e0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I have a situation where I have a series of terms queries as part of a
BooleanQuery.

example:

term: 'sole type' -> leather
  BooleanClause.SHOULD_OCCURR
term: 'title' -> 'Men's Golf shoes'
  BooleanClause.SHOULD_OCCURR
...

But, some terms are incredibly powerful indicators of match
term: 'band type' -> 'gold'

Normally, I would set this as a field boost in the query. Problem is, it
isn't producing ANY changes even when I set the boost score absurdly high. I
have also tried to set the BooleanClause.MUST on my really important term
and I get no results at all.

I tried a simple TermQuery for that (no clause) and got no results. Below is
a code snippet. I checked through the recent archives discussing field
boosts and I am pretty confident I am doing it right. So, now I am presuming
it's a problem with my query.

    private Query buildQuery(Map<String, String> CatalogInfo) {
        if (CatalogInfo != null && CatalogInfo.size() > 0) {
            BooleanQuery booleanQuery = new BooleanQuery();
            for (Map.Entry<String, String> attributeValue :
CatalogInfo.entrySet()) {
                String attributeName = attributeValue.getKey();
                String[] attributeValues;
                if (attributeValue.getValue().indexOf(VALUES_DELIMITER) ==
-1) {
                    attributeValues = new String[]
{attributeValue.getValue()};
                } else {
                    attributeValues =
attributeValue.getValue().split(VALUES_DELIMITER);
                }
                for (String attributeValue : attributeValues) {
                    String escapedValue =
QueryParser.escape(attributeValue).trim();
                    TermQuery termQuery = new TermQuery(new
Term(attributeName, escapedValue));


                    Float boostNumber = _boostMap.get(attributeName); //
this is where 'band type' gets it's boost
                    if (boostNumber != null) {
                        LOG.warn("Boost value found: " + boostNumber);
                        termQuery.setBoost(boostNumber);
                    }
                    booleanQuery.add(termQuery, BooleanClause.Occur.SHOULD);
                }
            }
            LOG.warn("Boolean query: " + booleanQuery.toString());
            return booleanQuery;
        }
        return null;
    }
-- 
Christian Bongiorno

--0016e6878a64e79a3c0470f713e0--

From java-user-return-41837-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 21:29:07 2009
Return-Path: <java-user-return-41837-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7111 invoked from network); 12 Aug 2009 21:29:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 21:29:07 -0000
Received: (qmail 43614 invoked by uid 500); 12 Aug 2009 21:29:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43516 invoked by uid 500); 12 Aug 2009 21:29:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43503 invoked by uid 99); 12 Aug 2009 21:29:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 21:29:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 21:29:03 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 4F89971C21C; Wed, 12 Aug 2009 14:28:42 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 4C11171C15F
	for <java-user@lucene.apache.org>; Wed, 12 Aug 2009 14:28:42 -0700 (PDT)
Date: Wed, 12 Aug 2009 14:28:42 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Contribute to Lucene
In-Reply-To: <A93D296C-A577-4F4A-8E09-3B7ED6CD6C71@apache.org>
Message-ID: <Pine.LNX.4.64.0908121427290.28276@radix.cryptio.net>
References: <6f4104d80908120109i62ccb2e0rcbb74dde3c8184b0@mail.gmail.com>
 <6f4104d80908120251p2901829fk2bf4152b659fb0a4@mail.gmail.com>
 <A93D296C-A577-4F4A-8E09-3B7ED6CD6C71@apache.org>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: that you use.  Also, we are nearing 2.9 release, so it would
: be great to have as many eyeballs as possible on that.  There is a lot of new
: goodness coming in 2.9, so it will be particularly important to get good
: feedback, as this will help set the stage

...even for people that might be really unfamiliar with the Lucene 
internals, skimming the CHANGES.txt and then looking at the corrisponding 
javadocs to find any missing/confusing javadocs would be really helpful.

And of course: we can always use more test cases.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41838-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 21:55:57 2009
Return-Path: <java-user-return-41838-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22405 invoked from network); 12 Aug 2009 21:55:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 21:55:57 -0000
Received: (qmail 77906 invoked by uid 500); 12 Aug 2009 21:56:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77812 invoked by uid 500); 12 Aug 2009 21:56:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77802 invoked by uid 99); 12 Aug 2009 21:56:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 21:56:02 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.74] (HELO spunkymail-a14.g.dreamhost.com) (208.97.132.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 21:55:50 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a14.g.dreamhost.com (Postfix) with ESMTP id 1DC891954CB
	for <java-user@lucene.apache.org>; Wed, 12 Aug 2009 14:55:28 -0700 (PDT)
Message-Id: <60C77AC9-434C-4E78-B54C-C74EFDFA54B3@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <11a518030908121246i2657ca68sb25e438015436fe9@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: term query boost problem
Date: Wed, 12 Aug 2009 17:55:27 -0400
References: <11a518030908121246i2657ca68sb25e438015436fe9@mail.gmail.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

You have a bunch of log statements in there, what are they printing out?

Also, IndexSearcher.explain() is your friend for understanding why a  
doc matched the way it did.


On Aug 12, 2009, at 3:46 PM, Christian Bongiorno wrote:

> I have a situation where I have a series of terms queries as part of a
> BooleanQuery.
>
> example:
>
> term: 'sole type' -> leather
>  BooleanClause.SHOULD_OCCURR
> term: 'title' -> 'Men's Golf shoes'
>  BooleanClause.SHOULD_OCCURR
> ...
>
> But, some terms are incredibly powerful indicators of match
> term: 'band type' -> 'gold'
>
> Normally, I would set this as a field boost in the query. Problem  
> is, it
> isn't producing ANY changes even when I set the boost score absurdly  
> high. I
> have also tried to set the BooleanClause.MUST on my really important  
> term
> and I get no results at all.
>
> I tried a simple TermQuery for that (no clause) and got no results.  
> Below is
> a code snippet. I checked through the recent archives discussing field
> boosts and I am pretty confident I am doing it right. So, now I am  
> presuming
> it's a problem with my query.
>
>    private Query buildQuery(Map<String, String> CatalogInfo) {
>        if (CatalogInfo != null && CatalogInfo.size() > 0) {
>            BooleanQuery booleanQuery = new BooleanQuery();
>            for (Map.Entry<String, String> attributeValue :
> CatalogInfo.entrySet()) {
>                String attributeName = attributeValue.getKey();
>                String[] attributeValues;
>                if  
> (attributeValue.getValue().indexOf(VALUES_DELIMITER) ==
> -1) {
>                    attributeValues = new String[]
> {attributeValue.getValue()};
>                } else {
>                    attributeValues =
> attributeValue.getValue().split(VALUES_DELIMITER);
>                }
>                for (String attributeValue : attributeValues) {
>                    String escapedValue =
> QueryParser.escape(attributeValue).trim();
>                    TermQuery termQuery = new TermQuery(new
> Term(attributeName, escapedValue));
>
>
>                    Float boostNumber =  
> _boostMap.get(attributeName); //
> this is where 'band type' gets it's boost
>                    if (boostNumber != null) {
>                        LOG.warn("Boost value found: " + boostNumber);
>                        termQuery.setBoost(boostNumber);
>                    }
>                    booleanQuery.add(termQuery,  
> BooleanClause.Occur.SHOULD);
>                }
>            }
>            LOG.warn("Boolean query: " + booleanQuery.toString());
>            return booleanQuery;
>        }
>        return null;
>    }
> -- 
> Christian Bongiorno

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41839-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 12 22:52:57 2009
Return-Path: <java-user-return-41839-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54350 invoked from network); 12 Aug 2009 22:52:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Aug 2009 22:52:57 -0000
Received: (qmail 46459 invoked by uid 500); 12 Aug 2009 22:53:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46390 invoked by uid 500); 12 Aug 2009 22:53:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46380 invoked by uid 99); 12 Aug 2009 22:53:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 22:53:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.221.203 as permitted sender)
Received: from [209.85.221.203] (HELO mail-qy0-f203.google.com) (209.85.221.203)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Aug 2009 22:52:53 +0000
Received: by qyk41 with SMTP id 41so345246qyk.29
        for <java-user@lucene.apache.org>; Wed, 12 Aug 2009 15:52:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=+H9HgX+V9ggQwZBwjy4s5WVcLUSRCiB2qBTl5wiOylY=;
        b=wSzCMBS0oR+My7wnEVJHy2r0Weo7TzMpSJmTjK4HHLTwbh0mmIt+DetQfq2NXulLqr
         r8vwlC0Es3l57Ii7U3ShQq7gifchkxJ5D3V58Ip+7QexVJ5Tkh0zkGiIVL4cbax0s+Jl
         VloIhpwFA7cIXKn6zwXA4iqpMRPDHBbpUg7eg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=jI+yWtVZD2PjZUheX6XNMhVfQYolThD3/tYVo0R6WA9dWK+UKBclnD8fzIxtwZCzhJ
         jzLD0XDdy6U9TNPTw1kyScNXRsWeU2h1+DWK/UEz2VfjNI/HMKSYgswOimowWP8tgUq+
         UNK67bWZcfDDE1nyAQPrOc357/LXRlre0WY4I=
MIME-Version: 1.0
Received: by 10.224.109.83 with SMTP id i19mr706696qap.309.1250117551486; Wed, 
	12 Aug 2009 15:52:31 -0700 (PDT)
Date: Wed, 12 Aug 2009 15:52:31 -0700
Message-ID: <85d3c3b60908121552h1ad18f45ya6129ebdbbfd114a@mail.gmail.com>
Subject: Complexity of PhraseQuery slop?
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

In trying to calculate the cost of various slop settings for phrase
queries, what's the time complexity?  O(n) or O(n^2)?

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41840-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 02:11:45 2009
Return-Path: <java-user-return-41840-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5993 invoked from network); 13 Aug 2009 02:11:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 02:11:45 -0000
Received: (qmail 2590 invoked by uid 500); 13 Aug 2009 02:11:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2528 invoked by uid 500); 13 Aug 2009 02:11:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2518 invoked by uid 99); 13 Aug 2009 02:11:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 02:11:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 02:11:39 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbPmg-0005jz-DF
	for java-user@lucene.apache.org; Wed, 12 Aug 2009 19:11:18 -0700
Message-ID: <24943981.post@talk.nabble.com>
Date: Wed, 12 Aug 2009 19:11:18 -0700 (PDT)
From: bourne71 <garylkc@live.com>
To: java-user@lucene.apache.org
Subject: Re: Generating Query
In-Reply-To: <391442.37864.qm@web52912.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: garylkc@live.com
References: <24931880.post@talk.nabble.com> <391442.37864.qm@web52912.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org


thanks for the suggestion, but unfortunately it does not work ><


Ahmet Arslan wrote:
> 
>> I am trying to build a query that looks like the
>> following:
>> url:(+news +politics)^1.5 content:(+news +politics)^2.0
>> 
>> But I can't seems to find any reference to it. I try
>> hardcoding it like the
>> following:
>> BooleanQuery query = new BooleanQuery();
>> query.add(new TermQuery(new Term(field, "+news
>> +politics")),
>> BooleanClause.Occur.SHOULD);
> 
> Query t1 = new TermQuery(new Term("url", "news"));
> Query t2 = new TermQuery(new Term("url", "politics"));
> 
> Query t3 = new TermQuery(new Term("content", "news"));
> Query t4 = new TermQuery(new Term("content", "politics"));
> 
> BooleanQuery b1 = new BooleanQuery();
> b1.add(t1, BooleanClause.Occur.MUST);
> b1.add(t2, BooleanClause.Occur.MUST);
> b1.setBoost(1.5f);
> 
> BooleanQuery b2 = new BooleanQuery();
> b2.add(t3, BooleanClause.Occur.MUST);
> b2.add(t4, BooleanClause.Occur.MUST);
> b2.setBoost(2.0f);
>         
> BooleanQuery finalQuery = new BooleanQuery();
> finalQuery.add(b1,BooleanClause.Occur.SHOULD);
> finalQuery.add(b2,BooleanClause.Occur.SHOULD); 
> 
> 
>       
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Generating-Query-tp24931880p24943981.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41841-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 04:11:17 2009
Return-Path: <java-user-return-41841-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31615 invoked from network); 13 Aug 2009 04:11:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 04:11:17 -0000
Received: (qmail 78998 invoked by uid 500); 13 Aug 2009 04:11:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78914 invoked by uid 500); 13 Aug 2009 04:11:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78904 invoked by uid 99); 13 Aug 2009 04:11:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 04:11:21 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of christian.bongiorno@gmail.com designates 209.85.211.200 as permitted sender)
Received: from [209.85.211.200] (HELO mail-yw0-f200.google.com) (209.85.211.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 04:11:11 +0000
Received: by ywh38 with SMTP id 38so682777ywh.20
        for <java-user@lucene.apache.org>; Wed, 12 Aug 2009 21:10:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:in-reply-to
         :references:date:x-google-sender-auth:message-id:subject:from:to
         :content-type;
        bh=oF41hds9tQRwU4aTagl1fB8y0+yW8UC7rpzv04vtaiE=;
        b=rTUXdvkIlwIq/5dId81QEWzUo9A3tzqHvw5bpNQQiZeTYO3r/h0VIWlCzrNgPB1sXD
         zlBRO7n/EcK7/QSRM06Mxxtad7vEb8xIkMs9aTCKrGBtb17wy2uEIFJ3xEH7DbasOejK
         PgyZYO+NXcogRgCRo3Nv8OMX+bIvvgUwOovbQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        b=hG7tfTctrSXq26Rxiwb8ex9vI8P81/+AJDzmFANUjhdxcfSK2oERHB/J3A4P208stN
         lb6CrdOlmg8l4tGx6bocfMLdEVAkild8x70irD2izcbT0J2xv7qwkZnvoxx+iceqKCJo
         0IX+t5agSnhFhhg930l7p0UXf5ZTk9WeBul4M=
MIME-Version: 1.0
Sender: christian.bongiorno@gmail.com
Received: by 10.91.186.12 with SMTP id n12mr399986agp.120.1250136650645; Wed, 
	12 Aug 2009 21:10:50 -0700 (PDT)
In-Reply-To: <11a518030908121246i2657ca68sb25e438015436fe9@mail.gmail.com>
References: <11a518030908121246i2657ca68sb25e438015436fe9@mail.gmail.com>
Date: Wed, 12 Aug 2009 21:10:50 -0700
X-Google-Sender-Auth: cd5040589e16b6c8
Message-ID: <11a518030908122110t3861ecf9vd89403905426a998@mail.gmail.com>
Subject: Re: term query boost problem
From: Christian Bongiorno <christian@bongiorno.org>
To: java-user <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=0016e646089efb82e10470fe1e2c
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e646089efb82e10470fe1e2c
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

turns out the index is being built with lower-case terms which is why we
aren't getting hits the way we expect. When I change my search terms to
lower I see more of what I expect.

Gonna keep working on this and post updates.

On Wed, Aug 12, 2009 at 12:46 PM, Christian Bongiorno <
christian@bongiorno.org> wrote:

> I have a situation where I have a series of terms queries as part of a
> BooleanQuery.
>
> example:
>
> term: 'sole type' -> leather
>   BooleanClause.SHOULD_OCCURR
> term: 'title' -> 'Men's Golf shoes'
>   BooleanClause.SHOULD_OCCURR
> ...
>
> But, some terms are incredibly powerful indicators of match
> term: 'band type' -> 'gold'
>
> Normally, I would set this as a field boost in the query. Problem is, it
> isn't producing ANY changes even when I set the boost score absurdly high. I
> have also tried to set the BooleanClause.MUST on my really important term
> and I get no results at all.
>
> I tried a simple TermQuery for that (no clause) and got no results. Below
> is a code snippet. I checked through the recent archives discussing field
> boosts and I am pretty confident I am doing it right. So, now I am presuming
> it's a problem with my query.
>
>     private Query buildQuery(Map<String, String> CatalogInfo) {
>         if (CatalogInfo != null && CatalogInfo.size() > 0) {
>             BooleanQuery booleanQuery = new BooleanQuery();
>             for (Map.Entry<String, String> attributeValue :
> CatalogInfo.entrySet()) {
>                 String attributeName = attributeValue.getKey();
>                 String[] attributeValues;
>                 if (attributeValue.getValue().indexOf(VALUES_DELIMITER) ==
> -1) {
>                     attributeValues = new String[]
> {attributeValue.getValue()};
>                 } else {
>                     attributeValues =
> attributeValue.getValue().split(VALUES_DELIMITER);
>                 }
>                 for (String attributeValue : attributeValues) {
>                     String escapedValue =
> QueryParser.escape(attributeValue).trim();
>                     TermQuery termQuery = new TermQuery(new
> Term(attributeName, escapedValue));
>
>
>                     Float boostNumber = _boostMap.get(attributeName); //
> this is where 'band type' gets it's boost
>                     if (boostNumber != null) {
>                         LOG.warn("Boost value found: " + boostNumber);
>                         termQuery.setBoost(boostNumber);
>                     }
>                     booleanQuery.add(termQuery,
> BooleanClause.Occur.SHOULD);
>                 }
>             }
>             LOG.warn("Boolean query: " + booleanQuery.toString());
>             return booleanQuery;
>         }
>         return null;
>     }
> --
> Christian Bongiorno
>
>


-- 
Christian Bongiorno

--0016e646089efb82e10470fe1e2c--

From java-user-return-41842-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 04:43:27 2009
Return-Path: <java-user-return-41842-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35250 invoked from network); 13 Aug 2009 04:43:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 04:43:27 -0000
Received: (qmail 99146 invoked by uid 500); 13 Aug 2009 04:43:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99056 invoked by uid 500); 13 Aug 2009 04:43:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99046 invoked by uid 99); 13 Aug 2009 04:43:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 04:43:32 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of anshumg@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 04:43:23 +0000
Received: by fxm2 with SMTP id 2so410514fxm.28
        for <java-user@lucene.apache.org>; Wed, 12 Aug 2009 21:43:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=Ej9aGi2sC1MHEWydnEZfRCVa/XVZch7yqyw8DCEIFcA=;
        b=WydVrW1eqRQ6ULehho10/MccqWWl1enPxzVKGxkEUHkuGujtd8j+myt9RREcRIGLc6
         xVZg2cDk83ChNQLYVHs2SVsPc0EQ1RjTLxL/e5pioJzvT81zQCzf36g954jSbd+/W4CJ
         xufEJVenWCNfhoni/NusJz/4bDC0s/m8GiT84=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=NpsNYOOA0mvWTbd/SkuF2iMEbmePYGlDviM7yQtRWyQjvo+JFsCFGB1eNP/Ty7/6Zr
         QDyZPXfVTbhE4YQCpYUak5/MMCw8b3QPuK2C/LpazzEf06rD2n0Shg8tyaxth7kaSYZT
         TlYdJs/+VkLmcQtVwZFsUMODFsY1IKehPVKQk=
MIME-Version: 1.0
Received: by 10.223.103.83 with SMTP id j19mr189233fao.29.1250138582925; Wed, 
	12 Aug 2009 21:43:02 -0700 (PDT)
Date: Thu, 13 Aug 2009 10:13:02 +0530
Message-ID: <867513fe0908122143g5139355duc47134a13d5406fa@mail.gmail.com>
Subject: Lucene Vs Sphinx benchmarking for large dataset
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c5a51b27c1490470fe92ac
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5a51b27c1490470fe92ac
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I just happened to benchmark a little modified version of lucene with a
little modified version of sphinx :)
Have posted my results here
http://ai-cafe.blogspot.com
Would also be updating more @ the blog in a while!

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............

--001636c5a51b27c1490470fe92ac--

From java-user-return-41843-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 06:52:58 2009
Return-Path: <java-user-return-41843-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83121 invoked from network); 13 Aug 2009 06:52:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 06:52:58 -0000
Received: (qmail 4476 invoked by uid 500); 13 Aug 2009 06:53:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4398 invoked by uid 500); 13 Aug 2009 06:53:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4388 invoked by uid 99); 13 Aug 2009 06:53:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 06:53:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.49.16] (HELO web52906.mail.re2.yahoo.com) (206.190.49.16)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 13 Aug 2009 06:52:53 +0000
Received: (qmail 24253 invoked by uid 60001); 13 Aug 2009 06:52:31 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1250146351; bh=FII8ZKGAHduLGBcFwP5EPFH9xQIoGw2yT3JkBWJoQmY=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=N5bDES+SC7tH7wpy3AkyFRz+u5lftrxCcmVFwsS0DJQ+0DrqUuNT5BcQM/rQTLnPbzs86VIxHZq/Vgpt5QAIRxyEamFAAkVRXtJU3uonDYiW2ZibE/jwjEeutYR0SQjWCkHthI37s7whaOqtXkqPYyqIJEsId6Qy2/6Z7OfSkxY=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=eI7Qt5kq0akfCmb+4JITgVSvlv96oOP/AAwRoBVctYKVVFvDjRrVJC6cgJjZ4rEpR3VC0tfIxXAdTdJCk1HtwWprLm77yM1gYUKtR2kFc4cIQ3oss/iJWDYlDajJtlUd1coWrhztbd8kOmFDePXpdLFKcksDf2g/bcbnhgHBSls=;
Message-ID: <340389.23662.qm@web52906.mail.re2.yahoo.com>
X-YMail-OSG: BkcBJsgVM1meABMVuT556DphYbyACmZnqykFk2YglV9RGeasnzH0Sj02tyWAmBNpdrd67jq9jaG4ieckPqV3CsUbuj9ThepPJez_dJSOkkQ2SPYbF6kc8HVrkGYT8XY4QsqHZAD27HXPnZsTr9HQQmj3mZpF.yamwC_2F7Yc1AuZRxTqIhOb229wznzX47f5Soizo8nEBBWjxoNoL4ORI86_ZXm5FAKPY8x6K_BUYMRg_lJCQRGgrimBDZHkhqV4aQ_Oclr2Rx4uN..dqSUao3xYgo0NlynhtfzouosLKgo-
Received: from [193.140.184.100] by web52906.mail.re2.yahoo.com via HTTP; Wed, 12 Aug 2009 23:52:31 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.2
Date: Wed, 12 Aug 2009 23:52:31 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Generating Query
To: java-user@lucene.apache.org
In-Reply-To: <24943981.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> thanks for the suggestion, but unfortunately it does not
> work.

What are you trying to do? Both Adriano's and my query satisfies what you were asking for. What didn't work?


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41844-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 07:09:53 2009
Return-Path: <java-user-return-41844-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86632 invoked from network); 13 Aug 2009 07:09:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 07:09:53 -0000
Received: (qmail 24180 invoked by uid 500); 13 Aug 2009 07:09:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24098 invoked by uid 500); 13 Aug 2009 07:09:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24088 invoked by uid 99); 13 Aug 2009 07:09:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 07:09:57 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aminmc@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 07:09:49 +0000
Received: by ey-out-2122.google.com with SMTP id 9so92613eyd.53
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 00:09:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=cbWyb2tq67jRTil8XiU7XNHEh/mtdZXJmgxlDFGyYGI=;
        b=o4hRy1EBLwjxlmigFb7aUIi5l+QER+1I0PS2+07/UQG1F9//yUBTaeqD+Gri0Asz3j
         ANXKiZ4H0KM/uZqWiPYYxnvUTIcRx8TRbf6UrI6VmEzAh6Umf7kQnSIRk7nWq+QLjXc+
         vp0ZIdCNCk1Sm+J0YAu1Q8LDJcJKLMOKfozIE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=pNNQd2WsH5cAAFlxirCwEBkPqLu4UKpa/G8TmPEbW4tLOUf9fWzb5maD/5IA+SVAow
         gU0K/mTsD6L47WXrC6/whJRAQWFhkwpRYVO9RBkKE+7LOa97HA6GNcNOT/GvRneictEO
         EGhUjpBUEl5RtONnmwhx5yKh1L9zRni/nsBSg=
MIME-Version: 1.0
Received: by 10.216.86.204 with SMTP id w54mr151477wee.54.1250147368164; Thu, 
	13 Aug 2009 00:09:28 -0700 (PDT)
In-Reply-To: <Pine.LNX.4.64.0908121427290.28276@radix.cryptio.net>
References: <6f4104d80908120109i62ccb2e0rcbb74dde3c8184b0@mail.gmail.com>
	 <6f4104d80908120251p2901829fk2bf4152b659fb0a4@mail.gmail.com>
	 <A93D296C-A577-4F4A-8E09-3B7ED6CD6C71@apache.org>
	 <Pine.LNX.4.64.0908121427290.28276@radix.cryptio.net>
Date: Thu, 13 Aug 2009 08:09:27 +0100
Message-ID: <6f4104d80908130009j4bea60e9qca7f5012fb153d86@mail.gmail.com>
Subject: Re: Contribute to Lucene
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d999e1cbe8270471009d65
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d999e1cbe8270471009d65
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks for your replies. I have checked out trunk and have started looking
at what I can do.  Any more suggestions as usual always welcome.

Thanks all!

Amin

On Wed, Aug 12, 2009 at 10:28 PM, Chris Hostetter
<hossman_lucene@fucit.org>wrote:

>
> : that you use.  Also, we are nearing 2.9 release, so it would
> : be great to have as many eyeballs as possible on that.  There is a lot of
> new
> : goodness coming in 2.9, so it will be particularly important to get good
> : feedback, as this will help set the stage
>
> ...even for people that might be really unfamiliar with the Lucene
> internals, skimming the CHANGES.txt and then looking at the corrisponding
> javadocs to find any missing/confusing javadocs would be really helpful.
>
> And of course: we can always use more test cases.
>
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d999e1cbe8270471009d65--

From java-user-return-41845-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 07:37:27 2009
Return-Path: <java-user-return-41845-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91959 invoked from network); 13 Aug 2009 07:37:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 07:37:27 -0000
Received: (qmail 59041 invoked by uid 500); 13 Aug 2009 07:37:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58960 invoked by uid 500); 13 Aug 2009 07:37:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58950 invoked by uid 99); 13 Aug 2009 07:37:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 07:37:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.211 as permitted sender)
Received: from [209.85.218.211] (HELO mail-bw0-f211.google.com) (209.85.218.211)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 07:37:21 +0000
Received: by bwz8 with SMTP id 8so442971bwz.28
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 00:36:59 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=bPd+krEzkpwJblE4wys/RtU13in/9C+F5gLEPF4FEXM=;
        b=WdaycRRhuOXS70EadieOeBpdYMYNwB8b6b7pV8hsYbBfNs8sgVyPHNk9DLvvFEzFgN
         qJ6c5xX4YR1LfkF3gCpo7JkwEAYDb6KfpNUCYvCvbBtgV3whMvbB+eWzCq+G2SsVCiuh
         Vsfulf5P4PB8CdIV1e0WFH8mOsbWq3ugqFZxE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=Zs1d+HbSNNs5l8W/86uGZLyqiwatGe/fVUqZFtwGJuaDPgXpE2dxh4IFKO+TxcvT0C
         9jNTI343GPgo97BedDabnS//MI7rLZvCa+9jmxSW6JeVhNhNsvlNqPHsMIr0nOvhsUbg
         K9+iRt4ObOMeQS6j1mfAyLuRl5TP4wv7oglI4=
MIME-Version: 1.0
Received: by 10.239.156.146 with SMTP id m18mr72938hbc.24.1250149019270; Thu, 
	13 Aug 2009 00:36:59 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <11a518030908122110t3861ecf9vd89403905426a998@mail.gmail.com>
References: <11a518030908121246i2657ca68sb25e438015436fe9@mail.gmail.com>
	 <11a518030908122110t3861ecf9vd89403905426a998@mail.gmail.com>
Date: Thu, 13 Aug 2009 09:36:59 +0200
Message-ID: <f18c9dde0908130036u11535b9ap7e0d6fb599a8f459@mail.gmail.com>
Subject: Re: term query boost problem
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Chrisitan,
if you haven't done so you might find Luke
(http://www.getopt.org/luke/) very helpful so see what has been
indexed and how.

simon

On Thu, Aug 13, 2009 at 6:10 AM, Christian
Bongiorno<christian@bongiorno.org> wrote:
> turns out the index is being built with lower-case terms which is why we
> aren't getting hits the way we expect. When I change my search terms to
> lower I see more of what I expect.
>
> Gonna keep working on this and post updates.
>
> On Wed, Aug 12, 2009 at 12:46 PM, Christian Bongiorno <
> christian@bongiorno.org> wrote:
>
>> I have a situation where I have a series of terms queries as part of a
>> BooleanQuery.
>>
>> example:
>>
>> term: 'sole type' -> leather
>> =C2=A0 BooleanClause.SHOULD_OCCURR
>> term: 'title' -> 'Men's Golf shoes'
>> =C2=A0 BooleanClause.SHOULD_OCCURR
>> ...
>>
>> But, some terms are incredibly powerful indicators of match
>> term: 'band type' -> 'gold'
>>
>> Normally, I would set this as a field boost in the query. Problem is, it
>> isn't producing ANY changes even when I set the boost score absurdly hig=
h. I
>> have also tried to set the BooleanClause.MUST on my really important ter=
m
>> and I get no results at all.
>>
>> I tried a simple TermQuery for that (no clause) and got no results. Belo=
w
>> is a code snippet. I checked through the recent archives discussing fiel=
d
>> boosts and I am pretty confident I am doing it right. So, now I am presu=
ming
>> it's a problem with my query.
>>
>> =C2=A0 =C2=A0 private Query buildQuery(Map<String, String> CatalogInfo) =
{
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 if (CatalogInfo !=3D null && CatalogInfo.siz=
e() > 0) {
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 BooleanQuery booleanQuery =3D =
new BooleanQuery();
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 for (Map.Entry<String, String>=
 attributeValue :
>> CatalogInfo.entrySet()) {
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 String attribute=
Name =3D attributeValue.getKey();
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 String[] attribu=
teValues;
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 if (attributeVal=
ue.getValue().indexOf(VALUES_DELIMITER) =3D=3D
>> -1) {
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 at=
tributeValues =3D new String[]
>> {attributeValue.getValue()};
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 } else {
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 at=
tributeValues =3D
>> attributeValue.getValue().split(VALUES_DELIMITER);
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 }
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 for (String attr=
ibuteValue : attributeValues) {
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 St=
ring escapedValue =3D
>> QueryParser.escape(attributeValue).trim();
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Te=
rmQuery termQuery =3D new TermQuery(new
>> Term(attributeName, escapedValue));
>>
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Fl=
oat boostNumber =3D _boostMap.get(attributeName); //
>> this is where 'band type' gets it's boost
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 if=
 (boostNumber !=3D null) {
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 LOG.warn("Boost value found: " + boostNumber);
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 termQuery.setBoost(boostNumber);
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 }
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 bo=
oleanQuery.add(termQuery,
>> BooleanClause.Occur.SHOULD);
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 }
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 }
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 LOG.warn("Boolean query: " + b=
ooleanQuery.toString());
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 return booleanQuery;
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 }
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 return null;
>> =C2=A0 =C2=A0 }
>> --
>> Christian Bongiorno
>>
>>
>
>
> --
> Christian Bongiorno
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41846-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 07:41:53 2009
Return-Path: <java-user-return-41846-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92662 invoked from network); 13 Aug 2009 07:41:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 07:41:53 -0000
Received: (qmail 61875 invoked by uid 500); 13 Aug 2009 07:41:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61780 invoked by uid 500); 13 Aug 2009 07:41:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61770 invoked by uid 99); 13 Aug 2009 07:41:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 07:41:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of claudio.gennaro@isti.cnr.it designates 194.119.192.6 as permitted sender)
Received: from [194.119.192.6] (HELO ITANIUM.ISTI.CNR.IT) (194.119.192.6)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 07:41:48 +0000
Received: from conversionlocal.isti.cnr.it by mx.isti.cnr.it (PMDF V6.4 #31598)
 id <01NCGWMXXWOWA5UM3X@mx.isti.cnr.it> for java-user@lucene.apache.org; Thu,
 13 Aug 2009 09:40:40 +0200 (MEST)
Received: from ultralisca ([217.203.0.138])
 by mx.isti.cnr.it (PMDF V6.4 #31599) with ESMTPA id
 <01NCGWMW7PTIA7350F@mx.isti.cnr.it> for java-user@lucene.apache.org; Thu,
 13 Aug 2009 09:40:40 +0200
Date: Thu, 13 Aug 2009 09:40:40 +0200
From: Claudio Gennaro <claudio.gennaro@isti.cnr.it>
Subject: Simple Cosine Similarity
In-reply-to: <6f4104d80908130009j4bea60e9qca7f5012fb153d86@mail.gmail.com>
To: java-user@lucene.apache.org
Message-id: <001601ca1be9$5d7cf280$1876d780$%gennaro@isti.cnr.it>
MIME-version: 1.0
X-Mailer: Microsoft Office Outlook 12.0
Content-type: text/plain; charset=US-ASCII
Content-language: it
Content-transfer-encoding: 7bit
Thread-Index: Acob5RNgVknCOJRxQbukhTeRx8S9CAAAu5PQ
X-INSM-ip-source: 217.203.0.138 Auth Done
x-cr-hashedpuzzle: DyY= 0No= AUih Ah/P BPzM BooH DjCP EQHP EUwc Erls Et3F FKC3
 FuYe GMla GxyT
 G1Yv;1;agBhAHYAYQAtAHUAcwBlAHIAQABsAHUAYwBlAG4AZQAuAGEAcABhAGMAaABlAC4AbwByAGcA;Sosha1_v1;7;{F69F8367-AB8A-476B-9BBA-E74F9AF6160D};YwBsAGEAdQBkAGkAbwAuAGcAZQBuAG4AYQByAG8AQABpAHMAdABpAC4AYwBuAHIALgBpAHQA;Thu,
 13 Aug 2009 07:40:38
 GMT;UwBpAG0AcABsAGUAIABDAG8AcwBpAG4AZQAgAFMAaQBtAGkAbABhAHIAaQB0AHkA
x-cr-puzzleid: {F69F8367-AB8A-476B-9BBA-E74F9AF6160D}
References: <6f4104d80908120109i62ccb2e0rcbb74dde3c8184b0@mail.gmail.com>
 <6f4104d80908120251p2901829fk2bf4152b659fb0a4@mail.gmail.com>
 <A93D296C-A577-4F4A-8E09-3B7ED6CD6C71@apache.org>
 <Pine.LNX.4.64.0908121427290.28276@radix.cryptio.net>
 <6f4104d80908130009j4bea60e9qca7f5012fb153d86@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I would like to know if there is a simple way to force Lucene to adopt the
simple cosine similarity of the term frequency vectors of the documents and
the query for ranking the result.

Thank you

Claudio



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41847-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 07:45:23 2009
Return-Path: <java-user-return-41847-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93200 invoked from network); 13 Aug 2009 07:45:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 07:45:23 -0000
Received: (qmail 66465 invoked by uid 500); 13 Aug 2009 07:45:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66387 invoked by uid 500); 13 Aug 2009 07:45:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66377 invoked by uid 99); 13 Aug 2009 07:45:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 07:45:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 72.14.220.155 as permitted sender)
Received: from [72.14.220.155] (HELO fg-out-1718.google.com) (72.14.220.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 07:45:16 +0000
Received: by fg-out-1718.google.com with SMTP id 22so130244fge.4
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 00:44:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=QYvg+QKGt6XssM/hHJl5H2ujpEmWpH4NzW+snDeUVGM=;
        b=hlwMFkK1MIZxPNLXF2SwnSqoXTB2KHGh68n98xZqC4NpvKGcyQvBYuL57CW0WkweXR
         soZImgtSUW8DqCDQeSDjKY4g2CLnHRsB1zBqHimzc69YB7r0f5d/YIMAIkLovNdugIed
         HanCpefx+fb9PMRwoc9n+SEH9H9mI6TxqZT2k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=CHKyObCoLBkXH77x1KRDzK9uDm6rthLL1V/6uCzVObKISON823sTCCkNTCb6AXhHo+
         K/c9HzSzJXCfBKFoOLVU/09Nf5yHXxAeUXWnkyOkHUEs9snC8rvaLtJf7yyY+AWKnbKe
         MbHHI3v5lME7us69poIFFS/wjU9e63ZghTlmY=
MIME-Version: 1.0
Received: by 10.239.145.15 with SMTP id q15mr55211hba.121.1250149496118; Thu, 
	13 Aug 2009 00:44:56 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <6f4104d80908130009j4bea60e9qca7f5012fb153d86@mail.gmail.com>
References: <6f4104d80908120109i62ccb2e0rcbb74dde3c8184b0@mail.gmail.com>
	 <6f4104d80908120251p2901829fk2bf4152b659fb0a4@mail.gmail.com>
	 <A93D296C-A577-4F4A-8E09-3B7ED6CD6C71@apache.org>
	 <Pine.LNX.4.64.0908121427290.28276@radix.cryptio.net>
	 <6f4104d80908130009j4bea60e9qca7f5012fb153d86@mail.gmail.com>
Date: Thu, 13 Aug 2009 09:44:56 +0200
Message-ID: <f18c9dde0908130044m37d7914fu95e77cd6f81febe5@mail.gmail.com>
Subject: Re: Contribute to Lucene
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

There is a lot of code in /contrib which needs proper documentation,
refactoring and clean-up.
For refactoring you can have a quick look at /analyzers/smartcn.
Clean-up and documentation is needed in /contrib/spartial which still
suffers from lots of legacy comments and certainly legacy code.
I guess somebody else mentioned it already - test-cases are always
appreciated. I haven't looked at spartial for a couple of weeks but i
haven't seen a lot of test cases so far.

Maybe the contribs are a good place to start from.

simon


On Thu, Aug 13, 2009 at 9:09 AM, Amin Mohammed-Coleman<aminmc@gmail.com> wr=
ote:
> Thanks for your replies. I have checked out trunk and have started lookin=
g
> at what I can do. =C2=A0Any more suggestions as usual always welcome.
>
> Thanks all!
>
> Amin
>
> On Wed, Aug 12, 2009 at 10:28 PM, Chris Hostetter
> <hossman_lucene@fucit.org>wrote:
>
>>
>> : that you use. =C2=A0Also, we are nearing 2.9 release, so it would
>> : be great to have as many eyeballs as possible on that. =C2=A0There is =
a lot of
>> new
>> : goodness coming in 2.9, so it will be particularly important to get go=
od
>> : feedback, as this will help set the stage
>>
>> ...even for people that might be really unfamiliar with the Lucene
>> internals, skimming the CHANGES.txt and then looking at the corrispondin=
g
>> javadocs to find any missing/confusing javadocs would be really helpful.
>>
>> And of course: we can always use more test cases.
>>
>>
>>
>> -Hoss
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41848-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 07:47:45 2009
Return-Path: <java-user-return-41848-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93477 invoked from network); 13 Aug 2009 07:47:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 07:47:45 -0000
Received: (qmail 69940 invoked by uid 500); 13 Aug 2009 07:47:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69867 invoked by uid 500); 13 Aug 2009 07:47:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69857 invoked by uid 99); 13 Aug 2009 07:47:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 07:47:49 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aminmc@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 07:47:41 +0000
Received: by ewy26 with SMTP id 26so606160ewy.5
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 00:47:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=rqIait5x8pWm1GvCrZ75hf7ynsXeSJplW8anr4/0GUE=;
        b=XkKypeDugZdzLK8bgHDH9C3E0SfNLsodRmca0OCi0lVoIZw4BAeGQzgy21wXBRs1Pm
         mxx1UgNMwVsaHlFsTzwe424pwIwLS/adkFSNi74oouH0sEJuSj6DxQ2vpQrAslhsKl1C
         wDZo/mseafBeP3E0wqH8TpuEVBRkIYYTBmwwc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=cuvHjV0WroThl+wPNiGeLbpIWZyX4ms+Z7GGTeIMAzDILW8QV9UxXLuaBinqt6mJ6O
         OG8v8uSK1QTbEa4F4Te5R3LiQNpSDjR7VJZl4Sna3mmPPIMQQDyT+SIzFc17VOW/WARm
         8QNwYESqOBHrLntmlArU/MMJaMyKoQlnyJUSs=
MIME-Version: 1.0
Received: by 10.216.85.133 with SMTP id u5mr139293wee.91.1250149640086; Thu, 
	13 Aug 2009 00:47:20 -0700 (PDT)
In-Reply-To: <f18c9dde0908130044m37d7914fu95e77cd6f81febe5@mail.gmail.com>
References: <6f4104d80908120109i62ccb2e0rcbb74dde3c8184b0@mail.gmail.com>
	 <6f4104d80908120251p2901829fk2bf4152b659fb0a4@mail.gmail.com>
	 <A93D296C-A577-4F4A-8E09-3B7ED6CD6C71@apache.org>
	 <Pine.LNX.4.64.0908121427290.28276@radix.cryptio.net>
	 <6f4104d80908130009j4bea60e9qca7f5012fb153d86@mail.gmail.com>
	 <f18c9dde0908130044m37d7914fu95e77cd6f81febe5@mail.gmail.com>
Date: Thu, 13 Aug 2009 08:47:20 +0100
Message-ID: <6f4104d80908130047r5d055b35ia470be11fc0c54b3@mail.gmail.com>
Subject: Re: Contribute to Lucene
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: java-user@lucene.apache.org, simon.willnauer@gmail.com
Content-Type: multipart/alternative; boundary=0016e6d63fff36a6960471012571
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d63fff36a6960471012571
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Cool! I'll be on the case.

Cheers!

Amin

On Thu, Aug 13, 2009 at 8:44 AM, Simon Willnauer <
simon.willnauer@googlemail.com> wrote:

> There is a lot of code in /contrib which needs proper documentation,
> refactoring and clean-up.
> For refactoring you can have a quick look at /analyzers/smartcn.
> Clean-up and documentation is needed in /contrib/spartial which still
> suffers from lots of legacy comments and certainly legacy code.
> I guess somebody else mentioned it already - test-cases are always
> appreciated. I haven't looked at spartial for a couple of weeks but i
> haven't seen a lot of test cases so far.
>
> Maybe the contribs are a good place to start from.
>
> simon
>
>
> On Thu, Aug 13, 2009 at 9:09 AM, Amin Mohammed-Coleman<aminmc@gmail.com>
> wrote:
> > Thanks for your replies. I have checked out trunk and have started
> looking
> > at what I can do.  Any more suggestions as usual always welcome.
> >
> > Thanks all!
> >
> > Amin
> >
> > On Wed, Aug 12, 2009 at 10:28 PM, Chris Hostetter
> > <hossman_lucene@fucit.org>wrote:
> >
> >>
> >> : that you use.  Also, we are nearing 2.9 release, so it would
> >> : be great to have as many eyeballs as possible on that.  There is a lot
> of
> >> new
> >> : goodness coming in 2.9, so it will be particularly important to get
> good
> >> : feedback, as this will help set the stage
> >>
> >> ...even for people that might be really unfamiliar with the Lucene
> >> internals, skimming the CHANGES.txt and then looking at the
> corrisponding
> >> javadocs to find any missing/confusing javadocs would be really helpful.
> >>
> >> And of course: we can always use more test cases.
> >>
> >>
> >>
> >> -Hoss
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d63fff36a6960471012571--

From java-user-return-41849-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 07:59:58 2009
Return-Path: <java-user-return-41849-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96833 invoked from network); 13 Aug 2009 07:59:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 07:59:57 -0000
Received: (qmail 92539 invoked by uid 500); 13 Aug 2009 08:00:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92469 invoked by uid 500); 13 Aug 2009 08:00:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92459 invoked by uid 99); 13 Aug 2009 08:00:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 08:00:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.212 as permitted sender)
Received: from [209.85.218.212] (HELO mail-bw0-f212.google.com) (209.85.218.212)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 07:59:51 +0000
Received: by bwz8 with SMTP id 8so451705bwz.28
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 00:59:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=De30iNTLZeHuvYraeHY+b99Pf3oSn5DRjZtlw4IVmrw=;
        b=KCAZk6ofS1qBgT4hXpEFcPudiRYGM64CjiD9YC7EizHzacU2M3VkuQ4UkAtBIA4lNT
         /wm2IggRtFXIG0gWTdqhddrDhAtY8qk/1gnjQkouMSHzXvLKNWRuC7dvwK8JT7+2DKGw
         VVsGLxbTy8B61ft35Gz9gO+v42nc6TfrgCi5E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=Z+Xa96Hhcr94SHmGBwwEg9GtSVt1cZiLX5EN2lsSALr5imKyOzwHTsRqe3hhZBVI+U
         Y/4hzxs3tWGGgVMLvf9JWORodzCQKQKlw1Bwou7S5q/NrVRSQHWU1QAJ+RI4XEuhP0kk
         mi7u0Ff3Fo/YWxnmK4MDgcIjlvVuQZ75a9MC8=
MIME-Version: 1.0
Received: by 10.239.135.78 with SMTP id c14mr58275hbc.102.1250150370558; Thu, 
	13 Aug 2009 00:59:30 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <6f4104d80908130047r5d055b35ia470be11fc0c54b3@mail.gmail.com>
References: <6f4104d80908120109i62ccb2e0rcbb74dde3c8184b0@mail.gmail.com>
	 <6f4104d80908120251p2901829fk2bf4152b659fb0a4@mail.gmail.com>
	 <A93D296C-A577-4F4A-8E09-3B7ED6CD6C71@apache.org>
	 <Pine.LNX.4.64.0908121427290.28276@radix.cryptio.net>
	 <6f4104d80908130009j4bea60e9qca7f5012fb153d86@mail.gmail.com>
	 <f18c9dde0908130044m37d7914fu95e77cd6f81febe5@mail.gmail.com>
	 <6f4104d80908130047r5d055b35ia470be11fc0c54b3@mail.gmail.com>
Date: Thu, 13 Aug 2009 09:59:30 +0200
Message-ID: <f18c9dde0908130059i5a44cb44hd880f8b035a90a7e@mail.gmail.com>
Subject: Re: Contribute to Lucene
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Once you open an issues on the spartial / analyzers/cn contribs feel
free to assign me to them.

simon

On Thu, Aug 13, 2009 at 9:47 AM, Amin Mohammed-Coleman<aminmc@gmail.com> wr=
ote:
> Cool! I'll be on the case.
>
> Cheers!
>
> Amin
>
> On Thu, Aug 13, 2009 at 8:44 AM, Simon Willnauer
> <simon.willnauer@googlemail.com> wrote:
>>
>> There is a lot of code in /contrib which needs proper documentation,
>> refactoring and clean-up.
>> For refactoring you can have a quick look at /analyzers/smartcn.
>> Clean-up and documentation is needed in /contrib/spartial which still
>> suffers from lots of legacy comments and certainly legacy code.
>> I guess somebody else mentioned it already - test-cases are always
>> appreciated. I haven't looked at spartial for a couple of weeks but i
>> haven't seen a lot of test cases so far.
>>
>> Maybe the contribs are a good place to start from.
>>
>> simon
>>
>>
>> On Thu, Aug 13, 2009 at 9:09 AM, Amin Mohammed-Coleman<aminmc@gmail.com>
>> wrote:
>> > Thanks for your replies. I have checked out trunk and have started
>> > looking
>> > at what I can do. =C2=A0Any more suggestions as usual always welcome.
>> >
>> > Thanks all!
>> >
>> > Amin
>> >
>> > On Wed, Aug 12, 2009 at 10:28 PM, Chris Hostetter
>> > <hossman_lucene@fucit.org>wrote:
>> >
>> >>
>> >> : that you use. =C2=A0Also, we are nearing 2.9 release, so it would
>> >> : be great to have as many eyeballs as possible on that. =C2=A0There =
is a
>> >> lot of
>> >> new
>> >> : goodness coming in 2.9, so it will be particularly important to get
>> >> good
>> >> : feedback, as this will help set the stage
>> >>
>> >> ...even for people that might be really unfamiliar with the Lucene
>> >> internals, skimming the CHANGES.txt and then looking at the
>> >> corrisponding
>> >> javadocs to find any missing/confusing javadocs would be really
>> >> helpful.
>> >>
>> >> And of course: we can always use more test cases.
>> >>
>> >>
>> >>
>> >> -Hoss
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41850-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 08:16:08 2009
Return-Path: <java-user-return-41850-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 442 invoked from network); 13 Aug 2009 08:16:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 08:16:08 -0000
Received: (qmail 21120 invoked by uid 500); 13 Aug 2009 08:16:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21047 invoked by uid 500); 13 Aug 2009 08:16:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21037 invoked by uid 99); 13 Aug 2009 08:16:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 08:16:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.212 as permitted sender)
Received: from [209.85.218.212] (HELO mail-bw0-f212.google.com) (209.85.218.212)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 08:16:02 +0000
Received: by bwz8 with SMTP id 8so458318bwz.28
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 01:15:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=2l9LHzdp+xRVmOFMA2Cu28i80zI7jX2EPXJo8FE+HdU=;
        b=dbr7py2RaiCsY+NN6itdSCxCwdlDh7PCl+X4vWFaVKocxGz5l1fYc9CPNhHhNctF9+
         4+0jaOGjLEE6nfsKbI1WuVxiyQqbuJEcx3kZKNC7c045olSzFggjtkCSu95ODR6pEcHz
         H9XFYokpu7asTVhW4snPeHDtNvm418Q05jxsk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=dXRXwHCadzfw1Glx+SMj0mPqa0cxXaSXTcHYQfeFE1DF7X4N35Ls1XnqH/UV8nvZcT
         mMkYIY09SPSVhjzduPO1XfjUWZKgeko1J44vS+p69NbCeZ3aafD8J3rbSN+8Dnf2migD
         M35XBwhiOeX143qvSbg0PydTvlO1NAaT5NzRM=
MIME-Version: 1.0
Received: by 10.239.169.8 with SMTP id m8mr62122hbe.168.1250151340487; Thu, 13 
	Aug 2009 01:15:40 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <867513fe0908122143g5139355duc47134a13d5406fa@mail.gmail.com>
References: <867513fe0908122143g5139355duc47134a13d5406fa@mail.gmail.com>
Date: Thu, 13 Aug 2009 10:15:40 +0200
Message-ID: <f18c9dde0908130115s932c485kb1a7c7190595e1cb@mail.gmail.com>
Subject: Re: Lucene Vs Sphinx benchmarking for large dataset
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Anshum, thanks for posting this on the list. I have a view comments on
that benchmark while being happy that lucene has an upper hand in
yours.
I wonder if you can publish the various modifications you did to
either of those? If not would it be possible to run the benchmarks
against the vanilla versions? Did you use an already released version
of lucene or did you do modifications against the trunk? I found it
little hard to read - putting it into a table would make little more
sense to me though. I personally would be interested in what kind of
analysis you have applied to the index document and the queries
though.

simon

On Thu, Aug 13, 2009 at 6:43 AM, Anshum<anshumg@gmail.com> wrote:
> I just happened to benchmark a little modified version of lucene with a
> little modified version of sphinx :)
> Have posted my results here
> http://ai-cafe.blogspot.com
> Would also be updating more @ the blog in a while!
>
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
>
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41851-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 09:12:35 2009
Return-Path: <java-user-return-41851-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21733 invoked from network); 13 Aug 2009 09:12:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 09:12:35 -0000
Received: (qmail 85619 invoked by uid 500); 13 Aug 2009 09:12:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85561 invoked by uid 500); 13 Aug 2009 09:12:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85551 invoked by uid 99); 13 Aug 2009 09:12:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 09:12:39 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 09:12:30 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbWLx-0001f5-RF
	for java-user@lucene.apache.org; Thu, 13 Aug 2009 02:12:09 -0700
Message-ID: <24951573.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 02:12:09 -0700 (PDT)
From: bourne71 <garylkc@live.com>
To: java-user@lucene.apache.org
Subject: Re: Generating Query
In-Reply-To: <340389.23662.qm@web52906.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: garylkc@live.com
References: <24931880.post@talk.nabble.com> <391442.37864.qm@web52912.mail.re2.yahoo.com> <24943981.post@talk.nabble.com> <340389.23662.qm@web52906.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org


I am trying to boost  results that have all the query in it to increase its
ranking. But both the query unfortunately does not seems to effect it

Ahmet Arslan wrote:
> 
>> thanks for the suggestion, but unfortunately it does not
>> work.
> 
> What are you trying to do? Both Adriano's and my query satisfies what you
> were asking for. What didn't work?
> 
> 
>       
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Generating-Query-tp24931880p24951573.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41852-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 09:19:35 2009
Return-Path: <java-user-return-41852-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26388 invoked from network); 13 Aug 2009 09:19:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 09:19:35 -0000
Received: (qmail 91986 invoked by uid 500); 13 Aug 2009 09:19:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91921 invoked by uid 500); 13 Aug 2009 09:19:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91911 invoked by uid 99); 13 Aug 2009 09:19:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 09:19:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 09:19:29 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbWSi-0001se-7Y
	for java-user@lucene.apache.org; Thu, 13 Aug 2009 02:19:08 -0700
Message-ID: <24951667.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 02:19:08 -0700 (PDT)
From: rishisinghal <singhal.rishi@gmail.com>
To: java-user@lucene.apache.org
Subject: Indexer crashes with "hit exception during merge"
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: singhal.rishi@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I am trying to index documents and when all is complete and optimize is
called I get

IFD [main]: setInfoStream
deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@4fced0
IW 0 [main]: setInfoStream:
dir=org.apache.lucene.store.FSDirectory@/SYS$SYSDEVICE/RISHI/melon_1600
autoCommit=false mergePolicy=org
.apache.lucene.index.LogByteSizeMergePolicy@92cb49
mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@6038e4
ramBufferS
izeMB=16.0 maxBufferedDocs=5 maxBuffereDeleteTerms=-1 maxFieldLength=10000
index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0 _61:c245->_0
_9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
IW 0 [main]:   flush: segment=null docStoreSegment=null docStoreOffset=0
flushDocs=false flushDeletes=true flushDocStores=false numD
ocs=0 numBufDelTerms=0
IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0 _61:c245->_0
_9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
IW 0 [main]: add merge to pendingMerges: _61:c245->_0 _9e:c485->_0
_ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1 pending]
IW 0 [main]: CMS: now merge
IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
_9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
IW 0 [main]: CMS:   consider merge _61:c245->_0 _9e:c485->_0 _ay:c225->_0
_az:c5->_0 _b0:c5->_0 into _b5 [optimize]
IW 0 [main]: CMS:     launch new thread [Lucene Merge Thread #73]
IW 0 [main]: CMS:   no more merges pending; now return
IW 0 [Lucene Merge Thread #73]: CMS:   merge thread: start
IW 0 [Lucene Merge Thread #73]: now merge
  merge=_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into
_b5 [optimize]
  merge=org.apache.lucene.index.MergePolicy$OneMerge@3725db
  index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0 _ay:c225->_0
_az:c5->_0 _b0:c5->_0
IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0 _9e:c485->_0
_ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
IW 0 [Lucene Merge Thread #73]: hit exception during merge
Exception in thread "Lucene Merge Thread #73"
org.apache.lucene.index.MergePolicy$MergeException:
java.io.FileNotFoundException: /SY
S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
        at
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
        at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
Caused by: java.io.FileNotFoundException:
/SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
        at java.io.RandomAccessFile.open(Native Method)
        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
        at
org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
        at
org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
        at
org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
        at
org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
        at
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
        at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
        at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
        at
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
        at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
        at
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
        at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
Aug 13, 2009 2:40:56 PM org.hp.openvms.lucene.index.FileIndexerJSP jspMain
SEVERE: Indexing not completebackground merge hit exception: _61:c245->_0
_9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
optimize]
java.io.IOException: background merge hit exception: _61:c245->_0
_9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize
]
        at
org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
        at
org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
        at
org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
        at org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
Source)
        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown Source)
Caused by: java.io.FileNotFoundException:
/SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
        at java.io.RandomAccessFile.open(Native Method)
        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
        at
org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
        at
org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
        at
org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
        at
org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
        at
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
        at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
        at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
        at
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
        at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
        at
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
        at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
IW 0 [main]: now flush at close
IW 0 [main]:   flush: segment=null docStoreSegment=null docStoreOffset=0
flushDocs=false flushDeletes=true flushDocStores=false numD
ocs=0 numBufDelTerms=0
IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0 _61:c245->_0
_9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
IW 0 [main]: CMS: now merge
IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
_9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
IW 0 [main]: CMS:   no more merges pending; now return
IW 0 [main]: now call final commit()
IW 0 [main]: startCommit(): start sizeInBytes=0
IW 0 [main]: startCommit index=_37:c465->_0 _4c:c165->_0 _61:c245->_0
_9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=11
95
IW 0 [main]: now sync _37.cfs
IW 0 [main]: hit exception while closing
Exception in thread "main" java.io.FileNotFoundException:
/SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5))
        at java.io.RandomAccessFile.open(Native Method)
        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
        at org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
        at
org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
        at org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
        at
org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1654)
        at org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
        at org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
        at org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
Source)
        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown Source)



I have setMaxBufferedDocs = 5 and setMergeFactor=5. I was trying different
combinations of these to see if that helps but was unsuccessful. 


Regards,
Rishi
-- 
View this message in context: http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24951667.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41853-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 09:49:30 2009
Return-Path: <java-user-return-41853-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44416 invoked from network); 13 Aug 2009 09:49:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 09:49:30 -0000
Received: (qmail 22638 invoked by uid 500); 13 Aug 2009 09:49:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22575 invoked by uid 500); 13 Aug 2009 09:49:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22565 invoked by uid 99); 13 Aug 2009 09:49:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 09:49:34 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.217.218] (HELO mail-gx0-f218.google.com) (209.85.217.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 09:49:25 +0000
Received: by gxk18 with SMTP id 18so684042gxk.5
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 02:49:03 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.253.21 with SMTP id a21mr1208129ybi.157.1250156943280; 
	Thu, 13 Aug 2009 02:49:03 -0700 (PDT)
In-Reply-To: <24951667.post@talk.nabble.com>
References: <24951667.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 05:49:03 -0400
Message-ID: <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com>
Subject: Re: Indexer crashes with "hit exception during merge"
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Is there any chance that two writers are open on this directory?  Or,
something external to Lucene is removing files from the directory.

It looks like there were at least two missing files (_37

On Thu, Aug 13, 2009 at 5:19 AM, rishisinghal<singhal.rishi@gmail.com> wrot=
e:
>
> Hi,
>
> I am trying to index documents and when all is complete and optimize is
> called I get
>
> IFD [main]: setInfoStream
> deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy=
@4fced0
> IW 0 [main]: setInfoStream:
> dir=3Dorg.apache.lucene.store.FSDirectory@/SYS$SYSDEVICE/RISHI/melon_1600
> autoCommit=3Dfalse mergePolicy=3Dorg
> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
> mergeScheduler=3Dorg.apache.lucene.index.ConcurrentMergeScheduler@6038e4
> ramBufferS
> izeMB=3D16.0 maxBufferedDocs=3D5 maxBuffereDeleteTerms=3D-1 maxFieldLengt=
h=3D10000
> index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
> =A0_ay:c225->_0 _az:c5->_0 _b0:c5->_0
> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0 _61:c245->_0
> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> IW 0 [main]: =A0 flush: segment=3Dnull docStoreSegment=3Dnull docStoreOff=
set=3D0
> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfalse numD
> ocs=3D0 numBufDelTerms=3D0
> IW 0 [main]: =A0 index before flush _37:c465->_0 _4c:c165->_0 _61:c245->_=
0
> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> IW 0 [main]: add merge to pendingMerges: _61:c245->_0 _9e:c485->_0
> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1 pending]
> IW 0 [main]: CMS: now merge
> IW 0 [main]: CMS: =A0 index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> IW 0 [main]: CMS: =A0 consider merge _61:c245->_0 _9e:c485->_0 _ay:c225->=
_0
> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
> IW 0 [main]: CMS: =A0 =A0 launch new thread [Lucene Merge Thread #73]
> IW 0 [main]: CMS: =A0 no more merges pending; now return
> IW 0 [Lucene Merge Thread #73]: CMS: =A0 merge thread: start
> IW 0 [Lucene Merge Thread #73]: now merge
> =A0merge=3D_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 i=
nto
> _b5 [optimize]
> =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@3725db
> =A0index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0 _ay:c225->=
_0
> _az:c5->_0 _b0:c5->_0
> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0 _9e:c485->_0
> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
> IW 0 [Lucene Merge Thread #73]: hit exception during merge
> Exception in thread "Lucene Merge Thread #73"
> org.apache.lucene.index.MergePolicy$MergeException:
> java.io.FileNotFoundException: /SY
> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
currentMergeScheduler.java:309)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntMergeScheduler.java:286)
> Caused by: java.io.FileNotFoundException:
> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Method)
> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.<init>(RandomAccessFile.java:2=
31)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDire=
ctory.java:552)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:=
582)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java=
:70)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader=
.java:306)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader=
.java:260)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.j=
ava:3884)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
cheduler.java:205)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntMergeScheduler.java:260)
> Aug 13, 2009 2:40:56 PM org.hp.openvms.lucene.index.FileIndexerJSP jspMai=
n
> SEVERE: Indexing not completebackground merge hit exception: _61:c245->_0
> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
> optimize]
> java.io.IOException: background merge hit exception: _61:c245->_0
> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize
> ]
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
> =A0 =A0 =A0 =A0at org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unkn=
own
> Source)
> =A0 =A0 =A0 =A0at org.hp.openvms.lucene.index.FileIndexer.main(Unknown So=
urce)
> Caused by: java.io.FileNotFoundException:
> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Method)
> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.<init>(RandomAccessFile.java:2=
31)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDire=
ctory.java:552)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:=
582)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java=
:70)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader=
.java:306)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader=
.java:260)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.j=
ava:3884)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
cheduler.java:205)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntMergeScheduler.java:260)
> IW 0 [main]: now flush at close
> IW 0 [main]: =A0 flush: segment=3Dnull docStoreSegment=3Dnull docStoreOff=
set=3D0
> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfalse numD
> ocs=3D0 numBufDelTerms=3D0
> IW 0 [main]: =A0 index before flush _37:c465->_0 _4c:c165->_0 _61:c245->_=
0
> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> IW 0 [main]: CMS: now merge
> IW 0 [main]: CMS: =A0 index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> IW 0 [main]: CMS: =A0 no more merges pending; now return
> IW 0 [main]: now call final commit()
> IW 0 [main]: startCommit(): start sizeInBytes=3D0
> IW 0 [main]: startCommit index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0
> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=3D11
> 95
> IW 0 [main]: now sync _37.cfs
> IW 0 [main]: hit exception while closing
> Exception in thread "main" java.io.FileNotFoundException:
> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5))
> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Method)
> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.<init>(RandomAccessFile.java:2=
31)
> =A0 =A0 =A0 =A0at org.apache.lucene.store.FSDirectory.sync(FSDirectory.ja=
va:456)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.commit(IndexWriter.=
java:3369)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1654)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.close(IndexWriter.j=
ava:1602)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.close(IndexWriter.j=
ava:1578)
> =A0 =A0 =A0 =A0at org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unkn=
own
> Source)
> =A0 =A0 =A0 =A0at org.hp.openvms.lucene.index.FileIndexer.main(Unknown So=
urce)
>
>
>
> I have setMaxBufferedDocs =3D 5 and setMergeFactor=3D5. I was trying diff=
erent
> combinations of these to see if that helps but was unsuccessful.
>
>
> Regards,
> Rishi
> --
> View this message in context: http://www.nabble.com/Indexer-crashes-with-=
%22hit-exception-during-merge%22-tp24951667p24951667.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41854-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 09:55:33 2009
Return-Path: <java-user-return-41854-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48315 invoked from network); 13 Aug 2009 09:55:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 09:55:32 -0000
Received: (qmail 30220 invoked by uid 500); 13 Aug 2009 09:55:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30141 invoked by uid 500); 13 Aug 2009 09:55:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30128 invoked by uid 99); 13 Aug 2009 09:55:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 09:55:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.18] (HELO web52908.mail.re2.yahoo.com) (206.190.49.18)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 13 Aug 2009 09:55:26 +0000
Received: (qmail 5316 invoked by uid 60001); 13 Aug 2009 09:55:03 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1250157302; bh=yTrmuJgENXKYV8mS+yxWvReVoBvLKlhVldNFHxjwcWc=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=zKlVvFsy4JLzFEJ2NxPK1qVK2te89RvwwMDvE/aJRTngzXoUQwkdZkVoXrLuhkuD8yGZI+Sh0pUnG6xaFAwK2hqq2Pt/ZvNpvJEEXRjdieJ9G9qKgg4WPx6ywzmbRJzgkAvnA0AQEAegTIfJVCU/bRspZktjQogu+skgyS+Mmzk=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=t00ekNpYjy+TqKdDDmzlRJk3Z8M2TIOVPmxTLKcyZYfdAybnXmXVBel6ZnG3DpJNBoyqmsYaQC19o8FZNii5NoYFZoKeiC0ypr3KXm4Y7JrjA9b3Z0+WL2KcObRf0kJz7kYZq5tJRMOBWVLE0oEHJ9Da3vRXHNAMDMjH1PzwsBY=;
Message-ID: <884693.1902.qm@web52908.mail.re2.yahoo.com>
X-YMail-OSG: C1DXuy4VM1mcVr.FMGtyCfoea9t.kRPc8GUDvMsgtwnFI9zfBCl_mwtqFUJc3EZe9EFllvXQTo3VQRE3ErMukXItdnWOefra9auvOMsO0Z0FjCoHj1cZTYlu9HUX2.uMI0UyplVfov9bU15QHU1qtMSotteNJUA5p2_Jq7P8D0OgREpGCzIf7XzoXlk5BIgNM3CSy.kNufBX7Txe9vY9zGrME2AHDS8B.74vEnrcpDckFyT4KONCBKPwh4I.VXete.B1fYK1vxhbMGetpMSiH97ST9_evEGB2BzOQXsX3uqn9v..g2nWmWbwcArf9FNc8wJKP_DlB529
Received: from [193.140.184.100] by web52908.mail.re2.yahoo.com via HTTP; Thu, 13 Aug 2009 02:55:02 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.2
Date: Thu, 13 Aug 2009 02:55:02 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Generating Query
To: java-user@lucene.apache.org
In-Reply-To: <24951573.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

> I am trying to boost=A0 results that have all the query
> in it to increase its ranking. But both the query unfortunately does not =
> seems to effect it

Did you read last two messages on this thread?

http://www.nabble.com/Generating-Query-for-Multiple-Clauses-in-a-Single-Fie=
ld-td24694748.html=20

And do not forget to use your new similarity class in both indexing and sea=
rching. IndexSearcher.setSimilarity and IndexWriter.setSimilarity.=0A=0A=0A=
      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41855-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 10:07:39 2009
Return-Path: <java-user-return-41855-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54597 invoked from network); 13 Aug 2009 10:07:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 10:07:39 -0000
Received: (qmail 49323 invoked by uid 500); 13 Aug 2009 10:07:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49252 invoked by uid 500); 13 Aug 2009 10:07:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49242 invoked by uid 99); 13 Aug 2009 10:07:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:07:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:07:34 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbXDF-0003cM-LC
	for java-user@lucene.apache.org; Thu, 13 Aug 2009 03:07:13 -0700
Message-ID: <24952295.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 03:07:13 -0700 (PDT)
From: rishisinghal <singhal.rishi@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Indexer crashes with "hit exception during merge"
In-Reply-To: <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: singhal.rishi@gmail.com
References: <24951667.post@talk.nabble.com> <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


>>Is there any chance that two writers are open on this directory? =20
No, thats not true.

>>something external to Lucene is removing files from the directory.
No this also has rare chances as I am the owner of these files and other
then me no one can delete the, :-)

Here are all the files in the index directory:
segments.gen;1      segments_1.;1       segments_2.;1       _0.fdt;1
_0.fdx;1            _37.cfs;1           _4c.cfs;1           _61.cfs;1
_9e.cfs;1           _ay.cfs;1           _az.cfs;1           _b0.cfs;1
_b2.tis;1           _b3.fdt;1           _b4.fdt;1

I see _37 present.

Regards,
Rishi


Michael McCandless-2 wrote:
>=20
> Is there any chance that two writers are open on this directory?  Or,
> something external to Lucene is removing files from the directory.
>=20
> It looks like there were at least two missing files (_37
>=20
> On Thu, Aug 13, 2009 at 5:19 AM, rishisinghal<singhal.rishi@gmail.com>
> wrote:
>>
>> Hi,
>>
>> I am trying to index documents and when all is complete and optimize is
>> called I get
>>
>> IFD [main]: setInfoStream
>> deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionPolic=
y@4fced0
>> IW 0 [main]: setInfoStream:
>> dir=3Dorg.apache.lucene.store.FSDirectory@/SYS$SYSDEVICE/RISHI/melon_160=
0
>> autoCommit=3Dfalse mergePolicy=3Dorg
>> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
>> mergeScheduler=3Dorg.apache.lucene.index.ConcurrentMergeScheduler@6038e4
>> ramBufferS
>> izeMB=3D16.0 maxBufferedDocs=3D5 maxBuffereDeleteTerms=3D-1
>> maxFieldLength=3D10000
>> index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>> =C2=A0_ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0 _61:c245->_0
>> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> IW 0 [main]: =C2=A0 flush: segment=3Dnull docStoreSegment=3Dnull docStor=
eOffset=3D0
>> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfalse numD
>> ocs=3D0 numBufDelTerms=3D0
>> IW 0 [main]: =C2=A0 index before flush _37:c465->_0 _4c:c165->_0 _61:c24=
5->_0
>> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> IW 0 [main]: add merge to pendingMerges: _61:c245->_0 _9e:c485->_0
>> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1 pending]
>> IW 0 [main]: CMS: now merge
>> IW 0 [main]: CMS: =C2=A0 index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
>> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> IW 0 [main]: CMS: =C2=A0 consider merge _61:c245->_0 _9e:c485->_0 _ay:c2=
25->_0
>> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>> IW 0 [main]: CMS: =C2=A0 =C2=A0 launch new thread [Lucene Merge Thread #=
73]
>> IW 0 [main]: CMS: =C2=A0 no more merges pending; now return
>> IW 0 [Lucene Merge Thread #73]: CMS: =C2=A0 merge thread: start
>> IW 0 [Lucene Merge Thread #73]: now merge
>> =C2=A0merge=3D_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->=
_0 into
>> _b5 [optimize]
>> =C2=A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@3725db
>> =C2=A0index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0 _ay:c2=
25->_0
>> _az:c5->_0 _b0:c5->_0
>> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0 _9e:c485->_0
>> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>> IW 0 [Lucene Merge Thread #73]: hit exception during merge
>> Exception in thread "Lucene Merge Thread #73"
>> org.apache.lucene.index.MergePolicy$MergeException:
>> java.io.FileNotFoundException: /SY
>> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Co=
ncurrentMergeScheduler.java:309)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr=
entMergeScheduler.java:286)
>> Caused by: java.io.FileNotFoundException:
>> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.open(Native Metho=
d)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.<init>(RandomAcce=
ssFile.java:231)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDir=
ectory.java:552)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java=
:582)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.jav=
a:70)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerge=
Scheduler.java:205)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr=
entMergeScheduler.java:260)
>> Aug 13, 2009 2:40:56 PM org.hp.openvms.lucene.index.FileIndexerJSP
>> jspMain
>> SEVERE: Indexing not completebackground merge hit exception: _61:c245->_=
0
>> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
>> optimize]
>> java.io.IOException: background merge hit exception: _61:c245->_0
>> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize
>> ]
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.hp.openvms.lucene.index.FileIndexerJSP=
.jspMain(Unknown
>> Source)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.hp.openvms.lucene.index.FileIndexer.ma=
in(Unknown Source)
>> Caused by: java.io.FileNotFoundException:
>> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.open(Native Metho=
d)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.<init>(RandomAcce=
ssFile.java:231)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDir=
ectory.java:552)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java=
:582)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.jav=
a:70)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerge=
Scheduler.java:205)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr=
entMergeScheduler.java:260)
>> IW 0 [main]: now flush at close
>> IW 0 [main]: =C2=A0 flush: segment=3Dnull docStoreSegment=3Dnull docStor=
eOffset=3D0
>> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfalse numD
>> ocs=3D0 numBufDelTerms=3D0
>> IW 0 [main]: =C2=A0 index before flush _37:c465->_0 _4c:c165->_0 _61:c24=
5->_0
>> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> IW 0 [main]: CMS: now merge
>> IW 0 [main]: CMS: =C2=A0 index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
>> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> IW 0 [main]: CMS: =C2=A0 no more merges pending; now return
>> IW 0 [main]: now call final commit()
>> IW 0 [main]: startCommit(): start sizeInBytes=3D0
>> IW 0 [main]: startCommit index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0
>> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=3D11
>> 95
>> IW 0 [main]: now sync _37.cfs
>> IW 0 [main]: hit exception while closing
>> Exception in thread "main" java.io.FileNotFoundException:
>> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5))
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.open(Native Metho=
d)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.<init>(RandomAcce=
ssFile.java:231)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.apache.lucene.store.FSDirectory.sync(F=
SDirectory.java:456)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1654)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.hp.openvms.lucene.index.FileIndexerJSP=
.jspMain(Unknown
>> Source)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.hp.openvms.lucene.index.FileIndexer.ma=
in(Unknown Source)
>>
>>
>>
>> I have setMaxBufferedDocs =3D 5 and setMergeFactor=3D5. I was trying
>> different
>> combinations of these to see if that helps but was unsuccessful.
>>
>>
>> Regards,
>> Rishi
>> --
>> View this message in context:
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge=
%22-tp24951667p24951667.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Indexer-crashes-with-%2=
2hit-exception-during-merge%22-tp24951667p24952295.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41856-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 10:09:55 2009
Return-Path: <java-user-return-41856-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56222 invoked from network); 13 Aug 2009 10:09:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 10:09:55 -0000
Received: (qmail 54037 invoked by uid 500); 13 Aug 2009 10:10:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53962 invoked by uid 500); 13 Aug 2009 10:10:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53951 invoked by uid 99); 13 Aug 2009 10:10:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:10:00 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:09:48 +0000
Received: by ey-out-2122.google.com with SMTP id 9so113187eyd.53
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 03:09:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=CITiT+GbxrU1JnskcdEAma+thHnW6ClCFLIozT1OVaE=;
        b=cebdinJBNj+8RFEPElaFzXwKUDuQFMQWXxf3K7fjAIt1UJaTl5v2nY9CMS4a7suUKk
         9odSq/IL9xr19UcuIkpDBSqGKwLN0szGwP52hMlKrbBUtaLSXo2a+OAUqqieLCM1LPBJ
         w1UiDPz5tMWqvVqaQhDROq2fbHgGifCg+QuLo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=i5WV8AOt+vinsPX4ibyOCUKVIRx3NkJ12KxQxpqZ7Nq4sqcT7KugYJUb9QuTgOB9ol
         3dQlc1w0JRCJe0fd4XU5F1oRyfT9oFtUhGORsuKU4jxyrYQz1BAX9tHFcO0OiKJokdYV
         pkn1Bxj8g9Iau0Yd+ug0Ojs4wwaqdUWhNylgc=
MIME-Version: 1.0
Received: by 10.216.12.67 with SMTP id 45mr156141wey.218.1250158167867; Thu, 
	13 Aug 2009 03:09:27 -0700 (PDT)
In-Reply-To: <24952295.post@talk.nabble.com>
References: <24951667.post@talk.nabble.com>
	 <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com>
	 <24952295.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 13:09:27 +0300
Message-ID: <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com>
Subject: Re: Indexer crashes with "hit exception during merge"
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364d1d558243500471032152
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364d1d558243500471032152
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Is that a local file system, or a network share?

On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal <singhal.rishi@gmail.com>wrote:

>
> >>Is there any chance that two writers are open on this directory?
> No, thats not true.
>
> >>something external to Lucene is removing files from the directory.
> No this also has rare chances as I am the owner of these files and other
> then me no one can delete the, :-)
>
> Here are all the files in the index directory:
> segments.gen;1      segments_1.;1       segments_2.;1       _0.fdt;1
> _0.fdx;1            _37.cfs;1           _4c.cfs;1           _61.cfs;1
> _9e.cfs;1           _ay.cfs;1           _az.cfs;1           _b0.cfs;1
> _b2.tis;1           _b3.fdt;1           _b4.fdt;1
>
> I see _37 present.
>
> Regards,
> Rishi
>
>
> Michael McCandless-2 wrote:
> >
> > Is there any chance that two writers are open on this directory?  Or,
> > something external to Lucene is removing files from the directory.
> >
> > It looks like there were at least two missing files (_37
> >
> > On Thu, Aug 13, 2009 at 5:19 AM, rishisinghal<singhal.rishi@gmail.com>
> > wrote:
> >>
> >> Hi,
> >>
> >> I am trying to index documents and when all is complete and optimize is
> >> called I get
> >>
> >> IFD [main]: setInfoStream
> >>
> deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@4fced0
> >> IW 0 [main]: setInfoStream:
> >> dir=org.apache.lucene.store.FSDirectory@/SYS$SYSDEVICE/RISHI/melon_1600
> >> autoCommit=false mergePolicy=org
> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
> >> mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@6038e4
> >> ramBufferS
> >> izeMB=16.0 maxBufferedDocs=5 maxBuffereDeleteTerms=-1
> >> maxFieldLength=10000
> >> index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
> >>  _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0 _61:c245->_0
> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> IW 0 [main]:   flush: segment=null docStoreSegment=null docStoreOffset=0
> >> flushDocs=false flushDeletes=true flushDocStores=false numD
> >> ocs=0 numBufDelTerms=0
> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0 _61:c245->_0
> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0 _9e:c485->_0
> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1 pending]
> >> IW 0 [main]: CMS: now merge
> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> IW 0 [main]: CMS:   consider merge _61:c245->_0 _9e:c485->_0
> _ay:c225->_0
> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
> >> IW 0 [main]: CMS:     launch new thread [Lucene Merge Thread #73]
> >> IW 0 [main]: CMS:   no more merges pending; now return
> >> IW 0 [Lucene Merge Thread #73]: CMS:   merge thread: start
> >> IW 0 [Lucene Merge Thread #73]: now merge
> >>  merge=_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into
> >> _b5 [optimize]
> >>  merge=org.apache.lucene.index.MergePolicy$OneMerge@3725db
> >>  index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0 _ay:c225->_0
> >> _az:c5->_0 _b0:c5->_0
> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0 _9e:c485->_0
> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
> >> IW 0 [Lucene Merge Thread #73]: hit exception during merge
> >> Exception in thread "Lucene Merge Thread #73"
> >> org.apache.lucene.index.MergePolicy$MergeException:
> >> java.io.FileNotFoundException: /SY
> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> >>        at
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
> >>        at
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
> >> Caused by: java.io.FileNotFoundException:
> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> >>        at java.io.RandomAccessFile.open(Native Method)
> >>        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
> >>        at
> >>
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
> >>        at
> >>
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
> >>        at
> >> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> >>        at
> >>
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
> >>        at
> >> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> >>        at
> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >>        at
> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> >>        at
> >> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> >>        at
> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> >>        at
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
> >>        at
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
> >> Aug 13, 2009 2:40:56 PM org.hp.openvms.lucene.index.FileIndexerJSP
> >> jspMain
> >> SEVERE: Indexing not completebackground merge hit exception:
> _61:c245->_0
> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
> >> optimize]
> >> java.io.IOException: background merge hit exception: _61:c245->_0
> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize
> >> ]
> >>        at
> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
> >>        at
> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
> >>        at
> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
> >>        at org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
> >> Source)
> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown Source)
> >> Caused by: java.io.FileNotFoundException:
> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> >>        at java.io.RandomAccessFile.open(Native Method)
> >>        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
> >>        at
> >>
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
> >>        at
> >>
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
> >>        at
> >> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> >>        at
> >>
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
> >>        at
> >> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> >>        at
> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >>        at
> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> >>        at
> >> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> >>        at
> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> >>        at
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
> >>        at
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
> >> IW 0 [main]: now flush at close
> >> IW 0 [main]:   flush: segment=null docStoreSegment=null docStoreOffset=0
> >> flushDocs=false flushDeletes=true flushDocStores=false numD
> >> ocs=0 numBufDelTerms=0
> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0 _61:c245->_0
> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> IW 0 [main]: CMS: now merge
> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> IW 0 [main]: CMS:   no more merges pending; now return
> >> IW 0 [main]: now call final commit()
> >> IW 0 [main]: startCommit(): start sizeInBytes=0
> >> IW 0 [main]: startCommit index=_37:c465->_0 _4c:c165->_0 _61:c245->_0
> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=11
> >> 95
> >> IW 0 [main]: now sync _37.cfs
> >> IW 0 [main]: hit exception while closing
> >> Exception in thread "main" java.io.FileNotFoundException:
> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5))
> >>        at java.io.RandomAccessFile.open(Native Method)
> >>        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
> >>        at org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
> >>        at
> >> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
> >>        at
> >> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
> >>        at
> >> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1654)
> >>        at
> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
> >>        at
> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
> >>        at org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
> >> Source)
> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown Source)
> >>
> >>
> >>
> >> I have setMaxBufferedDocs = 5 and setMergeFactor=5. I was trying
> >> different
> >> combinations of these to see if that helps but was unsuccessful.
> >>
> >>
> >> Regards,
> >> Rishi
> >> --
> >> View this message in context:
> >>
> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24951667.html
> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
>
> --
> View this message in context:
> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24952295.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016364d1d558243500471032152--

From java-user-return-41857-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 10:11:24 2009
Return-Path: <java-user-return-41857-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57118 invoked from network); 13 Aug 2009 10:11:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 10:11:24 -0000
Received: (qmail 56290 invoked by uid 500); 13 Aug 2009 10:11:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56207 invoked by uid 500); 13 Aug 2009 10:11:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56197 invoked by uid 99); 13 Aug 2009 10:11:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:11:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:11:19 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbXGt-0003l9-97
	for java-user@lucene.apache.org; Thu, 13 Aug 2009 03:10:59 -0700
Message-ID: <24952356.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 03:10:59 -0700 (PDT)
From: bourne71 <garylkc@live.com>
To: java-user@lucene.apache.org
Subject: Re: Generating Query
In-Reply-To: <884693.1902.qm@web52908.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: garylkc@live.com
References: <24931880.post@talk.nabble.com> <391442.37864.qm@web52912.mail.re2.yahoo.com> <24943981.post@talk.nabble.com> <340389.23662.qm@web52906.mail.re2.yahoo.com> <24951573.post@talk.nabble.com> <884693.1902.qm@web52908.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org


hm...try tat...but doesn't seems to be working for me though

Ahmet Arslan wrote:
>=20
>> I am trying to boost=C2=A0 results that have all the query
>> in it to increase its ranking. But both the query unfortunately does not
>> > seems to effect it
>=20
> Did you read last two messages on this thread?
>=20
> http://www.nabble.com/Generating-Query-for-Multiple-Clauses-in-a-Single-F=
ield-td24694748.html=20
>=20
> And do not forget to use your new similarity class in both indexing and
> searching. IndexSearcher.setSimilarity and IndexWriter.setSimilarity.
>=20
>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Generating-Query-tp2493=
1880p24952356.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41858-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 10:24:40 2009
Return-Path: <java-user-return-41858-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66600 invoked from network); 13 Aug 2009 10:24:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 10:24:40 -0000
Received: (qmail 73219 invoked by uid 500); 13 Aug 2009 10:24:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73134 invoked by uid 500); 13 Aug 2009 10:24:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73124 invoked by uid 99); 13 Aug 2009 10:24:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:24:45 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anshumg@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:24:37 +0000
Received: by fxm2 with SMTP id 2so527605fxm.28
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 03:24:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=/ALjaoOeIpAf80ti5G8DoYmWZ1EkeJCobReoGnz2Bzc=;
        b=o43ofkvZPiL5uQvHu4mFUvXbrS2XarYRVBhQGJDj4dpJhVs+DnALxVzaxLqoM1m7ZG
         YsWxsFekI267ehkCTdebUGdk3v7c1W1ex3B8mHUUkag/CV+T4HrpqbaHhDdDj3pHblhv
         Q8AOoDelhb8xyjuJS4370poSdfb/nXqTHYcdE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=nkfoE/Vv8eYtJj2TPsUcX4UohXwinTncnMwAZKrLafzlMnsGzM9XX6OgK3zZ9IDc+O
         MMbl7aTQuo3PoCEWwc17BOyguJXI4OSF/q5Gn/rjKrKT7wkZbTLqMcSUqzr811dT/3Px
         PN9tN05lFOUIdIros+IQr84bEh0pAw1p44Khs=
MIME-Version: 1.0
Received: by 10.223.116.145 with SMTP id m17mr238402faq.56.1250159055788; Thu, 
	13 Aug 2009 03:24:15 -0700 (PDT)
In-Reply-To: <f18c9dde0908130115s932c485kb1a7c7190595e1cb@mail.gmail.com>
References: <867513fe0908122143g5139355duc47134a13d5406fa@mail.gmail.com>
	 <f18c9dde0908130115s932c485kb1a7c7190595e1cb@mail.gmail.com>
Date: Thu, 13 Aug 2009 15:54:15 +0530
Message-ID: <867513fe0908130324u49ca97f3l7bff462feeb51738@mail.gmail.com>
Subject: Re: Lucene Vs Sphinx benchmarking for large dataset
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c5ac3e6ed9bf0471035651
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5ac3e6ed9bf0471035651
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hey Simon,
Thanks for the comment, though would be great to have the comment @ the
blog! :)
About testing vanilla sphinx Vs Sphinx, have that pipelined but would be
some time before I go ahead and do that.
I'm also planning a benchmarking (of search & indexing) of 2.4 & 2.9 (when
its here) with the most recent version of sphinx (and other search engines).

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Thu, Aug 13, 2009 at 1:45 PM, Simon Willnauer <
simon.willnauer@googlemail.com> wrote:

> Anshum, thanks for posting this on the list. I have a view comments on
> that benchmark while being happy that lucene has an upper hand in
> yours.
> I wonder if you can publish the various modifications you did to
> either of those? If not would it be possible to run the benchmarks
> against the vanilla versions? Did you use an already released version
> of lucene or did you do modifications against the trunk? I found it
> little hard to read - putting it into a table would make little more
> sense to me though. I personally would be interested in what kind of
> analysis you have applied to the index document and the queries
> though.
>
> simon
>
> On Thu, Aug 13, 2009 at 6:43 AM, Anshum<anshumg@gmail.com> wrote:
> > I just happened to benchmark a little modified version of lucene with a
> > little modified version of sphinx :)
> > Have posted my results here
> > http://ai-cafe.blogspot.com
> > Would also be updating more @ the blog in a while!
> >
> > --
> > Anshum Gupta
> > Naukri Labs!
> > http://ai-cafe.blogspot.com
> >
> > The facts expressed here belong to everybody, the opinions to me. The
> > distinction is yours to draw............
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636c5ac3e6ed9bf0471035651--

From java-user-return-41859-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 10:29:17 2009
Return-Path: <java-user-return-41859-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69813 invoked from network); 13 Aug 2009 10:29:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 10:29:17 -0000
Received: (qmail 85033 invoked by uid 500); 13 Aug 2009 10:29:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84940 invoked by uid 500); 13 Aug 2009 10:29:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84930 invoked by uid 99); 13 Aug 2009 10:29:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:29:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:29:11 +0000
Received: by fxm2 with SMTP id 2so529491fxm.28
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 03:28:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=FUjB7FTMtwAMQL87AYvvPo5gKt2Gw/sfffeV2oWJIgc=;
        b=ipSS7CdioFPgip6YE4vYm4/9bOgwQvEY/ULawj0gZWw++9qM7OhHqtdgrSdLSs9DDp
         yI8LY/P6Nw4NgZXAjJfu35v32iW+1POoyrLPD8oSEIxkQ2CU4bjw244HLOeuelqL6Wuo
         In2XY7Y8moU6VYRULn/emny5qC0S6evX7bpDI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=B4rLyh6YBwE554jld0dFM2bBnOwtpyPvAhBHiIs++Hlzy6Xa2vKrggT02Woyw7oW09
         QVFkSq1aLaFu2WCd869R3wZRDNARuznlYOdhnoOTQHXyu97Y/scNxQKfS8MS7QVcO5Bj
         sRAZ6J6WA5+nnUT5kOJan0aQX04FzHFDkcBEs=
MIME-Version: 1.0
Received: by 10.239.156.146 with SMTP id m18mr81366hbc.24.1250159330594; Thu, 
	13 Aug 2009 03:28:50 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <867513fe0908130324u49ca97f3l7bff462feeb51738@mail.gmail.com>
References: <867513fe0908122143g5139355duc47134a13d5406fa@mail.gmail.com>
	 <f18c9dde0908130115s932c485kb1a7c7190595e1cb@mail.gmail.com>
	 <867513fe0908130324u49ca97f3l7bff462feeb51738@mail.gmail.com>
Date: Thu, 13 Aug 2009 12:28:50 +0200
Message-ID: <f18c9dde0908130328q2e306459l7c4769ae11223722@mail.gmail.com>
Subject: Re: Lucene Vs Sphinx benchmarking for large dataset
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Aug 13, 2009 at 12:24 PM, Anshum<anshumg@gmail.com> wrote:
> Hey Simon,
> Thanks for the comment, though would be great to have the comment @ the
> blog! :)
done!

Simon
> About testing vanilla sphinx Vs Sphinx, have that pipelined but would be
> some time before I go ahead and do that.
> I'm also planning a benchmarking (of search & indexing) of 2.4 & 2.9 (when
> its here) with the most recent version of sphinx (and other search engines).
>
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
>
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
>
>
> On Thu, Aug 13, 2009 at 1:45 PM, Simon Willnauer <
> simon.willnauer@googlemail.com> wrote:
>
>> Anshum, thanks for posting this on the list. I have a view comments on
>> that benchmark while being happy that lucene has an upper hand in
>> yours.
>> I wonder if you can publish the various modifications you did to
>> either of those? If not would it be possible to run the benchmarks
>> against the vanilla versions? Did you use an already released version
>> of lucene or did you do modifications against the trunk? I found it
>> little hard to read - putting it into a table would make little more
>> sense to me though. I personally would be interested in what kind of
>> analysis you have applied to the index document and the queries
>> though.
>>
>> simon
>>
>> On Thu, Aug 13, 2009 at 6:43 AM, Anshum<anshumg@gmail.com> wrote:
>> > I just happened to benchmark a little modified version of lucene with a
>> > little modified version of sphinx :)
>> > Have posted my results here
>> > http://ai-cafe.blogspot.com
>> > Would also be updating more @ the blog in a while!
>> >
>> > --
>> > Anshum Gupta
>> > Naukri Labs!
>> > http://ai-cafe.blogspot.com
>> >
>> > The facts expressed here belong to everybody, the opinions to me. The
>> > distinction is yours to draw............
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41860-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 10:53:51 2009
Return-Path: <java-user-return-41860-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81448 invoked from network); 13 Aug 2009 10:53:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 10:53:50 -0000
Received: (qmail 17904 invoked by uid 500); 13 Aug 2009 10:53:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17817 invoked by uid 500); 13 Aug 2009 10:53:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17807 invoked by uid 99); 13 Aug 2009 10:53:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:53:55 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of shichuanwuhan@gmail.com designates 209.85.222.186 as permitted sender)
Received: from [209.85.222.186] (HELO mail-pz0-f186.google.com) (209.85.222.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 10:53:47 +0000
Received: by pzk16 with SMTP id 16so530863pzk.20
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 03:53:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=oTChn+MMqPaTxl5WD7ZUowYHRfcDKKdwTZ5CnfDVC4M=;
        b=CiEzDOeMgEzxyU2SbrHndiWKQr9frve3TdkxTsdjEFaTaBVXBcz8NJFU7i5M9kz8YU
         oVAzroYzF/O8uEjq5f8CqoBp9DudX+m/NshciC7wTbD65+Eu3+ZYwDcKeaNxym11jEU6
         lJuChwSGRl4m30++ySL4+IhqYFEqgnZ2Fe/Co=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=oC7moW0DTNPYTY9wwqG4HUOq5hcCzCyGZ+G6RoRunkcYhu0Cgm71X4pUhcU8SZYsHH
         oHYJEoo2LR2mge8n+YL2mmyROp2ApBvWXTh2kpuZhM0TYroRAE7DGV9pNL3JFMduMraV
         h6Cuz0ZhDP6/+hAbsRabngCDeGQWZVvMdDwOA=
MIME-Version: 1.0
Received: by 10.142.217.13 with SMTP id p13mr153409wfg.260.1250160807184; Thu, 
	13 Aug 2009 03:53:27 -0700 (PDT)
Date: Thu, 13 Aug 2009 18:53:27 +0800
Message-ID: <1c3e185f0908130353x1a354007o7c1cc77251e702b2@mail.gmail.com>
Subject: [EASY]How to change the demo of lucene143 into a multithread one?
From: Chuan SHI <shichuanwuhan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd2e3b0d30d91047103be70
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd2e3b0d30d91047103be70
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi all,
       I am new to multi-thread programming and lucene. I want to change the
indexing demo of lucene143 into a multi-thread one. I create one instance of
IndexWriter which is shared by three threads. But I find that the time it
costs when three threads are used is approximate three times of that of
single thread.(My computer is dual-core) It seems I write a pseudo
multi-thread program and it does the same work for three times.
Following is a snippet of my code. Please tell me how to write the correct
code. Thanks.

IndexWriter writer = new IndexWriter("D:\\index", new StandardAnalyzer(),
true);
File file=new File(args[0]);
Thread t1=new Thread(new IndexFiles(writer,file));
Thread t2=new Thread(new IndexFiles(writer,file));
Thread t3=new Thread(new IndexFiles(writer,file));
t1.start();
t2.start();
t3.start();
writer.optimize();
writer.close();

while(t1.getState()!=State.TERMINATED
||t2.getState()!=State.TERMINATED
||t3.getState()!=State.TERMINATED
){}//wait until the threads end.
Date end = new Date();

-- 
Best regards,

Chuan SHI

--000e0cd2e3b0d30d91047103be70--

From java-user-return-41861-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 11:24:18 2009
Return-Path: <java-user-return-41861-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90332 invoked from network); 13 Aug 2009 11:24:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 11:24:18 -0000
Received: (qmail 63736 invoked by uid 500); 13 Aug 2009 11:24:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63689 invoked by uid 500); 13 Aug 2009 11:24:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63679 invoked by uid 99); 13 Aug 2009 11:24:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 11:24:22 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anshumg@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 11:24:14 +0000
Received: by fxm2 with SMTP id 2so553694fxm.28
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 04:23:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Sh20C41j2PmqjPWbb+SgsE/Ztwlk0xqp8dx2cfPZxBk=;
        b=U4I3CE+sJVPXb8JLlML9wU9H2Ibk2r8/C5U+SeiP7UAuMKJhueRPuInpKv/i6AM6or
         3XWhBlIATLN3NhoUgzwdTFEIILEdVGEL5+WrROJa8oVOw8wQPw8HaxXZAIguZ+4So9eg
         VXfXnQstY0qzsHvqQUqATiGwYDHfP9aGS06r0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Jg3uKvUD2ybARDAODC2CMSFpleZQaexZvawXKEpvPbHWmSTvu1hov/nKJX8Y6ZElxW
         brMnYScbo4g0rn6yfOlHbm2uKEMbADDcKyPgAQpIKCZ9z1EChDOHJBaMSA+9T5QxBfv3
         qfyJnjRCJ4LzUTnp2sKSAj1l4moNoPydAdun4=
MIME-Version: 1.0
Received: by 10.223.144.67 with SMTP id y3mr272202fau.20.1250162632587; Thu, 
	13 Aug 2009 04:23:52 -0700 (PDT)
In-Reply-To: <f18c9dde0908130328q2e306459l7c4769ae11223722@mail.gmail.com>
References: <867513fe0908122143g5139355duc47134a13d5406fa@mail.gmail.com>
	 <f18c9dde0908130115s932c485kb1a7c7190595e1cb@mail.gmail.com>
	 <867513fe0908130324u49ca97f3l7bff462feeb51738@mail.gmail.com>
	 <f18c9dde0908130328q2e306459l7c4769ae11223722@mail.gmail.com>
Date: Thu, 13 Aug 2009 16:53:52 +0530
Message-ID: <867513fe0908130423q399e764va8b9a2a9b5724660@mail.gmail.com>
Subject: Re: Lucene Vs Sphinx benchmarking for large dataset
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org, simon.willnauer@gmail.com
Content-Type: multipart/alternative; boundary=0023545bf548a07bdc0471042ba2
X-Virus-Checked: Checked by ClamAV on apache.org

--0023545bf548a07bdc0471042ba2
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks Simon! :)
--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Thu, Aug 13, 2009 at 3:58 PM, Simon Willnauer <
simon.willnauer@googlemail.com> wrote:

> On Thu, Aug 13, 2009 at 12:24 PM, Anshum<anshumg@gmail.com> wrote:
> > Hey Simon,
> > Thanks for the comment, though would be great to have the comment @ the
> > blog! :)
> done!
>
> Simon
> > About testing vanilla sphinx Vs Sphinx, have that pipelined but would be
> > some time before I go ahead and do that.
> > I'm also planning a benchmarking (of search & indexing) of 2.4 & 2.9
> (when
> > its here) with the most recent version of sphinx (and other search
> engines).
> >
> > --
> > Anshum Gupta
> > Naukri Labs!
> > http://ai-cafe.blogspot.com
> >
> > The facts expressed here belong to everybody, the opinions to me. The
> > distinction is yours to draw............
> >
> >
> > On Thu, Aug 13, 2009 at 1:45 PM, Simon Willnauer <
> > simon.willnauer@googlemail.com> wrote:
> >
> >> Anshum, thanks for posting this on the list. I have a view comments on
> >> that benchmark while being happy that lucene has an upper hand in
> >> yours.
> >> I wonder if you can publish the various modifications you did to
> >> either of those? If not would it be possible to run the benchmarks
> >> against the vanilla versions? Did you use an already released version
> >> of lucene or did you do modifications against the trunk? I found it
> >> little hard to read - putting it into a table would make little more
> >> sense to me though. I personally would be interested in what kind of
> >> analysis you have applied to the index document and the queries
> >> though.
> >>
> >> simon
> >>
> >> On Thu, Aug 13, 2009 at 6:43 AM, Anshum<anshumg@gmail.com> wrote:
> >> > I just happened to benchmark a little modified version of lucene with
> a
> >> > little modified version of sphinx :)
> >> > Have posted my results here
> >> > http://ai-cafe.blogspot.com
> >> > Would also be updating more @ the blog in a while!
> >> >
> >> > --
> >> > Anshum Gupta
> >> > Naukri Labs!
> >> > http://ai-cafe.blogspot.com
> >> >
> >> > The facts expressed here belong to everybody, the opinions to me. The
> >> > distinction is yours to draw............
> >> >
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0023545bf548a07bdc0471042ba2--

From java-user-return-41862-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 11:25:58 2009
Return-Path: <java-user-return-41862-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90690 invoked from network); 13 Aug 2009 11:25:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 11:25:58 -0000
Received: (qmail 67076 invoked by uid 500); 13 Aug 2009 11:26:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66987 invoked by uid 500); 13 Aug 2009 11:26:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66977 invoked by uid 99); 13 Aug 2009 11:26:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 11:26:02 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aminmc@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 11:25:54 +0000
Received: by ewy26 with SMTP id 26so722557ewy.5
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 04:25:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=wBQUMXMfJb+a4cgOYpYpluj95xYd8NFUlMyIpjmJ2/g=;
        b=UV0DOLLjGFwuf5OCORv16FTuxnMR6FlhdV6re31FEmsYvmMkzpRSC+Et7zWo3odt9a
         6wn3fYlayJmbrTPw3i1kfAZr4M+ph2to7zhM3MfpBVqmDK0tb0fLAAPl5XO3EYNq9ARL
         +1ijk1QSvL01h9rDN40Y5FTWTarkka9Bi9UJ0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=mYmQ2r1FBJ0w+BEPmN7hzsPZNyRx4vJA7L3HpBXWXAcnF/PkhXRszfVUQQpsvhXBZY
         OG9P5eDODOGKQB5OYW8COPVRMiFA1/Mbc2EUmW7ZNmwW0VZdTdFwsQlD7zshdjnLFoUB
         cUpJS0kksPKLiLqzqRbV9P+1Iqoh70fhM6TKw=
MIME-Version: 1.0
Received: by 10.216.6.198 with SMTP id 48mr172068wen.200.1250162733469; Thu, 
	13 Aug 2009 04:25:33 -0700 (PDT)
In-Reply-To: <1c3e185f0908130353x1a354007o7c1cc77251e702b2@mail.gmail.com>
References: <1c3e185f0908130353x1a354007o7c1cc77251e702b2@mail.gmail.com>
Date: Thu, 13 Aug 2009 12:25:33 +0100
Message-ID: <6f4104d80908130425r77d88463rdf09a0341b7fa22b@mail.gmail.com>
Subject: Re: [EASY]How to change the demo of lucene143 into a multithread one?
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364d1d91a3d24204710431a0
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364d1d91a3d24204710431a0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi

I have recently created an indexing reference project using Spring
Integration.  May not help you with what you're doing but it might be
interesting for creating asynchronous indexing using JMS.

http://code.google.com/p/lucene-indexing-with-si/

Cheers
Amin


On Thu, Aug 13, 2009 at 11:53 AM, Chuan SHI <shichuanwuhan@gmail.com> wrote:

> Hi all,
>       I am new to multi-thread programming and lucene. I want to change the
> indexing demo of lucene143 into a multi-thread one. I create one instance
> of
> IndexWriter which is shared by three threads. But I find that the time it
> costs when three threads are used is approximate three times of that of
> single thread.(My computer is dual-core) It seems I write a pseudo
> multi-thread program and it does the same work for three times.
> Following is a snippet of my code. Please tell me how to write the correct
> code. Thanks.
>
> IndexWriter writer = new IndexWriter("D:\\index", new StandardAnalyzer(),
> true);
> File file=new File(args[0]);
> Thread t1=new Thread(new IndexFiles(writer,file));
> Thread t2=new Thread(new IndexFiles(writer,file));
> Thread t3=new Thread(new IndexFiles(writer,file));
> t1.start();
> t2.start();
> t3.start();
> writer.optimize();
> writer.close();
>
> while(t1.getState()!=State.TERMINATED
> ||t2.getState()!=State.TERMINATED
> ||t3.getState()!=State.TERMINATED
> ){}//wait until the threads end.
> Date end = new Date();
>
> --
> Best regards,
>
> Chuan SHI
>

--0016364d1d91a3d24204710431a0--

From java-user-return-41863-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 11:41:19 2009
Return-Path: <java-user-return-41863-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93735 invoked from network); 13 Aug 2009 11:41:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 11:41:19 -0000
Received: (qmail 84875 invoked by uid 500); 13 Aug 2009 11:41:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84817 invoked by uid 500); 13 Aug 2009 11:41:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84807 invoked by uid 99); 13 Aug 2009 11:41:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 11:41:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 11:41:13 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbYft-0006x8-2b
	for java-user@lucene.apache.org; Thu, 13 Aug 2009 04:40:53 -0700
Message-ID: <24953406.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 04:40:53 -0700 (PDT)
From: joe_coder <codetester.codetester@gmail.com>
To: java-user@lucene.apache.org
Subject: Term Extraction
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: codetester.codetester@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


I was wondering if there is any way to directly use Lucene API to extract
terms from a given string. My requirement is that I have a text document for
which I need a term frequency vector ( after stemming, removing stopwords
and synonyms checks ). The result needs to be the terms and frequency.

Is it possible to get this using any lucene API? ( As I see lucene also
needs to stem, remove stopwords, synonyms etc before indexing). Or is this
any java project that would help me in this? 
-- 
View this message in context: http://www.nabble.com/Term-Extraction-tp24953406p24953406.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41864-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 12:00:41 2009
Return-Path: <java-user-return-41864-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97007 invoked from network); 13 Aug 2009 12:00:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 12:00:41 -0000
Received: (qmail 10598 invoked by uid 500); 13 Aug 2009 12:00:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10563 invoked by uid 500); 13 Aug 2009 12:00:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10553 invoked by uid 99); 13 Aug 2009 12:00:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:00:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:00:37 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbYye-0007W6-3n
	for java-user@lucene.apache.org; Thu, 13 Aug 2009 05:00:16 -0700
Message-ID: <24953575.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 05:00:15 -0700 (PDT)
From: rishisinghal <singhal.rishi@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Indexer crashes with "hit exception during merge"
In-Reply-To: <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: singhal.rishi@gmail.com
References: <24951667.post@talk.nabble.com> <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com> <24952295.post@talk.nabble.com> <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


It is a local file system.

We are using lucene 2.4 and java 1.5

Regards,
Rishi


Shai Erera wrote:
> 
> Is that a local file system, or a network share?
> 
> On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
> <singhal.rishi@gmail.com>wrote:
> 
>>
>> >>Is there any chance that two writers are open on this directory?
>> No, thats not true.
>>
>> >>something external to Lucene is removing files from the directory.
>> No this also has rare chances as I am the owner of these files and other
>> then me no one can delete the, :-)
>>
>> Here are all the files in the index directory:
>> segments.gen;1      segments_1.;1       segments_2.;1       _0.fdt;1
>> _0.fdx;1            _37.cfs;1           _4c.cfs;1           _61.cfs;1
>> _9e.cfs;1           _ay.cfs;1           _az.cfs;1           _b0.cfs;1
>> _b2.tis;1           _b3.fdt;1           _b4.fdt;1
>>
>> I see _37 present.
>>
>> Regards,
>> Rishi
>>
>>
>> Michael McCandless-2 wrote:
>> >
>> > Is there any chance that two writers are open on this directory?  Or,
>> > something external to Lucene is removing files from the directory.
>> >
>> > It looks like there were at least two missing files (_37
>> >
>> > On Thu, Aug 13, 2009 at 5:19 AM, rishisinghal<singhal.rishi@gmail.com>
>> > wrote:
>> >>
>> >> Hi,
>> >>
>> >> I am trying to index documents and when all is complete and optimize
>> is
>> >> called I get
>> >>
>> >> IFD [main]: setInfoStream
>> >>
>> deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@4fced0
>> >> IW 0 [main]: setInfoStream:
>> >>
>> dir=org.apache.lucene.store.FSDirectory@/SYS$SYSDEVICE/RISHI/melon_1600
>> >> autoCommit=false mergePolicy=org
>> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
>> >> mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@6038e4
>> >> ramBufferS
>> >> izeMB=16.0 maxBufferedDocs=5 maxBuffereDeleteTerms=-1
>> >> maxFieldLength=10000
>> >> index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>> >>  _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0
>> _61:c245->_0
>> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> IW 0 [main]:   flush: segment=null docStoreSegment=null
>> docStoreOffset=0
>> >> flushDocs=false flushDeletes=true flushDocStores=false numD
>> >> ocs=0 numBufDelTerms=0
>> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0
>> _61:c245->_0
>> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0 _9e:c485->_0
>> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1 pending]
>> >> IW 0 [main]: CMS: now merge
>> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
>> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> IW 0 [main]: CMS:   consider merge _61:c245->_0 _9e:c485->_0
>> _ay:c225->_0
>> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>> >> IW 0 [main]: CMS:     launch new thread [Lucene Merge Thread #73]
>> >> IW 0 [main]: CMS:   no more merges pending; now return
>> >> IW 0 [Lucene Merge Thread #73]: CMS:   merge thread: start
>> >> IW 0 [Lucene Merge Thread #73]: now merge
>> >>  merge=_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> into
>> >> _b5 [optimize]
>> >>  merge=org.apache.lucene.index.MergePolicy$OneMerge@3725db
>> >>  index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>> _ay:c225->_0
>> >> _az:c5->_0 _b0:c5->_0
>> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0 _9e:c485->_0
>> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>> >> IW 0 [Lucene Merge Thread #73]: hit exception during merge
>> >> Exception in thread "Lucene Merge Thread #73"
>> >> org.apache.lucene.index.MergePolicy$MergeException:
>> >> java.io.FileNotFoundException: /SY
>> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> >>        at
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
>> >>        at
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
>> >> Caused by: java.io.FileNotFoundException:
>> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> >>        at java.io.RandomAccessFile.open(Native Method)
>> >>        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>> >>        at
>> >>
>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
>> >>        at
>> >>
>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
>> >>        at
>> >> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>> >>        at
>> >>
>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
>> >>        at
>> >>
>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
>> >>        at
>> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>> >>        at
>> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>> >>        at
>> >> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>> >>        at
>> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>> >>        at
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
>> >>        at
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
>> >> Aug 13, 2009 2:40:56 PM org.hp.openvms.lucene.index.FileIndexerJSP
>> >> jspMain
>> >> SEVERE: Indexing not completebackground merge hit exception:
>> _61:c245->_0
>> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
>> >> optimize]
>> >> java.io.IOException: background merge hit exception: _61:c245->_0
>> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize
>> >> ]
>> >>        at
>> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
>> >>        at
>> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
>> >>        at
>> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>> >>        at org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>> >> Source)
>> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown Source)
>> >> Caused by: java.io.FileNotFoundException:
>> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> >>        at java.io.RandomAccessFile.open(Native Method)
>> >>        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>> >>        at
>> >>
>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
>> >>        at
>> >>
>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
>> >>        at
>> >> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>> >>        at
>> >>
>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
>> >>        at
>> >>
>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
>> >>        at
>> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>> >>        at
>> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>> >>        at
>> >> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>> >>        at
>> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>> >>        at
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
>> >>        at
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
>> >> IW 0 [main]: now flush at close
>> >> IW 0 [main]:   flush: segment=null docStoreSegment=null
>> docStoreOffset=0
>> >> flushDocs=false flushDeletes=true flushDocStores=false numD
>> >> ocs=0 numBufDelTerms=0
>> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0
>> _61:c245->_0
>> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> IW 0 [main]: CMS: now merge
>> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
>> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> IW 0 [main]: CMS:   no more merges pending; now return
>> >> IW 0 [main]: now call final commit()
>> >> IW 0 [main]: startCommit(): start sizeInBytes=0
>> >> IW 0 [main]: startCommit index=_37:c465->_0 _4c:c165->_0 _61:c245->_0
>> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=11
>> >> 95
>> >> IW 0 [main]: now sync _37.cfs
>> >> IW 0 [main]: hit exception while closing
>> >> Exception in thread "main" java.io.FileNotFoundException:
>> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5))
>> >>        at java.io.RandomAccessFile.open(Native Method)
>> >>        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>> >>        at
>> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
>> >>        at
>> >> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
>> >>        at
>> >> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
>> >>        at
>> >>
>> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1654)
>> >>        at
>> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
>> >>        at
>> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
>> >>        at org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>> >> Source)
>> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown Source)
>> >>
>> >>
>> >>
>> >> I have setMaxBufferedDocs = 5 and setMergeFactor=5. I was trying
>> >> different
>> >> combinations of these to see if that helps but was unsuccessful.
>> >>
>> >>
>> >> Regards,
>> >> Rishi
>> >> --
>> >> View this message in context:
>> >>
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24951667.html
>> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>> >
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24952295.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24953575.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41865-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 12:08:52 2009
Return-Path: <java-user-return-41865-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98977 invoked from network); 13 Aug 2009 12:08:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 12:08:51 -0000
Received: (qmail 25208 invoked by uid 500); 13 Aug 2009 12:08:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25136 invoked by uid 500); 13 Aug 2009 12:08:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25126 invoked by uid 99); 13 Aug 2009 12:08:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:08:56 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:08:44 +0000
Received: by ewy22 with SMTP id 22so698415ewy.28
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 05:08:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ZQsyxGNMDECsz6bcKdmgrvvFHGmWHcX9fmEIQY/mh4Y=;
        b=UiPJYlui6PYAOfclDtRzTPH369zLqyPq+Xa9o8Ll4NirfrhjXtlg01o450aLsbz1yw
         c6qjpZFbJQ4rsy3Y0sUvZXvJ0aWkC0t3DQ8rP5MJHE9h79G+WEpc1ailOUJkZUFE5tIx
         4U9XCr+j0onabLOVFOguWwPDNEYYhJdDvDnXs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=pj7xBCzbzq9Y19wHMmmdLTBFdhuEXJI+fhzwAQjcUSypz4aMDAIQmvkWGA+4PaxaCg
         y4mr5z2Z2elVqNGR1P3C8xXkNi66nH4T1vnH6dz2RZawKlheDbACglr4gJ+J2qUeP3zI
         jFE6TeNSV3SulJAWS/s95HkGmiTMN2rP0H31g=
MIME-Version: 1.0
Received: by 10.216.90.131 with SMTP id e3mr174466wef.69.1250165304160; Thu, 
	13 Aug 2009 05:08:24 -0700 (PDT)
In-Reply-To: <24953575.post@talk.nabble.com>
References: <24951667.post@talk.nabble.com>
	 <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com>
	 <24952295.post@talk.nabble.com>
	 <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com>
	 <24953575.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 15:08:24 +0300
Message-ID: <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com>
Subject: Re: Indexer crashes with "hit exception during merge"
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6dab171dd71de047104ca36
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6dab171dd71de047104ca36
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I noticed the exception is "Caused by: java.io.FileNotFoundException:
/SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))"

I searched for i/o error (errno:5) and found some information which
associates it w/ a more native IO problem, like corrupt file due to system
crash etc.

Did you experience that? Can you try to create the index somewhere else, or
on another drive?

Shai

On Thu, Aug 13, 2009 at 3:00 PM, rishisinghal <singhal.rishi@gmail.com>wrote:

>
> It is a local file system.
>
> We are using lucene 2.4 and java 1.5
>
> Regards,
> Rishi
>
>
> Shai Erera wrote:
> >
> > Is that a local file system, or a network share?
> >
> > On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
> > <singhal.rishi@gmail.com>wrote:
> >
> >>
> >> >>Is there any chance that two writers are open on this directory?
> >> No, thats not true.
> >>
> >> >>something external to Lucene is removing files from the directory.
> >> No this also has rare chances as I am the owner of these files and other
> >> then me no one can delete the, :-)
> >>
> >> Here are all the files in the index directory:
> >> segments.gen;1      segments_1.;1       segments_2.;1       _0.fdt;1
> >> _0.fdx;1            _37.cfs;1           _4c.cfs;1           _61.cfs;1
> >> _9e.cfs;1           _ay.cfs;1           _az.cfs;1           _b0.cfs;1
> >> _b2.tis;1           _b3.fdt;1           _b4.fdt;1
> >>
> >> I see _37 present.
> >>
> >> Regards,
> >> Rishi
> >>
> >>
> >> Michael McCandless-2 wrote:
> >> >
> >> > Is there any chance that two writers are open on this directory?  Or,
> >> > something external to Lucene is removing files from the directory.
> >> >
> >> > It looks like there were at least two missing files (_37
> >> >
> >> > On Thu, Aug 13, 2009 at 5:19 AM, rishisinghal<singhal.rishi@gmail.com
> >
> >> > wrote:
> >> >>
> >> >> Hi,
> >> >>
> >> >> I am trying to index documents and when all is complete and optimize
> >> is
> >> >> called I get
> >> >>
> >> >> IFD [main]: setInfoStream
> >> >>
> >>
> deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@4fced0
> >> >> IW 0 [main]: setInfoStream:
> >> >>
> >> dir=org.apache.lucene.store.FSDirectory@/SYS$SYSDEVICE/RISHI/melon_1600
> >> >> autoCommit=false mergePolicy=org
> >> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
> >> >>
> mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@6038e4
> >> >> ramBufferS
> >> >> izeMB=16.0 maxBufferedDocs=5 maxBuffereDeleteTerms=-1
> >> >> maxFieldLength=10000
> >> >> index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
> >> >>  _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0
> >> _61:c245->_0
> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> >> IW 0 [main]:   flush: segment=null docStoreSegment=null
> >> docStoreOffset=0
> >> >> flushDocs=false flushDeletes=true flushDocStores=false numD
> >> >> ocs=0 numBufDelTerms=0
> >> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0
> >> _61:c245->_0
> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0 _9e:c485->_0
> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1 pending]
> >> >> IW 0 [main]: CMS: now merge
> >> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> >> IW 0 [main]: CMS:   consider merge _61:c245->_0 _9e:c485->_0
> >> _ay:c225->_0
> >> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
> >> >> IW 0 [main]: CMS:     launch new thread [Lucene Merge Thread #73]
> >> >> IW 0 [main]: CMS:   no more merges pending; now return
> >> >> IW 0 [Lucene Merge Thread #73]: CMS:   merge thread: start
> >> >> IW 0 [Lucene Merge Thread #73]: now merge
> >> >>  merge=_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> into
> >> >> _b5 [optimize]
> >> >>  merge=org.apache.lucene.index.MergePolicy$OneMerge@3725db
> >> >>  index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
> >> _ay:c225->_0
> >> >> _az:c5->_0 _b0:c5->_0
> >> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0 _9e:c485->_0
> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
> >> >> IW 0 [Lucene Merge Thread #73]: hit exception during merge
> >> >> Exception in thread "Lucene Merge Thread #73"
> >> >> org.apache.lucene.index.MergePolicy$MergeException:
> >> >> java.io.FileNotFoundException: /SY
> >> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> >> >>        at
> >> >>
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
> >> >>        at
> >> >>
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
> >> >> Caused by: java.io.FileNotFoundException:
> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> >> >>        at java.io.RandomAccessFile.open(Native Method)
> >> >>        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
> >> >>        at
> >> >>
> >>
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
> >> >>        at
> >> >>
> >>
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
> >> >>        at
> >> >> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> >> >>        at
> >> >>
> >>
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
> >> >>        at
> >> >>
> >> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> >> >>        at
> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >> >>        at
> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> >> >>        at
> >> >>
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> >> >>        at
> >> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> >> >>        at
> >> >>
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
> >> >>        at
> >> >>
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
> >> >> Aug 13, 2009 2:40:56 PM org.hp.openvms.lucene.index.FileIndexerJSP
> >> >> jspMain
> >> >> SEVERE: Indexing not completebackground merge hit exception:
> >> _61:c245->_0
> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
> >> >> optimize]
> >> >> java.io.IOException: background merge hit exception: _61:c245->_0
> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize
> >> >> ]
> >> >>        at
> >> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
> >> >>        at
> >> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
> >> >>        at
> >> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
> >> >>        at org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
> >> >> Source)
> >> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown
> Source)
> >> >> Caused by: java.io.FileNotFoundException:
> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> >> >>        at java.io.RandomAccessFile.open(Native Method)
> >> >>        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
> >> >>        at
> >> >>
> >>
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
> >> >>        at
> >> >>
> >>
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
> >> >>        at
> >> >> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> >> >>        at
> >> >>
> >>
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
> >> >>        at
> >> >>
> >> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> >> >>        at
> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >> >>        at
> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> >> >>        at
> >> >>
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> >> >>        at
> >> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> >> >>        at
> >> >>
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
> >> >>        at
> >> >>
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
> >> >> IW 0 [main]: now flush at close
> >> >> IW 0 [main]:   flush: segment=null docStoreSegment=null
> >> docStoreOffset=0
> >> >> flushDocs=false flushDeletes=true flushDocStores=false numD
> >> >> ocs=0 numBufDelTerms=0
> >> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0
> >> _61:c245->_0
> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> >> IW 0 [main]: CMS: now merge
> >> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >> >> IW 0 [main]: CMS:   no more merges pending; now return
> >> >> IW 0 [main]: now call final commit()
> >> >> IW 0 [main]: startCommit(): start sizeInBytes=0
> >> >> IW 0 [main]: startCommit index=_37:c465->_0 _4c:c165->_0 _61:c245->_0
> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=11
> >> >> 95
> >> >> IW 0 [main]: now sync _37.cfs
> >> >> IW 0 [main]: hit exception while closing
> >> >> Exception in thread "main" java.io.FileNotFoundException:
> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5))
> >> >>        at java.io.RandomAccessFile.open(Native Method)
> >> >>        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
> >> >>        at
> >> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
> >> >>        at
> >> >>
> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
> >> >>        at
> >> >> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
> >> >>        at
> >> >>
> >> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1654)
> >> >>        at
> >> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
> >> >>        at
> >> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
> >> >>        at org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
> >> >> Source)
> >> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown
> Source)
> >> >>
> >> >>
> >> >>
> >> >> I have setMaxBufferedDocs = 5 and setMergeFactor=5. I was trying
> >> >> different
> >> >> combinations of these to see if that helps but was unsuccessful.
> >> >>
> >> >>
> >> >> Regards,
> >> >> Rishi
> >> >> --
> >> >> View this message in context:
> >> >>
> >>
> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24951667.html
> >> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >> >>
> >> >>
> >> >> ---------------------------------------------------------------------
> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >>
> >> >>
> >> >
> >> > ---------------------------------------------------------------------
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >> >
> >> >
> >>
> >> --
> >> View this message in context:
> >>
> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24952295.html
> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> >
>
> --
> View this message in context:
> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24953575.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6dab171dd71de047104ca36--

From java-user-return-41866-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 12:19:53 2009
Return-Path: <java-user-return-41866-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7792 invoked from network); 13 Aug 2009 12:19:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 12:19:53 -0000
Received: (qmail 46410 invoked by uid 500); 13 Aug 2009 12:19:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46349 invoked by uid 500); 13 Aug 2009 12:19:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46339 invoked by uid 99); 13 Aug 2009 12:19:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:19:57 +0000
X-ASF-Spam-Status: No, hits=-5.8 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_HI,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Ueli.Kistler@trivadis.com designates 212.249.206.77 as permitted sender)
Received: from [212.249.206.77] (HELO mailx2.trivadis.com) (212.249.206.77)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:19:49 +0000
X-ASG-Debug-ID: 1250166009-170802480000-H1Y1KX
X-Barracuda-URL: http://mailx1.trivadis.com:8000/cgi-bin/mark.cgi
Received: from mailx2.trivadis.com (localhost [127.0.0.1])
	by mailx2.trivadis.com (Spam & Virus Firewall) with ESMTP id 910D64228C4
	for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 14:20:09 +0200 (CEST)
Received: from mailx2.trivadis.com ([172.16.34.102]) by mailx2.trivadis.com with ESMTP id yOGaARYFK3dNnnIC for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 14:20:09 +0200 (CEST)
X-Barracuda-Envelope-From: Ueli.Kistler@trivadis.com
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01CA1C10.4CB9A9E4"
X-ASG-Orig-Subj: Wildcard search fails
Subject: Wildcard search fails
Date: Thu, 13 Aug 2009 14:19:25 +0200
Message-ID: <F2C9CCA71510B442AF71446CAE8AEBAF0184FC4C@MSXVS04.trivadis.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Wildcard search fails
Thread-Index: AcocEExFHOxlyEZOStO0wO1RGZLunA==
From: "Ueli Kistler" <Ueli.Kistler@trivadis.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: UNKNOWN[172.16.34.102]
X-Barracuda-Start-Time: 1250166009
X-Barracuda-Virus-Scanned: by Trivadis Spam Firewall at trivadis.com
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01CA1C10.4CB9A9E4
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hello,

=20

We're experiencing a problem using Lucene 2.4.1 and Compass 2.1.4 using
wildcard search.

Attribute values containing slashes can be searched using the full word,
but not using wildcards. We already tried different analyzers with the
same result.

Slash isn't mentioned as a stop word only backslash also.

=20

Example : Searching < RZ/G/17 > and also < RZ/G/22 > succeed, but <
RZ/G/* > , < RZ/G* > or < RZ/G/ ?? > don't.

=20

Any ideas why wildcard search doesn't work?

=20

Thanks,

Ueli Kistler

=20


------_=_NextPart_001_01CA1C10.4CB9A9E4--

From java-user-return-41867-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 12:22:12 2009
Return-Path: <java-user-return-41867-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8873 invoked from network); 13 Aug 2009 12:22:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 12:22:12 -0000
Received: (qmail 54762 invoked by uid 500); 13 Aug 2009 12:22:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54694 invoked by uid 500); 13 Aug 2009 12:22:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54684 invoked by uid 99); 13 Aug 2009 12:22:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:22:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:22:05 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbZJQ-0008IX-GO
	for java-user@lucene.apache.org; Thu, 13 Aug 2009 05:21:44 -0700
Message-ID: <24953833.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 05:21:44 -0700 (PDT)
From: rishisinghal <singhal.rishi@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Indexer crashes with "hit exception during merge"
In-Reply-To: <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: singhal.rishi@gmail.com
References: <24951667.post@talk.nabble.com> <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com> <24952295.post@talk.nabble.com> <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com> <24953575.post@talk.nabble.com> <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


I tried creating the index in different disks but still i see the issue :-(

I tried to index documents in other disks also and got the same exception. 

I also tried
$ java org.apache.lucene.index.CheckIndex /SYS$SYSDEVICE/RISHI/melon_1600/
-segment _61
NOTE: testing will be more thorough if you run java with
'-ea:org.apache.lucene...', so assertions are enabled
Opening index @ /SYS$SYSDEVICE/RISHI/melon_1600/
Segments file=segments_1 numSegments=0 version=FORMAT_HAS_PROX [Lucene 2.4]

Checking only these segments: _61:
No problems were detected with this index.

Regards,
Rishi


Shai Erera wrote:
> 
> I noticed the exception is "Caused by: java.io.FileNotFoundException:
> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))"
> 
> I searched for i/o error (errno:5) and found some information which
> associates it w/ a more native IO problem, like corrupt file due to system
> crash etc.
> 
> Did you experience that? Can you try to create the index somewhere else,
> or
> on another drive?
> 
> Shai
> 
> On Thu, Aug 13, 2009 at 3:00 PM, rishisinghal
> <singhal.rishi@gmail.com>wrote:
> 
>>
>> It is a local file system.
>>
>> We are using lucene 2.4 and java 1.5
>>
>> Regards,
>> Rishi
>>
>>
>> Shai Erera wrote:
>> >
>> > Is that a local file system, or a network share?
>> >
>> > On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
>> > <singhal.rishi@gmail.com>wrote:
>> >
>> >>
>> >> >>Is there any chance that two writers are open on this directory?
>> >> No, thats not true.
>> >>
>> >> >>something external to Lucene is removing files from the directory.
>> >> No this also has rare chances as I am the owner of these files and
>> other
>> >> then me no one can delete the, :-)
>> >>
>> >> Here are all the files in the index directory:
>> >> segments.gen;1      segments_1.;1       segments_2.;1       _0.fdt;1
>> >> _0.fdx;1            _37.cfs;1           _4c.cfs;1           _61.cfs;1
>> >> _9e.cfs;1           _ay.cfs;1           _az.cfs;1           _b0.cfs;1
>> >> _b2.tis;1           _b3.fdt;1           _b4.fdt;1
>> >>
>> >> I see _37 present.
>> >>
>> >> Regards,
>> >> Rishi
>> >>
>> >>
>> >> Michael McCandless-2 wrote:
>> >> >
>> >> > Is there any chance that two writers are open on this directory? 
>> Or,
>> >> > something external to Lucene is removing files from the directory.
>> >> >
>> >> > It looks like there were at least two missing files (_37
>> >> >
>> >> > On Thu, Aug 13, 2009 at 5:19 AM,
>> rishisinghal<singhal.rishi@gmail.com
>> >
>> >> > wrote:
>> >> >>
>> >> >> Hi,
>> >> >>
>> >> >> I am trying to index documents and when all is complete and
>> optimize
>> >> is
>> >> >> called I get
>> >> >>
>> >> >> IFD [main]: setInfoStream
>> >> >>
>> >>
>> deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@4fced0
>> >> >> IW 0 [main]: setInfoStream:
>> >> >>
>> >>
>> dir=org.apache.lucene.store.FSDirectory@/SYS$SYSDEVICE/RISHI/melon_1600
>> >> >> autoCommit=false mergePolicy=org
>> >> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
>> >> >>
>> mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@6038e4
>> >> >> ramBufferS
>> >> >> izeMB=16.0 maxBufferedDocs=5 maxBuffereDeleteTerms=-1
>> >> >> maxFieldLength=10000
>> >> >> index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>> >> >>  _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0
>> >> _61:c245->_0
>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> >> IW 0 [main]:   flush: segment=null docStoreSegment=null
>> >> docStoreOffset=0
>> >> >> flushDocs=false flushDeletes=true flushDocStores=false numD
>> >> >> ocs=0 numBufDelTerms=0
>> >> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0
>> >> _61:c245->_0
>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0 _9e:c485->_0
>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1 pending]
>> >> >> IW 0 [main]: CMS: now merge
>> >> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> >> IW 0 [main]: CMS:   consider merge _61:c245->_0 _9e:c485->_0
>> >> _ay:c225->_0
>> >> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>> >> >> IW 0 [main]: CMS:     launch new thread [Lucene Merge Thread #73]
>> >> >> IW 0 [main]: CMS:   no more merges pending; now return
>> >> >> IW 0 [Lucene Merge Thread #73]: CMS:   merge thread: start
>> >> >> IW 0 [Lucene Merge Thread #73]: now merge
>> >> >>  merge=_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> into
>> >> >> _b5 [optimize]
>> >> >>  merge=org.apache.lucene.index.MergePolicy$OneMerge@3725db
>> >> >>  index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>> >> _ay:c225->_0
>> >> >> _az:c5->_0 _b0:c5->_0
>> >> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0 _9e:c485->_0
>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>> >> >> IW 0 [Lucene Merge Thread #73]: hit exception during merge
>> >> >> Exception in thread "Lucene Merge Thread #73"
>> >> >> org.apache.lucene.index.MergePolicy$MergeException:
>> >> >> java.io.FileNotFoundException: /SY
>> >> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
>> >> >> Caused by: java.io.FileNotFoundException:
>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> >> >>        at java.io.RandomAccessFile.open(Native Method)
>> >> >>        at
>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
>> >> >>        at
>> >> >> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
>> >> >>        at
>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>> >> >>        at
>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>> >> >>        at
>> >> >>
>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>> >> >>        at
>> >> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
>> >> >> Aug 13, 2009 2:40:56 PM org.hp.openvms.lucene.index.FileIndexerJSP
>> >> >> jspMain
>> >> >> SEVERE: Indexing not completebackground merge hit exception:
>> >> _61:c245->_0
>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
>> >> >> optimize]
>> >> >> java.io.IOException: background merge hit exception: _61:c245->_0
>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize
>> >> >> ]
>> >> >>        at
>> >> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
>> >> >>        at
>> >> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
>> >> >>        at
>> >> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>> >> >>        at
>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>> >> >> Source)
>> >> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>> Source)
>> >> >> Caused by: java.io.FileNotFoundException:
>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> >> >>        at java.io.RandomAccessFile.open(Native Method)
>> >> >>        at
>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
>> >> >>        at
>> >> >> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
>> >> >>        at
>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>> >> >>        at
>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>> >> >>        at
>> >> >>
>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>> >> >>        at
>> >> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
>> >> >> IW 0 [main]: now flush at close
>> >> >> IW 0 [main]:   flush: segment=null docStoreSegment=null
>> >> docStoreOffset=0
>> >> >> flushDocs=false flushDeletes=true flushDocStores=false numD
>> >> >> ocs=0 numBufDelTerms=0
>> >> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0
>> >> _61:c245->_0
>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> >> IW 0 [main]: CMS: now merge
>> >> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0 _61:c245->_0
>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >> >> IW 0 [main]: CMS:   no more merges pending; now return
>> >> >> IW 0 [main]: now call final commit()
>> >> >> IW 0 [main]: startCommit(): start sizeInBytes=0
>> >> >> IW 0 [main]: startCommit index=_37:c465->_0 _4c:c165->_0
>> _61:c245->_0
>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=11
>> >> >> 95
>> >> >> IW 0 [main]: now sync _37.cfs
>> >> >> IW 0 [main]: hit exception while closing
>> >> >> Exception in thread "main" java.io.FileNotFoundException:
>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5))
>> >> >>        at java.io.RandomAccessFile.open(Native Method)
>> >> >>        at
>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>> >> >>        at
>> >> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
>> >> >>        at
>> >> >>
>> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
>> >> >>        at
>> >> >> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
>> >> >>        at
>> >> >>
>> >>
>> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1654)
>> >> >>        at
>> >> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
>> >> >>        at
>> >> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
>> >> >>        at
>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>> >> >> Source)
>> >> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>> Source)
>> >> >>
>> >> >>
>> >> >>
>> >> >> I have setMaxBufferedDocs = 5 and setMergeFactor=5. I was trying
>> >> >> different
>> >> >> combinations of these to see if that helps but was unsuccessful.
>> >> >>
>> >> >>
>> >> >> Regards,
>> >> >> Rishi
>> >> >> --
>> >> >> View this message in context:
>> >> >>
>> >>
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24951667.html
>> >> >> Sent from the Lucene - Java Users mailing list archive at
>> Nabble.com.
>> >> >>
>> >> >>
>> >> >>
>> ---------------------------------------------------------------------
>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >> >>
>> >> >>
>> >> >
>> >> >
>> ---------------------------------------------------------------------
>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >> >
>> >> >
>> >> >
>> >>
>> >> --
>> >> View this message in context:
>> >>
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24952295.html
>> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>> >
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24953575.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24953833.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41868-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 12:27:13 2009
Return-Path: <java-user-return-41868-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10643 invoked from network); 13 Aug 2009 12:27:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 12:27:12 -0000
Received: (qmail 67910 invoked by uid 500); 13 Aug 2009 12:27:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67855 invoked by uid 500); 13 Aug 2009 12:27:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67845 invoked by uid 99); 13 Aug 2009 12:27:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:27:16 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.202] (HELO spunkymail-a7.g.dreamhost.com) (208.97.132.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:27:06 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a7.g.dreamhost.com (Postfix) with ESMTP id D28F45B5A9
	for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 05:26:45 -0700 (PDT)
Message-Id: <52395A4A-D1A5-4370-8834-1F9014D02A0F@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <24953406.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Term Extraction
Date: Thu, 13 Aug 2009 08:26:44 -0400
References: <24953406.post@talk.nabble.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


On Aug 13, 2009, at 7:40 AM, joe_coder wrote:

>
> I was wondering if there is any way to directly use Lucene API to  
> extract
> terms from a given string. My requirement is that I have a text  
> document for
> which I need a term frequency vector ( after stemming, removing  
> stopwords
> and synonyms checks ). The result needs to be the terms and frequency.

IndexReader.getTermFreqVector(), assuming you have indexed using Term  
Vectors.


>
> Is it possible to get this using any lucene API? ( As I see lucene  
> also
> needs to stem, remove stopwords, synonyms etc before indexing). Or  
> is this
> any java project that would help me in this?
> -- 
> View this message in context: http://www.nabble.com/Term-Extraction-tp24953406p24953406.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41869-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 12:36:21 2009
Return-Path: <java-user-return-41869-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13630 invoked from network); 13 Aug 2009 12:36:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 12:36:21 -0000
Received: (qmail 80102 invoked by uid 500); 13 Aug 2009 12:36:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80012 invoked by uid 500); 13 Aug 2009 12:36:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80001 invoked by uid 99); 13 Aug 2009 12:36:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:36:25 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.200] (HELO mail-yw0-f200.google.com) (209.85.211.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:36:14 +0000
Received: by ywh38 with SMTP id 38so909964ywh.20
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 05:35:52 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.59.12 with SMTP id h12mr1357730yba.39.1250166951663; Thu, 
	13 Aug 2009 05:35:51 -0700 (PDT)
In-Reply-To: <24953833.post@talk.nabble.com>
References: <24951667.post@talk.nabble.com>
	 <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com>
	 <24952295.post@talk.nabble.com>
	 <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com>
	 <24953575.post@talk.nabble.com>
	 <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com>
	 <24953833.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 08:35:51 -0400
Message-ID: <9ac0c6aa0908130535x68ad6b4atcf0663a4b046f0f9@mail.gmail.com>
Subject: Re: Indexer crashes with "hit exception during merge"
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

It's very odd that CheckIndex has no trouble opening the segment's
files, yet when you run optimize the OS reports a "file not found"
exception (errno 5).  Something odd is happening at the OS/filesystem
level.

What OS are you running on?

Can you boil this down to a smallish standalone test that shows the problem=
?

Mike

On Thu, Aug 13, 2009 at 8:21 AM, rishisinghal<singhal.rishi@gmail.com> wrot=
e:
>
> I tried creating the index in different disks but still i see the issue :=
-(
>
> I tried to index documents in other disks also and got the same exception=
.
>
> I also tried
> $ java org.apache.lucene.index.CheckIndex /SYS$SYSDEVICE/RISHI/melon_1600=
/
> -segment _61
> NOTE: testing will be more thorough if you run java with
> '-ea:org.apache.lucene...', so assertions are enabled
> Opening index @ /SYS$SYSDEVICE/RISHI/melon_1600/
> Segments file=3Dsegments_1 numSegments=3D0 version=3DFORMAT_HAS_PROX [Luc=
ene 2.4]
>
> Checking only these segments: _61:
> No problems were detected with this index.
>
> Regards,
> Rishi
>
>
> Shai Erera wrote:
>>
>> I noticed the exception is "Caused by: java.io.FileNotFoundException:
>> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))"
>>
>> I searched for i/o error (errno:5) and found some information which
>> associates it w/ a more native IO problem, like corrupt file due to syst=
em
>> crash etc.
>>
>> Did you experience that? Can you try to create the index somewhere else,
>> or
>> on another drive?
>>
>> Shai
>>
>> On Thu, Aug 13, 2009 at 3:00 PM, rishisinghal
>> <singhal.rishi@gmail.com>wrote:
>>
>>>
>>> It is a local file system.
>>>
>>> We are using lucene 2.4 and java 1.5
>>>
>>> Regards,
>>> Rishi
>>>
>>>
>>> Shai Erera wrote:
>>> >
>>> > Is that a local file system, or a network share?
>>> >
>>> > On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
>>> > <singhal.rishi@gmail.com>wrote:
>>> >
>>> >>
>>> >> >>Is there any chance that two writers are open on this directory?
>>> >> No, thats not true.
>>> >>
>>> >> >>something external to Lucene is removing files from the directory.
>>> >> No this also has rare chances as I am the owner of these files and
>>> other
>>> >> then me no one can delete the, :-)
>>> >>
>>> >> Here are all the files in the index directory:
>>> >> segments.gen;1 =A0 =A0 =A0segments_1.;1 =A0 =A0 =A0 segments_2.;1 =
=A0 =A0 =A0 _0.fdt;1
>>> >> _0.fdx;1 =A0 =A0 =A0 =A0 =A0 =A0_37.cfs;1 =A0 =A0 =A0 =A0 =A0 _4c.cf=
s;1 =A0 =A0 =A0 =A0 =A0 _61.cfs;1
>>> >> _9e.cfs;1 =A0 =A0 =A0 =A0 =A0 _ay.cfs;1 =A0 =A0 =A0 =A0 =A0 _az.cfs;=
1 =A0 =A0 =A0 =A0 =A0 _b0.cfs;1
>>> >> _b2.tis;1 =A0 =A0 =A0 =A0 =A0 _b3.fdt;1 =A0 =A0 =A0 =A0 =A0 _b4.fdt;=
1
>>> >>
>>> >> I see _37 present.
>>> >>
>>> >> Regards,
>>> >> Rishi
>>> >>
>>> >>
>>> >> Michael McCandless-2 wrote:
>>> >> >
>>> >> > Is there any chance that two writers are open on this directory?
>>> Or,
>>> >> > something external to Lucene is removing files from the directory.
>>> >> >
>>> >> > It looks like there were at least two missing files (_37
>>> >> >
>>> >> > On Thu, Aug 13, 2009 at 5:19 AM,
>>> rishisinghal<singhal.rishi@gmail.com
>>> >
>>> >> > wrote:
>>> >> >>
>>> >> >> Hi,
>>> >> >>
>>> >> >> I am trying to index documents and when all is complete and
>>> optimize
>>> >> is
>>> >> >> called I get
>>> >> >>
>>> >> >> IFD [main]: setInfoStream
>>> >> >>
>>> >>
>>> deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionPoli=
cy@4fced0
>>> >> >> IW 0 [main]: setInfoStream:
>>> >> >>
>>> >>
>>> dir=3Dorg.apache.lucene.store.FSDirectory@/SYS$SYSDEVICE/RISHI/melon_16=
00
>>> >> >> autoCommit=3Dfalse mergePolicy=3Dorg
>>> >> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
>>> >> >>
>>> mergeScheduler=3Dorg.apache.lucene.index.ConcurrentMergeScheduler@6038e=
4
>>> >> >> ramBufferS
>>> >> >> izeMB=3D16.0 maxBufferedDocs=3D5 maxBuffereDeleteTerms=3D-1
>>> >> >> maxFieldLength=3D10000
>>> >> >> index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>>> >> >> =A0_ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0
>>> >> _61:c245->_0
>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >> >> IW 0 [main]: =A0 flush: segment=3Dnull docStoreSegment=3Dnull
>>> >> docStoreOffset=3D0
>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfalse numD
>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>> >> >> IW 0 [main]: =A0 index before flush _37:c465->_0 _4c:c165->_0
>>> >> _61:c245->_0
>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0 _9e:c485->_=
0
>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1 pending]
>>> >> >> IW 0 [main]: CMS: now merge
>>> >> >> IW 0 [main]: CMS: =A0 index: _37:c465->_0 _4c:c165->_0 _61:c245->=
_0
>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >> >> IW 0 [main]: CMS: =A0 consider merge _61:c245->_0 _9e:c485->_0
>>> >> _ay:c225->_0
>>> >> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>> >> >> IW 0 [main]: CMS: =A0 =A0 launch new thread [Lucene Merge Thread =
#73]
>>> >> >> IW 0 [main]: CMS: =A0 no more merges pending; now return
>>> >> >> IW 0 [Lucene Merge Thread #73]: CMS: =A0 merge thread: start
>>> >> >> IW 0 [Lucene Merge Thread #73]: now merge
>>> >> >> =A0merge=3D_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:=
c5->_0
>>> >> into
>>> >> >> _b5 [optimize]
>>> >> >> =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@3725db
>>> >> >> =A0index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>>> >> _ay:c225->_0
>>> >> >> _az:c5->_0 _b0:c5->_0
>>> >> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0 _9e:c485->_0
>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>> >> >> IW 0 [Lucene Merge Thread #73]: hit exception during merge
>>> >> >> Exception in thread "Lucene Merge Thread #73"
>>> >> >> org.apache.lucene.index.MergePolicy$MergeException:
>>> >> >> java.io.FileNotFoundException: /SY
>>> >> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(C=
oncurrentMergeScheduler.java:309)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concur=
rentMergeScheduler.java:286)
>>> >> >> Caused by: java.io.FileNotFoundException:
>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>>> >> >> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Method)
>>> >> >> =A0 =A0 =A0 =A0at
>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDi=
rectory.java:552)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.jav=
a:582)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:48=
8)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.ja=
va:70)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321=
)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerg=
eScheduler.java:205)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concur=
rentMergeScheduler.java:260)
>>> >> >> Aug 13, 2009 2:40:56 PM org.hp.openvms.lucene.index.FileIndexerJS=
P
>>> >> >> jspMain
>>> >> >> SEVERE: Indexing not completebackground merge hit exception:
>>> >> _61:c245->_0
>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
>>> >> >> optimize]
>>> >> >> java.io.IOException: background merge hit exception: _61:c245->_0
>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimiz=
e
>>> >> >> ]
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:227=
3)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:221=
8)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:219=
8)
>>> >> >> =A0 =A0 =A0 =A0at
>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>> >> >> Source)
>>> >> >> =A0 =A0 =A0 =A0at org.hp.openvms.lucene.index.FileIndexer.main(Un=
known
>>> Source)
>>> >> >> Caused by: java.io.FileNotFoundException:
>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>>> >> >> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Method)
>>> >> >> =A0 =A0 =A0 =A0at
>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDi=
rectory.java:552)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.jav=
a:582)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:48=
8)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.ja=
va:70)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321=
)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerg=
eScheduler.java:205)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concur=
rentMergeScheduler.java:260)
>>> >> >> IW 0 [main]: now flush at close
>>> >> >> IW 0 [main]: =A0 flush: segment=3Dnull docStoreSegment=3Dnull
>>> >> docStoreOffset=3D0
>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfalse numD
>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>> >> >> IW 0 [main]: =A0 index before flush _37:c465->_0 _4c:c165->_0
>>> >> _61:c245->_0
>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >> >> IW 0 [main]: CMS: now merge
>>> >> >> IW 0 [main]: CMS: =A0 index: _37:c465->_0 _4c:c165->_0 _61:c245->=
_0
>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >> >> IW 0 [main]: CMS: =A0 no more merges pending; now return
>>> >> >> IW 0 [main]: now call final commit()
>>> >> >> IW 0 [main]: startCommit(): start sizeInBytes=3D0
>>> >> >> IW 0 [main]: startCommit index=3D_37:c465->_0 _4c:c165->_0
>>> _61:c245->_0
>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=3D11
>>> >> >> 95
>>> >> >> IW 0 [main]: now sync _37.cfs
>>> >> >> IW 0 [main]: hit exception while closing
>>> >> >> Exception in thread "main" java.io.FileNotFoundException:
>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5))
>>> >> >> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Method)
>>> >> >> =A0 =A0 =A0 =A0at
>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >>
>>> >>
>>> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1654=
)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
>>> >> >> =A0 =A0 =A0 =A0at
>>> >> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
>>> >> >> =A0 =A0 =A0 =A0at
>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>> >> >> Source)
>>> >> >> =A0 =A0 =A0 =A0at org.hp.openvms.lucene.index.FileIndexer.main(Un=
known
>>> Source)
>>> >> >>
>>> >> >>
>>> >> >>
>>> >> >> I have setMaxBufferedDocs =3D 5 and setMergeFactor=3D5. I was try=
ing
>>> >> >> different
>>> >> >> combinations of these to see if that helps but was unsuccessful.
>>> >> >>
>>> >> >>
>>> >> >> Regards,
>>> >> >> Rishi
>>> >> >> --
>>> >> >> View this message in context:
>>> >> >>
>>> >>
>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merg=
e%22-tp24951667p24951667.html
>>> >> >> Sent from the Lucene - Java Users mailing list archive at
>>> Nabble.com.
>>> >> >>
>>> >> >>
>>> >> >>
>>> ---------------------------------------------------------------------
>>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>>> >> >>
>>> >> >>
>>> >> >
>>> >> >
>>> ---------------------------------------------------------------------
>>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
>>> >> >
>>> >> >
>>> >> >
>>> >>
>>> >> --
>>> >> View this message in context:
>>> >>
>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merg=
e%22-tp24951667p24952295.html
>>> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com=
.
>>> >>
>>> >>
>>> >> --------------------------------------------------------------------=
-
>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>>> >>
>>> >>
>>> >
>>> >
>>>
>>> --
>>> View this message in context:
>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merg=
e%22-tp24951667p24953575.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>
> --
> View this message in context: http://www.nabble.com/Indexer-crashes-with-=
%22hit-exception-during-merge%22-tp24951667p24953833.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41870-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 12:43:27 2009
Return-Path: <java-user-return-41870-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16053 invoked from network); 13 Aug 2009 12:43:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 12:43:27 -0000
Received: (qmail 4604 invoked by uid 500); 13 Aug 2009 12:43:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4544 invoked by uid 500); 13 Aug 2009 12:43:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4534 invoked by uid 99); 13 Aug 2009 12:43:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:43:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 12:43:22 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbZe1-0000Rf-Nu
	for java-user@lucene.apache.org; Thu, 13 Aug 2009 05:43:01 -0700
Message-ID: <24954024.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 05:43:01 -0700 (PDT)
From: joe_coder <codetester.codetester@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Term Extraction
In-Reply-To: <52395A4A-D1A5-4370-8834-1F9014D02A0F@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: codetester.codetester@gmail.com
References: <24953406.post@talk.nabble.com> <52395A4A-D1A5-4370-8834-1F9014D02A0F@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org


Grant, thanks for responding.

My issue is that I am not planning to use lucene ( as I don't need any
search capability, atleast yet). All I have is a text document and I need to
extract keywords and their frequency ( which could be a simple split on
space and tracking the count). But I realize that I would need to do some
preprocessing to remove stopwords, stem words and also check for synonyms.
So wondering if there is already such code present in lucene ( or any other
project ) that I can use directly.

Thanks!



Grant Ingersoll-6 wrote:
> 
> 
> On Aug 13, 2009, at 7:40 AM, joe_coder wrote:
> 
>>
>> I was wondering if there is any way to directly use Lucene API to  
>> extract
>> terms from a given string. My requirement is that I have a text  
>> document for
>> which I need a term frequency vector ( after stemming, removing  
>> stopwords
>> and synonyms checks ). The result needs to be the terms and frequency.
> 
> IndexReader.getTermFreqVector(), assuming you have indexed using Term  
> Vectors.
> 
> 
>>
>> Is it possible to get this using any lucene API? ( As I see lucene  
>> also
>> needs to stem, remove stopwords, synonyms etc before indexing). Or  
>> is this
>> any java project that would help me in this?
>> -- 
>> View this message in context:
>> http://www.nabble.com/Term-Extraction-tp24953406p24953406.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
> 
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
> 
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
> using Solr/Lucene:
> http://www.lucidimagination.com/search
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Term-Extraction-tp24953406p24954024.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41871-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 13:09:09 2009
Return-Path: <java-user-return-41871-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22623 invoked from network); 13 Aug 2009 13:09:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 13:09:08 -0000
Received: (qmail 46471 invoked by uid 500); 13 Aug 2009 13:09:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46394 invoked by uid 500); 13 Aug 2009 13:09:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46384 invoked by uid 99); 13 Aug 2009 13:09:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 13:09:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 13:09:02 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mba2r-0001LV-Ga
	for java-user@lucene.apache.org; Thu, 13 Aug 2009 06:08:41 -0700
Message-ID: <24954264.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 06:08:41 -0700 (PDT)
From: joe_coder <codetester.codetester@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Term Extraction
In-Reply-To: <24954024.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: codetester.codetester@gmail.com
References: <24953406.post@talk.nabble.com> <52395A4A-D1A5-4370-8834-1F9014D02A0F@apache.org> <24954024.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


For example, I am able to do 
Analyzer analyzer = new StandardAnalyzer(); // or any other analyzer
      TokenStream ts = analyzer.tokenStream("myfield",new StringReader("some
text goes here"));
      Token t = ts.next();
      while (t!=null) {
        System.out.println("token: "+t));
        t = ts.next();
      }
  
But I would need to enhance it to include
- Split on hyphen,semicolon etc
- stemming ( porter )
- synonyms


Thanks


joe_coder wrote:
> 
> Grant, thanks for responding.
> 
> My issue is that I am not planning to use lucene ( as I don't need any
> search capability, atleast yet). All I have is a text document and I need
> to extract keywords and their frequency ( which could be a simple split on
> space and tracking the count). But I realize that I would need to do some
> preprocessing to remove stopwords, stem words and also check for synonyms.
> So wondering if there is already such code present in lucene ( or any
> other project ) that I can use directly.
> 
> Thanks!
> 
> 
> 
> Grant Ingersoll-6 wrote:
>> 
>> 
>> On Aug 13, 2009, at 7:40 AM, joe_coder wrote:
>> 
>>>
>>> I was wondering if there is any way to directly use Lucene API to  
>>> extract
>>> terms from a given string. My requirement is that I have a text  
>>> document for
>>> which I need a term frequency vector ( after stemming, removing  
>>> stopwords
>>> and synonyms checks ). The result needs to be the terms and frequency.
>> 
>> IndexReader.getTermFreqVector(), assuming you have indexed using Term  
>> Vectors.
>> 
>> 
>>>
>>> Is it possible to get this using any lucene API? ( As I see lucene  
>>> also
>>> needs to stem, remove stopwords, synonyms etc before indexing). Or  
>>> is this
>>> any java project that would help me in this?
>>> -- 
>>> View this message in context:
>>> http://www.nabble.com/Term-Extraction-tp24953406p24953406.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>> 
>> --------------------------
>> Grant Ingersoll
>> http://www.lucidimagination.com/
>> 
>> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
>> using Solr/Lucene:
>> http://www.lucidimagination.com/search
>> 
>> 
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> 
>> 
>> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Term-Extraction-tp24953406p24954264.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41872-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 13:21:13 2009
Return-Path: <java-user-return-41872-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25451 invoked from network); 13 Aug 2009 13:21:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 13:21:13 -0000
Received: (qmail 64919 invoked by uid 500); 13 Aug 2009 13:21:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64821 invoked by uid 500); 13 Aug 2009 13:21:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64809 invoked by uid 99); 13 Aug 2009 13:21:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 13:21:17 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 13:21:09 +0000
Received: by yxe3 with SMTP id 3so1062004yxe.29
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 06:20:48 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=3nq3832tsSBmSebmpYyqupPKNLeELXoYqeqa1py2HQ0=;
        b=pJ7TNt30GSp6nh56d1ps17+gamw44x4QFsfEH2mW5p+9RmpyPPWE8h8hnFO9s4YBI6
         vqXrDew9ed3g1gjdDE9DxnkZEY3U3OuFLOD7W4JofoqNDXqToyS3dDV3kUaGUSqBBP5Z
         MAFXHt6QrZW6JPTMBu18Mk1UTMhA9biYLUU3M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ngQ9SQ00RIdqj7NkwMAQEjNa0KM4AT5tsSPxjcnMxudWCd0zmeDiMsdu5ueUSf74E/
         o8qQs7wB8yv28LxMRNos321mAdNHn3QnHJwYqV5E7heXhuct4jKbRVwYgQRBNFZsQ3tD
         iQILgSzv0yuA2/2fKT/oe1qpY2aBNGCUE5674=
MIME-Version: 1.0
Received: by 10.231.32.138 with SMTP id c10mr886173ibd.28.1250169648291; Thu, 
	13 Aug 2009 06:20:48 -0700 (PDT)
In-Reply-To: <F2C9CCA71510B442AF71446CAE8AEBAF0184FC4C@MSXVS04.trivadis.com>
References: <F2C9CCA71510B442AF71446CAE8AEBAF0184FC4C@MSXVS04.trivadis.com>
Date: Thu, 13 Aug 2009 09:20:48 -0400
Message-ID: <359a92830908130620x34038decq2f2eee77d2e983a4@mail.gmail.com>
Subject: Re: Wildcard search fails
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=002215048e3bcba26d047105cde4
X-Virus-Checked: Checked by ClamAV on apache.org

--002215048e3bcba26d047105cde4
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Several, all of which boil down to "what analyzers are you usingduring
indexing and searching?". Without that information, we can't
say much.

Also, I'd recommend you get a copy of Luke and examine your index
to see whether what's in there is what you expect.

And query.toString and (as Grant says), IndexSearcher.explain() is your
friend

Best
Erick

On Thu, Aug 13, 2009 at 8:19 AM, Ueli Kistler <Ueli.Kistler@trivadis.com>wrote:

> Hello,
>
>
>
> We're experiencing a problem using Lucene 2.4.1 and Compass 2.1.4 using
> wildcard search.
>
> Attribute values containing slashes can be searched using the full word,
> but not using wildcards. We already tried different analyzers with the
> same result.
>
> Slash isn't mentioned as a stop word only backslash also.
>
>
>
> Example : Searching < RZ/G/17 > and also < RZ/G/22 > succeed, but <
> RZ/G/* > , < RZ/G* > or < RZ/G/ ?? > don't.
>
>
>
> Any ideas why wildcard search doesn't work?
>
>
>
> Thanks,
>
> Ueli Kistler
>
>
>
>

--002215048e3bcba26d047105cde4--

From java-user-return-41873-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 13:28:46 2009
Return-Path: <java-user-return-41873-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29876 invoked from network); 13 Aug 2009 13:28:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 13:28:45 -0000
Received: (qmail 77104 invoked by uid 500); 13 Aug 2009 13:28:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77015 invoked by uid 500); 13 Aug 2009 13:28:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77005 invoked by uid 99); 13 Aug 2009 13:28:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 13:28:50 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a12.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 13:28:38 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a12.g.dreamhost.com (Postfix) with ESMTP id D61D47FA8
	for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 06:28:16 -0700 (PDT)
Message-Id: <2601AB6F-2B4F-4257-8DD4-CB2CACA1ACC4@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <24954024.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Term Extraction
Date: Thu, 13 Aug 2009 09:28:15 -0400
References: <24953406.post@talk.nabble.com> <52395A4A-D1A5-4370-8834-1F9014D02A0F@apache.org> <24954024.post@talk.nabble.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


I would just throw your doc into a MemoryIndex (lives in contrib/ 
memory, I think; it only holds one doc), get the Vector and do what  
you need to do.  So you would kind of be doing indexing, but not really.


On Aug 13, 2009, at 8:43 AM, joe_coder wrote:

>
> Grant, thanks for responding.
>
> My issue is that I am not planning to use lucene ( as I don't need any
> search capability, atleast yet). All I have is a text document and I  
> need to
> extract keywords and their frequency ( which could be a simple split  
> on
> space and tracking the count). But I realize that I would need to do  
> some
> preprocessing to remove stopwords, stem words and also check for  
> synonyms.
> So wondering if there is already such code present in lucene ( or  
> any other
> project ) that I can use directly.
>
> Thanks!
>
>
>
> Grant Ingersoll-6 wrote:
>>
>>
>> On Aug 13, 2009, at 7:40 AM, joe_coder wrote:
>>
>>>
>>> I was wondering if there is any way to directly use Lucene API to
>>> extract
>>> terms from a given string. My requirement is that I have a text
>>> document for
>>> which I need a term frequency vector ( after stemming, removing
>>> stopwords
>>> and synonyms checks ). The result needs to be the terms and  
>>> frequency.
>>
>> IndexReader.getTermFreqVector(), assuming you have indexed using Term
>> Vectors.
>>
>>
>>>
>>> Is it possible to get this using any lucene API? ( As I see lucene
>>> also
>>> needs to stem, remove stopwords, synonyms etc before indexing). Or
>>> is this
>>> any java project that would help me in this?
>>> -- 
>>> View this message in context:
>>> http://www.nabble.com/Term-Extraction-tp24953406p24953406.html
>>> Sent from the Lucene - Java Users mailing list archive at  
>>> Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>> --------------------------
>> Grant Ingersoll
>> http://www.lucidimagination.com/
>>
>> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)
>> using Solr/Lucene:
>> http://www.lucidimagination.com/search
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41874-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 13:34:51 2009
Return-Path: <java-user-return-41874-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32634 invoked from network); 13 Aug 2009 13:34:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 13:34:51 -0000
Received: (qmail 85577 invoked by uid 500); 13 Aug 2009 13:34:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85532 invoked by uid 500); 13 Aug 2009 13:34:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85522 invoked by uid 99); 13 Aug 2009 13:34:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 13:34:56 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.15] (HELO web52905.mail.re2.yahoo.com) (206.190.49.15)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 13 Aug 2009 13:34:45 +0000
Received: (qmail 90789 invoked by uid 60001); 13 Aug 2009 13:34:22 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1250170462; bh=p6Sh8wSJL6/T0MPA96kcJ5HFToFCCY9hlx/uNLgqrpk=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=oc/H6noSKJYuTr51Mo8g23z1hpKniZ5be7SZhTBLxhvhtw4VkRo+2+X2ktTSLaZisC1oh58/BUK6G30wuOV9C33UUyWhtuWKjLAtCz44wsmiwlk187zBGhCvDqj+ftZsKvVhcQbVABk8dsu/hoyb0tjV8q/ZExKA9b77Gw3/vDA=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=KLaG4DYxr/xbOZFWIInoDvyavwHrqj2TR1lkx8+SKlbTBXLQOTol2XuacGhbcFRvTSYpGyeFDl3azM33ktclOopV4NWDBqi6Ih9gpELODkp1X+5sWchz5D2QablNXIjBTaeuxWEKWh1rQ7Wy6gxGALCk4voX75cP2iGhbQcxogI=;
Message-ID: <386454.89420.qm@web52905.mail.re2.yahoo.com>
X-YMail-OSG: SSpGmNUVM1nnuGpClf9KYBAKfJc50Ghq.1mgnoSyYPkthOuInHUUUD9oj01zrlPSBwzzIL9Kq4N6bbxN8.kllnVeg.aixYyGjimnep34pbsSCOnrYaGjne2p4seLzeDy4J5NXKHwWHzgnD45cMdtX9WohG.TGUnC_Wql58jwRcrwVbD9986oqNgEI8KQA72ZRorxSdUHvmhUTdDV0LT33h_l.A9ww3y6WO5si6U1zgg563IxwnfEp_xxBigIZE_4PpoDdmGcUSu_z2GM6bgHFBeAxnTxXJvaSx96JswDmIQ-
Received: from [193.140.184.100] by web52905.mail.re2.yahoo.com via HTTP; Thu, 13 Aug 2009 06:34:22 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.2
Date: Thu, 13 Aug 2009 06:34:22 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Generating Query
To: java-user@lucene.apache.org
In-Reply-To: <24952356.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> hm...try tat...but doesn't seems to be working for me though

Discarding lengthNorm didn't work for you. Very interesting. I am not sure but I think inverse document frequency causing problem to you. Probably one of query word (very common word) has high document frequency, and the docs having other query words are getting higher rank. Or one your query word (very rare word) has very small document frequency, and docs having only that word are getting higher rank.

You can override another method (idf) of Similarity to ignore idf as well as lengthNorm.

public float idf(int docFreq, int numDocs) {
    return 1.0f;
  }
public float lengthNorm(String fieldName, int numTerms) {
    return 1.0f;
  }

Ofcourse this modifications will cause some side-effects but probably you will see all of your query words in the first document. If such document exists in your index. Please let me know if this works for you.


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41875-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 13:38:59 2009
Return-Path: <java-user-return-41875-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34867 invoked from network); 13 Aug 2009 13:38:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 13:38:58 -0000
Received: (qmail 94706 invoked by uid 500); 13 Aug 2009 13:39:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94606 invoked by uid 500); 13 Aug 2009 13:39:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94596 invoked by uid 99); 13 Aug 2009 13:39:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 13:39:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.19] (HELO web52909.mail.re2.yahoo.com) (206.190.49.19)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 13 Aug 2009 13:38:53 +0000
Received: (qmail 96866 invoked by uid 60001); 13 Aug 2009 13:37:52 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1250170672; bh=wCMo62zJXcTJQd8z1htMKgXIFHi9BRhL+/nTQcMoqz8=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=0/MFhGXT68FYo3AGho9QhS672PXn2MKQ19SK3yXGvMh1BQaj9RM6KWwCqboxvNvBgPhpChV4BtDdKUg7m+Vp9ov8oLXDs6yVlvfS/0R3S2Qsq+xO4y66GDn3RdB2our5AjG67VpSgRykugjCKr/sNKLEfAzaH6J/M2AIjr5vkvE=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=MVaxP8hWMHIR6vLvuClWR4nmlAU/uPyVWMSeFYcuRDLJ5aUw3X7gcAiVGXUZ0imJ5PU/IqyotyVkFlmWzrZ8cbC+yPP5A1IUqQuiMyRmVdMJWbp/UueIQ6X9AMpnrnbUf43yPKOyPv9DsA2QReUu3kY3rlL4Br2HJUnykmXCwZw=;
Message-ID: <187833.91011.qm@web52909.mail.re2.yahoo.com>
X-YMail-OSG: OOaUAksVM1k8TClXJMQjlW60KlojLfnsmcFLsftCT4JeQ9rQ3be2LgcGG_i8qgL8r.BOTq0i_vGXdqlcIEwLVI4ycx23MDsvOrG9IEwJ2qoXWVRvMwVtsDl8m_V9s5_uqkqspHHrk_DU8HgVFpotxTTCYOMrxz9u5GtEkKPbsDIJoH00iQyBL7v1ETEMikqPYt2RgHcRRZU0FjGxsO.1WPgYGFC0Xog2ubx4XCEMf7.kYZvb9iDEvWa9nSb3GxYjcCIbLTyZbA_QaE_SOuxo4aJOvWlbiVY_ElzMWxEC_KM-
Received: from [193.140.184.100] by web52909.mail.re2.yahoo.com via HTTP; Thu, 13 Aug 2009 06:37:52 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.2
Date: Thu, 13 Aug 2009 06:37:52 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Generating Query
To: java-user@lucene.apache.org
In-Reply-To: <24952356.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> hm...try tat...but doesn't seems to be working for me though

Discarding lengthNorm didn't work for you. Very interesting. I am not sure but I think inverse document frequency causing problem to you. Probably one of query word (very common word) has high document frequency, and the docs having other query words are getting higher rank. Or one your query word (very rare word) has very small document frequency, and docs having only that word are getting higher rank.

You can override another method (idf) of Similarity to ignore idf as well as lengthNorm.

public float idf(int docFreq, int numDocs) {
    return 1.0f;
  }
public float lengthNorm(String fieldName, int numTerms) {
    return 1.0f;
  }

Ofcourse this modifications will cause some side-effects but probably you will see all of your query words in the first document. If such document exists in your index. Can you confirm this by ANDing all of your query words and look if you are getting results? Please let me know if this works for you.


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41876-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 14:33:16 2009
Return-Path: <java-user-return-41876-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63691 invoked from network); 13 Aug 2009 14:33:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 14:33:15 -0000
Received: (qmail 24391 invoked by uid 500); 13 Aug 2009 14:33:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24322 invoked by uid 500); 13 Aug 2009 14:33:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24300 invoked by uid 99); 13 Aug 2009 14:33:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 14:33:16 +0000
X-ASF-Spam-Status: No, hits=-8.0 required=10.0
	tests=RCVD_IN_DNSWL_HI,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Ueli.Kistler@trivadis.com designates 212.249.206.79 as permitted sender)
Received: from [212.249.206.79] (HELO mailx1.trivadis.com) (212.249.206.79)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 14:33:07 +0000
X-ASG-Debug-ID: 1250174061-464000c50000-H1Y1KX
X-Barracuda-URL: http://mailx1.trivadis.com:8000/cgi-bin/mark.cgi
Received: from mailx2.trivadis.com (localhost [127.0.0.1])
	by mailx1.trivadis.com (Spam & Virus Firewall) with ESMTP id B77912A55AE
	for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 16:34:21 +0200 (CEST)
Received: from mailx2.trivadis.com ([172.16.34.102]) by mailx1.trivadis.com with ESMTP id 2k1rH9E9c37AG8JS for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 16:34:21 +0200 (CEST)
X-Barracuda-Envelope-From: Ueli.Kistler@trivadis.com
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-ASG-Orig-Subj: AW: Wildcard search fails
Subject: AW: Wildcard search fails
Date: Thu, 13 Aug 2009 16:32:44 +0200
Message-ID: <F2C9CCA71510B442AF71446CAE8AEBAF0184FC6C@MSXVS04.trivadis.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Wildcard search fails
Thread-Index: AcocGPLoDIAP5/5FR7KO4Rub+ItqfQAAFVlA
References: <F2C9CCA71510B442AF71446CAE8AEBAF0184FC4C@MSXVS04.trivadis.com> <359a92830908130620x34038decq2f2eee77d2e983a4@mail.gmail.com>
From: "Ueli Kistler" <Ueli.Kistler@trivadis.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: UNKNOWN[172.16.34.102]
X-Barracuda-Start-Time: 1250174061
X-Barracuda-Virus-Scanned: by Barracuda Spam & Virus Firewall at trivadis.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

we used different analyzers and regenerated the index each time with the =
same results...used Luke each time already.
Currently we're using SnowBall and Luke can't find any documents using =
the supplied query examples below (in zzz-all).

Same happened using StandardAnalyzer (for both, indexing and search).
Using Luke with StandardAnalyzer set, searching for "rz/g/*" results in =
a query for zzz-all:rz/g/* but with no results.

Any other queries work as expected also using wildcards.

Can anyone think of a possible problem using / (slash) and wildcard =
characters "?" or "*" ?

Thanks for your help,
Ueli Kistler

-----Urspr=FCngliche Nachricht-----
Von: Erick Erickson [mailto:erickerickson@gmail.com]=20
Gesendet: Donnerstag, 13. August 2009 15:21
An: java-user@lucene.apache.org
Betreff: Re: Wildcard search fails

Several, all of which boil down to "what analyzers are you usingduring
indexing and searching?". Without that information, we can't
say much.

Also, I'd recommend you get a copy of Luke and examine your index
to see whether what's in there is what you expect.

And query.toString and (as Grant says), IndexSearcher.explain() is your
friend

Best
Erick

On Thu, Aug 13, 2009 at 8:19 AM, Ueli Kistler =
<Ueli.Kistler@trivadis.com>wrote:

> Hello,
>
>
>
> We're experiencing a problem using Lucene 2.4.1 and Compass 2.1.4 =
using
> wildcard search.
>
> Attribute values containing slashes can be searched using the full =
word,
> but not using wildcards. We already tried different analyzers with the
> same result.
>
> Slash isn't mentioned as a stop word only backslash also.
>
>
>
> Example : Searching < RZ/G/17 > and also < RZ/G/22 > succeed, but <
> RZ/G/* > , < RZ/G* > or < RZ/G/ ?? > don't.
>
>
>
> Any ideas why wildcard search doesn't work?
>
>
>
> Thanks,
>
> Ueli Kistler
>
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41877-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 14:34:13 2009
Return-Path: <java-user-return-41877-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64284 invoked from network); 13 Aug 2009 14:34:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 14:34:13 -0000
Received: (qmail 27469 invoked by uid 500); 13 Aug 2009 14:34:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27395 invoked by uid 500); 13 Aug 2009 14:34:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27385 invoked by uid 99); 13 Aug 2009 14:34:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 14:34:18 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [132.204.246.22] (HELO pruche.dit.umontreal.ca) (132.204.246.22)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 14:34:08 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by pruche.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n7DEXkcY004776
	for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 10:33:46 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Thu, 13 Aug 2009 10:33:46 -0400
  id 000272B6.4A84244A.00004009
Message-ID: <4A842449.3050505@lexum.umontreal.ca>
Date: Thu, 13 Aug 2009 10:33:45 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Is there a way to check for field "uniqueness" when indexing?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-NAI-Spam-Score: 0
X-NAI-Spam-Rules: 1 Rules triggered
	RV3339=0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all!

I'm currently running a big lucene index and one of my main concerns is 
the integrity of the data entered. A few things come to mind, like 
enforcing that certain fields be non-blank, forcing certain formats etc...

All these validations are easy to do with lucene, since I can validate 
the document before it is indexed or when it is retrieved.

The thing however that I have a hard time with, is field uniquness.

Lets say I have a field and I really want it to be unique. I can't seem 
to find out how to do it during the indexation phase since everything 
that is added to the index is not readable by an index reader until the 
index is closed.

Add to that the fact that items can be deleted from the index during the 
indexation and the only way I have to figure uniquness is to check every 
unique field values using termEnums and checking for docFreq.

This has a major disadvantage that I cannot inform people who are using 
the library of the unique conflit when it happens, only when the index 
is closed.

Does anyone have an idea on how I could check an index that is in the 
process of being indexed (things added, things deleted) for the uniquess 
of a given field *at the time I index a document* ?

Daniel Shane


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41878-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 14:44:17 2009
Return-Path: <java-user-return-41878-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71707 invoked from network); 13 Aug 2009 14:44:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 14:44:17 -0000
Received: (qmail 50789 invoked by uid 500); 13 Aug 2009 14:44:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50748 invoked by uid 500); 13 Aug 2009 14:44:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50738 invoked by uid 99); 13 Aug 2009 14:44:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 14:44:21 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 14:44:13 +0000
Received: by ewy26 with SMTP id 26so867713ewy.5
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 07:43:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=mdhNExwd+zo7dR0c+MvCbJnuErFpDQBzj+0jKleyU1w=;
        b=ustpTc7EVe9Q3twiSeS9suLF363ngsTgwuEjUAiUI1WOmy6hnb2F/+KpPI/q8iaN/S
         qxB7JX4s51/COC81js80DiK3CSkHtwIeD0ojhtiAwKpEeHDzrx01+PhOxwoWP4kBsQTE
         IwasbZuQywE35tpt6dtaweF4IXjE/dnZjHdMI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=gfxDi29shxDtZZE59VFAEeoTVlskQaiA1i3tTsx6WRhMhc/6s3PJE6gz58+q3QrGGP
         Vn6quzEKrt706AanaTcdq+PPVUxyb9f22I9l3o7Y2xhqswTyq7YBhkhgCjLi3+K5Lh9w
         NAZo8UhBWIDpKJPAF9KVWaj5ZrbHVRfIRVIk0=
MIME-Version: 1.0
Received: by 10.216.85.194 with SMTP id u44mr182004wee.65.1250174632093; Thu, 
	13 Aug 2009 07:43:52 -0700 (PDT)
In-Reply-To: <4A842449.3050505@lexum.umontreal.ca>
References: <4A842449.3050505@lexum.umontreal.ca>
Date: Thu, 13 Aug 2009 17:43:52 +0300
Message-ID: <786fde50908130743s674ce80u4c61b153e06070c4@mail.gmail.com>
Subject: Re: Is there a way to check for field "uniqueness" when indexing?
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d7e744da6871047106f6f9
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d7e744da6871047106f6f9
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

How many documents do you index between you refresh a reader? If it's not
too much, I'd keep a Set of those terms and check every incoming document in
the set and then the reader.

Note that the set keeps only just the terms of those documents your reader
doesn't see. You should clear() it after you've refreshed your reader.

In 2.9, IndexWriter will expose a getReader(), so you might be able to use
it, by checking on its reader and the on disk reader.

If it's possible, I think I'd prefer the first approach.

Shai

On Thu, Aug 13, 2009 at 5:33 PM, Daniel Shane <shaned@lexum.umontreal.ca>wrote:

> Hi all!
>
> I'm currently running a big lucene index and one of my main concerns is the
> integrity of the data entered. A few things come to mind, like enforcing
> that certain fields be non-blank, forcing certain formats etc...
>
> All these validations are easy to do with lucene, since I can validate the
> document before it is indexed or when it is retrieved.
>
> The thing however that I have a hard time with, is field uniquness.
>
> Lets say I have a field and I really want it to be unique. I can't seem to
> find out how to do it during the indexation phase since everything that is
> added to the index is not readable by an index reader until the index is
> closed.
>
> Add to that the fact that items can be deleted from the index during the
> indexation and the only way I have to figure uniquness is to check every
> unique field values using termEnums and checking for docFreq.
>
> This has a major disadvantage that I cannot inform people who are using the
> library of the unique conflit when it happens, only when the index is
> closed.
>
> Does anyone have an idea on how I could check an index that is in the
> process of being indexed (things added, things deleted) for the uniquess of
> a given field *at the time I index a document* ?
>
> Daniel Shane
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d7e744da6871047106f6f9--

From java-user-return-41879-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 14:53:04 2009
Return-Path: <java-user-return-41879-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74483 invoked from network); 13 Aug 2009 14:53:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 14:53:04 -0000
Received: (qmail 71233 invoked by uid 500); 13 Aug 2009 14:53:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71182 invoked by uid 500); 13 Aug 2009 14:53:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71172 invoked by uid 99); 13 Aug 2009 14:53:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 14:53:09 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [132.204.246.20] (HELO chene.dit.umontreal.ca) (132.204.246.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 14:52:59 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by chene.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n7DEqcvW025040
	for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 10:52:38 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Thu, 13 Aug 2009 10:52:37 -0400
  id 000272B6.4A8428B5.00004C83
Message-ID: <4A8428B5.5000601@lexum.umontreal.ca>
Date: Thu, 13 Aug 2009 10:52:37 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Is there a way to check for field "uniqueness" when indexing?
References: <4A842449.3050505@lexum.umontreal.ca> <786fde50908130743s674ce80u4c61b153e06070c4@mail.gmail.com>
In-Reply-To: <786fde50908130743s674ce80u4c61b153e06070c4@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-NAI-Spam-Score: 0
X-NAI-Spam-Rules: 1 Rules triggered
	RV3339=0
X-Virus-Checked: Checked by ClamAV on apache.org

Users can index really a lot of stuff, so I'd like not to keep things in 
memory for too long.

Even if I keep a set of things added, how do I know if something has 
been deleted via a delete? It seems rather difficult to keep this set of 
documents added in sync with the index reader on the index (before it 
has been written to).

What I'd like is to have an access to the stuff the index writer has 
written but not yet commited. Is there something that can access that data?

Daniel Shane

Shai Erera wrote:
> How many documents do you index between you refresh a reader? If it's not
> too much, I'd keep a Set of those terms and check every incoming document in
> the set and then the reader.
>
> Note that the set keeps only just the terms of those documents your reader
> doesn't see. You should clear() it after you've refreshed your reader.
>
> In 2.9, IndexWriter will expose a getReader(), so you might be able to use
> it, by checking on its reader and the on disk reader.
>
> If it's possible, I think I'd prefer the first approach.
>
> Shai
>
> On Thu, Aug 13, 2009 at 5:33 PM, Daniel Shane <shaned@lexum.umontreal.ca>wrote:
>
>   
>> Hi all!
>>
>> I'm currently running a big lucene index and one of my main concerns is the
>> integrity of the data entered. A few things come to mind, like enforcing
>> that certain fields be non-blank, forcing certain formats etc...
>>
>> All these validations are easy to do with lucene, since I can validate the
>> document before it is indexed or when it is retrieved.
>>
>> The thing however that I have a hard time with, is field uniquness.
>>
>> Lets say I have a field and I really want it to be unique. I can't seem to
>> find out how to do it during the indexation phase since everything that is
>> added to the index is not readable by an index reader until the index is
>> closed.
>>
>> Add to that the fact that items can be deleted from the index during the
>> indexation and the only way I have to figure uniquness is to check every
>> unique field values using termEnums and checking for docFreq.
>>
>> This has a major disadvantage that I cannot inform people who are using the
>> library of the unique conflit when it happens, only when the index is
>> closed.
>>
>> Does anyone have an idea on how I could check an index that is in the
>> process of being indexed (things added, things deleted) for the uniquess of
>> a given field *at the time I index a document* ?
>>
>> Daniel Shane
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41880-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 15:01:00 2009
Return-Path: <java-user-return-41880-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78461 invoked from network); 13 Aug 2009 15:01:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 15:01:00 -0000
Received: (qmail 86006 invoked by uid 500); 13 Aug 2009 15:01:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85926 invoked by uid 500); 13 Aug 2009 15:01:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85916 invoked by uid 99); 13 Aug 2009 15:01:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 15:01:04 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 15:00:56 +0000
Received: by ewy26 with SMTP id 26so880945ewy.5
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 08:00:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=oIbFYDcnxyiZUmGOsy69pl9NShOkZEhR9aa8FpnBNf0=;
        b=PTCEWy8/Ls+ror+QXpcOPIXrIOshYvO2gTeEvRMrw5tLX7vJ3ZTTpDHljXdekrVhfF
         fFfz4nUzg3nLnyGxGwHRFEKYrDaRh4F1/gsoMM4BSWiBcFRK9NMSI/5qotwv+0ILyi74
         3Jn22GseCbvN2sVXPcnRN9Y2/1XMJTU9Kq/f4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=V7/ixNnujslBjAg6z8MNM7CM/aP0GqgI1W0LQx6joXxqhPF/LfcLWFYSve3CtlKsWv
         k5bzyT5eF1FBKtMwpIc7ZtqwiJmO9ZxQLXr0jvg9l7FaViY0ykqJdXrVGbnRxrQW868E
         mOxhroOb9JttnxqOnIl3/LCXwLcixcGUGZ/do=
MIME-Version: 1.0
Received: by 10.216.88.19 with SMTP id z19mr185708wee.93.1250175635245; Thu, 
	13 Aug 2009 08:00:35 -0700 (PDT)
In-Reply-To: <4A8428B5.5000601@lexum.umontreal.ca>
References: <4A842449.3050505@lexum.umontreal.ca>
	 <786fde50908130743s674ce80u4c61b153e06070c4@mail.gmail.com>
	 <4A8428B5.5000601@lexum.umontreal.ca>
Date: Thu, 13 Aug 2009 18:00:35 +0300
Message-ID: <786fde50908130800p1dc631e7o5d282a426d22d11@mail.gmail.com>
Subject: Re: Is there a way to check for field "uniqueness" when indexing?
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6daa921a54c090471073227
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6daa921a54c090471073227
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

In 2.9 there will be - IndexWriter#getReader().

BTW, note that even if someone deletes, your reader may not see this delete.
If you use IndexWriter to delete docs, the open reader won't see those
deletes. So you may still have a problem.

I don't know how much stuff users can index, and how often you plan to
commit. But I'd like to think humans can't generate that much traffic in a
short period of time (say every couple of minutes). If they do, you might
want to commit anyway, so they'll be able to search on their newly added
data?

Anyway, I'll give it some more thought.

Shai

On Thu, Aug 13, 2009 at 5:52 PM, Daniel Shane <shaned@lexum.umontreal.ca>wrote:

> Users can index really a lot of stuff, so I'd like not to keep things in
> memory for too long.
>
> Even if I keep a set of things added, how do I know if something has been
> deleted via a delete? It seems rather difficult to keep this set of
> documents added in sync with the index reader on the index (before it has
> been written to).
>
> What I'd like is to have an access to the stuff the index writer has
> written but not yet commited. Is there something that can access that data?
>
> Daniel Shane
>
>
> Shai Erera wrote:
>
>> How many documents do you index between you refresh a reader? If it's not
>> too much, I'd keep a Set of those terms and check every incoming document
>> in
>> the set and then the reader.
>>
>> Note that the set keeps only just the terms of those documents your reader
>> doesn't see. You should clear() it after you've refreshed your reader.
>>
>> In 2.9, IndexWriter will expose a getReader(), so you might be able to use
>> it, by checking on its reader and the on disk reader.
>>
>> If it's possible, I think I'd prefer the first approach.
>>
>> Shai
>>
>> On Thu, Aug 13, 2009 at 5:33 PM, Daniel Shane <shaned@lexum.umontreal.ca
>> >wrote:
>>
>>
>>
>>> Hi all!
>>>
>>> I'm currently running a big lucene index and one of my main concerns is
>>> the
>>> integrity of the data entered. A few things come to mind, like enforcing
>>> that certain fields be non-blank, forcing certain formats etc...
>>>
>>> All these validations are easy to do with lucene, since I can validate
>>> the
>>> document before it is indexed or when it is retrieved.
>>>
>>> The thing however that I have a hard time with, is field uniquness.
>>>
>>> Lets say I have a field and I really want it to be unique. I can't seem
>>> to
>>> find out how to do it during the indexation phase since everything that
>>> is
>>> added to the index is not readable by an index reader until the index is
>>> closed.
>>>
>>> Add to that the fact that items can be deleted from the index during the
>>> indexation and the only way I have to figure uniquness is to check every
>>> unique field values using termEnums and checking for docFreq.
>>>
>>> This has a major disadvantage that I cannot inform people who are using
>>> the
>>> library of the unique conflit when it happens, only when the index is
>>> closed.
>>>
>>> Does anyone have an idea on how I could check an index that is in the
>>> process of being indexed (things added, things deleted) for the uniquess
>>> of
>>> a given field *at the time I index a document* ?
>>>
>>> Daniel Shane
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>>
>>
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6daa921a54c090471073227--

From java-user-return-41881-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 16:30:01 2009
Return-Path: <java-user-return-41881-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11450 invoked from network); 13 Aug 2009 16:30:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 16:30:01 -0000
Received: (qmail 38404 invoked by uid 500); 13 Aug 2009 16:30:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38357 invoked by uid 500); 13 Aug 2009 16:30:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38347 invoked by uid 99); 13 Aug 2009 16:30:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 16:30:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of claudio.gennaro@isti.cnr.it designates 194.119.192.4 as permitted sender)
Received: from [194.119.192.4] (HELO mx2.isti.cnr.it) (194.119.192.4)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 16:29:56 +0000
Received: from conversionlocal.isti.cnr.it by mx.isti.cnr.it (PMDF V6.4 #31598)
 id <01NCHF2VTT5CA5UXIR@mx.isti.cnr.it> for java-user@lucene.apache.org; Thu,
 13 Aug 2009 18:28:55 +0200 (MEST)
Received: from ultralisca ([217.201.23.232])
 by mx.isti.cnr.it (PMDF V6.4 #31599)
 with ESMTPA id <01NCHF2RJNZYA7363M@mx.isti.cnr.it> for
 java-user@lucene.apache.org; Thu, 13 Aug 2009 18:28:53 +0200
Date: Thu, 13 Aug 2009 18:28:51 +0200
From: Claudio Gennaro <claudio.gennaro@isti.cnr.it>
Subject: Simple tf cosine similarity
To: java-user@lucene.apache.org
Message-id: <004001ca1c33$26fc28d0$74f47a70$%gennaro@isti.cnr.it>
MIME-version: 1.0
X-Mailer: Microsoft Office Outlook 12.0
Content-type: text/plain; charset=US-ASCII
Content-language: it
Content-transfer-encoding: 7bit
Thread-Index: AcocMySfT8ruC7rhSCa2MLUGuklUXw==
X-INSM-ip-source: 217.201.23.232 Auth Done
X-Virus-Checked: Checked by ClamAV on apache.org

I would like to know if there is a simple way to force Lucene to adopt the
simple cosine similarity of the term frequency vectors of the documents and
the query for ranking the result. In practice the score sc_i of the document
i should be given by:

sc_i = (D_i*Q)/(|D_i|*|Q|)

where D_i = vector of the term frequencies of document i;
	Q = vector of the term frequencies of the Query;
	* = scalar product;
	|| = norm of the vector (the square root of the sum of the squares
of the entries of the vector).

I wasn't able to find a way to evaluate |D_i|.

Thank you

Claudio


======================================
Ing. Claudio Gennaro, PhD
ISTI (Information Science and Technology Institute) 
Consiglio Nazionale delle Ricerche Area della Ricerca di Pisa (room I14) 
Via G. Moruzzi 1
56124 Pisa - ITALY
phone: +39 050 315 3077
mobile: +39 328 92 16 734
fax: +39 050 315 3464 or +39 050 315 2810
e-mail: claudio.gennaro@isti.cnr.it



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41882-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 20:53:09 2009
Return-Path: <java-user-return-41882-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11774 invoked from network); 13 Aug 2009 20:53:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 20:53:09 -0000
Received: (qmail 88893 invoked by uid 500); 13 Aug 2009 20:53:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88824 invoked by uid 500); 13 Aug 2009 20:53:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88814 invoked by uid 99); 13 Aug 2009 20:53:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 20:53:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.19] (HELO web52909.mail.re2.yahoo.com) (206.190.49.19)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 13 Aug 2009 20:53:03 +0000
Received: (qmail 15490 invoked by uid 60001); 13 Aug 2009 20:52:02 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1250196722; bh=+Y2ToIQ9WDN+mhW0qq9dqjN9ioSWMQ0dE1FIZb4vbuk=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=kWLREbWoYmgME3KDZR5+PmnC8y2cvm7Lq+gkHiEAz7yWQGQVXOZQgo7SAOg1kh6+kR4fvAUuiHusxvfrQf1FtDGuU8Xy2hobie0Lhguq8ITxohzJ/D2IB2VrgyWMpHKianaXCp+b4WKFuvxG+Zq8AMa94XxPPPjkcIp6b1aeel8=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=NbCKwoHO+25lAuAaOnZvKIAVB/JBTtsZe2bzwxIafgw/ntnSu6YHqJN4PFKrdq1rMUysbnjHkBoPxlHZlJChhstgnBMOK5rEw8a+zyMlV6mnEc8CDaMV1vFdrzzCnLlAG9+qVUZPoy/a/3lXaEQlX/YyN939jQGUddBg5L7/YcE=;
Message-ID: <128388.15037.qm@web52909.mail.re2.yahoo.com>
X-YMail-OSG: WgR2HBUVM1kIeABh.r.gA.IproHC7m7uzI11yGBDNqjEKk7HUdzEfvbarVUqcVVm3km46nBNtPnxXF_KMR1rn68O3nDQBIb6olTr.vNnZLeqb9wVT_93YSrb_KtQGZ3NH7f9oHSCKClC2mgfCrmQdDSElUxLpYn3BAgA4knCsdqLxd0Iop1cqlhi0TdlsLF0goNyUYng84x0ihITRgVuJSUqm3IELIZAQuHQQGrk6SwD7Vl91UcfKtKOuI9FN_tKPG8eBWNZv728cgIK_DjFAQMlcaK6etnYxI0GjHU_
Received: from [78.168.45.102] by web52909.mail.re2.yahoo.com via HTTP; Thu, 13 Aug 2009 13:52:01 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.2
Date: Thu, 13 Aug 2009 13:52:01 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: AW: Wildcard search fails
To: java-user@lucene.apache.org
In-Reply-To: <F2C9CCA71510B442AF71446CAE8AEBAF0184FC6C@MSXVS04.trivadis.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> we used different analyzers and regenerated the index each
> time with the same results...used Luke each time already.
> Currently we're using SnowBall and Luke can't find any
> documents using the supplied query examples below (in
> zzz-all).
> 
> Same happened using StandardAnalyzer (for both, indexing
> and search).
> Using Luke with StandardAnalyzer set, searching for
> "rz/g/*" results in a query for zzz-all:rz/g/* but with no results.

StandardTokenizer produces two tokens ('rz' and  'g/17') from 'RZ/G/17'.
That's why "rz/g/*" is not matching. WhitespaceTokenizer or WhitespaceAnalyazer will recognize 'RZ/G/17' as one token.
Then you the query "RZ/G/*" will return 'RZ/G/17'. Also wildcard queries are not analyzed (tokenize, lowercase, stem, etc). 


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41883-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 13 21:17:35 2009
Return-Path: <java-user-return-41883-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18848 invoked from network); 13 Aug 2009 21:17:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Aug 2009 21:17:35 -0000
Received: (qmail 29922 invoked by uid 500); 13 Aug 2009 21:17:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29842 invoked by uid 500); 13 Aug 2009 21:17:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29832 invoked by uid 99); 13 Aug 2009 21:17:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 21:17:39 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Aug 2009 21:17:28 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbhfX-0001iz-9S
	for java-user@lucene.apache.org; Thu, 13 Aug 2009 14:17:07 -0700
Message-ID: <24958845.post@talk.nabble.com>
Date: Thu, 13 Aug 2009 14:17:07 -0700 (PDT)
From: rishisinghal <singhal.rishi@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Indexer crashes with "hit exception during merge"
In-Reply-To: <9ac0c6aa0908130535x68ad6b4atcf0663a4b046f0f9@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: singhal.rishi@gmail.com
References: <24951667.post@talk.nabble.com> <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com> <24952295.post@talk.nabble.com> <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com> <24953575.post@talk.nabble.com> <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com> <24953833.post@talk.nabble.com> <9ac0c6aa0908130535x68ad6b4atcf0663a4b046f0f9@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


I am running this on OpenVMS V8.2-1 on IA64. For a small number of files th=
is
works all fine.=20

I checked the resources part and i have enough disk and ram available.

Regards,
Rishi


Michael McCandless-2 wrote:
>=20
> It's very odd that CheckIndex has no trouble opening the segment's
> files, yet when you run optimize the OS reports a "file not found"
> exception (errno 5).  Something odd is happening at the OS/filesystem
> level.
>=20
> What OS are you running on?
>=20
> Can you boil this down to a smallish standalone test that shows the
> problem?
>=20
> Mike
>=20
> On Thu, Aug 13, 2009 at 8:21 AM, rishisinghal<singhal.rishi@gmail.com>
> wrote:
>>
>> I tried creating the index in different disks but still i see the issue
>> :-(
>>
>> I tried to index documents in other disks also and got the same
>> exception.
>>
>> I also tried
>> $ java org.apache.lucene.index.CheckIndex
>> /SYS$SYSDEVICE/RISHI/melon_1600/
>> -segment _61
>> NOTE: testing will be more thorough if you run java with
>> '-ea:org.apache.lucene...', so assertions are enabled
>> Opening index @ /SYS$SYSDEVICE/RISHI/melon_1600/
>> Segments file=3Dsegments_1 numSegments=3D0 version=3DFORMAT_HAS_PROX [Lu=
cene
>> 2.4]
>>
>> Checking only these segments: _61:
>> No problems were detected with this index.
>>
>> Regards,
>> Rishi
>>
>>
>> Shai Erera wrote:
>>>
>>> I noticed the exception is "Caused by: java.io.FileNotFoundException:
>>> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))"
>>>
>>> I searched for i/o error (errno:5) and found some information which
>>> associates it w/ a more native IO problem, like corrupt file due to
>>> system
>>> crash etc.
>>>
>>> Did you experience that? Can you try to create the index somewhere else=
,
>>> or
>>> on another drive?
>>>
>>> Shai
>>>
>>> On Thu, Aug 13, 2009 at 3:00 PM, rishisinghal
>>> <singhal.rishi@gmail.com>wrote:
>>>
>>>>
>>>> It is a local file system.
>>>>
>>>> We are using lucene 2.4 and java 1.5
>>>>
>>>> Regards,
>>>> Rishi
>>>>
>>>>
>>>> Shai Erera wrote:
>>>> >
>>>> > Is that a local file system, or a network share?
>>>> >
>>>> > On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
>>>> > <singhal.rishi@gmail.com>wrote:
>>>> >
>>>> >>
>>>> >> >>Is there any chance that two writers are open on this directory?
>>>> >> No, thats not true.
>>>> >>
>>>> >> >>something external to Lucene is removing files from the directory=
.
>>>> >> No this also has rare chances as I am the owner of these files and
>>>> other
>>>> >> then me no one can delete the, :-)
>>>> >>
>>>> >> Here are all the files in the index directory:
>>>> >> segments.gen;1 =C2=A0 =C2=A0 =C2=A0segments_1.;1 =C2=A0 =C2=A0 =C2=
=A0 segments_2.;1 =C2=A0 =C2=A0 =C2=A0 _0.fdt;1
>>>> >> _0.fdx;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0_37.cfs;1 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 _4c.cfs;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0
>>>> _61.cfs;1
>>>> >> _9e.cfs;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _ay.cfs;1 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 _az.cfs;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0
>>>> _b0.cfs;1
>>>> >> _b2.tis;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _b3.fdt;1 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 _b4.fdt;1
>>>> >>
>>>> >> I see _37 present.
>>>> >>
>>>> >> Regards,
>>>> >> Rishi
>>>> >>
>>>> >>
>>>> >> Michael McCandless-2 wrote:
>>>> >> >
>>>> >> > Is there any chance that two writers are open on this directory?
>>>> Or,
>>>> >> > something external to Lucene is removing files from the directory=
.
>>>> >> >
>>>> >> > It looks like there were at least two missing files (_37
>>>> >> >
>>>> >> > On Thu, Aug 13, 2009 at 5:19 AM,
>>>> rishisinghal<singhal.rishi@gmail.com
>>>> >
>>>> >> > wrote:
>>>> >> >>
>>>> >> >> Hi,
>>>> >> >>
>>>> >> >> I am trying to index documents and when all is complete and
>>>> optimize
>>>> >> is
>>>> >> >> called I get
>>>> >> >>
>>>> >> >> IFD [main]: setInfoStream
>>>> >> >>
>>>> >>
>>>> deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionPol=
icy@4fced0
>>>> >> >> IW 0 [main]: setInfoStream:
>>>> >> >>
>>>> >>
>>>> dir=3Dorg.apache.lucene.store.FSDirectory@/SYS$SYSDEVICE/RISHI/melon_1=
600
>>>> >> >> autoCommit=3Dfalse mergePolicy=3Dorg
>>>> >> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
>>>> >> >>
>>>> mergeScheduler=3Dorg.apache.lucene.index.ConcurrentMergeScheduler@6038=
e4
>>>> >> >> ramBufferS
>>>> >> >> izeMB=3D16.0 maxBufferedDocs=3D5 maxBuffereDeleteTerms=3D-1
>>>> >> >> maxFieldLength=3D10000
>>>> >> >> index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>>>> >> >> =C2=A0_ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0
>>>> >> _61:c245->_0
>>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >> >> IW 0 [main]: =C2=A0 flush: segment=3Dnull docStoreSegment=3Dnull
>>>> >> docStoreOffset=3D0
>>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfalse num=
D
>>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>>> >> >> IW 0 [main]: =C2=A0 index before flush _37:c465->_0 _4c:c165->_0
>>>> >> _61:c245->_0
>>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0
>>>> _9e:c485->_0
>>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1 pending]
>>>> >> >> IW 0 [main]: CMS: now merge
>>>> >> >> IW 0 [main]: CMS: =C2=A0 index: _37:c465->_0 _4c:c165->_0 _61:c2=
45->_0
>>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >> >> IW 0 [main]: CMS: =C2=A0 consider merge _61:c245->_0 _9e:c485->_=
0
>>>> >> _ay:c225->_0
>>>> >> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>>> >> >> IW 0 [main]: CMS: =C2=A0 =C2=A0 launch new thread [Lucene Merge =
Thread #73]
>>>> >> >> IW 0 [main]: CMS: =C2=A0 no more merges pending; now return
>>>> >> >> IW 0 [Lucene Merge Thread #73]: CMS: =C2=A0 merge thread: start
>>>> >> >> IW 0 [Lucene Merge Thread #73]: now merge
>>>> >> >> =C2=A0merge=3D_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0
>>>> _b0:c5->_0
>>>> >> into
>>>> >> >> _b5 [optimize]
>>>> >> >> =C2=A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@3725d=
b
>>>> >> >> =C2=A0index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_=
0
>>>> >> _ay:c225->_0
>>>> >> >> _az:c5->_0 _b0:c5->_0
>>>> >> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0 _9e:c485->_=
0
>>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>>> >> >> IW 0 [Lucene Merge Thread #73]: hit exception during merge
>>>> >> >> Exception in thread "Lucene Merge Thread #73"
>>>> >> >> org.apache.lucene.index.MergePolicy$MergeException:
>>>> >> >> java.io.FileNotFoundException: /SY
>>>> >> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(=
ConcurrentMergeScheduler.java:309)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concu=
rrentMergeScheduler.java:286)
>>>> >> >> Caused by: java.io.FileNotFoundException:
>>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.open(Nati=
ve Method)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSD=
irectory.java:552)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.ja=
va:582)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.j=
ava:70)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:32=
1)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306=
)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260=
)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMer=
geScheduler.java:205)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concu=
rrentMergeScheduler.java:260)
>>>> >> >> Aug 13, 2009 2:40:56 PM
>>>> org.hp.openvms.lucene.index.FileIndexerJSP
>>>> >> >> jspMain
>>>> >> >> SEVERE: Indexing not completebackground merge hit exception:
>>>> >> _61:c245->_0
>>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
>>>> >> >> optimize]
>>>> >> >> java.io.IOException: background merge hit exception: _61:c245->_=
0
>>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5
>>>> [optimize
>>>> >> >> ]
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>>> >> >> Source)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.hp.openvms.lucene.index.FileIn=
dexer.main(Unknown
>>>> Source)
>>>> >> >> Caused by: java.io.FileNotFoundException:
>>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.open(Nati=
ve Method)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSD=
irectory.java:552)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.ja=
va:582)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.j=
ava:70)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:32=
1)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306=
)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260=
)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMer=
geScheduler.java:205)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concu=
rrentMergeScheduler.java:260)
>>>> >> >> IW 0 [main]: now flush at close
>>>> >> >> IW 0 [main]: =C2=A0 flush: segment=3Dnull docStoreSegment=3Dnull
>>>> >> docStoreOffset=3D0
>>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfalse num=
D
>>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>>> >> >> IW 0 [main]: =C2=A0 index before flush _37:c465->_0 _4c:c165->_0
>>>> >> _61:c245->_0
>>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >> >> IW 0 [main]: CMS: now merge
>>>> >> >> IW 0 [main]: CMS: =C2=A0 index: _37:c465->_0 _4c:c165->_0 _61:c2=
45->_0
>>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >> >> IW 0 [main]: CMS: =C2=A0 no more merges pending; now return
>>>> >> >> IW 0 [main]: now call final commit()
>>>> >> >> IW 0 [main]: startCommit(): start sizeInBytes=3D0
>>>> >> >> IW 0 [main]: startCommit index=3D_37:c465->_0 _4c:c165->_0
>>>> _61:c245->_0
>>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=3D11
>>>> >> >> 95
>>>> >> >> IW 0 [main]: now sync _37.cfs
>>>> >> >> IW 0 [main]: hit exception while closing
>>>> >> >> Exception in thread "main" java.io.FileNotFoundException:
>>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5))
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.open(Nati=
ve Method)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369=
)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >>
>>>> >>
>>>> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:165=
4)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>>> >> >> Source)
>>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.hp.openvms.lucene.index.FileIn=
dexer.main(Unknown
>>>> Source)
>>>> >> >>
>>>> >> >>
>>>> >> >>
>>>> >> >> I have setMaxBufferedDocs =3D 5 and setMergeFactor=3D5. I was tr=
ying
>>>> >> >> different
>>>> >> >> combinations of these to see if that helps but was unsuccessful.
>>>> >> >>
>>>> >> >>
>>>> >> >> Regards,
>>>> >> >> Rishi
>>>> >> >> --
>>>> >> >> View this message in context:
>>>> >> >>
>>>> >>
>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-mer=
ge%22-tp24951667p24951667.html
>>>> >> >> Sent from the Lucene - Java Users mailing list archive at
>>>> Nabble.com.
>>>> >> >>
>>>> >> >>
>>>> >> >>
>>>> ---------------------------------------------------------------------
>>>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> >> >> For additional commands, e-mail: java-user-help@lucene.apache.or=
g
>>>> >> >>
>>>> >> >>
>>>> >> >
>>>> >> >
>>>> ---------------------------------------------------------------------
>>>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
>>>> >> >
>>>> >> >
>>>> >> >
>>>> >>
>>>> >> --
>>>> >> View this message in context:
>>>> >>
>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-mer=
ge%22-tp24951667p24952295.html
>>>> >> Sent from the Lucene - Java Users mailing list archive at
>>>> Nabble.com.
>>>> >>
>>>> >>
>>>> >>
>>>> ---------------------------------------------------------------------
>>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>> >>
>>>> >>
>>>> >
>>>> >
>>>>
>>>> --
>>>> View this message in context:
>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-mer=
ge%22-tp24951667p24953575.html
>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>>
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge=
%22-tp24951667p24953833.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Indexer-crashes-with-%2=
2hit-exception-during-merge%22-tp24951667p24958845.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41884-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 00:46:53 2009
Return-Path: <java-user-return-41884-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93444 invoked from network); 14 Aug 2009 00:46:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 00:46:53 -0000
Received: (qmail 10598 invoked by uid 500); 14 Aug 2009 00:46:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10514 invoked by uid 500); 14 Aug 2009 00:46:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10504 invoked by uid 99); 14 Aug 2009 00:46:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 00:46:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of glen.newton@gmail.com designates 209.85.132.241 as permitted sender)
Received: from [209.85.132.241] (HELO an-out-0708.google.com) (209.85.132.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 00:46:47 +0000
Received: by an-out-0708.google.com with SMTP id b2so439077ana.5
        for <java-user@lucene.apache.org>; Thu, 13 Aug 2009 17:46:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=qVpTNJRrj00jtw40P1t7NBkQ+7jW6E4QTWVQEqTFyJk=;
        b=dDSWjXnjusyzkqEuJ2DDVUlxo6USCWmHNW1TE99owqzrUgGrqJ0HbCmD/+vl23uEqE
         rcFWcKPM+L/7+EluGt4vYwpJdAWp+CuOO38wRrIOTujxD4W610PAqTqdlvYQGZaDnaVW
         1bxuYyuT1xjpJEPyMHuyiZ9m+sIauQLRrzD7I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=t6Hf3JgE7jNO3SbVdnw4LVtANUoAp7yB5rL+ETPULjWzUQ4TZAV4RzYbcd148XzNQs
         vfEQF3ThEKDcdILvkko5Ht7SgfM4SYYRizf6tlJqA2yw9lF2R7CHzpCHzNIgKvrhYYWG
         5zXMt1gNy2gCW0ETs+I0ts+MqMNf53TYUo8A4=
MIME-Version: 1.0
Received: by 10.100.51.10 with SMTP id y10mr1374088any.128.1250210786942; Thu, 
	13 Aug 2009 17:46:26 -0700 (PDT)
In-Reply-To: <1c3e185f0908130353x1a354007o7c1cc77251e702b2@mail.gmail.com>
References: <1c3e185f0908130353x1a354007o7c1cc77251e702b2@mail.gmail.com>
Date: Thu, 13 Aug 2009 20:46:26 -0400
Message-ID: <5e76f3840908131746n5f32397ew720772f9c2ec72c@mail.gmail.com>
Subject: Re: [EASY]How to change the demo of lucene143 into a multithread one?
From: Glen Newton <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

You are optimizing before the threads are finished adding to the index.
I think this should work:

IndexWriter writer =3D new IndexWriter("D:\\index", new StandardAnalyzer(),
true);
File file=3Dnew File(args[0]);
Thread t1=3Dnew Thread(new IndexFiles(writer,file));
Thread t2=3Dnew Thread(new IndexFiles(writer,file));
Thread t3=3Dnew Thread(new IndexFiles(writer,file));
t1.start();
t2.start();
t3.start();
while(t1.getState()!=3DState.TERMINATED
||t2.getState()!=3DState.TERMINATED
||t3.getState()!=3DState.TERMINATED
){
  try{
   Thread.currentThread().sleep(100l);
   }
  catch(InterruptedException ie)
    {
       ie.printStackTrace();
    }

}//wait until the threads end.

writer.optimize();
writer.close();
Date end =3D new Date();

2009/8/13 Chuan SHI <shichuanwuhan@gmail.com>:
> Hi all,
> =C2=A0 =C2=A0 =C2=A0 I am new to multi-thread programming and lucene. I w=
ant to change the
> indexing demo of lucene143 into a multi-thread one. I create one instance=
 of
> IndexWriter which is shared by three threads. But I find that the time it
> costs when three threads are used is approximate three times of that of
> single thread.(My computer is dual-core) It seems I write a pseudo
> multi-thread program and it does the same work for three times.
> Following is a snippet of my code. Please tell me how to write the correc=
t
> code. Thanks.
>
> IndexWriter writer =3D new IndexWriter("D:\\index", new StandardAnalyzer(=
),
> true);
> File file=3Dnew File(args[0]);
> Thread t1=3Dnew Thread(new IndexFiles(writer,file));
> Thread t2=3Dnew Thread(new IndexFiles(writer,file));
> Thread t3=3Dnew Thread(new IndexFiles(writer,file));
> t1.start();
> t2.start();
> t3.start();
> writer.optimize();
> writer.close();
>
> while(t1.getState()!=3DState.TERMINATED
> ||t2.getState()!=3DState.TERMINATED
> ||t3.getState()!=3DState.TERMINATED
> ){}//wait until the threads end.
> Date end =3D new Date();
>
> --
> Best regards,
>
> Chuan SHI
>



--=20

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41885-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 07:11:44 2009
Return-Path: <java-user-return-41885-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16049 invoked from network); 14 Aug 2009 07:11:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 07:11:44 -0000
Received: (qmail 53462 invoked by uid 500); 14 Aug 2009 07:11:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53390 invoked by uid 500); 14 Aug 2009 07:11:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53380 invoked by uid 99); 14 Aug 2009 07:11:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 07:11:48 +0000
X-ASF-Spam-Status: No, hits=-8.0 required=10.0
	tests=RCVD_IN_DNSWL_HI,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Ueli.Kistler@trivadis.com designates 212.249.206.79 as permitted sender)
Received: from [212.249.206.79] (HELO mailx1.trivadis.com) (212.249.206.79)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 07:11:40 +0000
X-ASG-Debug-ID: 1250233976-1bda01b80000-H1Y1KX
X-Barracuda-URL: http://mailx1.trivadis.com:8000/cgi-bin/mark.cgi
Received: from mailx2.trivadis.com (localhost [127.0.0.1])
	by mailx1.trivadis.com (Spam & Virus Firewall) with ESMTP id 7F1872A784A
	for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 09:12:56 +0200 (CEST)
Received: from mailx2.trivadis.com ([172.16.34.102]) by mailx1.trivadis.com with ESMTP id wAI3F5cBWpCL7MTV for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 09:12:56 +0200 (CEST)
X-Barracuda-Envelope-From: Ueli.Kistler@trivadis.com
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-ASG-Orig-Subj: AW: AW: Wildcard search fails
Subject: AW: AW: Wildcard search fails
Date: Fri, 14 Aug 2009 09:11:06 +0200
Message-ID: <F2C9CCA71510B442AF71446CAE8AEBAF0184FCB9@MSXVS04.trivadis.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: AW: Wildcard search fails
Thread-Index: AcocWBfw72q3AeLiSGurZRwwn5ykwAAVe9NQ
References: <128388.15037.qm@web52909.mail.re2.yahoo.com>
From: "Ueli Kistler" <Ueli.Kistler@trivadis.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: UNKNOWN[172.16.34.102]
X-Barracuda-Start-Time: 1250233976
X-Barracuda-Virus-Scanned: by Barracuda Spam & Virus Firewall at trivadis.com
X-Virus-Checked: Checked by ClamAV on apache.org

Noticed that in Luke... is there any existing analyzer around that =
supports case-insensitive search and recognizes "RZ/G/17" as one token?=20

-----Urspr=FCngliche Nachricht-----
Von: AHMET ARSLAN [mailto:iorixxx@yahoo.com]=20
Gesendet: Donnerstag, 13. August 2009 22:52
An: java-user@lucene.apache.org
Betreff: Re: AW: Wildcard search fails

> we used different analyzers and regenerated the index each
> time with the same results...used Luke each time already.
> Currently we're using SnowBall and Luke can't find any
> documents using the supplied query examples below (in
> zzz-all).
>=20
> Same happened using StandardAnalyzer (for both, indexing
> and search).
> Using Luke with StandardAnalyzer set, searching for
> "rz/g/*" results in a query for zzz-all:rz/g/* but with no results.

StandardTokenizer produces two tokens ('rz' and  'g/17') from 'RZ/G/17'.
That's why "rz/g/*" is not matching. WhitespaceTokenizer or =
WhitespaceAnalyazer will recognize 'RZ/G/17' as one token.
Then you the query "RZ/G/*" will return 'RZ/G/17'. Also wildcard queries =
are not analyzed (tokenize, lowercase, stem, etc).=20


     =20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41886-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 08:11:50 2009
Return-Path: <java-user-return-41886-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33467 invoked from network); 14 Aug 2009 08:11:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 08:11:49 -0000
Received: (qmail 22981 invoked by uid 500); 14 Aug 2009 08:11:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22880 invoked by uid 500); 14 Aug 2009 08:11:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22870 invoked by uid 99); 14 Aug 2009 08:11:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 08:11:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 08:11:44 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mbrsh-0004yJ-4w
	for java-user@lucene.apache.org; Fri, 14 Aug 2009 01:11:23 -0700
Message-ID: <24967906.post@talk.nabble.com>
Date: Fri, 14 Aug 2009 01:11:23 -0700 (PDT)
From: joe_coder <codetester.codetester@gmail.com>
To: java-user@lucene.apache.org
Subject: Personalized Search
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: codetester.codetester@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Lets say we have 4 users : U1, U2, U3 and U4. Each user has a title and set
of documents created by him/her. Using this info, we can come up with a term
vector ( interest vector ) which would contain a set of top terms ( that
appeared in his/her docs ) along with frequency. So conceptually, we get
some thing like this: 
U1 => T1:1, T2:2, T3:1  ( Title: "something ")
U2 => T2:3, T4:1  ( Title: "Something else")
U3 => T1:5, T2:10, T7:1  ( Title: "Java Beans")
U4 => T1:7, T2:7, T8:1  ( Title: "Java World")

Now supposing user U1 searches for "Java", I need to search on all the
titles of all the users to find the best match ( i.e result should contain
U3 and U4 ) BUT also considering the interest of the target user w.r.t to
the user who is searching. I.e in the result U3 may get higher priority over
U4 as U3 is more closer to U1 ( as both U1 and U3 has similar interest based
on the term vectors... T1:T2 => 1:2 for U1, 1:2 for U3 and 1:1 for U4)

What would be the best way to implement this using lucene starting from
step1 by generating term vectors to using the term vector for ranking
results? 

Thanks!


-- 
View this message in context: http://www.nabble.com/Personalized-Search-tp24967906p24967906.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41887-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 10:56:51 2009
Return-Path: <java-user-return-41887-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3661 invoked from network); 14 Aug 2009 10:56:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 10:56:50 -0000
Received: (qmail 68800 invoked by uid 500); 14 Aug 2009 10:56:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68710 invoked by uid 500); 14 Aug 2009 10:56:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68700 invoked by uid 99); 14 Aug 2009 10:56:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 10:56:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.49.15] (HELO web52905.mail.re2.yahoo.com) (206.190.49.15)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 14 Aug 2009 10:56:45 +0000
Received: (qmail 16656 invoked by uid 60001); 14 Aug 2009 10:56:23 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1250247383; bh=HtTUJ8cSw8SYI/f38toEoVPXyXD9S6zZreM7CgjyS7A=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=6MgoZD3v/xbDWXljnq8hY2P+eLQxa3304vJ0jvprXWyG5oH9LVvG0HU4GfTDLWLa+B1iB7uDdff7RLHHfKMP+nm+3FWp+zq2mbCeh1au7zT217mORMDjRDel7n3ksRLK1Hw6UOuq+uZProjQ6gJKwG0ZXAj/enEfE7fkRj8llxo=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=suVIdQoTupTybYeeLKiP4YyRp1+Brg63Lvl/pF3In7JadWliDd9U5X6SLbGnOSrMzWDR/d+bvvN2OWXe/sBOx6D76FTKx0rMdls10vO/NjJEiD9UIlUzFm3vTR5oziNHA8heMkYeLiIR1wix3bs4AY7tvaQJ/HIu/trPDNAD+OY=;
Message-ID: <901677.16404.qm@web52905.mail.re2.yahoo.com>
X-YMail-OSG: bMiSSh0VM1ko6g_XvEj0ZVvaPkx4cNI5ExLuXL3.tJG20lbnWTdmvzeDvYnNbW6i7GfAzzSzlYl7FMP2XR4F4X2T2hNXkGla8K9l.4324j.cx2SdLOeSXnxvVbvi_eYCy0QJvxRCUFM3Sh5.jvT5OEExZ1PrANfEonS5qAo0KFoiPg.1pcUPFIKW3Yb7iRrlZtAsz2M5pq8r6h3EkAVHLBoJGwasEdsdiK5IP9MAQQaSUqvxg_OFg3aLyFyddK1Geufhi1rYh9WDbWH10qVVczzxSEZ5nNObQaKKZ1tnEzi9QF9qmbqlLkCoIFUFasjwsQsGU1M-
Received: from [193.140.184.100] by web52905.mail.re2.yahoo.com via HTTP; Fri, 14 Aug 2009 03:56:23 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.2
Date: Fri, 14 Aug 2009 03:56:23 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: AW: AW: Wildcard search fails
To: java-user@lucene.apache.org
In-Reply-To: <F2C9CCA71510B442AF71446CAE8AEBAF0184FCB9@MSXVS04.trivadis.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> Noticed that in Luke... is there any existing analyzer around that 
> supports case-insensitive search and recognizes "RZ/G/17" as one token? 

As far as I know there is no built-in analyzer that uses whitespace tokenizer and lowercase filter together. But it is easy to cast tokenizer and token filters to create a new analyzer. You said that you were using SnowballAnalyzer, right? Just replace tokenizer from standard to whitespace. Edit SnowballAnalyzer.java :

public TokenStream tokenStream(String fieldName, Reader reader) {
    TokenStream result = new WhitespaceTokenizer(reader);
    result = new LowerCaseFilter(result);
    if (stopSet != null)
      result = new StopFilter(result, stopSet);
    result = new SnowballFilter(result, name);
    return result;
  }

By changing this method you can create custom analyzers. If you do not want stemming just erase the line that contains SnowballFilter, etc. Since you have lowercasefilter in your analyzer, your wildcard queries should be lowercased. Alternatively you can set setLowercaseExpandedTerms(true) of your QueryParser.


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41888-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 11:09:30 2009
Return-Path: <java-user-return-41888-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8916 invoked from network); 14 Aug 2009 11:09:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 11:09:30 -0000
Received: (qmail 81476 invoked by uid 500); 14 Aug 2009 11:09:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81394 invoked by uid 500); 14 Aug 2009 11:09:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81384 invoked by uid 99); 14 Aug 2009 11:09:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 11:09:34 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 11:09:25 +0000
Received: by ewy26 with SMTP id 26so1475567ewy.5
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 04:09:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=oy/NhtXobWWnG2zjYpYQeRhyIclVR9zoTn70hap67RU=;
        b=cK1ZgqY5Jyi3uNFvcaqQppHw3XPxzfgththsCKLT43Oi0jkM/T2zrRrLRSNx24f0zy
         7bvxLbX/kccz596d3I/Tsm5PyEsO9EcGxvr4/qQnRJHniQMBnAEHBd+wXxFfnVD8EVaC
         /E8po0YVAEu7RYX0+YbgruIqd4ail4ofZ0iv0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Wo+YalxWpDcsrLUDeQ6tzs681Q8H8ior+T/WQXNLrA4sHF69RX8ba9T1CIVZBF7HmI
         w+e9TXFTcCsbmtjpextwy5EbszvU1I02fF7dv8rYF74FuZS23Q3OZwpB+GVoqeVmPbMi
         nXTiOV8vYAd9yj7SyLodikobiiIMNT/227q7I=
MIME-Version: 1.0
Received: by 10.216.26.200 with SMTP id c50mr386342wea.61.1250248143033; Fri, 
	14 Aug 2009 04:09:03 -0700 (PDT)
In-Reply-To: <24958845.post@talk.nabble.com>
References: <24951667.post@talk.nabble.com>
	 <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com>
	 <24952295.post@talk.nabble.com>
	 <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com>
	 <24953575.post@talk.nabble.com>
	 <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com>
	 <24953833.post@talk.nabble.com>
	 <9ac0c6aa0908130535x68ad6b4atcf0663a4b046f0f9@mail.gmail.com>
	 <24958845.post@talk.nabble.com>
Date: Fri, 14 Aug 2009 14:09:02 +0300
Message-ID: <786fde50908140409u5fe053f1j9a49efae6797d25c@mail.gmail.com>
Subject: Re: Indexer crashes with "hit exception during merge"
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636d348a07257bd04711814fd
X-Virus-Checked: Checked by ClamAV on apache.org

--001636d348a07257bd04711814fd
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

If it's easily reproducible, can you please provide a test that reproduces
it, even if on just your FS? And also, can you turn on infoStream on
IndexWriter and post the output?

If CheckIndex succeeds, then I'd compare the output w/ and w/o CheckIndex.

Shai

On Fri, Aug 14, 2009 at 12:17 AM, rishisinghal <singhal.rishi@gmail.com>wrote:

>
> I am running this on OpenVMS V8.2-1 on IA64. For a small number of files
> this
> works all fine.
>
> I checked the resources part and i have enough disk and ram available.
>
> Regards,
> Rishi
>
>
> Michael McCandless-2 wrote:
> >
> > It's very odd that CheckIndex has no trouble opening the segment's
> > files, yet when you run optimize the OS reports a "file not found"
> > exception (errno 5).  Something odd is happening at the OS/filesystem
> > level.
> >
> > What OS are you running on?
> >
> > Can you boil this down to a smallish standalone test that shows the
> > problem?
> >
> > Mike
> >
> > On Thu, Aug 13, 2009 at 8:21 AM, rishisinghal<singhal.rishi@gmail.com>
> > wrote:
> >>
> >> I tried creating the index in different disks but still i see the issue
> >> :-(
> >>
> >> I tried to index documents in other disks also and got the same
> >> exception.
> >>
> >> I also tried
> >> $ java org.apache.lucene.index.CheckIndex
> >> /SYS$SYSDEVICE/RISHI/melon_1600/
> >> -segment _61
> >> NOTE: testing will be more thorough if you run java with
> >> '-ea:org.apache.lucene...', so assertions are enabled
> >> Opening index @ /SYS$SYSDEVICE/RISHI/melon_1600/
> >> Segments file=segments_1 numSegments=0 version=FORMAT_HAS_PROX [Lucene
> >> 2.4]
> >>
> >> Checking only these segments: _61:
> >> No problems were detected with this index.
> >>
> >> Regards,
> >> Rishi
> >>
> >>
> >> Shai Erera wrote:
> >>>
> >>> I noticed the exception is "Caused by: java.io.FileNotFoundException:
> >>> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))"
> >>>
> >>> I searched for i/o error (errno:5) and found some information which
> >>> associates it w/ a more native IO problem, like corrupt file due to
> >>> system
> >>> crash etc.
> >>>
> >>> Did you experience that? Can you try to create the index somewhere
> else,
> >>> or
> >>> on another drive?
> >>>
> >>> Shai
> >>>
> >>> On Thu, Aug 13, 2009 at 3:00 PM, rishisinghal
> >>> <singhal.rishi@gmail.com>wrote:
> >>>
> >>>>
> >>>> It is a local file system.
> >>>>
> >>>> We are using lucene 2.4 and java 1.5
> >>>>
> >>>> Regards,
> >>>> Rishi
> >>>>
> >>>>
> >>>> Shai Erera wrote:
> >>>> >
> >>>> > Is that a local file system, or a network share?
> >>>> >
> >>>> > On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
> >>>> > <singhal.rishi@gmail.com>wrote:
> >>>> >
> >>>> >>
> >>>> >> >>Is there any chance that two writers are open on this directory?
> >>>> >> No, thats not true.
> >>>> >>
> >>>> >> >>something external to Lucene is removing files from the
> directory.
> >>>> >> No this also has rare chances as I am the owner of these files and
> >>>> other
> >>>> >> then me no one can delete the, :-)
> >>>> >>
> >>>> >> Here are all the files in the index directory:
> >>>> >> segments.gen;1      segments_1.;1       segments_2.;1
> _0.fdt;1
> >>>> >> _0.fdx;1            _37.cfs;1           _4c.cfs;1
> >>>> _61.cfs;1
> >>>> >> _9e.cfs;1           _ay.cfs;1           _az.cfs;1
> >>>> _b0.cfs;1
> >>>> >> _b2.tis;1           _b3.fdt;1           _b4.fdt;1
> >>>> >>
> >>>> >> I see _37 present.
> >>>> >>
> >>>> >> Regards,
> >>>> >> Rishi
> >>>> >>
> >>>> >>
> >>>> >> Michael McCandless-2 wrote:
> >>>> >> >
> >>>> >> > Is there any chance that two writers are open on this directory?
> >>>> Or,
> >>>> >> > something external to Lucene is removing files from the
> directory.
> >>>> >> >
> >>>> >> > It looks like there were at least two missing files (_37
> >>>> >> >
> >>>> >> > On Thu, Aug 13, 2009 at 5:19 AM,
> >>>> rishisinghal<singhal.rishi@gmail.com
> >>>> >
> >>>> >> > wrote:
> >>>> >> >>
> >>>> >> >> Hi,
> >>>> >> >>
> >>>> >> >> I am trying to index documents and when all is complete and
> >>>> optimize
> >>>> >> is
> >>>> >> >> called I get
> >>>> >> >>
> >>>> >> >> IFD [main]: setInfoStream
> >>>> >> >>
> >>>> >>
> >>>>
> deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@4fced0
> >>>> >> >> IW 0 [main]: setInfoStream:
> >>>> >> >>
> >>>> >>
> >>>> dir=org.apache.lucene.store.FSDirectory@
> /SYS$SYSDEVICE/RISHI/melon_1600
> >>>> >> >> autoCommit=false mergePolicy=org
> >>>> >> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
> >>>> >> >>
> >>>> mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@6038e4
> >>>> >> >> ramBufferS
> >>>> >> >> izeMB=16.0 maxBufferedDocs=5 maxBuffereDeleteTerms=-1
> >>>> >> >> maxFieldLength=10000
> >>>> >> >> index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
> >>>> >> >>  _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >>>> >> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0
> >>>> >> _61:c245->_0
> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >>>> >> >> IW 0 [main]:   flush: segment=null docStoreSegment=null
> >>>> >> docStoreOffset=0
> >>>> >> >> flushDocs=false flushDeletes=true flushDocStores=false numD
> >>>> >> >> ocs=0 numBufDelTerms=0
> >>>> >> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0
> >>>> >> _61:c245->_0
> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >>>> >> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0
> >>>> _9e:c485->_0
> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1 pending]
> >>>> >> >> IW 0 [main]: CMS: now merge
> >>>> >> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0
> _61:c245->_0
> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >>>> >> >> IW 0 [main]: CMS:   consider merge _61:c245->_0 _9e:c485->_0
> >>>> >> _ay:c225->_0
> >>>> >> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
> >>>> >> >> IW 0 [main]: CMS:     launch new thread [Lucene Merge Thread
> #73]
> >>>> >> >> IW 0 [main]: CMS:   no more merges pending; now return
> >>>> >> >> IW 0 [Lucene Merge Thread #73]: CMS:   merge thread: start
> >>>> >> >> IW 0 [Lucene Merge Thread #73]: now merge
> >>>> >> >>  merge=_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0
> >>>> _b0:c5->_0
> >>>> >> into
> >>>> >> >> _b5 [optimize]
> >>>> >> >>  merge=org.apache.lucene.index.MergePolicy$OneMerge@3725db
> >>>> >> >>  index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
> >>>> >> _ay:c225->_0
> >>>> >> >> _az:c5->_0 _b0:c5->_0
> >>>> >> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0
> _9e:c485->_0
> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
> >>>> >> >> IW 0 [Lucene Merge Thread #73]: hit exception during merge
> >>>> >> >> Exception in thread "Lucene Merge Thread #73"
> >>>> >> >> org.apache.lucene.index.MergePolicy$MergeException:
> >>>> >> >> java.io.FileNotFoundException: /SY
> >>>> >> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
> >>>> >> >> Caused by: java.io.FileNotFoundException:
> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> >>>> >> >>        at java.io.RandomAccessFile.open(Native Method)
> >>>> >> >>        at
> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
> >>>> >> >>        at
> >>>> >> >>
> >>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> >>>> >> >>        at
> >>>> >> >>
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >>>> >> >>        at
> >>>> >> >>
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> >>>> >> >>        at
> >>>> >> >>
> >>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> >>>> >> >>        at
> >>>> >> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
> >>>> >> >> Aug 13, 2009 2:40:56 PM
> >>>> org.hp.openvms.lucene.index.FileIndexerJSP
> >>>> >> >> jspMain
> >>>> >> >> SEVERE: Indexing not completebackground merge hit exception:
> >>>> >> _61:c245->_0
> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
> >>>> >> >> optimize]
> >>>> >> >> java.io.IOException: background merge hit exception:
> _61:c245->_0
> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5
> >>>> [optimize
> >>>> >> >> ]
> >>>> >> >>        at
> >>>> >> >>
> >>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
> >>>> >> >>        at
> >>>> >> >>
> >>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
> >>>> >> >>        at
> >>>> >> >>
> >>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
> >>>> >> >>        at
> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
> >>>> >> >> Source)
> >>>> >> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown
> >>>> Source)
> >>>> >> >> Caused by: java.io.FileNotFoundException:
> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
> >>>> >> >>        at java.io.RandomAccessFile.open(Native Method)
> >>>> >> >>        at
> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
> >>>> >> >>        at
> >>>> >> >>
> >>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> >>>> >> >>        at
> >>>> >> >>
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >>>> >> >>        at
> >>>> >> >>
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> >>>> >> >>        at
> >>>> >> >>
> >>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> >>>> >> >>        at
> >>>> >> >> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
> >>>> >> >> IW 0 [main]: now flush at close
> >>>> >> >> IW 0 [main]:   flush: segment=null docStoreSegment=null
> >>>> >> docStoreOffset=0
> >>>> >> >> flushDocs=false flushDeletes=true flushDocStores=false numD
> >>>> >> >> ocs=0 numBufDelTerms=0
> >>>> >> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0
> >>>> >> _61:c245->_0
> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >>>> >> >> IW 0 [main]: CMS: now merge
> >>>> >> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0
> _61:c245->_0
> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
> >>>> >> >> IW 0 [main]: CMS:   no more merges pending; now return
> >>>> >> >> IW 0 [main]: now call final commit()
> >>>> >> >> IW 0 [main]: startCommit(): start sizeInBytes=0
> >>>> >> >> IW 0 [main]: startCommit index=_37:c465->_0 _4c:c165->_0
> >>>> _61:c245->_0
> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=11
> >>>> >> >> 95
> >>>> >> >> IW 0 [main]: now sync _37.cfs
> >>>> >> >> IW 0 [main]: hit exception while closing
> >>>> >> >> Exception in thread "main" java.io.FileNotFoundException:
> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5))
> >>>> >> >>        at java.io.RandomAccessFile.open(Native Method)
> >>>> >> >>        at
> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
> >>>> >> >>        at
> >>>> >> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
> >>>> >> >>        at
> >>>> >> >>
> >>>> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
> >>>> >> >>        at
> >>>> >> >>
> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
> >>>> >> >>        at
> >>>> >> >>
> >>>> >>
> >>>>
> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1654)
> >>>> >> >>        at
> >>>> >> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
> >>>> >> >>        at
> >>>> >> >> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
> >>>> >> >>        at
> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
> >>>> >> >> Source)
> >>>> >> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown
> >>>> Source)
> >>>> >> >>
> >>>> >> >>
> >>>> >> >>
> >>>> >> >> I have setMaxBufferedDocs = 5 and setMergeFactor=5. I was trying
> >>>> >> >> different
> >>>> >> >> combinations of these to see if that helps but was unsuccessful.
> >>>> >> >>
> >>>> >> >>
> >>>> >> >> Regards,
> >>>> >> >> Rishi
> >>>> >> >> --
> >>>> >> >> View this message in context:
> >>>> >> >>
> >>>> >>
> >>>>
> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24951667.html
> >>>> >> >> Sent from the Lucene - Java Users mailing list archive at
> >>>> Nabble.com.
> >>>> >> >>
> >>>> >> >>
> >>>> >> >>
> >>>> ---------------------------------------------------------------------
> >>>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> >> >> For additional commands, e-mail:
> java-user-help@lucene.apache.org
> >>>> >> >>
> >>>> >> >>
> >>>> >> >
> >>>> >> >
> >>>> ---------------------------------------------------------------------
> >>>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> >> > For additional commands, e-mail:
> java-user-help@lucene.apache.org
> >>>> >> >
> >>>> >> >
> >>>> >> >
> >>>> >>
> >>>> >> --
> >>>> >> View this message in context:
> >>>> >>
> >>>>
> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24952295.html
> >>>> >> Sent from the Lucene - Java Users mailing list archive at
> >>>> Nabble.com.
> >>>> >>
> >>>> >>
> >>>> >>
> >>>> ---------------------------------------------------------------------
> >>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>> >>
> >>>> >>
> >>>> >
> >>>> >
> >>>>
> >>>> --
> >>>> View this message in context:
> >>>>
> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24953575.html
> >>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >>>>
> >>>>
> >>>> ---------------------------------------------------------------------
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>>
> >>>
> >>>
> >>
> >> --
> >> View this message in context:
> >>
> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24953833.html
> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
>
> --
> View this message in context:
> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24958845.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636d348a07257bd04711814fd--

From java-user-return-41889-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 11:37:15 2009
Return-Path: <java-user-return-41889-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18038 invoked from network); 14 Aug 2009 11:37:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 11:37:15 -0000
Received: (qmail 15800 invoked by uid 500); 14 Aug 2009 11:37:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15702 invoked by uid 500); 14 Aug 2009 11:37:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15692 invoked by uid 99); 14 Aug 2009 11:37:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 11:37:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 11:37:09 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mbv5U-0005et-Gx
	for java-user@lucene.apache.org; Fri, 14 Aug 2009 04:36:48 -0700
Message-ID: <24970274.post@talk.nabble.com>
Date: Fri, 14 Aug 2009 04:36:48 -0700 (PDT)
From: rishisinghal <singhal.rishi@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Indexer crashes with "hit exception during merge"
In-Reply-To: <786fde50908140409u5fe053f1j9a49efae6797d25c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: singhal.rishi@gmail.com
References: <24951667.post@talk.nabble.com> <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com> <24952295.post@talk.nabble.com> <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com> <24953575.post@talk.nabble.com> <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com> <24953833.post@talk.nabble.com> <9ac0c6aa0908130535x68ad6b4atcf0663a4b046f0f9@mail.gmail.com> <24958845.post@talk.nabble.com> <786fde50908140409u5fe053f1j9a49efae6797d25c@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


It is reproducible in my system. If the number of files are small I am not
able to see the crash.

>>can you turn on infoStream on IndexWriter and post the output?
I am not clear on this. If you are talking of
writer.setInfoStream(System.out);
I already have posted the output while raising the issue.


>>If CheckIndex succeeds, then I'd compare the output w/ and w/o CheckIndex.
I am not clear on this too. As I know CheckIndex program has been run after
I get the error and it shows no issues. 

Regards,
Rishi



Shai Erera wrote:
> 
> If it's easily reproducible, can you please provide a test that reproduces
> it, even if on just your FS? And also, can you turn on infoStream on
> IndexWriter and post the output?
> 
> If CheckIndex succeeds, then I'd compare the output w/ and w/o CheckIndex.
> 
> Shai
> 
> On Fri, Aug 14, 2009 at 12:17 AM, rishisinghal
> <singhal.rishi@gmail.com>wrote:
> 
>>
>> I am running this on OpenVMS V8.2-1 on IA64. For a small number of files
>> this
>> works all fine.
>>
>> I checked the resources part and i have enough disk and ram available.
>>
>> Regards,
>> Rishi
>>
>>
>> Michael McCandless-2 wrote:
>> >
>> > It's very odd that CheckIndex has no trouble opening the segment's
>> > files, yet when you run optimize the OS reports a "file not found"
>> > exception (errno 5).  Something odd is happening at the OS/filesystem
>> > level.
>> >
>> > What OS are you running on?
>> >
>> > Can you boil this down to a smallish standalone test that shows the
>> > problem?
>> >
>> > Mike
>> >
>> > On Thu, Aug 13, 2009 at 8:21 AM, rishisinghal<singhal.rishi@gmail.com>
>> > wrote:
>> >>
>> >> I tried creating the index in different disks but still i see the
>> issue
>> >> :-(
>> >>
>> >> I tried to index documents in other disks also and got the same
>> >> exception.
>> >>
>> >> I also tried
>> >> $ java org.apache.lucene.index.CheckIndex
>> >> /SYS$SYSDEVICE/RISHI/melon_1600/
>> >> -segment _61
>> >> NOTE: testing will be more thorough if you run java with
>> >> '-ea:org.apache.lucene...', so assertions are enabled
>> >> Opening index @ /SYS$SYSDEVICE/RISHI/melon_1600/
>> >> Segments file=segments_1 numSegments=0 version=FORMAT_HAS_PROX [Lucene
>> >> 2.4]
>> >>
>> >> Checking only these segments: _61:
>> >> No problems were detected with this index.
>> >>
>> >> Regards,
>> >> Rishi
>> >>
>> >>
>> >> Shai Erera wrote:
>> >>>
>> >>> I noticed the exception is "Caused by: java.io.FileNotFoundException:
>> >>> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))"
>> >>>
>> >>> I searched for i/o error (errno:5) and found some information which
>> >>> associates it w/ a more native IO problem, like corrupt file due to
>> >>> system
>> >>> crash etc.
>> >>>
>> >>> Did you experience that? Can you try to create the index somewhere
>> else,
>> >>> or
>> >>> on another drive?
>> >>>
>> >>> Shai
>> >>>
>> >>> On Thu, Aug 13, 2009 at 3:00 PM, rishisinghal
>> >>> <singhal.rishi@gmail.com>wrote:
>> >>>
>> >>>>
>> >>>> It is a local file system.
>> >>>>
>> >>>> We are using lucene 2.4 and java 1.5
>> >>>>
>> >>>> Regards,
>> >>>> Rishi
>> >>>>
>> >>>>
>> >>>> Shai Erera wrote:
>> >>>> >
>> >>>> > Is that a local file system, or a network share?
>> >>>> >
>> >>>> > On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
>> >>>> > <singhal.rishi@gmail.com>wrote:
>> >>>> >
>> >>>> >>
>> >>>> >> >>Is there any chance that two writers are open on this
>> directory?
>> >>>> >> No, thats not true.
>> >>>> >>
>> >>>> >> >>something external to Lucene is removing files from the
>> directory.
>> >>>> >> No this also has rare chances as I am the owner of these files
>> and
>> >>>> other
>> >>>> >> then me no one can delete the, :-)
>> >>>> >>
>> >>>> >> Here are all the files in the index directory:
>> >>>> >> segments.gen;1      segments_1.;1       segments_2.;1
>> _0.fdt;1
>> >>>> >> _0.fdx;1            _37.cfs;1           _4c.cfs;1
>> >>>> _61.cfs;1
>> >>>> >> _9e.cfs;1           _ay.cfs;1           _az.cfs;1
>> >>>> _b0.cfs;1
>> >>>> >> _b2.tis;1           _b3.fdt;1           _b4.fdt;1
>> >>>> >>
>> >>>> >> I see _37 present.
>> >>>> >>
>> >>>> >> Regards,
>> >>>> >> Rishi
>> >>>> >>
>> >>>> >>
>> >>>> >> Michael McCandless-2 wrote:
>> >>>> >> >
>> >>>> >> > Is there any chance that two writers are open on this
>> directory?
>> >>>> Or,
>> >>>> >> > something external to Lucene is removing files from the
>> directory.
>> >>>> >> >
>> >>>> >> > It looks like there were at least two missing files (_37
>> >>>> >> >
>> >>>> >> > On Thu, Aug 13, 2009 at 5:19 AM,
>> >>>> rishisinghal<singhal.rishi@gmail.com
>> >>>> >
>> >>>> >> > wrote:
>> >>>> >> >>
>> >>>> >> >> Hi,
>> >>>> >> >>
>> >>>> >> >> I am trying to index documents and when all is complete and
>> >>>> optimize
>> >>>> >> is
>> >>>> >> >> called I get
>> >>>> >> >>
>> >>>> >> >> IFD [main]: setInfoStream
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@4fced0
>> >>>> >> >> IW 0 [main]: setInfoStream:
>> >>>> >> >>
>> >>>> >>
>> >>>> dir=org.apache.lucene.store.FSDirectory@
>> /SYS$SYSDEVICE/RISHI/melon_1600
>> >>>> >> >> autoCommit=false mergePolicy=org
>> >>>> >> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
>> >>>> >> >>
>> >>>>
>> mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@6038e4
>> >>>> >> >> ramBufferS
>> >>>> >> >> izeMB=16.0 maxBufferedDocs=5 maxBuffereDeleteTerms=-1
>> >>>> >> >> maxFieldLength=10000
>> >>>> >> >> index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>> >>>> >> >>  _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >>>> >> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0
>> >>>> >> _61:c245->_0
>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >>>> >> >> IW 0 [main]:   flush: segment=null docStoreSegment=null
>> >>>> >> docStoreOffset=0
>> >>>> >> >> flushDocs=false flushDeletes=true flushDocStores=false numD
>> >>>> >> >> ocs=0 numBufDelTerms=0
>> >>>> >> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0
>> >>>> >> _61:c245->_0
>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >>>> >> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0
>> >>>> _9e:c485->_0
>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1
>> pending]
>> >>>> >> >> IW 0 [main]: CMS: now merge
>> >>>> >> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0
>> _61:c245->_0
>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >>>> >> >> IW 0 [main]: CMS:   consider merge _61:c245->_0 _9e:c485->_0
>> >>>> >> _ay:c225->_0
>> >>>> >> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>> >>>> >> >> IW 0 [main]: CMS:     launch new thread [Lucene Merge Thread
>> #73]
>> >>>> >> >> IW 0 [main]: CMS:   no more merges pending; now return
>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: CMS:   merge thread: start
>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: now merge
>> >>>> >> >>  merge=_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0
>> >>>> _b0:c5->_0
>> >>>> >> into
>> >>>> >> >> _b5 [optimize]
>> >>>> >> >>  merge=org.apache.lucene.index.MergePolicy$OneMerge@3725db
>> >>>> >> >>  index=_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>> >>>> >> _ay:c225->_0
>> >>>> >> >> _az:c5->_0 _b0:c5->_0
>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0
>> _9e:c485->_0
>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: hit exception during merge
>> >>>> >> >> Exception in thread "Lucene Merge Thread #73"
>> >>>> >> >> org.apache.lucene.index.MergePolicy$MergeException:
>> >>>> >> >> java.io.FileNotFoundException: /SY
>> >>>> >> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> >>>> >> >>        at java.io.RandomAccessFile.open(Native Method)
>> >>>> >> >>        at
>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
>> >>>> >> >>        at
>> >>>> >> >>
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>> >>>> >> >>        at
>> >>>> >> >>
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>>
>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>> >>>> >> >>        at
>> >>>> >> >>
>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
>> >>>> >> >> Aug 13, 2009 2:40:56 PM
>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP
>> >>>> >> >> jspMain
>> >>>> >> >> SEVERE: Indexing not completebackground merge hit exception:
>> >>>> >> _61:c245->_0
>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
>> >>>> >> >> optimize]
>> >>>> >> >> java.io.IOException: background merge hit exception:
>> _61:c245->_0
>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5
>> >>>> [optimize
>> >>>> >> >> ]
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>> >>>> >> >>        at
>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>> >>>> >> >> Source)
>> >>>> >> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>> >>>> Source)
>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>> >>>> >> >>        at java.io.RandomAccessFile.open(Native Method)
>> >>>> >> >>        at
>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
>> >>>> >> >>        at
>> >>>> >> >>
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>> >>>> >> >>        at
>> >>>> >> >>
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>>
>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>> >>>> >> >>        at
>> >>>> >> >>
>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
>> >>>> >> >> IW 0 [main]: now flush at close
>> >>>> >> >> IW 0 [main]:   flush: segment=null docStoreSegment=null
>> >>>> >> docStoreOffset=0
>> >>>> >> >> flushDocs=false flushDeletes=true flushDocStores=false numD
>> >>>> >> >> ocs=0 numBufDelTerms=0
>> >>>> >> >> IW 0 [main]:   index before flush _37:c465->_0 _4c:c165->_0
>> >>>> >> _61:c245->_0
>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >>>> >> >> IW 0 [main]: CMS: now merge
>> >>>> >> >> IW 0 [main]: CMS:   index: _37:c465->_0 _4c:c165->_0
>> _61:c245->_0
>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>> >>>> >> >> IW 0 [main]: CMS:   no more merges pending; now return
>> >>>> >> >> IW 0 [main]: now call final commit()
>> >>>> >> >> IW 0 [main]: startCommit(): start sizeInBytes=0
>> >>>> >> >> IW 0 [main]: startCommit index=_37:c465->_0 _4c:c165->_0
>> >>>> _61:c245->_0
>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=11
>> >>>> >> >> 95
>> >>>> >> >> IW 0 [main]: now sync _37.cfs
>> >>>> >> >> IW 0 [main]: hit exception while closing
>> >>>> >> >> Exception in thread "main" java.io.FileNotFoundException:
>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5))
>> >>>> >> >>        at java.io.RandomAccessFile.open(Native Method)
>> >>>> >> >>        at
>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>> >>>> >> >>        at
>> >>>> >> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>>
>> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
>> >>>> >> >>        at
>> >>>> >> >>
>> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
>> >>>> >> >>        at
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1654)
>> >>>> >> >>        at
>> >>>> >> >>
>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
>> >>>> >> >>        at
>> >>>> >> >>
>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
>> >>>> >> >>        at
>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>> >>>> >> >> Source)
>> >>>> >> >>        at org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>> >>>> Source)
>> >>>> >> >>
>> >>>> >> >>
>> >>>> >> >>
>> >>>> >> >> I have setMaxBufferedDocs = 5 and setMergeFactor=5. I was
>> trying
>> >>>> >> >> different
>> >>>> >> >> combinations of these to see if that helps but was
>> unsuccessful.
>> >>>> >> >>
>> >>>> >> >>
>> >>>> >> >> Regards,
>> >>>> >> >> Rishi
>> >>>> >> >> --
>> >>>> >> >> View this message in context:
>> >>>> >> >>
>> >>>> >>
>> >>>>
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24951667.html
>> >>>> >> >> Sent from the Lucene - Java Users mailing list archive at
>> >>>> Nabble.com.
>> >>>> >> >>
>> >>>> >> >>
>> >>>> >> >>
>> >>>>
>> ---------------------------------------------------------------------
>> >>>> >> >> To unsubscribe, e-mail:
>> java-user-unsubscribe@lucene.apache.org
>> >>>> >> >> For additional commands, e-mail:
>> java-user-help@lucene.apache.org
>> >>>> >> >>
>> >>>> >> >>
>> >>>> >> >
>> >>>> >> >
>> >>>>
>> ---------------------------------------------------------------------
>> >>>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >>>> >> > For additional commands, e-mail:
>> java-user-help@lucene.apache.org
>> >>>> >> >
>> >>>> >> >
>> >>>> >> >
>> >>>> >>
>> >>>> >> --
>> >>>> >> View this message in context:
>> >>>> >>
>> >>>>
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24952295.html
>> >>>> >> Sent from the Lucene - Java Users mailing list archive at
>> >>>> Nabble.com.
>> >>>> >>
>> >>>> >>
>> >>>> >>
>> >>>>
>> ---------------------------------------------------------------------
>> >>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >>>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>>> >>
>> >>>> >>
>> >>>> >
>> >>>> >
>> >>>>
>> >>>> --
>> >>>> View this message in context:
>> >>>>
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24953575.html
>> >>>> Sent from the Lucene - Java Users mailing list archive at
>> Nabble.com.
>> >>>>
>> >>>>
>> >>>>
>> ---------------------------------------------------------------------
>> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>>>
>> >>>>
>> >>>
>> >>>
>> >>
>> >> --
>> >> View this message in context:
>> >>
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24953833.html
>> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>> >
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24958845.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge%22-tp24951667p24970274.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41890-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 11:50:55 2009
Return-Path: <java-user-return-41890-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20142 invoked from network); 14 Aug 2009 11:50:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 11:50:54 -0000
Received: (qmail 30838 invoked by uid 500); 14 Aug 2009 11:50:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30748 invoked by uid 500); 14 Aug 2009 11:50:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30737 invoked by uid 99); 14 Aug 2009 11:50:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 11:50:59 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 11:50:49 +0000
Received: by gxk12 with SMTP id 12so1951039gxk.4
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 04:50:28 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.114.11 with SMTP id r11mr2592876ybm.78.1250250627906; Fri, 
	14 Aug 2009 04:50:27 -0700 (PDT)
In-Reply-To: <24970274.post@talk.nabble.com>
References: <24951667.post@talk.nabble.com> <24952295.post@talk.nabble.com>
	 <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com>
	 <24953575.post@talk.nabble.com>
	 <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com>
	 <24953833.post@talk.nabble.com>
	 <9ac0c6aa0908130535x68ad6b4atcf0663a4b046f0f9@mail.gmail.com>
	 <24958845.post@talk.nabble.com>
	 <786fde50908140409u5fe053f1j9a49efae6797d25c@mail.gmail.com>
	 <24970274.post@talk.nabble.com>
Date: Fri, 14 Aug 2009 07:50:27 -0400
Message-ID: <9ac0c6aa0908140450q6df61575o708db832c4493323@mail.gmail.com>
Subject: Re: Indexer crashes with "hit exception during merge"
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Can you post the full sources for the test that hits the exception on
your system?

Mike

On Fri, Aug 14, 2009 at 7:36 AM, rishisinghal<singhal.rishi@gmail.com> wrot=
e:
>
> It is reproducible in my system. If the number of files are small I am no=
t
> able to see the crash.
>
>>>can you turn on infoStream on IndexWriter and post the output?
> I am not clear on this. If you are talking of
> writer.setInfoStream(System.out);
> I already have posted the output while raising the issue.
>
>
>>>If CheckIndex succeeds, then I'd compare the output w/ and w/o CheckInde=
x.
> I am not clear on this too. As I know CheckIndex program has been run aft=
er
> I get the error and it shows no issues.
>
> Regards,
> Rishi
>
>
>
> Shai Erera wrote:
>>
>> If it's easily reproducible, can you please provide a test that reproduc=
es
>> it, even if on just your FS? And also, can you turn on infoStream on
>> IndexWriter and post the output?
>>
>> If CheckIndex succeeds, then I'd compare the output w/ and w/o CheckInde=
x.
>>
>> Shai
>>
>> On Fri, Aug 14, 2009 at 12:17 AM, rishisinghal
>> <singhal.rishi@gmail.com>wrote:
>>
>>>
>>> I am running this on OpenVMS V8.2-1 on IA64. For a small number of file=
s
>>> this
>>> works all fine.
>>>
>>> I checked the resources part and i have enough disk and ram available.
>>>
>>> Regards,
>>> Rishi
>>>
>>>
>>> Michael McCandless-2 wrote:
>>> >
>>> > It's very odd that CheckIndex has no trouble opening the segment's
>>> > files, yet when you run optimize the OS reports a "file not found"
>>> > exception (errno 5). =A0Something odd is happening at the OS/filesyst=
em
>>> > level.
>>> >
>>> > What OS are you running on?
>>> >
>>> > Can you boil this down to a smallish standalone test that shows the
>>> > problem?
>>> >
>>> > Mike
>>> >
>>> > On Thu, Aug 13, 2009 at 8:21 AM, rishisinghal<singhal.rishi@gmail.com=
>
>>> > wrote:
>>> >>
>>> >> I tried creating the index in different disks but still i see the
>>> issue
>>> >> :-(
>>> >>
>>> >> I tried to index documents in other disks also and got the same
>>> >> exception.
>>> >>
>>> >> I also tried
>>> >> $ java org.apache.lucene.index.CheckIndex
>>> >> /SYS$SYSDEVICE/RISHI/melon_1600/
>>> >> -segment _61
>>> >> NOTE: testing will be more thorough if you run java with
>>> >> '-ea:org.apache.lucene...', so assertions are enabled
>>> >> Opening index @ /SYS$SYSDEVICE/RISHI/melon_1600/
>>> >> Segments file=3Dsegments_1 numSegments=3D0 version=3DFORMAT_HAS_PROX=
 [Lucene
>>> >> 2.4]
>>> >>
>>> >> Checking only these segments: _61:
>>> >> No problems were detected with this index.
>>> >>
>>> >> Regards,
>>> >> Rishi
>>> >>
>>> >>
>>> >> Shai Erera wrote:
>>> >>>
>>> >>> I noticed the exception is "Caused by: java.io.FileNotFoundExceptio=
n:
>>> >>> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))"
>>> >>>
>>> >>> I searched for i/o error (errno:5) and found some information which
>>> >>> associates it w/ a more native IO problem, like corrupt file due to
>>> >>> system
>>> >>> crash etc.
>>> >>>
>>> >>> Did you experience that? Can you try to create the index somewhere
>>> else,
>>> >>> or
>>> >>> on another drive?
>>> >>>
>>> >>> Shai
>>> >>>
>>> >>> On Thu, Aug 13, 2009 at 3:00 PM, rishisinghal
>>> >>> <singhal.rishi@gmail.com>wrote:
>>> >>>
>>> >>>>
>>> >>>> It is a local file system.
>>> >>>>
>>> >>>> We are using lucene 2.4 and java 1.5
>>> >>>>
>>> >>>> Regards,
>>> >>>> Rishi
>>> >>>>
>>> >>>>
>>> >>>> Shai Erera wrote:
>>> >>>> >
>>> >>>> > Is that a local file system, or a network share?
>>> >>>> >
>>> >>>> > On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
>>> >>>> > <singhal.rishi@gmail.com>wrote:
>>> >>>> >
>>> >>>> >>
>>> >>>> >> >>Is there any chance that two writers are open on this
>>> directory?
>>> >>>> >> No, thats not true.
>>> >>>> >>
>>> >>>> >> >>something external to Lucene is removing files from the
>>> directory.
>>> >>>> >> No this also has rare chances as I am the owner of these files
>>> and
>>> >>>> other
>>> >>>> >> then me no one can delete the, :-)
>>> >>>> >>
>>> >>>> >> Here are all the files in the index directory:
>>> >>>> >> segments.gen;1 =A0 =A0 =A0segments_1.;1 =A0 =A0 =A0 segments_2.=
;1
>>> _0.fdt;1
>>> >>>> >> _0.fdx;1 =A0 =A0 =A0 =A0 =A0 =A0_37.cfs;1 =A0 =A0 =A0 =A0 =A0 _=
4c.cfs;1
>>> >>>> _61.cfs;1
>>> >>>> >> _9e.cfs;1 =A0 =A0 =A0 =A0 =A0 _ay.cfs;1 =A0 =A0 =A0 =A0 =A0 _az=
.cfs;1
>>> >>>> _b0.cfs;1
>>> >>>> >> _b2.tis;1 =A0 =A0 =A0 =A0 =A0 _b3.fdt;1 =A0 =A0 =A0 =A0 =A0 _b4=
.fdt;1
>>> >>>> >>
>>> >>>> >> I see _37 present.
>>> >>>> >>
>>> >>>> >> Regards,
>>> >>>> >> Rishi
>>> >>>> >>
>>> >>>> >>
>>> >>>> >> Michael McCandless-2 wrote:
>>> >>>> >> >
>>> >>>> >> > Is there any chance that two writers are open on this
>>> directory?
>>> >>>> Or,
>>> >>>> >> > something external to Lucene is removing files from the
>>> directory.
>>> >>>> >> >
>>> >>>> >> > It looks like there were at least two missing files (_37
>>> >>>> >> >
>>> >>>> >> > On Thu, Aug 13, 2009 at 5:19 AM,
>>> >>>> rishisinghal<singhal.rishi@gmail.com
>>> >>>> >
>>> >>>> >> > wrote:
>>> >>>> >> >>
>>> >>>> >> >> Hi,
>>> >>>> >> >>
>>> >>>> >> >> I am trying to index documents and when all is complete and
>>> >>>> optimize
>>> >>>> >> is
>>> >>>> >> >> called I get
>>> >>>> >> >>
>>> >>>> >> >> IFD [main]: setInfoStream
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionPoli=
cy@4fced0
>>> >>>> >> >> IW 0 [main]: setInfoStream:
>>> >>>> >> >>
>>> >>>> >>
>>> >>>> dir=3Dorg.apache.lucene.store.FSDirectory@
>>> /SYS$SYSDEVICE/RISHI/melon_1600
>>> >>>> >> >> autoCommit=3Dfalse mergePolicy=3Dorg
>>> >>>> >> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
>>> >>>> >> >>
>>> >>>>
>>> mergeScheduler=3Dorg.apache.lucene.index.ConcurrentMergeScheduler@6038e=
4
>>> >>>> >> >> ramBufferS
>>> >>>> >> >> izeMB=3D16.0 maxBufferedDocs=3D5 maxBuffereDeleteTerms=3D-1
>>> >>>> >> >> maxFieldLength=3D10000
>>> >>>> >> >> index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>>> >>>> >> >> =A0_ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >>>> >> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0
>>> >>>> >> _61:c245->_0
>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >>>> >> >> IW 0 [main]: =A0 flush: segment=3Dnull docStoreSegment=3Dnul=
l
>>> >>>> >> docStoreOffset=3D0
>>> >>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfalse=
 numD
>>> >>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>> >>>> >> >> IW 0 [main]: =A0 index before flush _37:c465->_0 _4c:c165->_=
0
>>> >>>> >> _61:c245->_0
>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >>>> >> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0
>>> >>>> _9e:c485->_0
>>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1
>>> pending]
>>> >>>> >> >> IW 0 [main]: CMS: now merge
>>> >>>> >> >> IW 0 [main]: CMS: =A0 index: _37:c465->_0 _4c:c165->_0
>>> _61:c245->_0
>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >>>> >> >> IW 0 [main]: CMS: =A0 consider merge _61:c245->_0 _9e:c485->=
_0
>>> >>>> >> _ay:c225->_0
>>> >>>> >> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>> >>>> >> >> IW 0 [main]: CMS: =A0 =A0 launch new thread [Lucene Merge Th=
read
>>> #73]
>>> >>>> >> >> IW 0 [main]: CMS: =A0 no more merges pending; now return
>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: CMS: =A0 merge thread: start
>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: now merge
>>> >>>> >> >> =A0merge=3D_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->_0
>>> >>>> _b0:c5->_0
>>> >>>> >> into
>>> >>>> >> >> _b5 [optimize]
>>> >>>> >> >> =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@3725=
db
>>> >>>> >> >> =A0index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->=
_0
>>> >>>> >> _ay:c225->_0
>>> >>>> >> >> _az:c5->_0 _b0:c5->_0
>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0
>>> _9e:c485->_0
>>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: hit exception during merge
>>> >>>> >> >> Exception in thread "Lucene Merge Thread #73"
>>> >>>> >> >> org.apache.lucene.index.MergePolicy$MergeException:
>>> >>>> >> >> java.io.FileNotFoundException: /SY
>>> >>>> >> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(C=
oncurrentMergeScheduler.java:309)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concur=
rentMergeScheduler.java:286)
>>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5)=
)
>>> >>>> >> >> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Metho=
d)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDi=
rectory.java:552)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.jav=
a:582)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488=
)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.ja=
va:70)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321=
)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>>
>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerg=
eScheduler.java:205)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concur=
rentMergeScheduler.java:260)
>>> >>>> >> >> Aug 13, 2009 2:40:56 PM
>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP
>>> >>>> >> >> jspMain
>>> >>>> >> >> SEVERE: Indexing not completebackground merge hit exception:
>>> >>>> >> _61:c245->_0
>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
>>> >>>> >> >> optimize]
>>> >>>> >> >> java.io.IOException: background merge hit exception:
>>> _61:c245->_0
>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5
>>> >>>> [optimize
>>> >>>> >> >> ]
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273=
)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218=
)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198=
)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>> >>>> >> >> Source)
>>> >>>> >> >> =A0 =A0 =A0 =A0at org.hp.openvms.lucene.index.FileIndexer.ma=
in(Unknown
>>> >>>> Source)
>>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5)=
)
>>> >>>> >> >> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Metho=
d)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDi=
rectory.java:552)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.jav=
a:582)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488=
)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.ja=
va:70)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321=
)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>>
>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerg=
eScheduler.java:205)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concur=
rentMergeScheduler.java:260)
>>> >>>> >> >> IW 0 [main]: now flush at close
>>> >>>> >> >> IW 0 [main]: =A0 flush: segment=3Dnull docStoreSegment=3Dnul=
l
>>> >>>> >> docStoreOffset=3D0
>>> >>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfalse=
 numD
>>> >>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>> >>>> >> >> IW 0 [main]: =A0 index before flush _37:c465->_0 _4c:c165->_=
0
>>> >>>> >> _61:c245->_0
>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >>>> >> >> IW 0 [main]: CMS: now merge
>>> >>>> >> >> IW 0 [main]: CMS: =A0 index: _37:c465->_0 _4c:c165->_0
>>> _61:c245->_0
>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>> >>>> >> >> IW 0 [main]: CMS: =A0 no more merges pending; now return
>>> >>>> >> >> IW 0 [main]: now call final commit()
>>> >>>> >> >> IW 0 [main]: startCommit(): start sizeInBytes=3D0
>>> >>>> >> >> IW 0 [main]: startCommit index=3D_37:c465->_0 _4c:c165->_0
>>> >>>> _61:c245->_0
>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 changeCount=
=3D11
>>> >>>> >> >> 95
>>> >>>> >> >> IW 0 [main]: now sync _37.cfs
>>> >>>> >> >> IW 0 [main]: hit exception while closing
>>> >>>> >> >> Exception in thread "main" java.io.FileNotFoundException:
>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error (errno:5)=
)
>>> >>>> >> >> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Metho=
d)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>>
>>> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1654=
)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> >> >>
>>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>> >>>> >> >> Source)
>>> >>>> >> >> =A0 =A0 =A0 =A0at org.hp.openvms.lucene.index.FileIndexer.ma=
in(Unknown
>>> >>>> Source)
>>> >>>> >> >>
>>> >>>> >> >>
>>> >>>> >> >>
>>> >>>> >> >> I have setMaxBufferedDocs =3D 5 and setMergeFactor=3D5. I wa=
s
>>> trying
>>> >>>> >> >> different
>>> >>>> >> >> combinations of these to see if that helps but was
>>> unsuccessful.
>>> >>>> >> >>
>>> >>>> >> >>
>>> >>>> >> >> Regards,
>>> >>>> >> >> Rishi
>>> >>>> >> >> --
>>> >>>> >> >> View this message in context:
>>> >>>> >> >>
>>> >>>> >>
>>> >>>>
>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merg=
e%22-tp24951667p24951667.html
>>> >>>> >> >> Sent from the Lucene - Java Users mailing list archive at
>>> >>>> Nabble.com.
>>> >>>> >> >>
>>> >>>> >> >>
>>> >>>> >> >>
>>> >>>>
>>> ---------------------------------------------------------------------
>>> >>>> >> >> To unsubscribe, e-mail:
>>> java-user-unsubscribe@lucene.apache.org
>>> >>>> >> >> For additional commands, e-mail:
>>> java-user-help@lucene.apache.org
>>> >>>> >> >>
>>> >>>> >> >>
>>> >>>> >> >
>>> >>>> >> >
>>> >>>>
>>> ---------------------------------------------------------------------
>>> >>>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.o=
rg
>>> >>>> >> > For additional commands, e-mail:
>>> java-user-help@lucene.apache.org
>>> >>>> >> >
>>> >>>> >> >
>>> >>>> >> >
>>> >>>> >>
>>> >>>> >> --
>>> >>>> >> View this message in context:
>>> >>>> >>
>>> >>>>
>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merg=
e%22-tp24951667p24952295.html
>>> >>>> >> Sent from the Lucene - Java Users mailing list archive at
>>> >>>> Nabble.com.
>>> >>>> >>
>>> >>>> >>
>>> >>>> >>
>>> >>>>
>>> ---------------------------------------------------------------------
>>> >>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> >>>> >> For additional commands, e-mail: java-user-help@lucene.apache.o=
rg
>>> >>>> >>
>>> >>>> >>
>>> >>>> >
>>> >>>> >
>>> >>>>
>>> >>>> --
>>> >>>> View this message in context:
>>> >>>>
>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merg=
e%22-tp24951667p24953575.html
>>> >>>> Sent from the Lucene - Java Users mailing list archive at
>>> Nabble.com.
>>> >>>>
>>> >>>>
>>> >>>>
>>> ---------------------------------------------------------------------
>>> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>> >>>>
>>> >>>>
>>> >>>
>>> >>>
>>> >>
>>> >> --
>>> >> View this message in context:
>>> >>
>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merg=
e%22-tp24951667p24953833.html
>>> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com=
.
>>> >>
>>> >>
>>> >> --------------------------------------------------------------------=
-
>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>>> >>
>>> >>
>>> >
>>> > ---------------------------------------------------------------------
>>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>>> >
>>> >
>>> >
>>>
>>> --
>>> View this message in context:
>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merg=
e%22-tp24951667p24958845.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>
> --
> View this message in context: http://www.nabble.com/Indexer-crashes-with-=
%22hit-exception-during-merge%22-tp24951667p24970274.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41891-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 12:13:58 2009
Return-Path: <java-user-return-41891-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24477 invoked from network); 14 Aug 2009 12:13:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 12:13:57 -0000
Received: (qmail 52362 invoked by uid 500); 14 Aug 2009 12:14:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52287 invoked by uid 500); 14 Aug 2009 12:14:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52277 invoked by uid 99); 14 Aug 2009 12:14:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 12:14:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 12:13:52 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mbvf1-0007Dq-Je
	for java-user@lucene.apache.org; Fri, 14 Aug 2009 05:13:31 -0700
Message-ID: <24970750.post@talk.nabble.com>
Date: Fri, 14 Aug 2009 05:13:31 -0700 (PDT)
From: rishisinghal <singhal.rishi@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Indexer crashes with "hit exception during merge"
In-Reply-To: <9ac0c6aa0908140450q6df61575o708db832c4493323@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: singhal.rishi@gmail.com
References: <24951667.post@talk.nabble.com> <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com> <24952295.post@talk.nabble.com> <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com> <24953575.post@talk.nabble.com> <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com> <24953833.post@talk.nabble.com> <9ac0c6aa0908130535x68ad6b4atcf0663a4b046f0f9@mail.gmail.com> <24958845.post@talk.nabble.com> <786fde50908140409u5fe053f1j9a49efae6797d25c@mail.gmail.com> <24970274.post@talk.nabble.com> <9ac0c6aa0908140450q6df61575o708db832c4493323@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


This is a big project having lots of source files.  The excerpt of the main
indexer program  is:
FileIndexer indexer =3D new FileIndexer(props);
=09=09
=09=09Analyzer defAnalyzer =3D new StandardAnalyzer();
=09=09FileIndexer.analyzer =3D defAnalyzer;
=09=09IndexWriter writer =3D new IndexWriter(dir,FileIndexer.analyzer, true=
,
IndexWriter.MaxFieldLength.LIMITED);
=09=09writer.setMaxBufferedDocs(5);
=09=09//writer.setMaxMergeDocs(50);
=09=09writer.setMergeFactor(5);
=09=09
=09=09long start =3D new Date().getTime();
=09=09try
=09=09{
=09=09for (int i=3D0; i<disks.size();i++)
=09=09{
=09=09index(writer, new File(disks.get(i)),filelist, FileIndexer.analyzer);
=09=09
=09=09}=09=09
=09=09writer.setInfoStream(System.out);
=09=09writer.optimize();
=09=09}
=09=09catch(Exception e)
=09=09{
=09=09=09=09e.printStackTrace();
=09=09}
=09=09finally
=09=09{
=09=09=09
=09=09=09writer.close();
=09=09}






Michael McCandless-2 wrote:
>=20
> Can you post the full sources for the test that hits the exception on
> your system?
>=20
> Mike
>=20
> On Fri, Aug 14, 2009 at 7:36 AM, rishisinghal<singhal.rishi@gmail.com>
> wrote:
>>
>> It is reproducible in my system. If the number of files are small I am
>> not
>> able to see the crash.
>>
>>>>can you turn on infoStream on IndexWriter and post the output?
>> I am not clear on this. If you are talking of
>> writer.setInfoStream(System.out);
>> I already have posted the output while raising the issue.
>>
>>
>>>>If CheckIndex succeeds, then I'd compare the output w/ and w/o
CheckIndex.
>> I am not clear on this too. As I know CheckIndex program has been run
>> after
>> I get the error and it shows no issues.
>>
>> Regards,
>> Rishi
>>
>>
>>
>> Shai Erera wrote:
>>>
>>> If it's easily reproducible, can you please provide a test that
>>> reproduces
>>> it, even if on just your FS? And also, can you turn on infoStream on
>>> IndexWriter and post the output?
>>>
>>> If CheckIndex succeeds, then I'd compare the output w/ and w/o
>>> CheckIndex.
>>>
>>> Shai
>>>
>>> On Fri, Aug 14, 2009 at 12:17 AM, rishisinghal
>>> <singhal.rishi@gmail.com>wrote:
>>>
>>>>
>>>> I am running this on OpenVMS V8.2-1 on IA64. For a small number of
>>>> files
>>>> this
>>>> works all fine.
>>>>
>>>> I checked the resources part and i have enough disk and ram available.
>>>>
>>>> Regards,
>>>> Rishi
>>>>
>>>>
>>>> Michael McCandless-2 wrote:
>>>> >
>>>> > It's very odd that CheckIndex has no trouble opening the segment's
>>>> > files, yet when you run optimize the OS reports a "file not found"
>>>> > exception (errno 5). =C2=A0Something odd is happening at the OS/file=
system
>>>> > level.
>>>> >
>>>> > What OS are you running on?
>>>> >
>>>> > Can you boil this down to a smallish standalone test that shows the
>>>> > problem?
>>>> >
>>>> > Mike
>>>> >
>>>> > On Thu, Aug 13, 2009 at 8:21 AM,
>>>> rishisinghal<singhal.rishi@gmail.com>
>>>> > wrote:
>>>> >>
>>>> >> I tried creating the index in different disks but still i see the
>>>> issue
>>>> >> :-(
>>>> >>
>>>> >> I tried to index documents in other disks also and got the same
>>>> >> exception.
>>>> >>
>>>> >> I also tried
>>>> >> $ java org.apache.lucene.index.CheckIndex
>>>> >> /SYS$SYSDEVICE/RISHI/melon_1600/
>>>> >> -segment _61
>>>> >> NOTE: testing will be more thorough if you run java with
>>>> >> '-ea:org.apache.lucene...', so assertions are enabled
>>>> >> Opening index @ /SYS$SYSDEVICE/RISHI/melon_1600/
>>>> >> Segments file=3Dsegments_1 numSegments=3D0 version=3DFORMAT_HAS_PRO=
X
>>>> [Lucene
>>>> >> 2.4]
>>>> >>
>>>> >> Checking only these segments: _61:
>>>> >> No problems were detected with this index.
>>>> >>
>>>> >> Regards,
>>>> >> Rishi
>>>> >>
>>>> >>
>>>> >> Shai Erera wrote:
>>>> >>>
>>>> >>> I noticed the exception is "Caused by:
>>>> java.io.FileNotFoundException:
>>>> >>> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))"
>>>> >>>
>>>> >>> I searched for i/o error (errno:5) and found some information whic=
h
>>>> >>> associates it w/ a more native IO problem, like corrupt file due t=
o
>>>> >>> system
>>>> >>> crash etc.
>>>> >>>
>>>> >>> Did you experience that? Can you try to create the index somewhere
>>>> else,
>>>> >>> or
>>>> >>> on another drive?
>>>> >>>
>>>> >>> Shai
>>>> >>>
>>>> >>> On Thu, Aug 13, 2009 at 3:00 PM, rishisinghal
>>>> >>> <singhal.rishi@gmail.com>wrote:
>>>> >>>
>>>> >>>>
>>>> >>>> It is a local file system.
>>>> >>>>
>>>> >>>> We are using lucene 2.4 and java 1.5
>>>> >>>>
>>>> >>>> Regards,
>>>> >>>> Rishi
>>>> >>>>
>>>> >>>>
>>>> >>>> Shai Erera wrote:
>>>> >>>> >
>>>> >>>> > Is that a local file system, or a network share?
>>>> >>>> >
>>>> >>>> > On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
>>>> >>>> > <singhal.rishi@gmail.com>wrote:
>>>> >>>> >
>>>> >>>> >>
>>>> >>>> >> >>Is there any chance that two writers are open on this
>>>> directory?
>>>> >>>> >> No, thats not true.
>>>> >>>> >>
>>>> >>>> >> >>something external to Lucene is removing files from the
>>>> directory.
>>>> >>>> >> No this also has rare chances as I am the owner of these files
>>>> and
>>>> >>>> other
>>>> >>>> >> then me no one can delete the, :-)
>>>> >>>> >>
>>>> >>>> >> Here are all the files in the index directory:
>>>> >>>> >> segments.gen;1 =C2=A0 =C2=A0 =C2=A0segments_1.;1 =C2=A0 =C2=A0=
 =C2=A0 segments_2.;1
>>>> _0.fdt;1
>>>> >>>> >> _0.fdx;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0_37.cfs;1 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _4c.cfs;1
>>>> >>>> _61.cfs;1
>>>> >>>> >> _9e.cfs;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _ay.cfs;1 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 _az.cfs;1
>>>> >>>> _b0.cfs;1
>>>> >>>> >> _b2.tis;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _b3.fdt;1 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 _b4.fdt;1
>>>> >>>> >>
>>>> >>>> >> I see _37 present.
>>>> >>>> >>
>>>> >>>> >> Regards,
>>>> >>>> >> Rishi
>>>> >>>> >>
>>>> >>>> >>
>>>> >>>> >> Michael McCandless-2 wrote:
>>>> >>>> >> >
>>>> >>>> >> > Is there any chance that two writers are open on this
>>>> directory?
>>>> >>>> Or,
>>>> >>>> >> > something external to Lucene is removing files from the
>>>> directory.
>>>> >>>> >> >
>>>> >>>> >> > It looks like there were at least two missing files (_37
>>>> >>>> >> >
>>>> >>>> >> > On Thu, Aug 13, 2009 at 5:19 AM,
>>>> >>>> rishisinghal<singhal.rishi@gmail.com
>>>> >>>> >
>>>> >>>> >> > wrote:
>>>> >>>> >> >>
>>>> >>>> >> >> Hi,
>>>> >>>> >> >>
>>>> >>>> >> >> I am trying to index documents and when all is complete and
>>>> >>>> optimize
>>>> >>>> >> is
>>>> >>>> >> >> called I get
>>>> >>>> >> >>
>>>> >>>> >> >> IFD [main]: setInfoStream
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionPol=
icy@4fced0
>>>> >>>> >> >> IW 0 [main]: setInfoStream:
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>> dir=3Dorg.apache.lucene.store.FSDirectory@
>>>> /SYS$SYSDEVICE/RISHI/melon_1600
>>>> >>>> >> >> autoCommit=3Dfalse mergePolicy=3Dorg
>>>> >>>> >> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
>>>> >>>> >> >>
>>>> >>>>
>>>> mergeScheduler=3Dorg.apache.lucene.index.ConcurrentMergeScheduler@6038=
e4
>>>> >>>> >> >> ramBufferS
>>>> >>>> >> >> izeMB=3D16.0 maxBufferedDocs=3D5 maxBuffereDeleteTerms=3D-1
>>>> >>>> >> >> maxFieldLength=3D10000
>>>> >>>> >> >> index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_0
>>>> >>>> >> >> =C2=A0_ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >>>> >> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0
>>>> >>>> >> _61:c245->_0
>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >>>> >> >> IW 0 [main]: =C2=A0 flush: segment=3Dnull docStoreSegment=
=3Dnull
>>>> >>>> >> docStoreOffset=3D0
>>>> >>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfals=
e numD
>>>> >>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>>> >>>> >> >> IW 0 [main]: =C2=A0 index before flush _37:c465->_0 _4c:c16=
5->_0
>>>> >>>> >> _61:c245->_0
>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >>>> >> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0
>>>> >>>> _9e:c485->_0
>>>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1
>>>> pending]
>>>> >>>> >> >> IW 0 [main]: CMS: now merge
>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 index: _37:c465->_0 _4c:c165->_0
>>>> _61:c245->_0
>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 consider merge _61:c245->_0 _9e:c4=
85->_0
>>>> >>>> >> _ay:c225->_0
>>>> >>>> >> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 =C2=A0 launch new thread [Lucene M=
erge Thread
>>>> #73]
>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 no more merges pending; now return
>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: CMS: =C2=A0 merge thread: s=
tart
>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: now merge
>>>> >>>> >> >> =C2=A0merge=3D_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5=
->_0
>>>> >>>> _b0:c5->_0
>>>> >>>> >> into
>>>> >>>> >> >> _b5 [optimize]
>>>> >>>> >> >> =C2=A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@=
3725db
>>>> >>>> >> >> =C2=A0index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c4=
85->_0
>>>> >>>> >> _ay:c225->_0
>>>> >>>> >> >> _az:c5->_0 _b0:c5->_0
>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0
>>>> _9e:c485->_0
>>>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: hit exception during merge
>>>> >>>> >> >> Exception in thread "Lucene Merge Thread #73"
>>>> >>>> >> >> org.apache.lucene.index.MergePolicy$MergeException:
>>>> >>>> >> >> java.io.FileNotFoundException: /SY
>>>> >>>> >> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(=
ConcurrentMergeScheduler.java:309)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concu=
rrentMergeScheduler.java:286)
>>>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error
>>>> (errno:5))
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.open=
(Native Method)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSD=
irectory.java:552)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.ja=
va:582)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>>
>>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.j=
ava:70)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:32=
1)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>>
>>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMer=
geScheduler.java:205)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concu=
rrentMergeScheduler.java:260)
>>>> >>>> >> >> Aug 13, 2009 2:40:56 PM
>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP
>>>> >>>> >> >> jspMain
>>>> >>>> >> >> SEVERE: Indexing not completebackground merge hit exception=
:
>>>> >>>> >> _61:c245->_0
>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
>>>> >>>> >> >> optimize]
>>>> >>>> >> >> java.io.IOException: background merge hit exception:
>>>> _61:c245->_0
>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5
>>>> >>>> [optimize
>>>> >>>> >> >> ]
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>>
>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>>
>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>>
>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>>> >>>> >> >> Source)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>>>> >>>> Source)
>>>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error
>>>> (errno:5))
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.open=
(Native Method)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSD=
irectory.java:552)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.ja=
va:582)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>>
>>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.j=
ava:70)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:32=
1)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>>
>>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMer=
geScheduler.java:205)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concu=
rrentMergeScheduler.java:260)
>>>> >>>> >> >> IW 0 [main]: now flush at close
>>>> >>>> >> >> IW 0 [main]: =C2=A0 flush: segment=3Dnull docStoreSegment=
=3Dnull
>>>> >>>> >> docStoreOffset=3D0
>>>> >>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfals=
e numD
>>>> >>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>>> >>>> >> >> IW 0 [main]: =C2=A0 index before flush _37:c465->_0 _4c:c16=
5->_0
>>>> >>>> >> _61:c245->_0
>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >>>> >> >> IW 0 [main]: CMS: now merge
>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 index: _37:c465->_0 _4c:c165->_0
>>>> _61:c245->_0
>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 no more merges pending; now return
>>>> >>>> >> >> IW 0 [main]: now call final commit()
>>>> >>>> >> >> IW 0 [main]: startCommit(): start sizeInBytes=3D0
>>>> >>>> >> >> IW 0 [main]: startCommit index=3D_37:c465->_0 _4c:c165->_0
>>>> >>>> _61:c245->_0
>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>> changeCount=3D11
>>>> >>>> >> >> 95
>>>> >>>> >> >> IW 0 [main]: now sync _37.cfs
>>>> >>>> >> >> IW 0 [main]: hit exception while closing
>>>> >>>> >> >> Exception in thread "main" java.io.FileNotFoundException:
>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error
>>>> (errno:5))
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.open=
(Native Method)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>>
>>>> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:165=
4)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> >> >>
>>>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>>> >>>> >> >> Source)
>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>> org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>>>> >>>> Source)
>>>> >>>> >> >>
>>>> >>>> >> >>
>>>> >>>> >> >>
>>>> >>>> >> >> I have setMaxBufferedDocs =3D 5 and setMergeFactor=3D5. I w=
as
>>>> trying
>>>> >>>> >> >> different
>>>> >>>> >> >> combinations of these to see if that helps but was
>>>> unsuccessful.
>>>> >>>> >> >>
>>>> >>>> >> >>
>>>> >>>> >> >> Regards,
>>>> >>>> >> >> Rishi
>>>> >>>> >> >> --
>>>> >>>> >> >> View this message in context:
>>>> >>>> >> >>
>>>> >>>> >>
>>>> >>>>
>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-mer=
ge%22-tp24951667p24951667.html
>>>> >>>> >> >> Sent from the Lucene - Java Users mailing list archive at
>>>> >>>> Nabble.com.
>>>> >>>> >> >>
>>>> >>>> >> >>
>>>> >>>> >> >>
>>>> >>>>
>>>> ---------------------------------------------------------------------
>>>> >>>> >> >> To unsubscribe, e-mail:
>>>> java-user-unsubscribe@lucene.apache.org
>>>> >>>> >> >> For additional commands, e-mail:
>>>> java-user-help@lucene.apache.org
>>>> >>>> >> >>
>>>> >>>> >> >>
>>>> >>>> >> >
>>>> >>>> >> >
>>>> >>>>
>>>> ---------------------------------------------------------------------
>>>> >>>> >> > To unsubscribe, e-mail:
>>>> java-user-unsubscribe@lucene.apache.org
>>>> >>>> >> > For additional commands, e-mail:
>>>> java-user-help@lucene.apache.org
>>>> >>>> >> >
>>>> >>>> >> >
>>>> >>>> >> >
>>>> >>>> >>
>>>> >>>> >> --
>>>> >>>> >> View this message in context:
>>>> >>>> >>
>>>> >>>>
>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-mer=
ge%22-tp24951667p24952295.html
>>>> >>>> >> Sent from the Lucene - Java Users mailing list archive at
>>>> >>>> Nabble.com.
>>>> >>>> >>
>>>> >>>> >>
>>>> >>>> >>
>>>> >>>>
>>>> ---------------------------------------------------------------------
>>>> >>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.or=
g
>>>> >>>> >> For additional commands, e-mail:
>>>> java-user-help@lucene.apache.org
>>>> >>>> >>
>>>> >>>> >>
>>>> >>>> >
>>>> >>>> >
>>>> >>>>
>>>> >>>> --
>>>> >>>> View this message in context:
>>>> >>>>
>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-mer=
ge%22-tp24951667p24953575.html
>>>> >>>> Sent from the Lucene - Java Users mailing list archive at
>>>> Nabble.com.
>>>> >>>>
>>>> >>>>
>>>> >>>>
>>>> ---------------------------------------------------------------------
>>>> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>> >>>>
>>>> >>>>
>>>> >>>
>>>> >>>
>>>> >>
>>>> >> --
>>>> >> View this message in context:
>>>> >>
>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-mer=
ge%22-tp24951667p24953833.html
>>>> >> Sent from the Lucene - Java Users mailing list archive at
>>>> Nabble.com.
>>>> >>
>>>> >>
>>>> >>
>>>> ---------------------------------------------------------------------
>>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>> >>
>>>> >>
>>>> >
>>>> > --------------------------------------------------------------------=
-
>>>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>>>> >
>>>> >
>>>> >
>>>>
>>>> --
>>>> View this message in context:
>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-mer=
ge%22-tp24951667p24958845.html
>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>>
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge=
%22-tp24951667p24970274.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Indexer-crashes-with-%2=
2hit-exception-during-merge%22-tp24951667p24970750.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41892-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 12:41:00 2009
Return-Path: <java-user-return-41892-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38946 invoked from network); 14 Aug 2009 12:41:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 12:41:00 -0000
Received: (qmail 88310 invoked by uid 500); 14 Aug 2009 12:41:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88246 invoked by uid 500); 14 Aug 2009 12:41:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88236 invoked by uid 99); 14 Aug 2009 12:41:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 12:41:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 12:40:52 +0000
Received: by gxk12 with SMTP id 12so1984762gxk.4
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 05:40:30 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.172.39 with SMTP id u39mr300647ybe.43.1250253630731; Fri, 
	14 Aug 2009 05:40:30 -0700 (PDT)
In-Reply-To: <24970750.post@talk.nabble.com>
References: <24951667.post@talk.nabble.com> <24953575.post@talk.nabble.com>
	 <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com>
	 <24953833.post@talk.nabble.com>
	 <9ac0c6aa0908130535x68ad6b4atcf0663a4b046f0f9@mail.gmail.com>
	 <24958845.post@talk.nabble.com>
	 <786fde50908140409u5fe053f1j9a49efae6797d25c@mail.gmail.com>
	 <24970274.post@talk.nabble.com>
	 <9ac0c6aa0908140450q6df61575o708db832c4493323@mail.gmail.com>
	 <24970750.post@talk.nabble.com>
Date: Fri, 14 Aug 2009 08:40:30 -0400
Message-ID: <9ac0c6aa0908140540s1e2c9d3dwe384dca94b0e6e28@mail.gmail.com>
Subject: Re: Indexer crashes with "hit exception during merge"
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

But, if you can break out just the Lucene indexing part into a
standalone test, that shows the exception, that can help us isolate
it.

At this point it seems likely the issue is something OS/filesystem
specific, because at one time (during optimize), we see a "file not
found" exception, yet at another time (running CheckIndex) the same
file is opened just fine.

Mike

On Fri, Aug 14, 2009 at 8:13 AM, rishisinghal<singhal.rishi@gmail.com> wrot=
e:
>
> This is a big project having lots of source files. =A0The excerpt of the =
main
> indexer program =A0is:
> FileIndexer indexer =3D new FileIndexer(props);
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Analyzer defAnalyzer =3D new StandardAnaly=
zer();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0FileIndexer.analyzer =3D defAnalyzer;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexWriter writer =3D new IndexWriter(dir=
,FileIndexer.analyzer, true,
> IndexWriter.MaxFieldLength.LIMITED);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0writer.setMaxBufferedDocs(5);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0//writer.setMaxMergeDocs(50);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0writer.setMergeFactor(5);
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0long start =3D new Date().getTime();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0for (int i=3D0; i<disks.size();i++)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0index(writer, new File(disks.get(i)),filel=
ist, FileIndexer.analyzer);
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0writer.setInfoStream(System.out);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0writer.optimize();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0catch(Exception e)
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0e.printSta=
ckTrace();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0finally
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0writer.close();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
>
>
>
>
>
> Michael McCandless-2 wrote:
>>
>> Can you post the full sources for the test that hits the exception on
>> your system?
>>
>> Mike
>>
>> On Fri, Aug 14, 2009 at 7:36 AM, rishisinghal<singhal.rishi@gmail.com>
>> wrote:
>>>
>>> It is reproducible in my system. If the number of files are small I am
>>> not
>>> able to see the crash.
>>>
>>>>>can you turn on infoStream on IndexWriter and post the output?
>>> I am not clear on this. If you are talking of
>>> writer.setInfoStream(System.out);
>>> I already have posted the output while raising the issue.
>>>
>>>
>>>>>If CheckIndex succeeds, then I'd compare the output w/ and w/o
> CheckIndex.
>>> I am not clear on this too. As I know CheckIndex program has been run
>>> after
>>> I get the error and it shows no issues.
>>>
>>> Regards,
>>> Rishi
>>>
>>>
>>>
>>> Shai Erera wrote:
>>>>
>>>> If it's easily reproducible, can you please provide a test that
>>>> reproduces
>>>> it, even if on just your FS? And also, can you turn on infoStream on
>>>> IndexWriter and post the output?
>>>>
>>>> If CheckIndex succeeds, then I'd compare the output w/ and w/o
>>>> CheckIndex.
>>>>
>>>> Shai
>>>>
>>>> On Fri, Aug 14, 2009 at 12:17 AM, rishisinghal
>>>> <singhal.rishi@gmail.com>wrote:
>>>>
>>>>>
>>>>> I am running this on OpenVMS V8.2-1 on IA64. For a small number of
>>>>> files
>>>>> this
>>>>> works all fine.
>>>>>
>>>>> I checked the resources part and i have enough disk and ram available=
.
>>>>>
>>>>> Regards,
>>>>> Rishi
>>>>>
>>>>>
>>>>> Michael McCandless-2 wrote:
>>>>> >
>>>>> > It's very odd that CheckIndex has no trouble opening the segment's
>>>>> > files, yet when you run optimize the OS reports a "file not found"
>>>>> > exception (errno 5). =A0Something odd is happening at the OS/filesy=
stem
>>>>> > level.
>>>>> >
>>>>> > What OS are you running on?
>>>>> >
>>>>> > Can you boil this down to a smallish standalone test that shows the
>>>>> > problem?
>>>>> >
>>>>> > Mike
>>>>> >
>>>>> > On Thu, Aug 13, 2009 at 8:21 AM,
>>>>> rishisinghal<singhal.rishi@gmail.com>
>>>>> > wrote:
>>>>> >>
>>>>> >> I tried creating the index in different disks but still i see the
>>>>> issue
>>>>> >> :-(
>>>>> >>
>>>>> >> I tried to index documents in other disks also and got the same
>>>>> >> exception.
>>>>> >>
>>>>> >> I also tried
>>>>> >> $ java org.apache.lucene.index.CheckIndex
>>>>> >> /SYS$SYSDEVICE/RISHI/melon_1600/
>>>>> >> -segment _61
>>>>> >> NOTE: testing will be more thorough if you run java with
>>>>> >> '-ea:org.apache.lucene...', so assertions are enabled
>>>>> >> Opening index @ /SYS$SYSDEVICE/RISHI/melon_1600/
>>>>> >> Segments file=3Dsegments_1 numSegments=3D0 version=3DFORMAT_HAS_PR=
OX
>>>>> [Lucene
>>>>> >> 2.4]
>>>>> >>
>>>>> >> Checking only these segments: _61:
>>>>> >> No problems were detected with this index.
>>>>> >>
>>>>> >> Regards,
>>>>> >> Rishi
>>>>> >>
>>>>> >>
>>>>> >> Shai Erera wrote:
>>>>> >>>
>>>>> >>> I noticed the exception is "Caused by:
>>>>> java.io.FileNotFoundException:
>>>>> >>> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))"
>>>>> >>>
>>>>> >>> I searched for i/o error (errno:5) and found some information whi=
ch
>>>>> >>> associates it w/ a more native IO problem, like corrupt file due =
to
>>>>> >>> system
>>>>> >>> crash etc.
>>>>> >>>
>>>>> >>> Did you experience that? Can you try to create the index somewher=
e
>>>>> else,
>>>>> >>> or
>>>>> >>> on another drive?
>>>>> >>>
>>>>> >>> Shai
>>>>> >>>
>>>>> >>> On Thu, Aug 13, 2009 at 3:00 PM, rishisinghal
>>>>> >>> <singhal.rishi@gmail.com>wrote:
>>>>> >>>
>>>>> >>>>
>>>>> >>>> It is a local file system.
>>>>> >>>>
>>>>> >>>> We are using lucene 2.4 and java 1.5
>>>>> >>>>
>>>>> >>>> Regards,
>>>>> >>>> Rishi
>>>>> >>>>
>>>>> >>>>
>>>>> >>>> Shai Erera wrote:
>>>>> >>>> >
>>>>> >>>> > Is that a local file system, or a network share?
>>>>> >>>> >
>>>>> >>>> > On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
>>>>> >>>> > <singhal.rishi@gmail.com>wrote:
>>>>> >>>> >
>>>>> >>>> >>
>>>>> >>>> >> >>Is there any chance that two writers are open on this
>>>>> directory?
>>>>> >>>> >> No, thats not true.
>>>>> >>>> >>
>>>>> >>>> >> >>something external to Lucene is removing files from the
>>>>> directory.
>>>>> >>>> >> No this also has rare chances as I am the owner of these file=
s
>>>>> and
>>>>> >>>> other
>>>>> >>>> >> then me no one can delete the, :-)
>>>>> >>>> >>
>>>>> >>>> >> Here are all the files in the index directory:
>>>>> >>>> >> segments.gen;1 =A0 =A0 =A0segments_1.;1 =A0 =A0 =A0 segments_=
2.;1
>>>>> _0.fdt;1
>>>>> >>>> >> _0.fdx;1 =A0 =A0 =A0 =A0 =A0 =A0_37.cfs;1 =A0 =A0 =A0 =A0 =A0=
 _4c.cfs;1
>>>>> >>>> _61.cfs;1
>>>>> >>>> >> _9e.cfs;1 =A0 =A0 =A0 =A0 =A0 _ay.cfs;1 =A0 =A0 =A0 =A0 =A0 _=
az.cfs;1
>>>>> >>>> _b0.cfs;1
>>>>> >>>> >> _b2.tis;1 =A0 =A0 =A0 =A0 =A0 _b3.fdt;1 =A0 =A0 =A0 =A0 =A0 _=
b4.fdt;1
>>>>> >>>> >>
>>>>> >>>> >> I see _37 present.
>>>>> >>>> >>
>>>>> >>>> >> Regards,
>>>>> >>>> >> Rishi
>>>>> >>>> >>
>>>>> >>>> >>
>>>>> >>>> >> Michael McCandless-2 wrote:
>>>>> >>>> >> >
>>>>> >>>> >> > Is there any chance that two writers are open on this
>>>>> directory?
>>>>> >>>> Or,
>>>>> >>>> >> > something external to Lucene is removing files from the
>>>>> directory.
>>>>> >>>> >> >
>>>>> >>>> >> > It looks like there were at least two missing files (_37
>>>>> >>>> >> >
>>>>> >>>> >> > On Thu, Aug 13, 2009 at 5:19 AM,
>>>>> >>>> rishisinghal<singhal.rishi@gmail.com
>>>>> >>>> >
>>>>> >>>> >> > wrote:
>>>>> >>>> >> >>
>>>>> >>>> >> >> Hi,
>>>>> >>>> >> >>
>>>>> >>>> >> >> I am trying to index documents and when all is complete an=
d
>>>>> >>>> optimize
>>>>> >>>> >> is
>>>>> >>>> >> >> called I get
>>>>> >>>> >> >>
>>>>> >>>> >> >> IFD [main]: setInfoStream
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionPo=
licy@4fced0
>>>>> >>>> >> >> IW 0 [main]: setInfoStream:
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>> dir=3Dorg.apache.lucene.store.FSDirectory@
>>>>> /SYS$SYSDEVICE/RISHI/melon_1600
>>>>> >>>> >> >> autoCommit=3Dfalse mergePolicy=3Dorg
>>>>> >>>> >> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
>>>>> >>>> >> >>
>>>>> >>>>
>>>>> mergeScheduler=3Dorg.apache.lucene.index.ConcurrentMergeScheduler@603=
8e4
>>>>> >>>> >> >> ramBufferS
>>>>> >>>> >> >> izeMB=3D16.0 maxBufferedDocs=3D5 maxBuffereDeleteTerms=3D-=
1
>>>>> >>>> >> >> maxFieldLength=3D10000
>>>>> >>>> >> >> index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->_=
0
>>>>> >>>> >> >> =A0_ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>> >>>> >> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_0
>>>>> >>>> >> _61:c245->_0
>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>> >>>> >> >> IW 0 [main]: =A0 flush: segment=3Dnull docStoreSegment=3Dn=
ull
>>>>> >>>> >> docStoreOffset=3D0
>>>>> >>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfal=
se numD
>>>>> >>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>>>> >>>> >> >> IW 0 [main]: =A0 index before flush _37:c465->_0 _4c:c165-=
>_0
>>>>> >>>> >> _61:c245->_0
>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>> >>>> >> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0
>>>>> >>>> _9e:c485->_0
>>>>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1
>>>>> pending]
>>>>> >>>> >> >> IW 0 [main]: CMS: now merge
>>>>> >>>> >> >> IW 0 [main]: CMS: =A0 index: _37:c465->_0 _4c:c165->_0
>>>>> _61:c245->_0
>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>> >>>> >> >> IW 0 [main]: CMS: =A0 consider merge _61:c245->_0 _9e:c485=
->_0
>>>>> >>>> >> _ay:c225->_0
>>>>> >>>> >> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>>>> >>>> >> >> IW 0 [main]: CMS: =A0 =A0 launch new thread [Lucene Merge =
Thread
>>>>> #73]
>>>>> >>>> >> >> IW 0 [main]: CMS: =A0 no more merges pending; now return
>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: CMS: =A0 merge thread: sta=
rt
>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: now merge
>>>>> >>>> >> >> =A0merge=3D_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:c5->=
_0
>>>>> >>>> _b0:c5->_0
>>>>> >>>> >> into
>>>>> >>>> >> >> _b5 [optimize]
>>>>> >>>> >> >> =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@37=
25db
>>>>> >>>> >> >> =A0index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485=
->_0
>>>>> >>>> >> _ay:c225->_0
>>>>> >>>> >> >> _az:c5->_0 _b0:c5->_0
>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0
>>>>> _9e:c485->_0
>>>>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: hit exception during merge
>>>>> >>>> >> >> Exception in thread "Lucene Merge Thread #73"
>>>>> >>>> >> >> org.apache.lucene.index.MergePolicy$MergeException:
>>>>> >>>> >> >> java.io.FileNotFoundException: /SY
>>>>> >>>> >> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException=
(ConcurrentMergeScheduler.java:309)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Conc=
urrentMergeScheduler.java:286)
>>>>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error
>>>>> (errno:5))
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Met=
hod)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FS=
Directory.java:552)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.j=
ava:582)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>>
>>>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.=
java:70)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:3=
21)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220=
)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMe=
rgeScheduler.java:205)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Conc=
urrentMergeScheduler.java:260)
>>>>> >>>> >> >> Aug 13, 2009 2:40:56 PM
>>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP
>>>>> >>>> >> >> jspMain
>>>>> >>>> >> >> SEVERE: Indexing not completebackground merge hit exceptio=
n:
>>>>> >>>> >> _61:c245->_0
>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [
>>>>> >>>> >> >> optimize]
>>>>> >>>> >> >> java.io.IOException: background merge hit exception:
>>>>> _61:c245->_0
>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5
>>>>> >>>> [optimize
>>>>> >>>> >> >> ]
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>>>> >>>> >> >> Source)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>>>>> >>>> Source)
>>>>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error
>>>>> (errno:5))
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Met=
hod)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FS=
Directory.java:552)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.j=
ava:582)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>>
>>>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.=
java:70)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:3=
21)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220=
)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMe=
rgeScheduler.java:205)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Conc=
urrentMergeScheduler.java:260)
>>>>> >>>> >> >> IW 0 [main]: now flush at close
>>>>> >>>> >> >> IW 0 [main]: =A0 flush: segment=3Dnull docStoreSegment=3Dn=
ull
>>>>> >>>> >> docStoreOffset=3D0
>>>>> >>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfal=
se numD
>>>>> >>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>>>> >>>> >> >> IW 0 [main]: =A0 index before flush _37:c465->_0 _4c:c165-=
>_0
>>>>> >>>> >> _61:c245->_0
>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>> >>>> >> >> IW 0 [main]: CMS: now merge
>>>>> >>>> >> >> IW 0 [main]: CMS: =A0 index: _37:c465->_0 _4c:c165->_0
>>>>> _61:c245->_0
>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>> >>>> >> >> IW 0 [main]: CMS: =A0 no more merges pending; now return
>>>>> >>>> >> >> IW 0 [main]: now call final commit()
>>>>> >>>> >> >> IW 0 [main]: startCommit(): start sizeInBytes=3D0
>>>>> >>>> >> >> IW 0 [main]: startCommit index=3D_37:c465->_0 _4c:c165->_0
>>>>> >>>> _61:c245->_0
>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>> changeCount=3D11
>>>>> >>>> >> >> 95
>>>>> >>>> >> >> IW 0 [main]: now sync _37.cfs
>>>>> >>>> >> >> IW 0 [main]: hit exception while closing
>>>>> >>>> >> >> Exception in thread "main" java.io.FileNotFoundException:
>>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error
>>>>> (errno:5))
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Met=
hod)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456=
)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4590=
)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:16=
54)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> >> >>
>>>>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>>>> >>>> >> >> Source)
>>>>> >>>> >> >> =A0 =A0 =A0 =A0at
>>>>> org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>>>>> >>>> Source)
>>>>> >>>> >> >>
>>>>> >>>> >> >>
>>>>> >>>> >> >>
>>>>> >>>> >> >> I have setMaxBufferedDocs =3D 5 and setMergeFactor=3D5. I =
was
>>>>> trying
>>>>> >>>> >> >> different
>>>>> >>>> >> >> combinations of these to see if that helps but was
>>>>> unsuccessful.
>>>>> >>>> >> >>
>>>>> >>>> >> >>
>>>>> >>>> >> >> Regards,
>>>>> >>>> >> >> Rishi
>>>>> >>>> >> >> --
>>>>> >>>> >> >> View this message in context:
>>>>> >>>> >> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-me=
rge%22-tp24951667p24951667.html
>>>>> >>>> >> >> Sent from the Lucene - Java Users mailing list archive at
>>>>> >>>> Nabble.com.
>>>>> >>>> >> >>
>>>>> >>>> >> >>
>>>>> >>>> >> >>
>>>>> >>>>
>>>>> ---------------------------------------------------------------------
>>>>> >>>> >> >> To unsubscribe, e-mail:
>>>>> java-user-unsubscribe@lucene.apache.org
>>>>> >>>> >> >> For additional commands, e-mail:
>>>>> java-user-help@lucene.apache.org
>>>>> >>>> >> >>
>>>>> >>>> >> >>
>>>>> >>>> >> >
>>>>> >>>> >> >
>>>>> >>>>
>>>>> ---------------------------------------------------------------------
>>>>> >>>> >> > To unsubscribe, e-mail:
>>>>> java-user-unsubscribe@lucene.apache.org
>>>>> >>>> >> > For additional commands, e-mail:
>>>>> java-user-help@lucene.apache.org
>>>>> >>>> >> >
>>>>> >>>> >> >
>>>>> >>>> >> >
>>>>> >>>> >>
>>>>> >>>> >> --
>>>>> >>>> >> View this message in context:
>>>>> >>>> >>
>>>>> >>>>
>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-me=
rge%22-tp24951667p24952295.html
>>>>> >>>> >> Sent from the Lucene - Java Users mailing list archive at
>>>>> >>>> Nabble.com.
>>>>> >>>> >>
>>>>> >>>> >>
>>>>> >>>> >>
>>>>> >>>>
>>>>> ---------------------------------------------------------------------
>>>>> >>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.o=
rg
>>>>> >>>> >> For additional commands, e-mail:
>>>>> java-user-help@lucene.apache.org
>>>>> >>>> >>
>>>>> >>>> >>
>>>>> >>>> >
>>>>> >>>> >
>>>>> >>>>
>>>>> >>>> --
>>>>> >>>> View this message in context:
>>>>> >>>>
>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-me=
rge%22-tp24951667p24953575.html
>>>>> >>>> Sent from the Lucene - Java Users mailing list archive at
>>>>> Nabble.com.
>>>>> >>>>
>>>>> >>>>
>>>>> >>>>
>>>>> ---------------------------------------------------------------------
>>>>> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> >>>> For additional commands, e-mail: java-user-help@lucene.apache.or=
g
>>>>> >>>>
>>>>> >>>>
>>>>> >>>
>>>>> >>>
>>>>> >>
>>>>> >> --
>>>>> >> View this message in context:
>>>>> >>
>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-me=
rge%22-tp24951667p24953833.html
>>>>> >> Sent from the Lucene - Java Users mailing list archive at
>>>>> Nabble.com.
>>>>> >>
>>>>> >>
>>>>> >>
>>>>> ---------------------------------------------------------------------
>>>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>> >>
>>>>> >>
>>>>> >
>>>>> > -------------------------------------------------------------------=
--
>>>>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>> >
>>>>> >
>>>>> >
>>>>>
>>>>> --
>>>>> View this message in context:
>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-me=
rge%22-tp24951667p24958845.html
>>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>
>>>>
>>>
>>> --
>>> View this message in context:
>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merg=
e%22-tp24951667p24970274.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> --
> View this message in context: http://www.nabble.com/Indexer-crashes-with-=
%22hit-exception-during-merge%22-tp24951667p24970750.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41893-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 12:47:38 2009
Return-Path: <java-user-return-41893-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40694 invoked from network); 14 Aug 2009 12:47:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 12:47:38 -0000
Received: (qmail 98522 invoked by uid 500); 14 Aug 2009 12:47:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98428 invoked by uid 500); 14 Aug 2009 12:47:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98418 invoked by uid 99); 14 Aug 2009 12:47:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 12:47:42 +0000
X-ASF-Spam-Status: No, hits=-8.0 required=10.0
	tests=RCVD_IN_DNSWL_HI,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Ueli.Kistler@trivadis.com designates 212.249.206.79 as permitted sender)
Received: from [212.249.206.79] (HELO mailx1.trivadis.com) (212.249.206.79)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 12:47:33 +0000
X-ASG-Debug-ID: 1250254130-6363002c0000-H1Y1KX
X-Barracuda-URL: http://mailx1.trivadis.com:8000/cgi-bin/mark.cgi
Received: from mailx2.trivadis.com (localhost [127.0.0.1])
	by mailx1.trivadis.com (Spam & Virus Firewall) with ESMTP id E633F2A8F9E
	for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 14:48:50 +0200 (CEST)
Received: from mailx2.trivadis.com ([172.16.34.102]) by mailx1.trivadis.com with ESMTP id HlR13ZJOjy3Jbxs2 for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 14:48:50 +0200 (CEST)
X-Barracuda-Envelope-From: Ueli.Kistler@trivadis.com
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-ASG-Orig-Subj: AW: AW: AW: Wildcard search fails
Subject: AW: AW: AW: Wildcard search fails
Date: Fri, 14 Aug 2009 14:47:11 +0200
Message-ID: <F2C9CCA71510B442AF71446CAE8AEBAF0184FD19@MSXVS04.trivadis.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: AW: AW: Wildcard search fails
Thread-Index: AcoczfHTatyE6+TsT/q4ao/yIGbOdAADx0xA
References: <901677.16404.qm@web52905.mail.re2.yahoo.com>
From: "Ueli Kistler" <Ueli.Kistler@trivadis.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: UNKNOWN[172.16.34.102]
X-Barracuda-Start-Time: 1250254130
X-Barracuda-Virus-Scanned: by Barracuda Spam & Virus Firewall at trivadis.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

using PatternAnalyzer solved the problem as well, using a whitespace =
pattern.
There's lowercase support as well (see =
http://lucene.apache.org/java/2_2_0/api/org/apache/lucene/index/memory/Pa=
tternAnalyzer.html)

Many thanks.

Regards,
Ueli Kistler

-----Urspr=FCngliche Nachricht-----
Von: AHMET ARSLAN [mailto:iorixxx@yahoo.com]=20
Gesendet: Freitag, 14. August 2009 12:56
An: java-user@lucene.apache.org
Betreff: Re: AW: AW: Wildcard search fails

> Noticed that in Luke... is there any existing analyzer around that=20
> supports case-insensitive search and recognizes "RZ/G/17" as one =
token?=20

As far as I know there is no built-in analyzer that uses whitespace =
tokenizer and lowercase filter together. But it is easy to cast =
tokenizer and token filters to create a new analyzer. You said that you =
were using SnowballAnalyzer, right? Just replace tokenizer from standard =
to whitespace. Edit SnowballAnalyzer.java :

public TokenStream tokenStream(String fieldName, Reader reader) {
    TokenStream result =3D new WhitespaceTokenizer(reader);
    result =3D new LowerCaseFilter(result);
    if (stopSet !=3D null)
      result =3D new StopFilter(result, stopSet);
    result =3D new SnowballFilter(result, name);
    return result;
  }

By changing this method you can create custom analyzers. If you do not =
want stemming just erase the line that contains SnowballFilter, etc. =
Since you have lowercasefilter in your analyzer, your wildcard queries =
should be lowercased. Alternatively you can set =
setLowercaseExpandedTerms(true) of your QueryParser.


     =20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41894-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 12:52:23 2009
Return-Path: <java-user-return-41894-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42414 invoked from network); 14 Aug 2009 12:52:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 12:52:23 -0000
Received: (qmail 8294 invoked by uid 500); 14 Aug 2009 12:52:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8238 invoked by uid 500); 14 Aug 2009 12:52:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8228 invoked by uid 99); 14 Aug 2009 12:52:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 12:52:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 12:52:17 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MbwGC-0000K8-Fg
	for java-user@lucene.apache.org; Fri, 14 Aug 2009 05:51:56 -0700
Message-ID: <24971223.post@talk.nabble.com>
Date: Fri, 14 Aug 2009 05:51:56 -0700 (PDT)
From: rishisinghal <singhal.rishi@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Indexer crashes with "hit exception during merge"
In-Reply-To: <9ac0c6aa0908140540s1e2c9d3dwe384dca94b0e6e28@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: singhal.rishi@gmail.com
References: <24951667.post@talk.nabble.com> <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com> <24952295.post@talk.nabble.com> <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com> <24953575.post@talk.nabble.com> <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com> <24953833.post@talk.nabble.com> <9ac0c6aa0908130535x68ad6b4atcf0663a4b046f0f9@mail.gmail.com> <24958845.post@talk.nabble.com> <786fde50908140409u5fe053f1j9a49efae6797d25c@mail.gmail.com> <24970274.post@talk.nabble.com> <9ac0c6aa0908140450q6df61575o708db832c4493323@mail.gmail.com> <24970750.post@talk.nabble.com> <9ac0c6aa0908140540s1e2c9d3dwe384dca94b0e6e28@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Okay let me try if i can create a standalone test which reproduces this iss=
ue
and get back.

Regards,
Rishi


Michael McCandless-2 wrote:
>=20
> But, if you can break out just the Lucene indexing part into a
> standalone test, that shows the exception, that can help us isolate
> it.
>=20
> At this point it seems likely the issue is something OS/filesystem
> specific, because at one time (during optimize), we see a "file not
> found" exception, yet at another time (running CheckIndex) the same
> file is opened just fine.
>=20
> Mike
>=20
> On Fri, Aug 14, 2009 at 8:13 AM, rishisinghal<singhal.rishi@gmail.com>
> wrote:
>>
>> This is a big project having lots of source files. =C2=A0The excerpt of =
the
>> main
>> indexer program =C2=A0is:
>> FileIndexer indexer =3D new FileIndexer(props);
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Analyzer defAnaly=
zer =3D new StandardAnalyzer();
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0FileIndexer.analy=
zer =3D defAnalyzer;
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0IndexWriter write=
r =3D new
>> IndexWriter(dir,FileIndexer.analyzer, true,
>> IndexWriter.MaxFieldLength.LIMITED);
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0writer.setMaxBuff=
eredDocs(5);
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0//writer.setMaxMe=
rgeDocs(50);
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0writer.setMergeFa=
ctor(5);
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0long start =3D ne=
w Date().getTime();
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0try
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0{
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0for (int i=3D0; i=
<disks.size();i++)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0{
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0index(writer, new=
 File(disks.get(i)),filelist,
>> FileIndexer.analyzer);
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0}
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0writer.setInfoStr=
eam(System.out);
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0writer.optimize()=
;
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0}
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0catch(Exception e=
)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0{
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0e.printStackTrace();
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0}
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0finally
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0{
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0writer.close();
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0}
>>
>>
>>
>>
>>
>>
>> Michael McCandless-2 wrote:
>>>
>>> Can you post the full sources for the test that hits the exception on
>>> your system?
>>>
>>> Mike
>>>
>>> On Fri, Aug 14, 2009 at 7:36 AM, rishisinghal<singhal.rishi@gmail.com>
>>> wrote:
>>>>
>>>> It is reproducible in my system. If the number of files are small I am
>>>> not
>>>> able to see the crash.
>>>>
>>>>>>can you turn on infoStream on IndexWriter and post the output?
>>>> I am not clear on this. If you are talking of
>>>> writer.setInfoStream(System.out);
>>>> I already have posted the output while raising the issue.
>>>>
>>>>
>>>>>>If CheckIndex succeeds, then I'd compare the output w/ and w/o
>> CheckIndex.
>>>> I am not clear on this too. As I know CheckIndex program has been run
>>>> after
>>>> I get the error and it shows no issues.
>>>>
>>>> Regards,
>>>> Rishi
>>>>
>>>>
>>>>
>>>> Shai Erera wrote:
>>>>>
>>>>> If it's easily reproducible, can you please provide a test that
>>>>> reproduces
>>>>> it, even if on just your FS? And also, can you turn on infoStream on
>>>>> IndexWriter and post the output?
>>>>>
>>>>> If CheckIndex succeeds, then I'd compare the output w/ and w/o
>>>>> CheckIndex.
>>>>>
>>>>> Shai
>>>>>
>>>>> On Fri, Aug 14, 2009 at 12:17 AM, rishisinghal
>>>>> <singhal.rishi@gmail.com>wrote:
>>>>>
>>>>>>
>>>>>> I am running this on OpenVMS V8.2-1 on IA64. For a small number of
>>>>>> files
>>>>>> this
>>>>>> works all fine.
>>>>>>
>>>>>> I checked the resources part and i have enough disk and ram
>>>>>> available.
>>>>>>
>>>>>> Regards,
>>>>>> Rishi
>>>>>>
>>>>>>
>>>>>> Michael McCandless-2 wrote:
>>>>>> >
>>>>>> > It's very odd that CheckIndex has no trouble opening the segment's
>>>>>> > files, yet when you run optimize the OS reports a "file not found"
>>>>>> > exception (errno 5). =C2=A0Something odd is happening at the
>>>>>> OS/filesystem
>>>>>> > level.
>>>>>> >
>>>>>> > What OS are you running on?
>>>>>> >
>>>>>> > Can you boil this down to a smallish standalone test that shows th=
e
>>>>>> > problem?
>>>>>> >
>>>>>> > Mike
>>>>>> >
>>>>>> > On Thu, Aug 13, 2009 at 8:21 AM,
>>>>>> rishisinghal<singhal.rishi@gmail.com>
>>>>>> > wrote:
>>>>>> >>
>>>>>> >> I tried creating the index in different disks but still i see the
>>>>>> issue
>>>>>> >> :-(
>>>>>> >>
>>>>>> >> I tried to index documents in other disks also and got the same
>>>>>> >> exception.
>>>>>> >>
>>>>>> >> I also tried
>>>>>> >> $ java org.apache.lucene.index.CheckIndex
>>>>>> >> /SYS$SYSDEVICE/RISHI/melon_1600/
>>>>>> >> -segment _61
>>>>>> >> NOTE: testing will be more thorough if you run java with
>>>>>> >> '-ea:org.apache.lucene...', so assertions are enabled
>>>>>> >> Opening index @ /SYS$SYSDEVICE/RISHI/melon_1600/
>>>>>> >> Segments file=3Dsegments_1 numSegments=3D0 version=3DFORMAT_HAS_P=
ROX
>>>>>> [Lucene
>>>>>> >> 2.4]
>>>>>> >>
>>>>>> >> Checking only these segments: _61:
>>>>>> >> No problems were detected with this index.
>>>>>> >>
>>>>>> >> Regards,
>>>>>> >> Rishi
>>>>>> >>
>>>>>> >>
>>>>>> >> Shai Erera wrote:
>>>>>> >>>
>>>>>> >>> I noticed the exception is "Caused by:
>>>>>> java.io.FileNotFoundException:
>>>>>> >>> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))"
>>>>>> >>>
>>>>>> >>> I searched for i/o error (errno:5) and found some information
>>>>>> which
>>>>>> >>> associates it w/ a more native IO problem, like corrupt file due
>>>>>> to
>>>>>> >>> system
>>>>>> >>> crash etc.
>>>>>> >>>
>>>>>> >>> Did you experience that? Can you try to create the index
>>>>>> somewhere
>>>>>> else,
>>>>>> >>> or
>>>>>> >>> on another drive?
>>>>>> >>>
>>>>>> >>> Shai
>>>>>> >>>
>>>>>> >>> On Thu, Aug 13, 2009 at 3:00 PM, rishisinghal
>>>>>> >>> <singhal.rishi@gmail.com>wrote:
>>>>>> >>>
>>>>>> >>>>
>>>>>> >>>> It is a local file system.
>>>>>> >>>>
>>>>>> >>>> We are using lucene 2.4 and java 1.5
>>>>>> >>>>
>>>>>> >>>> Regards,
>>>>>> >>>> Rishi
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>> Shai Erera wrote:
>>>>>> >>>> >
>>>>>> >>>> > Is that a local file system, or a network share?
>>>>>> >>>> >
>>>>>> >>>> > On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
>>>>>> >>>> > <singhal.rishi@gmail.com>wrote:
>>>>>> >>>> >
>>>>>> >>>> >>
>>>>>> >>>> >> >>Is there any chance that two writers are open on this
>>>>>> directory?
>>>>>> >>>> >> No, thats not true.
>>>>>> >>>> >>
>>>>>> >>>> >> >>something external to Lucene is removing files from the
>>>>>> directory.
>>>>>> >>>> >> No this also has rare chances as I am the owner of these
>>>>>> files
>>>>>> and
>>>>>> >>>> other
>>>>>> >>>> >> then me no one can delete the, :-)
>>>>>> >>>> >>
>>>>>> >>>> >> Here are all the files in the index directory:
>>>>>> >>>> >> segments.gen;1 =C2=A0 =C2=A0 =C2=A0segments_1.;1 =C2=A0 =C2=
=A0 =C2=A0 segments_2.;1
>>>>>> _0.fdt;1
>>>>>> >>>> >> _0.fdx;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0_37.cfs;1 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _4c.cfs;1
>>>>>> >>>> _61.cfs;1
>>>>>> >>>> >> _9e.cfs;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _ay.cfs;1 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _az.cfs;1
>>>>>> >>>> _b0.cfs;1
>>>>>> >>>> >> _b2.tis;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _b3.fdt;1 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _b4.fdt;1
>>>>>> >>>> >>
>>>>>> >>>> >> I see _37 present.
>>>>>> >>>> >>
>>>>>> >>>> >> Regards,
>>>>>> >>>> >> Rishi
>>>>>> >>>> >>
>>>>>> >>>> >>
>>>>>> >>>> >> Michael McCandless-2 wrote:
>>>>>> >>>> >> >
>>>>>> >>>> >> > Is there any chance that two writers are open on this
>>>>>> directory?
>>>>>> >>>> Or,
>>>>>> >>>> >> > something external to Lucene is removing files from the
>>>>>> directory.
>>>>>> >>>> >> >
>>>>>> >>>> >> > It looks like there were at least two missing files (_37
>>>>>> >>>> >> >
>>>>>> >>>> >> > On Thu, Aug 13, 2009 at 5:19 AM,
>>>>>> >>>> rishisinghal<singhal.rishi@gmail.com
>>>>>> >>>> >
>>>>>> >>>> >> > wrote:
>>>>>> >>>> >> >>
>>>>>> >>>> >> >> Hi,
>>>>>> >>>> >> >>
>>>>>> >>>> >> >> I am trying to index documents and when all is complete
>>>>>> and
>>>>>> >>>> optimize
>>>>>> >>>> >> is
>>>>>> >>>> >> >> called I get
>>>>>> >>>> >> >>
>>>>>> >>>> >> >> IFD [main]: setInfoStream
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionP=
olicy@4fced0
>>>>>> >>>> >> >> IW 0 [main]: setInfoStream:
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>> dir=3Dorg.apache.lucene.store.FSDirectory@
>>>>>> /SYS$SYSDEVICE/RISHI/melon_1600
>>>>>> >>>> >> >> autoCommit=3Dfalse mergePolicy=3Dorg
>>>>>> >>>> >> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
>>>>>> >>>> >> >>
>>>>>> >>>>
>>>>>> mergeScheduler=3Dorg.apache.lucene.index.ConcurrentMergeScheduler@60=
38e4
>>>>>> >>>> >> >> ramBufferS
>>>>>> >>>> >> >> izeMB=3D16.0 maxBufferedDocs=3D5 maxBuffereDeleteTerms=3D=
-1
>>>>>> >>>> >> >> maxFieldLength=3D10000
>>>>>> >>>> >> >> index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485->=
_0
>>>>>> >>>> >> >> =C2=A0_ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>> >>>> >> >> IW 0 [main]: optimize: index now _37:c465->_0 _4c:c165->_=
0
>>>>>> >>>> >> _61:c245->_0
>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>> >>>> >> >> IW 0 [main]: =C2=A0 flush: segment=3Dnull docStoreSegment=
=3Dnull
>>>>>> >>>> >> docStoreOffset=3D0
>>>>>> >>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfa=
lse
>>>>>> numD
>>>>>> >>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>>>>> >>>> >> >> IW 0 [main]: =C2=A0 index before flush _37:c465->_0
>>>>>> _4c:c165->_0
>>>>>> >>>> >> _61:c245->_0
>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>> >>>> >> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0
>>>>>> >>>> _9e:c485->_0
>>>>>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1
>>>>>> pending]
>>>>>> >>>> >> >> IW 0 [main]: CMS: now merge
>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 index: _37:c465->_0 _4c:c165->_0
>>>>>> _61:c245->_0
>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 consider merge _61:c245->_0
>>>>>> _9e:c485->_0
>>>>>> >>>> >> _ay:c225->_0
>>>>>> >>>> >> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 =C2=A0 launch new thread [Lucene=
 Merge
>>>>>> Thread
>>>>>> #73]
>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 no more merges pending; now retu=
rn
>>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: CMS: =C2=A0 merge thread:=
 start
>>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: now merge
>>>>>> >>>> >> >> =C2=A0merge=3D_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az:=
c5->_0
>>>>>> >>>> _b0:c5->_0
>>>>>> >>>> >> into
>>>>>> >>>> >> >> _b5 [optimize]
>>>>>> >>>> >> >> =C2=A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerg=
e@3725db
>>>>>> >>>> >> >> =C2=A0index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:=
c485->_0
>>>>>> >>>> >> _ay:c225->_0
>>>>>> >>>> >> >> _az:c5->_0 _b0:c5->_0
>>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0
>>>>>> _9e:c485->_0
>>>>>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: hit exception during merg=
e
>>>>>> >>>> >> >> Exception in thread "Lucene Merge Thread #73"
>>>>>> >>>> >> >> org.apache.lucene.index.MergePolicy$MergeException:
>>>>>> >>>> >> >> java.io.FileNotFoundException: /SY
>>>>>> >>>> >> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5)=
)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeExceptio=
n(ConcurrentMergeScheduler.java:309)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Con=
currentMergeScheduler.java:286)
>>>>>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>>>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error
>>>>>> (errno:5))
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.op=
en(Native Method)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(F=
SDirectory.java:552)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.=
java:582)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader=
.java:70)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:=
321)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:422=
0)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentM=
ergeScheduler.java:205)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Con=
currentMergeScheduler.java:260)
>>>>>> >>>> >> >> Aug 13, 2009 2:40:56 PM
>>>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP
>>>>>> >>>> >> >> jspMain
>>>>>> >>>> >> >> SEVERE: Indexing not completebackground merge hit
>>>>>> exception:
>>>>>> >>>> >> _61:c245->_0
>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 =
[
>>>>>> >>>> >> >> optimize]
>>>>>> >>>> >> >> java.io.IOException: background merge hit exception:
>>>>>> _61:c245->_0
>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5
>>>>>> >>>> [optimize
>>>>>> >>>> >> >> ]
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>>>>> >>>> >> >> Source)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>>>>>> >>>> Source)
>>>>>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>>>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error
>>>>>> (errno:5))
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.op=
en(Native Method)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(F=
SDirectory.java:552)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.=
java:582)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader=
.java:70)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:=
321)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:422=
0)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentM=
ergeScheduler.java:205)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Con=
currentMergeScheduler.java:260)
>>>>>> >>>> >> >> IW 0 [main]: now flush at close
>>>>>> >>>> >> >> IW 0 [main]: =C2=A0 flush: segment=3Dnull docStoreSegment=
=3Dnull
>>>>>> >>>> >> docStoreOffset=3D0
>>>>>> >>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Dfa=
lse
>>>>>> numD
>>>>>> >>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>>>>> >>>> >> >> IW 0 [main]: =C2=A0 index before flush _37:c465->_0
>>>>>> _4c:c165->_0
>>>>>> >>>> >> _61:c245->_0
>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>> >>>> >> >> IW 0 [main]: CMS: now merge
>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 index: _37:c465->_0 _4c:c165->_0
>>>>>> _61:c245->_0
>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 no more merges pending; now retu=
rn
>>>>>> >>>> >> >> IW 0 [main]: now call final commit()
>>>>>> >>>> >> >> IW 0 [main]: startCommit(): start sizeInBytes=3D0
>>>>>> >>>> >> >> IW 0 [main]: startCommit index=3D_37:c465->_0 _4c:c165->_=
0
>>>>>> >>>> _61:c245->_0
>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>> changeCount=3D11
>>>>>> >>>> >> >> 95
>>>>>> >>>> >> >> IW 0 [main]: now sync _37.cfs
>>>>>> >>>> >> >> IW 0 [main]: hit exception while closing
>>>>>> >>>> >> >> Exception in thread "main" java.io.FileNotFoundException:
>>>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error
>>>>>> (errno:5))
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.op=
en(Native Method)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >>
>>>>>> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:459=
0)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:1=
654)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> >> >>
>>>>>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>>>>> >>>> >> >> Source)
>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>> org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>>>>>> >>>> Source)
>>>>>> >>>> >> >>
>>>>>> >>>> >> >>
>>>>>> >>>> >> >>
>>>>>> >>>> >> >> I have setMaxBufferedDocs =3D 5 and setMergeFactor=3D5. I=
 was
>>>>>> trying
>>>>>> >>>> >> >> different
>>>>>> >>>> >> >> combinations of these to see if that helps but was
>>>>>> unsuccessful.
>>>>>> >>>> >> >>
>>>>>> >>>> >> >>
>>>>>> >>>> >> >> Regards,
>>>>>> >>>> >> >> Rishi
>>>>>> >>>> >> >> --
>>>>>> >>>> >> >> View this message in context:
>>>>>> >>>> >> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-m=
erge%22-tp24951667p24951667.html
>>>>>> >>>> >> >> Sent from the Lucene - Java Users mailing list archive at
>>>>>> >>>> Nabble.com.
>>>>>> >>>> >> >>
>>>>>> >>>> >> >>
>>>>>> >>>> >> >>
>>>>>> >>>>
>>>>>> --------------------------------------------------------------------=
-
>>>>>> >>>> >> >> To unsubscribe, e-mail:
>>>>>> java-user-unsubscribe@lucene.apache.org
>>>>>> >>>> >> >> For additional commands, e-mail:
>>>>>> java-user-help@lucene.apache.org
>>>>>> >>>> >> >>
>>>>>> >>>> >> >>
>>>>>> >>>> >> >
>>>>>> >>>> >> >
>>>>>> >>>>
>>>>>> --------------------------------------------------------------------=
-
>>>>>> >>>> >> > To unsubscribe, e-mail:
>>>>>> java-user-unsubscribe@lucene.apache.org
>>>>>> >>>> >> > For additional commands, e-mail:
>>>>>> java-user-help@lucene.apache.org
>>>>>> >>>> >> >
>>>>>> >>>> >> >
>>>>>> >>>> >> >
>>>>>> >>>> >>
>>>>>> >>>> >> --
>>>>>> >>>> >> View this message in context:
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-m=
erge%22-tp24951667p24952295.html
>>>>>> >>>> >> Sent from the Lucene - Java Users mailing list archive at
>>>>>> >>>> Nabble.com.
>>>>>> >>>> >>
>>>>>> >>>> >>
>>>>>> >>>> >>
>>>>>> >>>>
>>>>>> --------------------------------------------------------------------=
-
>>>>>> >>>> >> To unsubscribe, e-mail:
>>>>>> java-user-unsubscribe@lucene.apache.org
>>>>>> >>>> >> For additional commands, e-mail:
>>>>>> java-user-help@lucene.apache.org
>>>>>> >>>> >>
>>>>>> >>>> >>
>>>>>> >>>> >
>>>>>> >>>> >
>>>>>> >>>>
>>>>>> >>>> --
>>>>>> >>>> View this message in context:
>>>>>> >>>>
>>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-m=
erge%22-tp24951667p24953575.html
>>>>>> >>>> Sent from the Lucene - Java Users mailing list archive at
>>>>>> Nabble.com.
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>>
>>>>>> --------------------------------------------------------------------=
-
>>>>>> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> >>>> For additional commands, e-mail:
>>>>>> java-user-help@lucene.apache.org
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>
>>>>>> >>>
>>>>>> >>
>>>>>> >> --
>>>>>> >> View this message in context:
>>>>>> >>
>>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-m=
erge%22-tp24951667p24953833.html
>>>>>> >> Sent from the Lucene - Java Users mailing list archive at
>>>>>> Nabble.com.
>>>>>> >>
>>>>>> >>
>>>>>> >>
>>>>>> --------------------------------------------------------------------=
-
>>>>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>> >>
>>>>>> >>
>>>>>> >
>>>>>> >
>>>>>> --------------------------------------------------------------------=
-
>>>>>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>> >
>>>>>> >
>>>>>> >
>>>>>>
>>>>>> --
>>>>>> View this message in context:
>>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-m=
erge%22-tp24951667p24958845.html
>>>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com=
.
>>>>>>
>>>>>>
>>>>>> --------------------------------------------------------------------=
-
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>
>>>> --
>>>> View this message in context:
>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-mer=
ge%22-tp24951667p24970274.html
>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merge=
%22-tp24951667p24970750.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Indexer-crashes-with-%2=
2hit-exception-during-merge%22-tp24951667p24971223.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41895-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 18:48:11 2009
Return-Path: <java-user-return-41895-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5603 invoked from network); 14 Aug 2009 18:48:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 18:48:10 -0000
Received: (qmail 87780 invoked by uid 500); 14 Aug 2009 18:48:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87696 invoked by uid 500); 14 Aug 2009 18:48:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87686 invoked by uid 99); 14 Aug 2009 18:48:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 18:48:15 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nazario.lucas@gmail.com designates 209.85.222.186 as permitted sender)
Received: from [209.85.222.186] (HELO mail-pz0-f186.google.com) (209.85.222.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 18:48:07 +0000
Received: by pzk16 with SMTP id 16so1157040pzk.20
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 11:47:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=qSRUAgcx0VBzGb4YrIRvjzrYseQUrmfChtWyDEfNjLw=;
        b=GaYfRHEodSTCSZLsdinCeYey2yxhFTLW/yx3PPXUp/zBnVNg51+rCD957Gmti2rD6R
         GKmIbMqA96MGYj7sEubZTZwE3tutKj3kkHUjeLhPceChBhWKXeCxXJ6O79HvjlkTC1So
         jQRzAKwgloiox1N8+KRr5kMX6VTjkSjBkOsfc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=P9JWYh2ZI8KucWFVvKmbg22XRW1k/A341PVIglKd3fzRW230P6EOAo4GKqNOghmlVw
         BLvcobpM+zcbQi5LBn2cJb4OXeDx7BJDjzx00k8MC/Twg+2TtrI/SH7BAy9gXbUrYCEp
         bysI6ThCeSR5+9VygzgH5AGpCFgsqQ16YsTQM=
MIME-Version: 1.0
Received: by 10.115.88.19 with SMTP id q19mr2045000wal.81.1250275666381; Fri, 
	14 Aug 2009 11:47:46 -0700 (PDT)
Date: Fri, 14 Aug 2009 15:47:46 -0300
Message-ID: <3ca1516d0908141147i1baf7af2yf15bcf69d4af77dc@mail.gmail.com>
Subject: Problem doing backup using the SnapshotDeletionPolicy class
From: =?ISO-8859-1?Q?Lucas_Naz=E1rio_dos_Santos?= <nazario.lucas@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163646c116f7631004711e7c7b
X-Virus-Checked: Checked by ClamAV on apache.org

--00163646c116f7631004711e7c7b
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

I'm using the SnapshotDeletionPolicy class to backup my index. I basically
call the snapshot() method from the class SnapshotDeletionPolicy at some
point, get a list of files that changed, copy then to the backup folder, and
finish by calling the release() method.

The problem arises when, in between backups, I optimize the index by opening
it with the IndexWriter class and calling the optimize() method. When I
don't optimize in between backups, here is what happens:

The first backup copies the segment composed by the files _0.cfs and
segments_2. The second backup copies the files _1.cfs and segments_3, and
the third backup copies the files _2.cfs e segments_4. I can open the backup
folder with Luke without problems.

When I do optimize in between backups, the copies are as follow:

The first backup copies the segment composed by the files _0.cfs and
segments_2. The second backup copies the files _1.cfs and segments_3, and
the third backup copies the files _3.cfs e segments_5. In this case, when I
try to open the backup folder, Luke gives a message saying that it can't
find the file _2.cfs.

My question is: how can I backup my index using the SnapshotDeletionPolicy
and having to optimize the index in between backups? Am I using the right
backup strategy?

Thanks,
Lucas

--00163646c116f7631004711e7c7b--

From java-user-return-41896-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 19:03:13 2009
Return-Path: <java-user-return-41896-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8984 invoked from network); 14 Aug 2009 19:03:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 19:03:13 -0000
Received: (qmail 7264 invoked by uid 500); 14 Aug 2009 19:03:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7183 invoked by uid 500); 14 Aug 2009 19:03:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7173 invoked by uid 99); 14 Aug 2009 19:03:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 19:03:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 19:03:08 +0000
Received: by yxe3 with SMTP id 3so2323213yxe.29
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 12:02:46 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.235.19 with SMTP id i19mr2850100ybh.191.1250276566428; 
	Fri, 14 Aug 2009 12:02:46 -0700 (PDT)
In-Reply-To: <3ca1516d0908141147i1baf7af2yf15bcf69d4af77dc@mail.gmail.com>
References: <3ca1516d0908141147i1baf7af2yf15bcf69d4af77dc@mail.gmail.com>
Date: Fri, 14 Aug 2009 15:02:46 -0400
Message-ID: <9ac0c6aa0908141202v677039a3g863e83022675220e@mail.gmail.com>
Subject: Re: Problem doing backup using the SnapshotDeletionPolicy class
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Could you boil this down to a small standalone program showing the problem?

Optimizing in between backups should be completely fine.

Mike

On Fri, Aug 14, 2009 at 2:47 PM, Lucas Naz=E1rio dos
Santos<nazario.lucas@gmail.com> wrote:
> Hi,
>
> I'm using the SnapshotDeletionPolicy class to backup my index. I basicall=
y
> call the snapshot() method from the class SnapshotDeletionPolicy at some
> point, get a list of files that changed, copy then to the backup folder, =
and
> finish by calling the release() method.
>
> The problem arises when, in between backups, I optimize the index by open=
ing
> it with the IndexWriter class and calling the optimize() method. When I
> don't optimize in between backups, here is what happens:
>
> The first backup copies the segment composed by the files _0.cfs and
> segments_2. The second backup copies the files _1.cfs and segments_3, and
> the third backup copies the files _2.cfs e segments_4. I can open the bac=
kup
> folder with Luke without problems.
>
> When I do optimize in between backups, the copies are as follow:
>
> The first backup copies the segment composed by the files _0.cfs and
> segments_2. The second backup copies the files _1.cfs and segments_3, and
> the third backup copies the files _3.cfs e segments_5. In this case, when=
 I
> try to open the backup folder, Luke gives a message saying that it can't
> find the file _2.cfs.
>
> My question is: how can I backup my index using the SnapshotDeletionPolic=
y
> and having to optimize the index in between backups? Am I using the right
> backup strategy?
>
> Thanks,
> Lucas
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41897-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 19:38:15 2009
Return-Path: <java-user-return-41897-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19109 invoked from network); 14 Aug 2009 19:38:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 19:38:14 -0000
Received: (qmail 53511 invoked by uid 500); 14 Aug 2009 19:38:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53408 invoked by uid 500); 14 Aug 2009 19:38:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53393 invoked by uid 99); 14 Aug 2009 19:38:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 19:38:19 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 19:38:11 +0000
Received: by ewy26 with SMTP id 26so1810085ewy.5
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 12:37:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=7YE+HfDKVp6W0ZAwcK5MfasO4wj3+3c2fy1STFc4FmI=;
        b=vQZx+4PLJ36aM71ARfZraEOh74KYtal9WgZi3phHrJu9NUT0nhdYTRIoMsjy34y1Vc
         eZhaoltsf1tyhsWaJxG2JCCZdGWrccn4eIyS9+cG4CyxbNmBh1cEALH1Q7c49EvKrg9V
         gMIWx8BDl+0sHaJUDktPjaoom5h0n11yfJ0WA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=TNI33LRnOOg0/PB3X5okSODR/ONzdFyMTo52SfUCmeUD+wmV3Kz0ih8jjooTcYUfmE
         IOQAGJre6+9XgSNJkpb2FaboEgdNl7Q0fxUVJoYyef0Uk4pDC4+5fzwhrARK0ysm4PHU
         EnH1pZwV95vgg0AlZDaL2O3xCeSzzKpqhBY6Q=
MIME-Version: 1.0
Received: by 10.216.12.67 with SMTP id 45mr481096wey.218.1250278667819; Fri, 
	14 Aug 2009 12:37:47 -0700 (PDT)
In-Reply-To: <9ac0c6aa0908141202v677039a3g863e83022675220e@mail.gmail.com>
References: <3ca1516d0908141147i1baf7af2yf15bcf69d4af77dc@mail.gmail.com>
	 <9ac0c6aa0908141202v677039a3g863e83022675220e@mail.gmail.com>
Date: Fri, 14 Aug 2009 22:37:47 +0300
Message-ID: <786fde50908141237l590c017ej7ff1e2d68929622c@mail.gmail.com>
Subject: Re: Problem doing backup using the SnapshotDeletionPolicy class
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364d1d55dd9b0d04711f2f63
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364d1d55dd9b0d04711f2f63
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

I think you should also delete files that don't exist anymore in the index,
from the backup?

Shai

On Fri, Aug 14, 2009 at 10:02 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> Could you boil this down to a small standalone program showing the proble=
m?
>
> Optimizing in between backups should be completely fine.
>
> Mike
>
> On Fri, Aug 14, 2009 at 2:47 PM, Lucas Naz=E1rio dos
> Santos<nazario.lucas@gmail.com> wrote:
> > Hi,
> >
> > I'm using the SnapshotDeletionPolicy class to backup my index. I
> basically
> > call the snapshot() method from the class SnapshotDeletionPolicy at som=
e
> > point, get a list of files that changed, copy then to the backup folder=
,
> and
> > finish by calling the release() method.
> >
> > The problem arises when, in between backups, I optimize the index by
> opening
> > it with the IndexWriter class and calling the optimize() method. When I
> > don't optimize in between backups, here is what happens:
> >
> > The first backup copies the segment composed by the files _0.cfs and
> > segments_2. The second backup copies the files _1.cfs and segments_3, a=
nd
> > the third backup copies the files _2.cfs e segments_4. I can open the
> backup
> > folder with Luke without problems.
> >
> > When I do optimize in between backups, the copies are as follow:
> >
> > The first backup copies the segment composed by the files _0.cfs and
> > segments_2. The second backup copies the files _1.cfs and segments_3, a=
nd
> > the third backup copies the files _3.cfs e segments_5. In this case, wh=
en
> I
> > try to open the backup folder, Luke gives a message saying that it can'=
t
> > find the file _2.cfs.
> >
> > My question is: how can I backup my index using the
> SnapshotDeletionPolicy
> > and having to optimize the index in between backups? Am I using the rig=
ht
> > backup strategy?
> >
> > Thanks,
> > Lucas
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016364d1d55dd9b0d04711f2f63--

From java-user-return-41898-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 20:56:14 2009
Return-Path: <java-user-return-41898-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47073 invoked from network); 14 Aug 2009 20:56:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 20:56:14 -0000
Received: (qmail 43484 invoked by uid 500); 14 Aug 2009 20:56:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43444 invoked by uid 500); 14 Aug 2009 20:56:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43434 invoked by uid 99); 14 Aug 2009 20:56:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 20:56:18 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nazario.lucas@gmail.com designates 209.85.146.182 as permitted sender)
Received: from [209.85.146.182] (HELO wa-out-1112.google.com) (209.85.146.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 20:56:10 +0000
Received: by wa-out-1112.google.com with SMTP id v27so229894wah.5
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 13:55:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=fvxYbrARzk+E0avqpFundj0nMfmB3ATBtzu5vC2pWz4=;
        b=l5VWFJMYmNR8mhCih8zgOikQuySAf7Fl6zBi4/7+q94KhvuDsbTScrs22iRIi7+8s+
         t1L5yGESDtK3qoV8AR/KbUfcAZbVvpS7nTebaajZ54PCpnQH/ibw9Y+iz7z+oWpMXVIx
         WeZ9TWJ0sEeihH46thXFw0nAzkBuNPJGc3ziQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=jS3Ys66L2jCdguVAhOGpZ7IMi4qnsy4cQj+53RyXhssmOhrQj9gZriB5L8NfAW84B7
         SO7caMKvyh/Fs5JHRdwU4SE3wQmYfEFBHyB0GqzMY5kJ8mbqcwa0cU3qe1ShTyKLsyTZ
         CsAlle5sjAJtx5pgKaItpsHSbN3I0pPJ0PH4Q=
MIME-Version: 1.0
Received: by 10.115.88.19 with SMTP id q19mr2129175wal.81.1250283349946; Fri, 
	14 Aug 2009 13:55:49 -0700 (PDT)
In-Reply-To: <786fde50908141237l590c017ej7ff1e2d68929622c@mail.gmail.com>
References: <3ca1516d0908141147i1baf7af2yf15bcf69d4af77dc@mail.gmail.com>
	 <9ac0c6aa0908141202v677039a3g863e83022675220e@mail.gmail.com>
	 <786fde50908141237l590c017ej7ff1e2d68929622c@mail.gmail.com>
Date: Fri, 14 Aug 2009 17:55:49 -0300
Message-ID: <3ca1516d0908141355u65b5027rc4892f5c54f16b79@mail.gmail.com>
Subject: Re: Problem doing backup using the SnapshotDeletionPolicy class
From: =?ISO-8859-1?Q?Lucas_Naz=E1rio_dos_Santos?= <nazario.lucas@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163646c116f1330b047120461e
X-Virus-Checked: Checked by ClamAV on apache.org

--00163646c116f1330b047120461e
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Not as small as I would like, but shows the problem.

If you remove the statement

// Remove this and the backup works fine
optimize(policy);

the backup works wonderfully.

(More code in the next e-mail)

Lucas


        public static void main(final String[] args) throws
CorruptIndexException, IOException, InterruptedException {
                final SnapshotDeletionPolicy policy =3D new
SnapshotDeletionPolicy(new KeepOnlyLastCommitDeletionPolicy());
                final IndexBackup backup =3D new IndexBackup(policy, new
File("backup"));
                for (int i =3D 0; i < 3; i++) {
                        index(policy, backup);
                }
        }

        private static void index(final SnapshotDeletionPolicy policy, fina=
l
IndexBackup backup) throws CorruptIndexException,
                        LockObtainFailedException, IOException {
                IndexWriter writer =3D null;
                try {
                        FSDirectory.setDisableLocks(true);
                        writer =3D new
IndexWriter(FSDirectory.getDirectory("index"), new StandardAnalyzer(),
policy,
                                        MaxFieldLength.UNLIMITED);

                        System.out.println("Star: " +
backup.willBackupFromNowOn());

                        for (int i =3D 0; i < 10000; i++) {
                                final Document document =3D new Document();
                                document.add(new Field("content", "content
content content content", Store.YES, Index.ANALYZED));
                                writer.addDocument(document);
                        }
                } finally {
                        if (writer !=3D null) {
                                writer.close();
                        }

                        System.out.println("Backup: " + backup.backup());

                        // Remove this and the backup works fine
                        optimize(policy);
                }
        }

        private static void optimize(final SnapshotDeletionPolicy policy)
throws CorruptIndexException, LockObtainFailedException,
                        IOException {

                IndexWriter writer =3D null;
                try {
                        writer =3D new
IndexWriter(FSDirectory.getDirectory("index"), new StandardAnalyzer(),
policy,
                                        MaxFieldLength.UNLIMITED);
                        writer.optimize();
                } finally {
                        writer.close();
                }
        }


On Fri, Aug 14, 2009 at 4:37 PM, Shai Erera <serera@gmail.com> wrote:

> I think you should also delete files that don't exist anymore in the inde=
x,
> from the backup?
>
> Shai
>
> On Fri, Aug 14, 2009 at 10:02 PM, Michael McCandless <
> lucene@mikemccandless.com> wrote:
>
> > Could you boil this down to a small standalone program showing the
> problem?
> >
> > Optimizing in between backups should be completely fine.
> >
> > Mike
> >
> > On Fri, Aug 14, 2009 at 2:47 PM, Lucas Naz=E1rio dos
> > Santos<nazario.lucas@gmail.com> wrote:
> > > Hi,
> > >
> > > I'm using the SnapshotDeletionPolicy class to backup my index. I
> > basically
> > > call the snapshot() method from the class SnapshotDeletionPolicy at
> some
> > > point, get a list of files that changed, copy then to the backup
> folder,
> > and
> > > finish by calling the release() method.
> > >
> > > The problem arises when, in between backups, I optimize the index by
> > opening
> > > it with the IndexWriter class and calling the optimize() method. When=
 I
> > > don't optimize in between backups, here is what happens:
> > >
> > > The first backup copies the segment composed by the files _0.cfs and
> > > segments_2. The second backup copies the files _1.cfs and segments_3,
> and
> > > the third backup copies the files _2.cfs e segments_4. I can open the
> > backup
> > > folder with Luke without problems.
> > >
> > > When I do optimize in between backups, the copies are as follow:
> > >
> > > The first backup copies the segment composed by the files _0.cfs and
> > > segments_2. The second backup copies the files _1.cfs and segments_3,
> and
> > > the third backup copies the files _3.cfs e segments_5. In this case,
> when
> > I
> > > try to open the backup folder, Luke gives a message saying that it
> can't
> > > find the file _2.cfs.
> > >
> > > My question is: how can I backup my index using the
> > SnapshotDeletionPolicy
> > > and having to optimize the index in between backups? Am I using the
> right
> > > backup strategy?
> > >
> > > Thanks,
> > > Lucas
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--00163646c116f1330b047120461e--

From java-user-return-41899-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 21:03:06 2009
Return-Path: <java-user-return-41899-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49211 invoked from network); 14 Aug 2009 21:03:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 21:03:06 -0000
Received: (qmail 49175 invoked by uid 500); 14 Aug 2009 21:03:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49124 invoked by uid 500); 14 Aug 2009 21:03:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49087 invoked by uid 99); 14 Aug 2009 21:03:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 21:03:10 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of nazario.lucas@gmail.com designates 209.85.216.204 as permitted sender)
Received: from [209.85.216.204] (HELO mail-px0-f204.google.com) (209.85.216.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 21:03:00 +0000
Received: by pxi42 with SMTP id 42so453594pxi.20
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 14:02:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=65r5G9YXks4NVYRBvXilCBG2dIthyDhZzzc2C2Lniw4=;
        b=FST/2m9/utBVJkrxwMgmWB+KBmk04BRLyneUA736wVDb7Zdd48rSrLthXDAsFDyivz
         WPLz653lCeLU/zzbf6XMDI+F4Tm42/viIfdK1v9yXpMXaeee6Ch79eEQClyML93dFkPE
         jHi2q0NFH0diNfan2sJHMqz49DtcfMOifQ8Dw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=VhLYVJRu5wIomhEE3rP9pU8lbj2i596lFVVTDGE9W6A/TUkUN+a7tHVrW1hb9/Eq98
         QrIsr6VFnoma6Nuz8Y80uEeojAUWHZIVJyEpzUWr4t8LIeq4l+eqZu5iBy/INWLD0gaG
         IlIEzaX/8KU4/Cg2NxS0QdEACh5G84JDpce2g=
MIME-Version: 1.0
Received: by 10.115.93.15 with SMTP id v15mr815511wal.184.1250283759204; Fri, 
	14 Aug 2009 14:02:39 -0700 (PDT)
In-Reply-To: <3ca1516d0908141355u65b5027rc4892f5c54f16b79@mail.gmail.com>
References: <3ca1516d0908141147i1baf7af2yf15bcf69d4af77dc@mail.gmail.com>
	 <9ac0c6aa0908141202v677039a3g863e83022675220e@mail.gmail.com>
	 <786fde50908141237l590c017ej7ff1e2d68929622c@mail.gmail.com>
	 <3ca1516d0908141355u65b5027rc4892f5c54f16b79@mail.gmail.com>
Date: Fri, 14 Aug 2009 18:02:39 -0300
Message-ID: <3ca1516d0908141402w6df4fe0cp348963b40cb866a2@mail.gmail.com>
Subject: Re: Problem doing backup using the SnapshotDeletionPolicy class
From: =?ISO-8859-1?Q?Lucas_Naz=E1rio_dos_Santos?= <nazario.lucas@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364c58d755fad00471205fd0
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364c58d755fad00471205fd0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

    public static class IndexBackup {
    private SnapshotDeletionPolicy snapshotDeletionPolicy;
    private File backupFolder;
    private IndexCommit indexCommit;

    public IndexBackup(final SnapshotDeletionPolicy snapshotDeletionPolicy,
        final File backupFolder) {
        this.snapshotDeletionPolicy = snapshotDeletionPolicy;
        this.backupFolder = backupFolder;
    }

    public boolean willBackupFromNowOn() {
        try {
        this.indexCommit = (IndexCommit) this.snapshotDeletionPolicy
            .snapshot();
        return indexCommit != null;
        } catch (final Exception e) {
        return false;
        }
    }

    public boolean backup() throws IOException {
        if (this.indexCommit == null)
        return false;
        try {
        final File indexFolder = ((FSDirectory) this.indexCommit
            .getDirectory()).getFile();
        final String[] filesToBackup = indexFolder
            .list(new FilterFilesToBackup(
                IndexBackup.this.indexCommit.getFileNames()));
        for (String fileToBackup : filesToBackup) {
            FileUtils.copyFileToDirectory(new File(indexFolder,
                fileToBackup), this.backupFolder, true);
        }
        return true;
        } finally {
        this.snapshotDeletionPolicy.release();
        }
    }

    private class FilterFilesToBackup implements FilenameFilter {
        private Collection filesToNotBackup;

        private FilterFilesToBackup(final Collection filesToNotBackup) {
        this.filesToNotBackup = filesToNotBackup;
        }

        public boolean accept(final File dir, final String name) {
        if (name.equals("segments.gen") || name.equals("write.lock"))
            return false;
        else
            return !this.filesToNotBackup.contains(name);
        }
    }
    }

--0016364c58d755fad00471205fd0--

From java-user-return-41900-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 14 23:06:24 2009
Return-Path: <java-user-return-41900-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98233 invoked from network); 14 Aug 2009 23:06:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Aug 2009 23:06:24 -0000
Received: (qmail 94905 invoked by uid 500); 14 Aug 2009 23:06:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94823 invoked by uid 500); 14 Aug 2009 23:06:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94813 invoked by uid 99); 14 Aug 2009 23:06:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 23:06:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Aug 2009 23:06:18 +0000
Received: by yxe3 with SMTP id 3so2495947yxe.29
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 16:05:57 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.140.9 with SMTP id n9mr1232427ybd.61.1250291156961; Fri, 
	14 Aug 2009 16:05:56 -0700 (PDT)
In-Reply-To: <3ca1516d0908141355u65b5027rc4892f5c54f16b79@mail.gmail.com>
References: <3ca1516d0908141147i1baf7af2yf15bcf69d4af77dc@mail.gmail.com>
	 <9ac0c6aa0908141202v677039a3g863e83022675220e@mail.gmail.com>
	 <786fde50908141237l590c017ej7ff1e2d68929622c@mail.gmail.com>
	 <3ca1516d0908141355u65b5027rc4892f5c54f16b79@mail.gmail.com>
Date: Fri, 14 Aug 2009 19:05:56 -0400
Message-ID: <9ac0c6aa0908141605v72fbc559qb41a9576f0cc64d7@mail.gmail.com>
Subject: Re: Problem doing backup using the SnapshotDeletionPolicy class
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Alas I don't see it failing, with the optimize left in.  Which exact
rev of 2.9 are you testing with?  Which OS/filesystem/JRE?

I realize this is just a test so what follows may not apply to your
"real" usage of SnapshotDeletionPolicy...:

Since you're closing the writer before taking the backup, there's no
need to even use SnapshotDeletionPolicy (you can just copy all files
you find in the index).

SnapshotDeletionPolicy's purpose is to enable taking backups while an
IndexWriter is still open & making ongoing changes to the index, ie a
"hot backup".

Finally, you're taking the snapshot before doing any indexing... which
means your backup will only reflect the index as of the last commit
before you did indexing.

Mike

On Fri, Aug 14, 2009 at 4:55 PM, Lucas Naz=E1rio dos
Santos<nazario.lucas@gmail.com> wrote:
> Not as small as I would like, but shows the problem.
>
> If you remove the statement
>
> // Remove this and the backup works fine
> optimize(policy);
>
> the backup works wonderfully.
>
> (More code in the next e-mail)
>
> Lucas
>
>
> =A0 =A0 =A0 =A0public static void main(final String[] args) throws
> CorruptIndexException, IOException, InterruptedException {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0final SnapshotDeletionPolicy policy =3D ne=
w
> SnapshotDeletionPolicy(new KeepOnlyLastCommitDeletionPolicy());
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0final IndexBackup backup =3D new IndexBack=
up(policy, new
> File("backup"));
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0for (int i =3D 0; i < 3; i++) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0index(policy, backup);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0private static void index(final SnapshotDeletionPolicy pol=
icy, final
> IndexBackup backup) throws CorruptIndexException,
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0LockObtainFailedException,=
 IOException {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexWriter writer =3D null;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0FSDirectory.setDisableLock=
s(true);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0writer =3D new
> IndexWriter(FSDirectory.getDirectory("index"), new StandardAnalyzer(),
> policy,
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0MaxFieldLength.UNLIMITED);
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Star: =
" +
> backup.willBackupFromNowOn());
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0for (int i =3D 0; i < 1000=
0; i++) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0final Docu=
ment document =3D new Document();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0document.a=
dd(new Field("content", "content
> content content content", Store.YES, Index.ANALYZED));
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0writer.add=
Document(document);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} finally {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (writer !=3D null) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0writer.clo=
se();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("Backup=
: " + backup.backup());
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0// Remove this and the bac=
kup works fine
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0optimize(policy);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0private static void optimize(final SnapshotDeletionPolicy =
policy)
> throws CorruptIndexException, LockObtainFailedException,
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IOException {
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexWriter writer =3D null;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0writer =3D new
> IndexWriter(FSDirectory.getDirectory("index"), new StandardAnalyzer(),
> policy,
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0MaxFieldLength.UNLIMITED);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0writer.optimize();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} finally {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0writer.close();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
>
>
> On Fri, Aug 14, 2009 at 4:37 PM, Shai Erera <serera@gmail.com> wrote:
>
>> I think you should also delete files that don't exist anymore in the ind=
ex,
>> from the backup?
>>
>> Shai
>>
>> On Fri, Aug 14, 2009 at 10:02 PM, Michael McCandless <
>> lucene@mikemccandless.com> wrote:
>>
>> > Could you boil this down to a small standalone program showing the
>> problem?
>> >
>> > Optimizing in between backups should be completely fine.
>> >
>> > Mike
>> >
>> > On Fri, Aug 14, 2009 at 2:47 PM, Lucas Naz=E1rio dos
>> > Santos<nazario.lucas@gmail.com> wrote:
>> > > Hi,
>> > >
>> > > I'm using the SnapshotDeletionPolicy class to backup my index. I
>> > basically
>> > > call the snapshot() method from the class SnapshotDeletionPolicy at
>> some
>> > > point, get a list of files that changed, copy then to the backup
>> folder,
>> > and
>> > > finish by calling the release() method.
>> > >
>> > > The problem arises when, in between backups, I optimize the index by
>> > opening
>> > > it with the IndexWriter class and calling the optimize() method. Whe=
n I
>> > > don't optimize in between backups, here is what happens:
>> > >
>> > > The first backup copies the segment composed by the files _0.cfs and
>> > > segments_2. The second backup copies the files _1.cfs and segments_3=
,
>> and
>> > > the third backup copies the files _2.cfs e segments_4. I can open th=
e
>> > backup
>> > > folder with Luke without problems.
>> > >
>> > > When I do optimize in between backups, the copies are as follow:
>> > >
>> > > The first backup copies the segment composed by the files _0.cfs and
>> > > segments_2. The second backup copies the files _1.cfs and segments_3=
,
>> and
>> > > the third backup copies the files _3.cfs e segments_5. In this case,
>> when
>> > I
>> > > try to open the backup folder, Luke gives a message saying that it
>> can't
>> > > find the file _2.cfs.
>> > >
>> > > My question is: how can I backup my index using the
>> > SnapshotDeletionPolicy
>> > > and having to optimize the index in between backups? Am I using the
>> right
>> > > backup strategy?
>> > >
>> > > Thanks,
>> > > Lucas
>> > >
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41901-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 15 05:03:47 2009
Return-Path: <java-user-return-41901-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83857 invoked from network); 15 Aug 2009 05:03:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Aug 2009 05:03:47 -0000
Received: (qmail 8831 invoked by uid 500); 15 Aug 2009 05:03:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8735 invoked by uid 500); 15 Aug 2009 05:03:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8724 invoked by uid 99); 15 Aug 2009 05:03:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Aug 2009 05:03:51 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bryan.j.swift@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Aug 2009 05:03:41 +0000
Received: by ywh26 with SMTP id 26so2594832ywh.5
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 22:03:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=x/Pt4XLabde5Ejj27cYnpdb2P6m619EvMadIdwqkGNI=;
        b=U0nqhsBCMEKipvt0OIo4viSfP3x1KwOkw5RTP7+aU5IxwEC00o16QBS4luoX+iqWL2
         QpDLIcjKux7jRZ5b75LHPzJxrPXT0tw9SAHH3tXVGCuGpgg02CCy2IZvPP7GZ6F5ug2U
         GdO8VpqcnVNelLaYWvErYlgVcfv6zxuqs0WYg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=wuxuJ6zFTvhegoHDBI/2O9BF5cJ/y2B+csinS/EXwBeLWnc6qO9g3WdUyP/i9RX0ag
         0318dnjpv/E7kMQyr9j5z086vWcggrZkFm+JZx7cNbCruqfImty2QCGlV/xxW6sNvaiK
         IhUMHzKSntxJ4O6Wrao4bUkf4JtI8VetVVK5c=
MIME-Version: 1.0
Received: by 10.100.154.17 with SMTP id b17mr119258ane.103.1250312600810; Fri, 
	14 Aug 2009 22:03:20 -0700 (PDT)
Date: Sat, 15 Aug 2009 01:03:20 -0400
Message-ID: <182726e80908142203g464f667ek645d9c9cbe2ef00c@mail.gmail.com>
Subject: Bytes seem the same but checksums differ
From: Bryan Swift <bryan.j.swift@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e642d3766df59c04712716ea
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e642d3766df59c04712716ea
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

I'm attempting to create a Directory implementation (lucene-core 2.4.1) to
sit on top of Google's App Engine Datastore (written in Scala). In the
process of doing this I found something odd for which I'm hoping there is a
relatively simple solution.
When instantiating a new IndexWriter with my Directory implementation (which
uses Datastore based IndexInput and IndexOutput classes) the checksum of the
segments file (segments_1 because there is nothing in the index yet) varies
when calculated by ChecksumIndexOutput vs ChecksumIndexInput. Of course,
this causes a CorruptIndexException to be thrown at line 248. The
interesting thing is the array of bytes being written by my
DatastoreIndexOutput is the same array of bytes being ready by
DatastoreIndexInput. I've also noticed the difference between the checksums
is consistently that checksumThen (line 246 in SegmentInfos) is one less
than checksumNow (line 245 in SegmentInfos).

In an attempt to gain further information about this problem I added CRC32
objects to my IndexInput and IndexOutput definitions to in order to peak in
on their values while debugging and it seems the IndexInput and IndexOutput
classes I defined have the same checksum after reading and writing all the
bits.

The source for my implementation to this point can be found at
http://github.com/bryanjswift/quotidian/tree/search-checksums under
src/main/scala/quotidian/search

Any insight or assistance would be very much appreciated at this point.

Cheers.
Bryan

--0016e642d3766df59c04712716ea--

From java-user-return-41902-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 15 05:18:13 2009
Return-Path: <java-user-return-41902-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27072 invoked from network); 15 Aug 2009 05:18:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Aug 2009 05:18:13 -0000
Received: (qmail 19304 invoked by uid 500); 15 Aug 2009 05:18:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19218 invoked by uid 500); 15 Aug 2009 05:18:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19208 invoked by uid 99); 15 Aug 2009 05:18:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Aug 2009 05:18:17 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of bryan.j.swift@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Aug 2009 05:18:05 +0000
Received: by ywh26 with SMTP id 26so2599313ywh.5
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 22:17:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=uUG7OabYC61il6rP33vQxdUjUGJghoWX2UJxAj9b9jU=;
        b=acmX+06aOOMD5tAG2lYrME+S3j0qa4K0AZwaaadaVq6wbbuvitdILEfICtSR8CkkV4
         Q7zgtgwq7dtPHsgkcU0MLGfEuLzi9V1mbEYqFVg+4erJrhV6cCBtE5JruxNZEZW+tCdE
         JEvI/EanFaL0ZqjUvyy3VaZt2kcmZdbCFKa44=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Rso/wAY6wsdkovPOrgyoXYmPrj+booY5B5+qrd3y9VTjiHgHtpo7OFmm8nSp1h50lz
         q4YBSAESyDS6r50kP0nb702eoIW18HOvL8fA4UU+xmy9JBJDfY6zYK5nTKjZ9BWIInrx
         8vDadtw3X+WpYSK3H0TxOzfIcLSu1kvQcMpg8=
MIME-Version: 1.0
Received: by 10.100.34.10 with SMTP id h10mr2183205anh.182.1250313464063; Fri, 
	14 Aug 2009 22:17:44 -0700 (PDT)
In-Reply-To: <182726e80908142203g464f667ek645d9c9cbe2ef00c@mail.gmail.com>
References: <182726e80908142203g464f667ek645d9c9cbe2ef00c@mail.gmail.com>
Date: Sat, 15 Aug 2009 01:17:44 -0400
Message-ID: <182726e80908142217q20334066we50ecce7e554262b@mail.gmail.com>
Subject: Re: Bytes seem the same but checksums differ
From: Bryan Swift <bryan.j.swift@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f33b3ee226b70471274952
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f33b3ee226b70471274952
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

Right, so after looking at what was happening in SegmentInfos again I
noticed I was saving to the Datastore on IndexOutput.flush but not on close.
Persisting the file on close solved this particular problem.
Sorry about that.

On Sat, Aug 15, 2009 at 1:03 AM, Bryan Swift <bryan.j.swift@gmail.com>wrote:

> I'm attempting to create a Directory implementation (lucene-core 2.4.1) to
> sit on top of Google's App Engine Datastore (written in Scala). In the
> process of doing this I found something odd for which I'm hoping there is a
> relatively simple solution.
> When instantiating a new IndexWriter with my Directory implementation
> (which uses Datastore based IndexInput and IndexOutput classes) the checksum
> of the segments file (segments_1 because there is nothing in the index yet)
> varies when calculated by ChecksumIndexOutput vs ChecksumIndexInput. Of
> course, this causes a CorruptIndexException to be thrown at line 248. The
> interesting thing is the array of bytes being written by my
> DatastoreIndexOutput is the same array of bytes being ready by
> DatastoreIndexInput. I've also noticed the difference between the checksums
> is consistently that checksumThen (line 246 in SegmentInfos) is one less
> than checksumNow (line 245 in SegmentInfos).
>
> In an attempt to gain further information about this problem I added CRC32
> objects to my IndexInput and IndexOutput definitions to in order to peak in
> on their values while debugging and it seems the IndexInput and IndexOutput
> classes I defined have the same checksum after reading and writing all the
> bits.
>
> The source for my implementation to this point can be found at
> http://github.com/bryanjswift/quotidian/tree/search-checksums under
> src/main/scala/quotidian/search
>
> Any insight or assistance would be very much appreciated at this point.
>
> Cheers.
> Bryan
>

--001485f33b3ee226b70471274952--

From java-user-return-41903-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 15 06:16:18 2009
Return-Path: <java-user-return-41903-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60418 invoked from network); 15 Aug 2009 06:16:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Aug 2009 06:16:18 -0000
Received: (qmail 41160 invoked by uid 500); 15 Aug 2009 06:16:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41061 invoked by uid 500); 15 Aug 2009 06:16:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41051 invoked by uid 99); 15 Aug 2009 06:16:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Aug 2009 06:16:22 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Aug 2009 06:16:14 +0000
Received: by ewy26 with SMTP id 26so2018566ewy.5
        for <java-user@lucene.apache.org>; Fri, 14 Aug 2009 23:15:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=t18PaAS0xq1PNbcwTGZqiJmib7za/46Ba9Bx1N2ixjM=;
        b=LGq3t73RwwazK7coL6K/LKXpPU1K56EKkQcT8p16/nUPg+FjXNQwV4+YXqqnEGLIeC
         HZn43yqGAS7ITNvjyM2k65SQaveQURCIAefnDVkzmq9Xvw4wkL25rbFiMZKbU2/FXXW9
         qwiaMCEnTFWU/UZlk5ZO8mIQxEXBNVoPMYQ08=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=s575w0/M3/WaIxlqbHf8l2D4E478an0uYMNOc5ZZXOmPG2Tk5oSpMnCUt/iH8mkHZe
         J/Fryxqy1FX7m5UR3a2nj43R9Myh5SXvD2m7DM1RA8/hscovV8Fh9NZKcXYqH9xSYNAs
         4s+0GGoPzwMmv+nHiKvMtERvMmkUP1eY7d/M4=
MIME-Version: 1.0
Received: by 10.216.85.2 with SMTP id t2mr583848wee.81.1250316953562; Fri, 14 
	Aug 2009 23:15:53 -0700 (PDT)
Date: Sat, 15 Aug 2009 09:15:53 +0300
Message-ID: <786fde50908142315k37b1e378o5ffde2f8f5d8f4dc@mail.gmail.com>
Subject: FSDirectory.setDisableLocks
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6db2b15dfad1104712819fa
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6db2b15dfad1104712819fa
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi

If I can guarantee only one JVM will update an index (not at a time - truly
just one JVM), can I disable locks, or is it really necessary only for
read-only devices? If I disable locks, will I see any performance
improvements?

Thanks
Shai

--0016e6db2b15dfad1104712819fa--

From java-user-return-41904-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 15 09:49:52 2009
Return-Path: <java-user-return-41904-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25515 invoked from network); 15 Aug 2009 09:49:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Aug 2009 09:49:52 -0000
Received: (qmail 74723 invoked by uid 500); 15 Aug 2009 09:49:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74643 invoked by uid 500); 15 Aug 2009 09:49:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74633 invoked by uid 99); 15 Aug 2009 09:49:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Aug 2009 09:49:57 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Aug 2009 09:49:47 +0000
Received: by ywh26 with SMTP id 26so2668816ywh.5
        for <java-user@lucene.apache.org>; Sat, 15 Aug 2009 02:49:25 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.172.39 with SMTP id u39mr1176192ybe.43.1250329765681; Sat, 
	15 Aug 2009 02:49:25 -0700 (PDT)
In-Reply-To: <786fde50908142315k37b1e378o5ffde2f8f5d8f4dc@mail.gmail.com>
References: <786fde50908142315k37b1e378o5ffde2f8f5d8f4dc@mail.gmail.com>
Date: Sat, 15 Aug 2009 05:49:25 -0400
Message-ID: <9ac0c6aa0908150249r2045056do89cce68ff2e44e8d@mail.gmail.com>
Subject: Re: FSDirectory.setDisableLocks
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

You could also use NoLockFactory.

Disabling locks just means Lucene stops checking if another writer has
the index open (the write.lock file).

It's extremely dangerous to do, unless you are absolutely certain your
application level locking properly implements the protection.  It will
quickly lead to index corruption.

I would expect no real performance change, unless you create writers
exceptionally often.

A read-only index need not disable locks because IndexReader will
never attempt to create a lock.  (Before 2.1 there was also a commit
lock, which IndexReader did create, but as of 2.1 IndexReader is
readOnly, unless you use it to do deletions or change norms).

Mike

On Sat, Aug 15, 2009 at 2:15 AM, Shai Erera<serera@gmail.com> wrote:
> Hi
>
> If I can guarantee only one JVM will update an index (not at a time - truly
> just one JVM), can I disable locks, or is it really necessary only for
> read-only devices? If I disable locks, will I see any performance
> improvements?
>
> Thanks
> Shai
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41905-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 15 11:32:44 2009
Return-Path: <java-user-return-41905-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51955 invoked from network); 15 Aug 2009 11:32:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Aug 2009 11:32:44 -0000
Received: (qmail 35263 invoked by uid 500); 15 Aug 2009 11:32:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35227 invoked by uid 500); 15 Aug 2009 11:32:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35217 invoked by uid 99); 15 Aug 2009 11:32:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Aug 2009 11:32:48 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Aug 2009 11:32:40 +0000
Received: by ewy26 with SMTP id 26so2097552ewy.5
        for <java-user@lucene.apache.org>; Sat, 15 Aug 2009 04:32:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=TbWTehUO9njHUDrQ5ZJ0qSUqVyySHN0TKa01cB2khT0=;
        b=SopuRE7E5xRmcbeowP6O7bb4DAqhllUsAt6YTpQBVi7OLDyGCpyjb3ja2Cy76hrA1v
         zQAx2jw4Izfl+6N0qeUYOatb1W2OQhpd+Pc0SVsz+UF23aFFDCqYvi91Qgv7zYxkNKNm
         CryVoKfvGuv8Zqnx7offXP11hpNxnkqgE0Kzk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=KEwEopq7hefKXyaWSa/yPkQb836JXPN+L6R4790U2IFA59AR9vUGWW7UbRRaj6ZkzA
         SjvBCxLdRMX5B5bExDL7p41B21drsjFqlkUlJR3zSMPcl421gzIJ1V9XADTDE1DycCJe
         LRccQqPbTnnNk1IE7SS4oKUDkpWe6QASFlooE=
MIME-Version: 1.0
Received: by 10.216.12.67 with SMTP id 45mr610207wey.218.1250335938981; Sat, 
	15 Aug 2009 04:32:18 -0700 (PDT)
In-Reply-To: <9ac0c6aa0908150249r2045056do89cce68ff2e44e8d@mail.gmail.com>
References: <786fde50908142315k37b1e378o5ffde2f8f5d8f4dc@mail.gmail.com>
	 <9ac0c6aa0908150249r2045056do89cce68ff2e44e8d@mail.gmail.com>
Date: Sat, 15 Aug 2009 14:32:18 +0300
Message-ID: <786fde50908150432h519dbdc3j4983c4565c0f895a@mail.gmail.com>
Subject: Re: FSDirectory.setDisableLocks
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364d1d557e308904712c8518
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364d1d557e308904712c8518
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks Mike.

Shai

On Sat, Aug 15, 2009 at 12:49 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> You could also use NoLockFactory.
>
> Disabling locks just means Lucene stops checking if another writer has
> the index open (the write.lock file).
>
> It's extremely dangerous to do, unless you are absolutely certain your
> application level locking properly implements the protection.  It will
> quickly lead to index corruption.
>
> I would expect no real performance change, unless you create writers
> exceptionally often.
>
> A read-only index need not disable locks because IndexReader will
> never attempt to create a lock.  (Before 2.1 there was also a commit
> lock, which IndexReader did create, but as of 2.1 IndexReader is
> readOnly, unless you use it to do deletions or change norms).
>
> Mike
>
> On Sat, Aug 15, 2009 at 2:15 AM, Shai Erera<serera@gmail.com> wrote:
> > Hi
> >
> > If I can guarantee only one JVM will update an index (not at a time -
> truly
> > just one JVM), can I disable locks, or is it really necessary only for
> > read-only devices? If I disable locks, will I see any performance
> > improvements?
> >
> > Thanks
> > Shai
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016364d1d557e308904712c8518--

From java-user-return-41906-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 16 13:35:09 2009
Return-Path: <java-user-return-41906-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4814 invoked from network); 16 Aug 2009 13:35:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Aug 2009 13:35:09 -0000
Received: (qmail 51751 invoked by uid 500); 16 Aug 2009 13:35:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51651 invoked by uid 500); 16 Aug 2009 13:35:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51641 invoked by uid 99); 16 Aug 2009 13:35:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 16 Aug 2009 13:35:13 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of prashullegaddi@gmail.com designates 209.85.146.180 as permitted sender)
Received: from [209.85.146.180] (HELO wa-out-1112.google.com) (209.85.146.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 16 Aug 2009 13:35:05 +0000
Received: by wa-out-1112.google.com with SMTP id v27so310270wah.5
        for <java-user@lucene.apache.org>; Sun, 16 Aug 2009 06:34:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=BJrNAcLkTSnz1CJETWP8EQ+G67EdyiUni7oOutWPAMA=;
        b=DvN4ou42HhmRZqaSFX2PNWpNTrrJetajc3mHBmbcbxq3zMkhFhmKe4R9uVUEqTY+l4
         flXTR2XLc9o/hwQD2UYXvcr9a6vKIAXNFdLzWyFnX95+VgNURyTwnSzydxIsWZQ+P5MZ
         PufpEAXQYGQ/ZTrFbrzaaLSjhVRHeSRldtTQU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=iR/Yqic9cO9LIgMqYqRMJf5mlnW60Jc3tks3rZ+ZZXk2I6NUOVwmxxVATGUViP7ZhT
         k7BBRPhVTfeX8SiTG3t0tWKjrFcjTryaSaGU0ijUwyIAR2Hjf97aicpdze53oV/aMn2K
         2sRAhKX63/alXOs75ShSC/XNIfWTCvZe7nl8s=
MIME-Version: 1.0
Received: by 10.140.251.12 with SMTP id y12mr734497rvh.3.1250429684985; Sun, 
	16 Aug 2009 06:34:44 -0700 (PDT)
Date: Sun, 16 Aug 2009 19:04:44 +0530
Message-ID: <ac6e61fc0908160634o12e9544fvfe718c2ba6a7139c@mail.gmail.com>
Subject: How to normalize Lucene score?
From: prashant ullegaddi <prashullegaddi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1107230b1430471425985
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1107230b1430471425985
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

How to normalize the Lucene score to the range [0, 1]?

Thanks,
Prashant.

--000e0cd1107230b1430471425985--

From java-user-return-41907-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 16 17:56:54 2009
Return-Path: <java-user-return-41907-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82163 invoked from network); 16 Aug 2009 17:56:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Aug 2009 17:56:53 -0000
Received: (qmail 79538 invoked by uid 500); 16 Aug 2009 17:56:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79440 invoked by uid 500); 16 Aug 2009 17:56:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79430 invoked by uid 99); 16 Aug 2009 17:56:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 16 Aug 2009 17:56:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 16 Aug 2009 17:56:45 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mcjxw-0003qI-Bs
	for java-user@lucene.apache.org; Sun, 16 Aug 2009 10:56:24 -0700
Message-ID: <24996067.post@talk.nabble.com>
Date: Sun, 16 Aug 2009 10:56:24 -0700 (PDT)
From: rishisinghal <singhal.rishi@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Indexer crashes with "hit exception during merge"
In-Reply-To: <24971223.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: singhal.rishi@gmail.com
References: <24951667.post@talk.nabble.com> <9ac0c6aa0908130249x15226100w5183cd591f43181d@mail.gmail.com> <24952295.post@talk.nabble.com> <786fde50908130309i49b5395bpd4e9199d334346ff@mail.gmail.com> <24953575.post@talk.nabble.com> <786fde50908130508h55c4e0d6xb052e1f4d75f7a65@mail.gmail.com> <24953833.post@talk.nabble.com> <9ac0c6aa0908130535x68ad6b4atcf0663a4b046f0f9@mail.gmail.com> <24958845.post@talk.nabble.com> <786fde50908140409u5fe053f1j9a49efae6797d25c@mail.gmail.com> <24970274.post@talk.nabble.com> <9ac0c6aa0908140450q6df61575o708db832c4493323@mail.gmail.com> <24970750.post@talk.nabble.com> <9ac0c6aa0908140540s1e2c9d3dwe384dca94b0e6e28@mail.gmail.com> <24971223.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


hmm i tried to create a small reproducer but was not successful to reproduc=
e
this. For less number of files my application also works fine. I tried with
many different individual directories and it runs fine. Only when the
directory structure is huge i get the io error.

So i have no idea what is causing this.=20

Regards,
Rishi


rishisinghal wrote:
>=20
> Okay let me try if i can create a standalone test which reproduces this
> issue and get back.
>=20
> Regards,
> Rishi
>=20
>=20
> Michael McCandless-2 wrote:
>>=20
>> But, if you can break out just the Lucene indexing part into a
>> standalone test, that shows the exception, that can help us isolate
>> it.
>>=20
>> At this point it seems likely the issue is something OS/filesystem
>> specific, because at one time (during optimize), we see a "file not
>> found" exception, yet at another time (running CheckIndex) the same
>> file is opened just fine.
>>=20
>> Mike
>>=20
>> On Fri, Aug 14, 2009 at 8:13 AM, rishisinghal<singhal.rishi@gmail.com>
>> wrote:
>>>
>>> This is a big project having lots of source files. =C2=A0The excerpt of=
 the
>>> main
>>> indexer program =C2=A0is:
>>> FileIndexer indexer =3D new FileIndexer(props);
>>>
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Analyzer defAnal=
yzer =3D new StandardAnalyzer();
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0FileIndexer.anal=
yzer =3D defAnalyzer;
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0IndexWriter writ=
er =3D new
>>> IndexWriter(dir,FileIndexer.analyzer, true,
>>> IndexWriter.MaxFieldLength.LIMITED);
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0writer.setMaxBuf=
feredDocs(5);
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0//writer.setMaxM=
ergeDocs(50);
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0writer.setMergeF=
actor(5);
>>>
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0long start =3D n=
ew Date().getTime();
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0try
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0{
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0for (int i=3D0; =
i<disks.size();i++)
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0{
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0index(writer, ne=
w File(disks.get(i)),filelist,
>>> FileIndexer.analyzer);
>>>
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0}
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0writer.setInfoSt=
ream(System.out);
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0writer.optimize(=
);
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0}
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0catch(Exception =
e)
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0{
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0e.printStackTrace();
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0}
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0finally
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0{
>>>
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0writer.close();
>>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0}
>>>
>>>
>>>
>>>
>>>
>>>
>>> Michael McCandless-2 wrote:
>>>>
>>>> Can you post the full sources for the test that hits the exception on
>>>> your system?
>>>>
>>>> Mike
>>>>
>>>> On Fri, Aug 14, 2009 at 7:36 AM, rishisinghal<singhal.rishi@gmail.com>
>>>> wrote:
>>>>>
>>>>> It is reproducible in my system. If the number of files are small I a=
m
>>>>> not
>>>>> able to see the crash.
>>>>>
>>>>>>>can you turn on infoStream on IndexWriter and post the output?
>>>>> I am not clear on this. If you are talking of
>>>>> writer.setInfoStream(System.out);
>>>>> I already have posted the output while raising the issue.
>>>>>
>>>>>
>>>>>>>If CheckIndex succeeds, then I'd compare the output w/ and w/o
>>> CheckIndex.
>>>>> I am not clear on this too. As I know CheckIndex program has been run
>>>>> after
>>>>> I get the error and it shows no issues.
>>>>>
>>>>> Regards,
>>>>> Rishi
>>>>>
>>>>>
>>>>>
>>>>> Shai Erera wrote:
>>>>>>
>>>>>> If it's easily reproducible, can you please provide a test that
>>>>>> reproduces
>>>>>> it, even if on just your FS? And also, can you turn on infoStream on
>>>>>> IndexWriter and post the output?
>>>>>>
>>>>>> If CheckIndex succeeds, then I'd compare the output w/ and w/o
>>>>>> CheckIndex.
>>>>>>
>>>>>> Shai
>>>>>>
>>>>>> On Fri, Aug 14, 2009 at 12:17 AM, rishisinghal
>>>>>> <singhal.rishi@gmail.com>wrote:
>>>>>>
>>>>>>>
>>>>>>> I am running this on OpenVMS V8.2-1 on IA64. For a small number of
>>>>>>> files
>>>>>>> this
>>>>>>> works all fine.
>>>>>>>
>>>>>>> I checked the resources part and i have enough disk and ram
>>>>>>> available.
>>>>>>>
>>>>>>> Regards,
>>>>>>> Rishi
>>>>>>>
>>>>>>>
>>>>>>> Michael McCandless-2 wrote:
>>>>>>> >
>>>>>>> > It's very odd that CheckIndex has no trouble opening the segment'=
s
>>>>>>> > files, yet when you run optimize the OS reports a "file not found=
"
>>>>>>> > exception (errno 5). =C2=A0Something odd is happening at the
>>>>>>> OS/filesystem
>>>>>>> > level.
>>>>>>> >
>>>>>>> > What OS are you running on?
>>>>>>> >
>>>>>>> > Can you boil this down to a smallish standalone test that shows
>>>>>>> the
>>>>>>> > problem?
>>>>>>> >
>>>>>>> > Mike
>>>>>>> >
>>>>>>> > On Thu, Aug 13, 2009 at 8:21 AM,
>>>>>>> rishisinghal<singhal.rishi@gmail.com>
>>>>>>> > wrote:
>>>>>>> >>
>>>>>>> >> I tried creating the index in different disks but still i see th=
e
>>>>>>> issue
>>>>>>> >> :-(
>>>>>>> >>
>>>>>>> >> I tried to index documents in other disks also and got the same
>>>>>>> >> exception.
>>>>>>> >>
>>>>>>> >> I also tried
>>>>>>> >> $ java org.apache.lucene.index.CheckIndex
>>>>>>> >> /SYS$SYSDEVICE/RISHI/melon_1600/
>>>>>>> >> -segment _61
>>>>>>> >> NOTE: testing will be more thorough if you run java with
>>>>>>> >> '-ea:org.apache.lucene...', so assertions are enabled
>>>>>>> >> Opening index @ /SYS$SYSDEVICE/RISHI/melon_1600/
>>>>>>> >> Segments file=3Dsegments_1 numSegments=3D0 version=3DFORMAT_HAS_=
PROX
>>>>>>> [Lucene
>>>>>>> >> 2.4]
>>>>>>> >>
>>>>>>> >> Checking only these segments: _61:
>>>>>>> >> No problems were detected with this index.
>>>>>>> >>
>>>>>>> >> Regards,
>>>>>>> >> Rishi
>>>>>>> >>
>>>>>>> >>
>>>>>>> >> Shai Erera wrote:
>>>>>>> >>>
>>>>>>> >>> I noticed the exception is "Caused by:
>>>>>>> java.io.FileNotFoundException:
>>>>>>> >>> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error (errno:5))"
>>>>>>> >>>
>>>>>>> >>> I searched for i/o error (errno:5) and found some information
>>>>>>> which
>>>>>>> >>> associates it w/ a more native IO problem, like corrupt file du=
e
>>>>>>> to
>>>>>>> >>> system
>>>>>>> >>> crash etc.
>>>>>>> >>>
>>>>>>> >>> Did you experience that? Can you try to create the index
>>>>>>> somewhere
>>>>>>> else,
>>>>>>> >>> or
>>>>>>> >>> on another drive?
>>>>>>> >>>
>>>>>>> >>> Shai
>>>>>>> >>>
>>>>>>> >>> On Thu, Aug 13, 2009 at 3:00 PM, rishisinghal
>>>>>>> >>> <singhal.rishi@gmail.com>wrote:
>>>>>>> >>>
>>>>>>> >>>>
>>>>>>> >>>> It is a local file system.
>>>>>>> >>>>
>>>>>>> >>>> We are using lucene 2.4 and java 1.5
>>>>>>> >>>>
>>>>>>> >>>> Regards,
>>>>>>> >>>> Rishi
>>>>>>> >>>>
>>>>>>> >>>>
>>>>>>> >>>> Shai Erera wrote:
>>>>>>> >>>> >
>>>>>>> >>>> > Is that a local file system, or a network share?
>>>>>>> >>>> >
>>>>>>> >>>> > On Thu, Aug 13, 2009 at 1:07 PM, rishisinghal
>>>>>>> >>>> > <singhal.rishi@gmail.com>wrote:
>>>>>>> >>>> >
>>>>>>> >>>> >>
>>>>>>> >>>> >> >>Is there any chance that two writers are open on this
>>>>>>> directory?
>>>>>>> >>>> >> No, thats not true.
>>>>>>> >>>> >>
>>>>>>> >>>> >> >>something external to Lucene is removing files from the
>>>>>>> directory.
>>>>>>> >>>> >> No this also has rare chances as I am the owner of these
>>>>>>> files
>>>>>>> and
>>>>>>> >>>> other
>>>>>>> >>>> >> then me no one can delete the, :-)
>>>>>>> >>>> >>
>>>>>>> >>>> >> Here are all the files in the index directory:
>>>>>>> >>>> >> segments.gen;1 =C2=A0 =C2=A0 =C2=A0segments_1.;1 =C2=A0 =C2=
=A0 =C2=A0 segments_2.;1
>>>>>>> _0.fdt;1
>>>>>>> >>>> >> _0.fdx;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0_37.cfs;1=
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _4c.cfs;1
>>>>>>> >>>> _61.cfs;1
>>>>>>> >>>> >> _9e.cfs;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _ay.cfs;1 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _az.cfs;1
>>>>>>> >>>> _b0.cfs;1
>>>>>>> >>>> >> _b2.tis;1 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _b3.fdt;1 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 _b4.fdt;1
>>>>>>> >>>> >>
>>>>>>> >>>> >> I see _37 present.
>>>>>>> >>>> >>
>>>>>>> >>>> >> Regards,
>>>>>>> >>>> >> Rishi
>>>>>>> >>>> >>
>>>>>>> >>>> >>
>>>>>>> >>>> >> Michael McCandless-2 wrote:
>>>>>>> >>>> >> >
>>>>>>> >>>> >> > Is there any chance that two writers are open on this
>>>>>>> directory?
>>>>>>> >>>> Or,
>>>>>>> >>>> >> > something external to Lucene is removing files from the
>>>>>>> directory.
>>>>>>> >>>> >> >
>>>>>>> >>>> >> > It looks like there were at least two missing files (_37
>>>>>>> >>>> >> >
>>>>>>> >>>> >> > On Thu, Aug 13, 2009 at 5:19 AM,
>>>>>>> >>>> rishisinghal<singhal.rishi@gmail.com
>>>>>>> >>>> >
>>>>>>> >>>> >> > wrote:
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >> Hi,
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >> I am trying to index documents and when all is complete
>>>>>>> and
>>>>>>> >>>> optimize
>>>>>>> >>>> >> is
>>>>>>> >>>> >> >> called I get
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >> IFD [main]: setInfoStream
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletion=
Policy@4fced0
>>>>>>> >>>> >> >> IW 0 [main]: setInfoStream:
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>> dir=3Dorg.apache.lucene.store.FSDirectory@
>>>>>>> /SYS$SYSDEVICE/RISHI/melon_1600
>>>>>>> >>>> >> >> autoCommit=3Dfalse mergePolicy=3Dorg
>>>>>>> >>>> >> >> .apache.lucene.index.LogByteSizeMergePolicy@92cb49
>>>>>>> >>>> >> >>
>>>>>>> >>>>
>>>>>>> mergeScheduler=3Dorg.apache.lucene.index.ConcurrentMergeScheduler@6=
038e4
>>>>>>> >>>> >> >> ramBufferS
>>>>>>> >>>> >> >> izeMB=3D16.0 maxBufferedDocs=3D5 maxBuffereDeleteTerms=
=3D-1
>>>>>>> >>>> >> >> maxFieldLength=3D10000
>>>>>>> >>>> >> >> index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0 _9e:c485-=
>_0
>>>>>>> >>>> >> >> =C2=A0_ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>>> >>>> >> >> IW 0 [main]: optimize: index now _37:c465->_0
>>>>>>> _4c:c165->_0
>>>>>>> >>>> >> _61:c245->_0
>>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>>> >>>> >> >> IW 0 [main]: =C2=A0 flush: segment=3Dnull docStoreSegmen=
t=3Dnull
>>>>>>> >>>> >> docStoreOffset=3D0
>>>>>>> >>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Df=
alse
>>>>>>> numD
>>>>>>> >>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>>>>>> >>>> >> >> IW 0 [main]: =C2=A0 index before flush _37:c465->_0
>>>>>>> _4c:c165->_0
>>>>>>> >>>> >> _61:c245->_0
>>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>>> >>>> >> >> IW 0 [main]: add merge to pendingMerges: _61:c245->_0
>>>>>>> >>>> _9e:c485->_0
>>>>>>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 [optimize] [total 1
>>>>>>> pending]
>>>>>>> >>>> >> >> IW 0 [main]: CMS: now merge
>>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 index: _37:c465->_0 _4c:c165->_=
0
>>>>>>> _61:c245->_0
>>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 consider merge _61:c245->_0
>>>>>>> _9e:c485->_0
>>>>>>> >>>> >> _ay:c225->_0
>>>>>>> >>>> >> >> _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 =C2=A0 launch new thread [Lucen=
e Merge
>>>>>>> Thread
>>>>>>> #73]
>>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 no more merges pending; now ret=
urn
>>>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: CMS: =C2=A0 merge thread=
:
>>>>>>> start
>>>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: now merge
>>>>>>> >>>> >> >> =C2=A0merge=3D_61:c245->_0 _9e:c485->_0 _ay:c225->_0 _az=
:c5->_0
>>>>>>> >>>> _b0:c5->_0
>>>>>>> >>>> >> into
>>>>>>> >>>> >> >> _b5 [optimize]
>>>>>>> >>>> >> >>
>>>>>>> =C2=A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@3725db
>>>>>>> >>>> >> >> =C2=A0index=3D_37:c465->_0 _4c:c165->_0 _61:c245->_0
>>>>>>> _9e:c485->_0
>>>>>>> >>>> >> _ay:c225->_0
>>>>>>> >>>> >> >> _az:c5->_0 _b0:c5->_0
>>>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: merging _61:c245->_0
>>>>>>> _9e:c485->_0
>>>>>>> >>>> >> >> _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5 [optimize]
>>>>>>> >>>> >> >> IW 0 [Lucene Merge Thread #73]: hit exception during
>>>>>>> merge
>>>>>>> >>>> >> >> Exception in thread "Lucene Merge Thread #73"
>>>>>>> >>>> >> >> org.apache.lucene.index.MergePolicy$MergeException:
>>>>>>> >>>> >> >> java.io.FileNotFoundException: /SY
>>>>>>> >>>> >> >> S$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error
>>>>>>> (errno:5))
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeExcepti=
on(ConcurrentMergeScheduler.java:309)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Co=
ncurrentMergeScheduler.java:286)
>>>>>>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>>>>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error
>>>>>>> (errno:5))
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.o=
pen(Native Method)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(=
FSDirectory.java:552)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory=
.java:582)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReade=
r.java:70)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java=
:321)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:42=
20)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(Concurrent=
MergeScheduler.java:205)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Co=
ncurrentMergeScheduler.java:260)
>>>>>>> >>>> >> >> Aug 13, 2009 2:40:56 PM
>>>>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP
>>>>>>> >>>> >> >> jspMain
>>>>>>> >>>> >> >> SEVERE: Indexing not completebackground merge hit
>>>>>>> exception:
>>>>>>> >>>> >> _61:c245->_0
>>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5
>>>>>>> [
>>>>>>> >>>> >> >> optimize]
>>>>>>> >>>> >> >> java.io.IOException: background merge hit exception:
>>>>>>> _61:c245->_0
>>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0 into _b5
>>>>>>> >>>> [optimize
>>>>>>> >>>> >> >> ]
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>>>>>> >>>> >> >> Source)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>>>>>>> >>>> Source)
>>>>>>> >>>> >> >> Caused by: java.io.FileNotFoundException:
>>>>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_61.cfs (i/o error
>>>>>>> (errno:5))
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.o=
pen(Native Method)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(=
FSDirectory.java:552)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory=
.java:582)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReade=
r.java:70)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java=
:321)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:42=
20)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(Concurrent=
MergeScheduler.java:205)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Co=
ncurrentMergeScheduler.java:260)
>>>>>>> >>>> >> >> IW 0 [main]: now flush at close
>>>>>>> >>>> >> >> IW 0 [main]: =C2=A0 flush: segment=3Dnull docStoreSegmen=
t=3Dnull
>>>>>>> >>>> >> docStoreOffset=3D0
>>>>>>> >>>> >> >> flushDocs=3Dfalse flushDeletes=3Dtrue flushDocStores=3Df=
alse
>>>>>>> numD
>>>>>>> >>>> >> >> ocs=3D0 numBufDelTerms=3D0
>>>>>>> >>>> >> >> IW 0 [main]: =C2=A0 index before flush _37:c465->_0
>>>>>>> _4c:c165->_0
>>>>>>> >>>> >> _61:c245->_0
>>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>>> >>>> >> >> IW 0 [main]: CMS: now merge
>>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 index: _37:c465->_0 _4c:c165->_=
0
>>>>>>> _61:c245->_0
>>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>>> >>>> >> >> IW 0 [main]: CMS: =C2=A0 no more merges pending; now ret=
urn
>>>>>>> >>>> >> >> IW 0 [main]: now call final commit()
>>>>>>> >>>> >> >> IW 0 [main]: startCommit(): start sizeInBytes=3D0
>>>>>>> >>>> >> >> IW 0 [main]: startCommit index=3D_37:c465->_0 _4c:c165->=
_0
>>>>>>> >>>> _61:c245->_0
>>>>>>> >>>> >> >> _9e:c485->_0 _ay:c225->_0 _az:c5->_0 _b0:c5->_0
>>>>>>> changeCount=3D11
>>>>>>> >>>> >> >> 95
>>>>>>> >>>> >> >> IW 0 [main]: now sync _37.cfs
>>>>>>> >>>> >> >> IW 0 [main]: hit exception while closing
>>>>>>> >>>> >> >> Exception in thread "main" java.io.FileNotFoundException=
:
>>>>>>> >>>> >> >> /SYS$SYSDEVICE/RISHI/melon_1600/_37.cfs (i/o error
>>>>>>> (errno:5))
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.o=
pen(Native Method)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >>
>>>>>>> org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:456)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:45=
90)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3369)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:=
1654)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1602)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> >> >>
>>>>>>> org.apache.lucene.index.IndexWriter.close(IndexWriter.java:1578)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> >>>> org.hp.openvms.lucene.index.FileIndexerJSP.jspMain(Unknown
>>>>>>> >>>> >> >> Source)
>>>>>>> >>>> >> >> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>>>>>>> org.hp.openvms.lucene.index.FileIndexer.main(Unknown
>>>>>>> >>>> Source)
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >> I have setMaxBufferedDocs =3D 5 and setMergeFactor=3D5. =
I was
>>>>>>> trying
>>>>>>> >>>> >> >> different
>>>>>>> >>>> >> >> combinations of these to see if that helps but was
>>>>>>> unsuccessful.
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >> Regards,
>>>>>>> >>>> >> >> Rishi
>>>>>>> >>>> >> >> --
>>>>>>> >>>> >> >> View this message in context:
>>>>>>> >>>> >> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-=
merge%22-tp24951667p24951667.html
>>>>>>> >>>> >> >> Sent from the Lucene - Java Users mailing list archive a=
t
>>>>>>> >>>> Nabble.com.
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >>
>>>>>>> >>>>
>>>>>>> -------------------------------------------------------------------=
--
>>>>>>> >>>> >> >> To unsubscribe, e-mail:
>>>>>>> java-user-unsubscribe@lucene.apache.org
>>>>>>> >>>> >> >> For additional commands, e-mail:
>>>>>>> java-user-help@lucene.apache.org
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >>
>>>>>>> >>>> >> >
>>>>>>> >>>> >> >
>>>>>>> >>>>
>>>>>>> -------------------------------------------------------------------=
--
>>>>>>> >>>> >> > To unsubscribe, e-mail:
>>>>>>> java-user-unsubscribe@lucene.apache.org
>>>>>>> >>>> >> > For additional commands, e-mail:
>>>>>>> java-user-help@lucene.apache.org
>>>>>>> >>>> >> >
>>>>>>> >>>> >> >
>>>>>>> >>>> >> >
>>>>>>> >>>> >>
>>>>>>> >>>> >> --
>>>>>>> >>>> >> View this message in context:
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-=
merge%22-tp24951667p24952295.html
>>>>>>> >>>> >> Sent from the Lucene - Java Users mailing list archive at
>>>>>>> >>>> Nabble.com.
>>>>>>> >>>> >>
>>>>>>> >>>> >>
>>>>>>> >>>> >>
>>>>>>> >>>>
>>>>>>> -------------------------------------------------------------------=
--
>>>>>>> >>>> >> To unsubscribe, e-mail:
>>>>>>> java-user-unsubscribe@lucene.apache.org
>>>>>>> >>>> >> For additional commands, e-mail:
>>>>>>> java-user-help@lucene.apache.org
>>>>>>> >>>> >>
>>>>>>> >>>> >>
>>>>>>> >>>> >
>>>>>>> >>>> >
>>>>>>> >>>>
>>>>>>> >>>> --
>>>>>>> >>>> View this message in context:
>>>>>>> >>>>
>>>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-=
merge%22-tp24951667p24953575.html
>>>>>>> >>>> Sent from the Lucene - Java Users mailing list archive at
>>>>>>> Nabble.com.
>>>>>>> >>>>
>>>>>>> >>>>
>>>>>>> >>>>
>>>>>>> -------------------------------------------------------------------=
--
>>>>>>> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.or=
g
>>>>>>> >>>> For additional commands, e-mail:
>>>>>>> java-user-help@lucene.apache.org
>>>>>>> >>>>
>>>>>>> >>>>
>>>>>>> >>>
>>>>>>> >>>
>>>>>>> >>
>>>>>>> >> --
>>>>>>> >> View this message in context:
>>>>>>> >>
>>>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-=
merge%22-tp24951667p24953833.html
>>>>>>> >> Sent from the Lucene - Java Users mailing list archive at
>>>>>>> Nabble.com.
>>>>>>> >>
>>>>>>> >>
>>>>>>> >>
>>>>>>> -------------------------------------------------------------------=
--
>>>>>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> >> For additional commands, e-mail: java-user-help@lucene.apache.or=
g
>>>>>>> >>
>>>>>>> >>
>>>>>>> >
>>>>>>> >
>>>>>>> -------------------------------------------------------------------=
--
>>>>>>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>> >
>>>>>>> >
>>>>>>> >
>>>>>>>
>>>>>>> --
>>>>>>> View this message in context:
>>>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-=
merge%22-tp24951667p24958845.html
>>>>>>> Sent from the Lucene - Java Users mailing list archive at
>>>>>>> Nabble.com.
>>>>>>>
>>>>>>>
>>>>>>> -------------------------------------------------------------------=
--
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>> --
>>>>> View this message in context:
>>>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-me=
rge%22-tp24951667p24970274.html
>>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>
>>>
>>> --
>>> View this message in context:
>>> http://www.nabble.com/Indexer-crashes-with-%22hit-exception-during-merg=
e%22-tp24951667p24970750.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>=20
>>=20
>>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Indexer-crashes-with-%2=
2hit-exception-during-merge%22-tp24951667p24996067.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41908-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 17 07:25:03 2009
Return-Path: <java-user-return-41908-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95205 invoked from network); 17 Aug 2009 07:25:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Aug 2009 07:25:03 -0000
Received: (qmail 527 invoked by uid 500); 17 Aug 2009 07:25:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 448 invoked by uid 500); 17 Aug 2009 07:25:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 438 invoked by uid 99); 17 Aug 2009 07:25:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 07:25:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 07:24:57 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mcwa5-0002Bs-56
	for java-user@lucene.apache.org; Mon, 17 Aug 2009 00:24:37 -0700
Message-ID: <25002240.post@talk.nabble.com>
Date: Mon, 17 Aug 2009 00:24:37 -0700 (PDT)
From: joe_coder <codetester.codetester@gmail.com>
To: java-user@lucene.apache.org
Subject: Lucene Tokenizer + Merge terms
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: codetester.codetester@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


I am using a custom analyzer:


    public TokenStream tokenStream(String fieldName, Reader reader) {
        StandardTokenizer tokenStream = new StandardTokenizer(reader);
        tokenStream.setMaxTokenLength(maxTokenLength);

        TokenStream result = new ASCIIFoldingFilter(tokenStream);
        result = new StandardFilter(result);
        result = new LengthFilter(result, 3, maxTokenLength);
        result = new LowerCaseFilter(result);
        result = new StopFilter(true, result, stopSet);
        result = new PorterStemFilter(result);
        return result;
    } 

My question is around creating a new tokenizer which can detect people
name/place names etc(I will be able to lookup on my local db to find such
cases). E.g: If a text has "Joe Coder is in New York", then instead of
termvectors [Joe][Coder][New][York], I would like to have term vectors as
[Joe Coder][New York]

Are there any tokenzier in lucene that I can extend to perform this
functionality? Any other pointers?
-- 
View this message in context: http://www.nabble.com/Lucene-Tokenizer-%2B-Merge-terms-tp25002240p25002240.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41909-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 17 08:32:55 2009
Return-Path: <java-user-return-41909-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23514 invoked from network); 17 Aug 2009 08:32:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Aug 2009 08:32:55 -0000
Received: (qmail 89757 invoked by uid 500); 17 Aug 2009 08:33:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89675 invoked by uid 500); 17 Aug 2009 08:32:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89665 invoked by uid 99); 17 Aug 2009 08:32:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 08:32:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 08:32:49 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mcxdk-0004VI-OW
	for java-user@lucene.apache.org; Mon, 17 Aug 2009 01:32:28 -0700
Message-ID: <25003017.post@talk.nabble.com>
Date: Mon, 17 Aug 2009 01:32:28 -0700 (PDT)
From: Strubbl <nabble@linux4tw.de>
To: java-user@lucene.apache.org
Subject: filter special chars
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: nabble@linux4tw.de
X-Virus-Checked: Checked by ClamAV on apache.org


hi, is there any way to filter special chars like this one: "=C3=98" out of=
 my
fields I want to index?
until now I tested it with the StopFilter("=C3=98"). But it doesn't work. W=
hen I
search the index with Luke for this symbol I still get results.

Can anyone help please?
--=20
View this message in context: http://www.nabble.com/filter-special-chars-tp=
25003017p25003017.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41910-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 17 08:33:09 2009
Return-Path: <java-user-return-41910-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23660 invoked from network); 17 Aug 2009 08:33:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Aug 2009 08:33:08 -0000
Received: (qmail 91496 invoked by uid 500); 17 Aug 2009 08:33:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91427 invoked by uid 500); 17 Aug 2009 08:33:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91417 invoked by uid 99); 17 Aug 2009 08:33:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 08:33:12 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: 131.246.120.220 is neither permitted nor denied by domain of christian.reuschling@gmail.com)
Received: from [131.246.120.220] (HELO mailgw1.uni-kl.de) (131.246.120.220)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 08:33:01 +0000
Received: from dfki.uni-kl.de (dfki-1002.dfki.uni-kl.de [131.246.195.2])
	by mailgw1.uni-kl.de (8.13.8/8.13.8/Debian-3) with ESMTP id n7H8WfaB017371
	for <java-user@lucene.apache.org>; Mon, 17 Aug 2009 10:32:41 +0200
Received: from serv-4100.kl.dfki.de (serv-4100.kl.dfki.de [192.168.41.180])
	by dfki.uni-kl.de (8.13.8+Sun/8.11.4) with ESMTP id n7H8WekY024663
	for <java-user@lucene.apache.org>; Mon, 17 Aug 2009 10:32:40 +0200 (CEST)
Received: from pc-4176.kl.dfki.de (pc-4176.kl.dfki.de [192.168.41.166])
	by serv-4100.kl.dfki.de (8.13.8+Sun/8.13.8) with ESMTP id n7H8Weem021493
	for <java-user@lucene.apache.org>; Mon, 17 Aug 2009 10:32:40 +0200 (CEST)
Date: Mon, 17 Aug 2009 10:32:36 +0200
From: Christian Reuschling <christian.reuschling@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to normalize Lucene score?
Message-ID: <20090817103236.7a054c46@pc-4176.kl.dfki.de>
In-Reply-To: <ac6e61fc0908160634o12e9544fvfe718c2ba6a7139c@mail.gmail.com>
References: <ac6e61fc0908160634o12e9544fvfe718c2ba6a7139c@mail.gmail.com>
X-Mailer: Claws Mail 3.7.0 (GTK+ 2.14.4; i586-suse-linux-gnu)
Mime-Version: 1.0
Content-Type: multipart/signed; boundary="Sig_/oMP9R.WmjGCi1gnxyjal6d7";
 protocol="application/pgp-signature"; micalg=PGP-SHA1
X-Virus-Checked: Checked by ClamAV on apache.org

--Sig_/oMP9R.WmjGCi1gnxyjal6d7
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: quoted-printable

Hi Prashant,

we let convergate the scores to 1 - whereby they will never reach one, to h=
ave
also correct ratings with respect to higher Lucene scores which are more
or less open-ended:

normalizedScore =3D 1 - [ 1 / (1+luceneScore) ]


best

Christian


On Sun, 16 Aug 2009 19:04:44 +0530
prashant ullegaddi <prashullegaddi@gmail.com> wrote:

> Hi,
>=20
> How to normalize the Lucene score to the range [0, 1]?
>=20
> Thanks,
> Prashant.


--Sig_/oMP9R.WmjGCi1gnxyjal6d7
Content-Type: application/pgp-signature; name=signature.asc
Content-Disposition: attachment; filename=signature.asc

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.9 (GNU/Linux)

iEYEARECAAYFAkqJFaQACgkQ6EqMXq+WZg8IgQCcD6x7b4mjB18+fz+tszpZAWa9
wFIAnjcNm08NIeQ8LkpxFKakuPWznG9N
=4p9P
-----END PGP SIGNATURE-----

--Sig_/oMP9R.WmjGCi1gnxyjal6d7--

From java-user-return-41911-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 17 08:46:13 2009
Return-Path: <java-user-return-41911-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29982 invoked from network); 17 Aug 2009 08:46:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Aug 2009 08:46:13 -0000
Received: (qmail 2203 invoked by uid 500); 17 Aug 2009 08:46:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2124 invoked by uid 500); 17 Aug 2009 08:46:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2114 invoked by uid 99); 17 Aug 2009 08:46:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 08:46:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.222 as permitted sender)
Received: from [209.85.220.222] (HELO mail-fx0-f222.google.com) (209.85.220.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 08:46:07 +0000
Received: by fxm22 with SMTP id 22so2501709fxm.9
        for <java-user@lucene.apache.org>; Mon, 17 Aug 2009 01:45:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=IHMan2g1TozkB6EssWVwKlGo+tBnphS+WujsKhgI/Rk=;
        b=ey1chJjQqsZjG9rC0LU+ic3UTnONuhZLydsxMc44F2+1fskId31Vr5nTmIBHf2ghMk
         arawFnr2gM2prtHN7lApS3nAyRMZxHpi61Fr707jxgGFJmJDiwuT7X2VA9sBTZvs67jT
         rmIfPZ8dRR6IsWtoWzu61Ag9Cuwx2aWm+YpB4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=QLO7vHn05CNYj+hZP7JUOYy72LAd0h+e6+6Hx0E5eaHfUrXFlAMNDCp1KNLHT9cRfZ
         lWZIriPl++zO4mjW9ULtCsU80Sl4AsW2XCexmvzK3AFUIZaYju98kmJUMRizuu5nVyYz
         MiDII5esPxJ7uYvcPMD3Liv8Q+CqH18T+pHVU=
MIME-Version: 1.0
Received: by 10.239.163.208 with SMTP id q16mr322946hbd.102.1250498746256; 
	Mon, 17 Aug 2009 01:45:46 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <25003017.post@talk.nabble.com>
References: <25003017.post@talk.nabble.com>
Date: Mon, 17 Aug 2009 10:45:46 +0200
Message-ID: <f18c9dde0908170145q49afcb1aga7ca32e3e6af6c02@mail.gmail.com>
Subject: Re: filter special chars
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

hey there,

did you try to pass it lower-cased "=C3=B8" I guess you have a
LowerCaseFilter / Tokeninzer in you analysis chain.

simon

On Mon, Aug 17, 2009 at 10:32 AM, Strubbl<nabble@linux4tw.de> wrote:
>
> hi, is there any way to filter special chars like this one: "=C3=98" out =
of my
> fields I want to index?
> until now I tested it with the StopFilter("=C3=98"). But it doesn't work.=
 When I
> search the index with Luke for this symbol I still get results.
>
> Can anyone help please?
> --
> View this message in context: http://www.nabble.com/filter-special-chars-=
tp25003017p25003017.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41912-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 17 08:58:01 2009
Return-Path: <java-user-return-41912-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36089 invoked from network); 17 Aug 2009 08:58:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Aug 2009 08:58:01 -0000
Received: (qmail 20339 invoked by uid 500); 17 Aug 2009 08:58:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20275 invoked by uid 500); 17 Aug 2009 08:58:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20254 invoked by uid 99); 17 Aug 2009 08:58:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 08:58:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 08:57:55 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mcy22-0005FK-92
	for java-user@lucene.apache.org; Mon, 17 Aug 2009 01:57:34 -0700
Message-ID: <25003341.post@talk.nabble.com>
Date: Mon, 17 Aug 2009 01:57:34 -0700 (PDT)
From: Strubbl <nabble@linux4tw.de>
To: java-user@lucene.apache.org
Subject: Re: filter special chars
In-Reply-To: <f18c9dde0908170145q49afcb1aga7ca32e3e6af6c02@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: nabble@linux4tw.de
References: <25003017.post@talk.nabble.com> <f18c9dde0908170145q49afcb1aga7ca32e3e6af6c02@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


YES, you're right. thank you very much! :)


Simon Willnauer wrote:
>=20
> hey there,
>=20
> did you try to pass it lower-cased "=C3=B8" I guess you have a
> LowerCaseFilter / Tokeninzer in you analysis chain.
>=20
> simon
>=20
> On Mon, Aug 17, 2009 at 10:32 AM, Strubbl<nabble@linux4tw.de> wrote:
>>
>> hi, is there any way to filter special chars like this one: "=C3=98" out=
 of my
>> fields I want to index?
>> until now I tested it with the StopFilter("=C3=98"). But it doesn't work=
. When
>> I
>> search the index with Luke for this symbol I still get results.
>>
>> Can anyone help please?
>> --
>> View this message in context:
>> http://www.nabble.com/filter-special-chars-tp25003017p25003017.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/filter-special-chars-tp=
25003017p25003341.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41913-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 17 12:59:59 2009
Return-Path: <java-user-return-41913-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91677 invoked from network); 17 Aug 2009 12:59:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Aug 2009 12:59:59 -0000
Received: (qmail 76354 invoked by uid 500); 17 Aug 2009 13:00:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76278 invoked by uid 500); 17 Aug 2009 13:00:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76268 invoked by uid 99); 17 Aug 2009 13:00:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 13:00:03 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nazario.lucas@gmail.com designates 209.85.216.204 as permitted sender)
Received: from [209.85.216.204] (HELO mail-px0-f204.google.com) (209.85.216.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 12:59:55 +0000
Received: by pxi42 with SMTP id 42so1189904pxi.20
        for <java-user@lucene.apache.org>; Mon, 17 Aug 2009 05:59:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=pDESKAXJqGkUXljCDENin69uF3vdsppVOe5SWiIrCf8=;
        b=xI5gtB1cRxtuT+xLvSdSXdGm6Lr0J9y28ROkJsbrEK2iyo5JMc7OuAad9IlfaFaVba
         XBjbpMzCDTozFEGFmat77zQ63Rb+RcpVyV8kmqC/IBLvGroTGkkJoWyELBdgScGrPHnP
         mt8t8bp8mxGFuOzN3RY5B67ma7kGikxD5jG5I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=FA5lNHdxEyB+HY9Ip9WmCwoVkQhHHOD5gbOS8vUQDUAjqNVGPkSAUViBbhJePTt2WV
         fhX1o0WnQENGlSPbpN9I8FrKTUVaSX8E+iv3C++6E8lw5gl7/unhoU23kxrwXoefx2bI
         4K1Q9K4xrLML4dJmcc3nbtQY4tT39pB7HjeoU=
MIME-Version: 1.0
Received: by 10.115.132.12 with SMTP id j12mr4700009wan.121.1250513975098; 
	Mon, 17 Aug 2009 05:59:35 -0700 (PDT)
In-Reply-To: <9ac0c6aa0908141605v72fbc559qb41a9576f0cc64d7@mail.gmail.com>
References: <3ca1516d0908141147i1baf7af2yf15bcf69d4af77dc@mail.gmail.com>
	 <9ac0c6aa0908141202v677039a3g863e83022675220e@mail.gmail.com>
	 <786fde50908141237l590c017ej7ff1e2d68929622c@mail.gmail.com>
	 <3ca1516d0908141355u65b5027rc4892f5c54f16b79@mail.gmail.com>
	 <9ac0c6aa0908141605v72fbc559qb41a9576f0cc64d7@mail.gmail.com>
Date: Mon, 17 Aug 2009 09:59:35 -0300
Message-ID: <3ca1516d0908170559h241a3524x529eb2241ac853c9@mail.gmail.com>
Subject: Re: Problem doing backup using the SnapshotDeletionPolicy class
From: =?ISO-8859-1?Q?Lucas_Naz=E1rio_dos_Santos?= <nazario.lucas@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e648f4b245bedf047155f9d6
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e648f4b245bedf047155f9d6
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Thanks Mike.

I'm using Windows XP with Java 1.6.0 and Lucene 2.4.1.

I don't know if I'm using the right backup strategy. I have an indexing
process that happens from time to time and the index is getting every day
bigger. Hence, copying all the index every time as a backup strategy is
becoming a painful, endless activity. Giving this scenario, I wouldn't like
to copy the entire index each time I do backup, but only the difference fro=
m
the previous backup. Here is the plan:

1. Create an index writer;
2. Take a snapshot to prevent existing files from changing;
3. Start indexing until no more documents to be indexed exist;
4. Retrieve a list of index files that didn't change with
this.snapshotDeletionPolicy.snapshot().getFileNames();
5. Copy all other files inside the index folder that not those retrieved in
step 4 to the backup directory;
6. Optimize and close the index.

I really don't know if what I'm doing is the best approach to my problem. I
believe that people use the SnapshotDeletionPolicy to copy all the index up
to the last commit. I want to copy only the difference since last backup.

What I'm thinking about doing now is to index in a new directory at every
indexing iteration, copy this index to the backup folder and merge it with
the main index afterwards.

What do you guys think I should do?

Lucas



On Fri, Aug 14, 2009 at 8:05 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> Alas I don't see it failing, with the optimize left in.  Which exact
> rev of 2.9 are you testing with?  Which OS/filesystem/JRE?
>
> I realize this is just a test so what follows may not apply to your
> "real" usage of SnapshotDeletionPolicy...:
>
> Since you're closing the writer before taking the backup, there's no
> need to even use SnapshotDeletionPolicy (you can just copy all files
> you find in the index).
>
> SnapshotDeletionPolicy's purpose is to enable taking backups while an
> IndexWriter is still open & making ongoing changes to the index, ie a
> "hot backup".
>
> Finally, you're taking the snapshot before doing any indexing... which
> means your backup will only reflect the index as of the last commit
> before you did indexing.
>
> Mike
>
> On Fri, Aug 14, 2009 at 4:55 PM, Lucas Naz=E1rio dos
> Santos<nazario.lucas@gmail.com> wrote:
> > Not as small as I would like, but shows the problem.
> >
> > If you remove the statement
> >
> > // Remove this and the backup works fine
> > optimize(policy);
> >
> > the backup works wonderfully.
> >
> > (More code in the next e-mail)
> >
> > Lucas
> >
> >
> >        public static void main(final String[] args) throws
> > CorruptIndexException, IOException, InterruptedException {
> >                final SnapshotDeletionPolicy policy =3D new
> > SnapshotDeletionPolicy(new KeepOnlyLastCommitDeletionPolicy());
> >                final IndexBackup backup =3D new IndexBackup(policy, new
> > File("backup"));
> >                for (int i =3D 0; i < 3; i++) {
> >                        index(policy, backup);
> >                }
> >        }
> >
> >        private static void index(final SnapshotDeletionPolicy policy,
> final
> > IndexBackup backup) throws CorruptIndexException,
> >                        LockObtainFailedException, IOException {
> >                IndexWriter writer =3D null;
> >                try {
> >                        FSDirectory.setDisableLocks(true);
> >                        writer =3D new
> > IndexWriter(FSDirectory.getDirectory("index"), new StandardAnalyzer(),
> > policy,
> >                                        MaxFieldLength.UNLIMITED);
> >
> >                        System.out.println("Star: " +
> > backup.willBackupFromNowOn());
> >
> >                        for (int i =3D 0; i < 10000; i++) {
> >                                final Document document =3D new Document=
();
> >                                document.add(new Field("content", "conte=
nt
> > content content content", Store.YES, Index.ANALYZED));
> >                                writer.addDocument(document);
> >                        }
> >                } finally {
> >                        if (writer !=3D null) {
> >                                writer.close();
> >                        }
> >
> >                        System.out.println("Backup: " + backup.backup())=
;
> >
> >                        // Remove this and the backup works fine
> >                        optimize(policy);
> >                }
> >        }
> >
> >        private static void optimize(final SnapshotDeletionPolicy policy=
)
> > throws CorruptIndexException, LockObtainFailedException,
> >                        IOException {
> >
> >                IndexWriter writer =3D null;
> >                try {
> >                        writer =3D new
> > IndexWriter(FSDirectory.getDirectory("index"), new StandardAnalyzer(),
> > policy,
> >                                        MaxFieldLength.UNLIMITED);
> >                        writer.optimize();
> >                } finally {
> >                        writer.close();
> >                }
> >        }
> >
> >
> > On Fri, Aug 14, 2009 at 4:37 PM, Shai Erera <serera@gmail.com> wrote:
> >
> >> I think you should also delete files that don't exist anymore in the
> index,
> >> from the backup?
> >>
> >> Shai
> >>
> >> On Fri, Aug 14, 2009 at 10:02 PM, Michael McCandless <
> >> lucene@mikemccandless.com> wrote:
> >>
> >> > Could you boil this down to a small standalone program showing the
> >> problem?
> >> >
> >> > Optimizing in between backups should be completely fine.
> >> >
> >> > Mike
> >> >
> >> > On Fri, Aug 14, 2009 at 2:47 PM, Lucas Naz=E1rio dos
> >> > Santos<nazario.lucas@gmail.com> wrote:
> >> > > Hi,
> >> > >
> >> > > I'm using the SnapshotDeletionPolicy class to backup my index. I
> >> > basically
> >> > > call the snapshot() method from the class SnapshotDeletionPolicy a=
t
> >> some
> >> > > point, get a list of files that changed, copy then to the backup
> >> folder,
> >> > and
> >> > > finish by calling the release() method.
> >> > >
> >> > > The problem arises when, in between backups, I optimize the index =
by
> >> > opening
> >> > > it with the IndexWriter class and calling the optimize() method.
> When I
> >> > > don't optimize in between backups, here is what happens:
> >> > >
> >> > > The first backup copies the segment composed by the files _0.cfs a=
nd
> >> > > segments_2. The second backup copies the files _1.cfs and
> segments_3,
> >> and
> >> > > the third backup copies the files _2.cfs e segments_4. I can open
> the
> >> > backup
> >> > > folder with Luke without problems.
> >> > >
> >> > > When I do optimize in between backups, the copies are as follow:
> >> > >
> >> > > The first backup copies the segment composed by the files _0.cfs a=
nd
> >> > > segments_2. The second backup copies the files _1.cfs and
> segments_3,
> >> and
> >> > > the third backup copies the files _3.cfs e segments_5. In this cas=
e,
> >> when
> >> > I
> >> > > try to open the backup folder, Luke gives a message saying that it
> >> can't
> >> > > find the file _2.cfs.
> >> > >
> >> > > My question is: how can I backup my index using the
> >> > SnapshotDeletionPolicy
> >> > > and having to optimize the index in between backups? Am I using th=
e
> >> right
> >> > > backup strategy?
> >> > >
> >> > > Thanks,
> >> > > Lucas
> >> > >
> >> >
> >> > --------------------------------------------------------------------=
-
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >> >
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e648f4b245bedf047155f9d6--

From java-user-return-41914-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 17 14:05:25 2009
Return-Path: <java-user-return-41914-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30803 invoked from network); 17 Aug 2009 14:05:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Aug 2009 14:05:25 -0000
Received: (qmail 91726 invoked by uid 500); 17 Aug 2009 14:05:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91661 invoked by uid 500); 17 Aug 2009 14:05:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91651 invoked by uid 99); 17 Aug 2009 14:05:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 14:05:29 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [216.82.241.99] (HELO mail51.messagelabs.com) (216.82.241.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 14:05:17 +0000
X-VirusChecked: Checked
X-Env-Sender: chris@emaildatasource.com
X-Msg-Ref: server-15.tower-51.messagelabs.com!1250517896!4120661!1
X-StarScan-Version: 6.1.3; banners=-,-,-
X-Originating-IP: [216.254.75.243]
Received: (qmail 28840 invoked from network); 17 Aug 2009 14:04:56 -0000
Received: from dsl254-075-243.nyc1.dsl.speakeasy.net (HELO int02-ny1.corp.emaildatasource.com) (216.254.75.243)
  by server-15.tower-51.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 17 Aug 2009 14:04:56 -0000
Received: from eds-mail01.eds.emaildatasource.com (smtp.corp.emaildatasource.com [216.254.75.147] (may be forged))
	by int02-ny1.corp.emaildatasource.com (8.13.5/8.13.1) with ESMTP id n7HE4t64020927
	for <java-user@lucene.apache.org>; Mon, 17 Aug 2009 14:04:55 GMT
Content-class: urn:content-classes:message
Subject: IndexSearcher.search Behavior
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Date: Mon, 17 Aug 2009 14:04:53 -0000
Message-ID: <A89AADF947D6F248AC92914A50378572DCF546@eds-mail01.eds.emaildatasource.com.>
X-MimeOLE: Produced By Microsoft Exchange V6.5
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: IndexSearcher.search Behavior
Thread-Index: AcofQ7FpxwVEQ7PxRdGVnTUJjVJUcQ==
From: "Chris Adams" <chris@emaildatasource.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

I'm not extremely familiar with Lucene, so I am confused at why the
following behavior is happening:
=20
When I build up a BooleanQuery using the Lucene objects (combination of
RangeQueries, TermQuery, etc.) I am getting a different result than when
I do a QueryParser.parse(queryString).
=20
The BooleanQuery that I build up produces the following output:

String queryString =3D baseQuery.toString();
Output: +date_received:[20030301 TO 20090913] +type:O24337
+(site_domains_reversed:moc.rettiwt site_domains_reversed:moc.rettiwt.*)

Hits results =3D indexSearcher.search(baseQuery);
Output: results.length =3D 0

-------------
However, if I do the following, I get results:
QueryParser stringParser =3D new QueryParser(LUCENE_SEARCH_FIELD,
PuntEmailIndexHelper.getAnalyzer());
Query parsedQuery =3D stringParser.parse(baseQuery.toString());
Hits results =3D indexSearcher.search(parsedQuery);
Output: results.length =3D 3

My question is, why are the results different?? The query in both cases
is the same, the only difference is that one was "built-up" while the
other one was "parsed" based upon the .toString() method of the built-up
query...

Hopefully, this is making sense and someone can explain why the results
are different.

Thanks for your help.

Chris Adams
Senior Software Engineer

Email Data Source, Inc.
816-448-2045=20
chris@emaildatasource.com

EmailDataSource.com <http://www.emaildatasource.com/>   | 5 of the top
20 internet retailers use Email Data Source


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41915-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 17 14:09:59 2009
Return-Path: <java-user-return-41915-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33328 invoked from network); 17 Aug 2009 14:09:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Aug 2009 14:09:59 -0000
Received: (qmail 99008 invoked by uid 500); 17 Aug 2009 14:10:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98934 invoked by uid 500); 17 Aug 2009 14:10:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98911 invoked by uid 99); 17 Aug 2009 14:10:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 14:10:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.217.216 as permitted sender)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 14:09:49 +0000
Received: by gxk12 with SMTP id 12so4103834gxk.4
        for <java-user@lucene.apache.org>; Mon, 17 Aug 2009 07:09:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=pJM5xVXmjAer6XODhoZw4Ez1H0+5J/bm4NKQUVtwe3A=;
        b=ZALY7iCRSwtmKZ6SowvCJuRlt+21LAqfSn4uX4Rw9f5L9IYM+8nzB1hNYE8a1IjkDh
         MniAiI+b3aob+MawLSoU55XO5EfuJ44rB5pK+nrnX349jvvfZo8oRC1EUapthprWqc3j
         amLyx3hvo3MR3qBleaTsuH9fep6FaMg9BNY04=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=got9CiuL5vFvzOLwuh6QLVmXjgp3s+UGQ1v7P8AUl6SURL/SZD8YnJEflswkCp7fJt
         g2IJU11APDh9IAAdP8Xll8OZF9ULS0A33MV5pg1xPWncdUTWobfijKhAbIkXqnD9+kKk
         tm2ZVosfyncWm1TZhnQIhyuVRyUM38kEIugQc=
Received: by 10.90.127.20 with SMTP id z20mr2808100agc.118.1250518168285;
        Mon, 17 Aug 2009 07:09:28 -0700 (PDT)
Received: from ?192.168.1.106? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 10sm6781784agd.73.2009.08.17.07.09.27
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 17 Aug 2009 07:09:27 -0700 (PDT)
Message-ID: <4A896497.4060709@gmail.com>
Date: Mon, 17 Aug 2009 10:09:27 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.22 (X11/20090804)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: IndexSearcher.search Behavior
References: <A89AADF947D6F248AC92914A50378572DCF546@eds-mail01.eds.emaildatasource.com.>
In-Reply-To: <A89AADF947D6F248AC92914A50378572DCF546@eds-mail01.eds.emaildatasource.com.>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Unfortunately, many Query's toString output is not actually parsable by 
QueryParser (though some are).  If you look at the result Query object 
that gets built from the toString output, its likely different than the 
BooleanQuery you are putting together.


-- 
- Mark

http://www.lucidimagination.com



Chris Adams wrote:
> I'm not extremely familiar with Lucene, so I am confused at why the
> following behavior is happening:
>  
> When I build up a BooleanQuery using the Lucene objects (combination of
> RangeQueries, TermQuery, etc.) I am getting a different result than when
> I do a QueryParser.parse(queryString).
>  
> The BooleanQuery that I build up produces the following output:
>
> String queryString = baseQuery.toString();
> Output: +date_received:[20030301 TO 20090913] +type:O24337
> +(site_domains_reversed:moc.rettiwt site_domains_reversed:moc.rettiwt.*)
>
> Hits results = indexSearcher.search(baseQuery);
> Output: results.length = 0
>
> -------------
> However, if I do the following, I get results:
> QueryParser stringParser = new QueryParser(LUCENE_SEARCH_FIELD,
> PuntEmailIndexHelper.getAnalyzer());
> Query parsedQuery = stringParser.parse(baseQuery.toString());
> Hits results = indexSearcher.search(parsedQuery);
> Output: results.length = 3
>
> My question is, why are the results different?? The query in both cases
> is the same, the only difference is that one was "built-up" while the
> other one was "parsed" based upon the .toString() method of the built-up
> query...
>
> Hopefully, this is making sense and someone can explain why the results
> are different.
>
> Thanks for your help.
>
> Chris Adams
> Senior Software Engineer
>
> Email Data Source, Inc.
> 816-448-2045 
> chris@emaildatasource.com
>
> EmailDataSource.com <http://www.emaildatasource.com/>   | 5 of the top
> 20 internet retailers use Email Data Source
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41916-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 17 15:14:48 2009
Return-Path: <java-user-return-41916-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61557 invoked from network); 17 Aug 2009 15:14:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Aug 2009 15:14:48 -0000
Received: (qmail 30729 invoked by uid 500); 17 Aug 2009 15:14:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30678 invoked by uid 500); 17 Aug 2009 15:14:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30668 invoked by uid 99); 17 Aug 2009 15:14:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 15:14:52 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [216.82.249.131] (HELO mail28.messagelabs.com) (216.82.249.131)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 15:14:37 +0000
X-VirusChecked: Checked
X-Env-Sender: chris@emaildatasource.com
X-Msg-Ref: server-2.tower-28.messagelabs.com!1250522045!30752133!1
X-StarScan-Version: 6.1.3; banners=-,-,-
X-Originating-IP: [216.254.75.243]
Received: (qmail 23265 invoked from network); 17 Aug 2009 15:14:13 -0000
Received: from dsl254-075-243.nyc1.dsl.speakeasy.net (HELO int02-ny1.corp.emaildatasource.com) (216.254.75.243)
  by server-2.tower-28.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 17 Aug 2009 15:14:13 -0000
Received: from eds-mail01.eds.emaildatasource.com (smtp.corp.emaildatasource.com [216.254.75.147] (may be forged))
	by int02-ny1.corp.emaildatasource.com (8.13.5/8.13.1) with ESMTP id n7HFE0is006674
	for <java-user@lucene.apache.org>; Mon, 17 Aug 2009 15:14:03 GMT
Content-class: urn:content-classes:message
Subject: RE: IndexSearcher.search Behavior
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Date: Mon, 17 Aug 2009 15:13:59 -0000
Message-ID: <A89AADF947D6F248AC92914A50378572DCF568@eds-mail01.eds.emaildatasource.com.>
X-MimeOLE: Produced By Microsoft Exchange V6.5
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: IndexSearcher.search Behavior
Thread-Index: AcofRG0Dzcu02Gm8TRqvaZszJFugzwACJtKw
References: <A89AADF947D6F248AC92914A50378572DCF546@eds-mail01.eds.emaildatasource.com.> <4A896497.4060709@gmail.com>
From: "Chris Adams" <chris@emaildatasource.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks, Mark. That info helped tremendously.=20

The problem in my case was that the parse(querystring) was using our
custom analyzer when parsing the entire string, where as the
BooleanObject that was being putting together wasn't using our custom
analyzer for one of the terms when it should have been.

Thanks again.=20

-----Original Message-----
From: Mark Miller [mailto:markrmiller@gmail.com]=20
Sent: Monday, August 17, 2009 9:09 AM
To: java-user@lucene.apache.org
Subject: Re: IndexSearcher.search Behavior

Unfortunately, many Query's toString output is not actually parsable by
QueryParser (though some are).  If you look at the result Query object
that gets built from the toString output, its likely different than the
BooleanQuery you are putting together.


--
- Mark

http://www.lucidimagination.com



Chris Adams wrote:
> I'm not extremely familiar with Lucene, so I am confused at why the=20
> following behavior is happening:
> =20
> When I build up a BooleanQuery using the Lucene objects (combination=20
> of RangeQueries, TermQuery, etc.) I am getting a different result than

> when I do a QueryParser.parse(queryString).
> =20
> The BooleanQuery that I build up produces the following output:
>
> String queryString =3D baseQuery.toString();
> Output: +date_received:[20030301 TO 20090913] +type:O24337
> +(site_domains_reversed:moc.rettiwt=20
> +site_domains_reversed:moc.rettiwt.*)
>
> Hits results =3D indexSearcher.search(baseQuery);
> Output: results.length =3D 0
>
> -------------
> However, if I do the following, I get results:
> QueryParser stringParser =3D new QueryParser(LUCENE_SEARCH_FIELD,=20
> PuntEmailIndexHelper.getAnalyzer());
> Query parsedQuery =3D stringParser.parse(baseQuery.toString());
> Hits results =3D indexSearcher.search(parsedQuery);
> Output: results.length =3D 3
>
> My question is, why are the results different?? The query in both=20
> cases is the same, the only difference is that one was "built-up"=20
> while the other one was "parsed" based upon the .toString() method of=20
> the built-up query...
>
> Hopefully, this is making sense and someone can explain why the=20
> results are different.
>
> Thanks for your help.
>
> Chris Adams
> Senior Software Engineer
>
> Email Data Source, Inc.
> 816-448-2045
> chris@emaildatasource.com
>
> EmailDataSource.com <http://www.emaildatasource.com/>   | 5 of the top
> 20 internet retailers use Email Data Source
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>  =20





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41917-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 17 18:49:06 2009
Return-Path: <java-user-return-41917-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64062 invoked from network); 17 Aug 2009 18:49:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Aug 2009 18:49:06 -0000
Received: (qmail 6871 invoked by uid 500); 17 Aug 2009 18:49:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6786 invoked by uid 500); 17 Aug 2009 18:49:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6776 invoked by uid 99); 17 Aug 2009 18:49:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 18:49:10 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.226 as permitted sender)
Received: from [209.85.219.226] (HELO mail-ew0-f226.google.com) (209.85.219.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Aug 2009 18:49:02 +0000
Received: by ewy26 with SMTP id 26so3289187ewy.5
        for <java-user@lucene.apache.org>; Mon, 17 Aug 2009 11:48:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=aLYXGzL3l0Ol6folT+QTXGWIS0l3YRSo6m+tRIT7kh4=;
        b=Cdbf3S74zJcav3dmAapr9eYMjD70w17YAep6cn+itr2n08W3CMYStwTcWNAnO/vTQn
         yST8hPC26TKQ+JFM4DMydkXUPSO/OJ4jxmp28eBWo11gPnv8q2zYnlKCJnGE43y/dmQL
         PhDyQke3hS9KPj4e1XeYdryNB+j6wranyTs84=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=nhWEs2ABrOsUCH41Cr3DIc/LLqBLN1SPfZmYOKc1dGJbUTrOnw4TYO4OgQUxNQyLQ3
         +5NITphgy7GfnV3R9L/uAfTiz0z36mhnpd6xaq2duogZCSd5h5ArfVc73zAkO/DkNn8d
         2RChcVSmlwaoAwc+BNo4EhmPeGRDhOI0jnvXI=
MIME-Version: 1.0
Received: by 10.216.55.208 with SMTP id k58mr1098506wec.9.1250534919218; Mon, 
	17 Aug 2009 11:48:39 -0700 (PDT)
In-Reply-To: <3ca1516d0908170559h241a3524x529eb2241ac853c9@mail.gmail.com>
References: <3ca1516d0908141147i1baf7af2yf15bcf69d4af77dc@mail.gmail.com>
	 <9ac0c6aa0908141202v677039a3g863e83022675220e@mail.gmail.com>
	 <786fde50908141237l590c017ej7ff1e2d68929622c@mail.gmail.com>
	 <3ca1516d0908141355u65b5027rc4892f5c54f16b79@mail.gmail.com>
	 <9ac0c6aa0908141605v72fbc559qb41a9576f0cc64d7@mail.gmail.com>
	 <3ca1516d0908170559h241a3524x529eb2241ac853c9@mail.gmail.com>
Date: Mon, 17 Aug 2009 21:48:39 +0300
Message-ID: <786fde50908171148k7c06c952q2c96ccb37236fc87@mail.gmail.com>
Subject: Re: Problem doing backup using the SnapshotDeletionPolicy class
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00504502e2a0a3a66404715ad9d2
X-Virus-Checked: Checked by ClamAV on apache.org

--00504502e2a0a3a66404715ad9d2
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

The way I'd do the backups is by having a background thread that is
scheduled to run every X hours/days (depends on how frequent you want to do
the backups) and when it wakes it:
1) Creates a SnapshotDeletionPolicy and retrieve the file names.
2) Lists the files in the backup folder.
3) Copies the files from (1) that do not appear in (2).
4) Delete the files in (2) that do not appear in (1) --> that deletes
segments that do not exist anymore.

But that is because I want to do the backups while the system is up and
running, and indexing and search operations occur.

>From what you describe below, you index in batches and then indexing stops.
So you can just do a directory listing (after everything stops - indexing,
optimize ...) and basically repeat steps (2) - (4) from above, I think.

Hope this helps,
Shai

On Mon, Aug 17, 2009 at 3:59 PM, Lucas Naz=E1rio dos Santos <
nazario.lucas@gmail.com> wrote:

> Thanks Mike.
>
> I'm using Windows XP with Java 1.6.0 and Lucene 2.4.1.
>
> I don't know if I'm using the right backup strategy. I have an indexing
> process that happens from time to time and the index is getting every day
> bigger. Hence, copying all the index every time as a backup strategy is
> becoming a painful, endless activity. Giving this scenario, I wouldn't li=
ke
> to copy the entire index each time I do backup, but only the difference
> from
> the previous backup. Here is the plan:
>
> 1. Create an index writer;
> 2. Take a snapshot to prevent existing files from changing;
> 3. Start indexing until no more documents to be indexed exist;
> 4. Retrieve a list of index files that didn't change with
> this.snapshotDeletionPolicy.snapshot().getFileNames();
> 5. Copy all other files inside the index folder that not those retrieved =
in
> step 4 to the backup directory;
> 6. Optimize and close the index.
>
> I really don't know if what I'm doing is the best approach to my problem.=
 I
> believe that people use the SnapshotDeletionPolicy to copy all the index =
up
> to the last commit. I want to copy only the difference since last backup.
>
> What I'm thinking about doing now is to index in a new directory at every
> indexing iteration, copy this index to the backup folder and merge it wit=
h
> the main index afterwards.
>
> What do you guys think I should do?
>
> Lucas
>
>
>
> On Fri, Aug 14, 2009 at 8:05 PM, Michael McCandless <
> lucene@mikemccandless.com> wrote:
>
> > Alas I don't see it failing, with the optimize left in.  Which exact
> > rev of 2.9 are you testing with?  Which OS/filesystem/JRE?
> >
> > I realize this is just a test so what follows may not apply to your
> > "real" usage of SnapshotDeletionPolicy...:
> >
> > Since you're closing the writer before taking the backup, there's no
> > need to even use SnapshotDeletionPolicy (you can just copy all files
> > you find in the index).
> >
> > SnapshotDeletionPolicy's purpose is to enable taking backups while an
> > IndexWriter is still open & making ongoing changes to the index, ie a
> > "hot backup".
> >
> > Finally, you're taking the snapshot before doing any indexing... which
> > means your backup will only reflect the index as of the last commit
> > before you did indexing.
> >
> > Mike
> >
> > On Fri, Aug 14, 2009 at 4:55 PM, Lucas Naz=E1rio dos
> > Santos<nazario.lucas@gmail.com> wrote:
> > > Not as small as I would like, but shows the problem.
> > >
> > > If you remove the statement
> > >
> > > // Remove this and the backup works fine
> > > optimize(policy);
> > >
> > > the backup works wonderfully.
> > >
> > > (More code in the next e-mail)
> > >
> > > Lucas
> > >
> > >
> > >        public static void main(final String[] args) throws
> > > CorruptIndexException, IOException, InterruptedException {
> > >                final SnapshotDeletionPolicy policy =3D new
> > > SnapshotDeletionPolicy(new KeepOnlyLastCommitDeletionPolicy());
> > >                final IndexBackup backup =3D new IndexBackup(policy, n=
ew
> > > File("backup"));
> > >                for (int i =3D 0; i < 3; i++) {
> > >                        index(policy, backup);
> > >                }
> > >        }
> > >
> > >        private static void index(final SnapshotDeletionPolicy policy,
> > final
> > > IndexBackup backup) throws CorruptIndexException,
> > >                        LockObtainFailedException, IOException {
> > >                IndexWriter writer =3D null;
> > >                try {
> > >                        FSDirectory.setDisableLocks(true);
> > >                        writer =3D new
> > > IndexWriter(FSDirectory.getDirectory("index"), new StandardAnalyzer()=
,
> > > policy,
> > >                                        MaxFieldLength.UNLIMITED);
> > >
> > >                        System.out.println("Star: " +
> > > backup.willBackupFromNowOn());
> > >
> > >                        for (int i =3D 0; i < 10000; i++) {
> > >                                final Document document =3D new
> Document();
> > >                                document.add(new Field("content",
> "content
> > > content content content", Store.YES, Index.ANALYZED));
> > >                                writer.addDocument(document);
> > >                        }
> > >                } finally {
> > >                        if (writer !=3D null) {
> > >                                writer.close();
> > >                        }
> > >
> > >                        System.out.println("Backup: " +
> backup.backup());
> > >
> > >                        // Remove this and the backup works fine
> > >                        optimize(policy);
> > >                }
> > >        }
> > >
> > >        private static void optimize(final SnapshotDeletionPolicy
> policy)
> > > throws CorruptIndexException, LockObtainFailedException,
> > >                        IOException {
> > >
> > >                IndexWriter writer =3D null;
> > >                try {
> > >                        writer =3D new
> > > IndexWriter(FSDirectory.getDirectory("index"), new StandardAnalyzer()=
,
> > > policy,
> > >                                        MaxFieldLength.UNLIMITED);
> > >                        writer.optimize();
> > >                } finally {
> > >                        writer.close();
> > >                }
> > >        }
> > >
> > >
> > > On Fri, Aug 14, 2009 at 4:37 PM, Shai Erera <serera@gmail.com> wrote:
> > >
> > >> I think you should also delete files that don't exist anymore in the
> > index,
> > >> from the backup?
> > >>
> > >> Shai
> > >>
> > >> On Fri, Aug 14, 2009 at 10:02 PM, Michael McCandless <
> > >> lucene@mikemccandless.com> wrote:
> > >>
> > >> > Could you boil this down to a small standalone program showing the
> > >> problem?
> > >> >
> > >> > Optimizing in between backups should be completely fine.
> > >> >
> > >> > Mike
> > >> >
> > >> > On Fri, Aug 14, 2009 at 2:47 PM, Lucas Naz=E1rio dos
> > >> > Santos<nazario.lucas@gmail.com> wrote:
> > >> > > Hi,
> > >> > >
> > >> > > I'm using the SnapshotDeletionPolicy class to backup my index. I
> > >> > basically
> > >> > > call the snapshot() method from the class SnapshotDeletionPolicy
> at
> > >> some
> > >> > > point, get a list of files that changed, copy then to the backup
> > >> folder,
> > >> > and
> > >> > > finish by calling the release() method.
> > >> > >
> > >> > > The problem arises when, in between backups, I optimize the inde=
x
> by
> > >> > opening
> > >> > > it with the IndexWriter class and calling the optimize() method.
> > When I
> > >> > > don't optimize in between backups, here is what happens:
> > >> > >
> > >> > > The first backup copies the segment composed by the files _0.cfs
> and
> > >> > > segments_2. The second backup copies the files _1.cfs and
> > segments_3,
> > >> and
> > >> > > the third backup copies the files _2.cfs e segments_4. I can ope=
n
> > the
> > >> > backup
> > >> > > folder with Luke without problems.
> > >> > >
> > >> > > When I do optimize in between backups, the copies are as follow:
> > >> > >
> > >> > > The first backup copies the segment composed by the files _0.cfs
> and
> > >> > > segments_2. The second backup copies the files _1.cfs and
> > segments_3,
> > >> and
> > >> > > the third backup copies the files _3.cfs e segments_5. In this
> case,
> > >> when
> > >> > I
> > >> > > try to open the backup folder, Luke gives a message saying that =
it
> > >> can't
> > >> > > find the file _2.cfs.
> > >> > >
> > >> > > My question is: how can I backup my index using the
> > >> > SnapshotDeletionPolicy
> > >> > > and having to optimize the index in between backups? Am I using
> the
> > >> right
> > >> > > backup strategy?
> > >> > >
> > >> > > Thanks,
> > >> > > Lucas
> > >> > >
> > >> >
> > >> >
> ---------------------------------------------------------------------
> > >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >> >
> > >> >
> > >>
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--00504502e2a0a3a66404715ad9d2--

From java-user-return-41918-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 18 01:31:51 2009
Return-Path: <java-user-return-41918-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18236 invoked from network); 18 Aug 2009 01:31:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Aug 2009 01:31:51 -0000
Received: (qmail 20429 invoked by uid 500); 18 Aug 2009 01:32:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20362 invoked by uid 500); 18 Aug 2009 01:32:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20352 invoked by uid 99); 18 Aug 2009 01:32:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 01:32:08 +0000
X-ASF-Spam-Status: No, hits=2.1 required=10.0
	tests=DNS_FROM_RFC_BOGUSMX,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of micah@affinitycircles.com designates 207.7.158.80 as permitted sender)
Received: from [207.7.158.80] (HELO boom.affinityengines.com) (207.7.158.80)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 01:31:57 +0000
Received: from shiny.affinitycircles.local (h-64-105-88-158.affinitycircles.com [64.105.88.158])
	by boom.affinityengines.com (Postfix) with ESMTP id 7585B1DB121
	for <java-user@lucene.apache.org>; Mon, 17 Aug 2009 18:31:34 -0700 (PDT)
Message-Id: <13A42DBE-C3BA-4B77-B41A-946B960C05C7@affinitycircles.com>
From: Micah Jaffe <micah@affinitycircles.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Bizarre indexing issue where thousands of files get created
Date: Mon, 17 Aug 2009 18:31:34 -0700
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

The Problem: periodically we see thousands of files get created from  
an IndexWriter in a Java process in a very short period of time.   
Since we started trying to track this, we saw an index go from ~25  
files to over 200K files in about a half hour.

The Context: a hand-rolled, all-in-one Lucene server (2.3.2 codebase)  
that can respond to searches and perform index updates, running under  
Tomcat, on Java 1.6 on 32-bit Linux using 2GB of memory, reading/ 
writing to local disk.  This is a threaded environment where we're  
serving about 15-20/requests a second (mostly searches, with a 10:1  
search/update ratio).  We wrap all of the update code around  
IndexWriter to make sure all threads are only ever using one writer  
and never close an actively used writer.  We cache about 40  
IndexSearchers (really IndexReaders) using an MRU cache and leave it  
to Java to garbage collect those that leave scope.  We can potentially  
serve ~150 different search indexes, most with document count under 1  
million, with fairly sparsely populated fields and under about 100  
fields.  We do not store a lot of information in any index, generally  
just IDs that we then use for DB look-ups.  Our biggest index is about  
7GB on disk and comprises roughly 18 million records and is almost  
always in use (either searched or updated).  We sometimes go days  
without seeing the The Problem and we've seen it happen twice in the  
span of 4 hours.

Accompanying Symptom: we see an OOM error where we do not have enough  
heap space.  I'm not sure if the explosion of files triggers or  
results from the error.  This is the only error we see accompanying  
the problem; performance and memory usage seem fine up to the OOM error.

Current Workaround: taking the same server to a 64-bit machine and  
throwing 10GB of RAM at it seems (4 days counting now) to have  
"solved" the problem.

What I'd really like is to understand the underlying problem, and we  
have some theories, but before charging down one way or another I was  
hoping to get an idea if a) people have seen something similar before  
and b) what they did.  Our theories:
- Opening IndexReaders faster than Java can garbage collect those that  
are out of scope.  We do know that too many open readers (e.g. around  
100 of our indexes) can exhaust memory.  This scenario seems unlikely  
given our usage; we have 2-3 heavily used indexes and very light usage  
on the rest.  That said, the with some recent code changes we decided  
to rely on garbage collection to fix another bug (race condition where  
a searcher was being used as it was being closed).
- Hit a race condition with IndexWriter, with our code or in this  
version of the library, and it goes nuts.
- Particular heavy-duty search/update hits, e.g. potentially iterating  
across all documents (not likely) or updating a large number of  
documents in an index (more likely).

Really scientific, I know, but I'd welcome any discussion that  
involves juggling Java heap (what do you do with your OOMs?), our  
particular problem or a threaded environment using Lucene (like Solr).

thanks!
Micah

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41919-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 18 06:41:22 2009
Return-Path: <java-user-return-41919-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49208 invoked from network); 18 Aug 2009 06:41:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Aug 2009 06:41:21 -0000
Received: (qmail 3183 invoked by uid 500); 18 Aug 2009 06:41:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3097 invoked by uid 500); 18 Aug 2009 06:41:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3087 invoked by uid 99); 18 Aug 2009 06:41:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 06:41:36 +0000
X-ASF-Spam-Status: No, hits=4.3 required=10.0
	tests=HTML_MESSAGE,MSGID_FROM_MTA_HEADER,SPF_SOFTFAIL
X-Spam-Check-By: apache.org
Received-SPF: softfail (nike.apache.org: transitioning domain of lucene@searchblox.com does not designate 62.24.128.243 as permitted sender)
Received: from [62.24.128.243] (HELO ttsmtp.cpwnetworks.com) (62.24.128.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 06:41:23 +0000
Message-Id: <7tslsh$363n1h@ttsmtp.cpwnetworks.com>
X-Path: TalkTalk-smtp
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: AqQEABfqiUpZ89cd/2dsb2JhbACCKivZYwU
Received: from unknown (HELO taurus2) ([89.243.215.29])
  by ttsmtp.cpwnetworks.com with ESMTP; 18 Aug 2009 07:41:03 +0100
Reply-To: <lucene@searchblox.com>
From: "Lucene" <lucene@searchblox.com>
To: <java-user@lucene.apache.org>
Subject:  [ANN] SearchBlox announces UNLIMITED Edition
Date: Tue, 18 Aug 2009 07:41:04 +0100
Organization: SearchBlox Software, Inc.
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0016_01CA1FD7.3D9057E0"
X-Mailer: Microsoft Office Outlook, Build 11.0.5510
X-MimeOLE: Produced By Microsoft MimeOLE V6.0.6001.18049
Thread-Index: AcofztuVkDDr1W1KTP+bc1lda2UZKg==
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_0016_01CA1FD7.3D9057E0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

The SearchBlox Team is pleased to announce the availability of SearchBlox
UNLIMITED Edition of its Lucene-based Search Software.

 

The UNLIMITED Edition allows indexing of unlimited number of documents and
provides for unlimited number of development and deployment licenses to the
licensee for an annual subscription. 

The annual subscription also covers product support and upgrades to the
latest versions of the software during the subscription period.

 

SearchBlox is an integrated Enterprise Search product incorporating Lucene
and includes:

 

- Web/RSS/File Crawlers

- Web Admin Console for Server Management

- Indexes Popular File Formats including Office and PDF

- Multi-language Support

- Search Statistics Reporting 

 

More details of the product can be found at
http://www.searchblox.com/features.html

 

Regards,

 

The SearchBlox Team

SearchBlox Software, Inc.

http://www.searchblox.com <http://www.searchblox.com/> 

http://twitter.com/search_software

 

 

 

 


------=_NextPart_000_0016_01CA1FD7.3D9057E0--


From java-user-return-41920-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 18 11:35:35 2009
Return-Path: <java-user-return-41920-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59487 invoked from network); 18 Aug 2009 11:35:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Aug 2009 11:35:35 -0000
Received: (qmail 9739 invoked by uid 500); 18 Aug 2009 11:35:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9657 invoked by uid 500); 18 Aug 2009 11:35:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9647 invoked by uid 99); 18 Aug 2009 11:35:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 11:35:51 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 11:35:41 +0000
Received: by gxk12 with SMTP id 12so4983693gxk.4
        for <java-user@lucene.apache.org>; Tue, 18 Aug 2009 04:35:18 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.251.27 with SMTP id y27mr4859572ybh.340.1250595317977; 
	Tue, 18 Aug 2009 04:35:17 -0700 (PDT)
In-Reply-To: <13A42DBE-C3BA-4B77-B41A-946B960C05C7@affinitycircles.com>
References: <13A42DBE-C3BA-4B77-B41A-946B960C05C7@affinitycircles.com>
Date: Tue, 18 Aug 2009 07:35:17 -0400
Message-ID: <9ac0c6aa0908180435u44806ab7nefe92b6f028c2b3a@mail.gmail.com>
Subject: Re: Bizarre indexing issue where thousands of files get created
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Are you .close()ing your IndexReaders when they fall out of the MRU cache?

Seems like there are two problems... 1) why are you hitting OOMEs?
Seems likely you're just doing too much at once.... can you ask the
JRE to get you a heap dump when it hits OOME?

2) Why is IndexWriter creating zillions of tiny files?  This one is
a.... does the OOME pass through IndexWriter?  If you turn on
infoStream in your writer, get the problem to happen, and post back
the resulting output, it'll give us a better idea what's going on.
Could you also post a representative subset of these 200K filenames?
It sounds like somehow IndexWriter is getting stuck into a state where
it thinks it must flush segments far too frequently.

Mike

On Mon, Aug 17, 2009 at 9:31 PM, Micah Jaffe<micah@affinitycircles.com> wro=
te:
> The Problem: periodically we see thousands of files get created from an
> IndexWriter in a Java process in a very short period of time. =A0Since we
> started trying to track this, we saw an index go from ~25 files to over 2=
00K
> files in about a half hour.
>
> The Context: a hand-rolled, all-in-one Lucene server (2.3.2 codebase) tha=
t
> can respond to searches and perform index updates, running under Tomcat, =
on
> Java 1.6 on 32-bit Linux using 2GB of memory, reading/writing to local di=
sk.
> =A0This is a threaded environment where we're serving about 15-20/request=
s a
> second (mostly searches, with a 10:1 search/update ratio). =A0We wrap all=
 of
> the update code around IndexWriter to make sure all threads are only ever
> using one writer and never close an actively used writer. =A0We cache abo=
ut 40
> IndexSearchers (really IndexReaders) using an MRU cache and leave it to J=
ava
> to garbage collect those that leave scope. =A0We can potentially serve ~1=
50
> different search indexes, most with document count under 1 million, with
> fairly sparsely populated fields and under about 100 fields. =A0We do not
> store a lot of information in any index, generally just IDs that we then =
use
> for DB look-ups. =A0Our biggest index is about 7GB on disk and comprises
> roughly 18 million records and is almost always in use (either searched o=
r
> updated). =A0We sometimes go days without seeing the The Problem and we'v=
e
> seen it happen twice in the span of 4 hours.
>
> Accompanying Symptom: we see an OOM error where we do not have enough hea=
p
> space. =A0I'm not sure if the explosion of files triggers or results from=
 the
> error. =A0This is the only error we see accompanying the problem; perform=
ance
> and memory usage seem fine up to the OOM error.
>
> Current Workaround: taking the same server to a 64-bit machine and throwi=
ng
> 10GB of RAM at it seems (4 days counting now) to have "solved" the proble=
m.
>
> What I'd really like is to understand the underlying problem, and we have
> some theories, but before charging down one way or another I was hoping t=
o
> get an idea if a) people have seen something similar before and b) what t=
hey
> did. =A0Our theories:
> - Opening IndexReaders faster than Java can garbage collect those that ar=
e
> out of scope. =A0We do know that too many open readers (e.g. around 100 o=
f our
> indexes) can exhaust memory. =A0This scenario seems unlikely given our us=
age;
> we have 2-3 heavily used indexes and very light usage on the rest. =A0Tha=
t
> said, the with some recent code changes we decided to rely on garbage
> collection to fix another bug (race condition where a searcher was being
> used as it was being closed).
> - Hit a race condition with IndexWriter, with our code or in this version=
 of
> the library, and it goes nuts.
> - Particular heavy-duty search/update hits, e.g. potentially iterating
> across all documents (not likely) or updating a large number of documents=
 in
> an index (more likely).
>
> Really scientific, I know, but I'd welcome any discussion that involves
> juggling Java heap (what do you do with your OOMs?), our particular probl=
em
> or a threaded environment using Lucene (like Solr).
>
> thanks!
> Micah
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41921-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 18 13:52:01 2009
Return-Path: <java-user-return-41921-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15670 invoked from network); 18 Aug 2009 13:52:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Aug 2009 13:52:01 -0000
Received: (qmail 3652 invoked by uid 500); 18 Aug 2009 13:52:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3595 invoked by uid 500); 18 Aug 2009 13:52:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3585 invoked by uid 99); 18 Aug 2009 13:52:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 13:52:17 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of nazario.lucas@gmail.com designates 209.85.216.204 as permitted sender)
Received: from [209.85.216.204] (HELO mail-px0-f204.google.com) (209.85.216.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 13:52:06 +0000
Received: by pxi42 with SMTP id 42so1789997pxi.20
        for <java-user@lucene.apache.org>; Tue, 18 Aug 2009 06:51:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=kt7a1IZY/DbEFqiwDW7NWGlWtuq++YVgGOHDhkkn+38=;
        b=ZMxyPCVdbZGm9sGPWUKhmAtcMlr8D5FtCKM1mQD5qMl0Lo7z6F5dxC7llCrNc8GZbS
         2Z7rgD94dOdz7T2WdpzXisc+4V71gedo3xdVyZJ5TlZsU1Z2hA0Cm2837ax0DAPiNWg/
         SfqdAqaA7ZwI1yurpxxsINooMpeqk/aMKYXvw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=aPcf/A8rqnFMIWDJi1pQKCOTwKzgF7NCOvYMFYIy1J56xVlB+DY7Yfyi922szbrnKB
         SBYps7yqD2OAF3HyvJ/FFAUgBxcm7zYz7FBUi0OV9OJwjEl5dethi94f9jV3awFuM9Aq
         WUatP+REM+xxtqhuvNHrQALFkgT6iKKzlHkaQ=
MIME-Version: 1.0
Received: by 10.114.86.5 with SMTP id j5mr5419854wab.0.1250603505111; Tue, 18 
	Aug 2009 06:51:45 -0700 (PDT)
In-Reply-To: <786fde50908171148k7c06c952q2c96ccb37236fc87@mail.gmail.com>
References: <3ca1516d0908141147i1baf7af2yf15bcf69d4af77dc@mail.gmail.com>
	 <9ac0c6aa0908141202v677039a3g863e83022675220e@mail.gmail.com>
	 <786fde50908141237l590c017ej7ff1e2d68929622c@mail.gmail.com>
	 <3ca1516d0908141355u65b5027rc4892f5c54f16b79@mail.gmail.com>
	 <9ac0c6aa0908141605v72fbc559qb41a9576f0cc64d7@mail.gmail.com>
	 <3ca1516d0908170559h241a3524x529eb2241ac853c9@mail.gmail.com>
	 <786fde50908171148k7c06c952q2c96ccb37236fc87@mail.gmail.com>
Date: Tue, 18 Aug 2009 10:51:45 -0300
Message-ID: <3ca1516d0908180651s42cdb600k64f6dc8290411c11@mail.gmail.com>
Subject: Re: Problem doing backup using the SnapshotDeletionPolicy class
From: =?ISO-8859-1?Q?Lucas_Naz=E1rio_dos_Santos?= <nazario.lucas@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00504502e13bad53d604716ad1af
X-Virus-Checked: Checked by ClamAV on apache.org

--00504502e13bad53d604716ad1af
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Thanks, Shai.

After thinking a bit I don't believe that the SnapshotDeletionPolicy is the
best approach to my problem.

Because I do batch indexing, the final solution I came up with is to index
documents each time in a temporary folder, copy this temporary folder to a
backup directory after indexing, and merge it with a complete index to
maintain a unique structure. This way I can backup only the difference sinc=
e
last indexing took place.

Lucas



On Mon, Aug 17, 2009 at 3:48 PM, Shai Erera <serera@gmail.com> wrote:

> The way I'd do the backups is by having a background thread that is
> scheduled to run every X hours/days (depends on how frequent you want to =
do
> the backups) and when it wakes it:
> 1) Creates a SnapshotDeletionPolicy and retrieve the file names.
> 2) Lists the files in the backup folder.
> 3) Copies the files from (1) that do not appear in (2).
> 4) Delete the files in (2) that do not appear in (1) --> that deletes
> segments that do not exist anymore.
>
> But that is because I want to do the backups while the system is up and
> running, and indexing and search operations occur.
>
> From what you describe below, you index in batches and then indexing stop=
s.
> So you can just do a directory listing (after everything stops - indexing=
,
> optimize ...) and basically repeat steps (2) - (4) from above, I think.
>
> Hope this helps,
> Shai
>
> On Mon, Aug 17, 2009 at 3:59 PM, Lucas Naz=E1rio dos Santos <
> nazario.lucas@gmail.com> wrote:
>
> > Thanks Mike.
> >
> > I'm using Windows XP with Java 1.6.0 and Lucene 2.4.1.
> >
> > I don't know if I'm using the right backup strategy. I have an indexing
> > process that happens from time to time and the index is getting every d=
ay
> > bigger. Hence, copying all the index every time as a backup strategy is
> > becoming a painful, endless activity. Giving this scenario, I wouldn't
> like
> > to copy the entire index each time I do backup, but only the difference
> > from
> > the previous backup. Here is the plan:
> >
> > 1. Create an index writer;
> > 2. Take a snapshot to prevent existing files from changing;
> > 3. Start indexing until no more documents to be indexed exist;
> > 4. Retrieve a list of index files that didn't change with
> > this.snapshotDeletionPolicy.snapshot().getFileNames();
> > 5. Copy all other files inside the index folder that not those retrieve=
d
> in
> > step 4 to the backup directory;
> > 6. Optimize and close the index.
> >
> > I really don't know if what I'm doing is the best approach to my proble=
m.
> I
> > believe that people use the SnapshotDeletionPolicy to copy all the inde=
x
> up
> > to the last commit. I want to copy only the difference since last backu=
p.
> >
> > What I'm thinking about doing now is to index in a new directory at eve=
ry
> > indexing iteration, copy this index to the backup folder and merge it
> with
> > the main index afterwards.
> >
> > What do you guys think I should do?
> >
> > Lucas
> >
> >
> >
> > On Fri, Aug 14, 2009 at 8:05 PM, Michael McCandless <
> > lucene@mikemccandless.com> wrote:
> >
> > > Alas I don't see it failing, with the optimize left in.  Which exact
> > > rev of 2.9 are you testing with?  Which OS/filesystem/JRE?
> > >
> > > I realize this is just a test so what follows may not apply to your
> > > "real" usage of SnapshotDeletionPolicy...:
> > >
> > > Since you're closing the writer before taking the backup, there's no
> > > need to even use SnapshotDeletionPolicy (you can just copy all files
> > > you find in the index).
> > >
> > > SnapshotDeletionPolicy's purpose is to enable taking backups while an
> > > IndexWriter is still open & making ongoing changes to the index, ie a
> > > "hot backup".
> > >
> > > Finally, you're taking the snapshot before doing any indexing... whic=
h
> > > means your backup will only reflect the index as of the last commit
> > > before you did indexing.
> > >
> > > Mike
> > >
> > > On Fri, Aug 14, 2009 at 4:55 PM, Lucas Naz=E1rio dos
> > > Santos<nazario.lucas@gmail.com> wrote:
> > > > Not as small as I would like, but shows the problem.
> > > >
> > > > If you remove the statement
> > > >
> > > > // Remove this and the backup works fine
> > > > optimize(policy);
> > > >
> > > > the backup works wonderfully.
> > > >
> > > > (More code in the next e-mail)
> > > >
> > > > Lucas
> > > >
> > > >
> > > >        public static void main(final String[] args) throws
> > > > CorruptIndexException, IOException, InterruptedException {
> > > >                final SnapshotDeletionPolicy policy =3D new
> > > > SnapshotDeletionPolicy(new KeepOnlyLastCommitDeletionPolicy());
> > > >                final IndexBackup backup =3D new IndexBackup(policy,=
 new
> > > > File("backup"));
> > > >                for (int i =3D 0; i < 3; i++) {
> > > >                        index(policy, backup);
> > > >                }
> > > >        }
> > > >
> > > >        private static void index(final SnapshotDeletionPolicy polic=
y,
> > > final
> > > > IndexBackup backup) throws CorruptIndexException,
> > > >                        LockObtainFailedException, IOException {
> > > >                IndexWriter writer =3D null;
> > > >                try {
> > > >                        FSDirectory.setDisableLocks(true);
> > > >                        writer =3D new
> > > > IndexWriter(FSDirectory.getDirectory("index"), new
> StandardAnalyzer(),
> > > > policy,
> > > >                                        MaxFieldLength.UNLIMITED);
> > > >
> > > >                        System.out.println("Star: " +
> > > > backup.willBackupFromNowOn());
> > > >
> > > >                        for (int i =3D 0; i < 10000; i++) {
> > > >                                final Document document =3D new
> > Document();
> > > >                                document.add(new Field("content",
> > "content
> > > > content content content", Store.YES, Index.ANALYZED));
> > > >                                writer.addDocument(document);
> > > >                        }
> > > >                } finally {
> > > >                        if (writer !=3D null) {
> > > >                                writer.close();
> > > >                        }
> > > >
> > > >                        System.out.println("Backup: " +
> > backup.backup());
> > > >
> > > >                        // Remove this and the backup works fine
> > > >                        optimize(policy);
> > > >                }
> > > >        }
> > > >
> > > >        private static void optimize(final SnapshotDeletionPolicy
> > policy)
> > > > throws CorruptIndexException, LockObtainFailedException,
> > > >                        IOException {
> > > >
> > > >                IndexWriter writer =3D null;
> > > >                try {
> > > >                        writer =3D new
> > > > IndexWriter(FSDirectory.getDirectory("index"), new
> StandardAnalyzer(),
> > > > policy,
> > > >                                        MaxFieldLength.UNLIMITED);
> > > >                        writer.optimize();
> > > >                } finally {
> > > >                        writer.close();
> > > >                }
> > > >        }
> > > >
> > > >
> > > > On Fri, Aug 14, 2009 at 4:37 PM, Shai Erera <serera@gmail.com>
> wrote:
> > > >
> > > >> I think you should also delete files that don't exist anymore in t=
he
> > > index,
> > > >> from the backup?
> > > >>
> > > >> Shai
> > > >>
> > > >> On Fri, Aug 14, 2009 at 10:02 PM, Michael McCandless <
> > > >> lucene@mikemccandless.com> wrote:
> > > >>
> > > >> > Could you boil this down to a small standalone program showing t=
he
> > > >> problem?
> > > >> >
> > > >> > Optimizing in between backups should be completely fine.
> > > >> >
> > > >> > Mike
> > > >> >
> > > >> > On Fri, Aug 14, 2009 at 2:47 PM, Lucas Naz=E1rio dos
> > > >> > Santos<nazario.lucas@gmail.com> wrote:
> > > >> > > Hi,
> > > >> > >
> > > >> > > I'm using the SnapshotDeletionPolicy class to backup my index.=
 I
> > > >> > basically
> > > >> > > call the snapshot() method from the class SnapshotDeletionPoli=
cy
> > at
> > > >> some
> > > >> > > point, get a list of files that changed, copy then to the back=
up
> > > >> folder,
> > > >> > and
> > > >> > > finish by calling the release() method.
> > > >> > >
> > > >> > > The problem arises when, in between backups, I optimize the
> index
> > by
> > > >> > opening
> > > >> > > it with the IndexWriter class and calling the optimize() metho=
d.
> > > When I
> > > >> > > don't optimize in between backups, here is what happens:
> > > >> > >
> > > >> > > The first backup copies the segment composed by the files _0.c=
fs
> > and
> > > >> > > segments_2. The second backup copies the files _1.cfs and
> > > segments_3,
> > > >> and
> > > >> > > the third backup copies the files _2.cfs e segments_4. I can
> open
> > > the
> > > >> > backup
> > > >> > > folder with Luke without problems.
> > > >> > >
> > > >> > > When I do optimize in between backups, the copies are as follo=
w:
> > > >> > >
> > > >> > > The first backup copies the segment composed by the files _0.c=
fs
> > and
> > > >> > > segments_2. The second backup copies the files _1.cfs and
> > > segments_3,
> > > >> and
> > > >> > > the third backup copies the files _3.cfs e segments_5. In this
> > case,
> > > >> when
> > > >> > I
> > > >> > > try to open the backup folder, Luke gives a message saying tha=
t
> it
> > > >> can't
> > > >> > > find the file _2.cfs.
> > > >> > >
> > > >> > > My question is: how can I backup my index using the
> > > >> > SnapshotDeletionPolicy
> > > >> > > and having to optimize the index in between backups? Am I usin=
g
> > the
> > > >> right
> > > >> > > backup strategy?
> > > >> > >
> > > >> > > Thanks,
> > > >> > > Lucas
> > > >> > >
> > > >> >
> > > >> >
> > ---------------------------------------------------------------------
> > > >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > >> > For additional commands, e-mail: java-user-help@lucene.apache.or=
g
> > > >> >
> > > >> >
> > > >>
> > > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
>

--00504502e13bad53d604716ad1af--

From java-user-return-41922-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 18 14:28:30 2009
Return-Path: <java-user-return-41922-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39324 invoked from network); 18 Aug 2009 14:28:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Aug 2009 14:28:30 -0000
Received: (qmail 79260 invoked by uid 500); 18 Aug 2009 14:28:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79154 invoked by uid 500); 18 Aug 2009 14:28:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79144 invoked by uid 99); 18 Aug 2009 14:28:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 14:28:46 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a12.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 14:28:36 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a12.g.dreamhost.com (Postfix) with ESMTP id 919AE7FAC
	for <java-user@lucene.apache.org>; Tue, 18 Aug 2009 07:28:14 -0700 (PDT)
Message-Id: <84088EC8-93A1-4888-8287-B9898A32ED17@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <4A842449.3050505@lexum.umontreal.ca>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Is there a way to check for field "uniqueness" when indexing?
Date: Tue, 18 Aug 2009 10:28:13 -0400
References: <4A842449.3050505@lexum.umontreal.ca>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org



On Aug 13, 2009, at 10:33 AM, Daniel Shane wrote:
>
> Does anyone have an idea on how I could check an index that is in  
> the process of being indexed (things added, things deleted) for the  
> uniquess of a given field *at the time I index a document* ?


Solr has de-duplication built-in at indexing time: http://wiki.apache.org/solr/Deduplication

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41923-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 18 16:55:53 2009
Return-Path: <java-user-return-41923-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58069 invoked from network); 18 Aug 2009 16:55:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Aug 2009 16:55:53 -0000
Received: (qmail 1192 invoked by uid 500); 18 Aug 2009 16:56:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1107 invoked by uid 500); 18 Aug 2009 16:56:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1094 invoked by uid 99); 18 Aug 2009 16:56:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 16:56:09 +0000
X-ASF-Spam-Status: No, hits=2.1 required=10.0
	tests=DNS_FROM_RFC_BOGUSMX,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of micah@affinitycircles.com designates 207.7.158.80 as permitted sender)
Received: from [207.7.158.80] (HELO boom.affinityengines.com) (207.7.158.80)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 16:55:58 +0000
Received: from [10.200.1.43] (h-64-105-88-158.affinitycircles.com [64.105.88.158])
	by boom.affinityengines.com (Postfix) with ESMTP id 8DE721DB121
	for <java-user@lucene.apache.org>; Tue, 18 Aug 2009 09:55:36 -0700 (PDT)
Message-Id: <B43F6D24-083E-4EF7-A63D-68CFA93661F7@affinitycircles.com>
From: Micah Jaffe <micah@affinitycircles.com>
To: java-user@lucene.apache.org
In-Reply-To: <9ac0c6aa0908180435u44806ab7nefe92b6f028c2b3a@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Bizarre indexing issue where thousands of files get created
Date: Tue, 18 Aug 2009 09:55:35 -0700
References: <13A42DBE-C3BA-4B77-B41A-946B960C05C7@affinitycircles.com> <9ac0c6aa0908180435u44806ab7nefe92b6f028c2b3a@mail.gmail.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Hi, thanks for the response!  The (custom) searchers that are falling  
out of cache are indeed calling close on their IndexReader in  
finalize(); they are not calling close on themselves as that appears  
to be a no-op when creating an IndexSearcher with a reader.  The  
searchers are just extended IndexSearchers which have notion of their  
lifetime and are only built with IndexReaders.

The OOM does appear to be a symptom of reopening an IndexWriter, I  
haven't seen an OOM originate from the IndexWriter.  Here's a partial  
stack trace (fyi, we are closing the old reader following the pattern  
of "if the fresh reader != old reader"):

java.lang.OutOfMemoryError: Java heap space at  
org 
.apache.lucene.index.MultiSegmentReader.<init>(MultiSegmentReader.java: 
160) at  
org 
.apache 
.lucene.index.MultiSegmentReader.doReopen(MultiSegmentReader.java:203)  
at org.apache.lucene.index.DirectoryIndexReader 
$2.doBody(DirectoryIndexReader.java:98) at  
org.apache.lucene.index.SegmentInfos 
$FindSegmentsFile.run(SegmentInfos.java:636) at  
org 
.apache 
.lucene.index.DirectoryIndexReader.reopen(DirectoryIndexReader.java:92)
[... many more lines of our server code and Tomcat stack ...]
What I don't have visibility to right now is what a IndexWriter(s)  
might be up to at that point, nor which index just exploded the memory.
Everything  I've read about trying to handle OOMs in Java is "be  
careful, but you're likely screwed", so I'm unsure if I should try to  
capture the error and mop up what I can or if that will just cause  
more problems.  On indexes that have the large number of files  
problem, it appears the next time an IndexWriter is opened on that  
index in a new process (after the write.lock is nuked post shut-down),  
it collapses the files back down to a sane number (at close() maybe?).
I'll see if I can work in the infoStream suggestion, thanks...
-Micah
On Aug 18, 2009, at 4:35 AM, Michael McCandless wrote:

> Are you .close()ing your IndexReaders when they fall out of the MRU  
> cache?
>
> Seems like there are two problems... 1) why are you hitting OOMEs?
> Seems likely you're just doing too much at once.... can you ask the
> JRE to get you a heap dump when it hits OOME?
>
> 2) Why is IndexWriter creating zillions of tiny files?  This one is
> a.... does the OOME pass through IndexWriter?  If you turn on
> infoStream in your writer, get the problem to happen, and post back
> the resulting output, it'll give us a better idea what's going on.
> Could you also post a representative subset of these 200K filenames?
> It sounds like somehow IndexWriter is getting stuck into a state where
> it thinks it must flush segments far too frequently.
>
> Mike
>
> On Mon, Aug 17, 2009 at 9:31 PM, Micah  
> Jaffe<micah@affinitycircles.com> wrote:
>> The Problem: periodically we see thousands of files get created  
>> from an
>> IndexWriter in a Java process in a very short period of time.   
>> Since we
>> started trying to track this, we saw an index go from ~25 files to  
>> over 200K
>> files in about a half hour.
>>
>> The Context: a hand-rolled, all-in-one Lucene server (2.3.2  
>> codebase) that
>> can respond to searches and perform index updates, running under  
>> Tomcat, on
>> Java 1.6 on 32-bit Linux using 2GB of memory, reading/writing to  
>> local disk.
>>  This is a threaded environment where we're serving about 15-20/ 
>> requests a
>> second (mostly searches, with a 10:1 search/update ratio).  We wrap  
>> all of
>> the update code around IndexWriter to make sure all threads are  
>> only ever
>> using one writer and never close an actively used writer.  We cache  
>> about 40
>> IndexSearchers (really IndexReaders) using an MRU cache and leave  
>> it to Java
>> to garbage collect those that leave scope.  We can potentially  
>> serve ~150
>> different search indexes, most with document count under 1 million,  
>> with
>> fairly sparsely populated fields and under about 100 fields.  We do  
>> not
>> store a lot of information in any index, generally just IDs that we  
>> then use
>> for DB look-ups.  Our biggest index is about 7GB on disk and  
>> comprises
>> roughly 18 million records and is almost always in use (either  
>> searched or
>> updated).  We sometimes go days without seeing the The Problem and  
>> we've
>> seen it happen twice in the span of 4 hours.
>>
>> Accompanying Symptom: we see an OOM error where we do not have  
>> enough heap
>> space.  I'm not sure if the explosion of files triggers or results  
>> from the
>> error.  This is the only error we see accompanying the problem;  
>> performance
>> and memory usage seem fine up to the OOM error.
>>
>> Current Workaround: taking the same server to a 64-bit machine and  
>> throwing
>> 10GB of RAM at it seems (4 days counting now) to have "solved" the  
>> problem.
>>
>> What I'd really like is to understand the underlying problem, and  
>> we have
>> some theories, but before charging down one way or another I was  
>> hoping to
>> get an idea if a) people have seen something similar before and b)  
>> what they
>> did.  Our theories:
>> - Opening IndexReaders faster than Java can garbage collect those  
>> that are
>> out of scope.  We do know that too many open readers (e.g. around  
>> 100 of our
>> indexes) can exhaust memory.  This scenario seems unlikely given  
>> our usage;
>> we have 2-3 heavily used indexes and very light usage on the rest.   
>> That
>> said, the with some recent code changes we decided to rely on garbage
>> collection to fix another bug (race condition where a searcher was  
>> being
>> used as it was being closed).
>> - Hit a race condition with IndexWriter, with our code or in this  
>> version of
>> the library, and it goes nuts.
>> - Particular heavy-duty search/update hits, e.g. potentially  
>> iterating
>> across all documents (not likely) or updating a large number of  
>> documents in
>> an index (more likely).
>>
>> Really scientific, I know, but I'd welcome any discussion that  
>> involves
>> juggling Java heap (what do you do with your OOMs?), our particular  
>> problem
>> or a threaded environment using Lucene (like Solr).
>>
>> thanks!
>> Micah
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41924-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 18 17:33:36 2009
Return-Path: <java-user-return-41924-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80295 invoked from network); 18 Aug 2009 17:33:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Aug 2009 17:33:35 -0000
Received: (qmail 58119 invoked by uid 500); 18 Aug 2009 17:33:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58040 invoked by uid 500); 18 Aug 2009 17:33:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58030 invoked by uid 99); 18 Aug 2009 17:33:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 17:33:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.221.203 as permitted sender)
Received: from [209.85.221.203] (HELO mail-qy0-f203.google.com) (209.85.221.203)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 17:33:43 +0000
Received: by qyk41 with SMTP id 41so2958978qyk.29
        for <java-user@lucene.apache.org>; Tue, 18 Aug 2009 10:33:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=8+AremdPsCcvI6gLREO6G6tR+pOdDy20Lg8kJSHL2f4=;
        b=CG9wWmbyZVg6DKFxs2VAZnMyf6SRT0RLVHACPwevryQt0Lf0h434LUTDbr1SWHhrP9
         vhyW/FzDNS8gP/FA+BhGxhTwJbWo+e5+H9F2HY14KcBncl/mCPcN0R4GfABmmo3aY9G6
         yRAc9NKIDngYNw2t8Mvd43DcEl72sNDztNcfU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=NsCVyOyYWNdWl5g4zDR/6ZfzhkNrCYnJ5FQ1nmhtmc1uGcfwJUSkaAq9oYhys/kQTY
         vuTLylJYvGn60/fCGdhDLjrcyplMLxcHY1bpt4NpWNX2KuFEKd/gT8gPpu8z3TX54+/r
         RrAhAeIqE8eexosuNgLs5BwVI7UyYSFEc84tQ=
MIME-Version: 1.0
Received: by 10.224.10.17 with SMTP id n17mr5743974qan.170.1250616802913; Tue, 
	18 Aug 2009 10:33:22 -0700 (PDT)
In-Reply-To: <B43F6D24-083E-4EF7-A63D-68CFA93661F7@affinitycircles.com>
References: <13A42DBE-C3BA-4B77-B41A-946B960C05C7@affinitycircles.com>
	 <9ac0c6aa0908180435u44806ab7nefe92b6f028c2b3a@mail.gmail.com>
	 <B43F6D24-083E-4EF7-A63D-68CFA93661F7@affinitycircles.com>
Date: Tue, 18 Aug 2009 10:33:22 -0700
Message-ID: <85d3c3b60908181033t225098b3m83b6ce228ee3a36f@mail.gmail.com>
Subject: Re: Bizarre indexing issue where thousands of files get created
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Micah,

If you can post some of your code, it may be easier to identify the
problem you're experiencing.

-J

On Tue, Aug 18, 2009 at 9:55 AM, Micah Jaffe<micah@affinitycircles.com> wro=
te:
> Hi, thanks for the response! =A0The (custom) searchers that are falling o=
ut of
> cache are indeed calling close on their IndexReader in finalize(); they a=
re
> not calling close on themselves as that appears to be a no-op when creati=
ng
> an IndexSearcher with a reader. =A0The searchers are just extended
> IndexSearchers which have notion of their lifetime and are only built wit=
h
> IndexReaders.
>
> The OOM does appear to be a symptom of reopening an IndexWriter, I haven'=
t
> seen an OOM originate from the IndexWriter. =A0Here's a partial stack tra=
ce
> (fyi, we are closing the old reader following the pattern of "if the fres=
h
> reader !=3D old reader"):
>
> java.lang.OutOfMemoryError: Java heap space at
> org.apache.lucene.index.MultiSegmentReader.<init>(MultiSegmentReader.java=
:160)
> at
> org.apache.lucene.index.MultiSegmentReader.doReopen(MultiSegmentReader.ja=
va:203)
> at
> org.apache.lucene.index.DirectoryIndexReader$2.doBody(DirectoryIndexReade=
r.java:98)
> at
> org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.ja=
va:636)
> at
> org.apache.lucene.index.DirectoryIndexReader.reopen(DirectoryIndexReader.=
java:92)
> [... many more lines of our server code and Tomcat stack ...]
> What I don't have visibility to right now is what a IndexWriter(s) might =
be
> up to at that point, nor which index just exploded the memory.
> Everything =A0I've read about trying to handle OOMs in Java is "be carefu=
l,
> but you're likely screwed", so I'm unsure if I should try to capture the
> error and mop up what I can or if that will just cause more problems. =A0=
On
> indexes that have the large number of files problem, it appears the next
> time an IndexWriter is opened on that index in a new process (after the
> write.lock is nuked post shut-down), it collapses the files back down to =
a
> sane number (at close() maybe?).
> I'll see if I can work in the infoStream suggestion, thanks...
> -Micah
> On Aug 18, 2009, at 4:35 AM, Michael McCandless wrote:
>
>> Are you .close()ing your IndexReaders when they fall out of the MRU cach=
e?
>>
>> Seems like there are two problems... 1) why are you hitting OOMEs?
>> Seems likely you're just doing too much at once.... can you ask the
>> JRE to get you a heap dump when it hits OOME?
>>
>> 2) Why is IndexWriter creating zillions of tiny files? =A0This one is
>> a.... does the OOME pass through IndexWriter? =A0If you turn on
>> infoStream in your writer, get the problem to happen, and post back
>> the resulting output, it'll give us a better idea what's going on.
>> Could you also post a representative subset of these 200K filenames?
>> It sounds like somehow IndexWriter is getting stuck into a state where
>> it thinks it must flush segments far too frequently.
>>
>> Mike
>>
>> On Mon, Aug 17, 2009 at 9:31 PM, Micah Jaffe<micah@affinitycircles.com>
>> wrote:
>>>
>>> The Problem: periodically we see thousands of files get created from an
>>> IndexWriter in a Java process in a very short period of time. =A0Since =
we
>>> started trying to track this, we saw an index go from ~25 files to over
>>> 200K
>>> files in about a half hour.
>>>
>>> The Context: a hand-rolled, all-in-one Lucene server (2.3.2 codebase)
>>> that
>>> can respond to searches and perform index updates, running under Tomcat=
,
>>> on
>>> Java 1.6 on 32-bit Linux using 2GB of memory, reading/writing to local
>>> disk.
>>> =A0This is a threaded environment where we're serving about 15-20/reque=
sts
>>> a
>>> second (mostly searches, with a 10:1 search/update ratio). =A0We wrap a=
ll
>>> of
>>> the update code around IndexWriter to make sure all threads are only ev=
er
>>> using one writer and never close an actively used writer. =A0We cache a=
bout
>>> 40
>>> IndexSearchers (really IndexReaders) using an MRU cache and leave it to
>>> Java
>>> to garbage collect those that leave scope. =A0We can potentially serve =
~150
>>> different search indexes, most with document count under 1 million, wit=
h
>>> fairly sparsely populated fields and under about 100 fields. =A0We do n=
ot
>>> store a lot of information in any index, generally just IDs that we the=
n
>>> use
>>> for DB look-ups. =A0Our biggest index is about 7GB on disk and comprise=
s
>>> roughly 18 million records and is almost always in use (either searched
>>> or
>>> updated). =A0We sometimes go days without seeing the The Problem and we=
've
>>> seen it happen twice in the span of 4 hours.
>>>
>>> Accompanying Symptom: we see an OOM error where we do not have enough
>>> heap
>>> space. =A0I'm not sure if the explosion of files triggers or results fr=
om
>>> the
>>> error. =A0This is the only error we see accompanying the problem;
>>> performance
>>> and memory usage seem fine up to the OOM error.
>>>
>>> Current Workaround: taking the same server to a 64-bit machine and
>>> throwing
>>> 10GB of RAM at it seems (4 days counting now) to have "solved" the
>>> problem.
>>>
>>> What I'd really like is to understand the underlying problem, and we ha=
ve
>>> some theories, but before charging down one way or another I was hoping
>>> to
>>> get an idea if a) people have seen something similar before and b) what
>>> they
>>> did. =A0Our theories:
>>> - Opening IndexReaders faster than Java can garbage collect those that
>>> are
>>> out of scope. =A0We do know that too many open readers (e.g. around 100=
 of
>>> our
>>> indexes) can exhaust memory. =A0This scenario seems unlikely given our
>>> usage;
>>> we have 2-3 heavily used indexes and very light usage on the rest. =A0T=
hat
>>> said, the with some recent code changes we decided to rely on garbage
>>> collection to fix another bug (race condition where a searcher was bein=
g
>>> used as it was being closed).
>>> - Hit a race condition with IndexWriter, with our code or in this versi=
on
>>> of
>>> the library, and it goes nuts.
>>> - Particular heavy-duty search/update hits, e.g. potentially iterating
>>> across all documents (not likely) or updating a large number of documen=
ts
>>> in
>>> an index (more likely).
>>>
>>> Really scientific, I know, but I'd welcome any discussion that involves
>>> juggling Java heap (what do you do with your OOMs?), our particular
>>> problem
>>> or a threaded environment using Lucene (like Solr).
>>>
>>> thanks!
>>> Micah
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41925-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 18 17:53:50 2009
Return-Path: <java-user-return-41925-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91076 invoked from network); 18 Aug 2009 17:53:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Aug 2009 17:53:50 -0000
Received: (qmail 91338 invoked by uid 500); 18 Aug 2009 17:54:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91285 invoked by uid 500); 18 Aug 2009 17:54:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91243 invoked by uid 99); 18 Aug 2009 17:54:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 17:54:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Aug 2009 17:53:56 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 9CA9B71C404; Tue, 18 Aug 2009 10:53:35 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 99F2171C379
	for <java-user@lucene.apache.org>; Tue, 18 Aug 2009 10:53:35 -0700 (PDT)
Date: Tue, 18 Aug 2009 10:53:35 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: How to normalize Lucene score?
In-Reply-To: <ac6e61fc0908160634o12e9544fvfe718c2ba6a7139c@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0908181052040.16874@radix.cryptio.net>
References: <ac6e61fc0908160634o12e9544fvfe718c2ba6a7139c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Hi,
: 
: How to normalize the Lucene score to the range [0, 1]?

http://wiki.apache.org/lucene-java/ScoresAsPercentages





-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41926-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 19 02:57:20 2009
Return-Path: <java-user-return-41926-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27167 invoked from network); 19 Aug 2009 02:57:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Aug 2009 02:57:20 -0000
Received: (qmail 78435 invoked by uid 500); 19 Aug 2009 02:57:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78352 invoked by uid 500); 19 Aug 2009 02:57:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78342 invoked by uid 99); 19 Aug 2009 02:57:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 02:57:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of bryan.j.swift@gmail.com designates 209.85.221.203 as permitted sender)
Received: from [209.85.221.203] (HELO mail-qy0-f203.google.com) (209.85.221.203)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 02:57:25 +0000
Received: by qyk41 with SMTP id 41so3208509qyk.29
        for <java-user@lucene.apache.org>; Tue, 18 Aug 2009 19:57:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :content-type:content-transfer-encoding:mime-version:subject:date
         :x-mailer;
        bh=+XKvrOSE6yzHzaf9FJHPCNghSLc8IPTlRrc7goaKCpo=;
        b=wdXLMQl7pF2rzgZGjvurdtMm0VKCRFyeyL0lgoMHrAR/dmw5+Eq28Apgk/kWCyORzQ
         CBJWE/ZpYZRbhJyFtzrAr8N6AlBnethPeadxZvudoMxFOMqIv2qiXoZO8uRrLFqk5xRX
         zOUkj+CcA++6of8ki7IVPUwqfHChCLju3/9wg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:content-type:content-transfer-encoding
         :mime-version:subject:date:x-mailer;
        b=TM5Pmv/tkhIAinbxbffvKclqt0vMqMEfveCNr34UdODSdZsyrH/hOr0BjdPbJwQ1RU
         DdWs9N9fHt1RVmwUZbQ0T5DyA+ubNA0zW4hK2JqrgBEMct+2xjn2fP32vyW7N8NVsvZn
         TACYV4Hczf4o2GhQm32heb7Un5B5a06VXU0RA=
Received: by 10.224.74.146 with SMTP id u18mr6125855qaj.67.1250650624729;
        Tue, 18 Aug 2009 19:57:04 -0700 (PDT)
Received: from ?10.0.1.33? (cpe-72-227-132-159.nyc.res.rr.com [72.227.132.159])
        by mx.google.com with ESMTPS id 5sm2920292qwg.30.2009.08.18.19.57.03
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 18 Aug 2009 19:57:03 -0700 (PDT)
Message-Id: <F2EBF86E-8126-44A3-ADA2-100DED5C23ED@gmail.com>
From: Bryan Swift <bryan.j.swift@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Lucene-Core test failures
Date: Tue, 18 Aug 2009 22:57:02 -0400
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

I was running the tests which lucene-core version 2.4 and I noticed a  
failure in org.apache.lucene.index.TestIndexInput for testRead at line  
89. The assertions in question have to do with reading "Modified UTF-8  
null bytes" according to the comments in the file. It seems these  
modified null bytes are not being retrieved properly.

This failure is of particular interest to me because I am getting a  
similar failure in the specs for the implementation of IndexInput I  
am  working on for the App Engine Datastore. I was wondering if this  
test failure is something to be concerned with or if it could be  
ignored/removed with relative safety?

Cheers.
Bryan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41927-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 19 03:15:16 2009
Return-Path: <java-user-return-41927-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30056 invoked from network); 19 Aug 2009 03:15:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Aug 2009 03:15:16 -0000
Received: (qmail 86817 invoked by uid 500); 19 Aug 2009 03:15:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86686 invoked by uid 500); 19 Aug 2009 03:15:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86671 invoked by uid 99); 19 Aug 2009 03:15:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 03:15:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 03:15:23 +0000
Received: by qw-out-2122.google.com with SMTP id 8so579820qwh.53
        for <java-user@lucene.apache.org>; Tue, 18 Aug 2009 20:15:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=CEOo9BRcunwkWGPxkQ+t95L/O7DSS+8yYTxBswj93+Q=;
        b=GwKsfk8CHvnZcYG+a5N7rxRB8uU36kFhgzPZ9EdkQmLmyrdQ0kHsc6HbyTvj3SHe4O
         +QVDFWcmTIkndKWbrBwxoIc45dNB2JTVuWb4a+rYJkihPnvYWaXRcQjmXI3rgfUMYbrM
         4ndesavzetdr/DxqKMksR8sz21USlATkC6kwk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=Frm+K+Vj8zJNLN8ic9cRJXoJWId9YmdF7KpGcZ3o8JZDPp94noHYZR+NCTt4PIQoDm
         /lndA2JGPHIOjRS+rxfQ5yn4Lr8qa60DyMOWbe3wggnBL3qwlwmTm2zvp+c6jVOz9v88
         bF8SDEZzyFjmKdOdIt6COBOhLMRwLNZJ6vS6U=
Received: by 10.224.94.134 with SMTP id z6mr6078680qam.145.1250651702132;
        Tue, 18 Aug 2009 20:15:02 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 2sm11482650qwi.43.2009.08.18.20.15.01
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 18 Aug 2009 20:15:01 -0700 (PDT)
Message-ID: <4A8B6E38.4070501@gmail.com>
Date: Tue, 18 Aug 2009 23:15:04 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.22 (X11/20090804)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene-Core test failures
References: <F2EBF86E-8126-44A3-ADA2-100DED5C23ED@gmail.com>
In-Reply-To: <F2EBF86E-8126-44A3-ADA2-100DED5C23ED@gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Bryan Swift wrote:
> I was running the tests which lucene-core version 2.4 and I noticed a 
> failure in org.apache.lucene.index.TestIndexInput for testRead at line 
> 89. The assertions in question have to do with reading "Modified UTF-8 
> null bytes" according to the comments in the file. It seems these 
> modified null bytes are not being retrieved properly.
>
> This failure is of particular interest to me because I am getting a 
> similar failure in the specs for the implementation of IndexInput I 
> am  working on for the App Engine Datastore. I was wondering if this 
> test failure is something to be concerned with or if it could be 
> ignored/removed with relative safety?
>
> Cheers.
> Bryan
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
I believe thats a bad test that has since been removed. Its only 
triggered with a certain OS version of unicode I think.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41928-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 19 18:20:00 2009
Return-Path: <java-user-return-41928-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27161 invoked from network); 19 Aug 2009 18:19:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Aug 2009 18:19:59 -0000
Received: (qmail 89337 invoked by uid 500); 19 Aug 2009 18:20:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89269 invoked by uid 500); 19 Aug 2009 18:20:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89099 invoked by uid 99); 19 Aug 2009 18:20:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 18:20:16 +0000
X-ASF-Spam-Status: No, hits=-1.8 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mdufrasne@nvidia.com designates 216.228.112.145 as permitted sender)
Received: from [216.228.112.145] (HELO hqemgate03.nvidia.com) (216.228.112.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 18:20:06 +0000
Received: from hqnvupgp03.nvidia.com (Not Verified[172.17.102.18]) by hqemgate03.nvidia.com
	id <B4a8c42830001>; Wed, 19 Aug 2009 11:20:51 -0700
Received: from hqemhub02.nvidia.com ([172.17.108.22])
  by hqnvupgp03.nvidia.com (PGP Universal service);
  Wed, 19 Aug 2009 11:19:23 -0700
X-PGP-Universal: processed;
	by hqnvupgp03.nvidia.com on Wed, 19 Aug 2009 11:19:23 -0700
Received: from HQMAIL04.nvidia.com ([172.17.200.17]) by hqemhub02.nvidia.com
 ([172.17.98.27]) with mapi; Wed, 19 Aug 2009 11:19:22 -0700
From: Matt Dufrasne <mdufrasne@nvidia.com>
To: "'java-user@lucene.apache.org'" <java-user@lucene.apache.org>
Date: Wed, 19 Aug 2009 11:19:21 -0700
Subject: Modifying a tokenized field entry
Thread-Topic: Modifying a tokenized field entry
Thread-Index: Acog+ZLd6VxMlLBzQvuhBmZSKairEg==
Message-ID: <1BEF4F56914145408DFAD4EEA44E8C4210569C4587@HQMAIL04.nvidia.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_000_1BEF4F56914145408DFAD4EEA44E8C4210569C4587HQMAIL04nvidi_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_1BEF4F56914145408DFAD4EEA44E8C4210569C4587HQMAIL04nvidi_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Let's assume I have an index structured as below

name

species

color

max

cat

grey

sam

dog

brown

lucy

cat

white

.

.

.

.

.

.

poe

dog

blond

joe

cat

red

pam

dog

brown



The species and color fields are tokenized, indexed and stored.

Now let's assume that I want to change the term cat to feline and dog to =
canine.

>From what I have been reading, I would have to delete each Document(row) =
and re-add it with the new term.
Since the original cat and dog terms are Indexed, Tokenized and Stored, i=
t seems like there should be a way to update just the terms cat and dog t=
o their new titles.

Is there already a way to do this? Did  I just miss it?

-------------------------------------------------------------------------=
----------
This email message is for the sole use of the intended recipient(s) and m=
ay contain
confidential information.  Any unauthorized review, use, disclosure or di=
stribution
is prohibited.  If you are not the intended recipient, please contact the=
=20sender by
reply email and destroy all copies of the original message.
-------------------------------------------------------------------------=
----------

--_000_1BEF4F56914145408DFAD4EEA44E8C4210569C4587HQMAIL04nvidi_--

From java-user-return-41929-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 19 19:04:43 2009
Return-Path: <java-user-return-41929-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59987 invoked from network); 19 Aug 2009 19:04:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Aug 2009 19:04:43 -0000
Received: (qmail 56364 invoked by uid 500); 19 Aug 2009 19:05:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56307 invoked by uid 500); 19 Aug 2009 19:05:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56296 invoked by uid 99); 19 Aug 2009 19:05:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 19:05:00 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [132.204.246.20] (HELO chene.dit.umontreal.ca) (132.204.246.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 19:04:49 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by chene.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n7JJ4Mrc000995
	for <java-user@lucene.apache.org>; Wed, 19 Aug 2009 15:04:23 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Wed, 19 Aug 2009 15:04:22 -0400
  id 0002737A.4A8C4CB6.00003EA1
Message-ID: <4A8C4CB6.8040009@lexum.umontreal.ca>
Date: Wed, 19 Aug 2009 15:04:22 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Is there a way to check for field "uniqueness" when indexing?
References: <4A842449.3050505@lexum.umontreal.ca> <84088EC8-93A1-4888-8287-B9898A32ED17@apache.org>
In-Reply-To: <84088EC8-93A1-4888-8287-B9898A32ED17@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-NAI-Spam-Score: 0
X-NAI-Spam-Rules: 1 Rules triggered
	RV3344=0
X-Virus-Checked: Checked by ClamAV on apache.org

But in that case, I assume Solr does a commit per document added.

Lets say I wanted to index a collection of 1 million pages, would it 
take much longer if I comited at each insertion rather than comiting at 
the end?

Daniel Shane
 
Grant Ingersoll wrote:
>
>
> On Aug 13, 2009, at 10:33 AM, Daniel Shane wrote:
>>
>> Does anyone have an idea on how I could check an index that is in the 
>> process of being indexed (things added, things deleted) for the 
>> uniquess of a given field *at the time I index a document* ?
>
>
> Solr has de-duplication built-in at indexing time: 
> http://wiki.apache.org/solr/Deduplication
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) 
> using Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41930-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 19 20:20:31 2009
Return-Path: <java-user-return-41930-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82755 invoked from network); 19 Aug 2009 20:20:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Aug 2009 20:20:31 -0000
Received: (qmail 56796 invoked by uid 500); 19 Aug 2009 20:20:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56745 invoked by uid 500); 19 Aug 2009 20:20:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56735 invoked by uid 99); 19 Aug 2009 20:20:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 20:20:47 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,MISSING_MID,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of prvs=14820411f0=chris@mainsequence.net designates 65.199.122.3 as permitted sender)
Received: from [65.199.122.3] (HELO mainsequence.net) (65.199.122.3)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 20:20:35 +0000
Received: from 127.0.0.1 ([66.104.120.34])
	by mainsequence.net (mainsequence.net)
	(Cipher TLSv1:RC4-MD5:128) (MDaemon PRO v10.1.0)
	with ESMTP id md50010654717.msg
	for <java-user@lucene.apache.org>; Wed, 19 Aug 2009 16:20:12 -0400
X-Spam-Processed: mainsequence.net, Wed, 19 Aug 2009 16:20:12 -0400
	(not processed: message from trusted or authenticated source)
X-MDRemoteIP: 66.104.120.34
X-Return-Path: prvs=14820411f0=chris@mainsequence.net
X-Envelope-From: chris@mainsequence.net
X-MDaemon-Deliver-To: java-user@lucene.apache.org
Reply-To: "Chris Salem" <chris@mainsequence.net>
From: "Chris Salem" <chris@mainsequence.net>
To: java-user@lucene.apache.org
CC: 
Subject: custom scorer
Date: Wed, 19 Aug 2009 20:20:07 -0000
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: PCR Emu of Microsoft Office Outlook, Build 11.0.6353
X-MimeOLE: PCR Emu of Microsoft MimeOLE V6.00.2800.1441
MIME-Version: 1.0
Content-Type: multipart/alternative;
      boundary="----=_pcr38C6C7C1B9BC459C9035B6205CCDA3F5section1-b1"
X-Virus-Checked: Checked by ClamAV on apache.org
Message-Id: <20090819202045.AF7958160B3@nike.apache.org>

------=_pcr38C6C7C1B9BC459C9035B6205CCDA3F5section1-b1
Content-Type: text/plain; charset="ISO-8859-1"
Content-Transfer-Encoding: 7bit

Hello,
I'm trying to write a custom scorer that only uses the term frequency function from the DefaultSimilarity class, the problem is that documents with lower frequencies are returning with higher scores than documents with higher frequencies.  Here's the code:
searcher.setSimilarity(new DefaultSimilarity(){
 public float lengthNorm(String field, int numTerms){
  return 1;        
 }
 public float idf(int docFreq, int numDocs){
  return 1;
 }
 public float coord(int overlap, int maxoverlap){
  return 1;
 }
 public float queryNorm(float sumOfSquaredWeights){
  return 1;
 }   
 public float sloppyFreq(int distance){
  return 1;
 }
});
Any idea why this wouldn't be working?
Sincerely,
Chris Salem 

------=_pcr38C6C7C1B9BC459C9035B6205CCDA3F5section1-b1--




From java-user-return-41931-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 19 23:18:03 2009
Return-Path: <java-user-return-41931-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59501 invoked from network); 19 Aug 2009 23:18:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Aug 2009 23:18:02 -0000
Received: (qmail 8917 invoked by uid 500); 19 Aug 2009 23:18:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8836 invoked by uid 500); 19 Aug 2009 23:18:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8826 invoked by uid 99); 19 Aug 2009 23:18:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 23:18:19 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a10.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Aug 2009 23:18:08 +0000
Received: from [10.0.0.37] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a10.g.dreamhost.com (Postfix) with ESMTP id 978331615D6
	for <java-user@lucene.apache.org>; Wed, 19 Aug 2009 16:17:46 -0700 (PDT)
Message-Id: <A86562E2-C059-4DC9-878F-8BC13C69D2BE@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <20090819202045.AF7958160B3@nike.apache.org>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: custom scorer
X-Priority: 3
Date: Wed, 19 Aug 2009 19:17:45 -0400
References: <20090819202045.AF7958160B3@nike.apache.org>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Are you setting the Similarity before indexing, too, on the IndexWriter?

On Aug 19, 2009, at 4:20 PM, Chris Salem wrote:

> Hello,
> I'm trying to write a custom scorer that only uses the term  
> frequency function from the DefaultSimilarity class, the problem is  
> that documents with lower frequencies are returning with higher  
> scores than documents with higher frequencies.  Here's the code:
> searcher.setSimilarity(new DefaultSimilarity(){
> public float lengthNorm(String field, int numTerms){
>  return 1;
> }
> public float idf(int docFreq, int numDocs){
>  return 1;
> }
> public float coord(int overlap, int maxoverlap){
>  return 1;
> }
> public float queryNorm(float sumOfSquaredWeights){
>  return 1;
> }
> public float sloppyFreq(int distance){
>  return 1;
> }
> });
> Any idea why this wouldn't be working?
> Sincerely,
> Chris Salem

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41932-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 07:44:59 2009
Return-Path: <java-user-return-41932-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26046 invoked from network); 20 Aug 2009 07:44:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 07:44:58 -0000
Received: (qmail 83886 invoked by uid 500); 20 Aug 2009 07:45:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83814 invoked by uid 500); 20 Aug 2009 07:45:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83804 invoked by uid 99); 20 Aug 2009 07:45:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 07:45:14 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,MSGID_MULTIPLE_AT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [64.13.253.17] (HELO guavus.com) (64.13.253.17)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 07:45:05 +0000
Received: (qmail 27815 invoked from network); 20 Aug 2009 00:44:43 -0700
Received: from isp-net67.spectranet.com (HELO station151) (@125.63.71.67)
  by guavus.com with SMTP; 20 Aug 2009 00:44:42 -0700
From: "Sumanta Bhowmik" <sumanta.bhowmik@guavus.com>
To: <java-user@lucene.apache.org>
Subject: Merge Exception in Lucene 2.4
Date: Thu, 20 Aug 2009 13:14:35 +0530
Message-ID: <005301ca216a$1529ee80$3f7dcb80$@bhowmik@guavus.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0054_01CA2198.2EE22A80"
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcohahAuOQijjpD4SZ6VfDYKxFYncg==
Content-Language: en-us
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_0054_01CA2198.2EE22A80
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

Hi

 

I am getting this issue in Lucene2.4 when I try to merge multiple
IndexWriters(generally 6) 

 

sh-3.2# Exception in thread "Lucene Merge Thread #5"
org.apache.lucene.index.MergePolicy$MergeException: java.io.IOException:
read past EOF

        at
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Concur
rentMergeScheduler.java:309)

        at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentM
ergeScheduler.java:286)

Caused by: java.io.IOException: read past EOF

        at
org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.java
:135)

        at
org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.java:
228)

        at
org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:184
)

        at
org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.java:
204)

        at
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4260)

        at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3877)

        at
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeSche
duler.java:205)

        at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentM
ergeScheduler.java:260)

 

 

Is this a known issue and has any fix been provided for it ? Would
appreciate any help.

 

Regards

Sumanta

 

 


------=_NextPart_000_0054_01CA2198.2EE22A80--


From java-user-return-41933-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 09:22:00 2009
Return-Path: <java-user-return-41933-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57246 invoked from network); 20 Aug 2009 09:21:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 09:21:59 -0000
Received: (qmail 49147 invoked by uid 500); 20 Aug 2009 09:22:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49091 invoked by uid 500); 20 Aug 2009 09:22:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49071 invoked by uid 99); 20 Aug 2009 09:22:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 09:22:16 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=MSGID_MULTIPLE_AT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [64.13.253.17] (HELO guavus.com) (64.13.253.17)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 09:22:05 +0000
Received: (qmail 15463 invoked from network); 20 Aug 2009 02:21:44 -0700
Received: from isp-net67.spectranet.com (HELO station151) (@125.63.71.67)
  by guavus.com with SMTP; 20 Aug 2009 02:21:44 -0700
From: "Sumanta Bhowmik" <sumanta.bhowmik@guavus.com>
To: <java-user@lucene.apache.org>
References: <005301ca216a$1529ee80$3f7dcb80$@bhowmik@guavus.com>
In-Reply-To: <005301ca216a$1529ee80$3f7dcb80$@bhowmik@guavus.com>
Subject: RE: Merge Exception in Lucene 2.4
Date: Thu, 20 Aug 2009 14:51:36 +0530
Message-ID: <005b01ca2177$a2d58ed0$e880ac70$@bhowmik@guavus.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcohahAuOQijjpD4SZ6VfDYKxFYncgADPsNQ
Content-Language: en-us
X-Virus-Checked: Checked by ClamAV on apache.org

I checked at http://issues.apache.org/jira/browse/LUCENE-1282
SegmentMerger.java has this code

TermFreqVector[] vectors = reader.getTermFreqVectors(docNum);
termVectorsWriter.addAllDocVectors(vectors);

so this issue appears inspite of this fix.

I am using java version "1.6.0_07". Is it fixed in jdk6u10 and above
(http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6707044) ? 

Regards
Sumanta


-----Original Message-----
From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com] 
Sent: Thursday, August 20, 2009 1:15 PM
To: java-user@lucene.apache.org
Subject: Merge Exception in Lucene 2.4

Hi

 

I am getting this issue in Lucene2.4 when I try to merge multiple
IndexWriters(generally 6) 

 

sh-3.2# Exception in thread "Lucene Merge Thread #5"
org.apache.lucene.index.MergePolicy$MergeException: java.io.IOException:
read past EOF

        at
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Concur
rentMergeScheduler.java:309)

        at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentM
ergeScheduler.java:286)

Caused by: java.io.IOException: read past EOF

        at
org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.java
:135)

        at
org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.java:
228)

        at
org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:184
)

        at
org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.java:
204)

        at
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4260)

        at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3877)

        at
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeSche
duler.java:205)

        at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentM
ergeScheduler.java:260)

 

 

Is this a known issue and has any fix been provided for it ? Would
appreciate any help.

 

Regards

Sumanta

 

 




__________ NOD32 4349 (20090819) Information __________

This message was checked by NOD32 antivirus system.
http://www.eset.com



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41934-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 09:37:34 2009
Return-Path: <java-user-return-41934-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65141 invoked from network); 20 Aug 2009 09:37:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 09:37:34 -0000
Received: (qmail 73416 invoked by uid 500); 20 Aug 2009 09:37:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73373 invoked by uid 500); 20 Aug 2009 09:37:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73363 invoked by uid 99); 20 Aug 2009 09:37:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 09:37:51 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 09:37:39 +0000
Received: by gxk12 with SMTP id 12so6873215gxk.4
        for <java-user@lucene.apache.org>; Thu, 20 Aug 2009 02:37:16 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.114.13 with SMTP id m13mr12306676ybc.262.1250761036838; 
	Thu, 20 Aug 2009 02:37:16 -0700 (PDT)
In-Reply-To: <-61520930041827677@unknownmsgid>
References: <-61520930041827677@unknownmsgid>
Date: Thu, 20 Aug 2009 05:37:16 -0400
Message-ID: <9ac0c6aa0908200237kcb7d0f3q73d37b5fdec27f2d@mail.gmail.com>
Subject: Re: Merge Exception in Lucene 2.4
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

You should definitely upgrade to the latest JDK 1.6 to get the fix for
the JRE bug in LUCENE-1282, but, I don't think you are hitting that
bug (read past EOF during merge is a different exception).

Can you describe more detail on how you merge 6 IndexWriters?

Mike

On Thu, Aug 20, 2009 at 5:21 AM, Sumanta
Bhowmik<sumanta.bhowmik@guavus.com> wrote:
> I checked at http://issues.apache.org/jira/browse/LUCENE-1282
> SegmentMerger.java has this code
>
> TermFreqVector[] vectors =3D reader.getTermFreqVectors(docNum);
> termVectorsWriter.addAllDocVectors(vectors);
>
> so this issue appears inspite of this fix.
>
> I am using java version "1.6.0_07". Is it fixed in jdk6u10 and above
> (http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=3D6707044) ?
>
> Regards
> Sumanta
>
>
> -----Original Message-----
> From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]
> Sent: Thursday, August 20, 2009 1:15 PM
> To: java-user@lucene.apache.org
> Subject: Merge Exception in Lucene 2.4
>
> Hi
>
>
>
> I am getting this issue in Lucene2.4 when I try to merge multiple
> IndexWriters(generally 6)
>
>
>
> sh-3.2# Exception in thread "Lucene Merge Thread #5"
> org.apache.lucene.index.MergePolicy$MergeException: java.io.IOException:
> read past EOF
>
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
> rentMergeScheduler.java:309)
>
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
> ergeScheduler.java:286)
>
> Caused by: java.io.IOException: read past EOF
>
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.j=
ava
> :135)
>
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.ja=
va:
> 228)
>
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:=
184
> )
>
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.ja=
va:
> 204)
>
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4260)
>
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.j=
ava:3877)
>
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
> duler.java:205)
>
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
> ergeScheduler.java:260)
>
>
>
>
>
> Is this a known issue and has any fix been provided for it ? Would
> appreciate any help.
>
>
>
> Regards
>
> Sumanta
>
>
>
>
>
>
>
>
> __________ NOD32 4349 (20090819) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41935-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 11:41:58 2009
Return-Path: <java-user-return-41935-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11367 invoked from network); 20 Aug 2009 11:41:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 11:41:58 -0000
Received: (qmail 50732 invoked by uid 500); 20 Aug 2009 11:42:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50671 invoked by uid 500); 20 Aug 2009 11:42:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50661 invoked by uid 99); 20 Aug 2009 11:42:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 11:42:14 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=MSGID_MULTIPLE_AT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [64.13.253.17] (HELO guavus.com) (64.13.253.17)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 11:42:02 +0000
Received: (qmail 10138 invoked from network); 20 Aug 2009 04:41:40 -0700
Received: from isp-net67.spectranet.com (HELO station151) (@125.63.71.67)
  by guavus.com with SMTP; 20 Aug 2009 04:41:40 -0700
From: "Sumanta Bhowmik" <sumanta.bhowmik@guavus.com>
To: <java-user@lucene.apache.org>
References: <-61520930041827677@unknownmsgid> <9ac0c6aa0908200237kcb7d0f3q73d37b5fdec27f2d@mail.gmail.com>
In-Reply-To: <9ac0c6aa0908200237kcb7d0f3q73d37b5fdec27f2d@mail.gmail.com>
Subject: RE: Merge Exception in Lucene 2.4
Date: Thu, 20 Aug 2009 17:11:33 +0530
Message-ID: <005c01ca218b$2f90f400$8eb2dc00$@bhowmik@guavus.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcohefUUqgXYA17yRP+YM1Ij7+o1fQAD6DfA
Content-Language: en-us
X-Virus-Checked: Checked by ClamAV on apache.org

We put all the IndexWriters in an array which is defined by

final Directory[] finalDir;=09

We also declare an indexer
As=20
private volatile static Indexer indexer;

final Indexer finalIndexer =3D indexer;

Next we call the merge in a new thread :

Thread thread =3D new Thread(){
			public void run()
			{
				try {
					logger.debug("starts merging w/o
optimization");
=09
finalIndexer.getWriter().addIndexesNoOptimize(finalDir);
					logger.debug("ends merging w/o
optimization");
				=09
				} catch (CorruptIndexException e) {
					logger.notice("",e);
				} catch (IOException e) {
					logger.notice("",e);
				}
			=09
	}
}

Sumanta




-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: Thursday, August 20, 2009 3:07 PM
To: java-user@lucene.apache.org
Subject: Re: Merge Exception in Lucene 2.4

You should definitely upgrade to the latest JDK 1.6 to get the fix for
the JRE bug in LUCENE-1282, but, I don't think you are hitting that
bug (read past EOF during merge is a different exception).

Can you describe more detail on how you merge 6 IndexWriters?

Mike

On Thu, Aug 20, 2009 at 5:21 AM, Sumanta
Bhowmik<sumanta.bhowmik@guavus.com> wrote:
> I checked at http://issues.apache.org/jira/browse/LUCENE-1282
> SegmentMerger.java has this code
>
> TermFreqVector[] vectors =3D reader.getTermFreqVectors(docNum);
> termVectorsWriter.addAllDocVectors(vectors);
>
> so this issue appears inspite of this fix.
>
> I am using java version "1.6.0_07". Is it fixed in jdk6u10 and above
> (http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=3D6707044) ?
>
> Regards
> Sumanta
>
>
> -----Original Message-----
> From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]
> Sent: Thursday, August 20, 2009 1:15 PM
> To: java-user@lucene.apache.org
> Subject: Merge Exception in Lucene 2.4
>
> Hi
>
>
>
> I am getting this issue in Lucene2.4 when I try to merge multiple
> IndexWriters(generally 6)
>
>
>
> sh-3.2# Exception in thread "Lucene Merge Thread #5"
> org.apache.lucene.index.MergePolicy$MergeException: =
java.io.IOException:
> read past EOF
>
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
> rentMergeScheduler.java:309)
>
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
> ergeScheduler.java:286)
>
> Caused by: java.io.IOException: read past EOF
>
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.j=
ava
> :135)
>
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.ja=
va:
> 228)
>
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:=
184
> )
>
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.ja=
va:
> 204)
>
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4260)
>
> =A0 =A0 =A0 =A0at =
org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3877)
>
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
> duler.java:205)
>
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
> ergeScheduler.java:260)
>
>
>
>
>
> Is this a known issue and has any fix been provided for it ? Would
> appreciate any help.
>
>
>
> Regards
>
> Sumanta
>
>
>
>
>
>
>
>
> __________ NOD32 4349 (20090819) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


__________ NOD32 4350 (20090820) Information __________

This message was checked by NOD32 antivirus system.
http://www.eset.com



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41936-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 11:50:09 2009
Return-Path: <java-user-return-41936-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13749 invoked from network); 20 Aug 2009 11:50:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 11:50:07 -0000
Received: (qmail 64462 invoked by uid 500); 20 Aug 2009 11:50:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64397 invoked by uid 500); 20 Aug 2009 11:50:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64387 invoked by uid 99); 20 Aug 2009 11:50:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 11:50:23 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 11:50:15 +0000
Received: by ewy22 with SMTP id 22so5005678ewy.28
        for <java-user@lucene.apache.org>; Thu, 20 Aug 2009 04:49:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=BvVVGPYLAmMKiT7g3WQip3Hky3uc7BBdymNYNi20iKw=;
        b=otEPq0st/r85PyTJqrrJ0IazUAGONzzODbFGQycmvjmE1MBP3y7ntNbMgUohFD6okk
         8AE8AzodB2yTUqIaXkXY+KUavc7rW94slob14lyE4WeyutudgzxzLaadrNAmBNhmTF9z
         g/2uJ7q4Jy4JepwOzJ0/6pdaFU+OGClRYZBwU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=wVpjpF5dMYtMC1mFfGjjxkapovNJFk2SRUf1pcaN4S5Vt8eeyRdnPuUrIeXJs5OJ+u
         AUH5YuDV6orBK3UuegHuMBK2gUDv3Z7hoy3DArw1xW8ojJ94NlQ6BSXd1k0gnqO3cyMo
         PpbLhzEViJZ9NywQ5TXAxB4z2FivvOTrXWkRY=
MIME-Version: 1.0
Received: by 10.216.36.73 with SMTP id v51mr1778053wea.215.1250768994108; Thu, 
	20 Aug 2009 04:49:54 -0700 (PDT)
Date: Thu, 20 Aug 2009 14:49:54 +0300
Message-ID: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
Subject: Extending Sort/FieldCache
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016365ee96e97053204719159ab
X-Virus-Checked: Checked by ClamAV on apache.org

--0016365ee96e97053204719159ab
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi

I'd like to extend Lucene's FieldCache such that it will read native values
from a different place (in my case, payloads). That is, instead of iterating
on a field's terms and parsing each String to long (for example), I'd like
to iterate over one term (sort:long, again - an example) and decode each
payload value to long, and store it in the cache. The reason I want to
extend Lucene's FieldCache is because I'd like Lucene to take care of
updating this cache when necessary (such as after reopen for example). This
will allow me to use Lucene's Sort option more easily.

I noticed Sort can be extended by providing a CUSTOM SortField, but that
forces me to create Comparable objects, which is much more expensive than
native longs (40 bytes vs. 8 bytes).

I didn't find a way though to extend FieldCache, or ExtendedFieldCache -->
even though both are extendable, I don't find the place where they're given
as input to TopFieldDocCollector, FieldSortedHitQueue etc. Perhaps I'm
missing it?

I need to do it on top of 2.4.1, but if it's not possible and something was
done in 2.9 (which I missed) in that regard I'd be happy to get a pointer to
that.

Today, I use this payload to implement sorting, which is memory efficient
for very large indexes, but for small indexes I think Lucene's built-in sort
will perform better.

BTW, if it interests anyone, perhaps augmenting Lucene's sort w/ reading
values from a Payload, or doing a complete payload-based-sort, I can work up
a patch ...

Thanks
Shai

--0016365ee96e97053204719159ab--

From java-user-return-41937-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 13:26:19 2009
Return-Path: <java-user-return-41937-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54706 invoked from network); 20 Aug 2009 13:26:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 13:26:18 -0000
Received: (qmail 26374 invoked by uid 500); 20 Aug 2009 13:26:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26306 invoked by uid 500); 20 Aug 2009 13:26:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26296 invoked by uid 99); 20 Aug 2009 13:26:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 13:26:35 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,MISSING_MID,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of prvs=1483c3b2fb=chris@mainsequence.net designates 65.199.122.3 as permitted sender)
Received: from [65.199.122.3] (HELO mainsequence.net) (65.199.122.3)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 13:26:23 +0000
Received: from 127.0.0.1 ([66.104.120.34])
	by mainsequence.net (mainsequence.net)
	(Cipher TLSv1:RC4-MD5:128) (MDaemon PRO v10.1.0)
	with ESMTP id md50010659532.msg
	for <java-user@lucene.apache.org>; Thu, 20 Aug 2009 09:26:01 -0400
X-Spam-Processed: mainsequence.net, Thu, 20 Aug 2009 09:26:01 -0400
	(not processed: message from trusted or authenticated source)
X-MDRemoteIP: 66.104.120.34
X-Return-Path: prvs=1483c3b2fb=chris@mainsequence.net
X-Envelope-From: chris@mainsequence.net
X-MDaemon-Deliver-To: java-user@lucene.apache.org
Reply-To: "Chris Salem" <chris@mainsequence.net>
From: "Chris Salem" <chris@mainsequence.net>
To: java-user@lucene.apache.org
CC: 
Subject: Re: custom scorer
Date: Thu, 20 Aug 2009 13:25:56 -0000
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: PCR Emu of Microsoft Office Outlook, Build 11.0.6353
X-MimeOLE: PCR Emu of Microsoft MimeOLE V6.00.2800.1441
MIME-Version: 1.0
Content-Type: multipart/alternative;
      boundary="----=_pcr040268CE4F8A4CD9BF2886E53910F598section1-b1"
X-Virus-Checked: Checked by ClamAV on apache.org
Message-Id: <20090820132633.24EF78160CA@nike.apache.org>

------=_pcr040268CE4F8A4CD9BF2886E53910F598section1-b1
Content-Type: text/plain; charset="ISO-8859-1"
Content-Transfer-Encoding: 7bit

No, I take it I have to use it for both?  Is there anything else I should have to do?
Sincerely,
Chris Salem 


----- Original Message ----- 
To: java-user@lucene.apache.org
From: Grant Ingersoll <gsingers@apache.org>
Sent: 8/19/2009 7:17:45 PM
Subject: Re: custom scorer


Are you setting the Similarity before indexing, too, on the IndexWriter?

On Aug 19, 2009, at 4:20 PM, Chris Salem wrote:

> Hello,
> I'm trying to write a custom scorer that only uses the term 
> frequency function from the DefaultSimilarity class, the problem is 
> that documents with lower frequencies are returning with higher 
> scores than documents with higher frequencies. Here's the code:
> searcher.setSimilarity(new DefaultSimilarity(){
> public float lengthNorm(String field, int numTerms){
> return 1;
> }
> public float idf(int docFreq, int numDocs){
> return 1;
> }
> public float coord(int overlap, int maxoverlap){
> return 1;
> }
> public float queryNorm(float sumOfSquaredWeights){
> return 1;
> }
> public float sloppyFreq(int distance){
> return 1;
> }
> });
> Any idea why this wouldn't be working?
> Sincerely,
> Chris Salem

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) 
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

------=_pcr040268CE4F8A4CD9BF2886E53910F598section1-b1--




From java-user-return-41938-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 13:30:58 2009
Return-Path: <java-user-return-41938-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57525 invoked from network); 20 Aug 2009 13:30:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 13:30:57 -0000
Received: (qmail 33605 invoked by uid 500); 20 Aug 2009 13:31:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33518 invoked by uid 500); 20 Aug 2009 13:31:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33508 invoked by uid 99); 20 Aug 2009 13:31:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 13:31:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.225 as permitted sender)
Received: from [209.85.220.225] (HELO mail-fx0-f225.google.com) (209.85.220.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 13:31:03 +0000
Received: by fxm25 with SMTP id 25so4283607fxm.5
        for <java-user@lucene.apache.org>; Thu, 20 Aug 2009 06:30:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=7tRXTPiD6nutR+5ii9xnWFkvqPsSqCZkM5IV1Se6iEY=;
        b=fbUDnmWdj2QhA/yrKNOJpMQrlRdauWTQhCu3+PIlkzUwvdu9xilipl5adfiUk9Xuw7
         1RVQMMwA+c0OvIOr9SLim1CsZS5CwetOa6eMZ4SBMfnHZrkKHPES3yKqqjoqoq93nmVE
         KkPaoeSl+HHkjsz4Jloz5x+Bl5TvBzUtsEnCE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=FxJYK/ClFDJehX5j4nfyUso2rs5zmSVUOoCTzleBzwneUDX+AWpbIfJjXxivdPgxLQ
         u6SWe6xCaWyQHM7nUbMvqRuxfiBThJSPVo2vbYDxcGES4pk0NEgGT2lU/gMeQhdKV54d
         In2ZyVO80VhkH52Pu6XHkAeqK08XyO4PD+vu8=
MIME-Version: 1.0
Received: by 10.239.141.140 with SMTP id c12mr690070hba.15.1250775042844; Thu, 
	20 Aug 2009 06:30:42 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <20090820132633.24EF78160CA@nike.apache.org>
References: <20090820132633.24EF78160CA@nike.apache.org>
Date: Thu, 20 Aug 2009 15:30:42 +0200
Message-ID: <f18c9dde0908200630w76c0e5edi1d24974379e274a7@mail.gmail.com>
Subject: Re: custom scorer
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

You could simply set Similarity.setDefault(yourSimilarity) to make
sure it is used all over the place.

Simon

On Thu, Aug 20, 2009 at 3:25 PM, Chris Salem<chris@mainsequence.net> wrote:
> No, I take it I have to use it for both? =C2=A0Is there anything else I s=
hould have to do?
> Sincerely,
> Chris Salem
>
>
> ----- Original Message -----
> To: java-user@lucene.apache.org
> From: Grant Ingersoll <gsingers@apache.org>
> Sent: 8/19/2009 7:17:45 PM
> Subject: Re: custom scorer
>
>
> Are you setting the Similarity before indexing, too, on the IndexWriter?
>
> On Aug 19, 2009, at 4:20 PM, Chris Salem wrote:
>
>> Hello,
>> I'm trying to write a custom scorer that only uses the term
>> frequency function from the DefaultSimilarity class, the problem is
>> that documents with lower frequencies are returning with higher
>> scores than documents with higher frequencies. Here's the code:
>> searcher.setSimilarity(new DefaultSimilarity(){
>> public float lengthNorm(String field, int numTerms){
>> return 1;
>> }
>> public float idf(int docFreq, int numDocs){
>> return 1;
>> }
>> public float coord(int overlap, int maxoverlap){
>> return 1;
>> }
>> public float queryNorm(float sumOfSquaredWeights){
>> return 1;
>> }
>> public float sloppyFreq(int distance){
>> return 1;
>> }
>> });
>> Any idea why this wouldn't be working?
>> Sincerely,
>> Chris Salem
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)
> using Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41939-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 14:28:24 2009
Return-Path: <java-user-return-41939-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98741 invoked from network); 20 Aug 2009 14:28:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 14:28:23 -0000
Received: (qmail 85613 invoked by uid 500); 20 Aug 2009 14:28:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85525 invoked by uid 500); 20 Aug 2009 14:28:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85515 invoked by uid 99); 20 Aug 2009 14:28:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 14:28:39 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 14:28:29 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Me8ca-000443-W7
	for java-user@lucene.apache.org; Thu, 20 Aug 2009 07:28:08 -0700
Message-ID: <25063175.post@talk.nabble.com>
Date: Thu, 20 Aug 2009 07:28:08 -0700 (PDT)
From: Valery <khamenya@gmail.com>
To: java-user@lucene.apache.org
Subject: Any Tokenizator friendly to C++, C#, .NET, etc ?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: khamenya@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi all, 

I am trying to tune Lucene to respect such tokens like C++, C#, .NET

The task is known for Lucene community, but surprisingly I can't google out
somewhat good info on it.

Of course, I tried to re-use Lucene's  building blocks for Tokenizer. Here
we go:

  1) StandardTokenizer -- oh, this option would be just fantastic, but "C++,
C#, .NET" ends up with "c c net". Too bad.

  2) WhitespaceTokenizer gives me a lot of lexems that are actually should
have been chopped into smaller pieces. Example: "C/C++" comes out like a
single lexem. If I follow this way I end-up with "Tokenization of tokens" --
that sounds a bit odd, doesn't it?

  3) CharTokenizer allows me to add the '/' to be also a token-emitting
char, but then '/' gets immediately lost like those whitespace chars. In
result "SAP R/3" ends up with "SAP" "R" "3" and one will need to search the
original char stream for the "/" char to re-build "SAP R/3" term as a whole.

Do you see any other relevant building blocks missed by me?

Also, people around there have meant that such problem should be solved by a
synonym dictionary. However this hint sheds no light on which tokenization
strategy should be more appropriate *before* the synonym step.

So, it looks like I have to take the class CharTokenizer as for the starting
point and write anew my own Tokenizer. This Tokenizer should also react on
delimiting characters and emit the token. However, it should distinguish
between delimiters like whitespaces along with ";,?" and the delimiters like
"./&". 

Indeed, the delimiters like whitespaces and ";,?" should be thrown away from
Lexem level, 
whereas the token emitting characters like "./&" should be kept in Lexem
level.

Your comments, gurus?

regards,
Valery

-- 
View this message in context: http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25063175.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41940-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 14:37:03 2009
Return-Path: <java-user-return-41940-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2458 invoked from network); 20 Aug 2009 14:37:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 14:37:01 -0000
Received: (qmail 729 invoked by uid 500); 20 Aug 2009 14:37:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 673 invoked by uid 500); 20 Aug 2009 14:37:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 663 invoked by uid 99); 20 Aug 2009 14:37:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 14:37:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 14:37:07 +0000
Received: by ywh26 with SMTP id 26so6681561ywh.5
        for <java-user@lucene.apache.org>; Thu, 20 Aug 2009 07:36:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=slkgyvn4mN1XbnKfsW/YpJJ4pRsTLhbTbQ31beezNBw=;
        b=NBUWJ88N6lcEoI3+9gffyUniMSHJMTraNwGWXVpbIRlrtacGjYxYFfbEi9WBI7k+r5
         dmWkXc97eJSD2SmT3hH2TAZ3xLg/AxIm15cIyGsQ3uenBSfm+Bbwr1bbmT3vK7sSU8HA
         SUdZhpnwET7Z1uKlLLuEjbaJMsR/yfPSc8/+A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=iSzW7Wo19JqfS7uLrK0MIcb/TWR8dZwSyFq3DjfvYH4y3DUeOcqtGTf1ogwGSm7SMZ
         fEYavg+yWmgNBwoHA5pCE2f/PJXKEVBJVYxMpj2N9gr7gFtwHrZwGBJSQVfAH3zDk8Z0
         ExBGhuqJevHI+DboHtNiik08kDiMb9mDhYysc=
MIME-Version: 1.0
Received: by 10.101.81.15 with SMTP id i15mr8778269anl.131.1250779006423; Thu, 
	20 Aug 2009 07:36:46 -0700 (PDT)
In-Reply-To: <25063175.post@talk.nabble.com>
References: <25063175.post@talk.nabble.com>
Date: Thu, 20 Aug 2009 10:36:46 -0400
Message-ID: <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com>
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Valery,

One thing you could try would be to create a JFlex-based tokenizer,
specifying a grammar with the rules you want.
You could use the source code & grammar of StandardTokenizer as a
starting point.


On Thu, Aug 20, 2009 at 10:28 AM, Valery<khamenya@gmail.com> wrote:
>
> Hi all,
>
> I am trying to tune Lucene to respect such tokens like C++, C#, .NET
>
> The task is known for Lucene community, but surprisingly I can't google o=
ut
> somewhat good info on it.
>
> Of course, I tried to re-use Lucene's =C2=A0building blocks for Tokenizer=
. Here
> we go:
>
> =C2=A01) StandardTokenizer -- oh, this option would be just fantastic, bu=
t "C++,
> C#, .NET" ends up with "c c net". Too bad.
>
> =C2=A02) WhitespaceTokenizer gives me a lot of lexems that are actually s=
hould
> have been chopped into smaller pieces. Example: "C/C++" comes out like a
> single lexem. If I follow this way I end-up with "Tokenization of tokens"=
 --
> that sounds a bit odd, doesn't it?
>
> =C2=A03) CharTokenizer allows me to add the '/' to be also a token-emitti=
ng
> char, but then '/' gets immediately lost like those whitespace chars. In
> result "SAP R/3" ends up with "SAP" "R" "3" and one will need to search t=
he
> original char stream for the "/" char to re-build "SAP R/3" term as a who=
le.
>
> Do you see any other relevant building blocks missed by me?
>
> Also, people around there have meant that such problem should be solved b=
y a
> synonym dictionary. However this hint sheds no light on which tokenizatio=
n
> strategy should be more appropriate *before* the synonym step.
>
> So, it looks like I have to take the class CharTokenizer as for the start=
ing
> point and write anew my own Tokenizer. This Tokenizer should also react o=
n
> delimiting characters and emit the token. However, it should distinguish
> between delimiters like whitespaces along with ";,?" and the delimiters l=
ike
> "./&".
>
> Indeed, the delimiters like whitespaces and ";,?" should be thrown away f=
rom
> Lexem level,
> whereas the token emitting characters like "./&" should be kept in Lexem
> level.
>
> Your comments, gurus?
>
> regards,
> Valery
>
> --
> View this message in context: http://www.nabble.com/Any-Tokenizator-frien=
dly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25063175.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41941-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 15:09:25 2009
Return-Path: <java-user-return-41941-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18378 invoked from network); 20 Aug 2009 15:09:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 15:09:24 -0000
Received: (qmail 1439 invoked by uid 500); 20 Aug 2009 15:09:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1387 invoked by uid 500); 20 Aug 2009 15:09:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1366 invoked by uid 99); 20 Aug 2009 15:09:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 15:09:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 15:09:31 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Me9GI-0005en-K3
	for java-user@lucene.apache.org; Thu, 20 Aug 2009 08:09:10 -0700
Message-ID: <25063964.post@talk.nabble.com>
Date: Thu, 20 Aug 2009 08:09:10 -0700 (PDT)
From: Valery <khamenya@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
In-Reply-To: <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: khamenya@gmail.com
References: <25063175.post@talk.nabble.com> <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Robert,=20

thanks for the hint.=20

Indeed, a natural way to go. Especially if one builds a Tokenizer of the
level of quality like StandardTokenizer's.=20

OTOH, you mean that the out-of-the-box stuff is indeed not customizable for
this task?..

regards
Valery



Robert Muir wrote:
>=20
> Valery,
>=20
> One thing you could try would be to create a JFlex-based tokenizer,
> specifying a grammar with the rules you want.
> You could use the source code & grammar of StandardTokenizer as a
> starting point.
>=20
>=20
> On Thu, Aug 20, 2009 at 10:28 AM, Valery<khamenya@gmail.com> wrote:
>>
>> Hi all,
>>
>> I am trying to tune Lucene to respect such tokens like C++, C#, .NET
>>
>> The task is known for Lucene community, but surprisingly I can't google
>> out
>> somewhat good info on it.
>>
>> Of course, I tried to re-use Lucene's =C2=A0building blocks for Tokenize=
r.
>> Here
>> we go:
>>
>> =C2=A01) StandardTokenizer -- oh, this option would be just fantastic, b=
ut
>> "C++,
>> C#, .NET" ends up with "c c net". Too bad.
>>
>> =C2=A02) WhitespaceTokenizer gives me a lot of lexems that are actually =
should
>> have been chopped into smaller pieces. Example: "C/C++" comes out like a
>> single lexem. If I follow this way I end-up with "Tokenization of tokens=
"
>> --
>> that sounds a bit odd, doesn't it?
>>
>> =C2=A03) CharTokenizer allows me to add the '/' to be also a token-emitt=
ing
>> char, but then '/' gets immediately lost like those whitespace chars. In
>> result "SAP R/3" ends up with "SAP" "R" "3" and one will need to search
>> the
>> original char stream for the "/" char to re-build "SAP R/3" term as a
>> whole.
>>
>> Do you see any other relevant building blocks missed by me?
>>
>> Also, people around there have meant that such problem should be solved
>> by a
>> synonym dictionary. However this hint sheds no light on which
>> tokenization
>> strategy should be more appropriate *before* the synonym step.
>>
>> So, it looks like I have to take the class CharTokenizer as for the
>> starting
>> point and write anew my own Tokenizer. This Tokenizer should also react
>> on
>> delimiting characters and emit the token. However, it should distinguish
>> between delimiters like whitespaces along with ";,?" and the delimiters
>> like
>> "./&".
>>
>> Indeed, the delimiters like whitespaces and ";,?" should be thrown away
>> from
>> Lexem level,
>> whereas the token emitting characters like "./&" should be kept in Lexem
>> level.
>>
>> Your comments, gurus?
>>
>> regards,
>> Valery
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%=
2C-etc---tp25063175p25063175.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
>=20
>=20
> --=20
> Robert Muir
> rcmuir@gmail.com
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Any-Tokenizator-friendl=
y-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25063964.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41942-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 15:20:30 2009
Return-Path: <java-user-return-41942-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23095 invoked from network); 20 Aug 2009 15:20:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 15:20:26 -0000
Received: (qmail 37196 invoked by uid 500); 20 Aug 2009 15:20:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37120 invoked by uid 500); 20 Aug 2009 15:20:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37078 invoked by uid 99); 20 Aug 2009 15:20:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 15:20:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.132.250 as permitted sender)
Received: from [209.85.132.250] (HELO an-out-0708.google.com) (209.85.132.250)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 15:20:33 +0000
Received: by an-out-0708.google.com with SMTP id b2so1850663ana.5
        for <java-user@lucene.apache.org>; Thu, 20 Aug 2009 08:20:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=BAiYFVGKjO8+danJfAuVP/aufYNI3VGAsqRfI0IC1Lk=;
        b=uGACwvnzZnwhpPweHcpKNf77e1xyFBuF/DDzkU01nNr2UFeSZFK3t/ClgXzzLcpGqe
         zlpYyOEzk7bf2vJaJLQyootzm+KHsKfGrrCfhwNa8SY9Ige5590Q23U2jv43YfQ1nqag
         HPIWMKTJ2n8SsnCItWVaRx0h3lSojkFf9FXE8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=WwmukfgqFRi8DEBNOWA1K+cnl5msKEywyK2rLgGCCWnnz5ZFiUSSYPp3eOAcf80uOi
         FB1KqN0FrnPvNNFfAl78pBjdp4TGcDaaXb1T/G8gZfIEEpBsJnabuM40viVzg2grz9iP
         XvolhyU6sozpLlsBgq5reHHgPVqNlVgjXZphI=
MIME-Version: 1.0
Received: by 10.101.162.10 with SMTP id p10mr8826665ano.92.1250781612356; Thu, 
	20 Aug 2009 08:20:12 -0700 (PDT)
In-Reply-To: <25063964.post@talk.nabble.com>
References: <25063175.post@talk.nabble.com>
	 <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com>
	 <25063964.post@talk.nabble.com>
Date: Thu, 20 Aug 2009 11:20:12 -0400
Message-ID: <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com>
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Valery, oh I think there might be other ways to solve this.

But you provided some examples such as C/C++ and SAP R/3.
In these two examples you want the "/" to behave differently depending
upon context, so my first thought was that a grammar might be a good
way to ensure it does what you want.

On Thu, Aug 20, 2009 at 11:09 AM, Valery<khamenya@gmail.com> wrote:
>
> Hi Robert,
>
> thanks for the hint.
>
> Indeed, a natural way to go. Especially if one builds a Tokenizer of the
> level of quality like StandardTokenizer's.
>
> OTOH, you mean that the out-of-the-box stuff is indeed not customizable f=
or
> this task?..
>
> regards
> Valery
>
>
>
> Robert Muir wrote:
>>
>> Valery,
>>
>> One thing you could try would be to create a JFlex-based tokenizer,
>> specifying a grammar with the rules you want.
>> You could use the source code & grammar of StandardTokenizer as a
>> starting point.
>>
>>
>> On Thu, Aug 20, 2009 at 10:28 AM, Valery<khamenya@gmail.com> wrote:
>>>
>>> Hi all,
>>>
>>> I am trying to tune Lucene to respect such tokens like C++, C#, .NET
>>>
>>> The task is known for Lucene community, but surprisingly I can't google
>>> out
>>> somewhat good info on it.
>>>
>>> Of course, I tried to re-use Lucene's =C2=A0building blocks for Tokeniz=
er.
>>> Here
>>> we go:
>>>
>>> =C2=A01) StandardTokenizer -- oh, this option would be just fantastic, =
but
>>> "C++,
>>> C#, .NET" ends up with "c c net". Too bad.
>>>
>>> =C2=A02) WhitespaceTokenizer gives me a lot of lexems that are actually=
 should
>>> have been chopped into smaller pieces. Example: "C/C++" comes out like =
a
>>> single lexem. If I follow this way I end-up with "Tokenization of token=
s"
>>> --
>>> that sounds a bit odd, doesn't it?
>>>
>>> =C2=A03) CharTokenizer allows me to add the '/' to be also a token-emit=
ting
>>> char, but then '/' gets immediately lost like those whitespace chars. I=
n
>>> result "SAP R/3" ends up with "SAP" "R" "3" and one will need to search
>>> the
>>> original char stream for the "/" char to re-build "SAP R/3" term as a
>>> whole.
>>>
>>> Do you see any other relevant building blocks missed by me?
>>>
>>> Also, people around there have meant that such problem should be solved
>>> by a
>>> synonym dictionary. However this hint sheds no light on which
>>> tokenization
>>> strategy should be more appropriate *before* the synonym step.
>>>
>>> So, it looks like I have to take the class CharTokenizer as for the
>>> starting
>>> point and write anew my own Tokenizer. This Tokenizer should also react
>>> on
>>> delimiting characters and emit the token. However, it should distinguis=
h
>>> between delimiters like whitespaces along with ";,?" and the delimiters
>>> like
>>> "./&".
>>>
>>> Indeed, the delimiters like whitespaces and ";,?" should be thrown away
>>> from
>>> Lexem level,
>>> whereas the token emitting characters like "./&" should be kept in Lexe=
m
>>> level.
>>>
>>> Your comments, gurus?
>>>
>>> regards,
>>> Valery
>>>
>>> --
>>> View this message in context:
>>> http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET=
%2C-etc---tp25063175p25063175.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>>
>> --
>> Robert Muir
>> rcmuir@gmail.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> --
> View this message in context: http://www.nabble.com/Any-Tokenizator-frien=
dly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25063964.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41943-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 16:46:28 2009
Return-Path: <java-user-return-41943-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63025 invoked from network); 20 Aug 2009 16:46:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 16:46:26 -0000
Received: (qmail 17172 invoked by uid 500); 20 Aug 2009 16:46:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17108 invoked by uid 500); 20 Aug 2009 16:46:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17098 invoked by uid 99); 20 Aug 2009 16:46:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 16:46:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.177.145.93] (HELO prxy.net) (209.177.145.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 16:46:30 +0000
X-Scanned-By: RAE MPP/ClamAV http://raeinternet.com/mpp
X-Scanned-By: This message was scanned by MPP Free Edition (www.messagepartners.com)!
Received: from [75.26.198.169] (account ken@krugler.org HELO [192.168.1.43])
  by prxy.net (CommuniGate Pro SMTP 4.2.10)
  with ESMTP id 111588439 for java-user@lucene.apache.org; Thu, 20 Aug 2009 09:47:09 -0700
Message-Id: <AF702461-8DAB-4A58-B937-F98220B098A3@transpac.com>
From: Ken Krugler <kkrugler_lists@transpac.com>
To: java-user@lucene.apache.org
In-Reply-To: <25063964.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v935.3)
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
Date: Thu, 20 Aug 2009 09:46:03 -0700
References: <25063175.post@talk.nabble.com> <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com> <25063964.post@talk.nabble.com>
X-Mailer: Apple Mail (2.935.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Valery,

 From our experience at Krugle, we wound up having to create our own  
tokenizers (actually kind of  specialized parser) for the different  
languages. It didn't seem like a good option to try to twist one of  
the existing tokenizers into something that would work well enough. We  
wound up using ANTLR for this.

-- Ken


On Aug 20, 2009, at 8:09am, Valery wrote:

>
> Hi Robert,
>
> thanks for the hint.
>
> Indeed, a natural way to go. Especially if one builds a Tokenizer of  
> the
> level of quality like StandardTokenizer's.
>
> OTOH, you mean that the out-of-the-box stuff is indeed not  
> customizable for
> this task?..
>
> regards
> Valery
>
>
>
> Robert Muir wrote:
>>
>> Valery,
>>
>> One thing you could try would be to create a JFlex-based tokenizer,
>> specifying a grammar with the rules you want.
>> You could use the source code & grammar of StandardTokenizer as a
>> starting point.
>>
>>
>> On Thu, Aug 20, 2009 at 10:28 AM, Valery<khamenya@gmail.com> wrote:
>>>
>>> Hi all,
>>>
>>> I am trying to tune Lucene to respect such tokens like C++, C#, .NET
>>>
>>> The task is known for Lucene community, but surprisingly I can't  
>>> google
>>> out
>>> somewhat good info on it.
>>>
>>> Of course, I tried to re-use Lucene's  building blocks for  
>>> Tokenizer.
>>> Here
>>> we go:
>>>
>>>  1) StandardTokenizer -- oh, this option would be just fantastic,  
>>> but
>>> "C++,
>>> C#, .NET" ends up with "c c net". Too bad.
>>>
>>>  2) WhitespaceTokenizer gives me a lot of lexems that are actually  
>>> should
>>> have been chopped into smaller pieces. Example: "C/C++" comes out  
>>> like a
>>> single lexem. If I follow this way I end-up with "Tokenization of  
>>> tokens"
>>> --
>>> that sounds a bit odd, doesn't it?
>>>
>>>  3) CharTokenizer allows me to add the '/' to be also a token- 
>>> emitting
>>> char, but then '/' gets immediately lost like those whitespace  
>>> chars. In
>>> result "SAP R/3" ends up with "SAP" "R" "3" and one will need to  
>>> search
>>> the
>>> original char stream for the "/" char to re-build "SAP R/3" term  
>>> as a
>>> whole.
>>>
>>> Do you see any other relevant building blocks missed by me?
>>>
>>> Also, people around there have meant that such problem should be  
>>> solved
>>> by a
>>> synonym dictionary. However this hint sheds no light on which
>>> tokenization
>>> strategy should be more appropriate *before* the synonym step.
>>>
>>> So, it looks like I have to take the class CharTokenizer as for the
>>> starting
>>> point and write anew my own Tokenizer. This Tokenizer should also  
>>> react
>>> on
>>> delimiting characters and emit the token. However, it should  
>>> distinguish
>>> between delimiters like whitespaces along with ";,?" and the  
>>> delimiters
>>> like
>>> "./&".
>>>
>>> Indeed, the delimiters like whitespaces and ";,?" should be thrown  
>>> away
>>> from
>>> Lexem level,
>>> whereas the token emitting characters like "./&" should be kept in  
>>> Lexem
>>> level.
>>>
>>> Your comments, gurus?
>>>
>>> regards,
>>> Valery
>>>
>>> --
>>> View this message in context:
>>> http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25063175.html
>>> Sent from the Lucene - Java Users mailing list archive at  
>>> Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>>
>> -- 
>> Robert Muir
>> rcmuir@gmail.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> -- 
> View this message in context: http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25063964.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Ken Krugler
TransPac Software, Inc.
<http://www.transpac.com>
+1 530-210-6378


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41944-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 17:32:26 2009
Return-Path: <java-user-return-41944-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19532 invoked from network); 20 Aug 2009 17:32:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 17:32:25 -0000
Received: (qmail 94861 invoked by uid 500); 20 Aug 2009 17:32:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94811 invoked by uid 500); 20 Aug 2009 17:32:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94801 invoked by uid 99); 20 Aug 2009 17:32:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 17:32:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 17:32:32 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MeBUh-0002dW-He
	for java-user@lucene.apache.org; Thu, 20 Aug 2009 10:32:11 -0700
Message-ID: <25066540.post@talk.nabble.com>
Date: Thu, 20 Aug 2009 10:32:11 -0700 (PDT)
From: Valery <khamenya@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
In-Reply-To: <AF702461-8DAB-4A58-B937-F98220B098A3@transpac.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: khamenya@gmail.com
References: <25063175.post@talk.nabble.com> <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com> <25063964.post@talk.nabble.com> <AF702461-8DAB-4A58-B937-F98220B098A3@transpac.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Ken, 

thanks for the comments. Well, Terrence's ANTLR was and is a good piece of
work. 

Do you mean that you use ANTLR to generate a Tokenzer (lexem parser) 

or 

did you even proceed further and used ANTLR to generate higher level parsers
to overrule Lucene's TokenFilters?

or maybe even both?..

regards,
Valery



Ken Krugler wrote:
> 
> Hi Valery,
> 
>  From our experience at Krugle, we wound up having to create our own  
> tokenizers (actually kind of  specialized parser) for the different  
> languages. It didn't seem like a good option to try to twist one of  
> the existing tokenizers into something that would work well enough. We  
> wound up using ANTLR for this.
> 
> -- Ken
> 
> 
> On Aug 20, 2009, at 8:09am, Valery wrote:
> 
>>
>> Hi Robert,
>>
>> thanks for the hint.
>>
>> Indeed, a natural way to go. Especially if one builds a Tokenizer of  
>> the
>> level of quality like StandardTokenizer's.
>>
>> OTOH, you mean that the out-of-the-box stuff is indeed not  
>> customizable for
>> this task?..
>>
>> regards
>> Valery
>>
>>
>>
>> Robert Muir wrote:
>>>
>>> Valery,
>>>
>>> One thing you could try would be to create a JFlex-based tokenizer,
>>> specifying a grammar with the rules you want.
>>> You could use the source code & grammar of StandardTokenizer as a
>>> starting point.
>>>
>>>
>>> On Thu, Aug 20, 2009 at 10:28 AM, Valery<khamenya@gmail.com> wrote:
>>>>
>>>> Hi all,
>>>>
>>>> I am trying to tune Lucene to respect such tokens like C++, C#, .NET
>>>>
>>>> The task is known for Lucene community, but surprisingly I can't  
>>>> google
>>>> out
>>>> somewhat good info on it.
>>>>
>>>> Of course, I tried to re-use Lucene's  building blocks for  
>>>> Tokenizer.
>>>> Here
>>>> we go:
>>>>
>>>>  1) StandardTokenizer -- oh, this option would be just fantastic,  
>>>> but
>>>> "C++,
>>>> C#, .NET" ends up with "c c net". Too bad.
>>>>
>>>>  2) WhitespaceTokenizer gives me a lot of lexems that are actually  
>>>> should
>>>> have been chopped into smaller pieces. Example: "C/C++" comes out  
>>>> like a
>>>> single lexem. If I follow this way I end-up with "Tokenization of  
>>>> tokens"
>>>> --
>>>> that sounds a bit odd, doesn't it?
>>>>
>>>>  3) CharTokenizer allows me to add the '/' to be also a token- 
>>>> emitting
>>>> char, but then '/' gets immediately lost like those whitespace  
>>>> chars. In
>>>> result "SAP R/3" ends up with "SAP" "R" "3" and one will need to  
>>>> search
>>>> the
>>>> original char stream for the "/" char to re-build "SAP R/3" term  
>>>> as a
>>>> whole.
>>>>
>>>> Do you see any other relevant building blocks missed by me?
>>>>
>>>> Also, people around there have meant that such problem should be  
>>>> solved
>>>> by a
>>>> synonym dictionary. However this hint sheds no light on which
>>>> tokenization
>>>> strategy should be more appropriate *before* the synonym step.
>>>>
>>>> So, it looks like I have to take the class CharTokenizer as for the
>>>> starting
>>>> point and write anew my own Tokenizer. This Tokenizer should also  
>>>> react
>>>> on
>>>> delimiting characters and emit the token. However, it should  
>>>> distinguish
>>>> between delimiters like whitespaces along with ";,?" and the  
>>>> delimiters
>>>> like
>>>> "./&".
>>>>
>>>> Indeed, the delimiters like whitespaces and ";,?" should be thrown  
>>>> away
>>>> from
>>>> Lexem level,
>>>> whereas the token emitting characters like "./&" should be kept in  
>>>> Lexem
>>>> level.
>>>>
>>>> Your comments, gurus?
>>>>
>>>> regards,
>>>> Valery
>>>>
>>>> --
>>>> View this message in context:
>>>> http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25063175.html
>>>> Sent from the Lucene - Java Users mailing list archive at  
>>>> Nabble.com.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>>
>>>
>>> -- 
>>> Robert Muir
>>> rcmuir@gmail.com
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> -- 
>> View this message in context:
>> http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25063964.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
> 
> --------------------------
> Ken Krugler
> TransPac Software, Inc.
> <http://www.transpac.com>
> +1 530-210-6378
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25066540.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41945-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 17:47:02 2009
Return-Path: <java-user-return-41945-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45906 invoked from network); 20 Aug 2009 17:47:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 17:47:02 -0000
Received: (qmail 18912 invoked by uid 500); 20 Aug 2009 17:47:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18827 invoked by uid 500); 20 Aug 2009 17:47:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18817 invoked by uid 99); 20 Aug 2009 17:47:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 17:47:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 17:47:09 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MeBir-000393-AS
	for java-user@lucene.apache.org; Thu, 20 Aug 2009 10:46:49 -0700
Message-ID: <25066762.post@talk.nabble.com>
Date: Thu, 20 Aug 2009 10:46:49 -0700 (PDT)
From: Valery <khamenya@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
In-Reply-To: <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: khamenya@gmail.com
References: <25063175.post@talk.nabble.com> <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com> <25063964.post@talk.nabble.com> <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Robert, 

so, would you expect a Tokenizer to consider '/' in both cases as a separate
Token?

Personally, I see no problem if Tokenzer would do the following job:

"C/C++" ==> TokenStream of { "C", "/", "C", "+", "+"} 
and come up with "C" and "C++" tokens after processing through the
downstream tokenfilters.

Similarly:

"SAP R/3" ==> TokenStream of { "SAP", "R", "/", "3"} 
and getting { "SAP", "R", "/", "3", "R/3", "SAP R/3"} later.

I try to follow a spirit that a token (or its lexem) usually should never be
parsed again. One can build  more complex (compound) things from the tokens.
However, usually one never chops a lexem into smaller pieces.

What do you think, Robert?

regards,
Valery

-- 
View this message in context: http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25066762.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41946-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 18:48:27 2009
Return-Path: <java-user-return-41946-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76508 invoked from network); 20 Aug 2009 18:48:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 18:48:27 -0000
Received: (qmail 9828 invoked by uid 500); 20 Aug 2009 18:48:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9756 invoked by uid 500); 20 Aug 2009 18:48:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9734 invoked by uid 99); 20 Aug 2009 18:48:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 18:48:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.132.251 as permitted sender)
Received: from [209.85.132.251] (HELO an-out-0708.google.com) (209.85.132.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 18:48:35 +0000
Received: by an-out-0708.google.com with SMTP id b2so36119ana.5
        for <java-user@lucene.apache.org>; Thu, 20 Aug 2009 11:48:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=E6StKdYYwrP/UDijso679UpmGMlF0ED4E26zYpPAPK4=;
        b=w+yZyBwTvn7CUvYW6pxQ5/Pt5yWVfMigY4O+hf3VGZR7skvFy/3zBItlXPR5fRDnfj
         I39f9K+oxqCb7XSlhHxejJaTFXIuEEzwk6Ac8wB168HrxEBGFIlyMl8lNgGrlqnA/oy8
         1j7iDg0No54kzy3GOgDXXFQWYvurIO1ieLk1Y=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=exLWGk2dBxW3FYS46E6aj/qFYcaVMmrGjzbMRKMI7adYBIF/xKdeEkgGwfmoumpnoz
         fqWegCNNX/cpKi/keSR9CJf0EU2J01OytezoGOVwmzkzYsgFxFa8C0lCQHw8D2dESOqO
         Z2dxa2BbjqZokOWZT9iA9dqxdaRMUSga91mmc=
MIME-Version: 1.0
Received: by 10.100.80.7 with SMTP id d7mr201125anb.43.1250794094363; Thu, 20 
	Aug 2009 11:48:14 -0700 (PDT)
In-Reply-To: <25066762.post@talk.nabble.com>
References: <25063175.post@talk.nabble.com>
	 <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com>
	 <25063964.post@talk.nabble.com>
	 <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com>
	 <25066762.post@talk.nabble.com>
Date: Thu, 20 Aug 2009 14:48:14 -0400
Message-ID: <8f0ad1f30908201148t1e38748elad82b7f5bf1a1c2c@mail.gmail.com>
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Valery, I think it all depends on how you want your search to work.

when I say this, I mean for example: if a document only contains "C++"
do you want searches on just "C" to match or not?

another thing I would suggest is to take a look at the capabilities of
Solr: it has some analysis stuff that might be beneficial for your
needs.
wiki page is here: http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilt=
ers


On Thu, Aug 20, 2009 at 1:46 PM, Valery<khamenya@gmail.com> wrote:
>
> Hi Robert,
>
> so, would you expect a Tokenizer to consider '/' in both cases as a separ=
ate
> Token?
>
> Personally, I see no problem if Tokenzer would do the following job:
>
> "C/C++" =3D=3D> TokenStream of { "C", "/", "C", "+", "+"}
> and come up with "C" and "C++" tokens after processing through the
> downstream tokenfilters.
>
> Similarly:
>
> "SAP R/3" =3D=3D> TokenStream of { "SAP", "R", "/", "3"}
> and getting { "SAP", "R", "/", "3", "R/3", "SAP R/3"} later.
>
> I try to follow a spirit that a token (or its lexem) usually should never=
 be
> parsed again. One can build =C2=A0more complex (compound) things from the=
 tokens.
> However, usually one never chops a lexem into smaller pieces.
>
> What do you think, Robert?
>
> regards,
> Valery
>
> --
> View this message in context: http://www.nabble.com/Any-Tokenizator-frien=
dly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25066762.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41947-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 19:22:56 2009
Return-Path: <java-user-return-41947-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87404 invoked from network); 20 Aug 2009 19:22:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 19:22:56 -0000
Received: (qmail 56439 invoked by uid 500); 20 Aug 2009 19:23:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56382 invoked by uid 500); 20 Aug 2009 19:23:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56372 invoked by uid 99); 20 Aug 2009 19:23:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 19:23:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.225 as permitted sender)
Received: from [209.85.220.225] (HELO mail-fx0-f225.google.com) (209.85.220.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 19:23:03 +0000
Received: by fxm25 with SMTP id 25so105613fxm.5
        for <java-user@lucene.apache.org>; Thu, 20 Aug 2009 12:22:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=Vv7AKaRQZxNaejO4unaSfCe8DzRgCN0yr2uR01c8bAM=;
        b=ejhDa9PfggMji56oxNqIsNe5G9O3qXSu2VkdErG79HPcHZu46Y+vuKwTPf6oDzJI59
         noC1AdcLFomP/Ft/3szqms/n9msd22esqRbaN7XwkARZhAAesC/RAzIZw27S6y04cN4v
         4evg+9uulgNb3dBBAbvucux8ArXBgeEAoIsXs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=DsUZ+C3Blys7v0ipQstb5f84AXHEw8Jdja2FA4VV49SzPk4ntA2XPLWCCWr6JeVbsD
         Hqt7EcwwoN44QamvcbhltfyyQ2llNICeaEAqQDcpH9LkfslL52fvQb+jVC6D++zldUzz
         E+TQZ/wwm7MhCzjg3zfBLW7wT9w5P0v1eHRSo=
MIME-Version: 1.0
Received: by 10.239.182.153 with SMTP id q25mr15526hbg.138.1250796161647; Thu, 
	20 Aug 2009 12:22:41 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <8f0ad1f30908201148t1e38748elad82b7f5bf1a1c2c@mail.gmail.com>
References: <25063175.post@talk.nabble.com>
	 <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com>
	 <25063964.post@talk.nabble.com>
	 <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com>
	 <25066762.post@talk.nabble.com>
	 <8f0ad1f30908201148t1e38748elad82b7f5bf1a1c2c@mail.gmail.com>
Date: Thu, 20 Aug 2009 21:22:41 +0200
Message-ID: <f18c9dde0908201222i5f85d734y716837e0681ce59e@mail.gmail.com>
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Valery, have you tried to use whitespaceTokenizer / CharTokenizer and
do any further processing in a  custom TokenFilter?!

simon

On Thu, Aug 20, 2009 at 8:48 PM, Robert Muir<rcmuir@gmail.com> wrote:
> Valery, I think it all depends on how you want your search to work.
>
> when I say this, I mean for example: if a document only contains "C++"
> do you want searches on just "C" to match or not?
>
> another thing I would suggest is to take a look at the capabilities of
> Solr: it has some analysis stuff that might be beneficial for your
> needs.
> wiki page is here: http://wiki.apache.org/solr/AnalyzersTokenizersTokenFi=
lters
>
>
> On Thu, Aug 20, 2009 at 1:46 PM, Valery<khamenya@gmail.com> wrote:
>>
>> Hi Robert,
>>
>> so, would you expect a Tokenizer to consider '/' in both cases as a sepa=
rate
>> Token?
>>
>> Personally, I see no problem if Tokenzer would do the following job:
>>
>> "C/C++" =3D=3D> TokenStream of { "C", "/", "C", "+", "+"}
>> and come up with "C" and "C++" tokens after processing through the
>> downstream tokenfilters.
>>
>> Similarly:
>>
>> "SAP R/3" =3D=3D> TokenStream of { "SAP", "R", "/", "3"}
>> and getting { "SAP", "R", "/", "3", "R/3", "SAP R/3"} later.
>>
>> I try to follow a spirit that a token (or its lexem) usually should neve=
r be
>> parsed again. One can build =C2=A0more complex (compound) things from th=
e tokens.
>> However, usually one never chops a lexem into smaller pieces.
>>
>> What do you think, Robert?
>>
>> regards,
>> Valery
>>
>> --
>> View this message in context: http://www.nabble.com/Any-Tokenizator-frie=
ndly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25066762.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> --
> Robert Muir
> rcmuir@gmail.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41948-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 20 21:36:07 2009
Return-Path: <java-user-return-41948-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37827 invoked from network); 20 Aug 2009 21:36:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Aug 2009 21:36:06 -0000
Received: (qmail 53431 invoked by uid 500); 20 Aug 2009 21:36:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53342 invoked by uid 500); 20 Aug 2009 21:36:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53332 invoked by uid 99); 20 Aug 2009 21:36:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 21:36:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.7] (HELO eastrmmtao101.cox.net) (68.230.240.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Aug 2009 21:36:12 +0000
Received: from eastrmimpo03.cox.net ([68.1.16.126])
          by eastrmmtao101.cox.net
          (InterMail vM.8.00.01.00 201-2244-105-20090324) with ESMTP
          id <20090820213546.UFPZ6358.eastrmmtao101.cox.net@eastrmimpo03.cox.net>
          for <java-user@lucene.apache.org>;
          Thu, 20 Aug 2009 17:35:46 -0400
Received: from eastrmwml44 ([172.18.18.217])
	by eastrmimpo03.cox.net with bizsmtp
	id Wlbn1c0054h0NJL02lbnrh; Thu, 20 Aug 2009 17:35:47 -0400
X-VR-Score: -20.00
X-Authority-Analysis: v=1.0 c=1 a=UBNZu-DbSA4A:10 a=y6CmZzHcY9ptqTMDGiMA:9
 a=ZnfQImLsPqYLS92xa-AA:7 a=FTYTfjbf82q-fzzY444oxhYYzskA:4
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Thu, 20 Aug 2009 17:35:46 -0400
Message-ID: <20090820173547.XBPCC.24753.imail@eastrmwml44>
Date: Thu, 20 Aug 2009 17:35:47 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Possible to invoke same Lucene query on a String?
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

This question is going to be a little complicated to explain, but let me try.

I have implemented an indexer app based on the demo IndexFiles app, and a web app based on the luceneweb web app for the searching.

In my case, the "Documents" that I'm indexing are a proprietary file type, and each document has kind of "sub-documents".  So, in my indexer, I parse each of the sub-documents, and, for a given "Document", I build a long string containing terms that I extracted from each of the sub-documents, then I do:

doc.add(new Field("contents", longstring, Field.Store.YES, Field.Index.ANALYZED));

I also add the longstring to another non-indexed field, summary:

doc.add(new Field("summary", longstring, Field.Store.YES, Field.Index.NO));

The modified luceneweb web app that I use is pretty vanilla, and originally, what I was asked to do was to be able to search just for a Document, i.e., given a query like "X and Y" (document containing both term=X and term=Y), return the file path+name for the document.  I also was displaying the terms associated with each sub-document by parsing the 'summary' string.

So, for example, if "Document1" contained 3 sub-documents (which contained (term1, term2), (term1a, term2a), and (term1b, term2b), respectively), and if I queried for "term1a AND term2a", the web app would display something like:

Document1                 subdoc1 term1 term2
                                      subdoc2 term1a term2a
                                      subdoc3 term1b term2b

However, I've now been asked to implement the ability to query the sub-documents. 

In other words, rather than the web app displaying what I showed above, they want it to return something like just:

Document1                 subdoc2 term1a term2a

Right now, the web app gets the 'summary' (again, in a long string), then just breaks it into subdoc1, subdoc2, and subdoc3 lines, just for display purposes, so to do what I've been asked, I need to query the 3 sub-strings from the 'summary', i.e., run the "term1a AND term2a" query against the following strings:

subdoc1 term1 term2
subdoc2 term1a term2a
subdoc3 term1b term2b

I guess that I can write a method to do that, but I want to make sure that the sub-document/string query "duplicates" the behavior of the Lucene query.

It seems like there should be a way to duplicate the Lucene query logic by using something (methods) in Lucene itself??

I've been reviewing the Javadocs, but I'm still fairly new to Lucene, so I was hoping that someone could point me in the right direction?

My apologies for the longish post, but I hope that I've been able to explain clearly :)!!

Thanks,
Jim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41949-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 00:44:44 2009
Return-Path: <java-user-return-41949-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92178 invoked from network); 21 Aug 2009 00:44:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 00:44:44 -0000
Received: (qmail 68603 invoked by uid 500); 21 Aug 2009 00:45:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68523 invoked by uid 500); 21 Aug 2009 00:45:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68503 invoked by uid 99); 21 Aug 2009 00:45:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 00:45:00 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.46] (HELO eastrmmtao104.cox.net) (68.230.240.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 00:44:48 +0000
Received: from eastrmimpo02.cox.net ([68.1.16.120])
          by eastrmmtao104.cox.net
          (InterMail vM.8.00.01.00 201-2244-105-20090324) with ESMTP
          id <20090821004427.ODLJ11036.eastrmmtao104.cox.net@eastrmimpo02.cox.net>
          for <java-user@lucene.apache.org>;
          Thu, 20 Aug 2009 20:44:27 -0400
Received: from eastrmwml49 ([172.18.18.217])
	by eastrmimpo02.cox.net with bizsmtp
	id WokS1c0074h0NJL02okSAH; Thu, 20 Aug 2009 20:44:26 -0400
X-VR-Score: -120.00
X-Authority-Analysis: v=1.0 c=1 a=g_Tv2rkpugkA:10 a=kviXuzpPAAAA:8
 a=mV9VRH-2AAAA:8 a=Do7LTSaTa2tWzZ0muC0A:9 a=enjaGlVbqlsTZYF3-TMA:7
 a=pXU4OjxO8SJT3jxXWZOaVSGyLGoA:4 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Thu, 20 Aug 2009 20:44:26 -0400
Message-ID: <20090820204426.C9BHD.27707.imail@eastrmwml49>
Date: Thu, 20 Aug 2009 20:44:26 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Possible to invoke same Lucene query on a String?
In-Reply-To: <20090820173547.XBPCC.24753.imail@eastrmwml44>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I guess, that, in short, what I'm really trying to find out is:

If I construct a Lucene query, can I (somehow) use that to query a String object that I have, rather than querying against a Lucene index?

Thanks,
Jim


---- ohaya@cox.net wrote: 
> Hi,
> 
> This question is going to be a little complicated to explain, but let me try.
> 
> I have implemented an indexer app based on the demo IndexFiles app, and a web app based on the luceneweb web app for the searching.
> 
> In my case, the "Documents" that I'm indexing are a proprietary file type, and each document has kind of "sub-documents".  So, in my indexer, I parse each of the sub-documents, and, for a given "Document", I build a long string containing terms that I extracted from each of the sub-documents, then I do:
> 
> doc.add(new Field("contents", longstring, Field.Store.YES, Field.Index.ANALYZED));
> 
> I also add the longstring to another non-indexed field, summary:
> 
> doc.add(new Field("summary", longstring, Field.Store.YES, Field.Index.NO));
> 
> The modified luceneweb web app that I use is pretty vanilla, and originally, what I was asked to do was to be able to search just for a Document, i.e., given a query like "X and Y" (document containing both term=X and term=Y), return the file path+name for the document.  I also was displaying the terms associated with each sub-document by parsing the 'summary' string.
> 
> So, for example, if "Document1" contained 3 sub-documents (which contained (term1, term2), (term1a, term2a), and (term1b, term2b), respectively), and if I queried for "term1a AND term2a", the web app would display something like:
> 
> Document1                 subdoc1 term1 term2
>                                       subdoc2 term1a term2a
>                                       subdoc3 term1b term2b
> 
> However, I've now been asked to implement the ability to query the sub-documents. 
> 
> In other words, rather than the web app displaying what I showed above, they want it to return something like just:
> 
> Document1                 subdoc2 term1a term2a
> 
> Right now, the web app gets the 'summary' (again, in a long string), then just breaks it into subdoc1, subdoc2, and subdoc3 lines, just for display purposes, so to do what I've been asked, I need to query the 3 sub-strings from the 'summary', i.e., run the "term1a AND term2a" query against the following strings:
> 
> subdoc1 term1 term2
> subdoc2 term1a term2a
> subdoc3 term1b term2b
> 
> I guess that I can write a method to do that, but I want to make sure that the sub-document/string query "duplicates" the behavior of the Lucene query.
> 
> It seems like there should be a way to duplicate the Lucene query logic by using something (methods) in Lucene itself??
> 
> I've been reviewing the Javadocs, but I'm still fairly new to Lucene, so I was hoping that someone could point me in the right direction?
> 
> My apologies for the longish post, but I hope that I've been able to explain clearly :)!!
> 
> Thanks,
> Jim
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41950-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 02:05:09 2009
Return-Path: <java-user-return-41950-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6683 invoked from network); 21 Aug 2009 02:05:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 02:05:09 -0000
Received: (qmail 25141 invoked by uid 500); 21 Aug 2009 02:05:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25096 invoked by uid 500); 21 Aug 2009 02:05:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25086 invoked by uid 99); 21 Aug 2009 02:05:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 02:05:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [203.89.202.182] (HELO postoffice2.aconex.com) (203.89.202.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 02:05:15 +0000
X-ASG-Debug-ID: 1250820292-34e602970000-H1Y1KX
X-Barracuda-URL: http://postoffice2.aconex.com:8000/cgi-bin/mark.cgi
Received: from postoffice.aconex.com (localhost [127.0.0.1])
	by postoffice2.aconex.com (Spam & Virus Firewall) with ESMTP id 3D6A57FA9D2
	for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 12:04:52 +1000 (EST)
Received: from postoffice.aconex.com (postoffice.yarra.acx [192.168.102.1]) by postoffice2.aconex.com with ESMTP id 1Ab4nY6MpZ0HWUNH for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 12:04:52 +1000 (EST)
X-Barracuda-Envelope-From: cowan@aconex.com
Received: from gatekeeper.aconex.com (gatekeeper.yarra.acx [192.168.102.10])
	by postoffice.aconex.com (Postfix) with ESMTP id B6C56A501BD
	for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 12:03:57 +1000 (EST)
Received: from localhost (localhost.localdomain [127.0.0.1])
	by gatekeeper.aconex.com (Postfix) with ESMTP id 037614FD82
	for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 12:04:52 +1000 (EST)
X-Virus-Scanned: amavisd-new at gatekeeper.yarra.acx
Received: from gatekeeper.aconex.com ([127.0.0.1])
	by localhost (gatekeeper.aconex.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id q8x8sYEJVmxK for <java-user@lucene.apache.org>;
	Fri, 21 Aug 2009 12:04:47 +1000 (EST)
Received: from [192.168.5.132] (melho0.aconex.com [203.89.192.141])
	by gatekeeper.aconex.com (Postfix) with ESMTP id 3BF784FD86
	for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 12:04:47 +1000 (EST)
Message-ID: <4A8E00BE.2020207@aconex.com>
Date: Fri, 21 Aug 2009 12:04:46 +1000
From: Paul Cowan <cowan@aconex.com>
Organization: Aconex
User-Agent: Thunderbird 2.0.0.21 (X11/20090409)
MIME-Version: 1.0
To: java-user@lucene.apache.org
X-ASG-Orig-Subj: Re: Possible to invoke same Lucene query on a String?
Subject: Re: Possible to invoke same Lucene query on a String?
References: <20090820204426.C9BHD.27707.imail@eastrmwml49>
In-Reply-To: <20090820204426.C9BHD.27707.imail@eastrmwml49>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Barracuda-Connect: postoffice.yarra.acx[192.168.102.1]
X-Barracuda-Start-Time: 1250820292
X-Barracuda-Virus-Scanned: by Aconex Staff Email Spam Firewall at aconex.com
X-Virus-Checked: Checked by ClamAV on apache.org

ohaya@cox.net wrote:
> Document1                 subdoc1 term1 term2
>                                       subdoc2 term1a term2a
>                                       subdoc3 term1b term2b
>
> However, I've now been asked to implement the ability to query the sub-documents. 
>
> In other words, rather than the web app displaying what I showed above, they want it to return something like just:
>
> Document1                 subdoc2 term1a term2a

Just checking here... you only want to match where the terms are in 
specific sub-documents? That is, if someone searches for 'term1a AND 
term2b', what do you want to see? Nothing (because no sub-document 
matches both terms)? Or subdoc2 and subdoc3, because they're both part 
of the reason that Document1 matched?

If the former, then just indexing each sub-doc as a separate document 
(duplicating the document-level information) may be the simplest option.

Cheers,

Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41951-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 03:03:00 2009
Return-Path: <java-user-return-41951-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16812 invoked from network); 21 Aug 2009 03:02:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 03:02:59 -0000
Received: (qmail 80612 invoked by uid 500); 21 Aug 2009 03:03:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80390 invoked by uid 500); 21 Aug 2009 03:03:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80352 invoked by uid 99); 21 Aug 2009 03:03:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 03:03:11 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.230.240.46] (HELO eastrmmtao104.cox.net) (68.230.240.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 02:45:11 +0000
Received: from eastrmimpo01.cox.net ([68.1.16.119])
          by eastrmmtao104.cox.net
          (InterMail vM.8.00.01.00 201-2244-105-20090324) with ESMTP
          id <20090821024450.RFBG11036.eastrmmtao104.cox.net@eastrmimpo01.cox.net>;
          Thu, 20 Aug 2009 22:44:50 -0400
Received: from eastrmwml29 ([172.18.18.217])
	by eastrmimpo01.cox.net with bizsmtp
	id Wqkq1c0064h0NJL02qkqUS; Thu, 20 Aug 2009 22:44:50 -0400
X-VR-Score: -170.00
X-Authority-Analysis: v=1.0 c=1 a=g_Tv2rkpugkA:10 a=FbwGDW88AAAA:8
 a=kviXuzpPAAAA:8 a=p4CTpLOJAAAA:8 a=PP5AhTUp0uSikSbfgL0A:9
 a=lG0nLVclVZAQUxTUc1S9iYlO-DIA:4 a=pVPEDnPezCQA:10 a=4vB-4DCPJfMA:10
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Thu, 20 Aug 2009 22:44:50 -0400
Message-ID: <20090820224450.04G0A.30333.imail@eastrmwml29>
Date: Thu, 20 Aug 2009 22:44:50 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Possible to invoke same Lucene query on a String?
Cc: Paul Cowan <cowan@aconex.com>
In-Reply-To: <4A8E00BE.2020207@aconex.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org


---- Paul Cowan <cowan@aconex.com> wrote: 
> ohaya@cox.net wrote:
> > Document1                 subdoc1 term1 term2
> >                                       subdoc2 term1a term2a
> >                                       subdoc3 term1b term2b
> >
> > However, I've now been asked to implement the ability to query the sub-documents. 
> >
> > In other words, rather than the web app displaying what I showed above, they want it to return something like just:
> >
> > Document1                 subdoc2 term1a term2a
> 
> Just checking here... you only want to match where the terms are in 
> specific sub-documents? That is, if someone searches for 'term1a AND 
> term2b', what do you want to see? Nothing (because no sub-document 
> matches both terms)? Or subdoc2 and subdoc3, because they're both part 
> of the reason that Document1 matched?
> 
> If the former, then just indexing each sub-doc as a separate document 
> (duplicating the document-level information) may be the simplest option.
> 
> Cheers,
> 
> Paul
>


Hi Paul,

Hah!

Yes, it's the former I think...

The "Hah!" was because I was googling, and just ran across this:

http://javatechniques.com/blog/lucene-in-memory-text-search-example/

which, I think, creates an in-memory index, then searches it.

I was reading through that, as I saw your message.

As I was reading though, I am wondering:  This seems like it would create an awful lot of overhead?

In other words:

- I'd have to create a (very small) index, for each sub-document, where I do the Document.add() with just the (for example) two terms, then
- Run a query against the 1-entry index, which
- Would either give me a "yes" or "no" (for that sub-document)

As I said, I'm concerned about overhead.  Some of the documents are quite large, containing >20K sub-documents.  That means that, for such a document, I'd have to create >20K indexes.

Is there really no other way to do this?  I guess that, in my mind, I keep thinking about somehow "redirecting" Lucene to do a search on a single String object (that was just a kind of metaphor)?

Comments?

Thanks for your response!

Jim



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41952-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 04:19:09 2009
Return-Path: <java-user-return-41952-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27021 invoked from network); 21 Aug 2009 04:19:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 04:19:09 -0000
Received: (qmail 30849 invoked by uid 500); 21 Aug 2009 04:19:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30687 invoked by uid 500); 21 Aug 2009 04:19:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30664 invoked by uid 99); 21 Aug 2009 04:19:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 04:19:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [203.89.202.182] (HELO postoffice2.aconex.com) (203.89.202.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 04:19:14 +0000
X-ASG-Debug-ID: 1250828331-4f6501140000-H1Y1KX
X-Barracuda-URL: http://postoffice2.aconex.com:8000/cgi-bin/mark.cgi
Received: from postoffice.aconex.com (localhost [127.0.0.1])
	by postoffice2.aconex.com (Spam & Virus Firewall) with ESMTP id 6B73F2E145D
	for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 14:18:51 +1000 (EST)
Received: from postoffice.aconex.com (postoffice.yarra.acx [192.168.102.1]) by postoffice2.aconex.com with ESMTP id X9kSROdpcTV58xpz for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 14:18:51 +1000 (EST)
X-Barracuda-Envelope-From: cowan@aconex.com
Received: from gatekeeper.aconex.com (gatekeeper.yarra.acx [192.168.102.10])
	by postoffice.aconex.com (Postfix) with ESMTP id 0D9DEA502B5
	for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 14:17:57 +1000 (EST)
Received: from localhost (localhost.localdomain [127.0.0.1])
	by gatekeeper.aconex.com (Postfix) with ESMTP id 59C264FD86
	for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 14:18:51 +1000 (EST)
X-Virus-Scanned: amavisd-new at gatekeeper.yarra.acx
Received: from gatekeeper.aconex.com ([127.0.0.1])
	by localhost (gatekeeper.aconex.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 5+LwHRBAMBaN for <java-user@lucene.apache.org>;
	Fri, 21 Aug 2009 14:18:46 +1000 (EST)
Received: from [192.168.5.132] (melho0.aconex.com [203.89.192.141])
	by gatekeeper.aconex.com (Postfix) with ESMTP id ACD8E4FD84
	for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 14:18:46 +1000 (EST)
Message-ID: <4A8E2024.1030103@aconex.com>
Date: Fri, 21 Aug 2009 14:18:44 +1000
From: Paul Cowan <cowan@aconex.com>
Organization: Aconex
User-Agent: Thunderbird 2.0.0.21 (X11/20090409)
MIME-Version: 1.0
To: java-user@lucene.apache.org
X-ASG-Orig-Subj: Re: Possible to invoke same Lucene query on a String?
Subject: Re: Possible to invoke same Lucene query on a String?
References: <20090820224450.04G0A.30333.imail@eastrmwml29>
In-Reply-To: <20090820224450.04G0A.30333.imail@eastrmwml29>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Barracuda-Connect: postoffice.yarra.acx[192.168.102.1]
X-Barracuda-Start-Time: 1250828331
X-Barracuda-Virus-Scanned: by Aconex Staff Email Spam Firewall at aconex.com
X-Virus-Checked: Checked by ClamAV on apache.org

ohaya@cox.net wrote:
> - I'd have to create a (very small) index, for each sub-document, where I do the Document.add() with just the (for example) two terms, then
> - Run a query against the 1-entry index, which
> - Would either give me a "yes" or "no" (for that sub-document)
> 
> As I said, I'm concerned about overhead.  Some of the documents are quite large, containing >20K sub-documents.  That means that, for such a document, I'd have to create >20K indexes.

No, I'm talking about a separate document in the same index.

There are a few approaches here:

1) Index each sub-document separately. So if you have fields 'doc#', 
'docname', 'subdoc#', and 'subdocterms', you might do:

    for (Doc parent : Docs) {
      for (SubDoc child : parent.subDocs()) {
        Document luceneDoc = new Document();
        doc.add(new Field("doc#", parent.number()));
        doc.add(new Field("docname", parent.name()));
        doc.add(new Field("subdoc#", child.number()));
        doc.add(new Field("subdocterms", child.data()));
      }
    }

This means that in your index after indexing 2 docs with 2 subdocs each, 
you'll have
    (Lucene #)   doc#   docname   subdoc#   subdocterms
    ----------------------------------------------------
    0            100    Foo       101       subdoc1 terms here
    1            100    Foo       102       subdoc2 terms
    2            200    Bar       201       subdoc1 terms from doc2
    3            200    Bar       202       some more subdoc text

So the search you're doing is actually on the subdoc level. This can get 
complicated, especially as subdocs from the same parent doc may come 
back out of order, etc, depending on scoring/sorting.

Also, if there is a lot of data at the parent level, you're obviously 
duplicating it. This can get nasty.

2) Maintain a (logically) separate subdoc index. You could have 
something like:
    doc#   docname  bigblobofdocdata
    ---------------------------------
    100    Foo      lots of data here...
    200    Bar      and lots more here..
in one index, and
    doc#   subdoc#  subdocterms
    ---------------------------------
    100    101       subdoc1 terms here
    100    102       subdoc2 terms
    200    201       subdoc1 terms from doc2
    200    202       some more subdoc text

Then you can FIRST search on the doc index to do any matches on 
'docname' etc, then use the IDs you find to filter the subdoc index -- 
so if the user searches for 'docname=foo' and 'subdocterms=text', you 
first do the docname search to get the docname-matching doc (100), then 
do a search on the second index for 'subdocterms', but also filter where 
doc#=100.

Note they don't HAVE to be separate indexes -- you can actually keep 
these in the same physical index, with some sort of discriminator (all 
docs in an index don't have to have the same fields).

3) Do some really hardcore tricks with spanqueries. This is what I'm 
working on at the moment, so it's near and dear to my heart. It's not 
for the faint-hearted, though, and if you're new to Lucene may scare you 
off, sorry! Basically Lucene has the concept of 'positions' for terms -- 
metadata about where in the document the term can be found. This lets 
you do 'near' queries, etc.

We're taking advantage of that to do some many-to-one stuff like your 
problem. Using the first example, with term positions indicated in [], 
we position terms from different subdocs with a large gap between them, 
like so:

    (Lucene #)   doc#   docname   subdoc#   subdocterms
    ----------------------------------------------------
    0            100    Foo       101[0]    subdoc1[0] terms[1] here[2]
                                  102[100]  subdoc2[100] terms[101]

    1            200    Bar       201[0]    subdoc1[0] terms[1] from[2]
                                  202[100]  doc2[3] some[100] more[101]
                                            subdoc[102] text[103]

So in each doc, subdoc #1's terms start at 0, #2's at 100, #3s at 200, 
etc. Then when we search we can say 'the terms you're looking for must 
be in the same 100-position block' to find only subdocs that match all 
subdoc-related subqueries. This is pretty hairy but is working well for 
us -- massively reduces our indexing and search times compared to the 
duplicated document way I mentioned above.

Cheers,

Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41953-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 04:30:23 2009
Return-Path: <java-user-return-41953-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30339 invoked from network); 21 Aug 2009 04:30:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 04:30:23 -0000
Received: (qmail 49993 invoked by uid 500); 21 Aug 2009 04:30:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49804 invoked by uid 500); 21 Aug 2009 04:30:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49794 invoked by uid 99); 21 Aug 2009 04:30:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 04:30:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.230.240.48] (HELO eastrmmtao106.cox.net) (68.230.240.48)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 04:30:30 +0000
Received: from eastrmimpo01.cox.net ([68.1.16.119])
          by eastrmmtao106.cox.net
          (InterMail vM.8.00.01.00 201-2244-105-20090324) with ESMTP
          id <20090821043009.RMIP19495.eastrmmtao106.cox.net@eastrmimpo01.cox.net>;
          Fri, 21 Aug 2009 00:30:09 -0400
Received: from eastrmwml36 ([172.18.18.217])
	by eastrmimpo01.cox.net with bizsmtp
	id WsW81c0094h0NJL02sW8YH; Fri, 21 Aug 2009 00:30:08 -0400
X-VR-Score: -200.00
X-Authority-Analysis: v=1.0 c=1 a=g_Tv2rkpugkA:10 a=FbwGDW88AAAA:8
 a=kviXuzpPAAAA:8 a=PX6GZhbMICEtm8vSDpkA:9 a=9OzDIp0q-d-jwhaXOz4A:7
 a=5VMmiVM5VclWsUIEH8gy-TRoBBUA:4 a=pVPEDnPezCQA:10 a=4vB-4DCPJfMA:10
 a=iyAS19UhfmkuS5y2:21 a=LUXhJWAU-sylPDOH:21
X-CM-Score: 0.00
Received: from 72.196.195.196 by webmail.east.cox.net; Fri, 21 Aug 2009 0:30:08 -0400
Message-ID: <20090821003009.C6LIW.31472.imail@eastrmwml36>
Date: Fri, 21 Aug 2009 0:30:09 -0400
From:  <ohaya@cox.net>
To: java-user@lucene.apache.org
Subject: Re: Possible to invoke same Lucene query on a String?
Cc: Paul Cowan <cowan@aconex.com>
In-Reply-To: <4A8E2024.1030103@aconex.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
Sensitivity: Normal
X-Virus-Checked: Checked by ClamAV on apache.org


---- Paul Cowan <cowan@aconex.com> wrote: 
> ohaya@cox.net wrote:
> > - I'd have to create a (very small) index, for each sub-document, where I do the Document.add() with just the (for example) two terms, then
> > - Run a query against the 1-entry index, which
> > - Would either give me a "yes" or "no" (for that sub-document)
> > 
> > As I said, I'm concerned about overhead.  Some of the documents are quite large, containing >20K sub-documents.  That means that, for such a document, I'd have to create >20K indexes.
> 
> No, I'm talking about a separate document in the same index.
> 
> There are a few approaches here:
> 
> 1) Index each sub-document separately. So if you have fields 'doc#', 
> 'docname', 'subdoc#', and 'subdocterms', you might do:
> 
>     for (Doc parent : Docs) {
>       for (SubDoc child : parent.subDocs()) {
>         Document luceneDoc = new Document();
>         doc.add(new Field("doc#", parent.number()));
>         doc.add(new Field("docname", parent.name()));
>         doc.add(new Field("subdoc#", child.number()));
>         doc.add(new Field("subdocterms", child.data()));
>       }
>     }
> 
> This means that in your index after indexing 2 docs with 2 subdocs each, 
> you'll have
>     (Lucene #)   doc#   docname   subdoc#   subdocterms
>     ----------------------------------------------------
>     0            100    Foo       101       subdoc1 terms here
>     1            100    Foo       102       subdoc2 terms
>     2            200    Bar       201       subdoc1 terms from doc2
>     3            200    Bar       202       some more subdoc text
> 
> So the search you're doing is actually on the subdoc level. This can get 
> complicated, especially as subdocs from the same parent doc may come 
> back out of order, etc, depending on scoring/sorting.
> 
> Also, if there is a lot of data at the parent level, you're obviously 
> duplicating it. This can get nasty.
> 
> 2) Maintain a (logically) separate subdoc index. You could have 
> something like:
>     doc#   docname  bigblobofdocdata
>     ---------------------------------
>     100    Foo      lots of data here...
>     200    Bar      and lots more here..
> in one index, and
>     doc#   subdoc#  subdocterms
>     ---------------------------------
>     100    101       subdoc1 terms here
>     100    102       subdoc2 terms
>     200    201       subdoc1 terms from doc2
>     200    202       some more subdoc text
> 
> Then you can FIRST search on the doc index to do any matches on 
> 'docname' etc, then use the IDs you find to filter the subdoc index -- 
> so if the user searches for 'docname=foo' and 'subdocterms=text', you 
> first do the docname search to get the docname-matching doc (100), then 
> do a search on the second index for 'subdocterms', but also filter where 
> doc#=100.
> 
> Note they don't HAVE to be separate indexes -- you can actually keep 
> these in the same physical index, with some sort of discriminator (all 
> docs in an index don't have to have the same fields).
> 
> 3) Do some really hardcore tricks with spanqueries. This is what I'm 
> working on at the moment, so it's near and dear to my heart. It's not 
> for the faint-hearted, though, and if you're new to Lucene may scare you 
> off, sorry! Basically Lucene has the concept of 'positions' for terms -- 
> metadata about where in the document the term can be found. This lets 
> you do 'near' queries, etc.
> 
> We're taking advantage of that to do some many-to-one stuff like your 
> problem. Using the first example, with term positions indicated in [], 
> we position terms from different subdocs with a large gap between them, 
> like so:
> 
>     (Lucene #)   doc#   docname   subdoc#   subdocterms
>     ----------------------------------------------------
>     0            100    Foo       101[0]    subdoc1[0] terms[1] here[2]
>                                   102[100]  subdoc2[100] terms[101]
> 
>     1            200    Bar       201[0]    subdoc1[0] terms[1] from[2]
>                                   202[100]  doc2[3] some[100] more[101]
>                                             subdoc[102] text[103]
> 
> So in each doc, subdoc #1's terms start at 0, #2's at 100, #3s at 200, 
> etc. Then when we search we can say 'the terms you're looking for must 
> be in the same 100-position block' to find only subdocs that match all 
> subdoc-related subqueries. This is pretty hairy but is working well for 
> us -- massively reduces our indexing and search times compared to the 
> duplicated document way I mentioned above.
> 
> Cheers,
> 
> Paul


Paul,

Oh boy, you've given me a LOT to chew on :)!!

At first read, I like your #1 approach, maybe because it's easiest for me to understand.  I have to think about it, but my first thought is that we might not need/want the sub-doc index to persist after they're used (maybe!), so create the sub-doc index "on-the-fly" for each Document, maybe using that example I linked as the template, do the query, then move on to the next Document...

I'll have to think about it.  Like I said, lots of ideas in your message :)...

Having said that, I keep thinking wouldn't it be much easier if, as I originally posted, there was a way to invoke a "Lucene query" on just a String object :(??

Of course, if, after some more thought, it makes more sense to persist the sub-doc index(es), then I guess not...

Again, thanks.  Now, I'll have to re-read what you wrote, a couple of times.  

Jim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41954-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 04:49:16 2009
Return-Path: <java-user-return-41954-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33805 invoked from network); 21 Aug 2009 04:49:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 04:49:16 -0000
Received: (qmail 62038 invoked by uid 500); 21 Aug 2009 04:49:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61798 invoked by uid 500); 21 Aug 2009 04:49:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61781 invoked by uid 99); 21 Aug 2009 04:49:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 04:49:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 04:49:23 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id D6C6C71C2D1; Thu, 20 Aug 2009 21:49:01 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id D54AA71C29C
	for <java-user@lucene.apache.org>; Thu, 20 Aug 2009 21:49:01 -0700 (PDT)
Date: Thu, 20 Aug 2009 21:49:01 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Is there a way to check for field "uniqueness" when indexing?
In-Reply-To: <4A8C4CB6.8040009@lexum.umontreal.ca>
Message-ID: <Pine.LNX.4.64.0908202141490.21261@radix.cryptio.net>
References: <4A842449.3050505@lexum.umontreal.ca> <84088EC8-93A1-4888-8287-B9898A32ED17@apache.org>
 <4A8C4CB6.8040009@lexum.umontreal.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: But in that case, I assume Solr does a commit per document added.

not at all ... it computes a signature and then uses that as a unique key.  
IndexWriter.updateDocument does all the hard work.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41955-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 04:52:51 2009
Return-Path: <java-user-return-41955-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34060 invoked from network); 21 Aug 2009 04:52:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 04:52:50 -0000
Received: (qmail 64373 invoked by uid 500); 21 Aug 2009 04:53:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64206 invoked by uid 500); 21 Aug 2009 04:53:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64194 invoked by uid 99); 21 Aug 2009 04:53:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 04:53:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.220.225 as permitted sender)
Received: from [209.85.220.225] (HELO mail-fx0-f225.google.com) (209.85.220.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 04:52:57 +0000
Received: by fxm25 with SMTP id 25so291648fxm.5
        for <java-user@lucene.apache.org>; Thu, 20 Aug 2009 21:52:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=6okagfuFAmvlK8dmkawA/fRNtT1txDRpZZZhVxfpvxI=;
        b=ZJwVKtwhPrcxtGCLPqjRbkiwO6e319iUIqsQrwFKAFpopZmeeKoxUbcbORZq6PRSsC
         Th3tNQD5HlEghz06I+nRM53LWF9h1ehFEkmv8OWJUSUGRmS+/XDaLIeVKQYwlYcxw8QB
         aPNcWt+j2pcz985PkjYN/Sow/jbVmcxoxXp7E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=ct0rYK4Lni2jYXuks5iuv7PkL7Qnqrr5sfI7mnkx0P4g2Dj9uJl+Cg+zqPEacXIc7F
         Co7aKab88HX0/EHfH976JiU9K56dsgD9GBOvMu3rPDBXe7jKXU9ddKN2FFoVbwpsy9so
         opAsrVLRY1HQhIys6SAFRQc6N9V3QjmdNFF5Q=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.223.54.152 with SMTP id q24mr131465fag.19.1250830356649; Thu, 
	20 Aug 2009 21:52:36 -0700 (PDT)
In-Reply-To: <Pine.LNX.4.64.0908202141490.21261@radix.cryptio.net>
References: <4A842449.3050505@lexum.umontreal.ca>
	 <84088EC8-93A1-4888-8287-B9898A32ED17@apache.org>
	 <4A8C4CB6.8040009@lexum.umontreal.ca>
	 <Pine.LNX.4.64.0908202141490.21261@radix.cryptio.net>
Date: Fri, 21 Aug 2009 00:52:36 -0400
X-Google-Sender-Auth: 14fdccddf2e0a76b
Message-ID: <c68e39170908202152i23f711dew117f9fd138781120@mail.gmail.com>
Subject: Re: Is there a way to check for field "uniqueness" when indexing?
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Aug 21, 2009 at 12:49 AM, Chris
Hostetter<hossman_lucene@fucit.org> wrote:
>
> : But in that case, I assume Solr does a commit per document added.
>
> not at all ... it computes a signature and then uses that as a unique key.
> IndexWriter.updateDocument does all the hard work.

Right - Solr used to do that hard work, but we handed that over to
Lucene when that capability was added.  It involves batching either
way (but letting Lucene handle it at a lower level is "better" since
it can prevent inconsistencies from crashes).

-Yonik
http://www.lucidimagination.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41956-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 08:19:35 2009
Return-Path: <java-user-return-41956-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14213 invoked from network); 21 Aug 2009 08:19:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 08:19:34 -0000
Received: (qmail 77997 invoked by uid 500); 21 Aug 2009 08:19:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77940 invoked by uid 500); 21 Aug 2009 08:19:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77930 invoked by uid 99); 21 Aug 2009 08:19:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 08:19:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.125.145.37] (HELO mercury.propylon.com) (194.125.145.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 08:19:41 +0000
Received: from propylon-sdsl.sdsl.esat.net ([193.120.101.26] helo=[192.168.213.172])
	by mercury.propylon.com with esmtp (Exim 4.50)
	id 1MePJa-0007SF-SO
	for java-user@lucene.apache.org; Fri, 21 Aug 2009 09:17:38 +0100
Message-ID: <4A8E5886.1070504@propylon.com>
Date: Fri, 21 Aug 2009 09:19:18 +0100
From: John Byrne <john.byrne@propylon.com>
User-Agent: Thunderbird 2.0.0.22 (Windows/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
References: <25063175.post@talk.nabble.com> <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com> <25063964.post@talk.nabble.com> <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com> <25066762.post@talk.nabble.com>
In-Reply-To: <25066762.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-SA-Do-Not-Run: Yes
X-SA-Exim-Connect-IP: 193.120.101.26
X-SA-Exim-Mail-From: john.byrne@propylon.com
X-SA-Exim-Scanned: No (on mercury.propylon.com); SAEximRunCond expanded to false
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Valery,

I'm inclined to disagree with the idea that a token should not be split 
again downstream. I think that is actually a much easier way to handle 
it. I would have the tokenizer return the longest match, and then split 
it in a token filter. In fact I have dones this before and it has worked 
fine for me.

I think you will have to maintain some state within the token filter 
either way - think about how you'd do that in each case:
-To split longer tokens, you will just have to split the token into a 
list of sub-tokens, then temporarily store these, and return them on 
subsequent calls to the filter. When the list is empty, you get another 
token from the tokenizer.

-To join up shorter tokens, you would have to basically do what he 
original tokenizer did - try to match sequences of characters to patterns.

The second way sounds harder to me, and it's the job of the original 
tokenizer anyway. Do the simplest thing that could possibly work!

Regards,
-John

Valery wrote:
> Hi Robert, 
>
> so, would you expect a Tokenizer to consider '/' in both cases as a separate
> Token?
>
> Personally, I see no problem if Tokenzer would do the following job:
>
> "C/C++" ==> TokenStream of { "C", "/", "C", "+", "+"} 
> and come up with "C" and "C++" tokens after processing through the
> downstream tokenfilters.
>
> Similarly:
>
> "SAP R/3" ==> TokenStream of { "SAP", "R", "/", "3"} 
> and getting { "SAP", "R", "/", "3", "R/3", "SAP R/3"} later.
>
> I try to follow a spirit that a token (or its lexem) usually should never be
> parsed again. One can build  more complex (compound) things from the tokens.
> However, usually one never chops a lexem into smaller pieces.
>
> What do you think, Robert?
>
> regards,
> Valery
>
>   
> ------------------------------------------------------------------------
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com 
> Version: 8.5.392 / Virus Database: 270.13.62/2315 - Release Date: 08/20/09 06:05:00
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41957-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 08:23:53 2009
Return-Path: <java-user-return-41957-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16979 invoked from network); 21 Aug 2009 08:23:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 08:23:53 -0000
Received: (qmail 88395 invoked by uid 500); 21 Aug 2009 08:24:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88337 invoked by uid 500); 21 Aug 2009 08:24:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88327 invoked by uid 99); 21 Aug 2009 08:24:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 08:24:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 08:24:04 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MePPT-0007Ss-V9
	for java-user@lucene.apache.org; Fri, 21 Aug 2009 01:23:43 -0700
Message-ID: <25075903.post@talk.nabble.com>
Date: Fri, 21 Aug 2009 01:23:43 -0700 (PDT)
From: Valery <khamenya@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
In-Reply-To: <f18c9dde0908201222i5f85d734y716837e0681ce59e@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: khamenya@gmail.com
References: <25063175.post@talk.nabble.com> <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com> <25063964.post@talk.nabble.com> <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com> <25066762.post@talk.nabble.com> <8f0ad1f30908201148t1e38748elad82b7f5bf1a1c2c@mail.gmail.com> <f18c9dde0908201222i5f85d734y716837e0681ce59e@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Simon,


Simon Willnauer wrote:
> 
> Valery, have you tried to use whitespaceTokenizer / CharTokenizer and
> [...]?!
> 
> simon
> 

yes, I did, please find the info in the initial message. Here are the
excerpts:


Valery wrote:
> 
>   2) WhitespaceTokenizer gives me a lot of lexems that are actually should
> have been chopped into smaller pieces. Example: "C/C++" comes out like a
> single lexem. If I follow this way I end-up with "Tokenization of tokens"
> -- that sounds a bit odd, doesn't it?
> 
>   3) CharTokenizer allows me to add the '/' to be also a token-emitting
> char, but then '/' gets immediately lost like those whitespace chars. In
> result "SAP R/3" ends up with "SAP" "R" "3" and one will need to search
> the original char stream for the "/" char to re-build "SAP R/3" term as a
> whole. 

regards,
Valery



Simon Willnauer wrote:
> 
> Valery, have you tried to [...] and do any further processing in a  custom
> TokenFilter?!
> simon
> 

yes, and that's why I have sent the initial post "Any Tokenizator friendly
to C++, C#, .NET, etc ?"

Simon, what do you expect from the Tokenizer? 
(In other words, what job is exclusively "Tokenizer's Job" and should rather
not be done in downstream filters?)

regards, 
Valery

-- 
View this message in context: http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25075903.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41958-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 08:26:52 2009
Return-Path: <java-user-return-41958-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19090 invoked from network); 21 Aug 2009 08:26:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 08:26:52 -0000
Received: (qmail 95562 invoked by uid 500); 21 Aug 2009 08:27:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95516 invoked by uid 500); 21 Aug 2009 08:27:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95506 invoked by uid 99); 21 Aug 2009 08:27:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 08:27:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 08:27:03 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MePSN-0007Y9-EX
	for java-user@lucene.apache.org; Fri, 21 Aug 2009 01:26:43 -0700
Message-ID: <25075903.post@talk.nabble.com>
Date: Fri, 21 Aug 2009 01:26:43 -0700 (PDT)
From: Valery <khamenya@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: khamenya@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Simon,


Simon Willnauer wrote:
> 
> Valery, have you tried to use whitespaceTokenizer / CharTokenizer and
> [...]?!
> 
> simon
> 

yes, I did, please find the info in the initial message. Here are the
excerpts:


Valery wrote:
> 
>   2) WhitespaceTokenizer gives me a lot of lexems that are actually should
> have been chopped into smaller pieces. Example: "C/C++" comes out like a
> single lexem. If I follow this way I end-up with "Tokenization of tokens"
> -- that sounds a bit odd, doesn't it?
> 
>   3) CharTokenizer allows me to add the '/' to be also a token-emitting
> char, but then '/' gets immediately lost like those whitespace chars. In
> result "SAP R/3" ends up with "SAP" "R" "3" and one will need to search
> the original char stream for the "/" char to re-build "SAP R/3" term as a
> whole. 

regarding this part:


Simon Willnauer wrote:
> 
> Valery, have you tried to [...] and do any further processing in a  custom
> TokenFilter?!
> simon
> 

yes, and that's why I have sent the initial post "Any Tokenizator friendly
to C++, C#, .NET, etc ?"
Actually, I am a bit confused to do a Tokenizer's job in filters and
re-parse the char stream.

Simon, what do you expect from the Tokenizer? 
(In other words, what job is exclusively "Tokenizer's Job" and should rather
not be done in downstream filters?)

regards, 
Valery

-- 
View this message in context: http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25075903.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41959-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 09:09:32 2009
Return-Path: <java-user-return-41959-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44267 invoked from network); 21 Aug 2009 09:09:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 09:09:31 -0000
Received: (qmail 61114 invoked by uid 500); 21 Aug 2009 09:09:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61072 invoked by uid 500); 21 Aug 2009 09:09:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60941 invoked by uid 99); 21 Aug 2009 09:09:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 09:09:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.225 as permitted sender)
Received: from [209.85.220.225] (HELO mail-fx0-f225.google.com) (209.85.220.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 09:09:40 +0000
Received: by fxm25 with SMTP id 25so370878fxm.5
        for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 02:09:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=lvcR7AUU+/MGu/9VvPWmnXw+8pFSpVSRTyG8gxjkfFU=;
        b=se43S5js7dfYmTkyZfVYexzPpgcV81lPpiHPrsyqNVADoGBlwoZJaTmULfQUOQkmas
         //0J7vuzz/wMtUqFH277sheyauoQMm3vuFOmIhTuVCGkkgHiDEKzBk9oKj7WF51C9V13
         KVGkVvWzyNvvYM4WOcASqrWCBwQiUBTx+kUxE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=PQORekP2So+8nGk7l+OmfPa/qt9ZvEBnabxtBlo3So7FXS3Xl3tCqn90yoKJqxWNtU
         DPseWPVIkDZBQZcvV6n29EwpcbOs6nnJUx/jPe91E9Z9Rt4X5r8PGRwvBU9FMWC74Cng
         wTLSfeas+/yWkzEo1vA3stGqlxyAZDi0vfmaw=
MIME-Version: 1.0
Received: by 10.239.168.138 with SMTP id k10mr85992hbe.100.1250845759206; Fri, 
	21 Aug 2009 02:09:19 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <25075903.post@talk.nabble.com>
References: <25075903.post@talk.nabble.com>
Date: Fri, 21 Aug 2009 11:09:19 +0200
Message-ID: <f18c9dde0908210209j53da3db1w2aa8a213854d8427@mail.gmail.com>
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Aug 21, 2009 at 10:26 AM, Valery<khamenya@gmail.com> wrote:
>
> Hi Simon,
>
>
> Simon Willnauer wrote:
>>
>> Valery, have you tried to use whitespaceTokenizer / CharTokenizer and
>> [...]?!
>>
>> simon
>>
>
> yes, I did, please find the info in the initial message. Here are the
> excerpts:
>
>
> Valery wrote:
>>
>> =C2=A0 2) WhitespaceTokenizer gives me a lot of lexems that are actually=
 should
>> have been chopped into smaller pieces. Example: "C/C++" comes out like a
>> single lexem. If I follow this way I end-up with "Tokenization of tokens=
"
>> -- that sounds a bit odd, doesn't it?
>>
>> =C2=A0 3) CharTokenizer allows me to add the '/' to be also a token-emit=
ting
>> char, but then '/' gets immediately lost like those whitespace chars. In
>> result "SAP R/3" ends up with "SAP" "R" "3" and one will need to search
>> the original char stream for the "/" char to re-build "SAP R/3" term as =
a
>> whole.
>
> regarding this part:
>
>
> Simon Willnauer wrote:
>>
>> Valery, have you tried to [...] and do any further processing in a =C2=
=A0custom
>> TokenFilter?!
>> simon
>>
>
> yes, and that's why I have sent the initial post "Any Tokenizator friendl=
y
> to C++, C#, .NET, etc ?"
> Actually, I am a bit confused to do a Tokenizer's job in filters and
> re-parse the char stream.
>
> Simon, what do you expect from the Tokenizer?
> (In other words, what job is exclusively "Tokenizer's Job" and should rat=
her
> not be done in downstream filters?)

Well, Tokenizer, TokenFilter both of them are sub are subclasses of
TokenStream while their input differ. A Tokenizer gets the input from
a reader and creates Tokens from this input. A TokenFilter uses the
tokens created by the Tokenizer and does further processing. For
instance. An Analyzer that uses WhitespaceTokenizer as an input for
LowerCaseFilter would produce the following:


Input:  C# or .NET

WhitespaceTokenizer:
[Tokenstring: "C#"; offset: 0->2; pos: 1]
[Tokenstring: "or"; offset: 3->5; pos: 2]
[Tokenstring: ".Net"; offset: 6->10; pos: 3]
LowerCaseFilter:
[Tokenstring: "c#"; offset: 0->2; pos: 1]
[Tokenstring: "or"; offset: 3->5; pos: 2]
[Tokenstring: ".net"; offset: 6->10; pos: 3]

if you wanna do any further processing with those tokens you can add
your own TokenFilter and modify the tokens as you need. you could do
the whole job in a Tokenizer but this would not be a good separation
of concerns right!?

simon

>
> regards,
> Valery
>
> --
> View this message in context: http://www.nabble.com/Any-Tokenizator-frien=
dly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25075903.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41960-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 10:51:40 2009
Return-Path: <java-user-return-41960-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95621 invoked from network); 21 Aug 2009 10:51:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 10:51:39 -0000
Received: (qmail 94479 invoked by uid 500); 21 Aug 2009 10:51:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94391 invoked by uid 500); 21 Aug 2009 10:51:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94381 invoked by uid 99); 21 Aug 2009 10:51:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 10:51:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 10:51:50 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MeRiT-0002zf-VY
	for java-user@lucene.apache.org; Fri, 21 Aug 2009 03:51:29 -0700
Message-ID: <25076151.post@talk.nabble.com>
Date: Fri, 21 Aug 2009 03:51:29 -0700 (PDT)
From: Valery <khamenya@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
In-Reply-To: <4A8E5886.1070504@propylon.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: khamenya@gmail.com
References: <25063175.post@talk.nabble.com> <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com> <25063964.post@talk.nabble.com> <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com> <25066762.post@talk.nabble.com> <4A8E5886.1070504@propylon.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi John, 

(aren't you the same John Byrne who is a key contributor to the great
OpenSSI project?)


John Byrne-3 wrote:
> 
> I'm inclined to disagree with the idea that a token should not be split 
> again downstream. I think that is actually a much easier way to handle 
> it. I would have the tokenizer return the longest match, and then split 
> it in a token filter. In fact I have dones this before and it has worked 
> fine for me.
> 

well, I could soften my position: if the token re-parsing is done by looking
into currentlexem value only, then it might be perhaps accepted. In
contrast, if during your re-parsing you have to look into the upstream
characters data "several filters backwards", then, IMHO, it is rather messy
and unacceptable. 


Regarding this part:

John Byrne-3 wrote:
> 
> I think you will have to maintain some state within the token filter 
> [...]
> 

I would wait for Simon's answer to the question "What do you expect from the
Tokenizer?"

Then I will give my 2cents on this and perhaps then I could sum up all
opinions and adopt a common conclusion.
:)

regards
Valery

-- 
View this message in context: http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25076151.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41961-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 11:10:23 2009
Return-Path: <java-user-return-41961-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1506 invoked from network); 21 Aug 2009 11:10:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 11:10:23 -0000
Received: (qmail 13404 invoked by uid 500); 21 Aug 2009 11:10:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13305 invoked by uid 500); 21 Aug 2009 11:10:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13295 invoked by uid 99); 21 Aug 2009 11:10:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 11:10:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.125.145.37] (HELO mercury.propylon.com) (194.125.145.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 11:10:31 +0000
Received: from propylon-sdsl.sdsl.esat.net ([193.120.101.26] helo=[192.168.213.172])
	by mercury.propylon.com with esmtp (Exim 4.50)
	id 1MeRyu-0003IV-GK
	for java-user@lucene.apache.org; Fri, 21 Aug 2009 12:08:28 +0100
Message-ID: <4A8E808F.2080602@propylon.com>
Date: Fri, 21 Aug 2009 12:10:07 +0100
From: John Byrne <john.byrne@propylon.com>
User-Agent: Thunderbird 2.0.0.22 (Windows/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
References: <25063175.post@talk.nabble.com> <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com> <25063964.post@talk.nabble.com> <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com> <25066762.post@talk.nabble.com> <4A8E5886.1070504@propylon.com> <25076151.post@talk.nabble.com>
In-Reply-To: <25076151.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-SA-Do-Not-Run: Yes
X-SA-Exim-Connect-IP: 193.120.101.26
X-SA-Exim-Mail-From: john.byrne@propylon.com
X-SA-Exim-Scanned: No (on mercury.propylon.com); SAEximRunCond expanded to false
X-Virus-Checked: Checked by ClamAV on apache.org

Valery wrote:
> Hi John, 
>
> (aren't you the same John Byrne who is a key contributor to the great
> OpenSSI project?)
>   
Nope, never heard of him! But with a great name like that I'm sure he'll 
go a long way :)
>
> John Byrne-3 wrote:
>   
>> I'm inclined to disagree with the idea that a token should not be split 
>> again downstream. I think that is actually a much easier way to handle 
>> it. I would have the tokenizer return the longest match, and then split 
>> it in a token filter. In fact I have dones this before and it has worked 
>> fine for me.
>>
>>     
>
> well, I could soften my position: if the token re-parsing is done by looking
> into currentlexem value only, then it might be perhaps accepted. In
> contrast, if during your re-parsing you have to look into the upstream
> characters data "several filters backwards", then, IMHO, it is rather messy
> and unacceptable. 
>   
If I understand you correctly, that's pretty much what I meant. By 
having the first tokenizer pass larger tokens, and splitting them in the 
filter, you never have to look upstream while storing state. You only 
look upstream for a new token after you are finished splitting the last 
one and sending the parts downstream.

>
> Regarding this part:
>
> John Byrne-3 wrote:
>   
>> I think you will have to maintain some state within the token filter 
>> [...]
>>
>>     
>
> I would wait for Simon's answer to the question "What do you expect from the
> Tokenizer?"
>
> Then I will give my 2cents on this and perhaps then I could sum up all
> opinions and adopt a common conclusion.
> :)
>
> regards
> Valery
>
>   
> ------------------------------------------------------------------------
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com 
> Version: 8.5.392 / Virus Database: 270.13.63/2316 - Release Date: 08/20/09 18:06:00
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41962-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 11:12:01 2009
Return-Path: <java-user-return-41962-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2367 invoked from network); 21 Aug 2009 11:12:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 11:12:01 -0000
Received: (qmail 17804 invoked by uid 500); 21 Aug 2009 11:12:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17716 invoked by uid 500); 21 Aug 2009 11:12:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17706 invoked by uid 99); 21 Aug 2009 11:12:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 11:12:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 72.14.220.155 as permitted sender)
Received: from [72.14.220.155] (HELO fg-out-1718.google.com) (72.14.220.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 11:12:11 +0000
Received: by fg-out-1718.google.com with SMTP id l27so158577fgb.4
        for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 04:11:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=iqrGYbVjZyC+zw9qppVklsK4r19cyo4jXXwOCeHtaTw=;
        b=qU8R/z4E5/3/z9vqB4+vS9BdQNr0dig5HC1q54mXaZHDwZcGFljyVgcB9IvhclxAxM
         t+xWHYQQqjWGcejsL0GK27Sb9On2Rw/8gOb+hIb3PRTYtOLzn64AHPexS3FCUeUUYWF4
         R2BbtbOH4/eysUvk2VNwDqZUbSPGx9NdPHogY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=AjLnFywn1ud52Kfg09920jzKiasU2NMgRVrlwK1xosw7B1iK8PKRAPD9vEFPvug5cy
         yph/EAwGdRaJ7kw2gfcf07fiaQB4l3E9aH0N1GtXgyyy/1PePSn6fQIgk1YQSKjYK+LF
         6ykFoMi6UroCdpI83N9Gb4X+m1UIgT8G+kVlY=
MIME-Version: 1.0
Received: by 10.239.139.132 with SMTP id t4mr97775hbt.88.1250853109932; Fri, 
	21 Aug 2009 04:11:49 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <25076151.post@talk.nabble.com>
References: <25063175.post@talk.nabble.com>
	 <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com>
	 <25063964.post@talk.nabble.com>
	 <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com>
	 <25066762.post@talk.nabble.com> <4A8E5886.1070504@propylon.com>
	 <25076151.post@talk.nabble.com>
Date: Fri, 21 Aug 2009 13:11:49 +0200
Message-ID: <f18c9dde0908210411r4b63053ue8823b371fa778f0@mail.gmail.com>
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Aug 21, 2009 at 12:51 PM, Valery<khamenya@gmail.com> wrote:
>
> Hi John,
>
> (aren't you the same John Byrne who is a key contributor to the great
> OpenSSI project?)
>
>
> John Byrne-3 wrote:
>>
>> I'm inclined to disagree with the idea that a token should not be split
>> again downstream. I think that is actually a much easier way to handle
>> it. I would have the tokenizer return the longest match, and then split
>> it in a token filter. In fact I have dones this before and it has worked
>> fine for me.
>>
>
> well, I could soften my position: if the token re-parsing is done by looking
> into currentlexem value only, then it might be perhaps accepted. In
> contrast, if during your re-parsing you have to look into the upstream
> characters data "several filters backwards", then, IMHO, it is rather messy
> and unacceptable.
>
>
> Regarding this part:
>
> John Byrne-3 wrote:
>>
>> I think you will have to maintain some state within the token filter
>> [...]
>>
>
> I would wait for Simon's answer to the question "What do you expect from the
> Tokenizer?"
>
I already responded...
again...
<snip>
Well, Tokenizer, TokenFilter both of them are sub are subclasses of
TokenStream while their input differ. A Tokenizer gets the input from
a reader and creates Tokens from this input. A TokenFilter uses the
tokens created by the Tokenizer and does further processing. For
instance. An Analyzer that uses WhitespaceTokenizer as an input for
LowerCaseFilter would produce the following:


Input:  C# or .NET

WhitespaceTokenizer:
[Tokenstring: "C#"; offset: 0->2; pos: 1]
[Tokenstring: "or"; offset: 3->5; pos: 2]
[Tokenstring: ".Net"; offset: 6->10; pos: 3]
LowerCaseFilter:
[Tokenstring: "c#"; offset: 0->2; pos: 1]
[Tokenstring: "or"; offset: 3->5; pos: 2]
[Tokenstring: ".net"; offset: 6->10; pos: 3]

if you wanna do any further processing with those tokens you can add
your own TokenFilter and modify the tokens as you need. you could do
the whole job in a Tokenizer but this would not be a good separation
of concerns right!?
</snip>

Tokenizer splits the input stream into tokens (Token.java) and
TokenFilter subclasses operate on those. I expect from a Tokenizer
that is provides me a stream of tokens :) - how those tokens are
created is the responsibility of the Tokenizer. to LowerCase, remove
Stopwords, adding payloads etc. is the job of the TokenFilter.

simon

> Then I will give my 2cents on this and perhaps then I could sum up all
> opinions and adopt a common conclusion.
> :)
>
> regards
> Valery
>
> --
> View this message in context: http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25076151.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41963-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 11:14:00 2009
Return-Path: <java-user-return-41963-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2758 invoked from network); 21 Aug 2009 11:14:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 11:14:00 -0000
Received: (qmail 20375 invoked by uid 500); 21 Aug 2009 11:14:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20287 invoked by uid 500); 21 Aug 2009 11:14:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20269 invoked by uid 99); 21 Aug 2009 11:14:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 11:14:20 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 11:14:09 +0000
Received: by ywh26 with SMTP id 26so795951ywh.5
        for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 04:13:48 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.59.12 with SMTP id h12mr2077804yba.39.1250853228047; Fri, 
	21 Aug 2009 04:13:48 -0700 (PDT)
In-Reply-To: <-3936163573164025315@unknownmsgid>
References: <-61520930041827677@unknownmsgid>
	 <9ac0c6aa0908200237kcb7d0f3q73d37b5fdec27f2d@mail.gmail.com>
	 <-3936163573164025315@unknownmsgid>
Date: Fri, 21 Aug 2009 07:13:48 -0400
Message-ID: <9ac0c6aa0908210413w92a8280rd8a1d9deb0548bb8@mail.gmail.com>
Subject: Re: Merge Exception in Lucene 2.4
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

That code looks fine...

What OS/filesystem are you using?

Can you make a small test case that shows the issue?

Mike

On Thu, Aug 20, 2009 at 7:41 AM, Sumanta
Bhowmik<sumanta.bhowmik@guavus.com> wrote:
> We put all the IndexWriters in an array which is defined by
>
> final Directory[] finalDir;
>
> We also declare an indexer
> As
> private volatile static Indexer indexer;
>
> final Indexer finalIndexer =3D indexer;
>
> Next we call the merge in a new thread :
>
> Thread thread =3D new Thread(){
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public void run()
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0logger.debug("starts merging w/o
> optimization");
>
> finalIndexer.getWriter().addIndexesNoOptimize(finalDir);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0logger.debug("ends merging w/o
> optimization");
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (C=
orruptIndexException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0logger.notice("",e);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (I=
OException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0logger.notice("",e);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0}
> }
>
> Sumanta
>
>
>
>
> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: Thursday, August 20, 2009 3:07 PM
> To: java-user@lucene.apache.org
> Subject: Re: Merge Exception in Lucene 2.4
>
> You should definitely upgrade to the latest JDK 1.6 to get the fix for
> the JRE bug in LUCENE-1282, but, I don't think you are hitting that
> bug (read past EOF during merge is a different exception).
>
> Can you describe more detail on how you merge 6 IndexWriters?
>
> Mike
>
> On Thu, Aug 20, 2009 at 5:21 AM, Sumanta
> Bhowmik<sumanta.bhowmik@guavus.com> wrote:
>> I checked at http://issues.apache.org/jira/browse/LUCENE-1282
>> SegmentMerger.java has this code
>>
>> TermFreqVector[] vectors =3D reader.getTermFreqVectors(docNum);
>> termVectorsWriter.addAllDocVectors(vectors);
>>
>> so this issue appears inspite of this fix.
>>
>> I am using java version "1.6.0_07". Is it fixed in jdk6u10 and above
>> (http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=3D6707044) ?
>>
>> Regards
>> Sumanta
>>
>>
>> -----Original Message-----
>> From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]
>> Sent: Thursday, August 20, 2009 1:15 PM
>> To: java-user@lucene.apache.org
>> Subject: Merge Exception in Lucene 2.4
>>
>> Hi
>>
>>
>>
>> I am getting this issue in Lucene2.4 when I try to merge multiple
>> IndexWriters(generally 6)
>>
>>
>>
>> sh-3.2# Exception in thread "Lucene Merge Thread #5"
>> org.apache.lucene.index.MergePolicy$MergeException: java.io.IOException:
>> read past EOF
>>
>> =A0 =A0 =A0 =A0at
>>
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
>> rentMergeScheduler.java:309)
>>
>> =A0 =A0 =A0 =A0at
>>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>> ergeScheduler.java:286)
>>
>> Caused by: java.io.IOException: read past EOF
>>
>> =A0 =A0 =A0 =A0at
>>
> org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.j=
ava
>> :135)
>>
>> =A0 =A0 =A0 =A0at
>>
> org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.ja=
va:
>> 228)
>>
>> =A0 =A0 =A0 =A0at
>>
> org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:=
184
>> )
>>
>> =A0 =A0 =A0 =A0at
>>
> org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.ja=
va:
>> 204)
>>
>> =A0 =A0 =A0 =A0at
>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4260)
>>
>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.=
java:3877)
>>
>> =A0 =A0 =A0 =A0at
>>
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
>> duler.java:205)
>>
>> =A0 =A0 =A0 =A0at
>>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>> ergeScheduler.java:260)
>>
>>
>>
>>
>>
>> Is this a known issue and has any fix been provided for it ? Would
>> appreciate any help.
>>
>>
>>
>> Regards
>>
>> Sumanta
>>
>>
>>
>>
>>
>>
>>
>>
>> __________ NOD32 4349 (20090819) Information __________
>>
>> This message was checked by NOD32 antivirus system.
>> http://www.eset.com
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> __________ NOD32 4350 (20090820) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41964-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 11:45:45 2009
Return-Path: <java-user-return-41964-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12614 invoked from network); 21 Aug 2009 11:45:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 11:45:45 -0000
Received: (qmail 70871 invoked by uid 500); 21 Aug 2009 11:46:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70779 invoked by uid 500); 21 Aug 2009 11:46:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70769 invoked by uid 99); 21 Aug 2009 11:46:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 11:46:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 11:45:55 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MeSYo-0004Sv-OD
	for java-user@lucene.apache.org; Fri, 21 Aug 2009 04:45:34 -0700
Message-ID: <25077083.post@talk.nabble.com>
Date: Fri, 21 Aug 2009 04:45:34 -0700 (PDT)
From: Valery <khamenya@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
In-Reply-To: <f18c9dde0908210209j53da3db1w2aa8a213854d8427@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: khamenya@gmail.com
References: <25063175.post@talk.nabble.com> <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com> <25063964.post@talk.nabble.com> <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com> <25066762.post@talk.nabble.com> <8f0ad1f30908201148t1e38748elad82b7f5bf1a1c2c@mail.gmail.com> <f18c9dde0908201222i5f85d734y716837e0681ce59e@mail.gmail.com> <25075903.post@talk.nabble.com> <f18c9dde0908210209j53da3db1w2aa8a213854d8427@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org



Simon Willnauer wrote:
> 
> you could do
> the whole job in a Tokenizer but this would not be a good separation
> of concerns right!?
> 

right, it wouldn't be a good separation of concerns. 
That's why I wanted to know what you consider as "Tokenizer's job".


-- 
View this message in context: http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25077083.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41965-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 11:56:07 2009
Return-Path: <java-user-return-41965-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17011 invoked from network); 21 Aug 2009 11:56:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 11:56:07 -0000
Received: (qmail 83563 invoked by uid 500); 21 Aug 2009 11:56:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83493 invoked by uid 500); 21 Aug 2009 11:56:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83482 invoked by uid 99); 21 Aug 2009 11:56:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 11:56:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.132.241 as permitted sender)
Received: from [209.85.132.241] (HELO an-out-0708.google.com) (209.85.132.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 11:56:16 +0000
Received: by an-out-0708.google.com with SMTP id b2so216798ana.5
        for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 04:55:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=ZF+wCHFDM1bsDKasplZKpsW0Rscu7GXnakJz6vSz2FA=;
        b=kGAqgDXbMlAaNLeKIDWuA8wEuEyOFnoIOI+Edk8VY4QrWOe2ssq1f8LAmRDLMEfD+C
         /qYMRjDlnWGs//vkJWVONb6IXcAhwluuQbWzKbZJsE0NBBCENG5pkdVxyGi5WyvxMoal
         +/D5k0w7zJr7GyCdX47xXi7rYzaCwyxBWHqnM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=RRvXizn/b4VybexH3BYCUCr16U3vUfD3Uhz79XuPwCx24uRNjGo9TQgUsG1eBbMIsb
         aeG/hRLY+pbv56QwAcCxRpDxNChcAfqwreyuZy1MYJcJzxB8zua3HDJHgqV8ewW4wloy
         kti/18navRu56ZU5zoL2AV2foADitg5fyhzQ8=
MIME-Version: 1.0
Received: by 10.101.176.38 with SMTP id d38mr952243anp.12.1250855755189; Fri, 
	21 Aug 2009 04:55:55 -0700 (PDT)
In-Reply-To: <25077083.post@talk.nabble.com>
References: <25063175.post@talk.nabble.com>
	 <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com>
	 <25063964.post@talk.nabble.com>
	 <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com>
	 <25066762.post@talk.nabble.com>
	 <8f0ad1f30908201148t1e38748elad82b7f5bf1a1c2c@mail.gmail.com>
	 <f18c9dde0908201222i5f85d734y716837e0681ce59e@mail.gmail.com>
	 <25075903.post@talk.nabble.com>
	 <f18c9dde0908210209j53da3db1w2aa8a213854d8427@mail.gmail.com>
	 <25077083.post@talk.nabble.com>
Date: Fri, 21 Aug 2009 07:55:55 -0400
Message-ID: <8f0ad1f30908210455s3570ae5bmef7b9c9bc284ab16@mail.gmail.com>
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Valery,

FWIW, to answer this question, I think the answer is still "it depends".
I agree with John, I think it is much easier for your tokenizer to
create tokens that contain all the context you need for the downstream
filters to do their job.
I don't think you can put some exact specification on what this is, it
really does depend on a lot of things, mostly the way that you need to
handle text for your application.

For an extreme example, the Tokenizer in lucene contrib's
SmartChineseAnalyzer (SentenceTokenizer) actually outputs entire
phrases as tokens.
This is because the downstream tokenfilter (WordTokenFilter) needs
that kind of context to subdivide the phrases into words.

On Fri, Aug 21, 2009 at 7:45 AM, Valery<khamenya@gmail.com> wrote:
>
>
> Simon Willnauer wrote:
>>
>> you could do
>> the whole job in a Tokenizer but this would not be a good separation
>> of concerns right!?
>>
>
> right, it wouldn't be a good separation of concerns.
> That's why I wanted to know what you consider as "Tokenizer's job".
>
>
> --
> View this message in context: http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25077083.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41966-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 12:18:32 2009
Return-Path: <java-user-return-41966-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27186 invoked from network); 21 Aug 2009 12:18:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 12:18:32 -0000
Received: (qmail 20923 invoked by uid 500); 21 Aug 2009 12:18:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20844 invoked by uid 500); 21 Aug 2009 12:18:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20834 invoked by uid 99); 21 Aug 2009 12:18:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 12:18:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 12:18:43 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MeT4Y-0005XD-I5
	for java-user@lucene.apache.org; Fri, 21 Aug 2009 05:18:22 -0700
Message-ID: <25078755.post@talk.nabble.com>
Date: Fri, 21 Aug 2009 05:18:22 -0700 (PDT)
From: Valery <khamenya@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
In-Reply-To: <f18c9dde0908210411r4b63053ue8823b371fa778f0@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: khamenya@gmail.com
References: <25063175.post@talk.nabble.com> <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com> <25063964.post@talk.nabble.com> <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com> <25066762.post@talk.nabble.com> <4A8E5886.1070504@propylon.com> <25076151.post@talk.nabble.com> <f18c9dde0908210411r4b63053ue8823b371fa778f0@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org



Simon Willnauer wrote:
> 
> I already responded... again...
> 
sorry, I've been in answering and seen your post right after sending.


Simon Willnauer wrote:
> 
> Tokenizer splits the input stream into tokens (Token.java) and
> TokenFilter subclasses operate on those. I expect from a Tokenizer
> that is provides me a stream of tokens :) - how those tokens are
> created is the responsibility of the Tokenizer.

According to your requirements:

 * one programmer will write a simplistic Tokenizer that converts a whole
char input into a 1 huge token. 

 * another programmer will write a simplistic Tokenizer that converts each
single char of the input into a 1-char token.  It will end up in a huge
number of 1-char tokens.

Moreoever, both claim the job is done in a brilliant way, because the
Tokenizer is based on a 1-line statement in Java...

Who did the work better?

Said that, I'd love to hear more specific requirements about Tokenizer to
avoid the above odd deliveries :)

regards
Valery

-- 
View this message in context: http://www.nabble.com/Any-Tokenizator-friendly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25078755.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41967-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 12:43:23 2009
Return-Path: <java-user-return-41967-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43451 invoked from network); 21 Aug 2009 12:43:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 12:43:23 -0000
Received: (qmail 61717 invoked by uid 500); 21 Aug 2009 12:43:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61665 invoked by uid 500); 21 Aug 2009 12:43:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61655 invoked by uid 99); 21 Aug 2009 12:43:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 12:43:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 12:43:31 +0000
Received: by bwz10 with SMTP id 10so460153bwz.5
        for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 05:43:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=hGXSKE9slqY5Y0SwCOfj+ij9s6QFyrNbD45z3E7tZ54=;
        b=nIJerpfojCpQnBjA6vAXdm9MJwiuQttgt0KI3sBdULJdnSNQIoEgaEWpZOEHBkwiFL
         v/05Oc+qsZPZ60C2L55I1jftxFe3h4I+/wuZ8TSoz+tIzsrjfVW4+jAigjM4MKvDqxF4
         cENoWUBkTReJ6zjT0PtrbUOZN0GW7OWScpusg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=JIUw9DXK3xK2dcUf4aNGOhgsYcg711pVbdqwZIV8kxh73+SZbGLqfzZtA7SJMIIlIy
         b1NGlJgl14XkIOdWe5IIkXLjI2mF2fWL7TYl4r9cr8qFmqn6ZWiAUeFUSX1ptCqPCKdw
         XYRMZr9Jnatv+axWkQfJOnk5TQm1kEHt1+xJo=
MIME-Version: 1.0
Received: by 10.239.163.205 with SMTP id q13mr92745hbd.132.1250858591022; Fri, 
	21 Aug 2009 05:43:11 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <25078755.post@talk.nabble.com>
References: <25063175.post@talk.nabble.com>
	 <8f0ad1f30908200736x3dc1c6fcrc084e74dd8b5f07@mail.gmail.com>
	 <25063964.post@talk.nabble.com>
	 <8f0ad1f30908200820o77e17418oc37c709ae786115b@mail.gmail.com>
	 <25066762.post@talk.nabble.com> <4A8E5886.1070504@propylon.com>
	 <25076151.post@talk.nabble.com>
	 <f18c9dde0908210411r4b63053ue8823b371fa778f0@mail.gmail.com>
	 <25078755.post@talk.nabble.com>
Date: Fri, 21 Aug 2009 14:43:10 +0200
Message-ID: <f18c9dde0908210543x768a7d71q82a918a5f297ff81@mail.gmail.com>
Subject: Re: Any Tokenizator friendly to C++, C#, .NET, etc ?
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Aug 21, 2009 at 2:18 PM, Valery<khamenya@gmail.com> wrote:
>
>
> Simon Willnauer wrote:
>>
>> I already responded... again...
>>
> sorry, I've been in answering and seen your post right after sending.
>
>
> Simon Willnauer wrote:
>>
>> Tokenizer splits the input stream into tokens (Token.java) and
>> TokenFilter subclasses operate on those. I expect from a Tokenizer
>> that is provides me a stream of tokens :) - how those tokens are
>> created is the responsibility of the Tokenizer.
>
> According to your requirements:
>
> =C2=A0* one programmer will write a simplistic Tokenizer that converts a =
whole
> char input into a 1 huge token.
>
> =C2=A0* another programmer will write a simplistic Tokenizer that convert=
s each
> single char of the input into a 1-char token. =C2=A0It will end up in a h=
uge
> number of 1-char tokens.
>
> Moreoever, both claim the job is done in a brilliant way, because the
> Tokenizer is based on a 1-line statement in Java...
>
> Who did the work better?
>
> Said that, I'd love to hear more specific requirements about Tokenizer to
> avoid the above odd deliveries :)
The answer is again "it depends"  if you need two tokenizers one
creating tokens by dividing at non-lettser and another one dividing at
whitespaces a Tokenizer that output every single char is a good super
class for those two.
See LetterTokenizer / WhitespaceTokenizer and their common superclass
CharTokenizer.

Asking the question who did a better job is not valid without
specifying the requirements. Anyway, does WhitespaceTokenizer solve
your problem?!
As Robert said - have a look at the smartcn stuff this is the other
extreme - it always depends.

simon
>
> regards
> Valery
>
> --
> View this message in context: http://www.nabble.com/Any-Tokenizator-frien=
dly-to-C%2B%2B%2C-C-%2C-.NET%2C-etc---tp25063175p25078755.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41968-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 14:00:47 2009
Return-Path: <java-user-return-41968-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84866 invoked from network); 21 Aug 2009 14:00:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 14:00:46 -0000
Received: (qmail 20395 invoked by uid 500); 21 Aug 2009 14:01:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20322 invoked by uid 500); 21 Aug 2009 14:01:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20312 invoked by uid 99); 21 Aug 2009 14:01:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 14:01:06 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 14:00:57 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MeUfV-0001GG-22
	for java-user@lucene.apache.org; Fri, 21 Aug 2009 07:00:37 -0700
Message-ID: <25080365.post@talk.nabble.com>
Date: Fri, 21 Aug 2009 07:00:37 -0700 (PDT)
From: javaguy44 <javaguy44@yahoo.com>
To: java-user@lucene.apache.org
Subject: Lucene SORT does a sort on entire index..how do I filter SORT?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: javaguy44@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I'm currently looking at sorting in lucene, and to get started I took a look
at the distance sorting example from the Lucene in Action book.

Working through the test DistanceSortingTest, I've noticed that performing
the SORT ends up sorting the whole index!

To test this I did the following:
 - added a few more lines in setup()
    addPoint(writer, "Nico's Fish Shop", "fishmongerie", 10, 10);
    addPoint(writer, "Nico's Fish Shop deux", "fishmongerie", 10, 10);

 - I added a log statement to DistanceComparatorSource in the
while(termDocs.next()) loop
 - I ran DistanceSortingTest.testNearesRestaurantToHome and to my surprise I
had 6 sorts / log lines of output in while(termDocs.next()) loop

DistanceSortingTest.testNearesRestaurantToHome searches by the query term
new TermQuery(new Term("type", "restaurant")).  As such shouldn't the index
be filtered first (to 4 documents) before the DistanceSort occurs?

Obviously this is not ideal in a million+ document index and assuming you
had 100, 200 records that were hit based on the term.

Would appreciate someone's input / advice on how to filter first
-- 
View this message in context: http://www.nabble.com/Lucene-SORT-does-a-sort-on-entire-index..how-do-I-filter-SORT--tp25080365p25080365.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41969-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 21 16:53:27 2009
Return-Path: <java-user-return-41969-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74694 invoked from network); 21 Aug 2009 16:53:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Aug 2009 16:53:27 -0000
Received: (qmail 62104 invoked by uid 500); 21 Aug 2009 16:53:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62038 invoked by uid 500); 21 Aug 2009 16:53:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62028 invoked by uid 99); 21 Aug 2009 16:53:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 16:53:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jason.rutherglen@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Aug 2009 16:53:37 +0000
Received: by qw-out-2122.google.com with SMTP id 8so547539qwh.53
        for <java-user@lucene.apache.org>; Fri, 21 Aug 2009 09:53:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=EFdEtgmVwfjdX+7YgbP7uRQvvUW4clkldd8gEpNmWek=;
        b=XNeixXuXtghWr89ivEpk4+XxohPajUvA77Ea7hkr2R/9QAD/MWdNLgcbrX9N8CM4+3
         +42WUEhNip/XoaQezx7dv6m4iODhAR8sGR1Tqyb1UL9/Myf7ET8eN1W9tFrFT+Dz5YV9
         AEmPdzgRNStHdD3LAectD31TnHjB8C8U/80c8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=xo7zgOAnmC8kXdLWB5dMP0YP1fpW2yEG2dSvQTtCyW/iWFNQ3NWx52ATRgvcnvlbek
         +JrQy90Y8bEXHufLVZIRnNijbISyVGQq9bZKLXWKUWaPlpWBCrPllAFjkwyyIdWF9Wl3
         EBpb/IaYSdbM7CT5j9iSuSPTu2ReaITRh/J7c=
MIME-Version: 1.0
Received: by 10.224.29.74 with SMTP id p10mr889198qac.290.1250873596427; Fri, 
	21 Aug 2009 09:53:16 -0700 (PDT)
In-Reply-To: <25080365.post@talk.nabble.com>
References: <25080365.post@talk.nabble.com>
Date: Fri, 21 Aug 2009 09:53:16 -0700
Message-ID: <85d3c3b60908210953k25872bf3q894399bc546e1c27@mail.gmail.com>
Subject: Re: Lucene SORT does a sort on entire index..how do I filter SORT?
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Take a look at contrib/spatial.

On Fri, Aug 21, 2009 at 7:00 AM, javaguy44<javaguy44@yahoo.com> wrote:
>
> Hi,
>
> I'm currently looking at sorting in lucene, and to get started I took a l=
ook
> at the distance sorting example from the Lucene in Action book.
>
> Working through the test DistanceSortingTest, I've noticed that performin=
g
> the SORT ends up sorting the whole index!
>
> To test this I did the following:
> =A0- added a few more lines in setup()
> =A0 =A0addPoint(writer, "Nico's Fish Shop", "fishmongerie", 10, 10);
> =A0 =A0addPoint(writer, "Nico's Fish Shop deux", "fishmongerie", 10, 10);
>
> =A0- I added a log statement to DistanceComparatorSource in the
> while(termDocs.next()) loop
> =A0- I ran DistanceSortingTest.testNearesRestaurantToHome and to my surpr=
ise I
> had 6 sorts / log lines of output in while(termDocs.next()) loop
>
> DistanceSortingTest.testNearesRestaurantToHome searches by the query term
> new TermQuery(new Term("type", "restaurant")). =A0As such shouldn't the i=
ndex
> be filtered first (to 4 documents) before the DistanceSort occurs?
>
> Obviously this is not ideal in a million+ document index and assuming you
> had 100, 200 records that were hit based on the term.
>
> Would appreciate someone's input / advice on how to filter first
> --
> View this message in context: http://www.nabble.com/Lucene-SORT-does-a-so=
rt-on-entire-index..how-do-I-filter-SORT--tp25080365p25080365.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41981-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 11:17:58 2009
Return-Path: <java-user-return-41981-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84616 invoked from network); 22 Aug 2009 11:17:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 11:17:58 -0000
Received: (qmail 70212 invoked by uid 500); 22 Aug 2009 11:18:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70128 invoked by uid 500); 22 Aug 2009 11:18:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70118 invoked by uid 99); 22 Aug 2009 11:18:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 11:18:17 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 11:18:06 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 4C607549BF
	for <java-user@lucene.apache.org>; Sat, 22 Aug 2009 07:17:45 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute2.internal (MEProxy); Sat, 22 Aug 2009 07:17:45 -0400
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:content-type:content-transfer-encoding; s=smtpout; bh=1sL6yNOvMRP7B/XIShocGfLuTVA=; b=J+76BIjsj4YuohZ90QBH8EMx4QGGxpRNMilLp/nEbr2tNE77yRIRFVPj2EEsIrDdTPwVAj/RVhzmcVkraU6sSBOhRBuL+ZWX5vSIDqaM9cUuWFMRf+cPFp2egSpnGLf660dlboG9UZRo5cT14D4sh+JMU9taLOocuyfdPdvb0R4=
X-Sasl-enc: unjM8uOulnQ7ahLcwvEQP1nAg4/ZUUpTuJmjjR4UUaGb 1250939864
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 8C8CCB45D
	for <java-user@lucene.apache.org>; Sat, 22 Aug 2009 07:17:44 -0400 (EDT)
Message-ID: <4A8FD3D7.4010805@fastmail.fm>
Date: Sat, 22 Aug 2009 12:17:43 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: Lucene Users <java-user@lucene.apache.org>
Subject: Query parser fails on Hangul/Korean
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

public class Issue3341Test extends TestCase {

public void testMatchHangul() throws Exception {
Analyzer analyzer = new StandardAnalyzer();
RAMDirectory dir = new RAMDirectory();
IndexWriter writer = new IndexWriter(dir, analyzer, true, 
IndexWriter.MaxFieldLength.LIMITED);
Document doc = new Document();
doc.add(new Field("name", "키드갱", Field.Store.YES, Field.Index.ANALYZED));
writer.addDocument(doc);
writer.close();

IndexSearcher searcher = new IndexSearcher(dir,true);
Query q = new QueryParser("name", analyzer).parse("키드갱");
System.out.println(q.toString());


Hits hits = searcher.search(q);
assertEquals(1, hits.length());
}

}

gives the following:

org.apache.lucene.queryParser.ParseException: Cannot parse '???': '*' or 
'?' not allowed as first character in WildcardQuery
at org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:181)
at 
org.musicbrainz.search.analysis.Issue3341Test.testMatchHangul(Issue3341Test.java:32)

Why does the parser think its a wildcard.
(I'm just using the standard analyser, because the search could be 
performed in any language, but the user doesnt specify the language so 
we don't know what analyser to use. But thats okay I dont expect lucene 
to do anything clever but I would expect a match when index and query 
are identical.)


thanks Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41982-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 11:45:48 2009
Return-Path: <java-user-return-41982-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88197 invoked from network); 22 Aug 2009 11:45:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 11:45:48 -0000
Received: (qmail 83990 invoked by uid 500); 22 Aug 2009 11:46:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83923 invoked by uid 500); 22 Aug 2009 11:46:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83910 invoked by uid 99); 22 Aug 2009 11:46:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 11:46:08 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.16] (HELO web52906.mail.re2.yahoo.com) (206.190.49.16)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 22 Aug 2009 11:45:57 +0000
Received: (qmail 44839 invoked by uid 60001); 22 Aug 2009 11:45:35 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1250941535; bh=kIHyzH0Cz+cevGQfq8f2IisfkzbpYY9W4pfv6IyiKB0=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=NiOQpn0R1qbWjw/E+X9MautZ6AZazz68Fjl++c2KJcA7imGEccatPq+n4LBNH5huRRDTd5PChBzUxDUaW6T74j5I1oxAlySpaykS9kJPeU+zpyfIAg8qckig34VrqtFy74stxPBiDsUH1Dr+IWj1D9elyHcHxIXAOr3Fzf35VVo=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=ect4IXn1N8xK8n2djGMLZF65see6ZpTiUu7jUul3tvjRYTvrMZ4LMDLm82753UuVoNtcku/vYwSWOqJXm09RBITa9r6Gi+b6rh1RkRYL6EP9aZHwlqC1nZmXsUUCLJqWFkezKbBJY7WCM7Ku5kYWxKapjOTk6va92qTlNLivLVs=;
Message-ID: <918755.44703.qm@web52906.mail.re2.yahoo.com>
X-YMail-OSG: NeGZt2sVM1nEBqQdjsvYpXnBQpM9NWy53oPEo1zlof5g.hGdkhqxrfVtlxwjwp3M.T7ekYK2IfRw9pBcFZYPI.xw791SRp9w2SuWfmMJlzVDScaLafC3aMoe1X3lZ2MZpOODUc_5GxFFkn3KwR6EqGWrKkXMOqvtqrR4Wh30RTbI0QJeRDnu6LADn7fXpRgH7ugxdElx7JTGaZ9dY9tejN3Fa3gfzHjP08DBujTq73afQoxcBP_EDFwVQbPv7IytdkqvIeeBDoa0cboRxZNqq3S.gaCBYpXaxsXm_jZftw1_unVm6Ovbo096FCFQQYRfTO5RcnaCnwQAhCnw.r1g_Na1GGjnjuASiFsdiU58xxyxJ4C3jlBV
Received: from [88.239.196.4] by web52906.mail.re2.yahoo.com via HTTP; Sat, 22 Aug 2009 04:45:35 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.1
Date: Sat, 22 Aug 2009 04:45:35 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Using HitCollector to Collect First N Hits
To: java-user@lucene.apache.org
In-Reply-To: <20090822050824.M44709@jostleme.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

> I=E2=80=99m using Lucene 2.4.1 and I=E2=80=99m trying to use a custom=0A>=
 HitCollector to collect only the first N hits (not the best hits) for=0A> =
performance.=C2=A0=0A=0AYou mean that you do not need score calculation the=
refore you do not want results sorted by relevancy. Just you need is a Bool=
ean Retrieval Model, right? All results will have ConstantScore (0 or 1).=
=0A=0AIf yes, I think omitting norms and tfs of your searchable fields can =
improve your search performance without writing custom HitCollector.=0A=0A=
=0A=0Avoid org.apache.lucene.document.Field.setOmitNorms(true) =0AUsing Fie=
ld.Index.ANALYZED_NO_NORMS in constructor.=0Avoid org.apache.lucene.documen=
t.Field.setOmitTf(true)  =0A=0A=0ABut i am not sure those changes are enoug=
h to convert Vector Space Model to Boolean Retrieval Model. I think there s=
hould be another trick to not to calculate score/similarity at all. =0A=0A_=
_________________________________________________=0ADo You Yahoo!?=0ATired =
of spam?  Yahoo! Mail has the best spam protection around =0Ahttp://mail.ya=
hoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41983-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 12:12:58 2009
Return-Path: <java-user-return-41983-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92047 invoked from network); 22 Aug 2009 12:12:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 12:12:57 -0000
Received: (qmail 95167 invoked by uid 500); 22 Aug 2009 12:13:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95097 invoked by uid 500); 22 Aug 2009 12:13:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95087 invoked by uid 99); 22 Aug 2009 12:13:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 12:13:17 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 12:13:08 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MepSg-000493-Tw
	for java-user@lucene.apache.org; Sat, 22 Aug 2009 05:12:46 -0700
Message-ID: <25093309.post@talk.nabble.com>
Date: Sat, 22 Aug 2009 05:12:46 -0700 (PDT)
From: Rafis <irafis@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Using HitCollector to Collect First N Hits
In-Reply-To: <20090822050824.M44709@jostleme.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: irafis@yahoo.com
References: <20090822050824.M44709@jostleme.com>
X-Virus-Checked: Checked by ClamAV on apache.org



Len Takeuchi-2 wrote:
>=20
> I=C2=92m using Lucene 2.4.1 and I=C2=92m trying to use a custom HitCollec=
tor to
> collect
> only the first N hits (not the best hits) for performance.  I saw another
> e-mail in this group where they mentioned writing a HitCollector which
> throws
> an exception after N hits to do this.  So I tried this approach and it
> seems
> as if my HitCollector isn=C2=92t called until the hits have been determin=
ed,
> i.e.
> the time until my HitCollector is called is dependent on the number of
> hits
> and my performance is no better than when I was not using a custom
> HitCollector.
>=20
>=20
In my case count of found hits was required, so there was no throwing
exception.=20

/**
 * Hit collector to collect only first docs ignoring score
 * @author Rafis
 */
public class LimitedHitCollector extends HitCollector {
=09public final int capacity;
=09public final int[] docs;
=09private int count;
=09
=09public LimitedHitCollector(int capacity) {
=09=09this.capacity =3D capacity;
=09=09docs =3D new int[capacity];
=09}
=09
=09@Override
=09public void collect(int doc, float score) {
=09=09if (count < capacity)
=09=09=09docs[count] =3D doc;
//=09=09else
//=09=09=09throw custom exception here to break search, if you do not need =
real
count
=09=09count++;
=09}
=09
=09/**
=09 * @return Number of collected docs
=09 */
=09public int getSize() {
=09=09return Math.min(count, capacity);
=09}

=09/**
=09 * @return Number of found docs
=09 */
=09public int getCount() {
=09=09return count;
=09}
=09
}


Add throwing exception in collect(int doc, float score) to break search:

=09@Override
=09public void collect(int doc, float score) {
=09=09if (count < capacity)
=09=09=09docs[count++] =3D doc;
=09=09else
=09=09=09throw new SomeRuntimeException();
=09}

And catch it from search.

Regards,
Rafis
--=20
View this message in context: http://www.nabble.com/Using-HitCollector-to-C=
ollect-First-N-Hits-tp25090722p25093309.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41984-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 12:22:54 2009
Return-Path: <java-user-return-41984-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94670 invoked from network); 22 Aug 2009 12:22:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 12:22:54 -0000
Received: (qmail 2181 invoked by uid 500); 22 Aug 2009 12:23:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2123 invoked by uid 500); 22 Aug 2009 12:23:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2105 invoked by uid 99); 22 Aug 2009 12:23:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 12:23:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.225 as permitted sender)
Received: from [209.85.220.225] (HELO mail-fx0-f225.google.com) (209.85.220.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 12:23:02 +0000
Received: by fxm25 with SMTP id 25so867427fxm.5
        for <java-user@lucene.apache.org>; Sat, 22 Aug 2009 05:22:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=cyIlCs1fSMpi2E4quLOxZzT5+31ZB8thwOML9wqy8A4=;
        b=uxyh2ZimFh4T3hJOQeXHSaQg04XWrrPbE4HCgUJ3iZTYJh8S7T4NjocmjICqg2utWQ
         yWB1H/vDGLDq4OFTgFYLog9naHzK2UmvEpc5azfQ1y2QWtMsLKqfedu2U8LNnmZCgGGv
         edmoGFOS7K67qOuZAC2WCVZineMQ3WOJoOS7w=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=RU3sx5ErQ8849/epxnAjQpDSII5klbf/GUR3QBVKh4UXTWJ07iasLxhLhdxWHUv3LZ
         z0WtwaccaX41aY/fWXZ18u+2eFIHityf6YAPQ6woFeyHH4zIKCpSkmQdppQSDSIHB1by
         NwZP4gig3SDpp+OnSASgvogvjAaLatgQTSau0=
MIME-Version: 1.0
Received: by 10.239.182.153 with SMTP id q25mr240761hbg.138.1250943761691; 
	Sat, 22 Aug 2009 05:22:41 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <4A8FD3D7.4010805@fastmail.fm>
References: <4A8FD3D7.4010805@fastmail.fm>
Date: Sat, 22 Aug 2009 14:22:41 +0200
Message-ID: <f18c9dde0908220522x3ad3304dvb795bd13dc204dd3@mail.gmail.com>
Subject: Re: Query parser fails on Hangul/Korean
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Paul, my frist guess would be that your source file encoding is set to
something else than UTF-8. Those characters should be supported by
lucene - none of them are > 16bit so I don't see why this should be
caused by lucene.

I'm pretty sure thats a encoding issues. R u running on windows?!

hope that helps,

simon

On Sat, Aug 22, 2009 at 1:17 PM, Paul Taylor<paul_t100@fastmail.fm> wrote:
> public class Issue3341Test extends TestCase {
>
> public void testMatchHangul() throws Exception {
> Analyzer analyzer =3D new StandardAnalyzer();
> RAMDirectory dir =3D new RAMDirectory();
> IndexWriter writer =3D new IndexWriter(dir, analyzer, true,
> IndexWriter.MaxFieldLength.LIMITED);
> Document doc =3D new Document();
> doc.add(new Field("name", "=ED=82=A4=EB=93=9C=EA=B0=B1", Field.Store.YES,=
 Field.Index.ANALYZED));
> writer.addDocument(doc);
> writer.close();
>
> IndexSearcher searcher =3D new IndexSearcher(dir,true);
> Query q =3D new QueryParser("name", analyzer).parse("=ED=82=A4=EB=93=9C=
=EA=B0=B1");
> System.out.println(q.toString());
>
>
> Hits hits =3D searcher.search(q);
> assertEquals(1, hits.length());
> }
>
> }
>
> gives the following:
>
> org.apache.lucene.queryParser.ParseException: Cannot parse '???': '*' or =
'?'
> not allowed as first character in WildcardQuery
> at org.apache.lucene.queryParser.QueryParser.parse(QueryParser.java:181)
> at
> org.musicbrainz.search.analysis.Issue3341Test.testMatchHangul(Issue3341Te=
st.java:32)
>
> Why does the parser think its a wildcard.
> (I'm just using the standard analyser, because the search could be perfor=
med
> in any language, but the user doesnt specify the language so we don't kno=
w
> what analyser to use. But thats okay I dont expect lucene to do anything
> clever but I would expect a match when index and query are identical.)
>
>
> thanks Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41985-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 12:34:39 2009
Return-Path: <java-user-return-41985-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95734 invoked from network); 22 Aug 2009 12:34:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 12:34:39 -0000
Received: (qmail 6086 invoked by uid 500); 22 Aug 2009 12:34:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5993 invoked by uid 500); 22 Aug 2009 12:34:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5983 invoked by uid 99); 22 Aug 2009 12:34:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 12:34:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 12:34:48 +0000
Received: by bwz10 with SMTP id 10so860477bwz.5
        for <java-user@lucene.apache.org>; Sat, 22 Aug 2009 05:34:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=ABNhu2uWtCQ7Icwxi8PIqQREfQV0EWBxH3BqRoWd9no=;
        b=dTVGrWo0udIVVkbNR1AzI6V0C00phfcJGQbCXocUD+jrzTSQSOQsIIsj4jU4dm5d18
         lewDB32BpS2MptCwvvAu1DJTD9HO29CpsMI57pgNwIu2vDAIBOCjanY/6IzjrmbcaaaU
         X1fiZ9oDz3qsEwIE57U0K0tIhDYzwJ0HuldHA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=k9XYjrPOX67e1gwOPrgo03lDq/WG1jYo7m7SBTa3Sa5VpkwFKtaFS4q3HLKCGJls/o
         iC6scGnnHuruMEKu4yp/HzzcNqchgs64/hQLZ5weMfViBgioivkikQD0uCiQz3Mqsfrt
         a6br8xtzfi2cXSBtzoyfgoBJxK3ASWkrPNk3A=
MIME-Version: 1.0
Received: by 10.239.170.35 with SMTP id q35mr239678hbe.150.1250944467404; Sat, 
	22 Aug 2009 05:34:27 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <20090822050824.M44709@jostleme.com>
References: <20090822050824.M44709@jostleme.com>
Date: Sat, 22 Aug 2009 14:34:27 +0200
Message-ID: <f18c9dde0908220534w63dc7051xf0ae53b14f0f98e7@mail.gmail.com>
Subject: Re: Using HitCollector to Collect First N Hits
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Len,
what kind of query do you execute when you collect the hits.
HitCollector should be called for each document by the time it is
scored. Is it possible that you run a query that could be expensive in
terms of term expansion like WildcardQuery?

simon


On Sat, Aug 22, 2009 at 7:09 AM, Len Takeuchi<ltakeuchi@jostleme.com> wrote=
:
> Hello,
>
> I=E2=80=99m using Lucene 2.4.1 and I=E2=80=99m trying to use a custom Hit=
Collector to collect
> only the first N hits (not the best hits) for performance. =C2=A0I saw an=
other
> e-mail in this group where they mentioned writing a HitCollector which th=
rows
> an exception after N hits to do this. =C2=A0So I tried this approach and =
it seems
> as if my HitCollector isn=E2=80=99t called until the hits have been deter=
mined, i.e.
> the time until my HitCollector is called is dependent on the number of hi=
ts
> and my performance is no better than when I was not using a custom
> HitCollector. =C2=A0Does anyone have insight into my problem? =C2=A0The p=
erson who tried
> approach mentioned performance improved significantly for him.
>
> Regards,
> Len
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41986-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 12:57:02 2009
Return-Path: <java-user-return-41986-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98331 invoked from network); 22 Aug 2009 12:57:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 12:57:02 -0000
Received: (qmail 18207 invoked by uid 500); 22 Aug 2009 12:57:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18126 invoked by uid 500); 22 Aug 2009 12:57:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18116 invoked by uid 99); 22 Aug 2009 12:57:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 12:57:20 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mayankjuneja1@gmail.com designates 209.85.222.174 as permitted sender)
Received: from [209.85.222.174] (HELO mail-pz0-f174.google.com) (209.85.222.174)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 12:57:11 +0000
Received: by pzk4 with SMTP id 4so272426pzk.29
        for <java-user@lucene.apache.org>; Sat, 22 Aug 2009 05:56:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=B4oWgdW85Uqx69mGB19Vx5Fl4xpI1EeCT05iSBLJOag=;
        b=Rfor1aBnSP/Wj4wd0r07eD2818KNryuwleFKNNbt9R42FmlrGaH4kECaKB2jfKKQOk
         uTml+UdFk1/qhPIDUuKWgfeo20zxvmWa09sSI2g+bQM7BOlZvggjQqfKWMlcBwIWZHmz
         mLUz5wsuwmFYB56tccL0r+PL81v3WY9oL9SH0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=gDMQpVEWApDdrlbTSIl/ymjpuLFSsmhkLTrKs3FdlfIxWq888E5Tfje31Oo8vL3t65
         P3pWR+bLyUs1kuZTcCO8aawDFRydTwIm2TKTfQ7LMhX5g+xBwMvM+xGBkSxC/Vg0jk/B
         dxILmbn6hpGGQfTPBcs6YLZ7b9jaCZbtFWLK4=
MIME-Version: 1.0
Received: by 10.115.114.7 with SMTP id r7mr336544wam.70.1250945810455; Sat, 22 
	Aug 2009 05:56:50 -0700 (PDT)
Date: Sat, 22 Aug 2009 18:26:50 +0530
Message-ID: <eced85100908220556s2a9215b2jd8069b08287130cc@mail.gmail.com>
Subject: Incremental Indexing in PyLucene
From: mayank juneja <mayankjuneja1@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64eeac2aa5f030471ba84e1
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64eeac2aa5f030471ba84e1
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

I am building a database of text files using PyLucene. I need to add new
text files to the index at regular intervals. Since I am a beginner, I do
not know how to build the index incremently. Can anyone guide me how to
accomplish the task ?

Any kind of help would be appreciated.

Thanks,
Mayank Juneja

--0016e64eeac2aa5f030471ba84e1--

From java-user-return-41987-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 13:40:22 2009
Return-Path: <java-user-return-41987-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3795 invoked from network); 22 Aug 2009 13:40:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 13:40:22 -0000
Received: (qmail 37485 invoked by uid 500); 22 Aug 2009 13:40:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37408 invoked by uid 500); 22 Aug 2009 13:40:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37398 invoked by uid 99); 22 Aug 2009 13:40:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 13:40:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 13:40:31 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MeqpH-0006p5-2K
	for java-user@lucene.apache.org; Sat, 22 Aug 2009 06:40:11 -0700
Message-ID: <25093931.post@talk.nabble.com>
Date: Sat, 22 Aug 2009 06:40:11 -0700 (PDT)
From: jlman <josh.lincoln@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to het the score in percentage
In-Reply-To: <Pine.LNX.4.64.0905011433110.17125@radix.cryptio.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: josh.lincoln@gmail.com
References: <23293723.post@talk.nabble.com> <Pine.LNX.4.64.0905011433110.17125@radix.cryptio.net>
X-Virus-Checked: Checked by ClamAV on apache.org



hossman wrote:
> 
> 
> : here ie, in our existing system we are showing the search score in
> : percenetage but lucene provides the search score in numbers which is
> derived
> : from some internal logic. Can anybody give some tips for converting the
> : lucene score to percentage or is there any way to retrive the score as
> : percentage from lucene search. 
> 
> there is an extremely important and fundemental question you have to 
> answer when you say you want "the score as a percentage" ... 
> 
> 	A percentage of what exactly?
> 
> score values are meaningful only for purposes of comparison between other 
> documents for the exact same query and the exact same index.  when you try 
> to compute a percentage, you are setting up an implicit comparison with 
> scores from other queries.
> 
> -Hoss
> 
> 

There is one situation where comparison is viable. When the input is an
existing document (ie - using the mlt function or doing a simple query using
a document's title/body). In such cases, the score of the document to itself
(which will hopefully be the max score in the result set) is the scaling
factor. With this approach we can answer the question "are docs A and B more
similar than docs C and D".

This may even be the approach used by carrot for clustering, though I
haven't looked into how it generates its similarity matrix. (note - it's
also possible that the scores between two docs aren't bi-directional,
meaning A is more similar to B than B is to A)

Perhaps treating each query as a document would allow lucene to return the
max score possible for that query (the match to itself), and then scale
documents from there. Yes, there are lots of challenges to actually doing
this since you wouldn't want to actually add a temporary doc to the index.

I know this topic usually morphs into assessing if a percentage-match is
useful. While I agree that scaled/normalized scores are prone to misuse, we
need a way to know if there are any good results, not just what the best
results are. One use case is when users submit content similar to existing
content and you'd like to alert them to the near-duplicate before
proceeding. Obviously you only want to prompt them if there are close
matches, and currently lucene only offers a way to get the most similar
docs, not a way to determine if any are actually similar.
-- 
View this message in context: http://www.nabble.com/How-to-het-the-score-in-percentage-tp23293756p25093931.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41988-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 13:42:52 2009
Return-Path: <java-user-return-41988-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4053 invoked from network); 22 Aug 2009 13:42:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 13:42:52 -0000
Received: (qmail 39637 invoked by uid 500); 22 Aug 2009 13:43:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39552 invoked by uid 500); 22 Aug 2009 13:43:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39542 invoked by uid 99); 22 Aug 2009 13:43:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 13:43:11 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 13:42:59 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 2BEB745EFEB
	for <java-user@lucene.apache.org>; Sat, 22 Aug 2009 15:42:39 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id yGqftK4lbSxW for <java-user@lucene.apache.org>;
	Sat, 22 Aug 2009 15:42:29 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 1D32145EFE6
	for <java-user@lucene.apache.org>; Sat, 22 Aug 2009 15:42:29 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <eced85100908220556s2a9215b2jd8069b08287130cc@mail.gmail.com>
Subject: RE: Incremental Indexing in PyLucene
Date: Sat, 22 Aug 2009 15:42:28 +0200
Message-ID: <6BE4C2E105184126A204F6F7551FAC06@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <eced85100908220556s2a9215b2jd8069b08287130cc@mail.gmail.com>
Thread-Index: AcojKBwQMc5VtHG3QGe5wnE396RVjAABjCUQ
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

This mailing list is about Lucene Java! Please ask your question in the
PyLucene list.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: mayank juneja [mailto:mayankjuneja1@gmail.com]
> Sent: Saturday, August 22, 2009 2:57 PM
> To: java-user@lucene.apache.org
> Subject: Incremental Indexing in PyLucene
> 
> Hi,
> 
> I am building a database of text files using PyLucene. I need to add new
> text files to the index at regular intervals. Since I am a beginner, I do
> not know how to build the index incremently. Can anyone guide me how to
> accomplish the task ?
> 
> Any kind of help would be appreciated.
> 
> Thanks,
> Mayank Juneja


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41989-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 13:50:24 2009
Return-Path: <java-user-return-41989-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4503 invoked from network); 22 Aug 2009 13:50:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 13:50:24 -0000
Received: (qmail 42880 invoked by uid 500); 22 Aug 2009 13:50:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42815 invoked by uid 500); 22 Aug 2009 13:50:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42805 invoked by uid 99); 22 Aug 2009 13:50:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 13:50:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 13:50:33 +0000
Received: by bwz10 with SMTP id 10so877684bwz.5
        for <java-user@lucene.apache.org>; Sat, 22 Aug 2009 06:50:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=JEycCJer9UwJZdQVuo3D73kSmvjHoxtiiIfGESaxqho=;
        b=lj5xwOamS2+nbwhEZ4LQoH8cKn8vhySlSBRavoqBeiQGAa6jT4GW7DSn5l1w002vvC
         X42LEyqwYUx96Fiz4FxgSc65ql54n+NCcbazaTe0eTW9jZ01+PEP81VgdIDMuQgJ7gLn
         trnQeLbvZuAIlZYUUrq3IKEwxvX39tj1l5uHo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=jE19p2kUJ39UVv3XCxHrWKnEoZDEw8BzkZPRonzbRZ39fU5b1GCwIzFZ83K67KQk3G
         ZXUK5D1ar+qfzVsBuNXuhQRCuaK5I3TZ9zbeKq2hgYZ7PeHOY/FvxCHpG1/O+LAxLtFB
         PncaQKjGA7p7fCqZwbXTTnAAb8uwefBlYrotA=
MIME-Version: 1.0
Received: by 10.239.139.132 with SMTP id t4mr251499hbt.88.1250949012131; Sat, 
	22 Aug 2009 06:50:12 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <eced85100908220556s2a9215b2jd8069b08287130cc@mail.gmail.com>
References: <eced85100908220556s2a9215b2jd8069b08287130cc@mail.gmail.com>
Date: Sat, 22 Aug 2009 15:50:12 +0200
Message-ID: <f18c9dde0908220650g6cd3d8c8o2d41c3b61c5d94a@mail.gmail.com>
Subject: Re: Incremental Indexing in PyLucene
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

this is the java users mailing list - you will get help on the user
mailinglist of pylucene:

http://lucene.apache.org/pylucene/resources/mailing_lists.html

simon

On Sat, Aug 22, 2009 at 2:56 PM, mayank juneja<mayankjuneja1@gmail.com> wrote:
> Hi,
>
> I am building a database of text files using PyLucene. I need to add new
> text files to the index at regular intervals. Since I am a beginner, I do
> not know how to build the index incremently. Can anyone guide me how to
> accomplish the task ?
>
> Any kind of help would be appreciated.
>
> Thanks,
> Mayank Juneja
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41990-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 14:02:30 2009
Return-Path: <java-user-return-41990-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6677 invoked from network); 22 Aug 2009 14:02:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 14:02:30 -0000
Received: (qmail 52352 invoked by uid 500); 22 Aug 2009 14:02:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52285 invoked by uid 500); 22 Aug 2009 14:02:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52275 invoked by uid 99); 22 Aug 2009 14:02:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 14:02:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of shashi.mit@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 14:02:40 +0000
Received: by yxe3 with SMTP id 3so848763yxe.29
        for <java-user@lucene.apache.org>; Sat, 22 Aug 2009 07:02:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=J2O8d4LjuRPWsW8mxAMudDbtwl6P+G53RktXM8+d+9A=;
        b=f/+d2fmiwwvVu8QRBVR1AO/m1PzLFPyAiYStv7C/WHOXBdY2fi3oHyqJKBoQX/VJxl
         cnGxGhfRJAxxnbbvC2nOmkYL6fpsTDGumL0JnruEeBHEWf0BXsMbmefMoXSAZC2nDgo4
         hnf6HFKCbCNEVNf51/4qw8SDIUtTpjz0DLEoE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=uwJxb/mohWAUd0DjkQNZB3JNY+xXtanUBRYRINoDamZ8sCoqEijj6SwJUtp17Pr9qC
         x8rL5GVGf4cIcRktygmJBtDyZl//kLBxzHs0ig67tRmnmb+Sfvb7c3RFByzbvFGNT4O9
         MuDRGPC9+PeU8q2xO8eBq68SmrifO4R/MMPkA=
MIME-Version: 1.0
Received: by 10.150.62.2 with SMTP id k2mr4257299yba.232.1250949739052; Sat, 
	22 Aug 2009 07:02:19 -0700 (PDT)
In-Reply-To: <25093931.post@talk.nabble.com>
References: <23293723.post@talk.nabble.com> <Pine.LNX.4.64.0905011433110.17125@radix.cryptio.net> 
	<25093931.post@talk.nabble.com>
From: Shashi Kant <shashi.mit@gmail.com>
Date: Sat, 22 Aug 2009 10:01:59 -0400
Message-ID: <4d19a3630908220701g5c6441aw42ed18cfdd08b1dd@mail.gmail.com>
Subject: Re: How to het the score in percentage
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Chris & Erick's arguments are persuasive , however we do live in an
imperfect world. Most of our users want to see the relative importance
of a results vis-a-vis the rest....

Relative Importance (%) = (d - dmin)/(dmax-dmin) * 100

Where dmax is the highest Lucene score (score of top result) and dmin
is the least (the score of the last result) and d = current score.

This would work for any n results.

While this might be technically 'meh', we took a simple normalization
approach of Lucene scores, it helped the users in gauging the relative
importance and relate better. End of day, isn't that what matters
most?

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41991-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 15:52:04 2009
Return-Path: <java-user-return-41991-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24941 invoked from network); 22 Aug 2009 15:52:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 15:52:03 -0000
Received: (qmail 21200 invoked by uid 500); 22 Aug 2009 15:52:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21112 invoked by uid 500); 22 Aug 2009 15:52:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21102 invoked by uid 99); 22 Aug 2009 15:52:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 15:52:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ltakeuchi@jostleme.com designates 69.27.117.2 as permitted sender)
Received: from [69.27.117.2] (HELO bx172.blacksun.ca) (69.27.117.2)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 15:52:12 +0000
Received: from webmail.jostleme.com (localhost [127.0.0.1])
	by bx172.blacksun.ca (8.13.1/8.13.1) with ESMTP id n7MFpeQT014499;
	Sat, 22 Aug 2009 09:51:41 -0600
From: "Len Takeuchi" <ltakeuchi@jostleme.com>
To: java-user@lucene.apache.org
Subject: Re: Using HitCollector to Collect First N Hits
Date: Sat, 22 Aug 2009 08:51:40 -0700
Message-Id: <20090822155000.M1251@jostleme.com>
X-Mailer: OpenWebMail 2.52 20060502
X-OriginatingIP: 70.79.218.180 (len)
MIME-Version: 1.0
Content-Type: text/plain;
	charset=iso-8859-1
X-yoursite-MailScanner-Information: Please contact the ISP for more information
X-yoursite-MailScanner: Found to be clean
X-yoursite-MailScanner-From: ltakeuchi@jostleme.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

I have attached the original thread from where I got my information at the 
very bottom in case it is of any help. In regards to whether I want just a 
boolean retrieval model, in the usage we are currently discussing, the 
answer is yes (I don't care about the score).  However, we also do other 
queries in other use cases where we do care about the score.

In regards to the type of query, we are using a prefix query.  We have a 
problem with performance when the prefix entered by the user is short 
because it yields a large number of hits.  I was hoping that taking the 
approach I mentioned, search engine would call the HitCollector 
incrementally and give me a chance to end the search earlier but it seems 
like it is not happening.  Do you think the problem is with term expansion?

Regards,
Len

----- original message -----
From: simon.willnauer [at] googlemail
Re: Using HitCollector to Collect First N Hits 

Hi Len, 
what kind of query do you execute when you collect the hits. 
HitCollector should be called for each document by the time it is 
scored. Is it possible that you run a query that could be expensive in 
terms of term expansion like WildcardQuery? 

simon 

----- original message -----
>From : ltakeuchi [at] jostleme
Stop search process when a given number of hits is reached 
Hello, 

Im using Lucene 2.4.1 and Im trying to use a custom HitCollector to 
collect 
only the first N hits (not the best hits) for performance. I saw another 
e-mail in this group where they mentioned writing a HitCollector which 
throws 
an exception after N hits to do this. So I tried this approach and it seems 
as if my HitCollector isnt called until the hits have been determined, i.e. 
the time until my HitCollector is called is dependent on the number of hits 
and my performance is no better than when I was not using a custom 
HitCollector. Does anyone have insight into my problem? The person who tried 
approach mentioned performance improved significantly for him. 

Regards, 
Len 







ORIGINAL THREAD BELOW
=====================

----- original message -----
>From : yodapoubelle [at] yahoo
Re : Stop search process when a given number of hits is reached 

Thanks a lot for your responses... 

I have tried the HitCollector and throw an exception when the limit of hits 
is reached... 
It works fine and the search time is really reduce when there is a lot of 
docs which are matching the query... 

I did that : 

public class CountCollector extends HitCollector{ 
public int cpt; 
private int _maxHit; 
public CountCollector(int maxHit) 
{ 
cpt = 0; 
_maxHit = maxHit 
} 
public void collect(int arg0, float arg1) 
{ 
cpt++; 
if (cpt > _max_Hit) 
{ 
throw new LimitIsReachedException(); 
} 
} 
} 

With a simple try catch, I catch the exception, and display "cpt" (the 
counter)... 

Best regards 

----- Message d'origine ---- 
De : Andrzej Bialecki <ab[at]getopt.org> 
À : java-user[at]lucene.apache.org 
Envoyé le : Jeudi, 7 Août 2008, 14h29mn 31s 
Objet : Re: Stop search process when a given number of hits is reached 

Doron Cohen wrote: 
> Nothing built in that I'm aware of will do this, but it can be done by 
> searching with your own HitCollector. 
> There is a related feature - stop search after a specified time - using 
> TimeLimitedCollector. 
> It is not released yet, see issue LUCENE-997. 
> In short, the collector's collect() method is invoked in the search 
process 
> for each matching document. 
> Once 500 docs were collected, your collector can cause the search to stop 
by 
> throwing an exception. 
> Upon catching the exception you know that 500 docs were collected. 

Two additional comments: 

* the topN results from such incomplete search may be way off, if there 
were some high scoring documents somewhere beyond the limit. 

* if you know that there are more important and less important documents 
in your corpus, and their relative weight is independent of the query 
(e.g. PageRank-type score), then you can restructure your index so that 
postings belonging to highly-scoring documents come first on the posting 
lists - this way you have a better chance to collect highly relevant 
documents first, even though the search is incomplete. You can find an 
implementation of this concept in Nutch 
(org.apache.nutch.indexer.IndexSorter). 

-- 
Best regards, 
Andrzej Bialecki <>< 
___. ___ ___ ___ _ _ __________________________________ 
[__ || __|__/|__||\/| Information Retrieval, Semantic Web 
___|||__|| \| || | Embedded Unix, System Integration 
http://www.sigram.com Contact: info at sigram dot com 


----- original message -----
>From : yodapoubelle [at] yahoo
Stop search process when a given number of hits is reached Remove 
Highlighting  

Hello 

Is there a way to stop the search process when a given number of hits is 
reached? 

I have a counter feature which displays how many docs match a query. 
This counter is blocked; I mean that if there are more than 500 docs, it 
will just display "more than 500". 
I don't care about the exact amount of docs matched by the query, the order 
of the hits or whatever... 
What I want is to stop the search process when it reaches at least 500 hits 
in order to improve performance... 
(I want an average search time in about 50 - 100 ms) 

I experimented with the following methods : 
For the same query: 
with search(Query query, Filter filter, Sort sort) hits=157691 docs in 
searchingTime=2514 ms 
with search(Query query, Filter filter, int n) (with n = 50) TopDocs 
totalHits 157691 in searchingTime= 2360 ms 

For another query: 
With search(Query query, Filter filter, Sort sort) hits=1208 docs in 
searchingTime=750 ms 
With search(Query query, Filter filter, int n) (with n = 50) TopDocs 
totalHits 1208 in searchingTime= 718 ms 

For another query: 
With search(Query query, Filter filter, Sort sort) hits=16174 cv(s) 
searchingTime=1297 ms 
With search(Query query, Filter filter, int n) (with n = 50) TopDocs 
totalHits 16174 in searchingTime= 1219 ms 

According to this results, replacing the first method by the other has no 
effect on either the search 
time or total number of hits returned 

Also the lucene version used now is 1.9.1 (but i work on the evolution to 
2.3.2) 


Thanks a lot 
(Sorry for my bad English ... you will easily guess, I’m French ;) 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41992-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 16:19:16 2009
Return-Path: <java-user-return-41992-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28713 invoked from network); 22 Aug 2009 16:19:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 16:19:16 -0000
Received: (qmail 37392 invoked by uid 500); 22 Aug 2009 16:19:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37329 invoked by uid 500); 22 Aug 2009 16:19:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37319 invoked by uid 99); 22 Aug 2009 16:19:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 16:19:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 72.14.220.158 as permitted sender)
Received: from [72.14.220.158] (HELO fg-out-1718.google.com) (72.14.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 16:19:24 +0000
Received: by fg-out-1718.google.com with SMTP id l26so319039fgb.4
        for <java-user@lucene.apache.org>; Sat, 22 Aug 2009 09:19:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=Ff6dxEH/wsBoKJCPFAuMFUKVoDpaFnLg6qT41hZf6Jc=;
        b=iHZvv9tIIL5P/Us2MxSkA7y8LuomLmhlvZkq+XFFpYjPPS4qz0e3uU2/swl35bhAjJ
         adC6Y/8LML0S4RCscvjGequ0QFBpcYM03EhrgAOr30B61Od9t6AWYAIrf06DIal8KgV4
         UVtJiOjuMhDYEn47i9wngcrcnaMCYfiQwVFt0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=FceD/iYu9vH5QoY8iXzOG50dHnsYoO1XqWOXvJCFEKzgYfzOoySARTz+BFOoNT5SOi
         TP64YZgBGlOVLt677ybqxD4/Oiig/M5fWOwywulR6LIc6tbt4zXCl4cMjJCyXdGweYZr
         bS176nm6zKAPA2fJ53rRLmKBOpwbIHNfWky3I=
MIME-Version: 1.0
Received: by 10.239.163.195 with SMTP id q3mr250678hbd.108.1250957943310; Sat, 
	22 Aug 2009 09:19:03 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <20090822155000.M1251@jostleme.com>
References: <20090822155000.M1251@jostleme.com>
Date: Sat, 22 Aug 2009 18:19:03 +0200
Message-ID: <f18c9dde0908220919x577d1302y84a808b61ce4268f@mail.gmail.com>
Subject: Re: Using HitCollector to Collect First N Hits
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Len,

On Sat, Aug 22, 2009 at 5:51 PM, Len Takeuchi<ltakeuchi@jostleme.com> wrote=
:
> Hello,
>
> I have attached the original thread from where I got my information at th=
e
> very bottom in case it is of any help. In regards to whether I want just =
a
> boolean retrieval model, in the usage we are currently discussing, the
> answer is yes (I don't care about the score). =C2=A0However, we also do o=
ther
> queries in other use cases where we do care about the score.
>
> In regards to the type of query, we are using a prefix query. =C2=A0We ha=
ve a
> problem with performance when the prefix entered by the user is short
> because it yields a large number of hits. =C2=A0I was hoping that taking =
the
> approach I mentioned, search engine would call the HitCollector
> incrementally and give me a chance to end the search earlier but it seems
> like it is not happening. =C2=A0Do you think the problem is with term exp=
ansion?
that is what my first guess was and I'm pretty sure that the long time
is taken before the documents get scored. A short prefix can easily
expand to thousands of terms, do you encounter
TooManyClausesExceptions and in turn do you set
BooleanQuery#setMaxClauseCount() to a higher value than 1024?
I wonder if BooleanQuery#setAllowDocsOutOfOrder(true) would give you
any performance hit if you don't care about the order of how the docs
come in. Any idea how many terms your prefix query expands to?

simon
>
> Regards,
> Len
>
> ----- original message -----
> From: simon.willnauer [at] googlemail
> Re: Using HitCollector to Collect First N Hits
>
> Hi Len,
> what kind of query do you execute when you collect the hits.
> HitCollector should be called for each document by the time it is
> scored. Is it possible that you run a query that could be expensive in
> terms of term expansion like WildcardQuery?
>
> simon
>
> ----- original message -----
> From : ltakeuchi [at] jostleme
> Stop search process when a given number of hits is reached
> Hello,
>
> I=E2=80=99m using Lucene 2.4.1 and I=E2=80=99m trying to use a custom Hit=
Collector to
> collect
> only the first N hits (not the best hits) for performance. I saw another
> e-mail in this group where they mentioned writing a HitCollector which
> throws
> an exception after N hits to do this. So I tried this approach and it see=
ms
> as if my HitCollector isn=E2=80=99t called until the hits have been deter=
mined, i.e.
> the time until my HitCollector is called is dependent on the number of hi=
ts
> and my performance is no better than when I was not using a custom
> HitCollector. Does anyone have insight into my problem? The person who tr=
ied
> approach mentioned performance improved significantly for him.
>
> Regards,
> Len
>
>
>
>
>
>
>
> ORIGINAL THREAD BELOW
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>
> ----- original message -----
> From : yodapoubelle [at] yahoo
> Re : Stop search process when a given number of hits is reached
>
> Thanks a lot for your responses...
>
> I have tried the HitCollector and throw an exception when the limit of hi=
ts
> is reached...
> It works fine and the search time is really reduce when there is a lot of
> docs which are matching the query...
>
> I did that :
>
> public class CountCollector extends HitCollector{
> public int cpt;
> private int _maxHit;
> public CountCollector(int maxHit)
> {
> cpt =3D 0;
> _maxHit =3D maxHit
> }
> public void collect(int arg0, float arg1)
> {
> cpt++;
> if (cpt > _max_Hit)
> {
> throw new LimitIsReachedException();
> }
> }
> }
>
> With a simple try catch, I catch the exception, and display "cpt" (the
> counter)...
>
> Best regards
>
> ----- Message d'origine ----
> De : Andrzej Bialecki <ab[at]getopt.org>
> =C3=80 : java-user[at]lucene.apache.org
> Envoy=C3=A9 le : Jeudi, 7 Ao=C3=BBt 2008, 14h29mn 31s
> Objet : Re: Stop search process when a given number of hits is reached
>
> Doron Cohen wrote:
>> Nothing built in that I'm aware of will do this, but it can be done by
>> searching with your own HitCollector.
>> There is a related feature - stop search after a specified time - using
>> TimeLimitedCollector.
>> It is not released yet, see issue LUCENE-997.
>> In short, the collector's collect() method is invoked in the search
> process
>> for each matching document.
>> Once 500 docs were collected, your collector can cause the search to sto=
p
> by
>> throwing an exception.
>> Upon catching the exception you know that 500 docs were collected.
>
> Two additional comments:
>
> * the topN results from such incomplete search may be way off, if there
> were some high scoring documents somewhere beyond the limit.
>
> * if you know that there are more important and less important documents
> in your corpus, and their relative weight is independent of the query
> (e.g. PageRank-type score), then you can restructure your index so that
> postings belonging to highly-scoring documents come first on the posting
> lists - this way you have a better chance to collect highly relevant
> documents first, even though the search is incomplete. You can find an
> implementation of this concept in Nutch
> (org.apache.nutch.indexer.IndexSorter).
>
> --
> Best regards,
> Andrzej Bialecki <><
> ___. ___ ___ ___ _ _ __________________________________
> [__ || __|__/|__||\/| Information Retrieval, Semantic Web
> ___|||__|| \| || | Embedded Unix, System Integration
> http://www.sigram.com Contact: info at sigram dot com
>
>
> ----- original message -----
> From : yodapoubelle [at] yahoo
> Stop search process when a given number of hits is reached Remove
> Highlighting
>
> Hello
>
> Is there a way to stop the search process when a given number of hits is
> reached?
>
> I have a counter feature which displays how many docs match a query.
> This counter is blocked; I mean that if there are more than 500 docs, it
> will just display "more than 500".
> I don't care about the exact amount of docs matched by the query, the ord=
er
> of the hits or whatever...
> What I want is to stop the search process when it reaches at least 500 hi=
ts
> in order to improve performance...
> (I want an average search time in about 50 - 100 ms)
>
> I experimented with the following methods :
> For the same query:
> with search(Query query, Filter filter, Sort sort) hits=3D157691 docs in
> searchingTime=3D2514 ms
> with search(Query query, Filter filter, int n) (with n =3D 50) TopDocs
> totalHits 157691 in searchingTime=3D 2360 ms
>
> For another query:
> With search(Query query, Filter filter, Sort sort) hits=3D1208 docs in
> searchingTime=3D750 ms
> With search(Query query, Filter filter, int n) (with n =3D 50) TopDocs
> totalHits 1208 in searchingTime=3D 718 ms
>
> For another query:
> With search(Query query, Filter filter, Sort sort) hits=3D16174 cv(s)
> searchingTime=3D1297 ms
> With search(Query query, Filter filter, int n) (with n =3D 50) TopDocs
> totalHits 16174 in searchingTime=3D 1219 ms
>
> According to this results, replacing the first method by the other has no
> effect on either the search
> time or total number of hits returned
>
> Also the lucene version used now is 1.9.1 (but i work on the evolution to
> 2.3.2)
>
>
> Thanks a lot
> (Sorry for my bad English ... you will easily guess, I=E2=80=99m French ;=
)
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41993-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 16:32:01 2009
Return-Path: <java-user-return-41993-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30207 invoked from network); 22 Aug 2009 16:32:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 16:32:01 -0000
Received: (qmail 46069 invoked by uid 500); 22 Aug 2009 16:32:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45994 invoked by uid 500); 22 Aug 2009 16:32:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45984 invoked by uid 99); 22 Aug 2009 16:32:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 16:32:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.225 as permitted sender)
Received: from [209.85.220.225] (HELO mail-fx0-f225.google.com) (209.85.220.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 16:32:08 +0000
Received: by fxm25 with SMTP id 25so924942fxm.5
        for <java-user@lucene.apache.org>; Sat, 22 Aug 2009 09:31:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=KjuNLzXDylVPrMt+UN5TX2NYV/exr5w7u3YLFhHAs5Q=;
        b=Lu7XoJFWrhbsGeCHBO9S8dt3QAafxTJtiMyOPTSz8ldw542RnKhCLia0wyImULP+FX
         n/1w1pjujBTU4QJYdamPkcYwH8064SIkqR4OiDrXw1jSKeynfUeLo6MoA3UoSAis03EN
         V66QcGxeOGsTiE7H3cKUPQxzn2ocmlNHANd2Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=VQJuDGOf2cSo96SWHez6xOTzRH+X++kpaydAjjBMYR549/AK2OoRx+eNFp9dQYsh50
         ykdx6niQD8zREMIdaxzSZvdSQ9bq5wARFzdWKym2ZEk4WAdfPCDx5MLB5S+ohN8BIyC/
         uYsXdvg8dBEq6aTAWrmTkR0aSdCTppfbmLT+w=
MIME-Version: 1.0
Received: by 10.239.139.196 with SMTP id u4mr249782hbu.114.1250958707647; Sat, 
	22 Aug 2009 09:31:47 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <f18c9dde0908220919x577d1302y84a808b61ce4268f@mail.gmail.com>
References: <20090822155000.M1251@jostleme.com>
	 <f18c9dde0908220919x577d1302y84a808b61ce4268f@mail.gmail.com>
Date: Sat, 22 Aug 2009 18:31:47 +0200
Message-ID: <f18c9dde0908220931vc6de3aevfb24309a478284a9@mail.gmail.com>
Subject: Re: Using HitCollector to Collect First N Hits
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hey Len,
one more thing... while I have no idea about your usecase if you don't
care about the score you could you expand the terms yourself just like
PrefixQuery does.

simon

On Sat, Aug 22, 2009 at 6:19 PM, Simon
Willnauer<simon.willnauer@googlemail.com> wrote:
> Hi Len,
>
> On Sat, Aug 22, 2009 at 5:51 PM, Len Takeuchi<ltakeuchi@jostleme.com> wro=
te:
>> Hello,
>>
>> I have attached the original thread from where I got my information at t=
he
>> very bottom in case it is of any help. In regards to whether I want just=
 a
>> boolean retrieval model, in the usage we are currently discussing, the
>> answer is yes (I don't care about the score). =C2=A0However, we also do =
other
>> queries in other use cases where we do care about the score.
>>
>> In regards to the type of query, we are using a prefix query. =C2=A0We h=
ave a
>> problem with performance when the prefix entered by the user is short
>> because it yields a large number of hits. =C2=A0I was hoping that taking=
 the
>> approach I mentioned, search engine would call the HitCollector
>> incrementally and give me a chance to end the search earlier but it seem=
s
>> like it is not happening. =C2=A0Do you think the problem is with term ex=
pansion?
> that is what my first guess was and I'm pretty sure that the long time
> is taken before the documents get scored. A short prefix can easily
> expand to thousands of terms, do you encounter
> TooManyClausesExceptions and in turn do you set
> BooleanQuery#setMaxClauseCount() to a higher value than 1024?
> I wonder if BooleanQuery#setAllowDocsOutOfOrder(true) would give you
> any performance hit if you don't care about the order of how the docs
> come in. Any idea how many terms your prefix query expands to?
>
> simon
>>
>> Regards,
>> Len
>>
>> ----- original message -----
>> From: simon.willnauer [at] googlemail
>> Re: Using HitCollector to Collect First N Hits
>>
>> Hi Len,
>> what kind of query do you execute when you collect the hits.
>> HitCollector should be called for each document by the time it is
>> scored. Is it possible that you run a query that could be expensive in
>> terms of term expansion like WildcardQuery?
>>
>> simon
>>
>> ----- original message -----
>> From : ltakeuchi [at] jostleme
>> Stop search process when a given number of hits is reached
>> Hello,
>>
>> I=E2=80=99m using Lucene 2.4.1 and I=E2=80=99m trying to use a custom Hi=
tCollector to
>> collect
>> only the first N hits (not the best hits) for performance. I saw another
>> e-mail in this group where they mentioned writing a HitCollector which
>> throws
>> an exception after N hits to do this. So I tried this approach and it se=
ems
>> as if my HitCollector isn=E2=80=99t called until the hits have been dete=
rmined, i.e.
>> the time until my HitCollector is called is dependent on the number of h=
its
>> and my performance is no better than when I was not using a custom
>> HitCollector. Does anyone have insight into my problem? The person who t=
ried
>> approach mentioned performance improved significantly for him.
>>
>> Regards,
>> Len
>>
>>
>>
>>
>>
>>
>>
>> ORIGINAL THREAD BELOW
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>>
>> ----- original message -----
>> From : yodapoubelle [at] yahoo
>> Re : Stop search process when a given number of hits is reached
>>
>> Thanks a lot for your responses...
>>
>> I have tried the HitCollector and throw an exception when the limit of h=
its
>> is reached...
>> It works fine and the search time is really reduce when there is a lot o=
f
>> docs which are matching the query...
>>
>> I did that :
>>
>> public class CountCollector extends HitCollector{
>> public int cpt;
>> private int _maxHit;
>> public CountCollector(int maxHit)
>> {
>> cpt =3D 0;
>> _maxHit =3D maxHit
>> }
>> public void collect(int arg0, float arg1)
>> {
>> cpt++;
>> if (cpt > _max_Hit)
>> {
>> throw new LimitIsReachedException();
>> }
>> }
>> }
>>
>> With a simple try catch, I catch the exception, and display "cpt" (the
>> counter)...
>>
>> Best regards
>>
>> ----- Message d'origine ----
>> De : Andrzej Bialecki <ab[at]getopt.org>
>> =C3=80 : java-user[at]lucene.apache.org
>> Envoy=C3=A9 le : Jeudi, 7 Ao=C3=BBt 2008, 14h29mn 31s
>> Objet : Re: Stop search process when a given number of hits is reached
>>
>> Doron Cohen wrote:
>>> Nothing built in that I'm aware of will do this, but it can be done by
>>> searching with your own HitCollector.
>>> There is a related feature - stop search after a specified time - using
>>> TimeLimitedCollector.
>>> It is not released yet, see issue LUCENE-997.
>>> In short, the collector's collect() method is invoked in the search
>> process
>>> for each matching document.
>>> Once 500 docs were collected, your collector can cause the search to st=
op
>> by
>>> throwing an exception.
>>> Upon catching the exception you know that 500 docs were collected.
>>
>> Two additional comments:
>>
>> * the topN results from such incomplete search may be way off, if there
>> were some high scoring documents somewhere beyond the limit.
>>
>> * if you know that there are more important and less important documents
>> in your corpus, and their relative weight is independent of the query
>> (e.g. PageRank-type score), then you can restructure your index so that
>> postings belonging to highly-scoring documents come first on the posting
>> lists - this way you have a better chance to collect highly relevant
>> documents first, even though the search is incomplete. You can find an
>> implementation of this concept in Nutch
>> (org.apache.nutch.indexer.IndexSorter).
>>
>> --
>> Best regards,
>> Andrzej Bialecki <><
>> ___. ___ ___ ___ _ _ __________________________________
>> [__ || __|__/|__||\/| Information Retrieval, Semantic Web
>> ___|||__|| \| || | Embedded Unix, System Integration
>> http://www.sigram.com Contact: info at sigram dot com
>>
>>
>> ----- original message -----
>> From : yodapoubelle [at] yahoo
>> Stop search process when a given number of hits is reached Remove
>> Highlighting
>>
>> Hello
>>
>> Is there a way to stop the search process when a given number of hits is
>> reached?
>>
>> I have a counter feature which displays how many docs match a query.
>> This counter is blocked; I mean that if there are more than 500 docs, it
>> will just display "more than 500".
>> I don't care about the exact amount of docs matched by the query, the or=
der
>> of the hits or whatever...
>> What I want is to stop the search process when it reaches at least 500 h=
its
>> in order to improve performance...
>> (I want an average search time in about 50 - 100 ms)
>>
>> I experimented with the following methods :
>> For the same query:
>> with search(Query query, Filter filter, Sort sort) hits=3D157691 docs in
>> searchingTime=3D2514 ms
>> with search(Query query, Filter filter, int n) (with n =3D 50) TopDocs
>> totalHits 157691 in searchingTime=3D 2360 ms
>>
>> For another query:
>> With search(Query query, Filter filter, Sort sort) hits=3D1208 docs in
>> searchingTime=3D750 ms
>> With search(Query query, Filter filter, int n) (with n =3D 50) TopDocs
>> totalHits 1208 in searchingTime=3D 718 ms
>>
>> For another query:
>> With search(Query query, Filter filter, Sort sort) hits=3D16174 cv(s)
>> searchingTime=3D1297 ms
>> With search(Query query, Filter filter, int n) (with n =3D 50) TopDocs
>> totalHits 16174 in searchingTime=3D 1219 ms
>>
>> According to this results, replacing the first method by the other has n=
o
>> effect on either the search
>> time or total number of hits returned
>>
>> Also the lucene version used now is 1.9.1 (but i work on the evolution t=
o
>> 2.3.2)
>>
>>
>> Thanks a lot
>> (Sorry for my bad English ... you will easily guess, I=E2=80=99m French =
;)
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41994-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 22 17:40:51 2009
Return-Path: <java-user-return-41994-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38118 invoked from network); 22 Aug 2009 17:40:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Aug 2009 17:40:51 -0000
Received: (qmail 83654 invoked by uid 500); 22 Aug 2009 17:41:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83572 invoked by uid 500); 22 Aug 2009 17:41:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83562 invoked by uid 99); 22 Aug 2009 17:41:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 17:41:09 +0000
X-ASF-Spam-Status: No, hits=1.1 required=10.0
	tests=FORGED_HOTMAIL_RCVD2,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Aug 2009 17:41:00 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MeuZz-00063h-ED
	for java-user@lucene.apache.org; Sat, 22 Aug 2009 10:40:39 -0700
Message-ID: <25096044.post@talk.nabble.com>
Date: Sat, 22 Aug 2009 10:40:39 -0700 (PDT)
From: marquinhocb <marquinhocb@hotmail.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene index question
In-Reply-To: <867513fe0908212224o748f4e3bt39db739958831c89@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: marquinhocb@hotmail.com
References: <25090565.post@talk.nabble.com> <867513fe0908212224o748f4e3bt39db739958831c89@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Anshum,

Thanks so much for the quick response! I think that pretty much covers it. 
I was worried that having to delete the document and re-add it simply
because a date field has been updated would make my indexing quite slow.

Seems however that's not something I'll have to worry about.  Thanks so
much!

Anshum-2 wrote:
> 
> Hi Marquin,
> So you have a field that you want to sort on, well thats pretty much a
> straight task in lucene.
> 
> <snip>
> Sort sort = new Sort();
> sort.setSort(<sort field>, true/false);
> </snip>
> 
> http://lucene.apache.org/java/2_3_1/api/org/apache/lucene/search/Sort.html
> * It would not really be taxing and frequent updates could be handled
> smoothly.
> * About updating a single field, there's no way to do so, you'd have to
> you
> delete and add a document.
> * About creating a delta index, I've tried that approach and it kinda
> works,
> but then a lot also depends on your implementation and application setup.
> Also, to clarify what I just mentioned, there's not really a way to create
> a
> field based split index in lucene, instead you might consider keeping all
> updated docs on a seperate index and use a multisearcher or something to
> search on the delta plus core index while searching (and also have a merge
> policy for the delta to be merged with the core).
> Hope this clarifies the doubt to some extent. :)
> 
> 
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
> 
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
> 
> 
> On Sat, Aug 22, 2009 at 10:06 AM, marquinhocb
> <marquinhocb@hotmail.com>wrote:
> 
>>
>> Hello everyone.  New here to Lucene, amazing product, but takes some time
>> to
>> wrap my head around it all heh.
>>
>> So I have a basic question regarding indices.  I have a "document" with
>> various fields (content, post date, last viewed).  The majority of these
>> fields are quite constant, but clearly the last viewed field would be
>> updated quite often.  I would like to be able to sort by "last viewed".
>>
>> My questions are:
>>
>> 1) Will it be taxing to Lucene if I have to constantly re-index a
>> document
>> just because the "last viewed" date has been updated?
>> 2) Is there any way to just update the single field, so that the entire
>> index doesn't have to be rebuilt? (I believe the answer to this one is
>> "no")
>> 3) Is there any sort of delta trick that can be done so that the "last
>> viewed" property can be created in a separate index?
>>
>> Thanks in advance!
>> --
>> View this message in context:
>> http://www.nabble.com/Lucene-index-question-tp25090565p25090565.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Lucene-index-question-tp25090565p25096044.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41995-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 23 12:35:35 2009
Return-Path: <java-user-return-41995-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82803 invoked from network); 23 Aug 2009 12:35:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Aug 2009 12:35:35 -0000
Received: (qmail 68207 invoked by uid 500); 23 Aug 2009 12:35:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68121 invoked by uid 500); 23 Aug 2009 12:35:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68111 invoked by uid 99); 23 Aug 2009 12:35:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Aug 2009 12:35:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [134.96.191.147] (HELO smtp.dfki.de) (134.96.191.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Aug 2009 12:35:43 +0000
Received: from smtp.dfki.de (localhost [127.0.0.1])
	by imss.7 (Postfix) with ESMTP id CEB283143F
	for <java-user@lucene.apache.org>; Sun, 23 Aug 2009 14:35:22 +0200 (CEST)
Received: from mail.dfki.de (lnv-104.sb.dfki.de [134.96.191.146])
	by smtp.dfki.de (Postfix) with ESMTP id AFF2C315D3
	for <java-user@lucene.apache.org>; Sun, 23 Aug 2009 14:35:22 +0200 (CEST)
Received: from [192.168.178.47] (BAH035a.bah.pppool.de [77.135.3.90])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.dfki.de (Postfix) with ESMTPSA id 6AADA310B4
	for <java-user@lucene.apache.org>; Sun, 23 Aug 2009 14:35:22 +0200 (CEST)
Message-Id: <4D934086-244B-4B72-827A-2586A01A36B3@activemath.org>
From: Paul Libbrecht <paul@activemath.org>
To: java-user@lucene.apache.org
Content-Type: multipart/signed; boundary=Apple-Mail-45--6702289; micalg=sha1; protocol="application/pkcs7-signature"
Mime-Version: 1.0 (Apple Message framework v936)
Subject: phonetic encoders for other languages?
Date: Sun, 23 Aug 2009 14:35:17 +0200
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail-45--6702289
Content-Type: text/plain;
	charset=US-ASCII;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: 7bit



Hello list,

I will need to use phonetic analyzers to do "phonetic search". I know  
of the Metaphone analyzers and use them but they're really only known  
to work for English.

Does anyone have pointers to projects that encode phonetically words  
of other languages?
I'm interested to French, Spanish, German, Dutch, and Hungarian thus  
far.

thanks in advance

paul
--Apple-Mail-45--6702289
Content-Disposition: attachment;
	filename=smime.p7s
Content-Type: application/pkcs7-signature;
	name=smime.p7s
Content-Transfer-Encoding: base64

MIAGCSqGSIb3DQEHAqCAMIACAQExCzAJBgUrDgMCGgUAMIAGCSqGSIb3DQEHAQAAoIIDDzCCAwsw
ggJ0oAMCAQICECfgYPDm3JFN4mPGdyWyyVgwDQYJKoZIhvcNAQEFBQAwYjELMAkGA1UEBhMCWkEx
JTAjBgNVBAoTHFRoYXd0ZSBDb25zdWx0aW5nIChQdHkpIEx0ZC4xLDAqBgNVBAMTI1RoYXd0ZSBQ
ZXJzb25hbCBGcmVlbWFpbCBJc3N1aW5nIENBMB4XDTA5MDUyNjA3MzIzNloXDTEwMDUyNjA3MzIz
NlowcDEaMBgGA1UEBBMRTGliYnJlY2h0IEdvdXJkZXQxDTALBgNVBCoTBFBhdWwxHzAdBgNVBAMT
FlBhdWwgTGliYnJlY2h0IEdvdXJkZXQxIjAgBgkqhkiG9w0BCQEWE3BhdWxAYWN0aXZlbWF0aC5v
cmcwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDeZiQTdNavFBrVY7WMNWscajCzBRZF
cWhrkQyh2V0CCrwx7ElHEM0asrD/FbmK+eor0aeav4u/3RKj3qOsV/HV8VRiM2zHaaErrp+/boPw
FapmxhPk0TXLceFJAgL5ZA1RsfpcIxGzE/AQ5ic+MqZXp2tZkH6RNeOwoUTURZb2bOZWX5fA1G+L
G+IVs20vAN6i/Kdud3JUe9ElfHWfJTl2eO42Hea5MVLnk2IkmCqzxC3CcEchOgOzIrnEjaj/JLPB
ZZkDv6sTyEouG4qQHr4trSZCe5anTM2HoPVtmAoaz+Acyt2+0cwIUIPGDjk1K0mvrnCbVIOUNlUe
FVJu0svnAgMBAAGjMDAuMB4GA1UdEQQXMBWBE3BhdWxAYWN0aXZlbWF0aC5vcmcwDAYDVR0TAQH/
BAIwADANBgkqhkiG9w0BAQUFAAOBgQDC0P6qlhvM4E2XepLgrDWLj7yp9obwKr2tZBvM3lXGCIyx
edzPOMRQABPH3eBbvhKyMb64AoCttJ0vt+QcBLLtc9TkBxPyHyaRHmi4NUMlJJyy1z6pLNc0Ipec
U+qv5ck7Cl2SUs7ZQps9ZSW++s4LKKrcdsEs9HD4myt1YusWKTGCAxAwggMMAgEBMHYwYjELMAkG
A1UEBhMCWkExJTAjBgNVBAoTHFRoYXd0ZSBDb25zdWx0aW5nIChQdHkpIEx0ZC4xLDAqBgNVBAMT
I1RoYXd0ZSBQZXJzb25hbCBGcmVlbWFpbCBJc3N1aW5nIENBAhAn4GDw5tyRTeJjxnclsslYMAkG
BSsOAwIaBQCgggFvMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTA5
MDgyMzEyMzUxN1owIwYJKoZIhvcNAQkEMRYEFNRuKZGo9/fQI+0qRokueoD4dGkYMIGFBgkrBgEE
AYI3EAQxeDB2MGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQKExxUaGF3dGUgQ29uc3VsdGluZyAoUHR5
KSBMdGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwgRnJlZW1haWwgSXNzdWluZyBDQQIQJ+Bg
8ObckU3iY8Z3JbLJWDCBhwYLKoZIhvcNAQkQAgsxeKB2MGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQK
ExxUaGF3dGUgQ29uc3VsdGluZyAoUHR5KSBMdGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwg
RnJlZW1haWwgSXNzdWluZyBDQQIQJ+Bg8ObckU3iY8Z3JbLJWDANBgkqhkiG9w0BAQEFAASCAQCQ
gdXq87PPrZVP3EEiSG1M+cZYpEGizTcmy8J0dmNRi+YOMhYdC02xVzxgG+HahNe3ywh7+k1Embl2
gnJMJ5ByPqa7KqVOJWEFDjUwCXqywYQBZbYBkG+1VzjIhyLk9grhWfask68N7j5eyTHKh5ny5lwt
KS13oDJV8X7wZccDQClUH7EoKczb4rNKLIN5s3xgvOlbh0AKQf0dxzqeF2YjdSqSrjoR7WUG19Z3
1lYJ09h60G2L9ftu1PDVfaIwFHU11+Y1AVCByGtegbY63aRAZXNJ8edkscs9vglw2dQoL/yccbbw
p4O74QfLJzDzKwejXXmARhNghNXbZ76JbrRnAAAAAAAA

--Apple-Mail-45--6702289--

From java-user-return-41996-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 23 15:06:18 2009
Return-Path: <java-user-return-41996-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9688 invoked from network); 23 Aug 2009 15:06:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Aug 2009 15:06:18 -0000
Received: (qmail 46847 invoked by uid 500); 23 Aug 2009 15:06:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46779 invoked by uid 500); 23 Aug 2009 15:06:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46769 invoked by uid 99); 23 Aug 2009 15:06:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Aug 2009 15:06:36 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of petite_abeille@mac.com designates 17.148.16.87 as permitted sender)
Received: from [17.148.16.87] (HELO asmtpout012.mac.com) (17.148.16.87)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Aug 2009 15:06:25 +0000
MIME-version: 1.0
Content-transfer-encoding: 7BIT
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Received: from [192.168.1.34] ([85.4.4.213])
 by asmtp012.mac.com (Sun Java(tm) System Messaging Server 6.3-8.01 (built Dec
 16 2008; 32bit)) with ESMTPSA id <0KOU00LBA4L6DT10@asmtp012.mac.com> for
 java-user@lucene.apache.org; Sun, 23 Aug 2009 08:06:03 -0700 (PDT)
Message-id: <0A4FD9E3-A5EB-4F8E-A6D5-60306D8CBE13@mac.com>
From: Petite Abeille <petite_abeille@mac.com>
To: java-user@lucene.apache.org
In-reply-to: <4D934086-244B-4B72-827A-2586A01A36B3@activemath.org>
Subject: Re: phonetic encoders for other languages?
Date: Sun, 23 Aug 2009 17:05:30 +0200
References: <4D934086-244B-4B72-827A-2586A01A36B3@activemath.org>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


On Aug 23, 2009, at 2:35 PM, Paul Libbrecht wrote:

> I will need to use phonetic analyzers to do "phonetic search". I  
> know of the Metaphone analyzers and use them but they're really only  
> known to work for English.

Double Metaphone?

http://en.wikipedia.org/wiki/Double_Metaphone

--
PA.
http://alt.textdrive.com/nanoki/



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41997-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 23 16:07:52 2009
Return-Path: <java-user-return-41997-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16369 invoked from network); 23 Aug 2009 16:07:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Aug 2009 16:07:52 -0000
Received: (qmail 83714 invoked by uid 500); 23 Aug 2009 16:08:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83630 invoked by uid 500); 23 Aug 2009 16:08:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83620 invoked by uid 99); 23 Aug 2009 16:08:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Aug 2009 16:08:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [134.96.191.147] (HELO smtp.dfki.de) (134.96.191.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Aug 2009 16:07:58 +0000
Received: from smtp.dfki.de (localhost [127.0.0.1])
	by imss.7 (Postfix) with ESMTP id A404631650
	for <java-user@lucene.apache.org>; Sun, 23 Aug 2009 18:07:33 +0200 (CEST)
Received: from mail.dfki.de (lnv-104.sb.dfki.de [134.96.191.146])
	by smtp.dfki.de (Postfix) with ESMTP id 8EC613122C
	for <java-user@lucene.apache.org>; Sun, 23 Aug 2009 18:07:33 +0200 (CEST)
Received: from [192.168.178.47] (BAH035a.bah.pppool.de [77.135.3.90])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.dfki.de (Postfix) with ESMTPSA id 6983A310B4
	for <java-user@lucene.apache.org>; Sun, 23 Aug 2009 18:07:33 +0200 (CEST)
Message-Id: <04115B48-DD11-4827-9888-0FBD8F7E7572@activemath.org>
From: Paul Libbrecht <paul@activemath.org>
To: java-user@lucene.apache.org
In-Reply-To: <0A4FD9E3-A5EB-4F8E-A6D5-60306D8CBE13@mac.com>
Content-Type: multipart/signed; boundary=Apple-Mail-47-6028163; micalg=sha1; protocol="application/pkcs7-signature"
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: phonetic encoders for other languages?
Date: Sun, 23 Aug 2009 18:07:15 +0200
References: <4D934086-244B-4B72-827A-2586A01A36B3@activemath.org> <0A4FD9E3-A5EB-4F8E-A6D5-60306D8CBE13@mac.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail-47-6028163
Content-Type: text/plain;
	charset=ISO-8859-1;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: quoted-printable

Le 23-ao=FBt-09 =E0 17:05, Petite Abeille a =E9crit :
>> I will need to use phonetic analyzers to do "phonetic search". I =20
>> know of the Metaphone analyzers and use them but they're really =20
>> only known to work for English.
> Double Metaphone?
> http://en.wikipedia.org/wiki/Double_Metaphone

thanks,

I hadn't see it intended to cover many languages, yes, it would be a =20
solution.
(though hungarian is missing).

Do you know of experimental results with all these languages?

paul


--Apple-Mail-47-6028163
Content-Disposition: attachment;
	filename=smime.p7s
Content-Type: application/pkcs7-signature;
	name=smime.p7s
Content-Transfer-Encoding: base64

MIAGCSqGSIb3DQEHAqCAMIACAQExCzAJBgUrDgMCGgUAMIAGCSqGSIb3DQEHAQAAoIIDDzCCAwsw
ggJ0oAMCAQICECfgYPDm3JFN4mPGdyWyyVgwDQYJKoZIhvcNAQEFBQAwYjELMAkGA1UEBhMCWkEx
JTAjBgNVBAoTHFRoYXd0ZSBDb25zdWx0aW5nIChQdHkpIEx0ZC4xLDAqBgNVBAMTI1RoYXd0ZSBQ
ZXJzb25hbCBGcmVlbWFpbCBJc3N1aW5nIENBMB4XDTA5MDUyNjA3MzIzNloXDTEwMDUyNjA3MzIz
NlowcDEaMBgGA1UEBBMRTGliYnJlY2h0IEdvdXJkZXQxDTALBgNVBCoTBFBhdWwxHzAdBgNVBAMT
FlBhdWwgTGliYnJlY2h0IEdvdXJkZXQxIjAgBgkqhkiG9w0BCQEWE3BhdWxAYWN0aXZlbWF0aC5v
cmcwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDeZiQTdNavFBrVY7WMNWscajCzBRZF
cWhrkQyh2V0CCrwx7ElHEM0asrD/FbmK+eor0aeav4u/3RKj3qOsV/HV8VRiM2zHaaErrp+/boPw
FapmxhPk0TXLceFJAgL5ZA1RsfpcIxGzE/AQ5ic+MqZXp2tZkH6RNeOwoUTURZb2bOZWX5fA1G+L
G+IVs20vAN6i/Kdud3JUe9ElfHWfJTl2eO42Hea5MVLnk2IkmCqzxC3CcEchOgOzIrnEjaj/JLPB
ZZkDv6sTyEouG4qQHr4trSZCe5anTM2HoPVtmAoaz+Acyt2+0cwIUIPGDjk1K0mvrnCbVIOUNlUe
FVJu0svnAgMBAAGjMDAuMB4GA1UdEQQXMBWBE3BhdWxAYWN0aXZlbWF0aC5vcmcwDAYDVR0TAQH/
BAIwADANBgkqhkiG9w0BAQUFAAOBgQDC0P6qlhvM4E2XepLgrDWLj7yp9obwKr2tZBvM3lXGCIyx
edzPOMRQABPH3eBbvhKyMb64AoCttJ0vt+QcBLLtc9TkBxPyHyaRHmi4NUMlJJyy1z6pLNc0Ipec
U+qv5ck7Cl2SUs7ZQps9ZSW++s4LKKrcdsEs9HD4myt1YusWKTGCAxAwggMMAgEBMHYwYjELMAkG
A1UEBhMCWkExJTAjBgNVBAoTHFRoYXd0ZSBDb25zdWx0aW5nIChQdHkpIEx0ZC4xLDAqBgNVBAMT
I1RoYXd0ZSBQZXJzb25hbCBGcmVlbWFpbCBJc3N1aW5nIENBAhAn4GDw5tyRTeJjxnclsslYMAkG
BSsOAwIaBQCgggFvMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTA5
MDgyMzE2MDcxNlowIwYJKoZIhvcNAQkEMRYEFGM8ervUAo9M9NMqgxV4h7bokmUOMIGFBgkrBgEE
AYI3EAQxeDB2MGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQKExxUaGF3dGUgQ29uc3VsdGluZyAoUHR5
KSBMdGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwgRnJlZW1haWwgSXNzdWluZyBDQQIQJ+Bg
8ObckU3iY8Z3JbLJWDCBhwYLKoZIhvcNAQkQAgsxeKB2MGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQK
ExxUaGF3dGUgQ29uc3VsdGluZyAoUHR5KSBMdGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwg
RnJlZW1haWwgSXNzdWluZyBDQQIQJ+Bg8ObckU3iY8Z3JbLJWDANBgkqhkiG9w0BAQEFAASCAQAn
w9iHlCc9Fl3AK/iDLYXaCR7nXqD8AAh9oHhgZIuvVRb/E0re31VPCEH8xogiZjrN9G7teG/jOKcq
6dF1MHYPBdHPhJJGhIH0WiWhefTtcJRgnbPKy9TOZRy4AVne7WgaPR6S3RX843yc64gOFSOMypP7
8dSiMeHYExNqRWaBg8XBuIU28HY6dUP2oLbejXvprxfRxn3BX1xUSAgKcAR08zTQVQsHI52TfZDG
ShdZy2O2pZCNXvYnwG4hh3dTOdf/b9AYXVjubWv+dI28ok7W16X+LaD4Ax+9GwU7VXilnwB89mtp
z696v1myO0AyA0rpnYoZaO8zGk3ByGZTrvnvAAAAAAAA

--Apple-Mail-47-6028163--

From java-user-return-41998-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 24 07:40:06 2009
Return-Path: <java-user-return-41998-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2815 invoked from network); 24 Aug 2009 07:40:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Aug 2009 07:40:06 -0000
Received: (qmail 97696 invoked by uid 500); 24 Aug 2009 07:40:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97624 invoked by uid 500); 24 Aug 2009 07:40:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97613 invoked by uid 99); 24 Aug 2009 07:40:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 07:40:23 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=MSGID_MULTIPLE_AT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [64.13.253.17] (HELO guavus.com) (64.13.253.17)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 07:40:12 +0000
Received: (qmail 3076 invoked from network); 24 Aug 2009 00:39:51 -0700
Received: from isp-net67.spectranet.com (HELO station151) (@125.63.71.67)
  by guavus.com with SMTP; 24 Aug 2009 00:39:50 -0700
From: "Sumanta Bhowmik" <sumanta.bhowmik@guavus.com>
To: <java-user@lucene.apache.org>
References: <-61520930041827677@unknownmsgid>	 <9ac0c6aa0908200237kcb7d0f3q73d37b5fdec27f2d@mail.gmail.com>	 <-3936163573164025315@unknownmsgid> <9ac0c6aa0908210413w92a8280rd8a1d9deb0548bb8@mail.gmail.com>
In-Reply-To: <9ac0c6aa0908210413w92a8280rd8a1d9deb0548bb8@mail.gmail.com>
Subject: RE: Merge Exception in Lucene 2.4
Date: Mon, 24 Aug 2009 13:09:43 +0530
Message-ID: <004801ca248e$10e835d0$32b8a170$@bhowmik@guavus.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcoiUJoBxd7a02ekREyZvpD45TXGLwCPUvkg
Content-Language: en-us
X-Virus-Checked: Checked by ClamAV on apache.org

I will be running a long running test with jdk1.6u16. If the problem =
still
appears I will try to create a test case to show the issue.

Sumanta

-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: Friday, August 21, 2009 4:44 PM
To: java-user@lucene.apache.org
Subject: Re: Merge Exception in Lucene 2.4

That code looks fine...

What OS/filesystem are you using?

Can you make a small test case that shows the issue?

Mike

On Thu, Aug 20, 2009 at 7:41 AM, Sumanta
Bhowmik<sumanta.bhowmik@guavus.com> wrote:
> We put all the IndexWriters in an array which is defined by
>
> final Directory[] finalDir;
>
> We also declare an indexer
> As
> private volatile static Indexer indexer;
>
> final Indexer finalIndexer =3D indexer;
>
> Next we call the merge in a new thread :
>
> Thread thread =3D new Thread(){
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public void run()
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.debug("starts merging w/o
> optimization");
>
> finalIndexer.getWriter().addIndexesNoOptimize(finalDir);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.debug("ends merging w/o
> optimization");
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch =
(CorruptIndexException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.notice("",e);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch =
(IOException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.notice("",e);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0}
> }
>
> Sumanta
>
>
>
>
> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: Thursday, August 20, 2009 3:07 PM
> To: java-user@lucene.apache.org
> Subject: Re: Merge Exception in Lucene 2.4
>
> You should definitely upgrade to the latest JDK 1.6 to get the fix for
> the JRE bug in LUCENE-1282, but, I don't think you are hitting that
> bug (read past EOF during merge is a different exception).
>
> Can you describe more detail on how you merge 6 IndexWriters?
>
> Mike
>
> On Thu, Aug 20, 2009 at 5:21 AM, Sumanta
> Bhowmik<sumanta.bhowmik@guavus.com> wrote:
>> I checked at http://issues.apache.org/jira/browse/LUCENE-1282
>> SegmentMerger.java has this code
>>
>> TermFreqVector[] vectors =3D reader.getTermFreqVectors(docNum);
>> termVectorsWriter.addAllDocVectors(vectors);
>>
>> so this issue appears inspite of this fix.
>>
>> I am using java version "1.6.0_07". Is it fixed in jdk6u10 and above
>> (http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=3D6707044) ?
>>
>> Regards
>> Sumanta
>>
>>
>> -----Original Message-----
>> From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]
>> Sent: Thursday, August 20, 2009 1:15 PM
>> To: java-user@lucene.apache.org
>> Subject: Merge Exception in Lucene 2.4
>>
>> Hi
>>
>>
>>
>> I am getting this issue in Lucene2.4 when I try to merge multiple
>> IndexWriters(generally 6)
>>
>>
>>
>> sh-3.2# Exception in thread "Lucene Merge Thread #5"
>> org.apache.lucene.index.MergePolicy$MergeException: =
java.io.IOException:
>> read past EOF
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
>> rentMergeScheduler.java:309)
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>> ergeScheduler.java:286)
>>
>> Caused by: java.io.IOException: read past EOF
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.j=
ava
>> :135)
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.ja=
va:
>> 228)
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:=
184
>> )
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.ja=
va:
>> 204)
>>
>> =A0 =A0 =A0 =A0at
>> =
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4260)
>>
>> =A0 =A0 =A0 =A0at
org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3877)
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
>> duler.java:205)
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>> ergeScheduler.java:260)
>>
>>
>>
>>
>>
>> Is this a known issue and has any fix been provided for it ? Would
>> appreciate any help.
>>
>>
>>
>> Regards
>>
>> Sumanta
>>
>>
>>
>>
>>
>>
>>
>>
>> __________ NOD32 4349 (20090819) Information __________
>>
>> This message was checked by NOD32 antivirus system.
>> http://www.eset.com
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> __________ NOD32 4350 (20090820) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


__________ NOD32 4354 (20090821) Information __________

This message was checked by NOD32 antivirus system.
http://www.eset.com



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42002-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 24 16:33:40 2009
Return-Path: <java-user-return-42002-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6732 invoked from network); 24 Aug 2009 16:33:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Aug 2009 16:33:40 -0000
Received: (qmail 24404 invoked by uid 500); 24 Aug 2009 16:34:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24345 invoked by uid 500); 24 Aug 2009 16:34:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24335 invoked by uid 99); 24 Aug 2009 16:34:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 16:34:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.225 as permitted sender)
Received: from [209.85.220.225] (HELO mail-fx0-f225.google.com) (209.85.220.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 16:33:53 +0000
Received: by fxm25 with SMTP id 25so1630935fxm.5
        for <java-user@lucene.apache.org>; Mon, 24 Aug 2009 09:33:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=152H+ar6iN4cg1ANmghhfV50w0bSnMfAWtN2NV4b85E=;
        b=S1qXziInrsXLrhUZ73l71yqGgro6iNUsu3TF0RPyAdbpeRhRI36v+//HNgpwLJFX2h
         D0hb+yQfYa+lcr2L7L33fAF+XJ+J/xD45ac1fy70ds5TNtZCS5l2yJJd5VNx7VqyaTkj
         jU1isxUwON/AGHZ4W3eAoiWjkCvIgyYSXiOM0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=uDwbKQO5prmh9oq/mDw6kdhkvGfZ+/VLLVro7MgNThSmUE/8fXC6CB6alagAJIK+5R
         MENLMY6NP4pOVwLQYm7CUiVXtxRzC1RHCOqu0bUD3ZbfbQ3Ptd6/Aj3hanoiP+xSmULQ
         npKwWRfkJhgOJmfsbGMqf2HaIvZjJjojqTcRU=
MIME-Version: 1.0
Received: by 10.239.142.155 with SMTP id g27mr529071hba.62.1251131611823; Mon, 
	24 Aug 2009 09:33:31 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <4A92BC4D.1090806@sirma.bg>
References: <4A92BC4D.1090806@sirma.bg>
Date: Mon, 24 Aug 2009 18:33:31 +0200
Message-ID: <f18c9dde0908240933y7ecc3f6dn81007f2b521846d7@mail.gmail.com>
Subject: Re: Faster way for faceting?
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi there,

I'm not sure if the performance is considerable for you but you could try:
 TermDocs termDocs =3D this.reader.termDocs(term);
 int count =3D 0;
 while(termDocs.next()){
   count +=3D termDocs.freq();
 }


simon

On Mon, Aug 24, 2009 at 6:14 PM, Ivan Vasilev<ivasilev@sirma.bg> wrote:
> Hi All,
>
> We use faceting in our app but it is very slow for the indexes that use o=
ur
> clients.
> First I will say what I understand under faceting - this is for each term
> for certain field to obtain 1. number of docs that contain it, 2. the tot=
al
> number of occurrences of the term in the index.
> Now what we use to obtain the information:
>
> =C2=A0 =C2=A0 =C2=A0...
> =C2=A0 =C2=A0 =C2=A0some code for obtained terms on which we will make fa=
ceting
> =C2=A0 =C2=A0 =C2=A0...
>
> =C2=A0 =C2=A0 =C2=A0 Term[] retTerms =3D new Term[terms.size()];
> =C2=A0 =C2=A0 =C2=A0 int[] retFreqs =3D new int[retTerms.length];
> =C2=A0 =C2=A0 =C2=A0 int[] retDocs =3D new int[retTerms.length];
> =C2=A0 =C2=A0 =C2=A0 TermPositions tp =3D mSearcher.getIndexReader().term=
Positions();
> =C2=A0 =C2=A0 =C2=A0 int i =3D 0;
> =C2=A0 =C2=A0 =C2=A0 for(Iterator<Term> iter =3D terms.iterator(); iter.h=
asNext(); i++) {
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 try {
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 retTerms[i] =3D iter.nex=
t();
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 tp.seek(retTerms[i]);
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 while(tp.next()) {
> =C2=A0 // =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0tp.read(=
new int[]{}, new int[]{});
> // =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0t=
p.doc();
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 retFreqs[i=
] +=3D tp.freq();
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 retDocs[i]=
++;
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 }
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 } finally {
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 if(tp !=3D null) {
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 tp.close()=
;
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 }
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 }
> =C2=A0 =C2=A0 =C2=A0 }
>
> Now what I discovered that is extremely faster for obtaining number of do=
cs
> that contain each term.
>
> =C2=A0 =C2=A0 =C2=A0 ...
> =C2=A0 =C2=A0 =C2=A0the same code for obtained terms on which we will mak=
e faceting
> =C2=A0 =C2=A0 =C2=A0...
>
> =C2=A0 =C2=A0 =C2=A0 Term[] retTerms =3D new Term[terms.size()];
> =C2=A0 =C2=A0 =C2=A0 int[] retFreqs =3D new int[retTerms.length];
> =C2=A0 =C2=A0 =C2=A0 int i =3D 0;
> =C2=A0 =C2=A0 =C2=A0 long t1 =3D System.currentTimeMillis();
> =C2=A0 =C2=A0 =C2=A0 for (Term currTerm : terms) {
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 retTerms[i] =3D currTerm;
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 retFreqs[i] =3D mSearcher.docFreq(curr=
Term);
> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 i++;
> =C2=A0 =C2=A0 =C2=A0 }
>
> I tested two code versions for obtaining 1 237 390 term facets. The
> difference in time was 10 times (second version wins). I know that this i=
s
> because Lucene index keeps for each term the number of docs that contain =
it.
>
> My question - is there some way to obtain the total number of occurrences=
 of
> the term in the index in some similar fast way?
>
> Best Regards,
> Ivan
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42000-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 24 16:42:00 2009
Return-Path: <java-user-return-42000-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20346 invoked from network); 24 Aug 2009 16:41:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Aug 2009 16:41:59 -0000
Received: (qmail 86252 invoked by uid 500); 24 Aug 2009 16:14:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86187 invoked by uid 500); 24 Aug 2009 16:14:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86177 invoked by uid 99); 24 Aug 2009 16:14:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 16:14:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ltakeuchi@jostleme.com designates 69.27.117.2 as permitted sender)
Received: from [69.27.117.2] (HELO bx172.blacksun.ca) (69.27.117.2)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 16:14:13 +0000
Received: from LenTPC (zz209205103192.cipherkey.net [209.205.103.192] (may be forged))
	by bx172.blacksun.ca (8.13.1/8.13.1) with SMTP id n7OGDpeY011243
	for <java-user@lucene.apache.org>; Mon, 24 Aug 2009 10:13:51 -0600
From: "Len Takeuchi" <ltakeuchi@jostleme.com>
To: <java-user@lucene.apache.org>
In-Reply-To: <f18c9dde0908220919x577d1302y84a808b61ce4268f@mail.gmail.com>
Subject: RE: Using HitCollector to Collect First N Hits
Date: Mon, 24 Aug 2009 09:13:44 -0700
Message-ID: <722ED0A92EF94366B04837A30323593D@LenTPC>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook, Build 10.0.2616
X-MimeOLE: Produced By Microsoft MimeOLE V6.0.6001.18049
Importance: Normal
X-yoursite-MailScanner-Information: Please contact the ISP for more information
X-yoursite-MailScanner: Found to be clean
X-yoursite-MailScanner-From: ltakeuchi@jostleme.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Simon,

> that is what my first guess was and I'm pretty sure that the long time
> is taken before the documents get scored. A short prefix can easily
> expand to thousands of terms, do you encounter
> TooManyClausesExceptions and in turn do you set
> BooleanQuery#setMaxClauseCount() to a higher value than 1024?
> I wonder if BooleanQuery#setAllowDocsOutOfOrder(true) would give you
> any performance hit if you don't care about the order of how the docs
> come in. Any idea how many terms your prefix query expands to?


I looked into it and the prefix query we are finding to be slow expands
to about 150 terms (and hence we're not getting
TooManyClausesExceptions).  


> one more thing... while I have no idea about your usecase if you don't
> care about the score you could you expand the terms yourself just like
> PrefixQuery does.

I was trying out a few things and if term expansion is limited to about
20 or so the performance becomes okay for us.  I will have to try to
find some way to limit the expansion for some queries.  I'll look into
expanding the terms myself as you suggest.

Thanks for your help,
Len 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42001-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 24 16:42:11 2009
Return-Path: <java-user-return-42001-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20556 invoked from network); 24 Aug 2009 16:42:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Aug 2009 16:42:11 -0000
Received: (qmail 88044 invoked by uid 500); 24 Aug 2009 16:14:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87975 invoked by uid 500); 24 Aug 2009 16:14:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87965 invoked by uid 99); 24 Aug 2009 16:14:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 16:14:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [62.213.161.134] (HELO pmx.sirma.bg) (62.213.161.134)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 16:14:28 +0000
X-Virus-Scanned: Sirma Antivirus System
Received: from [192.168.128.140] (ivasilev.sirma.int [192.168.128.140])
	by pmx.sirma.bg (Sirma mail system) with ESMTP id 1F29D24001
	for <java-user@lucene.apache.org>; Mon, 24 Aug 2009 19:14:06 +0300 (EEST)
Message-ID: <4A92BC4D.1090806@sirma.bg>
Date: Mon, 24 Aug 2009 19:14:05 +0300
From: Ivan Vasilev <ivasilev@sirma.bg>
User-Agent: Thunderbird 2.0.0.22 (Windows/20090605)
MIME-Version: 1.0
To: LUCENE MAIL LIST <java-user@lucene.apache.org>
Subject: Faster way for faceting?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,

We use faceting in our app but it is very slow for the indexes that use 
our clients.
First I will say what I understand under faceting - this is for each 
term for certain field to obtain 1. number of docs that contain it, 2. 
the total number of occurrences of the term in the index.
Now what we use to obtain the information:

       ...
       some code for obtained terms on which we will make faceting
       ...

        Term[] retTerms = new Term[terms.size()];
        int[] retFreqs = new int[retTerms.length];
        int[] retDocs = new int[retTerms.length];
        TermPositions tp = mSearcher.getIndexReader().termPositions();
        int i = 0;
        for(Iterator<Term> iter = terms.iterator(); iter.hasNext(); i++) {
            try {
                retTerms[i] = iter.next();
                tp.seek(retTerms[i]);
                while(tp.next()) {
    //                tp.read(new int[]{}, new int[]{});
//                    tp.doc();
                    retFreqs[i] += tp.freq();
                    retDocs[i]++;
                }
            } finally {
                if(tp != null) {
                    tp.close();
                }
            }
        }

Now what I discovered that is extremely faster for obtaining number of 
docs that contain each term.

        ...
       the same code for obtained terms on which we will make faceting
       ...

        Term[] retTerms = new Term[terms.size()];
        int[] retFreqs = new int[retTerms.length];
        int i = 0;
        long t1 = System.currentTimeMillis();
        for (Term currTerm : terms) {
            retTerms[i] = currTerm;
            retFreqs[i] = mSearcher.docFreq(currTerm);
            i++;
        }

I tested two code versions for obtaining 1 237 390 term facets. The 
difference in time was 10 times (second version wins). I know that this 
is because Lucene index keeps for each term the number of docs that 
contain it.

My question - is there some way to obtain the total number of 
occurrences of the term in the index in some similar fast way?

Best Regards,
Ivan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-41999-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 24 16:55:18 2009
Return-Path: <java-user-return-41999-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38360 invoked from network); 24 Aug 2009 16:55:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Aug 2009 16:55:18 -0000
Received: (qmail 19940 invoked by uid 500); 24 Aug 2009 14:05:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19865 invoked by uid 500); 24 Aug 2009 14:05:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19854 invoked by uid 99); 24 Aug 2009 14:05:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 14:05:42 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.223.200 as permitted sender)
Received: from [209.85.223.200] (HELO mail-iw0-f200.google.com) (209.85.223.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 14:05:34 +0000
Received: by iwn38 with SMTP id 38so939282iwn.29
        for <java-user@lucene.apache.org>; Mon, 24 Aug 2009 07:05:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=y/IeEHaam2EBK5wljqSct3/RlOkDTMxljZ2ThTMpo/o=;
        b=WCUWT/MOecncZBPJvaeuj44HiBB0lN+giDvVxj1Lu6yiLMz3SR2wQST09U/4VG5XwP
         Yq7iTp2zSURg71vT+yRr3udgCAd1Tc+fpRSMxB7WhA+xOCfnpO1Y4oFi72J+MKT80HLu
         7oDLT60B6knyRXgPGsblWRzKuw9TXB/2DzIHk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Yej3Pt115dYJPw3cuzXXOU3TGTqKoQXDyLC7OQdUEna7G1YXa0wkdmP0GnFBeakc32
         TV+H12k7SNaUsBI70py3pKJJjlEk/v+SZfQR5EIlJpAZ18LQUc4JOM82ocD4NAcO0gyj
         3JKh+cR2ljO1fAv37tstTiu1GDGqO8RsSBYp8=
MIME-Version: 1.0
Received: by 10.231.32.134 with SMTP id c6mr2163625ibd.34.1251122713802; Mon, 
	24 Aug 2009 07:05:13 -0700 (PDT)
In-Reply-To: <4d19a3630908220701g5c6441aw42ed18cfdd08b1dd@mail.gmail.com>
References: <23293723.post@talk.nabble.com>
	 <Pine.LNX.4.64.0905011433110.17125@radix.cryptio.net>
	 <25093931.post@talk.nabble.com>
	 <4d19a3630908220701g5c6441aw42ed18cfdd08b1dd@mail.gmail.com>
Date: Mon, 24 Aug 2009 10:05:13 -0400
Message-ID: <359a92830908240705l6dd1c7c5i72bc0017bd138695@mail.gmail.com>
Subject: Re: How to het the score in percentage
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=002215048e77ed48150471e3b435
X-Virus-Checked: Checked by ClamAV on apache.org

--002215048e77ed48150471e3b435
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I'm not saying that calculating percentages is a bad thing *within a
query*.Your
absolutely right, users want some clue about how "good" a match
various items are.

But trying to compare percentages (scores) between *two different queries*
then trying to infer that there is some "better fit" based on that data
is where problems creep in.....


FWIW
Erick


On Sat, Aug 22, 2009 at 10:01 AM, Shashi Kant <shashi.mit@gmail.com> wrote:

> Chris & Erick's arguments are persuasive , however we do live in an
> imperfect world. Most of our users want to see the relative importance
> of a results vis-a-vis the rest....
>
> Relative Importance (%) = (d - dmin)/(dmax-dmin) * 100
>
> Where dmax is the highest Lucene score (score of top result) and dmin
> is the least (the score of the last result) and d = current score.
>
> This would work for any n results.
>
> While this might be technically 'meh', we took a simple normalization
> approach of Lucene scores, it helped the users in gauging the relative
> importance and relate better. End of day, isn't that what matters
> most?
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--002215048e77ed48150471e3b435--

From java-user-return-42003-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 24 19:40:40 2009
Return-Path: <java-user-return-42003-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47996 invoked from network); 24 Aug 2009 19:40:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Aug 2009 19:40:40 -0000
Received: (qmail 4304 invoked by uid 500); 24 Aug 2009 19:41:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4246 invoked by uid 500); 24 Aug 2009 19:41:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4236 invoked by uid 99); 24 Aug 2009 19:41:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 19:41:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ryantxu@gmail.com designates 74.125.92.24 as permitted sender)
Received: from [74.125.92.24] (HELO qw-out-2122.google.com) (74.125.92.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 19:40:53 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1603669qwh.53
        for <java-user@lucene.apache.org>; Mon, 24 Aug 2009 12:40:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :content-type:content-transfer-encoding:mime-version:subject:date
         :x-mailer;
        bh=fwzOxcPNbSHyZzdv2NDE3LiLnlSfXGBZ4RQALoxdfiM=;
        b=BJssUsujKPVKqWFUflGqNcBIGAcynSCudGUFgYWftrmejjtSFoTs5atgi5o90iIW+a
         ww62XS4zHrKZg60NycPetwANjdy+/iGzITn0HojghQsW3iVgpLLPpXaJXStUp38zNFlP
         PYqraS98nBd5MGCRKFH2FRM/ez77txKDjkSkc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:content-type:content-transfer-encoding
         :mime-version:subject:date:x-mailer;
        b=avcRAkG958WbMC+fC9YExPGNTPxYaqxJ3QskO/3vYQRe0GHEnJxGpcIoLuaB9Jo9pl
         afHTmqQTtgkRNvcqwYZe/w/U31C35NtpNKk+uGH4ybsjHeF+A15hwspqKdq/+Kbnca9n
         nSrCypbXh4Ez2tUNePoG0L5Y23EZY6OADmXGU=
Received: by 10.224.90.69 with SMTP id h5mr3187317qam.237.1251142820283;
        Mon, 24 Aug 2009 12:40:20 -0700 (PDT)
Received: from ?192.168.1.5? ([66.92.161.165])
        by mx.google.com with ESMTPS id 5sm1926172qwh.13.2009.08.24.12.40.19
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 24 Aug 2009 12:40:19 -0700 (PDT)
Message-Id: <1A6F2B47-617A-4C2F-A1C0-CC1B51AF7448@gmail.com>
From: Ryan McKinley <ryantxu@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Path Tokenizer?
Date: Mon, 24 Aug 2009 15:40:17 -0400
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Hello-

I'm looking for a way to make tokens navigate a directory structure.   
For example:

Given:
/aaa/bbb/ccc

Make three Tokens:
/aaa/
/aaa/bbb/
/aaa/bbb/ccc

A while ago, I added:
http://issues.apache.org/jira/browse/SOLR-1057

Is there a "standard" way to do this?

thanks
ryan


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42004-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 24 22:21:04 2009
Return-Path: <java-user-return-42004-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39576 invoked from network); 24 Aug 2009 22:21:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Aug 2009 22:21:04 -0000
Received: (qmail 89148 invoked by uid 500); 24 Aug 2009 22:21:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89071 invoked by uid 500); 24 Aug 2009 22:21:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89061 invoked by uid 99); 24 Aug 2009 22:21:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 22:21:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.221.172 as permitted sender)
Received: from [209.85.221.172] (HELO mail-qy0-f172.google.com) (209.85.221.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Aug 2009 22:21:16 +0000
Received: by qyk2 with SMTP id 2so368444qyk.21
        for <java-user@lucene.apache.org>; Mon, 24 Aug 2009 15:20:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:x-enigmail-version:content-type
         :content-transfer-encoding;
        bh=NVfv2tsZ36E1FoN9gpq7AVZ04gkZhBN+ousrrDmdQgw=;
        b=kHne4aBqNXV1vFu0ZEV108XewJKIp7LFDORSz4RmsE16Pq3Qm5F6Ch3kUWzIor/9l2
         L3MhmDqCLXujFHKF+uNkpPsHb8j6PE1DrZGlOu3PlMCmmwFpGf4QYEDqD3xaMutU7H8W
         243kClArRzKYnKW03psSPhUCT/f+n4CHuwoTM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :x-enigmail-version:content-type:content-transfer-encoding;
        b=pcEGpjIyhdqadyBuT0+SVu01SgyGhtG+nUA2gyayj4/fuENQ1zNE2ABrcMDFvDXHel
         FJgRCY1pDh1KH0HQpd3MDET9gvYxGTERNj2aBOSB6p6tD4FvpxlZ3IZMOgi3jxlVoBce
         1z8+gnNtTDcbEPcWhNCd6Kdni8KFTqL//Jtys=
Received: by 10.224.107.70 with SMTP id a6mr3319799qap.373.1251152455871;
        Mon, 24 Aug 2009 15:20:55 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 5sm9190843qwg.0.2009.08.24.15.20.54
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 24 Aug 2009 15:20:55 -0700 (PDT)
Message-ID: <4A931250.6020201@gmail.com>
Date: Mon, 24 Aug 2009 18:21:04 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: [ANNOUNCEMENT] LucidGaze for Lucene released
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hey all,

Just wanted to alert you to a new free offering we just released.
Combine Lucene with a little aspect programming and you can do some
pretty cool things :)

Announce:

Lucid Imagination has released LucidGaze for Lucene, a performance
monitoring and analysis utility for Open Source Apache Lucene. See
www.lucidimagination.com/Downloads/LucidGaze-for-Lucene.

This new utility simplifies analysis of performance for native Lucene
Java apps, by making transparent the search operations, so you can see
exactly how your search application works inside Lucene.
It supports a number of monitors -- statistics collectors which
aggregate information about different key aspects of Lucene search
operations. These statistics collectors can be controlled and reset
individually, with APIs to access the statistics within each. Included
in this version are:

* Analysis Monitor – information about the different analyzers and
filters used to create the index.
* Document Monitor – information on documents and fields added to or
retrieved from a Lucene index.
* Index Monitor – statistics on buffers, memory usage, Lucene index
readers/writers and add/commit times.
* Search Monitor – information about search cycle times.
* Store Monitor – provides number of directory instances.

LucidGaze for Lucene works as a drop-in replacement for the Lucene JAR;
it requires no changes to the source code of the application, or even
recompilation. This makes it readily usable with existing applications
even if their source code is unavailable or difficult to change.
LucidGaze for Lucene has been developed for enterprises that use Lucene
without Solr. It supports Apache Lucene version 2.4.1 and later. (Mark: 
released versions only at the moment)

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42005-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 02:07:57 2009
Return-Path: <java-user-return-42005-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82001 invoked from network); 25 Aug 2009 02:07:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 02:07:57 -0000
Received: (qmail 56351 invoked by uid 500); 25 Aug 2009 02:08:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56274 invoked by uid 500); 25 Aug 2009 02:08:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56264 invoked by uid 99); 25 Aug 2009 02:08:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 02:08:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of koji@r.email.ne.jp designates 202.224.39.197 as permitted sender)
Received: from [202.224.39.197] (HELO mail1.asahi-net.or.jp) (202.224.39.197)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 02:08:09 +0000
Received: from koji-sekiguchi-no-macbook.local (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	by mail1.asahi-net.or.jp (Postfix) with ESMTP id ECC8082269
	for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 11:07:47 +0900 (JST)
Message-ID: <4A934773.4090301@r.email.ne.jp>
Date: Tue, 25 Aug 2009 11:07:47 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Path Tokenizer?
References: <1A6F2B47-617A-4C2F-A1C0-CC1B51AF7448@gmail.com>
In-Reply-To: <1A6F2B47-617A-4C2F-A1C0-CC1B51AF7448@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Ryan,

I've looked for it when I implemented SOLR-64 patch, but not there.
So I implemented HierarchicalTokenFilterFactory.
I've not looked into your patch yet, but my impression is that probably
we can share such TokenFilter.

Thanks,

Koji


Ryan McKinley wrote:
> Hello-
>
> I'm looking for a way to make tokens navigate a directory structure.  
> For example:
>
> Given:
> /aaa/bbb/ccc
>
> Make three Tokens:
> /aaa/
> /aaa/bbb/
> /aaa/bbb/ccc
>
> A while ago, I added:
> http://issues.apache.org/jira/browse/SOLR-1057
>
> Is there a "standard" way to do this?
>
> thanks
> ryan
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42006-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 08:32:06 2009
Return-Path: <java-user-return-42006-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82990 invoked from network); 25 Aug 2009 08:32:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 08:32:06 -0000
Received: (qmail 2937 invoked by uid 500); 25 Aug 2009 08:32:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2911 invoked by uid 500); 25 Aug 2009 08:32:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2899 invoked by uid 99); 25 Aug 2009 08:32:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 08:32:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [62.213.161.134] (HELO pmx.sirma.bg) (62.213.161.134)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 08:32:15 +0000
X-Virus-Scanned: Sirma Antivirus System
Received: from [192.168.128.140] (ivasilev.sirma.int [192.168.128.140])
	by pmx.sirma.bg (Sirma mail system) with ESMTP id F19A224002
	for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 11:31:51 +0300 (EEST)
Message-ID: <4A93A177.9040405@sirma.bg>
Date: Tue, 25 Aug 2009 11:31:51 +0300
From: Ivan Vasilev <ivasilev@sirma.bg>
User-Agent: Thunderbird 2.0.0.22 (Windows/20090605)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Faster way for faceting?
References: <4A92BC4D.1090806@sirma.bg> <f18c9dde0908240933y7ecc3f6dn81007f2b521846d7@mail.gmail.com>
In-Reply-To: <f18c9dde0908240933y7ecc3f6dn81007f2b521846d7@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Simon,

10x for your answer.
Unfortunately the code that you suggest is compatible in speed with the 
code that we use in our app (it was even a bit slower).

10x,
Ivan

Simon Willnauer wrote:
> Hi there,
>
> I'm not sure if the performance is considerable for you but you could try:
>  TermDocs termDocs = this.reader.termDocs(term);
>  int count = 0;
>  while(termDocs.next()){
>    count += termDocs.freq();
>  }
>
>
> simon
>
> On Mon, Aug 24, 2009 at 6:14 PM, Ivan Vasilev<ivasilev@sirma.bg> wrote:
>   
>> Hi All,
>>
>> We use faceting in our app but it is very slow for the indexes that use our
>> clients.
>> First I will say what I understand under faceting - this is for each term
>> for certain field to obtain 1. number of docs that contain it, 2. the total
>> number of occurrences of the term in the index.
>> Now what we use to obtain the information:
>>
>>      ...
>>      some code for obtained terms on which we will make faceting
>>      ...
>>
>>       Term[] retTerms = new Term[terms.size()];
>>       int[] retFreqs = new int[retTerms.length];
>>       int[] retDocs = new int[retTerms.length];
>>       TermPositions tp = mSearcher.getIndexReader().termPositions();
>>       int i = 0;
>>       for(Iterator<Term> iter = terms.iterator(); iter.hasNext(); i++) {
>>           try {
>>               retTerms[i] = iter.next();
>>               tp.seek(retTerms[i]);
>>               while(tp.next()) {
>>   //                tp.read(new int[]{}, new int[]{});
>> //                    tp.doc();
>>                   retFreqs[i] += tp.freq();
>>                   retDocs[i]++;
>>               }
>>           } finally {
>>               if(tp != null) {
>>                   tp.close();
>>               }
>>           }
>>       }
>>
>> Now what I discovered that is extremely faster for obtaining number of docs
>> that contain each term.
>>
>>       ...
>>      the same code for obtained terms on which we will make faceting
>>      ...
>>
>>       Term[] retTerms = new Term[terms.size()];
>>       int[] retFreqs = new int[retTerms.length];
>>       int i = 0;
>>       long t1 = System.currentTimeMillis();
>>       for (Term currTerm : terms) {
>>           retTerms[i] = currTerm;
>>           retFreqs[i] = mSearcher.docFreq(currTerm);
>>           i++;
>>       }
>>
>> I tested two code versions for obtaining 1 237 390 term facets. The
>> difference in time was 10 times (second version wins). I know that this is
>> because Lucene index keeps for each term the number of docs that contain it.
>>
>> My question - is there some way to obtain the total number of occurrences of
>> the term in the index in some similar fast way?
>>
>> Best Regards,
>> Ivan
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42007-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 09:20:30 2009
Return-Path: <java-user-return-42007-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 510 invoked from network); 25 Aug 2009 09:20:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 09:20:30 -0000
Received: (qmail 77420 invoked by uid 500); 25 Aug 2009 09:20:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77357 invoked by uid 500); 25 Aug 2009 09:20:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77346 invoked by uid 99); 25 Aug 2009 09:20:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 09:20:51 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [217.70.33.37] (HELO lists.levonline.com) (217.70.33.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 09:20:41 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by lists.levonline.com (Postfix) with ESMTP id E309129C207
	for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 11:20:20 +0200 (CEST)
X-Virus-Scanned: By http://levonline.com - free virus scanning for all
	customers
Received: from lists.levonline.com ([127.0.0.1])
	by localhost (lists.levonline.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 3mLuJsCtNiXw for <java-user@lucene.apache.org>;
	Tue, 25 Aug 2009 11:20:18 +0200 (CEST)
Received: from ormen1.djurnet.levonline.com (webhotel.djur.levonline.com [217.70.32.9])
	by lists.levonline.com (Postfix) with ESMTP id 48B3429C20F
	for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 11:20:18 +0200 (CEST)
Received: from [192.168.2.199] (145.187.241.83.in-addr.dgcsystems.net [83.241.187.145])
	(authenticated bits=0)
	by ormen1.djurnet.levonline.com (8.12.11.20060308/8.12.11) with ESMTP id n7P9KHWj004923
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 11:20:18 +0200
Message-ID: <4A93ACCC.6050904@trillian.se>
Date: Tue, 25 Aug 2009 11:20:12 +0200
From: =?ISO-8859-1?Q?Henric_M=FCller?= <henric@trillian.se>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene query syntax using grouping, MUST, MUST_NOT and SHOULD
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I have experience some strange things when dealing with Lucene queries. 
I've read some threads on this list and realize that Lucene shouldn't be 
seen as a complete boolean query language. However I try to understand 
the Lucene-way and have one example that I wonder if someone can help me 
to clarify.

I wish to create a query that gives me all persons outside us OR having 
Smith as last name, ie something like (Country != us or LastName == smith)
This is what I've tried:

+((-Country:us) (+LastName:smith))
results in only all with LastName smith. Ie all the non-Smith's outside 
us will not be included.

(-Country:us) (+LastName:smith)
results in all documents. I guess this is since both groups are SHOULD.

It seem to have something to do with the MUST_NOT before Country, since 
the query below works more as expected:
+((+Country:us) (+LastName:smith))
results in only all persons in us and all persons in all countries with 
last name smith.

Is this not possible to do with Lucene or am I missing something?

Best regards
Henric Mller
Trillian AB - www.spamdrain.net




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42008-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 10:45:38 2009
Return-Path: <java-user-return-42008-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54589 invoked from network); 25 Aug 2009 10:45:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 10:45:38 -0000
Received: (qmail 68515 invoked by uid 500); 25 Aug 2009 10:46:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68432 invoked by uid 500); 25 Aug 2009 10:46:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68418 invoked by uid 99); 25 Aug 2009 10:46:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 10:46:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.49.11] (HELO web52901.mail.re2.yahoo.com) (206.190.49.11)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 25 Aug 2009 10:45:51 +0000
Received: (qmail 95038 invoked by uid 60001); 25 Aug 2009 10:45:30 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1251197130; bh=Ph0HxrxPZ3ygalNYMDy8kU2MEmX2b7Ko3k4NQmqg3ik=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=RPpM+FR0kSCwO6tIU+bh7Co019q5+YpxLCvlQLZjbSajWcC2l3NZ/ZZ+dtZcUaRoxyxkiiCp75DHwnxPyT915SnYMJ45avuS5d9pSd5vJwU+rKZgY+SX66HM6rn45+gWd+D3VyMKSVD0xvOxruV+Cg434Y9AvjnRrYWHeIGXR2s=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=4XFnCFLvNH/oCoyUWYY2REFNmdWSHyLcVHyRC96xFU4AXVerFlFXV7ZcLzSBDzdqh5FxaWM7KZ7Yj1aD+YtRuoYMS6Bf3cdIhxBSI++zVkYGT0WLs4BxsZDrDZ1Ia7EMHQ5L0eDNtj6Nuw6TLmEIbgU/fPkojAbKZ4tSSA7O7L4=;
Message-ID: <562452.92373.qm@web52901.mail.re2.yahoo.com>
X-YMail-OSG: 3X_taeUVM1lfaUBkUdoa6AVYpn8NIVmXXDtFHMY0b1YsQXVKtBXGU5ibbUnsgYuxFNjeUE_wGpTc3haRS2jjZOGoB9qDkwp3rAPQ.67NGkrDWtIPgxC_mt8XPSq1WhIdeF51Y6ZXFyZcLEmbHT2sRg27KsdqZrFWZGRuQ967Ad09aCCW_hAodzOYxjisbuHH1oQPG6ICB7f6RptqJfs5GthrQEeXCUd_8ZoeTWzQ6oCrTp_2bpie.og7JM3pC8sWeXDzIPM92Fd_XMRx0wHKoOJC5gS393.1KzLooVWMWzRgPGJyzaQaDcpJ1vHFB1.SCM5b2mupABVFhgCTuThjwVSt.Q._wo8avAnoy6yS.g--
Received: from [193.140.184.100] by web52901.mail.re2.yahoo.com via HTTP; Tue, 25 Aug 2009 03:45:30 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.1
Date: Tue, 25 Aug 2009 03:45:30 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Lucene query syntax using grouping, MUST, MUST_NOT and SHOULD
To: java-user@lucene.apache.org
In-Reply-To: <4A93ACCC.6050904@trillian.se>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

=0A=0A--- On Tue, 8/25/09, Henric M=FCller <henric@trillian.se> wrote:=0A=
=0A> From: Henric M=FCller <henric@trillian.se>=0A> Subject: Lucene query s=
yntax using grouping, MUST, MUST_NOT and SHOULD=0A> To: java-user@lucene.ap=
ache.org=0A> Date: Tuesday, August 25, 2009, 12:20 PM=0A> Hi,=0A> =0A> I ha=
ve experience some strange things when dealing with=0A> Lucene queries. I'v=
e read some threads on this list and=0A> realize that Lucene shouldn't be s=
een as a complete boolean=0A> query language. However I try to understand t=
he Lucene-way=0A> and have one example that I wonder if someone can help me=
 to=0A> clarify.=0A> =0A> I wish to create a query that gives me all person=
s outside=0A> us OR having Smith as last name, ie something like (Country=
=0A> !=3D us or LastName =3D=3D smith)=0A=0A(Country:[* TO *] NOT Country:u=
s) OR LastName:smith=0A=0A"Note: The NOT operator cannot be used with just =
one term. For example, the following search will return no results: NOT "ja=
karta apache""[1]=0A=0A[1] http://lucene.apache.org/java/2_4_1/queryparsers=
yntax.html#NOT=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42009-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 12:58:37 2009
Return-Path: <java-user-return-42009-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1138 invoked from network); 25 Aug 2009 12:58:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 12:58:37 -0000
Received: (qmail 19136 invoked by uid 500); 25 Aug 2009 12:59:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19052 invoked by uid 500); 25 Aug 2009 12:59:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 13013 invoked by uid 99); 25 Aug 2009 12:56:55 -0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erik.hatcher@gmail.com designates 209.85.222.174 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :content-type:content-transfer-encoding:mime-version:subject:date
         :x-mailer;
        bh=gnIvENSJLfEvWhZICpr3/FiwNIAF9ymXRcZt4AIcVcA=;
        b=pLqY2CFGopq3FamrMM4EWteeLUSfLgJB2wUfBfKY2RTZaFWxbGsiGVn1N3RFiEcf9+
         mKKalaZFDBTVr0fnnDXvnPLbja/hjW/ARt5PVWkPZoaBMOUNChb3OoIEuNL4GWJxRvW0
         UFwmTfnIukYiLl4oU529TQ5XSTnHFZchZSWwI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:content-type:content-transfer-encoding
         :mime-version:subject:date:x-mailer;
        b=luHx7rGM4+kom0uTm+4jHjzBfL26VqB2ovAFrKf4qhg7ZNeA7UNHaA6I4kin7lkDd2
         VpFh3ox2XHMEzgiLG6ogVZukkmhrdE3RgQw6w3OibqQBUTF54jnIkqMRDvPXmu83ISoy
         WfdokSRIcuhjjG1TwKhJt9AncGEXW8iohrNxQ=
Message-Id: <AD1CCAED-6264-4000-9EFC-F86462178192@gmail.com>
From: Erik Hatcher <erik.hatcher@gmail.com>
To: java-user@lucene.apache.org,
 solr-user@lucene.apache.org,
 general@lucene.apache.org
Content-Type: text/plain; charset=WINDOWS-1252; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v935.3)
Subject: Lucene Meetup - September 3, Mountain View, CA
Date: Tue, 25 Aug 2009 08:56:16 -0400
X-Mailer: Apple Mail (2.935.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Announcing a new Meetup for SFBay Apache Lucene/Solr Meetup!

What: SFBay Apache Lucene/Solr June Meetup
When: September 3, 2009 6:30 PM
Where: Computer History Museum, 1401 N Shoreline Blvd, Mountain View, =20=

CA 94043

Presentations and discussions on Lucene/Solr, the Apache Open Source =20
Search Engine/Platform -- featuring:
	=95 "Lucene Search Performance Analysis": Andrzej Bialecki, =
Nutch =20
Committer / Luke author
	=95 "Can you find what they found? Solr @ Digg.com": Sammy Yu, =
Digg.com =20
Search Development
	=95 "Looking at Solr Relevancy": Mark Bennett, New Idea =
Engineering
	=95 "Search at Netflix and beyond": Walter Underwood, Search =
Veteran--=20
Infoseek, Verity, Netflix
	=95 "Innovations in search and social media": Brian Pinkerton, =
Chief =20
Architect, Lucid Imagination
More talks posted shortly!

Presentations followed by Lightning Talks from community members. =20
Lightning talks open for registration soon.

We'll have some food and beverages. Questions? Contact =
talks@lucidimagination.com

Learn more here: =
http://www.meetup.com/SFBay-Lucene-Solr-Meetup/calendar/11157028/
See other meetups at =
http://www.lucidimagination.com/Community/Marketplace/Meetups=

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42010-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 14:57:37 2009
Return-Path: <java-user-return-42010-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99381 invoked from network); 25 Aug 2009 14:57:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 14:57:37 -0000
Received: (qmail 35070 invoked by uid 500); 25 Aug 2009 14:58:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35008 invoked by uid 500); 25 Aug 2009 14:58:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34993 invoked by uid 99); 25 Aug 2009 14:57:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 14:57:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 14:57:50 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MfxSj-0000mT-98
	for java-user@lucene.apache.org; Tue, 25 Aug 2009 07:57:29 -0700
Message-ID: <25136045.post@talk.nabble.com>
Date: Tue, 25 Aug 2009 07:57:29 -0700 (PDT)
From: cemerick <cemerick@snowtide.com>
To: java-user@lucene.apache.org
Subject: Purpose of the file modification date methods in Directory?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: cemerick@snowtide.com
X-Virus-Checked: Checked by ClamAV on apache.org


I've built a Lucene Directory implementation for jdbm, an embedded Java
database. Part of the Directory API are two methods related to "file"
modification dates: touchFile and fileModified. My question is, what is the
purpose of these methods? I've searched the Lucene core source tree, and
found no usage of these methods at all.

FWIW, my interest is the fact that I'd like to not bother tracking mod
dates, given that I'm using an embedded datastore, and such metadata isn't
"free" as it is in a regular filesystem.  My jdbm Directory impl seems to be
working just fine (with touchFile a no-op and fileModified always returning
0).

Thanks,

- Chas
-- 
View this message in context: http://www.nabble.com/Purpose-of-the-file-modification-date-methods-in-Directory--tp25136045p25136045.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42011-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 15:03:16 2009
Return-Path: <java-user-return-42011-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3931 invoked from network); 25 Aug 2009 15:03:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 15:03:16 -0000
Received: (qmail 42051 invoked by uid 500); 25 Aug 2009 15:03:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41960 invoked by uid 500); 25 Aug 2009 15:03:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41950 invoked by uid 99); 25 Aug 2009 15:03:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 15:03:38 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fabriciorsf@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 15:03:30 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1855269qwh.53
        for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 08:03:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=OmaXZwvyryp+xjVEOqILhuLxtJ0KURDWvuxQHSaFsec=;
        b=VHUANxfRuOW2aTMnJAeNCCT5QXSLnDYs5v1T0mw58/gqX9Lyt096zgRpma8B9CVLWj
         i6zrsrmO51jeZhPLfC53Y51d6JiOK/L/gpof8BfRQOY7XXZ9HO5hcRF3bAvZobfr1wDN
         cXFl6X+MitIffcBwf5xU0fwC8HbrSYZUiPhho=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=sdEHSZYF/LlwrmA04QpgcpIYo1lP8ew2x0gPk6XsoFCaRG87xtvdj51uagP3Ryu2n7
         uODH+Wf7PtU8pvHRqgJyDxLhpRaRJOfSnTLDEafhhCuUkxp6cJF77vaSWj1XGp4kJDl0
         Mvn2cAQcwWh/iM1A606sY4Rf2p++2ggqO4uY8=
MIME-Version: 1.0
Received: by 10.229.16.73 with SMTP id n9mr1478592qca.70.1251212589818; Tue, 
	25 Aug 2009 08:03:09 -0700 (PDT)
In-Reply-To: <ac6e61fc0908212228n56f9e80dhcba439cf824511fe@mail.gmail.com>
References: <e02e1b4b0908211007t518862cfv32bfb4e6445e9c@mail.gmail.com>
	 <ac6e61fc0908212228n56f9e80dhcba439cf824511fe@mail.gmail.com>
Date: Tue, 25 Aug 2009 12:03:09 -0300
Message-ID: <e02e1b4b0908250803u1f68c4boe153a1eb51fbd016@mail.gmail.com>
Subject: Re: How to give a score for all documents?
From: =?ISO-8859-1?Q?Fabr=EDcio_Raphael?= <fabriciorsf@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015175cb4caf466510471f8a1b0
X-Virus-Checked: Checked by ClamAV on apache.org

--0015175cb4caf466510471f8a1b0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

I already know about this, but I want to give a customized score for all
documents in collection, independent if wache document is or isn't relevant
to the vector model.

The similarity function is called only when the document is relevant to the
vector model.

Do you understand me?

Thanks!

On Sat, Aug 22, 2009 at 2:28 AM, prashant ullegaddi <
prashullegaddi@gmail.com> wrote:

> If you want to modify the way Lucene scores documents, I guess you need t=
o
> extend Similarity class and provide your own implementation. Take a look
> at:
>
>
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/DefaultS=
imilarity.html
>
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Similari=
ty.html
>
> Thanks,
> Prashant.
>
> 2009/8/21 Fabr=EDcio Raphael <fabriciorsf@gmail.com>
>
> > How to give a customize score for all documents independent of the vect=
or
> > model?
> >
> > I already know how to give a customize score, but I want to give this
> > customize score for all documents in the collection, regardless of what
> is
> > relevant to the vector model.
> >
> > How to do this?
> >
> > Now, thanks!
> >
> > --
> > Fabr=EDcio Raphael
> >
>



--=20
Fabr=EDcio Raphael

--0015175cb4caf466510471f8a1b0--

From java-user-return-42012-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 16:17:36 2009
Return-Path: <java-user-return-42012-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80791 invoked from network); 25 Aug 2009 16:17:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 16:17:36 -0000
Received: (qmail 73864 invoked by uid 500); 25 Aug 2009 16:17:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73794 invoked by uid 500); 25 Aug 2009 16:17:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73780 invoked by uid 99); 25 Aug 2009 16:17:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 16:17:59 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 16:17:51 +0000
Received: by ewy22 with SMTP id 22so3746914ewy.28
        for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 09:17:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=P73GSh5/frKUyBArRlYDMNAU66fEhr2fJyQQvY5Uy+A=;
        b=fSxLOx6nYmFZFf0d0YEtnLk6TfvjYgaWmb7WnhBoW1sZCGFLHmsMxAKbBlRsiOleth
         mkuxWj1pYh9UPsbewaMS1SAmWLtQeJ1vyYWehBsaGEFOn6rv47H3zG3FgGQ06ZbIACio
         hTczDBXU4wwYbBBkc4eW19pMlFxPuhOs24TYw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=iQ/+kUvOT30usH2YIk60lzighMaMu3ht3JpBqAZXRgi0QBPf7NGTdyJaBOZqxSwYA1
         ycij5g5PJ3CuxcW64NUOikivM+tlXJvABqa22czBUN09hC3fMtSFRz+nIshfaxD1A38F
         79DftRJVakqmdQzATm+wgV+A9dtS9zh9mbDFU=
MIME-Version: 1.0
Received: by 10.216.28.66 with SMTP id f44mr1352401wea.28.1251217049644; Tue, 
	25 Aug 2009 09:17:29 -0700 (PDT)
In-Reply-To: <e02e1b4b0908250803u1f68c4boe153a1eb51fbd016@mail.gmail.com>
References: <e02e1b4b0908211007t518862cfv32bfb4e6445e9c@mail.gmail.com>
	 <ac6e61fc0908212228n56f9e80dhcba439cf824511fe@mail.gmail.com>
	 <e02e1b4b0908250803u1f68c4boe153a1eb51fbd016@mail.gmail.com>
Date: Tue, 25 Aug 2009 19:17:29 +0300
Message-ID: <786fde50908250917w515f1ff1tc9d03f60e7637557@mail.gmail.com>
Subject: Re: How to give a score for all documents?
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d62336c7f09a0471f9ab48
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d62336c7f09a0471f9ab48
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Can you please elaborate more on the use case? Why if a certain document is
irrelevant to a certain query, you'd like to give it a score? Are you
perhaps talking about certain documents which should always appear in searc=
h
results, no matter what the query is? And instead of always showing them,
you'd like to give them a "static score", so that they can compete w/ other
docs?

If that's the case, I think you can use a BooleanQuery such that the user
query is added as a clause and then you add another clause (MUST) which is
in fact a MatchAllDocsQuery or something like that which returns a
customized score. It's expensive though as for each query you'll score all
docs in the index.

But I don't think that will help (at least for this use case) since every
relevant document to the query will be added the same score as an
'irrelevant' document, which means the relevant docs will still win, no?

Shai

2009/8/25 Fabr=EDcio Raphael <fabriciorsf@gmail.com>

> I already know about this, but I want to give a customized score for all
> documents in collection, independent if wache document is or isn't releva=
nt
> to the vector model.
>
> The similarity function is called only when the document is relevant to t=
he
> vector model.
>
> Do you understand me?
>
> Thanks!
>
> On Sat, Aug 22, 2009 at 2:28 AM, prashant ullegaddi <
> prashullegaddi@gmail.com> wrote:
>
> > If you want to modify the way Lucene scores documents, I guess you need
> to
> > extend Similarity class and provide your own implementation. Take a loo=
k
> > at:
> >
> >
> >
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/DefaultS=
imilarity.html
> >
> >
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Similari=
ty.html
> >
> > Thanks,
> > Prashant.
> >
> > 2009/8/21 Fabr=EDcio Raphael <fabriciorsf@gmail.com>
> >
> > > How to give a customize score for all documents independent of the
> vector
> > > model?
> > >
> > > I already know how to give a customize score, but I want to give this
> > > customize score for all documents in the collection, regardless of wh=
at
> > is
> > > relevant to the vector model.
> > >
> > > How to do this?
> > >
> > > Now, thanks!
> > >
> > > --
> > > Fabr=EDcio Raphael
> > >
> >
>
>
>
> --
> Fabr=EDcio Raphael
>

--0016e6d62336c7f09a0471f9ab48--

From java-user-return-42013-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 16:36:01 2009
Return-Path: <java-user-return-42013-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87292 invoked from network); 25 Aug 2009 16:36:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 16:36:01 -0000
Received: (qmail 1846 invoked by uid 500); 25 Aug 2009 16:36:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1789 invoked by uid 500); 25 Aug 2009 16:36:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1779 invoked by uid 99); 25 Aug 2009 16:36:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 16:36:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.222.174 as permitted sender)
Received: from [209.85.222.174] (HELO mail-pz0-f174.google.com) (209.85.222.174)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 16:36:13 +0000
Received: by pzk4 with SMTP id 4so1659750pzk.29
        for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 09:35:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:x-enigmail-version:content-type
         :content-transfer-encoding;
        bh=iEiiOYpfzBO5awzaUtYedaTISdJk5xef8lRkVoySDG0=;
        b=nYaYgqY04RbZaC+PqQtQDzUpgIMhfBnbrDpoV+JyqV0ycII5lrfnLnS9W6Jz+/DRPj
         aO8eroXq6nEagNN9hNig7BAhRCIqjzrdI1G/CTiIZw7mIrWzfzNR4wQfk/V8CuTH/Kzd
         tpbr9Vc6OwhzeVQZ4KJq0j0BCR8lVPG2kFFlQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :x-enigmail-version:content-type:content-transfer-encoding;
        b=vWpao63HOQtglgBVm7OY5WL2uKFDuzjfWifcQByzAcOUcrxn0YsNs6VGCrigllnHt6
         EoX+j96uf0fPs3MlmCCJsRb13LiMOnNYsIZbZH9vkg1vW0ucVe42ACI0f472aCZpGr6s
         9oZ7UKEeScFQUoolKWrQqZO7C3TGtgXFLwppo=
Received: by 10.114.54.15 with SMTP id c15mr8002760waa.193.1251218150841;
        Tue, 25 Aug 2009 09:35:50 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 23sm282828pxi.5.2009.08.25.09.35.49
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 25 Aug 2009 09:35:50 -0700 (PDT)
Message-ID: <4A9412E4.9080904@gmail.com>
Date: Tue, 25 Aug 2009 12:35:48 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene release 2.9
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hello all Lucene users,

I just wanted to let you in on the current release schedule for Lucene
2.9 (still subject to change):

Currently, we plan to go into official feature freeze tomorrow
(Wednesday, August 26 2009). That means we will try and keep the 2.9
code as stable as possible, only committing documentation patches, bug
fixes, and build patches.

That is tentatively scheduled to last one week. During this time
(starting tomorrow), I'm going to host Lucene 2.9 RC distributions on my
people.apache personal site to make it easy for users to download and
help us test and find documentation/packaging issues. Any assistance you
can give us in this regard will help ensure a quality Lucene 2.9
release. If, and as, issues are found, I will put up new RCs and
announce on the list their availability. I don't recommend that you use
these RC's in production - they are not going to be the official
release. However, if you are already using trunk, you should be
qualified to make your own decisions in that regard.

If we feel comfortable that 2.9 is ready after the week freeze - Lucene
2.9 will be promptly released.

You can find the changes for Lucene 2.9 here:
https://svn.apache.org/repos/asf/lucene/java/trunk/CHANGES.txt

Thanks,

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42014-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 16:46:40 2009
Return-Path: <java-user-return-42014-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92120 invoked from network); 25 Aug 2009 16:46:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 16:46:40 -0000
Received: (qmail 23300 invoked by uid 500); 25 Aug 2009 16:47:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23231 invoked by uid 500); 25 Aug 2009 16:47:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23221 invoked by uid 99); 25 Aug 2009 16:47:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 16:47:03 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fabriciorsf@gmail.com designates 209.85.221.186 as permitted sender)
Received: from [209.85.221.186] (HELO mail-qy0-f186.google.com) (209.85.221.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 16:46:55 +0000
Received: by qyk16 with SMTP id 16so702895qyk.20
        for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 09:46:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=PVw8uvbJzFQnAxw0FHgPVHJtBNUmw9BhcyyiKMunpC0=;
        b=KSZrhjZV8lNLsRPIWoVTMiFlllSzKYAU4Y7L5kmhFmORGyOKNI3WXJVVZHF2bxbmqX
         BKiWjQ3h28oRSunvg/g+hAjrNNJZVw5EQcR6MVSGwa38WCr2p8qNYhinrM0k1Adk6aqD
         MY63T+CvyPyHU0VFBXJfpQn0db5tZ/IvdLBWk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=sGhZ2ftbrdaPRa9dxyKqGFrDxaiomlhHmnJs5pSxnW50+vd65hk3eFrwaq/XwoQ5ZG
         6/iUAHDmIBGcJr+M0/v3tTnJSDqVmLYWYJVJL00mb0Q/b1lM1dfv8xVtintj5Ytu+nqK
         NKKQ0ONmrFG5Fd3uPnfNR6kBi8KcvaDGYX0Xo=
MIME-Version: 1.0
Received: by 10.229.92.199 with SMTP id s7mr1556094qcm.23.1251218794092; Tue, 
	25 Aug 2009 09:46:34 -0700 (PDT)
In-Reply-To: <786fde50908250917w515f1ff1tc9d03f60e7637557@mail.gmail.com>
References: <e02e1b4b0908211007t518862cfv32bfb4e6445e9c@mail.gmail.com>
	 <ac6e61fc0908212228n56f9e80dhcba439cf824511fe@mail.gmail.com>
	 <e02e1b4b0908250803u1f68c4boe153a1eb51fbd016@mail.gmail.com>
	 <786fde50908250917w515f1ff1tc9d03f60e7637557@mail.gmail.com>
Date: Tue, 25 Aug 2009 13:46:34 -0300
Message-ID: <e02e1b4b0908250946g1a904fbai17db94de40ad215b@mail.gmail.com>
Subject: Re: How to give a score for all documents?
From: =?ISO-8859-1?Q?Fabr=EDcio_Raphael?= <fabriciorsf@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd6a7bac2196d0471fa130d
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd6a7bac2196d0471fa130d
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

First, that a document is relevant to a query does not necessarily mean tha=
t
this document has to contain some query term. You can have other ways to
assert that a document is relevant to a query.

My IR model is different of the vector model, so it can to give score not
null for documents irrelevant for the vector model. I know that Lucene
implements the vector model, but I want to use the facilities of the Lucene
because I like what the Lucene provides.

But the Lucene to give scores only for relevant documents for the vector
model. And the my model can to give score same that this documents isn't
relevant to vector model. It depends of the configuration granularity of
execution.

So I liked that method nextDoc() of the class that implements the
Scorer.class returned all the documents the end of the iteration to
calculate the score.

I've got to calculate the customized score of the documents that Lucene
returns in according to the vector model.

I hope you have understood me!

Thanks!


On Tue, Aug 25, 2009 at 1:17 PM, Shai Erera <serera@gmail.com> wrote:

> Can you please elaborate more on the use case? Why if a certain document =
is
> irrelevant to a certain query, you'd like to give it a score? Are you
> perhaps talking about certain documents which should always appear in
> search
> results, no matter what the query is? And instead of always showing them,
> you'd like to give them a "static score", so that they can compete w/ oth=
er
> docs?
>
> If that's the case, I think you can use a BooleanQuery such that the user
> query is added as a clause and then you add another clause (MUST) which i=
s
> in fact a MatchAllDocsQuery or something like that which returns a
> customized score. It's expensive though as for each query you'll score al=
l
> docs in the index.
>
> But I don't think that will help (at least for this use case) since every
> relevant document to the query will be added the same score as an
> 'irrelevant' document, which means the relevant docs will still win, no?
>
> Shai
>
> 2009/8/25 Fabr=EDcio Raphael <fabriciorsf@gmail.com>
>
> > I already know about this, but I want to give a customized score for al=
l
> > documents in collection, independent if wache document is or isn't
> relevant
> > to the vector model.
> >
> > The similarity function is called only when the document is relevant to
> the
> > vector model.
> >
> > Do you understand me?
> >
> > Thanks!
> >
> > On Sat, Aug 22, 2009 at 2:28 AM, prashant ullegaddi <
> > prashullegaddi@gmail.com> wrote:
> >
> > > If you want to modify the way Lucene scores documents, I guess you ne=
ed
> > to
> > > extend Similarity class and provide your own implementation. Take a
> look
> > > at:
> > >
> > >
> > >
> >
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/DefaultS=
imilarity.html
> > >
> > >
> >
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Similari=
ty.html
> > >
> > > Thanks,
> > > Prashant.
> > >
> > > 2009/8/21 Fabr=EDcio Raphael <fabriciorsf@gmail.com>
> > >
> > > > How to give a customize score for all documents independent of the
> > vector
> > > > model?
> > > >
> > > > I already know how to give a customize score, but I want to give th=
is
> > > > customize score for all documents in the collection, regardless of
> what
> > > is
> > > > relevant to the vector model.
> > > >
> > > > How to do this?
> > > >
> > > > Now, thanks!
> > > >
> > > > --
> > > > Fabr=EDcio Raphael
> > > >
> > >
> >
> >
> >
> > --
> > Fabr=EDcio Raphael
> >
>



--=20
Fabr=EDcio Raphael

--000e0cd6a7bac2196d0471fa130d--

From java-user-return-42015-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 17:36:43 2009
Return-Path: <java-user-return-42015-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14929 invoked from network); 25 Aug 2009 17:36:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 17:36:43 -0000
Received: (qmail 91912 invoked by uid 500); 25 Aug 2009 17:37:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91844 invoked by uid 500); 25 Aug 2009 17:37:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91834 invoked by uid 99); 25 Aug 2009 17:37:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 17:37:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 17:36:56 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id B616171C299; Tue, 25 Aug 2009 10:36:35 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id B0B2471C11D
	for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 10:36:35 -0700 (PDT)
Date: Tue, 25 Aug 2009 10:36:35 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Extending Sort/FieldCache
In-Reply-To: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: I'd like to extend Lucene's FieldCache such that it will read native values
	...
: payload value to long, and store it in the cache. The reason I want to
: extend Lucene's FieldCache is because I'd like Lucene to take care of
: updating this cache when necessary (such as after reopen for example). This
: will allow me to use Lucene's Sort option more easily.

this was my motivation when i opened LUCENE-831, but i promptly got bogged 
down with other shit and had to abandon that issue ... 
Miller/Uwe/McCandles seemed like they were making really cool progress 
with it, but (if i remember correctly) it seems to have gotten into some 
sort of quagmire related to reopen and segment merging -- which led to a 
lot of the current segment based sortinging we have now, which makes most 
of that issue obsolete.

but we still have hte issue of wanting to provide your own caching 
mechanism -- which at the moment has no solution that i know of.

: I noticed Sort can be extended by providing a CUSTOM SortField, but that

i think you're only option is to use a custom Sort which uses your own 
private cache of some kind.

: I didn't find a way though to extend FieldCache, or ExtendedFieldCache -->
: even though both are extendable, I don't find the place where they're given
: as input to TopFieldDocCollector, FieldSortedHitQueue etc. Perhaps I'm
: missing it?

you're not missing anything ... a singleton is used, and you can't replace 
the singlton because its' a static on the Interface.

: BTW, if it interests anyone, perhaps augmenting Lucene's sort w/ reading
: values from a Payload, or doing a complete payload-based-sort, I can work up
: a patch ...

I believe that was always one of Busch's goals with the payload stuff, but 
last time i remember hearing about it he was thinking that rather then 
doing it directly with payloads he wants to skip ahead to use column-stride 
fields ... not sure if he had an implementation in mind yet though.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42016-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 17:57:23 2009
Return-Path: <java-user-return-42016-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28502 invoked from network); 25 Aug 2009 17:57:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 17:57:23 -0000
Received: (qmail 28485 invoked by uid 500); 25 Aug 2009 17:57:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28408 invoked by uid 500); 25 Aug 2009 17:57:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28396 invoked by uid 99); 25 Aug 2009 17:57:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 17:57:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 17:57:36 +0000
Received: by bwz10 with SMTP id 10so2159907bwz.5
        for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 10:57:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=L9r2Cb61aS0KGDmmszg5ccQYyBH5eyVILcQECXc9xnU=;
        b=LTe4Me/iYhZImCwnNvRseDy5dOZldM2g1YjDBYJCZUUMns6+zB9n4cHZ0hJ3E0F/Ct
         pZga0PcIM82Zfeo09mpjYQ5tnPgkyOmDpP7OkubB/aEiLIvnPDKcGLHoMwbiXdKOgLVS
         +bik6JcAPa+DxGZ0PKHAJOXXItu4IQ1G+m2bg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=xoGi7K1hclmrp9c2KIdOjIwiBNpW+hzZHU5vT1SnMp5WKoYZWetwTtAV03OEBOICPg
         yJe9cUkKejNttktWhWa8n0qZJaJJRZaBqMwbSrI8qpv0amOipX6xEdjfWjYX9XC0nVWm
         ZGeCjtrwL9h8ulXhcjb9tGQ9ivGc0pO7uIWDc=
MIME-Version: 1.0
Received: by 10.239.145.29 with SMTP id q29mr654893hba.127.1251223034680; Tue, 
	25 Aug 2009 10:57:14 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <e02e1b4b0908250946g1a904fbai17db94de40ad215b@mail.gmail.com>
References: <e02e1b4b0908211007t518862cfv32bfb4e6445e9c@mail.gmail.com>
	 <ac6e61fc0908212228n56f9e80dhcba439cf824511fe@mail.gmail.com>
	 <e02e1b4b0908250803u1f68c4boe153a1eb51fbd016@mail.gmail.com>
	 <786fde50908250917w515f1ff1tc9d03f60e7637557@mail.gmail.com>
	 <e02e1b4b0908250946g1a904fbai17db94de40ad215b@mail.gmail.com>
Date: Tue, 25 Aug 2009 19:57:14 +0200
Message-ID: <f18c9dde0908251057g63095903y976b7a6d6592c0e2@mail.gmail.com>
Subject: Re: How to give a score for all documents?
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Fabricio,

I will try to recap what you are trying to say...

you IR model does score documents that would not be returned by a
particular query. So you have some other indicator that make a
document relevant?! If it is not a term could you give use an example?
How would you decide if a doc is relevant or what would make it
"scorable"?

I guess an example would help :)

simon

2009/8/25 Fabr=C3=ADcio Raphael <fabriciorsf@gmail.com>:
> First, that a document is relevant to a query does not necessarily mean t=
hat
> this document has to contain some query term. You can have other ways to
> assert that a document is relevant to a query.
>
> My IR model is different of the vector model, so it can to give score not
> null for documents irrelevant for the vector model. I know that Lucene
> implements the vector model, but I want to use the facilities of the Luce=
ne
> because I like what the Lucene provides.
>
> But the Lucene to give scores only for relevant documents for the vector
> model. And the my model can to give score same that this documents isn't
> relevant to vector model. It depends of the configuration granularity of
> execution.
>
> So I liked that method nextDoc() of the class that implements the
> Scorer.class returned all the documents the end of the iteration to
> calculate the score.
>
> I've got to calculate the customized score of the documents that Lucene
> returns in according to the vector model.
>
> I hope you have understood me!
>
> Thanks!
>
>
> On Tue, Aug 25, 2009 at 1:17 PM, Shai Erera <serera@gmail.com> wrote:
>
>> Can you please elaborate more on the use case? Why if a certain document=
 is
>> irrelevant to a certain query, you'd like to give it a score? Are you
>> perhaps talking about certain documents which should always appear in
>> search
>> results, no matter what the query is? And instead of always showing them=
,
>> you'd like to give them a "static score", so that they can compete w/ ot=
her
>> docs?
>>
>> If that's the case, I think you can use a BooleanQuery such that the use=
r
>> query is added as a clause and then you add another clause (MUST) which =
is
>> in fact a MatchAllDocsQuery or something like that which returns a
>> customized score. It's expensive though as for each query you'll score a=
ll
>> docs in the index.
>>
>> But I don't think that will help (at least for this use case) since ever=
y
>> relevant document to the query will be added the same score as an
>> 'irrelevant' document, which means the relevant docs will still win, no?
>>
>> Shai
>>
>> 2009/8/25 Fabr=C3=ADcio Raphael <fabriciorsf@gmail.com>
>>
>> > I already know about this, but I want to give a customized score for a=
ll
>> > documents in collection, independent if wache document is or isn't
>> relevant
>> > to the vector model.
>> >
>> > The similarity function is called only when the document is relevant t=
o
>> the
>> > vector model.
>> >
>> > Do you understand me?
>> >
>> > Thanks!
>> >
>> > On Sat, Aug 22, 2009 at 2:28 AM, prashant ullegaddi <
>> > prashullegaddi@gmail.com> wrote:
>> >
>> > > If you want to modify the way Lucene scores documents, I guess you n=
eed
>> > to
>> > > extend Similarity class and provide your own implementation. Take a
>> look
>> > > at:
>> > >
>> > >
>> > >
>> >
>> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Default=
Similarity.html
>> > >
>> > >
>> >
>> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Similar=
ity.html
>> > >
>> > > Thanks,
>> > > Prashant.
>> > >
>> > > 2009/8/21 Fabr=C3=ADcio Raphael <fabriciorsf@gmail.com>
>> > >
>> > > > How to give a customize score for all documents independent of the
>> > vector
>> > > > model?
>> > > >
>> > > > I already know how to give a customize score, but I want to give t=
his
>> > > > customize score for all documents in the collection, regardless of
>> what
>> > > is
>> > > > relevant to the vector model.
>> > > >
>> > > > How to do this?
>> > > >
>> > > > Now, thanks!
>> > > >
>> > > > --
>> > > > Fabr=C3=ADcio Raphael
>> > > >
>> > >
>> >
>> >
>> >
>> > --
>> > Fabr=C3=ADcio Raphael
>> >
>>
>
>
>
> --
> Fabr=C3=ADcio Raphael
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42017-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 18:09:52 2009
Return-Path: <java-user-return-42017-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34986 invoked from network); 25 Aug 2009 18:09:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 18:09:52 -0000
Received: (qmail 51192 invoked by uid 500); 25 Aug 2009 18:10:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51144 invoked by uid 500); 25 Aug 2009 18:10:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51119 invoked by uid 99); 25 Aug 2009 18:10:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 18:10:15 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of fabriciorsf@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 18:10:03 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1905154qwh.53
        for <java-user@lucene.apache.org>; Tue, 25 Aug 2009 11:09:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=42KZzmnQGVyU1Dq311aGyxo3YjOG+vwCGnMa+8wjO9o=;
        b=CVwcww+RBU41rgsRJoILz8MuXEeBF6sgDfnPDD2UeDD2NGYqJHtY8CWIf5nrpEvZvV
         NcpuVlUvxBg9/bLiSQ2acK4ardIcooasbSzWRjur10ZmZ+ijkL7EcVu2LYLsEDX6lZVE
         DLf9/34f0UlCiqHKA9fr7IbOqgFg03re7T0H4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=aVIAz2lIArbOd95vbXFdpZK3sbMZCdMXnV27UEMsAXBq1Dp3/OdUSCXBEsKac3dJco
         1+U1yG0Gg/bdbG+Mh5Rr4zXbt2DjePdIq4HPcCTu5/TAMd8+CECSFUB5DGMptXDuaR5N
         ZJzpBbti3rHxXn8n3gilGiv5RfmXcEUzf8TIo=
MIME-Version: 1.0
Received: by 10.229.39.69 with SMTP id f5mr1758462qce.107.1251223782079; Tue, 
	25 Aug 2009 11:09:42 -0700 (PDT)
In-Reply-To: <f18c9dde0908251057g63095903y976b7a6d6592c0e2@mail.gmail.com>
References: <e02e1b4b0908211007t518862cfv32bfb4e6445e9c@mail.gmail.com>
	 <ac6e61fc0908212228n56f9e80dhcba439cf824511fe@mail.gmail.com>
	 <e02e1b4b0908250803u1f68c4boe153a1eb51fbd016@mail.gmail.com>
	 <786fde50908250917w515f1ff1tc9d03f60e7637557@mail.gmail.com>
	 <e02e1b4b0908250946g1a904fbai17db94de40ad215b@mail.gmail.com>
	 <f18c9dde0908251057g63095903y976b7a6d6592c0e2@mail.gmail.com>
Date: Tue, 25 Aug 2009 15:09:42 -0300
Message-ID: <e02e1b4b0908251109w143dd339gd2206cdbd0c1acc9@mail.gmail.com>
Subject: Re: How to give a score for all documents?
From: =?ISO-8859-1?Q?Fabr=EDcio_Raphael?= <fabriciorsf@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364275f710bdfe0471fb3d04
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364275f710bdfe0471fb3d04
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

I am continuing a work about wavelets in IR. In the bellow article you will
to find a example.

http://www.ieeexplore.ieee.org/search/srchabstract.jsp?arnumber=3D4740460&i=
snumber=3D4740405&punumber=3D4740404&k2dockey=3D4740460@ieeecnfs&query=3D%2=
8%28using+wavelets+to+classify+documents%29%3Cin%3Eti+%29&pos=3D0&access=3D=
no

Att,

On Tue, Aug 25, 2009 at 2:57 PM, Simon Willnauer <
simon.willnauer@googlemail.com> wrote:

> Hi Fabricio,
>
> I will try to recap what you are trying to say...
>
> you IR model does score documents that would not be returned by a
> particular query. So you have some other indicator that make a
> document relevant?! If it is not a term could you give use an example?
> How would you decide if a doc is relevant or what would make it
> "scorable"?
>
> I guess an example would help :)
>
> simon
>
> 2009/8/25 Fabr=EDcio Raphael <fabriciorsf@gmail.com>:
> > First, that a document is relevant to a query does not necessarily mean
> that
> > this document has to contain some query term. You can have other ways t=
o
> > assert that a document is relevant to a query.
> >
> > My IR model is different of the vector model, so it can to give score n=
ot
> > null for documents irrelevant for the vector model. I know that Lucene
> > implements the vector model, but I want to use the facilities of the
> Lucene
> > because I like what the Lucene provides.
> >
> > But the Lucene to give scores only for relevant documents for the vecto=
r
> > model. And the my model can to give score same that this documents isn'=
t
> > relevant to vector model. It depends of the configuration granularity o=
f
> > execution.
> >
> > So I liked that method nextDoc() of the class that implements the
> > Scorer.class returned all the documents the end of the iteration to
> > calculate the score.
> >
> > I've got to calculate the customized score of the documents that Lucene
> > returns in according to the vector model.
> >
> > I hope you have understood me!
> >
> > Thanks!
> >
> >
> > On Tue, Aug 25, 2009 at 1:17 PM, Shai Erera <serera@gmail.com> wrote:
> >
> >> Can you please elaborate more on the use case? Why if a certain docume=
nt
> is
> >> irrelevant to a certain query, you'd like to give it a score? Are you
> >> perhaps talking about certain documents which should always appear in
> >> search
> >> results, no matter what the query is? And instead of always showing
> them,
> >> you'd like to give them a "static score", so that they can compete w/
> other
> >> docs?
> >>
> >> If that's the case, I think you can use a BooleanQuery such that the
> user
> >> query is added as a clause and then you add another clause (MUST) whic=
h
> is
> >> in fact a MatchAllDocsQuery or something like that which returns a
> >> customized score. It's expensive though as for each query you'll score
> all
> >> docs in the index.
> >>
> >> But I don't think that will help (at least for this use case) since
> every
> >> relevant document to the query will be added the same score as an
> >> 'irrelevant' document, which means the relevant docs will still win, n=
o?
> >>
> >> Shai
> >>
> >> 2009/8/25 Fabr=EDcio Raphael <fabriciorsf@gmail.com>
> >>
> >> > I already know about this, but I want to give a customized score for
> all
> >> > documents in collection, independent if wache document is or isn't
> >> relevant
> >> > to the vector model.
> >> >
> >> > The similarity function is called only when the document is relevant
> to
> >> the
> >> > vector model.
> >> >
> >> > Do you understand me?
> >> >
> >> > Thanks!
> >> >
> >> > On Sat, Aug 22, 2009 at 2:28 AM, prashant ullegaddi <
> >> > prashullegaddi@gmail.com> wrote:
> >> >
> >> > > If you want to modify the way Lucene scores documents, I guess you
> need
> >> > to
> >> > > extend Similarity class and provide your own implementation. Take =
a
> >> look
> >> > > at:
> >> > >
> >> > >
> >> > >
> >> >
> >>
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/DefaultS=
imilarity.html
> >> > >
> >> > >
> >> >
> >>
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Similari=
ty.html
> >> > >
> >> > > Thanks,
> >> > > Prashant.
> >> > >
> >> > > 2009/8/21 Fabr=EDcio Raphael <fabriciorsf@gmail.com>
> >> > >
> >> > > > How to give a customize score for all documents independent of t=
he
> >> > vector
> >> > > > model?
> >> > > >
> >> > > > I already know how to give a customize score, but I want to give
> this
> >> > > > customize score for all documents in the collection, regardless =
of
> >> what
> >> > > is
> >> > > > relevant to the vector model.
> >> > > >
> >> > > > How to do this?
> >> > > >
> >> > > > Now, thanks!
> >> > > >
> >> > > > --
> >> > > > Fabr=EDcio Raphael
> >> > > >
> >> > >
> >> >
> >> >
> >> >
> >> > --
> >> > Fabr=EDcio Raphael
> >> >
> >>
> >
> >
> >
> > --
> > Fabr=EDcio Raphael
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


--=20
Fabr=EDcio Raphael

--0016364275f710bdfe0471fb3d04--

From java-user-return-42018-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Aug 25 23:21:18 2009
Return-Path: <java-user-return-42018-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91387 invoked from network); 25 Aug 2009 23:21:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Aug 2009 23:21:18 -0000
Received: (qmail 75405 invoked by uid 500); 25 Aug 2009 23:21:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75261 invoked by uid 500); 25 Aug 2009 23:21:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75201 invoked by uid 99); 25 Aug 2009 23:21:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 23:21:38 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HS_INDEX_PARAM,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bradfordstephens@gmail.com designates 209.85.211.173 as permitted sender)
Received: from [209.85.211.173] (HELO mail-yw0-f173.google.com) (209.85.211.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Aug 2009 23:21:28 +0000
Received: by ywh3 with SMTP id 3so5121400ywh.22
        for <multiple recipients>; Tue, 25 Aug 2009 16:21:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=5irSznTvdYtk+2bFn3BYOLjkC1jvi1Q5RHBTobSxp+M=;
        b=PrGFxW+B62fWzEK+sKyYVBEM42FOR0QWx0IwOd44LDuhTh4Yi7i+eVABUQDxMfAHEI
         tCvRBoFRpL25Vu/XI6ihy3diRKbRdBDMcxL7jLbk3VnlLHEg50S5MGoBnTlRJ229nDpo
         WJv07dcUIvqlIidrMeVHVjpXYziA0nxdWpAoI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=dNev73AKfJvyMCdMp9g7cZe7j4PXu1w1DdJfxsbxA5ohrVch2VYH+cxEp6ZvOgelbJ
         5wai+N8LDXo0axYausF2apYSREikdsIIxOrpG76wwUWlXYrawQhPzlFlDY2hQbFfNHoP
         fv4qfAL0VY6nMUQb88oWQh913gm3nqpQZTw1w=
MIME-Version: 1.0
Received: by 10.90.18.33 with SMTP id 33mr5433631agr.113.1251242467885; Tue, 
	25 Aug 2009 16:21:07 -0700 (PDT)
Date: Tue, 25 Aug 2009 16:21:07 -0700
Message-ID: <860544ed0908251621leacbe9andc4daefdabb8d62b@mail.gmail.com>
Subject: Seattle / NW Hadoop, HBase Lucene, etc. Meetup , Wed August 26th, 
	6:45pm
From: Bradford Stephens <bradfordstephens@gmail.com>
To: core-user@hadoop.apache.org, hbase-user@hadoop.apache.org, 
	solr-user@lucene.apache.org, java-user@lucene.apache.org, 
	pig-user@hadoop.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hey there,

Apologies for this not going out sooner -- apparently it was sitting
as a draft in my inbox. A few of you have pinged me, so thanks for
your vigilance.

It's time for another Hadoop/Lucene/Apache Stack meetup! We've had
great attendance in the past few months, let's keep it up! I'm always
amazed by the things I learn from everyone.

We're back at the University of Washington, Allen Computer Science
Center (not Computer Engineering)
Map: http://www.washington.edu/home/maps/?CSE

Room: 303 -or- the Entry level. If there are changes, signs will be posted.

More Info:

The meetup is about 2 hours: we'll have two in-depth talks of 15-20
minutes each, and then several "lightning talks" of 5 minutes. If no
one offers, We'll then have discussion and 'social time'.=A0 we'll just
have general discussion. Let net know if you're interested in speaking
or attending. We'd like to focus on education, so every presentation
*needs* to ask some questions at the end. We can talk about these
after the presentations, and I'll record what we've learned in a wiki
and share that with the rest of us.

Contact: Bradford Stephens, 904-415-3009, bradfordstephens@gmail.com

--
http://www.roadtofailure.com -- The Fringes of Scalability, Social
Media, and Computer Science

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42019-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 08:03:23 2009
Return-Path: <java-user-return-42019-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78348 invoked from network); 26 Aug 2009 08:03:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 08:03:23 -0000
Received: (qmail 60084 invoked by uid 500); 26 Aug 2009 08:03:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60009 invoked by uid 500); 26 Aug 2009 08:03:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59999 invoked by uid 99); 26 Aug 2009 08:03:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 08:03:20 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [87.248.115.50] (HELO web23607.mail.ird.yahoo.com) (87.248.115.50)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 26 Aug 2009 08:03:08 +0000
Received: (qmail 35257 invoked by uid 60001); 26 Aug 2009 08:02:48 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.es; s=s1024; t=1251273768; bh=s726i83G334KtHt7Rzas53sPXGQo8CM7zDLi1/vaRMc=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=DtHQR6V16dPXX62mhZux8h9Q4ZS9qejfhU4j3HOsFCpstEFb7+jpVQsF9Qsq717ORpSf/J8Rn4FFRnSmSFLm2ue2jxi/GsP36mrL8A7fTGc956EiVoyE3jgp7k09kwRoaJtL/1dpIWvtZKjXgab7kR0GUxRI08wkb0+9jKjnKcc=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.es;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=d89VVCq+wi7tR8tWrOZqDgp6LVtn+drRUe6Wys6DTh3eki5GUQ2JtGW4VA9rQzhOIFw83zxBIrBcE4UQt2IS6SVJmrzPDycH9Uj881jmuuiwzEwRRSyyGVcj+ZRgp9BJc9IxPhGddvthv6s2DrK1uN6zoi6rAxPI6HQPXPAEgew=;
Message-ID: <646516.34719.qm@web23607.mail.ird.yahoo.com>
X-YMail-OSG: Jur7a9UVM1mUxBV9MQEf3jcr4ue2RL9QbHTrzHRL5bcR.QZPqddw7LRulB_Rj5tZ4fZnt.wI0Cj89qWcqI_LLLrVTZXOf1XclyaDaNWZDGg1ndkLKZkmlAiNISWVUiUocS3yG5nCUKRb_1y2KNO54rRJeGg22gDeeKVTWwq2k0bRUvbw2PtG1woMXuxBeFOwSVneuFWFZygS5BS2Ch5.eqSJxvhKr_KNP2kP2F0RQ3_ESjsCBrdJsvK6QENmzfsklfxLcTI1RmreOPKNFza68qEbrRkE9Q8d9RGkzQxmTv38AJuyQ7eZRgv_eF9uBMV03DME1dHYGG8i9jvyxkjWVE9wD2.w_PNSHfvlLg--
Received: from [145.64.134.242] by web23607.mail.ird.yahoo.com via HTTP; Wed, 26 Aug 2009 08:02:48 GMT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.2
Date: Wed, 26 Aug 2009 08:02:48 +0000 (GMT)
From: David de la Torre <torremartin@yahoo.es>
Subject: "Read timed out" behind firewall - Ports closed? Loopback?
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-81443011-1251273768=:34719"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-81443011-1251273768=:34719
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable

When running lucene, on a machine with a firewall, I got the following=0Aer=
ror message, which I think it must be related to the firewall. In=0Afact, w=
hen I shut down the firewall, the error dissapears. It must be=0Asomething =
relating to the ports I have open. Lucene says it is running=0Ain port 8875=
. Is this the only port to open? is it a UDP or TCP port ?=0ACould it also =
be related to the loopback?

100870 [XML-RPC-0] ERROR org.apache.xmlrpc.webserver.WebServer  - Read time=
d out
java.net.SocketTimeoutException: Read timed out
=09at java.net.SocketInputStream.socketRead0(Native Method)
=09at java.net.SocketInputStream.read(SocketInputStream.java:146)
=09at java.io.BufferedInputStream.fill(BufferedInputStream.java:235)
=09at java.io.BufferedInputStream.read(BufferedInputStream.java:254)
=09at=0A org.apache.xmlrpc.webserver.Connection.readLine(Connection.java:19=
5)
=09at org.apache.xmlrpc.webserver.Connection.getRequestConfig(Connection.ja=
va:126)
=09at org.apache.xmlrpc.webserver.Connection.run(Connection.java:171)
=09at org.apache.xmlrpc.util.ThreadPool$MyThread.runTask(ThreadPool.java:71=
)
=09at org.apache.xmlrpc.util.ThreadPool$MyThread.run(ThreadPool.java:87)=0A=
=0A=0A      
--0-81443011-1251273768=:34719--

From java-user-return-42020-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 08:24:02 2009
Return-Path: <java-user-return-42020-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83677 invoked from network); 26 Aug 2009 08:24:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 08:24:02 -0000
Received: (qmail 91719 invoked by uid 500); 26 Aug 2009 08:23:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91629 invoked by uid 500); 26 Aug 2009 08:23:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91619 invoked by uid 99); 26 Aug 2009 08:23:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 08:23:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.225 as permitted sender)
Received: from [209.85.220.225] (HELO mail-fx0-f225.google.com) (209.85.220.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 08:23:48 +0000
Received: by fxm25 with SMTP id 25so2832302fxm.5
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 01:23:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=qzD9xwqGrBGicantgoay8/wiXaMrYSkBjgJ/eHttPjc=;
        b=dPHe7uIwqIHNBi/px/1RTV0bFrc/vZWuR80omTHlR9M+t6JLUiiPz8MHfUzmmUe6/b
         h9cymsYn0Vu2tBqv2SirYNIXKdeLZ+cy2PHefD0Y/5CFO0yMMu3n5n8TW1v6DVcxyh+M
         858bVKYop31/B5cCrhVCxhQR7ZAgWjrPRvrkI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=Lnjko6SX3lzk94ZCQ3vhRlVFFXYeHx4VrF1zgxuYqmV7TNd1/8Tleq66RMcNmldhd2
         rka/WSaJQ1JuLaATRrCnrIuWehql1XQIWa4lniFEIMm5Z84A/ozAQD8h19XegNwxvvWM
         7yza1v8hRnuHi2mcTPfhGC8AEaac4klEv6+6Y=
MIME-Version: 1.0
Received: by 10.239.145.144 with SMTP id s16mr708122hba.145.1251275007832; 
	Wed, 26 Aug 2009 01:23:27 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <646516.34719.qm@web23607.mail.ird.yahoo.com>
References: <646516.34719.qm@web23607.mail.ird.yahoo.com>
Date: Wed, 26 Aug 2009 10:23:27 +0200
Message-ID: <f18c9dde0908260123l4a8327d3n4d10c2d260492976@mail.gmail.com>
Subject: Re: "Read timed out" behind firewall - Ports closed? Loopback?
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

David,

I can not follow you. What kind of Lucene applicaiton are you talking
about. Afaik lucene does not use xmlRPC anywhere and we do not have
any dependency on it (Do I miss something?). There is a RemoteSearcher
/ RemoteSearchable in core (until 2.4.1) and now in contrib/remote
which uses RMI and the default port is 1099. But your stacktrace seems
to be something else.

If this has anything to do with lucene-core / contrib you will get
help if you can elaborate your problem further. If this is related to
some other app/project using lucene you might be better asking the
projects mailing-list.

simon

On Wed, Aug 26, 2009 at 10:02 AM, David de la Torre<torremartin@yahoo.es> w=
rote:
> When running lucene, on a machine with a firewall, I got the following
> error message, which I think it must be related to the firewall. In
> fact, when I shut down the firewall, the error dissapears. It must be
> something relating to the ports I have open. Lucene says it is running
> in port 8875. Is this the only port to open? is it a UDP or TCP port ?
> Could it also be related to the loopback?
>
> 100870 [XML-RPC-0] ERROR org.apache.xmlrpc.webserver.WebServer =C2=A0- Re=
ad timed out
> java.net.SocketTimeoutException: Read timed out
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.net.SocketInputStream.socketRead0(Nati=
ve Method)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.net.SocketInputStream.read(SocketInput=
Stream.java:146)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.BufferedInputStream.fill(BufferedIn=
putStream.java:235)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.BufferedInputStream.read(BufferedIn=
putStream.java:254)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> =C2=A0org.apache.xmlrpc.webserver.Connection.readLine(Connection.java:195=
)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.apache.xmlrpc.webserver.Connection.getR=
equestConfig(Connection.java:126)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.apache.xmlrpc.webserver.Connection.run(=
Connection.java:171)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.apache.xmlrpc.util.ThreadPool$MyThread.=
runTask(ThreadPool.java:71)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.apache.xmlrpc.util.ThreadPool$MyThread.=
run(ThreadPool.java:87)
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42021-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 09:19:07 2009
Return-Path: <java-user-return-42021-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96526 invoked from network); 26 Aug 2009 09:19:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 09:19:07 -0000
Received: (qmail 54759 invoked by uid 500); 26 Aug 2009 09:19:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54706 invoked by uid 500); 26 Aug 2009 09:19:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54696 invoked by uid 99); 26 Aug 2009 09:19:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 09:19:04 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [87.248.115.44] (HELO web23601.mail.ird.yahoo.com) (87.248.115.44)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 26 Aug 2009 09:18:53 +0000
Received: (qmail 74511 invoked by uid 60001); 26 Aug 2009 09:18:31 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.es; s=s1024; t=1251278311; bh=rlauU6BbT1PB/v4Iy2LV9mbV8bON4W0709hBJo8+9gI=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=G7h4XyxnmIwx8o6hva8xi2T+d1NJUHkquEkLV8C+htEu4YZZgS4X+4+t9E231Wplok4ZYQfahu80zMd+3fYP6FzrXE8ug3WBkpTHd8TPcV25Xmu+ls7Ve7WPGSq8ws6PXyYI2hV2YQLt/ORe43xTHJ92RjENpmaQ8bCJUZ2d+hE=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.es;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=jHMkQEdPMp8x6IutDO8dY6bIRaufPbKX2MxYEDDwafKULcZz6YcnpPOJJ9Tb12KojIEzabe/bcmMgA33hA2gwdvgSjor+oxh7xhgCrc7TZ5gY15r5++tT5R3dWPY6RnXmQIEFr9dv8Ry66BJMK519F7KfdelmyhkR9jqTxWHEAY=;
Message-ID: <328812.74396.qm@web23601.mail.ird.yahoo.com>
X-YMail-OSG: hPCLdfwVM1lbiFibsfFo3U.DYN0tENloBP3Wd5smxTZUm9Vq9MB5A0lGA_pcsxL5VYf8uBwRyrcYsIlrdJwi_H6uSsNhlviOeyJddT4Qu5fd4zX8zSV_vAjjmUvrBtjt8xVvdCk.3SAYse7UUuL7qpEoqdA.ThQgPtN_5Ef0.qUSE0FUIJ3eyw4.cvPqKAul5m9VgiVeG5lPW9MfzRU_CYb80zJs4CJh0bx14Mv3JxIjEtWqM8g6VLnkqqMd0DXRc2OUKObij_VDUPwpO8fU2h6hFFCbnnb0ItaSnLKjTKnclHxwkXH5FqPxYKJDGrpiWklqUPWs69e1nSyY3H7Wx1wOjqHR2HTSag4PThdh0U1B93za_gP5k7F6QbxtCVSMagq_EARdMebRY85s
Received: from [145.64.134.242] by web23601.mail.ird.yahoo.com via HTTP; Wed, 26 Aug 2009 09:18:31 GMT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.2
Date: Wed, 26 Aug 2009 09:18:31 +0000 (GMT)
From: David de la Torre <torremartin@yahoo.es>
Subject: Re: "Read timed out" behind firewall - Ports closed? Loopback?
To: java-user@lucene.apache.org, simon.willnauer@gmail.com
In-Reply-To: <f18c9dde0908260123l4a8327d3n4d10c2d260492976@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-982636304-1251278311=:74396"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-982636304-1251278311=:74396
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Dear Simon. Firstly thank you very much for your answer. I've been trying t=
o debug this problem for a while and I am a bit at a loss.

I am using lucene as search engine as included in a document management sys=
tem called KnowledgeTree (http://wiki.knowledgetree.com/Troubleshooting_the=
_Document_Indexer)

The authors of KnowledgeTree write that:=20

"KnowledgeTree uses a Java-based document indexing service that stores meta=
data in a Lucene based search library.=0AWhen the document indexer is not r=
unning, metadata of documents=0Acannot be placed in the search library, the=
reby excluding it from=0Asearch results".
So it seems to me that the error could come from this "indexer" from KT or =
from java/lucene. The only application I have running on Java at the moment=
 is named KtLucene, which I call=A0 on the console with: ">java -jar ktluce=
ne.jar&"

I guess that the error comes therefore from KtLucene. And I supose that KTl=
ucene calls Lucene at a certain moment. Am I wrong? What I still don't know=
 is if the error comes from lucene itself or from the application - KTlucen=
e.=20

>From your answer it seems that you believe that lucene is not the source of=
 the problem. I have to believe that it must come from KTlucene - the appli=
cation -. If this is the case, I will address the issue to the mailing list=
s of KnoledgeTree.
Thanks again for your help.


--- El mi=E9, 26/8/09, Simon Willnauer <simon.willnauer@googlemail.com> esc=
ribi=F3:

De: Simon Willnauer <simon.willnauer@googlemail.com>
Asunto: Re: "Read timed out" behind firewall - Ports closed? Loopback?
Para: java-user@lucene.apache.org
Fecha: mi=E9rcoles, 26 agosto, 2009 10:23

David,

I can not follow you. What kind of Lucene applicaiton are you talking
about. Afaik lucene does not use xmlRPC anywhere and we do not have
any dependency on it (Do I miss something?). There is a RemoteSearcher
/ RemoteSearchable in core (until 2.4.1) and now in contrib/remote
which uses RMI and the default port is 1099. But your stacktrace seems
to be something else.

If this has anything to do with lucene-core / contrib you will get
help if you can elaborate your problem further. If this is related to
some other app/project using lucene you might be better asking the
projects mailing-list.

simon

On Wed, Aug 26, 2009 at 10:02 AM, David de la Torre<torremartin@yahoo.es> w=
rote:
> When running lucene, on a machine with a firewall, I got the following
> error message, which I think it must be related to the firewall. In
> fact, when I shut down the firewall, the error dissapears. It must be
> something relating to the ports I have open. Lucene says it is running
> in port 8875. Is this the only port to open? is it a UDP or TCP port ?
> Could it also be related to the loopback?
>
> 100870 [XML-RPC-0] ERROR org.apache.xmlrpc.webserver.WebServer =A0- Read =
timed out
> java.net.SocketTimeoutException: Read timed out
> =A0 =A0 =A0 =A0at java.net.SocketInputStream.socketRead0(Native Method)
> =A0 =A0 =A0 =A0at java.net.SocketInputStream.read(SocketInputStream.java:=
146)
> =A0 =A0 =A0 =A0at java.io.BufferedInputStream.fill(BufferedInputStream.ja=
va:235)
> =A0 =A0 =A0 =A0at java.io.BufferedInputStream.read(BufferedInputStream.ja=
va:254)
> =A0 =A0 =A0 =A0at
> =A0org.apache.xmlrpc.webserver.Connection.readLine(Connection.java:195)
> =A0 =A0 =A0 =A0at org.apache.xmlrpc.webserver.Connection.getRequestConfig=
(Connection.java:126)
> =A0 =A0 =A0 =A0at org.apache.xmlrpc.webserver.Connection.run(Connection.j=
ava:171)
> =A0 =A0 =A0 =A0at org.apache.xmlrpc.util.ThreadPool$MyThread.runTask(Thre=
adPool.java:71)
> =A0 =A0 =A0 =A0at org.apache.xmlrpc.util.ThreadPool$MyThread.run(ThreadPo=
ol.java:87)
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      
--0-982636304-1251278311=:74396--

From java-user-return-42022-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 09:28:43 2009
Return-Path: <java-user-return-42022-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1399 invoked from network); 26 Aug 2009 09:28:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 09:28:43 -0000
Received: (qmail 70437 invoked by uid 500); 26 Aug 2009 09:28:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70359 invoked by uid 500); 26 Aug 2009 09:28:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70349 invoked by uid 99); 26 Aug 2009 09:28:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 09:28:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 09:28:30 +0000
Received: by bwz10 with SMTP id 10so2550561bwz.5
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 02:28:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:cc:content-type
         :content-transfer-encoding;
        bh=iDbJWY5PqRBlj0feiKhb9cODvIniaZF0prz187B7tm4=;
        b=id1JLHIhhC75eRuE9RKV/Dp8hrp8W8UqV7uqwyM1BeFGi4rBQyLNJRKg9TIrFwoDKt
         fRywnNemLG9XgxkgacF8a9RnWcjxldFvROEvHBQrN/YAtDDEHL8WjLNvUahgNsN3yLTG
         g5QRxUbwzSHYyUN4mvcQysm8/435VK7SZOEUw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:cc:content-type:content-transfer-encoding;
        b=pTg1p3j3fu0R1fqiwnFAtLWzMdWV+g2dsRcEpjXkGcs1zwSqBwE8O05++kXonmHqvH
         XXTm5LVN/ggiF3fTabo9C+q/zmEEP9t8hqnuFDxydamaUyUB5iuacGHRB1HFeV/wwprx
         kA1kihvEotnJvGyWzcEsJeZvUe+v5AI06gHl4=
MIME-Version: 1.0
Received: by 10.239.170.36 with SMTP id q36mr643447hbe.153.1251278888709; Wed, 
	26 Aug 2009 02:28:08 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <328812.74396.qm@web23601.mail.ird.yahoo.com>
References: <f18c9dde0908260123l4a8327d3n4d10c2d260492976@mail.gmail.com>
	 <328812.74396.qm@web23601.mail.ird.yahoo.com>
Date: Wed, 26 Aug 2009 11:28:08 +0200
Message-ID: <f18c9dde0908260228n43d47017hb892c9bee4dd1eb6@mail.gmail.com>
Subject: Re: "Read timed out" behind firewall - Ports closed? Loopback?
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: David de la Torre <torremartin@yahoo.es>
Cc: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

David,
Lucene is a framework that offers fulltext-indexing and search
capabilities with a very limited support for client/server
communication. The only remote communication mechanism included in
Lucene (I know about - but I'm very confident I did not miss anything
related to that) is the RemoteSearcher which is based Java RMI. Drawn
from the stacktrace you provided the error is somewhere in a xmlRPC
communication. Lucene does not have any dependencies on those classes
so I'm very confident that this error is not caused by Lucene
directly. I hardly recommend you re-ask your question on the
KnowledgeTree mailinglist.

Hope you get help there!

Simon

On Wed, Aug 26, 2009 at 11:18 AM, David de la Torre<torremartin@yahoo.es> w=
rote:
> Dear Simon. Firstly thank you very much for your answer. I've been trying=
 to
> debug this problem for a while and I am a bit at a loss.
>
> I am using lucene as search engine as included in a document management
> system called KnowledgeTree
> (http://wiki.knowledgetree.com/Troubleshooting_the_Document_Indexer)
>
> The authors of KnowledgeTree write that:
>
> "KnowledgeTree uses a Java-based document indexing service that stores
> metadata in a Lucene based search library.
>
> When the document indexer is not running, metadata of documents cannot be
> placed in the search library, thereby excluding it from search results".
>
> So it seems to me that the error could come from this "indexer" from KT o=
r
> from java/lucene. The only application I have running on Java at the mome=
nt
> is named KtLucene, which I call=C2=A0 on the console with: ">java -jar
> ktlucene.jar&"
>
> I guess that the error comes therefore from KtLucene. And I supose that
> KTlucene calls Lucene at a certain moment. Am I wrong? What I still don't
> know is if the error comes from lucene itself or from the application -
> KTlucene.
>
> From your answer it seems that you believe that lucene is not the source =
of
> the problem. I have to believe that it must come from KTlucene - the
> application -. If this is the case, I will address the issue to the maili=
ng
> lists of KnoledgeTree.
>
> Thanks again for your help.
>
>
> --- El mi=C3=A9, 26/8/09, Simon Willnauer <simon.willnauer@googlemail.com=
>
> escribi=C3=B3:
>
> De: Simon Willnauer <simon.willnauer@googlemail.com>
> Asunto: Re: "Read timed out" behind firewall - Ports closed? Loopback?
> Para: java-user@lucene.apache.org
> Fecha: mi=C3=A9rcoles, 26 agosto, 2009 10:23
>
> David,
>
> I can not follow you. What kind of Lucene applicaiton are you talking
> about. Afaik lucene does not use xmlRPC anywhere and we do not have
> any dependency on it (Do I miss something?). There is a RemoteSearcher
> / RemoteSearchable in core (until 2.4.1) and now in contrib/remote
> which uses RMI and the default port is 1099. But your stacktrace seems
> to be something else.
>
> If this has anything to do with lucene-core / contrib you will get
> help if you can elaborate your problem further. If this is related to
> some other app/project using lucene you might be better asking the
> projects mailing-list.
>
> simon
>
> On Wed, Aug 26, 2009 at 10:02 AM, David de la Torre<torremartin@yahoo.es>
> wrote:
>> When running lucene, on a machine with a firewall, I got the following
>> error message, which I think it must be related to the firewall. In
>> fact, when I shut down the firewall, the error dissapears. It must be
>> something relating to the ports I have open. Lucene says it is running
>> in port 8875. Is this the only port to open? is it a UDP or TCP port ?
>> Could it also be related to the loopback?
>>
>> 100870 [XML-RPC-0] ERROR org.apache.xmlrpc.webserver.WebServer =C2=A0- R=
ead
>> timed out
>> java.net.SocketTimeoutException: Read timed out
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.net.SocketInputStream.socketRead0(Nat=
ive Method)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.net.SocketInputStream.read(SocketInpu=
tStream.java:146)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.BufferedInputStream.fill(BufferedI=
nputStream.java:235)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.BufferedInputStream.read(BufferedI=
nputStream.java:254)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> =C2=A0org.apache.xmlrpc.webserver.Connection.readLine(Connection.java:19=
5)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.xmlrpc.webserver.Connection.getRequestConfig(Connection.java:=
126)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at org.apache.xmlrpc.webserver.Connection.run=
(Connection.java:171)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.xmlrpc.util.ThreadPool$MyThread.runTask(ThreadPool.java:71)
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
>> org.apache.xmlrpc.util.ThreadPool$MyThread.run(ThreadPool.java:87)
>>
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42023-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 09:58:29 2009
Return-Path: <java-user-return-42023-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19327 invoked from network); 26 Aug 2009 09:58:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 09:58:29 -0000
Received: (qmail 27916 invoked by uid 500); 26 Aug 2009 09:58:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27831 invoked by uid 500); 26 Aug 2009 09:58:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27819 invoked by uid 99); 26 Aug 2009 09:58:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 09:58:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [84.38.66.115] (HELO vserver1901.localdomain) (84.38.66.115)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 09:58:16 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by vserver1901.localdomain (Postfix) with ESMTP id 6AF411BF3B9
	for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 11:58:23 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at vserver1901.vserver-on.de
Received: from vserver1901.localdomain ([127.0.0.1])
	by localhost (vserver1901.vserver-on.de [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id fiFl9eWEB-qd for <java-user@lucene.apache.org>;
	Wed, 26 Aug 2009 11:58:21 +0200 (CEST)
Received: from [192.168.120.199] (unknown [85.183.31.24])
	by vserver1901.localdomain (Postfix) with ESMTPSA id CFDC31BF364
	for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 11:58:21 +0200 (CEST)
Message-ID: <4A950722.9030502@linux4tw.de>
Date: Wed, 26 Aug 2009 11:57:54 +0200
From: Sven Fischer <info@linux4tw.de>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: how to down-weight synonyms
Content-Type: text/plain; charset=ISO-8859-15; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,
I implemented a synonym search by using the chapter 4.6's example from 
the Lucene in Action book.
Now I want to extend the example in that way, that synonyms are boosted 
less that the original word the user searched for. Is there a way to do 
it? If it is, I would like to get any help on how to implement that feature.

can anyone help please?


Thanks
Sven

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42024-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 10:10:56 2009
Return-Path: <java-user-return-42024-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26828 invoked from network); 26 Aug 2009 10:10:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 10:10:55 -0000
Received: (qmail 42806 invoked by uid 500); 26 Aug 2009 10:10:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42717 invoked by uid 500); 26 Aug 2009 10:10:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42706 invoked by uid 99); 26 Aug 2009 10:10:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 10:10:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 10:10:42 +0000
Received: by bwz10 with SMTP id 10so7005bwz.5
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 03:10:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=4qGlXjS6EdAYV8i9GdMGlXBTFmRyxpyiTZCnVLmHGPU=;
        b=poHLdjWVMziQ3CHnmH9rHN5zrF49HV2fR1x/OSD2r1pN3C6ZBnHutne1N9r5r9r8yw
         0XgwwQ0jUC1cRwDRL4BRLb5fJi+cjg0jin/CgMNsYYN76BaTum7CeQDIlFaw/FbC5B5T
         ERbK4PmaJd7J3L+7PaInV2tS1SF3aocs66FKI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=ADcSAghf7txJ1AQrKEM978LAIh3M6H5FucHFf8+mRwhKYv37t/SMv2M6W38PMk0B7+
         MPi96j2m/PtrTwA6iGiAs3uf5pUc4cgGdYuSYhi/HWNkxxtOndH9BDutEecTjySvrNfV
         r332jIqi1ecVBsOAGR0wsC/x+uhuUApKKOtdI=
MIME-Version: 1.0
Received: by 10.239.170.36 with SMTP id q36mr646876hbe.153.1251281421863; Wed, 
	26 Aug 2009 03:10:21 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <4A950722.9030502@linux4tw.de>
References: <4A950722.9030502@linux4tw.de>
Date: Wed, 26 Aug 2009 12:10:21 +0200
Message-ID: <f18c9dde0908260310k7a5ca64cqad3a5234bead4d@mail.gmail.com>
Subject: Re: how to down-weight synonyms
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Sven,
While I have no idea bout the example in LiA  I can give you some
quick pointers.
if you add the synonyms at query time you can assign a boost factor to
the added synonyms that would boost the matches to a particular term
down. -> something in the interval [0,1]
if you add the synonyms at index time you could add a payload to the
added synonyms and use some payload aware query for searches. See
http://lucene.apache.org/java/2_4_0/api/core/org/apache/lucene/search/payloads/package-summary.html

You could also index the content into two different fields on with and
one without synonyms and set boost factors on the field. This case
would be a little more complex and rather "dirty" but maybe its an
option for you.

simon


On Wed, Aug 26, 2009 at 11:57 AM, Sven Fischer<info@linux4tw.de> wrote:
> Hi,
> I implemented a synonym search by using the chapter 4.6's example from the
> Lucene in Action book.
> Now I want to extend the example in that way, that synonyms are boosted less
> that the original word the user searched for. Is there a way to do it? If it
> is, I would like to get any help on how to implement that feature.
>
> can anyone help please?
>
>
> Thanks
> Sven
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42025-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 10:55:21 2009
Return-Path: <java-user-return-42025-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45204 invoked from network); 26 Aug 2009 10:55:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 10:55:21 -0000
Received: (qmail 90298 invoked by uid 500); 26 Aug 2009 10:55:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90219 invoked by uid 500); 26 Aug 2009 10:55:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90209 invoked by uid 99); 26 Aug 2009 10:55:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 10:55:19 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of abhayait@gmail.com designates 209.85.217.216 as permitted sender)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 10:55:11 +0000
Received: by gxk12 with SMTP id 12so37832gxk.4
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 03:54:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=pT3nTc0phhPGyB4yTkD5hgtPhLjimy/IrJph638FdWg=;
        b=mmc8Q/YZPYj5SnD7bWegoMfjkT+brDNOGyOfcleIFZLnWYtDW5Z4XXUWLokxzDzEBe
         UJGAbM9jLqKihLbMs4HzSfi6qM7I6bC1amoqNABnwQf3RQuutaT4gymClrB3xKgru2Qr
         OOu8JwAlavXAgMT0Q31Qdj3Tnh7b1VvkCD1Gs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=RvWIq/2lveVNx7e9wKIDzCl1pSKglWl5p8WvAXKrhXu3M+/GghjP3LW+TBudImNN7t
         qOB98S6Xf6y/zWn5RXa2p/9a8b2/hnuzRqLY9f836WocqU+SbYgdJIfC5pGPWw0jipER
         2I8u3R6hir3KvsWZnne6/OnsL0DxYM9HlGQBk=
MIME-Version: 1.0
Received: by 10.150.16.2 with SMTP id 2mr11406015ybp.251.1251284090098; Wed, 
	26 Aug 2009 03:54:50 -0700 (PDT)
In-Reply-To: <f18c9dde0908260310k7a5ca64cqad3a5234bead4d@mail.gmail.com>
References: <4A950722.9030502@linux4tw.de>
	 <f18c9dde0908260310k7a5ca64cqad3a5234bead4d@mail.gmail.com>
Date: Wed, 26 Aug 2009 16:24:50 +0530
Message-ID: <85e153be0908260354r53788a28se2a52219474545e0@mail.gmail.com>
Subject: Re: how to down-weight synonyms
From: abhay kumar <abhayait@gmail.com>
To: java-user@lucene.apache.org, simon.willnauer@gmail.com
Content-Type: multipart/alternative; boundary=000e0cd75518b417b00472094797
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd75518b417b00472094797
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,
 The first answer by Sven is more efficient and generaly used.

Abhay
@Sven
f you add the synonyms at query time you can assign a boost factor to
the added synonyms that would boost the matches to a particular term
down. -> something in the interval [0,1]

On Wed, Aug 26, 2009 at 3:40 PM, Simon Willnauer <
simon.willnauer@googlemail.com> wrote:

> Hi Sven,
> While I have no idea bout the example in LiA  I can give you some
> quick pointers.
> if you add the synonyms at query time you can assign a boost factor to
> the added synonyms that would boost the matches to a particular term
> down. -> something in the interval [0,1]
> if you add the synonyms at index time you could add a payload to the
> added synonyms and use some payload aware query for searches. See
>
> http://lucene.apache.org/java/2_4_0/api/core/org/apache/lucene/search/payloads/package-summary.html
>
> You could also index the content into two different fields on with and
> one without synonyms and set boost factors on the field. This case
> would be a little more complex and rather "dirty" but maybe its an
> option for you.
>
> simon
>
>
> On Wed, Aug 26, 2009 at 11:57 AM, Sven Fischer<info@linux4tw.de> wrote:
> > Hi,
> > I implemented a synonym search by using the chapter 4.6's example from
> the
> > Lucene in Action book.
> > Now I want to extend the example in that way, that synonyms are boosted
> less
> > that the original word the user searched for. Is there a way to do it? If
> it
> > is, I would like to get any help on how to implement that feature.
> >
> > can anyone help please?
> >
> >
> > Thanks
> > Sven
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd75518b417b00472094797--

From java-user-return-42026-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 13:19:21 2009
Return-Path: <java-user-return-42026-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90227 invoked from network); 26 Aug 2009 13:19:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 13:19:21 -0000
Received: (qmail 80819 invoked by uid 500); 26 Aug 2009 13:19:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80752 invoked by uid 500); 26 Aug 2009 13:19:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80742 invoked by uid 99); 26 Aug 2009 13:19:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 13:19:19 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 13:19:07 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n7QDIicG001793
	for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 14:18:45 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Wed, 26 Aug 2009 14:18:44 +0100 (BST)
Date: Wed, 26 Aug 2009 14:18:44 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <2132468419.17721251292724059.JavaMail.root@mail.uk.scalix.com>
Subject: Lucene gobbling file descriptors
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_Part_1188_1657855971.1251292724057"
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,HTML_MESSAGE,
	MISSING_MIMEOLE autolearn=ham version=3.2.5

------=_Part_1188_1657855971.1251292724057
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline

Hi there,

I wonder if someone can help?  We have a successful Lucene app deployed on Tomcat which works well.  As far as we can tell, our developers have observed all the guidelines in the Lucene FAQ, but on some of our installations, Tomcat eventually runs out of file descriptors and needs a restart to clear it.  We know Lucene is the culprit because use lsof -p <java PID> and the vast majority (usually tens of thousands) of files reported are Lucene index files.

I am hoping to get some tips on how this can be avoided.  Is it simply the case that as time goes by, more and more descriptors are left open and no matter how high ulimit is set, you will run out?  Or is there a policy of recycling that we are failing to utilise properly?

I am happy to provide more information, just don't know what at this point!  Please ask....

Thanks in advance 

- Chris

Chris Bamford
Senior Development Engineer
Scalix
chris.bamford@scalix.com
Tel: +44 (0)1344 381814
www.scalix.com


------=_Part_1188_1657855971.1251292724057--

From java-user-return-42027-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 13:22:55 2009
Return-Path: <java-user-return-42027-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92059 invoked from network); 26 Aug 2009 13:22:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 13:22:55 -0000
Received: (qmail 97312 invoked by uid 500); 26 Aug 2009 13:22:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97256 invoked by uid 500); 26 Aug 2009 13:22:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97243 invoked by uid 99); 26 Aug 2009 13:22:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 13:22:53 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 13:22:41 +0000
Received: by ewy22 with SMTP id 22so152045ewy.28
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 06:22:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ydpKDtFqfxeCrfjooiJbB54T2t2R1CvjHkokTEEcw4s=;
        b=Wbhm0cJb2jhoAy59RVG05SOdy93NuPRAU/a445iVu7ZM3vEDe+gFJsG9eLgyXMaOp/
         G9EkJcEvZT6B/HMF4OR2kRhY6YA+xNQfmfrMZSQu+gnT53bdYTbGGzwzkD+tdRhdaAhh
         2zwF6n0LN1R1cLVf1upO/5WRgjxIog9X1wUzg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=fB20ZZMQKCZdZ91Q8ZpSC86gEpv4xw46s0zf/h86vFGFLA9ya3Z6rzksfWT5r+N5bL
         dFSZLmzk9ePK39SEaqJj6umdzl5jrzJo/o7v2r32OmnTawKhekXeNEkYGrYz5FJ/cKwT
         kL9oc2ODqtB2hrY+9q9ghJYUpqRZG5bafDRw4=
MIME-Version: 1.0
Received: by 10.216.93.141 with SMTP id l13mr1588897wef.67.1251292941431; Wed, 
	26 Aug 2009 06:22:21 -0700 (PDT)
In-Reply-To: <2132468419.17721251292724059.JavaMail.root@mail.uk.scalix.com>
References: <2132468419.17721251292724059.JavaMail.root@mail.uk.scalix.com>
Date: Wed, 26 Aug 2009 16:22:21 +0300
Message-ID: <786fde50908260622s70e7a98bj90b40fa16fce6b87@mail.gmail.com>
Subject: Re: Lucene gobbling file descriptors
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d99a9348b32d04720b57e5
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d99a9348b32d04720b57e5
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

That's strange ... how do you execute your searches - each search opens up
an IndexReader? Do you make sure to close them? Maybe those are file
descriptors of files you index?

Forgive the silly questions, but I've never seen Lucene run into
out-of-files handles ...

Shai

On Wed, Aug 26, 2009 at 4:18 PM, Chris Bamford <Chris.Bamford@scalix.com>wrote:

> Hi there,
>
> I wonder if someone can help?  We have a successful Lucene app deployed on
> Tomcat which works well.  As far as we can tell, our developers have
> observed all the guidelines in the Lucene FAQ, but on some of our
> installations, Tomcat eventually runs out of file descriptors and needs a
> restart to clear it.  We know Lucene is the culprit because use lsof -p
> <java PID> and the vast majority (usually tens of thousands) of files
> reported are Lucene index files.
>
> I am hoping to get some tips on how this can be avoided.  Is it simply the
> case that as time goes by, more and more descriptors are left open and no
> matter how high ulimit is set, you will run out?  Or is there a policy of
> recycling that we are failing to utilise properly?
>
> I am happy to provide more information, just don't know what at this point!
>  Please ask....
>
> Thanks in advance
>
> - Chris
>
> Chris Bamford
> Senior Development Engineer
> Scalix
> chris.bamford@scalix.com
> Tel: +44 (0)1344 381814
> www.scalix.com
>
>

--0016e6d99a9348b32d04720b57e5--

From java-user-return-42028-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 13:27:25 2009
Return-Path: <java-user-return-42028-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94744 invoked from network); 26 Aug 2009 13:27:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 13:27:25 -0000
Received: (qmail 8579 invoked by uid 500); 26 Aug 2009 13:27:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8536 invoked by uid 500); 26 Aug 2009 13:27:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8526 invoked by uid 99); 26 Aug 2009 13:27:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 13:27:23 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.212.177] (HELO mail-vw0-f177.google.com) (209.85.212.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 13:27:11 +0000
Received: by vws7 with SMTP id 7so87156vws.29
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 06:26:50 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.213.20 with SMTP id l20mr13026057ybg.92.1251293210346; 
	Wed, 26 Aug 2009 06:26:50 -0700 (PDT)
In-Reply-To: <2132468419.17721251292724059.JavaMail.root@mail.uk.scalix.com>
References: <2132468419.17721251292724059.JavaMail.root@mail.uk.scalix.com>
Date: Wed, 26 Aug 2009 09:26:50 -0400
Message-ID: <9ac0c6aa0908260626m5e2d8a32kbb40ae010f922e7c@mail.gmail.com>
Subject: Re: Lucene gobbling file descriptors
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

This is not normal.  As long as you are certain you close every
IndexReader/Searcher that you opened, the number of file descriptors
should stay "contained".

Though: how many files are there in your index directory?

Mike

On Wed, Aug 26, 2009 at 9:18 AM, Chris Bamford<Chris.Bamford@scalix.com> wr=
ote:
> Hi there,
>
> I wonder if someone can help? =A0We have a successful Lucene app deployed=
 on Tomcat which works well. =A0As far as we can tell, our developers have =
observed all the guidelines in the Lucene FAQ, but on some of our installat=
ions, Tomcat eventually runs out of file descriptors and needs a restart to=
 clear it. =A0We know Lucene is the culprit because use lsof -p <java PID> =
and the vast majority (usually tens of thousands) of files reported are Luc=
ene index files.
>
> I am hoping to get some tips on how this can be avoided. =A0Is it simply =
the case that as time goes by, more and more descriptors are left open and =
no matter how high ulimit is set, you will run out? =A0Or is there a policy=
 of recycling that we are failing to utilise properly?
>
> I am happy to provide more information, just don't know what at this poin=
t! =A0Please ask....
>
> Thanks in advance
>
> - Chris
>
> Chris Bamford
> Senior Development Engineer
> Scalix
> chris.bamford@scalix.com
> Tel: +44 (0)1344 381814
> www.scalix.com
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42029-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 13:47:29 2009
Return-Path: <java-user-return-42029-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5770 invoked from network); 26 Aug 2009 13:47:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 13:47:28 -0000
Received: (qmail 50245 invoked by uid 500); 26 Aug 2009 13:47:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50158 invoked by uid 500); 26 Aug 2009 13:47:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50148 invoked by uid 99); 26 Aug 2009 13:47:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 13:47:26 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of eransevi@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 13:47:15 +0000
Received: by ewy22 with SMTP id 22so177897ewy.28
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 06:46:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=FAP0uXvChKrA2Mylzw0Qq6AZJQyh+I38czG5jNv2MNI=;
        b=SloddiiSkXEUNh5X7HOZTd1STm9gCPtMz4oCAH0OrncxHWxPqKgpXe9s27DAPXDTzT
         sxkhGuhZg2iVsk0bYIfV6gIYR8vEfezCB1r9DtbXCKPn1D8ii5XbORt1i3sbVO2w7RcN
         zOF7VLmDpsnwEP7YjRDYOgqbT23aUMZnEBDYI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=VLyBT4OMHQD+jJtlZWTF0sFCm6Q4xuW2FTSreXZP1iUqa2yvS2/pYo9lBVXZ4AwYPg
         YytEX2jo5azofiPAJZF2VTfj8g2KhbmCwwzuwN8+72SQCsuO5B8NS66Li5+A3Uh4kzrC
         unFLvauHcf1wJdhdpjjJjEVi2vSqm+4oM4o6E=
MIME-Version: 1.0
Received: by 10.210.41.1 with SMTP id o1mr3107846ebo.46.1251294413777; Wed, 26 
	Aug 2009 06:46:53 -0700 (PDT)
In-Reply-To: <4A80C935.4040605@gmail.com>
References: <74f928500908020830h5d3f4d0aw1f1ed2016c67200@mail.gmail.com>
	 <70FA860F-B368-462B-A510-FBA44FB1806D@apache.org>
	 <74f928500908090210x1da86971ibad538f6fba97227@mail.gmail.com>
	 <4A80C935.4040605@gmail.com>
Date: Wed, 26 Aug 2009 16:46:53 +0300
Message-ID: <74f928500908260646y6607cb97x4d7e74b51dd715aa@mail.gmail.com>
Subject: Re: score from spans
From: Eran Sevi <eransevi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c11ce0af4be04720baff8
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c11ce0af4be04720baff8
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I've done some work and would like to post it to the list in order to get
some opinions and try to reach something that is satisfactory for everyone.

One problem is that i'm actually using Lucene.Net and have written the code
in c#.
Anothe problem is that I'm using version 2.3.2 which might be a bit
different than current 2.9 version.

How do you suggest we should proceed?

Here's a description of what i've done:

I've managed to create some sort of solution to this problem -

The result is that we can get an equal score for a SpanOrQuery as a regular
BooleanQuery with only SHOULD clauses.
We can also get an equal score for a SpanNearQuery as a regular BooleanQuery
with only MUST clauses.

The good is that the score is calculated recursively and the boosts of the
inner queries are taken into account.
The bad in my solution is that the span distance is not taken into account
and that the spans are fetched for each sub query which can really affect
performance.

My solution is as follows:

1. Create a derived class for each "complex" span*Query that inherit from
SpanWeight (e.g. SpanNearWeight).
2. The new weight class is initialized with the SpanNearQuery and creates a
weight for each of the query's clauses - this gives us the recursive pass.
3. override the "SumOfSquaredWeights","Normalize" methods as the
BooleanWeight implementation.
4.  override the "Scorer" method as follows: create a BooleanScorer and add
the scorers from the weights of the sub queries. for SpanOrQuery add them as
not required and not prohibited. for SpanNearQuery add them as required and
not prohibited.
5. Override the "CreateWeight" method in the Span*Query to return the new
Weight class instead of the old SpanWeight class (the SpanWeight class will
still be returned for SpanTermQuery which doesn't contain any sub queries
and shouldn't be overriden).
6. SpanWeight - multiply queryNorm in query.GetBoost() in Normalize method.
7. optional - change the "SetFreqCurrentDoc" method in SpanScorer to sum the
freq in each doc instead of running SloppyFreq.


I hope you can understand the main idea from my complicated description.
The problem with the current spans implementation is that by the time you
have the spans you don't know how they were created - the span of a
complicated query or a simple query looks the same and treated the same.

With this method you can at least get a score for span queries which is not
the most accurate but at least take into account sub queries and boosts.
Thanks,
Eran.


On Tue, Aug 11, 2009 at 4:28 AM, Mark Miller <markrmiller@gmail.com> wrote:

> Hey Eran,
>
> I've started work on this in the past - you are right, it gets complicated
> quick! Its also likely to bring with it a sizable performance cost.
>
> We already have an issue in JIRA for this that is quite old:
> https://issues.apache.org/jira/browse/LUCENE-533
>
> If you get any work going, don't be shy to start posting code there, and
> perhaps you can get some additional eyes/help as you go.
>
> I think in the end, it might have to be an optional mode, if we get the
> code produced.
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
>
> Eran Sevi wrote:
>
>> Thanks for the answer.
>>
>> I tried to further understand the weight and score mechanism when running
>> a
>> span query search.
>> I noticed that indeed the SpanScorer and SpanWeight are being called and
>> some score is returned but it seems to me that these basic implementations
>> are more appropriate for the basic SpanTermQuery.
>> For the other types of span queries, the inner queries scores and weights
>> are not taken into account - for example if I run a simple SpanOrQuery and
>> boost one of it's child SpanTermQuery, the boost is not taken into
>> account.
>>
>> It seems to me that some recursive calculation is required in order to
>> take
>> into account all the weights and scores of the span's sub queries.
>> I'm trying to come up with a correct implementation for SpanOrQuery,
>> SpanNearQuery, SpanNotQuery based on similiar calculations of
>> BooleanQuery.
>>
>> Do you have a better idea on how to achieve the correct scoring? the score
>> calculations are quite complex for each case of span queries so any help
>> is
>> appreciated.
>>
>> Thanks, Eran.
>>
>> On Tue, Aug 4, 2009 at 8:51 PM, Grant Ingersoll <gsingers@apache.org>
>> wrote:
>>
>>
>>
>>> A SpanQuery is a Query, so if you do a search for it, you will get
>>> scores.
>>>  However, the mechanism is a bit complicated, b/c actually getting the
>>> Spans
>>> is separate from doing the query.  I agree there could be tighter
>>> integration.  However, what you could do is use Spans.skipTo to move to
>>> the
>>> document you are examining in the search results.
>>>
>>> -Grant
>>>
>>>
>>> On Aug 2, 2009, at 11:30 AM, Eran Sevi wrote:
>>>
>>> Hi,
>>>
>>>
>>>> How can I get the score of a span that is the result of
>>>> SpanQuery.getSpans()
>>>> ? The score should can be the same for each document, but if it's unique
>>>> per
>>>> span, it's even better.
>>>>
>>>> I tried looking for a way to expose this functionality through the Spans
>>>> class but it looks too complicated.
>>>> I'm not even sure that by default some score calculation is even
>>>> performed
>>>> when using span queries.
>>>>
>>>> I've noticed that some calculations are made using payloads and
>>>> BoostingTermQuery but the score result is used internally and can't be
>>>> accessed from the Spans results.
>>>> I don't want to re-run the query again using a HitCollector and since
>>>> the
>>>> reader is passed to getSpans, I think it should be possible to do what I
>>>> want.
>>>>
>>>> Any help on the correct way to expose the span score will be
>>>> appreciated.
>>>>
>>>> Thanks,
>>>> Eran.
>>>>
>>>>
>>>>
>>> --------------------------
>>> Grant Ingersoll
>>> http://www.lucidimagination.com/
>>>
>>> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) using
>>> Solr/Lucene:
>>> http://www.lucidimagination.com/search
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>>
>>
>>
>>
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174c11ce0af4be04720baff8--

From java-user-return-42030-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 14:14:39 2009
Return-Path: <java-user-return-42030-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19069 invoked from network); 26 Aug 2009 14:14:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 14:14:39 -0000
Received: (qmail 9130 invoked by uid 500); 26 Aug 2009 14:14:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9041 invoked by uid 500); 26 Aug 2009 14:14:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9031 invoked by uid 99); 26 Aug 2009 14:14:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 14:14:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.222.175 as permitted sender)
Received: from [209.85.222.175] (HELO mail-pz0-f175.google.com) (209.85.222.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 14:14:27 +0000
Received: by pzk5 with SMTP id 5so152243pzk.21
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 07:14:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=E+aGjKq7JZPfPKa+ZYsfEkgpwCXk4gGCwIteMJqoejU=;
        b=VF9DdB7ntBdugrovhNIRmXHApX0RpzIUNeQe3chjUH3qtcYJoa8URLHP5CVk8OdFQw
         F4efcIfCHcMlPq8xjL/nDcImufi/hO1li4+dC684rrCbnzwdQqRfb9phC1HuP/IjoNQ4
         rxwMjZgkp8mLMObMFsXG4mIlBsLWMt3HWKCUs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=YFozA13q9OqBSdZtCJc4x1xMKdZb94qgJW4R23w6b5+BL9DRYGgriG+agRvOWAt1R8
         KRDrT4UaFl5HzxykIa3jCAGlDBKC/jls4LNxfcnAp2Yw+Vbr88zWA1tIsXz3OPLL3i/T
         8/t/jJuB+en9tERhwfHILl4GDGaTm+tcKKdqo=
Received: by 10.114.253.23 with SMTP id a23mr10870853wai.155.1251296046025;
        Wed, 26 Aug 2009 07:14:06 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 20sm1820487pzk.9.2009.08.26.07.14.04
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 26 Aug 2009 07:14:05 -0700 (PDT)
Message-ID: <4A95432D.60906@gmail.com>
Date: Wed, 26 Aug 2009 10:14:05 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene release 2.9
References: <4A9412E4.9080904@gmail.com>
In-Reply-To: <4A9412E4.9080904@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Looks like we are going to pull back a day and start the freeze sometime
tomorrow (Thursday, August 27 2009). There is still a lot of
documentation to catch up - wouldn't make sense to have anyone look over
what we know is still wrong.

Thanks,

-- 
- Mark

http://www.lucidimagination.com



Mark Miller wrote:
> Hello all Lucene users,
>
> I just wanted to let you in on the current release schedule for Lucene
> 2.9 (still subject to change):
>
> Currently, we plan to go into official feature freeze tomorrow
> (Wednesday, August 26 2009). That means we will try and keep the 2.9
> code as stable as possible, only committing documentation patches, bug
> fixes, and build patches.
>
> That is tentatively scheduled to last one week. During this time
> (starting tomorrow), I'm going to host Lucene 2.9 RC distributions on my
> people.apache personal site to make it easy for users to download and
> help us test and find documentation/packaging issues. Any assistance you
> can give us in this regard will help ensure a quality Lucene 2.9
> release. If, and as, issues are found, I will put up new RCs and
> announce on the list their availability. I don't recommend that you use
> these RC's in production - they are not going to be the official
> release. However, if you are already using trunk, you should be
> qualified to make your own decisions in that regard.
>
> If we feel comfortable that 2.9 is ready after the week freeze - Lucene
> 2.9 will be promptly released.
>
> You can find the changes for Lucene 2.9 here:
> https://svn.apache.org/repos/asf/lucene/java/trunk/CHANGES.txt
>
> Thanks,
>
>   




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42031-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 16:48:19 2009
Return-Path: <java-user-return-42031-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9353 invoked from network); 26 Aug 2009 16:48:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 16:48:18 -0000
Received: (qmail 9772 invoked by uid 500); 26 Aug 2009 16:48:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9689 invoked by uid 500); 26 Aug 2009 16:48:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9679 invoked by uid 99); 26 Aug 2009 16:48:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 16:48:16 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [132.204.246.20] (HELO chene.dit.umontreal.ca) (132.204.246.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 16:48:06 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by chene.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n7QGleqm032044
	for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 12:47:40 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Wed, 26 Aug 2009 12:47:40 -0400
  id 0002732D.4A95672C.00007939
Message-ID: <4A95672B.7020306@lexum.umontreal.ca>
Date: Wed, 26 Aug 2009 12:47:39 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org, yonik@lucidimagination.com
Subject: Re: Is there a way to check for field "uniqueness" when indexing?
References: <4A842449.3050505@lexum.umontreal.ca>	 <84088EC8-93A1-4888-8287-B9898A32ED17@apache.org>	 <4A8C4CB6.8040009@lexum.umontreal.ca>	 <Pine.LNX.4.64.0908202141490.21261@radix.cryptio.net> <c68e39170908202152i23f711dew117f9fd138781120@mail.gmail.com>
In-Reply-To: <c68e39170908202152i23f711dew117f9fd138781120@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-NAI-Spam-Score: 0
X-NAI-Spam-Rules: 1 Rules triggered
	RV3348=0
X-Virus-Checked: Checked by ClamAV on apache.org

Humm... there is something I dont catch..

When you open up an index writer, you batch up add and deletes. Now if 
you create a signature for the document, as long as you add it works, 
but what happens if you delete stuff from the index using a query as 
well as adding?

Does Solr also remember the deletions as well?

Daniel Shane

Yonik Seeley wrote:
> On Fri, Aug 21, 2009 at 12:49 AM, Chris
> Hostetter<hossman_lucene@fucit.org> wrote:
>   
>> : But in that case, I assume Solr does a commit per document added.
>>
>> not at all ... it computes a signature and then uses that as a unique key.
>> IndexWriter.updateDocument does all the hard work.
>>     
>
> Right - Solr used to do that hard work, but we handed that over to
> Lucene when that capability was added.  It involves batching either
> way (but letting Lucene handle it at a lower level is "better" since
> it can prevent inconsistencies from crashes).
>
> -Yonik
> http://www.lucidimagination.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42032-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 17:27:13 2009
Return-Path: <java-user-return-42032-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27594 invoked from network); 26 Aug 2009 17:27:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 17:27:13 -0000
Received: (qmail 82369 invoked by uid 500); 26 Aug 2009 17:27:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82291 invoked by uid 500); 26 Aug 2009 17:27:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82281 invoked by uid 99); 26 Aug 2009 17:27:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 17:27:11 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fabriciorsf@gmail.com designates 209.85.222.175 as permitted sender)
Received: from [209.85.222.175] (HELO mail-pz0-f175.google.com) (209.85.222.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 17:27:00 +0000
Received: by pzk5 with SMTP id 5so358415pzk.21
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 10:26:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=gG+SmZScrApYxOVU/VCUkuVj1EJsLusVLaLdRU8eS8I=;
        b=j4JK/Pyr2QOhzLlaPo6KfAu4CSTKiYX7UN1sKGly6frwVmhWzxl9kj1zp/PSKyZ534
         bjrMKkCKFi8P7zDBHpG+Dq96+KP4RZTjSfprpiWSexwl4oGOkitPsNkiMk6vRaccV81V
         ZEPVJziYnSaPeAM8gdFyqzwYBzLFRmfPuX/NE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=suFrRzCnwbkDX2e/dVxovQ+WSaLsDV8AsSj20EkjQTblaKuTkPSKK+xTlhaI/Of8U4
         A/ogMo4mhEUyvhrecqi1o44QzdBxkZb+5mFcQW45kh7iuds826opcw/LqUilzDrlkMKg
         YIef5qVjE30WcgTQG4Yj9RRdFyFkuvbYiKdzY=
MIME-Version: 1.0
Received: by 10.143.129.2 with SMTP id g2mr612663wfn.56.1251307600248; Wed, 26 
	Aug 2009 10:26:40 -0700 (PDT)
In-Reply-To: <e02e1b4b0908251109w143dd339gd2206cdbd0c1acc9@mail.gmail.com>
References: <e02e1b4b0908211007t518862cfv32bfb4e6445e9c@mail.gmail.com>
	 <ac6e61fc0908212228n56f9e80dhcba439cf824511fe@mail.gmail.com>
	 <e02e1b4b0908250803u1f68c4boe153a1eb51fbd016@mail.gmail.com>
	 <786fde50908250917w515f1ff1tc9d03f60e7637557@mail.gmail.com>
	 <e02e1b4b0908250946g1a904fbai17db94de40ad215b@mail.gmail.com>
	 <f18c9dde0908251057g63095903y976b7a6d6592c0e2@mail.gmail.com>
	 <e02e1b4b0908251109w143dd339gd2206cdbd0c1acc9@mail.gmail.com>
Date: Wed, 26 Aug 2009 14:26:40 -0300
Message-ID: <e02e1b4b0908261026p5d53273fg66627a6c1749cc17@mail.gmail.com>
Subject: Re: How to give a score for all documents?
From: =?ISO-8859-1?Q?Fabr=EDcio_Raphael?= <fabriciorsf@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd5f674047f1104720ec1fc
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd5f674047f1104720ec1fc
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Can you help me? How to give customized scores for all documents?

2009/8/25 Fabr=EDcio Raphael <fabriciorsf@gmail.com>

> I am continuing a work about wavelets in IR. In the bellow article you wi=
ll
> to find a example.
>
>
> http://www.ieeexplore.ieee.org/search/srchabstract.jsp?arnumber=3D4740460=
&isnumber=3D4740405&punumber=3D4740404&k2dockey=3D4740460@ieeecnfs&query=3D=
%28%28using+wavelets+to+classify+documents%29%3Cin%3Eti+%29&pos=3D0&access=
=3Dno
>
> Att,
>
>
> On Tue, Aug 25, 2009 at 2:57 PM, Simon Willnauer <
> simon.willnauer@googlemail.com> wrote:
>
>> Hi Fabricio,
>>
>> I will try to recap what you are trying to say...
>>
>> you IR model does score documents that would not be returned by a
>> particular query. So you have some other indicator that make a
>> document relevant?! If it is not a term could you give use an example?
>> How would you decide if a doc is relevant or what would make it
>> "scorable"?
>>
>> I guess an example would help :)
>>
>> simon
>>
>> 2009/8/25 Fabr=EDcio Raphael <fabriciorsf@gmail.com>:
>> > First, that a document is relevant to a query does not necessarily mea=
n
>> that
>> > this document has to contain some query term. You can have other ways =
to
>> > assert that a document is relevant to a query.
>> >
>> > My IR model is different of the vector model, so it can to give score
>> not
>> > null for documents irrelevant for the vector model. I know that Lucene
>> > implements the vector model, but I want to use the facilities of the
>> Lucene
>> > because I like what the Lucene provides.
>> >
>> > But the Lucene to give scores only for relevant documents for the vect=
or
>> > model. And the my model can to give score same that this documents isn=
't
>> > relevant to vector model. It depends of the configuration granularity =
of
>> > execution.
>> >
>> > So I liked that method nextDoc() of the class that implements the
>> > Scorer.class returned all the documents the end of the iteration to
>> > calculate the score.
>> >
>> > I've got to calculate the customized score of the documents that Lucen=
e
>> > returns in according to the vector model.
>> >
>> > I hope you have understood me!
>> >
>> > Thanks!
>> >
>> >
>> > On Tue, Aug 25, 2009 at 1:17 PM, Shai Erera <serera@gmail.com> wrote:
>> >
>> >> Can you please elaborate more on the use case? Why if a certain
>> document is
>> >> irrelevant to a certain query, you'd like to give it a score? Are you
>> >> perhaps talking about certain documents which should always appear in
>> >> search
>> >> results, no matter what the query is? And instead of always showing
>> them,
>> >> you'd like to give them a "static score", so that they can compete w/
>> other
>> >> docs?
>> >>
>> >> If that's the case, I think you can use a BooleanQuery such that the
>> user
>> >> query is added as a clause and then you add another clause (MUST) whi=
ch
>> is
>> >> in fact a MatchAllDocsQuery or something like that which returns a
>> >> customized score. It's expensive though as for each query you'll scor=
e
>> all
>> >> docs in the index.
>> >>
>> >> But I don't think that will help (at least for this use case) since
>> every
>> >> relevant document to the query will be added the same score as an
>> >> 'irrelevant' document, which means the relevant docs will still win,
>> no?
>> >>
>> >> Shai
>> >>
>> >> 2009/8/25 Fabr=EDcio Raphael <fabriciorsf@gmail.com>
>> >>
>> >> > I already know about this, but I want to give a customized score fo=
r
>> all
>> >> > documents in collection, independent if wache document is or isn't
>> >> relevant
>> >> > to the vector model.
>> >> >
>> >> > The similarity function is called only when the document is relevan=
t
>> to
>> >> the
>> >> > vector model.
>> >> >
>> >> > Do you understand me?
>> >> >
>> >> > Thanks!
>> >> >
>> >> > On Sat, Aug 22, 2009 at 2:28 AM, prashant ullegaddi <
>> >> > prashullegaddi@gmail.com> wrote:
>> >> >
>> >> > > If you want to modify the way Lucene scores documents, I guess yo=
u
>> need
>> >> > to
>> >> > > extend Similarity class and provide your own implementation. Take=
 a
>> >> look
>> >> > > at:
>> >> > >
>> >> > >
>> >> > >
>> >> >
>> >>
>> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Default=
Similarity.html
>> >> > >
>> >> > >
>> >> >
>> >>
>> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Similar=
ity.html
>> >> > >
>> >> > > Thanks,
>> >> > > Prashant.
>> >> > >
>> >> > > 2009/8/21 Fabr=EDcio Raphael <fabriciorsf@gmail.com>
>> >> > >
>> >> > > > How to give a customize score for all documents independent of
>> the
>> >> > vector
>> >> > > > model?
>> >> > > >
>> >> > > > I already know how to give a customize score, but I want to giv=
e
>> this
>> >> > > > customize score for all documents in the collection, regardless
>> of
>> >> what
>> >> > > is
>> >> > > > relevant to the vector model.
>> >> > > >
>> >> > > > How to do this?
>> >> > > >
>> >> > > > Now, thanks!
>> >> > > >
>> >> > > > --
>> >> > > > Fabr=EDcio Raphael
>> >> > > >
>> >> > >
>> >> >
>> >> >
>> >> >
>> >> > --
>> >> > Fabr=EDcio Raphael
>> >> >
>> >>
>> >
>> >
>> >
>> > --
>> > Fabr=EDcio Raphael
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> --
> Fabr=EDcio Raphael
>



--=20
Fabr=EDcio Raphael

--000e0cd5f674047f1104720ec1fc--

From java-user-return-42033-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 19:05:31 2009
Return-Path: <java-user-return-42033-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82833 invoked from network); 26 Aug 2009 19:05:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 19:05:31 -0000
Received: (qmail 35225 invoked by uid 500); 26 Aug 2009 19:05:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35151 invoked by uid 500); 26 Aug 2009 19:05:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35141 invoked by uid 99); 26 Aug 2009 19:05:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 19:05:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 19:05:19 +0000
Received: by ewy22 with SMTP id 22so515230ewy.28
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 12:04:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=JO7GHs6e6vou/jdnIjE91zkvKcDbzAHUMsobqvo6DD4=;
        b=EylSah+ftxyPOAfg3ZrTlhy4114G70GzI7kI2Rf/lPBoop3zx8DgGUYSDVs2WyOI3Z
         OESwvMWcAwJqyL1q5LEsEJSV/EKbMn1esUyEsiIEmX4tgK3CKBsYQQb/U/45oCziDj0Z
         xKsd7mnlviR4hoQyivKPmHrZ/9FuEC60wL6J8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=WpScfjkDbECgVW6BWXLE5y0cgBCGQ9wULUQaSs314nHUzu93oAvOsMEQvcxi9huYyI
         mOJYqkWYJJduHLari4iThyyPRT9Uw/Yup3wrGjVdbmukBp0tMiy26wjHixv9if4eFx4H
         iVGIExXnR/vE2pxs5db34JlQDM1al9I+/MBfo=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.216.9.81 with SMTP id 59mr1585443wes.181.1251313498254; Wed, 
	26 Aug 2009 12:04:58 -0700 (PDT)
In-Reply-To: <4A95672B.7020306@lexum.umontreal.ca>
References: <4A842449.3050505@lexum.umontreal.ca>
	 <84088EC8-93A1-4888-8287-B9898A32ED17@apache.org>
	 <4A8C4CB6.8040009@lexum.umontreal.ca>
	 <Pine.LNX.4.64.0908202141490.21261@radix.cryptio.net>
	 <c68e39170908202152i23f711dew117f9fd138781120@mail.gmail.com>
	 <4A95672B.7020306@lexum.umontreal.ca>
Date: Wed, 26 Aug 2009 15:04:58 -0400
X-Google-Sender-Auth: c57cd99363cecdbe
Message-ID: <c68e39170908261204x5e06db1fh2cdd4978129dea19@mail.gmail.com>
Subject: Re: Is there a way to check for field "uniqueness" when indexing?
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Aug 26, 2009 at 12:47 PM, Daniel Shane<shaned@lexum.umontreal.ca> w=
rote:
> Humm... there is something I dont catch..
>
> When you open up an index writer, you batch up add and deletes. Now if yo=
u
> create a signature for the document, as long as you add it works, but wha=
t
> happens if you delete stuff from the index using a query as well as addin=
g?
>
> Does Solr also remember the deletions as well?

It used to - but now it delegates all that to IndexWriter as well (and
lucene buffers them instead).

-Yonik
http://www.lucidimagination.com


> Daniel Shane
>
> Yonik Seeley wrote:
>>
>> On Fri, Aug 21, 2009 at 12:49 AM, Chris
>> Hostetter<hossman_lucene@fucit.org> wrote:
>>
>>>
>>> : But in that case, I assume Solr does a commit per document added.
>>>
>>> not at all ... it computes a signature and then uses that as a unique
>>> key.
>>> IndexWriter.updateDocument does all the hard work.
>>>
>>
>> Right - Solr used to do that hard work, but we handed that over to
>> Lucene when that capability was added. =A0It involves batching either
>> way (but letting Lucene handle it at a lower level is "better" since
>> it can prevent inconsistencies from crashes).
>>
>> -Yonik
>> http://www.lucidimagination.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42034-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 21:45:25 2009
Return-Path: <java-user-return-42034-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31791 invoked from network); 26 Aug 2009 21:45:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 21:45:25 -0000
Received: (qmail 44565 invoked by uid 500); 26 Aug 2009 21:45:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44480 invoked by uid 500); 26 Aug 2009 21:45:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44470 invoked by uid 99); 26 Aug 2009 21:45:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 21:45:22 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.202.165.95] (HELO smtpauth04.prod.mesa1.secureserver.net) (64.202.165.95)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 26 Aug 2009 21:45:12 +0000
Received: (qmail 28397 invoked from network); 26 Aug 2009 21:44:50 -0000
Received: from unknown (81.219.54.251)
  by smtpauth04.prod.mesa1.secureserver.net (64.202.165.95) with ESMTP; 26 Aug 2009 21:44:49 -0000
Message-ID: <4A95ACC8.6060008@getopt.org>
Date: Wed, 26 Aug 2009 23:44:40 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene Search Performance Analysis Workshop
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,

I am giving a free talk/ workshop next week on how to analyze and 
improve Lucene search performance for native lucene apps. If you've ever 
been challenged to get your Java Lucene search apps running faster, I 
think you might find the talk of interest.

Free online workshop:
Thursday, September 3rd 2009
11:00-11:30AM PDT / 14:00-14:30 EDT

Follow this link to sign up:
http://www2.eventsvc.com/lucidimagination/event/ff97623d-3fd5-43ba-a69d-650dcb1d6bbc?trk=WR-SEP2009-AP

About:
Lucene Performance Workshop:
Understanding Lucene Search Performance
with Andrzej Bialecki

Experienced Java developers know how to use the Apache Lucene library to 
build powerful search applications natively in Java.
LucidGaze for Lucene from Lucid Imagination, just released this week, 
provides a powerful utility for making transparent the underlying 
indexing and search operations, and analyzing their impact on search 
performance.

Agenda:
* Understanding sources of variability in Lucene search performance
* LucidGaze for Lucene APIs for performance statistics
* Applying LucidGaze for Lucene performance statistics to real-world 
performance problems

Join us for a free online workshop. Sign up via the link below:
http://www2.eventsvc.com/lucidimagination/event/ff97623d-3fd5-43ba-a69d-650dcb1d6bbc?trk=WR-SEP2009-AP

About the Presenter:
Andrzej Bialecki, Apache Lucene PMC Member, is on the Lucid Imagination 
Technical Advisory Board; he also serves as the project lead for Nutch, 
and as committer in the Lucene-java, Nutch and Hadoop projects. He has 
broad expertise, across domains as diverse as information retrieval, 
systems architecture, embedded systems kernels, networking and business 
process/e-commerce modeling. He's also the author of the popular Luke 
index inspection utility. Andrzej holds a master's degree in Electronics 
from Warsaw Technical University, speaks four languages and programs in 
many, many more.


-- 
Best regards,
Andrzej Bialecki     <><
  ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42035-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 21:58:58 2009
Return-Path: <java-user-return-42035-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37438 invoked from network); 26 Aug 2009 21:58:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 21:58:58 -0000
Received: (qmail 60940 invoked by uid 500); 26 Aug 2009 21:58:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60862 invoked by uid 500); 26 Aug 2009 21:58:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60852 invoked by uid 99); 26 Aug 2009 21:58:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 21:58:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of tsuraan@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 21:58:48 +0000
Received: by qw-out-2122.google.com with SMTP id 8so84740qwh.53
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 14:58:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=OianOg9BpMuHY+YGSmDXRjLpvv66XYuz+5ZGiuRCXL8=;
        b=OdlhB9sX2/DH2fXJ/bfNpRPLBEwihQuUgS6H/+tQlz28/V3Yz2dXr3vsctG1waZfvN
         OCdl1Pas/bxdvCeJWY3M4UE+khOb63OYk1AxnLwzL7e6ZlvfHZ5Hx9c+ijYd6U1Avdb9
         eINZhv2u0pm1UUkIJuwxQHVGiq5AHhb00GNaY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=wmPwsNKzUiHCaC1BkgcO7Pc7Wk49XBp2AytpIbTSTIR7cvtTIqNfWZu9oXDCpjv1A+
         ZKz1v74PyB0/DRO4yAvpAcPrm0d8uqUCJh3cNZCzS76ZO22n5phquiAJAPXprVLiUkVM
         Yp+uiFgnFYwui6WypfbQrlXGz/KZ3bWnIh0w4=
MIME-Version: 1.0
Received: by 10.229.26.149 with SMTP id e21mr2629732qcc.66.1251323907182; Wed, 
	26 Aug 2009 14:58:27 -0700 (PDT)
Date: Wed, 26 Aug 2009 16:58:27 -0500
Message-ID: <84fb38e30908261458n1e365979p80a467f9ba77a65d@mail.gmail.com>
Subject: Lucene in Action Rev2
From: tsuraan <tsuraan@gmail.com>
To: java-user <java-user@lucene.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

In the free first chapter of the new Lucene in Action book, it states
that it's targetting Lucene 3.0, but on the Manning page for the book,
it says the code in the book is written for 2.3.  I'm guessing that
the book is the authority on what the book covers, but could somebody
maybe change the Manning page to reflect that?

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42036-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 22:37:21 2009
Return-Path: <java-user-return-42036-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57592 invoked from network); 26 Aug 2009 22:37:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 22:37:21 -0000
Received: (qmail 3429 invoked by uid 500); 26 Aug 2009 22:37:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3340 invoked by uid 500); 26 Aug 2009 22:37:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3330 invoked by uid 99); 26 Aug 2009 22:37:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 22:37:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.221.192 as permitted sender)
Received: from [209.85.221.192] (HELO mail-qy0-f192.google.com) (209.85.221.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 22:37:11 +0000
Received: by qyk30 with SMTP id 30so240181qyk.5
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 15:36:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=E9O2Oj60D3cK4zv7hpXXXvCb0KafxLyrvEkxAlFjk0E=;
        b=B7bHsjkAngE6PYcR8g17umueH7d1+rmwvzl8MVdlLlRB7BDsltiRDdfbHkGknx4ZoP
         HSgb/7NcFr6VzEFZ9dgKb27lTeDMs7b2qUxdLRF9eD6KQ85WOmbyWBhgY6+FEBntIKr+
         M/mxJ7ZxvPT4JkxjnykuoVu7wy73WYq1O+cis=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=flsLcljmP4WI2GbZaD2N2xS2kqRvAYG9AYaAwDX7cGMVsb6auHeDbzp/brItmmf2BY
         zPjdp6L4PyanYEUIeZnv9GkJbGoH3qcL+DN8uwGBGkt9w9/0LmG5B8W6qqnNqPfCfk1T
         ZwhPqJhfB5/aEUzVD6VHGNUxS65BS1en7GQw8=
MIME-Version: 1.0
Received: by 10.224.51.8 with SMTP id b8mr5617517qag.349.1251326210596; Wed, 
	26 Aug 2009 15:36:50 -0700 (PDT)
In-Reply-To: <4A842449.3050505@lexum.umontreal.ca>
References: <4A842449.3050505@lexum.umontreal.ca>
Date: Wed, 26 Aug 2009 15:36:50 -0700
Message-ID: <85d3c3b60908261536o2c05b64cj94ebb9c73016aa04@mail.gmail.com>
Subject: Re: Is there a way to check for field "uniqueness" when indexing?
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Daniel,

You may want to look at SOLR-1375 which enables ID checking
using a BloomFilter (with a specified errorrate of false
positives). Otherwise for what you're trying to do, you'd need
to create a hash map?

-J

On Thu, Aug 13, 2009 at 7:33 AM, Daniel Shane<shaned@lexum.umontreal.ca> wrote:
> Hi all!
>
> I'm currently running a big lucene index and one of my main concerns is the
> integrity of the data entered. A few things come to mind, like enforcing
> that certain fields be non-blank, forcing certain formats etc...
>
> All these validations are easy to do with lucene, since I can validate the
> document before it is indexed or when it is retrieved.
>
> The thing however that I have a hard time with, is field uniquness.
>
> Lets say I have a field and I really want it to be unique. I can't seem to
> find out how to do it during the indexation phase since everything that is
> added to the index is not readable by an index reader until the index is
> closed.
>
> Add to that the fact that items can be deleted from the index during the
> indexation and the only way I have to figure uniquness is to check every
> unique field values using termEnums and checking for docFreq.
>
> This has a major disadvantage that I cannot inform people who are using the
> library of the unique conflit when it happens, only when the index is
> closed.
>
> Does anyone have an idea on how I could check an index that is in the
> process of being indexed (things added, things deleted) for the uniquess of
> a given field *at the time I index a document* ?
>
> Daniel Shane
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42037-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Aug 26 23:57:32 2009
Return-Path: <java-user-return-42037-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74272 invoked from network); 26 Aug 2009 23:57:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Aug 2009 23:57:32 -0000
Received: (qmail 66429 invoked by uid 500); 26 Aug 2009 23:57:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66358 invoked by uid 500); 26 Aug 2009 23:57:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66348 invoked by uid 99); 26 Aug 2009 23:57:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 23:57:30 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Aug 2009 23:57:22 +0000
Received: by qw-out-2122.google.com with SMTP id 8so121458qwh.53
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 16:57:00 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.224.43.168 with SMTP id w40mr3840617qae.19.1251331020437; Wed, 
	26 Aug 2009 16:57:00 -0700 (PDT)
In-Reply-To: <84fb38e30908261458n1e365979p80a467f9ba77a65d@mail.gmail.com>
References: <84fb38e30908261458n1e365979p80a467f9ba77a65d@mail.gmail.com>
Date: Wed, 26 Aug 2009 19:57:00 -0400
Message-ID: <9ac0c6aa0908261657l5e22113av24d680a9036ba9e@mail.gmail.com>
Subject: Re: Lucene in Action Rev2
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks for spotting that!  We'll work with Manning to get it fixed...

Yes, we're targeting 3.0 not 2.3 :)

Mike

On Wed, Aug 26, 2009 at 5:58 PM, tsuraan<tsuraan@gmail.com> wrote:
> In the free first chapter of the new Lucene in Action book, it states
> that it's targetting Lucene 3.0, but on the Manning page for the book,
> it says the code in the book is written for 2.3. =A0I'm guessing that
> the book is the authority on what the book covers, but could somebody
> maybe change the Manning page to reflect that?
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42038-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 01:18:04 2009
Return-Path: <java-user-return-42038-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96466 invoked from network); 27 Aug 2009 01:18:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 01:18:04 -0000
Received: (qmail 24071 invoked by uid 500); 27 Aug 2009 01:17:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23953 invoked by uid 500); 27 Aug 2009 01:17:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23875 invoked by uid 99); 27 Aug 2009 01:17:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 01:17:59 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HS_INDEX_PARAM,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bradfordstephens@gmail.com designates 209.85.216.202 as permitted sender)
Received: from [209.85.216.202] (HELO mail-px0-f202.google.com) (209.85.216.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 01:17:30 +0000
Received: by pxi40 with SMTP id 40so634364pxi.5
        for <multiple recipients>; Wed, 26 Aug 2009 18:17:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:references:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:x-mailer
         :mime-version:subject:date:cc;
        bh=pIemCm5+H/JJ8wfytFj9/v6PQ7xOcFAO4qR3lIiwbRQ=;
        b=LRBLRYiRXCBD3sUbHRJWygvHglZzMCyExj69PFfKa51WG3ExIqz3re22snYVayKBZR
         ZUX/qr6lCQ4c5SgtZHeZ/8T+kkq1ruWcseOMJY/+EuLwfumcypyrwrg7Zu9olmhWsuxf
         MiynsXOnu9vYrslA9dK0pTMGOdt/x23c/U7dk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=references:message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:x-mailer:mime-version:subject:date:cc;
        b=j14wmkHAxmK238YJAlA+Ss+hUWmTJy8CvMyPEdOQoEGnl6h/nnRxlJ2Bac+eWwMNJ+
         hy6P70NJt3rs28WJomRNNOmNVSrfbz0ERkzHF+DxVHRh5kvTY8FSW575stroGMDLwK6A
         0gmcQfxXY4PFqJGkoxdlcbfrDKk9kqvVLbvvg=
Received: by 10.115.148.16 with SMTP id a16mr10659911wao.57.1251335830157;
        Wed, 26 Aug 2009 18:17:10 -0700 (PDT)
Received: from ?10.236.70.165? ([166.205.135.183])
        by mx.google.com with ESMTPS id f20sm609232waf.17.2009.08.26.18.17.07
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 26 Aug 2009 18:17:08 -0700 (PDT)
References: <860544ed0908251621leacbe9andc4daefdabb8d62b@mail.gmail.com>
Message-Id: <D97D9F63-3D13-4E9C-94CB-0C1D0722BFD1@gmail.com>
From: Bradford Stephens <bradfordstephens@gmail.com>
To: Bradford Stephens <bradfordstephens@gmail.com>
In-Reply-To: <860544ed0908251621leacbe9andc4daefdabb8d62b@mail.gmail.com>
Content-Type: text/plain;
	charset=us-ascii;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: 7bit
X-Mailer: iPhone Mail (7A400)
Mime-Version: 1.0 (iPhone Mail 7A400)
Subject: Re: Seattle / NW Hadoop, HBase Lucene, etc. Meetup , Wed August 26th, 6:45pm
Date: Wed, 26 Aug 2009 18:17:02 -0700
Cc: "core-user@hadoop.apache.org" <core-user@hadoop.apache.org>,
 "hbase-user@hadoop.apache.org" <hbase-user@hadoop.apache.org>,
 "solr-user@lucene.apache.org" <solr-user@lucene.apache.org>,
 "java-user@lucene.apache.org" <java-user@lucene.apache.org>,
 "pig-user@hadoop.apache.org" <pig-user@hadoop.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

My apologies, but there was a mix-up reserving our meeting location,  
and we don't have access to it.

I'm very sorry, and beer is on me next month. Promise :)

Sent from my Internets

On Aug 25, 2009, at 4:21 PM, Bradford Stephens <bradfordstephens@gmail.com 
 > wrote:

> Hey there,
>
> Apologies for this not going out sooner -- apparently it was sitting
> as a draft in my inbox. A few of you have pinged me, so thanks for
> your vigilance.
>
> It's time for another Hadoop/Lucene/Apache Stack meetup! We've had
> great attendance in the past few months, let's keep it up! I'm always
> amazed by the things I learn from everyone.
>
> We're back at the University of Washington, Allen Computer Science
> Center (not Computer Engineering)
> Map: http://www.washington.edu/home/maps/?CSE
>
> Room: 303 -or- the Entry level. If there are changes, signs will be  
> posted.
>
> More Info:
>
> The meetup is about 2 hours: we'll have two in-depth talks of 15-20
> minutes each, and then several "lightning talks" of 5 minutes. If no
> one offers, We'll then have discussion and 'social time'.  we'll just
> have general discussion. Let net know if you're interested in speaking
> or attending. We'd like to focus on education, so every presentation
> *needs* to ask some questions at the end. We can talk about these
> after the presentations, and I'll record what we've learned in a wiki
> and share that with the rest of us.
>
> Contact: Bradford Stephens, 904-415-3009, bradfordstephens@gmail.com
>
> --
> http://www.roadtofailure.com -- The Fringes of Scalability, Social
> Media, and Computer Science

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42039-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 01:49:56 2009
Return-Path: <java-user-return-42039-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10536 invoked from network); 27 Aug 2009 01:49:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 01:49:56 -0000
Received: (qmail 58641 invoked by uid 500); 27 Aug 2009 01:49:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58603 invoked by uid 500); 27 Aug 2009 01:49:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58593 invoked by uid 99); 27 Aug 2009 01:49:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 01:49:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erik.hatcher@gmail.com designates 209.85.211.196 as permitted sender)
Received: from [209.85.211.196] (HELO mail-yw0-f196.google.com) (209.85.211.196)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 01:49:44 +0000
Received: by ywh34 with SMTP id 34so916801ywh.6
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 18:49:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=r+koaJrsqjfizGrrTLTNkIHz30O2ss+g57Xb+c9/Ga4=;
        b=EJGaUjAvyKFMkgGGp7GyWPIulEMD8iQVJo9rBr9Bv2FVw5qqyu8iX8OirI6/45y0Z9
         Q+v/khz77oUYJ9HcCSuAou/z1QLQmGqiLA/0su0Jx6SBsy5B2e1IynLCs7m+dXNgkc1I
         0c1rXyzr14X3q4I2PL5d1ZrQmaWiGjVD/SoKQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=KkwiTSnTx1Xq6OjpqYFlzB0XvdqZGzBHYZo0S+JaNwNVymRuCq/feNSRjAwRlEm8RT
         K3UTBn5CHOBJAhY5HblwDyIdtw8Juar8vDDFFwwjA3fG6fY9Wlj1Wdz9NqukdTJAzFBz
         7nkA5qGP8+nLyk72PM2cKqBkLmvSIGIwJc8q4=
Received: by 10.91.161.39 with SMTP id n39mr6573110ago.88.1251337763542;
        Wed, 26 Aug 2009 18:49:23 -0700 (PDT)
Received: from ?10.0.1.14? (va-71-51-2-147.dhcp.embarqhsd.net [71.51.2.147])
        by mx.google.com with ESMTPS id 20sm4079357agb.75.2009.08.26.18.49.22
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 26 Aug 2009 18:49:22 -0700 (PDT)
Message-Id: <64F1818F-1ACD-4CAB-9A1B-F32483EDA2A3@gmail.com>
From: Erik Hatcher <erik.hatcher@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <84fb38e30908261458n1e365979p80a467f9ba77a65d@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v935.3)
Subject: Re: Lucene in Action Rev2
Date: Wed, 26 Aug 2009 20:12:33 -0400
References: <84fb38e30908261458n1e365979p80a467f9ba77a65d@mail.gmail.com>
X-Mailer: Apple Mail (2.935.3)
X-Virus-Checked: Checked by ClamAV on apache.org

I've pinged Manning to get this corrected.  Thanks for the heads-up.

	Erik

On Aug 26, 2009, at 5:58 PM, tsuraan wrote:

> In the free first chapter of the new Lucene in Action book, it states
> that it's targetting Lucene 3.0, but on the Manning page for the book,
> it says the code in the book is written for 2.3.  I'm guessing that
> the book is the authority on what the book covers, but could somebody
> maybe change the Manning page to reflect that?
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42040-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 03:31:34 2009
Return-Path: <java-user-return-42040-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39562 invoked from network); 27 Aug 2009 03:31:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 03:31:34 -0000
Received: (qmail 13055 invoked by uid 500); 27 Aug 2009 03:31:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12899 invoked by uid 500); 27 Aug 2009 03:31:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12885 invoked by uid 99); 27 Aug 2009 03:31:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 03:31:31 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 03:31:23 +0000
Received: by ewy22 with SMTP id 22so849845ewy.28
        for <java-user@lucene.apache.org>; Wed, 26 Aug 2009 20:31:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=g6i86dTH97ozrPmFnBOjU1cla2SFmaLfKM4yk9yf0Ms=;
        b=mUfVoDk1RkLYOSqHZBFvb3DwkPqbPHO56P/Jhac+VqBGKiMlVCQLx3lmOd2nFCmFsI
         GBi4wB59xpwd0Lng67NWJMuc86UAVXcx6g2ns6o2X8TLqkonGXfaerSgr34XxHLJkeyf
         m20gQcQP8nQBfHJ/SkFJARD1GvQjSYIeG1+N4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=LPgA2loxNH3KoVsQncEPaU6Tkhi3JTqBFBhVJd1BINwIVKpEDMGVwp5zbxv8IMTCjN
         qf6UV8XQnCyfr0Aw5GwOPjm1jWjePjyZ4h0jytHZz/QUCxwhRA2AhCP/lg47nNgoTph9
         Qr7Hg03spwte+q+Y6iItTfEZLg6iav1gcwvWA=
MIME-Version: 1.0
Received: by 10.216.29.80 with SMTP id h58mr1769200wea.159.1251343861772; Wed, 
	26 Aug 2009 20:31:01 -0700 (PDT)
In-Reply-To: <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
	 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
Date: Thu, 27 Aug 2009 06:31:01 +0300
Message-ID: <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
Subject: Re: Extending Sort/FieldCache
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6de010f5f73be0472173250
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6de010f5f73be0472173250
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks a lot for the response !

I wanted to avoid two things:
* Writing the logic that invokes cache-refresh upon IndexReader reload.
* Write my own TopFieldCollector which uses this cache.

I guess I don't have any other choice by to write both of them, or try to
make TFC more "customizable" such that someone can pass in his own
FieldCachePQ. I'll start w/ my own version and if possible suggest an
extension to TFC.

Thanks again,
Shai

On Tue, Aug 25, 2009 at 8:36 PM, Chris Hostetter
<hossman_lucene@fucit.org>wrote:

>
> : I'd like to extend Lucene's FieldCache such that it will read native
> values
>        ...
> : payload value to long, and store it in the cache. The reason I want to
> : extend Lucene's FieldCache is because I'd like Lucene to take care of
> : updating this cache when necessary (such as after reopen for example).
> This
> : will allow me to use Lucene's Sort option more easily.
>
> this was my motivation when i opened LUCENE-831, but i promptly got bogged
> down with other shit and had to abandon that issue ...
> Miller/Uwe/McCandles seemed like they were making really cool progress
> with it, but (if i remember correctly) it seems to have gotten into some
> sort of quagmire related to reopen and segment merging -- which led to a
> lot of the current segment based sortinging we have now, which makes most
> of that issue obsolete.
>
> but we still have hte issue of wanting to provide your own caching
> mechanism -- which at the moment has no solution that i know of.
>
> : I noticed Sort can be extended by providing a CUSTOM SortField, but that
>
> i think you're only option is to use a custom Sort which uses your own
> private cache of some kind.
>
> : I didn't find a way though to extend FieldCache, or ExtendedFieldCache
> -->
> : even though both are extendable, I don't find the place where they're
> given
> : as input to TopFieldDocCollector, FieldSortedHitQueue etc. Perhaps I'm
> : missing it?
>
> you're not missing anything ... a singleton is used, and you can't replace
> the singlton because its' a static on the Interface.
>
> : BTW, if it interests anyone, perhaps augmenting Lucene's sort w/ reading
> : values from a Payload, or doing a complete payload-based-sort, I can work
> up
> : a patch ...
>
> I believe that was always one of Busch's goals with the payload stuff, but
> last time i remember hearing about it he was thinking that rather then
> doing it directly with payloads he wants to skip ahead to use column-stride
> fields ... not sure if he had an implementation in mind yet though.
>
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6de010f5f73be0472173250--

From java-user-return-42041-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 04:46:55 2009
Return-Path: <java-user-return-42041-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51000 invoked from network); 27 Aug 2009 04:46:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 04:46:55 -0000
Received: (qmail 69720 invoked by uid 500); 27 Aug 2009 04:46:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69473 invoked by uid 500); 27 Aug 2009 04:46:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69463 invoked by uid 99); 27 Aug 2009 04:46:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 04:46:52 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=MSGID_MULTIPLE_AT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [64.13.253.17] (HELO guavus.com) (64.13.253.17)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 04:46:40 +0000
Received: (qmail 24205 invoked from network); 26 Aug 2009 21:46:18 -0700
Received: from isp-net67.spectranet.com (HELO station151) (@125.63.71.67)
  by guavus.com with SMTP; 26 Aug 2009 21:46:17 -0700
From: "Sumanta Bhowmik" <sumanta.bhowmik@guavus.com>
To: <java-user@lucene.apache.org>
Cc: <lucene@mikemccandless.com>
References: <-61520930041827677@unknownmsgid>	 <9ac0c6aa0908200237kcb7d0f3q73d37b5fdec27f2d@mail.gmail.com>	 <-3936163573164025315@unknownmsgid> <9ac0c6aa0908210413w92a8280rd8a1d9deb0548bb8@mail.gmail.com> <004801ca248e$10e835d0$32b8a170$@bhowmik@guavus.com>
In-Reply-To: <004801ca248e$10e835d0$32b8a170$@bhowmik@guavus.com>
Subject: RE: Merge Exception in Lucene 2.4
Date: Thu, 27 Aug 2009 10:16:08 +0530
Message-ID: <018b01ca26d1$50860060$f1920120$@bhowmik@guavus.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcoiUJoBxd7a02ekREyZvpD45TXGLwCPUvkgAI/ZZEA=
Content-Language: en-us
X-Virus-Checked: Checked by ClamAV on apache.org

Hi

I ran a long running test and now got this exception.

Exception in thread "Lucene Merge Thread #39"
org.apache.lucene.index.MergePolicy$MergeException: java.io.IOException:
read past EOF
        at
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
rentMergeScheduler.java:309)
        at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
ergeScheduler.java:286)
Caused by: java.io.IOException: read past EOF
        at
org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java=
:15
1)
        at
org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.ja=
va:
38)
        at =
org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
        at
org.apache.lucene.index.SegmentTermPositions.readDeltaPosition(SegmentTer=
mPo
sitions.java:73)
        at
org.apache.lucene.index.SegmentTermPositions.nextPosition(SegmentTermPosi=
tio
ns.java:69)
        at
org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:6=
67)
        at
org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:58=
6)
        at
org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:5=
47)
        at
org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:500)
        at
org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:140)
        at
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4226)
        at =
org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3877)
        at
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
duler.java:205)
        at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
ergeScheduler.java:260)



I am running it on Linux version 2.6.26-79.fc9 , gcc version 4.1.2 =
20071124
(Red Hat 4.1.2-42)

This exception occurs after we have indexed more than 100 gb of data. I =
will
try running with -Xint to see if I can avoid this exception.=20

Regards
Sumanta

-----Original Message-----
From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]=20
Sent: Monday, August 24, 2009 1:10 PM
To: java-user@lucene.apache.org
Subject: RE: Merge Exception in Lucene 2.4

I will be running a long running test with jdk1.6u16. If the problem =
still
appears I will try to create a test case to show the issue.

Sumanta

-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: Friday, August 21, 2009 4:44 PM
To: java-user@lucene.apache.org
Subject: Re: Merge Exception in Lucene 2.4

That code looks fine...

What OS/filesystem are you using?

Can you make a small test case that shows the issue?

Mike

On Thu, Aug 20, 2009 at 7:41 AM, Sumanta
Bhowmik<sumanta.bhowmik@guavus.com> wrote:
> We put all the IndexWriters in an array which is defined by
>
> final Directory[] finalDir;
>
> We also declare an indexer
> As
> private volatile static Indexer indexer;
>
> final Indexer finalIndexer =3D indexer;
>
> Next we call the merge in a new thread :
>
> Thread thread =3D new Thread(){
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public void run()
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.debug("starts merging w/o
> optimization");
>
> finalIndexer.getWriter().addIndexesNoOptimize(finalDir);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.debug("ends merging w/o
> optimization");
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch =
(CorruptIndexException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.notice("",e);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch =
(IOException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.notice("",e);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0}
> }
>
> Sumanta
>
>
>
>
> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: Thursday, August 20, 2009 3:07 PM
> To: java-user@lucene.apache.org
> Subject: Re: Merge Exception in Lucene 2.4
>
> You should definitely upgrade to the latest JDK 1.6 to get the fix for
> the JRE bug in LUCENE-1282, but, I don't think you are hitting that
> bug (read past EOF during merge is a different exception).
>
> Can you describe more detail on how you merge 6 IndexWriters?
>
> Mike
>
> On Thu, Aug 20, 2009 at 5:21 AM, Sumanta
> Bhowmik<sumanta.bhowmik@guavus.com> wrote:
>> I checked at http://issues.apache.org/jira/browse/LUCENE-1282
>> SegmentMerger.java has this code
>>
>> TermFreqVector[] vectors =3D reader.getTermFreqVectors(docNum);
>> termVectorsWriter.addAllDocVectors(vectors);
>>
>> so this issue appears inspite of this fix.
>>
>> I am using java version "1.6.0_07". Is it fixed in jdk6u10 and above
>> (http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=3D6707044) ?
>>
>> Regards
>> Sumanta
>>
>>
>> -----Original Message-----
>> From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]
>> Sent: Thursday, August 20, 2009 1:15 PM
>> To: java-user@lucene.apache.org
>> Subject: Merge Exception in Lucene 2.4
>>
>> Hi
>>
>>
>>
>> I am getting this issue in Lucene2.4 when I try to merge multiple
>> IndexWriters(generally 6)
>>
>>
>>
>> sh-3.2# Exception in thread "Lucene Merge Thread #5"
>> org.apache.lucene.index.MergePolicy$MergeException: =
java.io.IOException:
>> read past EOF
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
>> rentMergeScheduler.java:309)
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>> ergeScheduler.java:286)
>>
>> Caused by: java.io.IOException: read past EOF
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.j=
ava
>> :135)
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.ja=
va:
>> 228)
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:=
184
>> )
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.ja=
va:
>> 204)
>>
>> =A0 =A0 =A0 =A0at
>> =
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4260)
>>
>> =A0 =A0 =A0 =A0at
org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3877)
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
>> duler.java:205)
>>
>> =A0 =A0 =A0 =A0at
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>> ergeScheduler.java:260)
>>
>>
>>
>>
>>
>> Is this a known issue and has any fix been provided for it ? Would
>> appreciate any help.
>>
>>
>>
>> Regards
>>
>> Sumanta
>>
>>
>>
>>
>>
>>
>>
>>
>> __________ NOD32 4349 (20090819) Information __________
>>
>> This message was checked by NOD32 antivirus system.
>> http://www.eset.com
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> __________ NOD32 4350 (20090820) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


__________ NOD32 4354 (20090821) Information __________

This message was checked by NOD32 antivirus system.
http://www.eset.com



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


__________ NOD32 4361 (20090823) Information __________

This message was checked by NOD32 antivirus system.
http://www.eset.com



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42042-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 09:00:39 2009
Return-Path: <java-user-return-42042-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27772 invoked from network); 27 Aug 2009 09:00:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 09:00:39 -0000
Received: (qmail 4916 invoked by uid 500); 27 Aug 2009 09:00:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4835 invoked by uid 500); 27 Aug 2009 09:00:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4825 invoked by uid 99); 27 Aug 2009 09:00:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 09:00:36 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 09:00:26 +0000
Received: by gxk12 with SMTP id 12so1146270gxk.4
        for <java-user@lucene.apache.org>; Thu, 27 Aug 2009 02:00:04 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.239.1 with SMTP id m1mr13736145ybh.152.1251363604404; Thu, 
	27 Aug 2009 02:00:04 -0700 (PDT)
In-Reply-To: <4608543773190021384@unknownmsgid>
References: <-61520930041827677@unknownmsgid>
	 <9ac0c6aa0908200237kcb7d0f3q73d37b5fdec27f2d@mail.gmail.com>
	 <-3936163573164025315@unknownmsgid>
	 <9ac0c6aa0908210413w92a8280rd8a1d9deb0548bb8@mail.gmail.com>
	 <4608543773190021384@unknownmsgid>
Date: Thu, 27 Aug 2009 05:00:04 -0400
Message-ID: <9ac0c6aa0908270200l6064dc0fgdce08d0501441db0@mail.gmail.com>
Subject: Re: Merge Exception in Lucene 2.4
From: Michael McCandless <lucene@mikemccandless.com>
To: Sumanta Bhowmik <sumanta.bhowmik@guavus.com>
Cc: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Was this a smallish contained test case?  Can you post the sources?

Can you run your next test with IndexWriter's infoStream turned on,
and post the resluting output?

Was this with jdk1.6u16?  That version fixes the original hotspot bug
from LUCENE-1282... (and your exception looks different from the one
in LUCENE-1282).

Mike

On Thu, Aug 27, 2009 at 12:46 AM, Sumanta
Bhowmik<sumanta.bhowmik@guavus.com> wrote:
> Hi
>
> I ran a long running test and now got this exception.
>
> Exception in thread "Lucene Merge Thread #39"
> org.apache.lucene.index.MergePolicy$MergeException: java.io.IOException:
> read past EOF
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
> rentMergeScheduler.java:309)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
> ergeScheduler.java:286)
> Caused by: java.io.IOException: read past EOF
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java=
:15
> 1)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.ja=
va:
> 38)
> =A0 =A0 =A0 =A0at org.apache.lucene.store.IndexInput.readVInt(IndexInput.=
java:78)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentTermPositions.readDeltaPosition(SegmentTer=
mPo
> sitions.java:73)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentTermPositions.nextPosition(SegmentTermPosi=
tio
> ns.java:69)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:6=
67)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:58=
6)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:5=
47)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:500)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:140)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4226)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.j=
ava:3877)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
> duler.java:205)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
> ergeScheduler.java:260)
>
>
>
> I am running it on Linux version 2.6.26-79.fc9 , gcc version 4.1.2 200711=
24
> (Red Hat 4.1.2-42)
>
> This exception occurs after we have indexed more than 100 gb of data. I w=
ill
> try running with -Xint to see if I can avoid this exception.
>
> Regards
> Sumanta
>
> -----Original Message-----
> From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]
> Sent: Monday, August 24, 2009 1:10 PM
> To: java-user@lucene.apache.org
> Subject: RE: Merge Exception in Lucene 2.4
>
> I will be running a long running test with jdk1.6u16. If the problem stil=
l
> appears I will try to create a test case to show the issue.
>
> Sumanta
>
> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: Friday, August 21, 2009 4:44 PM
> To: java-user@lucene.apache.org
> Subject: Re: Merge Exception in Lucene 2.4
>
> That code looks fine...
>
> What OS/filesystem are you using?
>
> Can you make a small test case that shows the issue?
>
> Mike
>
> On Thu, Aug 20, 2009 at 7:41 AM, Sumanta
> Bhowmik<sumanta.bhowmik@guavus.com> wrote:
>> We put all the IndexWriters in an array which is defined by
>>
>> final Directory[] finalDir;
>>
>> We also declare an indexer
>> As
>> private volatile static Indexer indexer;
>>
>> final Indexer finalIndexer =3D indexer;
>>
>> Next we call the merge in a new thread :
>>
>> Thread thread =3D new Thread(){
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public void run()
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0logger.debug("starts merging w/o
>> optimization");
>>
>> finalIndexer.getWriter().addIndexesNoOptimize(finalDir);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0logger.debug("ends merging w/o
>> optimization");
>>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (=
CorruptIndexException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0logger.notice("",e);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (=
IOException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0logger.notice("",e);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0}
>> }
>>
>> Sumanta
>>
>>
>>
>>
>> -----Original Message-----
>> From: Michael McCandless [mailto:lucene@mikemccandless.com]
>> Sent: Thursday, August 20, 2009 3:07 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: Merge Exception in Lucene 2.4
>>
>> You should definitely upgrade to the latest JDK 1.6 to get the fix for
>> the JRE bug in LUCENE-1282, but, I don't think you are hitting that
>> bug (read past EOF during merge is a different exception).
>>
>> Can you describe more detail on how you merge 6 IndexWriters?
>>
>> Mike
>>
>> On Thu, Aug 20, 2009 at 5:21 AM, Sumanta
>> Bhowmik<sumanta.bhowmik@guavus.com> wrote:
>>> I checked at http://issues.apache.org/jira/browse/LUCENE-1282
>>> SegmentMerger.java has this code
>>>
>>> TermFreqVector[] vectors =3D reader.getTermFreqVectors(docNum);
>>> termVectorsWriter.addAllDocVectors(vectors);
>>>
>>> so this issue appears inspite of this fix.
>>>
>>> I am using java version "1.6.0_07". Is it fixed in jdk6u10 and above
>>> (http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=3D6707044) ?
>>>
>>> Regards
>>> Sumanta
>>>
>>>
>>> -----Original Message-----
>>> From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]
>>> Sent: Thursday, August 20, 2009 1:15 PM
>>> To: java-user@lucene.apache.org
>>> Subject: Merge Exception in Lucene 2.4
>>>
>>> Hi
>>>
>>>
>>>
>>> I am getting this issue in Lucene2.4 when I try to merge multiple
>>> IndexWriters(generally 6)
>>>
>>>
>>>
>>> sh-3.2# Exception in thread "Lucene Merge Thread #5"
>>> org.apache.lucene.index.MergePolicy$MergeException: java.io.IOException=
:
>>> read past EOF
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
>>> rentMergeScheduler.java:309)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>>> ergeScheduler.java:286)
>>>
>>> Caused by: java.io.IOException: read past EOF
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
> org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.j=
ava
>>> :135)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
> org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.ja=
va:
>>> 228)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
> org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:=
184
>>> )
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
> org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.ja=
va:
>>> 204)
>>>
>>> =A0 =A0 =A0 =A0at
>>> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4260)
>>>
>>> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3877)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
>>> duler.java:205)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>>> ergeScheduler.java:260)
>>>
>>>
>>>
>>>
>>>
>>> Is this a known issue and has any fix been provided for it ? Would
>>> appreciate any help.
>>>
>>>
>>>
>>> Regards
>>>
>>> Sumanta
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> __________ NOD32 4349 (20090819) Information __________
>>>
>>> This message was checked by NOD32 antivirus system.
>>> http://www.eset.com
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> __________ NOD32 4350 (20090820) Information __________
>>
>> This message was checked by NOD32 antivirus system.
>> http://www.eset.com
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> __________ NOD32 4354 (20090821) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> __________ NOD32 4361 (20090823) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42043-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 13:11:34 2009
Return-Path: <java-user-return-42043-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19345 invoked from network); 27 Aug 2009 13:11:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 13:11:34 -0000
Received: (qmail 1453 invoked by uid 500); 27 Aug 2009 13:11:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1367 invoked by uid 500); 27 Aug 2009 13:11:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1354 invoked by uid 99); 27 Aug 2009 13:11:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 13:11:31 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 13:11:21 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n7RDAwHp031850
	for <java-user@lucene.apache.org>; Thu, 27 Aug 2009 14:10:58 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Thu, 27 Aug 2009 14:10:58 +0100 (BST)
Date: Thu, 27 Aug 2009 14:10:58 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <895923651.19581251378658048.JavaMail.root@mail.uk.scalix.com>
In-Reply-To: <9ac0c6aa0908260626m5e2d8a32kbb40ae010f922e7c@mail.gmail.com>
Subject: RE: Lucene gobbling file descriptors
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

I'm glad its not normal.  That means we can fix it!  I will conduct a review of IndexReader/Searcher open/close ops.

Thanks!

Chris

----- Original Message -----
From: Michael McCandless <lucene@mikemccandless.com>
Sent: Wed, 26/8/2009 2:26pm
To: java-user@lucene.apache.org
Subject: Re: Lucene gobbling file descriptors

This is not normal.  As long as you are certain you close every
IndexReader/Searcher that you opened, the number of file descriptors
should stay "contained".

Though: how many files are there in your index directory?

Mike

On Wed, Aug 26, 2009 at 9:18 AM, Chris Bamford<Chris.Bamford@scalix.com> wrote:
> Hi there,
>
> I wonder if someone can help?  We have a successful Lucene app deployed on Tomcat which works well.  As far as we can tell, our developers have observed all the guidelines in the Lucene FAQ, but on some of our installations, Tomcat eventually runs out of file descriptors and needs a restart to clear it.  We know Lucene is the culprit because use lsof -p <java PID> and the vast majority (usually tens of thousands) of files reported are Lucene index files.
>
> I am hoping to get some tips on how this can be avoided.  Is it simply the case that as time goes by, more and more descriptors are left open and no matter how high ulimit is set, you will run out?  Or is there a policy of recycling that we are failing to utilise properly?
>
> I am happy to provide more information, just don't know what at this point!  Please ask....
>
> Thanks in advance
>
> - Chris
>
> Chris Bamford
> Senior Development Engineer
> Scalix
> chris.bamford@scalix.com
> Tel: +44 (0)1344 381814
> www.scalix.com
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42044-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 14:12:07 2009
Return-Path: <java-user-return-42044-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49416 invoked from network); 27 Aug 2009 14:12:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 14:12:06 -0000
Received: (qmail 78681 invoked by uid 500); 27 Aug 2009 14:12:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78610 invoked by uid 500); 27 Aug 2009 14:12:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78597 invoked by uid 99); 27 Aug 2009 14:12:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 14:12:04 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 14:11:55 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n7REBW5s011001
	for <java-user@lucene.apache.org>; Thu, 27 Aug 2009 15:11:32 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Thu, 27 Aug 2009 15:11:31 +0100 (BST)
Date: Thu, 27 Aug 2009 15:11:31 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <1631401208.19651251382291503.JavaMail.root@mail.uk.scalix.com>
Subject: New "Stream closed" exception with Java 6
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Hi, 

Since moving our app to Java 6 and Tomcat 6, we have started getting occasional exceptions of the form:

java.io.IOException: Stream closed
    at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
    at sun.nio.cs.StreamDecoder.read(Unknown Source)
    at java.io.InputStreamReader.read(Unknown Source)
    at org.apache.lucene.analysis.standard.StandardTokenizerImpl.zzRefill(StandardTokenizerImpl.java:443)
    at org.apache.lucene.analysis.standard.StandardTokenizerImpl.getNextToken(StandardTokenizerImpl.java:629)
    at org.apache.lucene.analysis.standard.StandardTokenizer.next(StandardTokenizer.java:140)
    at org.apache.lucene.analysis.standard.StandardFilter.next(StandardFilter.java:43)
    at org.apache.lucene.analysis.LowerCaseFilter.next(LowerCaseFilter.java:34)
    at org.apache.lucene.analysis.snowball.SnowballFilter.next(SnowballFilter.java:64)
    at org.apache.lucene.index.DocInverterPerField.processFields(DocInverterPerField.java:134)
    at org.apache.lucene.index.DocFieldConsumersPerField.processFields(DocFieldConsumersPerField.java:36)
    at org.apache.lucene.index.DocFieldProcessorPerThread.processDocument(DocFieldProcessorPerThread.java:234)
    at org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:765)
    at org.apache.lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:743)
    at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1902)
    at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1880)
    at com.scalix.index.manager.BatchUpdater.performContentAdds(BatchUpdater.java:386)
    at com.scalix.index.manager.BatchUpdater.processMods(BatchUpdater.java:176)
    at com.scalix.index.manager.QueueManager.processQueue(QueueManager.java:134)
    at com.scalix.index.manager.QueueManager.run(QueueManager.java:81)
    at java.lang.Thread.run(Unknown Source)

We are using Lucene 2.4.  Any ideas what is happening?

Thanks!

- Chris

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42045-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 14:50:24 2009
Return-Path: <java-user-return-42045-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70850 invoked from network); 27 Aug 2009 14:50:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 14:50:24 -0000
Received: (qmail 53185 invoked by uid 500); 27 Aug 2009 14:50:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53108 invoked by uid 500); 27 Aug 2009 14:50:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 55816 invoked by uid 99); 27 Aug 2009 11:07:56 -0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of uboness@gmail.com designates 209.85.219.222 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:content-type
         :content-transfer-encoding;
        bh=7aoDziGR+kL4Ys2zQZWwbS3knWV0G/z9v0wwUM48dJ0=;
        b=nIXsqk1kP6wco3yuarLJi2jyRuB2di4bwxzDOjvved7/hRFHWcQdHYP6/KwNo/37q8
         Uoyr/GxDanHA3+LGx1kNexoJF/Nx7ju9rH/OYGU6YN2Sk5Juu3BGcf6f4OaeOK5NH4ME
         4aU4lT2bSymWJcZ5tuE7MBO4pELzvVf1cZe9I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :content-type:content-transfer-encoding;
        b=PwTXnVnKwaoERE0No8mRS08WHCW3L7wBopoQ2OBtqJVHE+uSIgE+PkRZ4296teUxZE
         kjWf33sfrn/pYSW19t6+J63JSomcvTz72IHLjhMUaEsLL4esG0+SspTrF5SIo96g4rhY
         vDk2RRvJh4uAu3e8k1X2PJqIhHmJmegfFkIKc=
Message-ID: <4A9668EA.1090605@gmail.com>
Date: Thu, 27 Aug 2009 13:07:22 +0200
From: Uri Boness <uboness@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: solr-user@lucene.apache.org, java-user@lucene.apache.org
Subject: Announcing Dutch Lucene User Group
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

We started a new Lucene user group in The Netherlands. In the last 
couple of years we've notice an increasing demand and interest in Lucene 
and Solr. We thought it's about time to have a centralize place where 
people can have open discussions, trainings, and periodic meet-ups to 
share knowledge and experience with relation to these technologies. The 
website is up and running and you're welcome to register (even if you're 
not living in The Netherlands - the content is in English :-)). Check 
out: http://www.lucene-nl.org

Cheers,
Uri

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42046-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 15:29:39 2009
Return-Path: <java-user-return-42046-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87216 invoked from network); 27 Aug 2009 15:29:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 15:29:39 -0000
Received: (qmail 6255 invoked by uid 500); 27 Aug 2009 15:29:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6196 invoked by uid 500); 27 Aug 2009 15:29:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6181 invoked by uid 99); 27 Aug 2009 15:29:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 15:29:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of tsuraan@gmail.com designates 209.85.221.198 as permitted sender)
Received: from [209.85.221.198] (HELO mail-qy0-f198.google.com) (209.85.221.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 15:29:28 +0000
Received: by qyk36 with SMTP id 36so707002qyk.22
        for <java-user@lucene.apache.org>; Thu, 27 Aug 2009 08:29:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=ZZwDo77z8o/cU+uVYwW0r0+2FHxcfD9E6jNGhrqXxcw=;
        b=xDH9QHaMPGeZGj4RnMYw9uiX1fHySYxs1Zbt1jWnxRTHQfeggHBWtn/13NEtrJZHNG
         w0gNHRqMRu1skf5juxz0p6cUBqg7njnPlgrthP1RKRCVheKOWpR0bAWcA9BibHzjuX6A
         pvrxiyUWTuZlbNzVrBHUf+g5hl8ZyAaF/xipI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=s041YmsDIq/MEDlqd8d1fNFHt67I3ZoxHcnFZFZCtZKzFLUfOjNWH9yEIBSczKh+OG
         WgS+Yp1lBSKY9b4v33xzpnTAjmcjl09J7P3mi+a//T6YNzj02TiDDYhOOu8NoBR81gPH
         lcJ5regOeyuYOOEFzC8XAR7mAqG87Kcvh3s4o=
MIME-Version: 1.0
Received: by 10.229.1.200 with SMTP id 8mr2999137qcg.64.1251386947701; Thu, 27 
	Aug 2009 08:29:07 -0700 (PDT)
In-Reply-To: <64F1818F-1ACD-4CAB-9A1B-F32483EDA2A3@gmail.com>
References: <84fb38e30908261458n1e365979p80a467f9ba77a65d@mail.gmail.com>
	 <64F1818F-1ACD-4CAB-9A1B-F32483EDA2A3@gmail.com>
Date: Thu, 27 Aug 2009 10:29:07 -0500
Message-ID: <84fb38e30908270829w69a57669m8d43c45789639218@mail.gmail.com>
Subject: Re: Lucene in Action Rev2
From: tsuraan <tsuraan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

> I've pinged Manning to get this corrected.  Thanks for the heads-up.
>
> 	Erik

No problem.  I'm about to order the beta book, and I'm looking forward
to the final copy.  Thanks for writing it :)

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42047-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 15:50:14 2009
Return-Path: <java-user-return-42047-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97899 invoked from network); 27 Aug 2009 15:50:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 15:50:13 -0000
Received: (qmail 42006 invoked by uid 500); 27 Aug 2009 15:50:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41934 invoked by uid 500); 27 Aug 2009 15:50:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41924 invoked by uid 99); 27 Aug 2009 15:50:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 15:50:11 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.223.200 as permitted sender)
Received: from [209.85.223.200] (HELO mail-iw0-f200.google.com) (209.85.223.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 15:50:00 +0000
Received: by iwn38 with SMTP id 38so606414iwn.29
        for <java-user@lucene.apache.org>; Thu, 27 Aug 2009 08:49:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=cYf8xUtM/ss9UhfZMs1SMlBCshEBABlZWIHLO/WJrxo=;
        b=dwaEQJlIK2tpC9ihacBysXSLlGkG0IyzkYpsZRiEyjX9JYxsKassgJfp3p7UhMx7Fm
         gTTyAFdoKykUg/XR4Rl1depjKVEoDhxVXXNUndo4QHW+K1qzHLd/6sohLozvgzuBeRlH
         bt1pGiswu8DjOurJaKhQ28a2cbcxjUad+ctJY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=CUTLvfcHCF0ufQuBVEyPFrplx86caSFlZ04vo2tvMz/FSFvAB0mzQNG7kdQ+m/90aZ
         rIqaG5r1OXaDb+O7SlWMIeSSGvY6JjHiRiDaITkskjLa9p6+CbYhrs/DcW2XqgqQWwlB
         fFmaQK5XWPAzaET/pnJc4cEEbhVC6rl+ibzps=
MIME-Version: 1.0
Received: by 10.231.6.79 with SMTP id 15mr199199iby.36.1251388177784; Thu, 27 
	Aug 2009 08:49:37 -0700 (PDT)
In-Reply-To: <895923651.19581251378658048.JavaMail.root@mail.uk.scalix.com>
References: <9ac0c6aa0908260626m5e2d8a32kbb40ae010f922e7c@mail.gmail.com>
	 <895923651.19581251378658048.JavaMail.root@mail.uk.scalix.com>
Date: Thu, 27 Aug 2009 11:49:37 -0400
Message-ID: <359a92830908270849n374130ebnf872d0d12e7f5828@mail.gmail.com>
Subject: Re: Lucene gobbling file descriptors
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151774123ed02fa2047221835a
X-Virus-Checked: Checked by ClamAV on apache.org

--00151774123ed02fa2047221835a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Note that for search speed reasons, you really, really want to share your
readers and NOT open/close for every request.
FWIW
Erick

On Thu, Aug 27, 2009 at 9:10 AM, Chris Bamford <Chris.Bamford@scalix.com>wrote:

> I'm glad its not normal.  That means we can fix it!  I will conduct a
> review of IndexReader/Searcher open/close ops.
>
> Thanks!
>
> Chris
>
> ----- Original Message -----
> From: Michael McCandless <lucene@mikemccandless.com>
> Sent: Wed, 26/8/2009 2:26pm
> To: java-user@lucene.apache.org
> Subject: Re: Lucene gobbling file descriptors
>
> This is not normal.  As long as you are certain you close every
> IndexReader/Searcher that you opened, the number of file descriptors
> should stay "contained".
>
> Though: how many files are there in your index directory?
>
> Mike
>
> On Wed, Aug 26, 2009 at 9:18 AM, Chris Bamford<Chris.Bamford@scalix.com>
> wrote:
> > Hi there,
> >
> > I wonder if someone can help?  We have a successful Lucene app deployed
> on Tomcat which works well.  As far as we can tell, our developers have
> observed all the guidelines in the Lucene FAQ, but on some of our
> installations, Tomcat eventually runs out of file descriptors and needs a
> restart to clear it.  We know Lucene is the culprit because use lsof -p
> <java PID> and the vast majority (usually tens of thousands) of files
> reported are Lucene index files.
> >
> > I am hoping to get some tips on how this can be avoided.  Is it simply
> the case that as time goes by, more and more descriptors are left open and
> no matter how high ulimit is set, you will run out?  Or is there a policy of
> recycling that we are failing to utilise properly?
> >
> > I am happy to provide more information, just don't know what at this
> point!  Please ask....
> >
> > Thanks in advance
> >
> > - Chris
> >
> > Chris Bamford
> > Senior Development Engineer
> > Scalix
> > chris.bamford@scalix.com
> > Tel: +44 (0)1344 381814
> > www.scalix.com
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00151774123ed02fa2047221835a--

From java-user-return-42048-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 16:00:25 2009
Return-Path: <java-user-return-42048-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2274 invoked from network); 27 Aug 2009 16:00:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 16:00:25 -0000
Received: (qmail 56900 invoked by uid 500); 27 Aug 2009 16:00:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56848 invoked by uid 500); 27 Aug 2009 16:00:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56838 invoked by uid 99); 27 Aug 2009 16:00:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 16:00:22 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [72.167.82.83] (HELO p3plsmtpa01-03.prod.phx3.secureserver.net) (72.167.82.83)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 27 Aug 2009 16:00:12 +0000
Received: (qmail 28730 invoked from network); 27 Aug 2009 15:59:49 -0000
Received: from unknown (81.219.54.251)
  by p3plsmtpa01-03.prod.phx3.secureserver.net (72.167.82.83) with ESMTP; 27 Aug 2009 15:59:48 -0000
Message-ID: <4A96AD6B.9060306@getopt.org>
Date: Thu, 27 Aug 2009 17:59:39 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene gobbling file descriptors
References: <9ac0c6aa0908260626m5e2d8a32kbb40ae010f922e7c@mail.gmail.com>	 <895923651.19581251378658048.JavaMail.root@mail.uk.scalix.com> <359a92830908270849n374130ebnf872d0d12e7f5828@mail.gmail.com>
In-Reply-To: <359a92830908270849n374130ebnf872d0d12e7f5828@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Erick Erickson wrote:
> Note that for search speed reasons, you really, really want to share your
> readers and NOT open/close for every request.
> FWIW
> Erick
> 
> On Thu, Aug 27, 2009 at 9:10 AM, Chris Bamford <Chris.Bamford@scalix.com>wrote:
> 
>> I'm glad its not normal.  That means we can fix it!  I will conduct a
>> review of IndexReader/Searcher open/close ops.

If you use Lucene 2.4.1 you can also use the LucidGaze to actually see 
how many IndexReader and IndexSearcher instances you have in your 
application when running.

See this link for downloads and docs:

http://www.lucidimagination.com/Downloads/LucidGaze-for-Lucene

-- 
Best regards,
Andrzej Bialecki     <><
  ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42049-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 20:25:23 2009
Return-Path: <java-user-return-42049-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32477 invoked from network); 27 Aug 2009 20:25:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 20:25:23 -0000
Received: (qmail 56834 invoked by uid 500); 27 Aug 2009 20:25:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56763 invoked by uid 500); 27 Aug 2009 20:25:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56753 invoked by uid 99); 27 Aug 2009 20:25:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 20:25:21 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 20:25:10 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MglWc-000592-2U
	for java-user@lucene.apache.org; Thu, 27 Aug 2009 13:24:50 -0700
Message-ID: <25179313.post@talk.nabble.com>
Date: Thu, 27 Aug 2009 13:24:50 -0700 (PDT)
From: javaguy44 <javaguy44@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene SORT does a sort on entire index..how do I filter SORT?
In-Reply-To: <85d3c3b60908211651y14ec4a11t7bc2769be22beb2@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: javaguy44@yahoo.com
References: <25080365.post@talk.nabble.com> <85d3c3b60908210953k25872bf3q894399bc546e1c27@mail.gmail.com> <25088699.post@talk.nabble.com> <85d3c3b60908211651y14ec4a11t7bc2769be22beb2@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Jason,

Thanks v much for your replies + help.

I got it - all is swell.

Thx again


Jason Rutherglen-2 wrote:
>=20
> Only the results from the query should be sorted. The field
> caches do get loaded for all values of a field though, is that
> what you're seeing?
>=20
> On Fri, Aug 21, 2009 at 4:09 PM, javaguy44<javaguy44@yahoo.com> wrote:
>>
>> Hi Jason,
>>
>> Thanks for the advice.
>>
>> However I was just working through the example. =C2=A0I actually don't w=
ant to
>> search on numbers / dates / geo etc and was looking at custom sorting.
>>
>> It appears that custom sorting, or even sorting for that matter is not
>> useful if every document will have sorting applied against it before the
>> document filter even hits.
>>
>> Is there no way to limit the sorting to only the documents that were
>> found
>> in the query?
>>
>> Thanks
>>
>>
>>
>> Jason Rutherglen-2 wrote:
>>>
>>> Take a look at contrib/spatial.
>>>
>>> On Fri, Aug 21, 2009 at 7:00 AM, javaguy44<javaguy44@yahoo.com> wrote:
>>>>
>>>> Hi,
>>>>
>>>> I'm currently looking at sorting in lucene, and to get started I took =
a
>>>> look
>>>> at the distance sorting example from the Lucene in Action book.
>>>>
>>>> Working through the test DistanceSortingTest, I've noticed that
>>>> performing
>>>> the SORT ends up sorting the whole index!
>>>>
>>>> To test this I did the following:
>>>> =C2=A0- added a few more lines in setup()
>>>> =C2=A0 =C2=A0addPoint(writer, "Nico's Fish Shop", "fishmongerie", 10, =
10);
>>>> =C2=A0 =C2=A0addPoint(writer, "Nico's Fish Shop deux", "fishmongerie",=
 10, 10);
>>>>
>>>> =C2=A0- I added a log statement to DistanceComparatorSource in the
>>>> while(termDocs.next()) loop
>>>> =C2=A0- I ran DistanceSortingTest.testNearesRestaurantToHome and to my
>>>> surprise I
>>>> had 6 sorts / log lines of output in while(termDocs.next()) loop
>>>>
>>>> DistanceSortingTest.testNearesRestaurantToHome searches by the query
>>>> term
>>>> new TermQuery(new Term("type", "restaurant")). =C2=A0As such shouldn't=
 the
>>>> index
>>>> be filtered first (to 4 documents) before the DistanceSort occurs?
>>>>
>>>> Obviously this is not ideal in a million+ document index and assuming
>>>> you
>>>> had 100, 200 records that were hit based on the term.
>>>>
>>>> Would appreciate someone's input / advice on how to filter first
>>>> --
>>>> View this message in context:
>>>> http://www.nabble.com/Lucene-SORT-does-a-sort-on-entire-index..how-do-=
I-filter-SORT--tp25080365p25080365.html
>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Lucene-SORT-does-a-sort-on-entire-index..how-do-I-=
filter-SORT--tp25080365p25088699.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Lucene-SORT-does-a-sort=
-on-entire-index..how-do-I-filter-SORT--tp25080365p25179313.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42050-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 22:18:28 2009
Return-Path: <java-user-return-42050-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80878 invoked from network); 27 Aug 2009 22:18:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 22:18:28 -0000
Received: (qmail 80265 invoked by uid 500); 27 Aug 2009 22:18:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80171 invoked by uid 500); 27 Aug 2009 22:18:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80161 invoked by uid 99); 27 Aug 2009 22:18:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 22:18:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.217.216 as permitted sender)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 22:18:16 +0000
Received: by gxk12 with SMTP id 12so1954075gxk.4
        for <java-user@lucene.apache.org>; Thu, 27 Aug 2009 15:17:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:reply-to
         :organization:user-agent:mime-version:to:subject:x-enigmail-version
         :content-type:content-transfer-encoding;
        bh=w+2UoqNwvGjV6/BuPfr0HB3WUqQmmcUgBybSRkFPozo=;
        b=vFDh3q7AGOAt0RF3eQ44KP9Ijw7mbPuN2QNyk75iW18jwfHMdYxKsVturNT5cTTNvf
         dx98sacQg90cdKF5zturWZ4QgGqXryt89Hv9/Y2J35F7N7J2jdbVHy5FRF8ux6ZUOJ4n
         ORwQWe/6RUZKWQPZgegR8wzOzE0/oiC3jcSUs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:reply-to:organization:user-agent:mime-version
         :to:subject:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=ryO/H4SyItko3riBHo4nga3hc5wOovg4mj6Mj2lPVaEj+hsecB4WxmQFvfwHae56Tb
         Vs6DJiFZ4qdkLmJfx24KTeeHy7kGCHQhmnM4azk+Kz54+j3r7Y6CTW5Fun4lzy5ad5r0
         DvJI80rV5ioaW75hXdJUMnzh6i7/Gs+96Xol8=
Received: by 10.90.127.20 with SMTP id z20mr273796agc.118.1251411475155;
        Thu, 27 Aug 2009 15:17:55 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 9sm659704agb.29.2009.08.27.15.17.54
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 27 Aug 2009 15:17:54 -0700 (PDT)
Message-ID: <4A970612.1060409@apache.org>
Date: Thu, 27 Aug 2009 18:17:54 -0400
From: Mark Miller <markrmiller@gmail.com>
Reply-To: markrmiller@apache.org
Organization: Apache
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene 2.9 RC1 now available for testing
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello Lucene users,

On behalf of the Lucene dev community (a growing community far larger
than just the committers) I would like to announce the first release
candidate for Lucene 2.9.

Please download and check it out – take it for a spin and kick the
tires. If all goes well, we hope to release the final version of
Lucene 2.9 in a little over a week.

While we generally try and maintain full backwards compatibility
between major versions, Lucene 2.9 has a variety of breaks that are
spelled out in the 'Changes in backwards compatibility policy' section
of CHANGES.txt.

We recommend that you recompile your application with Lucene 2.9
rather than attempting to “drop” it in. This will alert you to any
issues you may have to fix if you are affected by one of the backward
compatibility breaks. As always, its a really good idea to thoroughly
read CHANGES.txt before upgrading. Also, remember that this is a
release candidate, and not the final Lucene 2.9 release.

Lucene 2.9 comes with a bevy of new features, including:

  Per segment searching and caching (can lead to much faster reopen
among other things)

  Near real-time search capabilities added to IndexWriter

  New queries, including NumericRangeQuery and NumericRangeFilter –
fast, highly scalable alternatives to RangeQuery/RangeFilter for
numeric searches.

  Smarter, more scalable multi-term queries (wildcard, range, etc)

  A freshly optimized Collector/Scorer API

  Improved Unicode support

  A new Attribute based TokenStream API

  A new QueryParser framework in contrib with a core QueryParser
replacement impl included.

  ….

And many, many more features, bug fixes, optimizations, and various
improvements. You can find the full list of changes here:

HTML version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/Changes.html

Text version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/CHANGES.txt

Many changes have also occurred in Lucene's contrib area:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/contrib/CHANGES.txt

Download release candidate 1 here:
http://people.apache.org/~markrmiller/staging-area/lucene2.9rc1/

Be sure to report back with any issues you find!

Thanks,

Mark Miller
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAkqXBhIACgkQ0DU3IV7ywDkucwCeN1zMAxC+YBULKKvCU8o7NV//
IkEAnApyVNUwtP0LLymss1bO22D3v4A9
=a9VM
-----END PGP SIGNATURE-----


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42051-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Aug 27 23:29:39 2009
Return-Path: <java-user-return-42051-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2522 invoked from network); 27 Aug 2009 23:29:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Aug 2009 23:29:39 -0000
Received: (qmail 30593 invoked by uid 500); 27 Aug 2009 23:29:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30516 invoked by uid 500); 27 Aug 2009 23:29:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30506 invoked by uid 99); 27 Aug 2009 23:29:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 23:29:37 +0000
X-ASF-Spam-Status: No, hits=2.1 required=10.0
	tests=DNS_FROM_RFC_BOGUSMX,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of micah@affinitycircles.com designates 207.7.158.80 as permitted sender)
Received: from [207.7.158.80] (HELO boom.affinityengines.com) (207.7.158.80)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Aug 2009 23:29:27 +0000
Received: from shiny.affinitycircles.local (h-64-105-88-158.affinitycircles.com [64.105.88.158])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(Client did not present a certificate)
	by boom.affinityengines.com (Postfix) with ESMTP id 5BD8E2B32A3
	for <java-user@lucene.apache.org>; Thu, 27 Aug 2009 16:29:06 -0700 (PDT)
Message-Id: <ECFC6E3B-80AF-4F6C-9B21-F77DDAE4580C@affinitycircles.com>
From: Micah Jaffe <micah@affinitycircles.com>
To: java-user@lucene.apache.org
In-Reply-To: <85d3c3b60908181033t225098b3m83b6ce228ee3a36f@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Bizarre indexing issue where thousands of files get created
Date: Thu, 27 Aug 2009 16:29:05 -0700
References: <13A42DBE-C3BA-4B77-B41A-946B960C05C7@affinitycircles.com> <9ac0c6aa0908180435u44806ab7nefe92b6f028c2b3a@mail.gmail.com> <B43F6D24-083E-4EF7-A63D-68CFA93661F7@affinitycircles.com> <85d3c3b60908181033t225098b3m83b6ce228ee3a36f@mail.gmail.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Unfortunately, there's no concise summarization of the code to post.

As a follow-up to the situation, after throwing more RAM at the  
problem (from 2GB to 10GB of process space) we no longer see OOM  
errors and also no longer see the IndexWriter create thousands of  
files; the OOM error did appear to be causally related to the  
thousands of files problem.

I'll post more info if I ever sleuth anything more out of it.

-Micah

On Aug 18, 2009, at 10:33 AM, Jason Rutherglen wrote:

> Micah,
>
> If you can post some of your code, it may be easier to identify the
> problem you're experiencing.
>
> -J
>
> On Tue, Aug 18, 2009 at 9:55 AM, Micah  
> Jaffe<micah@affinitycircles.com> wrote:
>> Hi, thanks for the response!  The (custom) searchers that are  
>> falling out of
>> cache are indeed calling close on their IndexReader in finalize();  
>> they are
>> not calling close on themselves as that appears to be a no-op when  
>> creating
>> an IndexSearcher with a reader.  The searchers are just extended
>> IndexSearchers which have notion of their lifetime and are only  
>> built with
>> IndexReaders.
>>
>> The OOM does appear to be a symptom of reopening an IndexWriter, I  
>> haven't
>> seen an OOM originate from the IndexWriter.  Here's a partial stack  
>> trace
>> (fyi, we are closing the old reader following the pattern of "if  
>> the fresh
>> reader != old reader"):
>>
>> java.lang.OutOfMemoryError: Java heap space at
>> org 
>> .apache 
>> .lucene.index.MultiSegmentReader.<init>(MultiSegmentReader.java:160)
>> at
>> org 
>> .apache 
>> .lucene.index.MultiSegmentReader.doReopen(MultiSegmentReader.java: 
>> 203)
>> at
>> org.apache.lucene.index.DirectoryIndexReader 
>> $2.doBody(DirectoryIndexReader.java:98)
>> at
>> org.apache.lucene.index.SegmentInfos 
>> $FindSegmentsFile.run(SegmentInfos.java:636)
>> at
>> org 
>> .apache 
>> .lucene.index.DirectoryIndexReader.reopen(DirectoryIndexReader.java: 
>> 92)
>> [... many more lines of our server code and Tomcat stack ...]
>> What I don't have visibility to right now is what a IndexWriter(s)  
>> might be
>> up to at that point, nor which index just exploded the memory.
>> Everything  I've read about trying to handle OOMs in Java is "be  
>> careful,
>> but you're likely screwed", so I'm unsure if I should try to  
>> capture the
>> error and mop up what I can or if that will just cause more  
>> problems.  On
>> indexes that have the large number of files problem, it appears the  
>> next
>> time an IndexWriter is opened on that index in a new process (after  
>> the
>> write.lock is nuked post shut-down), it collapses the files back  
>> down to a
>> sane number (at close() maybe?).
>> I'll see if I can work in the infoStream suggestion, thanks...
>> -Micah
>> On Aug 18, 2009, at 4:35 AM, Michael McCandless wrote:
>>
>>> Are you .close()ing your IndexReaders when they fall out of the  
>>> MRU cache?
>>>
>>> Seems like there are two problems... 1) why are you hitting OOMEs?
>>> Seems likely you're just doing too much at once.... can you ask the
>>> JRE to get you a heap dump when it hits OOME?
>>>
>>> 2) Why is IndexWriter creating zillions of tiny files?  This one is
>>> a.... does the OOME pass through IndexWriter?  If you turn on
>>> infoStream in your writer, get the problem to happen, and post back
>>> the resulting output, it'll give us a better idea what's going on.
>>> Could you also post a representative subset of these 200K filenames?
>>> It sounds like somehow IndexWriter is getting stuck into a state  
>>> where
>>> it thinks it must flush segments far too frequently.
>>>
>>> Mike
>>>
>>> On Mon, Aug 17, 2009 at 9:31 PM, Micah Jaffe<micah@affinitycircles.com 
>>> >
>>> wrote:
>>>>
>>>> The Problem: periodically we see thousands of files get created  
>>>> from an
>>>> IndexWriter in a Java process in a very short period of time.   
>>>> Since we
>>>> started trying to track this, we saw an index go from ~25 files  
>>>> to over
>>>> 200K
>>>> files in about a half hour.
>>>>
>>>> The Context: a hand-rolled, all-in-one Lucene server (2.3.2  
>>>> codebase)
>>>> that
>>>> can respond to searches and perform index updates, running under  
>>>> Tomcat,
>>>> on
>>>> Java 1.6 on 32-bit Linux using 2GB of memory, reading/writing to  
>>>> local
>>>> disk.
>>>>  This is a threaded environment where we're serving about 15-20/ 
>>>> requests
>>>> a
>>>> second (mostly searches, with a 10:1 search/update ratio).  We  
>>>> wrap all
>>>> of
>>>> the update code around IndexWriter to make sure all threads are  
>>>> only ever
>>>> using one writer and never close an actively used writer.  We  
>>>> cache about
>>>> 40
>>>> IndexSearchers (really IndexReaders) using an MRU cache and leave  
>>>> it to
>>>> Java
>>>> to garbage collect those that leave scope.  We can potentially  
>>>> serve ~150
>>>> different search indexes, most with document count under 1  
>>>> million, with
>>>> fairly sparsely populated fields and under about 100 fields.  We  
>>>> do not
>>>> store a lot of information in any index, generally just IDs that  
>>>> we then
>>>> use
>>>> for DB look-ups.  Our biggest index is about 7GB on disk and  
>>>> comprises
>>>> roughly 18 million records and is almost always in use (either  
>>>> searched
>>>> or
>>>> updated).  We sometimes go days without seeing the The Problem  
>>>> and we've
>>>> seen it happen twice in the span of 4 hours.
>>>>
>>>> Accompanying Symptom: we see an OOM error where we do not have  
>>>> enough
>>>> heap
>>>> space.  I'm not sure if the explosion of files triggers or  
>>>> results from
>>>> the
>>>> error.  This is the only error we see accompanying the problem;
>>>> performance
>>>> and memory usage seem fine up to the OOM error.
>>>>
>>>> Current Workaround: taking the same server to a 64-bit machine and
>>>> throwing
>>>> 10GB of RAM at it seems (4 days counting now) to have "solved" the
>>>> problem.
>>>>
>>>> What I'd really like is to understand the underlying problem, and  
>>>> we have
>>>> some theories, but before charging down one way or another I was  
>>>> hoping
>>>> to
>>>> get an idea if a) people have seen something similar before and  
>>>> b) what
>>>> they
>>>> did.  Our theories:
>>>> - Opening IndexReaders faster than Java can garbage collect those  
>>>> that
>>>> are
>>>> out of scope.  We do know that too many open readers (e.g. around  
>>>> 100 of
>>>> our
>>>> indexes) can exhaust memory.  This scenario seems unlikely given  
>>>> our
>>>> usage;
>>>> we have 2-3 heavily used indexes and very light usage on the  
>>>> rest.  That
>>>> said, the with some recent code changes we decided to rely on  
>>>> garbage
>>>> collection to fix another bug (race condition where a searcher  
>>>> was being
>>>> used as it was being closed).
>>>> - Hit a race condition with IndexWriter, with our code or in this  
>>>> version
>>>> of
>>>> the library, and it goes nuts.
>>>> - Particular heavy-duty search/update hits, e.g. potentially  
>>>> iterating
>>>> across all documents (not likely) or updating a large number of  
>>>> documents
>>>> in
>>>> an index (more likely).
>>>>
>>>> Really scientific, I know, but I'd welcome any discussion that  
>>>> involves
>>>> juggling Java heap (what do you do with your OOMs?), our particular
>>>> problem
>>>> or a threaded environment using Lucene (like Solr).
>>>>
>>>> thanks!
>>>> Micah
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42052-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 05:26:57 2009
Return-Path: <java-user-return-42052-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9147 invoked from network); 28 Aug 2009 05:26:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 05:26:57 -0000
Received: (qmail 74766 invoked by uid 500); 28 Aug 2009 05:26:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74675 invoked by uid 500); 28 Aug 2009 05:26:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74647 invoked by uid 99); 28 Aug 2009 05:26:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 05:26:54 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=MSGID_MULTIPLE_AT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [64.13.253.17] (HELO guavus.com) (64.13.253.17)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 05:26:42 +0000
Received: (qmail 7922 invoked from network); 27 Aug 2009 22:26:20 -0700
Received: from isp-net67.spectranet.com (HELO station151) (@125.63.71.67)
  by guavus.com with SMTP; 27 Aug 2009 22:26:19 -0700
From: "Sumanta Bhowmik" <sumanta.bhowmik@guavus.com>
To: <java-user@lucene.apache.org>
Cc: <lucene@mikemccandless.com>
References: <-61520930041827677@unknownmsgid>	 <9ac0c6aa0908200237kcb7d0f3q73d37b5fdec27f2d@mail.gmail.com>	 <-3936163573164025315@unknownmsgid>	 <9ac0c6aa0908210413w92a8280rd8a1d9deb0548bb8@mail.gmail.com>	 <4608543773190021384@unknownmsgid> <9ac0c6aa0908270200l6064dc0fgdce08d0501441db0@mail.gmail.com>
In-Reply-To: <9ac0c6aa0908270200l6064dc0fgdce08d0501441db0@mail.gmail.com>
Subject: RE: Merge Exception in Lucene 2.4
Date: Fri, 28 Aug 2009 10:56:11 +0530
Message-ID: <01f401ca27a0$130a4050$391ec0f0$@bhowmik@guavus.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: Acom9OpnOBKBpGsZTrqEOTG+LE6maQApB9YA
Content-Language: en-us
X-Virus-Checked: Checked by ClamAV on apache.org

Hi

I am not sure if the -Xint option works as the performance goes down =
like
anything. Since I am indexing streaming data -Xint is not an option. Is =
it
possible that we do the merge synchronously so that I can catch the
exception, clean the index and start afresh. Even if it is asynchronous =
if
there is a way to know the status of the merge operation?

Sumanta

-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: Thursday, August 27, 2009 2:30 PM
To: Sumanta Bhowmik
Cc: java-user@lucene.apache.org
Subject: Re: Merge Exception in Lucene 2.4

Was this a smallish contained test case?  Can you post the sources?

Can you run your next test with IndexWriter's infoStream turned on,
and post the resluting output?

Was this with jdk1.6u16?  That version fixes the original hotspot bug
from LUCENE-1282... (and your exception looks different from the one
in LUCENE-1282).

Mike

On Thu, Aug 27, 2009 at 12:46 AM, Sumanta
Bhowmik<sumanta.bhowmik@guavus.com> wrote:
> Hi
>
> I ran a long running test and now got this exception.
>
> Exception in thread "Lucene Merge Thread #39"
> org.apache.lucene.index.MergePolicy$MergeException: =
java.io.IOException:
> read past EOF
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
> rentMergeScheduler.java:309)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
> ergeScheduler.java:286)
> Caused by: java.io.IOException: read past EOF
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java=
:15
> 1)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.ja=
va:
> 38)
> =A0 =A0 =A0 =A0at =
org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.SegmentTermPositions.readDeltaPosition(SegmentTer=
mPo
> sitions.java:73)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.SegmentTermPositions.nextPosition(SegmentTermPosi=
tio
> ns.java:69)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:6=
67)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:58=
6)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:5=
47)
> =A0 =A0 =A0 =A0at
> =
org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:500)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:140)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4226)
> =A0 =A0 =A0 =A0at =
org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3877)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
> duler.java:205)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
> ergeScheduler.java:260)
>
>
>
> I am running it on Linux version 2.6.26-79.fc9 , gcc version 4.1.2
20071124
> (Red Hat 4.1.2-42)
>
> This exception occurs after we have indexed more than 100 gb of data. =
I
will
> try running with -Xint to see if I can avoid this exception.
>
> Regards
> Sumanta
>
> -----Original Message-----
> From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]
> Sent: Monday, August 24, 2009 1:10 PM
> To: java-user@lucene.apache.org
> Subject: RE: Merge Exception in Lucene 2.4
>
> I will be running a long running test with jdk1.6u16. If the problem =
still
> appears I will try to create a test case to show the issue.
>
> Sumanta
>
> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: Friday, August 21, 2009 4:44 PM
> To: java-user@lucene.apache.org
> Subject: Re: Merge Exception in Lucene 2.4
>
> That code looks fine...
>
> What OS/filesystem are you using?
>
> Can you make a small test case that shows the issue?
>
> Mike
>
> On Thu, Aug 20, 2009 at 7:41 AM, Sumanta
> Bhowmik<sumanta.bhowmik@guavus.com> wrote:
>> We put all the IndexWriters in an array which is defined by
>>
>> final Directory[] finalDir;
>>
>> We also declare an indexer
>> As
>> private volatile static Indexer indexer;
>>
>> final Indexer finalIndexer =3D indexer;
>>
>> Next we call the merge in a new thread :
>>
>> Thread thread =3D new Thread(){
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public void run()
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.debug("starts merging w/o
>> optimization");
>>
>> finalIndexer.getWriter().addIndexesNoOptimize(finalDir);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.debug("ends merging w/o
>> optimization");
>>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} =
catch (CorruptIndexException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.notice("",e);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} =
catch (IOException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.notice("",e);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0}
>> }
>>
>> Sumanta
>>
>>
>>
>>
>> -----Original Message-----
>> From: Michael McCandless [mailto:lucene@mikemccandless.com]
>> Sent: Thursday, August 20, 2009 3:07 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: Merge Exception in Lucene 2.4
>>
>> You should definitely upgrade to the latest JDK 1.6 to get the fix =
for
>> the JRE bug in LUCENE-1282, but, I don't think you are hitting that
>> bug (read past EOF during merge is a different exception).
>>
>> Can you describe more detail on how you merge 6 IndexWriters?
>>
>> Mike
>>
>> On Thu, Aug 20, 2009 at 5:21 AM, Sumanta
>> Bhowmik<sumanta.bhowmik@guavus.com> wrote:
>>> I checked at http://issues.apache.org/jira/browse/LUCENE-1282
>>> SegmentMerger.java has this code
>>>
>>> TermFreqVector[] vectors =3D reader.getTermFreqVectors(docNum);
>>> termVectorsWriter.addAllDocVectors(vectors);
>>>
>>> so this issue appears inspite of this fix.
>>>
>>> I am using java version "1.6.0_07". Is it fixed in jdk6u10 and above
>>> (http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=3D6707044) ?
>>>
>>> Regards
>>> Sumanta
>>>
>>>
>>> -----Original Message-----
>>> From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]
>>> Sent: Thursday, August 20, 2009 1:15 PM
>>> To: java-user@lucene.apache.org
>>> Subject: Merge Exception in Lucene 2.4
>>>
>>> Hi
>>>
>>>
>>>
>>> I am getting this issue in Lucene2.4 when I try to merge multiple
>>> IndexWriters(generally 6)
>>>
>>>
>>>
>>> sh-3.2# Exception in thread "Lucene Merge Thread #5"
>>> org.apache.lucene.index.MergePolicy$MergeException: =
java.io.IOException:
>>> read past EOF
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
>>> rentMergeScheduler.java:309)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>>> ergeScheduler.java:286)
>>>
>>> Caused by: java.io.IOException: read past EOF
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.j=
ava
>>> :135)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.ja=
va:
>>> 228)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:=
184
>>> )
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.ja=
va:
>>> 204)
>>>
>>> =A0 =A0 =A0 =A0at
>>> =
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4260)
>>>
>>> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3877)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
>>> duler.java:205)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>>> ergeScheduler.java:260)
>>>
>>>
>>>
>>>
>>>
>>> Is this a known issue and has any fix been provided for it ? Would
>>> appreciate any help.
>>>
>>>
>>>
>>> Regards
>>>
>>> Sumanta
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> __________ NOD32 4349 (20090819) Information __________
>>>
>>> This message was checked by NOD32 antivirus system.
>>> http://www.eset.com
>>>
>>>
>>>
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> __________ NOD32 4350 (20090820) Information __________
>>
>> This message was checked by NOD32 antivirus system.
>> http://www.eset.com
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> __________ NOD32 4354 (20090821) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> __________ NOD32 4361 (20090823) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


__________ NOD32 4371 (20090826) Information __________

This message was checked by NOD32 antivirus system.
http://www.eset.com



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42053-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 07:39:12 2009
Return-Path: <java-user-return-42053-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71107 invoked from network); 28 Aug 2009 07:39:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 07:39:11 -0000
Received: (qmail 95251 invoked by uid 500); 28 Aug 2009 07:39:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95188 invoked by uid 500); 28 Aug 2009 07:39:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95178 invoked by uid 99); 28 Aug 2009 07:39:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 07:39:09 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=MSGID_MULTIPLE_AT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [64.13.253.17] (HELO guavus.com) (64.13.253.17)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 07:38:57 +0000
Received: (qmail 9485 invoked from network); 28 Aug 2009 00:38:35 -0700
Received: from isp-net67.spectranet.com (HELO station151) (@125.63.71.67)
  by guavus.com with SMTP; 28 Aug 2009 00:38:34 -0700
From: "Sumanta Bhowmik" <sumanta.bhowmik@guavus.com>
To: <java-user@lucene.apache.org>
Cc: <lucene@mikemccandless.com>
References: <-61520930041827677@unknownmsgid>	 <9ac0c6aa0908200237kcb7d0f3q73d37b5fdec27f2d@mail.gmail.com>	 <-3936163573164025315@unknownmsgid>	 <9ac0c6aa0908210413w92a8280rd8a1d9deb0548bb8@mail.gmail.com>	 <4608543773190021384@unknownmsgid> <9ac0c6aa0908270200l6064dc0fgdce08d0501441db0@mail.gmail.com> <01f401ca27a0$130a4050$391ec0f0$@bhowmik@guavus.com>
In-Reply-To: <01f401ca27a0$130a4050$391ec0f0$@bhowmik@guavus.com>
Subject: RE: Merge Exception in Lucene 2.4
Date: Fri, 28 Aug 2009 13:08:23 +0530
Message-ID: <01fb01ca27b2$8cdaec60$a690c520$@bhowmik@guavus.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: Acom9OpnOBKBpGsZTrqEOTG+LE6maQApB9YAAAZTL1A=
Content-Language: en-us
X-Virus-Checked: Checked by ClamAV on apache.org

Hi

Since merging is done in separate threads, I am actually firing multiple
merges concurrently. That may be causing the problem. Is it possible to =
make
merges a synchronous  operation?

Sumanta

-----Original Message-----
From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]=20
Sent: Friday, August 28, 2009 10:56 AM
To: java-user@lucene.apache.org
Cc: lucene@mikemccandless.com
Subject: RE: Merge Exception in Lucene 2.4

Hi

I am not sure if the -Xint option works as the performance goes down =
like
anything. Since I am indexing streaming data -Xint is not an option. Is =
it
possible that we do the merge synchronously so that I can catch the
exception, clean the index and start afresh. Even if it is asynchronous =
if
there is a way to know the status of the merge operation?

Sumanta

-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: Thursday, August 27, 2009 2:30 PM
To: Sumanta Bhowmik
Cc: java-user@lucene.apache.org
Subject: Re: Merge Exception in Lucene 2.4

Was this a smallish contained test case?  Can you post the sources?

Can you run your next test with IndexWriter's infoStream turned on,
and post the resluting output?

Was this with jdk1.6u16?  That version fixes the original hotspot bug
from LUCENE-1282... (and your exception looks different from the one
in LUCENE-1282).

Mike

On Thu, Aug 27, 2009 at 12:46 AM, Sumanta
Bhowmik<sumanta.bhowmik@guavus.com> wrote:
> Hi
>
> I ran a long running test and now got this exception.
>
> Exception in thread "Lucene Merge Thread #39"
> org.apache.lucene.index.MergePolicy$MergeException: =
java.io.IOException:
> read past EOF
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
> rentMergeScheduler.java:309)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
> ergeScheduler.java:286)
> Caused by: java.io.IOException: read past EOF
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java=
:15
> 1)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.ja=
va:
> 38)
> =A0 =A0 =A0 =A0at =
org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.SegmentTermPositions.readDeltaPosition(SegmentTer=
mPo
> sitions.java:73)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.SegmentTermPositions.nextPosition(SegmentTermPosi=
tio
> ns.java:69)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:6=
67)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:58=
6)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:5=
47)
> =A0 =A0 =A0 =A0at
> =
org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:500)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:140)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4226)
> =A0 =A0 =A0 =A0at =
org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3877)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
> duler.java:205)
> =A0 =A0 =A0 =A0at
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
> ergeScheduler.java:260)
>
>
>
> I am running it on Linux version 2.6.26-79.fc9 , gcc version 4.1.2
20071124
> (Red Hat 4.1.2-42)
>
> This exception occurs after we have indexed more than 100 gb of data. =
I
will
> try running with -Xint to see if I can avoid this exception.
>
> Regards
> Sumanta
>
> -----Original Message-----
> From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]
> Sent: Monday, August 24, 2009 1:10 PM
> To: java-user@lucene.apache.org
> Subject: RE: Merge Exception in Lucene 2.4
>
> I will be running a long running test with jdk1.6u16. If the problem =
still
> appears I will try to create a test case to show the issue.
>
> Sumanta
>
> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: Friday, August 21, 2009 4:44 PM
> To: java-user@lucene.apache.org
> Subject: Re: Merge Exception in Lucene 2.4
>
> That code looks fine...
>
> What OS/filesystem are you using?
>
> Can you make a small test case that shows the issue?
>
> Mike
>
> On Thu, Aug 20, 2009 at 7:41 AM, Sumanta
> Bhowmik<sumanta.bhowmik@guavus.com> wrote:
>> We put all the IndexWriters in an array which is defined by
>>
>> final Directory[] finalDir;
>>
>> We also declare an indexer
>> As
>> private volatile static Indexer indexer;
>>
>> final Indexer finalIndexer =3D indexer;
>>
>> Next we call the merge in a new thread :
>>
>> Thread thread =3D new Thread(){
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0public void run()
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0{
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.debug("starts merging w/o
>> optimization");
>>
>> finalIndexer.getWriter().addIndexesNoOptimize(finalDir);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.debug("ends merging w/o
>> optimization");
>>
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} =
catch (CorruptIndexException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.notice("",e);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} =
catch (IOException e) {
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0logger.notice("",e);
>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>>
>> =A0 =A0 =A0 =A0}
>> }
>>
>> Sumanta
>>
>>
>>
>>
>> -----Original Message-----
>> From: Michael McCandless [mailto:lucene@mikemccandless.com]
>> Sent: Thursday, August 20, 2009 3:07 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: Merge Exception in Lucene 2.4
>>
>> You should definitely upgrade to the latest JDK 1.6 to get the fix =
for
>> the JRE bug in LUCENE-1282, but, I don't think you are hitting that
>> bug (read past EOF during merge is a different exception).
>>
>> Can you describe more detail on how you merge 6 IndexWriters?
>>
>> Mike
>>
>> On Thu, Aug 20, 2009 at 5:21 AM, Sumanta
>> Bhowmik<sumanta.bhowmik@guavus.com> wrote:
>>> I checked at http://issues.apache.org/jira/browse/LUCENE-1282
>>> SegmentMerger.java has this code
>>>
>>> TermFreqVector[] vectors =3D reader.getTermFreqVectors(docNum);
>>> termVectorsWriter.addAllDocVectors(vectors);
>>>
>>> so this issue appears inspite of this fix.
>>>
>>> I am using java version "1.6.0_07". Is it fixed in jdk6u10 and above
>>> (http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=3D6707044) ?
>>>
>>> Regards
>>> Sumanta
>>>
>>>
>>> -----Original Message-----
>>> From: Sumanta Bhowmik [mailto:sumanta.bhowmik@guavus.com]
>>> Sent: Thursday, August 20, 2009 1:15 PM
>>> To: java-user@lucene.apache.org
>>> Subject: Merge Exception in Lucene 2.4
>>>
>>> Hi
>>>
>>>
>>>
>>> I am getting this issue in Lucene2.4 when I try to merge multiple
>>> IndexWriters(generally 6)
>>>
>>>
>>>
>>> sh-3.2# Exception in thread "Lucene Merge Thread #5"
>>> org.apache.lucene.index.MergePolicy$MergeException: =
java.io.IOException:
>>> read past EOF
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
cur
>>> rentMergeScheduler.java:309)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>>> ergeScheduler.java:286)
>>>
>>> Caused by: java.io.IOException: read past EOF
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.j=
ava
>>> :135)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.ja=
va:
>>> 228)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:=
184
>>> )
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.ja=
va:
>>> 204)
>>>
>>> =A0 =A0 =A0 =A0at
>>> =
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4260)
>>>
>>> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3877)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
che
>>> duler.java:205)
>>>
>>> =A0 =A0 =A0 =A0at
>>>
>>
>
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntM
>>> ergeScheduler.java:260)
>>>
>>>
>>>
>>>
>>>
>>> Is this a known issue and has any fix been provided for it ? Would
>>> appreciate any help.
>>>
>>>
>>>
>>> Regards
>>>
>>> Sumanta
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> __________ NOD32 4349 (20090819) Information __________
>>>
>>> This message was checked by NOD32 antivirus system.
>>> http://www.eset.com
>>>
>>>
>>>
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> __________ NOD32 4350 (20090820) Information __________
>>
>> This message was checked by NOD32 antivirus system.
>> http://www.eset.com
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> __________ NOD32 4354 (20090821) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> __________ NOD32 4361 (20090823) Information __________
>
> This message was checked by NOD32 antivirus system.
> http://www.eset.com
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


__________ NOD32 4371 (20090826) Information __________

This message was checked by NOD32 antivirus system.
http://www.eset.com



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


__________ NOD32 4375 (20090827) Information __________

This message was checked by NOD32 antivirus system.
http://www.eset.com



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42056-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 16:44:31 2009
Return-Path: <java-user-return-42056-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90364 invoked from network); 28 Aug 2009 12:26:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 12:26:48 -0000
Received: (qmail 78474 invoked by uid 500); 28 Aug 2009 12:26:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78391 invoked by uid 500); 28 Aug 2009 12:26:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78381 invoked by uid 99); 28 Aug 2009 12:26:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 12:26:46 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.202] (HELO spunkymail-a4.g.dreamhost.com) (208.97.132.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 12:26:36 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a4.g.dreamhost.com (Postfix) with ESMTP id B12053B9BA
	for <java-user@lucene.apache.org>; Fri, 28 Aug 2009 05:26:15 -0700 (PDT)
Message-Id: <E17F2B23-01EA-49ED-990E-2EF6074966EC@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <1631401208.19651251382291503.JavaMail.root@mail.uk.scalix.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: New "Stream closed" exception with Java 6
Date: Fri, 28 Aug 2009 08:26:15 -0400
References: <1631401208.19651251382291503.JavaMail.root@mail.uk.scalix.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Are there any log messages around that spot?  Did something happen to  
the underlying Reader you are using?  Can you share that little bit of  
indexing code?

On Aug 27, 2009, at 10:11 AM, Chris Bamford wrote:

> Hi,
>
> Since moving our app to Java 6 and Tomcat 6, we have started getting  
> occasional exceptions of the form:
>
> java.io.IOException: Stream closed
>    at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
>    at sun.nio.cs.StreamDecoder.read(Unknown Source)
>    at java.io.InputStreamReader.read(Unknown Source)
>    at  
> org 
> .apache 
> .lucene 
> .analysis 
> .standard.StandardTokenizerImpl.zzRefill(StandardTokenizerImpl.java: 
> 443)
>    at  
> org 
> .apache 
> .lucene 
> .analysis 
> .standard 
> .StandardTokenizerImpl.getNextToken(StandardTokenizerImpl.java:629)
>    at  
> org 
> .apache 
> .lucene 
> .analysis.standard.StandardTokenizer.next(StandardTokenizer.java:140)
>    at  
> org 
> .apache 
> .lucene.analysis.standard.StandardFilter.next(StandardFilter.java:43)
>    at  
> org.apache.lucene.analysis.LowerCaseFilter.next(LowerCaseFilter.java: 
> 34)
>    at  
> org 
> .apache 
> .lucene.analysis.snowball.SnowballFilter.next(SnowballFilter.java:64)
>    at  
> org 
> .apache 
> .lucene 
> .index.DocInverterPerField.processFields(DocInverterPerField.java:134)
>    at  
> org 
> .apache 
> .lucene 
> .index 
> .DocFieldConsumersPerField 
> .processFields(DocFieldConsumersPerField.java:36)
>    at  
> org 
> .apache 
> .lucene 
> .index 
> .DocFieldProcessorPerThread 
> .processDocument(DocFieldProcessorPerThread.java:234)
>    at  
> org 
> .apache 
> .lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:765)
>    at  
> org 
> .apache 
> .lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:743)
>    at  
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1902)
>    at  
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1880)
>    at  
> com 
> .scalix 
> .index.manager.BatchUpdater.performContentAdds(BatchUpdater.java:386)
>    at  
> com.scalix.index.manager.BatchUpdater.processMods(BatchUpdater.java: 
> 176)
>    at  
> com.scalix.index.manager.QueueManager.processQueue(QueueManager.java: 
> 134)
>    at com.scalix.index.manager.QueueManager.run(QueueManager.java:81)
>    at java.lang.Thread.run(Unknown Source)
>
> We are using Lucene 2.4.  Any ideas what is happening?
>
> Thanks!
>
> - Chris
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42058-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 17:07:15 2009
Return-Path: <java-user-return-42058-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16010 invoked from network); 28 Aug 2009 17:07:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 17:07:15 -0000
Received: (qmail 8201 invoked by uid 500); 28 Aug 2009 15:17:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8140 invoked by uid 500); 28 Aug 2009 15:17:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8128 invoked by uid 99); 28 Aug 2009 15:17:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 15:17:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 15:17:43 +0000
Received: by ywh26 with SMTP id 26so2778088ywh.5
        for <java-user@lucene.apache.org>; Fri, 28 Aug 2009 08:17:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=EG7CFwQftyXpirS47gACZPCGPV9fPgSLlvL6vuBRKcY=;
        b=UG38S+ogvHmOgs/EfWecMOkTfcWe/stBDHAtxDbjZ6sDSDDopvaxtkjmCN9UZAVnC9
         NF4AL0FHc3ORXOcOIpRO1eSPO/l7nCLdTZRthTp8MhY+z/Rb7bQ3/opgbUoW/5G4SVq2
         SP9MT9tCHiSROz5DqQnswutHKK4vn6/adF2t8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=HfGe+kgGTb18vLySzQmewNz3jaKFCXBTRXSzGXb1BvR/R+um8BVjUccuNS+GeDYGsR
         bpeucNtey4tba03gw2Ei2Yo4YXKDQFakXlJHCIVw85I03WaSGuxeqxzqXqOigJMakaIZ
         zxL45IBAtY+fPtEQuJy3Dsb42neNtyRztWGeo=
Received: by 10.90.121.2 with SMTP id t2mr1023080agc.50.1251472639081;
        Fri, 28 Aug 2009 08:17:19 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 25sm2949319aga.17.2009.08.28.08.17.18
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 28 Aug 2009 08:17:18 -0700 (PDT)
Message-ID: <4A97F4FD.50504@gmail.com>
Date: Fri, 28 Aug 2009 11:17:17 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene 2.9 RC1 now available for testing
References: <4A970612.1060409@apache.org> <962ea6660908280208t3f451143y681a6356caa00ec7@mail.gmail.com> <4A97D5BB.8000209@gmail.com>
In-Reply-To: <4A97D5BB.8000209@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

The dist build issues have been addressed and RC2 will include the
missing analyzer and db contrib binaries.

Unfortunately, people.apache.org is not up at the moment
(https://blogs.apache.org/infra/entry/apache_org_downtime_initial_report),
but I will put up Lucene 2.9 RC2 when it comes back up.

-- 
- Mark

http://www.lucidimagination.com



Mark Miller wrote:
> Apologies - you are correct - contrib/analyzers is in src but not the
> jar distrib. I will address whatever is up with the build process and
> put up another RC when apache servers are back up.
>
> Thanks for pointing this out,
>
> - Mark
>
> Bogdan Ghidireac wrote:
>   
>> Thank you, Lucene 2.9 is a great release...
>>
>> I have one issue so far - I cannot find the contrib/analyzers jars,
>> only the sources are present.
>>
>> Bogdan
>>
>> On Fri, Aug 28, 2009 at 1:17 AM, Mark Miller<markrmiller@gmail.com> wrote:
>> Hello Lucene users,
>>
>> On behalf of the Lucene dev community (a growing community far larger
>> than just the committers) I would like to announce the first release
>> candidate for Lucene 2.9.
>>
>> Please download and check it out  take it for a spin and kick the
>> tires. If all goes well, we hope to release the final version of
>> Lucene 2.9 in a little over a week.
>>
>> While we generally try and maintain full backwards compatibility
>> between major versions, Lucene 2.9 has a variety of breaks that are
>> spelled out in the 'Changes in backwards compatibility policy' section
>> of CHANGES.txt.
>>
>> We recommend that you recompile your application with Lucene 2.9
>> rather than attempting to drop it in. This will alert you to any
>> issues you may have to fix if you are affected by one of the backward
>> compatibility breaks. As always, its a really good idea to thoroughly
>> read CHANGES.txt before upgrading. Also, remember that this is a
>> release candidate, and not the final Lucene 2.9 release.
>>
>> Lucene 2.9 comes with a bevy of new features, including:
>>
>>  Per segment searching and caching (can lead to much faster reopen
>> among other things)
>>
>>  Near real-time search capabilities added to IndexWriter
>>
>>  New queries, including NumericRangeQuery and NumericRangeFilter 
>> fast, highly scalable alternatives to RangeQuery/RangeFilter for
>> numeric searches.
>>
>>  Smarter, more scalable multi-term queries (wildcard, range, etc)
>>
>>  A freshly optimized Collector/Scorer API
>>
>>  Improved Unicode support
>>
>>  A new Attribute based TokenStream API
>>
>>  A new QueryParser framework in contrib with a core QueryParser
>> replacement impl included.
>>
>>  &.
>>
>> And many, many more features, bug fixes, optimizations, and various
>> improvements. You can find the full list of changes here:
>>
>> HTML version:
>> http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/Changes.html
>>
>> Text version:
>> http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/CHANGES.txt
>>
>> Many changes have also occurred in Lucene's contrib area:
>> http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/contrib/CHANGES.txt
>>
>> Download release candidate 1 here:
>> http://people.apache.org/~markrmiller/staging-area/lucene2.9rc1/
>>
>> Be sure to report back with any issues you find!
>>
>> Thanks,
>>
>> Mark Miller
>>     
>>>       
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>   
>>>       
>
>   
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
>
>
>   




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42057-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 17:08:30 2009
Return-Path: <java-user-return-42057-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18183 invoked from network); 28 Aug 2009 17:08:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 17:08:30 -0000
Received: (qmail 5851 invoked by uid 500); 28 Aug 2009 13:04:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5799 invoked by uid 500); 28 Aug 2009 13:04:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5789 invoked by uid 99); 28 Aug 2009 13:04:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 13:04:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.221.192 as permitted sender)
Received: from [209.85.221.192] (HELO mail-qy0-f192.google.com) (209.85.221.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 13:04:19 +0000
Received: by qyk30 with SMTP id 30so1200850qyk.5
        for <java-user@lucene.apache.org>; Fri, 28 Aug 2009 06:03:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=5EmM8Fe8aBsRaNJF0/tLDL+24GTfBjVQfOVpOccXVIs=;
        b=BLUmgqcJbNjvNAMQ1s96rXapnILGrP5b8VwQ9NwRtnu07oi/sXXcmAhrXTOkrNH8H9
         4hy383WZQnQ1Ogn+eSPsRUyEruBai129ih3AZjlbMoFFZwLCnJjbt4h8OFWKfUwERxfE
         WuCBaDhb3+/9V7mH6UWLNCbEuNqyhOQ8yhyIE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=PIC7bfM+jVnYy+xmCIZIXOcJfbRghpvaJyYpGsfA8Ldn8D08001yb5E8mKeP5Kk90c
         W/0T/TXOzWlhltLB9FkL2ZVUPLX3jGLMlQxAvEbgJFbUk5GNYmKX3mjJ+FFdWagmlEYF
         lbwdusuNdKHmB+EYOSh7N2TyUtkC8t6h8uakU=
Received: by 10.224.30.6 with SMTP id s6mr967972qac.101.1251464637586;
        Fri, 28 Aug 2009 06:03:57 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 7sm3382364qwf.16.2009.08.28.06.03.53
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 28 Aug 2009 06:03:55 -0700 (PDT)
Message-ID: <4A97D5BB.8000209@gmail.com>
Date: Fri, 28 Aug 2009 09:03:55 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene 2.9 RC1 now available for testing
References: <4A970612.1060409@apache.org> <962ea6660908280208t3f451143y681a6356caa00ec7@mail.gmail.com>
In-Reply-To: <962ea6660908280208t3f451143y681a6356caa00ec7@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Apologies - you are correct - contrib/analyzers is in src but not the
jar distrib. I will address whatever is up with the build process and
put up another RC when apache servers are back up.

Thanks for pointing this out,

- Mark

Bogdan Ghidireac wrote:
> Thank you, Lucene 2.9 is a great release...
>
> I have one issue so far - I cannot find the contrib/analyzers jars,
> only the sources are present.
>
> Bogdan
>
> On Fri, Aug 28, 2009 at 1:17 AM, Mark Miller<markrmiller@gmail.com> wrote:
> Hello Lucene users,
>
> On behalf of the Lucene dev community (a growing community far larger
> than just the committers) I would like to announce the first release
> candidate for Lucene 2.9.
>
> Please download and check it out  take it for a spin and kick the
> tires. If all goes well, we hope to release the final version of
> Lucene 2.9 in a little over a week.
>
> While we generally try and maintain full backwards compatibility
> between major versions, Lucene 2.9 has a variety of breaks that are
> spelled out in the 'Changes in backwards compatibility policy' section
> of CHANGES.txt.
>
> We recommend that you recompile your application with Lucene 2.9
> rather than attempting to drop it in. This will alert you to any
> issues you may have to fix if you are affected by one of the backward
> compatibility breaks. As always, its a really good idea to thoroughly
> read CHANGES.txt before upgrading. Also, remember that this is a
> release candidate, and not the final Lucene 2.9 release.
>
> Lucene 2.9 comes with a bevy of new features, including:
>
>  Per segment searching and caching (can lead to much faster reopen
> among other things)
>
>  Near real-time search capabilities added to IndexWriter
>
>  New queries, including NumericRangeQuery and NumericRangeFilter 
> fast, highly scalable alternatives to RangeQuery/RangeFilter for
> numeric searches.
>
>  Smarter, more scalable multi-term queries (wildcard, range, etc)
>
>  A freshly optimized Collector/Scorer API
>
>  Improved Unicode support
>
>  A new Attribute based TokenStream API
>
>  A new QueryParser framework in contrib with a core QueryParser
> replacement impl included.
>
>  &.
>
> And many, many more features, bug fixes, optimizations, and various
> improvements. You can find the full list of changes here:
>
> HTML version:
> http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/Changes.html
>
> Text version:
> http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/CHANGES.txt
>
> Many changes have also occurred in Lucene's contrib area:
> http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/contrib/CHANGES.txt
>
> Download release candidate 1 here:
> http://people.apache.org/~markrmiller/staging-area/lucene2.9rc1/
>
> Be sure to report back with any issues you find!
>
> Thanks,
>
> Mark Miller
>>
>>
---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>

> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



-- 
- Mark

http://www.lucidimagination.com





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42060-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 17:21:44 2009
Return-Path: <java-user-return-42060-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34227 invoked from network); 28 Aug 2009 17:21:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 17:21:44 -0000
Received: (qmail 16328 invoked by uid 500); 28 Aug 2009 16:19:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16239 invoked by uid 500); 28 Aug 2009 16:19:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16229 invoked by uid 99); 28 Aug 2009 16:19:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 16:19:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 16:19:33 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mh4AS-0006nJ-LB
	for java-user@lucene.apache.org; Fri, 28 Aug 2009 09:19:12 -0700
Message-ID: <25192797.post@talk.nabble.com>
Date: Fri, 28 Aug 2009 09:19:12 -0700 (PDT)
From: cemerick <cemerick@snowtide.com>
To: java-user@lucene.apache.org
Subject: Re: Purpose of the file modification date methods in Directory?
In-Reply-To: <25136045.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: cemerick@snowtide.com
References: <25136045.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


I just thought I'd ping the list once more on this question.  Any thoughts? 
If not, I'll leave well enough alone until something breaks... :-)

Thanks much,

- Chas


cemerick wrote:
> 
> I've built a Lucene Directory implementation for jdbm, an embedded Java
> database. Part of the Directory API are two methods related to "file"
> modification dates: touchFile and fileModified. My question is, what is
> the purpose of these methods? I've searched the Lucene core source tree,
> and found no usage of these methods at all.
> 
> FWIW, my interest is the fact that I'd like to not bother tracking mod
> dates, given that I'm using an embedded datastore, and such metadata isn't
> "free" as it is in a regular filesystem.  My jdbm Directory impl seems to
> be working just fine (with touchFile a no-op and fileModified always
> returning 0).
> 
> Thanks,
> 
> - Chas
> 

-- 
View this message in context: http://www.nabble.com/Purpose-of-the-file-modification-date-methods-in-Directory--tp25136045p25192797.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42061-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 17:33:10 2009
Return-Path: <java-user-return-42061-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49389 invoked from network); 28 Aug 2009 17:33:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 17:33:10 -0000
Received: (qmail 43660 invoked by uid 500); 28 Aug 2009 17:33:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43589 invoked by uid 500); 28 Aug 2009 17:33:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43561 invoked by uid 99); 28 Aug 2009 17:33:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 17:33:08 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 17:32:58 +0000
Received: by ywh26 with SMTP id 26so2950203ywh.5
        for <java-user@lucene.apache.org>; Fri, 28 Aug 2009 10:32:37 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.107.2 with SMTP id f2mr2551336ybc.188.1251480757238; Fri, 
	28 Aug 2009 10:32:37 -0700 (PDT)
In-Reply-To: <25192797.post@talk.nabble.com>
References: <25136045.post@talk.nabble.com> <25192797.post@talk.nabble.com>
Date: Fri, 28 Aug 2009 13:32:37 -0400
Message-ID: <9ac0c6aa0908281032j18d7fbefvab6dcb2583c0f766@mail.gmail.com>
Subject: Re: Purpose of the file modification date methods in Directory?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

IndexReader.lastModified returns lastModified of the latest segments_N
file.  Also, IndexCommit exposes a lastModified which is the
lastModified of the segments_N file for that commit point.

Otherwise I don't think Lucene uses it elsewhere.

Mike

On Fri, Aug 28, 2009 at 12:19 PM, cemerick<cemerick@snowtide.com> wrote:
>
> I just thought I'd ping the list once more on this question. =A0Any thoug=
hts?
> If not, I'll leave well enough alone until something breaks... :-)
>
> Thanks much,
>
> - Chas
>
>
> cemerick wrote:
>>
>> I've built a Lucene Directory implementation for jdbm, an embedded Java
>> database. Part of the Directory API are two methods related to "file"
>> modification dates: touchFile and fileModified. My question is, what is
>> the purpose of these methods? I've searched the Lucene core source tree,
>> and found no usage of these methods at all.
>>
>> FWIW, my interest is the fact that I'd like to not bother tracking mod
>> dates, given that I'm using an embedded datastore, and such metadata isn=
't
>> "free" as it is in a regular filesystem. =A0My jdbm Directory impl seems=
 to
>> be working just fine (with touchFile a no-op and fileModified always
>> returning 0).
>>
>> Thanks,
>>
>> - Chas
>>
>
> --
> View this message in context: http://www.nabble.com/Purpose-of-the-file-m=
odification-date-methods-in-Directory--tp25136045p25192797.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42059-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 17:37:35 2009
Return-Path: <java-user-return-42059-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54988 invoked from network); 28 Aug 2009 17:37:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 17:37:35 -0000
Received: (qmail 60111 invoked by uid 500); 28 Aug 2009 15:48:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60070 invoked by uid 500); 28 Aug 2009 15:48:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60060 invoked by uid 99); 28 Aug 2009 15:48:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 15:48:13 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 15:48:02 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n7SFlZuO023438
	for <java-user@lucene.apache.org>; Fri, 28 Aug 2009 16:47:35 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Fri, 28 Aug 2009 16:47:34 +0100 (BST)
Date: Fri, 28 Aug 2009 16:47:34 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <1500883127.20471251474454677.JavaMail.root@mail.uk.scalix.com>
In-Reply-To: <E17F2B23-01EA-49ED-990E-2EF6074966EC@apache.org>
Subject: RE: New "Stream closed" exception with Java 6
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_Part_1252_1526595348.1251474454674"
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

------=_Part_1252_1526595348.1251474454674
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline

Hi Grant

Please see attached.

Thanks,

- Chris


----- Original Message -----
From: Grant Ingersoll <gsingers@apache.org>
Sent: Fri, 28/8/2009 1:26pm
To: java-user@lucene.apache.org
Subject: Re: New "Stream closed" exception with Java 6

Are there any log messages around that spot?  Did something happen to  
the underlying Reader you are using?  Can you share that little bit of  
indexing code?

On Aug 27, 2009, at 10:11 AM, Chris Bamford wrote:

> Hi,
>
> Since moving our app to Java 6 and Tomcat 6, we have started getting  
> occasional exceptions of the form:
>
> java.io.IOException: Stream closed
>    at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
>    at sun.nio.cs.StreamDecoder.read(Unknown Source)
>    at java.io.InputStreamReader.read(Unknown Source)
>    at  
> org 
> .apache 
> .lucene 
> .analysis 
> .standard.StandardTokenizerImpl.zzRefill(StandardTokenizerImpl.java: 
> 443)
>    at  
> org 
> .apache 
> .lucene 
> .analysis 
> .standard 
> .StandardTokenizerImpl.getNextToken(StandardTokenizerImpl.java:629)
>    at  
> org 
> .apache 
> .lucene 
> .analysis.standard.StandardTokenizer.next(StandardTokenizer.java:140)
>    at  
> org 
> .apache 
> .lucene.analysis.standard.StandardFilter.next(StandardFilter.java:43)
>    at  
> org.apache.lucene.analysis.LowerCaseFilter.next(LowerCaseFilter.java: 
> 34)
>    at  
> org 
> .apache 
> .lucene.analysis.snowball.SnowballFilter.next(SnowballFilter.java:64)
>    at  
> org 
> .apache 
> .lucene 
> .index.DocInverterPerField.processFields(DocInverterPerField.java:134)
>    at  
> org 
> .apache 
> .lucene 
> .index 
> .DocFieldConsumersPerField 
> .processFields(DocFieldConsumersPerField.java:36)
>    at  
> org 
> .apache 
> .lucene 
> .index 
> .DocFieldProcessorPerThread 
> .processDocument(DocFieldProcessorPerThread.java:234)
>    at  
> org 
> .apache 
> .lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:765)
>    at  
> org 
> .apache 
> .lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:743)
>    at  
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1902)
>    at  
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1880)
>    at  
> com 
> .scalix 
> .index.manager.BatchUpdater.performContentAdds(BatchUpdater.java:386)
>    at  
> com.scalix.index.manager.BatchUpdater.processMods(BatchUpdater.java: 
> 176)
>    at  
> com.scalix.index.manager.QueueManager.processQueue(QueueManager.java: 
> 134)
>    at com.scalix.index.manager.QueueManager.run(QueueManager.java:81)
>    at java.lang.Thread.run(Unknown Source)
>
> We are using Lucene 2.4.  Any ideas what is happening?
>
> Thanks!
>
> - Chris
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


------=_Part_1252_1526595348.1251474454674
Content-Type: text/plain;
	charset="us-ascii";
	name="lucene_msg.txt"
Content-Disposition: attachment;
	filename="lucene_msg.txt"


Since my last email I have poked around and discovered two things:

1) These exceptions are related to a handful of particular documents (repeatable), so I suspect the content is the problem.
2) They index fine on Lucene 2.0 but not 2.4

I have added to the error handling, so we get better diagnostics:
 
            try {
                indexWriter.addDocument(doc);
            } catch (CorruptIndexException ex) {
                throw new IndexerException ("CorruptIndexException on doc: " + doc.toString() +
                    " - " + ex.toString());
            } catch (IOException ex) {
                throw new IndexerException ("IOException on doc: " + doc.toString() +
                    " - " + ex.toString());
            }

Here is an example exception (we are indexing email messages):

com.scalix.index.api.IndexerException: IOException on doc: Document<indexed,tokenized<return-path:freddy@scalix.com> indexed,tokenized<received
:from [172.28.176.173] (bigfoot.scalix.com [172.16.0.31])
    by bigfoot.scalix.com (Scalix SMTP Relay 11.4.1.11929)
    via ESMTP; Mon, 18 Aug 2008 23:52:31 -0400 (EDT)> indexed<CREATE-DATE:20080819035308> indexed,tokenized<date:Mon Aug 18 23:53:08 EDT 2008>
indexed,tokenized<from:barney<barneyp@scalix.com>> indexed,tokenized<cc:Stefan =?ISO-8859-1?Q?V=F6lkel?= <stefan.voelkel@scalix.com>>  
indexed,tokenized<cc:Peter Kelly <pkelly@scalix.com>> indexed<message-id:48AA43A4.3090409@scalix.
com> indexed<in-reply-to:LBEA59C0EB3BE48d1BCD72524401CF9AE.1219072640.mail.us.scalix.com@MHS> indexed<references:LBEA59C0EB3BE48d1BCD72524401CF
9AE.1219072640.mail.us.scalix.com@MHS> indexed,tokenized<subject:Re: PLEASE READ EVERYONE! Weekly Status Reports> indexed,tokenized<autoforward
ed:FALSE> indexed,tokenized<importance:Normal> indexed,tokenized<priority:Normal> indexed,tokenized<sensitivity:Normal> indexed,tokenized<x-msm
ail-priority:Medium> indexed,tokenized<x-priority:3> indexed<x-scalix-autoreplied:FALSE> indexed,tokenized<user-agent:Thunderbird 1.5.0.7 (X11/
20061023)> indexed,tokenized<mime-version:1.0> indexed<SIZE-KBYTES:0000000006> indexed<DELIVERY-DATE:20080819035235> indexed,tokenized<x-scalix
-internaldate:Mon Aug 18 23:52:35 EDT 2008> indexed<x-scalix-has-attach:FALSE> indexed,tokenized<content-type:text/plain;
        charset="US-ASCII";
        format="flowed"> indexed,tokenized<content-transfer-encoding:7bit> indexed,tokenized<content-disposition:inline> indexed<CONTENT-TYPE:t
ext/plain> indexed,tokenized<BODY:java.io.InputStreamReader@1c6f48c> indexed<x-scalix-class:IPM.Note> indexed<MSG-TYPE:email> stored/uncompress
ed,indexed<INDEXID:90010ac-4682aaad-48aa4383-54daaf>> - java.io.IOException: Stream closed
        at com.scalix.index.manager.BatchUpdater.performContentAdds(BatchUpdater.java:395)
        at com.scalix.index.manager.BatchUpdater.processMods(BatchUpdater.java:179)
        at com.scalix.index.manager.QueueManager.processQueue(QueueManager.java:134)
        at com.scalix.index.manager.QueueManager.run(QueueManager.java:81)
        at java.lang.Thread.run(Unknown Source)

Unfortunately, I cannot seem to see what is in the email BODY part (highlighted above) as it is hidden behind some object
reference (<BODY:java.io.InputStreamReader@1c6f48c>).  How can I do this?

Do you need any more information?



------=_Part_1252_1526595348.1251474454674
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
------=_Part_1252_1526595348.1251474454674--

From java-user-return-42062-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 18:59:48 2009
Return-Path: <java-user-return-42062-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16731 invoked from network); 28 Aug 2009 18:59:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 18:59:48 -0000
Received: (qmail 86790 invoked by uid 500); 28 Aug 2009 18:59:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86709 invoked by uid 500); 28 Aug 2009 18:59:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86699 invoked by uid 99); 28 Aug 2009 18:59:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 18:59:45 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of fabriciorsf@gmail.com designates 209.85.221.192 as permitted sender)
Received: from [209.85.221.192] (HELO mail-qy0-f192.google.com) (209.85.221.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 18:59:36 +0000
Received: by qyk30 with SMTP id 30so1402220qyk.5
        for <java-user@lucene.apache.org>; Fri, 28 Aug 2009 11:59:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=KJVkFLJiUn6fnuKQTas4q+XkTkeT722jGMKEAdFPxCM=;
        b=UTWjmCrfUY70Zi3iScsQmEs4FPeXiiZ2RlYyOXCHy6HCuWscuLEEsbyz49qGCHK05z
         0k4eTti1svU3SnkBBocSZceBtsEmGWHXR2+BXaAC9ZXomFuAql1NeF2+fZ/lHzEsK0Cp
         u4PNvSf2J0C0PXDQCRlRqma/en7xlmuGdmqH4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=LmPOCC1plQW2gRFVUNGBuSV4wGPj36vbw8w8YVFySWg5hjVRHYVNCQyVSVJofdrt7r
         afXz+QpQC2RalmupshVsWg/BpIewvOxIgXiqJvwMjZ0fOqz+2jJ1MW1IzKG3IcZhWL5l
         5cHKFteKuf9PYeW4/7EjNipM25pGHstguw8yI=
MIME-Version: 1.0
Received: by 10.229.55.69 with SMTP id t5mr883138qcg.34.1251485955075; Fri, 28 
	Aug 2009 11:59:15 -0700 (PDT)
In-Reply-To: <e02e1b4b0908250946g1a904fbai17db94de40ad215b@mail.gmail.com>
References: <e02e1b4b0908211007t518862cfv32bfb4e6445e9c@mail.gmail.com>
	 <ac6e61fc0908212228n56f9e80dhcba439cf824511fe@mail.gmail.com>
	 <e02e1b4b0908250803u1f68c4boe153a1eb51fbd016@mail.gmail.com>
	 <786fde50908250917w515f1ff1tc9d03f60e7637557@mail.gmail.com>
	 <e02e1b4b0908250946g1a904fbai17db94de40ad215b@mail.gmail.com>
Date: Fri, 28 Aug 2009 15:59:14 -0300
Message-ID: <e02e1b4b0908281159x932dadn6bba15d86b3995ac@mail.gmail.com>
Subject: Re: How to give a score for all documents?
From: =?ISO-8859-1?Q?Fabr=EDcio_Raphael?= <fabriciorsf@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015175dd8b8cb2fcc04723847f4
X-Virus-Checked: Checked by ClamAV on apache.org

--0015175dd8b8cb2fcc04723847f4
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Any ideia? Or is it a limitation of the Lucene?

2009/8/25 Fabr=EDcio Raphael <fabriciorsf@gmail.com>

> First, that a document is relevant to a query does not necessarily mean
> that this document has to contain some query term. You can have other way=
s
> to assert that a document is relevant to a query.
>
> My IR model is different of the vector model, so it can to give score not
> null for documents irrelevant for the vector model. I know that Lucene
> implements the vector model, but I want to use the facilities of the Luce=
ne
> because I like what the Lucene provides.
>
> But the Lucene to give scores only for relevant documents for the vector
> model. And the my model can to give score same that this documents isn't
> relevant to vector model. It depends of the configuration granularity of
> execution.
>
> So I liked that method nextDoc() of the class that implements the
> Scorer.class returned all the documents the end of the iteration to
> calculate the score.
>
> I've got to calculate the customized score of the documents that Lucene
> returns in according to the vector model.
>
> I hope you have understood me!
>
> Thanks!
>
>
>
> On Tue, Aug 25, 2009 at 1:17 PM, Shai Erera <serera@gmail.com> wrote:
>
>> Can you please elaborate more on the use case? Why if a certain document
>> is
>> irrelevant to a certain query, you'd like to give it a score? Are you
>> perhaps talking about certain documents which should always appear in
>> search
>> results, no matter what the query is? And instead of always showing them=
,
>> you'd like to give them a "static score", so that they can compete w/
>> other
>> docs?
>>
>> If that's the case, I think you can use a BooleanQuery such that the use=
r
>> query is added as a clause and then you add another clause (MUST) which =
is
>> in fact a MatchAllDocsQuery or something like that which returns a
>> customized score. It's expensive though as for each query you'll score a=
ll
>> docs in the index.
>>
>> But I don't think that will help (at least for this use case) since ever=
y
>> relevant document to the query will be added the same score as an
>> 'irrelevant' document, which means the relevant docs will still win, no?
>>
>> Shai
>>
>> 2009/8/25 Fabr=EDcio Raphael <fabriciorsf@gmail.com>
>>
>> > I already know about this, but I want to give a customized score for a=
ll
>> > documents in collection, independent if wache document is or isn't
>> relevant
>> > to the vector model.
>> >
>> > The similarity function is called only when the document is relevant t=
o
>> the
>> > vector model.
>> >
>> > Do you understand me?
>> >
>> > Thanks!
>> >
>> > On Sat, Aug 22, 2009 at 2:28 AM, prashant ullegaddi <
>> > prashullegaddi@gmail.com> wrote:
>> >
>> > > If you want to modify the way Lucene scores documents, I guess you
>> need
>> > to
>> > > extend Similarity class and provide your own implementation. Take a
>> look
>> > > at:
>> > >
>> > >
>> > >
>> >
>> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Default=
Similarity.html
>> > >
>> > >
>> >
>> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/Similar=
ity.html
>> > >
>> > > Thanks,
>> > > Prashant.
>> > >
>> > > 2009/8/21 Fabr=EDcio Raphael <fabriciorsf@gmail.com>
>> > >
>> > > > How to give a customize score for all documents independent of the
>> > vector
>> > > > model?
>> > > >
>> > > > I already know how to give a customize score, but I want to give
>> this
>> > > > customize score for all documents in the collection, regardless of
>> what
>> > > is
>> > > > relevant to the vector model.
>> > > >
>> > > > How to do this?
>> > > >
>> > > > Now, thanks!
>> > > >
>> > > > --
>> > > > Fabr=EDcio Raphael
>> > > >
>> > >
>> >
>> >
>> >
>> > --
>> > Fabr=EDcio Raphael
>> >
>>
>
>
>
> --
> Fabr=EDcio Raphael
>



--=20
Fabr=EDcio Raphael

--0015175dd8b8cb2fcc04723847f4--

From java-user-return-42063-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 19:03:06 2009
Return-Path: <java-user-return-42063-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18555 invoked from network); 28 Aug 2009 19:03:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 19:03:05 -0000
Received: (qmail 96665 invoked by uid 500); 28 Aug 2009 19:03:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96600 invoked by uid 500); 28 Aug 2009 19:03:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96589 invoked by uid 99); 28 Aug 2009 19:03:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 19:03:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.216.202 as permitted sender)
Received: from [209.85.216.202] (HELO mail-px0-f202.google.com) (209.85.216.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 19:02:53 +0000
Received: by pxi40 with SMTP id 40so2101594pxi.5
        for <java-user@lucene.apache.org>; Fri, 28 Aug 2009 12:02:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:reply-to
         :organization:user-agent:mime-version:to:subject:x-enigmail-version
         :content-type:content-transfer-encoding;
        bh=LZeWixWMuuXVDRHx9T6/oDoLc21KAJFRAlplIRsfPt0=;
        b=xXjJfCHfNv6tTgNdEVx0gbGzWWT58V6eePTUFNFj8nLPNSakpAbQYHxl8HCI3r7J07
         13qnCB360KVQgie6Mgd87sm0tYFt/46uy+ZTlEuxQBy4hfxgZCo8cAFsCOBwxpcB5qft
         2EyoPgF5S6znIr8yUmlAwo71gXG9QJTFd05bM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:reply-to:organization:user-agent:mime-version
         :to:subject:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=Sy0btCZL6brav2SF6DzhPfcdeNLLKpIin02V41sis29AXgmq4+bJ39lpCDkjPPQAgk
         7Qjfj7XGzKoxsvZkOos8RR8oIF9RJ5HdU+nJZJLlxQOglICzLK5BjgCGq/DTlmb0J0z3
         Zd/2jbHUjbFsMPV0TzH520ZJVXL5wRe0kjy6Y=
Received: by 10.114.18.37 with SMTP id 37mr2057043war.143.1251486153467;
        Fri, 28 Aug 2009 12:02:33 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 23sm901959pxi.13.2009.08.28.12.02.27
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 28 Aug 2009 12:02:31 -0700 (PDT)
Message-ID: <4A9829C2.2000104@apache.org>
Date: Fri, 28 Aug 2009 15:02:26 -0400
From: Mark Miller <markrmiller@gmail.com>
Reply-To: markrmiller@apache.org
Organization: Apache
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene 2.9 RC2 now available for testing
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello Lucene users,

On behalf of the Lucene dev community (a growing community far larger
than just the committers) I would like to announce the second release
candidate for Lucene 2.9.

Please download and check it out – take it for a spin and kick the
tires. If all goes well, we hope to release the final version of
Lucene 2.9 in a little over a week.

The following changes have been applied since the first release candidate:
LUCENE-1867: replace collation/lib/icu4j.jar with a smaller icu jar
LUCENE-1868: add Arabic stemmer to notice.txt
LUCENE-1870: fix contrib dist - missing analyzers/db binaries - extra
miscellaneous folder with misc readme in it
LUCENE-1869: include 'file exists?' when we throw RuntimeException
from fdx or tvx size mismatches during flush or merge
LUCENE-1871: Add option to avoid needlessly wrapping TokenStream with
CachingTokenFilter in Highlighter

While we generally try and maintain full backwards compatibility
between major versions, Lucene 2.9 has a variety of breaks that are
spelled out in the 'Changes in backwards compatibility policy' section
of CHANGES.txt.

We recommend that you recompile your application with Lucene 2.9
rather than attempting to “drop” it in. This will alert you to any
issues you may have to fix if you are affected by one of the backward
compatibility breaks. As always, its a really good idea to thoroughly
read CHANGES.txt before upgrading. Also, remember that this is a
release candidate, and not the final Lucene 2.9 release.

Lucene 2.9 comes with a bevy of new features, including:

Per segment searching and caching (can lead to much faster reopen
among other things)

Near real-time search capabilities added to IndexWriter

New queries, including NumericRangeQuery and NumericRangeFilter –
fast, highly scalable alternatives to RangeQuery/RangeFilter for
numeric searches.

Smarter, more scalable multi-term queries (wildcard, range, etc)

A freshly optimized Collector/Scorer API

Improved Unicode support

A new Attribute based TokenStream API

A new QueryParser framework in contrib with a core QueryParser
replacement impl included.

  ….

And many, many more features, bug fixes, optimizations, and various
improvements. You can find the full list of changes here:

HTML version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/Changes.html

Text version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/CHANGES.txt

Many changes have also occurred in Lucene's contrib area:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/contrib/CHANGES.txt

Download release candidate 1 here:
http://people.apache.org/~markrmiller/staging-area/lucene2.9rc2/

Be sure to report back with any issues you find!

Thanks,

Mark Miller
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAkqYKcIACgkQ0DU3IV7ywDkZHACfbzHKac0sVjNkdSi+79WTYWme
JR4An18v1SJ6HN8mkCYHF0ybqUSypOG/
=qS9t
-----END PGP SIGNATURE-----


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42064-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 19:19:32 2009
Return-Path: <java-user-return-42064-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21608 invoked from network); 28 Aug 2009 19:19:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 19:19:32 -0000
Received: (qmail 21200 invoked by uid 500); 28 Aug 2009 19:19:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21121 invoked by uid 500); 28 Aug 2009 19:19:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21111 invoked by uid 99); 28 Aug 2009 19:19:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 19:19:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.222.200 as permitted sender)
Received: from [209.85.222.200] (HELO mail-pz0-f200.google.com) (209.85.222.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 19:19:20 +0000
Received: by pzk38 with SMTP id 38so2194423pzk.5
        for <java-user@lucene.apache.org>; Fri, 28 Aug 2009 12:19:00 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=4rsDw6fTUZBGJQeE2eZkF1KmgForcp4BEFDgCTwY2vU=;
        b=CMmi79TgnTPK+PV7/xHQjTEuTsu/A6pJdy0SnFzCl7SfTW3qy4DAZMc6QF6o3N4Jbc
         ikvgXiWl1SrPhYuMsXHXGVKQmGW08havTgLX4s82LS6cOKMn9jvG2uc5sc7vLyBeGWUx
         Np4/qagJBm/zwAHejh1urZXr1NNYbOYv7ksuw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=JZvjehBzD0vUc/LiT98O0Y9gXdcj3GxBhH/iGFs0VpumA7IJaI9PvoOxrCggHhclM8
         3BMPgNWHFZi2FH1TRJ9N2aU31XZAUNRbMyYcJh3Bxj88VX1OilqH2ieFnH5L1NOwlahS
         SgFJjyQcpcSLFzMjUrr+UGa7dDZ/u0XJ3F7TQ=
Received: by 10.114.252.30 with SMTP id z30mr1057175wah.76.1251487140089;
        Fri, 28 Aug 2009 12:19:00 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 23sm910900pxi.1.2009.08.28.12.18.58
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 28 Aug 2009 12:18:58 -0700 (PDT)
Message-ID: <4A982DA1.9090608@gmail.com>
Date: Fri, 28 Aug 2009 15:18:57 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene 2.9 RC2 now available for testing
References: <4A9829C2.2000104@apache.org>
In-Reply-To: <4A9829C2.2000104@apache.org>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Mark Miller wrote:
>
> Download release candidate 1 here:
> http://people.apache.org/~markrmiller/staging-area/lucene2.9rc2/
>
In case anyone catches - yes that is a cut and paste typo - should read
release candidate 2 (obvious, but just to cross my t's).

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42065-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 21:24:49 2009
Return-Path: <java-user-return-42065-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65020 invoked from network); 28 Aug 2009 21:24:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 21:24:49 -0000
Received: (qmail 56079 invoked by uid 500); 28 Aug 2009 21:24:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55998 invoked by uid 500); 28 Aug 2009 21:24:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55988 invoked by uid 99); 28 Aug 2009 21:24:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 21:24:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 21:24:38 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mh8vh-0002eR-JE
	for java-user@lucene.apache.org; Fri, 28 Aug 2009 14:24:17 -0700
Message-ID: <25197062.post@talk.nabble.com>
Date: Fri, 28 Aug 2009 14:24:17 -0700 (PDT)
From: cemerick <cemerick@snowtide.com>
To: java-user@lucene.apache.org
Subject: Re: Purpose of the file modification date methods in Directory?
In-Reply-To: <9ac0c6aa0908281032j18d7fbefvab6dcb2583c0f766@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: cemerick@snowtide.com
References: <25136045.post@talk.nabble.com> <25192797.post@talk.nabble.com> <9ac0c6aa0908281032j18d7fbefvab6dcb2583c0f766@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Right, and those methods (IndexReader.lastModified and
IndexCommit.lastModified) aren't used at all.  I guess what I meant to say
originally was I had 'found no functional dependencies' on those methods on
Directory.

Thanks for the data point.

- Chas


Michael McCandless-2 wrote:
>=20
> IndexReader.lastModified returns lastModified of the latest segments_N
> file.  Also, IndexCommit exposes a lastModified which is the
> lastModified of the segments_N file for that commit point.
>=20
> Otherwise I don't think Lucene uses it elsewhere.
>=20
> Mike
>=20
> On Fri, Aug 28, 2009 at 12:19 PM, cemerick<cemerick@snowtide.com> wrote:
>>
>> I just thought I'd ping the list once more on this question. =C2=A0Any
>> thoughts?
>> If not, I'll leave well enough alone until something breaks... :-)
>>
>> Thanks much,
>>
>> - Chas
>>
>>
>> cemerick wrote:
>>>
>>> I've built a Lucene Directory implementation for jdbm, an embedded Java
>>> database. Part of the Directory API are two methods related to "file"
>>> modification dates: touchFile and fileModified. My question is, what is
>>> the purpose of these methods? I've searched the Lucene core source tree=
,
>>> and found no usage of these methods at all.
>>>
>>> FWIW, my interest is the fact that I'd like to not bother tracking mod
>>> dates, given that I'm using an embedded datastore, and such metadata
>>> isn't
>>> "free" as it is in a regular filesystem. =C2=A0My jdbm Directory impl s=
eems
>>> to
>>> be working just fine (with touchFile a no-op and fileModified always
>>> returning 0).
>>>
>>> Thanks,
>>>
>>> - Chas
>>>
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Purpose-of-the-file-modification-date-methods-in-D=
irectory--tp25136045p25192797.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Purpose-of-the-file-mod=
ification-date-methods-in-Directory--tp25136045p25197062.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42066-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 21:57:12 2009
Return-Path: <java-user-return-42066-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73243 invoked from network); 28 Aug 2009 21:57:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 21:57:12 -0000
Received: (qmail 83685 invoked by uid 500); 28 Aug 2009 21:57:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83626 invoked by uid 500); 28 Aug 2009 21:57:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83616 invoked by uid 99); 28 Aug 2009 21:57:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 21:57:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 21:57:02 +0000
Received: by qw-out-2122.google.com with SMTP id 8so610645qwh.53
        for <java-user@lucene.apache.org>; Fri, 28 Aug 2009 14:56:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=g8VZiQJgxZxu/TgjXb/0Zv5sTLRwVk3Mvbpavxd9h8k=;
        b=Xe0PRZM4qa6lpqtwUY592WV200ucFt9y90RTL5x4uogwg3yzgiHkZNpyCFs+Xs+Zya
         WveG1dRKX23IZJgDx2Mt+fx/GjiaGt0To9L9snTgdtE2J/Ohv90YzSvYEzC35D2rot7i
         BFviLHwbCiePQTL4IydVx6dituxMgLbRX30YU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=LguHEJK1011ZvTWwoQYlw+U/Ql/LLfNKLpVGr+C5Xz/m4QOm/tQ9rxuIhQ+SrKJRYt
         qKAi0Oija5+eT6LsgbMbaBwUc2zrcdBw9dOixHUUFSr9m086f07iynq0z957T8kSHPvW
         ddZ+ds/uBB/waRyyqcNDG6Ss5t7myUaHN5JRw=
MIME-Version: 1.0
Received: by 10.224.51.231 with SMTP id e39mr1580328qag.337.1251496601127; 
	Fri, 28 Aug 2009 14:56:41 -0700 (PDT)
Date: Fri, 28 Aug 2009 14:56:41 -0700
Message-ID: <85d3c3b60908281456sfed65a9v9c0428fd2d8c08fd@mail.gmail.com>
Subject: JVM bug?
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

While indexing with the latest nightly build of Solr on Amazon EC2 the
following JVM bug has occurred twice on two different servers.

Post the log to a Jira issue?

java version "1.6.0_07"
Java(TM) SE Runtime Environment (build 1.6.0_07-b06)
Java HotSpot(TM) 64-Bit Server VM (build 10.0-b23, mixed mode)

#
# An unexpected error has been detected by Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00002aaaab852a01, pid=2747, tid=1077070160
#
# Java VM: Java HotSpot(TM) 64-Bit Server VM (10.0-b23 mixed mode linux-amd64)
# Problematic frame:
# V  [libjvm.so+0x2faa01]
#
# An error report file with more information is saved as:
# /mnt/solr/conf/hs_err_pid2747.log
#
# If you would like to submit a bug report, please visit:
#   http://java.sun.com/webapps/bugreport/crash.jsp
#

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42067-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 22:13:31 2009
Return-Path: <java-user-return-42067-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79711 invoked from network); 28 Aug 2009 22:13:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 22:13:31 -0000
Received: (qmail 97224 invoked by uid 500); 28 Aug 2009 22:13:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97183 invoked by uid 500); 28 Aug 2009 22:13:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97173 invoked by uid 99); 28 Aug 2009 22:13:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 22:13:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 22:13:18 +0000
Received: by qw-out-2122.google.com with SMTP id 8so613386qwh.53
        for <java-user@lucene.apache.org>; Fri, 28 Aug 2009 15:12:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=Wa6uNZTTm6gykYGhITPVzTVcpZUBdCkQ/CUic9jK85U=;
        b=FX7vSDHgrxJT2kuYFxxzI0tQB+eueccwWzU4zPgM5fw+Z2+2iLVy6a5/1ShbPyKTg9
         d44ZFBO4OguT8BQ3qpH7JeLJ5VZBtL2SLGmGFLOmMMc1WBKIfU+k9gq0PNhAI8QzB2mY
         gwJRQj5Pwqe/jJ7AHySKFH76RVykYHY2Mcqgo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=qTgjflMM8xC40BJP+oIEEoMxrJD0KAjHEe9GWlm3vgxswiZ7YSgrP2XvPspPwUjlXH
         INGbt7/PNrRzxVIOXsPpd1J8FkPZwyeUSqI6JLybuUQ22awDtEubu+5Elix2xMOKNoUR
         H/kD0/WFpkX8z8TV3XWs21pW713K5KUcxhVoc=
Received: by 10.224.51.8 with SMTP id b8mr1575931qag.349.1251497577527;
        Fri, 28 Aug 2009 15:12:57 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 5sm1092186qwh.13.2009.08.28.15.12.56
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 28 Aug 2009 15:12:57 -0700 (PDT)
Message-ID: <4A985668.8000101@gmail.com>
Date: Fri, 28 Aug 2009 18:12:56 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: JVM bug?
References: <85d3c3b60908281456sfed65a9v9c0428fd2d8c08fd@mail.gmail.com>
In-Reply-To: <85d3c3b60908281456sfed65a9v9c0428fd2d8c08fd@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Could be this issue in Lucene
https://issues.apache.org/jira/browse/LUCENE-1342 ?

-- 
- Mark

http://www.lucidimagination.com



Jason Rutherglen wrote:
> While indexing with the latest nightly build of Solr on Amazon EC2 the
> following JVM bug has occurred twice on two different servers.
>
> Post the log to a Jira issue?
>
> java version "1.6.0_07"
> Java(TM) SE Runtime Environment (build 1.6.0_07-b06)
> Java HotSpot(TM) 64-Bit Server VM (build 10.0-b23, mixed mode)
>
> #
> # An unexpected error has been detected by Java Runtime Environment:
> #
> #  SIGSEGV (0xb) at pc=0x00002aaaab852a01, pid=2747, tid=1077070160
> #
> # Java VM: Java HotSpot(TM) 64-Bit Server VM (10.0-b23 mixed mode linux-amd64)
> # Problematic frame:
> # V  [libjvm.so+0x2faa01]
> #
> # An error report file with more information is saved as:
> # /mnt/solr/conf/hs_err_pid2747.log
> #
> # If you would like to submit a bug report, please visit:
> #   http://java.sun.com/webapps/bugreport/crash.jsp
> #
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42068-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 22:29:17 2009
Return-Path: <java-user-return-42068-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83458 invoked from network); 28 Aug 2009 22:29:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 22:29:17 -0000
Received: (qmail 11091 invoked by uid 500); 28 Aug 2009 22:29:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11019 invoked by uid 500); 28 Aug 2009 22:29:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11008 invoked by uid 99); 28 Aug 2009 22:29:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 22:29:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.221.192 as permitted sender)
Received: from [209.85.221.192] (HELO mail-qy0-f192.google.com) (209.85.221.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 22:29:06 +0000
Received: by qyk30 with SMTP id 30so1526200qyk.5
        for <java-user@lucene.apache.org>; Fri, 28 Aug 2009 15:28:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=prJ5W/zgSxPEIl9ksDMG52VpWjQest2Y4arOTLuySfc=;
        b=c9wwp/7sYGdZwntmUQWgNHc2DE4/GhmNw+t8h/a/fcU+B1lWSG5Em4Y/KjYLvafqzk
         acdi8hfkUfEAWwoB8GK2JaJ/SvO4eK+1orxwdGds95plNnJLEc+TwU4Xrs7q/AY2ZEaN
         wO0NvgHFcSz0fmWdCXM3q0pqlipNbvc0VAg34=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=NzMuH6B+RYoytIh0Z0DdJ7TBi0i5JpC9T497t5YGEYtD6eKATT6fLwdPIhpWL6xNto
         ohwfUpVBsB5IgqRg9bI0FDvNHaF2S++u6R/IdyvzAPlj9BP6aE2eIZ05PRaJsasvxUDV
         F4iZUiNM+fE0q/jDoFSXz2wd64kIYDo7gHO+U=
MIME-Version: 1.0
Received: by 10.224.40.9 with SMTP id i9mr1656467qae.117.1251498525212; Fri, 
	28 Aug 2009 15:28:45 -0700 (PDT)
In-Reply-To: <4A985668.8000101@gmail.com>
References: <85d3c3b60908281456sfed65a9v9c0428fd2d8c08fd@mail.gmail.com>
	 <4A985668.8000101@gmail.com>
Date: Fri, 28 Aug 2009 15:28:45 -0700
Message-ID: <85d3c3b60908281528o3795c700u23f48d88f7afdf8e@mail.gmail.com>
Subject: Re: JVM bug?
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

That looks like it! I am going to upgrade the JVM to 1.6.0_16 however
it's not clear from the issue this will fix the problem?

On Fri, Aug 28, 2009 at 3:12 PM, Mark Miller<markrmiller@gmail.com> wrote:
> Could be this issue in Lucene
> https://issues.apache.org/jira/browse/LUCENE-1342 ?
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
> Jason Rutherglen wrote:
>> While indexing with the latest nightly build of Solr on Amazon EC2 the
>> following JVM bug has occurred twice on two different servers.
>>
>> Post the log to a Jira issue?
>>
>> java version "1.6.0_07"
>> Java(TM) SE Runtime Environment (build 1.6.0_07-b06)
>> Java HotSpot(TM) 64-Bit Server VM (build 10.0-b23, mixed mode)
>>
>> #
>> # An unexpected error has been detected by Java Runtime Environment:
>> #
>> # =A0SIGSEGV (0xb) at pc=3D0x00002aaaab852a01, pid=3D2747, tid=3D1077070=
160
>> #
>> # Java VM: Java HotSpot(TM) 64-Bit Server VM (10.0-b23 mixed mode linux-=
amd64)
>> # Problematic frame:
>> # V =A0[libjvm.so+0x2faa01]
>> #
>> # An error report file with more information is saved as:
>> # /mnt/solr/conf/hs_err_pid2747.log
>> #
>> # If you would like to submit a bug report, please visit:
>> # =A0 http://java.sun.com/webapps/bugreport/crash.jsp
>> #
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42069-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Aug 28 22:48:13 2009
Return-Path: <java-user-return-42069-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91328 invoked from network); 28 Aug 2009 22:48:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Aug 2009 22:48:13 -0000
Received: (qmail 22582 invoked by uid 500); 28 Aug 2009 22:48:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22500 invoked by uid 500); 28 Aug 2009 22:48:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22490 invoked by uid 99); 28 Aug 2009 22:48:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 22:48:11 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Aug 2009 22:48:01 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 288C445F1C0
	for <java-user@lucene.apache.org>; Sat, 29 Aug 2009 00:47:40 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id VXM-hwazKRn1 for <java-user@lucene.apache.org>;
	Sat, 29 Aug 2009 00:47:25 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 452AA45F1BC
	for <java-user@lucene.apache.org>; Sat, 29 Aug 2009 00:47:25 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <85d3c3b60908281456sfed65a9v9c0428fd2d8c08fd@mail.gmail.com> <4A985668.8000101@gmail.com> <85d3c3b60908281528o3795c700u23f48d88f7afdf8e@mail.gmail.com>
Subject: RE: JVM bug?
Date: Sat, 29 Aug 2009 00:47:24 +0200
Message-ID: <F143CF59BDC34C9BA30A0C8A0E8D1E56@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <85d3c3b60908281528o3795c700u23f48d88f7afdf8e@mail.gmail.com>
Thread-Index: AcooLwZvVUR193zgQEyiWDnfpf9FawAAklBw
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

I am so happy to always use Java 1.5.... :-) It never crashed for us! I
think I will not jump to 1.6 the next time.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Jason Rutherglen [mailto:jason.rutherglen@gmail.com]
> Sent: Saturday, August 29, 2009 12:29 AM
> To: java-user@lucene.apache.org
> Subject: Re: JVM bug?
>=20
> That looks like it! I am going to upgrade the JVM to 1.6.0_16 however
> it's not clear from the issue this will fix the problem?
>=20
> On Fri, Aug 28, 2009 at 3:12 PM, Mark Miller<markrmiller@gmail.com> =
wrote:
> > Could be this issue in Lucene
> > https://issues.apache.org/jira/browse/LUCENE-1342 ?
> >
> > --
> > - Mark
> >
> > http://www.lucidimagination.com
> >
> >
> >
> > Jason Rutherglen wrote:
> >> While indexing with the latest nightly build of Solr on Amazon EC2 =
the
> >> following JVM bug has occurred twice on two different servers.
> >>
> >> Post the log to a Jira issue?
> >>
> >> java version "1.6.0_07"
> >> Java(TM) SE Runtime Environment (build 1.6.0_07-b06)
> >> Java HotSpot(TM) 64-Bit Server VM (build 10.0-b23, mixed mode)
> >>
> >> #
> >> # An unexpected error has been detected by Java Runtime =
Environment:
> >> #
> >> # =A0SIGSEGV (0xb) at pc=3D0x00002aaaab852a01, pid=3D2747, =
tid=3D1077070160
> >> #
> >> # Java VM: Java HotSpot(TM) 64-Bit Server VM (10.0-b23 mixed mode
> linux-amd64)
> >> # Problematic frame:
> >> # V =A0[libjvm.so+0x2faa01]
> >> #
> >> # An error report file with more information is saved as:
> >> # /mnt/solr/conf/hs_err_pid2747.log
> >> #
> >> # If you would like to submit a bug report, please visit:
> >> # =A0 http://java.sun.com/webapps/bugreport/crash.jsp
> >> #
> >>
> >> =
---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> >
> >
> >
> > =
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42070-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Aug 29 11:01:32 2009
Return-Path: <java-user-return-42070-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26734 invoked from network); 29 Aug 2009 11:01:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Aug 2009 11:01:31 -0000
Received: (qmail 70456 invoked by uid 500); 29 Aug 2009 11:01:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70385 invoked by uid 500); 29 Aug 2009 11:01:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70375 invoked by uid 99); 29 Aug 2009 11:01:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 29 Aug 2009 11:01:29 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a13.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 29 Aug 2009 11:01:19 +0000
Received: from [10.0.0.128] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a13.g.dreamhost.com (Postfix) with ESMTP id 3EDED129B28
	for <java-user@lucene.apache.org>; Sat, 29 Aug 2009 04:00:58 -0700 (PDT)
Message-Id: <695C6352-5CCC-4603-9211-0C931448529E@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <1500883127.20471251474454677.JavaMail.root@mail.uk.scalix.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: New "Stream closed" exception with Java 6
Date: Sat, 29 Aug 2009 07:00:57 -0400
References: <1500883127.20471251474454677.JavaMail.root@mail.uk.scalix.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

I think you code there needs to show the underlying exception, too, so  
we can see that stack trace.

-Grant

On Aug 28, 2009, at 11:47 AM, Chris Bamford wrote:

> Hi Grant
>
> Please see attached.
>
> Thanks,
>
> - Chris
>
>
> ----- Original Message -----
> From: Grant Ingersoll <gsingers@apache.org>
> Sent: Fri, 28/8/2009 1:26pm
> To: java-user@lucene.apache.org
> Subject: Re: New "Stream closed" exception with Java 6
>
> Are there any log messages around that spot?  Did something happen to
> the underlying Reader you are using?  Can you share that little bit of
> indexing code?
>
> On Aug 27, 2009, at 10:11 AM, Chris Bamford wrote:
>
>> Hi,
>>
>> Since moving our app to Java 6 and Tomcat 6, we have started getting
>> occasional exceptions of the form:
>>
>> java.io.IOException: Stream closed
>>   at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
>>   at sun.nio.cs.StreamDecoder.read(Unknown Source)
>>   at java.io.InputStreamReader.read(Unknown Source)
>>   at
>> org
>> .apache
>> .lucene
>> .analysis
>> .standard.StandardTokenizerImpl.zzRefill(StandardTokenizerImpl.java:
>> 443)
>>   at
>> org
>> .apache
>> .lucene
>> .analysis
>> .standard
>> .StandardTokenizerImpl.getNextToken(StandardTokenizerImpl.java:629)
>>   at
>> org
>> .apache
>> .lucene
>> .analysis.standard.StandardTokenizer.next(StandardTokenizer.java:140)
>>   at
>> org
>> .apache
>> .lucene.analysis.standard.StandardFilter.next(StandardFilter.java:43)
>>   at
>> org.apache.lucene.analysis.LowerCaseFilter.next(LowerCaseFilter.java:
>> 34)
>>   at
>> org
>> .apache
>> .lucene.analysis.snowball.SnowballFilter.next(SnowballFilter.java:64)
>>   at
>> org
>> .apache
>> .lucene
>> .index.DocInverterPerField.processFields(DocInverterPerField.java: 
>> 134)
>>   at
>> org
>> .apache
>> .lucene
>> .index
>> .DocFieldConsumersPerField
>> .processFields(DocFieldConsumersPerField.java:36)
>>   at
>> org
>> .apache
>> .lucene
>> .index
>> .DocFieldProcessorPerThread
>> .processDocument(DocFieldProcessorPerThread.java:234)
>>   at
>> org
>> .apache
>> .lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java: 
>> 765)
>>   at
>> org
>> .apache
>> .lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:743)
>>   at
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java: 
>> 1902)
>>   at
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java: 
>> 1880)
>>   at
>> com
>> .scalix
>> .index.manager.BatchUpdater.performContentAdds(BatchUpdater.java:386)
>>   at
>> com.scalix.index.manager.BatchUpdater.processMods(BatchUpdater.java:
>> 176)
>>   at
>> com.scalix.index.manager.QueueManager.processQueue(QueueManager.java:
>> 134)
>>   at com.scalix.index.manager.QueueManager.run(QueueManager.java:81)
>>   at java.lang.Thread.run(Unknown Source)
>>
>> We are using Lucene 2.4.  Any ideas what is happening?
>>
>> Thanks!
>>
>> - Chris
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)
> using Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
> <lucene_msg.txt>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42071-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 30 17:25:45 2009
Return-Path: <java-user-return-42071-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18721 invoked from network); 30 Aug 2009 17:25:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Aug 2009 17:25:45 -0000
Received: (qmail 91249 invoked by uid 500); 30 Aug 2009 17:25:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91136 invoked by uid 500); 30 Aug 2009 17:25:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91126 invoked by uid 99); 30 Aug 2009 17:25:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Aug 2009 17:25:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jak-lucene-user@m.gmane.org designates 80.91.229.12 as permitted sender)
Received: from [80.91.229.12] (HELO lo.gmane.org) (80.91.229.12)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Aug 2009 17:25:32 +0000
Received: from list by lo.gmane.org with local (Exim 4.50)
	id 1Mho9I-0006wo-Tp
	for java-user@lucene.apache.org; Sun, 30 Aug 2009 19:25:04 +0200
Received: from p4fc7680b.dip.t-dialin.net ([79.199.104.11])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <java-user@lucene.apache.org>; Sun, 30 Aug 2009 19:25:04 +0200
Received: from jpstotz by p4fc7680b.dip.t-dialin.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <java-user@lucene.apache.org>; Sun, 30 Aug 2009 19:25:04 +0200
X-Injected-Via-Gmane: http://gmane.org/
To: java-user@lucene.apache.org
From:  Jan Peter Stotz <jpstotz@gmx.de>
Subject:  Unintelligent implementation of IndexWriter locking?
Date:  Sun, 30 Aug 2009 19:23:27 +0200
Lines: 17
Message-ID: <h7ecih$8eb$1@ger.gmane.org>
Mime-Version:  1.0
Content-Type:  text/plain; charset="us-ascii"
Content-Transfer-Encoding:  7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: p4fc7680b.dip.t-dialin.net
User-Agent: 40tude_Dialog/2.0.15.84de
Sender: news <news@ger.gmane.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Lucene users,

at the moment I have some problems with the locking mechanism of
IndexWriter. Some times my application quits/terminates before I can close
the IndexWriter. Then the "write.lock" file remains and prohibits every
write access to my index. Of course I could simply unlock the directory
with the index but from the description of the unlock mechanism I read out
that it does not check if some other process still holds the lock and
therefore concurrent writes from multiple process may occur.

Is the locking mechanism really so "dumb"?
If yes - why does Lucene not use a more intelligent approach, e.g. the one
via RandomAccessFile as it is presented here:

http://jimlife.wordpress.com/2008/07/21/java-application-make-sure-only-singleone-instance-running-with-file-lock-ampampampampamp-shutdownhook/

Ciao, Jan


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42072-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 30 17:30:36 2009
Return-Path: <java-user-return-42072-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19778 invoked from network); 30 Aug 2009 17:30:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Aug 2009 17:30:36 -0000
Received: (qmail 95583 invoked by uid 500); 30 Aug 2009 17:30:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95495 invoked by uid 500); 30 Aug 2009 17:30:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95485 invoked by uid 99); 30 Aug 2009 17:30:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Aug 2009 17:30:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.221.192 as permitted sender)
Received: from [209.85.221.192] (HELO mail-qy0-f192.google.com) (209.85.221.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Aug 2009 17:30:23 +0000
Received: by qyk30 with SMTP id 30so2159762qyk.5
        for <java-user@lucene.apache.org>; Sun, 30 Aug 2009 10:30:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=IKBVqJFh7Je9P7r4dptfC5oEZGMsbVz6qO5vwcSeyJ8=;
        b=iRjgKq88R8WnipnVpmyqLBoGS5ZBJihsVTGwPwXimonkPtJOzGPB8e5Bn31nkhT3yl
         7Kt90/QibvNwT87oCIMorBaa3qOpcNxqYt+EWgxfFq8Da6mUwNm5trR19IGisSLq2Dtn
         KipQuLL0jnCWUBjqvF+I4kBtEaeoX6ISKFBak=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=ikYufeQhCtdCCqD52g1iw4y4tQdMbaxhMmHchWh6Woy6P6bPxPqVuzX+bzMcQmXR1k
         9/qAtRnsKAv9LbB0c14UjVOgIXwSazfahlxpwJwMAqfxTz22LEq42inV+Wu5I4bYQO2V
         wLeSvFg6cr0eV8GDmDFicm+u/y1fiGRnCnbmw=
Received: by 10.224.44.154 with SMTP id a26mr2775017qaf.182.1251653401484;
        Sun, 30 Aug 2009 10:30:01 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 7sm1873635qwf.6.2009.08.30.10.30.00
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 30 Aug 2009 10:30:00 -0700 (PDT)
Message-ID: <4A9AB71B.2010101@gmail.com>
Date: Sun, 30 Aug 2009 13:30:03 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Unintelligent implementation of IndexWriter locking?
References: <h7ecih$8eb$1@ger.gmane.org>
In-Reply-To: <h7ecih$8eb$1@ger.gmane.org>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Jan Peter Stotz wrote:
> Hi Lucene users,
>
> at the moment I have some problems with the locking mechanism of
> IndexWriter. Some times my application quits/terminates before I can close
> the IndexWriter. Then the "write.lock" file remains and prohibits every
> write access to my index. Of course I could simply unlock the directory
> with the index but from the description of the unlock mechanism I read out
> that it does not check if some other process still holds the lock and
> therefore concurrent writes from multiple process may occur.
>
> Is the locking mechanism really so "dumb"?
> If yes - why does Lucene not use a more intelligent approach, e.g. the one
> via RandomAccessFile as it is presented here:
>
> http://jimlife.wordpress.com/2008/07/21/java-application-make-sure-only-singleone-instance-running-with-file-lock-ampampampampamp-shutdownhook/
>
> Ciao, Jan
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   
Have you tried using a native lock factory?

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42073-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 30 17:54:55 2009
Return-Path: <java-user-return-42073-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23341 invoked from network); 30 Aug 2009 17:54:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Aug 2009 17:54:55 -0000
Received: (qmail 9397 invoked by uid 500); 30 Aug 2009 17:54:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9320 invoked by uid 500); 30 Aug 2009 17:54:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9310 invoked by uid 99); 30 Aug 2009 17:54:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Aug 2009 17:54:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jak-lucene-user@m.gmane.org designates 80.91.229.12 as permitted sender)
Received: from [80.91.229.12] (HELO lo.gmane.org) (80.91.229.12)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Aug 2009 17:54:43 +0000
Received: from list by lo.gmane.org with local (Exim 4.50)
	id 1Mhobc-0005rN-0B
	for java-user@lucene.apache.org; Sun, 30 Aug 2009 19:54:20 +0200
Received: from p4fc7680b.dip.t-dialin.net ([79.199.104.11])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <java-user@lucene.apache.org>; Sun, 30 Aug 2009 19:54:19 +0200
Received: from jpstotz by p4fc7680b.dip.t-dialin.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <java-user@lucene.apache.org>; Sun, 30 Aug 2009 19:54:19 +0200
X-Injected-Via-Gmane: http://gmane.org/
To: java-user@lucene.apache.org
From:  Jan Peter Stotz <jpstotz@gmx.de>
Subject:  Re: Unintelligent implementation of IndexWriter locking?
Date:  Sun, 30 Aug 2009 19:53:55 +0200
Lines: 15
Message-ID: <h7eebl$d5n$1@ger.gmane.org>
References:  <h7ecih$8eb$1@ger.gmane.org> <4A9AB71B.2010101@gmail.com>
Mime-Version:  1.0
Content-Type:  text/plain; charset="us-ascii"
Content-Transfer-Encoding:  7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: p4fc7680b.dip.t-dialin.net
User-Agent: 40tude_Dialog/2.0.15.84de
Sender: news <news@ger.gmane.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Mark Miller wrote:

> Have you tried using a native lock factory?

No - I did not even know of it's existence as it is nowhere "visible" from
the IndexWriter class (not directly used and nowhere mentioned in the
JavDoc. Could you please add a small hint after the description about the
"locking file" in the JavaDoc of the IndexWriter class that explains how to
specify the LockFactory?
I am currently using FSDirectory.getDirectory(File,LockFactory)) and then
use that Directory to create my IndexWriter.
That would make it easier for others to find their way...

Thanks for your help,
Jan


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42074-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 30 18:28:46 2009
Return-Path: <java-user-return-42074-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26999 invoked from network); 30 Aug 2009 18:28:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Aug 2009 18:28:46 -0000
Received: (qmail 20562 invoked by uid 500); 30 Aug 2009 18:28:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20486 invoked by uid 500); 30 Aug 2009 18:28:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20476 invoked by uid 99); 30 Aug 2009 18:28:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Aug 2009 18:28:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.221.192 as permitted sender)
Received: from [209.85.221.192] (HELO mail-qy0-f192.google.com) (209.85.221.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Aug 2009 18:28:33 +0000
Received: by qyk30 with SMTP id 30so2176315qyk.5
        for <java-user@lucene.apache.org>; Sun, 30 Aug 2009 11:28:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=jugd5OIcFlUmENVTk6WB+M4dvXgzC+5Zi1WeNI9J7h4=;
        b=PLO6OX+CSwXell7ECFpGLqeto19ShkIgq7yfrXnBylKFjOrNu2syG2X2VDo5Nhth4h
         ja/7LhSw5Hck4hD0gHlumY/d5tyh4BQ/MzgmhuH8dtK8d6zGQ98tNLyMBcIIr3g6njX9
         ka8A9VrElffUfzJlXWFDgGax0U9LoUx/jAog0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=wWULZ7aun7rKKms+ixndokO0o61IxSLhwrlbC8zpGBZQfSIzCLQMSL7ovqtN2EkQc5
         04kBJGRA7oZHg69rK8tBeB5jAqS7bkcaVAeYhcUpRJbfAvApxbsF4zp1ktXVMn9IVpij
         k35jNZuEpik6C765HYlxGmxIqWHmCTypCiSf0=
Received: by 10.224.81.66 with SMTP id w2mr2842977qak.98.1251656889546;
        Sun, 30 Aug 2009 11:28:09 -0700 (PDT)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm6298346qwe.14.2009.08.30.11.28.08
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 30 Aug 2009 11:28:08 -0700 (PDT)
Message-ID: <4A9AC4BB.9010901@gmail.com>
Date: Sun, 30 Aug 2009 14:28:11 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Unintelligent implementation of IndexWriter locking?
References: <h7ecih$8eb$1@ger.gmane.org> <4A9AB71B.2010101@gmail.com> <h7eebl$d5n$1@ger.gmane.org>
In-Reply-To: <h7eebl$d5n$1@ger.gmane.org>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Jan Peter Stotz wrote:
> Mark Miller wrote:
>
>   
>> Have you tried using a native lock factory?
>>     
>
> No - I did not even know of it's existence as it is nowhere "visible" from
> the IndexWriter class (not directly used and nowhere mentioned in the
> JavDoc. Could you please add a small hint after the description about the
> "locking file" in the JavaDoc of the IndexWriter class that explains how to
> specify the LockFactory?
> I am currently using FSDirectory.getDirectory(File,LockFactory)) and then
> use that Directory to create my IndexWriter.
> That would make it easier for others to find their way...
>
> Thanks for your help,
> Jan
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   
I've created an issue: https://issues.apache.org/jira/browse/LUCENE-1877

Feel free to add your comments/suggestions.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42075-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Aug 30 18:34:03 2009
Return-Path: <java-user-return-42075-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29084 invoked from network); 30 Aug 2009 18:34:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Aug 2009 18:34:03 -0000
Received: (qmail 24615 invoked by uid 500); 30 Aug 2009 18:34:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24531 invoked by uid 500); 30 Aug 2009 18:34:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24520 invoked by uid 99); 30 Aug 2009 18:34:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Aug 2009 18:34:01 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 30 Aug 2009 18:33:50 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 4341DD36003
	for <java-user@lucene.apache.org>; Sun, 30 Aug 2009 20:33:30 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id sors1CX70cKF for <java-user@lucene.apache.org>;
	Sun, 30 Aug 2009 20:33:16 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 88DCDD36002
	for <java-user@lucene.apache.org>; Sun, 30 Aug 2009 20:33:16 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <h7ecih$8eb$1@ger.gmane.org> <4A9AB71B.2010101@gmail.com> <h7eebl$d5n$1@ger.gmane.org> <4A9AC4BB.9010901@gmail.com>
Subject: RE: Unintelligent implementation of IndexWriter locking?
Date: Sun, 30 Aug 2009 20:33:14 +0200
Message-ID: <BAB6ACF26B554AB1B7D68F517700F4CC@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4A9AC4BB.9010901@gmail.com>
Thread-Index: Acopn767qnYvER6DSAKqAKIVIQX4NAAAD5qQ
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

We can add a note to FSDirectory about that.

For IndexWriter/IndexReader this hint is no longer needed (in Lucene 2.9),
as all methods taking String/File instead of Directory are deprecated and
users should create directory instances and then will automatically get to
the place where the LockFactory can be supplied.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Mark Miller [mailto:markrmiller@gmail.com]
> Sent: Sunday, August 30, 2009 8:28 PM
> To: java-user@lucene.apache.org
> Subject: Re: Unintelligent implementation of IndexWriter locking?
> 
> Jan Peter Stotz wrote:
> > Mark Miller wrote:
> >
> >
> >> Have you tried using a native lock factory?
> >>
> >
> > No - I did not even know of it's existence as it is nowhere "visible"
> from
> > the IndexWriter class (not directly used and nowhere mentioned in the
> > JavDoc. Could you please add a small hint after the description about
> the
> > "locking file" in the JavaDoc of the IndexWriter class that explains how
> to
> > specify the LockFactory?
> > I am currently using FSDirectory.getDirectory(File,LockFactory)) and
> then
> > use that Directory to create my IndexWriter.
> > That would make it easier for others to find their way...
> >
> > Thanks for your help,
> > Jan
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> I've created an issue: https://issues.apache.org/jira/browse/LUCENE-1877
> 
> Feel free to add your comments/suggestions.
> 
> --
> - Mark
> 
> http://www.lucidimagination.com
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42076-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 06:07:07 2009
Return-Path: <java-user-return-42076-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42227 invoked from network); 31 Aug 2009 06:07:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 06:07:07 -0000
Received: (qmail 38545 invoked by uid 500); 31 Aug 2009 06:07:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38461 invoked by uid 500); 31 Aug 2009 06:07:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38451 invoked by uid 99); 31 Aug 2009 06:07:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 06:07:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.94] (HELO smtp107.mail.in.yahoo.com) (202.86.5.94)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 31 Aug 2009 06:06:54 +0000
Received: (qmail 20447 invoked from network); 31 Aug 2009 06:06:30 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=kg1zUQWtWU0NqZTeI3JQRfH4RNonNTatqlubXxayd50fIUPG0EGyC6t9IJUg9V5mm66vrmkEBfcyo0CGZdl3nVOjjB/d+6XXiuOyFUw9LOfBk7Qg/f+5tJ+tlf+2WTcsu2/QVl9D6ccLNld8UvjlHBpUBW9soPzD0zryRjvUWCU=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp107.mail.in.yahoo.com with SMTP; 31 Aug 2009 06:06:29 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: 15GUsowVM1lzBCTHkmyV84Ef59LyazPIYeJTaZO1aJ0ILfcyI2TQpNtkY8HECIWlgicA6O1Ibjc.1knvmwR1rnIM_EBdIhRmEwLm4GDqGW6oZh.RIkxgp2iALVZixpnOAW0f72y_bLRZad5xbj6ZcQ0D
X-Yahoo-Newman-Property: ymail-3
Message-ID: <0f8801ca2a01$2e524d40$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
Subject: Wildcard query
Date: Mon, 31 Aug 2009 11:36:25 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

Hello all,

I am having some content with text "attention". If is search using =
"att*", "attent*", the results are displayed. If i search for "attenti*" =
then no results are displayed.=20

I am using Snowball Analyzer for Indexing and Search (Lucene v2.4.1). =20

Regards
Ganesh
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42077-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 09:31:56 2009
Return-Path: <java-user-return-42077-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12332 invoked from network); 31 Aug 2009 09:31:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 09:31:56 -0000
Received: (qmail 16175 invoked by uid 500); 31 Aug 2009 09:31:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16096 invoked by uid 500); 31 Aug 2009 09:31:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16086 invoked by uid 99); 31 Aug 2009 09:31:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 09:31:53 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of anshumg@gmail.com designates 209.85.222.200 as permitted sender)
Received: from [209.85.222.200] (HELO mail-pz0-f200.google.com) (209.85.222.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 09:31:44 +0000
Received: by pzk38 with SMTP id 38so3863766pzk.5
        for <java-user@lucene.apache.org>; Mon, 31 Aug 2009 02:31:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=VNeRUwXK5BqXx9mNdPz7MtGQQlexX16wGixG3qNMq08=;
        b=RnmGj3qIa6S6hog/v6/f5L4L4ygARVxRrc2oApZPjI2aRaq/xxARPAWo7DJ5aBkNqg
         Ujbv1O3+M8dQ+aUVoyQpzBi3JyuprQAqZDz19uFERoem3BTuYP2nds7G1Kvr8qdtnhja
         BRJU2L7w1ByiaMQ4s5Xct6p3VY3zT57GqPUrM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ANfYMkYKQGMjPzdX/nJWlRcViaVrwAMgVFpylaVydfNE1RKAd+gv2uc5rTYV8RIQK2
         vOkdOKsGcBcM6z6RsCf1b/tMy+ZMQYVDKk9Zydi1pU+kkvQWgpbT4yNDR29Yyn+tKPJj
         LpJwRLhaNtqmSioADLni2jqCMu+4srdyFiKJs=
MIME-Version: 1.0
Received: by 10.115.84.10 with SMTP id m10mr2330819wal.100.1251711082713; Mon, 
	31 Aug 2009 02:31:22 -0700 (PDT)
In-Reply-To: <0f8801ca2a01$2e524d40$710bc30a@sv.us.sonicwall.com>
References: <0f8801ca2a01$2e524d40$710bc30a@sv.us.sonicwall.com>
Date: Mon, 31 Aug 2009 15:01:22 +0530
Message-ID: <867513fe0908310231s23e593a8v38a5d9931c794c33@mail.gmail.com>
Subject: Re: Wildcard query
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636417d1372591b04726cb2d3
X-Virus-Checked: Checked by ClamAV on apache.org

--001636417d1372591b04726cb2d3
Content-Type: text/plain; charset=ISO-8859-1

Hi Ganesh,

Its the snowball analyzer that uses English Stemmer which is causing this
behavior. When you search for* 'attention'*, the query gets parsed to*'attent'
*whereas when you search for *'attenti'* it stays as it is because the
stemmer is not able to fit it anywhere.
Could you tell me what is the goal that is to be met here? I suppose using
just the Snowball analyzer here might be enough for you and you might just
give the wildcard query a complete skip.

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Mon, Aug 31, 2009 at 11:36 AM, Ganesh <emailgane@yahoo.co.in> wrote:

> Hello all,
>
> I am having some content with text "attention". If is search using "att*",
> "attent*", the results are displayed. If i search for "attenti*" then no
> results are displayed.
>
> I am using Snowball Analyzer for Indexing and Search (Lucene v2.4.1).
>
> Regards
> Ganesh
> Send instant messages to your online friends http://in.messenger.yahoo.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636417d1372591b04726cb2d3--

From java-user-return-42078-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 09:48:34 2009
Return-Path: <java-user-return-42078-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15287 invoked from network); 31 Aug 2009 09:48:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 09:48:34 -0000
Received: (qmail 28009 invoked by uid 500); 31 Aug 2009 09:48:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27918 invoked by uid 500); 31 Aug 2009 09:48:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27908 invoked by uid 99); 31 Aug 2009 09:48:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 09:48:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.94] (HELO smtp107.mail.in.yahoo.com) (202.86.5.94)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 31 Aug 2009 09:48:21 +0000
Received: (qmail 56684 invoked from network); 31 Aug 2009 09:47:57 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:References:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=OAJA5aAU0Lgp6/9HnhI62ANv0+IKor6LIm8nxLsKmqE2IH3rHhV+mF4rLdgXn6lXIJqIpt6WWsmwfeAZQYJqHPfKFv5MuuIHPV9CQvICBiDLo+dsHC1dLiosuHcZVOFiYiP5b8wjpP9kvWH4zW5VesIIjYY9SB5W0oyX0QEEnJk=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp107.mail.in.yahoo.com with SMTP; 31 Aug 2009 09:47:55 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: kHv3mRoVM1n9VPxgpUcjAGkRStGKVdvFJyragG.TOEaYJ9tIKMCUZEukkHMCB7n92wP.T28zbpEwAkDljHbNb3yS80.o8y570h.T19JBT5wNoNwpzSylROujw1vPMLeBlikHdodi4RVkG1wKf0WM0ai0WqUX8muGKV7DtXuPC675x0BhOV3F1TrddTkGuw--
X-Yahoo-Newman-Property: ymail-3
Message-ID: <0fab01ca2a20$1df20200$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
References: <0f8801ca2a01$2e524d40$710bc30a@sv.us.sonicwall.com> <867513fe0908310231s23e593a8v38a5d9931c794c33@mail.gmail.com>
Subject: Re: Wildcard query
Date: Mon, 31 Aug 2009 15:17:46 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Anusham

I could understand that the Analyzer stems the word to base word and =
stores in DB. Users may not know this internals and they tend to give =
"attenti*".=20

My question is queryparser should stem the word and then apply /expand =
the wild card query. Is this a bug with queryparser? OR Analyzer will =
not stem the word if it finds a wild card operator in it?

Regards
Ganesh


----- Original Message -----=20
From: "Anshum" <anshumg@gmail.com>
To: <java-user@lucene.apache.org>
Sent: Monday, August 31, 2009 3:01 PM
Subject: Re: Wildcard query


> Hi Ganesh,
>=20
> Its the snowball analyzer that uses English Stemmer which is causing =
this
> behavior. When you search for* 'attention'*, the query gets parsed =
to*'attent'
> *whereas when you search for *'attenti'* it stays as it is because the
> stemmer is not able to fit it anywhere.
> Could you tell me what is the goal that is to be met here? I suppose =
using
> just the Snowball analyzer here might be enough for you and you might =
just
> give the wildcard query a complete skip.
>=20
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
>=20
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
>=20
>=20
> On Mon, Aug 31, 2009 at 11:36 AM, Ganesh <emailgane@yahoo.co.in> =
wrote:
>=20
>> Hello all,
>>
>> I am having some content with text "attention". If is search using =
"att*",
>> "attent*", the results are displayed. If i search for "attenti*" then =
no
>> results are displayed.
>>
>> I am using Snowball Analyzer for Indexing and Search (Lucene v2.4.1).
>>
>> Regards
>> Ganesh
>> Send instant messages to your online friends =
http://in.messenger.yahoo.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42079-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 10:32:12 2009
Return-Path: <java-user-return-42079-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25818 invoked from network); 31 Aug 2009 10:32:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 10:32:12 -0000
Received: (qmail 84544 invoked by uid 500); 31 Aug 2009 10:32:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84467 invoked by uid 500); 31 Aug 2009 10:32:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84457 invoked by uid 99); 31 Aug 2009 10:32:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 10:32:09 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of anshumg@gmail.com designates 209.85.216.174 as permitted sender)
Received: from [209.85.216.174] (HELO mail-px0-f174.google.com) (209.85.216.174)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 10:32:00 +0000
Received: by pxi4 with SMTP id 4so20306pxi.21
        for <java-user@lucene.apache.org>; Mon, 31 Aug 2009 03:31:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=WOvaqbC6Z1HZYUU//avje6i6+h94XfEZV7UCKagHuiI=;
        b=c5WTmNuOi5dPJVJaJgBjkpVkCWF6P56YU9/H7/KFHO/xP0OOeXxRGEYl2MvZCEu2oo
         PQVv9eCtBZFV0gfbF0yPau1BsDjRDpzLMWC72rMP60caL2rEEZhdV30V3PEOxhJe3g8C
         YNVDob19oQscazIKLrqF7n1wtcZwBOfiVgmiU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=OQtZ9bJZA2Pvs4mZsufJ9ct/uOZQL2DkT8y2QpsrqBv6Gk28PYNTfLAGXlJLAwM4ar
         hWjMU4dZTOYs6a0Ku03ehlgn7Zu6aFjyc0/prCpdETbRC+0CVglBPSAClJ3HrsdOlrMT
         WhTJIVjjqJ6v29oqQis9O4evvjKHsIHAUk4E0=
MIME-Version: 1.0
Received: by 10.114.251.14 with SMTP id y14mr2394571wah.144.1251714698734; 
	Mon, 31 Aug 2009 03:31:38 -0700 (PDT)
In-Reply-To: <0fab01ca2a20$1df20200$710bc30a@sv.us.sonicwall.com>
References: <0f8801ca2a01$2e524d40$710bc30a@sv.us.sonicwall.com>
	 <867513fe0908310231s23e593a8v38a5d9931c794c33@mail.gmail.com>
	 <0fab01ca2a20$1df20200$710bc30a@sv.us.sonicwall.com>
Date: Mon, 31 Aug 2009 16:01:38 +0530
Message-ID: <867513fe0908310331t3e3dbd59mea607447b564c412@mail.gmail.com>
Subject: Re: Wildcard query
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016367f9369fa6d1704726d8988
X-Virus-Checked: Checked by ClamAV on apache.org

--0016367f9369fa6d1704726d8988
Content-Type: text/plain; charset=ISO-8859-1

What happens is when you index using the analyzer, attent gets indexed
(assuming you are using the same analyzer while indexing). When you search
for attent*, the query formed is for attent.
when you search for attenti*, it would look for all documents that contain
attenti* (which would not be present in the doc that got indexed as attent).
Also, stemmer wouldn't work in case of wildcards.
Hope this solves your issues.

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Mon, Aug 31, 2009 at 3:17 PM, Ganesh <emailgane@yahoo.co.in> wrote:

> Hi Anusham
>
> I could understand that the Analyzer stems the word to base word and stores
> in DB. Users may not know this internals and they tend to give "attenti*".
>
> My question is queryparser should stem the word and then apply /expand the
> wild card query. Is this a bug with queryparser? OR Analyzer will not stem
> the word if it finds a wild card operator in it?
>
> Regards
> Ganesh
>
>
> ----- Original Message -----
> From: "Anshum" <anshumg@gmail.com>
> To: <java-user@lucene.apache.org>
> Sent: Monday, August 31, 2009 3:01 PM
> Subject: Re: Wildcard query
>
>
> > Hi Ganesh,
> >
> > Its the snowball analyzer that uses English Stemmer which is causing this
> > behavior. When you search for* 'attention'*, the query gets parsed
> to*'attent'
> > *whereas when you search for *'attenti'* it stays as it is because the
> > stemmer is not able to fit it anywhere.
> > Could you tell me what is the goal that is to be met here? I suppose
> using
> > just the Snowball analyzer here might be enough for you and you might
> just
> > give the wildcard query a complete skip.
> >
> > --
> > Anshum Gupta
> > Naukri Labs!
> > http://ai-cafe.blogspot.com
> >
> > The facts expressed here belong to everybody, the opinions to me. The
> > distinction is yours to draw............
> >
> >
> > On Mon, Aug 31, 2009 at 11:36 AM, Ganesh <emailgane@yahoo.co.in> wrote:
> >
> >> Hello all,
> >>
> >> I am having some content with text "attention". If is search using
> "att*",
> >> "attent*", the results are displayed. If i search for "attenti*" then no
> >> results are displayed.
> >>
> >> I am using Snowball Analyzer for Indexing and Search (Lucene v2.4.1).
> >>
> >> Regards
> >> Ganesh
> >> Send instant messages to your online friends
> http://in.messenger.yahoo.com
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> Send instant messages to your online friends http://in.messenger.yahoo.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016367f9369fa6d1704726d8988--

From java-user-return-42080-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 14:29:03 2009
Return-Path: <java-user-return-42080-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84288 invoked from network); 31 Aug 2009 14:29:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 14:29:03 -0000
Received: (qmail 76739 invoked by uid 500); 31 Aug 2009 14:29:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76654 invoked by uid 500); 31 Aug 2009 14:29:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76644 invoked by uid 99); 31 Aug 2009 14:29:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 14:29:00 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [149.8.64.32] (HELO mclmx2.mail.saic.com) (149.8.64.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 14:28:50 +0000
Received: from 0015-its-sbg02.saic.com ([149.8.64.21] [149.8.64.21]) by mclmx2.mail.saic.com with ESMTP id BT-MMP-8563079 for java-user@lucene.apache.org; Mon, 31 Aug 2009 10:28:23 -0400
X-AuditID: 9508407d-b7b7aae0000075c6-38-4a9bde0755ba
Received: from mclmx.mail.saic.com (mcl-sixl-nat.saic.com [149.8.64.21])
	by  (Symantec Brightmail Gateway) with SMTP id 26.27.30150.70EDB9A4; Mon, 31 Aug 2009 10:28:23 -0400 (EDT)
Received: from sc2xfe1.emainc.com ([149.8.64.21] [149.8.64.21]) by mclmx.mail.saic.com with ESMTP id BT-MMP-1786035 for java-user@lucene.apache.org; Mon, 31 Aug 2009 10:28:23 -0400
Received: from sc1exc2.corp.emainc.com ([10.36.152.47]) by sc2xfe1.emainc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Mon, 31 Aug 2009 10:31:37 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01CA2A47.BD232768"
Subject: Indexing large files?
Date: Mon, 31 Aug 2009 10:28:16 -0400
Message-Id: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Indexing large files?
Thread-Index: AcoqR0dKyqqfoNWqQp2LCReH0r4g8A==
From: <Paul_Murdoch@emainc.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 31 Aug 2009 14:31:37.0008 (UTC) FILETIME=[BF10E300:01CA2A47]
X-Brightmail-Tracker: AAAAAA==
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01CA2A47.BD232768
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi,

=20

I'm working with Lucene 2.4.0 and the JVM (JDK 1.6.0_07).  I'm
consistently receiving "OutOfMemoryError: Java heap space", when trying
to index large text files.

=20

Example 1: Indexing a 5 MB text file runs out of memory with a 16 MB
max. heap size.  So I increased the max. heap size to 512 MB.  This
worked for the 5 MB text file, but Lucene still used 84 MB of heap space
to do this.  Why so much?

=20

The class FreqProxTermsWriterPerField appears to be the biggest memory
consumer by far according to JConsole and the TPTP Memory Profiling
plugin for Eclipse Ganymede.

=20

Example 2: Indexing a 62 MB text file runs out of memory with a 512 MB
max. heap size.  Increasing the max. heap size to 1024 MB works but
Lucene uses 826 MB of heap space while performing this.  Still seems
like way too much memory is being used to do this.  I'm sure larger
files would cause the error as it seems correlative.

=20

I'm on a Windows XP SP2 platform with 2 GB of RAM.  So what is the best
practice for indexing large files?  Here is a code snippet that I'm
using:

=20

// Index the content of a text file.

      private Boolean saveTXTFile(File textFile, Document textDocument)
throws CIDBException {          =20

           =20

            try {            =20

                             =20

                  Boolean isFile =3D textFile.isFile();

                  Boolean hasTextExtension =3D
textFile.getName().endsWith(".txt");

                 =20

                  if (isFile && hasTextExtension) {

            =20

                        System.out.println("File " +
textFile.getCanonicalPath() + " is being indexed");

                        Reader textFileReader =3D new
FileReader(textFile);

                        if (textDocument =3D=3D null)

                              textDocument =3D new Document();

                        textDocument.add(new Field("content",
textFileReader));

                        indexWriter.addDocument(textDocument);
// BREAKS HERE!!!!

                  }                   =20

            } catch (FileNotFoundException fnfe) {

                  System.out.println(fnfe.getMessage());

                  return false;

            } catch (CorruptIndexException cie) {

                  throw new CIDBException("The index has become
corrupt.");

            } catch (IOException ioe) {

                  System.out.println(ioe.getMessage());

                  return false;

            }                   =20

            return true;

      }

=20

=20

Thanks much,

=20

Paul

=20


------_=_NextPart_001_01CA2A47.BD232768--

From java-user-return-42081-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 15:25:42 2009
Return-Path: <java-user-return-42081-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97381 invoked from network); 31 Aug 2009 15:25:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 15:25:42 -0000
Received: (qmail 63412 invoked by uid 500); 31 Aug 2009 15:25:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63324 invoked by uid 500); 31 Aug 2009 15:25:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63314 invoked by uid 99); 31 Aug 2009 15:25:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 15:25:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [76.13.9.48] (HELO web65504.mail.ac4.yahoo.com) (76.13.9.48)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 31 Aug 2009 15:25:29 +0000
Received: (qmail 43764 invoked by uid 60001); 31 Aug 2009 15:25:08 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1251732308; bh=CzAuRW2RjsAShXL8Yxy2XHTphe1hH+4pr4TBSm9hON0=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=hPpyQfTguSamIIgNSzkvt+Tjn914qwQ6813a9606Blbz9YayhEcP0yTAoGwgx1WhuxrrPy3fTTijmMvowBC8knsFf34jVUmbu27ylgtIenvvgG69kHsTghAZtNfSiZe3fIB9dxb5zTK08EKkNK2iRf2ijNkRDt+FEn1X/GUeHkQ=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=wVhCOnQyFplVYTO9b3ukA8qVwHnP6VtkC+YHJJs39jq8OXdO35gvgjl0cBryIOdV9xmJ5FwsFp5RNzaiAGs/aSVn+9yZuuy6QluSI1CqKW6q6WyL9hs5RxPkL9F0yKftR4I7xI3Kte5XkmC8VHdJZZSyJ9iWuWU4ZqwfhQb9yeo=;
Message-ID: <408754.43565.qm@web65504.mail.ac4.yahoo.com>
X-YMail-OSG: VKIxPFsVM1nAm3HyOU.M2l7VhbhOuSqsQ6LV865GmlJycMASSPqmvZxkNVBIaRqKVXZ6YPA929kU34L_LlKbTC9QXBpjZ8lTtlcWbj.MT_4h1C1KS3hhAKqN1ydXTMk5zSzphe_L50oXMcncg97xoHngOh6A_0F4ASwKIINw7_np7uHJsQI7YHXT1MT.Dz7ulnm7uz5H2PHMIyfkgx.wlBH_KUZ7PfDk6htnpBlRToUZU6E3EwuE4uagmUlXp0wsNm_IFro31ZbtvVONWNc6Z9I0M1Q3BAfWcgREF.gvJZwll5ufQOwy70s5WfK3xXjFrvUpw_kTI1sRtoZTlfXVzxNQrwo3d22Ro_nmGQ--
Received: from [140.239.67.170] by web65504.mail.ac4.yahoo.com via HTTP; Mon, 31 Aug 2009 08:25:08 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
Date: Mon, 31 Aug 2009 08:25:08 -0700 (PDT)
From: Ted Stockwell <emorning@yahoo.com>
Subject: Why perform optimization in 'off hours'?
To: java-user@lucene.apache.org
In-Reply-To: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,

I am new to Lucene and I was reading 'Lucene in Action' this weekend.
The book recommends that optimization be performed when the index is not in use.
The book makes it clear that optimization *may* be performed while indexing but it says that optimizing while indexing makes indexing slower.
However, the book does not explain *why* indexing would be slower while optimizing.
Since I know that optimization will create new segments and not mess with the old ones, I'm confused as to how optimizing may cause indexing to slow down.

Any ideas?


Thanks,
ted stockwell



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42082-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 15:29:14 2009
Return-Path: <java-user-return-42082-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97991 invoked from network); 31 Aug 2009 15:29:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 15:29:14 -0000
Received: (qmail 67013 invoked by uid 500); 31 Aug 2009 15:29:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66935 invoked by uid 500); 31 Aug 2009 15:29:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66925 invoked by uid 99); 31 Aug 2009 15:29:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 15:29:12 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 15:29:02 +0000
Received: by ewy22 with SMTP id 22so4203149ewy.28
        for <java-user@lucene.apache.org>; Mon, 31 Aug 2009 08:28:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=I0+10xiXK/NVo3B6s1YhCjqR3TkSBx7DYnw8ARimlMI=;
        b=lxBFpQQ4zZGhJpnEe/WigXA8jfq+KknMUjKiPX0v5f5n787TXrs5Fc6Pw9QYfbSB0l
         CzWfaCpjgv86fyI/rFB2kLdgpIsORJASoGxlZwH/owoabqPiT7rQx1/FfchsB8oFJXjT
         UjGRJLolWFmj9QRjYAE9H6a+O48oOa0nH6Yew=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=izXfliuNLNEQmuE6iub4pTMrPXMCdws3fSGzt+czLIDg1dLj6Kv6qGYolx4zxhhP81
         bgwMf7V5y+qTEtRZDCPF31bgoiYD8dltA9NPUtA6W/qDGu7eL8SduAGXxWVF8/7bV7g4
         JHUYe6tPed3GgyhGvH9XhiQIWeAdm0qS6+HYg=
MIME-Version: 1.0
Received: by 10.216.87.71 with SMTP id x49mr1155042wee.11.1251732522010; Mon, 
	31 Aug 2009 08:28:42 -0700 (PDT)
In-Reply-To: <408754.43565.qm@web65504.mail.ac4.yahoo.com>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
	 <408754.43565.qm@web65504.mail.ac4.yahoo.com>
Date: Mon, 31 Aug 2009 18:28:41 +0300
Message-ID: <786fde50908310828gddcfceev3628dceb3602dc2c@mail.gmail.com>
Subject: Re: Why perform optimization in 'off hours'?
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d63f8a5409cc047271b02b
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d63f8a5409cc047271b02b
Content-Type: text/plain; charset=ISO-8859-1

When you run optimize(), you consume CPU and do lots of IO operations which
can really mess up the OS IO cache. Optimize is a very heavy process and
therefore is recommended to run at off hours. Sometimes, when your index is
large enough, it's recommended to run it during weekends, since the
optimize() process itself may take several hours, so that a nightly job
won't be enough.

Shai

On Mon, Aug 31, 2009 at 6:25 PM, Ted Stockwell <emorning@yahoo.com> wrote:

> Hi All,
>
> I am new to Lucene and I was reading 'Lucene in Action' this weekend.
> The book recommends that optimization be performed when the index is not in
> use.
> The book makes it clear that optimization *may* be performed while indexing
> but it says that optimizing while indexing makes indexing slower.
> However, the book does not explain *why* indexing would be slower while
> optimizing.
> Since I know that optimization will create new segments and not mess with
> the old ones, I'm confused as to how optimizing may cause indexing to slow
> down.
>
> Any ideas?
>
>
> Thanks,
> ted stockwell
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d63f8a5409cc047271b02b--

From java-user-return-42083-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 15:40:21 2009
Return-Path: <java-user-return-42083-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1659 invoked from network); 31 Aug 2009 15:40:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 15:40:21 -0000
Received: (qmail 83515 invoked by uid 500); 31 Aug 2009 15:40:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83464 invoked by uid 500); 31 Aug 2009 15:40:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83454 invoked by uid 99); 31 Aug 2009 15:40:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 15:40:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [217.237.170.35] (HELO mzex01.healy-hudson.com) (217.237.170.35)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 15:40:09 +0000
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.4325
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: MergePolicy$MergeException because of FileNotFoundException because wrong path to index-file
Date: Mon, 31 Aug 2009 17:39:47 +0200
Message-ID: <D7206503EB5BE94497458AF4FE4AE8AB014ADF34@owamz.healy-hudson.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: MergePolicy$MergeException because of FileNotFoundException because wrong path to index-file
thread-index: AcoqUUVGwZAxBpSXS5Oe5h4MAEYetA==
From: "Uwe Goetzke" <uwe.goetzke@healy-hudson.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

We have an IndexWriter.optimize running on 4 Proc Xenon Java 1.5 Win2003
machine.
We get a repeatable FileNotFoundException because the path to the file
is wrong:

D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
fs
Instead of
D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140\_0.
cfs

I have no idea what is different here because we use the same code
successfully on other machines (even multi-core)
1. 2009.08.28 13:10:30 :
[B:600000043][N:org.apache.lucene.index.MergePolicy$MergeException]
org.apache.lucene.index.MergePolicy$MergeException:
java.io.FileNotFoundException:
D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
fs (The system cannot find the file specified)
at
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Co
ncurrentMergeScheduler.java:309)
at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr
entMergeScheduler.java:286)
Caused by: java.io.FileNotFoundException:
D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
fs (The system cannot find the file specified)
at java.io.RandomAccessFile.open(Native Method)
at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
at
org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDir
ectory.java:552)
at
org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java
:582)
at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
at
org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.jav
a:70)
at
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
at
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
at
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerge
Scheduler.java:205)
at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr
entMergeScheduler.java:260)
2. 2009.08.28 13:10:31 : [B:600000043][N:java.io.IOException]
java.io.IOException: background merge hit exception: _0:c71339->_0
_1:c36232->_0 _2:c37691->_0 _3:c29335->_0 _4:c29954->_0 _5:c33617->_0
_6:c37092->_0 _7:c35483->_0 _8:c25244->_0 _9:c31566->_0 _a:c4891->_0
into _b [optimize]
at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)

I have looked through the code of FSDirectory
// Inherit javadoc
  public IndexInput openInput(String name, int bufferSize) throws
IOException {
    ensureOpen();
    return new FSIndexInput(new File(directory, name), bufferSize);
  }

Checking further, one would assume that in Win32FileSystem the following
would be not set
	slash =3D ((String) AccessController.doPrivileged(
              new GetPropertyAction("file.separator"))).charAt(0);

Which sounds more than strange to me...

Any idea?

Regards

Uwe Goetzke=20


-----------------------------------------------------------------------
Healy Hudson GmbH - D-55252 Mainz Kastel
Geschaftsfuhrer Christian Konhauser - Amtsgericht Wiesbaden HRB 12076

Diese Email ist vertraulich. Wenn Sie nicht der beabsichtigte Empfanger =
sind, durfen Sie die Informationen nicht offen legen oder benutzen. Wenn =
Sie diese Email durch einen Fehler bekommen haben, teilen Sie uns dies =
bitte umgehend mit, indem Sie diese Email an den Absender =
zuruckschicken. Bitte loschen Sie danach diese Email.
This email is confidential. If you are not the intended recipient, you =
must not disclose or use this information contained in it. If you have =
received this email in error please tell us immediately by return email =
and delete the document.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42084-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 15:41:22 2009
Return-Path: <java-user-return-42084-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1950 invoked from network); 31 Aug 2009 15:41:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 15:41:21 -0000
Received: (qmail 87697 invoked by uid 500); 31 Aug 2009 15:41:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87619 invoked by uid 500); 31 Aug 2009 15:41:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87609 invoked by uid 99); 31 Aug 2009 15:41:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 15:41:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [76.13.9.54] (HELO web65510.mail.ac4.yahoo.com) (76.13.9.54)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 31 Aug 2009 15:41:10 +0000
Received: (qmail 39930 invoked by uid 60001); 31 Aug 2009 15:40:45 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1251733245; bh=C2WbupL120YVKoii4zeUVW/GdM50eVUhM9EB9YNcP8Y=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=Pjy2JBoQ48cMWDCfMcgTP/b6YjP97zFI8cf4xMpVXKMew22S96WcwFHYHzqccMl77tmZN2IrjPdHIcaPP9lz7nZ6QEmyJoxP0Nzsbw32+ToHk6eN48a+wtn7YaZ22GAF+bh3F4hBic2ZzEUPEV8nk9/bzn1xJiMwp+LE6KsMGH8=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=NeMQkDKzBBn/ot2ycjX4UocdxM66VjiFyNkFI3n0GdAp1EhSftn7/4fcJQ6BhqNpBU+7zZX5RvXdDMpMy24n7Dz64Ewa28Hmcc4stvllNKC4+EwpmxAM4cQtSIPrbBQoUTh6vUKJ4i4uUiVtXEINIxO5k+Mded+x6pj6l6x7hHk=;
Message-ID: <434239.30581.qm@web65510.mail.ac4.yahoo.com>
X-YMail-OSG: zbuCI5cVM1mBxKHLvU9sRlEwCItX4MjZ7mvCBEF8BxHCGjccT6hDqkdcCyJBghyDhq5ZQU1s8iwciR1dXsF232TLkBReBNE1lVL5Mxi3GcBkVFJUF4UnXx1yyrZtJcDx.5dt7bpvP3fXH36ZrMADzrpI59CXHF53MHjWCRWyV_exA5tnmxx9nPIKtF.gtMpBJXpQEs5Fb3duoF7LYBNWq9OV_03eCLyZgF9MpApsVtf0.hDKxdXrgcN_m8hJtVsE5nPdKcOBzgGqnjhkNjeuUaRihv3sSRV5ERXpFZSrLAPf1jWip_sKXD7GM7KSP5vDRscYB9mIP1eRIReSGy4FP14X_8tkEc8i3Jr2BTgenkMNC0QlMJQvELH7HU4C8PE5ZJUmv7VZ
Received: from [140.239.67.170] by web65510.mail.ac4.yahoo.com via HTTP; Mon, 31 Aug 2009 08:40:45 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>  <408754.43565.qm@web65504.mail.ac4.yahoo.com> <786fde50908310828gddcfceev3628dceb3602dc2c@mail.gmail.com>
Date: Mon, 31 Aug 2009 08:40:45 -0700 (PDT)
From: Ted Stockwell <emorning@yahoo.com>
Subject: Re: Why perform optimization in 'off hours'?
To: java-user@lucene.apache.org
In-Reply-To: <786fde50908310828gddcfceev3628dceb3602dc2c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks for the reply.
I suspected that was the case, I was just wondering if there was something more to it.



----- Original Message ----
> From: Shai Erera <serera@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Monday, August 31, 2009 10:28:41 AM
> Subject: Re: Why perform optimization in 'off hours'?
> 
> When you run optimize(), you consume CPU and do lots of IO operations which
> can really mess up the OS IO cache. Optimize is a very heavy process and
> therefore is recommended to run at off hours. Sometimes, when your index is
> large enough, it's recommended to run it during weekends, since the
> optimize() process itself may take several hours, so that a nightly job
> won't be enough.
> 
> Shai
> 
> On Mon, Aug 31, 2009 at 6:25 PM, Ted Stockwell wrote:
> 
> > Hi All,
> >
> > I am new to Lucene and I was reading 'Lucene in Action' this weekend.
> > The book recommends that optimization be performed when the index is not in
> > use.
> > The book makes it clear that optimization *may* be performed while indexing
> > but it says that optimizing while indexing makes indexing slower.
> > However, the book does not explain *why* indexing would be slower while
> > optimizing.
> > Since I know that optimization will create new segments and not mess with
> > the old ones, I'm confused as to how optimizing may cause indexing to slow
> > down.
> >
> > Any ideas?
> >
> >
> > Thanks,
> > ted stockwell
> >
> >
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42085-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 15:42:31 2009
Return-Path: <java-user-return-42085-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2217 invoked from network); 31 Aug 2009 15:42:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 15:42:31 -0000
Received: (qmail 89726 invoked by uid 500); 31 Aug 2009 15:42:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89656 invoked by uid 500); 31 Aug 2009 15:42:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89646 invoked by uid 99); 31 Aug 2009 15:42:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 15:42:28 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 15:42:18 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id AB93DD36005
	for <java-user@lucene.apache.org>; Mon, 31 Aug 2009 17:41:55 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id F54mBoz42yZw for <java-user@lucene.apache.org>;
	Mon, 31 Aug 2009 17:41:45 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 6AC97D36002
	for <java-user@lucene.apache.org>; Mon, 31 Aug 2009 17:41:45 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <D7206503EB5BE94497458AF4FE4AE8AB014ADF34@owamz.healy-hudson.com>
Subject: RE: MergePolicy$MergeException because of FileNotFoundException because wrong path to index-file
Date: Mon, 31 Aug 2009 17:41:44 +0200
Message-ID: <FD172D801FC94BF0B59084B5C9A6B026@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
thread-index: AcoqUUVGwZAxBpSXS5Oe5h4MAEYetAAADZ7w
In-Reply-To: <D7206503EB5BE94497458AF4FE4AE8AB014ADF34@owamz.healy-hudson.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Which Lucene Version? The RC2 of 2.9?

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Uwe Goetzke [mailto:uwe.goetzke@healy-hudson.com]
> Sent: Monday, August 31, 2009 5:40 PM
> To: java-user@lucene.apache.org
> Subject: MergePolicy$MergeException because of FileNotFoundException
> because wrong path to index-file
> 
> We have an IndexWriter.optimize running on 4 Proc Xenon Java 1.5 Win2003
> machine.
> We get a repeatable FileNotFoundException because the path to the file
> is wrong:
> 
> D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
> fs
> Instead of
> D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140\_0.
> cfs
> 
> I have no idea what is different here because we use the same code
> successfully on other machines (even multi-core)
> 1. 2009.08.28 13:10:30 :
> [B:600000043][N:org.apache.lucene.index.MergePolicy$MergeException]
> org.apache.lucene.index.MergePolicy$MergeException:
> java.io.FileNotFoundException:
> D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
> fs (The system cannot find the file specified)
> at
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Co
> ncurrentMergeScheduler.java:309)
> at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr
> entMergeScheduler.java:286)
> Caused by: java.io.FileNotFoundException:
> D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
> fs (The system cannot find the file specified)
> at java.io.RandomAccessFile.open(Native Method)
> at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
> at
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDir
> ectory.java:552)
> at
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java
> :582)
> at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> at
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.jav
> a:70)
> at
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> at
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerge
> Scheduler.java:205)
> at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr
> entMergeScheduler.java:260)
> 2. 2009.08.28 13:10:31 : [B:600000043][N:java.io.IOException]
> java.io.IOException: background merge hit exception: _0:c71339->_0
> _1:c36232->_0 _2:c37691->_0 _3:c29335->_0 _4:c29954->_0 _5:c33617->_0
> _6:c37092->_0 _7:c35483->_0 _8:c25244->_0 _9:c31566->_0 _a:c4891->_0
> into _b [optimize]
> at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
> at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
> at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
> 
> I have looked through the code of FSDirectory
> // Inherit javadoc
>   public IndexInput openInput(String name, int bufferSize) throws
> IOException {
>     ensureOpen();
>     return new FSIndexInput(new File(directory, name), bufferSize);
>   }
> 
> Checking further, one would assume that in Win32FileSystem the following
> would be not set
> 	slash = ((String) AccessController.doPrivileged(
>               new GetPropertyAction("file.separator"))).charAt(0);
> 
> Which sounds more than strange to me...
> 
> Any idea?
> 
> Regards
> 
> Uwe Goetzke
> 
> 
> -----------------------------------------------------------------------
> Healy Hudson GmbH - D-55252 Mainz Kastel
> Geschaftsfuhrer Christian Konhauser - Amtsgericht Wiesbaden HRB 12076
> 
> Diese Email ist vertraulich. Wenn Sie nicht der beabsichtigte Empfanger
> sind, durfen Sie die Informationen nicht offen legen oder benutzen. Wenn
> Sie diese Email durch einen Fehler bekommen haben, teilen Sie uns dies
> bitte umgehend mit, indem Sie diese Email an den Absender zuruckschicken.
> Bitte loschen Sie danach diese Email.
> This email is confidential. If you are not the intended recipient, you
> must not disclose or use this information contained in it. If you have
> received this email in error please tell us immediately by return email
> and delete the document.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42086-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 15:46:49 2009
Return-Path: <java-user-return-42086-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3040 invoked from network); 31 Aug 2009 15:46:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 15:46:49 -0000
Received: (qmail 95419 invoked by uid 500); 31 Aug 2009 15:46:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95362 invoked by uid 500); 31 Aug 2009 15:46:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95314 invoked by uid 99); 31 Aug 2009 15:46:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 15:46:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [217.237.170.35] (HELO mzex01.healy-hudson.com) (217.237.170.35)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 15:46:33 +0000
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.4325
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: AW: MergePolicy$MergeException because of FileNotFoundException because wrong path to index-file
Date: Mon, 31 Aug 2009 17:46:09 +0200
Message-ID: <D7206503EB5BE94497458AF4FE4AE8AB014ADF36@owamz.healy-hudson.com>
In-Reply-To: <FD172D801FC94BF0B59084B5C9A6B026@VEGA>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: MergePolicy$MergeException because of FileNotFoundException because wrong path to index-file
thread-index: AcoqUUVGwZAxBpSXS5Oe5h4MAEYetAAADZ7wAAAo1IA=
References: <D7206503EB5BE94497458AF4FE4AE8AB014ADF34@owamz.healy-hudson.com> <FD172D801FC94BF0B59084B5C9A6B026@VEGA>
From: "Uwe Goetzke" <uwe.goetzke@healy-hudson.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Ups, sorry 2.4.1

Thx

 Uwe Goetzke

-----Urspr=FCngliche Nachricht-----
Von: Uwe Schindler [mailto:uwe@thetaphi.de]=20
Gesendet: Montag, 31. August 2009 17:42
An: java-user@lucene.apache.org
Betreff: RE: MergePolicy$MergeException because of FileNotFoundException =
because wrong path to index-file

Which Lucene Version? The RC2 of 2.9?

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Uwe Goetzke [mailto:uwe.goetzke@healy-hudson.com]
> Sent: Monday, August 31, 2009 5:40 PM
> To: java-user@lucene.apache.org
> Subject: MergePolicy$MergeException because of FileNotFoundException
> because wrong path to index-file
>=20
> We have an IndexWriter.optimize running on 4 Proc Xenon Java 1.5 =
Win2003
> machine.
> We get a repeatable FileNotFoundException because the path to the file
> is wrong:
>=20
> =
D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
> fs
> Instead of
> =
D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140\_0.
> cfs
>=20
> I have no idea what is different here because we use the same code
> successfully on other machines (even multi-core)
> 1. 2009.08.28 13:10:30 :
> [B:600000043][N:org.apache.lucene.index.MergePolicy$MergeException]
> org.apache.lucene.index.MergePolicy$MergeException:
> java.io.FileNotFoundException:
> =
D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
> fs (The system cannot find the file specified)
> at
> =
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Co
> ncurrentMergeScheduler.java:309)
> at
> =
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr
> entMergeScheduler.java:286)
> Caused by: java.io.FileNotFoundException:
> =
D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
> fs (The system cannot find the file specified)
> at java.io.RandomAccessFile.open(Native Method)
> at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
> at
> =
org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDir
> ectory.java:552)
> at
> =
org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java
> :582)
> at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> at
> =
org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.jav
> a:70)
> at
> =
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> at
> =
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerge
> Scheduler.java:205)
> at
> =
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr
> entMergeScheduler.java:260)
> 2. 2009.08.28 13:10:31 : [B:600000043][N:java.io.IOException]
> java.io.IOException: background merge hit exception: _0:c71339->_0
> _1:c36232->_0 _2:c37691->_0 _3:c29335->_0 _4:c29954->_0 _5:c33617->_0
> _6:c37092->_0 _7:c35483->_0 _8:c25244->_0 _9:c31566->_0 _a:c4891->_0
> into _b [optimize]
> at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
> at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
> at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>=20
> I have looked through the code of FSDirectory
> // Inherit javadoc
>   public IndexInput openInput(String name, int bufferSize) throws
> IOException {
>     ensureOpen();
>     return new FSIndexInput(new File(directory, name), bufferSize);
>   }
>=20
> Checking further, one would assume that in Win32FileSystem the =
following
> would be not set
> 	slash =3D ((String) AccessController.doPrivileged(
>               new GetPropertyAction("file.separator"))).charAt(0);
>=20
> Which sounds more than strange to me...
>=20
> Any idea?
>=20
> Regards
>=20
> Uwe Goetzke
>=20
>=20
> =
-----------------------------------------------------------------------
> Healy Hudson GmbH - D-55252 Mainz Kastel
> Geschaftsfuhrer Christian Konhauser - Amtsgericht Wiesbaden HRB 12076
>=20
> Diese Email ist vertraulich. Wenn Sie nicht der beabsichtigte =
Empfanger
> sind, durfen Sie die Informationen nicht offen legen oder benutzen. =
Wenn
> Sie diese Email durch einen Fehler bekommen haben, teilen Sie uns dies
> bitte umgehend mit, indem Sie diese Email an den Absender =
zuruckschicken.
> Bitte loschen Sie danach diese Email.
> This email is confidential. If you are not the intended recipient, you
> must not disclose or use this information contained in it. If you have
> received this email in error please tell us immediately by return =
email
> and delete the document.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


-----------------------------------------------------------------------
Healy Hudson GmbH - D-55252 Mainz Kastel
Gesch=E4ftsf=FChrer Christian Konh=E4user - Amtsgericht Wiesbaden HRB =
12076

Diese Email ist vertraulich. Wenn Sie nicht der beabsichtigte =
Empf=E4nger sind, d=FCrfen Sie die Informationen nicht offen legen oder =
benutzen. Wenn Sie diese Email durch einen Fehler bekommen haben, teilen =
Sie uns dies bitte umgehend mit, indem Sie diese Email an den Absender =
zur=FCckschicken. Bitte l=F6schen Sie danach diese Email.
This email is confidential. If you are not the intended recipient, you =
must not disclose or use this information contained in it. If you have =
received this email in error please tell us immediately by return email =
and delete the document.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42087-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Aug 31 22:40:56 2009
Return-Path: <java-user-return-42087-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29327 invoked from network); 31 Aug 2009 22:40:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Aug 2009 22:40:55 -0000
Received: (qmail 5235 invoked by uid 500); 31 Aug 2009 22:40:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5148 invoked by uid 500); 31 Aug 2009 22:40:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5138 invoked by uid 99); 31 Aug 2009 22:40:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 22:40:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.204] (HELO mail-yx0-f204.google.com) (209.85.210.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 31 Aug 2009 22:40:43 +0000
Received: by yxe42 with SMTP id 42so1137682yxe.20
        for <java-user@lucene.apache.org>; Mon, 31 Aug 2009 15:40:22 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.47.12 with SMTP id u12mr8880801ybu.332.1251758422183; Mon, 
	31 Aug 2009 15:40:22 -0700 (PDT)
In-Reply-To: <D7206503EB5BE94497458AF4FE4AE8AB014ADF34@owamz.healy-hudson.com>
References: <D7206503EB5BE94497458AF4FE4AE8AB014ADF34@owamz.healy-hudson.com>
Date: Mon, 31 Aug 2009 18:40:22 -0400
Message-ID: <9ac0c6aa0908311540j30365fd2p5188ebc1c4acb2fa@mail.gmail.com>
Subject: Re: MergePolicy$MergeException because of FileNotFoundException 
	because wrong path to index-file
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

This is very strange.

On that machine if you make a tiny standalone test that eg calls:

  (new File(directory, name)).exists()

does it work properly?

Mike

On Mon, Aug 31, 2009 at 11:39 AM, Uwe
Goetzke<uwe.goetzke@healy-hudson.com> wrote:
> We have an IndexWriter.optimize running on 4 Proc Xenon Java 1.5 Win2003
> machine.
> We get a repeatable FileNotFoundException because the path to the file
> is wrong:
>
> D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
> fs
> Instead of
> D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140\_0.
> cfs
>
> I have no idea what is different here because we use the same code
> successfully on other machines (even multi-core)
> 1. 2009.08.28 13:10:30 :
> [B:600000043][N:org.apache.lucene.index.MergePolicy$MergeException]
> org.apache.lucene.index.MergePolicy$MergeException:
> java.io.FileNotFoundException:
> D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
> fs (The system cannot find the file specified)
> at
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Co
> ncurrentMergeScheduler.java:309)
> at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr
> entMergeScheduler.java:286)
> Caused by: java.io.FileNotFoundException:
> D:\data0\impact\ordering\prod\work\search_index\s_index1251456210140_0.c
> fs (The system cannot find the file specified)
> at java.io.RandomAccessFile.open(Native Method)
> at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
> at
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDir
> ectory.java:552)
> at
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java
> :582)
> at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> at
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.jav
> a:70)
> at
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> at
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerge
> Scheduler.java:205)
> at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr
> entMergeScheduler.java:260)
> 2. 2009.08.28 13:10:31 : [B:600000043][N:java.io.IOException]
> java.io.IOException: background merge hit exception: _0:c71339->_0
> _1:c36232->_0 _2:c37691->_0 _3:c29335->_0 _4:c29954->_0 _5:c33617->_0
> _6:c37092->_0 _7:c35483->_0 _8:c25244->_0 _9:c31566->_0 _a:c4891->_0
> into _b [optimize]
> at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
> at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
> at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>
> I have looked through the code of FSDirectory
> // Inherit javadoc
> =A0public IndexInput openInput(String name, int bufferSize) throws
> IOException {
> =A0 =A0ensureOpen();
> =A0 =A0return new FSIndexInput(new File(directory, name), bufferSize);
> =A0}
>
> Checking further, one would assume that in Win32FileSystem the following
> would be not set
> =A0 =A0 =A0 =A0slash =3D ((String) AccessController.doPrivileged(
> =A0 =A0 =A0 =A0 =A0 =A0 =A0new GetPropertyAction("file.separator"))).char=
At(0);
>
> Which sounds more than strange to me...
>
> Any idea?
>
> Regards
>
> Uwe Goetzke
>
>
> -----------------------------------------------------------------------
> Healy Hudson GmbH - D-55252 Mainz Kastel
> Geschaftsfuhrer Christian Konhauser - Amtsgericht Wiesbaden HRB 12076
>
> Diese Email ist vertraulich. Wenn Sie nicht der beabsichtigte Empfanger s=
ind, durfen Sie die Informationen nicht offen legen oder benutzen. Wenn Sie=
 diese Email durch einen Fehler bekommen haben, teilen Sie uns dies bitte u=
mgehend mit, indem Sie diese Email an den Absender zuruckschicken. Bitte lo=
schen Sie danach diese Email.
> This email is confidential. If you are not the intended recipient, you mu=
st not disclose or use this information contained in it. If you have receiv=
ed this email in error please tell us immediately by return email and delet=
e the document.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


