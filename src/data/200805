From java-user-return-33854-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 01:19:33 2008
Return-Path: <java-user-return-33854-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86822 invoked from network); 1 May 2008 01:19:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 01:19:33 -0000
Received: (qmail 50534 invoked by uid 500); 1 May 2008 01:19:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50497 invoked by uid 500); 1 May 2008 01:19:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50486 invoked by uid 99); 1 May 2008 01:19:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Apr 2008 18:19:27 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [87.248.110.148] (HELO n31.bullet.mail.ukl.yahoo.com) (87.248.110.148)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 01 May 2008 01:18:41 +0000
Received: from [217.146.182.177] by n31.bullet.mail.ukl.yahoo.com with NNFMP; 01 May 2008 01:18:53 -0000
Received: from [87.248.110.119] by t3.bullet.ukl.yahoo.com with NNFMP; 01 May 2008 01:18:53 -0000
Received: from [127.0.0.1] by omp224.mail.ukl.yahoo.com with NNFMP; 01 May 2008 01:18:53 -0000
X-Yahoo-Newman-Id: 547214.67510.bm@omp224.mail.ukl.yahoo.com
Received: (qmail 56965 invoked from network); 30 Apr 2008 22:21:07 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Received:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:Date:From:User-Agent:MIME-Version:To:Subject:References:In-Reply-To:Content-Type:Content-Transfer-Encoding;
  b=qzhJ/RvAZxgNAtODh2DbXMT9TCzNfF/5FaG0wR/fIlvvkPQ7REaiNGxONkRzgTInmLhfIMiOufEjGNEqpi82hQdsPJxjFvljQgmEysoEhUSsoo0qF/A24tRmZL4Bodi9snVzu4yecbQ0qwE3ogVT+kMdtDCiJ00nY1Q8T1fQJuU=  ;
Received: from unknown (HELO ?10.0.0.1?) (markharw00d@194.106.34.5 with plain)
  by smtp107.mail.ukl.yahoo.com with SMTP; 30 Apr 2008 22:21:07 -0000
X-YMail-OSG: P8YnDXkVM1mxdKjU0p67zG5E7ScnkrmpHm.2x1dYHzKq2wyhLkutIxYIopWvCxVi0qG9q_AU.zo8BBZ0ztYe7Oaa0ySxsyqO7LaGJil9bog4KDSqbRBdfoLgJwD2_wdAfyg-
X-Yahoo-Newman-Property: ymail-3
Message-ID: <4818F0D9.3050702@yahoo.co.uk>
Date: Wed, 30 Apr 2008 23:21:13 +0100
From: markharw00d <markharw00d@yahoo.co.uk>
User-Agent: Thunderbird 2.0.0.12 (Windows/20080213)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Please help with Gradient Formatter
References: <b0aae42b0804292141i421db14y2f790b7117c70a3d@mail.gmail.com>
In-Reply-To: <b0aae42b0804292141i421db14y2f790b7117c70a3d@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Here you go:

        Analyzer a=new StandardAnalyzer();
        //open an index
        String textFieldName="contents";
        IndexReader reader=IndexReader.open("E:/indexes/uksites");
        IndexSearcher searcher=new IndexSearcher(reader);       
        QueryParser qp=new QueryParser(textFieldName,a);
        //create a query (note one word is rarer than the other)
        Query q=qp.parse("football club");
               
        //Create a query scorer (passing a reader so that it can weight 
terms based on doc frequency)
        QueryScorer fragScorer = new QueryScorer(q,reader,"contents");
        //callibrate the scoring range based on best (ie rarest) search term
        float topScore=fragScorer.getMaxTermWeight();
        //Create a gradient formatter with appropriate color ranges
        GradientFormatter formatter=new 
GradientFormatter(topScore,"#888888","#ff8888","#ffffff",
        "#ffffff");
        //create the highlighter
        Highlighter highlighter=new Highlighter(formatter,fragScorer);
        //run the query and highlight the results - graded by color to 
reflect value of match
        Hits hits = searcher.search(q);
        int numToShow=Math.min(10,hits.length());
        for (int i = 0; i < numToShow; i++)
        {
            String text=hits.doc(i).get(textFieldName);
             TokenStream tokenStream = a.tokenStream(textFieldName, new 
StringReader(text));
             String highlightText = 
highlighter.getBestFragments(tokenStream, text, 2, "...");
             System.out.println("["+i+"="+hits.score(i)+"]"+highlightText);
        }
        

Cheers,
Mark


Mohammad Hasan wrote:
> Dear all,
>
>
>
> I need a working example of Gradient Formatter. I want to highlight a
> searched word after it is found in the database. I am using NHibernate
> Search & Lucene. But I am an entrly level programmer, so I do not know how
> to use Gradient Formatter. There are plenty of examples of HTML Formatter
> but no example for Gradient Formatter. Gradient Formatter asks for 5
> arguments, that is where I run into troubles. I do not understand these 5
> arguments. Instead of giving explanation, please post a working example of
> Gradient Formatter of Highlighter which will highlight a searched word after
> it is found in a database. Thanks.
>
> Hasan
>
>   
> ------------------------------------------------------------------------
>
> No virus found in this incoming message.
> Checked by AVG. 
> Version: 7.5.524 / Virus Database: 269.23.6/1403 - Release Date: 29/04/2008 07:26
>   



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33855-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 01:20:01 2008
Return-Path: <java-user-return-33855-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86992 invoked from network); 1 May 2008 01:20:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 01:20:01 -0000
Received: (qmail 52148 invoked by uid 500); 1 May 2008 01:19:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52114 invoked by uid 500); 1 May 2008 01:19:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52103 invoked by uid 99); 1 May 2008 01:19:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Apr 2008 18:19:55 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.57] (HELO web50303.mail.re2.yahoo.com) (206.190.38.57)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 01 May 2008 01:18:58 +0000
Received: (qmail 12909 invoked by uid 60001); 1 May 2008 01:19:19 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=HjbnlxtPynDM0Cf+ThBR2SbPBnOOSyn85UVyvbMpeAQaD1maui6o3RlvQ7znk2fkVlaW1Y6PgF+6ISvPx2E94Nsrbx2GgXViadV9kimSdeqh0BalU2QoZXAQZjmVv1eS3Rocr/YQUrEgNxZX37rotE76w4wc72ROJYy4QvMMcm8=;
Received: from [72.231.9.236] by web50303.mail.re2.yahoo.com via HTTP; Wed, 30 Apr 2008 18:19:18 PDT
X-Mailer: YahooMailRC/902.40 YahooMailWebService/0.7.185
Date: Wed, 30 Apr 2008 18:19:18 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: ParalleReader and synchronization between indexes
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <50424.12811.qm@web50303.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Bravo Grant!

Rajesh, I believe the following will work:
- delete your small index
- optimize your big index  (needed?  Not 100% sure, but I think it is)
- loop through the docs in your "big" index
- for each document in the big index, add a document to the small index

When you are done you have big+small with docIDs in sync.

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch

----- Original Message ----
> From: Grant Ingersoll <gsingers@apache.org>
> To: java-user@lucene.apache.org
> Sent: Wednesday, April 30, 2008 5:48:33 PM
> Subject: Re: ParalleReader and synchronization between indexes
> 
> Rajesh,
> 
> You are asking a fairly complicated question on a seldom used piece of  
> functionality.  Constantly pinging the list is just making it less  
> likely that someone will respond with an answer.  The likelihood that  
> the 1 person who understand that code (and trust me, it really is  
> likely very few people who know how to practically employ it) enough  
> to give practical advice have read it in the time period you have  
> alloted us to respond is next to nil.   We are all volunteers with day  
> jobs.
> 
> Have you bothered to search the dev and user mailing list for  
> information on the class in question?  I would look for threads from  
> Doug or Chuck Williams.
> 
> -Grant
> 
> 
> On Apr 30, 2008, at 5:00 PM, Rajesh parab wrote:
> 
> > Hi Guys,
> >
> > Any comments on this?
> >
> > I was looking into Lucene archive and came across this
> > thread what asks the same question.
> >
> > 
> http://www.gossamer-threads.com/lists/lucene/java-user/50477?search_string=parallelreader;#50477
> >
> > Any pointers will be helpful.
> >
> > Regards,
> > Rajesh
> >
> > --- Rajesh parab  wrote:
> >
> >> Hi All,
> >>
> >> Any suggestions/comments on my questions in this
> >> thread will be really helpful.
> >>
> >> We are planning to use Lucene indexes throughout the
> >> application and exploring possibilites of
> >> partitioning
> >> data between multiple indexes.
> >>
> >> Regards,
> >> Rajesh
> >>
> >> --- Rajesh parab  wrote:
> >>
> >>> Hi,
> >>>
> >>> This is from javadoc of ParallelReader:
> >>>
> >>>
> >>
> > ======================================================
> >>>
> >>> An IndexReader which reads multiple, parallel
> >>> indexes.
> >>> Each index added must have the same number of
> >>> documents, but typically each contains different
> >>> fields. Each document contains the union of the
> >>> fields
> >>> of all documents with the same document number.
> >> When
> >>> searching, matches for a query term are from the
> >>> first
> >>> index added that has the field.
> >>>
> >>> This is useful, e.g., with collections that have
> >>> large
> >>> fields which change rarely and small fields that
> >>> change more frequently. The smaller fields may be
> >>> re-indexed in a new index and both indexes may be
> >>> searched together.
> >>>
> >>>
> >>
> > ======================================================
> >>>
> >>> I have a similar use case as mentioned above and
> >>> hence
> >>> would like to use ParallelReader to search across
> >>> multiple indexes.
> >>>
> >>> I have an object that has 50 fields. Out of these
> >> 50
> >>> fields, 45 are relatively static and other 5 are
> >>> modified very often. So, I am planning to
> >> partition
> >>> this objects data into 2 indexes such that 45
> >> static
> >>> fields will be part of one index and remaining 5
> >>> dynamic fields will constitute second index. While
> >>> generating the index for the first time, I can
> >> make
> >>> sure that the document order for documents inside
> >>> both
> >>> these indexes is same and hence ParallelReader
> >> will
> >>> work properly with it.
> >>>
> >>> The question is -
> >>> What if the data inside second (smaller) index
> >>> changes? In order to update index document, I will
> >>> have to delete it and re-insert it again as Lucene
> >>> does not support document update. This action (of
> >>> delete and re-insert) will change internal
> >> document
> >>> id
> >>> for updated document inside second index and in
> >>> order
> >>> to sync it with first index, I will have to also
> >>> modify first (relatively big and static) index. If
> >>> we
> >>> will have to update both the indexes, how it is
> >>> different from having a single index with all the
> >>> fields? What is the use case in which
> >> ParallelReader
> >>> will get used? As per documentation, I was
> >> thinking
> >>> that it will apply for my use case, but
> >>> synchronizing
> >>> the indexes seems to be a problem.
> >>>
> >>> Please help.
> >>>
> >>> Regards,
> >>> Rajesh
> >>>
> >>>
> >>>
> >>>
> >>>
> >>
> > 
> ____________________________________________________________________________________
> >>> Be a better friend, newshound, and
> >>> know-it-all with Yahoo! Mobile.  Try it now.
> >>>
> >>
> > http://mobile.yahoo.com/;_ylt=Ahu06i62sR8HDtDypao8Wcj9tAcJ
> >>>
> >>>
> >>
> > ---------------------------------------------------------------------
> >>> To unsubscribe, e-mail:
> >>> java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail:
> >>> java-user-help@lucene.apache.org
> >>>
> >>>
> >>
> >>
> >>
> >>
> >>
> > 
> ____________________________________________________________________________________
> >> Be a better friend, newshound, and
> >> know-it-all with Yahoo! Mobile.  Try it now.
> >>
> > http://mobile.yahoo.com/;_ylt=Ahu06i62sR8HDtDypao8Wcj9tAcJ
> >>
> >>
> > ---------------------------------------------------------------------
> >> To unsubscribe, e-mail:
> >> java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail:
> >> java-user-help@lucene.apache.org
> >>
> >>
> >
> >
> >
> >       
> > 
> ____________________________________________________________________________________
> > Be a better friend, newshound, and
> > know-it-all with Yahoo! Mobile.  Try it now.  
> http://mobile.yahoo.com/;_ylt=Ahu06i62sR8HDtDypao8Wcj9tAcJ
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> 
> --------------------------
> Grant Ingersoll
> 
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
> 
> 
> 
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33856-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 02:25:14 2008
Return-Path: <java-user-return-33856-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5949 invoked from network); 1 May 2008 02:25:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 02:25:13 -0000
Received: (qmail 82701 invoked by uid 500); 1 May 2008 02:25:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82668 invoked by uid 500); 1 May 2008 02:25:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82657 invoked by uid 99); 1 May 2008 02:25:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Apr 2008 19:25:08 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 74.125.46.28 as permitted sender)
Received: from [74.125.46.28] (HELO yw-out-2324.google.com) (74.125.46.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 02:24:24 +0000
Received: by yw-out-2324.google.com with SMTP id 9so531148ywe.5
        for <java-user@lucene.apache.org>; Wed, 30 Apr 2008 19:24:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=ZNj/Mg0jzO95P6oQy1psLGjN64qhgUYP94JluqHpDuk=;
        b=x1X1vth/wkVfqF1XfxS+UjGJFOlsnrrzvEPxPO93u1LPxS7fbnn/oE8Q1VOoZSbEEmzh9pnk/bzt4dQrIU8VBIP6ABGHrc1TB/aeBDmcFwGi2lPCkxi+NaGAMmkue5ps3mVdEAsaJqRndnL2OFr+qb2z723YLk2ooItBhYUBmao=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=Uy+G4iFaPf3+aYk5j/1Har81REwHA/D4PvhGo/WmcjFWTIoOuaJrZr1J0i3Kpr43DsZFh9TZXbx3wQUMyTt67pF446uUh/W24PljgfbrpoWSTI7DYJd1LIz4DsMimuNuNtfOe/ZilXXL4wC7WSkXcIOeDVgRBZ2x2laojLEs/LU=
Received: by 10.150.50.2 with SMTP id x2mr1923315ybx.34.1209608677904;
        Wed, 30 Apr 2008 19:24:37 -0700 (PDT)
Received: by 10.151.41.21 with HTTP; Wed, 30 Apr 2008 19:24:37 -0700 (PDT)
Message-ID: <c68e39170804301924w34f30595o548c984e19d17ad7@mail.gmail.com>
Date: Wed, 30 Apr 2008 22:24:37 -0400
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: Does Lucene Supports Billions of data
In-Reply-To: <200805010910.04480.daniel@nuix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <16974808.post@talk.nabble.com>
	 <5e76f3840804300646y7d230aa3xb7827193fe441b4d@mail.gmail.com>
	 <8837fb770804300701v74791ce0h6c1bf359b801e473@mail.gmail.com>
	 <200805010910.04480.daniel@nuix.com>
X-Google-Sender-Auth: d033288a05c7ef63
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Apr 30, 2008 at 7:10 PM, Daniel Noll <daniel@nuix.com> wrote:
> On Thursday 01 May 2008 00:01:48 John Wang wrote:
>  > I am not sure how well lucene would perform with > 2 Billion docs in a
>  > single index anyway.
>
>  Even if they're in multiple indexes, the doc IDs being ints will still prevent
>  it going past 2Gi unless you wrap your own framework around it.

Righ.
Solr's distributed search does use "long" where appropriate, and
should be able to scale past 2B docs.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33857-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 02:52:51 2008
Return-Path: <java-user-return-33857-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12009 invoked from network); 1 May 2008 02:52:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 02:52:51 -0000
Received: (qmail 425 invoked by uid 500); 1 May 2008 02:52:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 385 invoked by uid 500); 1 May 2008 02:52:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 373 invoked by uid 99); 1 May 2008 02:52:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Apr 2008 19:52:44 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.253] (HELO web52006.mail.re2.yahoo.com) (206.190.49.253)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 01 May 2008 02:51:48 +0000
Received: (qmail 79380 invoked by uid 60001); 1 May 2008 02:52:08 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=FvRG5v3J1jljSxhKyzu8UK+V1Q63B15ls98ntPkvS85gaRuEPbjpEMUzJH3BSNmIIWnP4vHsrhKRgNjNry2G9tMcKeMUqozFFWi11zzQxYYRvyYJ+Tasm9AQ94NI8FMklV/YLKMnQuu+HqET2CrjLjWWsiyA3r/641OZRurJ7j8=;
X-YMail-OSG: nziyA44VM1n5u5fdeLjxhe49BQkBDCjWVYq6eCwL5IyPLOMj9uRKWM1ZGTjxqIBM1ZHjUO9.CZnoAu9xIFSDpXpZPurjB2cTuHmY9axaulng8AS6IJYyElp63vY-
Received: from [12.162.3.126] by web52006.mail.re2.yahoo.com via HTTP; Wed, 30 Apr 2008 19:52:08 PDT
Date: Wed, 30 Apr 2008 19:52:08 -0700 (PDT)
From: Rajesh parab <rajesh_parab_1@yahoo.com>
Subject: Re: ParalleReader and synchronization between indexes
To: java-user@lucene.apache.org
In-Reply-To: <50424.12811.qm@web50303.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
Message-ID: <567106.78534.qm@web52006.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

My apologies for quick follow-ups and thanks for
pointers/suggestions Grant and Otis.

I did check various threads on Java user forum around
this topic, but could not find a solution. Some most
relevant topics that end with same question I am
currently having.

http://www.gossamer-threads.com/lists/lucene/java-user/15063?search_string=parallelreader;#15063
http://www.gossamer-threads.com/lists/lucene/java-user/31435?search_string=parallelreader;#31435
http://www.gossamer-threads.com/lists/lucene/java-user/50164?search_string=parallelreader;#50164


Otis,
During incremental indexing, option of re-creating
second index entirely will not work well in our case
as we will be dealing with millions of documents.

I am sorry for creating confusion by referring index
as "small" index. I should have referred to it as
index with less no of fields, which change very often.

So, if first index with large no fields is not
changing and second index with small set of fields
requires constant updates due to frequent changes, is
there a way to keep document ids of both indexes in
sync without either re-creating second index entirely
or modifying both indexes? Can we somehow keep
internal document id same after updating (i.e. delete
and re-insert) index document?

Regards,
Rajesh

--- Otis Gospodnetic <otis_gospodnetic@yahoo.com>
wrote:

> Bravo Grant!
> 
> Rajesh, I believe the following will work:
> - delete your small index
> - optimize your big index  (needed?  Not 100% sure,
> but I think it is)
> - loop through the docs in your "big" index
> - for each document in the big index, add a document
> to the small index
> 
> When you are done you have big+small with docIDs in
> sync.
> 
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr -
> Nutch
> 
> ----- Original Message ----
> > From: Grant Ingersoll <gsingers@apache.org>
> > To: java-user@lucene.apache.org
> > Sent: Wednesday, April 30, 2008 5:48:33 PM
> > Subject: Re: ParalleReader and synchronization
> between indexes
> > 
> > Rajesh,
> > 
> > You are asking a fairly complicated question on a
> seldom used piece of  
> > functionality.  Constantly pinging the list is
> just making it less  
> > likely that someone will respond with an answer. 
> The likelihood that  
> > the 1 person who understand that code (and trust
> me, it really is  
> > likely very few people who know how to practically
> employ it) enough  
> > to give practical advice have read it in the time
> period you have  
> > alloted us to respond is next to nil.   We are all
> volunteers with day  
> > jobs.
> > 
> > Have you bothered to search the dev and user
> mailing list for  
> > information on the class in question?  I would
> look for threads from  
> > Doug or Chuck Williams.
> > 
> > -Grant
> > 
> > 
> > On Apr 30, 2008, at 5:00 PM, Rajesh parab wrote:
> > 
> > > Hi Guys,
> > >
> > > Any comments on this?
> > >
> > > I was looking into Lucene archive and came
> across this
> > > thread what asks the same question.
> > >
> > > 
> >
>
http://www.gossamer-threads.com/lists/lucene/java-user/50477?search_string=parallelreader;#50477
> > >
> > > Any pointers will be helpful.
> > >
> > > Regards,
> > > Rajesh
> > >
> > > --- Rajesh parab  wrote:
> > >
> > >> Hi All,
> > >>
> > >> Any suggestions/comments on my questions in
> this
> > >> thread will be really helpful.
> > >>
> > >> We are planning to use Lucene indexes
> throughout the
> > >> application and exploring possibilites of
> > >> partitioning
> > >> data between multiple indexes.
> > >>
> > >> Regards,
> > >> Rajesh
> > >>
> > >> --- Rajesh parab  wrote:
> > >>
> > >>> Hi,
> > >>>
> > >>> This is from javadoc of ParallelReader:
> > >>>
> > >>>
> > >>
> > >
>
======================================================
> > >>>
> > >>> An IndexReader which reads multiple, parallel
> > >>> indexes.
> > >>> Each index added must have the same number of
> > >>> documents, but typically each contains
> different
> > >>> fields. Each document contains the union of
> the
> > >>> fields
> > >>> of all documents with the same document
> number.
> > >> When
> > >>> searching, matches for a query term are from
> the
> > >>> first
> > >>> index added that has the field.
> > >>>
> > >>> This is useful, e.g., with collections that
> have
> > >>> large
> > >>> fields which change rarely and small fields
> that
> > >>> change more frequently. The smaller fields may
> be
> > >>> re-indexed in a new index and both indexes may
> be
> > >>> searched together.
> > >>>
> > >>>
> > >>
> > >
>
======================================================
> > >>>
> > >>> I have a similar use case as mentioned above
> and
> > >>> hence
> > >>> would like to use ParallelReader to search
> across
> > >>> multiple indexes.
> > >>>
> > >>> I have an object that has 50 fields. Out of
> these
> > >> 50
> > >>> fields, 45 are relatively static and other 5
> are
> > >>> modified very often. So, I am planning to
> > >> partition
> > >>> this objects data into 2 indexes such that 45
> > >> static
> > >>> fields will be part of one index and remaining
> 5
> > >>> dynamic fields will constitute second index.
> While
> > >>> generating the index for the first time, I can
> > >> make
> > >>> sure that the document order for documents
> inside
> > >>> both
> > >>> these indexes is same and hence ParallelReader
> > >> will
> > >>> work properly with it.
> > >>>
> > >>> The question is -
> > >>> What if the data inside second (smaller) index
> > >>> changes? In order to update index document, I
> will
> > >>> have to delete it and re-insert it again as
> Lucene
> > >>> does not support document update. This action
> (of
> > >>> delete and re-insert) will change internal
> > >> document
> > >>> id
> > >>> for updated document inside second index and
> in
> > >>> order
> > >>> to sync it with first index, I will have to
> also
> > >>> modify first (relatively big and static)
> index. If
> > >>> we
> > >>> will have to update both the indexes, how it
> is
> > >>> different from having a single index with all
> the
> > >>> fields? What is the use case in which
> > >> ParallelReader
> > >>> will get used? As per documentation, I was
> > >> thinking
> > >>> that it will apply for my use case, but
> > >>> synchronizing
> > >>> the indexes seems to be a problem.
> > >>>
> > >>> Please help.
> > >>>
> > >>> Regards,
> > >>> Rajesh
> > >>>
> > >>>
> > >>>
> > >>>
> > >>>
> > >>
> 
=== message truncated ===



      ____________________________________________________________________________________
Be a better friend, newshound, and 
know-it-all with Yahoo! Mobile.  Try it now.  http://mobile.yahoo.com/;_ylt=Ahu06i62sR8HDtDypao8Wcj9tAcJ

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33858-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 07:08:53 2008
Return-Path: <java-user-return-33858-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3991 invoked from network); 1 May 2008 07:08:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 07:08:52 -0000
Received: (qmail 30152 invoked by uid 500); 1 May 2008 07:08:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30126 invoked by uid 500); 1 May 2008 07:08:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30115 invoked by uid 99); 1 May 2008 07:08:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 00:08:42 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 07:07:56 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JrStm-0005Yr-5P
	for java-user@lucene.apache.org; Thu, 01 May 2008 00:08:10 -0700
Message-ID: <16993041.post@talk.nabble.com>
Date: Thu, 1 May 2008 00:08:10 -0700 (PDT)
From: esra <esraersan@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: lucene farsi problem
In-Reply-To: <9294E20AED46934EA459020706463F94A049F6@SUEXCL-02.ad.syr.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: esraersan@gmail.com
References: <16977096.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A049F6@SUEXCL-02.ad.syr.edu>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Steve,

thanks for your reply , i know farsi is written and read right-to-left.
i am using RangeOuery class and it's rewrite(IndexReader reader) method
decides if the word is in range or not by compareTo method and this decisio=
n
is made by using unicodes.

while searching for "=D8=AF-=DA=98" range the lowerTerm is "=D8=AF" and  th=
e upperTerm is
"=DA=98".=20
And while comparing for the result "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=
=D8=B1" also takes the first letter as
=D8=B3 and does the comparison for this letter.

 =D8=AF=3DU+62F
 =DA=98 =3D U+698
 and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1 " is =
 =D8=B3 =3D U+633

Esra,


Steven A Rowe wrote:
>=20
> Hi Esra,
>=20
> Caveat: I don't speak, read, write, or dream in Farsi - I just know that
> it mostly shares its orthography with Arabic, and that they are both
> written and read right-to-left.
>=20
> How are you constructing the queries?  Using QueryParser?  If so, then I
> suspect the problem is that you intend the range you supply to be read
> entirely right-to-left, but Lucene instead reads it left-to-right.  Have
> you tried using e.g. "=D8=AF-=DA=98" instead of "=D8=AF-=DA=98"?  (That i=
s, placing the lower
> valued term on the left instead of the right.)
>=20
> AFAICT, RangeFilter (called from ConstantScoreRangeQuery, which is called
> from QueryParser) does not test whether lowerTerm is in fact lower than
> upperTerm.  If it turns out that the problem is simply one of order, it
> might make sense to modify RangeFilter so that it flip them when lowerTer=
m
> > upperTerm.
>=20
> Steve
>=20
> On 04/30/2008 at 3:21 AM, esra wrote:
>>=20
>> hi,
>>=20
>> i am using lucene's "IndexSearcher" to search the given xml
>> by keyword which
>> contains farsi information.
>> while searching i use ranges like
>>=20
>> =D8=A2-=D8=AB  |  =D8=AC-=D8=AE  |  =D8=AF-=DA=98  |  =D8=B3-=D8=B8  |  =
=D8=B9-=D9=82  |  =DA=A9-=D9=84  |  =D9=85-=DB=8C
>>=20
>> when i do search for  "=D8=AF-=DA=98"  range the results are wrong ,
>> they are the
>> results of  " =D8=B3-=D8=B8 "range.
>>=20
>> for example when i do search for "=D8=AF-=DA=98"  one of the the
>> results is "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1"
>> , this result also shown on the " =D8=B3-=D8=B8 " range's result list
>> which is the
>> corret range.
>>=20
>> As IndexSearcher use "compareTo" method and this method uses
>> unicodes for
>> comparing, i found the unicodes of the characters.
>>=20
>> =D8=AF=3DU+62F
>> =DA=98 =3D U+698
>> and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1 " i=
s  =D8=B3 =3D U+633
>>=20
>> Do you have any idea how to solve this problem, there are
>> analyzers for
>> different languages ,
>> will this be usefull if so do you know where to find a farsi analyzer?
>>=20
>> I would bu glad if you help.
>>=20
>> thanks ,
>>=20
>> Esra
>>=20
>> -- View this message in context:
>> http://www.nabble.com/lucene-farsi-problem-tp16977096p16977096.html Sent
>> from the Lucene - Java Users mailing list archive at Nabble.com.
>>=20
>>=20
>> --------------------------------------------------------------------- To
>> unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org For
>> additional commands, e-mail: java-user-help@lucene.apache.org
>>=20
>>
>=20
> =20
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/lucene-farsi-problem-tp=
16977096p16993041.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33859-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 07:33:51 2008
Return-Path: <java-user-return-33859-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7535 invoked from network); 1 May 2008 07:33:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 07:33:51 -0000
Received: (qmail 42536 invoked by uid 500); 1 May 2008 07:33:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42509 invoked by uid 500); 1 May 2008 07:33:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42498 invoked by uid 99); 1 May 2008 07:33:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 00:33:46 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of spring@gmx.eu designates 213.165.64.20 as permitted sender)
Received: from [213.165.64.20] (HELO mail.gmx.net) (213.165.64.20)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 01 May 2008 07:33:01 +0000
Received: (qmail invoked by alias); 01 May 2008 07:33:12 -0000
Received: from e178069169.adsl.alicedsl.de (EHLO msrvcn04) [85.178.69.169]
  by mail.gmx.net (mp025) with SMTP; 01 May 2008 09:33:12 +0200
X-Authenticated: #2635966
X-Provags-ID: V01U2FsdGVkX187xiEvdwk7FoHdTy6CG+DDDA8FsWh5EaRBgAvTyo
	cKxf2HaIsMjf5e
From: <spring@gmx.eu>
To: <java-user@lucene.apache.org>
References: <16974808.post@talk.nabble.com> <5e76f3840804300646y7d230aa3xb7827193fe441b4d@mail.gmail.com> <8837fb770804300701v74791ce0h6c1bf359b801e473@mail.gmail.com> <200805010910.04480.daniel@nuix.com>
Subject: RE: Does Lucene Supports Billions of data
Date: Thu, 1 May 2008 09:33:13 +0200
Message-ID: <E09AF0CFC18B4DB39DA22567471FC92B@msrvcn04>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: AcirF7WiAhyKdDdaQ26nwM2KHQaciAARY++g
In-Reply-To: <200805010910.04480.daniel@nuix.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.4133
X-Y-GMX-Trusted: 0
X-Virus-Checked: Checked by ClamAV on apache.org

> Even if they're in multiple indexes, the doc IDs being ints 
> will still prevent 
> it going past 2Gi unless you wrap your own framework around it.

Hm. Does this mean that a MultiReader has the int-limit too?
I thought that this limit applies to a single index only...


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33860-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 08:01:14 2008
Return-Path: <java-user-return-33860-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11150 invoked from network); 1 May 2008 08:01:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 08:01:14 -0000
Received: (qmail 59982 invoked by uid 500); 1 May 2008 08:01:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59938 invoked by uid 500); 1 May 2008 08:01:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59927 invoked by uid 99); 1 May 2008 08:01:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 01:01:03 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephane.nicoll@gmail.com designates 209.85.132.247 as permitted sender)
Received: from [209.85.132.247] (HELO an-out-0708.google.com) (209.85.132.247)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 08:00:19 +0000
Received: by an-out-0708.google.com with SMTP id c37so200983anc.49
        for <java-user@lucene.apache.org>; Thu, 01 May 2008 01:00:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=0rFcZ3jaMW6HbIoha48HlLXcVT5ZJGEkszb54dlfczw=;
        b=k1YGwSeuBfKsTeN7ATMrfdcR8aViSpaHf4TZcJvrwQSc00LeiEuQhzP+OytsDQJYayAhHmf9vit/RmX5kwVcgQhTBczE1iA+fOWzAIKcaFd3effGTvso+/mUcOFVh9Xl6/V2uM+B8u/NSafECJjyLDwByweagJKGYzUJ/fpvBX8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=bQkN878OT6NQOy0Od/0rQnTqO52EhDs5SwPfqNsABjTbAHgqkOrjLY8IAl6HXWSXAt2RRSsBZ/tGOpMPiDcnuoRx4ut3vvXj2+/AYUGD0+fN4gfikr1YFD25G00Ei36vT1fhuLJjIWTgWk/l/YeMH2AX7nDnvhKTF2rdqZG+9E0=
Received: by 10.101.67.15 with SMTP id u15mr2601943ank.66.1209628833214;
        Thu, 01 May 2008 01:00:33 -0700 (PDT)
Received: by 10.100.178.12 with HTTP; Thu, 1 May 2008 01:00:33 -0700 (PDT)
Message-ID: <541f12ca0805010100o1ca4b99et4964206d7a860435@mail.gmail.com>
Date: Thu, 1 May 2008 10:00:33 +0200
From: "Stephane Nicoll" <stephane.nicoll@gmail.com>
To: java-user@lucene.apache.org
Subject: hybrid query (lucene + db)
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi there,

We're using lucene with Hibernate search and we're very happy so far
with the performance and the usability of lucene. We have however a
specific use cases that prevent us to use only lucene: spatial
queries. I already sent a mail on this list a while back about the
problem and we started investigating multiple solutions.

When the user selects a geographic area and some keywords we do the followi=
ng:

* Perform a search on the lucene index for the keywords with a
projection that returns only the primaryKey of the element sorted by
primary key
* Perform a search on the database with other criterias and a
projection that returns only the primary key of the elements
* Iterate on both list to find N matching IDs, optionally with paging
(some from X to X + N where X is the first result of the page)
* Run a query on the database to return the actual objects (select a
from MyClass a where a.id IN (the list of matching IDs) ) We limit the
page to 1000 results

We have searched a way to optimize the queries and to avoid to consume
too much memory, knowing that we must support paging.

With a single user a search by kewyords takes 30msec to complete, a
search by box takes 45msec. With both (keywords + spatial area)  it
takes 300msec

With 10 concurrent users, a search by keywords takes 150msec/user  but
for both it takes 3 sec/user !!!

I had the profiler running on this scenario and I've found that *all*
threads are waiting on org.apache.lucene.index.SegmentReader. I then
configured Hibernate Search to use a separate index reader per thread.
The deadlocks disappeared but it's still very slow (2.8sec).

Some questions:

* Does anyone knows where the deadlocks on SegmentReader are coming from?
* Is the sorting on the primary keys a bad idea regarding performance
and memory usage?
* Does anyone has an idea to perform this kind of hybrid query in an
efficient way?

I am using lucene 2.3.1 and Hibernate Search 3.0.1. I already ask for
support on the Hibernate Search forum but did not get any answer so
far.

Thanks,
St=E9phane

--=20
Large Systems Suck: This rule is 100% transitive. If you build one,
you suck" -- S.Yegge

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33861-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 08:37:10 2008
Return-Path: <java-user-return-33861-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16769 invoked from network); 1 May 2008 08:37:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 08:37:10 -0000
Received: (qmail 74019 invoked by uid 500); 1 May 2008 08:37:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73987 invoked by uid 500); 1 May 2008 08:37:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73976 invoked by uid 99); 1 May 2008 08:37:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 01:37:04 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 08:36:19 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JrUHI-0007Dl-HG
	for java-user@lucene.apache.org; Thu, 01 May 2008 01:36:32 -0700
Message-ID: <16993174.post@talk.nabble.com>
Date: Thu, 1 May 2008 01:36:32 -0700 (PDT)
From: esra <esraersan@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: lucene farsi problem
In-Reply-To: <1B1FC94C-66E4-4A8D-8C92-38CCCEFDF3E8@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: esraersan@gmail.com
References: <16977096.post@talk.nabble.com> <08DF1421-37F0-4124-BCE3-DCD68EEC189A@apache.org> <16980977.post@talk.nabble.com> <1B1FC94C-66E4-4A8D-8C92-38CCCEFDF3E8@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

document's encoding is "UTF-8".

i tried the  explain() method and the result for "=D8=AF-=DA=98"  range sea=
rching is:

  fieldWeight(keywordIndex:=C3=98=C2=B3=C3=98=C2=A7=C3=98=C2=A8 =C3=99=CB=
=86=C3=99=CB=86=C3=99=EF=BF=BD=C3=98=C2=B1 in 0), product of:
  1.0 =3D tf(termFreq(keywordIndex:=C3=98=C2=B3=C3=98=C2=A7=C3=98=C2=A8 =C3=
=99=CB=86=C3=99=CB=86=C3=99=EF=BF=BD=C3=98=C2=B1)=3D1)
  0.30685282 =3D idf(docFreq=3D1)
  1.0 =3D fieldNorm(field=3DkeywordIndex, doc=3D0)

here keywordIndex is "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1".

 i also  installed the "luke.jnlp"  but i don't know what to check by Luke.

Thanks,

Esra



Grant Ingersoll-6 wrote:
>=20
> I am not sure how Standard Analyzer will perform on Farsi.  The thing =20
> to do now would be to get Luke and have a look at the actual document =20
> that matches and see what it's tokens look like.  You might also try =20
> using the explain() method to see why that document matches.
>=20
> Also, are you sure you are loading the file w/ the proper encodings, =20
> etc?
>=20
> -Grant
>=20
> On Apr 30, 2008, at 8:06 AM, esra wrote:
>=20
>>
>> Hi,
>> thanks for your reply.
>> I am using StandartAnalyzer now and my xml document is like below:
>>
>> <keyword><![CDATA[=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1]]></keywor=
d>
>>      <description><![CDATA[=DB=8C=DA=A9 =D9=88=D9=88=D9=81=D8=B1 =DA=A9=
=D9=87 =D8=AF=D8=B1 =D9=85=D8=AD=D9=81=D8=B8=D9=87 =D8=A7=DB=8C =20
>> =D8=AC=D8=AF=D8=A7 =D8=A7=D8=B2 =D8=B3=D8=A7=DB=8C=D8=B1 =D8=AF=D8=B1=D8=
=A7=DB=8C=D9=88=D8=B1 =D9=87=D8=A7
>> =D9=82=D8=B1=D8=A7=D8=B1 =D8=AF=D8=A7=D8=B1=D8=AF =D8=AA=D8=A7 =D8=B5=D8=
=AF=D8=A7=DB=8C=DB=8C =D8=A8=D8=A7 =D8=A8=D8=A7=D8=B3 =D9=81=D9=88=D9=82 =
=D8=A7=D9=84=D8=B9=D8=A7=D8=AF=D9=87 =20
>> =D9=BE=D8=A7=DB=8C=DB=8C=D9=86 =D8=AA=D9=88=D9=84=DB=8C=D8=AF =DA=A9=D9=
=86=D8=AF. ]]></description>
>>
>> i googled for farsi analyzer and found nothing also i am not sure it =20
>> if
>> would solve my problem or not.
>>
>> Thanks,
>>
>> Esra
>>
>>
>> Grant Ingersoll-6 wrote:
>>>
>>> What Analyzer are you using?  You might try looking in Luke to see
>>> what is in your index, etc.  It also isn't clear to me what your
>>> documents look like.
>>>
>>> As for a Farsi analyzer, I would Google "Farsi analyzer Lucene" and
>>> see if you can find anything.  Otherwise, you will have to write your
>>> own (and donate it????)
>>>
>>> -Grant
>>>
>>> On Apr 30, 2008, at 3:21 AM, esra wrote:
>>>
>>>>
>>>> hi,
>>>>
>>>> i am using lucene's "IndexSearcher" to search the given xml by
>>>> keyword which
>>>> contains farsi information.
>>>> while searching i use ranges like
>>>>
>>>> =D8=A2-=D8=AB  |  =D8=AC-=D8=AE  |  =D8=AF-=DA=98  |  =D8=B3-=D8=B8  |=
  =D8=B9-=D9=82  |  =DA=A9-=D9=84  |  =D9=85-=DB=8C
>>>>
>>>> when i do search for  "=D8=AF-=DA=98"  range the results are wrong , t=
hey =20
>>>> are
>>>> the
>>>> results of  " =D8=B3-=D8=B8 "range.
>>>>
>>>> for example when i do search for "=D8=AF-=DA=98"  one of the the resul=
ts is
>>>> "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1"
>>>> , this result also shown on the " =D8=B3-=D8=B8 " range's result list =
which
>>>> is the
>>>> corret range.
>>>>
>>>> As IndexSearcher use "compareTo" method and this method uses
>>>> unicodes for
>>>> comparing, i found the unicodes of the characters.
>>>>
>>>> =D8=AF=3DU+62F
>>>> =DA=98 =3D U+698
>>>> and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1 "=
 is  =D8=B3 =3D U+633
>>>>
>>>> Do you have any idea how to solve this problem, there are analyzers
>>>> for
>>>> different languages ,
>>>> will this be usefull if so do you know where to find a farsi =20
>>>> analyzer?
>>>>
>>>> I would bu glad if you help.
>>>>
>>>> thanks ,
>>>>
>>>> Esra
>>>>
>>>> --=20
>>>> View this message in context:
>>>> http://www.nabble.com/lucene-farsi-problem-tp16977096p16977096.html
>>>> Sent from the Lucene - Java Users mailing list archive at =20
>>>> Nabble.com.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>> --------------------------
>>> Grant Ingersoll
>>>
>>> Lucene Helpful Hints:
>>> http://wiki.apache.org/lucene-java/BasicsOfPerformance
>>> http://wiki.apache.org/lucene-java/LuceneFAQ
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> --=20
>> View this message in context:
>> http://www.nabble.com/lucene-farsi-problem-tp16977096p16980977.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>=20
> --------------------------
> Grant Ingersoll
>=20
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>=20
>=20
>=20
>=20
>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/lucene-farsi-problem-tp=
16977096p16993174.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33862-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 09:16:16 2008
Return-Path: <java-user-return-33862-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22762 invoked from network); 1 May 2008 09:16:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 09:16:16 -0000
Received: (qmail 97822 invoked by uid 500); 1 May 2008 09:16:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97793 invoked by uid 500); 1 May 2008 09:16:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97782 invoked by uid 99); 1 May 2008 09:16:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 02:16:09 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.216] (HELO web26005.mail.ukl.yahoo.com) (217.12.10.216)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 01 May 2008 09:15:24 +0000
Received: (qmail 49571 invoked by uid 60001); 1 May 2008 09:15:37 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=ZwJukLegK9JP4ehpuiWaPmqSZEnRqCaIBAQZEuqYQSmDhEl1NDF2/fP5SVrWqqJkwEM3/tD6UCSMTW8qw8FgYo4/nbVCbk22IXX/M0RR1X02M/GwqiGO+wY2Yh0R9WHjCyGAvhceGi1hG/z2vl8QfHm5UWZgFklEi2EluZ/tEuY=;
X-YMail-OSG: Gr.9JMcVM1ns_vyZKlWZ.3z.P5JQIo7H9syiA9syiZQFyzxO1jlAMzNFFpi5JZJEfw--
Received: from [193.36.230.96] by web26005.mail.ukl.yahoo.com via HTTP; Thu, 01 May 2008 09:15:37 GMT
X-Mailer: YahooMailRC/902.40 YahooMailWebService/0.7.185
Date: Thu, 1 May 2008 09:15:37 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: hybrid query (lucene + db)
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
Message-ID: <101670.49504.qm@web26005.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

The issue here is a general one of trying to perform an efficient join betw=
een an external resource (rdbms) and Lucene.=0AThis experiment may be of in=
terest:=0A    http://issues.apache.org/jira/browse/LUCENE-434=0A=0AKeyMap.j=
ava embodies the core service which translates from lucene doc ids to DB pr=
imary keys or vice versa.=0AThere are a couple of implementations of KeyMap=
 that are not optimal (they pre-date Lucene's FieldCache) but it may give y=
ou food for thought.=0A=0ACheers=0AMark=0A=0A=0A----- Original Message ----=
=0AFrom: Stephane Nicoll <stephane.nicoll@gmail.com>=0ATo: java-user@lucene=
.apache.org=0ASent: Thursday, 1 May, 2008 9:00:33 AM=0ASubject: hybrid quer=
y (lucene + db)=0A=0AHi there,=0A=0AWe're using lucene with Hibernate searc=
h and we're very happy so far=0Awith the performance and the usability of l=
ucene. We have however a=0Aspecific use cases that prevent us to use only l=
ucene: spatial=0Aqueries. I already sent a mail on this list a while back a=
bout the=0Aproblem and we started investigating multiple solutions.=0A=0AWh=
en the user selects a geographic area and some keywords we do the following=
:=0A=0A* Perform a search on the lucene index for the keywords with a=0Apro=
jection that returns only the primaryKey of the element sorted by=0Aprimary=
 key=0A* Perform a search on the database with other criterias and a=0Aproj=
ection that returns only the primary key of the elements=0A* Iterate on bot=
h list to find N matching IDs, optionally with paging=0A(some from X to X +=
 N where X is the first result of the page)=0A* Run a query on the database=
 to return the actual objects (select a=0Afrom MyClass a where a.id IN (the=
 list of matching IDs) ) We limit the=0Apage to 1000 results=0A=0AWe have s=
earched a way to optimize the queries and to avoid to consume=0Atoo much me=
mory, knowing that we must support paging.=0A=0AWith a single user a search=
 by kewyords takes 30msec to complete, a=0Asearch by box takes 45msec. With=
 both (keywords + spatial area)  it=0Atakes 300msec=0A=0AWith 10 concurrent=
 users, a search by keywords takes 150msec/user  but=0Afor both it takes 3 =
sec/user !!!=0A=0AI had the profiler running on this scenario and I've foun=
d that *all*=0Athreads are waiting on org.apache.lucene.index.SegmentReader=
. I then=0Aconfigured Hibernate Search to use a separate index reader per t=
hread.=0AThe deadlocks disappeared but it's still very slow (2.8sec).=0A=0A=
Some questions:=0A=0A* Does anyone knows where the deadlocks on SegmentRead=
er are coming from?=0A* Is the sorting on the primary keys a bad idea regar=
ding performance=0Aand memory usage?=0A* Does anyone has an idea to perform=
 this kind of hybrid query in an=0Aefficient way?=0A=0AI am using lucene 2.=
3.1 and Hibernate Search 3.0.1. I already ask for=0Asupport on the Hibernat=
e Search forum but did not get any answer so=0Afar.=0A=0AThanks,=0ASt=E9pha=
ne=0A=0A-- =0ALarge Systems Suck: This rule is 100% transitive. If you buil=
d one,=0Ayou suck" -- S.Yegge=0A=0A----------------------------------------=
-----------------------------=0ATo unsubscribe, e-mail: java-user-unsubscri=
be@lucene.apache.org=0AFor additional commands, e-mail: java-user-help@luce=
ne.apache.org=0A=0A=0A=0A=0A=0A=0A      ___________________________________=
_______________________=0ASent from Yahoo! Mail.=0AA Smarter Email http://u=
k.docs.yahoo.com/nowyoucan.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33863-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 12:44:26 2008
Return-Path: <java-user-return-33863-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94461 invoked from network); 1 May 2008 12:44:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 12:44:25 -0000
Received: (qmail 46663 invoked by uid 500); 1 May 2008 12:44:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46611 invoked by uid 500); 1 May 2008 12:44:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46600 invoked by uid 99); 1 May 2008 12:44:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 05:44:19 -0700
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.108.46] (HELO SUEXCL-02.ad.syr.edu) (128.230.108.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 12:43:34 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: RE: lucene farsi problem
Date: Thu, 1 May 2008 08:42:14 -0400
Message-ID: <9294E20AED46934EA459020706463F94A04A4E@SUEXCL-02.ad.syr.edu>
In-Reply-To: <16993174.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: lucene farsi problem
Thread-Index: AcirZm9DwVWxyzfOT1+zqy6sG/BAxgAH6NxA
From: "Steven A Rowe" <sarowe@syr.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgRXNyYSwNCg0KR29pbmcgYmFjayB0byB0aGUgb3JpZ2luYWwgcHJvYmxlbSBzdGF0ZW1lbnQs
IEkgc2VlIHNvbWV0aGluZyB0aGF0IGxvb2tzIGlsbG9naWNhbCB0byBtZSAtIHBsZWFzZSBjb3Jy
ZWN0IG1lIGlmIEknbSB3cm9uZzoNCg0KT24gQXByIDMwLCAyMDA4LCBhdCAzOjIxIEFNLCBlc3Jh
IHdyb3RlOg0KPiBpIGFtIHVzaW5nIGx1Y2VuZSdzICJJbmRleFNlYXJjaGVyIiB0byBzZWFyY2gg
dGhlIGdpdmVuIHhtbCBieQ0KPiBrZXl3b3JkIHdoaWNoIGNvbnRhaW5zIGZhcnNpIGluZm9ybWF0
aW9uLg0KPiB3aGlsZSBzZWFyY2hpbmcgaSB1c2UgcmFuZ2VzIGxpa2UNCj4gDQo+INiiLdirICB8
ICDYrC3YriAgfCAg2K8t2pggIHwgINizLdi4ICB8ICDYuS3ZgiAgfCAg2qkt2YQgIHwgINmFLduM
DQo+IA0KPiB3aGVuIGkgZG8gc2VhcmNoIGZvciAgItivLdqYIiAgcmFuZ2UgdGhlIHJlc3VsdHMg
YXJlIHdyb25nICwgdGhleQ0KPiBhcmUgdGhlIHJlc3VsdHMgb2YgICIg2LMt2LggInJhbmdlLg0K
PiANCj4gZm9yIGV4YW1wbGUgd2hlbiBpIGRvIHNlYXJjaCBmb3IgItivLdqYIiAgb25lIG9mIHRo
ZSB0aGUgcmVzdWx0cyBpcw0KPiAi2LPYp9ioINmI2YjZgdixIiwgdGhpcyByZXN1bHQgYWxzbyBz
aG93biBvbiB0aGUgIiDYsy3YuCAiIHJhbmdlJ3MgcmVzdWx0DQo+IGxpc3Qgd2hpY2ggaXMgdGhl
IGNvcnJldCByYW5nZS4NCj4gDQo+IEFzIEluZGV4U2VhcmNoZXIgdXNlICJjb21wYXJlVG8iIG1l
dGhvZCBhbmQgdGhpcyBtZXRob2QgdXNlcw0KPiB1bmljb2RlcyBmb3IgY29tcGFyaW5nLCBpIGZv
dW5kIHRoZSB1bmljb2RlcyBvZiB0aGUgY2hhcmFjdGVycy4NCj4gDQo+INivPVUrNjJGDQo+INqY
ID0gVSs2OTgNCj4gYW5kIHRoZSBmaXJzdCBsZXR0ZXIgb2YgItiz2KfYqCDZiNmI2YHYsSAiIGlz
ICDYsyA9IFUrNjMzDQoNCkl0IGFwcGVhcnMgdG8gbWUgdGhhdCAqYm90aCogdGhlICLYry3amCIg
cmFuZ2UgWyBVKzA2MkYgLSBVKzA2OTggXSBhbmQgdGhlICLYsy3YuCIgcmFuZ2UgWyBVKzA2MzMg
LSBVKzA2MzggXSBjb250YWluIHRoZSBmaXJzdCBsZXR0ZXIgb2YgItiz2KfYqCDZiNmI2YHYsSIs
IHdoaWNoIGlzICLYsyIgPSBVKzA2MzMuICANCg0KWW91IHN0YXRlZCB0aGF0IFUrMDYzMyBzaG91
bGQgYmUgY29udGFpbmVkIGluIHRoZSBbIFUrMDYzMyAtIFUrMDYzOCBdIHJhbmdlIC0gSSBhZ3Jl
ZSAtIGJ1dCB3aHkgZG8geW91IHRoaW5rIFUrMDYzMyBzaG91bGQgbm90IGJlIGNvbnRhaW5lZCBp
biB0aGUgWyBVKzA2MkYgLSBVKzA2OTggXSByYW5nZT8NCg0KSW4gb3RoZXIgd29yZHMsIGl0IGxv
b2tzIHRvIG1lIGxpa2UgeW91ciBwcm9ibGVtIGlzIG5vdCBhIHByb2JsZW0gYXQgYWxsLg0KDQpT
dGV2ZQ0K


From java-user-return-33864-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 13:29:25 2008
Return-Path: <java-user-return-33864-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35615 invoked from network); 1 May 2008 13:29:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 13:29:25 -0000
Received: (qmail 6072 invoked by uid 500); 1 May 2008 13:29:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6045 invoked by uid 500); 1 May 2008 13:29:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6022 invoked by uid 99); 1 May 2008 13:29:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 06:29:14 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=SPF_NEUTRAL,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a12.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 13:28:26 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a12.g.dreamhost.com (Postfix) with ESMTP id 180BD7FF0
	for <java-user@lucene.apache.org>; Thu,  1 May 2008 06:28:37 -0700 (PDT)
Message-Id: <71D26EAB-DE2A-4A97-82BC-5AA27ECD519B@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <16993174.post@talk.nabble.com>
Content-Type: text/plain; charset=UTF-8; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: lucene farsi problem
Date: Thu, 1 May 2008 09:28:37 -0400
References: <16977096.post@talk.nabble.com> <08DF1421-37F0-4124-BCE3-DCD68EEC189A@apache.org> <16980977.post@talk.nabble.com> <1B1FC94C-66E4-4A8D-8C92-38CCCEFDF3E8@apache.org> <16993174.post@talk.nabble.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org


On May 1, 2008, at 4:36 AM, esra wrote:

>
> Hi,
>
> document's encoding is "UTF-8".
>
> i tried the  explain() method and the result for "=D8=AF-=DA=98"  =
range =20
> searching is:
>
>  fieldWeight(keywordIndex:=C3=98=C2=B3=C3=98=C2=A7=C3=98=C2=A8 =
=C3=99=CB=86=C3=99=CB=86=C3=99=EF=BF=BD=C3=98=C2=B1 in 0), =20
> product of:
>  1.0 =3D tf(termFreq(keywordIndex:=C3=98=C2=B3=C3=98=C2=A7=C3=98=C2=A8 =
=C3=99=CB=86=C3=99=CB=86=C3=99=EF=BF=BD=C3=98=C2=B1)=3D1)
>  0.30685282 =3D idf(docFreq=3D1)
>  1.0 =3D fieldNorm(field=3DkeywordIndex, doc=3D0)
>
> here keywordIndex is "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1".
>
> i also  installed the "luke.jnlp"  but i don't know what to check by =20=

> Luke.
>


=
http://wiki.apache.org/lucene-java/LuceneFAQ#head-3558e5121806fb4fce80fc02=
2d889484a9248b71

Luke can be used to view your index.  Not saying it is your problem =20
here, but often times when I get back results that "seem" incorrect, =20
the first thing I do is go look at my index using Luke, and compare =20
the "incorrect" document with what is in the query to see where the =20
(mis)match is occurring.   Usually, this analysis shows that my =20
document/query is not what I thought it was.

Luke can browse documents and parse queries, amongst other useful =20
things.




> Thanks,
>
> Esra
>
>
>
> Grant Ingersoll-6 wrote:
>>
>> I am not sure how Standard Analyzer will perform on Farsi.  The thing
>> to do now would be to get Luke and have a look at the actual document
>> that matches and see what it's tokens look like.  You might also try
>> using the explain() method to see why that document matches.
>>
>> Also, are you sure you are loading the file w/ the proper encodings,
>> etc?
>>
>> -Grant
>>
>> On Apr 30, 2008, at 8:06 AM, esra wrote:
>>
>>>
>>> Hi,
>>> thanks for your reply.
>>> I am using StandartAnalyzer now and my xml document is like below:
>>>
>>> <keyword><![CDATA[=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1]]></keyw=
ord>
>>>     <description><![CDATA[=DB=8C=DA=A9 =D9=88=D9=88=D9=81=D8=B1 =DA=A9=
=D9=87 =D8=AF=D8=B1 =D9=85=D8=AD=D9=81=D8=B8=D9=87 =D8=A7=DB=8C
>>> =D8=AC=D8=AF=D8=A7 =D8=A7=D8=B2 =D8=B3=D8=A7=DB=8C=D8=B1 =
=D8=AF=D8=B1=D8=A7=DB=8C=D9=88=D8=B1 =D9=87=D8=A7
>>> =D9=82=D8=B1=D8=A7=D8=B1 =D8=AF=D8=A7=D8=B1=D8=AF =D8=AA=D8=A7 =
=D8=B5=D8=AF=D8=A7=DB=8C=DB=8C =D8=A8=D8=A7 =D8=A8=D8=A7=D8=B3 =D9=81=D9=88=
=D9=82 =D8=A7=D9=84=D8=B9=D8=A7=D8=AF=D9=87
>>> =D9=BE=D8=A7=DB=8C=DB=8C=D9=86 =D8=AA=D9=88=D9=84=DB=8C=D8=AF =
=DA=A9=D9=86=D8=AF. ]]></description>
>>>
>>> i googled for farsi analyzer and found nothing also i am not sure it
>>> if
>>> would solve my problem or not.
>>>
>>> Thanks,
>>>
>>> Esra
>>>
>>>
>>> Grant Ingersoll-6 wrote:
>>>>
>>>> What Analyzer are you using?  You might try looking in Luke to see
>>>> what is in your index, etc.  It also isn't clear to me what your
>>>> documents look like.
>>>>
>>>> As for a Farsi analyzer, I would Google "Farsi analyzer Lucene" and
>>>> see if you can find anything.  Otherwise, you will have to write =20=

>>>> your
>>>> own (and donate it????)
>>>>
>>>> -Grant
>>>>
>>>> On Apr 30, 2008, at 3:21 AM, esra wrote:
>>>>
>>>>>
>>>>> hi,
>>>>>
>>>>> i am using lucene's "IndexSearcher" to search the given xml by
>>>>> keyword which
>>>>> contains farsi information.
>>>>> while searching i use ranges like
>>>>>
>>>>> =D8=A2-=D8=AB  |  =D8=AC-=D8=AE  |  =D8=AF-=DA=98  |  =D8=B3-=D8=B8 =
 |  =D8=B9-=D9=82  |  =DA=A9-=D9=84  |  =D9=85-=DB=8C
>>>>>
>>>>> when i do search for  "=D8=AF-=DA=98"  range the results are wrong =
, they
>>>>> are
>>>>> the
>>>>> results of  " =D8=B3-=D8=B8 "range.
>>>>>
>>>>> for example when i do search for "=D8=AF-=DA=98"  one of the the =
results =20
>>>>> is
>>>>> "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1"
>>>>> , this result also shown on the " =D8=B3-=D8=B8 " range's result =
list =20
>>>>> which
>>>>> is the
>>>>> corret range.
>>>>>
>>>>> As IndexSearcher use "compareTo" method and this method uses
>>>>> unicodes for
>>>>> comparing, i found the unicodes of the characters.
>>>>>
>>>>> =D8=AF=3DU+62F
>>>>> =DA=98 =3D U+698
>>>>> and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1=
 " is  =D8=B3 =3D U+633
>>>>>
>>>>> Do you have any idea how to solve this problem, there are =20
>>>>> analyzers
>>>>> for
>>>>> different languages ,
>>>>> will this be usefull if so do you know where to find a farsi
>>>>> analyzer?
>>>>>
>>>>> I would bu glad if you help.
>>>>>
>>>>> thanks ,
>>>>>
>>>>> Esra
>>>>>
>>>>> --=20
>>>>> View this message in context:
>>>>> http://www.nabble.com/lucene-farsi-problem-=20
>>>>> tp16977096p16977096.html
>>>>> Sent from the Lucene - Java Users mailing list archive at
>>>>> Nabble.com.
>>>>>
>>>>>
>>>>> =
---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>
>>>> --------------------------
>>>> Grant Ingersoll
>>>>
>>>> Lucene Helpful Hints:
>>>> http://wiki.apache.org/lucene-java/BasicsOfPerformance
>>>> http://wiki.apache.org/lucene-java/LuceneFAQ
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> =
---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>
>>>
>>> --=20
>>> View this message in context:
>>> http://www.nabble.com/lucene-farsi-problem-tp16977096p16980977.html
>>> Sent from the Lucene - Java Users mailing list archive at =20
>>> Nabble.com.
>>>
>>>
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>> --------------------------
>> Grant Ingersoll
>>
>> Lucene Helpful Hints:
>> http://wiki.apache.org/lucene-java/BasicsOfPerformance
>> http://wiki.apache.org/lucene-java/LuceneFAQ
>>
>>
>>
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> --=20
> View this message in context: =
http://www.nabble.com/lucene-farsi-problem-tp16977096p16993174.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33865-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 13:41:49 2008
Return-Path: <java-user-return-33865-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42368 invoked from network); 1 May 2008 13:41:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 13:41:48 -0000
Received: (qmail 15893 invoked by uid 500); 1 May 2008 13:41:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15868 invoked by uid 500); 1 May 2008 13:41:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15857 invoked by uid 99); 1 May 2008 13:41:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 06:41:43 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 66.249.90.178 as permitted sender)
Received: from [66.249.90.178] (HELO ik-out-1112.google.com) (66.249.90.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 13:40:59 +0000
Received: by ik-out-1112.google.com with SMTP id b35so97342ika.5
        for <java-user@lucene.apache.org>; Thu, 01 May 2008 06:41:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=UrFqm5Qmafi+dE0LWoexTy9wBBt+0pdFVm306Mc7ZHs=;
        b=SaaUWU7largkiHcDb/OSuTOR+pZOT9yPth6uN12YtnjCQ8k3XIDq/MTofSGWNnYeQ6JFoY3a/oXCuHwo5yCS2FSwe5DtUKPbzvoaQ+lpDq6g8+aOihsA7dGC1SHFB6tpPHT64dv0H/vSJN9U0MgwMQYX7QeuH8roSWCBXk8HHwU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=sYLTN/xogqrXqhAJFZnENjflV8iqMP7Op7X3qpYafDZX9po/Ba1qOn2qr/Vr6QsdEuj6bLqOX8QSlNLQ19ZPHjFZaDMvQ2F1XNmWrAIibmIHu0F1e+v/+URa/mx7TC5kW8LCOMIyBZsbCqHhZlLboO/83KHs/gRHW2B+6DwYG24=
Received: by 10.150.79.22 with SMTP id c22mr2246185ybb.160.1209649270615;
        Thu, 01 May 2008 06:41:10 -0700 (PDT)
Received: by 10.151.41.21 with HTTP; Thu, 1 May 2008 06:41:10 -0700 (PDT)
Message-ID: <c68e39170805010641u142f6c67i1af553724d03f39f@mail.gmail.com>
Date: Thu, 1 May 2008 09:41:10 -0400
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: ParalleReader and synchronization between indexes
In-Reply-To: <567106.78534.qm@web52006.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <50424.12811.qm@web50303.mail.re2.yahoo.com>
	 <567106.78534.qm@web52006.mail.re2.yahoo.com>
X-Google-Sender-Auth: ec27dbe5e0ea89e2
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Apr 30, 2008 at 10:52 PM, Rajesh parab <rajesh_parab_1@yahoo.com> wrote:
>  Can we somehow keep
>  internal document id same after updating (i.e. delete
>  and re-insert) index document?

No.  ParallelReader is not a general solution, it's an expert-level
solution that leaves the task of keeping the indexes in sync up to
you.  The easiest thing is to really rebuild the smaller index each
time.  If you can't do that, ParallelReader is probably not what you
are looking for.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33866-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 16:55:46 2008
Return-Path: <java-user-return-33866-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39456 invoked from network); 1 May 2008 16:55:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 16:55:46 -0000
Received: (qmail 19427 invoked by uid 500); 1 May 2008 16:55:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19353 invoked by uid 500); 1 May 2008 16:55:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19337 invoked by uid 99); 1 May 2008 16:55:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 09:55:36 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.48.26] (HELO web52010.mail.re2.yahoo.com) (206.190.48.26)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 01 May 2008 16:54:51 +0000
Received: (qmail 38227 invoked by uid 60001); 1 May 2008 16:55:01 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=35u6gktYinATrEcl8j7nMVGkoCn8Kuf/ldVnXZ8RxGtH9I0Ir07zP1J+xKtNT2O67UGoIbRN+TwuvnGkG0JUhMj577GBo5wU2t8oT1AETFsN3m5TintlIlIcXXHsi+5aF9bf1Ckew/iwFfHcxJoXIQr69C0LR9Kd11ePyx0vhWg=;
X-YMail-OSG: nCcud8kVM1m1czgSMwz3yUkzGv82CB6jIRmxXE00U9iHYzrL010urT1WgqPEOWC0bh.mcIKYvdGVqb36e9G883Mh36mmSz6ZaQiIKwu4dnrsFlLvYle6o_NTRYk-
Received: from [12.162.3.126] by web52010.mail.re2.yahoo.com via HTTP; Thu, 01 May 2008 09:55:00 PDT
Date: Thu, 1 May 2008 09:55:00 -0700 (PDT)
From: Rajesh parab <rajesh_parab_1@yahoo.com>
Subject: Re: ParalleReader and synchronization between indexes
To: java-user@lucene.apache.org
In-Reply-To: <c68e39170805010641u142f6c67i1af553724d03f39f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
Message-ID: <991537.37874.qm@web52010.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Yonik.

So, if rebuilding the second index is not an option
due to large no of documents, then ParallelReader will
not work :-(

And I believe there is no other way than
parallelReader to search across multiple indexes that
contain related data. Is there any other alternative?
I think, MultiSearcher or MultiReader will only work
with multiple, unrelated indexes.

Regards,
Rajesh


      ____________________________________________________________________________________
Be a better friend, newshound, and 
know-it-all with Yahoo! Mobile.  Try it now.  http://mobile.yahoo.com/;_ylt=Ahu06i62sR8HDtDypao8Wcj9tAcJ

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33867-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 18:51:33 2008
Return-Path: <java-user-return-33867-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2835 invoked from network); 1 May 2008 18:51:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 18:51:32 -0000
Received: (qmail 63383 invoked by uid 500); 1 May 2008 18:51:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63342 invoked by uid 500); 1 May 2008 18:51:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63330 invoked by uid 99); 1 May 2008 18:51:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 11:51:25 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stopman@gmail.com designates 209.85.128.186 as permitted sender)
Received: from [209.85.128.186] (HELO fk-out-0910.google.com) (209.85.128.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 18:50:41 +0000
Received: by fk-out-0910.google.com with SMTP id 18so823971fkq.5
        for <java-user@lucene.apache.org>; Thu, 01 May 2008 11:50:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=aDcIbKTYsjVtYZWO1J9q+eMG7zrWSaR39e+YWfyuAVk=;
        b=VsHKVPDwx9sW8DHZDn2eikg/kpUuLOYobn+pbmuxaAC0Fj6dBb1kxhqId7Gio3CDcd02RfYZrv/38LjJikOzswGnfPNlsUcLt3Wlsa2ejwy37vRXuv+IaUD8MmMkfpJDToi8zZIVRBAjLud8+g+jPPE4hclNxW4yh5IT2pMedzk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Ar1mRyVMdYNirP5gtCPvfp3F+kU93Nuv+gYC7vSVyOPfoUGeCDKVk0OArnWie8t17ks/AWOr8hIO8WFkf+OQbfcXXlrrsbaKP8OQlMWBrnP6dSPPTCNFTscGAT7tKr1Eu5GGDy7fos1Yqk15dMNKYdomYJLDfECXQ+0G0csDwxE=
Received: by 10.82.187.2 with SMTP id k2mr263242buf.56.1209667854082;
        Thu, 01 May 2008 11:50:54 -0700 (PDT)
Received: by 10.82.139.19 with HTTP; Thu, 1 May 2008 11:50:54 -0700 (PDT)
Message-ID: <652776090805011150i29576d04v7f4c2aa0bbba4753@mail.gmail.com>
Date: Thu, 1 May 2008 11:50:54 -0700
From: "Michael Stoppelman" <stopman@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: hybrid query (lucene + db)
In-Reply-To: <101670.49504.qm@web26005.mail.ukl.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_4943_26991021.1209667854068"
References: <101670.49504.qm@web26005.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_4943_26991021.1209667854068
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

Stephane,

Could you describe how you setup the spatial area? Having BooleanQuery with
200 terms in it definitely slows things down (I'm not sure exactly why yet
-- it seems like it shouldn't be "that" slow). If you can describe your
spatial area in fewer terms you can get much better performance. It just
depends on how you're describing your spatial areas and the number of
results in each zipcode. If you had a field like "city,state" in your index
you would have far less terms in your query than if that query had all the
zipcodes in a "city,state" combo, thus making your query much faster.

M

On Thu, May 1, 2008 at 2:15 AM, mark harwood <markharw00d@yahoo.co.uk>
wrote:

> The issue here is a general one of trying to perform an efficient join
> between an external resource (rdbms) and Lucene.
> This experiment may be of interest:
>    http://issues.apache.org/jira/browse/LUCENE-434
>
> KeyMap.java embodies the core service which translates from lucene doc id=
s
> to DB primary keys or vice versa.
> There are a couple of implementations of KeyMap that are not optimal (the=
y
> pre-date Lucene's FieldCache) but it may give you food for thought.
>
> Cheers
> Mark
>
>
> ----- Original Message ----
> From: Stephane Nicoll <stephane.nicoll@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Thursday, 1 May, 2008 9:00:33 AM
> Subject: hybrid query (lucene + db)
>
> Hi there,
>
> We're using lucene with Hibernate search and we're very happy so far
> with the performance and the usability of lucene. We have however a
> specific use cases that prevent us to use only lucene: spatial
> queries. I already sent a mail on this list a while back about the
> problem and we started investigating multiple solutions.
>
> When the user selects a geographic area and some keywords we do the
> following:
>
> * Perform a search on the lucene index for the keywords with a
> projection that returns only the primaryKey of the element sorted by
> primary key
> * Perform a search on the database with other criterias and a
> projection that returns only the primary key of the elements
> * Iterate on both list to find N matching IDs, optionally with paging
> (some from X to X + N where X is the first result of the page)
> * Run a query on the database to return the actual objects (select a
> from MyClass a where a.id IN (the list of matching IDs) ) We limit the
> page to 1000 results
>
> We have searched a way to optimize the queries and to avoid to consume
> too much memory, knowing that we must support paging.
>
> With a single user a search by kewyords takes 30msec to complete, a
> search by box takes 45msec. With both (keywords + spatial area)  it
> takes 300msec
>
> With 10 concurrent users, a search by keywords takes 150msec/user  but
> for both it takes 3 sec/user !!!
>
> I had the profiler running on this scenario and I've found that *all*
> threads are waiting on org.apache.lucene.index.SegmentReader. I then
> configured Hibernate Search to use a separate index reader per thread.
> The deadlocks disappeared but it's still very slow (2.8sec).
>
> Some questions:
>
> * Does anyone knows where the deadlocks on SegmentReader are coming from?
> * Is the sorting on the primary keys a bad idea regarding performance
> and memory usage?
> * Does anyone has an idea to perform this kind of hybrid query in an
> efficient way?
>
> I am using lucene 2.3.1 and Hibernate Search 3.0.1. I already ask for
> support on the Hibernate Search forum but did not get any answer so
> far.
>
> Thanks,
> St=E9phane
>
> --
> Large Systems Suck: This rule is 100% transitive. If you build one,
> you suck" -- S.Yegge
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
>
>
>       __________________________________________________________
> Sent from Yahoo! Mail.
> A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_4943_26991021.1209667854068--

From java-user-return-33868-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 20:11:18 2008
Return-Path: <java-user-return-33868-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23723 invoked from network); 1 May 2008 20:11:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 20:11:18 -0000
Received: (qmail 77844 invoked by uid 500); 1 May 2008 20:11:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77814 invoked by uid 500); 1 May 2008 20:11:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77803 invoked by uid 99); 1 May 2008 20:11:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 13:11:11 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.128.191 as permitted sender)
Received: from [209.85.128.191] (HELO fk-out-0910.google.com) (209.85.128.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 20:10:27 +0000
Received: by fk-out-0910.google.com with SMTP id 18so860497fkq.5
        for <java-user@lucene.apache.org>; Thu, 01 May 2008 13:10:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=yu5P6P7XYdyWAsH8s+FhPIuDibaxCaBF4deS5VS3t64=;
        b=US5/TCjT+7pw5NwZCcpXcYAPcz/vDjQErGiuJ4ZzrO7QOPH5WY3+JhWqZxVSh7hQ6NcTu1bc5DzfYWNN6NSC8nwIVSoggy3/mJPM3fw9+ah0KWdUUoyj+S7Bd4rqeFYAUi0O+zcHHoARLqPJLmXL5wAwNvY+UcNpa8EgOsatf8g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=QaVICEAn6HfBPzZTzC5eIhhJF1DLub/QFvQFOsB/D9GE69WsQdDee/fNWSLvW0Ua3dDqo8vYn6RAC36ICMtgqgPo2sEEh/l2lsZPpqJ+Xm2yg8g2MBpCVHsLgCCNoiw5/XxsIOAM69wnlnWsP9c5+Na9hO3BH2HplqSR4Ztof7Y=
Received: by 10.82.152.16 with SMTP id z16mr269614bud.70.1209672639918;
        Thu, 01 May 2008 13:10:39 -0700 (PDT)
Received: by 10.82.141.2 with HTTP; Thu, 1 May 2008 13:10:39 -0700 (PDT)
Message-ID: <8837fb770805011310p5fb7b1e7wcc75ab9992fed6fe@mail.gmail.com>
Date: Thu, 1 May 2008 13:10:39 -0700
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Does Lucene Supports Billions of data
In-Reply-To: <200805010910.04480.daniel@nuix.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_7011_29403196.1209672639913"
References: <16974808.post@talk.nabble.com>
	 <5e76f3840804300646y7d230aa3xb7827193fe441b4d@mail.gmail.com>
	 <8837fb770804300701v74791ce0h6c1bf359b801e473@mail.gmail.com>
	 <200805010910.04480.daniel@nuix.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_7011_29403196.1209672639913
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

I am not sure why this is the case, docid is internal to the sub index. As
long as the sub index size is below 2 bil, there is no need for docid to be
long. With multiple indexes, I was thinking having an aggregater which
merges maybe only a page of search result.

Example:

sub index 1: 1 billion docs
sub index 2: 1 billion docs
sub index 3: 1 billion docs

federating search to these subindexes, you represent an index of 3 billion
docs, and all internal doc ids are of type int.

Maybe I am not understanding something.

-John

On Wed, Apr 30, 2008 at 4:10 PM, Daniel Noll <daniel@nuix.com> wrote:

> On Thursday 01 May 2008 00:01:48 John Wang wrote:
> > I am not sure how well lucene would perform with > 2 Billion docs in a
> > single index anyway.
>
> Even if they're in multiple indexes, the doc IDs being ints will still
> prevent
> it going past 2Gi unless you wrap your own framework around it.
>
> Daniel
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_7011_29403196.1209672639913--

From java-user-return-33869-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 01 22:13:42 2008
Return-Path: <java-user-return-33869-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76086 invoked from network); 1 May 2008 22:13:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 May 2008 22:13:41 -0000
Received: (qmail 46385 invoked by uid 500); 1 May 2008 22:13:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46351 invoked by uid 500); 1 May 2008 22:13:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46340 invoked by uid 99); 1 May 2008 22:13:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 15:13:36 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [130.225.24.87] (HELO luna.statsbiblioteket.dk) (130.225.24.87)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 22:12:52 +0000
Received: from statsbiblioteket.dk (localhost [127.0.0.1])
 by luna.statsbiblioteket.dk
 (iPlanet Messaging Server 5.2 HotFix 1.16 (built May 14 2003))
 with ESMTP id <0K07008ZFN1SJ6@luna.statsbiblioteket.dk> for
 java-user@lucene.apache.org; Fri, 02 May 2008 00:13:04 +0200 (MEST)
Received: from [127.0.0.1] by luna.statsbiblioteket.dk (mshttpd); Fri,
 02 May 2008 00:13:04 +0200
Date: Fri, 02 May 2008 00:13:04 +0200
From: Toke Eskildsen <te@statsbiblioteket.dk>
Subject: Re: Does Lucene Supports Billions of data
To: java-user@lucene.apache.org
Message-id: <27483d26dac2.26dac227483d@statsbiblioteket.dk>
MIME-version: 1.0
X-Mailer: iPlanet Messenger Express 5.2 HotFix 1.16 (built May 14 2003)
Content-type: text/plain; charset=us-ascii
Content-language: en
Content-transfer-encoding: 7BIT
Content-disposition: inline
X-Accept-Language: en
Priority: normal
X-Virus-Checked: Checked by ClamAV on apache.org

From: John Wang <john.wang@gmail.com>
[...]
> sub index 1: 1 billion docs
> sub index 2: 1 billion docs
> sub index 3: 1 billion docs
> 
> federating search to these subindexes, you represent an index of 3 
> billiondocs, and all internal doc ids are of type int.

That falls under Daniel's "...unless you wrap your own framework around it". The problem with the solution you're describing is that it's not functionally equivalent to a single index of 3 billion docs.

If you just create 3 independent indexes and merge the top hits from all 3, the ranking of the documents will be messed up. You'll need to make sure that the scores from the different indexes can be compared. That's tricky when the score depends on the frequency of the terms in the whole corpus.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33870-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 00:31:10 2008
Return-Path: <java-user-return-33870-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16398 invoked from network); 2 May 2008 00:31:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 00:31:08 -0000
Received: (qmail 36237 invoked by uid 500); 2 May 2008 00:31:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36199 invoked by uid 500); 2 May 2008 00:31:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36188 invoked by uid 99); 2 May 2008 00:31:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 17:31:02 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.242] (HELO web50309.mail.re2.yahoo.com) (206.190.38.242)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 02 May 2008 00:30:15 +0000
Received: (qmail 15548 invoked by uid 60001); 2 May 2008 00:30:28 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=nxGMqfo5tWj8q2Bfa+zhhkoCzHvhudVViOmY+lk9lD5vL1pbjS6I075l1tsHYv0GFCfFkRReKciGT2//qP47gEn7eECqFG43cS9qKTVkiLduxt4uEy0Vpf+gYVp9rDSXPF640Pyk0fwwHVU0ioESRQbz6edZNBpp90rcn3dn8x8=;
X-YMail-OSG: 9mC3_iQVM1lpa_nmL21OR0wgEJGRFApoTaELlWsnzZEHU5dbCmvfupSj99FJijChSlbM92ZWU15ie4v.0MW2oemDMDN0bTo1tchhUO9Q8RnIJKN0e2iUrccOQA--
Received: from [72.231.9.236] by web50309.mail.re2.yahoo.com via HTTP; Thu, 01 May 2008 17:30:28 PDT
X-Mailer: YahooMailRC/902.40 YahooMailWebService/0.7.185
Date: Thu, 1 May 2008 17:30:28 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: ParalleReader and synchronization between indexes
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <550803.14652.qm@web50309.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

That's correct, Rajesh.  ParallelReader has its uses, but I guess your case is not one of them, unless we are all missing some key aspect of PR or a trick to make it work in your case.

Otis 

--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch

----- Original Message ----
> From: Rajesh parab <rajesh_parab_1@yahoo.com>
> To: java-user@lucene.apache.org
> Sent: Thursday, May 1, 2008 6:55:00 PM
> Subject: Re: ParalleReader and synchronization between indexes
> 
> Thanks Yonik.
> 
> So, if rebuilding the second index is not an option
> due to large no of documents, then ParallelReader will
> not work :-(
> 
> And I believe there is no other way than
> parallelReader to search across multiple indexes that
> contain related data. Is there any other alternative?
> I think, MultiSearcher or MultiReader will only work
> with multiple, unrelated indexes.
> 
> Regards,
> Rajesh



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33871-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 00:35:46 2008
Return-Path: <java-user-return-33871-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19445 invoked from network); 2 May 2008 00:35:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 00:35:45 -0000
Received: (qmail 41716 invoked by uid 500); 2 May 2008 00:35:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41682 invoked by uid 500); 2 May 2008 00:35:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41671 invoked by uid 99); 2 May 2008 00:35:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 17:35:39 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.61] (HELO web50307.mail.re2.yahoo.com) (206.190.38.61)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 02 May 2008 00:34:44 +0000
Received: (qmail 25594 invoked by uid 60001); 2 May 2008 00:35:04 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=zi5roBQNclnvqvju+u3fefWi/YwBDyP+V0QaUMU+hgmuxhIias0gSmq3CpHOIQX8uZwZC8+LW3G43P0dRXtoUkCRQc5sM44STCmH4mSXe3iny9EEM8k3uZ0YkJ0dECkppoiVGAqe5XmDNabbSrfhq8UgZvhY6E+Q44Np6AhPJTM=;
X-YMail-OSG: pi1DqEAVM1lDaJGQZP2gMCs1lgbDx_DxeNNnuE88XIb8dzvnOi6UtNRlPeXquMvoOtmMXIzpJ1CzQFbPXu9WpWAF4D5hw_b4pZzD_LUUEVs53mpPYtC6RvWMeA--
Received: from [72.231.9.236] by web50307.mail.re2.yahoo.com via HTTP; Thu, 01 May 2008 17:35:04 PDT
X-Mailer: YahooMailRC/902.40 YahooMailWebService/0.7.185
Date: Thu, 1 May 2008 17:35:04 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Does Lucene Supports Billions of data
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <169666.24827.qm@web50307.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Right.  And the typical answer to that is:

- If your terms are roughly equally distributed in all N indices (e.g. random doc->index/shard assignment), the relevance score will roughly match.

- If you have business rules for doc->index/shard distribution, then your relevance scores will not be comparable.

Otis 

--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch

----- Original Message ----
> From: Toke Eskildsen <te@statsbiblioteket.dk>
> To: java-user@lucene.apache.org
> Sent: Friday, May 2, 2008 12:13:04 AM
> Subject: Re: Does Lucene Supports Billions of data
> 
> From: John Wang 
> [...]
> > sub index 1: 1 billion docs
> > sub index 2: 1 billion docs
> > sub index 3: 1 billion docs
> > 
> > federating search to these subindexes, you represent an index of 3 
> > billiondocs, and all internal doc ids are of type int.
> 
> That falls under Daniel's "...unless you wrap your own framework around it". The 
> problem with the solution you're describing is that it's not functionally 
> equivalent to a single index of 3 billion docs.
> 
> If you just create 3 independent indexes and merge the top hits from all 3, the 
> ranking of the documents will be messed up. You'll need to make sure that the 
> scores from the different indexes can be compared. That's tricky when the score 
> depends on the frequency of the terms in the whole corpus.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33872-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 01:41:28 2008
Return-Path: <java-user-return-33872-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51757 invoked from network); 2 May 2008 01:41:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 01:41:28 -0000
Received: (qmail 2202 invoked by uid 500); 2 May 2008 01:41:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2158 invoked by uid 500); 2 May 2008 01:41:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2146 invoked by uid 99); 2 May 2008 01:41:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 18:41:23 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.48.26] (HELO web52010.mail.re2.yahoo.com) (206.190.48.26)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 02 May 2008 01:40:36 +0000
Received: (qmail 39948 invoked by uid 60001); 2 May 2008 01:40:48 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=KDpg2PnQdQuQK1mNN8iFmPf1A9yUiGyQ00mguvq3jzpVGMRCVrwybInTU1Krn1ct0QM7AxckZ/ufDYKIYvMiNh/OMeEZFbcNeKijgvnAVRyppgrJ8BMC0ysn0hfYcHDxcODgTq2KIfd9WpNVDy6xL7i3n77Yn/+PT1X2nnW/m6g=;
X-YMail-OSG: ooL1GS0VM1lbYKV2yrOYAsCEioP0yL5yCt.JK9bwLZcJBh9JP4VKsoQq1T198V2q2f3HttU9p1Mq4WSzQgJ5qTCAT1OvlwLPgvh3XzvTGI_UNQVvfX8tltuRSqM-
Received: from [12.162.3.126] by web52010.mail.re2.yahoo.com via HTTP; Thu, 01 May 2008 18:40:48 PDT
Date: Thu, 1 May 2008 18:40:48 -0700 (PDT)
From: Rajesh parab <rajesh_parab_1@yahoo.com>
Subject: Re: ParalleReader and synchronization between indexes
To: java-user@lucene.apache.org
In-Reply-To: <550803.14652.qm@web50309.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
Message-ID: <728451.39828.qm@web52010.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org


One trick I can think of is somehow keeping internal
document id of Lucene document same after document is
updated (i.e. deleted and re-inserted). I am not sure
if we have this capability in Lucene.

Regards,
Rajesh

--- Otis Gospodnetic <otis_gospodnetic@yahoo.com>
wrote:

> That's correct, Rajesh.  ParallelReader has its
> uses, but I guess your case is not one of them,
> unless we are all missing some key aspect of PR or a
> trick to make it work in your case.
> 
> Otis 
> 
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr -
> Nutch
> 
> ----- Original Message ----
> > From: Rajesh parab <rajesh_parab_1@yahoo.com>
> > To: java-user@lucene.apache.org
> > Sent: Thursday, May 1, 2008 6:55:00 PM
> > Subject: Re: ParalleReader and synchronization
> between indexes
> > 
> > Thanks Yonik.
> > 
> > So, if rebuilding the second index is not an
> option
> > due to large no of documents, then ParallelReader
> will
> > not work :-(
> > 
> > And I believe there is no other way than
> > parallelReader to search across multiple indexes
> that
> > contain related data. Is there any other
> alternative?
> > I think, MultiSearcher or MultiReader will only
> work
> > with multiple, unrelated indexes.
> > 
> > Regards,
> > Rajesh
> 
> 
> 
>
---------------------------------------------------------------------
> To unsubscribe, e-mail:
> java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail:
> java-user-help@lucene.apache.org
> 
> 



      ____________________________________________________________________________________
Be a better friend, newshound, and 
know-it-all with Yahoo! Mobile.  Try it now.  http://mobile.yahoo.com/;_ylt=Ahu06i62sR8HDtDypao8Wcj9tAcJ

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33873-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 06:58:44 2008
Return-Path: <java-user-return-33873-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71702 invoked from network); 2 May 2008 06:58:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 06:58:44 -0000
Received: (qmail 99289 invoked by uid 500); 2 May 2008 06:58:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99255 invoked by uid 500); 2 May 2008 06:58:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99244 invoked by uid 99); 2 May 2008 06:58:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 May 2008 23:58:37 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephane.nicoll@gmail.com designates 209.85.132.241 as permitted sender)
Received: from [209.85.132.241] (HELO an-out-0708.google.com) (209.85.132.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 06:57:53 +0000
Received: by an-out-0708.google.com with SMTP id c37so310527anc.49
        for <java-user@lucene.apache.org>; Thu, 01 May 2008 23:58:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=MFy0fImnvLi70x2Qqjm9z7XCFxvCTh80QcBp3qQGRTs=;
        b=U3CZzSNBLCCThDmILBG3x/0DQwYv5YeJPunAZKVEdWKmc0ePF6ERTypfMk0h09rqVHvg6/vkkEi8/zcZH9FMfHOBEyME+P+EjQvQ4QgiZ9BC7qvGVKc/nWyBtJvYFKbBk/96STEVVw4gurnG00akguFcyxvxDxEITYe14TRGlU0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=yGuqpfEvrSaV4ltwfRH+l5Lf8eermRoyszT6Sz7JearokwUJ3elVLsNU8x5xyqi/H/NeHyMZNaAOM6bwfkifKukYd8sjpPQSR4NC4CRHLq2EZH0bQTWOyuwUnhoYGEyuWKNnVA0hg2XQkGxfLxmpLybgugDCGJ6jLUB4PtH2HGo=
Received: by 10.100.96.9 with SMTP id t9mr4145654anb.129.1209711486742;
        Thu, 01 May 2008 23:58:06 -0700 (PDT)
Received: by 10.100.178.12 with HTTP; Thu, 1 May 2008 23:58:06 -0700 (PDT)
Message-ID: <541f12ca0805012358r2592fd47xd1c1e6f52d79dff7@mail.gmail.com>
Date: Fri, 2 May 2008 08:58:06 +0200
From: "Stephane Nicoll" <stephane.nicoll@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: hybrid query (lucene + db)
In-Reply-To: <652776090805011150i29576d04v7f4c2aa0bbba4753@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <101670.49504.qm@web26005.mail.ukl.yahoo.com>
	 <652776090805011150i29576d04v7f4c2aa0bbba4753@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Well for the moment we don't. The lucene index only contains the full
text content (indexed, not stored). We use lucene to perform full text
and fuzzy searches on the keywords field. Once we have the result, we
match them with the geospatial box provided by the user (we use Oracle
Spatial for that). We have no notion of city, state or zip code. Date
overlaps more than one countries most of the time actually.

We are thinking of reimplementing a quad tree in lucene to flag each
item with a spatial area. That way we will be able to pre-filter the
zone accordingly.

Still, this does not explain the deadlock on SegmentReader. If anyone
has an idea...

Thanks,
St=E9phane

On Thu, May 1, 2008 at 8:50 PM, Michael Stoppelman <stopman@gmail.com> wrot=
e:
> Stephane,
>
>  Could you describe how you setup the spatial area? Having BooleanQuery w=
ith
>  200 terms in it definitely slows things down (I'm not sure exactly why y=
et
>  -- it seems like it shouldn't be "that" slow). If you can describe your
>  spatial area in fewer terms you can get much better performance. It just
>  depends on how you're describing your spatial areas and the number of
>  results in each zipcode. If you had a field like "city,state" in your in=
dex
>  you would have far less terms in your query than if that query had all t=
he
>  zipcodes in a "city,state" combo, thus making your query much faster.
>
>  M
>
>  On Thu, May 1, 2008 at 2:15 AM, mark harwood <markharw00d@yahoo.co.uk>
>  wrote:
>
>
>
>  > The issue here is a general one of trying to perform an efficient join
>  > between an external resource (rdbms) and Lucene.
>  > This experiment may be of interest:
>  >    http://issues.apache.org/jira/browse/LUCENE-434
>  >
>  > KeyMap.java embodies the core service which translates from lucene doc=
 ids
>  > to DB primary keys or vice versa.
>  > There are a couple of implementations of KeyMap that are not optimal (=
they
>  > pre-date Lucene's FieldCache) but it may give you food for thought.
>  >
>  > Cheers
>  > Mark
>  >
>  >
>  > ----- Original Message ----
>  > From: Stephane Nicoll <stephane.nicoll@gmail.com>
>  > To: java-user@lucene.apache.org
>  > Sent: Thursday, 1 May, 2008 9:00:33 AM
>  > Subject: hybrid query (lucene + db)
>  >
>  > Hi there,
>  >
>  > We're using lucene with Hibernate search and we're very happy so far
>  > with the performance and the usability of lucene. We have however a
>  > specific use cases that prevent us to use only lucene: spatial
>  > queries. I already sent a mail on this list a while back about the
>  > problem and we started investigating multiple solutions.
>  >
>  > When the user selects a geographic area and some keywords we do the
>  > following:
>  >
>  > * Perform a search on the lucene index for the keywords with a
>  > projection that returns only the primaryKey of the element sorted by
>  > primary key
>  > * Perform a search on the database with other criterias and a
>  > projection that returns only the primary key of the elements
>  > * Iterate on both list to find N matching IDs, optionally with paging
>  > (some from X to X + N where X is the first result of the page)
>  > * Run a query on the database to return the actual objects (select a
>  > from MyClass a where a.id IN (the list of matching IDs) ) We limit the
>  > page to 1000 results
>  >
>  > We have searched a way to optimize the queries and to avoid to consume
>  > too much memory, knowing that we must support paging.
>  >
>  > With a single user a search by kewyords takes 30msec to complete, a
>  > search by box takes 45msec. With both (keywords + spatial area)  it
>  > takes 300msec
>  >
>  > With 10 concurrent users, a search by keywords takes 150msec/user  but
>  > for both it takes 3 sec/user !!!
>  >
>  > I had the profiler running on this scenario and I've found that *all*
>  > threads are waiting on org.apache.lucene.index.SegmentReader. I then
>  > configured Hibernate Search to use a separate index reader per thread.
>  > The deadlocks disappeared but it's still very slow (2.8sec).
>  >
>  > Some questions:
>  >
>  > * Does anyone knows where the deadlocks on SegmentReader are coming fr=
om?
>  > * Is the sorting on the primary keys a bad idea regarding performance
>  > and memory usage?
>  > * Does anyone has an idea to perform this kind of hybrid query in an
>  > efficient way?
>  >
>  > I am using lucene 2.3.1 and Hibernate Search 3.0.1. I already ask for
>  > support on the Hibernate Search forum but did not get any answer so
>  > far.
>  >
>  > Thanks,
>  > St=E9phane
>  >
>  > --
>  > Large Systems Suck: This rule is 100% transitive. If you build one,
>  > you suck" -- S.Yegge
>  >
>  > ---------------------------------------------------------------------
>  > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  > For additional commands, e-mail: java-user-help@lucene.apache.org
>  >
>  >
>  >
>  >
>  >
>  >
>  >       __________________________________________________________
>  > Sent from Yahoo! Mail.
>  > A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html
>  >
>  > ---------------------------------------------------------------------
>  > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  > For additional commands, e-mail: java-user-help@lucene.apache.org
>  >
>  >
>



--=20
Large Systems Suck: This rule is 100% transitive. If you build one,
you suck" -- S.Yegge

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33874-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 08:36:57 2008
Return-Path: <java-user-return-33874-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2729 invoked from network); 2 May 2008 08:36:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 08:36:57 -0000
Received: (qmail 67474 invoked by uid 500); 2 May 2008 08:36:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67435 invoked by uid 500); 2 May 2008 08:36:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67424 invoked by uid 99); 2 May 2008 08:36:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 01:36:50 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.213] (HELO web26002.mail.ukl.yahoo.com) (217.12.10.213)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 02 May 2008 08:35:55 +0000
Received: (qmail 43749 invoked by uid 60001); 2 May 2008 08:36:14 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=RuZLL5TjZG8CZ5XAWURdx4jdQDazxdxynhnpYDeQd1wRrzHvfpHtdMj/AJQHTYDDeF+GxAS+V3gLM2m2MvKu/PJ8D7lduzRFeP5Pe13aPWktmO3BS1bv6Ryt7vLrpXsghzDYud7Z0CVVhW6AAZVpUDSpEYFaGTSkGf82UEzZwpo=;
X-YMail-OSG: UvdJ4xMVM1nHvaDOkDY2N8FfWZ1rPgTQZu1czCYtsI3Y5uvxr9OEdKuvYWotH9Vlx_TgoXfWzwWHoJhUNqkrN7rrr0u2bsFyDvhmTZWhOf84jPa_NIb.MHG69hw-
Received: from [193.36.230.96] by web26002.mail.ukl.yahoo.com via HTTP; Fri, 02 May 2008 08:36:14 GMT
X-Mailer: YahooMailRC/902.40 YahooMailWebService/0.7.185
Date: Fri, 2 May 2008 08:36:14 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: Does Lucene Supports Billions of data
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Message-ID: <848219.43318.qm@web26002.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

>> If your terms are roughly equally distributed in all N indices(e.g. rand=
om doc->index/shard assignment), the relevance score willroughly match.=0A=
=0A=0AAgreed. I did some formal benchmarking of local IDF vs global IDF rel=
evance ranking recently.=0AI measured the movement of the top ranked docume=
nt in a single index's results (global IDF) vs the same document's position=
 in results merged from 2 remote indexes with randomized doc->shard assignm=
ent (a local IDF scheme). This distance was measured for a large number of =
real-world queries.=0AResults were very promising - the distributed ranking=
 scheme very rarely differed from that of the single large index.=0A=0A----=
- Original Message ----=0AFrom: Otis Gospodnetic <otis_gospodnetic@yahoo.co=
m>=0ATo: java-user@lucene.apache.org=0ASent: Friday, 2 May, 2008 1:35:04 AM=
=0ASubject: Re: Does Lucene Supports Billions of data=0A=0ARight.  And the =
typical answer to that is:=0A=0A- If your terms are roughly equally distrib=
uted in all N indices (e.g. random doc->index/shard assignment), the releva=
nce score will roughly match.=0A=0A- If you have business rules for doc->in=
dex/shard distribution, then your relevance scores will not be comparable.=
=0A=0AOtis =0A=0A--=0ASematext -- http://sematext.com/ -- Lucene - Solr - N=
utch=0A=0A----- Original Message ----=0A> From: Toke Eskildsen <te@statsbib=
lioteket.dk>=0A> To: java-user@lucene.apache.org=0A> Sent: Friday, May 2, 2=
008 12:13:04 AM=0A> Subject: Re: Does Lucene Supports Billions of data=0A> =
=0A> From: John Wang =0A> [...]=0A> > sub index 1: 1 billion docs=0A> > sub=
 index 2: 1 billion docs=0A> > sub index 3: 1 billion docs=0A> > =0A> > fed=
erating search to these subindexes, you represent an index of 3 =0A> > bill=
iondocs, and all internal doc ids are of type int.=0A> =0A> That falls unde=
r Daniel's "...unless you wrap your own framework around it". The =0A> prob=
lem with the solution you're describing is that it's not functionally =0A> =
equivalent to a single index of 3 billion docs.=0A> =0A> If you just create=
 3 independent indexes and merge the top hits from all 3, the =0A> ranking =
of the documents will be messed up. You'll need to make sure that the =0A> =
scores from the different indexes can be compared. That's tricky when the s=
core =0A> depends on the frequency of the terms in the whole corpus.=0A> =
=0A> =0A> -----------------------------------------------------------------=
----=0A> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org=0A=
> For additional commands, e-mail: java-user-help@lucene.apache.org=0A> =0A=
> =0A=0A=0A=0A-------------------------------------------------------------=
--------=0ATo unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org=
=0AFor additional commands, e-mail: java-user-help@lucene.apache.org=0A=0A=
=0A=0A=0A=0A=0A      ______________________________________________________=
____=0ASent from Yahoo! Mail.=0AA Smarter Email http://uk.docs.yahoo.com/no=
wyoucan.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33875-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 13:31:54 2008
Return-Path: <java-user-return-33875-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6774 invoked from network); 2 May 2008 13:31:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 13:31:54 -0000
Received: (qmail 35896 invoked by uid 500); 2 May 2008 13:31:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35861 invoked by uid 500); 2 May 2008 13:31:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35844 invoked by uid 99); 2 May 2008 13:31:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 06:31:48 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 13:30:52 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JrvM0-0006FN-In
	for java-user@lucene.apache.org; Fri, 02 May 2008 06:31:12 -0700
Message-ID: <17019498.post@talk.nabble.com>
Date: Fri, 2 May 2008 06:31:12 -0700 (PDT)
From: esra <esraersan@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: lucene farsi problem
In-Reply-To: <9294E20AED46934EA459020706463F94A04A4E@SUEXCL-02.ad.syr.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: esraersan@gmail.com
References: <16977096.post@talk.nabble.com> <08DF1421-37F0-4124-BCE3-DCD68EEC189A@apache.org> <16980977.post@talk.nabble.com> <1B1FC94C-66E4-4A8D-8C92-38CCCEFDF3E8@apache.org> <16993174.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04A4E@SUEXCL-02.ad.syr.edu>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Steven,

sorry i made a mistake. unicodes are like this:

> =D8=AF=3DU+62F
> =DA=98 =3D U+632
> and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1 " is=
  =D8=B3 =3D U+633

you can also check them here
:http://www.unics.uni-hannover.de/nhtcapri/persian-alphabet.html

Esra


Steven A Rowe wrote:
>=20
> Hi Esra,
>=20
> Going back to the original problem statement, I see something that looks
> illogical to me - please correct me if I'm wrong:
>=20
> On Apr 30, 2008, at 3:21 AM, esra wrote:
>> i am using lucene's "IndexSearcher" to search the given xml by
>> keyword which contains farsi information.
>> while searching i use ranges like
>>=20
>> =D8=A2-=D8=AB  |  =D8=AC-=D8=AE  |  =D8=AF-=DA=98  |  =D8=B3-=D8=B8  |  =
=D8=B9-=D9=82  |  =DA=A9-=D9=84  |  =D9=85-=DB=8C
>>=20
>> when i do search for  "=D8=AF-=DA=98"  range the results are wrong , the=
y
>> are the results of  " =D8=B3-=D8=B8 "range.
>>=20
>> for example when i do search for "=D8=AF-=DA=98"  one of the the results=
 is
>> "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1", this result also shown on=
 the " =D8=B3-=D8=B8 " range's result
>> list which is the corret range.
>>=20
>> As IndexSearcher use "compareTo" method and this method uses
>> unicodes for comparing, i found the unicodes of the characters.
>>=20
>> =D8=AF=3DU+62F
>> =DA=98 =3D U+698
>> and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1 " i=
s  =D8=B3 =3D U+633
>=20
> It appears to me that *both* the "=D8=AF-=DA=98" range [ U+062F - U+0698 =
] and the
> "=D8=B3-=D8=B8" range [ U+0633 - U+0638 ] contain the first letter of "=
=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1",
> which is "=D8=B3" =3D U+0633. =20
>=20
> You stated that U+0633 should be contained in the [ U+0633 - U+0638 ]
> range - I agree - but why do you think U+0633 should not be contained in
> the [ U+062F - U+0698 ] range?
>=20
> In other words, it looks to me like your problem is not a problem at all.
>=20
> Steve
>=20
>=20

--=20
View this message in context: http://www.nabble.com/lucene-farsi-problem-tp=
16977096p17019498.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33876-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 14:20:54 2008
Return-Path: <java-user-return-33876-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22510 invoked from network); 2 May 2008 14:20:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 14:20:53 -0000
Received: (qmail 36516 invoked by uid 500); 2 May 2008 14:20:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36489 invoked by uid 500); 2 May 2008 14:20:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36478 invoked by uid 99); 2 May 2008 14:20:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 07:20:47 -0700
X-ASF-Spam-Status: No, hits=-3.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.108.46] (HELO SUEXCL-02.ad.syr.edu) (128.230.108.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 14:20:00 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
Subject: RE: lucene farsi problem
Date: Fri, 2 May 2008 10:18:37 -0400
Message-ID: <9294E20AED46934EA459020706463F94A04AD2@SUEXCL-02.ad.syr.edu>
In-Reply-To: <17019498.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: lucene farsi problem
Thread-Index: AcisWOcj0g20OOurRXGfPCTYpTYJPwAA107g
From: "Steven A Rowe" <sarowe@syr.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgRXNyYSwNCg0KSSBzdGlsbCB0aGluayB5b3UncmUgd3JvbmcgOikuDQoNCk9uIDA1LzAyLzIw
MDggYXQgOTozMSBBTSwgZXNyYSB3cm90ZToNCj4gPiDamCA9IFUrNjMyDQoNCkFjY29yZGluZyB0
byB0aGUgd2Vic2l0ZSB5b3UgbGlua2VkIHRvLCB0aGUgYWJvdmUgY2hhcmFjdGVyLCB3aGljaCBo
YXMgdGhyZWUgZG90cyBvdmVyIGl0LCBpcyBuYW1lZCAiemhlIiwgYW5kIGl0cyBVbmljb2RlIGNv
ZGUgcG9pbnQgaXMgVSs2OTguICAoSSBoYWQgdG8gaW5jcmVhc2UgdGhlIGZvbnQgc2l6ZSB0byBz
ZWUgdGhlIHRocmVlIGRvdHMuKQ0KDQpJIHRoaW5rIHlvdSBhcmUgY29uZnVzaW5nICLamCIvInpo
ZSIvVSs2OTggd2l0aCB0aGUgbGV0dGVyICLYsiIvInplIi9VKzYzMiwgd2hpY2ggaGFzIGp1c3Qg
b25lIGRvdCBvdmVyIGl0Lg0KDQpVbmxlc3MgeW91IHdlcmUgbWlzdGFrZW4gaW4gYWxsIG9mIHlv
dXIgZW1haWxzIHdoZW4geW91IGluY2x1ZGVkIHRoZSBjaGFyYWN0ZXIgItqYIi8iemhlIiBpbnN0
ZWFkIG9mICLYsiIvInplIiwgdGhlbiB3aGF0IEkgc2FpZCBpbiBteSBwcmV2aW91cyBlbWFpbCBz
dGlsbCBzdGFuZHM6IHRoZXJlIGlzIG5vIHByb2JsZW0gaGVyZS4NCg0KU3RldmUNCg0KT24gMDUv
MDIvMjAwOCBhdCA5OjMxIEFNLCBlc3JhIHdyb3RlOg0KPiANCj4gSGkgU3RldmVuLA0KPiANCj4g
c29ycnkgaSBtYWRlIGEgbWlzdGFrZS4gdW5pY29kZXMgYXJlIGxpa2UgdGhpczoNCj4gDQo+ID4g
2K89VSs2MkYNCj4gPiDamCA9IFUrNjMyDQo+ID4gYW5kIHRoZSBmaXJzdCBsZXR0ZXIgb2YgItiz
2KfYqCDZiNmI2YHYsSAiIGlzICDYsyA9IFUrNjMzDQo+IA0KPiB5b3UgY2FuIGFsc28gY2hlY2sg
dGhlbSBoZXJlDQo+ID4gaHR0cDovL3d3dy51bmljcy51bmktaGFubm92ZXIuZGUvbmh0Y2Fwcmkv
cGVyc2lhbi1hbHBoYWJldC5odG1sDQo+IA0KPiBFc3JhDQo+IA0KPiANCj4gU3RldmVuIEEgUm93
ZSB3cm90ZToNCj4gPiANCj4gPiBIaSBFc3JhLA0KPiA+IA0KPiA+IEdvaW5nIGJhY2sgdG8gdGhl
IG9yaWdpbmFsIHByb2JsZW0gc3RhdGVtZW50LCBJIHNlZSBzb21ldGhpbmcgdGhhdA0KPiA+IGxv
b2tzIGlsbG9naWNhbCB0byBtZSAtIHBsZWFzZSBjb3JyZWN0IG1lIGlmIEknbSB3cm9uZzoNCj4g
PiANCj4gPiBPbiBBcHIgMzAsIDIwMDgsIGF0IDM6MjEgQU0sIGVzcmEgd3JvdGU6DQo+ID4gPiBp
IGFtIHVzaW5nIGx1Y2VuZSdzICJJbmRleFNlYXJjaGVyIiB0byBzZWFyY2ggdGhlIGdpdmVuIHht
bCBieQ0KPiA+ID4ga2V5d29yZCB3aGljaCBjb250YWlucyBmYXJzaSBpbmZvcm1hdGlvbi4NCj4g
PiA+IHdoaWxlIHNlYXJjaGluZyBpIHVzZSByYW5nZXMgbGlrZQ0KPiA+ID4gDQo+ID4gPiDYoi3Y
qyAgfCAg2Kwt2K4gIHwgINivLdqYICB8ICDYsy3YuCAgfCAg2Lkt2YIgIHwgINqpLdmEICB8ICDZ
hS3bjA0KPiA+ID4gDQo+ID4gPiB3aGVuIGkgZG8gc2VhcmNoIGZvciAgItivLdqYIiAgcmFuZ2Ug
dGhlIHJlc3VsdHMgYXJlIHdyb25nICwgdGhleQ0KPiA+ID4gYXJlIHRoZSByZXN1bHRzIG9mICAi
INizLdi4ICJyYW5nZS4NCj4gPiA+IA0KPiA+ID4gZm9yIGV4YW1wbGUgd2hlbiBpIGRvIHNlYXJj
aCBmb3IgItivLdqYIiAgb25lIG9mIHRoZSB0aGUgcmVzdWx0cyBpcw0KPiA+ID4gItiz2KfYqCDZ
iNmI2YHYsSIsIHRoaXMgcmVzdWx0IGFsc28gc2hvd24gb24gdGhlICIg2LMt2LggIiByYW5nZSdz
IHJlc3VsdA0KPiA+ID4gbGlzdCB3aGljaCBpcyB0aGUgY29ycmV0IHJhbmdlLg0KPiA+ID4gDQo+
ID4gPiBBcyBJbmRleFNlYXJjaGVyIHVzZSAiY29tcGFyZVRvIiBtZXRob2QgYW5kIHRoaXMgbWV0
aG9kIHVzZXMNCj4gPiA+IHVuaWNvZGVzIGZvciBjb21wYXJpbmcsIGkgZm91bmQgdGhlIHVuaWNv
ZGVzIG9mIHRoZSBjaGFyYWN0ZXJzLg0KPiA+ID4gDQo+ID4gPiDYrz1VKzYyRg0KPiA+ID4g2pgg
PSBVKzY5OA0KPiA+ID4gYW5kIHRoZSBmaXJzdCBsZXR0ZXIgb2YgItiz2KfYqCDZiNmI2YHYsSAi
IGlzICDYsyA9IFUrNjMzDQo+ID4gDQo+ID4gSXQgYXBwZWFycyB0byBtZSB0aGF0ICpib3RoKiB0
aGUgItivLdqYIiByYW5nZSBbIFUrMDYyRiAtIFUrMDY5OCBdIGFuZA0KPiA+IHRoZSAi2LMt2Lgi
IHJhbmdlIFsgVSswNjMzIC0gVSswNjM4IF0gY29udGFpbiB0aGUgZmlyc3QgbGV0dGVyIG9mICLY
s9in2KgNCj4gPiDZiNmI2YHYsSIsIHdoaWNoIGlzICLYsyIgPSBVKzA2MzMuDQo+ID4gDQo+ID4g
WW91IHN0YXRlZCB0aGF0IFUrMDYzMyBzaG91bGQgYmUgY29udGFpbmVkIGluIHRoZSBbIFUrMDYz
MyAtIFUrMDYzOCBdDQo+ID4gcmFuZ2UgLSBJIGFncmVlIC0gYnV0IHdoeSBkbyB5b3UgdGhpbmsg
VSswNjMzIHNob3VsZCBub3QgYmUgY29udGFpbmVkDQo+ID4gaW4gdGhlIFsgVSswNjJGIC0gVSsw
Njk4IF0gcmFuZ2U/DQo+ID4gDQo+ID4gSW4gb3RoZXIgd29yZHMsIGl0IGxvb2tzIHRvIG1lIGxp
a2UgeW91ciBwcm9ibGVtIGlzIG5vdCBhIHByb2JsZW0gYXQNCj4gPiBhbGwuDQo+ID4gDQo+ID4g
U3RldmUNCj4gPiANCj4gPiANCj4gDQo+IC0tIFZpZXcgdGhpcyBtZXNzYWdlIGluIGNvbnRleHQ6
DQo+IGh0dHA6Ly93d3cubmFiYmxlLmNvbS9sdWNlbmUtZmFyc2ktcHJvYmxlbS10cDE2OTc3MDk2
cDE3MDE5NDk4Lmh0bWwgU2VudA0KPiBmcm9tIHRoZSBMdWNlbmUgLSBKYXZhIFVzZXJzIG1haWxp
bmcgbGlzdCBhcmNoaXZlIGF0IE5hYmJsZS5jb20uDQo+IA0KPiANCj4gLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFRv
DQo+IHVuc3Vic2NyaWJlLCBlLW1haWw6IGphdmEtdXNlci11bnN1YnNjcmliZUBsdWNlbmUuYXBh
Y2hlLm9yZyBGb3INCj4gYWRkaXRpb25hbCBjb21tYW5kcywgZS1tYWlsOiBqYXZhLXVzZXItaGVs
cEBsdWNlbmUuYXBhY2hlLm9yZw0KPiANCj4NCg0KIA0KDQo=


From java-user-return-33877-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 15:34:12 2008
Return-Path: <java-user-return-33877-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63815 invoked from network); 2 May 2008 15:34:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 15:34:12 -0000
Received: (qmail 78304 invoked by uid 500); 2 May 2008 15:34:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77958 invoked by uid 500); 2 May 2008 15:34:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77947 invoked by uid 99); 2 May 2008 15:34:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 08:34:06 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephane.nicoll@gmail.com designates 209.85.132.246 as permitted sender)
Received: from [209.85.132.246] (HELO an-out-0708.google.com) (209.85.132.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 15:33:21 +0000
Received: by an-out-0708.google.com with SMTP id c37so351356anc.49
        for <java-user@lucene.apache.org>; Fri, 02 May 2008 08:33:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=VPgYdvWMjxQlotMshu1zV23HA10ORbyRTrzmKTV/F3E=;
        b=He9W21EM0t6LoVNdCfpJVzPTKoDyeqMMGPl1NHJEYbDaMXlXaqFZ7iO9CmCumB2Lr9fz9VfBXd+LFBO4fi8ItkDJ6p1hmHq27fGmdJlJ81wOA47FgaRms0+JdKKPG7lSWTx9Dgm3zWuiep+0nDk5GBgq65NNiiFuVzARfhoeeWk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=RGtQ95cbPuAFe/pFkL2P282vvMBtdXlEr6Xiw0P5c1xOXfT333XsKPVWuU459DjufQ9302orX1xK5guu3utVwgvGvCxsv7uKnumFl4HdsSK66CWJSK8kBdpeWaaEZaebtNXdjPcHBpXoKpeXyWBRJiH7LLuAofr4+nwcKvnzTeE=
Received: by 10.100.227.6 with SMTP id z6mr4799048ang.41.1209742413297;
        Fri, 02 May 2008 08:33:33 -0700 (PDT)
Received: by 10.100.178.12 with HTTP; Fri, 2 May 2008 08:33:33 -0700 (PDT)
Message-ID: <541f12ca0805020833u6f7e4219w65c30b693e3225bf@mail.gmail.com>
Date: Fri, 2 May 2008 17:33:33 +0200
From: "Stephane Nicoll" <stephane.nicoll@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: hybrid query (lucene + db)
In-Reply-To: <101670.49504.qm@web26005.mail.ukl.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <101670.49504.qm@web26005.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I had a look to this but didn't find anything that correspond to my problem=
.

Apparently there is a bug in Hibernate Search. If I use the same load
test on the same index with the same data with a direct access to the
lucene API, I get much better performance (and no deadlock on
SegmentReader).

I will report the problem there.

Thanks,
St=E9phane






On Thu, May 1, 2008 at 11:15 AM, mark harwood <markharw00d@yahoo.co.uk> wro=
te:
> The issue here is a general one of trying to perform an efficient join be=
tween an external resource (rdbms) and Lucene.
>  This experiment may be of interest:
>     http://issues.apache.org/jira/browse/LUCENE-434
>
>  KeyMap.java embodies the core service which translates from lucene doc i=
ds to DB primary keys or vice versa.
>  There are a couple of implementations of KeyMap that are not optimal (th=
ey pre-date Lucene's FieldCache) but it may give you food for thought.
>
>  Cheers
>  Mark
>
>
>
>
>  ----- Original Message ----
>  From: Stephane Nicoll <stephane.nicoll@gmail.com>
>  To: java-user@lucene.apache.org
>  Sent: Thursday, 1 May, 2008 9:00:33 AM
>  Subject: hybrid query (lucene + db)
>
>  Hi there,
>
>  We're using lucene with Hibernate search and we're very happy so far
>  with the performance and the usability of lucene. We have however a
>  specific use cases that prevent us to use only lucene: spatial
>  queries. I already sent a mail on this list a while back about the
>  problem and we started investigating multiple solutions.
>
>  When the user selects a geographic area and some keywords we do the foll=
owing:
>
>  * Perform a search on the lucene index for the keywords with a
>  projection that returns only the primaryKey of the element sorted by
>  primary key
>  * Perform a search on the database with other criterias and a
>  projection that returns only the primary key of the elements
>  * Iterate on both list to find N matching IDs, optionally with paging
>  (some from X to X + N where X is the first result of the page)
>  * Run a query on the database to return the actual objects (select a
>  from MyClass a where a.id IN (the list of matching IDs) ) We limit the
>  page to 1000 results
>
>  We have searched a way to optimize the queries and to avoid to consume
>  too much memory, knowing that we must support paging.
>
>  With a single user a search by kewyords takes 30msec to complete, a
>  search by box takes 45msec. With both (keywords + spatial area)  it
>  takes 300msec
>
>  With 10 concurrent users, a search by keywords takes 150msec/user  but
>  for both it takes 3 sec/user !!!
>
>  I had the profiler running on this scenario and I've found that *all*
>  threads are waiting on org.apache.lucene.index.SegmentReader. I then
>  configured Hibernate Search to use a separate index reader per thread.
>  The deadlocks disappeared but it's still very slow (2.8sec).
>
>  Some questions:
>
>  * Does anyone knows where the deadlocks on SegmentReader are coming from=
?
>  * Is the sorting on the primary keys a bad idea regarding performance
>  and memory usage?
>  * Does anyone has an idea to perform this kind of hybrid query in an
>  efficient way?
>
>  I am using lucene 2.3.1 and Hibernate Search 3.0.1. I already ask for
>  support on the Hibernate Search forum but did not get any answer so
>  far.
>
>  Thanks,
>  St=E9phane
>
>  --
>  Large Systems Suck: This rule is 100% transitive. If you build one,
>  you suck" -- S.Yegge
>
>  ---------------------------------------------------------------------
>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
>
>
>
>       __________________________________________________________
>  Sent from Yahoo! Mail.
>  A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html
>
>  ---------------------------------------------------------------------
>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Large Systems Suck: This rule is 100% transitive. If you build one,
you suck" -- S.Yegge

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33878-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 15:57:34 2008
Return-Path: <java-user-return-33878-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74459 invoked from network); 2 May 2008 15:57:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 15:57:34 -0000
Received: (qmail 27312 invoked by uid 500); 2 May 2008 15:57:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27283 invoked by uid 500); 2 May 2008 15:57:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27267 invoked by uid 99); 2 May 2008 15:57:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 08:57:28 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 15:56:36 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id C655F71C32D; Fri,  2 May 2008 08:56:56 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id C1CD171C118;
	Fri,  2 May 2008 08:56:56 -0700 (PDT)
Date: Fri, 2 May 2008 08:56:56 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
cc: vaijanathrao@aol.com
Subject: Re: Lucene Indexing structure
In-Reply-To: <4812EF79.4050906@aol.com>
Message-ID: <Pine.LNX.4.62.0805020847290.27756@radix.cryptio.net>
References: <4812EF79.4050906@aol.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Hi Lucene-user and Lucene-dev,

Please do not cross post -- java-user is the suitable place for your 
question.

: Obviously there is something wrong with the above approach (as to get the
: correct document we need to get all the documents and than do the required
: distance calculation), but that' due to lack of my knowledge of Luce and
: lucene's Index storage.
: 
: What I want to know how to improve upon the exsisting architecture other than
: making number of fields in the lucene equalling to total number of
: feature*size of each feature.

I suspect one of the reasons you haven't gotten much of a response yet is 
that people may not understand your problem statement -- I know nothing of 
Image Processing and even after googling "Color Histogram" I don't really 
understand how the examples you gave represent Color Histograms, or what 
it would mean to search on it with your example input.

Perhaps you could describe in more detail what exactly some sample 
data looks like, why certian objects should match certain queries, (and 
just as importantly: why other objects shouldn't match, and give examples 
of one one object is a "better" match then another object for each example 
query.

don't worry about Lucene Document/Field/QueryParse specifics -- just 
explain the concepts you are dealing with.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33879-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 16:19:24 2008
Return-Path: <java-user-return-33879-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84427 invoked from network); 2 May 2008 16:19:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 16:19:24 -0000
Received: (qmail 63366 invoked by uid 500); 2 May 2008 16:19:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63338 invoked by uid 500); 2 May 2008 16:19:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63327 invoked by uid 99); 2 May 2008 16:19:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 09:19:18 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 16:18:32 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Jrxy9-00034V-St
	for java-user@lucene.apache.org; Fri, 02 May 2008 09:18:45 -0700
Message-ID: <17022861.post@talk.nabble.com>
Date: Fri, 2 May 2008 09:18:45 -0700 (PDT)
From: esra <esraersan@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: lucene farsi problem
In-Reply-To: <9294E20AED46934EA459020706463F94A04AD2@SUEXCL-02.ad.syr.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: esraersan@gmail.com
References: <16977096.post@talk.nabble.com> <08DF1421-37F0-4124-BCE3-DCD68EEC189A@apache.org> <16980977.post@talk.nabble.com> <1B1FC94C-66E4-4A8D-8C92-38CCCEFDF3E8@apache.org> <16993174.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04A4E@SUEXCL-02.ad.syr.edu> <17019498.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04AD2@SUEXCL-02.ad.syr.edu>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Steven ,

yes the correct one is "=DA=98 "/"ze"/U+632.

my problem is when i do search for  "  =D8=AF-=DA=98" range. The result is =
 ""=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1=20
" and this word's first letter is "=D8=B3 " and it's unicode is "U+633"  an=
d  it
is not in the in the [ U+062F - U+0632 ] range.

am i wrong?

Esra


Steven A Rowe wrote:
>=20
> Hi Esra,
>=20
> I still think you're wrong :).
>=20
> On 05/02/2008 at 9:31 AM, esra wrote:
>> > =DA=98 =3D U+632
>=20
> According to the website you linked to, the above character, which has
> three dots over it, is named "zhe", and its Unicode code point is U+698.=
=20
> (I had to increase the font size to see the three dots.)
>=20
> I think you are confusing "=DA=98"/"zhe"/U+698 with the letter "=D8=B2"/"=
ze"/U+632,
> which has just one dot over it.
>=20
> Unless you were mistaken in all of your emails when you included the
> character "=DA=98"/"zhe" instead of "=D8=B2"/"ze", then what I said in my=
 previous
> email still stands: there is no problem here.
>=20
> Steve
>=20
> On 05/02/2008 at 9:31 AM, esra wrote:
>>=20
>> Hi Steven,
>>=20
>> sorry i made a mistake. unicodes are like this:
>>=20
>> > =D8=AF=3DU+62F
>> > =DA=98 =3D U+632
>> > and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1 "=
 is  =D8=B3 =3D U+633
>>=20
>> you can also check them here
>> > http://www.unics.uni-hannover.de/nhtcapri/persian-alphabet.html
>>=20
>> Esra
>>=20
>>=20
>> Steven A Rowe wrote:
>> >=20
>> > Hi Esra,
>> >=20
>> > Going back to the original problem statement, I see something that
>> > looks illogical to me - please correct me if I'm wrong:
>> >=20
>> > On Apr 30, 2008, at 3:21 AM, esra wrote:
>> > > i am using lucene's "IndexSearcher" to search the given xml by
>> > > keyword which contains farsi information.
>> > > while searching i use ranges like
>> > >=20
>> > > =D8=A2-=D8=AB  |  =D8=AC-=D8=AE  |  =D8=AF-=DA=98  |  =D8=B3-=D8=B8 =
 |  =D8=B9-=D9=82  |  =DA=A9-=D9=84  |  =D9=85-=DB=8C
>> > >=20
>> > > when i do search for  "=D8=AF-=DA=98"  range the results are wrong ,=
 they
>> > > are the results of  " =D8=B3-=D8=B8 "range.
>> > >=20
>> > > for example when i do search for "=D8=AF-=DA=98"  one of the the res=
ults is
>> > > "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1", this result also show=
n on the " =D8=B3-=D8=B8 " range's result
>> > > list which is the corret range.
>> > >=20
>> > > As IndexSearcher use "compareTo" method and this method uses
>> > > unicodes for comparing, i found the unicodes of the characters.
>> > >=20
>> > > =D8=AF=3DU+62F
>> > > =DA=98 =3D U+698
>> > > and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1=
 " is  =D8=B3 =3D U+633
>> >=20
>> > It appears to me that *both* the "=D8=AF-=DA=98" range [ U+062F - U+06=
98 ] and
>> > the "=D8=B3-=D8=B8" range [ U+0633 - U+0638 ] contain the first letter=
 of "=D8=B3=D8=A7=D8=A8
>> > =D9=88=D9=88=D9=81=D8=B1", which is "=D8=B3" =3D U+0633.
>> >=20
>> > You stated that U+0633 should be contained in the [ U+0633 - U+0638 ]
>> > range - I agree - but why do you think U+0633 should not be contained
>> > in the [ U+062F - U+0698 ] range?
>> >=20
>> > In other words, it looks to me like your problem is not a problem at
>> > all.
>> >=20
>> > Steve
>> >=20
>> >=20
>>=20
>> -- View this message in context:
>> http://www.nabble.com/lucene-farsi-problem-tp16977096p17019498.html Sent
>> from the Lucene - Java Users mailing list archive at Nabble.com.
>>=20
>>=20
>> --------------------------------------------------------------------- To
>> unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org For
>> additional commands, e-mail: java-user-help@lucene.apache.org
>>=20
>>
>=20
> =20
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/lucene-farsi-problem-tp=
16977096p17022861.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33880-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 16:31:44 2008
Return-Path: <java-user-return-33880-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92149 invoked from network); 2 May 2008 16:31:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 16:31:44 -0000
Received: (qmail 90991 invoked by uid 500); 2 May 2008 16:31:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90961 invoked by uid 500); 2 May 2008 16:31:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90950 invoked by uid 99); 2 May 2008 16:31:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 09:31:38 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of glen.newton@gmail.com designates 64.233.184.232 as permitted sender)
Received: from [64.233.184.232] (HELO wr-out-0506.google.com) (64.233.184.232)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 16:30:53 +0000
Received: by wr-out-0506.google.com with SMTP id c30so1013449wra.14
        for <java-user@lucene.apache.org>; Fri, 02 May 2008 09:31:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=XHsTjNjac/Pw6Ck2mu5ic3dj1/mhCtOVabwjZ+HjmXU=;
        b=Ir/K5qzi25WBLeSfnpRznew783F84DdlUjmIl0fv/aobi7m6w0JrZwjoZ9b6pQNzvBOywHU3s+HgaT5hyj20EljxFRsPXAUvp58ujgrL9snXcbE1T6fWo44bjO3qM6/Kvz0JzzbFEYkLmKk4d6Fx8G/TKdG+4etef7AprW0hN+s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=nioC3B7Coya8O3xv6sGEqNZgEtQNzkefBjtfYC8ymVps2qiq+U0zQqvWYSKqpGylX5yiZqksYhgXZ0r8m5Fs6byPqWGa//T1QRrUx8iJFDYu0F8wLJy1i1tznKwJVRe17Uiip3lSRcHjpbzfKX+hrkGgCYenOj2U23E+WvYFasY=
Received: by 10.140.126.14 with SMTP id y14mr1434950rvc.96.1209745866507;
        Fri, 02 May 2008 09:31:06 -0700 (PDT)
Received: by 10.140.148.19 with HTTP; Fri, 2 May 2008 09:31:06 -0700 (PDT)
Message-ID: <5e76f3840805020931r6586fb04qff9c6a92c10413a4@mail.gmail.com>
Date: Fri, 2 May 2008 12:31:06 -0400
From: "Glen Newton" <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene Indexing structure
Cc: java-dev@lucene.apache.org, vaijanathrao@aol.com
In-Reply-To: <4812EF79.4050906@aol.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <4812EF79.4050906@aol.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Vaijanath,

I think I would do things in a different fashion:
Lucene default distance metric is based on tf/idf and the cosine
model, i.e. the frequencies of items. I believe the values that you
are adding as Fields are the values in n-space for each of these
image-based attributes. I don't believe Lucene's default ranking will
not work for this.

You need to alter Lucene so that it understands that the Fields you
are adding represent the n-space values and not tokens, and alter
Lucene so that it uses this n-space to determine distance.

I am not a Lucene internals expert, but I think you need to write a
custom Similarity[1] class for use in your IndexSearcher[2] and
IndexWriter[3] and I think you might need a custom analyser that
understands that you are putting in actual numbers, not tokens, that
you use when building the index as well as querying it.

There are probably things I am missing and there may be a better way
to do this....

-Glen

[1]http://lucene.apache.org/java/2_2_0/api/org/apache/lucene/search/Similarity.html
[2]http://lucene.apache.org/java/2_2_0/api/org/apache/lucene/search/Searcher.html#setSimilarity(org.apache.lucene.search.Similarity)
[3]http://lucene.apache.org/java/2_2_0/api/org/apache/lucene/index/IndexWriter.html#getSimilarity()

2008/4/26 Vaijanath N. Rao <vaijanathrao@aol.com>:
> Hi Lucene-user and Lucene-dev,
>
>  I want to use lucene as an backend for the Image search (Content based
> Image retrieval).
>
>  Indexing Mechanism:
>  a) Get the Image properties such as Texture Tamura (TT), Texture Edge
> Histogram (TE), Color Coherence Vector (CCV) and Color Histogram (CH) and
> Color Correlogram  (CC) .
>  b) Convert each of these vector into String and index into lucene as
> fields, thush each Image (document in terms of lucene) consist of 6 fields
> Image name, TT field, TE field, CCV field, CH field and CC field.
>
>  Searching Mechanism:
>  a) For the search Image convert the Image into the above 5 properties.
>  b) for every field and for every value within the field construct the
> query, For example let's say the user wants to search only Color histogram
> based similarity and the query Image has 3 1 4 5 as the CH value the query
> will look like.
>    query = "CH:3 CH:1CH:4 CH:5"
>  c) for the results returned convert all the field values back into float
> and do the distance computation and re-rank the document with lower the
> distance on the top and larger distance at the bottom.
>  for example:
>    For above query assume that output has two documents
>    with one having CH as "1 3 5 4" and other one having CH as " 3 1 5 4", so
> the distance computation will rank the second document higher than the
> first.
>
>  Obviously there is something wrong with the above approach (as to get the
> correct document we need to get all the documents and than do the required
> distance calculation), but that' due to lack of my knowledge of Luce and
> lucene's Index storage.
>
>  What I want to know how to improve upon the exsisting architecture other
> than making number of fields in the lucene equalling to total number of
> feature*size of each feature.
>
>  Any other pointer will be welcomed. Is there is any Range tree
> implementation within lucene which I can use for this operation.
>
>  --Thanks and Regards
>  Vaijanath N. Rao
>
>  ---------------------------------------------------------------------
>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33881-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 16:35:09 2008
Return-Path: <java-user-return-33881-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93411 invoked from network); 2 May 2008 16:35:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 16:35:09 -0000
Received: (qmail 156 invoked by uid 500); 2 May 2008 16:35:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 118 invoked by uid 500); 2 May 2008 16:35:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 107 invoked by uid 99); 2 May 2008 16:35:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 09:35:03 -0700
X-ASF-Spam-Status: No, hits=-3.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.108.46] (HELO SUEXCL-02.ad.syr.edu) (128.230.108.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 16:34:06 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
Subject: RE: lucene farsi problem
Date: Fri, 2 May 2008 12:32:53 -0400
Message-ID: <9294E20AED46934EA459020706463F94A04ADD@SUEXCL-02.ad.syr.edu>
In-Reply-To: <17022861.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: lucene farsi problem
Thread-Index: AciscE23MnlmNpq8QcOFYTmnJKz51QAALrsw
From: "Steven A Rowe" <sarowe@syr.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgRXNyYSwNCg0KWW91IGFyZSAqc3RpbGwqIGluY29ycmVjdGx5IHJlZmVycmluZyB0byB0aGUg
Z2x5cGggd2l0aCB0aHJlZSBkb3RzIG92ZXIgaXQ6DQoNCk9uIDA1LzAyLzIwMDggYXQgMTI6MTgg
UE0sIGVzcmEgd3JvdGU6DQo+IHllcyB0aGUgY29ycmVjdCBvbmUgaXMgItqYICIvInplIi9VKzYz
Mi4NCg0KItqYIiBpcyAqbm90KiAiemUiL1UrNjMyIC0gaXQgaXMgInpoZSIvVSs2OTguDQoNCkhh
dmUgeW91IGluY3JlYXNlZCB0aGUgZm9udCBzaXplPyAgQ2FuIHlvdSBzZWUgdGhlIGRpZmZlcmVu
Y2UgYmV0d2VlbiB0aGVzZSB0d28/Og0KDQoi2pgiLyJ6aGUiL1UrNjk4DQoi2LIiLyJ6ZSIvVSs2
MzINCg0KPiBteSBwcm9ibGVtIGlzIHdoZW4gaSBkbyBzZWFyY2ggZm9yICAi2K8t2pgiIHJhbmdl
LiBUaGUgcmVzdWx0DQo+IGlzICAi2LPYp9ioINmI2YjZgdixIiBhbmQgdGhpcyB3b3JkJ3MgZmly
c3QgbGV0dGVyIGlzICLYsyIgYW5kIGl0J3MgdW5pY29kZSBpcw0KPiAiVSs2MzMiICBhbmQgaXQg
aXMgbm90IGluIHRoZSBpbiB0aGUgWyBVKzA2MkYgLSBVKzA2MzIgXSByYW5nZS4NCg0KTGlrZSBJ
IGtlZXAgc2F5aW5nLCBpbiB0aGUgYWJvdmUgZGVzY3JpcHRpb24sIHlvdSdyZSB1c2luZyB0aGUg
Z2x5cGggItqYIi8iemhlIi9VKzY5OCwgd2hpbGUgY2FsbGluZyBhdCB0aGUgc2FtZSB0aW1lIGlu
Y29ycmVjdGx5IHJlZmVycmluZyB0byBpdCBhcyAiemUiL1UrNjMyLg0KDQpJIGRvbid0IG1lYW4g
dG8gY29udGludWFsbHkgYmFuZyBvbiBhYm91dCB0aGlzIC0gaWYgeW91J3JlICpzdXJlKiB0aGF0
IHdoZW4geW91IHNlYXJjaCwgeW91J3JlIHVzaW5nIHRoZSBjaGFyYWN0ZXIgcmVwcmVzZW50ZWQg
YnkgdGhlIGdseXBoIHdpdGggb25lIGRvdCAoYW5kIG5vdCB0aHJlZSksIGkuZS4gItiyIi8iemUi
L1UrNjMyLCB0aGVuIHRoZSBwcm9ibGVtIGxpZXMgZWxzZXdoZXJlLg0KDQpTdGV2ZQ0KDQpPbiAw
NS8wMi8yMDA4IGF0IDEyOjE4IFBNLCBlc3JhIHdyb3RlOg0KPiB5ZXMgdGhlIGNvcnJlY3Qgb25l
IGlzICLamCAiLyJ6ZSIvVSs2MzIuDQo+IA0KPiBteSBwcm9ibGVtIGlzIHdoZW4gaSBkbyBzZWFy
Y2ggZm9yICAiICDYry3amCIgcmFuZ2UuIFRoZSByZXN1bHQNCj4gaXMgICIi2LPYp9ioINmI2YjZ
gdixDQo+ICIgYW5kIHRoaXMgd29yZCdzIGZpcnN0IGxldHRlciBpcyAi2LMgIiBhbmQgaXQncyB1
bmljb2RlIGlzDQo+ICJVKzYzMyIgIGFuZCAgaXQNCj4gaXMgbm90IGluIHRoZSBpbiB0aGUgWyBV
KzA2MkYgLSBVKzA2MzIgXSByYW5nZS4NCj4gDQo+IGFtIGkgd3Jvbmc/DQo+IA0KPiBFc3JhDQo+
IA0KPiBTdGV2ZW4gQSBSb3dlIHdyb3RlOg0KPiA+IA0KPiA+IEhpIEVzcmEsDQo+ID4gDQo+ID4g
SSBzdGlsbCB0aGluayB5b3UncmUgd3JvbmcgOikuDQo+ID4gDQo+ID4gT24gMDUvMDIvMjAwOCBh
dCA5OjMxIEFNLCBlc3JhIHdyb3RlOg0KPiA+ID4gPiDamCA9IFUrNjMyDQo+ID4gDQo+ID4gQWNj
b3JkaW5nIHRvIHRoZSB3ZWJzaXRlIHlvdSBsaW5rZWQgdG8sIHRoZSBhYm92ZSBjaGFyYWN0ZXIs
IHdoaWNoIGhhcw0KPiA+IHRocmVlIGRvdHMgb3ZlciBpdCwgaXMgbmFtZWQgInpoZSIsIGFuZCBp
dHMgVW5pY29kZSBjb2RlIHBvaW50IGlzDQo+ID4gVSs2OTguIChJIGhhZCB0byBpbmNyZWFzZSB0
aGUgZm9udCBzaXplIHRvIHNlZSB0aGUgdGhyZWUgZG90cy4pDQo+ID4gDQo+ID4gSSB0aGluayB5
b3UgYXJlIGNvbmZ1c2luZyAi2pgiLyJ6aGUiL1UrNjk4IHdpdGggdGhlIGxldHRlcg0KPiA+ICLY
siIvInplIi9VKzYzMiwgd2hpY2ggaGFzIGp1c3Qgb25lIGRvdCBvdmVyIGl0Lg0KPiA+IA0KPiA+
IFVubGVzcyB5b3Ugd2VyZSBtaXN0YWtlbiBpbiBhbGwgb2YgeW91ciBlbWFpbHMgd2hlbiB5b3Ug
aW5jbHVkZWQgdGhlDQo+ID4gY2hhcmFjdGVyICLamCIvInpoZSIgaW5zdGVhZCBvZiAi2LIiLyJ6
ZSIsIHRoZW4gd2hhdCBJIHNhaWQgaW4gbXkNCj4gPiBwcmV2aW91cyBlbWFpbCBzdGlsbCBzdGFu
ZHM6IHRoZXJlIGlzIG5vIHByb2JsZW0gaGVyZS4NCj4gPiANCj4gPiBTdGV2ZQ0KPiA+IA0KPiA+
IE9uIDA1LzAyLzIwMDggYXQgOTozMSBBTSwgZXNyYSB3cm90ZToNCj4gPiA+IA0KPiA+ID4gSGkg
U3RldmVuLA0KPiA+ID4gDQo+ID4gPiBzb3JyeSBpIG1hZGUgYSBtaXN0YWtlLiB1bmljb2RlcyBh
cmUgbGlrZSB0aGlzOg0KPiA+ID4gDQo+ID4gPiA+INivPVUrNjJGDQo+ID4gPiA+INqYID0gVSs2
MzINCj4gPiA+ID4gYW5kIHRoZSBmaXJzdCBsZXR0ZXIgb2YgItiz2KfYqCDZiNmI2YHYsSAiIGlz
ICDYsyA9IFUrNjMzDQo+ID4gPiANCj4gPiA+IHlvdSBjYW4gYWxzbyBjaGVjayB0aGVtIGhlcmUN
Cj4gPiA+ID4gaHR0cDovL3d3dy51bmljcy51bmktaGFubm92ZXIuZGUvbmh0Y2FwcmkvcGVyc2lh
bi1hbHBoYWJldC5odG1sDQo+ID4gPiANCj4gPiA+IEVzcmENCj4gPiA+IA0KPiA+ID4gDQo+ID4g
PiBTdGV2ZW4gQSBSb3dlIHdyb3RlOg0KPiA+ID4gPiANCj4gPiA+ID4gSGkgRXNyYSwNCj4gPiA+
ID4gDQo+ID4gPiA+IEdvaW5nIGJhY2sgdG8gdGhlIG9yaWdpbmFsIHByb2JsZW0gc3RhdGVtZW50
LCBJIHNlZSBzb21ldGhpbmcgdGhhdA0KPiA+ID4gPiBsb29rcyBpbGxvZ2ljYWwgdG8gbWUgLSBw
bGVhc2UgY29ycmVjdCBtZSBpZiBJJ20gd3Jvbmc6DQo+ID4gPiA+IA0KPiA+ID4gPiBPbiBBcHIg
MzAsIDIwMDgsIGF0IDM6MjEgQU0sIGVzcmEgd3JvdGU6DQo+ID4gPiA+ID4gaSBhbSB1c2luZyBs
dWNlbmUncyAiSW5kZXhTZWFyY2hlciIgdG8gc2VhcmNoIHRoZSBnaXZlbiB4bWwgYnkNCj4gPiA+
ID4gPiBrZXl3b3JkIHdoaWNoIGNvbnRhaW5zIGZhcnNpIGluZm9ybWF0aW9uLg0KPiA+ID4gPiA+
IHdoaWxlIHNlYXJjaGluZyBpIHVzZSByYW5nZXMgbGlrZQ0KPiA+ID4gPiA+IA0KPiA+ID4gPiA+
INiiLdirICB8ICDYrC3YriAgfCAg2K8t2pggIHwgINizLdi4ICB8ICDYuS3ZgiAgfCAg2qkt2YQg
IHwgINmFLduMDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gd2hlbiBpIGRvIHNlYXJjaCBmb3IgICLY
ry3amCIgIHJhbmdlIHRoZSByZXN1bHRzIGFyZSB3cm9uZyAsIHRoZXkNCj4gPiA+ID4gPiBhcmUg
dGhlIHJlc3VsdHMgb2YgICIg2LMt2LggInJhbmdlLg0KPiA+ID4gPiA+IA0KPiA+ID4gPiA+IGZv
ciBleGFtcGxlIHdoZW4gaSBkbyBzZWFyY2ggZm9yICLYry3amCIgIG9uZSBvZiB0aGUgdGhlIHJl
c3VsdHMgaXMNCj4gPiA+ID4gPiAi2LPYp9ioINmI2YjZgdixIiwgdGhpcyByZXN1bHQgYWxzbyBz
aG93biBvbiB0aGUgIiDYsy3YuCAiIHJhbmdlJ3MgcmVzdWx0DQo+ID4gPiA+ID4gbGlzdCB3aGlj
aCBpcyB0aGUgY29ycmV0IHJhbmdlLg0KPiA+ID4gPiA+IA0KPiA+ID4gPiA+IEFzIEluZGV4U2Vh
cmNoZXIgdXNlICJjb21wYXJlVG8iIG1ldGhvZCBhbmQgdGhpcyBtZXRob2QgdXNlcw0KPiA+ID4g
PiA+IHVuaWNvZGVzIGZvciBjb21wYXJpbmcsIGkgZm91bmQgdGhlIHVuaWNvZGVzIG9mIHRoZSBj
aGFyYWN0ZXJzLg0KPiA+ID4gPiA+IA0KPiA+ID4gPiA+INivPVUrNjJGDQo+ID4gPiA+ID4g2pgg
PSBVKzY5OA0KPiA+ID4gPiA+IGFuZCB0aGUgZmlyc3QgbGV0dGVyIG9mICLYs9in2Kgg2YjZiNmB
2LEgIiBpcyAg2LMgPSBVKzYzMw0KPiA+ID4gPiANCj4gPiA+ID4gSXQgYXBwZWFycyB0byBtZSB0
aGF0ICpib3RoKiB0aGUgItivLdqYIiByYW5nZSBbIFUrMDYyRiAtIFUrMDY5OCBdIGFuZA0KPiA+
ID4gPiB0aGUgItizLdi4IiByYW5nZSBbIFUrMDYzMyAtIFUrMDYzOCBdIGNvbnRhaW4gdGhlIGZp
cnN0IGxldHRlciBvZiAi2LPYp9ioDQo+ID4gPiA+INmI2YjZgdixIiwgd2hpY2ggaXMgItizIiA9
IFUrMDYzMy4NCj4gPiA+ID4gDQo+ID4gPiA+IFlvdSBzdGF0ZWQgdGhhdCBVKzA2MzMgc2hvdWxk
IGJlIGNvbnRhaW5lZCBpbiB0aGUgWyBVKzA2MzMgLSBVKzA2MzggXQ0KPiA+ID4gPiByYW5nZSAt
IEkgYWdyZWUgLSBidXQgd2h5IGRvIHlvdSB0aGluayBVKzA2MzMgc2hvdWxkIG5vdCBiZSBjb250
YWluZWQNCj4gPiA+ID4gaW4gdGhlIFsgVSswNjJGIC0gVSswNjk4IF0gcmFuZ2U/DQo+ID4gPiA+
IA0KPiA+ID4gPiBJbiBvdGhlciB3b3JkcywgaXQgbG9va3MgdG8gbWUgbGlrZSB5b3VyIHByb2Js
ZW0gaXMgbm90IGEgcHJvYmxlbSBhdA0KPiA+ID4gPiBhbGwuDQo+ID4gPiA+IA0KPiA+ID4gPiBT
dGV2ZQ0KPiA+ID4gPiANCj4gPiA+ID4gDQo+ID4gPiANCj4gPiA+IC0tIFZpZXcgdGhpcyBtZXNz
YWdlIGluIGNvbnRleHQ6DQo+ID4gPiANCj4gaHR0cDovL3d3dy5uYWJibGUuY29tL2x1Y2VuZS1m
YXJzaS1wcm9ibGVtLXRwMTY5NzcwOTZwMTcwMTk0OTgNCiAuaHRtbCBTZW50DQo+ID4gZnJvbSB0
aGUgTHVjZW5lIC0gSmF2YSBVc2VycyBtYWlsaW5nIGxpc3QgYXJjaGl2ZSBhdCBOYWJibGUuY29t
Lg0KPiA+IA0KPiA+IA0KPiA+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBUbw0KPiA+IHVuc3Vic2NyaWJlLCBlLW1h
aWw6IGphdmEtdXNlci11bnN1YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZyBGb3INCj4gPiBhZGRp
dGlvbmFsIGNvbW1hbmRzLCBlLW1haWw6IGphdmEtdXNlci1oZWxwQGx1Y2VuZS5hcGFjaGUub3Jn
DQo+ID4gDQo+ID4gDQo+IA0KPiANCj4gDQo+IA0KPiANCiANCiAtLQ0KIFZpZXcgdGhpcyBtZXNz
YWdlIGluIGNvbnRleHQ6IGh0dHA6Ly93d3cubmFiYmxlLmNvbS9sdWNlbmUtZmFyc2ktcHJvYmxl
bS10cDE2OTc3MDk2cDE3MDIyODYxLmh0bWwNCiBTZW50IGZyb20gdGhlIEx1Y2VuZSAtIEphdmEg
VXNlcnMgbWFpbGluZyBsaXN0IGFyY2hpdmUgYXQgTmFiYmxlLmNvbS4NCiANCiANCiAtLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0NCiBUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVAbHVj
ZW5lLmFwYWNoZS5vcmcNCiBGb3IgYWRkaXRpb25hbCBjb21tYW5kcywgZS1tYWlsOiBqYXZhLXVz
ZXItaGVscEBsdWNlbmUuYXBhY2hlLm9yZw0KDQogDQoNCg==


From java-user-return-33882-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 16:55:59 2008
Return-Path: <java-user-return-33882-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4106 invoked from network); 2 May 2008 16:55:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 16:55:58 -0000
Received: (qmail 32046 invoked by uid 500); 2 May 2008 16:55:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31963 invoked by uid 500); 2 May 2008 16:55:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31882 invoked by uid 99); 2 May 2008 16:55:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 09:55:51 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 16:55:03 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JryXV-00047V-7t
	for java-user@lucene.apache.org; Fri, 02 May 2008 09:55:17 -0700
Message-ID: <17023557.post@talk.nabble.com>
Date: Fri, 2 May 2008 09:55:17 -0700 (PDT)
From: esra <esraersan@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: lucene farsi problem
In-Reply-To: <9294E20AED46934EA459020706463F94A04ADD@SUEXCL-02.ad.syr.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: esraersan@gmail.com
References: <16977096.post@talk.nabble.com> <08DF1421-37F0-4124-BCE3-DCD68EEC189A@apache.org> <16980977.post@talk.nabble.com> <1B1FC94C-66E4-4A8D-8C92-38CCCEFDF3E8@apache.org> <16993174.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04A4E@SUEXCL-02.ad.syr.edu> <17019498.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04AD2@SUEXCL-02.ad.syr.edu> <17022861.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04ADD@SUEXCL-02.ad.syr.edu>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Steven ,

yes you are right, sorry i am a bit confused.

i checked again and the correct one is  "zhe"/U+698.=20

It seems the word is in the range but my customer says it shouldn't be.

I think problem occurs because  "zhe" is a Persian letter outside the Arabi=
c
alphabet. In farsi alphabet this letter is not after the "=D8=B3" letter bu=
t it's
unicode is bigger than "=D8=B3" letter's and the searcher works with unicod=
es.=20

Esra


Steven A Rowe wrote:
>=20
> Hi Esra,
>=20
> You are *still* incorrectly referring to the glyph with three dots over
> it:
>=20
> On 05/02/2008 at 12:18 PM, esra wrote:
>> yes the correct one is "=DA=98 "/"ze"/U+632.
>=20
> "=DA=98" is *not* "ze"/U+632 - it is "zhe"/U+698.
>=20
> Have you increased the font size?  Can you see the difference between
> these two?:
>=20
> "=DA=98"/"zhe"/U+698
> "=D8=B2"/"ze"/U+632
>=20
>> my problem is when i do search for  "=D8=AF-=DA=98" range. The result
>> is  "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1" and this word's first =
letter is "=D8=B3" and it's unicode is
>> "U+633"  and it is not in the in the [ U+062F - U+0632 ] range.
>=20
> Like I keep saying, in the above description, you're using the glyph
> "=DA=98"/"zhe"/U+698, while calling at the same time incorrectly referrin=
g to
> it as "ze"/U+632.
>=20
> I don't mean to continually bang on about this - if you're *sure* that
> when you search, you're using the character represented by the glyph with
> one dot (and not three), i.e. "=D8=B2"/"ze"/U+632, then the problem lies
> elsewhere.
>=20
> Steve
>=20
> On 05/02/2008 at 12:18 PM, esra wrote:
>> yes the correct one is "=DA=98 "/"ze"/U+632.
>>=20
>> my problem is when i do search for  "  =D8=AF-=DA=98" range. The result
>> is  ""=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1
>> " and this word's first letter is "=D8=B3 " and it's unicode is
>> "U+633"  and  it
>> is not in the in the [ U+062F - U+0632 ] range.
>>=20
>> am i wrong?
>>=20
>> Esra
>>=20
>> Steven A Rowe wrote:
>> >=20
>> > Hi Esra,
>> >=20
>> > I still think you're wrong :).
>> >=20
>> > On 05/02/2008 at 9:31 AM, esra wrote:
>> > > > =DA=98 =3D U+632
>> >=20
>> > According to the website you linked to, the above character, which has
>> > three dots over it, is named "zhe", and its Unicode code point is
>> > U+698. (I had to increase the font size to see the three dots.)
>> >=20
>> > I think you are confusing "=DA=98"/"zhe"/U+698 with the letter
>> > "=D8=B2"/"ze"/U+632, which has just one dot over it.
>> >=20
>> > Unless you were mistaken in all of your emails when you included the
>> > character "=DA=98"/"zhe" instead of "=D8=B2"/"ze", then what I said in=
 my
>> > previous email still stands: there is no problem here.
>> >=20
>> > Steve
>> >=20
>> > On 05/02/2008 at 9:31 AM, esra wrote:
>> > >=20
>> > > Hi Steven,
>> > >=20
>> > > sorry i made a mistake. unicodes are like this:
>> > >=20
>> > > > =D8=AF=3DU+62F
>> > > > =DA=98 =3D U+632
>> > > > and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=
=B1 " is  =D8=B3 =3D U+633
>> > >=20
>> > > you can also check them here
>> > > > http://www.unics.uni-hannover.de/nhtcapri/persian-alphabet.html
>> > >=20
>> > > Esra
>> > >=20
>> > >=20
>> > > Steven A Rowe wrote:
>> > > >=20
>> > > > Hi Esra,
>> > > >=20
>> > > > Going back to the original problem statement, I see something that
>> > > > looks illogical to me - please correct me if I'm wrong:
>> > > >=20
>> > > > On Apr 30, 2008, at 3:21 AM, esra wrote:
>> > > > > i am using lucene's "IndexSearcher" to search the given xml by
>> > > > > keyword which contains farsi information.
>> > > > > while searching i use ranges like
>> > > > >=20
>> > > > > =D8=A2-=D8=AB  |  =D8=AC-=D8=AE  |  =D8=AF-=DA=98  |  =D8=B3-=D8=
=B8  |  =D8=B9-=D9=82  |  =DA=A9-=D9=84  |  =D9=85-=DB=8C
>> > > > >=20
>> > > > > when i do search for  "=D8=AF-=DA=98"  range the results are wro=
ng , they
>> > > > > are the results of  " =D8=B3-=D8=B8 "range.
>> > > > >=20
>> > > > > for example when i do search for "=D8=AF-=DA=98"  one of the the=
 results is
>> > > > > "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1", this result also =
shown on the " =D8=B3-=D8=B8 " range's result
>> > > > > list which is the corret range.
>> > > > >=20
>> > > > > As IndexSearcher use "compareTo" method and this method uses
>> > > > > unicodes for comparing, i found the unicodes of the characters.
>> > > > >=20
>> > > > > =D8=AF=3DU+62F
>> > > > > =DA=98 =3D U+698
>> > > > > and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=
=D8=B1 " is  =D8=B3 =3D U+633
>> > > >=20
>> > > > It appears to me that *both* the "=D8=AF-=DA=98" range [ U+062F - =
U+0698 ]
>> and
>> > > > the "=D8=B3-=D8=B8" range [ U+0633 - U+0638 ] contain the first le=
tter of
>> "=D8=B3=D8=A7=D8=A8
>> > > > =D9=88=D9=88=D9=81=D8=B1", which is "=D8=B3" =3D U+0633.
>> > > >=20
>> > > > You stated that U+0633 should be contained in the [ U+0633 - U+063=
8
>> ]
>> > > > range - I agree - but why do you think U+0633 should not be
>> contained
>> > > > in the [ U+062F - U+0698 ] range?
>> > > >=20
>> > > > In other words, it looks to me like your problem is not a problem
>> at
>> > > > all.
>> > > >=20
>> > > > Steve
>> > > >=20
>> > > >=20
>> > >=20
>> > > -- View this message in context:
>> > >=20
>> http://www.nabble.com/lucene-farsi-problem-tp16977096p17019498
>  .html Sent
>> > from the Lucene - Java Users mailing list archive at Nabble.com.
>> >=20
>> >=20
>> > ---------------------------------------------------------------------
>> To
>> > unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org For
>> > additional commands, e-mail: java-user-help@lucene.apache.org
>> >=20
>> >=20
>>=20
>>=20
>>=20
>>=20
>>=20
> =20
>  --
>  View this message in context:
> http://www.nabble.com/lucene-farsi-problem-tp16977096p17022861.html
>  Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> =20
> =20
>  ---------------------------------------------------------------------
>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
> =20
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/lucene-farsi-problem-tp=
16977096p17023557.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33883-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 16:56:39 2008
Return-Path: <java-user-return-33883-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4434 invoked from network); 2 May 2008 16:56:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 16:56:39 -0000
Received: (qmail 34450 invoked by uid 500); 2 May 2008 16:56:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34169 invoked by uid 500); 2 May 2008 16:56:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34158 invoked by uid 99); 2 May 2008 16:56:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 09:56:33 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,URIBL_GREY
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of marcelo.ochoa@gmail.com designates 74.125.46.31 as permitted sender)
Received: from [74.125.46.31] (HELO yw-out-2324.google.com) (74.125.46.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 16:55:45 +0000
Received: by yw-out-2324.google.com with SMTP id 5so4344ywb.5
        for <java-user@lucene.apache.org>; Fri, 02 May 2008 09:55:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=G2z/6nJvkvDC3VgT+HwvaiWmx3xIGN4ZQVuWRvt0t2E=;
        b=qL2UqhuPtN8R+qTVjk+gerOENq3p1YD2qWX6WOvK2pFWnqRc4A8fbZisZNfP+mCMcYcJwZQIqutxe7HR0kGw5fM5seBfJHHJMVLNnr8zeRJFForWw32KhBygIiEqK7bpe5ojoNpexX60ycycMAxPtQX7ZHQewdEb5tDZIpsfkqY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=rOwpaw3S356vl/qzhtCuso6JlhU5C6LKeGUsZhirfHVBeE2L3tnyKS5+8zARI4h34XsRGKu2alXXPDdgoxP39EFsee7Xm44/sYoEWIUfG5t7Xvx0n0YCpdbijXteDTaiUjeJFTtTSMNZ377JNKDaWJ7o58+9newo3Pmm35i8nLg=
Received: by 10.150.84.41 with SMTP id h41mr3669670ybb.218.1209747354730;
        Fri, 02 May 2008 09:55:54 -0700 (PDT)
Received: by 10.151.99.7 with HTTP; Fri, 2 May 2008 09:55:54 -0700 (PDT)
Message-ID: <126142c0805020955i198f92fn9238450c9789a1e6@mail.gmail.com>
Date: Fri, 2 May 2008 13:55:54 -0300
From: "Marcelo Ochoa" <marcelo.ochoa@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: hybrid query (lucene + db)
In-Reply-To: <541f12ca0805012358r2592fd47xd1c1e6f52d79dff7@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <101670.49504.qm@web26005.mail.ukl.yahoo.com>
	 <652776090805011150i29576d04v7f4c2aa0bbba4753@mail.gmail.com>
	 <541f12ca0805012358r2592fd47xd1c1e6f52d79dff7@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi St=E9phane:
  If you are using Oracle Spatial I assume that you are using Oracle
too for storing text :)
  Have you take a look at Oracle-Lucene integration project sponsored
by LendingClub.com?
http://docs.google.com/Doc?id=3Dddgw7sjp_54fgj9kg
http://sourceforge.net/project/showfiles.php?group_id=3D56183&package_id=3D=
255524&release_id=3D589900
  Its a new domain index for Oracle using Lucene inside the Oracle JVM.
  By doing that We can use Lucene as Oracle Text, but with many other
features, and using inline pagination We can get better perfomance
than latest 11g Text Counpound Domain Index.
  If you are interested in this implementation simply drop me an email.
  Best regards, Marcelo.

On Fri, May 2, 2008 at 3:58 AM, Stephane Nicoll
<stephane.nicoll@gmail.com> wrote:
> Well for the moment we don't. The lucene index only contains the full
>  text content (indexed, not stored). We use lucene to perform full text
>  and fuzzy searches on the keywords field. Once we have the result, we
>  match them with the geospatial box provided by the user (we use Oracle
>  Spatial for that). We have no notion of city, state or zip code. Date
>  overlaps more than one countries most of the time actually.
>
>  We are thinking of reimplementing a quad tree in lucene to flag each
>  item with a spatial area. That way we will be able to pre-filter the
>  zone accordingly.
>
>  Still, this does not explain the deadlock on SegmentReader. If anyone
>  has an idea...
>
>  Thanks,
>  St=E9phane
>
>
>
>  On Thu, May 1, 2008 at 8:50 PM, Michael Stoppelman <stopman@gmail.com> w=
rote:
>  > Stephane,
>  >
>  >  Could you describe how you setup the spatial area? Having BooleanQuer=
y with
>  >  200 terms in it definitely slows things down (I'm not sure exactly wh=
y yet
>  >  -- it seems like it shouldn't be "that" slow). If you can describe yo=
ur
>  >  spatial area in fewer terms you can get much better performance. It j=
ust
>  >  depends on how you're describing your spatial areas and the number of
>  >  results in each zipcode. If you had a field like "city,state" in your=
 index
>  >  you would have far less terms in your query than if that query had al=
l the
>  >  zipcodes in a "city,state" combo, thus making your query much faster.
>  >
>  >  M
>  >
>  >  On Thu, May 1, 2008 at 2:15 AM, mark harwood <markharw00d@yahoo.co.uk=
>
>  >  wrote:
>  >
>  >
>  >
>  >  > The issue here is a general one of trying to perform an efficient j=
oin
>  >  > between an external resource (rdbms) and Lucene.
>  >  > This experiment may be of interest:
>  >  >    http://issues.apache.org/jira/browse/LUCENE-434
>  >  >
>  >  > KeyMap.java embodies the core service which translates from lucene =
doc ids
>  >  > to DB primary keys or vice versa.
>  >  > There are a couple of implementations of KeyMap that are not optima=
l (they
>  >  > pre-date Lucene's FieldCache) but it may give you food for thought.
>  >  >
>  >  > Cheers
>  >  > Mark
>  >  >
>  >  >
>  >  > ----- Original Message ----
>  >  > From: Stephane Nicoll <stephane.nicoll@gmail.com>
>  >  > To: java-user@lucene.apache.org
>  >  > Sent: Thursday, 1 May, 2008 9:00:33 AM
>  >  > Subject: hybrid query (lucene + db)
>  >  >
>  >  > Hi there,
>  >  >
>  >  > We're using lucene with Hibernate search and we're very happy so fa=
r
>  >  > with the performance and the usability of lucene. We have however a
>  >  > specific use cases that prevent us to use only lucene: spatial
>  >  > queries. I already sent a mail on this list a while back about the
>  >  > problem and we started investigating multiple solutions.
>  >  >
>  >  > When the user selects a geographic area and some keywords we do the
>  >  > following:
>  >  >
>  >  > * Perform a search on the lucene index for the keywords with a
>  >  > projection that returns only the primaryKey of the element sorted b=
y
>  >  > primary key
>  >  > * Perform a search on the database with other criterias and a
>  >  > projection that returns only the primary key of the elements
>  >  > * Iterate on both list to find N matching IDs, optionally with pagi=
ng
>  >  > (some from X to X + N where X is the first result of the page)
>  >  > * Run a query on the database to return the actual objects (select =
a
>  >  > from MyClass a where a.id IN (the list of matching IDs) ) We limit =
the
>  >  > page to 1000 results
>  >  >
>  >  > We have searched a way to optimize the queries and to avoid to cons=
ume
>  >  > too much memory, knowing that we must support paging.
>  >  >
>  >  > With a single user a search by kewyords takes 30msec to complete, a
>  >  > search by box takes 45msec. With both (keywords + spatial area)  it
>  >  > takes 300msec
>  >  >
>  >  > With 10 concurrent users, a search by keywords takes 150msec/user  =
but
>  >  > for both it takes 3 sec/user !!!
>  >  >
>  >  > I had the profiler running on this scenario and I've found that *al=
l*
>  >  > threads are waiting on org.apache.lucene.index.SegmentReader. I the=
n
>  >  > configured Hibernate Search to use a separate index reader per thre=
ad.
>  >  > The deadlocks disappeared but it's still very slow (2.8sec).
>  >  >
>  >  > Some questions:
>  >  >
>  >  > * Does anyone knows where the deadlocks on SegmentReader are coming=
 from?
>  >  > * Is the sorting on the primary keys a bad idea regarding performan=
ce
>  >  > and memory usage?
>  >  > * Does anyone has an idea to perform this kind of hybrid query in a=
n
>  >  > efficient way?
>  >  >
>  >  > I am using lucene 2.3.1 and Hibernate Search 3.0.1. I already ask f=
or
>  >  > support on the Hibernate Search forum but did not get any answer so
>  >  > far.
>  >  >
>  >  > Thanks,
>  >  > St=E9phane
>  >  >
>  >  > --
>  >  > Large Systems Suck: This rule is 100% transitive. If you build one,
>  >  > you suck" -- S.Yegge
>  >  >
>  >  > -------------------------------------------------------------------=
--
>  >  > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  >  > For additional commands, e-mail: java-user-help@lucene.apache.org
>  >  >
>  >  >
>  >  >
>  >  >
>  >  >
>  >  >
>  >  >       __________________________________________________________
>  >  > Sent from Yahoo! Mail.
>  >  > A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html
>  >  >
>  >  > -------------------------------------------------------------------=
--
>  >  > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  >  > For additional commands, e-mail: java-user-help@lucene.apache.org
>  >  >
>  >  >
>  >
>
>
>
>  --
>
>
> Large Systems Suck: This rule is 100% transitive. If you build one,
>  you suck" -- S.Yegge
>
>  ---------------------------------------------------------------------
>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Marcelo F. Ochoa
http://marceloochoa.blogspot.com/
http://marcelo.ochoa.googlepages.com/home
______________
Do you Know DBPrism? Look @ DB Prism's Web Site
http://www.dbprism.com.ar/index.html
More info?
Chapter 17 of the book "Programming the Oracle Database using Java &
Web Services"
http://www.amazon.com/gp/product/1555583296/
Chapter 21 of the book "Professional XML Databases" - Wrox Press
http://www.amazon.com/gp/product/1861003587/
Chapter 8 of the book "Oracle & Open Source" - O'Reilly
http://www.oreilly.com/catalog/oracleopen/

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33884-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 16:59:41 2008
Return-Path: <java-user-return-33884-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4790 invoked from network); 2 May 2008 16:59:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 16:59:41 -0000
Received: (qmail 36611 invoked by uid 500); 2 May 2008 16:59:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36571 invoked by uid 500); 2 May 2008 16:59:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36560 invoked by uid 99); 2 May 2008 16:59:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 09:59:35 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,URIBL_GREY
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephane.nicoll@gmail.com designates 209.85.132.249 as permitted sender)
Received: from [209.85.132.249] (HELO an-out-0708.google.com) (209.85.132.249)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 16:58:49 +0000
Received: by an-out-0708.google.com with SMTP id c37so358744anc.49
        for <java-user@lucene.apache.org>; Fri, 02 May 2008 09:59:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=nXOnWfvJI0ZWLlOeXK2P1BXGkib/p5zte3+Txq+kgfk=;
        b=xrH3S5TGGh9RPQsYXn6LCrYkZUQAOYvRSxf4++vVWcG/6oICb4yyVJqakQBD2ntRj/O0ltIXxr7O1h/ajl/ogEUmvf/sUnTyEpcHncSJAZDDPG1k/sxfggfUdHdYr63uWxTqZHSsFSXwSuPU/GXyUnDfQzVG6vOflcGaIGDP+zM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=jPf1CH3ZhBpcro3cjlsLPAofwfghAe77rVSGRDxsq1l/pLqCcVjiGhCBNa5d0r3E75YFiEckmW5e2j7zVAvZElt+whsNR1IqA3W5D5gGYfJvwsbf4IEmpNQ31MiiVWnyFV6oz/5kzNbwYwMOaHfw53+AkJUCvw7pP4ZjECfcHy0=
Received: by 10.100.45.5 with SMTP id s5mr4974286ans.13.1209747542860;
        Fri, 02 May 2008 09:59:02 -0700 (PDT)
Received: by 10.100.178.12 with HTTP; Fri, 2 May 2008 09:59:02 -0700 (PDT)
Message-ID: <541f12ca0805020959o3afa8d95r97d7dd5fbe59bbf4@mail.gmail.com>
Date: Fri, 2 May 2008 18:59:02 +0200
From: "Stephane Nicoll" <stephane.nicoll@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: hybrid query (lucene + db)
In-Reply-To: <126142c0805020955i198f92fn9238450c9789a1e6@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <101670.49504.qm@web26005.mail.ukl.yahoo.com>
	 <652776090805011150i29576d04v7f4c2aa0bbba4753@mail.gmail.com>
	 <541f12ca0805012358r2592fd47xd1c1e6f52d79dff7@mail.gmail.com>
	 <126142c0805020955i198f92fn9238450c9789a1e6@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Thanks for the response. The very first reason  we're using lucene is
because we're building a product that must support different database
(Oracle 10, Oracle 11 and Postgresql with spatial extensions).

I had a look to this project already but we cannot stick to one database ve=
ndor.

Cheers,
St=E9phane

On Fri, May 2, 2008 at 6:55 PM, Marcelo Ochoa <marcelo.ochoa@gmail.com> wro=
te:
> Hi St=E9phane:
>   If you are using Oracle Spatial I assume that you are using Oracle
>  too for storing text :)
>   Have you take a look at Oracle-Lucene integration project sponsored
>  by LendingClub.com?
>  http://docs.google.com/Doc?id=3Dddgw7sjp_54fgj9kg
>  http://sourceforge.net/project/showfiles.php?group_id=3D56183&package_id=
=3D255524&release_id=3D589900
>   Its a new domain index for Oracle using Lucene inside the Oracle JVM.
>   By doing that We can use Lucene as Oracle Text, but with many other
>  features, and using inline pagination We can get better perfomance
>  than latest 11g Text Counpound Domain Index.
>   If you are interested in this implementation simply drop me an email.
>   Best regards, Marcelo.
>
>
>
>  On Fri, May 2, 2008 at 3:58 AM, Stephane Nicoll
>  <stephane.nicoll@gmail.com> wrote:
>  > Well for the moment we don't. The lucene index only contains the full
>  >  text content (indexed, not stored). We use lucene to perform full tex=
t
>  >  and fuzzy searches on the keywords field. Once we have the result, we
>  >  match them with the geospatial box provided by the user (we use Oracl=
e
>  >  Spatial for that). We have no notion of city, state or zip code. Date
>  >  overlaps more than one countries most of the time actually.
>  >
>  >  We are thinking of reimplementing a quad tree in lucene to flag each
>  >  item with a spatial area. That way we will be able to pre-filter the
>  >  zone accordingly.
>  >
>  >  Still, this does not explain the deadlock on SegmentReader. If anyone
>  >  has an idea...
>  >
>  >  Thanks,
>  >  St=E9phane
>  >
>  >
>  >
>  >  On Thu, May 1, 2008 at 8:50 PM, Michael Stoppelman <stopman@gmail.com=
> wrote:
>  >  > Stephane,
>  >  >
>  >  >  Could you describe how you setup the spatial area? Having BooleanQ=
uery with
>  >  >  200 terms in it definitely slows things down (I'm not sure exactly=
 why yet
>  >  >  -- it seems like it shouldn't be "that" slow). If you can describe=
 your
>  >  >  spatial area in fewer terms you can get much better performance. I=
t just
>  >  >  depends on how you're describing your spatial areas and the number=
 of
>  >  >  results in each zipcode. If you had a field like "city,state" in y=
our index
>  >  >  you would have far less terms in your query than if that query had=
 all the
>  >  >  zipcodes in a "city,state" combo, thus making your query much fast=
er.
>  >  >
>  >  >  M
>  >  >
>  >  >  On Thu, May 1, 2008 at 2:15 AM, mark harwood <markharw00d@yahoo.co=
.uk>
>  >  >  wrote:
>  >  >
>  >  >
>  >  >
>  >  >  > The issue here is a general one of trying to perform an efficien=
t join
>  >  >  > between an external resource (rdbms) and Lucene.
>  >  >  > This experiment may be of interest:
>  >  >  >    http://issues.apache.org/jira/browse/LUCENE-434
>  >  >  >
>  >  >  > KeyMap.java embodies the core service which translates from luce=
ne doc ids
>  >  >  > to DB primary keys or vice versa.
>  >  >  > There are a couple of implementations of KeyMap that are not opt=
imal (they
>  >  >  > pre-date Lucene's FieldCache) but it may give you food for thoug=
ht.
>  >  >  >
>  >  >  > Cheers
>  >  >  > Mark
>  >  >  >
>  >  >  >
>  >  >  > ----- Original Message ----
>  >  >  > From: Stephane Nicoll <stephane.nicoll@gmail.com>
>  >  >  > To: java-user@lucene.apache.org
>  >  >  > Sent: Thursday, 1 May, 2008 9:00:33 AM
>  >  >  > Subject: hybrid query (lucene + db)
>  >  >  >
>  >  >  > Hi there,
>  >  >  >
>  >  >  > We're using lucene with Hibernate search and we're very happy so=
 far
>  >  >  > with the performance and the usability of lucene. We have howeve=
r a
>  >  >  > specific use cases that prevent us to use only lucene: spatial
>  >  >  > queries. I already sent a mail on this list a while back about t=
he
>  >  >  > problem and we started investigating multiple solutions.
>  >  >  >
>  >  >  > When the user selects a geographic area and some keywords we do =
the
>  >  >  > following:
>  >  >  >
>  >  >  > * Perform a search on the lucene index for the keywords with a
>  >  >  > projection that returns only the primaryKey of the element sorte=
d by
>  >  >  > primary key
>  >  >  > * Perform a search on the database with other criterias and a
>  >  >  > projection that returns only the primary key of the elements
>  >  >  > * Iterate on both list to find N matching IDs, optionally with p=
aging
>  >  >  > (some from X to X + N where X is the first result of the page)
>  >  >  > * Run a query on the database to return the actual objects (sele=
ct a
>  >  >  > from MyClass a where a.id IN (the list of matching IDs) ) We lim=
it the
>  >  >  > page to 1000 results
>  >  >  >
>  >  >  > We have searched a way to optimize the queries and to avoid to c=
onsume
>  >  >  > too much memory, knowing that we must support paging.
>  >  >  >
>  >  >  > With a single user a search by kewyords takes 30msec to complete=
, a
>  >  >  > search by box takes 45msec. With both (keywords + spatial area) =
 it
>  >  >  > takes 300msec
>  >  >  >
>  >  >  > With 10 concurrent users, a search by keywords takes 150msec/use=
r  but
>  >  >  > for both it takes 3 sec/user !!!
>  >  >  >
>  >  >  > I had the profiler running on this scenario and I've found that =
*all*
>  >  >  > threads are waiting on org.apache.lucene.index.SegmentReader. I =
then
>  >  >  > configured Hibernate Search to use a separate index reader per t=
hread.
>  >  >  > The deadlocks disappeared but it's still very slow (2.8sec).
>  >  >  >
>  >  >  > Some questions:
>  >  >  >
>  >  >  > * Does anyone knows where the deadlocks on SegmentReader are com=
ing from?
>  >  >  > * Is the sorting on the primary keys a bad idea regarding perfor=
mance
>  >  >  > and memory usage?
>  >  >  > * Does anyone has an idea to perform this kind of hybrid query i=
n an
>  >  >  > efficient way?
>  >  >  >
>  >  >  > I am using lucene 2.3.1 and Hibernate Search 3.0.1. I already as=
k for
>  >  >  > support on the Hibernate Search forum but did not get any answer=
 so
>  >  >  > far.
>  >  >  >
>  >  >  > Thanks,
>  >  >  > St=E9phane
>  >  >  >
>  >  >  > --
>  >  >  > Large Systems Suck: This rule is 100% transitive. If you build o=
ne,
>  >  >  > you suck" -- S.Yegge
>  >  >  >
>  >  >  > ----------------------------------------------------------------=
-----
>  >  >  > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  >  >  > For additional commands, e-mail: java-user-help@lucene.apache.or=
g
>  >  >  >
>  >  >  >
>  >  >  >
>  >  >  >
>  >  >  >
>  >  >  >
>  >  >  >       __________________________________________________________
>  >  >  > Sent from Yahoo! Mail.
>  >  >  > A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html
>  >  >  >
>  >  >  > ----------------------------------------------------------------=
-----
>  >  >  > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  >  >  > For additional commands, e-mail: java-user-help@lucene.apache.or=
g
>  >  >  >
>  >  >  >
>  >  >
>  >
>  >
>  >
>  >  --
>  >
>  >
>  > Large Systems Suck: This rule is 100% transitive. If you build one,
>  >  you suck" -- S.Yegge
>  >
>  >  ---------------------------------------------------------------------
>  >  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  >  For additional commands, e-mail: java-user-help@lucene.apache.org
>  >
>  >
>
>
>
>  --
>  Marcelo F. Ochoa
>  http://marceloochoa.blogspot.com/
>  http://marcelo.ochoa.googlepages.com/home
>  ______________
>  Do you Know DBPrism? Look @ DB Prism's Web Site
>  http://www.dbprism.com.ar/index.html
>  More info?
>  Chapter 17 of the book "Programming the Oracle Database using Java &
>  Web Services"
>  http://www.amazon.com/gp/product/1555583296/
>  Chapter 21 of the book "Professional XML Databases" - Wrox Press
>  http://www.amazon.com/gp/product/1861003587/
>  Chapter 8 of the book "Oracle & Open Source" - O'Reilly
>  http://www.oreilly.com/catalog/oracleopen/
>
>
>
>  ---------------------------------------------------------------------
>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Large Systems Suck: This rule is 100% transitive. If you build one,
you suck" -- S.Yegge

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33885-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 17:25:51 2008
Return-Path: <java-user-return-33885-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15213 invoked from network); 2 May 2008 17:25:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 17:25:51 -0000
Received: (qmail 88808 invoked by uid 500); 2 May 2008 17:25:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88781 invoked by uid 500); 2 May 2008 17:25:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88770 invoked by uid 99); 2 May 2008 17:25:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 10:25:44 -0700
X-ASF-Spam-Status: No, hits=-3.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.108.46] (HELO SUEXCL-02.ad.syr.edu) (128.230.108.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 17:24:57 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
Subject: RE: lucene farsi problem
Date: Fri, 2 May 2008 13:23:36 -0400
Message-ID: <9294E20AED46934EA459020706463F94A04AE6@SUEXCL-02.ad.syr.edu>
In-Reply-To: <17023557.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: lucene farsi problem
Thread-Index: AcisdXDM28b2vPmzTRWLNLCFWVG0DQAAzwUA
From: "Steven A Rowe" <sarowe@syr.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgRXNyYSwNCg0KSSBoYXZlIGNyZWF0ZWQgYW4gaXNzdWUgZm9yIHRoaXMgLSBzZWUgPGh0dHBz
Oi8vaXNzdWVzLmFwYWNoZS5vcmcvamlyYS9icm93c2UvTFVDRU5FLTEyNzk+Lg0KDQpJJ2xsIHRy
eSB0byB0YWtlIGEgY3JhY2sgYXQgYSBwYXRjaCB0aGlzIHdlZWtlbmQuDQoNClN0ZXZlDQoNCk9u
IDA1LzAyLzIwMDggYXQgMTI6NTUgUE0sIGVzcmEgd3JvdGU6DQo+IA0KPiBIaSBTdGV2ZW4gLA0K
PiANCj4geWVzIHlvdSBhcmUgcmlnaHQsIHNvcnJ5IGkgYW0gYSBiaXQgY29uZnVzZWQuDQo+IA0K
PiBpIGNoZWNrZWQgYWdhaW4gYW5kIHRoZSBjb3JyZWN0IG9uZSBpcyAgInpoZSIvVSs2OTguDQo+
IA0KPiBJdCBzZWVtcyB0aGUgd29yZCBpcyBpbiB0aGUgcmFuZ2UgYnV0IG15IGN1c3RvbWVyIHNh
eXMgaXQNCj4gc2hvdWxkbid0IGJlLg0KPiANCj4gSSB0aGluayBwcm9ibGVtIG9jY3VycyBiZWNh
dXNlICAiemhlIiBpcyBhIFBlcnNpYW4gbGV0dGVyDQo+IG91dHNpZGUgdGhlIEFyYWJpYw0KPiBh
bHBoYWJldC4gSW4gZmFyc2kgYWxwaGFiZXQgdGhpcyBsZXR0ZXIgaXMgbm90IGFmdGVyIHRoZSAi
2LMiDQo+IGxldHRlciBidXQgaXQncw0KPiB1bmljb2RlIGlzIGJpZ2dlciB0aGFuICLYsyIgbGV0
dGVyJ3MgYW5kIHRoZSBzZWFyY2hlciB3b3Jrcw0KPiB3aXRoIHVuaWNvZGVzLg0KPiANCj4gRXNy
YQ0KPiANCj4gDQo+IFN0ZXZlbiBBIFJvd2Ugd3JvdGU6DQo+ID4gDQo+ID4gSGkgRXNyYSwNCj4g
PiANCj4gPiBZb3UgYXJlICpzdGlsbCogaW5jb3JyZWN0bHkgcmVmZXJyaW5nIHRvIHRoZSBnbHlw
aCB3aXRoIHRocmVlIGRvdHMgb3Zlcg0KPiA+IGl0Og0KPiA+IA0KPiA+IE9uIDA1LzAyLzIwMDgg
YXQgMTI6MTggUE0sIGVzcmEgd3JvdGU6DQo+ID4gPiB5ZXMgdGhlIGNvcnJlY3Qgb25lIGlzICLa
mCAiLyJ6ZSIvVSs2MzIuDQo+ID4gDQo+ID4gItqYIiBpcyAqbm90KiAiemUiL1UrNjMyIC0gaXQg
aXMgInpoZSIvVSs2OTguDQo+ID4gDQo+ID4gSGF2ZSB5b3UgaW5jcmVhc2VkIHRoZSBmb250IHNp
emU/ICBDYW4geW91IHNlZSB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuDQo+ID4gdGhlc2UgdHdvPzoN
Cj4gPiANCj4gPiAi2pgiLyJ6aGUiL1UrNjk4DQo+ID4gItiyIi8iemUiL1UrNjMyDQo+ID4gDQo+
ID4gPiBteSBwcm9ibGVtIGlzIHdoZW4gaSBkbyBzZWFyY2ggZm9yICAi2K8t2pgiIHJhbmdlLiBU
aGUgcmVzdWx0IGlzICAi2LPYp9ioDQo+ID4gPiDZiNmI2YHYsSIgYW5kIHRoaXMgd29yZCdzIGZp
cnN0IGxldHRlciBpcyAi2LMiIGFuZCBpdCdzIHVuaWNvZGUgaXMgIlUrNjMzIiANCj4gPiA+IGFu
ZCBpdCBpcyBub3QgaW4gdGhlIGluIHRoZSBbIFUrMDYyRiAtIFUrMDYzMiBdIHJhbmdlLg0KPiA+
IA0KPiA+IExpa2UgSSBrZWVwIHNheWluZywgaW4gdGhlIGFib3ZlIGRlc2NyaXB0aW9uLCB5b3Un
cmUgdXNpbmcgdGhlIGdseXBoDQo+ID4gItqYIi8iemhlIi9VKzY5OCwgd2hpbGUgY2FsbGluZyBh
dCB0aGUgc2FtZSB0aW1lIGluY29ycmVjdGx5IHJlZmVycmluZw0KPiA+IHRvIGl0IGFzICJ6ZSIv
VSs2MzIuDQo+ID4gDQo+ID4gSSBkb24ndCBtZWFuIHRvIGNvbnRpbnVhbGx5IGJhbmcgb24gYWJv
dXQgdGhpcyAtIGlmIHlvdSdyZSAqc3VyZSogdGhhdA0KPiA+IHdoZW4geW91IHNlYXJjaCwgeW91
J3JlIHVzaW5nIHRoZSBjaGFyYWN0ZXIgcmVwcmVzZW50ZWQgYnkgdGhlIGdseXBoDQo+ID4gd2l0
aCBvbmUgZG90IChhbmQgbm90IHRocmVlKSwgaS5lLiAi2LIiLyJ6ZSIvVSs2MzIsIHRoZW4gdGhl
IHByb2JsZW0NCj4gPiBsaWVzIGVsc2V3aGVyZS4NCj4gPiANCj4gPiBTdGV2ZQ0KPiA+IA0KPiA+
IE9uIDA1LzAyLzIwMDggYXQgMTI6MTggUE0sIGVzcmEgd3JvdGU6DQo+ID4gPiB5ZXMgdGhlIGNv
cnJlY3Qgb25lIGlzICLamCAiLyJ6ZSIvVSs2MzIuDQo+ID4gPiANCj4gPiA+IG15IHByb2JsZW0g
aXMgd2hlbiBpIGRvIHNlYXJjaCBmb3IgICIgINivLdqYIiByYW5nZS4gVGhlIHJlc3VsdA0KPiA+
ID4gaXMgICIi2LPYp9ioINmI2YjZgdixDQo+ID4gPiAiIGFuZCB0aGlzIHdvcmQncyBmaXJzdCBs
ZXR0ZXIgaXMgItizICIgYW5kIGl0J3MgdW5pY29kZSBpcw0KPiA+ID4gIlUrNjMzIiAgYW5kICBp
dA0KPiA+ID4gaXMgbm90IGluIHRoZSBpbiB0aGUgWyBVKzA2MkYgLSBVKzA2MzIgXSByYW5nZS4N
Cj4gPiA+IA0KPiA+ID4gYW0gaSB3cm9uZz8NCj4gPiA+IA0KPiA+ID4gRXNyYQ0KPiA+ID4gDQo+
ID4gPiBTdGV2ZW4gQSBSb3dlIHdyb3RlOg0KPiA+ID4gPiANCj4gPiA+ID4gSGkgRXNyYSwNCj4g
PiA+ID4gDQo+ID4gPiA+IEkgc3RpbGwgdGhpbmsgeW91J3JlIHdyb25nIDopLg0KPiA+ID4gPiAN
Cj4gPiA+ID4gT24gMDUvMDIvMjAwOCBhdCA5OjMxIEFNLCBlc3JhIHdyb3RlOg0KPiA+ID4gPiA+
ID4g2pggPSBVKzYzMg0KPiA+ID4gPiANCj4gPiA+ID4gQWNjb3JkaW5nIHRvIHRoZSB3ZWJzaXRl
IHlvdSBsaW5rZWQgdG8sIHRoZSBhYm92ZSBjaGFyYWN0ZXIsIHdoaWNoDQo+ID4gPiA+IGhhcyB0
aHJlZSBkb3RzIG92ZXIgaXQsIGlzIG5hbWVkICJ6aGUiLCBhbmQgaXRzIFVuaWNvZGUgY29kZSBw
b2ludCBpcw0KPiA+ID4gPiBVKzY5OC4gKEkgaGFkIHRvIGluY3JlYXNlIHRoZSBmb250IHNpemUg
dG8gc2VlIHRoZSB0aHJlZSBkb3RzLikNCj4gPiA+ID4gDQo+ID4gPiA+IEkgdGhpbmsgeW91IGFy
ZSBjb25mdXNpbmcgItqYIi8iemhlIi9VKzY5OCB3aXRoIHRoZSBsZXR0ZXINCj4gPiA+ID4gItiy
Ii8iemUiL1UrNjMyLCB3aGljaCBoYXMganVzdCBvbmUgZG90IG92ZXIgaXQuDQo+ID4gPiA+IA0K
PiA+ID4gPiBVbmxlc3MgeW91IHdlcmUgbWlzdGFrZW4gaW4gYWxsIG9mIHlvdXIgZW1haWxzIHdo
ZW4geW91IGluY2x1ZGVkIHRoZQ0KPiA+ID4gPiBjaGFyYWN0ZXIgItqYIi8iemhlIiBpbnN0ZWFk
IG9mICLYsiIvInplIiwgdGhlbiB3aGF0IEkgc2FpZCBpbiBteQ0KPiA+ID4gPiBwcmV2aW91cyBl
bWFpbCBzdGlsbCBzdGFuZHM6IHRoZXJlIGlzIG5vIHByb2JsZW0gaGVyZS4NCj4gPiA+ID4gDQo+
ID4gPiA+IFN0ZXZlDQo+ID4gPiA+IA0KPiA+ID4gPiBPbiAwNS8wMi8yMDA4IGF0IDk6MzEgQU0s
IGVzcmEgd3JvdGU6DQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gSGkgU3RldmVuLA0KPiA+ID4gPiA+
IA0KPiA+ID4gPiA+IHNvcnJ5IGkgbWFkZSBhIG1pc3Rha2UuIHVuaWNvZGVzIGFyZSBsaWtlIHRo
aXM6DQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiDYrz1VKzYyRg0KPiA+ID4gPiA+ID4g2pggPSBV
KzYzMg0KPiA+ID4gPiA+ID4gYW5kIHRoZSBmaXJzdCBsZXR0ZXIgb2YgItiz2KfYqCDZiNmI2YHY
sSAiIGlzICDYsyA9IFUrNjMzDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4geW91IGNhbiBhbHNvIGNo
ZWNrIHRoZW0gaGVyZQ0KPiA+ID4gPiA+ID4gDQo+IGh0dHA6Ly93d3cudW5pY3MudW5pLWhhbm5v
dmVyLmRlL25odGNhcHJpL3BlcnNpYW4tYWxwaGFiZXQuaHRtbA0KPiA+ID4gPiA+IA0KPiA+ID4g
PiA+IEVzcmENCj4gPiA+ID4gPiANCj4gPiA+ID4gPiANCj4gPiA+ID4gPiBTdGV2ZW4gQSBSb3dl
IHdyb3RlOg0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiBIaSBFc3JhLA0KPiA+ID4gPiA+ID4g
DQo+ID4gPiA+ID4gPiBHb2luZyBiYWNrIHRvIHRoZSBvcmlnaW5hbCBwcm9ibGVtIHN0YXRlbWVu
dCwgSSBzZWUgc29tZXRoaW5nIHRoYXQNCj4gPiA+ID4gPiA+IGxvb2tzIGlsbG9naWNhbCB0byBt
ZSAtIHBsZWFzZSBjb3JyZWN0IG1lIGlmIEknbSB3cm9uZzoNCj4gPiA+ID4gPiA+IA0KPiA+ID4g
PiA+ID4gT24gQXByIDMwLCAyMDA4LCBhdCAzOjIxIEFNLCBlc3JhIHdyb3RlOg0KPiA+ID4gPiA+
ID4gPiBpIGFtIHVzaW5nIGx1Y2VuZSdzICJJbmRleFNlYXJjaGVyIiB0byBzZWFyY2ggdGhlIGdp
dmVuIHhtbCBieQ0KPiA+ID4gPiA+ID4gPiBrZXl3b3JkIHdoaWNoIGNvbnRhaW5zIGZhcnNpIGlu
Zm9ybWF0aW9uLiB3aGlsZSBzZWFyY2hpbmcgaSB1c2UNCj4gPiA+ID4gPiA+ID4gcmFuZ2VzIGxp
a2UNCj4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+INiiLdirICB8ICDYrC3YriAgfCAg2K8t
2pggIHwgINizLdi4ICB8ICDYuS3ZgiAgfCAg2qkt2YQgIHwgINmFLduMDQo+ID4gPiA+ID4gPiA+
IA0KPiA+ID4gPiA+ID4gPiB3aGVuIGkgZG8gc2VhcmNoIGZvciAgItivLdqYIiAgcmFuZ2UgdGhl
IHJlc3VsdHMgYXJlIHdyb25nICwgdGhleQ0KPiA+ID4gPiA+ID4gPiBhcmUgdGhlIHJlc3VsdHMg
b2YgICIg2LMt2LggInJhbmdlLg0KPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gZm9yIGV4
YW1wbGUgd2hlbiBpIGRvIHNlYXJjaCBmb3IgItivLdqYIiAgb25lIG9mIHRoZSB0aGUgcmVzdWx0
cyBpcw0KPiA+ID4gPiA+ID4gPiAi2LPYp9ioINmI2YjZgdixIiwgdGhpcyByZXN1bHQgYWxzbyBz
aG93biBvbiB0aGUgIiDYsy3YuCAiIHJhbmdlJ3MgcmVzdWx0DQo+ID4gPiA+ID4gPiA+IGxpc3Qg
d2hpY2ggaXMgdGhlIGNvcnJldCByYW5nZS4NCj4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+
IEFzIEluZGV4U2VhcmNoZXIgdXNlICJjb21wYXJlVG8iIG1ldGhvZCBhbmQgdGhpcyBtZXRob2Qg
dXNlcw0KPiA+ID4gPiA+ID4gPiB1bmljb2RlcyBmb3IgY29tcGFyaW5nLCBpIGZvdW5kIHRoZSB1
bmljb2RlcyBvZiB0aGUgY2hhcmFjdGVycy4NCj4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+
INivPVUrNjJGDQo+ID4gPiA+ID4gPiA+INqYID0gVSs2OTgNCj4gPiA+ID4gPiA+ID4gYW5kIHRo
ZSBmaXJzdCBsZXR0ZXIgb2YgItiz2KfYqCDZiNmI2YHYsSAiIGlzICDYsyA9IFUrNjMzDQo+ID4g
PiA+ID4gPiANCj4gPiA+ID4gPiA+IEl0IGFwcGVhcnMgdG8gbWUgdGhhdCAqYm90aCogdGhlICLY
ry3amCIgcmFuZ2UgWw0KPiBVKzA2MkYgLSBVKzA2OTggXQ0KPiA+ID4gYW5kDQo+ID4gPiA+ID4g
PiB0aGUgItizLdi4IiByYW5nZSBbIFUrMDYzMyAtIFUrMDYzOCBdIGNvbnRhaW4gdGhlDQo+IGZp
cnN0IGxldHRlciBvZg0KPiA+ID4gItiz2KfYqA0KPiA+ID4gPiA+ID4g2YjZiNmB2LEiLCB3aGlj
aCBpcyAi2LMiID0gVSswNjMzLg0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiBZb3Ugc3RhdGVk
IHRoYXQgVSswNjMzIHNob3VsZCBiZSBjb250YWluZWQgaW4gdGhlIFsNCj4gVSswNjMzIC0gVSsw
NjM4DQo+ID4gPiBdDQo+ID4gPiA+ID4gPiByYW5nZSAtIEkgYWdyZWUgLSBidXQgd2h5IGRvIHlv
dSB0aGluayBVKzA2MzMgc2hvdWxkIG5vdCBiZQ0KPiA+ID4gPiA+ID4gY29udGFpbmVkIGluIHRo
ZSBbIFUrMDYyRiAtIFUrMDY5OCBdIHJhbmdlPw0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiBJ
biBvdGhlciB3b3JkcywgaXQgbG9va3MgdG8gbWUgbGlrZSB5b3VyIHByb2JsZW0gaXMNCj4gbm90
IGEgcHJvYmxlbQ0KPiA+ID4gYXQNCj4gPiA+ID4gPiA+IGFsbC4NCj4gPiA+ID4gPiA+IA0KPiA+
ID4gPiA+ID4gU3RldmUNCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+
ID4gPiA+ID4gLS0gVmlldyB0aGlzIG1lc3NhZ2UgaW4gY29udGV4dDoNCj4gPiA+ID4gPiANCj4g
PiA+IGh0dHA6Ly93d3cubmFiYmxlLmNvbS9sdWNlbmUtZmFyc2ktcHJvYmxlbS10cDE2OTc3MDk2
cDE3MDE5NDk4DQo+ID4gPiAuaHRtbCBTZW50DQo+ID4gPiA+IGZyb20gdGhlIEx1Y2VuZSAtIEph
dmEgVXNlcnMgbWFpbGluZyBsaXN0IGFyY2hpdmUgYXQgTmFiYmxlLmNvbS4NCj4gPiA+ID4gDQo+
ID4gPiA+IA0KPiA+ID4gPiANCj4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQo+ID4gPiBUbw0KPiA+ID4gPiB1bnN1
YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVAbHVjZW5lLmFwYWNoZS5vcmcg
Rm9yDQo+ID4gPiA+IGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDogamF2YS11c2VyLWhlbHBA
bHVjZW5lLmFwYWNoZS5vcmcNCj4gPiA+ID4gDQo+ID4gPiA+IA0KPiA+ID4gDQo+ID4gPiANCj4g
PiA+IA0KPiA+ID4gDQo+ID4gPiANCj4gPiA+IA0KPiA+ICAtLSBWaWV3IHRoaXMgbWVzc2FnZSBp
biBjb250ZXh0Og0KPiA+ICBodHRwOi8vd3d3Lm5hYmJsZS5jb20vbHVjZW5lLWZhcnNpLXByb2Js
ZW0tdHAxNjk3NzA5NnAxNzAyMjg2MS5odG1sDQo+ID4gIFNlbnQgZnJvbSB0aGUgTHVjZW5lIC0g
SmF2YSBVc2VycyBtYWlsaW5nIGxpc3QgYXJjaGl2ZSBhdA0KPiBOYWJibGUuY29tLg0KPiA+IA0K
PiA+IA0KPiA+IA0KPiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4gPiAgVG8gdW5zdWJzY3JpYmUsIGUtbWFpbDog
amF2YS11c2VyLXVuc3Vic2NyaWJlQGx1Y2VuZS5hcGFjaGUub3JnDQo+ID4gIEZvciBhZGRpdGlv
bmFsIGNvbW1hbmRzLCBlLW1haWw6IGphdmEtdXNlci1oZWxwQGx1Y2VuZS5hcGFjaGUub3JnDQo+
ID4gDQo+ID4gDQo+ID4gDQo+ID4gDQo+ID4gDQo+IA0KPiAtLSBWaWV3IHRoaXMgbWVzc2FnZSBp
biBjb250ZXh0Og0KPiBodHRwOi8vd3d3Lm5hYmJsZS5jb20vbHVjZW5lLWZhcnNpLXByb2JsZW0t
dHAxNjk3NzA5NnAxNzAyMzU1Ny5odG1sIFNlbnQNCj4gZnJvbSB0aGUgTHVjZW5lIC0gSmF2YSBV
c2VycyBtYWlsaW5nIGxpc3QgYXJjaGl2ZSBhdCBOYWJibGUuY29tLg0KPiANCj4gDQo+IC0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLSBUbw0KPiB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVA
bHVjZW5lLmFwYWNoZS5vcmcgRm9yDQo+IGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDogamF2
YS11c2VyLWhlbHBAbHVjZW5lLmFwYWNoZS5vcmcNCj4gDQo+DQoNCiANCg0K


From java-user-return-33886-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 02 23:24:22 2008
Return-Path: <java-user-return-33886-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69905 invoked from network); 2 May 2008 23:24:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 May 2008 23:24:22 -0000
Received: (qmail 88095 invoked by uid 500); 2 May 2008 23:24:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88065 invoked by uid 500); 2 May 2008 23:24:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88051 invoked by uid 99); 2 May 2008 23:24:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 16:24:15 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 23:23:21 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Js4bO-0000GH-6V
	for java-user@lucene.apache.org; Fri, 02 May 2008 16:23:42 -0700
Message-ID: <17029563.post@talk.nabble.com>
Date: Fri, 2 May 2008 16:23:42 -0700 (PDT)
From: oyesiji <oyesiji@gmail.com>
To: java-user@lucene.apache.org
Subject: Hibernate search (Problem adding new Record)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: oyesiji@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


I am using Hibernate Search in my Application, the first time i attempt to
index records from the database it works and the second time i attempt to
add records i notice that it does not work

FullTextSession fullTextSession = Search.createFullTextSession(session);
	for (JobDescription jobDescription : jobDescriptions) {
			fullTextSession.index(jobDescription);
}

Any suggestion is welcome
-- 
View this message in context: http://www.nabble.com/Hibernate-search-%28Problem-adding-new-Record%29-tp17029563p17029563.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33887-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 03 01:10:56 2008
Return-Path: <java-user-return-33887-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19554 invoked from network); 3 May 2008 01:10:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 3 May 2008 01:10:56 -0000
Received: (qmail 62068 invoked by uid 500); 3 May 2008 01:10:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61894 invoked by uid 500); 3 May 2008 01:10:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61883 invoked by uid 99); 3 May 2008 01:10:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 18:10:50 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.61] (HELO web50307.mail.re2.yahoo.com) (206.190.38.61)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 03 May 2008 01:10:03 +0000
Received: (qmail 28355 invoked by uid 60001); 3 May 2008 01:10:16 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=Z2RHDd1p3rQUlOd2yn55Bs4qkCs4LjbUnxBqIAB6nIt4RtOiOKNkFWIQddCUEgUh751afKcIvainhJDBXcDd4uKUrCEZ1zC6eGyF7CN+p7UjwjsK75oZVfzodcNPI/HrDgY9OnxbG/r1S42Lg0/ryt+4j841mwCdUMg+6nWENls=;
X-YMail-OSG: GH9wIEkVM1m9w2MMpy_9KtidUOyvc05cQcJeW.zma8qohhi8wcVXt8ufiFsjNl5uAqNLZZ6qDBIUXRsNV6ptho61kCAGYQyn0RMeIF1LT6nViIXKZBo07OzoFw--
Received: from [72.231.9.236] by web50307.mail.re2.yahoo.com via HTTP; Fri, 02 May 2008 18:10:15 PDT
X-Mailer: YahooMailRC/902.40 YahooMailWebService/0.7.185
Date: Fri, 2 May 2008 18:10:15 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Hibernate search (Problem adding new Record)
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <991227.27223.qm@web50307.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Hibernate Search hasn't been talked about much on this list, so you may not get much help, if any.  Have you tried asking on the Hibernate Search mailing list? (don't know it's address/site).

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch

----- Original Message ----
> From: oyesiji <oyesiji@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Saturday, May 3, 2008 1:23:42 AM
> Subject: Hibernate search (Problem adding new Record)
> 
> 
> I am using Hibernate Search in my Application, the first time i attempt to
> index records from the database it works and the second time i attempt to
> add records i notice that it does not work
> 
> FullTextSession fullTextSession = Search.createFullTextSession(session);
>     for (JobDescription jobDescription : jobDescriptions) {
>             fullTextSession.index(jobDescription);
> }
> 
> Any suggestion is welcome
> -- 
> View this message in context: 
> http://www.nabble.com/Hibernate-search-%28Problem-adding-new-Record%29-tp17029563p17029563.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33888-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 03 03:23:47 2008
Return-Path: <java-user-return-33888-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61707 invoked from network); 3 May 2008 03:23:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 3 May 2008 03:23:46 -0000
Received: (qmail 10096 invoked by uid 500); 3 May 2008 03:23:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10069 invoked by uid 500); 3 May 2008 03:23:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10054 invoked by uid 99); 3 May 2008 03:23:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 20:23:40 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [65.89.232.7] (HELO thebluezone.net) (65.89.232.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 May 2008 03:22:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by thebluezone.net (Postfix) with ESMTP id 21BBF286BC8
	for <java-user@lucene.apache.org>; Fri,  2 May 2008 21:23:05 -0600 (MDT)
Received: from thebluezone.net ([127.0.0.1])
	by localhost (mail1 [127.0.0.1]) (amavisd-new, port 10024) with ESMTP
	id 07078-04 for <java-user@lucene.apache.org>;
	Fri, 2 May 2008 21:23:03 -0600 (MDT)
Received: from desktop (unknown [65.89.233.61])
	by thebluezone.net (Postfix) with ESMTP id 41846286BDC
	for <java-user@lucene.apache.org>; Fri,  2 May 2008 21:23:03 -0600 (MDT)
From: "John Griffin" <jgriffin@thebluezone.net>
To: <java-user@lucene.apache.org>
References: <17029563.post@talk.nabble.com>
Subject: RE: Hibernate search (Problem adding new Record)
Date: Fri, 2 May 2008 21:22:49 -0600
Message-ID: <001b01c8accc$f6f42380$f93c10ac@desktop>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <17029563.post@talk.nabble.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198
Thread-Index: Acisq7QK2J8lfacMTdW6/kDpJeY0qgAIQINg
X-Virus-Scanned: by thebluezone.net
X-Virus-Checked: Checked by ClamAV on apache.org

Try this:

FullTextSession fullTextSession = Search.createFullTextSession(session);
	for (JobDescription jobDescription : jobDescriptions) {
			fullTextSession.save(jobDescription);
}                                   ^
                                    |

		.index causes a reindex not a save

John G.

-----Original Message-----
From: oyesiji [mailto:oyesiji@gmail.com] 
Sent: Friday, May 02, 2008 5:24 PM
To: java-user@lucene.apache.org
Subject: Hibernate search (Problem adding new Record)


I am using Hibernate Search in my Application, the first time i attempt to
index records from the database it works and the second time i attempt to
add records i notice that it does not work

FullTextSession fullTextSession = Search.createFullTextSession(session);
	for (JobDescription jobDescription : jobDescriptions) {
			fullTextSession.index(jobDescription);
}

Any suggestion is welcome
-- 
View this message in context:
http://www.nabble.com/Hibernate-search-%28Problem-adding-new-Record%29-tp170
29563p17029563.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33889-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 03 03:31:58 2008
Return-Path: <java-user-return-33889-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63641 invoked from network); 3 May 2008 03:31:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 3 May 2008 03:31:56 -0000
Received: (qmail 13753 invoked by uid 500); 3 May 2008 03:31:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13707 invoked by uid 500); 3 May 2008 03:31:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13692 invoked by uid 99); 3 May 2008 03:31:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 May 2008 20:31:51 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [65.89.232.7] (HELO thebluezone.net) (65.89.232.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 May 2008 03:31:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by thebluezone.net (Postfix) with ESMTP id E9015286BE7
	for <java-user@lucene.apache.org>; Fri,  2 May 2008 21:31:16 -0600 (MDT)
Received: from thebluezone.net ([127.0.0.1])
	by localhost (mail1 [127.0.0.1]) (amavisd-new, port 10024) with ESMTP
	id 08346-01 for <java-user@lucene.apache.org>;
	Fri, 2 May 2008 21:31:15 -0600 (MDT)
Received: from desktop (unknown [65.89.233.61])
	by thebluezone.net (Postfix) with ESMTP id 07CD9286BC8
	for <java-user@lucene.apache.org>; Fri,  2 May 2008 21:31:15 -0600 (MDT)
From: "John Griffin" <jgriffin@thebluezone.net>
To: <java-user@lucene.apache.org>
References: <17029563.post@talk.nabble.com>
Subject: RE: Hibernate search (Problem adding new Record)
Date: Fri, 2 May 2008 21:31:01 -0600
Message-ID: <001c01c8acce$1c8667b0$f93c10ac@desktop>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <17029563.post@talk.nabble.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198
Thread-Index: Acisq7QK2J8lfacMTdW6/kDpJeY0qgAIkh0A
X-Virus-Scanned: by thebluezone.net
X-Virus-Checked: Checked by ClamAV on apache.org

P.S.

The Hibernate Search forum is at 

http://forum.hibernate.org/viewforum.php?f=9

John G.



-----Original Message-----
From: oyesiji [mailto:oyesiji@gmail.com] 
Sent: Friday, May 02, 2008 5:24 PM
To: java-user@lucene.apache.org
Subject: Hibernate search (Problem adding new Record)


I am using Hibernate Search in my Application, the first time i attempt to
index records from the database it works and the second time i attempt to
add records i notice that it does not work

FullTextSession fullTextSession = Search.createFullTextSession(session);
	for (JobDescription jobDescription : jobDescriptions) {
			fullTextSession.index(jobDescription);
}

Any suggestion is welcome
-- 
View this message in context:
http://www.nabble.com/Hibernate-search-%28Problem-adding-new-Record%29-tp170
29563p17029563.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33890-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 03 12:34:12 2008
Return-Path: <java-user-return-33890-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44141 invoked from network); 3 May 2008 12:34:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 3 May 2008 12:34:12 -0000
Received: (qmail 96200 invoked by uid 500); 3 May 2008 12:34:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96159 invoked by uid 500); 3 May 2008 12:34:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96148 invoked by uid 99); 3 May 2008 12:34:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 May 2008 05:34:05 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 May 2008 12:33:09 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JsGvi-0002TI-AK
	for java-user@lucene.apache.org; Sat, 03 May 2008 05:33:30 -0700
Message-ID: <17034715.post@talk.nabble.com>
Date: Sat, 3 May 2008 05:33:30 -0700 (PDT)
From: esra <esraersan@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: lucene farsi problem
In-Reply-To: <9294E20AED46934EA459020706463F94A04AE6@SUEXCL-02.ad.syr.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: esraersan@gmail.com
References: <16977096.post@talk.nabble.com> <08DF1421-37F0-4124-BCE3-DCD68EEC189A@apache.org> <16980977.post@talk.nabble.com> <1B1FC94C-66E4-4A8D-8C92-38CCCEFDF3E8@apache.org> <16993174.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04A4E@SUEXCL-02.ad.syr.edu> <17019498.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04AD2@SUEXCL-02.ad.syr.edu> <17022861.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04ADD@SUEXCL-02.ad.syr.edu> <17023557.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04AE6@SUEXCL-02.ad.syr.edu>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Steven,

thanks for your help....

Esra


Steven A Rowe wrote:
>=20
> Hi Esra,
>=20
> I have created an issue for this - see
> <https://issues.apache.org/jira/browse/LUCENE-1279>.
>=20
> I'll try to take a crack at a patch this weekend.
>=20
> Steve
>=20
> On 05/02/2008 at 12:55 PM, esra wrote:
>>=20
>> Hi Steven ,
>>=20
>> yes you are right, sorry i am a bit confused.
>>=20
>> i checked again and the correct one is  "zhe"/U+698.
>>=20
>> It seems the word is in the range but my customer says it
>> shouldn't be.
>>=20
>> I think problem occurs because  "zhe" is a Persian letter
>> outside the Arabic
>> alphabet. In farsi alphabet this letter is not after the "=D8=B3"
>> letter but it's
>> unicode is bigger than "=D8=B3" letter's and the searcher works
>> with unicodes.
>>=20
>> Esra
>>=20
>>=20
>> Steven A Rowe wrote:
>> >=20
>> > Hi Esra,
>> >=20
>> > You are *still* incorrectly referring to the glyph with three dots ove=
r
>> > it:
>> >=20
>> > On 05/02/2008 at 12:18 PM, esra wrote:
>> > > yes the correct one is "=DA=98 "/"ze"/U+632.
>> >=20
>> > "=DA=98" is *not* "ze"/U+632 - it is "zhe"/U+698.
>> >=20
>> > Have you increased the font size?  Can you see the difference between
>> > these two?:
>> >=20
>> > "=DA=98"/"zhe"/U+698
>> > "=D8=B2"/"ze"/U+632
>> >=20
>> > > my problem is when i do search for  "=D8=AF-=DA=98" range. The resul=
t is  "=D8=B3=D8=A7=D8=A8
>> > > =D9=88=D9=88=D9=81=D8=B1" and this word's first letter is "=D8=B3" a=
nd it's unicode is "U+633"=20
>> > > and it is not in the in the [ U+062F - U+0632 ] range.
>> >=20
>> > Like I keep saying, in the above description, you're using the glyph
>> > "=DA=98"/"zhe"/U+698, while calling at the same time incorrectly refer=
ring
>> > to it as "ze"/U+632.
>> >=20
>> > I don't mean to continually bang on about this - if you're *sure* that
>> > when you search, you're using the character represented by the glyph
>> > with one dot (and not three), i.e. "=D8=B2"/"ze"/U+632, then the probl=
em
>> > lies elsewhere.
>> >=20
>> > Steve
>> >=20
>> > On 05/02/2008 at 12:18 PM, esra wrote:
>> > > yes the correct one is "=DA=98 "/"ze"/U+632.
>> > >=20
>> > > my problem is when i do search for  "  =D8=AF-=DA=98" range. The res=
ult
>> > > is  ""=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1
>> > > " and this word's first letter is "=D8=B3 " and it's unicode is
>> > > "U+633"  and  it
>> > > is not in the in the [ U+062F - U+0632 ] range.
>> > >=20
>> > > am i wrong?
>> > >=20
>> > > Esra
>> > >=20
>> > > Steven A Rowe wrote:
>> > > >=20
>> > > > Hi Esra,
>> > > >=20
>> > > > I still think you're wrong :).
>> > > >=20
>> > > > On 05/02/2008 at 9:31 AM, esra wrote:
>> > > > > > =DA=98 =3D U+632
>> > > >=20
>> > > > According to the website you linked to, the above character, which
>> > > > has three dots over it, is named "zhe", and its Unicode code point
>> is
>> > > > U+698. (I had to increase the font size to see the three dots.)
>> > > >=20
>> > > > I think you are confusing "=DA=98"/"zhe"/U+698 with the letter
>> > > > "=D8=B2"/"ze"/U+632, which has just one dot over it.
>> > > >=20
>> > > > Unless you were mistaken in all of your emails when you included
>> the
>> > > > character "=DA=98"/"zhe" instead of "=D8=B2"/"ze", then what I sai=
d in my
>> > > > previous email still stands: there is no problem here.
>> > > >=20
>> > > > Steve
>> > > >=20
>> > > > On 05/02/2008 at 9:31 AM, esra wrote:
>> > > > >=20
>> > > > > Hi Steven,
>> > > > >=20
>> > > > > sorry i made a mistake. unicodes are like this:
>> > > > >=20
>> > > > > > =D8=AF=3DU+62F
>> > > > > > =DA=98 =3D U+632
>> > > > > > and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=
=D8=B1 " is  =D8=B3 =3D U+633
>> > > > >=20
>> > > > > you can also check them here
>> > > > > >=20
>> http://www.unics.uni-hannover.de/nhtcapri/persian-alphabet.html
>> > > > >=20
>> > > > > Esra
>> > > > >=20
>> > > > >=20
>> > > > > Steven A Rowe wrote:
>> > > > > >=20
>> > > > > > Hi Esra,
>> > > > > >=20
>> > > > > > Going back to the original problem statement, I see something
>> that
>> > > > > > looks illogical to me - please correct me if I'm wrong:
>> > > > > >=20
>> > > > > > On Apr 30, 2008, at 3:21 AM, esra wrote:
>> > > > > > > i am using lucene's "IndexSearcher" to search the given xml
>> by
>> > > > > > > keyword which contains farsi information. while searching i
>> use
>> > > > > > > ranges like
>> > > > > > >=20
>> > > > > > > =D8=A2-=D8=AB  |  =D8=AC-=D8=AE  |  =D8=AF-=DA=98  |  =D8=B3=
-=D8=B8  |  =D8=B9-=D9=82  |  =DA=A9-=D9=84  |  =D9=85-=DB=8C
>> > > > > > >=20
>> > > > > > > when i do search for  "=D8=AF-=DA=98"  range the results are=
 wrong ,
>> they
>> > > > > > > are the results of  " =D8=B3-=D8=B8 "range.
>> > > > > > >=20
>> > > > > > > for example when i do search for "=D8=AF-=DA=98"  one of the=
 the
>> results is
>> > > > > > > "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1", this result a=
lso shown on the " =D8=B3-=D8=B8 " range's
>> result
>> > > > > > > list which is the corret range.
>> > > > > > >=20
>> > > > > > > As IndexSearcher use "compareTo" method and this method uses
>> > > > > > > unicodes for comparing, i found the unicodes of the
>> characters.
>> > > > > > >=20
>> > > > > > > =D8=AF=3DU+62F
>> > > > > > > =DA=98 =3D U+698
>> > > > > > > and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=
=81=D8=B1 " is  =D8=B3 =3D U+633
>> > > > > >=20
>> > > > > > It appears to me that *both* the "=D8=AF-=DA=98" range [
>> U+062F - U+0698 ]
>> > > and
>> > > > > > the "=D8=B3-=D8=B8" range [ U+0633 - U+0638 ] contain the
>> first letter of
>> > > "=D8=B3=D8=A7=D8=A8
>> > > > > > =D9=88=D9=88=D9=81=D8=B1", which is "=D8=B3" =3D U+0633.
>> > > > > >=20
>> > > > > > You stated that U+0633 should be contained in the [
>> U+0633 - U+0638
>> > > ]
>> > > > > > range - I agree - but why do you think U+0633 should not be
>> > > > > > contained in the [ U+062F - U+0698 ] range?
>> > > > > >=20
>> > > > > > In other words, it looks to me like your problem is
>> not a problem
>> > > at
>> > > > > > all.
>> > > > > >=20
>> > > > > > Steve
>> > > > > >=20
>> > > > > >=20
>> > > > >=20
>> > > > > -- View this message in context:
>> > > > >=20
>> > > http://www.nabble.com/lucene-farsi-problem-tp16977096p17019498
>> > > .html Sent
>> > > > from the Lucene - Java Users mailing list archive at Nabble.com.
>> > > >=20
>> > > >=20
>> > > >=20
>> ---------------------------------------------------------------------
>> > > To
>> > > > unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org For
>> > > > additional commands, e-mail: java-user-help@lucene.apache.org
>> > > >=20
>> > > >=20
>> > >=20
>> > >=20
>> > >=20
>> > >=20
>> > >=20
>> > >=20
>> >  -- View this message in context:
>> >  http://www.nabble.com/lucene-farsi-problem-tp16977096p17022861.html
>> >  Sent from the Lucene - Java Users mailing list archive at
>> Nabble.com.
>> >=20
>> >=20
>> >=20
>> ---------------------------------------------------------------------
>> >  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >  For additional commands, e-mail: java-user-help@lucene.apache.org
>> >=20
>> >=20
>> >=20
>> >=20
>> >=20
>>=20
>> -- View this message in context:
>> http://www.nabble.com/lucene-farsi-problem-tp16977096p17023557.html Sent
>> from the Lucene - Java Users mailing list archive at Nabble.com.
>>=20
>>=20
>> --------------------------------------------------------------------- To
>> unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org For
>> additional commands, e-mail: java-user-help@lucene.apache.org
>>=20
>>
>=20
> =20
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/lucene-farsi-problem-tp=
16977096p17034715.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33891-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 03 19:42:09 2008
Return-Path: <java-user-return-33891-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55643 invoked from network); 3 May 2008 19:42:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 3 May 2008 19:42:09 -0000
Received: (qmail 50800 invoked by uid 500); 3 May 2008 19:42:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50768 invoked by uid 500); 3 May 2008 19:42:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50757 invoked by uid 99); 3 May 2008 19:42:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 May 2008 12:42:03 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 May 2008 19:41:17 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JsNbv-0003tt-2X
	for java-user@lucene.apache.org; Sat, 03 May 2008 12:41:31 -0700
Message-ID: <17037588.post@talk.nabble.com>
Date: Sat, 3 May 2008 12:41:31 -0700 (PDT)
From: syedfa <fayyazuddin@gmail.com>
To: java-user@lucene.apache.org
Subject: Using Highlighter to return search results
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fayyazuddin@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Dear Fellow Java/Lucene developers:

I have created an index from an xml document which I would like to search
using lucene.  Unfortunately, I am only able to return the number of times a
particular key word is found in the document, instead of returning the
keyword as well as the text that comes before and after it in the xml
document. 

For example:

If I am searching for the keyword "arrows" in the following xml document
(which is from Shakespeare's play, "Hamlet"):

<SPEECH>
<SPEAKER>HAMLET</SPEAKER>
<LINES>To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them? To die: to sleep;
No more; and by a sleep to say we end
The heart-ache and the thousand natural shocks
That flesh is heir to, 'tis a consummation
Devoutly to be wish'd. To die, to sleep;
To sleep: perchance to dream: ay, there's the rub;
For in that sleep of death what dreams may come
When we have shuffled off this mortal coil,
Must give us pause: there's the respect
That makes calamity of so long life;
For who would bear the whips and scorns of time,
The oppressor's wrong, the proud man's contumely,
The pangs of despised love, the law's delay,
The insolence of office and the spurns
That patient merit of the unworthy takes,
When he himself might his quietus make
With a bare bodkin? who would fardels bear,
To grunt and sweat under a weary life,
But that the dread of something after death,
The undiscover'd country from whose bourn
No traveller returns, puzzles the will
And makes us rather bear those ills we have
Than fly to others that we know not of?
Thus conscience does make cowards of us all;
And thus the native hue of resolution
Is sicklied o'er with the pale cast of thought,
And enterprises of great pith and moment
With this regard their currents turn awry,
And lose the name of action.--Soft you now!
The fair Ophelia! Nymph, in thy orisons
Be all my sins remember'd.</LINES>
</SPEECH>

I would like a set of results that return the word "arrows" highlighted, and
the line from which it appears (i.e. The slings and arrows of outrageous
fortune).  Below is the code that I am using to search:

import java.io.File;
import java.io.FileReader;
import java.io.Reader;
import java.util.Date;
import java.io.IOException;
 
import org.apache.lucene.analysis.Analyzer;
import org.apache.lucene.analysis.standard.StandardAnalyzer ;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.index.IndexWriter;
import org.apache.lucene.search.IndexSearcher;
import org.apache.lucene.search.Query ;
import org.apache.lucene.search.Hits;
import org.apache.lucene.index.Term;
import org.apache.lucene.search.TermQuery;
import org.apache.lucene.store.FSDirectory;
import org.apache.lucene.store.Directory;
import org.apache.lucene.queryParser.QueryParser;
 
public class Searcher {
    
    /** Creates a new instance of Searcher */
    
    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) throws Exception{ 
        
        File indexDir=new File("c:\\indexD");
        String q="arrows";
        
        if(!indexDir.exists() || !indexDir.isDirectory()){
            throw new Exception(indexDir + "does not exist of is not a
directory."); 
        }
        
        search(indexDir, q);
        
    }
    
    public static void search(File indexDir, String q) throws Exception {
         
        Directory fsDir=FSDirectory.getDirectory(indexDir);
        IndexSearcher is=new IndexSearcher(fsDir);
        
        Query parser=new QueryParser("LINES", new
StandardAnalyzer()).parse(q); 
        long start=new Date().getTime();
        Hits hits=is.search(parser);
        long end=new Date().getTime();
        
        System.err.println("Found " + hits.length() + " document(s)(in" +
(end-start) + " milliseconds) that matched query '" + q + "':"); 
        
        for(int i=0; i<hits.length(); i++){
            Document doc=hits.doc(i);
        }
        
    }
    
}

What do I need to do to achieve this?  Thanks to everyone in advance.

Sincerely;
Fayyaz
-- 
View this message in context: http://www.nabble.com/Using-Highlighter-to-return-search-results-tp17037588p17037588.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33892-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 04 08:21:30 2008
Return-Path: <java-user-return-33892-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50916 invoked from network); 4 May 2008 08:21:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 4 May 2008 08:21:30 -0000
Received: (qmail 94370 invoked by uid 500); 4 May 2008 08:21:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93821 invoked by uid 500); 4 May 2008 08:21:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93810 invoked by uid 99); 4 May 2008 08:21:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 01:21:22 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of liccohu@hotmail.com designates 65.54.246.218 as permitted sender)
Received: from [65.54.246.218] (HELO bay0-omc3-s18.bay0.hotmail.com) (65.54.246.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 08:20:27 +0000
Received: from BAY113-DS7 ([65.54.168.94]) by bay0-omc3-s18.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Sun, 4 May 2008 01:20:47 -0700
X-Originating-IP: [222.66.106.34]
X-Originating-Email: [liccohu@hotmail.com]
Message-ID: <BAY113-DS7FAB636555AA0C595CEB2B8D40@phx.gbl>
From: "kai.hu" <liccohu@hotmail.com>
In-Reply-To: <011601c8a436$87adc240$b208a8c0@WangJianxin> <0C5F3D1247CCF341B9B8DD7B447FA492501A9A@CORPUSMX70A.corp.emc.com> <016901c8a43f$47c9edd0$b208a8c0@WangJianxin> <839ba01c0804220036h51992647yaecedad17597f0dc@mail.gmail.com>
To: <java-user@lucene.apache.org>
References: <011601c8a436$87adc240$b208a8c0@WangJianxin> <0C5F3D1247CCF341B9B8DD7B447FA492501A9A@CORPUSMX70A.corp.emc.com> <016901c8a43f$47c9edd0$b208a8c0@WangJianxin> <839ba01c0804220036h51992647yaecedad17597f0dc@mail.gmail.com>
Subject: =?utf-8?B?UmU6IE5lZWQgYWRkdGlvbmFsIGluZm8gZm9yIEZpZWw=?=
	=?utf-8?B?ZO+8iOW4jOacm+eci+W+l+aHguS4reaWh+eahOaci+WPi+W4ruaIkeWHuuWHug==?=
	=?utf-8?B?5Li75oSP77yJ?=
Date: Sun, 4 May 2008 16:20:45 +0800
MIME-Version: 1.0
Content-Type: text/plain;
	format=flowed;
	charset="utf-8";
	reply-type=original
X-Unsent: 1
Content-Transfer-Encoding: 8bit
X-Priority: 3
X-MSMail-Priority: Normal
Importance: Normal
X-Mailer: Microsoft Windows Live Mail 12.0.1606
X-MimeOLE: Produced By Microsoft MimeOLE V12.0.1606
X-OriginalArrivalTime: 04 May 2008 08:20:47.0743 (UTC) FILETIME=[C18978F0:01C8ADBF]
X-Virus-Checked: Checked by ClamAV on apache.org


document.add(new Field("sub","",Field.Store.YES,Field.Index.TOKENIZED));
document.add(new 
Field("time","01:02:02",Field.Store.YES,Field.Index.UN_TOKENIZED));
documentField

only index and tokenized "",and store the time with this sub.

--------------------------------------------------
From: "Cedric Ho" <cedric.ho@gmail.com>
Sent: Tuesday, April 22, 2008 3:36 PM
To: <java-user@lucene.apache.org>
Subject: Re: Need addtional info for Field 


> In that case you may want to index each:
>
> Field("Sub","""01:02:02");
>
> as a separate document. So your document contains 3 fields
> 1. title
> 2. time
> 3. sub
>
> then you can get both title and time by searching the "sub" field.
>
> Cedric
>
>
> 2008/4/22  <lieutroy@gmail.com>:
>>
>>  subsubField 
>> 
>>  payload
>>
>>
>>
>>  ----- Original Message -----
>>  From: <Fang_Li@emc.com>
>>  To: <java-user@lucene.apache.org>
>>  Sent: Tuesday, April 22, 2008 1:55 PM
>>  Subject: RE: Need addtional info for Field
>>
>>
>>  Try to use payload which is stored as additional information. Currently 
>> lucene only support per token payload, but you can add an arbitrary token 
>> for the time information.
>>
>>  I am not sure what are the query information? Only the subtitle or both 
>> subtitle and time?
>>
>>  Regards,
>>
>>  -----Original Message-----
>>  From:  [mailto:lieutroy@gmail.com]
>>  Sent: Tuesday, April 22, 2008 1:06 PM
>>  To: java-user
>>  Subject: Need addtional info for Field 
>> 
>>
>>  
>>
>>
>>  ----- Original Message -----
>>  From: 
>>  To: Chris
>>  Sent: Tuesday, April 22, 2008 9:52 AM
>>  Subject: Re: Need addtional info for Field
>>
>>
>>  
>>  (video)(index)
>>  Document,()
>>     Field("Sub","""01:02:02");
>>     Field("Sub","""01:03:05");
>>     ["01:02:02"lucene]
>>
>>  Field01:02:02""01:03:05""(User)""Field"01:02:02"""Field"01:02:02""01:03:05"
>>  
>>
>>  lucenelucene
>>
>>  
>>   ----- Original Message -----
>>   From: Chris
>>   To: 
>>   Sent: Monday, April 21, 2008 7:34 PM
>>   Subject: Re: Need addtional info for Field
>>
>>
>>   ....
>>
>>    multi-pair  String 
>>
>>   
>>                      Chris.
>>
>>
>>   2008/4/21,  <lieutroy@gmail.com>:
>>     
>>
>>     
>>     lucene
>>
>>       ----- Original Message -----
>>       From: Chris
>>       To: 
>>       Sent: Monday, April 21, 2008 5:14 PM
>>       Subject: Re: Need addtional info for Field
>>
>>
>>       This problem is not solve with lucene but or method will solve it.
>>
>>       The structure is not define as this as well ......
>>
>>       You may check it clear....
>>
>>       above
>>                      Chris.
>>
>>
>>       2008/4/21,  <lieutroy@gmail.com>:
>>         hi Chris, it is me ""
>>
>>         I have a new problem, Could you give me any advice? Thank you.
>>
>>
>>         I want to use lucene with some additional info,like:
>>
>>         1.index
>>             Document additionalDoc=ew Document()
>>
>>             additionalDoc.add(new Field("field","AA BB","Addtional info 
>> ..............."));
>>             additionalDoc.add(new Field("field","BB CC","Addtional info 
>> 222222222222222222222222..............."));
>>
>>             writer.addDocument(additionalDoc)
>>
>>             ........
>>
>>
>>         2. search
>>
>>             Searcher searcher;
>>             ....
>>
>>             searcher.search(termQuery("field","BB"));
>>
>>
>>
>>
>>             in this condition, I want lucene returns the additionalDoc , 
>> also know which fileds were matched, then I will get the additional info 
>> from the matched fields.
>>
>>         Can lucene make it in version 2.3.1?
>>
>>
>>
>>       --
>>       Chris Lin
>>       chrislin0426@gmail.com
>>       Taipei , Taiwan.
>>       -----------------------------------------------------------
>>
>>
>>
>>   --
>>   Chris Lin
>>   chrislin0426@gmail.com
>>   Taipei , Taiwan.
>>   -----------------------------------------------------------
>>
>>  ---------------------------------------------------------------------
>>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>  For additional commands, e-mail: java-user-help@lucene.apache.org
>>
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33893-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 04 08:28:10 2008
Return-Path: <java-user-return-33893-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52908 invoked from network); 4 May 2008 08:28:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 4 May 2008 08:28:10 -0000
Received: (qmail 96684 invoked by uid 500); 4 May 2008 08:28:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96652 invoked by uid 500); 4 May 2008 08:28:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96641 invoked by uid 99); 4 May 2008 08:28:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 01:28:06 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of liccohu@hotmail.com designates 65.54.246.236 as permitted sender)
Received: from [65.54.246.236] (HELO bay0-omc3-s36.bay0.hotmail.com) (65.54.246.236)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 08:27:18 +0000
Received: from BAY113-DS1 ([65.54.168.88]) by bay0-omc3-s36.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Sun, 4 May 2008 01:27:32 -0700
X-Originating-IP: [222.66.106.34]
X-Originating-Email: [liccohu@hotmail.com]
Message-ID: <BAY113-DS10FDD441271BC79D2F639B8D40@phx.gbl>
From: "kai.hu" <liccohu@hotmail.com>
In-Reply-To: <011601c8a436$87adc240$b208a8c0@WangJianxin> <0C5F3D1247CCF341B9B8DD7B447FA492501A9A@CORPUSMX70A.corp.emc.com> <016901c8a43f$47c9edd0$b208a8c0@WangJianxin> <839ba01c0804220036h51992647yaecedad17597f0dc@mail.gmail.com> <BAY113-DS7FAB636555AA0C595CEB2B8D40@phx.gbl>
To: <java-user@lucene.apache.org>
References: <011601c8a436$87adc240$b208a8c0@WangJianxin> <0C5F3D1247CCF341B9B8DD7B447FA492501A9A@CORPUSMX70A.corp.emc.com> <016901c8a43f$47c9edd0$b208a8c0@WangJianxin> <839ba01c0804220036h51992647yaecedad17597f0dc@mail.gmail.com> <BAY113-DS7FAB636555AA0C595CEB2B8D40@phx.gbl>
Subject: =?utf-8?B?UmU6IE5lZWQgYWRkdGlvbmFsIGluZm8gZm9yIEZpZWw=?=
	=?utf-8?B?ZO+8iOW4jOacm+eci+W+l+aHguS4reaWh+eahOaci+WPi+W4ruaIkeWHuuWHug==?=
	=?utf-8?B?5Li75oSP77yJ?=
Date: Sun, 4 May 2008 16:27:30 +0800
MIME-Version: 1.0
Content-Type: text/plain;
	format=flowed;
	charset="utf-8";
	reply-type=response
X-Unsent: 1
Content-Transfer-Encoding: 8bit
X-Priority: 3
X-MSMail-Priority: Normal
Importance: Normal
X-Mailer: Microsoft Windows Live Mail 12.0.1606
X-MimeOLE: Produced By Microsoft MimeOLE V12.0.1606
X-OriginalArrivalTime: 04 May 2008 08:27:32.0237 (UTC) FILETIME=[B2A25BD0:01C8ADC0]
X-Virus-Checked: Checked by ClamAV on apache.org

google

--------------------------------------------------
From: "kai.hu" <liccohu@hotmail.com>
Sent: Sunday, May 04, 2008 4:20 PM
To: <java-user@lucene.apache.org>
Subject: Re: Need addtional info for Field 


> 
> document.add(new Field("sub","",Field.Store.YES,Field.Index.TOKENIZED));
> document.add(new 
> Field("time","01:02:02",Field.Store.YES,Field.Index.UN_TOKENIZED));
> documentField
>
> only index and tokenized "",and store the time with this sub.
>
> --------------------------------------------------
> From: "Cedric Ho" <cedric.ho@gmail.com>
> Sent: Tuesday, April 22, 2008 3:36 PM
> To: <java-user@lucene.apache.org>
> Subject: Re: Need addtional info for Field 
> 
>
>> In that case you may want to index each:
>>
>> Field("Sub","""01:02:02");
>>
>> as a separate document. So your document contains 3 fields
>> 1. title
>> 2. time
>> 3. sub
>>
>> then you can get both title and time by searching the "sub" field.
>>
>> Cedric
>>
>>
>> 2008/4/22  <lieutroy@gmail.com>:
>>>
>>>  subsubField 
>>>  payload
>>>
>>>
>>>
>>>  ----- Original Message -----
>>>  From: <Fang_Li@emc.com>
>>>  To: <java-user@lucene.apache.org>
>>>  Sent: Tuesday, April 22, 2008 1:55 PM
>>>  Subject: RE: Need addtional info for Field
>>>
>>>
>>>  Try to use payload which is stored as additional information. Currently 
>>> lucene only support per token payload, but you can add an arbitrary 
>>> token for the time information.
>>>
>>>  I am not sure what are the query information? Only the subtitle or both 
>>> subtitle and time?
>>>
>>>  Regards,
>>>
>>>  -----Original Message-----
>>>  From:  [mailto:lieutroy@gmail.com]
>>>  Sent: Tuesday, April 22, 2008 1:06 PM
>>>  To: java-user
>>>  Subject: Need addtional info for Field 
>>> 
>>>  
>>>
>>>
>>>  ----- Original Message -----
>>>  From: 
>>>  To: Chris
>>>  Sent: Tuesday, April 22, 2008 9:52 AM
>>>  Subject: Re: Need addtional info for Field
>>>
>>>
>>>  
>>>  (video)(index)
>>>  Document,()
>>>     Field("Sub","""01:02:02");
>>>     Field("Sub","""01:03:05");
>>>     ["01:02:02"lucene]
>>>
>>>  Field01:02:02""01:03:05""(User)""Field"01:02:02"""Field"01:02:02""01:03:05"
>>>  
>>>
>>>  lucenelucene
>>>
>>>  
>>>   ----- Original Message -----
>>>   From: Chris
>>>   To: 
>>>   Sent: Monday, April 21, 2008 7:34 PM
>>>   Subject: Re: Need addtional info for Field
>>>
>>>
>>>   ....
>>>
>>>    multi-pair  String 
>>>
>>>   
>>>                      Chris.
>>>
>>>
>>>   2008/4/21,  <lieutroy@gmail.com>:
>>>     
>>>
>>>     
>>>     lucene
>>>
>>>       ----- Original Message -----
>>>       From: Chris
>>>       To: 
>>>       Sent: Monday, April 21, 2008 5:14 PM
>>>       Subject: Re: Need addtional info for Field
>>>
>>>
>>>       This problem is not solve with lucene but or method will solve it.
>>>
>>>       The structure is not define as this as well ......
>>>
>>>       You may check it clear....
>>>
>>>       above
>>>                      Chris.
>>>
>>>
>>>       2008/4/21,  <lieutroy@gmail.com>:
>>>         hi Chris, it is me ""
>>>
>>>         I have a new problem, Could you give me any advice? Thank you.
>>>
>>>
>>>         I want to use lucene with some additional info,like:
>>>
>>>         1.index
>>>             Document additionalDoc=ew Document()
>>>
>>>             additionalDoc.add(new Field("field","AA BB","Addtional info 
>>> ..............."));
>>>             additionalDoc.add(new Field("field","BB CC","Addtional info 
>>> 222222222222222222222222..............."));
>>>
>>>             writer.addDocument(additionalDoc)
>>>
>>>             ........
>>>
>>>
>>>         2. search
>>>
>>>             Searcher searcher;
>>>             ....
>>>
>>>             searcher.search(termQuery("field","BB"));
>>>
>>>
>>>
>>>
>>>             in this condition, I want lucene returns the additionalDoc , 
>>> also know which fileds were matched, then I will get the additional info 
>>> from the matched fields.
>>>
>>>         Can lucene make it in version 2.3.1?
>>>
>>>
>>>
>>>       --
>>>       Chris Lin
>>>       chrislin0426@gmail.com
>>>       Taipei , Taiwan.
>>>       -----------------------------------------------------------
>>>
>>>
>>>
>>>   --
>>>   Chris Lin
>>>   chrislin0426@gmail.com
>>>   Taipei , Taiwan.
>>>   -----------------------------------------------------------
>>>
>>>  ---------------------------------------------------------------------
>>>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>  For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33894-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 04 11:21:01 2008
Return-Path: <java-user-return-33894-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81658 invoked from network); 4 May 2008 11:21:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 4 May 2008 11:21:01 -0000
Received: (qmail 70568 invoked by uid 500); 4 May 2008 11:20:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70541 invoked by uid 500); 4 May 2008 11:20:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70530 invoked by uid 99); 4 May 2008 11:20:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 04:20:54 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MIME_BASE64_BLANKS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lieutroy@gmail.com designates 209.85.198.237 as permitted sender)
Received: from [209.85.198.237] (HELO rv-out-0506.google.com) (209.85.198.237)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 11:20:07 +0000
Received: by rv-out-0506.google.com with SMTP id f6so593010rvb.5
        for <java-user@lucene.apache.org>; Sun, 04 May 2008 04:20:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to:references:subject:date:mime-version:content-type:content-transfer-encoding:x-priority:x-msmail-priority:x-mailer:x-mimeole;
        bh=QAQAo1/1E0V2wbXwrIoARgUtLX/0uGkTKWO5W4n/13o=;
        b=M8BMyxXvbVDLBhnbj6Q2o2SBtiH3DkF7ZiWSgh1yNuhZmAPW+LBJk8BUoE1/+4X6/OJbBTG+hnfqhVC1yEy889CdDgiHXBKwSzbcBKq8GS7gCXGTKGDdXLUOjFdABeLtyeVCgrDHCVBUZSay7XIf53KTJ7vfvQOSCtk/WuNLkpU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:references:subject:date:mime-version:content-type:content-transfer-encoding:x-priority:x-msmail-priority:x-mailer:x-mimeole;
        b=YwObnbv//RFcZbNyQofjgnEopXEtayff/9iNK35u5PT+kv2FvnkwQI7TwTWETEkpQcMHnSIoFjQe9iJ+6Zv4sP60ihsVAm497NT8YTMTQlVGclb1x0ABwdFJSAfP2/EdNZzLE9LBw2X72FQaJALl0XxxH/IciUYZaWb9MAZiylo=
Received: by 10.140.164.6 with SMTP id m6mr2260006rve.210.1209900021958;
        Sun, 04 May 2008 04:20:21 -0700 (PDT)
Received: from WangJianxin ( [203.86.44.2])
        by mx.google.com with ESMTPS id l31sm7418313rvb.6.2008.05.04.04.20.16
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 04 May 2008 04:20:21 -0700 (PDT)
Message-ID: <004001c8add8$e4946210$ad03a8c0@WangJianxin>
From: =?utf-8?B?546L5bu65paw?= <lieutroy@gmail.com>
To: <java-user@lucene.apache.org>
References: <011601c8a436$87adc240$b208a8c0@WangJianxin> <0C5F3D1247CCF341B9B8DD7B447FA492501A9A@CORPUSMX70A.corp.emc.com> <016901c8a43f$47c9edd0$b208a8c0@WangJianxin> <839ba01c0804220036h51992647yaecedad17597f0dc@mail.gmail.com> <BAY113-DS7FAB636555AA0C595CEB2B8D40@phx.gbl> <BAY113-DS10FDD441271BC79D2F639B8D40@phx.gbl>
Subject: =?utf-8?B?UmU6IE5lZWQgYWRkdGlvbmFsIGluZm8gZm9yIEZpZWw=?=
	=?utf-8?B?ZO+8iOW4jOacm+eci+W+l+aHguS4reaWh+eahOaci+WPi+W4ruaIkeWHuuWHug==?=
	=?utf-8?B?5Li75oSP77yJ?=
Date: Sun, 4 May 2008 19:20:35 +0800
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198
X-Virus-Checked: Checked by ClamAV on apache.org

DQrlpb3nmoTvvIzosKLosKLvvIENCg0KLS0tLS0gT3JpZ2luYWwgTWVzc2FnZSAtLS0tLSANCkZy
b206ICJrYWkuaHUiIDxsaWNjb2h1QGhvdG1haWwuY29tPg0KVG86IDxqYXZhLXVzZXJAbHVjZW5l
LmFwYWNoZS5vcmc+DQpTZW50OiBTdW5kYXksIE1heSAwNCwgMjAwOCA0OjI3IFBNDQpTdWJqZWN0
OiBSZTogTmVlZCBhZGR0aW9uYWwgaW5mbyBmb3IgRmllbGTvvIjluIzmnJvnnIvlvpfmh4LkuK3m
lofnmoTmnIvlj4vluK7miJHlh7rlh7rkuLvmhI/vvIkNCg0KDQo+IOWcqGdvb2dsZemHjOaQnOS4
gOS4i+S4reaWh+WIhuivje+8jOWHuui9puS4nOeahOWMheWklu+8jOW6lOivpei/mOacieW+iOWk
muS6hu+8jOWmguaenOS9oOWPkeeOsOacieabtOWlveWIhuivje+8jOabtOmrmOaViOeOh+eahO+8
jOS5n+aOqOiNkOS4gOS7veWViuOAgg0KPiANCj4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4gRnJvbTogImthaS5odSIgPGxpY2NvaHVAaG90bWFp
bC5jb20+DQo+IFNlbnQ6IFN1bmRheSwgTWF5IDA0LCAyMDA4IDQ6MjAgUE0NCj4gVG86IDxqYXZh
LXVzZXJAbHVjZW5lLmFwYWNoZS5vcmc+DQo+IFN1YmplY3Q6IFJlOiBOZWVkIGFkZHRpb25hbCBp
bmZvIGZvciBGaWVsZO+8iOW4jOacm+eci+W+l+aHguS4reaWh+eahOaci+WPi+W4ruaIkeWHuuWH
uuS4u+aEj++8iSANCj4gDQo+IA0KPj4g5L2g5Y+q6KaB57Si5byV5bm25YiG6K+N4oCc5LiL5Y2I
5Y675byA5Lya4oCd5bCx6KGM5LqG77yM5oqK5a+55bqU55qE5pe26Ze05L+d5a2Y6L+b5Y6744CC
DQo+PiDlpoJkb2N1bWVudC5hZGQobmV3IEZpZWxkKCJzdWIiLCLkuIvljYjljrvlvIDkvJoiLEZp
ZWxkLlN0b3JlLllFUyxGaWVsZC5JbmRleC5UT0tFTklaRUQpKTsNCj4+IGRvY3VtZW50LmFkZChu
ZXcgDQo+PiBGaWVsZCgidGltZSIsIjAxOjAyOjAyIixGaWVsZC5TdG9yZS5ZRVMsRmllbGQuSW5k
ZXguVU5fVE9LRU5JWkVEKSk7DQo+PiDliLDml7blgJnmkJzntKLlh7rnmoTljZXkuKpkb2N1bWVu
dOmHjOWwseWMheWQq+i/meS4pOS4qkZpZWxk5LqG44CCDQo+Pg0KPj4gb25seSBpbmRleCBhbmQg
dG9rZW5pemVkICLkuIvljYjljrvlvIDkvJoiLGFuZCBzdG9yZSB0aGUgdGltZSB3aXRoIHRoaXMg
c3ViLg0KPj4NCj4+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tDQo+PiBGcm9tOiAiQ2VkcmljIEhvIiA8Y2VkcmljLmhvQGdtYWlsLmNvbT4NCj4+IFNl
bnQ6IFR1ZXNkYXksIEFwcmlsIDIyLCAyMDA4IDM6MzYgUE0NCj4+IFRvOiA8amF2YS11c2VyQGx1
Y2VuZS5hcGFjaGUub3JnPg0KPj4gU3ViamVjdDogUmU6IE5lZWQgYWRkdGlvbmFsIGluZm8gZm9y
IEZpZWxk77yI5biM5pyb55yL5b6X5oeC5Lit5paH55qE5pyL5Y+L5biu5oiR5Ye65Ye65Li75oSP
77yJIA0KPj4gDQo+Pg0KPj4+IEluIHRoYXQgY2FzZSB5b3UgbWF5IHdhbnQgdG8gaW5kZXggZWFj
aDoNCj4+Pg0KPj4+IEZpZWxkKCJTdWIiLCLkuIvljYjljrvlvIDkvJoi77yMIjAxOjAyOjAyIik7
DQo+Pj4NCj4+PiBhcyBhIHNlcGFyYXRlIGRvY3VtZW50LiBTbyB5b3VyIGRvY3VtZW50IGNvbnRh
aW5zIDMgZmllbGRzDQo+Pj4gMS4gdGl0bGUNCj4+PiAyLiB0aW1lDQo+Pj4gMy4gc3ViDQo+Pj4N
Cj4+PiB0aGVuIHlvdSBjYW4gZ2V0IGJvdGggdGl0bGUgYW5kIHRpbWUgYnkgc2VhcmNoaW5nIHRo
ZSAic3ViIiBmaWVsZC4NCj4+Pg0KPj4+IENlZHJpYw0KPj4+DQo+Pj4NCj4+PiAyMDA4LzQvMjIg
546L5bu65pawIDxsaWV1dHJveUBnbWFpbC5jb20+Og0KPj4+Pg0KPj4+PiAg6LCi6LCi77yM5oiR
5Y+q5piv5qOA57Sic3Vi77yM5LiN5qOA57Si5pe26Ze077yM5Zyo5qOA57Sic3Vi5pe277yM5Y+q
5oOz5b6X5Yiw5Yy56YWNRmllbGTlr7nlupTnmoTml7bpl7TjgIIgDQo+Pj4+ICDnlKhwYXlsb2Fk
5Ly85LmO5LiN5Y+v5Lul77yfDQo+Pj4+DQo+Pj4+DQo+Pj4+DQo+Pj4+ICAtLS0tLSBPcmlnaW5h
bCBNZXNzYWdlIC0tLS0tDQo+Pj4+ICBGcm9tOiA8RmFuZ19MaUBlbWMuY29tPg0KPj4+PiAgVG86
IDxqYXZhLXVzZXJAbHVjZW5lLmFwYWNoZS5vcmc+DQo+Pj4+ICBTZW50OiBUdWVzZGF5LCBBcHJp
bCAyMiwgMjAwOCAxOjU1IFBNDQo+Pj4+ICBTdWJqZWN0OiBSRTogTmVlZCBhZGR0aW9uYWwgaW5m
byBmb3IgRmllbGTvvIjluIzmnJvnnIvlvpfmh4LkuK3mlofnmoTmnIvlj4vluK7miJHlh7rlh7rk
uLvmhI/vvIkNCj4+Pj4NCj4+Pj4NCj4+Pj4gIFRyeSB0byB1c2UgcGF5bG9hZCB3aGljaCBpcyBz
dG9yZWQgYXMgYWRkaXRpb25hbCBpbmZvcm1hdGlvbi4gQ3VycmVudGx5IA0KPj4+PiBsdWNlbmUg
b25seSBzdXBwb3J0IHBlciB0b2tlbiBwYXlsb2FkLCBidXQgeW91IGNhbiBhZGQgYW4gYXJiaXRy
YXJ5IA0KPj4+PiB0b2tlbiBmb3IgdGhlIHRpbWUgaW5mb3JtYXRpb24uDQo+Pj4+DQo+Pj4+ICBJ
IGFtIG5vdCBzdXJlIHdoYXQgYXJlIHRoZSBxdWVyeSBpbmZvcm1hdGlvbj8gT25seSB0aGUgc3Vi
dGl0bGUgb3IgYm90aCANCj4+Pj4gc3VidGl0bGUgYW5kIHRpbWU/DQo+Pj4+DQo+Pj4+ICBSZWdh
cmRzLA0KPj4+Pg0KPj4+PiAgLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4+Pj4gIEZyb206
IOeOi+W7uuaWsCBbbWFpbHRvOmxpZXV0cm95QGdtYWlsLmNvbV0NCj4+Pj4gIFNlbnQ6IFR1ZXNk
YXksIEFwcmlsIDIyLCAyMDA4IDE6MDYgUE0NCj4+Pj4gIFRvOiBqYXZhLXVzZXINCj4+Pj4gIFN1
YmplY3Q6IE5lZWQgYWRkdGlvbmFsIGluZm8gZm9yIEZpZWxk77yI5biM5pyb55yL5b6X5oeC5Lit
5paH55qE5pyL5Y+L5biu5oiR5Ye65Ye65Li75oSP77yJIA0KPj4+PiANCj4+Pj4gIOeUqOiLseaW
h+WPr+iDveaPj+i/sOW+l+S4jeaYr+W+iOa4healmu+8jOS4jeWlveaEj+aAne+8mu+8iQ0KPj4+
Pg0KPj4+Pg0KPj4+PiAgLS0tLS0gT3JpZ2luYWwgTWVzc2FnZSAtLS0tLQ0KPj4+PiAgRnJvbTog
546L5bu65pawDQo+Pj4+ICBUbzogQ2hyaXMNCj4+Pj4gIFNlbnQ6IFR1ZXNkYXksIEFwcmlsIDIy
LCAyMDA4IDk6NTIgQU0NCj4+Pj4gIFN1YmplY3Q6IFJlOiBOZWVkIGFkZHRpb25hbCBpbmZvIGZv
ciBGaWVsZA0KPj4+Pg0KPj4+Pg0KPj4+PiAg6LCi6LCi44CCDQo+Pj4+ICDmiJHnmoTpl67popjm
mK/ov5nmoLfnmoTvvJropoHlr7nkuIDmibnop4bpopHmlofku7YodmlkZW8p5bu656uL57Si5byV
KGluZGV4Ke+8jOWcqOW7uueri+e0ouW8leS5i+WJje+8jOaIkeW3sue7j+WIhuaekOWHuuS6huWc
qOinhumikeeahOS7gOS5iOaXtumXtOWHuueOsOS6huS7gOS5iOagt+eahOWtl+W5leWGheWuueOA
gg0KPj4+PiAg5Zyo6L+Z56eN5oOF5Ya15LiL77yM5LiA5Liq6KeG6aKR6IqC55uu5bCx55u45b2T
5LqO5LiA5LiqRG9jdW1lbnQs6YKj5LmI6ZyA6KaBKOW4jOacmynlr7nlrZfluZXlu7rnq4vntKLl
vJXvvIzlpoLkuIvvvJoNCj4+Pj4gICAgIEZpZWxkKCJTdWIiLCLkuIvljYjljrvlvIDkvJoi77yM
IjAxOjAyOjAyIik7DQo+Pj4+ICAgICBGaWVsZCgiU3ViIiwi5ZCO5aSp5Y675byA5LyaIu+8jCIw
MTowMzowNSIpOw0KPj4+PiAgICAgW+azqO+8miIwMTowMjowMiLmmK/pmYTlsZ7nmoTml7bpl7Tv
vIxsdWNlbmXmsqHmnInmj5Dkvpvov5nnp43nlKjms5XjgIJdDQo+Pj4+DQo+Pj4+ICDov5nkuKTk
uKpGaWVsZOihqOekuuWcqOW9k+WJjeeahOinhumikeiKguebruS4re+8jOWcqDAxOjAyOjAy5pe2
6Ze05Ye6546w5LqG5a2X5bmVIuS4i+WNiOWOu+W8gOS8miLvvIzlnKgwMTowMzowNeaXtumXtOWH
uueOsOS6hiLlkI7lpKnljrvlvIDkvJoi77yM5aaC5p6c55So5oi3KFVzZXIp5pCc57SiIuS4i+WN
iCLvvIzlvZPliY3op4bpopHoioLnm67mmK/lj6/ku6XljLnphY3nmoTvvIzkvYbmmK/lj6rljLnp
hY3liLDkuobnrKzkuIDkuKpGaWVsZO+8jOWPqumcgOimgeefpemBk+aXtumXtCIwMTowMjowMiLj
gILlpoLmnpznlKjmiLfmkJzntKIi5byA5LyaIu+8jOWImeS4pOS4qkZpZWxk6YO95Y+v5Lul5Yy5
6YWN5Yiw44CC5Zug5q2k6ZyA6KaB55+l6YGT5pe26Ze0IjAxOjAyOjAyIuWSjCIwMTowMzowNSLj
gIINCj4+Pj4gIOS4jeefpemBk+aIkeacieayoeacieivtOa4healmuOAgg0KPj4+Pg0KPj4+PiAg
5oiR5oOz55+l6YGTbHVjZW5l5piv5LiN5piv5Y+v5Lul6YCa6L+H5p+Q56eN5pa55byP6Kej5Yaz
6L+Z5Liq6Zeu6aKY77yM5aaC5p6c5LiN6KGM55qE6K+d77yM6ZyA6KaB5oCO5qC35L+u5pS5bHVj
ZW5l5ZGi77yfDQo+Pj4+DQo+Pj4+ICDnjovlu7rmlrANCj4+Pj4gICAtLS0tLSBPcmlnaW5hbCBN
ZXNzYWdlIC0tLS0tDQo+Pj4+ICAgRnJvbTogQ2hyaXMNCj4+Pj4gICBUbzog546L5bu65pawDQo+
Pj4+ICAgU2VudDogTW9uZGF5LCBBcHJpbCAyMSwgMjAwOCA3OjM0IFBNDQo+Pj4+ICAgU3ViamVj
dDogUmU6IE5lZWQgYWRkdGlvbmFsIGluZm8gZm9yIEZpZWxkDQo+Pj4+DQo+Pj4+DQo+Pj4+ICAg
5oKo55qE5Yqf6IO95Y+v5Lul5YaN5riF5qWa5LiA6bue5ZeO77yM5Zug54K65YW25a+m6YCZ5qij
6JmV55CG77yM5aW95YOP6KaB5pa36KmeLi4uLg0KPj4+Pg0KPj4+PiAgIOS9hueci+WIsOaCqOay
kuaWt++8jOiAjOS4lOashOS9jeWQjeeoseS4gOaoo+aYryBtdWx0aS1wYWlyIOWAvOeahOipse+8
jOS4jeaYr+eUqCBTdHJpbmcg5a2Y5ZOmDQo+Pj4+DQo+Pj4+ICAg5Lul5LiKDQo+Pj4+ICAgICAg
ICAgICAgICAgICAgICAgIENocmlzLg0KPj4+Pg0KPj4+Pg0KPj4+PiAgIDIwMDgvNC8yMSwg546L
5bu65pawIDxsaWV1dHJveUBnbWFpbC5jb20+Og0KPj4+PiAgICAg5L2g55yL5b6X5oeC5Lit5paH
5ZCX77yfDQo+Pj4+DQo+Pj4+ICAgICDmiJHkuI3mmK/lvojmmI7nmb3kvaDnmoTmhI/mgJ3jgIIN
Cj4+Pj4gICAgIOS9oOaYr+ivtOWPr+S7peeUqGx1Y2VuZeeOsOacieeahOWKn+iDveadpeino+WG
s+i/meS4qumXrumimOWQl++8nw0KPj4+Pg0KPj4+PiAgICAgICAtLS0tLSBPcmlnaW5hbCBNZXNz
YWdlIC0tLS0tDQo+Pj4+ICAgICAgIEZyb206IENocmlzDQo+Pj4+ICAgICAgIFRvOiDnjovlu7rm
lrANCj4+Pj4gICAgICAgU2VudDogTW9uZGF5LCBBcHJpbCAyMSwgMjAwOCA1OjE0IFBNDQo+Pj4+
ICAgICAgIFN1YmplY3Q6IFJlOiBOZWVkIGFkZHRpb25hbCBpbmZvIGZvciBGaWVsZA0KPj4+Pg0K
Pj4+Pg0KPj4+PiAgICAgICBUaGlzIHByb2JsZW0gaXMgbm90IHNvbHZlIHdpdGggbHVjZW5lIGJ1
dCBvciBtZXRob2Qgd2lsbCBzb2x2ZSBpdC4NCj4+Pj4NCj4+Pj4gICAgICAgVGhlIHN0cnVjdHVy
ZSBpcyBub3QgZGVmaW5lIGFzIHRoaXMgYXMgd2VsbCAuLi4uLi4NCj4+Pj4NCj4+Pj4gICAgICAg
WW91IG1heSBjaGVjayBpdCBjbGVhci4uLi4NCj4+Pj4NCj4+Pj4gICAgICAgYWJvdmUNCj4+Pj4g
ICAgICAgICAgICAgICAgICAgICAgQ2hyaXMuDQo+Pj4+DQo+Pj4+DQo+Pj4+ICAgICAgIDIwMDgv
NC8yMSwg546L5bu65pawIDxsaWV1dHJveUBnbWFpbC5jb20+Og0KPj4+PiAgICAgICAgIGhpIENo
cmlzLCBpdCBpcyBtZSAi546L5bu65pawIg0KPj4+Pg0KPj4+PiAgICAgICAgIEkgaGF2ZSBhIG5l
dyBwcm9ibGVtLCBDb3VsZCB5b3UgZ2l2ZSBtZSBhbnkgYWR2aWNlPyBUaGFuayB5b3UuDQo+Pj4+
DQo+Pj4+DQo+Pj4+ICAgICAgICAgSSB3YW50IHRvIHVzZSBsdWNlbmUgd2l0aCBzb21lIGFkZGl0
aW9uYWwgaW5mbyxsaWtlOg0KPj4+Pg0KPj4+PiAgICAgICAgIDEuaW5kZXgNCj4+Pj4gICAgICAg
ICAgICAgRG9jdW1lbnQgYWRkaXRpb25hbERvYz1ldyBEb2N1bWVudCgpDQo+Pj4+DQo+Pj4+ICAg
ICAgICAgICAgIGFkZGl0aW9uYWxEb2MuYWRkKG5ldyBGaWVsZCgiZmllbGQiLCJBQSBCQiIsIkFk
ZHRpb25hbCBpbmZvIA0KPj4+PiAuLi4uLi4uLi4uLi4uLi4iKSk7DQo+Pj4+ICAgICAgICAgICAg
IGFkZGl0aW9uYWxEb2MuYWRkKG5ldyBGaWVsZCgiZmllbGQiLCJCQiBDQyIsIkFkZHRpb25hbCBp
bmZvIA0KPj4+PiAyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIuLi4uLi4uLi4uLi4uLi4iKSk7DQo+
Pj4+DQo+Pj4+ICAgICAgICAgICAgIHdyaXRlci5hZGREb2N1bWVudChhZGRpdGlvbmFsRG9jKQ0K
Pj4+Pg0KPj4+PiAgICAgICAgICAgICAuLi4uLi4uLg0KPj4+Pg0KPj4+Pg0KPj4+PiAgICAgICAg
IDIuIHNlYXJjaA0KPj4+Pg0KPj4+PiAgICAgICAgICAgICBTZWFyY2hlciBzZWFyY2hlcjsNCj4+
Pj4gICAgICAgICAgICAgLi4uLg0KPj4+Pg0KPj4+PiAgICAgICAgICAgICBzZWFyY2hlci5zZWFy
Y2godGVybVF1ZXJ5KCJmaWVsZCIsIkJCIikpOw0KPj4+Pg0KPj4+Pg0KPj4+Pg0KPj4+Pg0KPj4+
PiAgICAgICAgICAgICBpbiB0aGlzIGNvbmRpdGlvbiwgSSB3YW50IGx1Y2VuZSByZXR1cm5zIHRo
ZSBhZGRpdGlvbmFsRG9jICwgDQo+Pj4+IGFsc28ga25vdyB3aGljaCBmaWxlZHMgd2VyZSBtYXRj
aGVkLCB0aGVuIEkgd2lsbCBnZXQgdGhlIGFkZGl0aW9uYWwgaW5mbyANCj4+Pj4gZnJvbSB0aGUg
bWF0Y2hlZCBmaWVsZHMuDQo+Pj4+DQo+Pj4+ICAgICAgICAgQ2FuIGx1Y2VuZSBtYWtlIGl0IGlu
IHZlcnNpb24gMi4zLjE/DQo+Pj4+DQo+Pj4+DQo+Pj4+DQo+Pj4+ICAgICAgIC0tDQo+Pj4+ICAg
ICAgIENocmlzIExpbg0KPj4+PiAgICAgICBjaHJpc2xpbjA0MjZAZ21haWwuY29tDQo+Pj4+ICAg
ICAgIFRhaXBlaSAsIFRhaXdhbi4NCj4+Pj4gICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4+Pj4NCj4+Pj4NCj4+Pj4NCj4+
Pj4gICAtLQ0KPj4+PiAgIENocmlzIExpbg0KPj4+PiAgIGNocmlzbGluMDQyNkBnbWFpbC5jb20N
Cj4+Pj4gICBUYWlwZWkgLCBUYWl3YW4uDQo+Pj4+ICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4+Pj4NCj4+Pj4gIC0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQ0KPj4+PiAgVG8gdW5zdWJzY3JpYmUsIGUtbWFpbDogamF2YS11c2VyLXVuc3Vic2NyaWJl
QGx1Y2VuZS5hcGFjaGUub3JnDQo+Pj4+ICBGb3IgYWRkaXRpb25hbCBjb21tYW5kcywgZS1tYWls
OiBqYXZhLXVzZXItaGVscEBsdWNlbmUuYXBhY2hlLm9yZw0KPj4+Pg0KPj4+DQo+Pg0KPj4gLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tDQo+PiBUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3Jp
YmVAbHVjZW5lLmFwYWNoZS5vcmcNCj4+IEZvciBhZGRpdGlvbmFsIGNvbW1hbmRzLCBlLW1haWw6
IGphdmEtdXNlci1oZWxwQGx1Y2VuZS5hcGFjaGUub3JnDQo+Pg0KPj4gDQo+IA0KPiAtLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0NCj4gVG8gdW5zdWJzY3JpYmUsIGUtbWFpbDogamF2YS11c2VyLXVuc3Vic2NyaWJlQGx1
Y2VuZS5hcGFjaGUub3JnDQo+IEZvciBhZGRpdGlvbmFsIGNvbW1hbmRzLCBlLW1haWw6IGphdmEt
dXNlci1oZWxwQGx1Y2VuZS5hcGFjaGUub3JnDQo+



From java-user-return-33895-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 04 13:41:02 2008
Return-Path: <java-user-return-33895-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13178 invoked from network); 4 May 2008 13:41:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 4 May 2008 13:41:01 -0000
Received: (qmail 48874 invoked by uid 500); 4 May 2008 13:40:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48828 invoked by uid 500); 4 May 2008 13:40:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48817 invoked by uid 99); 4 May 2008 13:40:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 06:40:55 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Vaijanathrao@aol.com designates 64.12.143.101 as permitted sender)
Received: from [64.12.143.101] (HELO imo-m13.mail.aol.com) (64.12.143.101)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 13:40:09 +0000
Received: from Vaijanathrao@aol.com
	by imo-m13.mx.aol.com (mail_out_v38_r9.4.) id i.c87.2bedf574 (37659);
	Sun, 4 May 2008 09:36:33 -0400 (EDT)
Received: from localhost.localdomain (121.245.22.84.cdma-hyderabad.vsnl.net.in [121.245.22.84]) by cia-mb07.mx.aol.com (v121.5) with ESMTP id MAILCIAMB071-931b481dbbc23d9; Sun, 04 May 2008 09:36:29 -0400
Message-ID: <481DBBB5.3060800@aol.com>
Date: Sun, 04 May 2008 19:05:49 +0530
From: "Vaijanath N. Rao" <vaijanathrao@aol.com>
User-Agent: Thunderbird 2.0.0.12 (X11/20080418)
MIME-Version: 1.0
To: Chris Hostetter <hossman_lucene@fucit.org>
CC: java-user@lucene.apache.org
Subject: Re: Lucene Indexing structure
References: <4812EF79.4050906@aol.com> <Pine.LNX.4.62.0805020847290.27756@radix.cryptio.net>
In-Reply-To: <Pine.LNX.4.62.0805020847290.27756@radix.cryptio.net>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-AOL-IP: 121.245.22.84
X-Mailer: Unknown (No Version)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Flag: NO

Hi Chris,

Sorry for the cross-posting and also for not making clear the problem. 
Let me try to explain the problem at my hand.

I am tying to write a CBIR (Content Based Image Reterival)  frame work 
using lucene. As each document have entities such as title, description, 
author and so on. I am decomposing each image and extracting features 
like color histogram, texture and other important attributes from every 
image and indexing it in lucene such a way that each of this attribute 
is a field. I convert the float values as string for every feature that 
I have extracted from the image.

While searching for similar image I extract the same set of features for 
the query Image and than query lucene to get all those images which have 
atleast one of the features, than I do the re-ranking according to the 
difference of the features. Once the re-ranking is done I submit the 
result.  

Here is where I need help, I need to know an optimal way to store the 
values, so that searching take less time and I don't have to re-ranking. 
Is there any way I can compare array of values rather than one value.  
What I essentially need is to get the query of type, give me all those 
features which are less than K distance from the current feature.

--Thanks and Regagrds
Vaijanath

Chris Hostetter wrote:
> : Hi Lucene-user and Lucene-dev,
>
> Please do not cross post -- java-user is the suitable place for your 
> question.
>
> : Obviously there is something wrong with the above approach (as to get the
> : correct document we need to get all the documents and than do the required
> : distance calculation), but that' due to lack of my knowledge of Luce and
> : lucene's Index storage.
> : 
> : What I want to know how to improve upon the exsisting architecture other than
> : making number of fields in the lucene equalling to total number of
> : feature*size of each feature.
>
> I suspect one of the reasons you haven't gotten much of a response yet is 
> that people may not understand your problem statement -- I know nothing of 
> Image Processing and even after googling "Color Histogram" I don't really 
> understand how the examples you gave represent Color Histograms, or what 
> it would mean to search on it with your example input.
>
> Perhaps you could describe in more detail what exactly some sample 
> data looks like, why certian objects should match certain queries, (and 
> just as importantly: why other objects shouldn't match, and give examples 
> of one one object is a "better" match then another object for each example 
> query.
>
> don't worry about Lucene Document/Field/QueryParse specifics -- just 
> explain the concepts you are dealing with.
>
>
>
> -Hoss
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33896-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 04 15:14:31 2008
Return-Path: <java-user-return-33896-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64868 invoked from network); 4 May 2008 15:14:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 4 May 2008 15:14:31 -0000
Received: (qmail 8972 invoked by uid 500); 4 May 2008 15:14:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8933 invoked by uid 500); 4 May 2008 15:14:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8920 invoked by uid 99); 4 May 2008 15:14:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 08:14:24 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.119] (HELO spunkymail-a6.g.dreamhost.com) (208.97.132.119)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 15:13:39 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a6.g.dreamhost.com (Postfix) with ESMTP id DAE47109F25
	for <java-user@lucene.apache.org>; Sun,  4 May 2008 08:13:51 -0700 (PDT)
Message-Id: <71DA30C5-903F-4EA4-87D4-216ED3F87EE0@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <481DBBB5.3060800@aol.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Lucene Indexing structure
Date: Sun, 4 May 2008 11:13:49 -0400
References: <4812EF79.4050906@aol.com> <Pine.LNX.4.62.0805020847290.27756@radix.cryptio.net> <481DBBB5.3060800@aol.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

Would a Function Query (ValueSourceQuery, see the  
org.apache.lucene.search.function package) work in this case?

-Grant

On May 4, 2008, at 9:35 AM, Vaijanath N. Rao wrote:

> Hi Chris,
>
> Sorry for the cross-posting and also for not making clear the  
> problem. Let me try to explain the problem at my hand.
>
> I am tying to write a CBIR (Content Based Image Reterival)  frame  
> work using lucene. As each document have entities such as title,  
> description, author and so on. I am decomposing each image and  
> extracting features like color histogram, texture and other  
> important attributes from every image and indexing it in lucene such  
> a way that each of this attribute is a field. I convert the float  
> values as string for every feature that I have extracted from the  
> image.
>
> While searching for similar image I extract the same set of features  
> for the query Image and than query lucene to get all those images  
> which have atleast one of the features, than I do the re-ranking  
> according to the difference of the features. Once the re-ranking is  
> done I submit the result.
> Here is where I need help, I need to know an optimal way to store  
> the values, so that searching take less time and I don't have to re- 
> ranking. Is there any way I can compare array of values rather than  
> one value.  What I essentially need is to get the query of type,  
> give me all those features which are less than K distance from the  
> current feature.
>
> --Thanks and Regagrds
> Vaijanath
>
> Chris Hostetter wrote:
>> : Hi Lucene-user and Lucene-dev,
>>
>> Please do not cross post -- java-user is the suitable place for  
>> your question.
>>
>> : Obviously there is something wrong with the above approach (as to  
>> get the
>> : correct document we need to get all the documents and than do the  
>> required
>> : distance calculation), but that' due to lack of my knowledge of  
>> Luce and
>> : lucene's Index storage.
>> : : What I want to know how to improve upon the exsisting  
>> architecture other than
>> : making number of fields in the lucene equalling to total number of
>> : feature*size of each feature.
>>
>> I suspect one of the reasons you haven't gotten much of a response  
>> yet is that people may not understand your problem statement -- I  
>> know nothing of Image Processing and even after googling "Color  
>> Histogram" I don't really understand how the examples you gave  
>> represent Color Histograms, or what it would mean to search on it  
>> with your example input.
>>
>> Perhaps you could describe in more detail what exactly some sample  
>> data looks like, why certian objects should match certain queries,  
>> (and just as importantly: why other objects shouldn't match, and  
>> give examples of one one object is a "better" match then another  
>> object for each example query.
>>
>> don't worry about Lucene Document/Field/QueryParse specifics --  
>> just explain the concepts you are dealing with.
>>
>>
>>
>> -Hoss
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33897-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 04 18:14:19 2008
Return-Path: <java-user-return-33897-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 797 invoked from network); 4 May 2008 18:14:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 4 May 2008 18:14:18 -0000
Received: (qmail 14568 invoked by uid 500); 4 May 2008 18:14:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14540 invoked by uid 500); 4 May 2008 18:14:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14528 invoked by uid 99); 4 May 2008 18:14:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 11:14:13 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 18:13:19 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JsiiS-000346-Ls
	for java-user@lucene.apache.org; Sun, 04 May 2008 11:13:40 -0700
Message-ID: <17049412.post@talk.nabble.com>
Date: Sun, 4 May 2008 11:13:40 -0700 (PDT)
From: DanaWhite <philrymek@comcast.net>
To: java-user@lucene.apache.org
Subject: Lucene's Mean Average Precision
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: philrymek@comcast.net
X-Virus-Checked: Checked by ClamAV on apache.org


Hello all,

I have been doing some evaluation of Lucene on a TReC collection and get a
rather disappointing mean average precision (MAP) of 11%.  Other sources
seem to report a MAP of about 20%.

So I am here to ask all of you who have done some Lucene evaluation - what
did you find Lucene's MAP to be?  Did you do anything to special (e.g. query
expansion) to get it higher?

Thanks
Dana
-- 
View this message in context: http://www.nabble.com/Lucene%27s-Mean-Average-Precision-tp17049412p17049412.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33898-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 04 23:06:57 2008
Return-Path: <java-user-return-33898-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75791 invoked from network); 4 May 2008 23:06:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 4 May 2008 23:06:57 -0000
Received: (qmail 44005 invoked by uid 500); 4 May 2008 23:06:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43955 invoked by uid 500); 4 May 2008 23:06:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43944 invoked by uid 99); 4 May 2008 23:06:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 16:06:52 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=SPF_NEUTRAL,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a1.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 23:06:05 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a1.g.dreamhost.com (Postfix) with ESMTP id 6783610007B
	for <java-user@lucene.apache.org>; Sun,  4 May 2008 16:06:17 -0700 (PDT)
Message-Id: <759605CB-002D-477E-A861-C3D1929BA2E2@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <17049412.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Lucene's Mean Average Precision
Date: Sun, 4 May 2008 19:06:15 -0400
References: <17049412.post@talk.nabble.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

How did you arrive at that MAP?  What analyzers, etc.?  So much of  
search depends on your choices during indexing and querying, etc.   
There is some work by the IBM Haifa people up on the Wiki, so that  
would be one place to check.  Another question is what is your end  
goal is in doing a TREC evaluation?  Are you competing in TREC, or are  
you just trying to get a feel for how Lucene performs?  If it is the  
latter, TREC is just one data point in the relevance sea and you can  
definitely risk overtuning for TREC.  You will definitely need a means  
for evaluating your data set.

And yes, most evals. I have seen pay attention to things like: pseudo  
relevance feedback and other expansion techniques, query construction,  
as well as adjusting Lucene's length normalization (see the Similarity  
class.)  You might also have a look at the contrib/benchmark Quality  
package.  Finally, one of these days, I am hoping we will get some  
TREC collections for use by committers on ASF hardware.  This process  
has been started and hopefully will be available soon.

Cheers,
Grant

On May 4, 2008, at 2:13 PM, DanaWhite wrote:

>
> Hello all,
>
> I have been doing some evaluation of Lucene on a TReC collection and  
> get a
> rather disappointing mean average precision (MAP) of 11%.  Other  
> sources
> seem to report a MAP of about 20%.
>
> So I am here to ask all of you who have done some Lucene evaluation  
> - what
> did you find Lucene's MAP to be?  Did you do anything to special  
> (e.g. query
> expansion) to get it higher?
>
> Thanks
> Dana
> -- 
> View this message in context: http://www.nabble.com/Lucene%27s-Mean-Average-Precision-tp17049412p17049412.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>




--------------------------
Grant Ingersoll

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33899-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 04 23:29:35 2008
Return-Path: <java-user-return-33899-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80490 invoked from network); 4 May 2008 23:29:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 4 May 2008 23:29:35 -0000
Received: (qmail 55341 invoked by uid 500); 4 May 2008 23:29:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55304 invoked by uid 500); 4 May 2008 23:29:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55293 invoked by uid 99); 4 May 2008 23:29:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 16:29:31 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 23:28:37 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JsndZ-00031l-M7
	for java-user@lucene.apache.org; Sun, 04 May 2008 16:28:57 -0700
Message-ID: <17052549.post@talk.nabble.com>
Date: Sun, 4 May 2008 16:28:57 -0700 (PDT)
From: DanaWhite <philrymek@comcast.net>
To: java-user@lucene.apache.org
Subject: Re: Lucene's Mean Average Precision
In-Reply-To: <759605CB-002D-477E-A861-C3D1929BA2E2@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: philrymek@comcast.net
References: <17049412.post@talk.nabble.com> <759605CB-002D-477E-A861-C3D1929BA2E2@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org


I arrived at this MAP by modifying IndexFiles to use a StopAnalyzer and work
in a way that was acceptable for TReC files.  The SearchFiles was modified
to use a StopAnalyzer and output data in a trec_eval suitable format. 
Trec_eval reports about 11% at this setting.

I am not competing in TReC I am just doing an evaluation of different search
engines.

At this point I am not going to add anything to Lucene to get a higher MAP
because I am trying to get a feel for its "out of the box" performance.

Dana

-- 
View this message in context: http://www.nabble.com/Lucene%27s-Mean-Average-Precision-tp17049412p17052549.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33900-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 00:02:37 2008
Return-Path: <java-user-return-33900-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87133 invoked from network); 5 May 2008 00:02:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 00:02:37 -0000
Received: (qmail 63194 invoked by uid 500); 5 May 2008 00:02:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63164 invoked by uid 500); 5 May 2008 00:02:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63151 invoked by uid 99); 5 May 2008 00:02:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 17:02:32 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a17.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 00:01:47 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a17.g.dreamhost.com (Postfix) with ESMTP id 4565475146
	for <java-user@lucene.apache.org>; Sun,  4 May 2008 17:02:01 -0700 (PDT)
Message-Id: <001B8EA8-864A-4DA0-B82A-59B17A9E798A@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <17052549.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Lucene's Mean Average Precision
Date: Sun, 4 May 2008 20:02:00 -0400
References: <17049412.post@talk.nabble.com> <759605CB-002D-477E-A861-C3D1929BA2E2@apache.org> <17052549.post@talk.nabble.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org


On May 4, 2008, at 7:28 PM, DanaWhite wrote:

>
> I arrived at this MAP by modifying IndexFiles to use a StopAnalyzer  
> and work
> in a way that was acceptable for TReC files.  The SearchFiles was  
> modified
> to use a StopAnalyzer and output data in a trec_eval suitable format.
> Trec_eval reports about 11% at this setting.
>
> I am not competing in TReC I am just doing an evaluation of  
> different search
> engines.
>
> At this point I am not going to add anything to Lucene to get a  
> higher MAP
> because I am trying to get a feel for its "out of the box"  
> performance.
>

It's kind of tough to say what an "out of the box" experience is in  
Lucene, so I frankly wouldn't read to much into any numbers you arrive  
at on TREC.   For instance, it is curious that you chose the  
StopAnalyzer over the more "out of the box" StandardAnalyzer.  If  
anything were out of the box, I guess it would be, given the name, the  
StandardAnalyzer, but that isn't too say it will do any better, I  
haven't tried it.  Most studies, have also shown that stemming is  
beneficial, but neither of those analyzers offer stemming.  Remember,  
Lucene really is just the canvas, paint and the brushes, it's up to  
you to do the actual painting.

Just my advice, make sure you are comparing apples to apples, or at  
least as close as you can reasonably get.  I think you will find that  
Lucene stacks up quite well.

Cheers,
Grant

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33901-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 03:39:10 2008
Return-Path: <java-user-return-33901-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63881 invoked from network); 5 May 2008 03:39:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 03:39:10 -0000
Received: (qmail 42613 invoked by uid 500); 5 May 2008 03:39:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42579 invoked by uid 500); 5 May 2008 03:39:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42568 invoked by uid 99); 5 May 2008 03:39:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 20:39:04 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.59] (HELO web50305.mail.re2.yahoo.com) (206.190.38.59)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 05 May 2008 03:38:09 +0000
Received: (qmail 12265 invoked by uid 60001); 5 May 2008 03:38:29 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=6Lac7hBKp8pH+/wAmkqVoq1uvT396Oc+8t5TgnV9avrIndsWIbH2bfW0N4MuoIoT4WDWiiCMSAz57ncWcGo9LakACr9lsVxTcxp6PDSX4TDild+ifitlSd2eJsGMl+4h9gill9G6lR1txO8Fq00PJbc8aG6HJGYcFcG8pgVxMI8=;
X-YMail-OSG: 0SaUnJwVM1n63T2InUf0gI.LMVDNnUAI7SVlGBInsViG_aqsCPgqwv.L4GuNIJwFjPShFkPTbOxR1iZSzGuZSeBtjqEekzeZsAQ_b2M4Lr9nqdzJgBfcMS8nxw--
Received: from [72.231.9.236] by web50305.mail.re2.yahoo.com via HTTP; Sun, 04 May 2008 20:38:29 PDT
X-Mailer: YahooMailRC/902.40 YahooMailWebService/0.7.185
Date: Sun, 4 May 2008 20:38:29 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Lucene's Mean Average Precision
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <621699.11667.qm@web50305.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Dana,

There is no "out of the box" for Lucene, really, especially not when it comes to Analyzers.
For example, look at this post and then the comments: http://blogs.sun.com/searchguy/entry/minion_and_lucene_case_sensitivity

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch

----- Original Message ----
> From: DanaWhite <philrymek@comcast.net>
> To: java-user@lucene.apache.org
> Sent: Sunday, May 4, 2008 7:28:57 PM
> Subject: Re: Lucene's Mean Average Precision
> 
> 
> I arrived at this MAP by modifying IndexFiles to use a StopAnalyzer and work
> in a way that was acceptable for TReC files.  The SearchFiles was modified
> to use a StopAnalyzer and output data in a trec_eval suitable format. 
> Trec_eval reports about 11% at this setting.
> 
> I am not competing in TReC I am just doing an evaluation of different search
> engines.
> 
> At this point I am not going to add anything to Lucene to get a higher MAP
> because I am trying to get a feel for its "out of the box" performance.
> 
> Dana
> 
> -- 
> View this message in context: 
> http://www.nabble.com/Lucene%27s-Mean-Average-Precision-tp17049412p17052549.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33902-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 04:52:03 2008
Return-Path: <java-user-return-33902-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87481 invoked from network); 5 May 2008 04:52:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 04:52:02 -0000
Received: (qmail 82989 invoked by uid 500); 5 May 2008 04:51:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82951 invoked by uid 500); 5 May 2008 04:51:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82940 invoked by uid 99); 5 May 2008 04:51:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 May 2008 21:51:56 -0700
X-ASF-Spam-Status: No, hits=-3.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.108.46] (HELO SUEXCL-02.ad.syr.edu) (128.230.108.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 04:51:08 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
Subject: RE: lucene farsi problem
Date: Mon, 5 May 2008 00:49:46 -0400
Message-ID: <9294E20AED46934EA459020706463F94A04B4C@SUEXCL-02.ad.syr.edu>
In-Reply-To: <17034715.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: lucene farsi problem
Thread-Index: AcitGgG64XUlXqVxR2mkuW8dgbVhqwBUF7xQ
From: "Steven A Rowe" <sarowe@syr.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgRXNyYSwNCg0KSSBoYXZlIGF0dGFjaGVkIGEgcGF0Y2ggdG8gTFVDRU5FLTEyNzkgY29udGFp
bmluZyBhIG5ldyBjbGFzczogQ29sbGF0aW5nUmFuZ2VRdWVyeS4NCg0KVGhlIHBhdGNoIGFsc28g
Y29udGFpbnMgYSB0ZXN0IGNsYXNzOiBUZXN0Q29sbGF0aW5nUmFuZ2VRdWVyeS4gIE9uZSBvZiB0
aGUgdGVzdCBtZXRob2RzIGNoZWNrcyBmb3IgdGhlIEZhcnNpIHJhbmdlIHlvdSB3ZXJlIGhhdmlu
ZyB0cm91YmxlIHdpdGguDQoNCkl0IHNob3VsZCBiZSBtZW50aW9uZWQgdGhhdCBhY2NvcmRpbmcg
dG8gQ29sbGF0b3IuZ2V0QXZhaWxhYmxlTG9jYWxlcygpLCBuZWl0aGVyIEphdmEgMS40LjIgbm9y
IEphdmEgMS41LjAgY29udGFpbnMgRmFyc2kgY29sbGF0aW9uIGluZm9ybWF0aW9uLiAgSG93ZXZl
ciwgaW4gdGhlIHRlc3QgY2xhc3MgSSB1c2UgdGhlIEFyYWJpYyBMb2NhbGUsIHdoaWNoIHNlZW1z
IHRvIHByb3Blcmx5IGNvbGxhdGUgdGhlIG5vbi1BcmFiaWMgRmFyc2kgbGV0dGVyIFUrMDY5OCwg
YW5kIGhvcGVmdWxseSBiZWhhdmVzIHdlbGwgd2l0aCBvdGhlciBGYXJzaSBsZXR0ZXJzLiAgSWYg
eW91IGZpbmQgdGhhdCB0aGlzIGlzIG5vdCB0aGUgY2FzZSwgeW91IGNhbiBsb29rIGludG8gd3Jp
dGluZyBjb2xsYXRpb24gcnVsZXMgdXNpbmcgUnVsZUJhc2VkQ29sbGF0b3IgLSB5b3Ugc2hvdWxk
IGJlIGFibGUgdG8gZGlyZWN0bHkgc3BlY2lmeSB0aGUgcHJvcGVyIGxldHRlciBvcmRlcmluZ3Mg
Zm9yIEZhcnNpOyBDb2xsYXRpbmdSYW5nZVF1ZXJ5IHdvdWxkIGFsc28gaGF2ZSB0byBzdXBwbHkg
YSBjb25zdHJ1Y3RvciB0aGF0IHRha2VzIGluIGEgQ29sbGF0b3IgaW5zdGVhZCBvZiBhIExvY2Fs
ZS4NCg0KUGxlYXNlIGdpdmUgdGhlIGNsYXNzIGEgdHJ5IGFuZCBwb3N0IGJhY2sgYWJvdXQgaG93
IGl0IHdvcmtzLg0KDQpUaGFua3MsDQpTdGV2ZQ0KDQpPbiAwNS8wMy8yMDA4IGF0IDg6MzMgQU0s
IGVzcmEgd3JvdGU6DQo+IA0KPiBIaSBTdGV2ZW4sDQo+IA0KPiB0aGFua3MgZm9yIHlvdXIgaGVs
cC4uLi4NCj4gDQo+IEVzcmENCj4gDQo+IA0KPiBTdGV2ZW4gQSBSb3dlIHdyb3RlOg0KPiA+IA0K
PiA+IEhpIEVzcmEsDQo+ID4gDQo+ID4gSSBoYXZlIGNyZWF0ZWQgYW4gaXNzdWUgZm9yIHRoaXMg
LSBzZWUNCj4gPiA8aHR0cHM6Ly9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJhL2Jyb3dzZS9MVUNFTkUt
MTI3OT4uDQo+ID4gDQo+ID4gSSdsbCB0cnkgdG8gdGFrZSBhIGNyYWNrIGF0IGEgcGF0Y2ggdGhp
cyB3ZWVrZW5kLg0KPiA+IA0KPiA+IFN0ZXZlDQo+ID4gDQo+ID4gT24gMDUvMDIvMjAwOCBhdCAx
Mjo1NSBQTSwgZXNyYSB3cm90ZToNCj4gPiA+IA0KPiA+ID4gSGkgU3RldmVuICwNCj4gPiA+IA0K
PiA+ID4geWVzIHlvdSBhcmUgcmlnaHQsIHNvcnJ5IGkgYW0gYSBiaXQgY29uZnVzZWQuDQo+ID4g
PiANCj4gPiA+IGkgY2hlY2tlZCBhZ2FpbiBhbmQgdGhlIGNvcnJlY3Qgb25lIGlzICAiemhlIi9V
KzY5OC4NCj4gPiA+IA0KPiA+ID4gSXQgc2VlbXMgdGhlIHdvcmQgaXMgaW4gdGhlIHJhbmdlIGJ1
dCBteSBjdXN0b21lciBzYXlzIGl0DQo+ID4gPiBzaG91bGRuJ3QgYmUuDQo+ID4gPiANCj4gPiA+
IEkgdGhpbmsgcHJvYmxlbSBvY2N1cnMgYmVjYXVzZSAgInpoZSIgaXMgYSBQZXJzaWFuIGxldHRl
cg0KPiA+ID4gb3V0c2lkZSB0aGUgQXJhYmljDQo+ID4gPiBhbHBoYWJldC4gSW4gZmFyc2kgYWxw
aGFiZXQgdGhpcyBsZXR0ZXIgaXMgbm90IGFmdGVyIHRoZSAi2LMiDQo+ID4gPiBsZXR0ZXIgYnV0
IGl0J3MNCj4gPiA+IHVuaWNvZGUgaXMgYmlnZ2VyIHRoYW4gItizIiBsZXR0ZXIncyBhbmQgdGhl
IHNlYXJjaGVyIHdvcmtzDQo+ID4gPiB3aXRoIHVuaWNvZGVzLg0KPiA+ID4gDQo+ID4gPiBFc3Jh
DQo+ID4gPiANCj4gPiA+IA0KPiA+ID4gU3RldmVuIEEgUm93ZSB3cm90ZToNCj4gPiA+ID4gDQo+
ID4gPiA+IEhpIEVzcmEsDQo+ID4gPiA+IA0KPiA+ID4gPiBZb3UgYXJlICpzdGlsbCogaW5jb3Jy
ZWN0bHkgcmVmZXJyaW5nIHRvIHRoZSBnbHlwaCB3aXRoIHRocmVlIGRvdHMNCj4gPiA+ID4gb3Zl
ciBpdDoNCj4gPiA+ID4gDQo+ID4gPiA+IE9uIDA1LzAyLzIwMDggYXQgMTI6MTggUE0sIGVzcmEg
d3JvdGU6DQo+ID4gPiA+ID4geWVzIHRoZSBjb3JyZWN0IG9uZSBpcyAi2pggIi8iemUiL1UrNjMy
Lg0KPiA+ID4gPiANCj4gPiA+ID4gItqYIiBpcyAqbm90KiAiemUiL1UrNjMyIC0gaXQgaXMgInpo
ZSIvVSs2OTguDQo+ID4gPiA+IA0KPiA+ID4gPiBIYXZlIHlvdSBpbmNyZWFzZWQgdGhlIGZvbnQg
c2l6ZT8gIENhbiB5b3Ugc2VlIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4NCj4gPiA+ID4gdGhlc2Ug
dHdvPzoNCj4gPiA+ID4gDQo+ID4gPiA+ICLamCIvInpoZSIvVSs2OTgNCj4gPiA+ID4gItiyIi8i
emUiL1UrNjMyDQo+ID4gPiA+IA0KPiA+ID4gPiA+IG15IHByb2JsZW0gaXMgd2hlbiBpIGRvIHNl
YXJjaCBmb3IgICLYry3amCIgcmFuZ2UuIFRoZSByZXN1bHQgaXMgICLYs9in2KgNCj4gPiA+ID4g
PiDZiNmI2YHYsSIgYW5kIHRoaXMgd29yZCdzIGZpcnN0IGxldHRlciBpcyAi2LMiIGFuZCBpdCdz
IHVuaWNvZGUgaXMNCj4gPiA+ID4gPiAiVSs2MzMiIGFuZCBpdCBpcyBub3QgaW4gdGhlIGluIHRo
ZSBbIFUrMDYyRiAtIFUrMDYzMiBdIHJhbmdlLg0KPiA+ID4gPiANCj4gPiA+ID4gTGlrZSBJIGtl
ZXAgc2F5aW5nLCBpbiB0aGUgYWJvdmUgZGVzY3JpcHRpb24sIHlvdSdyZSB1c2luZyB0aGUgZ2x5
cGgNCj4gPiA+ID4gItqYIi8iemhlIi9VKzY5OCwgd2hpbGUgY2FsbGluZyBhdCB0aGUgc2FtZSB0
aW1lIGluY29ycmVjdGx5IHJlZmVycmluZw0KPiA+ID4gPiB0byBpdCBhcyAiemUiL1UrNjMyLg0K
PiA+ID4gPiANCj4gPiA+ID4gSSBkb24ndCBtZWFuIHRvIGNvbnRpbnVhbGx5IGJhbmcgb24gYWJv
dXQgdGhpcyAtIGlmIHlvdSdyZSAqc3VyZSoNCj4gPiA+ID4gdGhhdCB3aGVuIHlvdSBzZWFyY2gs
IHlvdSdyZSB1c2luZyB0aGUgY2hhcmFjdGVyIHJlcHJlc2VudGVkIGJ5IHRoZQ0KPiA+ID4gPiBn
bHlwaCB3aXRoIG9uZSBkb3QgKGFuZCBub3QgdGhyZWUpLCBpLmUuICLYsiIvInplIi9VKzYzMiwg
dGhlbiB0aGUNCj4gPiA+ID4gcHJvYmxlbSBsaWVzIGVsc2V3aGVyZS4NCj4gPiA+ID4gDQo+ID4g
PiA+IFN0ZXZlDQo+ID4gPiA+IA0KPiA+ID4gPiBPbiAwNS8wMi8yMDA4IGF0IDEyOjE4IFBNLCBl
c3JhIHdyb3RlOg0KPiA+ID4gPiA+IHllcyB0aGUgY29ycmVjdCBvbmUgaXMgItqYICIvInplIi9V
KzYzMi4NCj4gPiA+ID4gPiANCj4gPiA+ID4gPiBteSBwcm9ibGVtIGlzIHdoZW4gaSBkbyBzZWFy
Y2ggZm9yICAiICDYry3amCIgcmFuZ2UuIFRoZSByZXN1bHQNCj4gPiA+ID4gPiBpcyAgIiLYs9in
2Kgg2YjZiNmB2LENCj4gPiA+ID4gPiAiIGFuZCB0aGlzIHdvcmQncyBmaXJzdCBsZXR0ZXIgaXMg
ItizICIgYW5kIGl0J3MgdW5pY29kZSBpcw0KPiA+ID4gPiA+ICJVKzYzMyIgIGFuZCAgaXQNCj4g
PiA+ID4gPiBpcyBub3QgaW4gdGhlIGluIHRoZSBbIFUrMDYyRiAtIFUrMDYzMiBdIHJhbmdlLg0K
PiA+ID4gPiA+IA0KPiA+ID4gPiA+IGFtIGkgd3Jvbmc/DQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4g
RXNyYQ0KPiA+ID4gPiA+IA0KPiA+ID4gPiA+IFN0ZXZlbiBBIFJvd2Ugd3JvdGU6DQo+ID4gPiA+
ID4gPiANCj4gPiA+ID4gPiA+IEhpIEVzcmEsDQo+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+IEkg
c3RpbGwgdGhpbmsgeW91J3JlIHdyb25nIDopLg0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiBP
biAwNS8wMi8yMDA4IGF0IDk6MzEgQU0sIGVzcmEgd3JvdGU6DQo+ID4gPiA+ID4gPiA+ID4g2pgg
PSBVKzYzMg0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiBBY2NvcmRpbmcgdG8gdGhlIHdlYnNp
dGUgeW91IGxpbmtlZCB0bywgdGhlIGFib3ZlIGNoYXJhY3Rlciwgd2hpY2gNCj4gPiA+ID4gPiA+
IGhhcyB0aHJlZSBkb3RzIG92ZXIgaXQsIGlzIG5hbWVkICJ6aGUiLCBhbmQgaXRzDQo+IFVuaWNv
ZGUgY29kZSBwb2ludA0KPiA+ID4gaXMNCj4gPiA+ID4gPiA+IFUrNjk4LiAoSSBoYWQgdG8gaW5j
cmVhc2UgdGhlIGZvbnQgc2l6ZSB0byBzZWUgdGhlIHRocmVlIGRvdHMuKQ0KPiA+ID4gPiA+ID4g
DQo+ID4gPiA+ID4gPiBJIHRoaW5rIHlvdSBhcmUgY29uZnVzaW5nICLamCIvInpoZSIvVSs2OTgg
d2l0aCB0aGUgbGV0dGVyDQo+ID4gPiA+ID4gPiAi2LIiLyJ6ZSIvVSs2MzIsIHdoaWNoIGhhcyBq
dXN0IG9uZSBkb3Qgb3ZlciBpdC4NCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gVW5sZXNzIHlv
dSB3ZXJlIG1pc3Rha2VuIGluIGFsbCBvZiB5b3VyIGVtYWlscyB3aGVuDQo+IHlvdSBpbmNsdWRl
ZA0KPiA+ID4gdGhlDQo+ID4gPiA+ID4gPiBjaGFyYWN0ZXIgItqYIi8iemhlIiBpbnN0ZWFkIG9m
ICLYsiIvInplIiwgdGhlbiB3aGF0IEkgc2FpZCBpbiBteQ0KPiA+ID4gPiA+ID4gcHJldmlvdXMg
ZW1haWwgc3RpbGwgc3RhbmRzOiB0aGVyZSBpcyBubyBwcm9ibGVtIGhlcmUuDQo+ID4gPiA+ID4g
PiANCj4gPiA+ID4gPiA+IFN0ZXZlDQo+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+IE9uIDA1LzAy
LzIwMDggYXQgOTozMSBBTSwgZXNyYSB3cm90ZToNCj4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4g
PiA+IEhpIFN0ZXZlbiwNCj4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+IHNvcnJ5IGkgbWFk
ZSBhIG1pc3Rha2UuIHVuaWNvZGVzIGFyZSBsaWtlIHRoaXM6DQo+ID4gPiA+ID4gPiA+IA0KPiA+
ID4gPiA+ID4gPiA+INivPVUrNjJGDQo+ID4gPiA+ID4gPiA+ID4g2pggPSBVKzYzMg0KPiA+ID4g
PiA+ID4gPiA+IGFuZCB0aGUgZmlyc3QgbGV0dGVyIG9mICLYs9in2Kgg2YjZiNmB2LEgIiBpcyAg
2LMgPSBVKzYzMw0KPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4geW91IGNhbiBhbHNvIGNo
ZWNrIHRoZW0gaGVyZQ0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gaHR0cDovL3d3dy51bmljcy51
bmktaGFubm92ZXIuZGUvbmh0Y2FwcmkvcGVyc2lhbi1hbHBoYWJldC5odG1sDQo+ID4gPiA+ID4g
PiA+IA0KPiA+ID4gPiA+ID4gPiBFc3JhDQo+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiAN
Cj4gPiA+ID4gPiA+ID4gU3RldmVuIEEgUm93ZSB3cm90ZToNCj4gPiA+ID4gPiA+ID4gPiANCj4g
PiA+ID4gPiA+ID4gPiBIaSBFc3JhLA0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+
IEdvaW5nIGJhY2sgdG8gdGhlIG9yaWdpbmFsIHByb2JsZW0gc3RhdGVtZW50LCBJDQo+IHNlZSBz
b21ldGhpbmcNCj4gPiA+IHRoYXQNCj4gPiA+ID4gPiA+ID4gPiBsb29rcyBpbGxvZ2ljYWwgdG8g
bWUgLSBwbGVhc2UgY29ycmVjdCBtZSBpZiBJJ20gd3Jvbmc6DQo+ID4gPiA+ID4gPiA+ID4gDQo+
ID4gPiA+ID4gPiA+ID4gT24gQXByIDMwLCAyMDA4LCBhdCAzOjIxIEFNLCBlc3JhIHdyb3RlOg0K
PiA+ID4gPiA+ID4gPiA+ID4gaSBhbSB1c2luZyBsdWNlbmUncyAiSW5kZXhTZWFyY2hlciIgdG8g
c2VhcmNoDQo+IHRoZSBnaXZlbiB4bWwNCj4gPiA+IGJ5DQo+ID4gPiA+ID4gPiA+ID4gPiBrZXl3
b3JkIHdoaWNoIGNvbnRhaW5zIGZhcnNpIGluZm9ybWF0aW9uLg0KPiB3aGlsZSBzZWFyY2hpbmcg
aQ0KPiA+ID4gdXNlDQo+ID4gPiA+ID4gPiA+ID4gPiByYW5nZXMgbGlrZQ0KPiA+ID4gPiA+ID4g
PiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiDYoi3YqyAgfCAg2Kwt2K4gIHwgINivLdqYICB8ICDY
sy3YuCAgfCAg2Lkt2YIgIHwgINqpLdmEICB8ICDZhS3bjA0KPiA+ID4gPiA+ID4gPiA+ID4gDQo+
ID4gPiA+ID4gPiA+ID4gPiB3aGVuIGkgZG8gc2VhcmNoIGZvciAgItivLdqYIiAgcmFuZ2UgdGhl
IHJlc3VsdHMNCj4gYXJlIHdyb25nICwNCj4gPiA+IHRoZXkNCj4gPiA+ID4gPiA+ID4gPiA+IGFy
ZSB0aGUgcmVzdWx0cyBvZiAgIiDYsy3YuCAicmFuZ2UuDQo+ID4gPiA+ID4gPiA+ID4gPiANCj4g
PiA+ID4gPiA+ID4gPiA+IGZvciBleGFtcGxlIHdoZW4gaSBkbyBzZWFyY2ggZm9yICLYry3amCIg
IG9uZSBvZiB0aGUgdGhlIHJlc3VsdHMNCj4gPiA+ID4gPiA+ID4gPiA+IGlzICLYs9in2Kgg2YjZ
iNmB2LEiLCB0aGlzIHJlc3VsdCBhbHNvIHNob3duIG9uIHRoZSAiDQo+INizLdi4ICIgcmFuZ2Un
cw0KPiA+ID4gcmVzdWx0DQo+ID4gPiA+ID4gPiA+ID4gPiBsaXN0IHdoaWNoIGlzIHRoZSBjb3Jy
ZXQgcmFuZ2UuDQo+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+IEFzIEluZGV4
U2VhcmNoZXIgdXNlICJjb21wYXJlVG8iIG1ldGhvZCBhbmQgdGhpcyBtZXRob2QgdXNlcw0KPiA+
ID4gPiA+ID4gPiA+ID4gdW5pY29kZXMgZm9yIGNvbXBhcmluZywgaSBmb3VuZCB0aGUgdW5pY29k
ZXMgb2YgdGhlIGNoYXJhY3RlcnMuDQo+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4g
PiA+INivPVUrNjJGDQo+ID4gPiA+ID4gPiA+ID4gPiDamCA9IFUrNjk4DQo+ID4gPiA+ID4gPiA+
ID4gPiBhbmQgdGhlIGZpcnN0IGxldHRlciBvZiAi2LPYp9ioINmI2YjZgdixICIgaXMgINizID0g
VSs2MzMNCj4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiBJdCBhcHBlYXJzIHRvIG1l
IHRoYXQgKmJvdGgqIHRoZSAi2K8t2pgiIHJhbmdlIFsNCj4gPiA+IFUrMDYyRiAtIFUrMDY5OCBd
DQo+ID4gPiA+ID4gYW5kDQo+ID4gPiA+ID4gPiA+ID4gdGhlICLYsy3YuCIgcmFuZ2UgWyBVKzA2
MzMgLSBVKzA2MzggXSBjb250YWluIHRoZQ0KPiA+ID4gZmlyc3QgbGV0dGVyIG9mDQo+ID4gPiA+
ID4gItiz2KfYqA0KPiA+ID4gPiA+ID4gPiA+INmI2YjZgdixIiwgd2hpY2ggaXMgItizIiA9IFUr
MDYzMy4NCj4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiBZb3Ugc3RhdGVkIHRoYXQg
VSswNjMzIHNob3VsZCBiZSBjb250YWluZWQgaW4gdGhlIFsNCj4gPiA+IFUrMDYzMyAtIFUrMDYz
OA0KPiA+ID4gPiA+IF0NCj4gPiA+ID4gPiA+ID4gPiByYW5nZSAtIEkgYWdyZWUgLSBidXQgd2h5
IGRvIHlvdSB0aGluayBVKzA2MzMgc2hvdWxkIG5vdCBiZQ0KPiA+ID4gPiA+ID4gPiA+IGNvbnRh
aW5lZCBpbiB0aGUgWyBVKzA2MkYgLSBVKzA2OTggXSByYW5nZT8NCj4gPiA+ID4gPiA+ID4gPiAN
Cj4gPiA+ID4gPiA+ID4gPiBJbiBvdGhlciB3b3JkcywgaXQgbG9va3MgdG8gbWUgbGlrZSB5b3Vy
IHByb2JsZW0gaXMNCj4gPiA+IG5vdCBhIHByb2JsZW0NCj4gPiA+ID4gPiBhdA0KPiA+ID4gPiA+
ID4gPiA+IGFsbC4NCj4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiBTdGV2ZQ0KPiA+
ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4g
PiA+ID4gLS0gVmlldyB0aGlzIG1lc3NhZ2UgaW4gY29udGV4dDoNCj4gPiA+ID4gPiA+ID4gDQo+
ID4gPiA+ID4gaHR0cDovL3d3dy5uYWJibGUuY29tL2x1Y2VuZS1mYXJzaS1wcm9ibGVtLXRwMTY5
NzcwOTZwMTcwMTk0OTgNCj4gPiA+ID4gPiAuaHRtbCBTZW50DQo+ID4gPiA+ID4gPiBmcm9tIHRo
ZSBMdWNlbmUgLSBKYXZhIFVzZXJzIG1haWxpbmcgbGlzdCBhcmNoaXZlIGF0IE5hYmJsZS5jb20u
DQo+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gDQo+ID4gPiANCj4gLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tDQo+ID4gPiA+ID4gVG8NCj4gPiA+ID4gPiA+IHVuc3Vic2NyaWJlLCBlLW1haWw6
IGphdmEtdXNlci11bnN1YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZyBGb3INCj4gPiA+ID4gPiA+
IGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDogamF2YS11c2VyLWhlbHBAbHVjZW5lLmFwYWNo
ZS5vcmcNCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4g
DQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+ID4gPiA+
ID4gLS0gVmlldyB0aGlzIG1lc3NhZ2UgaW4gY29udGV4dDoNCj4gPiA+ID4gDQo+IGh0dHA6Ly93
d3cubmFiYmxlLmNvbS9sdWNlbmUtZmFyc2ktcHJvYmxlbS10cDE2OTc3MDk2cDE3MDIyODYxLmh0
bWwNCj4gPiA+ID4gIFNlbnQgZnJvbSB0aGUgTHVjZW5lIC0gSmF2YSBVc2VycyBtYWlsaW5nIGxp
c3QgYXJjaGl2ZSBhdA0KPiA+ID4gTmFiYmxlLmNvbS4NCj4gPiA+ID4gDQo+ID4gPiA+IA0KPiA+
ID4gPiANCj4gPiA+IA0KPiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4gPiA+ID4gIFRvIHVuc3Vic2NyaWJlLCBl
LW1haWw6IGphdmEtdXNlci11bnN1YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZw0KPiA+ID4gPiAg
Rm9yIGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDoNCj4gamF2YS11c2VyLWhlbHBAbHVjZW5l
LmFwYWNoZS5vcmcNCj4gPiA+ID4gDQo+ID4gPiA+IA0KPiA+ID4gPiANCj4gPiA+ID4gDQo+ID4g
PiA+IA0KPiA+ID4gDQo+ID4gPiAtLSBWaWV3IHRoaXMgbWVzc2FnZSBpbiBjb250ZXh0Og0KPiA+
ID4gDQo+IGh0dHA6Ly93d3cubmFiYmxlLmNvbS9sdWNlbmUtZmFyc2ktcHJvYmxlbS10cDE2OTc3
MDk2cDE3MDIzNTU3DQogLmh0bWwgU2VudA0KPiA+IGZyb20gdGhlIEx1Y2VuZSAtIEphdmEgVXNl
cnMgbWFpbGluZyBsaXN0IGFyY2hpdmUgYXQgTmFiYmxlLmNvbS4NCj4gPiANCj4gPiANCj4gPiAt
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0gVG8NCj4gPiB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJz
Y3JpYmVAbHVjZW5lLmFwYWNoZS5vcmcgRm9yDQo+ID4gYWRkaXRpb25hbCBjb21tYW5kcywgZS1t
YWlsOiBqYXZhLXVzZXItaGVscEBsdWNlbmUuYXBhY2hlLm9yZw0KPiA+IA0KPiA+IA0KPiANCj4g
DQo+IA0KPiANCj4gDQogDQogLS0NCiBWaWV3IHRoaXMgbWVzc2FnZSBpbiBjb250ZXh0OiBodHRw
Oi8vd3d3Lm5hYmJsZS5jb20vbHVjZW5lLWZhcnNpLXByb2JsZW0tdHAxNjk3NzA5NnAxNzAzNDcx
NS5odG1sDQogU2VudCBmcm9tIHRoZSBMdWNlbmUgLSBKYXZhIFVzZXJzIG1haWxpbmcgbGlzdCBh
cmNoaXZlIGF0IE5hYmJsZS5jb20uDQogDQogDQogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogVG8gdW5zdWJzY3Jp
YmUsIGUtbWFpbDogamF2YS11c2VyLXVuc3Vic2NyaWJlQGx1Y2VuZS5hcGFjaGUub3JnDQogRm9y
IGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDogamF2YS11c2VyLWhlbHBAbHVjZW5lLmFwYWNo
ZS5vcmcNCg0KIA0KDQo=


From java-user-return-33903-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 16:13:58 2008
Return-Path: <java-user-return-33903-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93487 invoked from network); 5 May 2008 16:13:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 16:13:58 -0000
Received: (qmail 42765 invoked by uid 500); 5 May 2008 16:13:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42730 invoked by uid 500); 5 May 2008 16:13:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42719 invoked by uid 99); 5 May 2008 16:13:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 09:13:53 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [65.217.211.134] (HELO mal002ex.ccrn.com) (65.217.211.134)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 16:13:06 +0000
Received: from boc002ex.ccrn.com ([172.31.10.29]) by mal002ex.ccrn.com with Microsoft SMTPSVC(6.0.3790.211);
	 Mon, 5 May 2008 12:13:18 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----_=_NextPart_001_01C8AECA.EE066CB4"
Subject: Search Order
Date: Mon, 5 May 2008 12:12:48 -0400
Message-ID: <FD98FC13DC8A8A40BBA504AE516F96AE12B092A3@boc002ex.ccrn.com>
In-Reply-To: <621699.11667.qm@web50305.mail.re2.yahoo.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Search Order
Thread-Index: AciuYcnxpdBoh/BgQy21oUxg8dUjIwAaF5Nw
References: <621699.11667.qm@web50305.mail.re2.yahoo.com>
From: "Prashant Saraf" <psaraf@cctc.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 05 May 2008 16:13:18.0540 (UTC) FILETIME=[EE5788C0:01C8AECA]
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C8AECA.EE066CB4
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64

SGksDQpJIGFtIGNyZWF0aW5nIGEga2V5d29yZCBiYXNlZCBzZWFyY2ggZW5naW5lLiBOb3cgSSBh
bSBhYmxlIHRvIHNlYXJjaCB0aGUgcmVxdWlyZWQgZGF0YS4gTm93LCBJIG5vdGljZSB0aGF0IHRo
ZSBkYXRhIGNvbWluZyBpcyBpbiByYW5kb20gb3JkZXIuIElzIHRoZXJlIGFueSB3YXkgSSBjYW4g
Y2FsbCBwYXJ0aWN1bGFyIHJlY29yZCAxc3QuIEkgaGF2ZSBhbiBleGFtcGxlLiBTdXBwb3NlIEkg
bSB3b3JraW5nIG9uIHNlYXJjaCBvZiBCb29rIGNvbnRlbnQsIHdyaXRlciwgcHVibGljYXRpb24u
IE5vdyBpZiBJIGVudGVyIG5hbWUgb2YgdGl0bGUgb2YgYm9vayBzYXkgamF2YSwgYnV0IGlmIHRo
ZXJlIGlzIGFub3RoZXIgYm9vayB3aG8gaGFzIGNvbnRlbnQgYXMgd29yZCBKYXZhIENvZmZlZSBu
b3cgaXQgaXMgc2hvd2luZyB0aGF0IEJvb2sgb2YgY29mZmVlIGZpcnN0LiBIb3cgdG8gc29sdmUg
dGhpcyBwcm9ibGVtLg0KDQoNClRoYW5rcyBhbmQgUmVnYXJkcw0KICAgICAgIOCkquCljeCksOCk
tuCkvuCkguCkpCDgpLjgpLDgpL7gpKsNCihQcmFzaGFudCBTYXJhZikNClNFLUlJDQpDcm9zcyBD
b3VudHJ5IEluZm90ZWNoDQpFeHQgOiA3MjU0Mw0Kd3d3LmNyb3NzY291bnRyeS5pbg0KDQo=


------_=_NextPart_001_01C8AECA.EE066CB4
Content-Type: text/plain; charset=us-ascii

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
------_=_NextPart_001_01C8AECA.EE066CB4--

From java-user-return-33904-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 17:38:22 2008
Return-Path: <java-user-return-33904-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29087 invoked from network); 5 May 2008 17:38:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 17:38:22 -0000
Received: (qmail 57602 invoked by uid 500); 5 May 2008 17:38:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57567 invoked by uid 500); 5 May 2008 17:38:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57521 invoked by uid 99); 5 May 2008 17:38:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 10:38:20 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.189 as permitted sender)
Received: from [209.85.128.189] (HELO fk-out-0910.google.com) (209.85.128.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 17:37:34 +0000
Received: by fk-out-0910.google.com with SMTP id 18so771802fkq.5
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 10:37:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=fsiazH65D4Y9SKke8UxgVZqD1vvhRqXWxK370A3rRpU=;
        b=PaNLn1FYcFY2KUDfFhTstkgbmzn51vK1e7BtQWjquPOrBjoxUPuMHAiQ+LSAx8u7oeai46ext+4oPwOY3mGvtGASGyvKoqDipLP2Y+eYsEdUHQwa7Xq4skuTHcT7D7mo1Zvpj/55dGicpU5+l57iJDR8C+Ra5/OjtXknN1H7Em0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=n2rf1BwTx5pcjSiXHEvnUyTRrehETrYDPoJvwKIGHFTRtD1a06KdvYt+t1jB0NozRxRBu0u89dYDCXd6UUR3ZYlXkmWmL6StXRSEYJmsK1T/6HL2rilQoOvCQByKMhmit3/drj1vlrTAG2YgEQBUHfEkmdGwmCTiIU7LwZVUl64=
Received: by 10.82.187.8 with SMTP id k8mr598159buf.3.1210009066284;
        Mon, 05 May 2008 10:37:46 -0700 (PDT)
Received: by 10.82.151.7 with HTTP; Mon, 5 May 2008 10:37:46 -0700 (PDT)
Message-ID: <359a92830805051037q24958127rbc5b52a4bfb7ce9b@mail.gmail.com>
Date: Mon, 5 May 2008 13:37:46 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Search Order
In-Reply-To: <FD98FC13DC8A8A40BBA504AE516F96AE12B092A3@boc002ex.ccrn.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_13527_29879377.1210009066270"
References: <621699.11667.qm@web50305.mail.re2.yahoo.com>
	 <FD98FC13DC8A8A40BBA504AE516F96AE12B092A3@boc002ex.ccrn.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_13527_29879377.1210009066270
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
Content-Disposition: inline

V2VsbCwgaXQgYWxsIGRlcGVuZHMgdXBvbiB3aGF0IHlvdSBtZWFuIGJ5IHByb2JsZW0uIEx1Y2Vu
ZSBpcyBub3QgcmV0dXJuaW5nCnRoaW5ncyBpbiByYW5kb20gb3JkZXIsIGl0J3MgcmV0dXJuaW5n
IHRoaW5ncyBpbiByZWxldmFuY2Ugb3JkZXIuIFRoZXJlIGlzCmEgbG90IG9mIGRpc2N1c3Npb24g
YWJvdXQgc2NvcmluZyBib3RoIG9uIHRoZSBXaWtpIGFuZCBpbiB0aGUgbWFpbCBhcmNoaXZlCmlm
IHlvdSB3YW50IHRvIGFmZmVjdCB0aGUgcmV0dXJuIG9yZGVyLgoKQWx0ZXJuYXRpdmVseSwgeW91
IGNhbiBzb3J0IHlvdXIgcmVzdWx0cyBieSBwcm92aWRpbmcgdGhlIHNlYXJjaCB3aXRoCmEgU29y
dCBvYmplY3QsIHNlZSB0aGUgQVBJIGRvY3VtZW50YXRpb24uIEJ1dCBzb3J0IG9ubHkgd29ya3MK
b24gVU5fVE9LRU5JWkVELCBzaW5nbGUtdG9rZW4gZmllbGRzIHNvIHRoYXQgbWF5IG5vdCBiZSB3
aGF0CnlvdSB3YW50LgoKWW91IGNhbiBhbHNvIHVzZSBvbmUgb2YgdGhlIEhpdENvbGxlY3RvcnMg
YW5kIHNvcnQgdGhlIHJlc3VsdHMKeW91cnNlbGYgaWYgeW91IHNvIGNob29zZS4KCllvdSBjYW4g
YWxzbyB3b3JrIHdpdGggYm9vc3RzIG9uIHRoZSBzZWFyY2ggdG8sIHNheSwgbWFrZSBtYXRjaGVz
CmluIHRoZSB0aXRsZSBmaWVsZCBjb3VudCBtb3JlIHdoZW4gY29tcHV0aW5nIHJlbGV2YW5jZSB0
aGFuLCBzYXksIHRleHQuCgpZb3UgY2FuIGFsc28gYm9vc3QgZG9jdW1lbnRzIGF0ICppbmRleCog
dGltZSBpZiB5b3UgY2FuIHNheSB0aGF0CnBhcnRpY3VsYXIgZG9jdW1lbnRzIHNob3VsZCB0ZW5k
IHRvd2FyZCB0aGUgdG9wIG9mIHJlbGV2YW5jZSBzZWFyY2hlcy4KCklmIHlvdSdkIGV4cGxhaW4g
YSBiaXQgbW9yZSB3aGF0IHlvdSB3YW50IHRvIGFjY29tcGxpc2gsIHBlcmhhcHMgZm9sa3MKY2Fu
IHN1Z2dlc3QgbW9yZSBjb25jcmV0ZSBhY3Rpb25zLiBXaHksIGZvciBpbnN0YW5jZSwgaXMgc29y
dGluZyBieQpyZWxldmFuY2Ugbm90IGFwcHJvcHJpYXRlPyBIYXZlIHlvdSBpbmRleGVkIGV2ZXJ5
dGhpbmcgaW4geW91ciBleGFtcGxlCmluIGp1c3QgYSBiaWcgYmFnIG9mIHdvcmRzIG9yIGhhdmUg
eW91IGluZGV4ZWQgc2VwYXJhdGUgZmllbGRzPwoKQmVzdApFcmljawoKT24gTW9uLCBNYXkgNSwg
MjAwOCBhdCAxMjoxMiBQTSwgUHJhc2hhbnQgU2FyYWYgPHBzYXJhZkBjY3RjLmNvbT4gd3JvdGU6
Cgo+IEhpLAo+IEkgYW0gY3JlYXRpbmcgYSBrZXl3b3JkIGJhc2VkIHNlYXJjaCBlbmdpbmUuIE5v
dyBJIGFtIGFibGUgdG8gc2VhcmNoIHRoZQo+IHJlcXVpcmVkIGRhdGEuIE5vdywgSSBub3RpY2Ug
dGhhdCB0aGUgZGF0YSBjb21pbmcgaXMgaW4gcmFuZG9tIG9yZGVyLiBJcwo+IHRoZXJlIGFueSB3
YXkgSSBjYW4gY2FsbCBwYXJ0aWN1bGFyIHJlY29yZCAxc3QuIEkgaGF2ZSBhbiBleGFtcGxlLiBT
dXBwb3NlIEkKPiBtIHdvcmtpbmcgb24gc2VhcmNoIG9mIEJvb2sgY29udGVudCwgd3JpdGVyLCBw
dWJsaWNhdGlvbi4gTm93IGlmIEkgZW50ZXIKPiBuYW1lIG9mIHRpdGxlIG9mIGJvb2sgc2F5IGph
dmEsIGJ1dCBpZiB0aGVyZSBpcyBhbm90aGVyIGJvb2sgd2hvIGhhcyBjb250ZW50Cj4gYXMgd29y
ZCBKYXZhIENvZmZlZSBub3cgaXQgaXMgc2hvd2luZyB0aGF0IEJvb2sgb2YgY29mZmVlIGZpcnN0
LiBIb3cgdG8KPiBzb2x2ZSB0aGlzIHByb2JsZW0uCj4KPgo+IFRoYW5rcyBhbmQgUmVnYXJkcwo+
ICAgICAgIOCkquCljeCksOCktuCkvuCkguCkpCDgpLjgpLDgpL7gpKsKPiAoUHJhc2hhbnQgU2Fy
YWYpCj4gU0UtSUkKPiBDcm9zcyBDb3VudHJ5IEluZm90ZWNoCj4gRXh0IDogNzI1NDMKPiB3d3cu
Y3Jvc3Njb3VudHJ5LmluCj4KPgo+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo+IFRvIHVuc3Vic2NyaWJlLCBlLW1h
aWw6IGphdmEtdXNlci11bnN1YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZwo+IEZvciBhZGRpdGlv
bmFsIGNvbW1hbmRzLCBlLW1haWw6IGphdmEtdXNlci1oZWxwQGx1Y2VuZS5hcGFjaGUub3JnCj4K
------=_Part_13527_29879377.1210009066270--

From java-user-return-33905-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 17:39:21 2008
Return-Path: <java-user-return-33905-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29243 invoked from network); 5 May 2008 17:39:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 17:39:21 -0000
Received: (qmail 60302 invoked by uid 500); 5 May 2008 17:39:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60262 invoked by uid 500); 5 May 2008 17:39:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60251 invoked by uid 99); 5 May 2008 17:39:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 10:39:15 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [68.142.237.109] (HELO n2.bullet.mail.re3.yahoo.com) (68.142.237.109)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 05 May 2008 17:38:19 +0000
Received: from [68.142.230.28] by n2.bullet.mail.re3.yahoo.com with NNFMP; 05 May 2008 09:32:31 -0000
Received: from [66.196.97.153] by t1.bullet.re2.yahoo.com with NNFMP; 05 May 2008 17:38:35 -0000
Received: from [127.0.0.1] by omp206.mail.re3.yahoo.com with NNFMP; 05 May 2008 17:38:35 -0000
X-Yahoo-Newman-Id: 412436.10205.bm@omp206.mail.re3.yahoo.com
Received: (qmail 77622 invoked from network); 5 May 2008 17:38:35 -0000
Received: from unknown (HELO ?192.168.1.150?) (nhira@cognocys.com@69.136.240.12 with plain)
  by smtp107.plus.mail.re1.yahoo.com with SMTP; 5 May 2008 17:38:34 -0000
X-YMail-OSG: kdz5REMVM1lhwhorolIx8KlA9CuKw6FMjvGOfVwTG9eMwmE6PJ96cDxjf27Pb9lcmBpqTo4k3THDjf5eYbvSXP4V.JZqTk3Ndr1PsKlfNYk46NjJJ.LP7FJNtqUHeUjPTgKXsX5vnwcJPBujhVQFjhwZ
X-Yahoo-Newman-Property: ymail-3
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <FD98FC13DC8A8A40BBA504AE516F96AE12B092A3@boc002ex.ccrn.com>
References: <621699.11667.qm@web50305.mail.re2.yahoo.com> <FD98FC13DC8A8A40BBA504AE516F96AE12B092A3@boc002ex.ccrn.com>
Content-Type: text/plain; charset=UTF-8; delsp=yes; format=flowed
Message-Id: <8450933A-B2CC-4D03-AC29-EA5B645B3B88@cognocys.com>
Content-Transfer-Encoding: quoted-printable
From: "N. Hira" <nhira@cognocys.com>
Subject: Re: Search Order
Date: Mon, 5 May 2008 12:38:22 -0500
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org

Please review:
http://wiki.apache.org/lucene-java/LuceneFAQ

I suspect your question is answered as:
> How do I make sure that a match in a document title has greater =20
> weight than than a match in a document body?


-h

----------------------------------------------------------------------
Hira, N.R.
Solutions Architect
Cognocys, Inc.
(773) 251-7453

On 05-May-2008, at 11:12 AM, Prashant Saraf wrote:

> Hi,
> I am creating a keyword based search engine. Now I am able to =20
> search the required data. Now, I notice that the data coming is in =20
> random order. Is there any way I can call particular record 1st. I =20
> have an example. Suppose I m working on search of Book content, =20
> writer, publication. Now if I enter name of title of book say java, =20=

> but if there is another book who has content as word Java Coffee =20
> now it is showing that Book of coffee first. How to solve this =20
> problem.
>
>
> Thanks and Regards
>        =E0=A4=AA=E0=A5=8D=E0=A4=B0=E0=A4=B6=E0=A4=BE=E0=A4=82=E0=A4=A4 =
=E0=A4=B8=E0=A4=B0=E0=A4=BE=E0=A4=AB
> (Prashant Saraf)
> SE-II
> Cross Country Infotech
> Ext : 72543
> www.crosscountry.in
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33906-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 17:39:37 2008
Return-Path: <java-user-return-33906-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29299 invoked from network); 5 May 2008 17:39:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 17:39:37 -0000
Received: (qmail 61891 invoked by uid 500); 5 May 2008 17:39:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61865 invoked by uid 500); 5 May 2008 17:39:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61854 invoked by uid 99); 5 May 2008 17:39:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 10:39:32 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lucene@nitwit.de designates 80.67.29.8 as permitted sender)
Received: from [80.67.29.8] (HELO smtprelay08.ispgateway.de) (80.67.29.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 17:38:39 +0000
Received: from [85.178.228.108] (helo=server.localdomain)
	by smtprelay08.ispgateway.de with esmtps (TLSv1:AES256-SHA:256)
	(Exim 4.68)
	(envelope-from <lucene@nitwit.de>)
	id 1Jt4eS-0002RP-8y
	for java-user@lucene.apache.org; Mon, 05 May 2008 19:39:00 +0200
Received: from localhost (localhost [127.0.0.1])
	by server.localdomain (Postfix) with ESMTP id D5F8B6FDBB1
	for <java-user@lucene.apache.org>; Mon,  5 May 2008 19:38:59 +0200 (CEST)
From: Timo Nentwig <lucene@nitwit.de>
To: java-user@lucene.apache.org
Subject: @todo parallelize this one too
Date: Mon, 5 May 2008 19:38:59 +0200
User-Agent: KMail/1.9.7
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805051938.59594.lucene@nitwit.de>
X-Df-Sender: [pbs]153383
X-Virus-Checked: Checked by ClamAV on apache.org

Hi!

Unfortunately the search method in ParallelMultiSearcher which is able to take 
an HitCollector isn't running in parallel and there' even an issue regarding 
this (LUCENE-990) with zero watchers or votes :-\

So this isn't something that's likely to be done in near future, is it?

And question #2: what's the problem parallizing this one actually? Naively I 
would simply run the queries in multiple threads and OR the resulting BitSets 
(well, which is a implementation detail and not part of the HitCollector 
API...). And I must admit that I don't know what this scorer.score(reader) in 
the corresponding method in IndexSearcher really does actually...

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33907-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 19:34:38 2008
Return-Path: <java-user-return-33907-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83009 invoked from network); 5 May 2008 19:34:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 19:34:38 -0000
Received: (qmail 22825 invoked by uid 500); 5 May 2008 19:34:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22802 invoked by uid 500); 5 May 2008 19:34:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22791 invoked by uid 99); 5 May 2008 19:34:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 12:34:32 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.132.247 as permitted sender)
Received: from [209.85.132.247] (HELO an-out-0708.google.com) (209.85.132.247)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 19:33:46 +0000
Received: by an-out-0708.google.com with SMTP id c37so620133anc.49
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 12:34:00 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=sjIg7YSycmi1VdOzB5iJn1wnwwpo249WmKY4JoVJfl8=;
        b=J6xpat6lfzsdWbzNPFSfi6hKmtAooy6franckVihUMKHjVxrEuj/S0QfqvCqUecMJlA83wN6MGha/u6qsXtWsBS+WWI5YVJtmExFrg4ElI8JjtARDRMWv+kn834VjjIO2T7eY9aRnuExj15QiP33ywoANyJlBT+0z0kIt1ftHqQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=subject:from:to:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=iCGtGnoIF/Z+hohMq31eJ/b+wekuBkq6RSOuJeiMKaFmy0fb5LAtzzFM/NAqtxRHv05aN1ac6OEGgwPTYD7RCmKThR9g5bDLnLKM3WOZm0PNUSVYOkw/6QOC7DEHyanwhm0waktbqpGVxhiUIMf6lZ3qc6dXFGjYfMVSNDxFlPE=
Received: by 10.100.111.5 with SMTP id j5mr8223166anc.112.1210016040292;
        Mon, 05 May 2008 12:34:00 -0700 (PDT)
Received: from ?172.20.3.139? ( [204.126.80.110])
        by mx.google.com with ESMTPS id c23sm12122059ana.18.2008.05.05.12.33.58
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 12:33:58 -0700 (PDT)
Subject: index corruption with latest lucene
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Date: Mon, 05 May 2008 15:33:57 -0400
Message-Id: <1210016037.11339.7.camel@m-laptop>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.1 
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Any recent changes that would expose index corruption?

I am getting two new errors when trying to search:

nullpointer fieldsreaders line 260

indexoutofbounds on fieldinfo line 185

I am kind of screwed, because reindexing fixes this, but I cant reindex!

Any ideas?


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33908-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 19:42:20 2008
Return-Path: <java-user-return-33908-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87104 invoked from network); 5 May 2008 19:42:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 19:42:20 -0000
Received: (qmail 31992 invoked by uid 500); 5 May 2008 19:42:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31744 invoked by uid 500); 5 May 2008 19:42:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31730 invoked by uid 99); 5 May 2008 19:42:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 12:42:15 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.132.248 as permitted sender)
Received: from [209.85.132.248] (HELO an-out-0708.google.com) (209.85.132.248)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 19:41:29 +0000
Received: by an-out-0708.google.com with SMTP id c37so620820anc.49
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 12:41:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=0ycpiWseBTd6rEp5odn7Oy9CcKGnd746f7z+WqcJWWE=;
        b=WtqXIupWTRKXdtnlnrwxUqZvQyr8EnqPHfBp2l2D8fPuiK3EW2uymn1ZHZ26z46Ie9fjWsz83obE4/TrTOB2Rw+FEGiWUwXh2WbcBLVwW+LlZ0w3hh797ho6HbbWaXtnNLSi4IKaK42Nt03tus1guYkH/zEK2Ms9lMY0hzZr4Cw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=subject:from:to:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=AxJlQI2aZAHon/YWXqA2W01wHFgUhu36aP4ApiI70e2qsA9k006yaHPWaRh2ZSUnqqCE3m69XaYcIRHAv4CE1qL6hKD4kTG/if1S2B1p0PtEMn0Rnkr/2a/cozTFNIu8BJpdVbRo1yL2DcK06FOCQUUPaUq31jtypUJ9Y2N2btc=
Received: by 10.100.93.12 with SMTP id q12mr8194425anb.157.1210016503007;
        Mon, 05 May 2008 12:41:43 -0700 (PDT)
Received: from ?172.20.3.139? ( [204.126.80.110])
        by mx.google.com with ESMTPS id b19sm12054182ana.19.2008.05.05.12.41.41
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 12:41:42 -0700 (PDT)
Subject: index corruption with latest lucene
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Date: Mon, 05 May 2008 15:41:41 -0400
Message-Id: <1210016501.11339.10.camel@m-laptop>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.1 
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Last message had a type...I reversed line numbers fields...trying
again:

Any recent changes that would expose index corruption?

I am getting two new errors when trying to search:

nullpointer fieldsreaders line 185

indexoutofbounds on fieldinfo line 260

I am kind of screwed, because reindexing fixes this, but I cant reindex!

Any ideas?

P.S.

I cant go back to other lucene due to index version.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33909-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 19:49:49 2008
Return-Path: <java-user-return-33909-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92369 invoked from network); 5 May 2008 19:49:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 19:49:49 -0000
Received: (qmail 42061 invoked by uid 500); 5 May 2008 19:49:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42036 invoked by uid 500); 5 May 2008 19:49:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42025 invoked by uid 99); 5 May 2008 19:49:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 12:49:42 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of crspan@gmail.com designates 66.249.82.227 as permitted sender)
Received: from [66.249.82.227] (HELO wx-out-0506.google.com) (66.249.82.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 19:48:56 +0000
Received: by wx-out-0506.google.com with SMTP id h29so204664wxd.20
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 12:49:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=wxabk1aD13h2Lq0b5T9jPOH6twPYSuOaqHFrGlwefb0=;
        b=NiyWpw3V9EoNbTEex1oNL5FCdI2uTZTFUxf7GdvLQra5xlKzJtz2XYkDodIvtW10WlmmBiC5wbjIvElcnql2kCrwvCkSBcEWjnbm2yehdPOaCYZSmPlI6YbblE9MQzRYqssUkgx7W+mSBsoSBkOFo1LofxwMbmxihT4Qff+9mw8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=BeQypGaNKGA8OMOn26p9ISnYAyNh5CAtGhnbzlrIz8Z48ZiM/CvyAsxWoYImFnL7A2xuXD+P+ic+DkrqBd9/bfEQhoHJi4AbgVvwHEyH8HR3ZSUDCpUBBSbD+XQX+QSMCdiLBoxUgWqMvj7yVid18udLkV3qj8PBjPTKW1P9u30=
Received: by 10.90.68.3 with SMTP id q3mr6982962aga.15.1210016950493;
        Mon, 05 May 2008 12:49:10 -0700 (PDT)
Received: from ?192.168.168.3? ( [72.179.149.134])
        by mx.google.com with ESMTPS id c29sm11110028elf.9.2008.05.05.12.49.09
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 12:49:09 -0700 (PDT)
Message-ID: <481F64A9.6040808@gmail.com>
Date: Mon, 05 May 2008 14:48:57 -0500
From: crspan <crspan@gmail.com>
User-Agent: Thunderbird 2.0.0.12 (Windows/20080213)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: index corruption with latest lucene
References: <1210016037.11339.7.camel@m-laptop>
In-Reply-To: <1210016037.11339.7.camel@m-laptop>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

coincidence or it is from 2.3.2 ?

env:
lucene 2.3.2
jdk1.6.0_06 & jdk1.5.0_15


QueryString:
illeg^30.820824 technolog^22.290413 transfer^33.307804
Error: java.lang.ArrayIndexOutOfBoundsException: 
132704java.lang.ArrayIndexOutOfBoundsException: 132704
at 
org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor(BooleanScorer2.java:55)
at org.apache.lucene.search.BooleanScorer2.score(BooleanScorer2.java:358)
at org.apache.lucene.search.BooleanScorer2.score(BooleanScorer2.java:320)
at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:146)
at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:113)
at org.apache.lucene.search.Searcher.search(Searcher.java:132)
at 
org.cr.search.TrecQueryRelevanceFeedback.main(TrecQueryRelevanceFeedback.java:776)


QueryString:
oceanograph^68.48028 vessel^43.191563
Error: 
java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBoundsException
at java.lang.System.arraycopy(Native Method)
at 
org.apache.lucene.index.TermVectorsReader.readTermVector(TermVectorsReader.java:353)
at 
org.apache.lucene.index.TermVectorsReader.readTermVectors(TermVectorsReader.java:287)
at org.apache.lucene.index.TermVectorsReader.get(TermVectorsReader.java:232)
at 
org.apache.lucene.index.SegmentReader.getTermFreqVectors(SegmentReader.java:981)
at org.cr.rf.RelevanceFeedback.RelFeedbackWeight(RelevanceFeedback.java:134)
at 
org.cr.search.TrecQueryRelevanceFeedback.main(TrecQueryRelevanceFeedback.java:781)




Mark Miller wrote:
> Any recent changes that would expose index corruption?
>
> I am getting two new errors when trying to search:
>
> nullpointer fieldsreaders line 260
>
> indexoutofbounds on fieldinfo line 185
>
> I am kind of screwed, because reindexing fixes this, but I cant reindex!
>
> Any ideas?
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33910-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 19:57:29 2008
Return-Path: <java-user-return-33910-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96565 invoked from network); 5 May 2008 19:57:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 19:57:29 -0000
Received: (qmail 56637 invoked by uid 500); 5 May 2008 19:57:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56477 invoked by uid 500); 5 May 2008 19:57:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56466 invoked by uid 99); 5 May 2008 19:57:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 12:57:21 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 64.233.184.235 as permitted sender)
Received: from [64.233.184.235] (HELO wr-out-0506.google.com) (64.233.184.235)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 19:56:35 +0000
Received: by wr-out-0506.google.com with SMTP id c30so1345056wra.14
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 12:56:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=iXHvo7NDZ1dli6l2TmoLAFK7QtFOytDCiyoYuzgWqGU=;
        b=fwvg3S4H3zO6qpA1Qs4ovNk202QG9QcAu0ZDYiXhh2TXB11+jpWMRW5Va/MZOEq+nsbVyVCj6ocK9GUCN+o+kofxtxV4XeJ63p0puEW9kT/VQPnSCzNZQSrALFjpBKUO18yN7ztWQ8jGDdJ0KAjJ7gPL8drNgdK5pYV/2g3OPPc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=eciX4AbxgI8+S5Re3QErWJxHaJX7XqpCIiHMq+Ulpgc1782bFWSaGqh4Z2/c3VyqW/PJywrgFn5t2Jymm8s+TsTGKNhRr9ETgrpedR92WpW0pXXiFuJJPEtLxutDuXHEKvM7RTnd92gYvV/6O3ttwodkHCHpoRvdF6fwQaPb/NQ=
Received: by 10.100.46.10 with SMTP id t10mr8237203ant.156.1210017409157;
        Mon, 05 May 2008 12:56:49 -0700 (PDT)
Received: from ?172.20.3.139? ( [204.126.80.110])
        by mx.google.com with ESMTPS id d19sm12146717and.17.2008.05.05.12.56.48
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 12:56:48 -0700 (PDT)
Subject: Re: index corruption with latest lucene
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <481F64A9.6040808@gmail.com>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com>
Content-Type: text/plain; charset=utf-8
Date: Mon, 05 May 2008 15:56:47 -0400
Message-Id: <1210017407.11339.16.camel@m-laptop>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.1 
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Yeah, its pretty close to 2.3.2, but I think from last week mabye.

I finally have one of the stack traces (this comes on the tail complete
laptop failure so I am scrambling here)

java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
        at java.util.ArrayList.RangeCheck(ArrayList.java:572)
        at java.util.ArrayList.get(ArrayList.java:347)
        at org.apache.lucene.index.FieldInfos.fieldInfo(FieldInfos.java:260)
        at org.apache.lucene.index.FieldsReader.doc(FieldsReader.java:184)
        at org.apache.lucene.index.SegmentReader.document(SegmentReader.java:670)
        at org.apache.lucene.index.MultiSegmentReader.document(MultiSegmentReader.java:257)
        at org.apache.lucene.search.IndexSearcher.doc(IndexSearcher.java:97)

On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
> coincidence or it is from 2.3.2 ?
> 
> env:
> lucene 2.3.2
> jdk1.6.0_06 & jdk1.5.0_15
> 
> 
> QueryString:
> illeg^30.820824 technolog^22.290413 transfer^33.307804
> Error: java.lang.ArrayIndexOutOfBoundsException: 
> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
> at 
> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor(BooleanScorer2.java:55)
> at org.apache.lucene.search.BooleanScorer2.score(BooleanScorer2.java:358)
> at org.apache.lucene.search.BooleanScorer2.score(BooleanScorer2.java:320)
> at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:146)
> at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:113)
> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
> at 
> org.cr.search.TrecQueryRelevanceFeedback.main(TrecQueryRelevanceFeedback.java:776)
> 
> 
> QueryString:
> oceanograph^68.48028 vessel^43.191563
> Error: 
> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBoundsException
> at java.lang.System.arraycopy(Native Method)
> at 
> org.apache.lucene.index.TermVectorsReader.readTermVector(TermVectorsReader.java:353)
> at 
> org.apache.lucene.index.TermVectorsReader.readTermVectors(TermVectorsReader.java:287)
> at org.apache.lucene.index.TermVectorsReader.get(TermVectorsReader.java:232)
> at 
> org.apache.lucene.index.SegmentReader.getTermFreqVectors(SegmentReader.java:981)
> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight(RelevanceFeedback.java:134)
> at 
> org.cr.search.TrecQueryRelevanceFeedback.main(TrecQueryRelevanceFeedback.java:781)
> 
> 
> 
> 
> Mark Miller wrote:
> > Any recent changes that would expose index corruption?
> >
> > I am getting two new errors when trying to search:
> >
> > nullpointer fieldsreaders line 260
> >
> > indexoutofbounds on fieldinfo line 185
> >
> > I am kind of screwed, because reindexing fixes this, but I cant reindex!
> >
> > Any ideas?
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >   
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33911-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 20:08:58 2008
Return-Path: <java-user-return-33911-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3305 invoked from network); 5 May 2008 20:08:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 20:08:57 -0000
Received: (qmail 65116 invoked by uid 500); 5 May 2008 20:08:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65072 invoked by uid 500); 5 May 2008 20:08:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65061 invoked by uid 99); 5 May 2008 20:08:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 13:08:51 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [217.146.189.34] (HELO web23009.mail.ird.yahoo.com) (217.146.189.34)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 05 May 2008 20:08:05 +0000
Received: (qmail 63026 invoked by uid 60001); 5 May 2008 20:08:18 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=r7hSxU/i28P0twQuGW6HKyiM4GFSWgQcgTXDZIN0zi9/RD7zNaQoJ/LuS1ediYUSnw5CFUhVdWKbRK1/isyN3c/CTZPYITHpFkMbj3v9rYjZUrWqScCk0M732oHnhYRjbEtQ1SZT0vEqY9A8BQcTzR0zHh9C9kQVRPkJ3dtapuk=;
X-YMail-OSG: x37ON_cVM1lp5b2lBDw9qOznC9LvG8e_8yf4.5OuT3Z0ZCLhYsrQIqtjDDNJ8iq6NGF5OITCI0Kku9xEhksEzI3L5xNSeV2aM4dtKOm9e1fpXJVWCBHMyLo2FEA-
Received: from [79.201.108.192] by web23009.mail.ird.yahoo.com via HTTP; Mon, 05 May 2008 20:08:18 GMT
X-Mailer: YahooMailRC/975.37 YahooMailWebService/0.7.185
Date: Mon, 5 May 2008 20:08:18 +0000 (GMT)
From: eks dev <eksdev@yahoo.co.uk>
Subject: Re: index corruption with latest lucene
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Message-ID: <532189.62303.qm@web23009.mail.ird.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

hmm, if I am not wrong, it looks awfully similar to the Exception we have s=
een and concluded it is some black magic with corrupt memory chip or waht-n=
ot, but the fact we are not alone makes me wonder now... Subject of this th=
read was "Strange Exception"... we were able to use this very same index ag=
ain (it was RAMDirectory loaded from FSDirectory) by just reloading it from=
 FSDirectory.=0A=0Agood luck=0A=0A=0A----- Original Message ----=0A> From: =
Mark Miller <markrmiller@gmail.com>=0A> To: java-user@lucene.apache.org=0A>=
 Sent: Monday, 5 May, 2008 9:56:47 PM=0A> Subject: Re: index corruption wit=
h latest lucene=0A> =0A> Yeah, its pretty close to 2.3.2, but I think from =
last week mabye.=0A> =0A> I finally have one of the stack traces (this come=
s on the tail complete=0A> laptop failure so I am scrambling here)=0A> =0A>=
 =EF=BB=BFjava.lang.IndexOutOfBoundsException: Index: 97, Size: 43=0A>     =
    at java.util.ArrayList.RangeCheck(ArrayList.java:572)=0A>         at ja=
va.util.ArrayList.get(ArrayList.java:347)=0A>         at org.apache.lucene.=
index.FieldInfos.fieldInfo(FieldInfos.java:260)=0A>         at org.apache.l=
ucene.index.FieldsReader.doc(FieldsReader.java:184)=0A>         at =0A> org=
.apache.lucene.index.SegmentReader.document(SegmentReader.java:670)=0A>    =
     at =0A> org.apache.lucene.index.MultiSegmentReader.document(MultiSegme=
ntReader.java:257)=0A>         at org.apache.lucene.search.IndexSearcher.do=
c(IndexSearcher.java:97)=0A> =0A> On Mon, 2008-05-05 at 14:48 -0500, crspan=
 wrote:=0A> > coincidence or it is from 2.3.2 ?=0A> > =0A> > env:=0A> > luc=
ene 2.3.2=0A> > jdk1.6.0_06 & jdk1.5.0_15=0A> > =0A> > =0A> > QueryString:=
=0A> > illeg^30.820824 technolog^22.290413 transfer^33.307804=0A> > Error: =
java.lang.ArrayIndexOutOfBoundsException: =0A> > 132704java.lang.ArrayIndex=
OutOfBoundsException: 132704=0A> > at =0A> > =0A> org.apache.lucene.search.=
BooleanScorer2$Coordinator.coordFactor(BooleanScorer2.java:55)=0A> > at org=
.apache.lucene.search.BooleanScorer2.score(BooleanScorer2.java:358)=0A> > a=
t org.apache.lucene.search.BooleanScorer2.score(BooleanScorer2.java:320)=0A=
> > at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:146=
)=0A> > at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java=
:113)=0A> > at org.apache.lucene.search.Searcher.search(Searcher.java:132)=
=0A> > at =0A> > =0A> org.cr.search.TrecQueryRelevanceFeedback.main(TrecQue=
ryRelevanceFeedback.java:776)=0A> > =0A> > =0A> > QueryString:=0A> > oceano=
graph^68.48028 vessel^43.191563=0A> > Error: =0A> > =0A> java.lang.ArrayInd=
exOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBoundsException=0A> > at jav=
a.lang.System.arraycopy(Native Method)=0A> > at =0A> > =0A> org.apache.luce=
ne.index.TermVectorsReader.readTermVector(TermVectorsReader.java:353)=0A> >=
 at =0A> > =0A> org.apache.lucene.index.TermVectorsReader.readTermVectors(T=
ermVectorsReader.java:287)=0A> > at org.apache.lucene.index.TermVectorsRead=
er.get(TermVectorsReader.java:232)=0A> > at =0A> > =0A> org.apache.lucene.i=
ndex.SegmentReader.getTermFreqVectors(SegmentReader.java:981)=0A> > at org.=
cr.rf.RelevanceFeedback.RelFeedbackWeight(RelevanceFeedback.java:134)=0A> >=
 at =0A> > =0A> org.cr.search.TrecQueryRelevanceFeedback.main(TrecQueryRele=
vanceFeedback.java:781)=0A> > =0A> > =0A> > =0A> > =0A> > Mark Miller wrote=
:=0A> > > Any recent changes that would expose index corruption?=0A> > >=0A=
> > > I am getting two new errors when trying to search:=0A> > >=0A> > > nu=
llpointer =EF=BB=BFfieldsreaders line 260=0A> > >=0A> > > indexoutofbounds =
on =EF=BB=BFfieldinfo line 185=0A> > >=0A> > > I am kind of screwed, becaus=
e reindexing fixes this, but I cant reindex!=0A> > >=0A> > > Any ideas?=0A>=
 > >=0A> > >=0A> > > ------------------------------------------------------=
---------------=0A> > > To unsubscribe, e-mail: java-user-unsubscribe@lucen=
e.apache.org=0A> > > For additional commands, e-mail: java-user-help@lucene=
.apache.org=0A> > >=0A> > >  =0A> > =0A> > =0A> > -------------------------=
--------------------------------------------=0A> > To unsubscribe, e-mail: =
java-user-unsubscribe@lucene.apache.org=0A> > For additional commands, e-ma=
il: java-user-help@lucene.apache.org=0A> > =0A> =0A> =0A> -----------------=
----------------------------------------------------=0A> To unsubscribe, e-=
mail: java-user-unsubscribe@lucene.apache.org=0A> For additional commands, =
e-mail: java-user-help@lucene.apache.org=0A=0A=0A=0A      _________________=
_________________________________________=0ASent from Yahoo! Mail.=0AA Smar=
ter Email http://uk.docs.yahoo.com/nowyoucan.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33912-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 20:30:20 2008
Return-Path: <java-user-return-33912-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7847 invoked from network); 5 May 2008 20:30:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 20:30:20 -0000
Received: (qmail 82230 invoked by uid 500); 5 May 2008 20:30:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82202 invoked by uid 500); 5 May 2008 20:30:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82191 invoked by uid 99); 5 May 2008 20:30:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 13:30:13 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.132.242 as permitted sender)
Received: from [209.85.132.242] (HELO an-out-0708.google.com) (209.85.132.242)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 20:29:19 +0000
Received: by an-out-0708.google.com with SMTP id c37so625067anc.49
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 13:29:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=V7tAwc9+K5Z8lrPfbxw+lLbrBZ06oflSM/Om+8BNztY=;
        b=a8pwVK279Rn5/Gc/F/OMCCEE//XjPaYRfYg3hbrVCOICFbeIXV2ULkEk23QR2pBfN99bCU7z1Jqedj0HlDMr45elzjbuVNFvSE8CgtgPfpb8LncC36j/Ro78aRqSkeP2pMK934qAlQH6B1v8KX/im4spuU6bSLxRpoq7P0wp8Z8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=FZZP3gNb4r06ztBLRoxz+4qa+daDcwSVQnEmbD+tLXbJYnqqVgproYK4a0BsFARUc1zvCNcTorpbK2yBcEXgRYuK62DrJqjs2YNwfhRibLof5kIJX5HyNaIJu1G+MT/96ekfg0NEF9GhEPCgIlifc+asauKmtVf0N6Vus5I02yU=
Received: by 10.100.33.13 with SMTP id g13mr8340079ang.96.1210019379718;
        Mon, 05 May 2008 13:29:39 -0700 (PDT)
Received: from ?172.20.3.139? ( [204.126.80.110])
        by mx.google.com with ESMTPS id b7sm11904581ana.35.2008.05.05.13.29.38
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 13:29:39 -0700 (PDT)
Subject: Re: index corruption with latest lucene
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <532189.62303.qm@web23009.mail.ird.yahoo.com>
References: <532189.62303.qm@web23009.mail.ird.yahoo.com>
Content-Type: text/plain; charset=utf-8
Date: Mon, 05 May 2008 16:29:38 -0400
Message-Id: <1210019378.11339.20.camel@m-laptop>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.1 
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

I thought I remember that thread but couldn't remember the details.

I am def getting a similar error, except that I seem to be way more out
of bounds than you.

I actually get it using an FSDirectory though...and I have gotten it
twice already...both upgrades I tried...first on a test machine and then
at a site. Reindexing fixed the test machine. Not sure why previous
Lucene (also post 2.3 trunk) did not blow up on this...cant roll back
though :)

On Mon, 2008-05-05 at 20:08 +0000, eks dev wrote:
> hmm, if I am not wrong, it looks awfully similar to the Exception we have seen and concluded it is some black magic with corrupt memory chip or waht-not, but the fact we are not alone makes me wonder now... Subject of this thread was "Strange Exception"... we were able to use this very same index again (it was RAMDirectory loaded from FSDirectory) by just reloading it from FSDirectory.
> 
> good luck
> 
> 
> ----- Original Message ----
> > From: Mark Miller <markrmiller@gmail.com>
> > To: java-user@lucene.apache.org
> > Sent: Monday, 5 May, 2008 9:56:47 PM
> > Subject: Re: index corruption with latest lucene
> > 
> > Yeah, its pretty close to 2.3.2, but I think from last week mabye.
> > 
> > I finally have one of the stack traces (this comes on the tail complete
> > laptop failure so I am scrambling here)
> > 
> > java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
> >         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
> >         at java.util.ArrayList.get(ArrayList.java:347)
> >         at org.apache.lucene.index.FieldInfos.fieldInfo(FieldInfos.java:260)
> >         at org.apache.lucene.index.FieldsReader.doc(FieldsReader.java:184)
> >         at 
> > org.apache.lucene.index.SegmentReader.document(SegmentReader.java:670)
> >         at 
> > org.apache.lucene.index.MultiSegmentReader.document(MultiSegmentReader.java:257)
> >         at org.apache.lucene.search.IndexSearcher.doc(IndexSearcher.java:97)
> > 
> > On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
> > > coincidence or it is from 2.3.2 ?
> > > 
> > > env:
> > > lucene 2.3.2
> > > jdk1.6.0_06 & jdk1.5.0_15
> > > 
> > > 
> > > QueryString:
> > > illeg^30.820824 technolog^22.290413 transfer^33.307804
> > > Error: java.lang.ArrayIndexOutOfBoundsException: 
> > > 132704java.lang.ArrayIndexOutOfBoundsException: 132704
> > > at 
> > > 
> > org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor(BooleanScorer2.java:55)
> > > at org.apache.lucene.search.BooleanScorer2.score(BooleanScorer2.java:358)
> > > at org.apache.lucene.search.BooleanScorer2.score(BooleanScorer2.java:320)
> > > at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:146)
> > > at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:113)
> > > at org.apache.lucene.search.Searcher.search(Searcher.java:132)
> > > at 
> > > 
> > org.cr.search.TrecQueryRelevanceFeedback.main(TrecQueryRelevanceFeedback.java:776)
> > > 
> > > 
> > > QueryString:
> > > oceanograph^68.48028 vessel^43.191563
> > > Error: 
> > > 
> > java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBoundsException
> > > at java.lang.System.arraycopy(Native Method)
> > > at 
> > > 
> > org.apache.lucene.index.TermVectorsReader.readTermVector(TermVectorsReader.java:353)
> > > at 
> > > 
> > org.apache.lucene.index.TermVectorsReader.readTermVectors(TermVectorsReader.java:287)
> > > at org.apache.lucene.index.TermVectorsReader.get(TermVectorsReader.java:232)
> > > at 
> > > 
> > org.apache.lucene.index.SegmentReader.getTermFreqVectors(SegmentReader.java:981)
> > > at org.cr.rf.RelevanceFeedback.RelFeedbackWeight(RelevanceFeedback.java:134)
> > > at 
> > > 
> > org.cr.search.TrecQueryRelevanceFeedback.main(TrecQueryRelevanceFeedback.java:781)
> > > 
> > > 
> > > 
> > > 
> > > Mark Miller wrote:
> > > > Any recent changes that would expose index corruption?
> > > >
> > > > I am getting two new errors when trying to search:
> > > >
> > > > nullpointer fieldsreaders line 260
> > > >
> > > > indexoutofbounds on fieldinfo line 185
> > > >
> > > > I am kind of screwed, because reindexing fixes this, but I cant reindex!
> > > >
> > > > Any ideas?
> > > >
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >  
> > > 
> > > 
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > 
> > 
> > 
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
>       __________________________________________________________
> Sent from Yahoo! Mail.
> A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33913-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 20:32:07 2008
Return-Path: <java-user-return-33913-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9194 invoked from network); 5 May 2008 20:32:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 20:32:06 -0000
Received: (qmail 87332 invoked by uid 500); 5 May 2008 20:32:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87304 invoked by uid 500); 5 May 2008 20:32:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87293 invoked by uid 99); 5 May 2008 20:32:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 13:32:00 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.14.246.251] (HELO ag-out-0708.google.com) (72.14.246.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 20:31:14 +0000
Received: by ag-out-0708.google.com with SMTP id 23so710213agd.11
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 13:31:26 -0700 (PDT)
Received: by 10.90.95.18 with SMTP id s18mr10380948agb.55.1210019486135;
        Mon, 05 May 2008 13:31:26 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 9sm8706455agc.4.2008.05.05.13.31.25
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 05 May 2008 13:31:25 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <1210017407.11339.16.camel@m-laptop>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com> <1210017407.11339.16.camel@m-laptop>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: index corruption with latest lucene
Date: Mon, 5 May 2008 16:32:13 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Mark,

Not good!

Can you describe how this index was created?  Did you use multiple  
threads on one IndexWriter?  Multiple sessions of IndexWriter  
appending to the index?  addIndexes*?  Is the index copied from one  
place to another after being written and before being searched?

If you run CheckIndex, what does it report?

Any prior exceptions on this index?

Are your docs a variable schema (different fields)?

Mike

Mark Miller wrote:
> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
>
> I finally have one of the stack traces (this comes on the tail  
> complete
> laptop failure so I am scrambling here)
>
> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
>         at java.util.ArrayList.get(ArrayList.java:347)
>         at org.apache.lucene.index.FieldInfos.fieldInfo 
> (FieldInfos.java:260)
>         at org.apache.lucene.index.FieldsReader.doc 
> (FieldsReader.java:184)
>         at org.apache.lucene.index.SegmentReader.document 
> (SegmentReader.java:670)
>         at org.apache.lucene.index.MultiSegmentReader.document 
> (MultiSegmentReader.java:257)
>         at org.apache.lucene.search.IndexSearcher.doc 
> (IndexSearcher.java:97)
>
> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
>> coincidence or it is from 2.3.2 ?
>>
>> env:
>> lucene 2.3.2
>> jdk1.6.0_06 & jdk1.5.0_15
>>
>>
>> QueryString:
>> illeg^30.820824 technolog^22.290413 transfer^33.307804
>> Error: java.lang.ArrayIndexOutOfBoundsException:
>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
>> at
>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor 
>> (BooleanScorer2.java:55)
>> at org.apache.lucene.search.BooleanScorer2.score 
>> (BooleanScorer2.java:358)
>> at org.apache.lucene.search.BooleanScorer2.score 
>> (BooleanScorer2.java:320)
>> at org.apache.lucene.search.IndexSearcher.search 
>> (IndexSearcher.java:146)
>> at org.apache.lucene.search.IndexSearcher.search 
>> (IndexSearcher.java:113)
>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
>> at
>> org.cr.search.TrecQueryRelevanceFeedback.main 
>> (TrecQueryRelevanceFeedback.java:776)
>>
>>
>> QueryString:
>> oceanograph^68.48028 vessel^43.191563
>> Error:
>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBoun 
>> dsException
>> at java.lang.System.arraycopy(Native Method)
>> at
>> org.apache.lucene.index.TermVectorsReader.readTermVector 
>> (TermVectorsReader.java:353)
>> at
>> org.apache.lucene.index.TermVectorsReader.readTermVectors 
>> (TermVectorsReader.java:287)
>> at org.apache.lucene.index.TermVectorsReader.get 
>> (TermVectorsReader.java:232)
>> at
>> org.apache.lucene.index.SegmentReader.getTermFreqVectors 
>> (SegmentReader.java:981)
>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight 
>> (RelevanceFeedback.java:134)
>> at
>> org.cr.search.TrecQueryRelevanceFeedback.main 
>> (TrecQueryRelevanceFeedback.java:781)
>>
>>
>>
>>
>> Mark Miller wrote:
>>> Any recent changes that would expose index corruption?
>>>
>>> I am getting two new errors when trying to search:
>>>
>>> nullpointer fieldsreaders line 260
>>>
>>> indexoutofbounds on fieldinfo line 185
>>>
>>> I am kind of screwed, because reindexing fixes this, but I cant  
>>> reindex!
>>>
>>> Any ideas?
>>>
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33914-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 21:01:27 2008
Return-Path: <java-user-return-33914-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19204 invoked from network); 5 May 2008 21:01:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 21:01:26 -0000
Received: (qmail 26075 invoked by uid 500); 5 May 2008 21:01:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26051 invoked by uid 500); 5 May 2008 21:01:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26040 invoked by uid 99); 5 May 2008 21:01:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 14:01:21 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 66.249.82.229 as permitted sender)
Received: from [66.249.82.229] (HELO wx-out-0506.google.com) (66.249.82.229)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 21:00:35 +0000
Received: by wx-out-0506.google.com with SMTP id h29so230625wxd.20
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 14:00:48 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=2uc2XZSTWrsKnWMnSqt9brBhYpL6cmxhTICdbzljKXU=;
        b=MdHQBiYUam9QhcPDwuvAfNOSKuM7MEhDkuHaDn+amjotPQEaSzwTzi35xc8VWAdH/47EY/UE+64zif2lAqegHEAiS2RezNCzNAL+PKGXpa7XVn22NNz32jedKvtr7qijPexGLvkyVrC0wNMJG362uDRz7m8G238xDNTieAZNYPo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=QmUHmxsnDazjZiQXubM5qJ6bIa40q+gqRkf08uuqRMS63MXwRixPCV1ka31xbsukmJcAEBvg8hRraqNyE0f+Ke5eR7toco7gJkk8j8Y1ssLhZAHv/3+h0SG49bCEYg3YNZQkmcPHTbp515bZNk27V694Dq2Ynd4CpXiow7oM6eQ=
Received: by 10.100.33.4 with SMTP id g4mr8370096ang.111.1210021248606;
        Mon, 05 May 2008 14:00:48 -0700 (PDT)
Received: from ?172.20.3.139? ( [204.126.80.110])
        by mx.google.com with ESMTPS id c39sm15173574anc.29.2008.05.05.14.00.46
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 14:00:47 -0700 (PDT)
Subject: Re: index corruption with latest lucene
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com>
	 <1210017407.11339.16.camel@m-laptop>
	 <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>
Content-Type: text/plain
Date: Mon, 05 May 2008 17:00:46 -0400
Message-Id: <1210021246.11339.30.camel@m-laptop>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
> Hi Mark,
> 
> Not good!
> 
> Can you describe how this index was created?  Did you use multiple  
> threads on one IndexWriter?  Multiple sessions of IndexWriter  
> appending to the index?  addIndexes*?  Is the index copied from one  
> place to another after being written and before being searched?

Both sites were created by a single thread on a single IndexWriter.
Updates are done through multiple threads and one IndexWriter. No
addIndexes. Index was never copied, always same path.

> 
> If you run CheckIndex, what does it report?

This was my next move...unfortunately, someone accidentally kicked off a
complete reindex before I could do it. From what I can tell by the stack
trace, its a per doc problem...I am guessing I could have  printed the
ids of the problem docs and just reindex those? I have to deal with this
at many other sites, so that may be my attack...I cannot reindex
everything to fix.

> 
> Any prior exceptions on this index?

Not that I can recall. One of the indexes was made months ago, prob with
a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
site was windows 2003, the other AIX. One site was only 30,000 docs, the
other over 1 million.

> 
> Are your docs a variable schema (different fields)?

Yes. Lots of different fields depending on the doc.

> 
> Mike

Thanks Mike. I am currently trying to duplicate this. I can't go to
another site without testing some kind of fix.

> 
> Mark Miller wrote:
> > Yeah, its pretty close to 2.3.2, but I think from last week mabye.
> >
> > I finally have one of the stack traces (this comes on the tail  
> > complete
> > laptop failure so I am scrambling here)
> >
> > java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
> >         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
> >         at java.util.ArrayList.get(ArrayList.java:347)
> >         at org.apache.lucene.index.FieldInfos.fieldInfo 
> > (FieldInfos.java:260)
> >         at org.apache.lucene.index.FieldsReader.doc 
> > (FieldsReader.java:184)
> >         at org.apache.lucene.index.SegmentReader.document 
> > (SegmentReader.java:670)
> >         at org.apache.lucene.index.MultiSegmentReader.document 
> > (MultiSegmentReader.java:257)
> >         at org.apache.lucene.search.IndexSearcher.doc 
> > (IndexSearcher.java:97)
> >
> > On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
> >> coincidence or it is from 2.3.2 ?
> >>
> >> env:
> >> lucene 2.3.2
> >> jdk1.6.0_06 & jdk1.5.0_15
> >>
> >>
> >> QueryString:
> >> illeg^30.820824 technolog^22.290413 transfer^33.307804
> >> Error: java.lang.ArrayIndexOutOfBoundsException:
> >> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
> >> at
> >> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor 
> >> (BooleanScorer2.java:55)
> >> at org.apache.lucene.search.BooleanScorer2.score 
> >> (BooleanScorer2.java:358)
> >> at org.apache.lucene.search.BooleanScorer2.score 
> >> (BooleanScorer2.java:320)
> >> at org.apache.lucene.search.IndexSearcher.search 
> >> (IndexSearcher.java:146)
> >> at org.apache.lucene.search.IndexSearcher.search 
> >> (IndexSearcher.java:113)
> >> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
> >> at
> >> org.cr.search.TrecQueryRelevanceFeedback.main 
> >> (TrecQueryRelevanceFeedback.java:776)
> >>
> >>
> >> QueryString:
> >> oceanograph^68.48028 vessel^43.191563
> >> Error:
> >> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBoun 
> >> dsException
> >> at java.lang.System.arraycopy(Native Method)
> >> at
> >> org.apache.lucene.index.TermVectorsReader.readTermVector 
> >> (TermVectorsReader.java:353)
> >> at
> >> org.apache.lucene.index.TermVectorsReader.readTermVectors 
> >> (TermVectorsReader.java:287)
> >> at org.apache.lucene.index.TermVectorsReader.get 
> >> (TermVectorsReader.java:232)
> >> at
> >> org.apache.lucene.index.SegmentReader.getTermFreqVectors 
> >> (SegmentReader.java:981)
> >> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight 
> >> (RelevanceFeedback.java:134)
> >> at
> >> org.cr.search.TrecQueryRelevanceFeedback.main 
> >> (TrecQueryRelevanceFeedback.java:781)
> >>
> >>
> >>
> >>
> >> Mark Miller wrote:
> >>> Any recent changes that would expose index corruption?
> >>>
> >>> I am getting two new errors when trying to search:
> >>>
> >>> nullpointer fieldsreaders line 260
> >>>
> >>> indexoutofbounds on fieldinfo line 185
> >>>
> >>> I am kind of screwed, because reindexing fixes this, but I cant  
> >>> reindex!
> >>>
> >>> Any ideas?
> >>>
> >>>
> >>> -------------------------------------------------------------------- 
> >>> -
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>>
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33915-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 21:26:48 2008
Return-Path: <java-user-return-33915-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27062 invoked from network); 5 May 2008 21:26:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 21:26:48 -0000
Received: (qmail 47175 invoked by uid 500); 5 May 2008 21:26:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47145 invoked by uid 500); 5 May 2008 21:26:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47134 invoked by uid 99); 5 May 2008 21:26:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 14:26:42 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.14.246.241] (HELO ag-out-0708.google.com) (72.14.246.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 21:25:55 +0000
Received: by ag-out-0708.google.com with SMTP id 23so742718agd.11
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 14:26:07 -0700 (PDT)
Received: by 10.100.10.15 with SMTP id 15mr8400544anj.152.1210022767167;
        Mon, 05 May 2008 14:26:07 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 27sm12270622wra.32.2008.05.05.14.26.06
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 05 May 2008 14:26:06 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <1210021246.11339.30.camel@m-laptop>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com> <1210017407.11339.16.camel@m-laptop> <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com> <1210021246.11339.30.camel@m-laptop>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: index corruption with latest lucene
Date: Mon, 5 May 2008 17:26:54 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Actually that stack trace looks like it's from trunk, not from 2.3.2 
(pre)?  OK, I think you said it's from "post 2.3 trunk".

Another question: is autoCommit false or true?

More responses below:

Mark Miller wrote:
> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
>> Hi Mark,
>>
>> Not good!
>>
>> Can you describe how this index was created?  Did you use multiple
>> threads on one IndexWriter?  Multiple sessions of IndexWriter
>> appending to the index?  addIndexes*?  Is the index copied from one
>> place to another after being written and before being searched?
>
> Both sites were created by a single thread on a single IndexWriter.
> Updates are done through multiple threads and one IndexWriter. No
> addIndexes. Index was never copied, always same path.
>
>>
>> If you run CheckIndex, what does it report?
>
> This was my next move...unfortunately, someone accidentally kicked  
> off a
> complete reindex before I could do it. From what I can tell by the  
> stack
> trace, its a per doc problem...I am guessing I could have  printed the
> ids of the problem docs and just reindex those? I have to deal with  
> this
> at many other sites, so that may be my attack...I cannot reindex
> everything to fix.

It would be great to know if that workaround works (and indeed it's a  
per-doc issue).  I'd also love to know how many docs are affected,  
when you hit this.

If there's any way to zip up the index and send it to me, even just  
the files for the one segment that has the corrupted doc, that'd be  
great.

>>
>> Any prior exceptions on this index?
>
> Not that I can recall. One of the indexes was made months ago, prob  
> with
> a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
> site was windows 2003, the other AIX. One site was only 30,000  
> docs, the
> other over 1 million.
>
>>
>> Are your docs a variable schema (different fields)?
>
> Yes. Lots of different fields depending on the doc.
>
>>
>> Mike
>
> Thanks Mike. I am currently trying to duplicate this. I can't go to
> another site without testing some kind of fix.
>
>>
>> Mark Miller wrote:
>>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
>>>
>>> I finally have one of the stack traces (this comes on the tail
>>> complete
>>> laptop failure so I am scrambling here)
>>>
>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
>>>         at java.util.ArrayList.get(ArrayList.java:347)
>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
>>> (FieldInfos.java:260)
>>>         at org.apache.lucene.index.FieldsReader.doc
>>> (FieldsReader.java:184)
>>>         at org.apache.lucene.index.SegmentReader.document
>>> (SegmentReader.java:670)
>>>         at org.apache.lucene.index.MultiSegmentReader.document
>>> (MultiSegmentReader.java:257)
>>>         at org.apache.lucene.search.IndexSearcher.doc
>>> (IndexSearcher.java:97)
>>>
>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
>>>> coincidence or it is from 2.3.2 ?
>>>>
>>>> env:
>>>> lucene 2.3.2
>>>> jdk1.6.0_06 & jdk1.5.0_15
>>>>
>>>>
>>>> QueryString:
>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
>>>> at
>>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
>>>> (BooleanScorer2.java:55)
>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>> (BooleanScorer2.java:358)
>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>> (BooleanScorer2.java:320)
>>>> at org.apache.lucene.search.IndexSearcher.search
>>>> (IndexSearcher.java:146)
>>>> at org.apache.lucene.search.IndexSearcher.search
>>>> (IndexSearcher.java:113)
>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
>>>> at
>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>> (TrecQueryRelevanceFeedback.java:776)
>>>>
>>>>
>>>> QueryString:
>>>> oceanograph^68.48028 vessel^43.191563
>>>> Error:
>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBo 
>>>> un
>>>> dsException
>>>> at java.lang.System.arraycopy(Native Method)
>>>> at
>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
>>>> (TermVectorsReader.java:353)
>>>> at
>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
>>>> (TermVectorsReader.java:287)
>>>> at org.apache.lucene.index.TermVectorsReader.get
>>>> (TermVectorsReader.java:232)
>>>> at
>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
>>>> (SegmentReader.java:981)
>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
>>>> (RelevanceFeedback.java:134)
>>>> at
>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>> (TrecQueryRelevanceFeedback.java:781)
>>>>
>>>>
>>>>
>>>>
>>>> Mark Miller wrote:
>>>>> Any recent changes that would expose index corruption?
>>>>>
>>>>> I am getting two new errors when trying to search:
>>>>>
>>>>> nullpointer fieldsreaders line 260
>>>>>
>>>>> indexoutofbounds on fieldinfo line 185
>>>>>
>>>>> I am kind of screwed, because reindexing fixes this, but I cant
>>>>> reindex!
>>>>>
>>>>> Any ideas?
>>>>>
>>>>>
>>>>> ------------------------------------------------------------------ 
>>>>> --
>>>>> -
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>
>>>>
>>>> ------------------------------------------------------------------- 
>>>> --
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33916-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 21:32:25 2008
Return-Path: <java-user-return-33916-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29094 invoked from network); 5 May 2008 21:32:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 21:32:24 -0000
Received: (qmail 54939 invoked by uid 500); 5 May 2008 21:32:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54910 invoked by uid 500); 5 May 2008 21:32:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54890 invoked by uid 99); 5 May 2008 21:32:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 14:32:18 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.14.246.249] (HELO ag-out-0708.google.com) (72.14.246.249)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 21:31:32 +0000
Received: by ag-out-0708.google.com with SMTP id 23so746515agd.11
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 14:31:45 -0700 (PDT)
Received: by 10.100.251.18 with SMTP id y18mr8460162anh.36.1210023105008;
        Mon, 05 May 2008 14:31:45 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id d24sm15278042and.24.2008.05.05.14.31.44
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 05 May 2008 14:31:44 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <1210021246.11339.30.camel@m-laptop>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com> <1210017407.11339.16.camel@m-laptop> <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com> <1210021246.11339.30.camel@m-laptop>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <5B9447D2-D86A-4951-96CB-5B0CC8DA7DA5@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: index corruption with latest lucene
Date: Mon, 5 May 2008 17:32:32 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Also, if you can run your tests with assertions enabled, it could  
catch something...

Mike

Mark Miller wrote:
> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
>> Hi Mark,
>>
>> Not good!
>>
>> Can you describe how this index was created?  Did you use multiple
>> threads on one IndexWriter?  Multiple sessions of IndexWriter
>> appending to the index?  addIndexes*?  Is the index copied from one
>> place to another after being written and before being searched?
>
> Both sites were created by a single thread on a single IndexWriter.
> Updates are done through multiple threads and one IndexWriter. No
> addIndexes. Index was never copied, always same path.
>
>>
>> If you run CheckIndex, what does it report?
>
> This was my next move...unfortunately, someone accidentally kicked  
> off a
> complete reindex before I could do it. From what I can tell by the  
> stack
> trace, its a per doc problem...I am guessing I could have  printed the
> ids of the problem docs and just reindex those? I have to deal with  
> this
> at many other sites, so that may be my attack...I cannot reindex
> everything to fix.
>
>>
>> Any prior exceptions on this index?
>
> Not that I can recall. One of the indexes was made months ago, prob  
> with
> a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
> site was windows 2003, the other AIX. One site was only 30,000  
> docs, the
> other over 1 million.
>
>>
>> Are your docs a variable schema (different fields)?
>
> Yes. Lots of different fields depending on the doc.
>
>>
>> Mike
>
> Thanks Mike. I am currently trying to duplicate this. I can't go to
> another site without testing some kind of fix.
>
>>
>> Mark Miller wrote:
>>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
>>>
>>> I finally have one of the stack traces (this comes on the tail
>>> complete
>>> laptop failure so I am scrambling here)
>>>
>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
>>>         at java.util.ArrayList.get(ArrayList.java:347)
>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
>>> (FieldInfos.java:260)
>>>         at org.apache.lucene.index.FieldsReader.doc
>>> (FieldsReader.java:184)
>>>         at org.apache.lucene.index.SegmentReader.document
>>> (SegmentReader.java:670)
>>>         at org.apache.lucene.index.MultiSegmentReader.document
>>> (MultiSegmentReader.java:257)
>>>         at org.apache.lucene.search.IndexSearcher.doc
>>> (IndexSearcher.java:97)
>>>
>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
>>>> coincidence or it is from 2.3.2 ?
>>>>
>>>> env:
>>>> lucene 2.3.2
>>>> jdk1.6.0_06 & jdk1.5.0_15
>>>>
>>>>
>>>> QueryString:
>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
>>>> at
>>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
>>>> (BooleanScorer2.java:55)
>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>> (BooleanScorer2.java:358)
>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>> (BooleanScorer2.java:320)
>>>> at org.apache.lucene.search.IndexSearcher.search
>>>> (IndexSearcher.java:146)
>>>> at org.apache.lucene.search.IndexSearcher.search
>>>> (IndexSearcher.java:113)
>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
>>>> at
>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>> (TrecQueryRelevanceFeedback.java:776)
>>>>
>>>>
>>>> QueryString:
>>>> oceanograph^68.48028 vessel^43.191563
>>>> Error:
>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBo 
>>>> un
>>>> dsException
>>>> at java.lang.System.arraycopy(Native Method)
>>>> at
>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
>>>> (TermVectorsReader.java:353)
>>>> at
>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
>>>> (TermVectorsReader.java:287)
>>>> at org.apache.lucene.index.TermVectorsReader.get
>>>> (TermVectorsReader.java:232)
>>>> at
>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
>>>> (SegmentReader.java:981)
>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
>>>> (RelevanceFeedback.java:134)
>>>> at
>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>> (TrecQueryRelevanceFeedback.java:781)
>>>>
>>>>
>>>>
>>>>
>>>> Mark Miller wrote:
>>>>> Any recent changes that would expose index corruption?
>>>>>
>>>>> I am getting two new errors when trying to search:
>>>>>
>>>>> nullpointer fieldsreaders line 260
>>>>>
>>>>> indexoutofbounds on fieldinfo line 185
>>>>>
>>>>> I am kind of screwed, because reindexing fixes this, but I cant
>>>>> reindex!
>>>>>
>>>>> Any ideas?
>>>>>
>>>>>
>>>>> ------------------------------------------------------------------ 
>>>>> --
>>>>> -
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>
>>>>
>>>> ------------------------------------------------------------------- 
>>>> --
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33917-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 21:35:11 2008
Return-Path: <java-user-return-33917-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30619 invoked from network); 5 May 2008 21:35:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 21:35:11 -0000
Received: (qmail 65320 invoked by uid 500); 5 May 2008 21:35:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65021 invoked by uid 500); 5 May 2008 21:35:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65010 invoked by uid 99); 5 May 2008 21:35:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 14:35:06 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 64.233.166.183 as permitted sender)
Received: from [64.233.166.183] (HELO py-out-1112.google.com) (64.233.166.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 21:34:20 +0000
Received: by py-out-1112.google.com with SMTP id z74so1719238pyg.9
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 14:34:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=krpPZyjmFiSJQ7yx6gFd8gZjDZjitfw1qOy5ME5v0Iw=;
        b=s90LqylqlBfye86VBjol6gqVJrK+ABho7mYZcSik0RtIrQ1GqVKzCLkY5fVzdPM7MIS9nxPMn25FEFDRsqDLHjoP/aM5YKy5uIrhnn6GaypiHjxK7uTbVrNnihtDA1U2suTpJVQwbfyVcOa0AOt1r9SRWOoaHnLdoHt/jD4bNTo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=ooYjl1pu7EUDEILt+FBzoo8Pl6+NaHXNo/QJvpAmEQSBjMU8cabqT3ydtPO7aods5GCnsfoASBVQjACWoQHDJDBDfxkgMH73WaZMiXlkiVU/tLRO2UvmCnrLTrD69Lcq8x1wekAF2RGDT6smvwWyxhwAEF7p7VT71zVQB9qpeGA=
Received: by 10.35.49.11 with SMTP id b11mr12230724pyk.40.1210023273471;
        Mon, 05 May 2008 14:34:33 -0700 (PDT)
Received: from ?9.30.38.211? ( [129.42.184.35])
        by mx.google.com with ESMTPS id w67sm21257601pyg.20.2008.05.05.14.34.31
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 14:34:32 -0700 (PDT)
Message-ID: <481F7CF4.9020402@gmail.com>
Date: Mon, 05 May 2008 14:32:36 -0700
From: Michael Busch <buschmic@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: index corruption with latest lucene
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com> <1210017407.11339.16.camel@m-laptop> <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com> <1210021246.11339.30.camel@m-laptop> <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>
In-Reply-To: <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

If that is the case then I will go ahead and publish the 2.3.2 release? 
Have you seen this on 2.3.x, Mark?

-Michael

Michael McCandless wrote:
> 
> Actually that stack trace looks like it's from trunk, not from 
> 2.3.2(pre)?  OK, I think you said it's from "post 2.3 trunk".
> 
> Another question: is autoCommit false or true?
> 
> More responses below:
> 
> Mark Miller wrote:
>> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
>>> Hi Mark,
>>>
>>> Not good!
>>>
>>> Can you describe how this index was created?  Did you use multiple
>>> threads on one IndexWriter?  Multiple sessions of IndexWriter
>>> appending to the index?  addIndexes*?  Is the index copied from one
>>> place to another after being written and before being searched?
>>
>> Both sites were created by a single thread on a single IndexWriter.
>> Updates are done through multiple threads and one IndexWriter. No
>> addIndexes. Index was never copied, always same path.
>>
>>>
>>> If you run CheckIndex, what does it report?
>>
>> This was my next move...unfortunately, someone accidentally kicked off a
>> complete reindex before I could do it. From what I can tell by the stack
>> trace, its a per doc problem...I am guessing I could have  printed the
>> ids of the problem docs and just reindex those? I have to deal with this
>> at many other sites, so that may be my attack...I cannot reindex
>> everything to fix.
> 
> It would be great to know if that workaround works (and indeed it's a 
> per-doc issue).  I'd also love to know how many docs are affected, when 
> you hit this.
> 
> If there's any way to zip up the index and send it to me, even just the 
> files for the one segment that has the corrupted doc, that'd be great.
> 
>>>
>>> Any prior exceptions on this index?
>>
>> Not that I can recall. One of the indexes was made months ago, prob with
>> a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
>> site was windows 2003, the other AIX. One site was only 30,000 docs, the
>> other over 1 million.
>>
>>>
>>> Are your docs a variable schema (different fields)?
>>
>> Yes. Lots of different fields depending on the doc.
>>
>>>
>>> Mike
>>
>> Thanks Mike. I am currently trying to duplicate this. I can't go to
>> another site without testing some kind of fix.
>>
>>>
>>> Mark Miller wrote:
>>>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
>>>>
>>>> I finally have one of the stack traces (this comes on the tail
>>>> complete
>>>> laptop failure so I am scrambling here)
>>>>
>>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
>>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
>>>>         at java.util.ArrayList.get(ArrayList.java:347)
>>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
>>>> (FieldInfos.java:260)
>>>>         at org.apache.lucene.index.FieldsReader.doc
>>>> (FieldsReader.java:184)
>>>>         at org.apache.lucene.index.SegmentReader.document
>>>> (SegmentReader.java:670)
>>>>         at org.apache.lucene.index.MultiSegmentReader.document
>>>> (MultiSegmentReader.java:257)
>>>>         at org.apache.lucene.search.IndexSearcher.doc
>>>> (IndexSearcher.java:97)
>>>>
>>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
>>>>> coincidence or it is from 2.3.2 ?
>>>>>
>>>>> env:
>>>>> lucene 2.3.2
>>>>> jdk1.6.0_06 & jdk1.5.0_15
>>>>>
>>>>>
>>>>> QueryString:
>>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
>>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
>>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
>>>>> at
>>>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
>>>>> (BooleanScorer2.java:55)
>>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>>> (BooleanScorer2.java:358)
>>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>>> (BooleanScorer2.java:320)
>>>>> at org.apache.lucene.search.IndexSearcher.search
>>>>> (IndexSearcher.java:146)
>>>>> at org.apache.lucene.search.IndexSearcher.search
>>>>> (IndexSearcher.java:113)
>>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
>>>>> at
>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>>> (TrecQueryRelevanceFeedback.java:776)
>>>>>
>>>>>
>>>>> QueryString:
>>>>> oceanograph^68.48028 vessel^43.191563
>>>>> Error:
>>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBoun
>>>>> dsException
>>>>> at java.lang.System.arraycopy(Native Method)
>>>>> at
>>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
>>>>> (TermVectorsReader.java:353)
>>>>> at
>>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
>>>>> (TermVectorsReader.java:287)
>>>>> at org.apache.lucene.index.TermVectorsReader.get
>>>>> (TermVectorsReader.java:232)
>>>>> at
>>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
>>>>> (SegmentReader.java:981)
>>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
>>>>> (RelevanceFeedback.java:134)
>>>>> at
>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>>> (TrecQueryRelevanceFeedback.java:781)
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> Mark Miller wrote:
>>>>>> Any recent changes that would expose index corruption?
>>>>>>
>>>>>> I am getting two new errors when trying to search:
>>>>>>
>>>>>> nullpointer fieldsreaders line 260
>>>>>>
>>>>>> indexoutofbounds on fieldinfo line 185
>>>>>>
>>>>>> I am kind of screwed, because reindexing fixes this, but I cant
>>>>>> reindex!
>>>>>>
>>>>>> Any ideas?
>>>>>>
>>>>>>
>>>>>> --------------------------------------------------------------------
>>>>>> -
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33918-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 21:35:41 2008
Return-Path: <java-user-return-33918-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30775 invoked from network); 5 May 2008 21:35:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 21:35:41 -0000
Received: (qmail 66675 invoked by uid 500); 5 May 2008 21:35:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66646 invoked by uid 500); 5 May 2008 21:35:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66635 invoked by uid 99); 5 May 2008 21:35:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 14:35:35 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 64.233.184.235 as permitted sender)
Received: from [64.233.184.235] (HELO wr-out-0506.google.com) (64.233.184.235)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 21:34:50 +0000
Received: by wr-out-0506.google.com with SMTP id c30so1387814wra.14
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 14:35:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=BAlMSFIV9TjfxVzVkNcLrHb3Q4iEpUJG9+pfxgqfs/I=;
        b=ol8snEEqzzprkaq//UjNSl0LdnXakPNfZpwAOlwitJtwiHa+32pElFj+Yb+pSCNesvsdkJRTTLauVbYTWHuph9SpFXW/uSFr+Mwh2I8qmopem+fxILOzN+yo6p5YJ/PMabZN4fQRoL8X7+0PryPIIKHYegxT3t3ZVvcIAk+lb80=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=XwauE97I2xaL0Q0/l/AHsVa9pmAmnUgnBD7YQpOr9Aw/IqPhregosP0L6PlBlwQnSukrwGqtvtZ733bjycWrodXRhRx/rYeOAj3GyZmLwZIDyjBdQsd4XHwIb1YXrjHWBPmhXoeI4oigV5QrVjxxsHZJaGqaEHUjqyNWxeXR90g=
Received: by 10.100.134.10 with SMTP id h10mr8419229and.117.1210023303489;
        Mon, 05 May 2008 14:35:03 -0700 (PDT)
Received: from ?172.20.3.139? ( [204.126.80.110])
        by mx.google.com with ESMTPS id d36sm12349388and.8.2008.05.05.14.35.02
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 14:35:02 -0700 (PDT)
Subject: Re: index corruption with latest lucene
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com>
	 <1210017407.11339.16.camel@m-laptop>
	 <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>
	 <1210021246.11339.30.camel@m-laptop>
	 <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>
Content-Type: text/plain
Date: Mon, 05 May 2008 17:35:01 -0400
Message-Id: <1210023301.11339.34.camel@m-laptop>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Mon, 2008-05-05 at 17:26 -0400, Michael McCandless wrote:
> Actually that stack trace looks like it's from trunk, not from 2.3.2 
> (pre)?  OK, I think you said it's from "post 2.3 trunk".

Right...the Lucene that showed the problem was build from a trunk grab
late last week. One of the problem indexes was built with a 2.0 or 2.1
and the other was built with a post 2.3 trunk (but weeks (prob months)
before the one i grabbed late last week :) )

> 
> Another question: is autoCommit false or true?
false



If I can get you an affected index I will.

- mark


> 
> More responses below:
> 
> Mark Miller wrote:
> > On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
> >> Hi Mark,
> >>
> >> Not good!
> >>
> >> Can you describe how this index was created?  Did you use multiple
> >> threads on one IndexWriter?  Multiple sessions of IndexWriter
> >> appending to the index?  addIndexes*?  Is the index copied from one
> >> place to another after being written and before being searched?
> >
> > Both sites were created by a single thread on a single IndexWriter.
> > Updates are done through multiple threads and one IndexWriter. No
> > addIndexes. Index was never copied, always same path.
> >
> >>
> >> If you run CheckIndex, what does it report?
> >
> > This was my next move...unfortunately, someone accidentally kicked  
> > off a
> > complete reindex before I could do it. From what I can tell by the  
> > stack
> > trace, its a per doc problem...I am guessing I could have  printed the
> > ids of the problem docs and just reindex those? I have to deal with  
> > this
> > at many other sites, so that may be my attack...I cannot reindex
> > everything to fix.
> 
> It would be great to know if that workaround works (and indeed it's a  
> per-doc issue).  I'd also love to know how many docs are affected,  
> when you hit this.
> 
> If there's any way to zip up the index and send it to me, even just  
> the files for the one segment that has the corrupted doc, that'd be  
> great.
> 
> >>
> >> Any prior exceptions on this index?
> >
> > Not that I can recall. One of the indexes was made months ago, prob  
> > with
> > a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
> > site was windows 2003, the other AIX. One site was only 30,000  
> > docs, the
> > other over 1 million.
> >
> >>
> >> Are your docs a variable schema (different fields)?
> >
> > Yes. Lots of different fields depending on the doc.
> >
> >>
> >> Mike
> >
> > Thanks Mike. I am currently trying to duplicate this. I can't go to
> > another site without testing some kind of fix.
> >
> >>
> >> Mark Miller wrote:
> >>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
> >>>
> >>> I finally have one of the stack traces (this comes on the tail
> >>> complete
> >>> laptop failure so I am scrambling here)
> >>>
> >>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
> >>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
> >>>         at java.util.ArrayList.get(ArrayList.java:347)
> >>>         at org.apache.lucene.index.FieldInfos.fieldInfo
> >>> (FieldInfos.java:260)
> >>>         at org.apache.lucene.index.FieldsReader.doc
> >>> (FieldsReader.java:184)
> >>>         at org.apache.lucene.index.SegmentReader.document
> >>> (SegmentReader.java:670)
> >>>         at org.apache.lucene.index.MultiSegmentReader.document
> >>> (MultiSegmentReader.java:257)
> >>>         at org.apache.lucene.search.IndexSearcher.doc
> >>> (IndexSearcher.java:97)
> >>>
> >>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
> >>>> coincidence or it is from 2.3.2 ?
> >>>>
> >>>> env:
> >>>> lucene 2.3.2
> >>>> jdk1.6.0_06 & jdk1.5.0_15
> >>>>
> >>>>
> >>>> QueryString:
> >>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
> >>>> Error: java.lang.ArrayIndexOutOfBoundsException:
> >>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
> >>>> at
> >>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
> >>>> (BooleanScorer2.java:55)
> >>>> at org.apache.lucene.search.BooleanScorer2.score
> >>>> (BooleanScorer2.java:358)
> >>>> at org.apache.lucene.search.BooleanScorer2.score
> >>>> (BooleanScorer2.java:320)
> >>>> at org.apache.lucene.search.IndexSearcher.search
> >>>> (IndexSearcher.java:146)
> >>>> at org.apache.lucene.search.IndexSearcher.search
> >>>> (IndexSearcher.java:113)
> >>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
> >>>> at
> >>>> org.cr.search.TrecQueryRelevanceFeedback.main
> >>>> (TrecQueryRelevanceFeedback.java:776)
> >>>>
> >>>>
> >>>> QueryString:
> >>>> oceanograph^68.48028 vessel^43.191563
> >>>> Error:
> >>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBo 
> >>>> un
> >>>> dsException
> >>>> at java.lang.System.arraycopy(Native Method)
> >>>> at
> >>>> org.apache.lucene.index.TermVectorsReader.readTermVector
> >>>> (TermVectorsReader.java:353)
> >>>> at
> >>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
> >>>> (TermVectorsReader.java:287)
> >>>> at org.apache.lucene.index.TermVectorsReader.get
> >>>> (TermVectorsReader.java:232)
> >>>> at
> >>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
> >>>> (SegmentReader.java:981)
> >>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
> >>>> (RelevanceFeedback.java:134)
> >>>> at
> >>>> org.cr.search.TrecQueryRelevanceFeedback.main
> >>>> (TrecQueryRelevanceFeedback.java:781)
> >>>>
> >>>>
> >>>>
> >>>>
> >>>> Mark Miller wrote:
> >>>>> Any recent changes that would expose index corruption?
> >>>>>
> >>>>> I am getting two new errors when trying to search:
> >>>>>
> >>>>> nullpointer fieldsreaders line 260
> >>>>>
> >>>>> indexoutofbounds on fieldinfo line 185
> >>>>>
> >>>>> I am kind of screwed, because reindexing fixes this, but I cant
> >>>>> reindex!
> >>>>>
> >>>>> Any ideas?
> >>>>>
> >>>>>
> >>>>> ------------------------------------------------------------------ 
> >>>>> --
> >>>>> -
> >>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>>
> >>>>>
> >>>>
> >>>>
> >>>> ------------------------------------------------------------------- 
> >>>> --
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>
> >>>
> >>> -------------------------------------------------------------------- 
> >>> -
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33919-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 22:03:27 2008
Return-Path: <java-user-return-33919-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40353 invoked from network); 5 May 2008 22:03:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 22:03:26 -0000
Received: (qmail 86836 invoked by uid 500); 5 May 2008 22:03:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86797 invoked by uid 500); 5 May 2008 22:03:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86786 invoked by uid 99); 5 May 2008 22:03:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 15:03:20 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.132.247 as permitted sender)
Received: from [209.85.132.247] (HELO an-out-0708.google.com) (209.85.132.247)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 22:02:34 +0000
Received: by an-out-0708.google.com with SMTP id c37so633143anc.49
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 15:02:48 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=ryIuRfDdb5ZebYO5498WMbZU7f/yxzXJVRBQpep338M=;
        b=BQ0fgs3qL0wGT5f3HuKwHWLiQa3uhrUTe7/BiEoP7bqqEPqg1SEihuaHs8vOG93apg+XLK4L6KukI1fV82/CWqE9qem+xW9BQVizMMG7tDDhJwGoHpISCKuujCHGEk9GgsZAhb+AnO28MikYQ7HQhmJgTOwa3gFCasdxq9TZbn8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=cXpCO4Kb2w4YyX30qkcKgb6hQ8L7e49Ci+Ehcal8QKonI5E8PXZwSyLEYPpmWlmYtI+w/a0IQtTpCmkSObxV9oGd73zCK+EU2xFzrVLgklEfiKiLmDm8NXTnTaD4dywIvP1NLzv/j77AUatrTWhCvmI9yI0Czvlbti35m1slqG4=
Received: by 10.100.153.6 with SMTP id a6mr8475386ane.119.1210024967718;
        Mon, 05 May 2008 15:02:47 -0700 (PDT)
Received: from ?192.168.1.104? ( [209.134.38.5])
        by mx.google.com with ESMTPS id b19sm12252989ana.19.2008.05.05.15.02.45
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 15:02:46 -0700 (PDT)
Subject: Re: index corruption with latest lucene
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <481F7CF4.9020402@gmail.com>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com>
	 <1210017407.11339.16.camel@m-laptop>
	 <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>
	 <1210021246.11339.30.camel@m-laptop>
	 <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>
	 <481F7CF4.9020402@gmail.com>
Content-Type: text/plain
Date: Mon, 05 May 2008 18:02:44 -0400
Message-Id: <1210024964.11339.40.camel@m-laptop>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Man, I have even confused myself on these versions at this point. Let me
start over.

I am having the problem with a version of lucene that was the trunk late
last week. Which pretty much means 2.3.2.

I'd hate to hold up the release if the problem was only me though. I am
trying to work through it as fast I can. I just have to find another
index somewhere with the problem. Its just difficult because the indexes
are very large and on remote live sites. I am hoping I can find another
old test one with the problem or make one. The two installs that I have
detected the problem were rebuilt, one inadvertently.

- Mark

On Mon, 2008-05-05 at 14:32 -0700, Michael Busch wrote:
> If that is the case then I will go ahead and publish the 2.3.2 release? 
> Have you seen this on 2.3.x, Mark?
> 
> -Michael
> 
> Michael McCandless wrote:
> > 
> > Actually that stack trace looks like it's from trunk, not from 
> > 2.3.2(pre)?  OK, I think you said it's from "post 2.3 trunk".
> > 
> > Another question: is autoCommit false or true?
> > 
> > More responses below:
> > 
> > Mark Miller wrote:
> >> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
> >>> Hi Mark,
> >>>
> >>> Not good!
> >>>
> >>> Can you describe how this index was created?  Did you use multiple
> >>> threads on one IndexWriter?  Multiple sessions of IndexWriter
> >>> appending to the index?  addIndexes*?  Is the index copied from one
> >>> place to another after being written and before being searched?
> >>
> >> Both sites were created by a single thread on a single IndexWriter.
> >> Updates are done through multiple threads and one IndexWriter. No
> >> addIndexes. Index was never copied, always same path.
> >>
> >>>
> >>> If you run CheckIndex, what does it report?
> >>
> >> This was my next move...unfortunately, someone accidentally kicked off a
> >> complete reindex before I could do it. From what I can tell by the stack
> >> trace, its a per doc problem...I am guessing I could have  printed the
> >> ids of the problem docs and just reindex those? I have to deal with this
> >> at many other sites, so that may be my attack...I cannot reindex
> >> everything to fix.
> > 
> > It would be great to know if that workaround works (and indeed it's a 
> > per-doc issue).  I'd also love to know how many docs are affected, when 
> > you hit this.
> > 
> > If there's any way to zip up the index and send it to me, even just the 
> > files for the one segment that has the corrupted doc, that'd be great.
> > 
> >>>
> >>> Any prior exceptions on this index?
> >>
> >> Not that I can recall. One of the indexes was made months ago, prob with
> >> a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
> >> site was windows 2003, the other AIX. One site was only 30,000 docs, the
> >> other over 1 million.
> >>
> >>>
> >>> Are your docs a variable schema (different fields)?
> >>
> >> Yes. Lots of different fields depending on the doc.
> >>
> >>>
> >>> Mike
> >>
> >> Thanks Mike. I am currently trying to duplicate this. I can't go to
> >> another site without testing some kind of fix.
> >>
> >>>
> >>> Mark Miller wrote:
> >>>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
> >>>>
> >>>> I finally have one of the stack traces (this comes on the tail
> >>>> complete
> >>>> laptop failure so I am scrambling here)
> >>>>
> >>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
> >>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
> >>>>         at java.util.ArrayList.get(ArrayList.java:347)
> >>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
> >>>> (FieldInfos.java:260)
> >>>>         at org.apache.lucene.index.FieldsReader.doc
> >>>> (FieldsReader.java:184)
> >>>>         at org.apache.lucene.index.SegmentReader.document
> >>>> (SegmentReader.java:670)
> >>>>         at org.apache.lucene.index.MultiSegmentReader.document
> >>>> (MultiSegmentReader.java:257)
> >>>>         at org.apache.lucene.search.IndexSearcher.doc
> >>>> (IndexSearcher.java:97)
> >>>>
> >>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
> >>>>> coincidence or it is from 2.3.2 ?
> >>>>>
> >>>>> env:
> >>>>> lucene 2.3.2
> >>>>> jdk1.6.0_06 & jdk1.5.0_15
> >>>>>
> >>>>>
> >>>>> QueryString:
> >>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
> >>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
> >>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
> >>>>> at
> >>>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
> >>>>> (BooleanScorer2.java:55)
> >>>>> at org.apache.lucene.search.BooleanScorer2.score
> >>>>> (BooleanScorer2.java:358)
> >>>>> at org.apache.lucene.search.BooleanScorer2.score
> >>>>> (BooleanScorer2.java:320)
> >>>>> at org.apache.lucene.search.IndexSearcher.search
> >>>>> (IndexSearcher.java:146)
> >>>>> at org.apache.lucene.search.IndexSearcher.search
> >>>>> (IndexSearcher.java:113)
> >>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
> >>>>> at
> >>>>> org.cr.search.TrecQueryRelevanceFeedback.main
> >>>>> (TrecQueryRelevanceFeedback.java:776)
> >>>>>
> >>>>>
> >>>>> QueryString:
> >>>>> oceanograph^68.48028 vessel^43.191563
> >>>>> Error:
> >>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBoun
> >>>>> dsException
> >>>>> at java.lang.System.arraycopy(Native Method)
> >>>>> at
> >>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
> >>>>> (TermVectorsReader.java:353)
> >>>>> at
> >>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
> >>>>> (TermVectorsReader.java:287)
> >>>>> at org.apache.lucene.index.TermVectorsReader.get
> >>>>> (TermVectorsReader.java:232)
> >>>>> at
> >>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
> >>>>> (SegmentReader.java:981)
> >>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
> >>>>> (RelevanceFeedback.java:134)
> >>>>> at
> >>>>> org.cr.search.TrecQueryRelevanceFeedback.main
> >>>>> (TrecQueryRelevanceFeedback.java:781)
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>> Mark Miller wrote:
> >>>>>> Any recent changes that would expose index corruption?
> >>>>>>
> >>>>>> I am getting two new errors when trying to search:
> >>>>>>
> >>>>>> nullpointer fieldsreaders line 260
> >>>>>>
> >>>>>> indexoutofbounds on fieldinfo line 185
> >>>>>>
> >>>>>> I am kind of screwed, because reindexing fixes this, but I cant
> >>>>>> reindex!
> >>>>>>
> >>>>>> Any ideas?
> >>>>>>
> >>>>>>
> >>>>>> --------------------------------------------------------------------
> >>>>>> -
> >>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>>>
> >>>>>>
> >>>>>
> >>>>>
> >>>>> ---------------------------------------------------------------------
> >>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>>
> >>>>
> >>>>
> >>>> ---------------------------------------------------------------------
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>
> >>>
> >>> ---------------------------------------------------------------------
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> > 
> > 
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> > 
> > 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33920-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 22:07:41 2008
Return-Path: <java-user-return-33920-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43297 invoked from network); 5 May 2008 22:07:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 22:07:41 -0000
Received: (qmail 92535 invoked by uid 500); 5 May 2008 22:07:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92512 invoked by uid 500); 5 May 2008 22:07:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92501 invoked by uid 99); 5 May 2008 22:07:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 15:07:36 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.14.246.246] (HELO ag-out-0708.google.com) (72.14.246.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 22:06:50 +0000
Received: by ag-out-0708.google.com with SMTP id 23so769507agd.11
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 15:07:02 -0700 (PDT)
Received: by 10.101.68.19 with SMTP id v19mr8507470ank.75.1210025221869;
        Mon, 05 May 2008 15:07:01 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id b37sm12160478ana.33.2008.05.05.15.07.00
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 05 May 2008 15:07:01 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <1210023301.11339.34.camel@m-laptop>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com> <1210017407.11339.16.camel@m-laptop> <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com> <1210021246.11339.30.camel@m-laptop> <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com> <1210023301.11339.34.camel@m-laptop>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <220AD8BD-C0BE-465E-8C64-39797EAA8AAC@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: index corruption with latest lucene
Date: Mon, 5 May 2008 18:07:48 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Mark,

Which exact version of the JRE are you using?

Mike

Mark Miller wrote:
> On Mon, 2008-05-05 at 17:26 -0400, Michael McCandless wrote:
>> Actually that stack trace looks like it's from trunk, not from 2.3.2
>> (pre)?  OK, I think you said it's from "post 2.3 trunk".
>
> Right...the Lucene that showed the problem was build from a trunk grab
> late last week. One of the problem indexes was built with a 2.0 or 2.1
> and the other was built with a post 2.3 trunk (but weeks (prob months)
> before the one i grabbed late last week :) )
>
>>
>> Another question: is autoCommit false or true?
> false
>
>
>
> If I can get you an affected index I will.
>
> - mark
>
>
>>
>> More responses below:
>>
>> Mark Miller wrote:
>>> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
>>>> Hi Mark,
>>>>
>>>> Not good!
>>>>
>>>> Can you describe how this index was created?  Did you use multiple
>>>> threads on one IndexWriter?  Multiple sessions of IndexWriter
>>>> appending to the index?  addIndexes*?  Is the index copied from one
>>>> place to another after being written and before being searched?
>>>
>>> Both sites were created by a single thread on a single IndexWriter.
>>> Updates are done through multiple threads and one IndexWriter. No
>>> addIndexes. Index was never copied, always same path.
>>>
>>>>
>>>> If you run CheckIndex, what does it report?
>>>
>>> This was my next move...unfortunately, someone accidentally kicked
>>> off a
>>> complete reindex before I could do it. From what I can tell by the
>>> stack
>>> trace, its a per doc problem...I am guessing I could have   
>>> printed the
>>> ids of the problem docs and just reindex those? I have to deal with
>>> this
>>> at many other sites, so that may be my attack...I cannot reindex
>>> everything to fix.
>>
>> It would be great to know if that workaround works (and indeed it's a
>> per-doc issue).  I'd also love to know how many docs are affected,
>> when you hit this.
>>
>> If there's any way to zip up the index and send it to me, even just
>> the files for the one segment that has the corrupted doc, that'd be
>> great.
>>
>>>>
>>>> Any prior exceptions on this index?
>>>
>>> Not that I can recall. One of the indexes was made months ago, prob
>>> with
>>> a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
>>> site was windows 2003, the other AIX. One site was only 30,000
>>> docs, the
>>> other over 1 million.
>>>
>>>>
>>>> Are your docs a variable schema (different fields)?
>>>
>>> Yes. Lots of different fields depending on the doc.
>>>
>>>>
>>>> Mike
>>>
>>> Thanks Mike. I am currently trying to duplicate this. I can't go to
>>> another site without testing some kind of fix.
>>>
>>>>
>>>> Mark Miller wrote:
>>>>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
>>>>>
>>>>> I finally have one of the stack traces (this comes on the tail
>>>>> complete
>>>>> laptop failure so I am scrambling here)
>>>>>
>>>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
>>>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
>>>>>         at java.util.ArrayList.get(ArrayList.java:347)
>>>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
>>>>> (FieldInfos.java:260)
>>>>>         at org.apache.lucene.index.FieldsReader.doc
>>>>> (FieldsReader.java:184)
>>>>>         at org.apache.lucene.index.SegmentReader.document
>>>>> (SegmentReader.java:670)
>>>>>         at org.apache.lucene.index.MultiSegmentReader.document
>>>>> (MultiSegmentReader.java:257)
>>>>>         at org.apache.lucene.search.IndexSearcher.doc
>>>>> (IndexSearcher.java:97)
>>>>>
>>>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
>>>>>> coincidence or it is from 2.3.2 ?
>>>>>>
>>>>>> env:
>>>>>> lucene 2.3.2
>>>>>> jdk1.6.0_06 & jdk1.5.0_15
>>>>>>
>>>>>>
>>>>>> QueryString:
>>>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
>>>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
>>>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
>>>>>> at
>>>>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
>>>>>> (BooleanScorer2.java:55)
>>>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>>>> (BooleanScorer2.java:358)
>>>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>>>> (BooleanScorer2.java:320)
>>>>>> at org.apache.lucene.search.IndexSearcher.search
>>>>>> (IndexSearcher.java:146)
>>>>>> at org.apache.lucene.search.IndexSearcher.search
>>>>>> (IndexSearcher.java:113)
>>>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
>>>>>> at
>>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>>>> (TrecQueryRelevanceFeedback.java:776)
>>>>>>
>>>>>>
>>>>>> QueryString:
>>>>>> oceanograph^68.48028 vessel^43.191563
>>>>>> Error:
>>>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOf 
>>>>>> Bo
>>>>>> un
>>>>>> dsException
>>>>>> at java.lang.System.arraycopy(Native Method)
>>>>>> at
>>>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
>>>>>> (TermVectorsReader.java:353)
>>>>>> at
>>>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
>>>>>> (TermVectorsReader.java:287)
>>>>>> at org.apache.lucene.index.TermVectorsReader.get
>>>>>> (TermVectorsReader.java:232)
>>>>>> at
>>>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
>>>>>> (SegmentReader.java:981)
>>>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
>>>>>> (RelevanceFeedback.java:134)
>>>>>> at
>>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>>>> (TrecQueryRelevanceFeedback.java:781)
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> Mark Miller wrote:
>>>>>>> Any recent changes that would expose index corruption?
>>>>>>>
>>>>>>> I am getting two new errors when trying to search:
>>>>>>>
>>>>>>> nullpointer fieldsreaders line 260
>>>>>>>
>>>>>>> indexoutofbounds on fieldinfo line 185
>>>>>>>
>>>>>>> I am kind of screwed, because reindexing fixes this, but I cant
>>>>>>> reindex!
>>>>>>>
>>>>>>> Any ideas?
>>>>>>>
>>>>>>>
>>>>>>> ---------------------------------------------------------------- 
>>>>>>> --
>>>>>>> --
>>>>>>> -
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user- 
>>>>>>> help@lucene.apache.org
>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>> ----------------------------------------------------------------- 
>>>>>> --
>>>>>> --
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>
>>>>>
>>>>> ------------------------------------------------------------------ 
>>>>> --
>>>>> -
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>
>>>>
>>>> ------------------------------------------------------------------- 
>>>> --
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33921-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 22:10:08 2008
Return-Path: <java-user-return-33921-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43832 invoked from network); 5 May 2008 22:10:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 22:10:08 -0000
Received: (qmail 95867 invoked by uid 500); 5 May 2008 22:10:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95837 invoked by uid 500); 5 May 2008 22:10:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95826 invoked by uid 99); 5 May 2008 22:10:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 15:10:02 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 64.233.166.183 as permitted sender)
Received: from [64.233.166.183] (HELO py-out-1112.google.com) (64.233.166.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 22:09:17 +0000
Received: by py-out-1112.google.com with SMTP id z74so1738632pyg.9
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 15:09:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=qJFhLsUXj3lva/V8uY0NnhGqtM0S9ruWow4ShvWCRwU=;
        b=sbd1P2zZayaHAu9DfoIDQSbfoqkfUuiJzaFw3Dz0gkxNMkRn6LVXxr/vR8xFHlCbDuMrg5J7G3vsYAQmfS/VOrQdlPpBTSUxN/aVHj1rd/gGFlXzUhVC+g8RvGb5yrU4S/lb0JCQsbTVMmuJrjyWcnL97O8YV2aIYtghspfhkt8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=Z0lzXBJzvApHThRkpwN5C+N0807f2FMyJvX4YAfG/WcTg62LkKCPi8g6M4HjGODn6RC6uJJljaar0JLeFiVdnmfZGqR32Iih/8nBu8TngAJ4bwGKfyen3fe94ZWoa/c5IjVmYISyYvmD4MBjW0MQc4+NtoE8qYnIf//S8m7uzWM=
Received: by 10.35.93.1 with SMTP id v1mr12283767pyl.57.1210025370905;
        Mon, 05 May 2008 15:09:30 -0700 (PDT)
Received: from ?9.30.38.211? ( [129.42.184.35])
        by mx.google.com with ESMTPS id f55sm21494374pyh.28.2008.05.05.15.09.29
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 15:09:29 -0700 (PDT)
Message-ID: <481F8525.1010604@gmail.com>
Date: Mon, 05 May 2008 15:07:33 -0700
From: Michael Busch <buschmic@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: index corruption with latest lucene
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com>	 <1210017407.11339.16.camel@m-laptop>	 <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>	 <1210021246.11339.30.camel@m-laptop>	 <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>	 <481F7CF4.9020402@gmail.com> <1210024964.11339.40.camel@m-laptop>
In-Reply-To: <1210024964.11339.40.camel@m-laptop>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Yeah, it's probably confusing, because we currently commit patches to 
two branches: the trunk (/repos/asf/lucene/java/trunk) and the 2.3 
branch (/repos/asf/lucene/java/branches/lucene_2_3).

So if you checked out from the trunk, then this is not the 2.3.2 
version. The 2.3.2 release candidate is from the 2.3 branch, revision 
652650.

-Michael

Mark Miller wrote:
> Man, I have even confused myself on these versions at this point. Let me
> start over.
> 
> I am having the problem with a version of lucene that was the trunk late
> last week. Which pretty much means 2.3.2.
> 
> I'd hate to hold up the release if the problem was only me though. I am
> trying to work through it as fast I can. I just have to find another
> index somewhere with the problem. Its just difficult because the indexes
> are very large and on remote live sites. I am hoping I can find another
> old test one with the problem or make one. The two installs that I have
> detected the problem were rebuilt, one inadvertently.
> 
> - Mark
> 
> On Mon, 2008-05-05 at 14:32 -0700, Michael Busch wrote:
>> If that is the case then I will go ahead and publish the 2.3.2 release? 
>> Have you seen this on 2.3.x, Mark?
>>
>> -Michael
>>
>> Michael McCandless wrote:
>>> Actually that stack trace looks like it's from trunk, not from 
>>> 2.3.2(pre)?  OK, I think you said it's from "post 2.3 trunk".
>>>
>>> Another question: is autoCommit false or true?
>>>
>>> More responses below:
>>>
>>> Mark Miller wrote:
>>>> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
>>>>> Hi Mark,
>>>>>
>>>>> Not good!
>>>>>
>>>>> Can you describe how this index was created?  Did you use multiple
>>>>> threads on one IndexWriter?  Multiple sessions of IndexWriter
>>>>> appending to the index?  addIndexes*?  Is the index copied from one
>>>>> place to another after being written and before being searched?
>>>> Both sites were created by a single thread on a single IndexWriter.
>>>> Updates are done through multiple threads and one IndexWriter. No
>>>> addIndexes. Index was never copied, always same path.
>>>>
>>>>> If you run CheckIndex, what does it report?
>>>> This was my next move...unfortunately, someone accidentally kicked off a
>>>> complete reindex before I could do it. From what I can tell by the stack
>>>> trace, its a per doc problem...I am guessing I could have  printed the
>>>> ids of the problem docs and just reindex those? I have to deal with this
>>>> at many other sites, so that may be my attack...I cannot reindex
>>>> everything to fix.
>>> It would be great to know if that workaround works (and indeed it's a 
>>> per-doc issue).  I'd also love to know how many docs are affected, when 
>>> you hit this.
>>>
>>> If there's any way to zip up the index and send it to me, even just the 
>>> files for the one segment that has the corrupted doc, that'd be great.
>>>
>>>>> Any prior exceptions on this index?
>>>> Not that I can recall. One of the indexes was made months ago, prob with
>>>> a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
>>>> site was windows 2003, the other AIX. One site was only 30,000 docs, the
>>>> other over 1 million.
>>>>
>>>>> Are your docs a variable schema (different fields)?
>>>> Yes. Lots of different fields depending on the doc.
>>>>
>>>>> Mike
>>>> Thanks Mike. I am currently trying to duplicate this. I can't go to
>>>> another site without testing some kind of fix.
>>>>
>>>>> Mark Miller wrote:
>>>>>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
>>>>>>
>>>>>> I finally have one of the stack traces (this comes on the tail
>>>>>> complete
>>>>>> laptop failure so I am scrambling here)
>>>>>>
>>>>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
>>>>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
>>>>>>         at java.util.ArrayList.get(ArrayList.java:347)
>>>>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
>>>>>> (FieldInfos.java:260)
>>>>>>         at org.apache.lucene.index.FieldsReader.doc
>>>>>> (FieldsReader.java:184)
>>>>>>         at org.apache.lucene.index.SegmentReader.document
>>>>>> (SegmentReader.java:670)
>>>>>>         at org.apache.lucene.index.MultiSegmentReader.document
>>>>>> (MultiSegmentReader.java:257)
>>>>>>         at org.apache.lucene.search.IndexSearcher.doc
>>>>>> (IndexSearcher.java:97)
>>>>>>
>>>>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
>>>>>>> coincidence or it is from 2.3.2 ?
>>>>>>>
>>>>>>> env:
>>>>>>> lucene 2.3.2
>>>>>>> jdk1.6.0_06 & jdk1.5.0_15
>>>>>>>
>>>>>>>
>>>>>>> QueryString:
>>>>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
>>>>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
>>>>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
>>>>>>> at
>>>>>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
>>>>>>> (BooleanScorer2.java:55)
>>>>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>>>>> (BooleanScorer2.java:358)
>>>>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>>>>> (BooleanScorer2.java:320)
>>>>>>> at org.apache.lucene.search.IndexSearcher.search
>>>>>>> (IndexSearcher.java:146)
>>>>>>> at org.apache.lucene.search.IndexSearcher.search
>>>>>>> (IndexSearcher.java:113)
>>>>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
>>>>>>> at
>>>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>>>>> (TrecQueryRelevanceFeedback.java:776)
>>>>>>>
>>>>>>>
>>>>>>> QueryString:
>>>>>>> oceanograph^68.48028 vessel^43.191563
>>>>>>> Error:
>>>>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBoun
>>>>>>> dsException
>>>>>>> at java.lang.System.arraycopy(Native Method)
>>>>>>> at
>>>>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
>>>>>>> (TermVectorsReader.java:353)
>>>>>>> at
>>>>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
>>>>>>> (TermVectorsReader.java:287)
>>>>>>> at org.apache.lucene.index.TermVectorsReader.get
>>>>>>> (TermVectorsReader.java:232)
>>>>>>> at
>>>>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
>>>>>>> (SegmentReader.java:981)
>>>>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
>>>>>>> (RelevanceFeedback.java:134)
>>>>>>> at
>>>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>>>>> (TrecQueryRelevanceFeedback.java:781)
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> Mark Miller wrote:
>>>>>>>> Any recent changes that would expose index corruption?
>>>>>>>>
>>>>>>>> I am getting two new errors when trying to search:
>>>>>>>>
>>>>>>>> nullpointer fieldsreaders line 260
>>>>>>>>
>>>>>>>> indexoutofbounds on fieldinfo line 185
>>>>>>>>
>>>>>>>> I am kind of screwed, because reindexing fixes this, but I cant
>>>>>>>> reindex!
>>>>>>>>
>>>>>>>> Any ideas?
>>>>>>>>
>>>>>>>>
>>>>>>>> --------------------------------------------------------------------
>>>>>>>> -
>>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>> ---------------------------------------------------------------------
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>
>>>>>>
>>>>>> ---------------------------------------------------------------------
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33922-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 22:25:18 2008
Return-Path: <java-user-return-33922-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49188 invoked from network); 5 May 2008 22:25:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 22:25:18 -0000
Received: (qmail 11047 invoked by uid 500); 5 May 2008 22:25:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11013 invoked by uid 500); 5 May 2008 22:25:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11002 invoked by uid 99); 5 May 2008 22:25:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 15:25:12 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 64.233.184.234 as permitted sender)
Received: from [64.233.184.234] (HELO wr-out-0506.google.com) (64.233.184.234)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 22:24:26 +0000
Received: by wr-out-0506.google.com with SMTP id c30so8718wra.14
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 15:24:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=rWHU1Tal7I78c/xEvGwRpUnYhASRxZfSzMZrtgMV35g=;
        b=RuLgoVVp1yV2Jcy2fullfx3LpgZuhRJFn9Z/yXzhQ14j2N5CBpN1ZcC9616VqHDoi2FZE5j5tmBB7BzR0FtI1QyU+DjETK0Ng+flA+rlHYzhaYUhYHsX1UlaSSmW4qO3BaXQrIKOTcLop9+OtqpPq3qJJqysBLvwLwhKp7zfRpk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=YRA4bJ3EHnrbOs+6y/RUxBt9EpF6MVKrMU/uMytkOWQu0oWBRMMtWzHL7jlH/rJCDarXgt9p7Yvt9QUVSOOENQ4GveWvhiQsZVgTg0gtbXYYTu2JoAAUfZYX5UPHHxO8tq2Uui7uMhxim7caTBgR0cALR/THEVkQvl9SQHLbgBA=
Received: by 10.100.173.9 with SMTP id v9mr8495224ane.150.1210026280015;
        Mon, 05 May 2008 15:24:40 -0700 (PDT)
Received: from ?192.168.1.104? ( [209.134.38.5])
        by mx.google.com with ESMTPS id d29sm12286394and.12.2008.05.05.15.24.37
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 15:24:38 -0700 (PDT)
Subject: Re: index corruption with latest lucene
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <220AD8BD-C0BE-465E-8C64-39797EAA8AAC@mikemccandless.com>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com>
	 <1210017407.11339.16.camel@m-laptop>
	 <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>
	 <1210021246.11339.30.camel@m-laptop>
	 <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>
	 <1210023301.11339.34.camel@m-laptop>
	 <220AD8BD-C0BE-465E-8C64-39797EAA8AAC@mikemccandless.com>
Content-Type: text/plain
Date: Mon, 05 May 2008 18:24:31 -0400
Message-Id: <1210026272.11339.51.camel@m-laptop>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

MB: Ah, thanks for clearing the version stuff up...I just assumed that
trunk last week was pretty close to 2.3.1. I am def trunk last thurs or
fri. Perhaps the problem is after 2.3.1, and perhaps the problem is only
with me.

MM: FYI- I upgraded a really old test install (hasnt been touched by a
new version of lucene since mid last year) and it had no issues in it.
The install was almost identical to the install I had problems with, the
difference being that the problem install was created and touched by
later versions of Lucene.

I often (foolishly/bravely) work off the trunk for features I want, so
its entirely possible I have created my own pain, and point release
users may not be affected.

The win 2003 java version is 1.6.0_5

The AIX version I cannot check right now, but is 1.5 something (prob one
version before the one they released a week or 3 ago.

- Mark


On Mon, 2008-05-05 at 18:07 -0400, Michael McCandless wrote:
> Mark,
> 
> Which exact version of the JRE are you using?
> 
> Mike
> 
> Mark Miller wrote:
> > On Mon, 2008-05-05 at 17:26 -0400, Michael McCandless wrote:
> >> Actually that stack trace looks like it's from trunk, not from 2.3.2
> >> (pre)?  OK, I think you said it's from "post 2.3 trunk".
> >
> > Right...the Lucene that showed the problem was build from a trunk grab
> > late last week. One of the problem indexes was built with a 2.0 or 2.1
> > and the other was built with a post 2.3 trunk (but weeks (prob months)
> > before the one i grabbed late last week :) )
> >
> >>
> >> Another question: is autoCommit false or true?
> > false
> >
> >
> >
> > If I can get you an affected index I will.
> >
> > - mark
> >
> >
> >>
> >> More responses below:
> >>
> >> Mark Miller wrote:
> >>> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
> >>>> Hi Mark,
> >>>>
> >>>> Not good!
> >>>>
> >>>> Can you describe how this index was created?  Did you use multiple
> >>>> threads on one IndexWriter?  Multiple sessions of IndexWriter
> >>>> appending to the index?  addIndexes*?  Is the index copied from one
> >>>> place to another after being written and before being searched?
> >>>
> >>> Both sites were created by a single thread on a single IndexWriter.
> >>> Updates are done through multiple threads and one IndexWriter. No
> >>> addIndexes. Index was never copied, always same path.
> >>>
> >>>>
> >>>> If you run CheckIndex, what does it report?
> >>>
> >>> This was my next move...unfortunately, someone accidentally kicked
> >>> off a
> >>> complete reindex before I could do it. From what I can tell by the
> >>> stack
> >>> trace, its a per doc problem...I am guessing I could have   
> >>> printed the
> >>> ids of the problem docs and just reindex those? I have to deal with
> >>> this
> >>> at many other sites, so that may be my attack...I cannot reindex
> >>> everything to fix.
> >>
> >> It would be great to know if that workaround works (and indeed it's a
> >> per-doc issue).  I'd also love to know how many docs are affected,
> >> when you hit this.
> >>
> >> If there's any way to zip up the index and send it to me, even just
> >> the files for the one segment that has the corrupted doc, that'd be
> >> great.
> >>
> >>>>
> >>>> Any prior exceptions on this index?
> >>>
> >>> Not that I can recall. One of the indexes was made months ago, prob
> >>> with
> >>> a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
> >>> site was windows 2003, the other AIX. One site was only 30,000
> >>> docs, the
> >>> other over 1 million.
> >>>
> >>>>
> >>>> Are your docs a variable schema (different fields)?
> >>>
> >>> Yes. Lots of different fields depending on the doc.
> >>>
> >>>>
> >>>> Mike
> >>>
> >>> Thanks Mike. I am currently trying to duplicate this. I can't go to
> >>> another site without testing some kind of fix.
> >>>
> >>>>
> >>>> Mark Miller wrote:
> >>>>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
> >>>>>
> >>>>> I finally have one of the stack traces (this comes on the tail
> >>>>> complete
> >>>>> laptop failure so I am scrambling here)
> >>>>>
> >>>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
> >>>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
> >>>>>         at java.util.ArrayList.get(ArrayList.java:347)
> >>>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
> >>>>> (FieldInfos.java:260)
> >>>>>         at org.apache.lucene.index.FieldsReader.doc
> >>>>> (FieldsReader.java:184)
> >>>>>         at org.apache.lucene.index.SegmentReader.document
> >>>>> (SegmentReader.java:670)
> >>>>>         at org.apache.lucene.index.MultiSegmentReader.document
> >>>>> (MultiSegmentReader.java:257)
> >>>>>         at org.apache.lucene.search.IndexSearcher.doc
> >>>>> (IndexSearcher.java:97)
> >>>>>
> >>>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
> >>>>>> coincidence or it is from 2.3.2 ?
> >>>>>>
> >>>>>> env:
> >>>>>> lucene 2.3.2
> >>>>>> jdk1.6.0_06 & jdk1.5.0_15
> >>>>>>
> >>>>>>
> >>>>>> QueryString:
> >>>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
> >>>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
> >>>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
> >>>>>> at
> >>>>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
> >>>>>> (BooleanScorer2.java:55)
> >>>>>> at org.apache.lucene.search.BooleanScorer2.score
> >>>>>> (BooleanScorer2.java:358)
> >>>>>> at org.apache.lucene.search.BooleanScorer2.score
> >>>>>> (BooleanScorer2.java:320)
> >>>>>> at org.apache.lucene.search.IndexSearcher.search
> >>>>>> (IndexSearcher.java:146)
> >>>>>> at org.apache.lucene.search.IndexSearcher.search
> >>>>>> (IndexSearcher.java:113)
> >>>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
> >>>>>> at
> >>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
> >>>>>> (TrecQueryRelevanceFeedback.java:776)
> >>>>>>
> >>>>>>
> >>>>>> QueryString:
> >>>>>> oceanograph^68.48028 vessel^43.191563
> >>>>>> Error:
> >>>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOf 
> >>>>>> Bo
> >>>>>> un
> >>>>>> dsException
> >>>>>> at java.lang.System.arraycopy(Native Method)
> >>>>>> at
> >>>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
> >>>>>> (TermVectorsReader.java:353)
> >>>>>> at
> >>>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
> >>>>>> (TermVectorsReader.java:287)
> >>>>>> at org.apache.lucene.index.TermVectorsReader.get
> >>>>>> (TermVectorsReader.java:232)
> >>>>>> at
> >>>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
> >>>>>> (SegmentReader.java:981)
> >>>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
> >>>>>> (RelevanceFeedback.java:134)
> >>>>>> at
> >>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
> >>>>>> (TrecQueryRelevanceFeedback.java:781)
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>> Mark Miller wrote:
> >>>>>>> Any recent changes that would expose index corruption?
> >>>>>>>
> >>>>>>> I am getting two new errors when trying to search:
> >>>>>>>
> >>>>>>> nullpointer fieldsreaders line 260
> >>>>>>>
> >>>>>>> indexoutofbounds on fieldinfo line 185
> >>>>>>>
> >>>>>>> I am kind of screwed, because reindexing fixes this, but I cant
> >>>>>>> reindex!
> >>>>>>>
> >>>>>>> Any ideas?
> >>>>>>>
> >>>>>>>
> >>>>>>> ---------------------------------------------------------------- 
> >>>>>>> --
> >>>>>>> --
> >>>>>>> -
> >>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>>>> For additional commands, e-mail: java-user- 
> >>>>>>> help@lucene.apache.org
> >>>>>>>
> >>>>>>>
> >>>>>>
> >>>>>>
> >>>>>> ----------------------------------------------------------------- 
> >>>>>> --
> >>>>>> --
> >>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>>>
> >>>>>
> >>>>>
> >>>>> ------------------------------------------------------------------ 
> >>>>> --
> >>>>> -
> >>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>>
> >>>>
> >>>>
> >>>> ------------------------------------------------------------------- 
> >>>> --
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>
> >>>
> >>> -------------------------------------------------------------------- 
> >>> -
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33923-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 22:28:06 2008
Return-Path: <java-user-return-33923-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49486 invoked from network); 5 May 2008 22:28:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 22:28:06 -0000
Received: (qmail 13047 invoked by uid 500); 5 May 2008 22:28:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12999 invoked by uid 500); 5 May 2008 22:28:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12988 invoked by uid 99); 5 May 2008 22:28:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 15:28:00 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.132.244 as permitted sender)
Received: from [209.85.132.244] (HELO an-out-0708.google.com) (209.85.132.244)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 22:27:06 +0000
Received: by an-out-0708.google.com with SMTP id c37so635021anc.49
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 15:27:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=xkmcr+mGBi8SE7IUkBUkirZAy4HxzEbyhqYdROMO9JA=;
        b=oDZFEMyiByShOGu9GVp9SoJBysqi7esM2czEGC/6/i4GV/odkV4htRdQ6p3zj/fYURKsd6flTSRCoyQoVqXFfzDxo38ZSxVDq8Mx/SFt3wxHePiGH6ZQWWUBKqFa0RD90ZwWvqHeWSlugTqPq7PSfT80gBQPK2eaAE40xjDX9Xc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=RsTVE/ZFqD+GapFMCaKJAn3lpKzTx5D+J6oVgyYlM53MoSZs2F5ai/2m7ZoprgCzlaLD53OgevSt0lC/YnaLJZORjmhVgVe2JyXQwQuWAXtFZCxGcrAuycGcUJWh+ytAYfgv5pAsZUWL6i73tcRNY9yaz2tLNtdvkLmJEYqXKvo=
Received: by 10.100.93.12 with SMTP id q12mr35759anb.34.1210026446696;
        Mon, 05 May 2008 15:27:26 -0700 (PDT)
Received: from ?192.168.1.104? ( [209.134.38.5])
        by mx.google.com with ESMTPS id d22sm12375836and.2.2008.05.05.15.27.25
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 15:27:25 -0700 (PDT)
Subject: Re: index corruption with latest lucene
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <220AD8BD-C0BE-465E-8C64-39797EAA8AAC@mikemccandless.com>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com>
	 <1210017407.11339.16.camel@m-laptop>
	 <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>
	 <1210021246.11339.30.camel@m-laptop>
	 <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>
	 <1210023301.11339.34.camel@m-laptop>
	 <220AD8BD-C0BE-465E-8C64-39797EAA8AAC@mikemccandless.com>
Content-Type: text/plain
Date: Mon, 05 May 2008 18:27:24 -0400
Message-Id: <1210026444.11339.54.camel@m-laptop>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Sorry,

Also, win 2003 java is sun
AIX is obviously IBM.

On Mon, 2008-05-05 at 18:07 -0400, Michael McCandless wrote:
> Mark,
> 
> Which exact version of the JRE are you using?
> 
> Mike
> 
> Mark Miller wrote:
> > On Mon, 2008-05-05 at 17:26 -0400, Michael McCandless wrote:
> >> Actually that stack trace looks like it's from trunk, not from 2.3.2
> >> (pre)?  OK, I think you said it's from "post 2.3 trunk".
> >
> > Right...the Lucene that showed the problem was build from a trunk grab
> > late last week. One of the problem indexes was built with a 2.0 or 2.1
> > and the other was built with a post 2.3 trunk (but weeks (prob months)
> > before the one i grabbed late last week :) )
> >
> >>
> >> Another question: is autoCommit false or true?
> > false
> >
> >
> >
> > If I can get you an affected index I will.
> >
> > - mark
> >
> >
> >>
> >> More responses below:
> >>
> >> Mark Miller wrote:
> >>> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
> >>>> Hi Mark,
> >>>>
> >>>> Not good!
> >>>>
> >>>> Can you describe how this index was created?  Did you use multiple
> >>>> threads on one IndexWriter?  Multiple sessions of IndexWriter
> >>>> appending to the index?  addIndexes*?  Is the index copied from one
> >>>> place to another after being written and before being searched?
> >>>
> >>> Both sites were created by a single thread on a single IndexWriter.
> >>> Updates are done through multiple threads and one IndexWriter. No
> >>> addIndexes. Index was never copied, always same path.
> >>>
> >>>>
> >>>> If you run CheckIndex, what does it report?
> >>>
> >>> This was my next move...unfortunately, someone accidentally kicked
> >>> off a
> >>> complete reindex before I could do it. From what I can tell by the
> >>> stack
> >>> trace, its a per doc problem...I am guessing I could have   
> >>> printed the
> >>> ids of the problem docs and just reindex those? I have to deal with
> >>> this
> >>> at many other sites, so that may be my attack...I cannot reindex
> >>> everything to fix.
> >>
> >> It would be great to know if that workaround works (and indeed it's a
> >> per-doc issue).  I'd also love to know how many docs are affected,
> >> when you hit this.
> >>
> >> If there's any way to zip up the index and send it to me, even just
> >> the files for the one segment that has the corrupted doc, that'd be
> >> great.
> >>
> >>>>
> >>>> Any prior exceptions on this index?
> >>>
> >>> Not that I can recall. One of the indexes was made months ago, prob
> >>> with
> >>> a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
> >>> site was windows 2003, the other AIX. One site was only 30,000
> >>> docs, the
> >>> other over 1 million.
> >>>
> >>>>
> >>>> Are your docs a variable schema (different fields)?
> >>>
> >>> Yes. Lots of different fields depending on the doc.
> >>>
> >>>>
> >>>> Mike
> >>>
> >>> Thanks Mike. I am currently trying to duplicate this. I can't go to
> >>> another site without testing some kind of fix.
> >>>
> >>>>
> >>>> Mark Miller wrote:
> >>>>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
> >>>>>
> >>>>> I finally have one of the stack traces (this comes on the tail
> >>>>> complete
> >>>>> laptop failure so I am scrambling here)
> >>>>>
> >>>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
> >>>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
> >>>>>         at java.util.ArrayList.get(ArrayList.java:347)
> >>>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
> >>>>> (FieldInfos.java:260)
> >>>>>         at org.apache.lucene.index.FieldsReader.doc
> >>>>> (FieldsReader.java:184)
> >>>>>         at org.apache.lucene.index.SegmentReader.document
> >>>>> (SegmentReader.java:670)
> >>>>>         at org.apache.lucene.index.MultiSegmentReader.document
> >>>>> (MultiSegmentReader.java:257)
> >>>>>         at org.apache.lucene.search.IndexSearcher.doc
> >>>>> (IndexSearcher.java:97)
> >>>>>
> >>>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
> >>>>>> coincidence or it is from 2.3.2 ?
> >>>>>>
> >>>>>> env:
> >>>>>> lucene 2.3.2
> >>>>>> jdk1.6.0_06 & jdk1.5.0_15
> >>>>>>
> >>>>>>
> >>>>>> QueryString:
> >>>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
> >>>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
> >>>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
> >>>>>> at
> >>>>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
> >>>>>> (BooleanScorer2.java:55)
> >>>>>> at org.apache.lucene.search.BooleanScorer2.score
> >>>>>> (BooleanScorer2.java:358)
> >>>>>> at org.apache.lucene.search.BooleanScorer2.score
> >>>>>> (BooleanScorer2.java:320)
> >>>>>> at org.apache.lucene.search.IndexSearcher.search
> >>>>>> (IndexSearcher.java:146)
> >>>>>> at org.apache.lucene.search.IndexSearcher.search
> >>>>>> (IndexSearcher.java:113)
> >>>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
> >>>>>> at
> >>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
> >>>>>> (TrecQueryRelevanceFeedback.java:776)
> >>>>>>
> >>>>>>
> >>>>>> QueryString:
> >>>>>> oceanograph^68.48028 vessel^43.191563
> >>>>>> Error:
> >>>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOf 
> >>>>>> Bo
> >>>>>> un
> >>>>>> dsException
> >>>>>> at java.lang.System.arraycopy(Native Method)
> >>>>>> at
> >>>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
> >>>>>> (TermVectorsReader.java:353)
> >>>>>> at
> >>>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
> >>>>>> (TermVectorsReader.java:287)
> >>>>>> at org.apache.lucene.index.TermVectorsReader.get
> >>>>>> (TermVectorsReader.java:232)
> >>>>>> at
> >>>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
> >>>>>> (SegmentReader.java:981)
> >>>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
> >>>>>> (RelevanceFeedback.java:134)
> >>>>>> at
> >>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
> >>>>>> (TrecQueryRelevanceFeedback.java:781)
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>> Mark Miller wrote:
> >>>>>>> Any recent changes that would expose index corruption?
> >>>>>>>
> >>>>>>> I am getting two new errors when trying to search:
> >>>>>>>
> >>>>>>> nullpointer fieldsreaders line 260
> >>>>>>>
> >>>>>>> indexoutofbounds on fieldinfo line 185
> >>>>>>>
> >>>>>>> I am kind of screwed, because reindexing fixes this, but I cant
> >>>>>>> reindex!
> >>>>>>>
> >>>>>>> Any ideas?
> >>>>>>>
> >>>>>>>
> >>>>>>> ---------------------------------------------------------------- 
> >>>>>>> --
> >>>>>>> --
> >>>>>>> -
> >>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>>>> For additional commands, e-mail: java-user- 
> >>>>>>> help@lucene.apache.org
> >>>>>>>
> >>>>>>>
> >>>>>>
> >>>>>>
> >>>>>> ----------------------------------------------------------------- 
> >>>>>> --
> >>>>>> --
> >>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>>>
> >>>>>
> >>>>>
> >>>>> ------------------------------------------------------------------ 
> >>>>> --
> >>>>> -
> >>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>>
> >>>>
> >>>>
> >>>> ------------------------------------------------------------------- 
> >>>> --
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>
> >>>
> >>> -------------------------------------------------------------------- 
> >>> -
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33924-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 22:31:46 2008
Return-Path: <java-user-return-33924-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49868 invoked from network); 5 May 2008 22:31:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 22:31:46 -0000
Received: (qmail 15270 invoked by uid 500); 5 May 2008 22:31:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15240 invoked by uid 500); 5 May 2008 22:31:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15229 invoked by uid 99); 5 May 2008 22:31:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 15:31:40 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 64.233.166.176 as permitted sender)
Received: from [64.233.166.176] (HELO py-out-1112.google.com) (64.233.166.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 22:30:54 +0000
Received: by py-out-1112.google.com with SMTP id z74so1750295pyg.9
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 15:31:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=qJEZ8zeRtmUk83BSIaYTrvZdRHQVarhzlwyPsjUJH4k=;
        b=mUxBf3xXYyp6OziG8KYqLpyRRXQiMibGx2ZJCRAsE9kAJkNObOSqqOCVxmsfVnn3VFV8toE5PJcOKGusJ85+KDpjw5OQ0GQ6A93+c7kNpe5TyeRPHrltRh+LifmyMgUSH6xnxOSQkJuYAIdp/jRvdXoqt8tu26cugFTqs/gjuGo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=WKySTdxX9g66ieHgFcE3n10TGhKDESOOEeq4fuKvrOGUurGsJB6nd/fXHt3CfdWgtm1E3gZz4rZs2qjZrpm96n6/c8N5/jP8AEVztKA59Y+mYiM9UzfCrpQk/A10Z72A/6ewn8RyjIoktUcjChvsLEZ6uTtYMe1kh3zKF7DwWCA=
Received: by 10.35.84.20 with SMTP id m20mr12327691pyl.55.1210026668279;
        Mon, 05 May 2008 15:31:08 -0700 (PDT)
Received: from ?9.30.38.211? ( [129.42.184.35])
        by mx.google.com with ESMTPS id f45sm1799573pyh.43.2008.05.05.15.31.07
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 15:31:07 -0700 (PDT)
Message-ID: <481F8A37.4000903@gmail.com>
Date: Mon, 05 May 2008 15:29:11 -0700
From: Michael Busch <buschmic@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: index corruption with latest lucene
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com>	 <1210017407.11339.16.camel@m-laptop>	 <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>	 <1210021246.11339.30.camel@m-laptop>	 <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>	 <1210023301.11339.34.camel@m-laptop>	 <220AD8BD-C0BE-465E-8C64-39797EAA8AAC@mikemccandless.com> <1210026272.11339.51.camel@m-laptop>
In-Reply-To: <1210026272.11339.51.camel@m-laptop>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Mark Miller wrote:
> MB: Ah, thanks for clearing the version stuff up...I just assumed that
> trunk last week was pretty close to 2.3.1. I am def trunk last thurs or
> fri. Perhaps the problem is after 2.3.1, and perhaps the problem is only
> with me.
> 

OK, thanks for verifying. I'll go ahead and publish 2.3.2 then. If it 
still turns out that this problem also occurs on the 2_3 branch then we 
can always make a 2.3.3 release.

-Michael

> MM: FYI- I upgraded a really old test install (hasnt been touched by a
> new version of lucene since mid last year) and it had no issues in it.
> The install was almost identical to the install I had problems with, the
> difference being that the problem install was created and touched by
> later versions of Lucene.
> 
> I often (foolishly/bravely) work off the trunk for features I want, so
> its entirely possible I have created my own pain, and point release
> users may not be affected.
> 
> The win 2003 java version is 1.6.0_5
> 
> The AIX version I cannot check right now, but is 1.5 something (prob one
> version before the one they released a week or 3 ago.
> 
> - Mark
> 
> 
> On Mon, 2008-05-05 at 18:07 -0400, Michael McCandless wrote:
>> Mark,
>>
>> Which exact version of the JRE are you using?
>>
>> Mike
>>
>> Mark Miller wrote:
>>> On Mon, 2008-05-05 at 17:26 -0400, Michael McCandless wrote:
>>>> Actually that stack trace looks like it's from trunk, not from 2.3.2
>>>> (pre)?  OK, I think you said it's from "post 2.3 trunk".
>>> Right...the Lucene that showed the problem was build from a trunk grab
>>> late last week. One of the problem indexes was built with a 2.0 or 2.1
>>> and the other was built with a post 2.3 trunk (but weeks (prob months)
>>> before the one i grabbed late last week :) )
>>>
>>>> Another question: is autoCommit false or true?
>>> false
>>>
>>>
>>>
>>> If I can get you an affected index I will.
>>>
>>> - mark
>>>
>>>
>>>> More responses below:
>>>>
>>>> Mark Miller wrote:
>>>>> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
>>>>>> Hi Mark,
>>>>>>
>>>>>> Not good!
>>>>>>
>>>>>> Can you describe how this index was created?  Did you use multiple
>>>>>> threads on one IndexWriter?  Multiple sessions of IndexWriter
>>>>>> appending to the index?  addIndexes*?  Is the index copied from one
>>>>>> place to another after being written and before being searched?
>>>>> Both sites were created by a single thread on a single IndexWriter.
>>>>> Updates are done through multiple threads and one IndexWriter. No
>>>>> addIndexes. Index was never copied, always same path.
>>>>>
>>>>>> If you run CheckIndex, what does it report?
>>>>> This was my next move...unfortunately, someone accidentally kicked
>>>>> off a
>>>>> complete reindex before I could do it. From what I can tell by the
>>>>> stack
>>>>> trace, its a per doc problem...I am guessing I could have   
>>>>> printed the
>>>>> ids of the problem docs and just reindex those? I have to deal with
>>>>> this
>>>>> at many other sites, so that may be my attack...I cannot reindex
>>>>> everything to fix.
>>>> It would be great to know if that workaround works (and indeed it's a
>>>> per-doc issue).  I'd also love to know how many docs are affected,
>>>> when you hit this.
>>>>
>>>> If there's any way to zip up the index and send it to me, even just
>>>> the files for the one segment that has the corrupted doc, that'd be
>>>> great.
>>>>
>>>>>> Any prior exceptions on this index?
>>>>> Not that I can recall. One of the indexes was made months ago, prob
>>>>> with
>>>>> a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
>>>>> site was windows 2003, the other AIX. One site was only 30,000
>>>>> docs, the
>>>>> other over 1 million.
>>>>>
>>>>>> Are your docs a variable schema (different fields)?
>>>>> Yes. Lots of different fields depending on the doc.
>>>>>
>>>>>> Mike
>>>>> Thanks Mike. I am currently trying to duplicate this. I can't go to
>>>>> another site without testing some kind of fix.
>>>>>
>>>>>> Mark Miller wrote:
>>>>>>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
>>>>>>>
>>>>>>> I finally have one of the stack traces (this comes on the tail
>>>>>>> complete
>>>>>>> laptop failure so I am scrambling here)
>>>>>>>
>>>>>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
>>>>>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
>>>>>>>         at java.util.ArrayList.get(ArrayList.java:347)
>>>>>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
>>>>>>> (FieldInfos.java:260)
>>>>>>>         at org.apache.lucene.index.FieldsReader.doc
>>>>>>> (FieldsReader.java:184)
>>>>>>>         at org.apache.lucene.index.SegmentReader.document
>>>>>>> (SegmentReader.java:670)
>>>>>>>         at org.apache.lucene.index.MultiSegmentReader.document
>>>>>>> (MultiSegmentReader.java:257)
>>>>>>>         at org.apache.lucene.search.IndexSearcher.doc
>>>>>>> (IndexSearcher.java:97)
>>>>>>>
>>>>>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
>>>>>>>> coincidence or it is from 2.3.2 ?
>>>>>>>>
>>>>>>>> env:
>>>>>>>> lucene 2.3.2
>>>>>>>> jdk1.6.0_06 & jdk1.5.0_15
>>>>>>>>
>>>>>>>>
>>>>>>>> QueryString:
>>>>>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
>>>>>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
>>>>>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
>>>>>>>> at
>>>>>>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
>>>>>>>> (BooleanScorer2.java:55)
>>>>>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>>>>>> (BooleanScorer2.java:358)
>>>>>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>>>>>> (BooleanScorer2.java:320)
>>>>>>>> at org.apache.lucene.search.IndexSearcher.search
>>>>>>>> (IndexSearcher.java:146)
>>>>>>>> at org.apache.lucene.search.IndexSearcher.search
>>>>>>>> (IndexSearcher.java:113)
>>>>>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
>>>>>>>> at
>>>>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>>>>>> (TrecQueryRelevanceFeedback.java:776)
>>>>>>>>
>>>>>>>>
>>>>>>>> QueryString:
>>>>>>>> oceanograph^68.48028 vessel^43.191563
>>>>>>>> Error:
>>>>>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOf 
>>>>>>>> Bo
>>>>>>>> un
>>>>>>>> dsException
>>>>>>>> at java.lang.System.arraycopy(Native Method)
>>>>>>>> at
>>>>>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
>>>>>>>> (TermVectorsReader.java:353)
>>>>>>>> at
>>>>>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
>>>>>>>> (TermVectorsReader.java:287)
>>>>>>>> at org.apache.lucene.index.TermVectorsReader.get
>>>>>>>> (TermVectorsReader.java:232)
>>>>>>>> at
>>>>>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
>>>>>>>> (SegmentReader.java:981)
>>>>>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
>>>>>>>> (RelevanceFeedback.java:134)
>>>>>>>> at
>>>>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>>>>>> (TrecQueryRelevanceFeedback.java:781)
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>> Mark Miller wrote:
>>>>>>>>> Any recent changes that would expose index corruption?
>>>>>>>>>
>>>>>>>>> I am getting two new errors when trying to search:
>>>>>>>>>
>>>>>>>>> nullpointer fieldsreaders line 260
>>>>>>>>>
>>>>>>>>> indexoutofbounds on fieldinfo line 185
>>>>>>>>>
>>>>>>>>> I am kind of screwed, because reindexing fixes this, but I cant
>>>>>>>>> reindex!
>>>>>>>>>
>>>>>>>>> Any ideas?
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> ---------------------------------------------------------------- 
>>>>>>>>> --
>>>>>>>>> --
>>>>>>>>> -
>>>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>>>> For additional commands, e-mail: java-user- 
>>>>>>>>> help@lucene.apache.org
>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>> ----------------------------------------------------------------- 
>>>>>>>> --
>>>>>>>> --
>>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>>
>>>>>>>
>>>>>>> ------------------------------------------------------------------ 
>>>>>>> --
>>>>>>> -
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>
>>>>>>
>>>>>> ------------------------------------------------------------------- 
>>>>>> --
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>
>>>>> -------------------------------------------------------------------- 
>>>>> -
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33925-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 05 23:20:48 2008
Return-Path: <java-user-return-33925-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61154 invoked from network); 5 May 2008 23:20:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 May 2008 23:20:48 -0000
Received: (qmail 45224 invoked by uid 500); 5 May 2008 23:20:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45197 invoked by uid 500); 5 May 2008 23:20:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45186 invoked by uid 99); 5 May 2008 23:20:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 16:20:43 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 66.249.82.235 as permitted sender)
Received: from [66.249.82.235] (HELO wx-out-0506.google.com) (66.249.82.235)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 May 2008 23:19:57 +0000
Received: by wx-out-0506.google.com with SMTP id h29so278025wxd.20
        for <java-user@lucene.apache.org>; Mon, 05 May 2008 16:20:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=SooQ0bs6nnqIkWRbeQvFek9MyROgjkj2cWtXH8HuIG4=;
        b=EWhBijVZnLhYmGGXyBdhas6QZFCAjOWDlbOWNYrYQ/KGlhWXq06TrVTWAGBY8qYqGBGsf5+aFcd0R9eAtfoxMcfzfCiA7aZFXIYp/w8Fk4A27I0zZi6vq9BYkRTaoHRkm4+K3tmI+nx1L0enwmP0MhHGY6Zm96W1KWJyRae1fm0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=WNnJxy9+Hm2nUDjnZH7QExpqhOGfyWz5QJ7L2DJwJ57fo7oBcvKLUUOCE6idUcz84DiuLsBUq95kHSO+IbK3dg4hj5E5SpJKFiCqPlNY+2aI1BYa0C9KqVZoUhABpBhh5Lw3B+B+NFhPySh31sCzC+7PqjkKPJgG0cS+8gT2PNk=
Received: by 10.100.210.9 with SMTP id i9mr118046ang.0.1210029611113;
        Mon, 05 May 2008 16:20:11 -0700 (PDT)
Received: from ?192.168.1.104? ( [209.134.38.5])
        by mx.google.com with ESMTPS id c14sm15385205ana.4.2008.05.05.16.20.09
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 05 May 2008 16:20:09 -0700 (PDT)
Subject: Re: index corruption with latest lucene
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <220AD8BD-C0BE-465E-8C64-39797EAA8AAC@mikemccandless.com>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com>
	 <1210017407.11339.16.camel@m-laptop>
	 <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>
	 <1210021246.11339.30.camel@m-laptop>
	 <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>
	 <1210023301.11339.34.camel@m-laptop>
	 <220AD8BD-C0BE-465E-8C64-39797EAA8AAC@mikemccandless.com>
Content-Type: text/plain
Date: Mon, 05 May 2008 19:20:08 -0400
Message-Id: <1210029608.11339.64.camel@m-laptop>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I am getting even more confused. I luckily found a copy of one of the
corrupted test indices that i had made on 4/28/08...lucky as its the
only one I have ever made :) It doesn't have the problem. This is very
interesting to me, because the other site that has the problem has been
in action for months now. Both were running with my previous version of
Lucene, which was a trunk build from around when 2.3 was released I
think. Just seems odd that the test index was corrupted so recently.


So I am a bit stuck...its probably my own problem though, so unless
someone else sees it, Ill just report back if/when I find out more.

- Mark


On Mon, 2008-05-05 at 18:07 -0400, Michael McCandless wrote:
> Mark,
> 
> Which exact version of the JRE are you using?
> 
> Mike
> 
> Mark Miller wrote:
> > On Mon, 2008-05-05 at 17:26 -0400, Michael McCandless wrote:
> >> Actually that stack trace looks like it's from trunk, not from 2.3.2
> >> (pre)?  OK, I think you said it's from "post 2.3 trunk".
> >
> > Right...the Lucene that showed the problem was build from a trunk grab
> > late last week. One of the problem indexes was built with a 2.0 or 2.1
> > and the other was built with a post 2.3 trunk (but weeks (prob months)
> > before the one i grabbed late last week :) )
> >
> >>
> >> Another question: is autoCommit false or true?
> > false
> >
> >
> >
> > If I can get you an affected index I will.
> >
> > - mark
> >
> >
> >>
> >> More responses below:
> >>
> >> Mark Miller wrote:
> >>> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
> >>>> Hi Mark,
> >>>>
> >>>> Not good!
> >>>>
> >>>> Can you describe how this index was created?  Did you use multiple
> >>>> threads on one IndexWriter?  Multiple sessions of IndexWriter
> >>>> appending to the index?  addIndexes*?  Is the index copied from one
> >>>> place to another after being written and before being searched?
> >>>
> >>> Both sites were created by a single thread on a single IndexWriter.
> >>> Updates are done through multiple threads and one IndexWriter. No
> >>> addIndexes. Index was never copied, always same path.
> >>>
> >>>>
> >>>> If you run CheckIndex, what does it report?
> >>>
> >>> This was my next move...unfortunately, someone accidentally kicked
> >>> off a
> >>> complete reindex before I could do it. From what I can tell by the
> >>> stack
> >>> trace, its a per doc problem...I am guessing I could have   
> >>> printed the
> >>> ids of the problem docs and just reindex those? I have to deal with
> >>> this
> >>> at many other sites, so that may be my attack...I cannot reindex
> >>> everything to fix.
> >>
> >> It would be great to know if that workaround works (and indeed it's a
> >> per-doc issue).  I'd also love to know how many docs are affected,
> >> when you hit this.
> >>
> >> If there's any way to zip up the index and send it to me, even just
> >> the files for the one segment that has the corrupted doc, that'd be
> >> great.
> >>
> >>>>
> >>>> Any prior exceptions on this index?
> >>>
> >>> Not that I can recall. One of the indexes was made months ago, prob
> >>> with
> >>> a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
> >>> site was windows 2003, the other AIX. One site was only 30,000
> >>> docs, the
> >>> other over 1 million.
> >>>
> >>>>
> >>>> Are your docs a variable schema (different fields)?
> >>>
> >>> Yes. Lots of different fields depending on the doc.
> >>>
> >>>>
> >>>> Mike
> >>>
> >>> Thanks Mike. I am currently trying to duplicate this. I can't go to
> >>> another site without testing some kind of fix.
> >>>
> >>>>
> >>>> Mark Miller wrote:
> >>>>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
> >>>>>
> >>>>> I finally have one of the stack traces (this comes on the tail
> >>>>> complete
> >>>>> laptop failure so I am scrambling here)
> >>>>>
> >>>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
> >>>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
> >>>>>         at java.util.ArrayList.get(ArrayList.java:347)
> >>>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
> >>>>> (FieldInfos.java:260)
> >>>>>         at org.apache.lucene.index.FieldsReader.doc
> >>>>> (FieldsReader.java:184)
> >>>>>         at org.apache.lucene.index.SegmentReader.document
> >>>>> (SegmentReader.java:670)
> >>>>>         at org.apache.lucene.index.MultiSegmentReader.document
> >>>>> (MultiSegmentReader.java:257)
> >>>>>         at org.apache.lucene.search.IndexSearcher.doc
> >>>>> (IndexSearcher.java:97)
> >>>>>
> >>>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
> >>>>>> coincidence or it is from 2.3.2 ?
> >>>>>>
> >>>>>> env:
> >>>>>> lucene 2.3.2
> >>>>>> jdk1.6.0_06 & jdk1.5.0_15
> >>>>>>
> >>>>>>
> >>>>>> QueryString:
> >>>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
> >>>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
> >>>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
> >>>>>> at
> >>>>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
> >>>>>> (BooleanScorer2.java:55)
> >>>>>> at org.apache.lucene.search.BooleanScorer2.score
> >>>>>> (BooleanScorer2.java:358)
> >>>>>> at org.apache.lucene.search.BooleanScorer2.score
> >>>>>> (BooleanScorer2.java:320)
> >>>>>> at org.apache.lucene.search.IndexSearcher.search
> >>>>>> (IndexSearcher.java:146)
> >>>>>> at org.apache.lucene.search.IndexSearcher.search
> >>>>>> (IndexSearcher.java:113)
> >>>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
> >>>>>> at
> >>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
> >>>>>> (TrecQueryRelevanceFeedback.java:776)
> >>>>>>
> >>>>>>
> >>>>>> QueryString:
> >>>>>> oceanograph^68.48028 vessel^43.191563
> >>>>>> Error:
> >>>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOf 
> >>>>>> Bo
> >>>>>> un
> >>>>>> dsException
> >>>>>> at java.lang.System.arraycopy(Native Method)
> >>>>>> at
> >>>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
> >>>>>> (TermVectorsReader.java:353)
> >>>>>> at
> >>>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
> >>>>>> (TermVectorsReader.java:287)
> >>>>>> at org.apache.lucene.index.TermVectorsReader.get
> >>>>>> (TermVectorsReader.java:232)
> >>>>>> at
> >>>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
> >>>>>> (SegmentReader.java:981)
> >>>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
> >>>>>> (RelevanceFeedback.java:134)
> >>>>>> at
> >>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
> >>>>>> (TrecQueryRelevanceFeedback.java:781)
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>> Mark Miller wrote:
> >>>>>>> Any recent changes that would expose index corruption?
> >>>>>>>
> >>>>>>> I am getting two new errors when trying to search:
> >>>>>>>
> >>>>>>> nullpointer fieldsreaders line 260
> >>>>>>>
> >>>>>>> indexoutofbounds on fieldinfo line 185
> >>>>>>>
> >>>>>>> I am kind of screwed, because reindexing fixes this, but I cant
> >>>>>>> reindex!
> >>>>>>>
> >>>>>>> Any ideas?
> >>>>>>>
> >>>>>>>
> >>>>>>> ---------------------------------------------------------------- 
> >>>>>>> --
> >>>>>>> --
> >>>>>>> -
> >>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>>>> For additional commands, e-mail: java-user- 
> >>>>>>> help@lucene.apache.org
> >>>>>>>
> >>>>>>>
> >>>>>>
> >>>>>>
> >>>>>> ----------------------------------------------------------------- 
> >>>>>> --
> >>>>>> --
> >>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>>>
> >>>>>
> >>>>>
> >>>>> ------------------------------------------------------------------ 
> >>>>> --
> >>>>> -
> >>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>>
> >>>>
> >>>>
> >>>> ------------------------------------------------------------------- 
> >>>> --
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>
> >>>
> >>> -------------------------------------------------------------------- 
> >>> -
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33926-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 08:15:46 2008
Return-Path: <java-user-return-33926-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70983 invoked from network); 6 May 2008 08:15:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 08:15:46 -0000
Received: (qmail 93994 invoked by uid 500); 6 May 2008 08:15:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93960 invoked by uid 500); 6 May 2008 08:15:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93949 invoked by uid 99); 6 May 2008 08:15:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 01:15:41 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of eransevi@gmail.com designates 209.85.200.172 as permitted sender)
Received: from [209.85.200.172] (HELO wf-out-1314.google.com) (209.85.200.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 08:14:56 +0000
Received: by wf-out-1314.google.com with SMTP id 28so1493696wfc.20
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 01:15:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=LeibidYP9YyxJHaJ1kf5j6PLi5V7E4b3zcnQo14M/+A=;
        b=onlETUHYSvnVSNQd0oi8mlT+fAewBsI/XqiitMyQ/q6eHI3TQ4m+0Tfhqh+YMKsegq8dRF+pvgj8eit0Asp/ZZ3IdyfxY1wwUkcEyqJhnVPolZ4c1wfY7PHIg1n4Laqce3JkHGhxCqSW2brrWNCjr0je/vl/dTzqUs0RU/5NBRo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=ONSqxllxrzUMDzQcXok1fL1vR2/f4N1VbAuhEUNFSo1sxeBQzB0Fbjz6xoIZ1Jd0q3fLHctFc5vOHkv07CqIS5GOesDK3kUge8vYxLeB2fSc0UbPmvFY38U3Xj1NYKszu5TKPx7zC5DaUrvYd7MD8UtUKY9ndGsWkqkc8RR5lxo=
Received: by 10.143.161.3 with SMTP id n3mr215736wfo.32.1210061710975;
        Tue, 06 May 2008 01:15:10 -0700 (PDT)
Received: by 10.142.191.18 with HTTP; Tue, 6 May 2008 01:15:10 -0700 (PDT)
Message-ID: <74f928500805060115k6c6373bdib50b0e1ec88ecbbc@mail.gmail.com>
Date: Tue, 6 May 2008 11:15:10 +0300
From: "Eran Sevi" <eransevi@gmail.com>
To: java-user@lucene.apache.org
Subject: Filtering a SpanQuery
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_28616_4995459.1210061710957"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_28616_4995459.1210061710957
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,

I am looking for a way to filter a SpanQuery according to some other query
(on another field from the one used for the SpanQuery). I need to get access
to the spans themselves of course.
 I don't care about the scoring of the filter results and just need the
positions of hits found in the documents that matches the filter.

I tried looking through the archives and found some reference to a
SpanQueryFilter patch, however I don't see how it can help me achieve what I
want to do. This class receives only one query parameter (which I guess is
the actual query) and not a query and a filter for example.

Any help about how I can achieve this will be appreciated.

Thanks,
Eran.

------=_Part_28616_4995459.1210061710957--

From java-user-return-33927-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 08:56:56 2008
Return-Path: <java-user-return-33927-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84734 invoked from network); 6 May 2008 08:56:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 08:56:56 -0000
Received: (qmail 44115 invoked by uid 500); 6 May 2008 08:56:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44085 invoked by uid 500); 6 May 2008 08:56:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44074 invoked by uid 99); 6 May 2008 08:56:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 01:56:49 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of gopi.subramani@gmail.com designates 64.233.178.243 as permitted sender)
Received: from [64.233.178.243] (HELO hs-out-0708.google.com) (64.233.178.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 08:56:04 +0000
Received: by hs-out-0708.google.com with SMTP id 4so835361hsl.5
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 01:56:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=Czex15E43+VjhEyIZwWMz82uFRDINezPZFhO6A+TUW4=;
        b=oSHkoAqX/RuDPLkMoL++eDFLi4DfKQsUNgQd3zXltlSoxzrhy66sE6tDjKa3dncs+vxKQ2NUnd5V2Ney4D/QpzSxXAUv0GMcDxawZeBdJFBRU+PFOeAqJkuLF2ngSjVBOgC2ss8L99XnkUzVaaHMwqN3ySwAlNHPTi59V0aPwhE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=pxb9vDu5jiUXfh+OTpTG3BOKA0BZTw+h/MraT1d9oa16pHOnK5+hyucpqZh1HSUvtBWpLaTo53Hd5EwRQOcdvLq+Y24CDfCgud6fuF5bcJzcO+KnNTASdjaTkRF1MR0WDSlnxnewDMvMQ3PenLvgZd1tL3dR8z5PON25y/kFEsY=
Received: by 10.90.36.16 with SMTP id j16mr779755agj.105.1210064178086;
        Tue, 06 May 2008 01:56:18 -0700 (PDT)
Received: by 10.90.115.9 with HTTP; Tue, 6 May 2008 01:56:18 -0700 (PDT)
Message-ID: <733777220805060156t7fdb8fectf0bc984fbfe48a22@mail.gmail.com>
Date: Tue, 6 May 2008 14:26:18 +0530
From: "Gopikrishnan Subramani" <gopi.subramani@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: index corruption with latest lucene
In-Reply-To: <1210029608.11339.64.camel@m-laptop>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_10107_12628939.1210064178103"
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com>
	 <1210017407.11339.16.camel@m-laptop>
	 <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>
	 <1210021246.11339.30.camel@m-laptop>
	 <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>
	 <1210023301.11339.34.camel@m-laptop>
	 <220AD8BD-C0BE-465E-8C64-39797EAA8AAC@mikemccandless.com>
	 <1210029608.11339.64.camel@m-laptop>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_10107_12628939.1210064178103
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

[ Sorry if I'm hijacking this thread, if you feel this error is unrelated to
this thread, I'll move this to a separate thread. ]

Even after upgrading to 2.3.1 I'm running into index corruption problems.
I'm posting below the exception that is generated while searching. The stack
trace looks like,


org.apache.lucene.index.CorruptIndexException: doc counts differ for segment
_kk: fieldsReader shows 72670 but segmentInfo shows 72671
        at
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:313)
        at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:262)
        at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:230)
        at
org.apache.lucene.index.DirectoryIndexReader$1.doBody(DirectoryIndexReader.java:73)
        at
org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:636)
        at
org.apache.lucene.index.DirectoryIndexReader.open(DirectoryIndexReader.java:63)
        at org.apache.lucene.index.IndexReader.open(IndexReader.java:209)
        at org.apache.lucene.index.IndexReader.open(IndexReader.java:173)
        at
org.apache.lucene.search.IndexSearcher.<init>(IndexSearcher.java:48)


About the setup: all documents in the these indexes have the same set of
fields, but some fields are not added if the value is null. We have over 500
indexes and they are indexed incrementally on a daily basis. The index is
updated in place with autocommit turned on. A single thread writes to the
index and once all the documents are updated, the index is commited. About 5
indexes are getting corrupted per week on an average and a full index fixes
the problem. This is proving to be a lot of pain and any help in identifying
the problem is much appreicated.

thanks,
Gopi

On 5/6/08, Mark Miller <markrmiller@gmail.com> wrote:
>
> I am getting even more confused. I luckily found a copy of one of the
> corrupted test indices that i had made on 4/28/08...lucky as its the
> only one I have ever made :) It doesn't have the problem. This is very
> interesting to me, because the other site that has the problem has been
> in action for months now. Both were running with my previous version of
> Lucene, which was a trunk build from around when 2.3 was released I
> think. Just seems odd that the test index was corrupted so recently.
>
>
> So I am a bit stuck...its probably my own problem though, so unless
> someone else sees it, Ill just report back if/when I find out more.
>
> - Mark
>
>
> On Mon, 2008-05-05 at 18:07 -0400, Michael McCandless wrote:
> > Mark,
> >
> > Which exact version of the JRE are you using?
> >
> > Mike
> >
> > Mark Miller wrote:
> > > On Mon, 2008-05-05 at 17:26 -0400, Michael McCandless wrote:
> > >> Actually that stack trace looks like it's from trunk, not from 2.3.2
> > >> (pre)?  OK, I think you said it's from "post 2.3 trunk".
> > >
> > > Right...the Lucene that showed the problem was build from a trunk grab
> > > late last week. One of the problem indexes was built with a 2.0 or 2.1
> > > and the other was built with a post 2.3 trunk (but weeks (prob months)
> > > before the one i grabbed late last week :) )
> > >
> > >>
> > >> Another question: is autoCommit false or true?
> > > false
> > >
> > >
> > >
> > > If I can get you an affected index I will.
> > >
> > > - mark
> > >
> > >
> > >>
> > >> More responses below:
> > >>
> > >> Mark Miller wrote:
> > >>> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
> > >>>> Hi Mark,
> > >>>>
> > >>>> Not good!
> > >>>>
> > >>>> Can you describe how this index was created?  Did you use multiple
> > >>>> threads on one IndexWriter?  Multiple sessions of IndexWriter
> > >>>> appending to the index?  addIndexes*?  Is the index copied from one
> > >>>> place to another after being written and before being searched?
> > >>>
> > >>> Both sites were created by a single thread on a single IndexWriter.
> > >>> Updates are done through multiple threads and one IndexWriter. No
> > >>> addIndexes. Index was never copied, always same path.
> > >>>
> > >>>>
> > >>>> If you run CheckIndex, what does it report?
> > >>>
> > >>> This was my next move...unfortunately, someone accidentally kicked
> > >>> off a
> > >>> complete reindex before I could do it. From what I can tell by the
> > >>> stack
> > >>> trace, its a per doc problem...I am guessing I could have
> > >>> printed the
> > >>> ids of the problem docs and just reindex those? I have to deal with
> > >>> this
> > >>> at many other sites, so that may be my attack...I cannot reindex
> > >>> everything to fix.
> > >>
> > >> It would be great to know if that workaround works (and indeed it's a
> > >> per-doc issue).  I'd also love to know how many docs are affected,
> > >> when you hit this.
> > >>
> > >> If there's any way to zip up the index and send it to me, even just
> > >> the files for the one segment that has the corrupted doc, that'd be
> > >> great.
> > >>
> > >>>>
> > >>>> Any prior exceptions on this index?
> > >>>
> > >>> Not that I can recall. One of the indexes was made months ago, prob
> > >>> with
> > >>> a 2.0 or 2.1 Lucene, the second was made with a post 2.2 Lucene. One
> > >>> site was windows 2003, the other AIX. One site was only 30,000
> > >>> docs, the
> > >>> other over 1 million.
> > >>>
> > >>>>
> > >>>> Are your docs a variable schema (different fields)?
> > >>>
> > >>> Yes. Lots of different fields depending on the doc.
> > >>>
> > >>>>
> > >>>> Mike
> > >>>
> > >>> Thanks Mike. I am currently trying to duplicate this. I can't go to
> > >>> another site without testing some kind of fix.
> > >>>
> > >>>>
> > >>>> Mark Miller wrote:
> > >>>>> Yeah, its pretty close to 2.3.2, but I think from last week mabye.
> > >>>>>
> > >>>>> I finally have one of the stack traces (this comes on the tail
> > >>>>> complete
> > >>>>> laptop failure so I am scrambling here)
> > >>>>>
> > >>>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
> > >>>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
> > >>>>>         at java.util.ArrayList.get(ArrayList.java:347)
> > >>>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
> > >>>>> (FieldInfos.java:260)
> > >>>>>         at org.apache.lucene.index.FieldsReader.doc
> > >>>>> (FieldsReader.java:184)
> > >>>>>         at org.apache.lucene.index.SegmentReader.document
> > >>>>> (SegmentReader.java:670)
> > >>>>>         at org.apache.lucene.index.MultiSegmentReader.document
> > >>>>> (MultiSegmentReader.java:257)
> > >>>>>         at org.apache.lucene.search.IndexSearcher.doc
> > >>>>> (IndexSearcher.java:97)
> > >>>>>
> > >>>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
> > >>>>>> coincidence or it is from 2.3.2 ?
> > >>>>>>
> > >>>>>> env:
> > >>>>>> lucene 2.3.2
> > >>>>>> jdk1.6.0_06 & jdk1.5.0_15
> > >>>>>>
> > >>>>>>
> > >>>>>> QueryString:
> > >>>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
> > >>>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
> > >>>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
> > >>>>>> at
> > >>>>>> org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
> > >>>>>> (BooleanScorer2.java:55)
> > >>>>>> at org.apache.lucene.search.BooleanScorer2.score
> > >>>>>> (BooleanScorer2.java:358)
> > >>>>>> at org.apache.lucene.search.BooleanScorer2.score
> > >>>>>> (BooleanScorer2.java:320)
> > >>>>>> at org.apache.lucene.search.IndexSearcher.search
> > >>>>>> (IndexSearcher.java:146)
> > >>>>>> at org.apache.lucene.search.IndexSearcher.search
> > >>>>>> (IndexSearcher.java:113)
> > >>>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
> > >>>>>> at
> > >>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
> > >>>>>> (TrecQueryRelevanceFeedback.java:776)
> > >>>>>>
> > >>>>>>
> > >>>>>> QueryString:
> > >>>>>> oceanograph^68.48028 vessel^43.191563
> > >>>>>> Error:
> > >>>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOf
> > >>>>>> Bo
> > >>>>>> un
> > >>>>>> dsException
> > >>>>>> at java.lang.System.arraycopy(Native Method)
> > >>>>>> at
> > >>>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
> > >>>>>> (TermVectorsReader.java:353)
> > >>>>>> at
> > >>>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
> > >>>>>> (TermVectorsReader.java:287)
> > >>>>>> at org.apache.lucene.index.TermVectorsReader.get
> > >>>>>> (TermVectorsReader.java:232)
> > >>>>>> at
> > >>>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
> > >>>>>> (SegmentReader.java:981)
> > >>>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
> > >>>>>> (RelevanceFeedback.java:134)
> > >>>>>> at
> > >>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
> > >>>>>> (TrecQueryRelevanceFeedback.java:781)
> > >>>>>>
> > >>>>>>
> > >>>>>>
> > >>>>>>
> > >>>>>> Mark Miller wrote:
> > >>>>>>> Any recent changes that would expose index corruption?
> > >>>>>>>
> > >>>>>>> I am getting two new errors when trying to search:
> > >>>>>>>
> > >>>>>>> nullpointer fieldsreaders line 260
> > >>>>>>>
> > >>>>>>> indexoutofbounds on fieldinfo line 185
> > >>>>>>>
> > >>>>>>> I am kind of screwed, because reindexing fixes this, but I cant
> > >>>>>>> reindex!
> > >>>>>>>
> > >>>>>>> Any ideas?
> > >>>>>>>
> > >>>>>>>
> > >>>>>>> ----------------------------------------------------------------
> > >>>>>>> --
> > >>>>>>> --
> > >>>>>>> -
> > >>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >>>>>>> For additional commands, e-mail: java-user-
> > >>>>>>> help@lucene.apache.org
> > >>>>>>>
> > >>>>>>>
> > >>>>>>
> > >>>>>>
> > >>>>>> -----------------------------------------------------------------
> > >>>>>> --
> > >>>>>> --
> > >>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>>>>>
> > >>>>>
> > >>>>>
> > >>>>> ------------------------------------------------------------------
> > >>>>> --
> > >>>>> -
> > >>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>>>>
> > >>>>
> > >>>>
> > >>>> -------------------------------------------------------------------
> > >>>> --
> > >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>>>
> > >>>
> > >>>
> > >>> --------------------------------------------------------------------
> > >>> -
> > >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>>
> > >>
> > >>
> > >> ---------------------------------------------------------------------
> > >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_10107_12628939.1210064178103--

From java-user-return-33928-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 09:16:27 2008
Return-Path: <java-user-return-33928-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90876 invoked from network); 6 May 2008 09:16:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 09:16:27 -0000
Received: (qmail 61645 invoked by uid 500); 6 May 2008 09:16:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61619 invoked by uid 500); 6 May 2008 09:16:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61608 invoked by uid 99); 6 May 2008 09:16:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 02:16:20 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.14.246.241] (HELO ag-out-0708.google.com) (72.14.246.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:15:31 +0000
Received: by ag-out-0708.google.com with SMTP id 23so1255455agd.11
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 02:15:38 -0700 (PDT)
Received: by 10.100.94.14 with SMTP id r14mr479634anb.131.1210065338776;
        Tue, 06 May 2008 02:15:38 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 61sm650957wry.13.2008.05.06.02.15.38
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 06 May 2008 02:15:38 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <733777220805060156t7fdb8fectf0bc984fbfe48a22@mail.gmail.com>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com> <1210017407.11339.16.camel@m-laptop> <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com> <1210021246.11339.30.camel@m-laptop> <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com> <1210023301.11339.34.camel@m-laptop> <220AD8BD-C0BE-465E-8C64-39797EAA8AAC@mikemccandless.com> <1210029608.11339.64.camel@m-laptop> <733777220805060156t7fdb8fectf0bc984fbfe48a22@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <777ED07A-0805-4710-95AF-B32FA4337BCC@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: index corruption with latest lucene
Date: Tue, 6 May 2008 05:16:28 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Are you using JRE 1.6.0_04 or 1.6.0_05?

This sounds exactly the same as this:

     http://www.gossamer-threads.com/lists/lucene/java-user/59650

If it is the same issue, which seems to be a bug in the hotspot  
compiler, downgrading to JRE 1.6.0_03, or running Java with -Xbatch  
(forces up-front compilation) or -Xint (disables compilation) works  
around it.

Can you test either of these and report back?  Thanks.

Mike

Gopikrishnan Subramani wrote:
> [ Sorry if I'm hijacking this thread, if you feel this error is  
> unrelated to
> this thread, I'll move this to a separate thread. ]
>
> Even after upgrading to 2.3.1 I'm running into index corruption  
> problems.
> I'm posting below the exception that is generated while searching.  
> The stack
> trace looks like,
>
>
> org.apache.lucene.index.CorruptIndexException: doc counts differ  
> for segment
> _kk: fieldsReader shows 72670 but segmentInfo shows 72671
>         at
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java: 
> 313)
>         at org.apache.lucene.index.SegmentReader.get 
> (SegmentReader.java:262)
>         at org.apache.lucene.index.SegmentReader.get 
> (SegmentReader.java:230)
>         at
> org.apache.lucene.index.DirectoryIndexReader$1.doBody 
> (DirectoryIndexReader.java:73)
>         at
> org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run 
> (SegmentInfos.java:636)
>         at
> org.apache.lucene.index.DirectoryIndexReader.open 
> (DirectoryIndexReader.java:63)
>         at org.apache.lucene.index.IndexReader.open 
> (IndexReader.java:209)
>         at org.apache.lucene.index.IndexReader.open 
> (IndexReader.java:173)
>         at
> org.apache.lucene.search.IndexSearcher.<init>(IndexSearcher.java:48)
>
>
> About the setup: all documents in the these indexes have the same  
> set of
> fields, but some fields are not added if the value is null. We have  
> over 500
> indexes and they are indexed incrementally on a daily basis. The  
> index is
> updated in place with autocommit turned on. A single thread writes  
> to the
> index and once all the documents are updated, the index is  
> commited. About 5
> indexes are getting corrupted per week on an average and a full  
> index fixes
> the problem. This is proving to be a lot of pain and any help in  
> identifying
> the problem is much appreicated.
>
> thanks,
> Gopi
>
> On 5/6/08, Mark Miller <markrmiller@gmail.com> wrote:
>>
>> I am getting even more confused. I luckily found a copy of one of the
>> corrupted test indices that i had made on 4/28/08...lucky as its the
>> only one I have ever made :) It doesn't have the problem. This is  
>> very
>> interesting to me, because the other site that has the problem has  
>> been
>> in action for months now. Both were running with my previous  
>> version of
>> Lucene, which was a trunk build from around when 2.3 was released I
>> think. Just seems odd that the test index was corrupted so recently.
>>
>>
>> So I am a bit stuck...its probably my own problem though, so unless
>> someone else sees it, Ill just report back if/when I find out more.
>>
>> - Mark
>>
>>
>> On Mon, 2008-05-05 at 18:07 -0400, Michael McCandless wrote:
>>> Mark,
>>>
>>> Which exact version of the JRE are you using?
>>>
>>> Mike
>>>
>>> Mark Miller wrote:
>>>> On Mon, 2008-05-05 at 17:26 -0400, Michael McCandless wrote:
>>>>> Actually that stack trace looks like it's from trunk, not from  
>>>>> 2.3.2
>>>>> (pre)?  OK, I think you said it's from "post 2.3 trunk".
>>>>
>>>> Right...the Lucene that showed the problem was build from a  
>>>> trunk grab
>>>> late last week. One of the problem indexes was built with a 2.0  
>>>> or 2.1
>>>> and the other was built with a post 2.3 trunk (but weeks (prob  
>>>> months)
>>>> before the one i grabbed late last week :) )
>>>>
>>>>>
>>>>> Another question: is autoCommit false or true?
>>>> false
>>>>
>>>>
>>>>
>>>> If I can get you an affected index I will.
>>>>
>>>> - mark
>>>>
>>>>
>>>>>
>>>>> More responses below:
>>>>>
>>>>> Mark Miller wrote:
>>>>>> On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
>>>>>>> Hi Mark,
>>>>>>>
>>>>>>> Not good!
>>>>>>>
>>>>>>> Can you describe how this index was created?  Did you use  
>>>>>>> multiple
>>>>>>> threads on one IndexWriter?  Multiple sessions of IndexWriter
>>>>>>> appending to the index?  addIndexes*?  Is the index copied  
>>>>>>> from one
>>>>>>> place to another after being written and before being searched?
>>>>>>
>>>>>> Both sites were created by a single thread on a single  
>>>>>> IndexWriter.
>>>>>> Updates are done through multiple threads and one IndexWriter. No
>>>>>> addIndexes. Index was never copied, always same path.
>>>>>>
>>>>>>>
>>>>>>> If you run CheckIndex, what does it report?
>>>>>>
>>>>>> This was my next move...unfortunately, someone accidentally  
>>>>>> kicked
>>>>>> off a
>>>>>> complete reindex before I could do it. From what I can tell by  
>>>>>> the
>>>>>> stack
>>>>>> trace, its a per doc problem...I am guessing I could have
>>>>>> printed the
>>>>>> ids of the problem docs and just reindex those? I have to deal  
>>>>>> with
>>>>>> this
>>>>>> at many other sites, so that may be my attack...I cannot reindex
>>>>>> everything to fix.
>>>>>
>>>>> It would be great to know if that workaround works (and indeed  
>>>>> it's a
>>>>> per-doc issue).  I'd also love to know how many docs are affected,
>>>>> when you hit this.
>>>>>
>>>>> If there's any way to zip up the index and send it to me, even  
>>>>> just
>>>>> the files for the one segment that has the corrupted doc,  
>>>>> that'd be
>>>>> great.
>>>>>
>>>>>>>
>>>>>>> Any prior exceptions on this index?
>>>>>>
>>>>>> Not that I can recall. One of the indexes was made months ago,  
>>>>>> prob
>>>>>> with
>>>>>> a 2.0 or 2.1 Lucene, the second was made with a post 2.2  
>>>>>> Lucene. One
>>>>>> site was windows 2003, the other AIX. One site was only 30,000
>>>>>> docs, the
>>>>>> other over 1 million.
>>>>>>
>>>>>>>
>>>>>>> Are your docs a variable schema (different fields)?
>>>>>>
>>>>>> Yes. Lots of different fields depending on the doc.
>>>>>>
>>>>>>>
>>>>>>> Mike
>>>>>>
>>>>>> Thanks Mike. I am currently trying to duplicate this. I can't  
>>>>>> go to
>>>>>> another site without testing some kind of fix.
>>>>>>
>>>>>>>
>>>>>>> Mark Miller wrote:
>>>>>>>> Yeah, its pretty close to 2.3.2, but I think from last week  
>>>>>>>> mabye.
>>>>>>>>
>>>>>>>> I finally have one of the stack traces (this comes on the tail
>>>>>>>> complete
>>>>>>>> laptop failure so I am scrambling here)
>>>>>>>>
>>>>>>>> java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
>>>>>>>>         at java.util.ArrayList.RangeCheck(ArrayList.java:572)
>>>>>>>>         at java.util.ArrayList.get(ArrayList.java:347)
>>>>>>>>         at org.apache.lucene.index.FieldInfos.fieldInfo
>>>>>>>> (FieldInfos.java:260)
>>>>>>>>         at org.apache.lucene.index.FieldsReader.doc
>>>>>>>> (FieldsReader.java:184)
>>>>>>>>         at org.apache.lucene.index.SegmentReader.document
>>>>>>>> (SegmentReader.java:670)
>>>>>>>>         at org.apache.lucene.index.MultiSegmentReader.document
>>>>>>>> (MultiSegmentReader.java:257)
>>>>>>>>         at org.apache.lucene.search.IndexSearcher.doc
>>>>>>>> (IndexSearcher.java:97)
>>>>>>>>
>>>>>>>> On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
>>>>>>>>> coincidence or it is from 2.3.2 ?
>>>>>>>>>
>>>>>>>>> env:
>>>>>>>>> lucene 2.3.2
>>>>>>>>> jdk1.6.0_06 & jdk1.5.0_15
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> QueryString:
>>>>>>>>> illeg^30.820824 technolog^22.290413 transfer^33.307804
>>>>>>>>> Error: java.lang.ArrayIndexOutOfBoundsException:
>>>>>>>>> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
>>>>>>>>> at
>>>>>>>>> org.apache.lucene.search.BooleanScorer2 
>>>>>>>>> $Coordinator.coordFactor
>>>>>>>>> (BooleanScorer2.java:55)
>>>>>>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>>>>>>> (BooleanScorer2.java:358)
>>>>>>>>> at org.apache.lucene.search.BooleanScorer2.score
>>>>>>>>> (BooleanScorer2.java:320)
>>>>>>>>> at org.apache.lucene.search.IndexSearcher.search
>>>>>>>>> (IndexSearcher.java:146)
>>>>>>>>> at org.apache.lucene.search.IndexSearcher.search
>>>>>>>>> (IndexSearcher.java:113)
>>>>>>>>> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
>>>>>>>>> at
>>>>>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>>>>>>> (TrecQueryRelevanceFeedback.java:776)
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> QueryString:
>>>>>>>>> oceanograph^68.48028 vessel^43.191563
>>>>>>>>> Error:
>>>>>>>>> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOu 
>>>>>>>>> tOf
>>>>>>>>> Bo
>>>>>>>>> un
>>>>>>>>> dsException
>>>>>>>>> at java.lang.System.arraycopy(Native Method)
>>>>>>>>> at
>>>>>>>>> org.apache.lucene.index.TermVectorsReader.readTermVector
>>>>>>>>> (TermVectorsReader.java:353)
>>>>>>>>> at
>>>>>>>>> org.apache.lucene.index.TermVectorsReader.readTermVectors
>>>>>>>>> (TermVectorsReader.java:287)
>>>>>>>>> at org.apache.lucene.index.TermVectorsReader.get
>>>>>>>>> (TermVectorsReader.java:232)
>>>>>>>>> at
>>>>>>>>> org.apache.lucene.index.SegmentReader.getTermFreqVectors
>>>>>>>>> (SegmentReader.java:981)
>>>>>>>>> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
>>>>>>>>> (RelevanceFeedback.java:134)
>>>>>>>>> at
>>>>>>>>> org.cr.search.TrecQueryRelevanceFeedback.main
>>>>>>>>> (TrecQueryRelevanceFeedback.java:781)
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> Mark Miller wrote:
>>>>>>>>>> Any recent changes that would expose index corruption?
>>>>>>>>>>
>>>>>>>>>> I am getting two new errors when trying to search:
>>>>>>>>>>
>>>>>>>>>> nullpointer fieldsreaders line 260
>>>>>>>>>>
>>>>>>>>>> indexoutofbounds on fieldinfo line 185
>>>>>>>>>>
>>>>>>>>>> I am kind of screwed, because reindexing fixes this, but I  
>>>>>>>>>> cant
>>>>>>>>>> reindex!
>>>>>>>>>>
>>>>>>>>>> Any ideas?
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ------------------------------------------------------------- 
>>>>>>>>>> ---
>>>>>>>>>> --
>>>>>>>>>> --
>>>>>>>>>> -
>>>>>>>>>> To unsubscribe, e-mail: java-user- 
>>>>>>>>>> unsubscribe@lucene.apache.org
>>>>>>>>>> For additional commands, e-mail: java-user-
>>>>>>>>>> help@lucene.apache.org
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> -------------------------------------------------------------- 
>>>>>>>>> ---
>>>>>>>>> --
>>>>>>>>> --
>>>>>>>>> To unsubscribe, e-mail: java-user- 
>>>>>>>>> unsubscribe@lucene.apache.org
>>>>>>>>> For additional commands, e-mail: java-user- 
>>>>>>>>> help@lucene.apache.org
>>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>> --------------------------------------------------------------- 
>>>>>>>> ---
>>>>>>>> --
>>>>>>>> -
>>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>>> For additional commands, e-mail: java-user- 
>>>>>>>> help@lucene.apache.org
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> ---------------------------------------------------------------- 
>>>>>>> ---
>>>>>>> --
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user- 
>>>>>>> help@lucene.apache.org
>>>>>>>
>>>>>>
>>>>>>
>>>>>> ----------------------------------------------------------------- 
>>>>>> ---
>>>>>> -
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>
>>>>>
>>>>> ------------------------------------------------------------------ 
>>>>> ---
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>
>>>>
>>>> ------------------------------------------------------------------- 
>>>> --
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33929-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 09:30:01 2008
Return-Path: <java-user-return-33929-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96342 invoked from network); 6 May 2008 09:30:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 09:30:00 -0000
Received: (qmail 82572 invoked by uid 500); 6 May 2008 09:29:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82238 invoked by uid 500); 6 May 2008 09:29:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82227 invoked by uid 99); 6 May 2008 09:29:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 02:29:55 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.14.246.246] (HELO ag-out-0708.google.com) (72.14.246.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:29:09 +0000
Received: by ag-out-0708.google.com with SMTP id 23so1262905agd.11
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 02:29:22 -0700 (PDT)
Received: by 10.101.1.12 with SMTP id d12mr544689ani.31.1210066162307;
        Tue, 06 May 2008 02:29:22 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 18sm657181wry.18.2008.05.06.02.29.21
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 06 May 2008 02:29:22 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <481F64A9.6040808@gmail.com>
References: <1210016037.11339.7.camel@m-laptop> <481F64A9.6040808@gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <9AE36B36-2F84-4C41-AB30-4A516EA3B539@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: index corruption with latest lucene
Date: Tue, 6 May 2008 05:30:11 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Could you provide more detail on how you hit these two exceptions?   
Are they reproducible from scratch (creating a new index)?

Are you using multiple threads against IndexWriter?  Is autoCommit  
true or false?  Any prior exceptions hit?  Do your documents have  
varying number/configuration of fields?  Is the index copied  
somewhere after being written?

Can you run with assertions enabled to see if something is tripped?

Maybe run CheckIndex on the index?

Mike

crspan wrote:
> coincidence or it is from 2.3.2 ?
>
> env:
> lucene 2.3.2
> jdk1.6.0_06 & jdk1.5.0_15
>
>
> QueryString:
> illeg^30.820824 technolog^22.290413 transfer^33.307804
> Error: java.lang.ArrayIndexOutOfBoundsException:  
> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
> at org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor 
> (BooleanScorer2.java:55)
> at org.apache.lucene.search.BooleanScorer2.score 
> (BooleanScorer2.java:358)
> at org.apache.lucene.search.BooleanScorer2.score 
> (BooleanScorer2.java:320)
> at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java: 
> 146)
> at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java: 
> 113)
> at org.apache.lucene.search.Searcher.search(Searcher.java:132)
> at org.cr.search.TrecQueryRelevanceFeedback.main 
> (TrecQueryRelevanceFeedback.java:776)
>
>
> QueryString:
> oceanograph^68.48028 vessel^43.191563
> Error:  
> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBound 
> sException
> at java.lang.System.arraycopy(Native Method)
> at org.apache.lucene.index.TermVectorsReader.readTermVector 
> (TermVectorsReader.java:353)
> at org.apache.lucene.index.TermVectorsReader.readTermVectors 
> (TermVectorsReader.java:287)
> at org.apache.lucene.index.TermVectorsReader.get 
> (TermVectorsReader.java:232)
> at org.apache.lucene.index.SegmentReader.getTermFreqVectors 
> (SegmentReader.java:981)
> at org.cr.rf.RelevanceFeedback.RelFeedbackWeight 
> (RelevanceFeedback.java:134)
> at org.cr.search.TrecQueryRelevanceFeedback.main 
> (TrecQueryRelevanceFeedback.java:781)
>
>
>
>
> Mark Miller wrote:
>> Any recent changes that would expose index corruption?
>>
>> I am getting two new errors when trying to search:
>>
>> nullpointer fieldsreaders line 260
>>
>> indexoutofbounds on fieldinfo line 185
>>
>> I am kind of screwed, because reindexing fixes this, but I cant  
>> reindex!
>>
>> Any ideas?
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33930-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 09:30:29 2008
Return-Path: <java-user-return-33930-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96626 invoked from network); 6 May 2008 09:30:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 09:30:29 -0000
Received: (qmail 84080 invoked by uid 500); 6 May 2008 09:30:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84047 invoked by uid 500); 6 May 2008 09:30:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84036 invoked by uid 99); 6 May 2008 09:30:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 02:30:23 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of gopi.subramani@gmail.com designates 64.233.178.249 as permitted sender)
Received: from [64.233.178.249] (HELO hs-out-0708.google.com) (64.233.178.249)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:29:35 +0000
Received: by hs-out-0708.google.com with SMTP id 4so842980hsl.5
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 02:29:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=7prYXLnMrA/JVc0n7sY/Yc3LWgG11noRE6+CPymoOzE=;
        b=mkzusiRuGjfCJBZ1+9mq7azSUzbyGz8sQ6NnXYqdoHdehDfmaoHHHFpmxx9iYj259kq2borEEBLYoohHqk/KaO5nBp8dPp1X0WvbgJTRKcGlK4gEsC7nz5U2hIq0xxgWJxvcdlfTN+R8AvfN6v6MTvIFkl2+wrdFyMScXBde7Rg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=A20R3a8U52uYKysI9F2/rCQAOET5jgJF/30SRp+B0aX9VmgfrVg7NLJBMEuvvFoUwA0Fus1sa8jWLJDrkVf/FzyEsE5iMa1du1bfIHXOIIS9f7TFH6lPnKwEhGNrHAsve6iYWSdhqIeGOXBglEJroC+2p62If2ru5q9FeZRQVMw=
Received: by 10.90.72.3 with SMTP id u3mr850612aga.59.1210066189051;
        Tue, 06 May 2008 02:29:49 -0700 (PDT)
Received: by 10.90.115.9 with HTTP; Tue, 6 May 2008 02:29:48 -0700 (PDT)
Message-ID: <733777220805060229q1eb8fb28ta1a74b588156b57b@mail.gmail.com>
Date: Tue, 6 May 2008 14:59:48 +0530
From: "Gopikrishnan Subramani" <gopi.subramani@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: index corruption with latest lucene
In-Reply-To: <777ED07A-0805-4710-95AF-B32FA4337BCC@mikemccandless.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_10157_16406596.1210066189067"
References: <1210016037.11339.7.camel@m-laptop>
	 <1210017407.11339.16.camel@m-laptop>
	 <02370A1C-5252-4EC2-87D1-C818287A950D@mikemccandless.com>
	 <1210021246.11339.30.camel@m-laptop>
	 <C7F96B94-3830-4C53-8A1E-479CA31D3080@mikemccandless.com>
	 <1210023301.11339.34.camel@m-laptop>
	 <220AD8BD-C0BE-465E-8C64-39797EAA8AAC@mikemccandless.com>
	 <1210029608.11339.64.camel@m-laptop>
	 <733777220805060156t7fdb8fectf0bc984fbfe48a22@mail.gmail.com>
	 <777ED07A-0805-4710-95AF-B32FA4337BCC@mikemccandless.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_10157_16406596.1210066189067
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Thanks Mike. Sorry, I should have mentioned that I'm using 1.6.0_04. I
happened to look at the thread a while ago and used -Xbatch but that didn't
help which made me think may be it's a different issue. I'll try with -Xint
before downgrading to 1.6.0_03 to be doubly sure.

-Gopi


On 5/6/08, Michael McCandless <lucene@mikemccandless.com> wrote:
>
>
> Are you using JRE 1.6.0_04 or 1.6.0_05?
>
> This sounds exactly the same as this:
>
>    http://www.gossamer-threads.com/lists/lucene/java-user/59650
>
> If it is the same issue, which seems to be a bug in the hotspot compiler,
> downgrading to JRE 1.6.0_03, or running Java with -Xbatch (forces up-front
> compilation) or -Xint (disables compilation) works around it.
>
> Can you test either of these and report back?  Thanks.
>
> Mike
>
> Gopikrishnan Subramani wrote:
>
> > [ Sorry if I'm hijacking this thread, if you feel this error is
> > unrelated to
> > this thread, I'll move this to a separate thread. ]
> >
> > Even after upgrading to 2.3.1 I'm running into index corruption
> > problems.
> > I'm posting below the exception that is generated while searching. The
> > stack
> > trace looks like,
> >
> >
> > org.apache.lucene.index.CorruptIndexException: doc counts differ for
> > segment
> > _kk: fieldsReader shows 72670 but segmentInfo shows 72671
> >        at
> > org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:313)
> >        at
> > org.apache.lucene.index.SegmentReader.get(SegmentReader.java:262)
> >        at
> > org.apache.lucene.index.SegmentReader.get(SegmentReader.java:230)
> >        at
> >
> > org.apache.lucene.index.DirectoryIndexReader$1.doBody(DirectoryIndexReader.java:73)
> >        at
> >
> > org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:636)
> >        at
> >
> > org.apache.lucene.index.DirectoryIndexReader.open(DirectoryIndexReader.java:63)
> >        at org.apache.lucene.index.IndexReader.open(IndexReader.java:209)
> >        at org.apache.lucene.index.IndexReader.open(IndexReader.java:173)
> >        at
> > org.apache.lucene.search.IndexSearcher.<init>(IndexSearcher.java:48)
> >
> >
> > About the setup: all documents in the these indexes have the same set of
> > fields, but some fields are not added if the value is null. We have over
> > 500
> > indexes and they are indexed incrementally on a daily basis. The index
> > is
> > updated in place with autocommit turned on. A single thread writes to
> > the
> > index and once all the documents are updated, the index is commited.
> > About 5
> > indexes are getting corrupted per week on an average and a full index
> > fixes
> > the problem. This is proving to be a lot of pain and any help in
> > identifying
> > the problem is much appreicated.
> >
> > thanks,
> > Gopi
> >
> > On 5/6/08, Mark Miller <markrmiller@gmail.com> wrote:
> >
> > >
> > > I am getting even more confused. I luckily found a copy of one of the
> > > corrupted test indices that i had made on 4/28/08...lucky as its the
> > > only one I have ever made :) It doesn't have the problem. This is very
> > > interesting to me, because the other site that has the problem has
> > > been
> > > in action for months now. Both were running with my previous version
> > > of
> > > Lucene, which was a trunk build from around when 2.3 was released I
> > > think. Just seems odd that the test index was corrupted so recently.
> > >
> > >
> > > So I am a bit stuck...its probably my own problem though, so unless
> > > someone else sees it, Ill just report back if/when I find out more.
> > >
> > > - Mark
> > >
> > >
> > > On Mon, 2008-05-05 at 18:07 -0400, Michael McCandless wrote:
> > >
> > > > Mark,
> > > >
> > > > Which exact version of the JRE are you using?
> > > >
> > > > Mike
> > > >
> > > > Mark Miller wrote:
> > > >
> > > > > On Mon, 2008-05-05 at 17:26 -0400, Michael McCandless wrote:
> > > > >
> > > > > > Actually that stack trace looks like it's from trunk, not from
> > > > > > 2.3.2
> > > > > > (pre)?  OK, I think you said it's from "post 2.3 trunk".
> > > > > >
> > > > >
> > > > > Right...the Lucene that showed the problem was build from a trunk
> > > > > grab
> > > > > late last week. One of the problem indexes was built with a 2.0 or
> > > > > 2.1
> > > > > and the other was built with a post 2.3 trunk (but weeks (prob
> > > > > months)
> > > > > before the one i grabbed late last week :) )
> > > > >
> > > > >
> > > > > > Another question: is autoCommit false or true?
> > > > > >
> > > > > false
> > > > >
> > > > >
> > > > >
> > > > > If I can get you an affected index I will.
> > > > >
> > > > > - mark
> > > > >
> > > > >
> > > > >
> > > > > > More responses below:
> > > > > >
> > > > > > Mark Miller wrote:
> > > > > >
> > > > > > > On Mon, 2008-05-05 at 16:32 -0400, Michael McCandless wrote:
> > > > > > >
> > > > > > > > Hi Mark,
> > > > > > > >
> > > > > > > > Not good!
> > > > > > > >
> > > > > > > > Can you describe how this index was created?  Did you use
> > > > > > > > multiple
> > > > > > > > threads on one IndexWriter?  Multiple sessions of
> > > > > > > > IndexWriter
> > > > > > > > appending to the index?  addIndexes*?  Is the index copied
> > > > > > > > from one
> > > > > > > > place to another after being written and before being
> > > > > > > > searched?
> > > > > > > >
> > > > > > >
> > > > > > > Both sites were created by a single thread on a single
> > > > > > > IndexWriter.
> > > > > > > Updates are done through multiple threads and one IndexWriter.
> > > > > > > No
> > > > > > > addIndexes. Index was never copied, always same path.
> > > > > > >
> > > > > > >
> > > > > > > > If you run CheckIndex, what does it report?
> > > > > > > >
> > > > > > >
> > > > > > > This was my next move...unfortunately, someone accidentally
> > > > > > > kicked
> > > > > > > off a
> > > > > > > complete reindex before I could do it. From what I can tell by
> > > > > > > the
> > > > > > > stack
> > > > > > > trace, its a per doc problem...I am guessing I could have
> > > > > > > printed the
> > > > > > > ids of the problem docs and just reindex those? I have to deal
> > > > > > > with
> > > > > > > this
> > > > > > > at many other sites, so that may be my attack...I cannot
> > > > > > > reindex
> > > > > > > everything to fix.
> > > > > > >
> > > > > >
> > > > > > It would be great to know if that workaround works (and indeed
> > > > > > it's a
> > > > > > per-doc issue).  I'd also love to know how many docs are
> > > > > > affected,
> > > > > > when you hit this.
> > > > > >
> > > > > > If there's any way to zip up the index and send it to me, even
> > > > > > just
> > > > > > the files for the one segment that has the corrupted doc, that'd
> > > > > > be
> > > > > > great.
> > > > > >
> > > > > >
> > > > > > > > Any prior exceptions on this index?
> > > > > > > >
> > > > > > >
> > > > > > > Not that I can recall. One of the indexes was made months ago,
> > > > > > > prob
> > > > > > > with
> > > > > > > a 2.0 or 2.1 Lucene, the second was made with a post 2.2
> > > > > > > Lucene. One
> > > > > > > site was windows 2003, the other AIX. One site was only 30,000
> > > > > > > docs, the
> > > > > > > other over 1 million.
> > > > > > >
> > > > > > >
> > > > > > > > Are your docs a variable schema (different fields)?
> > > > > > > >
> > > > > > >
> > > > > > > Yes. Lots of different fields depending on the doc.
> > > > > > >
> > > > > > >
> > > > > > > > Mike
> > > > > > > >
> > > > > > >
> > > > > > > Thanks Mike. I am currently trying to duplicate this. I can't
> > > > > > > go to
> > > > > > > another site without testing some kind of fix.
> > > > > > >
> > > > > > >
> > > > > > > > Mark Miller wrote:
> > > > > > > >
> > > > > > > > > Yeah, its pretty close to 2.3.2, but I think from last
> > > > > > > > > week mabye.
> > > > > > > > >
> > > > > > > > > I finally have one of the stack traces (this comes on the
> > > > > > > > > tail
> > > > > > > > > complete
> > > > > > > > > laptop failure so I am scrambling here)
> > > > > > > > >
> > > > > > > > > java.lang.IndexOutOfBoundsException: Index: 97, Size: 43
> > > > > > > > >        at
> > > > > > > > > java.util.ArrayList.RangeCheck(ArrayList.java:572)
> > > > > > > > >        at java.util.ArrayList.get(ArrayList.java:347)
> > > > > > > > >        at org.apache.lucene.index.FieldInfos.fieldInfo
> > > > > > > > > (FieldInfos.java:260)
> > > > > > > > >        at org.apache.lucene.index.FieldsReader.doc
> > > > > > > > > (FieldsReader.java:184)
> > > > > > > > >        at org.apache.lucene.index.SegmentReader.document
> > > > > > > > > (SegmentReader.java:670)
> > > > > > > > >        at
> > > > > > > > > org.apache.lucene.index.MultiSegmentReader.document
> > > > > > > > > (MultiSegmentReader.java:257)
> > > > > > > > >        at org.apache.lucene.search.IndexSearcher.doc
> > > > > > > > > (IndexSearcher.java:97)
> > > > > > > > >
> > > > > > > > > On Mon, 2008-05-05 at 14:48 -0500, crspan wrote:
> > > > > > > > >
> > > > > > > > > > coincidence or it is from 2.3.2 ?
> > > > > > > > > >
> > > > > > > > > > env:
> > > > > > > > > > lucene 2.3.2
> > > > > > > > > > jdk1.6.0_06 & jdk1.5.0_15
> > > > > > > > > >
> > > > > > > > > >
> > > > > > > > > > QueryString:
> > > > > > > > > > illeg^30.820824 technolog^22.290413 transfer^33.307804
> > > > > > > > > > Error: java.lang.ArrayIndexOutOfBoundsException:
> > > > > > > > > > 132704java.lang.ArrayIndexOutOfBoundsException: 132704
> > > > > > > > > > at
> > > > > > > > > >
> > > > > > > > > > org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor
> > > > > > > > > > (BooleanScorer2.java:55)
> > > > > > > > > > at org.apache.lucene.search.BooleanScorer2.score
> > > > > > > > > > (BooleanScorer2.java:358)
> > > > > > > > > > at org.apache.lucene.search.BooleanScorer2.score
> > > > > > > > > > (BooleanScorer2.java:320)
> > > > > > > > > > at org.apache.lucene.search.IndexSearcher.search
> > > > > > > > > > (IndexSearcher.java:146)
> > > > > > > > > > at org.apache.lucene.search.IndexSearcher.search
> > > > > > > > > > (IndexSearcher.java:113)
> > > > > > > > > > at
> > > > > > > > > > org.apache.lucene.search.Searcher.search(Searcher.java:132)
> > > > > > > > > > at
> > > > > > > > > > org.cr.search.TrecQueryRelevanceFeedback.main
> > > > > > > > > > (TrecQueryRelevanceFeedback.java:776)
> > > > > > > > > >
> > > > > > > > > >
> > > > > > > > > > QueryString:
> > > > > > > > > > oceanograph^68.48028 vessel^43.191563
> > > > > > > > > > Error:
> > > > > > > > > >
> > > > > > > > > > java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOf
> > > > > > > > > > Bo
> > > > > > > > > > un
> > > > > > > > > > dsException
> > > > > > > > > > at java.lang.System.arraycopy(Native Method)
> > > > > > > > > > at
> > > > > > > > > > org.apache.lucene.index.TermVectorsReader.readTermVector
> > > > > > > > > > (TermVectorsReader.java:353)
> > > > > > > > > > at
> > > > > > > > > >
> > > > > > > > > > org.apache.lucene.index.TermVectorsReader.readTermVectors
> > > > > > > > > > (TermVectorsReader.java:287)
> > > > > > > > > > at org.apache.lucene.index.TermVectorsReader.get
> > > > > > > > > > (TermVectorsReader.java:232)
> > > > > > > > > > at
> > > > > > > > > > org.apache.lucene.index.SegmentReader.getTermFreqVectors
> > > > > > > > > > (SegmentReader.java:981)
> > > > > > > > > > at org.cr.rf.RelevanceFeedback.RelFeedbackWeight
> > > > > > > > > > (RelevanceFeedback.java:134)
> > > > > > > > > > at
> > > > > > > > > > org.cr.search.TrecQueryRelevanceFeedback.main
> > > > > > > > > > (TrecQueryRelevanceFeedback.java:781)
> > > > > > > > > >
> > > > > > > > > >
> > > > > > > > > >
> > > > > > > > > >
> > > > > > > > > > Mark Miller wrote:
> > > > > > > > > >
> > > > > > > > > > > Any recent changes that would expose index corruption?
> > > > > > > > > > >
> > > > > > > > > > > I am getting two new errors when trying to search:
> > > > > > > > > > >
> > > > > > > > > > > nullpointer fieldsreaders line 260
> > > > > > > > > > >
> > > > > > > > > > > indexoutofbounds on fieldinfo line 185
> > > > > > > > > > >
> > > > > > > > > > > I am kind of screwed, because reindexing fixes this,
> > > > > > > > > > > but I cant
> > > > > > > > > > > reindex!
> > > > > > > > > > >
> > > > > > > > > > > Any ideas?
> > > > > > > > > > >
> > > > > > > > > > >
> > > > > > > > > > >
> > > > > > > > > > > ----------------------------------------------------------------
> > > > > > > > > > > --
> > > > > > > > > > > --
> > > > > > > > > > > -
> > > > > > > > > > > To unsubscribe, e-mail: java-user-
> > > > > > > > > > > unsubscribe@lucene.apache.org
> > > > > > > > > > > For additional commands, e-mail: java-user-
> > > > > > > > > > > help@lucene.apache.org
> > > > > > > > > > >
> > > > > > > > > > >
> > > > > > > > > > >
> > > > > > > > > >
> > > > > > > > > >
> > > > > > > > > > -----------------------------------------------------------------
> > > > > > > > > > --
> > > > > > > > > > --
> > > > > > > > > > To unsubscribe, e-mail: java-user-
> > > > > > > > > > unsubscribe@lucene.apache.org
> > > > > > > > > > For additional commands, e-mail: java-user-
> > > > > > > > > > help@lucene.apache.org
> > > > > > > > > >
> > > > > > > > > >
> > > > > > > > >
> > > > > > > > >
> > > > > > > > > ------------------------------------------------------------------
> > > > > > > > > --
> > > > > > > > > -
> > > > > > > > > To unsubscribe, e-mail:
> > > > > > > > > java-user-unsubscribe@lucene.apache.org
> > > > > > > > > For additional commands, e-mail: java-user-
> > > > > > > > > help@lucene.apache.org
> > > > > > > > >
> > > > > > > > >
> > > > > > > >
> > > > > > > >
> > > > > > > > -------------------------------------------------------------------
> > > > > > > > --
> > > > > > > > To unsubscribe, e-mail:
> > > > > > > > java-user-unsubscribe@lucene.apache.org
> > > > > > > > For additional commands, e-mail: java-user-
> > > > > > > > help@lucene.apache.org
> > > > > > > >
> > > > > > > >
> > > > > > >
> > > > > > >
> > > > > > > --------------------------------------------------------------------
> > > > > > > -
> > > > > > > To unsubscribe, e-mail:
> > > > > > > java-user-unsubscribe@lucene.apache.org
> > > > > > > For additional commands, e-mail:
> > > > > > > java-user-help@lucene.apache.org
> > > > > > >
> > > > > > >
> > > > > >
> > > > > >
> > > > > > ---------------------------------------------------------------------
> > > > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > > > For additional commands, e-mail:
> > > > > > java-user-help@lucene.apache.org
> > > > > >
> > > > > >
> > > > >
> > > > >
> > > > > ---------------------------------------------------------------------
> > > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > > >
> > > > >
> > > >
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> > >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_10157_16406596.1210066189067--

From java-user-return-33931-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 11:38:55 2008
Return-Path: <java-user-return-33931-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36372 invoked from network); 6 May 2008 11:38:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 11:38:55 -0000
Received: (qmail 97855 invoked by uid 500); 6 May 2008 11:38:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97809 invoked by uid 500); 6 May 2008 11:38:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97798 invoked by uid 99); 6 May 2008 11:38:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 04:38:48 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 11:38:01 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JtLUt-0005v1-2A
	for java-user@lucene.apache.org; Tue, 06 May 2008 04:38:15 -0700
Message-ID: <17080852.post@talk.nabble.com>
Date: Tue, 6 May 2008 04:38:15 -0700 (PDT)
From: esra <esraersan@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: lucene farsi problem
In-Reply-To: <9294E20AED46934EA459020706463F94A04B4C@SUEXCL-02.ad.syr.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: esraersan@gmail.com
References: <16977096.post@talk.nabble.com> <08DF1421-37F0-4124-BCE3-DCD68EEC189A@apache.org> <16980977.post@talk.nabble.com> <1B1FC94C-66E4-4A8D-8C92-38CCCEFDF3E8@apache.org> <16993174.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04A4E@SUEXCL-02.ad.syr.edu> <17019498.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04AD2@SUEXCL-02.ad.syr.edu> <17022861.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04ADD@SUEXCL-02.ad.syr.edu> <17023557.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04AE6@SUEXCL-02.ad.syr.edu> <17034715.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04B4C@SUEXCL-02.ad.syr.edu>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Steven ,
Hi Steven,

i tried the class and it works fine with the locale parameter "ar".

Actually we are using "fa" for farsi and "ar" for arabic.
I have added a little control for the locale parameter in my code and now i
can see the correct results.

Thank you very much for ypur help.

Esra.



Steven A Rowe wrote:
>=20
> Hi Esra,
>=20
> I have attached a patch to LUCENE-1279 containing a new class:
> CollatingRangeQuery.
>=20
> The patch also contains a test class: TestCollatingRangeQuery.  One of th=
e
> test methods checks for the Farsi range you were having trouble with.
>=20
> It should be mentioned that according to Collator.getAvailableLocales(),
> neither Java 1.4.2 nor Java 1.5.0 contains Farsi collation information.=
=20
> However, in the test class I use the Arabic Locale, which seems to
> properly collate the non-Arabic Farsi letter U+0698, and hopefully behave=
s
> well with other Farsi letters.  If you find that this is not the case, yo=
u
> can look into writing collation rules using RuleBasedCollator - you shoul=
d
> be able to directly specify the proper letter orderings for Farsi;
> CollatingRangeQuery would also have to supply a constructor that takes in
> a Collator instead of a Locale.
>=20
> Please give the class a try and post back about how it works.
>=20
> Thanks,
> Steve
>=20
> On 05/03/2008 at 8:33 AM, esra wrote:
>>=20
>> Hi Steven,
>>=20
>> thanks for your help....
>>=20
>> Esra
>>=20
>>=20
>> Steven A Rowe wrote:
>> >=20
>> > Hi Esra,
>> >=20
>> > I have created an issue for this - see
>> > <https://issues.apache.org/jira/browse/LUCENE-1279>.
>> >=20
>> > I'll try to take a crack at a patch this weekend.
>> >=20
>> > Steve
>> >=20
>> > On 05/02/2008 at 12:55 PM, esra wrote:
>> > >=20
>> > > Hi Steven ,
>> > >=20
>> > > yes you are right, sorry i am a bit confused.
>> > >=20
>> > > i checked again and the correct one is  "zhe"/U+698.
>> > >=20
>> > > It seems the word is in the range but my customer says it
>> > > shouldn't be.
>> > >=20
>> > > I think problem occurs because  "zhe" is a Persian letter
>> > > outside the Arabic
>> > > alphabet. In farsi alphabet this letter is not after the "=D8=B3"
>> > > letter but it's
>> > > unicode is bigger than "=D8=B3" letter's and the searcher works
>> > > with unicodes.
>> > >=20
>> > > Esra
>> > >=20
>> > >=20
>> > > Steven A Rowe wrote:
>> > > >=20
>> > > > Hi Esra,
>> > > >=20
>> > > > You are *still* incorrectly referring to the glyph with three dots
>> > > > over it:
>> > > >=20
>> > > > On 05/02/2008 at 12:18 PM, esra wrote:
>> > > > > yes the correct one is "=DA=98 "/"ze"/U+632.
>> > > >=20
>> > > > "=DA=98" is *not* "ze"/U+632 - it is "zhe"/U+698.
>> > > >=20
>> > > > Have you increased the font size?  Can you see the difference
>> between
>> > > > these two?:
>> > > >=20
>> > > > "=DA=98"/"zhe"/U+698
>> > > > "=D8=B2"/"ze"/U+632
>> > > >=20
>> > > > > my problem is when i do search for  "=D8=AF-=DA=98" range. The r=
esult is=20
>> "=D8=B3=D8=A7=D8=A8
>> > > > > =D9=88=D9=88=D9=81=D8=B1" and this word's first letter is "=D8=
=B3" and it's unicode is
>> > > > > "U+633" and it is not in the in the [ U+062F - U+0632 ] range.
>> > > >=20
>> > > > Like I keep saying, in the above description, you're using the
>> glyph
>> > > > "=DA=98"/"zhe"/U+698, while calling at the same time incorrectly
>> referring
>> > > > to it as "ze"/U+632.
>> > > >=20
>> > > > I don't mean to continually bang on about this - if you're *sure*
>> > > > that when you search, you're using the character represented by th=
e
>> > > > glyph with one dot (and not three), i.e. "=D8=B2"/"ze"/U+632, then=
 the
>> > > > problem lies elsewhere.
>> > > >=20
>> > > > Steve
>> > > >=20
>> > > > On 05/02/2008 at 12:18 PM, esra wrote:
>> > > > > yes the correct one is "=DA=98 "/"ze"/U+632.
>> > > > >=20
>> > > > > my problem is when i do search for  "  =D8=AF-=DA=98" range. The=
 result
>> > > > > is  ""=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1
>> > > > > " and this word's first letter is "=D8=B3 " and it's unicode is
>> > > > > "U+633"  and  it
>> > > > > is not in the in the [ U+062F - U+0632 ] range.
>> > > > >=20
>> > > > > am i wrong?
>> > > > >=20
>> > > > > Esra
>> > > > >=20
>> > > > > Steven A Rowe wrote:
>> > > > > >=20
>> > > > > > Hi Esra,
>> > > > > >=20
>> > > > > > I still think you're wrong :).
>> > > > > >=20
>> > > > > > On 05/02/2008 at 9:31 AM, esra wrote:
>> > > > > > > > =DA=98 =3D U+632
>> > > > > >=20
>> > > > > > According to the website you linked to, the above character,
>> which
>> > > > > > has three dots over it, is named "zhe", and its
>> Unicode code point
>> > > is
>> > > > > > U+698. (I had to increase the font size to see the three dots.=
)
>> > > > > >=20
>> > > > > > I think you are confusing "=DA=98"/"zhe"/U+698 with the letter
>> > > > > > "=D8=B2"/"ze"/U+632, which has just one dot over it.
>> > > > > >=20
>> > > > > > Unless you were mistaken in all of your emails when
>> you included
>> > > the
>> > > > > > character "=DA=98"/"zhe" instead of "=D8=B2"/"ze", then what I=
 said in my
>> > > > > > previous email still stands: there is no problem here.
>> > > > > >=20
>> > > > > > Steve
>> > > > > >=20
>> > > > > > On 05/02/2008 at 9:31 AM, esra wrote:
>> > > > > > >=20
>> > > > > > > Hi Steven,
>> > > > > > >=20
>> > > > > > > sorry i made a mistake. unicodes are like this:
>> > > > > > >=20
>> > > > > > > > =D8=AF=3DU+62F
>> > > > > > > > =DA=98 =3D U+632
>> > > > > > > > and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=
=D9=81=D8=B1 " is  =D8=B3 =3D U+633
>> > > > > > >=20
>> > > > > > > you can also check them here
>> > > > > > > >=20
>> > > http://www.unics.uni-hannover.de/nhtcapri/persian-alphabet.html
>> > > > > > >=20
>> > > > > > > Esra
>> > > > > > >=20
>> > > > > > >=20
>> > > > > > > Steven A Rowe wrote:
>> > > > > > > >=20
>> > > > > > > > Hi Esra,
>> > > > > > > >=20
>> > > > > > > > Going back to the original problem statement, I
>> see something
>> > > that
>> > > > > > > > looks illogical to me - please correct me if I'm wrong:
>> > > > > > > >=20
>> > > > > > > > On Apr 30, 2008, at 3:21 AM, esra wrote:
>> > > > > > > > > i am using lucene's "IndexSearcher" to search
>> the given xml
>> > > by
>> > > > > > > > > keyword which contains farsi information.
>> while searching i
>> > > use
>> > > > > > > > > ranges like
>> > > > > > > > >=20
>> > > > > > > > > =D8=A2-=D8=AB  |  =D8=AC-=D8=AE  |  =D8=AF-=DA=98  |  =
=D8=B3-=D8=B8  |  =D8=B9-=D9=82  |  =DA=A9-=D9=84  |  =D9=85-=DB=8C
>> > > > > > > > >=20
>> > > > > > > > > when i do search for  "=D8=AF-=DA=98"  range the results
>> are wrong ,
>> > > they
>> > > > > > > > > are the results of  " =D8=B3-=D8=B8 "range.
>> > > > > > > > >=20
>> > > > > > > > > for example when i do search for "=D8=AF-=DA=98"  one of=
 the the
>> results
>> > > > > > > > > is "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1", this r=
esult also shown on the "
>> =D8=B3-=D8=B8 " range's
>> > > result
>> > > > > > > > > list which is the corret range.
>> > > > > > > > >=20
>> > > > > > > > > As IndexSearcher use "compareTo" method and this method
>> uses
>> > > > > > > > > unicodes for comparing, i found the unicodes of the
>> characters.
>> > > > > > > > >=20
>> > > > > > > > > =D8=AF=3DU+62F
>> > > > > > > > > =DA=98 =3D U+698
>> > > > > > > > > and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=
=D9=81=D8=B1 " is  =D8=B3 =3D U+633
>> > > > > > > >=20
>> > > > > > > > It appears to me that *both* the "=D8=AF-=DA=98" range [
>> > > U+062F - U+0698 ]
>> > > > > and
>> > > > > > > > the "=D8=B3-=D8=B8" range [ U+0633 - U+0638 ] contain the
>> > > first letter of
>> > > > > "=D8=B3=D8=A7=D8=A8
>> > > > > > > > =D9=88=D9=88=D9=81=D8=B1", which is "=D8=B3" =3D U+0633.
>> > > > > > > >=20
>> > > > > > > > You stated that U+0633 should be contained in the [
>> > > U+0633 - U+0638
>> > > > > ]
>> > > > > > > > range - I agree - but why do you think U+0633 should not b=
e
>> > > > > > > > contained in the [ U+062F - U+0698 ] range?
>> > > > > > > >=20
>> > > > > > > > In other words, it looks to me like your problem is
>> > > not a problem
>> > > > > at
>> > > > > > > > all.
>> > > > > > > >=20
>> > > > > > > > Steve
>> > > > > > > >=20
>> > > > > > > >=20
>> > > > > > >=20
>> > > > > > > -- View this message in context:
>> > > > > > >=20
>> > > > > http://www.nabble.com/lucene-farsi-problem-tp16977096p17019498
>> > > > > .html Sent
>> > > > > > from the Lucene - Java Users mailing list archive at
>> Nabble.com.
>> > > > > >=20
>> > > > > >=20
>> > > > > >=20
>> > >=20
>> ---------------------------------------------------------------------
>> > > > > To
>> > > > > > unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For
>> > > > > > additional commands, e-mail: java-user-help@lucene.apache.org
>> > > > > >=20
>> > > > > >=20
>> > > > >=20
>> > > > >=20
>> > > > >=20
>> > > > >=20
>> > > > >=20
>> > > > >=20
>> > > > > -- View this message in context:
>> > > >=20
>> http://www.nabble.com/lucene-farsi-problem-tp16977096p17022861.html
>> > > >  Sent from the Lucene - Java Users mailing list archive at
>> > > Nabble.com.
>> > > >=20
>> > > >=20
>> > > >=20
>> > >=20
>> ---------------------------------------------------------------------
>> > > >  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > > >  For additional commands, e-mail:
>> java-user-help@lucene.apache.org
>> > > >=20
>> > > >=20
>> > > >=20
>> > > >=20
>> > > >=20
>> > >=20
>> > > -- View this message in context:
>> > >=20
>> http://www.nabble.com/lucene-farsi-problem-tp16977096p17023557
>  .html Sent
>> > from the Lucene - Java Users mailing list archive at Nabble.com.
>> >=20
>> >=20
>> > ---------------------------------------------------------------------
>> To
>> > unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org For
>> > additional commands, e-mail: java-user-help@lucene.apache.org
>> >=20
>> >=20
>>=20
>>=20
>>=20
>>=20
>>=20
> =20
>  --
>  View this message in context:
> http://www.nabble.com/lucene-farsi-problem-tp16977096p17034715.html
>  Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> =20
> =20
>  ---------------------------------------------------------------------
>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
> =20
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/lucene-farsi-problem-tp=
16977096p17080852.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33932-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 15:40:17 2008
Return-Path: <java-user-return-33932-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57149 invoked from network); 6 May 2008 15:40:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 15:40:16 -0000
Received: (qmail 23233 invoked by uid 500); 6 May 2008 15:40:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23203 invoked by uid 500); 6 May 2008 15:40:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23192 invoked by uid 99); 6 May 2008 15:40:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 08:40:10 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.35] (HELO smtp-vbr15.xs4all.nl) (194.109.24.35)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 15:39:17 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr15.xs4all.nl (8.13.8/8.13.8) with ESMTP id m46FdcAV092850
	for <java-user@lucene.apache.org>; Tue, 6 May 2008 17:39:38 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Filtering a SpanQuery
Date: Tue, 6 May 2008 17:39:38 +0200
User-Agent: KMail/1.9.9
References: <74f928500805060115k6c6373bdib50b0e1ec88ecbbc@mail.gmail.com>
In-Reply-To: <74f928500805060115k6c6373bdib50b0e1ec88ecbbc@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805061739.38357.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Eran,

Op Tuesday 06 May 2008 10:15:10 schreef Eran Sevi:
> Hi,
>
> I am looking for a way to filter a SpanQuery according to some other
> query (on another field from the one used for the SpanQuery). I need
> to get access to the spans themselves of course.
>  I don't care about the scoring of the filter results and just need
> the positions of hits found in the documents that matches the filter.

I think you'll have to implement the filtering on the Spans yourself.
That's not really difficult, just use Spans.skipTo().
The code to do that could look sth like this (untested):

Spans spans = yourSpanQuery.getSpans(reader);
BitSet bits = yourFilter.bits(reader);
int filterDoc = bits.nextSetBit(0);
while ((filterDoc >= 0) and spans.skipTo(filterDoc)) {
  boolean more = true;
  while (more and (spans.doc() == filterDoc)) {
     // use spans.start() and spans.end() here
     // ...
     more = spans.next();
  }
  if (! more) {
    break;
  }
  filterDoc = bits.nextSetBit(spans.doc());
}

Please check the javadocs of java.util.BitSet, there may
be a 1 off error in the arguments to nextSetBit().

Regards,
Paul Elschot


>
> I tried looking through the archives and found some reference to a
> SpanQueryFilter patch, however I don't see how it can help me achieve
> what I want to do. This class receives only one query parameter
> (which I guess is the actual query) and not a query and a filter for
> example.
>
> Any help about how I can achieve this will be appreciated.
>
> Thanks,
> Eran.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33933-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:07:43 2008
Return-Path: <java-user-return-33933-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71513 invoked from network); 6 May 2008 16:07:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:07:43 -0000
Received: (qmail 55610 invoked by uid 500); 6 May 2008 16:07:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55587 invoked by uid 500); 6 May 2008 16:07:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55576 invoked by uid 99); 6 May 2008 16:07:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:07:37 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of vmirage@gmail.com designates 209.85.146.178 as permitted sender)
Received: from [209.85.146.178] (HELO wa-out-1112.google.com) (209.85.146.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:06:52 +0000
Received: by wa-out-1112.google.com with SMTP id l24so499028waf.11
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 09:07:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=y+/Xo6aVBwCA06AXejHhIdpHySiVP+6Q8F2Imf/zaGU=;
        b=l4t9bbj/XgRWgSjH8VUUZR+kyaDQh2SkttQfX3G0ZcQM3PjlKJbMe5cAsYTJ9HzyMwGVYfQ3qwtbdc5S8XH3J38mV/NVidG2V8GFBriOoqi9LFqeu9KuWo2MmvyqpZRYOrRQYRduyw+WaXso6yNrvhdRQej7M4CUQoHuPAfPes8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=U9rKiSJXHdz0rEKg56UBBpauGayiUn0Zq9krdhWyETjUQGgkOtPyjtTjq9aybshZ0O9B4gA55zdrHIqA7r/eWwAgSORjnHVGMMRnYeqB4J5DL75dqg3wW5cqoXVD2pNBC3V0t9kiyabu8DUXm/CmQ827AlCaLBT9Pwf3AEkjidg=
Received: by 10.114.73.14 with SMTP id v14mr893772waa.163.1210090026643;
        Tue, 06 May 2008 09:07:06 -0700 (PDT)
Received: by 10.114.174.10 with HTTP; Tue, 6 May 2008 09:07:06 -0700 (PDT)
Message-ID: <98ba5e100805060907q48473c11q6a37262e2c8e2992@mail.gmail.com>
Date: Wed, 7 May 2008 00:07:06 +0800
From: "Kelvin Foo Chuan Lyi" <vmirage@gmail.com>
To: java-user@lucene.apache.org
Subject: Multiple Field search
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_28052_2367801.1210090026660"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_28052_2367801.1210090026660
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

I'm new to lucene and have a question on how to create a query for the
following example... Say I have two fields, Title and Description, with the
following data

Item 1
Title: The greatest hits
Description : Collection of the best music from The Beatles.

Item 2
Title: U2 collections
Description : Greatest hits collection of U2


In my search, I want to search for 'greatest hits beatles'. The result
should return only Item 1..  how should the query looks like??


Thanks.




-- 
Sayonara,
Kelvin

------=_Part_28052_2367801.1210090026660--

From java-user-return-33934-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:14:40 2008
Return-Path: <java-user-return-33934-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76066 invoked from network); 6 May 2008 16:14:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:14:39 -0000
Received: (qmail 65532 invoked by uid 500); 6 May 2008 16:14:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65332 invoked by uid 500); 6 May 2008 16:14:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65321 invoked by uid 99); 6 May 2008 16:14:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:14:33 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of michaelysiu@hotmail.com designates 65.54.246.98 as permitted sender)
Received: from [65.54.246.98] (HELO bay0-omc1-s26.bay0.hotmail.com) (65.54.246.98)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:13:46 +0000
Received: from hotmail.com ([65.55.133.14]) by bay0-omc1-s26.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 6 May 2008 09:14:01 -0700
Received: from mail pickup service by hotmail.com with Microsoft SMTPSVC;
	 Tue, 6 May 2008 09:14:00 -0700
Message-ID: <BAY128-DAV48197750816BF4C0A00ACBED60@phx.gbl>
Received: from 209.189.193.162 by BAY128-DAV4.phx.gbl with DAV;
	Tue, 06 May 2008 16:13:56 +0000
X-Originating-IP: [209.189.193.162]
X-Originating-Email: [michaelysiu@hotmail.com]
X-Sender: michaelysiu@hotmail.com
From: "Michael Siu" <michaelysiu@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: How to make a query that associates 2 index files
Date: Tue, 6 May 2008 09:14:31 -0700
Message-ID: <026701c8af94$445aa170$cd0fe450$@com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0268_01C8AF59.97FBC970"
X-Mailer: Microsoft Office Outlook 12.0
thread-index: AcivlERJQI2yINkYQ22eQhIqmkLlsg==
Content-Language: en-us
X-OriginalArrivalTime: 06 May 2008 16:14:00.0518 (UTC) FILETIME=[31C69E60:01C8AF94]
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_0268_01C8AF59.97FBC970
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

Hi,

 

I am a newbie to Lucene. I have a question for making a query that associate
2 index files:

 

- One index has the content index for a list of documents and a key to the
document. That means the Lucene document of this index contains 2 fields:

the 'content' and the 'key'.

- another index has the some data indexed associated with the 'key' in the
previous index. The Lucene document of this index contains several fields:

the 'who' that contains some data and the 'key' that _points_ to the
document in the first index.

 

Sample data:

Index_1:   [key] [content] 

            Abc   "blah blah 123 ..."

            Xyz   "123 321 a nice day ..."

 

Index_2:   [who]    [accessed]   [key]

            David    1/1/2007     Abc

            Someone  1/2/2005     Abc

            Guess    12/1/2000    Xyz

            Harry    1/1/2008     Abc

            Sandra   1/1/2003     Xyz

 

As shown, the [key] field in Index_2 has repeated value that _points_ to the
[key] values in Index_1. How do I make a query for the following: 

 

Find out all documents in Index_2:

- [who] is in range of 'David' to 'Guess' and

- [accessed] in range '1/1/1900' to '1/1/2010' and

- [key] associated [content] in Index_1 that contains the term 'blah' 

 

I know this is more SQL like query. Is Lucene capable of doing this type of
query that needs associations among index files?

 

Thanks in advance.

 

- m

 

 

 


------=_NextPart_000_0268_01C8AF59.97FBC970--


From java-user-return-33935-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:29:10 2008
Return-Path: <java-user-return-33935-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81391 invoked from network); 6 May 2008 16:29:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:29:09 -0000
Received: (qmail 93226 invoked by uid 500); 6 May 2008 16:29:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92758 invoked by uid 500); 6 May 2008 16:29:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92747 invoked by uid 99); 6 May 2008 16:29:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:29:03 -0700
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:28:18 +0000
Received: by fg-out-1718.google.com with SMTP id l27so863872fgb.27
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 09:28:25 -0700 (PDT)
Received: by 10.86.4.2 with SMTP id 2mr1886807fgd.62.1210091305529;
        Tue, 06 May 2008 09:28:25 -0700 (PDT)
Received: by 10.86.76.17 with HTTP; Tue, 6 May 2008 09:28:25 -0700 (PDT)
Message-ID: <11e852b50805060928t1039a523o3a20c20681592c54@mail.gmail.com>
Date: Tue, 6 May 2008 17:28:25 +0100
From: "Chris Mannion" <chris.mannion@nonstopgov.com>
To: java-user@lucene.apache.org
Subject: Postcode/zipcode search
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_13522_13480380.1210091305527"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_13522_13480380.1210091305527
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi all

I've got a bit of a niggling problem with how one of my searches is working
as opposed to how my users would like it too work.  We're indexing on UK
postcodes, which are in the format of a 3 or 4 character area code followed
by a 3 or 4 character street specific code, e.g. "NW10 7NY" or "M11 1LQ".
We originally had the values being indexed as tokenized and used a very
simple search string in the format "postcode:xxx xxx", with no grouping or
boosting or fuzzy searching, just an straight search on whatever the user
answered.  This had the benefit of finding exact matches to searches and
allowing us to search just on the area part of the code to return all
records with that area code, eg a search on "NW2" returning anything
starting NW2, like "NW2 6TB", "NW2 1ER" etc etc.

However, the downside to that was that searches could also return records
only tenuously related to what was searched for, eg. a search for "NW10 7NY"
would also return a record with a postcode "SE9 6NY" because of the slight
match of the "NY".  Obviously this was technically correct but users
complained because their searches were returning records from completely
different areas.  Our first step to put this right was to take off the
tokenization of the field, which we also weren't happy with so have
continued to fiddle.

The current status is as follows - we index the values by stripping out
spaces and tokeniing them and use a keywordAnalyzer.  In searching we also
strip spaces from the search term entered and search with a
keywordAnalyzer.  Searches for full postcodes, e.g. "NW10 7NY" find all
exact matches but also any full values that are partial matches (e.g. some
records just have "NW10" as their postcode field and the "NW10 7NY" search
pulls them back too), but searches for partial postcodes e.g. "NW10" still
only finds exact matches, e.g. it only pulls back those record that have
just "NW10" as their postcode, rather than anything *starting* with NW10 as
we'd like it to do.

Can anyone help me get this working in the way we need it too please?

-- 
Chris Mannion
iCasework and LocalAlert implementation team
0208 144 4416

------=_Part_13522_13480380.1210091305527--

From java-user-return-33936-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:33:27 2008
Return-Path: <java-user-return-33936-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82531 invoked from network); 6 May 2008 16:33:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:33:27 -0000
Received: (qmail 96642 invoked by uid 500); 6 May 2008 16:33:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96614 invoked by uid 500); 6 May 2008 16:33:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96602 invoked by uid 99); 6 May 2008 16:33:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:33:17 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.187 as permitted sender)
Received: from [209.85.128.187] (HELO fk-out-0910.google.com) (209.85.128.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:32:32 +0000
Received: by fk-out-0910.google.com with SMTP id 18so30fkq.5
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 09:32:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=OhAi6XsarjdZ/d7TDRBH1/WpJzQ7TSLc2+Ms1eKEXAI=;
        b=YvUkryHqrppgA4F55XlOsXKlLLUzNbG0AGxQ1zdr0mfJ1TTIwZ/Z2DIprkeW+rwKD3W4NhYpaHcdMJnbWJumpCII9X3tWAFeBzNO+shX8iXmgSPmblzzeb+sLu4EjNermP/S1/725SXlrdyf6QmzlI/SEGAyUvdfslaL6Z23GQI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=b4Buhq98A7/vjwibxhRlOUeswI8ieGfvdMXtBJRl9tSK8JJZuAM20VjREqPpK8NTjSYevOKwy4KcM2s7A/kKGrgeBy1AHREC+BeXHCVNCGDBGHsxplhCPXJSLK5yVGFdbg9REy4kZB6WABsy6AkhUb7B7SYDmoXbL/yPmzydd/c=
Received: by 10.82.175.17 with SMTP id x17mr101274bue.0.1210091563540;
        Tue, 06 May 2008 09:32:43 -0700 (PDT)
Received: by 10.82.191.6 with HTTP; Tue, 6 May 2008 09:32:43 -0700 (PDT)
Message-ID: <359a92830805060932p22a19352t7e526bb4745ca277@mail.gmail.com>
Date: Tue, 6 May 2008 12:32:43 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Multiple Field search
In-Reply-To: <98ba5e100805060907q48473c11q6a37262e2c8e2992@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_19532_4319104.1210091563534"
References: <98ba5e100805060907q48473c11q6a37262e2c8e2992@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_19532_4319104.1210091563534
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

One of my favorite quotes from Roger Zelazny... "postulating
infinity, the rest is easy".

In this case, "infinity" is how you break up your query. The easy part is
making your search return what you want.

Assuming you know that you want "greatest" and
"hits" to go against the title field and "beatles" to
go against description, your query looks something
like:

+title:greatest +title:hits +description:beatles

But knowing you want to break up the query like that is the hard part.

Sometimes you can make it work well enough by submitting all
terms against both fields with an OR clause, something like:

title:(+greatest +hits +beatles) description:(+greatest +hits +beatles)
(note, OR is implied between title and description)

which would not work in your case. Another technique is to dump
all the words into a single uber-field *as well as* your individual
fields, so the search
uber:(+greatest +hits +beatles) would work for you. Note that if
you index (but do NOT store) the uber field and store (but do NOT index)
the text and description fields, your index stays about the same size.....

Anyway, you need to carefully define how your searches *should* work,
then define your index structure IMO.

Best
Erick

On Tue, May 6, 2008 at 12:07 PM, Kelvin Foo Chuan Lyi <vmirage@gmail.com>
wrote:

> I'm new to lucene and have a question on how to create a query for the
> following example... Say I have two fields, Title and Description, with
> the
> following data
>
> Item 1
> Title: The greatest hits
> Description : Collection of the best music from The Beatles.
>
> Item 2
> Title: U2 collections
> Description : Greatest hits collection of U2
>
>
> In my search, I want to search for 'greatest hits beatles'. The result
> should return only Item 1..  how should the query looks like??
>
>
> Thanks.
>
>
>
>
> --
> Sayonara,
> Kelvin
>

------=_Part_19532_4319104.1210091563534--

From java-user-return-33937-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:36:55 2008
Return-Path: <java-user-return-33937-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83711 invoked from network); 6 May 2008 16:36:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:36:55 -0000
Received: (qmail 4667 invoked by uid 500); 6 May 2008 16:36:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3663 invoked by uid 500); 6 May 2008 16:36:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3652 invoked by uid 99); 6 May 2008 16:36:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:36:49 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.186 as permitted sender)
Received: from [209.85.128.186] (HELO fk-out-0910.google.com) (209.85.128.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:36:03 +0000
Received: by fk-out-0910.google.com with SMTP id 18so1197fkq.5
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 09:36:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=xJqf/Ucnt07mohPQOkQamOjkUg0bX25LVmOhJ/piBsU=;
        b=qvUUHy9rH0pCl+oTucemvrVnP9s8GesD8MEIZlAxEMwU3w2AgbszH7E9eQlzSD88HDa9Aycf6guOG4WPolgYYMH6G0O9geDpsqPbkKRmOrYibL0qtvsI7qwsjyyzsc76ScwFW0IgmjyvLyFTeUysTfyCdpB84CrYHUHM0ZToC2A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=KVDNjA49c6y8kLqq1zJRE8ZCb58Kdhz9yarwvK3pZJB1N3xq9y2sp5CdGdXW+n0d60eqxe0TiWHXusfCOKU2ZPpzanDO7nP3NxCZCN1S931fEMD18mjpbRXNNgJOnK5DlHMOElxIilC80Uwam7c3o6pBDAKlCqN5SvEOAKJjCt8=
Received: by 10.82.124.10 with SMTP id w10mr99263buc.18.1210091775602;
        Tue, 06 May 2008 09:36:15 -0700 (PDT)
Received: by 10.82.191.6 with HTTP; Tue, 6 May 2008 09:36:15 -0700 (PDT)
Message-ID: <359a92830805060936x1d5f8ecm6eff1b1f67a0c97d@mail.gmail.com>
Date: Tue, 6 May 2008 12:36:15 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to make a query that associates 2 index files
In-Reply-To: <BAY128-DAV48197750816BF4C0A00ACBED60@phx.gbl>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_19566_8422951.1210091775575"
References: <BAY128-DAV48197750816BF4C0A00ACBED60@phx.gbl>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_19566_8422951.1210091775575
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

You don't. You really have to roll your own solution here, there's
no "inter-index" awareness that I know of in Lucene.

Typically, people either do a half-half solution (that is, put the
text search in Lucene and leave the DB parts in the DB) or
de-normalize the data in a Lucene index so you don't have
to even try to do things cross-index.

And then there's Marcelo Ochoa (I may have the spelling wrong) who's
put together some way to embed Lucene in an Oracle database, but
that's magic to me.

Why do you want to arrange your index this way in the first place?
Perhaps there's a more specific answer waiting out there...

Best
Erick

On Tue, May 6, 2008 at 12:14 PM, Michael Siu <michaelysiu@hotmail.com>
wrote:

> Hi,
>
>
>
> I am a newbie to Lucene. I have a question for making a query that
> associate
> 2 index files:
>
>
>
> - One index has the content index for a list of documents and a key to the
> document. That means the Lucene document of this index contains 2 fields:
>
> the 'content' and the 'key'.
>
> - another index has the some data indexed associated with the 'key' in the
> previous index. The Lucene document of this index contains several fields:
>
> the 'who' that contains some data and the 'key' that _points_ to the
> document in the first index.
>
>
>
> Sample data:
>
> Index_1:   [key] [content]
>
>            Abc   "blah blah 123 ..."
>
>            Xyz   "123 321 a nice day ..."
>
>
>
> Index_2:   [who]    [accessed]   [key]
>
>            David    1/1/2007     Abc
>
>            Someone  1/2/2005     Abc
>
>            Guess    12/1/2000    Xyz
>
>            Harry    1/1/2008     Abc
>
>            Sandra   1/1/2003     Xyz
>
>
>
> As shown, the [key] field in Index_2 has repeated value that _points_ to
> the
> [key] values in Index_1. How do I make a query for the following:
>
>
>
> Find out all documents in Index_2:
>
> - [who] is in range of 'David' to 'Guess' and
>
> - [accessed] in range '1/1/1900' to '1/1/2010' and
>
> - [key] associated [content] in Index_1 that contains the term 'blah'
>
>
>
> I know this is more SQL like query. Is Lucene capable of doing this type
> of
> query that needs associations among index files?
>
>
>
> Thanks in advance.
>
>
>
> - m
>
>
>
>
>
>
>
>

------=_Part_19566_8422951.1210091775575--

From java-user-return-33938-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:37:51 2008
Return-Path: <java-user-return-33938-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84084 invoked from network); 6 May 2008 16:37:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:37:51 -0000
Received: (qmail 7338 invoked by uid 500); 6 May 2008 16:37:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7302 invoked by uid 500); 6 May 2008 16:37:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7291 invoked by uid 99); 6 May 2008 16:37:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:37:46 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of vmirage@gmail.com designates 209.85.146.183 as permitted sender)
Received: from [209.85.146.183] (HELO wa-out-1112.google.com) (209.85.146.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:37:01 +0000
Received: by wa-out-1112.google.com with SMTP id l24so513460waf.11
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 09:37:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=MA4bQGuaMtjvMlbn8T0sxYvk8D/1JtOxKoY88F/d2sg=;
        b=jn8Q75HdF+GEBzAexeG2Zk2eazT92y+4c397N/qIcSaTZti4+LA+1rspu1i5ZcqksSQ8Xc0rDrR30YtXW1zSyWXmiaaObEBqaBHOilJTHg19kD+FnhojozSYMNiGUKa55BKVXeB2fge3L/7CQsFvlE7EEie8CeIz5AHlxMr+kUg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=I4atlXuwaSi1uqa9qOVmk0xCjKp7tZN3sP7w6aXb1/a7Pvm8n3Q7B23ZwP0qUXltXWHCGJxcAL9OHjtLRo0I0KvlYxBdvSoM4M1RSlkpiJIg3XMWqC5NZBcmId94SDTULcQie10VHqaw27i3WiPfObFas+uAafwgNOUm33HGG9U=
Received: by 10.114.175.16 with SMTP id x16mr955420wae.12.1210091835665;
        Tue, 06 May 2008 09:37:15 -0700 (PDT)
Received: by 10.114.174.10 with HTTP; Tue, 6 May 2008 09:37:15 -0700 (PDT)
Message-ID: <98ba5e100805060937s472dc538u77a63584dc165866@mail.gmail.com>
Date: Wed, 7 May 2008 00:37:15 +0800
From: "Kelvin Foo Chuan Lyi" <vmirage@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Multiple Field search
In-Reply-To: <359a92830805060932p22a19352t7e526bb4745ca277@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_28164_4830142.1210091835656"
References: <98ba5e100805060907q48473c11q6a37262e2c8e2992@mail.gmail.com>
	 <359a92830805060932p22a19352t7e526bb4745ca277@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_28164_4830142.1210091835656
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Thanks... that's what I thought of ... but was wondering if that was the
best method to do so... i guess it is then... :)




On Wed, May 7, 2008 at 12:32 AM, Erick Erickson <erickerickson@gmail.com>
wrote:

> One of my favorite quotes from Roger Zelazny... "postulating
> infinity, the rest is easy".
>
> In this case, "infinity" is how you break up your query. The easy part is
> making your search return what you want.
>
> Assuming you know that you want "greatest" and
> "hits" to go against the title field and "beatles" to
> go against description, your query looks something
> like:
>
> +title:greatest +title:hits +description:beatles
>
> But knowing you want to break up the query like that is the hard part.
>
> Sometimes you can make it work well enough by submitting all
> terms against both fields with an OR clause, something like:
>
> title:(+greatest +hits +beatles) description:(+greatest +hits +beatles)
> (note, OR is implied between title and description)
>
> which would not work in your case. Another technique is to dump
> all the words into a single uber-field *as well as* your individual
> fields, so the search
> uber:(+greatest +hits +beatles) would work for you. Note that if
> you index (but do NOT store) the uber field and store (but do NOT index)
> the text and description fields, your index stays about the same size.....
>
> Anyway, you need to carefully define how your searches *should* work,
> then define your index structure IMO.
>
> Best
> Erick
>
> On Tue, May 6, 2008 at 12:07 PM, Kelvin Foo Chuan Lyi <vmirage@gmail.com>
> wrote:
>
> > I'm new to lucene and have a question on how to create a query for the
> > following example... Say I have two fields, Title and Description, with
> > the
> > following data
> >
> > Item 1
> > Title: The greatest hits
> > Description : Collection of the best music from The Beatles.
> >
> > Item 2
> > Title: U2 collections
> > Description : Greatest hits collection of U2
> >
> >
> > In my search, I want to search for 'greatest hits beatles'. The result
> > should return only Item 1..  how should the query looks like??
> >
> >
> > Thanks.
> >
> >
> >
> >
> > --
> > Sayonara,
> > Kelvin
> >
>



-- 
Sayonara,
Kelvin

------=_Part_28164_4830142.1210091835656--

From java-user-return-33939-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:39:08 2008
Return-Path: <java-user-return-33939-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84540 invoked from network); 6 May 2008 16:39:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:39:08 -0000
Received: (qmail 10598 invoked by uid 500); 6 May 2008 16:39:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9611 invoked by uid 500); 6 May 2008 16:39:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9600 invoked by uid 99); 6 May 2008 16:39:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:39:02 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.119] (HELO spunkymail-a6.g.dreamhost.com) (208.97.132.119)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:38:09 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a6.g.dreamhost.com (Postfix) with ESMTP id 5CDDD109F35
	for <java-user@lucene.apache.org>; Tue,  6 May 2008 09:38:30 -0700 (PDT)
Message-Id: <71F43E2C-7965-4B6A-90DC-7FABA6890F11@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <11e852b50805060928t1039a523o3a20c20681592c54@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Postcode/zipcode search
Date: Tue, 6 May 2008 12:38:28 -0400
References: <11e852b50805060928t1039a523o3a20c20681592c54@mail.gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

You might have a look at using a phrase query when you have more than  
one term in the query in addition to your term query, but giving the  
phrase query more weight (i.e. give an exact match more weight) and  
keep your original tokenization process.

Something like:
"NW10 7NY"^5 OR NW10 OR 7NY

or even downweighting the individual terms.  Thus, exact matches on  
the full phrase will weigh much higher, and you can still do  
individual term matching for the single term case (NW10)

-Grant

On May 6, 2008, at 12:28 PM, Chris Mannion wrote:

> Hi all
>
> I've got a bit of a niggling problem with how one of my searches is  
> working
> as opposed to how my users would like it too work.  We're indexing  
> on UK
> postcodes, which are in the format of a 3 or 4 character area code  
> followed
> by a 3 or 4 character street specific code, e.g. "NW10 7NY" or "M11  
> 1LQ".
> We originally had the values being indexed as tokenized and used a  
> very
> simple search string in the format "postcode:xxx xxx", with no  
> grouping or
> boosting or fuzzy searching, just an straight search on whatever the  
> user
> answered.  This had the benefit of finding exact matches to searches  
> and
> allowing us to search just on the area part of the code to return all
> records with that area code, eg a search on "NW2" returning anything
> starting NW2, like "NW2 6TB", "NW2 1ER" etc etc.
>
> However, the downside to that was that searches could also return  
> records
> only tenuously related to what was searched for, eg. a search for  
> "NW10 7NY"
> would also return a record with a postcode "SE9 6NY" because of the  
> slight
> match of the "NY".  Obviously this was technically correct but users
> complained because their searches were returning records from  
> completely
> different areas.  Our first step to put this right was to take off the
> tokenization of the field, which we also weren't happy with so have
> continued to fiddle.
>
> The current status is as follows - we index the values by stripping  
> out
> spaces and tokeniing them and use a keywordAnalyzer.  In searching  
> we also
> strip spaces from the search term entered and search with a
> keywordAnalyzer.  Searches for full postcodes, e.g. "NW10 7NY" find  
> all
> exact matches but also any full values that are partial matches  
> (e.g. some
> records just have "NW10" as their postcode field and the "NW10 7NY"  
> search
> pulls them back too), but searches for partial postcodes e.g. "NW10"  
> still
> only finds exact matches, e.g. it only pulls back those record that  
> have
> just "NW10" as their postcode, rather than anything *starting* with  
> NW10 as
> we'd like it to do.
>
> Can anyone help me get this working in the way we need it too please?
>
> -- 
> Chris Mannion
> iCasework and LocalAlert implementation team
> 0208 144 4416

--------------------------
Grant Ingersoll

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33940-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:39:36 2008
Return-Path: <java-user-return-33940-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84697 invoked from network); 6 May 2008 16:39:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:39:36 -0000
Received: (qmail 11576 invoked by uid 500); 6 May 2008 16:39:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11539 invoked by uid 500); 6 May 2008 16:39:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11528 invoked by uid 99); 6 May 2008 16:39:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:39:30 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chris.lu@gmail.com designates 216.239.58.186 as permitted sender)
Received: from [216.239.58.186] (HELO gv-out-0910.google.com) (216.239.58.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:38:43 +0000
Received: by gv-out-0910.google.com with SMTP id u5so279065gve.23
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 09:38:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=hdc1i8aXjqnL2TbrhT8ulai6/1H6BZdTt3CEvhZH1bg=;
        b=BYhckqL/Gd4og4HegYtC2qysdyVrHuA2c7S17ipYTS1yL0NJHkNKyXcS46nOJRtDlOHAzWCFvRDGopwGrCqj+EHmkl67JCsUdixGW1isiRlY1ltxYADtRIz+clI0GI53Kw8dAOlNh8BgZ9gNZlFmP57imud+8XILFGj60yM9H0M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=ncwZl+tR19eCXE6z3pKuvek2EpOf62sl2YLy4xre9NK16o3oAvYW+sPETqKDn1gY+Z5Up7K6p/d0/K4E5+gDqUvIGSyTgs5FoWYLzxSSoXIpJ7Fyf/jEKI4Y1giYDBD4+ZDib2HL+ERcZ0xOJRmFXZhlSokID7Z/3gr+4F+qipc=
Received: by 10.78.179.12 with SMTP id b12mr275457huf.61.1210091936222;
        Tue, 06 May 2008 09:38:56 -0700 (PDT)
Received: by 10.78.155.15 with HTTP; Tue, 6 May 2008 09:38:56 -0700 (PDT)
Message-ID: <6e3ae6310805060938i29e583f5u8defc6425d64f313@mail.gmail.com>
Date: Tue, 6 May 2008 09:38:56 -0700
From: "Chris Lu" <chris.lu@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to make a query that associates 2 index files
In-Reply-To: <BAY128-DAV48197750816BF4C0A00ACBED60@phx.gbl>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_23066_5914871.1210091936218"
References: <BAY128-DAV48197750816BF4C0A00ACBED60@phx.gbl>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_23066_5914871.1210091936218
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

No easy way unless you merge your 2 indexes into:

Index:      [who]    [accessed]   [key]          [content]


            David    1/1/2007     Abc            "blah blah 123 ..."

            Someone  1/2/2005     Abc            "blah blah 123 ..."

            Guess    12/1/2000    Xyz            "123 321 a nice day ..."

            Harry    1/1/2008     Abc            "blah blah 123 ..."

            Sandra   1/1/2003     Xyz            "123 321 a nice day ..."


Anyway, Lucene index is more like Database Index. It's only efficient for
particular query execution paths.
If you have special requirements, you will have to re-structure your index
for performance.

-- 
Chris Lu
-------------------------
Instant Scalable Full-Text Search On Any Database/Application
site: http://www.dbsight.net
demo: http://search.dbsight.com
Lucene Database Search in 3 minutes:
http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
DBSight customer, a shopping comparison site, (anonymous per request) got
2.6 Million Euro funding!

On Tue, May 6, 2008 at 9:14 AM, Michael Siu <michaelysiu@hotmail.com> wrote:

> Hi,
>
>
>
> I am a newbie to Lucene. I have a question for making a query that
> associate
> 2 index files:
>
>
>
> - One index has the content index for a list of documents and a key to the
> document. That means the Lucene document of this index contains 2 fields:
>
> the 'content' and the 'key'.
>
> - another index has the some data indexed associated with the 'key' in the
> previous index. The Lucene document of this index contains several fields:
>
> the 'who' that contains some data and the 'key' that _points_ to the
> document in the first index.
>
>
>
> Sample data:
>
> Index_1:   [key] [content]
>
>            Abc   "blah blah 123 ..."
>
>            Xyz   "123 321 a nice day ..."
>
>
>
> Index_2:   [who]    [accessed]   [key]
>
>            David    1/1/2007     Abc
>
>            Someone  1/2/2005     Abc
>
>            Guess    12/1/2000    Xyz
>
>            Harry    1/1/2008     Abc
>
>            Sandra   1/1/2003     Xyz
>
>
>
> As shown, the [key] field in Index_2 has repeated value that _points_ to
> the
> [key] values in Index_1. How do I make a query for the following:
>
>
>
> Find out all documents in Index_2:
>
> - [who] is in range of 'David' to 'Guess' and
>
> - [accessed] in range '1/1/1900' to '1/1/2010' and
>
> - [key] associated [content] in Index_1 that contains the term 'blah'
>
>
>
> I know this is more SQL like query. Is Lucene capable of doing this type
> of
> query that needs associations among index files?
>
>
>
> Thanks in advance.
>
>
>
> - m
>
>
>
>
>
>
>
>

------=_Part_23066_5914871.1210091936218--

From java-user-return-33941-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:40:27 2008
Return-Path: <java-user-return-33941-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85273 invoked from network); 6 May 2008 16:40:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:40:27 -0000
Received: (qmail 14204 invoked by uid 500); 6 May 2008 16:40:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14175 invoked by uid 500); 6 May 2008 16:40:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14164 invoked by uid 99); 6 May 2008 16:40:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:40:21 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.128.189 as permitted sender)
Received: from [209.85.128.189] (HELO fk-out-0910.google.com) (209.85.128.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:39:28 +0000
Received: by fk-out-0910.google.com with SMTP id 18so2428fkq.5
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 09:39:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=cqVUZObbch/J7IhVryZ5Mc6QwtK0Qmu8dkYqOoFwGqY=;
        b=wJFhC2KDr/ojyWiERKzZ9Iu2w61CIGLdfdOPakafWhZhPBglDmtBIKiRygNPC05fHlFfLIVlTTFH8ykFTTP+VlA41s+WCTQ5yrtcK3O7Ht5IkVV1rkVgapZ5Eku8pQU9dJTlONi1vC6BAyZRmJu30QHG69c4/xrIpQYfZSQc4qI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=MzdvMyNUYcmliq5XNqUMfHNTQVGKmSMyAmxGziPoLC3Zdl41ySSi4CqaVV5DQlpAWyVAJug2w2I/6HnQCHmllGrSeJqxEgCFIxHgKfaZWLPduLJM4nWD58i3nw9spifhTe9c9qE/Y02h+QCnn6xk/SR6mock+MeFX3Vfp//xML8=
Received: by 10.82.107.15 with SMTP id f15mr88184buc.30.1210091990004;
        Tue, 06 May 2008 09:39:50 -0700 (PDT)
Received: by 10.82.191.6 with HTTP; Tue, 6 May 2008 09:39:49 -0700 (PDT)
Message-ID: <359a92830805060939g22b9cfa5oa87be38afe17db2a@mail.gmail.com>
Date: Tue, 6 May 2008 12:39:49 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Postcode/zipcode search
In-Reply-To: <11e852b50805060928t1039a523o3a20c20681592c54@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_19578_22043099.1210091989973"
References: <11e852b50805060928t1039a523o3a20c20681592c54@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_19578_22043099.1210091989973
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Have you looked at PrefixQuery? If that doesn't work for you, could you give
a few
more examples of expected inputs and outputs?

Best
Erick

On Tue, May 6, 2008 at 12:28 PM, Chris Mannion <chris.mannion@nonstopgov.com>
wrote:

> Hi all
>
> I've got a bit of a niggling problem with how one of my searches is
> working
> as opposed to how my users would like it too work.  We're indexing on UK
> postcodes, which are in the format of a 3 or 4 character area code
> followed
> by a 3 or 4 character street specific code, e.g. "NW10 7NY" or "M11 1LQ".
> We originally had the values being indexed as tokenized and used a very
> simple search string in the format "postcode:xxx xxx", with no grouping or
> boosting or fuzzy searching, just an straight search on whatever the user
> answered.  This had the benefit of finding exact matches to searches and
> allowing us to search just on the area part of the code to return all
> records with that area code, eg a search on "NW2" returning anything
> starting NW2, like "NW2 6TB", "NW2 1ER" etc etc.
>
> However, the downside to that was that searches could also return records
> only tenuously related to what was searched for, eg. a search for "NW10
> 7NY"
> would also return a record with a postcode "SE9 6NY" because of the slight
> match of the "NY".  Obviously this was technically correct but users
> complained because their searches were returning records from completely
> different areas.  Our first step to put this right was to take off the
> tokenization of the field, which we also weren't happy with so have
> continued to fiddle.
>
> The current status is as follows - we index the values by stripping out
> spaces and tokeniing them and use a keywordAnalyzer.  In searching we also
> strip spaces from the search term entered and search with a
> keywordAnalyzer.  Searches for full postcodes, e.g. "NW10 7NY" find all
> exact matches but also any full values that are partial matches (e.g. some
> records just have "NW10" as their postcode field and the "NW10 7NY" search
> pulls them back too), but searches for partial postcodes e.g. "NW10" still
> only finds exact matches, e.g. it only pulls back those record that have
> just "NW10" as their postcode, rather than anything *starting* with NW10
> as
> we'd like it to do.
>
> Can anyone help me get this working in the way we need it too please?
>
> --
> Chris Mannion
> iCasework and LocalAlert implementation team
> 0208 144 4416
>

------=_Part_19578_22043099.1210091989973--

From java-user-return-33942-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:41:43 2008
Return-Path: <java-user-return-33942-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85735 invoked from network); 6 May 2008 16:41:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:41:43 -0000
Received: (qmail 20761 invoked by uid 500); 6 May 2008 16:41:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20736 invoked by uid 500); 6 May 2008 16:41:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20725 invoked by uid 99); 6 May 2008 16:41:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:41:36 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.128.188 as permitted sender)
Received: from [209.85.128.188] (HELO fk-out-0910.google.com) (209.85.128.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:40:44 +0000
Received: by fk-out-0910.google.com with SMTP id 18so2865fkq.5
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 09:41:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=fHsfx6wh5DVv/E5A+dWVE+GvxC8vLUsyQdB6g8EqzfA=;
        b=rlCPgnvSo6TPuO6TK66h48gB5eWf6Oq18VL/Y77IWT+grQfiSXGL4wzawLu2tU4HDJgjOCScfr94izYGawd+CIGv2bSjPG9sL9aUMAoU91kzKYR4bdbR3GyuxYxOJflK9EjNJU6SoLA366tyo7H+TeFaDAuXgq+ibdwraaar/qw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=hIRHnSG0g2GaUxzZ5lFKEFGD/WvRZ/vW0fBX9wOqCyUkkjQ/QL3+2+YKTL1btDrc7K6RXTRnSbZpnmP2q56V8UQUEEfjJTIHhJveqlqtxHWTi2CGUeq4FTWfVdFlNWaeFs4VXPM+MlHd9/z8DW0rOXBebujRBzaFVZHQH+skFd0=
Received: by 10.82.157.6 with SMTP id f6mr98123bue.28.1210092065772;
        Tue, 06 May 2008 09:41:05 -0700 (PDT)
Received: by 10.82.191.6 with HTTP; Tue, 6 May 2008 09:41:05 -0700 (PDT)
Message-ID: <359a92830805060941w16cbedc0ve8fd23b6137e1af5@mail.gmail.com>
Date: Tue, 6 May 2008 12:41:05 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Multiple Field search
In-Reply-To: <98ba5e100805060937s472dc538u77a63584dc165866@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_19587_26404479.1210092065772"
References: <98ba5e100805060907q48473c11q6a37262e2c8e2992@mail.gmail.com>
	 <359a92830805060932p22a19352t7e526bb4745ca277@mail.gmail.com>
	 <98ba5e100805060937s472dc538u77a63584dc165866@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_19587_26404479.1210092065772
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Well, it's the one I'd use. Whether it's the best or not is...er...not so
certain <G>.

Erick

On Tue, May 6, 2008 at 12:37 PM, Kelvin Foo Chuan Lyi <vmirage@gmail.com>
wrote:

> Thanks... that's what I thought of ... but was wondering if that was the
> best method to do so... i guess it is then... :)
>
>
>
>
> On Wed, May 7, 2008 at 12:32 AM, Erick Erickson <erickerickson@gmail.com>
> wrote:
>
> > One of my favorite quotes from Roger Zelazny... "postulating
> > infinity, the rest is easy".
> >
> > In this case, "infinity" is how you break up your query. The easy part
> is
> > making your search return what you want.
> >
> > Assuming you know that you want "greatest" and
> > "hits" to go against the title field and "beatles" to
> > go against description, your query looks something
> > like:
> >
> > +title:greatest +title:hits +description:beatles
> >
> > But knowing you want to break up the query like that is the hard part.
> >
> > Sometimes you can make it work well enough by submitting all
> > terms against both fields with an OR clause, something like:
> >
> > title:(+greatest +hits +beatles) description:(+greatest +hits +beatles)
> > (note, OR is implied between title and description)
> >
> > which would not work in your case. Another technique is to dump
> > all the words into a single uber-field *as well as* your individual
> > fields, so the search
> > uber:(+greatest +hits +beatles) would work for you. Note that if
> > you index (but do NOT store) the uber field and store (but do NOT index)
> > the text and description fields, your index stays about the same
> size.....
> >
> > Anyway, you need to carefully define how your searches *should* work,
> > then define your index structure IMO.
> >
> > Best
> > Erick
> >
> > On Tue, May 6, 2008 at 12:07 PM, Kelvin Foo Chuan Lyi <vmirage@gmail.com
> >
> > wrote:
> >
> > > I'm new to lucene and have a question on how to create a query for the
> > > following example... Say I have two fields, Title and Description,
> with
> > > the
> > > following data
> > >
> > > Item 1
> > > Title: The greatest hits
> > > Description : Collection of the best music from The Beatles.
> > >
> > > Item 2
> > > Title: U2 collections
> > > Description : Greatest hits collection of U2
> > >
> > >
> > > In my search, I want to search for 'greatest hits beatles'. The result
> > > should return only Item 1..  how should the query looks like??
> > >
> > >
> > > Thanks.
> > >
> > >
> > >
> > >
> > > --
> > > Sayonara,
> > > Kelvin
> > >
> >
>
>
>
> --
> Sayonara,
> Kelvin
>

------=_Part_19587_26404479.1210092065772--

From java-user-return-33943-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:54:20 2008
Return-Path: <java-user-return-33943-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88941 invoked from network); 6 May 2008 16:54:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:54:20 -0000
Received: (qmail 33160 invoked by uid 500); 6 May 2008 16:54:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33125 invoked by uid 500); 6 May 2008 16:54:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33114 invoked by uid 99); 6 May 2008 16:54:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:54:14 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of willjohnsonsearch@gmail.com designates 66.249.82.230 as permitted sender)
Received: from [66.249.82.230] (HELO wx-out-0506.google.com) (66.249.82.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:53:28 +0000
Received: by wx-out-0506.google.com with SMTP id h29so571621wxd.20
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 09:53:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:to:references:in-reply-to:subject:date:message-id:mime-version:content-type:content-transfer-encoding:x-mailer:thread-index:content-language:from;
        bh=Y3zN6oL6mJOzgirgHc0bKgbiC+cJkUkYI9kSRMw+Ht8=;
        b=SPFPKbeiC9tbUBgKFUhfcEaEg7p5w/aXoJrq2cY5qjc1VtWW0K3BjWhVnGvhPKO2qCb5J7fIMgDXUYpUU3o5wTqvniyiYlRWie7MyKEIgYuSMS5CyB8mhg3cpvwAe30Okd0F0tp5kzXA9qzgjevZ2LbrIT+Hnn1BYAqtK66itXs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=to:references:in-reply-to:subject:date:message-id:mime-version:content-type:content-transfer-encoding:x-mailer:thread-index:content-language:from;
        b=cfb9SpLiM6UJvNObc8no5KuuBqSTOVcUEI1yaef1W25fMRAYtcn/eGk0QwssW7WE8/tmwa53kc8pbmE5+ZRCVS1kMUJqFcOS68cSF/wtmMBHGlE3iDRNdxIoxd4aLOK0iUcjeTU9+/TDy1MAaLfMTZt7K6BpT8djLyQRixSKktE=
Received: by 10.90.103.3 with SMTP id a3mr1421974agc.46.1210092821681;
        Tue, 06 May 2008 09:53:41 -0700 (PDT)
Received: from will ( [209.104.232.98])
        by mx.google.com with ESMTPS id 6sm998281agd.31.2008.05.06.09.53.40
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 06 May 2008 09:53:40 -0700 (PDT)
To: <java-user@lucene.apache.org>
References: <11e852b50805060928t1039a523o3a20c20681592c54@mail.gmail.com>
In-Reply-To: <11e852b50805060928t1039a523o3a20c20681592c54@mail.gmail.com>
Subject: RE: Postcode/zipcode search
Date: Tue, 6 May 2008 12:53:38 -0400
Message-ID: <005701c8af99$bc7aa330$356fe990$@com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcivlkuyKTfMC1hdRJSmOZiZl+LzVQAAkD+w
Content-Language: en-us
From: Will Johnson <willjohnsonsearch@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

You could split up the field into 2 separate fields:

Postcode:NW10 7NY -> post1:NW10 post2:7NY

Then rewrite user's queries using the same logic:  ie if the enter 1 term
'NW10' it gets rewritten to post1:NW10, if they enter 2 terms post1:NW10 AND
post2:7NY.

It also lets you do fuzzy search ie post1:NW10 post2:7?Y and so on.

- will

-----Original Message-----
From: Chris Mannion [mailto:chris.mannion@nonstopgov.com] 
Sent: Tuesday, May 06, 2008 12:28 PM
To: java-user@lucene.apache.org
Subject: Postcode/zipcode search

Hi all

I've got a bit of a niggling problem with how one of my searches is working
as opposed to how my users would like it too work.  We're indexing on UK
postcodes, which are in the format of a 3 or 4 character area code followed
by a 3 or 4 character street specific code, e.g. "NW10 7NY" or "M11 1LQ".
We originally had the values being indexed as tokenized and used a very
simple search string in the format "postcode:xxx xxx", with no grouping or
boosting or fuzzy searching, just an straight search on whatever the user
answered.  This had the benefit of finding exact matches to searches and
allowing us to search just on the area part of the code to return all
records with that area code, eg a search on "NW2" returning anything
starting NW2, like "NW2 6TB", "NW2 1ER" etc etc.

However, the downside to that was that searches could also return records
only tenuously related to what was searched for, eg. a search for "NW10 7NY"
would also return a record with a postcode "SE9 6NY" because of the slight
match of the "NY".  Obviously this was technically correct but users
complained because their searches were returning records from completely
different areas.  Our first step to put this right was to take off the
tokenization of the field, which we also weren't happy with so have
continued to fiddle.

The current status is as follows - we index the values by stripping out
spaces and tokeniing them and use a keywordAnalyzer.  In searching we also
strip spaces from the search term entered and search with a
keywordAnalyzer.  Searches for full postcodes, e.g. "NW10 7NY" find all
exact matches but also any full values that are partial matches (e.g. some
records just have "NW10" as their postcode field and the "NW10 7NY" search
pulls them back too), but searches for partial postcodes e.g. "NW10" still
only finds exact matches, e.g. it only pulls back those record that have
just "NW10" as their postcode, rather than anything *starting* with NW10 as
we'd like it to do.

Can anyone help me get this working in the way we need it too please?

-- 
Chris Mannion
iCasework and LocalAlert implementation team
0208 144 4416


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33944-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 16:55:34 2008
Return-Path: <java-user-return-33944-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89579 invoked from network); 6 May 2008 16:55:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 16:55:33 -0000
Received: (qmail 36414 invoked by uid 500); 6 May 2008 16:55:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36361 invoked by uid 500); 6 May 2008 16:55:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36336 invoked by uid 99); 6 May 2008 16:55:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 09:55:25 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aweber@comcast.net designates 76.96.30.24 as permitted sender)
Received: from [76.96.30.24] (HELO QMTA02.emeryville.ca.mail.comcast.net) (76.96.30.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 16:54:37 +0000
Received: from OMTA04.emeryville.ca.mail.comcast.net ([76.96.30.35])
	by QMTA02.emeryville.ca.mail.comcast.net with comcast
	id NFf71Z04H0lTkoCA202P00; Tue, 06 May 2008 16:52:48 +0000
Received: from silvercreek ([71.187.44.111])
	by OMTA04.emeryville.ca.mail.comcast.net with comcast
	id NGuf1Z0012PvBoP8Q00000; Tue, 06 May 2008 16:54:46 +0000
X-Authority-Analysis: v=1.0 c=1 a=rITDv7nW5hcA:10 a=d8Lf7conRKPqM1Ko7GcA:9
 a=oxhl_13P5jVW8_3NLPgA:7 a=PdRjTEQO0fOAZvK0mKRTjxYtO2gA:4 a=vNGxQsTWjH8A:10
 a=TPu5JSuM4MHVQhFGd7EA:9 a=oiEAaxwSFauuP6ZBvC4A:7
 a=ucIodlmlYYI4Bs9-HB31tOcZ21UA:4 a=6sawnC8HQy4A:10 a=AfD3MYMu9mQA:10
Message-ID: <002601c8af99$e0cc4680$d101a8c0@webtekllc.com>
Reply-To: "AJ Weber" <aweber@comcast.net>
From: "AJ Weber" <aweber@comcast.net>
To: <java-user@lucene.apache.org>
References: <11e852b50805060928t1039a523o3a20c20681592c54@mail.gmail.com>
Subject: Re: Postcode/zipcode search
Date: Tue, 6 May 2008 12:54:34 -0400
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0023_01C8AF78.55613770"
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_0023_01C8AF78.55613770
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Maybe I'm oversimplifying it, and maybe this isn't what you desire, =
but...

What about breaking the postcode into two (or three) different fields?  =
Seems easy to parse on the ingestion-side, as you just break the string =
at the "middle" space.  Then store "postal_area", "postal_street", and =
optionally the original, full "postalcode".  (Probably do not need to =
tokenize the first two, maybe the last one.)

Then, and here's where you may throw this idea out entirely, it depends =
on how your searching application/page is setup.  You'd need to apply =
the values entered by the user appropriately.  If they enter 2-3chars =
with no spaces, search on the "postal_area" field.  If they enter > 4 =
chars (including a space), you could, again, split the string at the =
space and search on the two individual fields.

If you kept the original, full "postalcode" field, you could always put =
a link on the search results (or maybe only if zero results are =
returned) saying, "Didn't find what you're looking for?  Click here to =
broaden your search!"  -- And in that case send the whole query-string =
against the postalcode field.

Dunno.  Just an idea.  Good Luck!

-AJ

  ----- Original Message -----=20
  From: Chris Mannion=20
  To: java-user@lucene.apache.org=20
  Sent: Tuesday, May 06, 2008 12:28 PM
  Subject: Postcode/zipcode search


  Hi all

  I've got a bit of a niggling problem with how one of my searches is =
working
  as opposed to how my users would like it too work.  We're indexing on =
UK
  postcodes, which are in the format of a 3 or 4 character area code =
followed
  by a 3 or 4 character street specific code, e.g. "NW10 7NY" or "M11 =
1LQ".
  We originally had the values being indexed as tokenized and used a =
very
  simple search string in the format "postcode:xxx xxx", with no =
grouping or
  boosting or fuzzy searching, just an straight search on whatever the =
user
  answered.  This had the benefit of finding exact matches to searches =
and
  allowing us to search just on the area part of the code to return all
  records with that area code, eg a search on "NW2" returning anything
  starting NW2, like "NW2 6TB", "NW2 1ER" etc etc.

  However, the downside to that was that searches could also return =
records
  only tenuously related to what was searched for, eg. a search for =
"NW10 7NY"
  would also return a record with a postcode "SE9 6NY" because of the =
slight
  match of the "NY".  Obviously this was technically correct but users
  complained because their searches were returning records from =
completely
  different areas.  Our first step to put this right was to take off the
  tokenization of the field, which we also weren't happy with so have
  continued to fiddle.

  The current status is as follows - we index the values by stripping =
out
  spaces and tokeniing them and use a keywordAnalyzer.  In searching we =
also
  strip spaces from the search term entered and search with a
  keywordAnalyzer.  Searches for full postcodes, e.g. "NW10 7NY" find =
all
  exact matches but also any full values that are partial matches (e.g. =
some
  records just have "NW10" as their postcode field and the "NW10 7NY" =
search
  pulls them back too), but searches for partial postcodes e.g. "NW10" =
still
  only finds exact matches, e.g. it only pulls back those record that =
have
  just "NW10" as their postcode, rather than anything *starting* with =
NW10 as
  we'd like it to do.

  Can anyone help me get this working in the way we need it too please?

  --=20
  Chris Mannion
  iCasework and LocalAlert implementation team
  0208 144 4416

------=_NextPart_000_0023_01C8AF78.55613770--


From java-user-return-33945-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 17:20:38 2008
Return-Path: <java-user-return-33945-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 482 invoked from network); 6 May 2008 17:20:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 17:20:37 -0000
Received: (qmail 68967 invoked by uid 500); 6 May 2008 17:20:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68930 invoked by uid 500); 6 May 2008 17:20:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68919 invoked by uid 99); 6 May 2008 17:20:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 10:20:31 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.219] (HELO web26008.mail.ukl.yahoo.com) (217.12.10.219)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 06 May 2008 17:19:37 +0000
Received: (qmail 55977 invoked by uid 60001); 6 May 2008 17:19:58 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=fKvpEzLBzZX8VhT55gxiojdUqCj491ROqt8bCg8EkURPaLd5s2uxo6jHf5FND9+P2A73SPP5pBrY5cb6WlA6gCyk0ADXNNdqlwwAcMM88QDB8JSzC7O8NGGXnJNyH7N3531cB/DRvf8bYaJJ4RBg/OslehxwYdJ4yI6S5iJXDaA=;
Received: from [193.36.230.96] by web26008.mail.ukl.yahoo.com via HTTP; Tue, 06 May 2008 17:19:58 GMT
X-Mailer: YahooMailRC/902.40 YahooMailWebService/0.7.185
Date: Tue, 6 May 2008 17:19:58 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: Postcode/zipcode search
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Message-ID: <463477.55913.qm@web26008.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Can you not convert all postcodes to coordinates and do actual distance-bas=
ed matching?=0A=0AYou will have to pay Royal Mail or 3rd party suppliers to=
 get hold of the PAF data required for this geocoding (despite having funde=
d this already as a UK tax payer- grrrr)=0A=0ACheers=0AMark=0A=0A----- Orig=
inal Message ----=0AFrom: Chris Mannion <chris.mannion@nonstopgov.com>=0ATo=
: java-user@lucene.apache.org=0ASent: Tuesday, 6 May, 2008 5:28:25 PM=0ASub=
ject: Postcode/zipcode search=0A=0AHi all=0A=0AI've got a bit of a niggling=
 problem with how one of my searches is working=0Aas opposed to how my user=
s would like it too work.  We're indexing on UK=0Apostcodes, which are in t=
he format of a 3 or 4 character area code followed=0Aby a 3 or 4 character =
street specific code, e.g. "NW10 7NY" or "M11 1LQ".=0AWe originally had the=
 values being indexed as tokenized and used a very=0Asimple search string i=
n the format "postcode:xxx xxx", with no grouping or=0Aboosting or fuzzy se=
arching, just an straight search on whatever the user=0Aanswered.  This had=
 the benefit of finding exact matches to searches and=0Aallowing us to sear=
ch just on the area part of the code to return all=0Arecords with that area=
 code, eg a search on "NW2" returning anything=0Astarting NW2, like "NW2 6T=
B", "NW2 1ER" etc etc.=0A=0AHowever, the downside to that was that searches=
 could also return records=0Aonly tenuously related to what was searched fo=
r, eg. a search for "NW10 7NY"=0Awould also return a record with a postcode=
 "SE9 6NY" because of the slight=0Amatch of the "NY".  Obviously this was t=
echnically correct but users=0Acomplained because their searches were retur=
ning records from completely=0Adifferent areas.  Our first step to put this=
 right was to take off the=0Atokenization of the field, which we also weren=
't happy with so have=0Acontinued to fiddle.=0A=0AThe current status is as =
follows - we index the values by stripping out=0Aspaces and tokeniing them =
and use a keywordAnalyzer.  In searching we also=0Astrip spaces from the se=
arch term entered and search with a=0AkeywordAnalyzer.  Searches for full p=
ostcodes, e.g. "NW10 7NY" find all=0Aexact matches but also any full values=
 that are partial matches (e.g. some=0Arecords just have "NW10" as their po=
stcode field and the "NW10 7NY" search=0Apulls them back too), but searches=
 for partial postcodes e.g. "NW10" still=0Aonly finds exact matches, e.g. i=
t only pulls back those record that have=0Ajust "NW10" as their postcode, r=
ather than anything *starting* with NW10 as=0Awe'd like it to do.=0A=0ACan =
anyone help me get this working in the way we need it too please?=0A=0A-- =
=0AChris Mannion=0AiCasework and LocalAlert implementation team=0A0208 144 =
4416=0A=0A=0A=0A=0A=0A      _______________________________________________=
___________=0ASent from Yahoo! Mail.=0AA Smarter Email http://uk.docs.yahoo=
.com/nowyoucan.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33946-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 18:03:57 2008
Return-Path: <java-user-return-33946-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18193 invoked from network); 6 May 2008 18:03:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 18:03:57 -0000
Received: (qmail 24315 invoked by uid 500); 6 May 2008 18:03:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24278 invoked by uid 500); 6 May 2008 18:03:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24267 invoked by uid 99); 6 May 2008 18:03:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 11:03:50 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of crspan@gmail.com designates 66.249.82.226 as permitted sender)
Received: from [66.249.82.226] (HELO wx-out-0506.google.com) (66.249.82.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 18:03:04 +0000
Received: by wx-out-0506.google.com with SMTP id h29so598635wxd.20
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 11:03:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=Vdb1GERN/EJ+LihdKo9PsJpii4KGn2UqikRMmkefAhQ=;
        b=IbtcFmFZEWopJgRRCkDmKWFokYE8Fspcmnal7SGODRzyooczT4jpXwHYFDJMWt6uExa3kXuAm9io2U8PXan0dJn8GQ3XQJVKTwoi45zS7riZbI3anFBJTTdOZDtKg4p55olgdkDuEhmjnqhh+aZRhD6muhdxaH6lFcrDSo+Hhdw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=Zt/cklnUMXLSgnKE2AobGWldKkxrV3CCuV/+LDtu2j0qgbE/vhrdclNuEC6eWoKJvBpKwtbrsOzIqD2EF5Go7pEHh3dfjgs+I/+ygWSgICOk+hVoSH5BOaeKTM2HtmBgvUhSRbiub7x8FmKiakBLfiDTFnv2rJjqsSiiEEAdTn4=
Received: by 10.90.69.15 with SMTP id r15mr1482785aga.89.1210096997841;
        Tue, 06 May 2008 11:03:17 -0700 (PDT)
Received: from ?192.168.168.3? ( [72.179.149.134])
        by mx.google.com with ESMTPS id o27sm2066489ele.8.2008.05.06.11.03.16
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 06 May 2008 11:03:16 -0700 (PDT)
Message-ID: <48209D62.2000103@gmail.com>
Date: Tue, 06 May 2008 13:03:14 -0500
From: crspan <crspan@gmail.com>
User-Agent: Thunderbird 2.0.0.12 (Windows/20080213)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Are those runtime errors about the jdk, or lucene's jar, or my code?
X-Virus-Checked: Checked by ClamAV on apache.org
 
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit



-- OS: Linux lg99 2.6.5-7.276-smp #1 SMP Fri Sep 28 20:33:22 AKDT 2007 
x86_64 x86_64 x86_64 GNU/Linux

-- Lucene:  2.3.2  (tried 2.2.0 as well, since the index was built 
around 2.2.0, jdk1.6.0_01 )

-- JDK:  Sun jdk1.6.0_06 ( from jdk-6u6-linux-x64.bin ) &  Sun 
jdk1.5.0_15 ( from jdk-1_5_0_15-linux-amd64.bin)
( both installed locally in the user's home directory WITHOUT root 
privilege.)

-- Souce code:

System.out.print("\n\n Range = "+range+"\nQuery = "+q.toString()+"\n") ;
tds = is.search( q, (Filter)null, range );

-- Stack traces (1):

 Range = 500
Query = TEXT:illeg^30.820824 TEXT:technolog^22.290413 
TEXT:transfer^33.307804 TEXT:bipartisan^20.942562 
TEXT:laboratori^18.500801 TEXT:norm^21.193087 
TEXT:counterintellig^29.724474 TEXT:spi^19.285275 TEXT:lab^20.497044 
TEXT:american^11.090684 TEXT:question^11.929131 TEXT:review^14.588552 
TEXT:obtain^17.56319 TEXT:commun^12.5947275 TEXT:nation^10.737445 
TEXT:offici^11.375352 TEXT:rep^17.646774 TEXT:contribut^15.35846 
TEXT:report^11.633566 TEXT:congress^14.976282 TEXT:justic^16.433678 
TEXT:govern^12.003913 TEXT:declassifi^31.553194 TEXT:campaign^14.959521 
TEXT:inform^14.187338 TEXT:compani^13.717714 TEXT:classifi^23.613848 
TEXT:washington^13.995003 TEXT:hugh^23.138725 TEXT:issu^14.177698 
TEXT:space^18.239595 TEXT:1996^16.198292 TEXT:rocket^21.983511 
TEXT:administr^17.11987 TEXT:satellit^21.777317 TEXT:nuclear^20.927034 
TEXT:republican^18.929497 TEXT:committe^18.195517 
TEXT:intellig^21.868582 TEXT:hous^17.309698 TEXT:democrat^18.528954 
TEXT:investig^19.492653 TEXT:panel^22.208527 TEXT:senat^20.456139 
TEXT:chines^19.726551 TEXT:sensit^23.52441 TEXT:secur^20.280426 
TEXT:depart^21.874023 TEXT:missil^25.32581 TEXT:illeg^27.417799 
TEXT:loral^41.9551 TEXT:transfer^33.933247


QueryString:
illeg^30.820824 technolog^22.290413 transfer^33.307804
Error: java.lang.ArrayIndexOutOfBoundsException: 
132704java.lang.ArrayIndexOutOfBoundsException: 132704
        at 
org.apache.lucene.search.BooleanScorer2$Coordinator.coordFactor(BooleanScorer2.java:55)
        at 
org.apache.lucene.search.BooleanScorer2.score(BooleanScorer2.java:358)
        at 
org.apache.lucene.search.BooleanScorer2.score(BooleanScorer2.java:320)
        at 
org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:146)
        at 
org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:113)
        at org.apache.lucene.search.Searcher.search(Searcher.java:132)
        at 
org.cr.search.TrecQueryRelevanceFeedback.main(TrecQueryRelevanceFeedback.java:785)





-- Souce code:

              TermFreqVector[] termsV = reader.getTermFreqVectors(docID);

-- Stack traces (2):

 Range = 500
Query = TEXT:oceanograph^68.48028 TEXT:vessel^43.191563


QueryString:
oceanograph^68.48028 vessel^43.191563
Error: 
java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBoundsException
        at 
org.apache.lucene.index.TermVectorsReader.readTermVector(TermVectorsReader.java:353)
        at 
org.apache.lucene.index.TermVectorsReader.readTermVectors(TermVectorsReader.java:287)
        at 
org.apache.lucene.index.TermVectorsReader.get(TermVectorsReader.java:232)
        at 
org.apache.lucene.index.SegmentReader.getTermFreqVectors(SegmentReader.java:981)
        at 
org.cr.rf.RelevanceFeedback.RelFeedbackWeight(RelevanceFeedback.java:145)
        at 
org.cr.search.TrecQueryRelevanceFeedback.main(TrecQueryRelevanceFeedback.java:789)



--  Other Info:

* This index can be searched in other programs in the same environment.
* The same program runs just fine in Window (1.6.0-b105 & 1.5.0_03-b07), 
and a HP-UX (1.5.0.05) without those runtime errors.



-- My questions:



---------? What is your reading of those two stack traces?


---------? Where

QueryString:
illeg^30.820824 technolog^22.290413 transfer^33.307804

got printed? It is NOT from my code, so is it part of Lucene's error 
message? Which line in Lucene is for this print out?


---------?? As you can see, from the line

System.out.print("\n\n Range = "+range+"\nQuery = "+q.toString()+"\n") ;

it just printed the 50 terms in the query:

 Range = 500
Query = TEXT:illeg^30.820824 TEXT:technolog^22.290413 
TEXT:transfer^33.307804 TEXT:bipartisan^20.942562 
TEXT:laboratori^18.500801 TEXT:norm^21.193087 
TEXT:counterintellig^29.724474 TEXT:spi^19.285275 TEXT:lab^20.497044 
TEXT:american^11.090684 TEXT:question^11.929131 TEXT:review^14.588552 
TEXT:obtain^17.56319 TEXT:commun^12.5947275 TEXT:nation^10.737445 
TEXT:offici^11.375352 TEXT:rep^17.646774 TEXT:contribut^15.35846 
TEXT:report^11.633566 TEXT:congress^14.976282 TEXT:justic^16.433678 
TEXT:govern^12.003913 TEXT:declassifi^31.553194 TEXT:campaign^14.959521 
TEXT:inform^14.187338 TEXT:compani^13.717714 TEXT:classifi^23.613848 
TEXT:washington^13.995003 TEXT:hugh^23.138725 TEXT:issu^14.177698 
TEXT:space^18.239595 TEXT:1996^16.198292 TEXT:rocket^21.983511 
TEXT:administr^17.11987 TEXT:satellit^21.777317 TEXT:nuclear^20.927034 
TEXT:republican^18.929497 TEXT:committe^18.195517 
TEXT:intellig^21.868582 TEXT:hous^17.309698 TEXT:democrat^18.528954 
TEXT:investig^19.492653 TEXT:panel^22.208527 TEXT:senat^20.456139 
TEXT:chines^19.726551 TEXT:sensit^23.52441 TEXT:secur^20.280426 
TEXT:depart^21.874023 TEXT:missil^25.32581 TEXT:illeg^27.417799 
TEXT:loral^41.9551 TEXT:transfer^33.933247

But how comes it became:

QueryString:
illeg^30.820824 technolog^22.290413 transfer^33.307804


---------? Overall, is this related to the JDK installation? wrong bin 
file? without root? etc? Any advice to fix the problem?




Thanks in advance for your valuable time and reply.

Charlie





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33947-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 18:54:14 2008
Return-Path: <java-user-return-33947-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55674 invoked from network); 6 May 2008 18:54:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 18:54:14 -0000
Received: (qmail 85116 invoked by uid 500); 6 May 2008 18:54:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85090 invoked by uid 500); 6 May 2008 18:54:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85079 invoked by uid 99); 6 May 2008 18:54:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 11:54:07 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.14.246.251] (HELO ag-out-0708.google.com) (72.14.246.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 18:53:21 +0000
Received: by ag-out-0708.google.com with SMTP id 23so1803549agd.11
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 11:53:34 -0700 (PDT)
Received: by 10.90.65.5 with SMTP id n5mr1553358aga.75.1210100014128;
        Tue, 06 May 2008 11:53:34 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id o61sm1052296hsc.17.2008.05.06.11.53.33
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 06 May 2008 11:53:33 -0700 (PDT)
In-Reply-To: <48209D62.2000103@gmail.com>
References: <48209D62.2000103@gmail.com>
Mime-Version: 1.0 (Apple Message framework v753)
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <D0DBD255-D484-481B-88E1-A4D8BF5BE038@mikemccandless.com>
Cc: crspan@gmail.com
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: Are those runtime errors about the jdk, or lucene's jar, or my code?
Date: Tue, 6 May 2008 14:54:21 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

Could you run org.apache.lucene.index.CheckIndex on your index and  
post the result?

Are these exceptions easily reproduced starting from scratch (new  
index)?

More responses/questions below:

crspan wrote:
>
>
> -- OS: Linux lg99 2.6.5-7.276-smp #1 SMP Fri Sep 28 20:33:22 AKDT  
> 2007 x86_64 x86_64 x86_64 GNU/Linux
>
> -- Lucene:  2.3.2  (tried 2.2.0 as well, since the index was built  
> around 2.2.0, jdk1.6.0_01 )

Do you see these same exceptions when you run on Lucene 2.2.0?

> -- JDK:  Sun jdk1.6.0_06 ( from jdk-6u6-linux-x64.bin ) &  Sun  
> jdk1.5.0_15 ( from jdk-1_5_0_15-linux-amd64.bin)
> ( both installed locally in the user's home directory WITHOUT root  
> privilege.)
>
> -- Souce code:
>
> System.out.print("\n\n Range = "+range+"\nQuery = "+q.toString() 
> +"\n") ;
> tds = is.search( q, (Filter)null, range );
>
> -- Stack traces (1):
>
> Range = 500
> Query = TEXT:illeg^30.820824 TEXT:technolog^22.290413  
> TEXT:transfer^33.307804 TEXT:bipartisan^20.942562  
> TEXT:laboratori^18.500801 TEXT:norm^21.193087  
> TEXT:counterintellig^29.724474 TEXT:spi^19.285275  
> TEXT:lab^20.497044 TEXT:american^11.090684 TEXT:question^11.929131  
> TEXT:review^14.588552 TEXT:obtain^17.56319 TEXT:commun^12.5947275  
> TEXT:nation^10.737445 TEXT:offici^11.375352 TEXT:rep^17.646774  
> TEXT:contribut^15.35846 TEXT:report^11.633566  
> TEXT:congress^14.976282 TEXT:justic^16.433678 TEXT:govern^12.003913  
> TEXT:declassifi^31.553194 TEXT:campaign^14.959521  
> TEXT:inform^14.187338 TEXT:compani^13.717714  
> TEXT:classifi^23.613848 TEXT:washington^13.995003  
> TEXT:hugh^23.138725 TEXT:issu^14.177698 TEXT:space^18.239595 TEXT: 
> 1996^16.198292 TEXT:rocket^21.983511 TEXT:administr^17.11987  
> TEXT:satellit^21.777317 TEXT:nuclear^20.927034  
> TEXT:republican^18.929497 TEXT:committe^18.195517  
> TEXT:intellig^21.868582 TEXT:hous^17.309698 TEXT:democrat^18.528954  
> TEXT:investig^19.492653 TEXT:panel^22.208527 TEXT:senat^20.456139  
> TEXT:chines^19.726551 TEXT:sensit^23.52441 TEXT:secur^20.280426  
> TEXT:depart^21.874023 TEXT:missil^25.32581 TEXT:illeg^27.417799  
> TEXT:loral^41.9551 TEXT:transfer^33.933247
>
>
> QueryString:
> illeg^30.820824 technolog^22.290413 transfer^33.307804
> Error: java.lang.ArrayIndexOutOfBoundsException:  
> 132704java.lang.ArrayIndexOutOfBoundsException: 132704
>        at org.apache.lucene.search.BooleanScorer2 
> $Coordinator.coordFactor(BooleanScorer2.java:55)
>        at org.apache.lucene.search.BooleanScorer2.score 
> (BooleanScorer2.java:358)
>        at org.apache.lucene.search.BooleanScorer2.score 
> (BooleanScorer2.java:320)
>        at org.apache.lucene.search.IndexSearcher.search 
> (IndexSearcher.java:146)
>        at org.apache.lucene.search.IndexSearcher.search 
> (IndexSearcher.java:113)
>        at org.apache.lucene.search.Searcher.search(Searcher.java:132)
>        at org.cr.search.TrecQueryRelevanceFeedback.main 
> (TrecQueryRelevanceFeedback.java:785)

I'm not sure what could cause this one.

> -- Souce code:
>
>              TermFreqVector[] termsV = reader.getTermFreqVectors 
> (docID);
>
> -- Stack traces (2):
>
> Range = 500
> Query = TEXT:oceanograph^68.48028 TEXT:vessel^43.191563
>
>
> QueryString:
> oceanograph^68.48028 vessel^43.191563
> Error:  
> java.lang.ArrayIndexOutOfBoundsExceptionjava.lang.ArrayIndexOutOfBound 
> sException
>        at org.apache.lucene.index.TermVectorsReader.readTermVector 
> (TermVectorsReader.java:353)
>        at org.apache.lucene.index.TermVectorsReader.readTermVectors 
> (TermVectorsReader.java:287)
>        at org.apache.lucene.index.TermVectorsReader.get 
> (TermVectorsReader.java:232)
>        at org.apache.lucene.index.SegmentReader.getTermFreqVectors 
> (SegmentReader.java:981)
>        at org.cr.rf.RelevanceFeedback.RelFeedbackWeight 
> (RelevanceFeedback.java:145)
>        at org.cr.search.TrecQueryRelevanceFeedback.main 
> (TrecQueryRelevanceFeedback.java:789)
>

This looks like index corruption.  If you run CheckIndex it should  
detect this.  Did you hit any previous exceptions when writing to  
this index?  Is it possible to send me a copy of the index?

>
> --  Other Info:
>
> * This index can be searched in other programs in the same  
> environment.
> * The same program runs just fine in Window (1.6.0-b105 & 1.5.0_03- 
> b07), and a HP-UX (1.5.0.05) without those runtime errors.

This is very strange.  These same programs that create the above two  
exceptions, run fine on Windows & HP-UX?  Did you copy the index  
between these machines, or is it the very same index in a shared mount?

> -- My questions:
>
>
>
> ---------? What is your reading of those two stack traces?
>
>
> ---------? Where
>
> QueryString:
> illeg^30.820824 technolog^22.290413 transfer^33.307804
>
> got printed? It is NOT from my code, so is it part of Lucene's  
> error message? Which line in Lucene is for this print out?

I don't know!

>
> ---------?? As you can see, from the line
>
> System.out.print("\n\n Range = "+range+"\nQuery = "+q.toString() 
> +"\n") ;
>
> it just printed the 50 terms in the query:
>
> Range = 500
> Query = TEXT:illeg^30.820824 TEXT:technolog^22.290413  
> TEXT:transfer^33.307804 TEXT:bipartisan^20.942562  
> TEXT:laboratori^18.500801 TEXT:norm^21.193087  
> TEXT:counterintellig^29.724474 TEXT:spi^19.285275  
> TEXT:lab^20.497044 TEXT:american^11.090684 TEXT:question^11.929131  
> TEXT:review^14.588552 TEXT:obtain^17.56319 TEXT:commun^12.5947275  
> TEXT:nation^10.737445 TEXT:offici^11.375352 TEXT:rep^17.646774  
> TEXT:contribut^15.35846 TEXT:report^11.633566  
> TEXT:congress^14.976282 TEXT:justic^16.433678 TEXT:govern^12.003913  
> TEXT:declassifi^31.553194 TEXT:campaign^14.959521  
> TEXT:inform^14.187338 TEXT:compani^13.717714  
> TEXT:classifi^23.613848 TEXT:washington^13.995003  
> TEXT:hugh^23.138725 TEXT:issu^14.177698 TEXT:space^18.239595 TEXT: 
> 1996^16.198292 TEXT:rocket^21.983511 TEXT:administr^17.11987  
> TEXT:satellit^21.777317 TEXT:nuclear^20.927034  
> TEXT:republican^18.929497 TEXT:committe^18.195517  
> TEXT:intellig^21.868582 TEXT:hous^17.309698 TEXT:democrat^18.528954  
> TEXT:investig^19.492653 TEXT:panel^22.208527 TEXT:senat^20.456139  
> TEXT:chines^19.726551 TEXT:sensit^23.52441 TEXT:secur^20.280426  
> TEXT:depart^21.874023 TEXT:missil^25.32581 TEXT:illeg^27.417799  
> TEXT:loral^41.9551 TEXT:transfer^33.933247
>
> But how comes it became:
>
> QueryString:
> illeg^30.820824 technolog^22.290413 transfer^33.307804
>
>
> ---------? Overall, is this related to the JDK installation? wrong  
> bin file? without root? etc? Any advice to fix the problem?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33948-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 19:03:51 2008
Return-Path: <java-user-return-33948-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59357 invoked from network); 6 May 2008 19:03:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 19:03:51 -0000
Received: (qmail 90672 invoked by uid 500); 6 May 2008 19:03:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90631 invoked by uid 500); 6 May 2008 19:03:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90620 invoked by uid 99); 6 May 2008 19:03:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 12:03:45 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of michaelysiu@hotmail.com designates 65.54.246.162 as permitted sender)
Received: from [65.54.246.162] (HELO bay0-omc2-s26.bay0.hotmail.com) (65.54.246.162)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 19:02:49 +0000
Received: from hotmail.com ([65.55.133.20]) by bay0-omc2-s26.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 6 May 2008 12:03:10 -0700
Received: from mail pickup service by hotmail.com with Microsoft SMTPSVC;
	 Tue, 6 May 2008 12:03:10 -0700
Message-ID: <BAY128-DAV1069EA00480B28A058C536BED60@phx.gbl>
Received: from 209.189.193.162 by BAY128-DAV10.phx.gbl with DAV;
	Tue, 06 May 2008 19:03:09 +0000
X-Originating-IP: [209.189.193.162]
X-Originating-Email: [michaelysiu@hotmail.com]
X-Sender: michaelysiu@hotmail.com
From: "Michael Siu" <michaelysiu@hotmail.com>
To: <java-user@lucene.apache.org>
References: <BAY128-DAV48197750816BF4C0A00ACBED60@phx.gbl> <359a92830805060936x1d5f8ecm6eff1b1f67a0c97d@mail.gmail.com>
In-Reply-To: <359a92830805060936x1d5f8ecm6eff1b1f67a0c97d@mail.gmail.com>
Subject: RE: How to make a query that associates 2 index files
Date: Tue, 6 May 2008 12:03:44 -0700
Message-ID: <028b01c8afab$e8010af0$b80320d0$@com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
thread-index: Acivl2PWSbP+ZitlQG+IfdSnjeQ+VAAEwKdA
Content-Language: en-us
X-OriginalArrivalTime: 06 May 2008 19:03:10.0602 (UTC) FILETIME=[D3B286A0:01C8AFAB]
X-Virus-Checked: Checked by ClamAV on apache.org

My problem is: the [content] value can be huge. Duplicating it in more than
one index document waste disk space (and search time?). In additions, when
new documents are added to the second index, it will be faster to just index
the linked [content] once (in first index file) and any subsequent reference
to the same [content] will not need to re-index.

In fact, I do not really need to physically separate the indices into 2
files because Lucene supports Heterogeneous documents in an index file. I
have no idea of how that work in a search. Does anyone know?

Thanks in advance.



-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com] 
Sent: Tuesday, May 06, 2008 9:36 AM
To: java-user@lucene.apache.org
Subject: Re: How to make a query that associates 2 index files

You don't. You really have to roll your own solution here, there's
no "inter-index" awareness that I know of in Lucene.

Typically, people either do a half-half solution (that is, put the
text search in Lucene and leave the DB parts in the DB) or
de-normalize the data in a Lucene index so you don't have
to even try to do things cross-index.

And then there's Marcelo Ochoa (I may have the spelling wrong) who's
put together some way to embed Lucene in an Oracle database, but
that's magic to me.

Why do you want to arrange your index this way in the first place?
Perhaps there's a more specific answer waiting out there...

Best
Erick

On Tue, May 6, 2008 at 12:14 PM, Michael Siu <michaelysiu@hotmail.com>
wrote:

> Hi,
>
>
>
> I am a newbie to Lucene. I have a question for making a query that
> associate
> 2 index files:
>
>
>
> - One index has the content index for a list of documents and a key to the
> document. That means the Lucene document of this index contains 2 fields:
>
> the 'content' and the 'key'.
>
> - another index has the some data indexed associated with the 'key' in the
> previous index. The Lucene document of this index contains several fields:
>
> the 'who' that contains some data and the 'key' that _points_ to the
> document in the first index.
>
>
>
> Sample data:
>
> Index_1:   [key] [content]
>
>            Abc   "blah blah 123 ..."
>
>            Xyz   "123 321 a nice day ..."
>
>
>
> Index_2:   [who]    [accessed]   [key]
>
>            David    1/1/2007     Abc
>
>            Someone  1/2/2005     Abc
>
>            Guess    12/1/2000    Xyz
>
>            Harry    1/1/2008     Abc
>
>            Sandra   1/1/2003     Xyz
>
>
>
> As shown, the [key] field in Index_2 has repeated value that _points_ to
> the
> [key] values in Index_1. How do I make a query for the following:
>
>
>
> Find out all documents in Index_2:
>
> - [who] is in range of 'David' to 'Guess' and
>
> - [accessed] in range '1/1/1900' to '1/1/2010' and
>
> - [key] associated [content] in Index_1 that contains the term 'blah'
>
>
>
> I know this is more SQL like query. Is Lucene capable of doing this type
> of
> query that needs associations among index files?
>
>
>
> Thanks in advance.
>
>
>
> - m
>
>
>
>
>
>
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33949-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 19:47:02 2008
Return-Path: <java-user-return-33949-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74851 invoked from network); 6 May 2008 19:47:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 19:47:02 -0000
Received: (qmail 48829 invoked by uid 500); 6 May 2008 19:46:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48793 invoked by uid 500); 6 May 2008 19:46:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48782 invoked by uid 99); 6 May 2008 19:46:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 12:46:56 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.187 as permitted sender)
Received: from [209.85.128.187] (HELO fk-out-0910.google.com) (209.85.128.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 19:46:11 +0000
Received: by fk-out-0910.google.com with SMTP id 18so67831fkq.5
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 12:46:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=Y2dO2BH6YS0L0j/skZiF5z7tWqg2xQHgsr74j2Uwo2o=;
        b=Zd210fwUWxCL/UiORdcqd5N/BF3s3IqmKPmSXe7e5VVtIFmpt4goNUqOuKPQd94HrtxavlOd4cB0FFbVUmObxq5S5JZiEbf7BIvCU9QLmKQQBE2sLrlm2g68XonTv9iOoKrzTr4t6GadNNBIi+gdVwaoAWwbWIkz03O2B8tF9lU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Q+tr80CnoaeOKB+mRyu+1Tcafz+S1Q2u6t6xqizb0RUGR9ySO976ccMqz76MVTSLDUVqkOKUgzapbdl3NdSmp++r/8Dl7I+IlYAqvMH5Fo/qrE6G/q3aBl5e0vgErxowEse4YgDnwo91ZoErXXPplAyCX1ptvdmxb8sruCeuKo4=
Received: by 10.82.117.16 with SMTP id p16mr113914buc.76.1210103174866;
        Tue, 06 May 2008 12:46:14 -0700 (PDT)
Received: by 10.82.191.6 with HTTP; Tue, 6 May 2008 12:46:14 -0700 (PDT)
Message-ID: <359a92830805061246g7b2d8949r39f390c0258c535b@mail.gmail.com>
Date: Tue, 6 May 2008 15:46:14 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to make a query that associates 2 index files
In-Reply-To: <BAY128-DAV1069EA00480B28A058C536BED60@phx.gbl>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_20113_4038011.1210103174869"
References: <BAY128-DAV48197750816BF4C0A00ACBED60@phx.gbl>
	 <359a92830805060936x1d5f8ecm6eff1b1f67a0c97d@mail.gmail.com>
	 <BAY128-DAV1069EA00480B28A058C536BED60@phx.gbl>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_20113_4038011.1210103174869
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Sure, just include different fields in different docs in your index.
Then, when you search since each term is on a field, docs without
that field are excluded from the search.

But this is really not very different in terms of a solution than
your earlier one. You still have the issue of searching the index
once to get the keys, then using those keys as part of another
search.

Are you saying that there is a many-to-one mapping to your content
index? And how much data are we talking about here? 10M, 100G?
this makes an enormous difference in your options.

I hope you're aware that Lucene doc IDs can change as the index is
modified, so I assume your "keys" are something you created and
NOT the lucene doc IDs.

Best
Erick

On Tue, May 6, 2008 at 3:03 PM, Michael Siu <michaelysiu@hotmail.com> wrote:

> My problem is: the [content] value can be huge. Duplicating it in more
> than
> one index document waste disk space (and search time?). In additions, when
> new documents are added to the second index, it will be faster to just
> index
> the linked [content] once (in first index file) and any subsequent
> reference
> to the same [content] will not need to re-index.
>
> In fact, I do not really need to physically separate the indices into 2
> files because Lucene supports Heterogeneous documents in an index file. I
> have no idea of how that work in a search. Does anyone know?
>
> Thanks in advance.
>
>
>
> -----Original Message-----
> From: Erick Erickson [mailto:erickerickson@gmail.com]
> Sent: Tuesday, May 06, 2008 9:36 AM
> To: java-user@lucene.apache.org
> Subject: Re: How to make a query that associates 2 index files
>
> You don't. You really have to roll your own solution here, there's
> no "inter-index" awareness that I know of in Lucene.
>
> Typically, people either do a half-half solution (that is, put the
> text search in Lucene and leave the DB parts in the DB) or
> de-normalize the data in a Lucene index so you don't have
> to even try to do things cross-index.
>
> And then there's Marcelo Ochoa (I may have the spelling wrong) who's
> put together some way to embed Lucene in an Oracle database, but
> that's magic to me.
>
> Why do you want to arrange your index this way in the first place?
> Perhaps there's a more specific answer waiting out there...
>
> Best
> Erick
>
> On Tue, May 6, 2008 at 12:14 PM, Michael Siu <michaelysiu@hotmail.com>
> wrote:
>
> > Hi,
> >
> >
> >
> > I am a newbie to Lucene. I have a question for making a query that
> > associate
> > 2 index files:
> >
> >
> >
> > - One index has the content index for a list of documents and a key to
> the
> > document. That means the Lucene document of this index contains 2
> fields:
> >
> > the 'content' and the 'key'.
> >
> > - another index has the some data indexed associated with the 'key' in
> the
> > previous index. The Lucene document of this index contains several
> fields:
> >
> > the 'who' that contains some data and the 'key' that _points_ to the
> > document in the first index.
> >
> >
> >
> > Sample data:
> >
> > Index_1:   [key] [content]
> >
> >            Abc   "blah blah 123 ..."
> >
> >            Xyz   "123 321 a nice day ..."
> >
> >
> >
> > Index_2:   [who]    [accessed]   [key]
> >
> >            David    1/1/2007     Abc
> >
> >            Someone  1/2/2005     Abc
> >
> >            Guess    12/1/2000    Xyz
> >
> >            Harry    1/1/2008     Abc
> >
> >            Sandra   1/1/2003     Xyz
> >
> >
> >
> > As shown, the [key] field in Index_2 has repeated value that _points_ to
> > the
> > [key] values in Index_1. How do I make a query for the following:
> >
> >
> >
> > Find out all documents in Index_2:
> >
> > - [who] is in range of 'David' to 'Guess' and
> >
> > - [accessed] in range '1/1/1900' to '1/1/2010' and
> >
> > - [key] associated [content] in Index_1 that contains the term 'blah'
> >
> >
> >
> > I know this is more SQL like query. Is Lucene capable of doing this type
> > of
> > query that needs associations among index files?
> >
> >
> >
> > Thanks in advance.
> >
> >
> >
> > - m
> >
> >
> >
> >
> >
> >
> >
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_20113_4038011.1210103174869--

From java-user-return-33950-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 21:37:02 2008
Return-Path: <java-user-return-33950-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42384 invoked from network); 6 May 2008 21:37:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 21:37:02 -0000
Received: (qmail 83105 invoked by uid 500); 6 May 2008 21:36:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82855 invoked by uid 500); 6 May 2008 21:36:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82844 invoked by uid 99); 6 May 2008 21:36:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 14:36:56 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,URIBL_GREY
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of marcelo.ochoa@gmail.com designates 74.125.46.31 as permitted sender)
Received: from [74.125.46.31] (HELO yw-out-2324.google.com) (74.125.46.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 21:36:08 +0000
Received: by yw-out-2324.google.com with SMTP id 3so2210ywj.5
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 14:36:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=nhfyu2sNsxBy7g9bJW3IJiklLSklAU/5+aY1xNuS6bY=;
        b=SE8m/zoa8eskIon1oNnccbubpchuzJxJRMRQ3b/b8fA2x3fFlHFlak29rwsGwzqlI8Jg+bjbTGHY2LTPU4SR5R5POWbc/xI4rRtIhjS8c3rPocbADt3QmnIMxkIDcwBt2OiYuFB+wVbz4wu13D5tn2jlscs03AyNQ4tBvEDnVZo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=eWFcjPW9Hx/0VVEVqWrrB49kWAcWChizRft8NukaUFKkY0BUUaC4Rt3SYRkxZ2wse2gg55ACqu1Rpgk29JG+XGKfk1ajE2K1jn0Nxb0jep6ODS9JXia8G2L6JWRbteIZqGuwnwpO+dkxJfZCqET7Xv0A0c9eWpERp5yXIO5FL6U=
Received: by 10.151.108.13 with SMTP id k13mr1317500ybm.84.1210109177989;
        Tue, 06 May 2008 14:26:17 -0700 (PDT)
Received: by 10.151.99.7 with HTTP; Tue, 6 May 2008 14:26:17 -0700 (PDT)
Message-ID: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com>
Date: Tue, 6 May 2008 18:26:17 -0300
From: "Marcelo Ochoa" <marcelo.ochoa@gmail.com>
To: java-user@lucene.apache.org
Subject: Help to solve an issue when upgrading Lucene-Oracle integration to lucene 2.3.1
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Lucene experts:
  I am working upgrading Lucene-Oracle integration project to latest
Lucene 2.3.1 code.
 After correcting a minor issue on OJVMDirectory file implementation I
have the integration running with latest 2.3.1 code.
 But it only works with small indexes, I think index which are lower
than the Memory threshold.
 If I performs an index in a big table, I got this exception:
 Exception in thread "Root Thread" java.lang.ArrayIndexOutOfBoundsException
        at org.apache.lucene.index.DocumentsWriter$ByteSliceReader.nextSlice(DocumentsWriter.java)
        at org.apache.lucene.index.DocumentsWriter$ByteSliceReader.readByte(DocumentsWriter.java)
        at org.apache.lucene.store.IndexInput.readVInt(IndexInput.java)
        at org.apache.lucene.index.DocumentsWriter.appendPostings(DocumentsWriter.java)
        at org.apache.lucene.index.DocumentsWriter.writeSegment(DocumentsWriter.java:2011)
        at org.apache.lucene.index.DocumentsWriter.flush(DocumentsWriter.java:548)
        at org.apache.lucene.index.IndexWriter.doFlush(IndexWriter.java:2497)
        at org.apache.lucene.index.IndexWriter.flush(IndexWriter.java:2397)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
        at org.apache.lucene.indexer.TableIndexer.index(TableIndexer.java)
        at org.apache.lucene.indexer.LuceneDomainIndex.ODCIIndexCreate(LuceneDomainIndex.java:477)

  Something is wrong at nextSlice method :(
  I added some System.out info and, before the exception is thrown,
index and arrays have this information:

.nextSlice (previous)
limit: 11393 buffer.length: 32768
level: 0 nextLevelArray.length: 10
bufferUpto: 147 pool.buffers.length: 366
.nextSlice (current)
limit: 6189 buffer.length: 32768
level: 0 nextLevelArray.length: 10
bufferUpto: 8192 pool.buffers.length: 366

   As you can see bufferUpto variable have 8192 value and pool.buffers
is an array of 366 elements, this cause the exception  nextSlice()
method is:
    public void nextSlice() {

      // Skip to our next slice
      System.out.println(".nextSlice");
      System.out.println("limit: "+limit+" buffer.length: "+buffer.length);
      final int nextIndex = ((buffer[limit]&0xff)<<24) +
((buffer[1+limit]&0xff)<<16) + ((buffer[2+limit]&0xff)<<8) +
(buffer[3+limit]&0xff);

      System.out.println("level: "+level+" nextLevelArray.length:
"+nextLevelArray.length);
      level = nextLevelArray[level];
      final int newSize = levelSizeArray[level];

      bufferUpto = nextIndex / BYTE_BLOCK_SIZE;
      bufferOffset = bufferUpto * BYTE_BLOCK_SIZE;

      System.out.println("bufferUpto: "+bufferUpto+"
pool.buffers.length: "+pool.buffers.length);
      buffer = pool.buffers[bufferUpto];
      upto = nextIndex & BYTE_BLOCK_MASK;

      if (nextIndex + newSize >= endIndex) {
        // We are advancing to the final slice
        assert endIndex - nextIndex > 0;
        limit = endIndex - bufferOffset;
      } else {
        // This is not the final slice (subtract 4 for the
        // forwarding address at the end of this new slice)
        limit = upto+newSize-4;
      }
    }

    IndexWriter InfoStream information is:
  RAM: now flush @ usedMB=53.016 allocMB=53.016 triggerMB=53
IW 0 [Root Thread]:   flush: segment=_0 docStoreSegment=_0
docStoreOffset=0 flushDocs=true flushDeletes=false
flushDocStores=false numDocs=85
564 numBufDelTerms=0
IW 0 [Root Thread]:   index before flush
flush postings as segment _0 numDocs=85564
..... nextSlice output here.....
docWriter: now abort
IW 1 [Root Thread]: hit exception flushing segment _0
docWriter: now abort
IFD [Root Thread]: now checkpoint "segments_1" [0 segments ; isCommit = false]
IFD [Root Thread]: refresh [prefix=_0]: removing newly created
unreferenced file "_0.tii"
IFD [Root Thread]: delete "_0.tii"
IFD [Root Thread]: refresh [prefix=_0]: removing newly created
unreferenced file "_0.fdx"
IFD [Root Thread]: delete "_0.fdx"
IFD [Root Thread]: refresh [prefix=_0]: removing newly created
unreferenced file "_0.fnm"
IFD [Root Thread]: delete "_0.fnm"
IFD [Root Thread]: refresh [prefix=_0]: removing newly created
unreferenced file "_0.fdt"
IFD [Root Thread]: delete "_0.fdt"
IFD [Root Thread]: refresh [prefix=_0]: removing newly created
unreferenced file "_0.prx"
IFD [Root Thread]: delete "_0.prx"
IFD [Root Thread]: refresh [prefix=_0]: removing newly created
unreferenced file "_0.frq"
IFD [Root Thread]: delete "_0.frq"
IFD [Root Thread]: refresh [prefix=_0]: removing newly created
unreferenced file "_0.tis"
IFD [Root Thread]: delete "_0.tis"
IW 1 [Root Thread]: now flush at close
IW 1 [Root Thread]:   flush: segment=null docStoreSegment=null
docStoreOffset=0 flushDocs=false flushDeletes=false
flushDocStores=false numDocs=0 numBufDelTerms=0
IW 1 [Root Thread]:   index before flush
IW 1 [Root Thread]: close: wrote segments file "segments_2"
IFD [Root Thread]: now checkpoint "segments_2" [0 segments ; isCommit = true]
IFD [Root Thread]: deleteCommits: now remove commit "segments_1"
IFD [Root Thread]: delete "segments_1"
IW 1 [Root Thread]: at close:
Exception in thread "Root Thread" java.lang.ArrayIndexOutOfBoundsException
        at org.apache.lucene.index.DocumentsWriter$ByteSliceReader.nextSlice(DocumentsWriter.java)
        at org.apache.lucene.index.DocumentsWriter$ByteSliceReader.readByte(DocumentsWriter.java)
        at org.apache.lucene.store.IndexInput.readVInt(IndexInput.java)
        at org.apache.lucene.index.DocumentsWriter.appendPostings(DocumentsWriter.java)
        at org.apache.lucene.index.DocumentsWriter.writeSegment(DocumentsWriter.java:2011)
        at org.apache.lucene.index.DocumentsWriter.flush(DocumentsWriter.java:548)
        at org.apache.lucene.index.IndexWriter.doFlush(IndexWriter.java:2497)
        at org.apache.lucene.index.IndexWriter.flush(IndexWriter.java:2397)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
        at org.apache.lucene.indexer.TableIndexer.index(TableIndexer.java)
        at org.apache.lucene.indexer.LuceneDomainIndex.ODCIIndexCreate(LuceneDomainIndex.java:477)

  Any help to find the incompatibility issue will be great.
  Best regards, Marcelo.

PD: If anybody needs the complete log I can send it my email.
-- 
Marcelo F. Ochoa
http://marceloochoa.blogspot.com/
http://marcelo.ochoa.googlepages.com/home
______________
Do you Know DBPrism? Look @ DB Prism's Web Site
http://www.dbprism.com.ar/index.html
More info?
Chapter 17 of the book "Programming the Oracle Database using Java &
Web Services"
http://www.amazon.com/gp/product/1555583296/
Chapter 21 of the book "Professional XML Databases" - Wrox Press
http://www.amazon.com/gp/product/1861003587/
Chapter 8 of the book "Oracle & Open Source" - O'Reilly
http://www.oreilly.com/catalog/oracleopen/

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33951-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 22:00:55 2008
Return-Path: <java-user-return-33951-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60749 invoked from network); 6 May 2008 22:00:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 22:00:55 -0000
Received: (qmail 15225 invoked by uid 500); 6 May 2008 22:00:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15187 invoked by uid 500); 6 May 2008 22:00:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15176 invoked by uid 99); 6 May 2008 22:00:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 15:00:48 -0700
X-ASF-Spam-Status: No, hits=1.5 required=10.0
	tests=SPF_NEUTRAL,URIBL_GREY
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.132.241] (HELO an-out-0708.google.com) (209.85.132.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 21:59:58 +0000
Received: by an-out-0708.google.com with SMTP id c37so1591anc.49
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 15:00:11 -0700 (PDT)
Received: by 10.100.41.9 with SMTP id o9mr1790500ano.42.1210111211294;
        Tue, 06 May 2008 15:00:11 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id c23sm1818697ana.18.2008.05.06.15.00.10
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 06 May 2008 15:00:11 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com>
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: Help to solve an issue when upgrading Lucene-Oracle integration to lucene 2.3.1
Date: Tue, 6 May 2008 18:00:58 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Marcelo,

Hmmm something is not right.

Somehow the byte slices, which DocumentsWriter uses to hold the  
postings in RAM, became corrupt.

Is this easily reproduced?

Mike

Marcelo Ochoa wrote:
> Hi Lucene experts:
>   I am working upgrading Lucene-Oracle integration project to latest
> Lucene 2.3.1 code.
>  After correcting a minor issue on OJVMDirectory file implementation I
> have the integration running with latest 2.3.1 code.
>  But it only works with small indexes, I think index which are lower
> than the Memory threshold.
>  If I performs an index in a big table, I got this exception:
>  Exception in thread "Root Thread"  
> java.lang.ArrayIndexOutOfBoundsException
>         at org.apache.lucene.index.DocumentsWriter 
> $ByteSliceReader.nextSlice(DocumentsWriter.java)
>         at org.apache.lucene.index.DocumentsWriter 
> $ByteSliceReader.readByte(DocumentsWriter.java)
>         at org.apache.lucene.store.IndexInput.readVInt 
> (IndexInput.java)
>         at org.apache.lucene.index.DocumentsWriter.appendPostings 
> (DocumentsWriter.java)
>         at org.apache.lucene.index.DocumentsWriter.writeSegment 
> (DocumentsWriter.java:2011)
>         at org.apache.lucene.index.DocumentsWriter.flush 
> (DocumentsWriter.java:548)
>         at org.apache.lucene.index.IndexWriter.doFlush 
> (IndexWriter.java:2497)
>         at org.apache.lucene.index.IndexWriter.flush 
> (IndexWriter.java:2397)
>         at org.apache.lucene.index.IndexWriter.addDocument 
> (IndexWriter.java)
>         at org.apache.lucene.index.IndexWriter.addDocument 
> (IndexWriter.java)
>         at org.apache.lucene.indexer.TableIndexer.index 
> (TableIndexer.java)
>         at  
> org.apache.lucene.indexer.LuceneDomainIndex.ODCIIndexCreate 
> (LuceneDomainIndex.java:477)
>
>   Something is wrong at nextSlice method :(
>   I added some System.out info and, before the exception is thrown,
> index and arrays have this information:
>
> .nextSlice (previous)
> limit: 11393 buffer.length: 32768
> level: 0 nextLevelArray.length: 10
> bufferUpto: 147 pool.buffers.length: 366
> .nextSlice (current)
> limit: 6189 buffer.length: 32768
> level: 0 nextLevelArray.length: 10
> bufferUpto: 8192 pool.buffers.length: 366
>
>    As you can see bufferUpto variable have 8192 value and pool.buffers
> is an array of 366 elements, this cause the exception  nextSlice()
> method is:
>     public void nextSlice() {
>
>       // Skip to our next slice
>       System.out.println(".nextSlice");
>       System.out.println("limit: "+limit+" buffer.length:  
> "+buffer.length);
>       final int nextIndex = ((buffer[limit]&0xff)<<24) +
> ((buffer[1+limit]&0xff)<<16) + ((buffer[2+limit]&0xff)<<8) +
> (buffer[3+limit]&0xff);
>
>       System.out.println("level: "+level+" nextLevelArray.length:
> "+nextLevelArray.length);
>       level = nextLevelArray[level];
>       final int newSize = levelSizeArray[level];
>
>       bufferUpto = nextIndex / BYTE_BLOCK_SIZE;
>       bufferOffset = bufferUpto * BYTE_BLOCK_SIZE;
>
>       System.out.println("bufferUpto: "+bufferUpto+"
> pool.buffers.length: "+pool.buffers.length);
>       buffer = pool.buffers[bufferUpto];
>       upto = nextIndex & BYTE_BLOCK_MASK;
>
>       if (nextIndex + newSize >= endIndex) {
>         // We are advancing to the final slice
>         assert endIndex - nextIndex > 0;
>         limit = endIndex - bufferOffset;
>       } else {
>         // This is not the final slice (subtract 4 for the
>         // forwarding address at the end of this new slice)
>         limit = upto+newSize-4;
>       }
>     }
>
>     IndexWriter InfoStream information is:
>   RAM: now flush @ usedMB=53.016 allocMB=53.016 triggerMB=53
> IW 0 [Root Thread]:   flush: segment=_0 docStoreSegment=_0
> docStoreOffset=0 flushDocs=true flushDeletes=false
> flushDocStores=false numDocs=85
> 564 numBufDelTerms=0
> IW 0 [Root Thread]:   index before flush
> flush postings as segment _0 numDocs=85564
> ..... nextSlice output here.....
> docWriter: now abort
> IW 1 [Root Thread]: hit exception flushing segment _0
> docWriter: now abort
> IFD [Root Thread]: now checkpoint "segments_1" [0 segments ;  
> isCommit = false]
> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> unreferenced file "_0.tii"
> IFD [Root Thread]: delete "_0.tii"
> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> unreferenced file "_0.fdx"
> IFD [Root Thread]: delete "_0.fdx"
> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> unreferenced file "_0.fnm"
> IFD [Root Thread]: delete "_0.fnm"
> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> unreferenced file "_0.fdt"
> IFD [Root Thread]: delete "_0.fdt"
> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> unreferenced file "_0.prx"
> IFD [Root Thread]: delete "_0.prx"
> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> unreferenced file "_0.frq"
> IFD [Root Thread]: delete "_0.frq"
> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> unreferenced file "_0.tis"
> IFD [Root Thread]: delete "_0.tis"
> IW 1 [Root Thread]: now flush at close
> IW 1 [Root Thread]:   flush: segment=null docStoreSegment=null
> docStoreOffset=0 flushDocs=false flushDeletes=false
> flushDocStores=false numDocs=0 numBufDelTerms=0
> IW 1 [Root Thread]:   index before flush
> IW 1 [Root Thread]: close: wrote segments file "segments_2"
> IFD [Root Thread]: now checkpoint "segments_2" [0 segments ;  
> isCommit = true]
> IFD [Root Thread]: deleteCommits: now remove commit "segments_1"
> IFD [Root Thread]: delete "segments_1"
> IW 1 [Root Thread]: at close:
> Exception in thread "Root Thread"  
> java.lang.ArrayIndexOutOfBoundsException
>         at org.apache.lucene.index.DocumentsWriter 
> $ByteSliceReader.nextSlice(DocumentsWriter.java)
>         at org.apache.lucene.index.DocumentsWriter 
> $ByteSliceReader.readByte(DocumentsWriter.java)
>         at org.apache.lucene.store.IndexInput.readVInt 
> (IndexInput.java)
>         at org.apache.lucene.index.DocumentsWriter.appendPostings 
> (DocumentsWriter.java)
>         at org.apache.lucene.index.DocumentsWriter.writeSegment 
> (DocumentsWriter.java:2011)
>         at org.apache.lucene.index.DocumentsWriter.flush 
> (DocumentsWriter.java:548)
>         at org.apache.lucene.index.IndexWriter.doFlush 
> (IndexWriter.java:2497)
>         at org.apache.lucene.index.IndexWriter.flush 
> (IndexWriter.java:2397)
>         at org.apache.lucene.index.IndexWriter.addDocument 
> (IndexWriter.java)
>         at org.apache.lucene.index.IndexWriter.addDocument 
> (IndexWriter.java)
>         at org.apache.lucene.indexer.TableIndexer.index 
> (TableIndexer.java)
>         at  
> org.apache.lucene.indexer.LuceneDomainIndex.ODCIIndexCreate 
> (LuceneDomainIndex.java:477)
>
>   Any help to find the incompatibility issue will be great.
>   Best regards, Marcelo.
>
> PD: If anybody needs the complete log I can send it my email.
> -- 
> Marcelo F. Ochoa
> http://marceloochoa.blogspot.com/
> http://marcelo.ochoa.googlepages.com/home
> ______________
> Do you Know DBPrism? Look @ DB Prism's Web Site
> http://www.dbprism.com.ar/index.html
> More info?
> Chapter 17 of the book "Programming the Oracle Database using Java &
> Web Services"
> http://www.amazon.com/gp/product/1555583296/
> Chapter 21 of the book "Professional XML Databases" - Wrox Press
> http://www.amazon.com/gp/product/1861003587/
> Chapter 8 of the book "Oracle & Open Source" - O'Reilly
> http://www.oreilly.com/catalog/oracleopen/
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33952-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 06 22:16:30 2008
Return-Path: <java-user-return-33952-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64518 invoked from network); 6 May 2008 22:16:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 May 2008 22:16:30 -0000
Received: (qmail 31359 invoked by uid 500); 6 May 2008 22:16:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31334 invoked by uid 500); 6 May 2008 22:16:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31323 invoked by uid 99); 6 May 2008 22:16:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 15:16:24 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,URIBL_GREY
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of marcelo.ochoa@gmail.com designates 74.125.46.28 as permitted sender)
Received: from [74.125.46.28] (HELO yw-out-2324.google.com) (74.125.46.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 22:15:36 +0000
Received: by yw-out-2324.google.com with SMTP id 3so10542ywj.5
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 15:15:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=LS39/KpXWFmzGcP1iDF0O8kvAlUOXCHlMT71n8igiiM=;
        b=Ud3cGNfuFxI9UD1BBaHatZjBZ5awi9/H3TWQw8udC1Z72u4otzeqhow6vLvb1JJ+8EOc9IVdUOwE9sEPO0HIoFwCMvGWqdJF0Vs7rqIEzFE00KyYHl9kt2YsHPExwL1Lpk9e3EWENfRaWlJbhgnOQlh2J7nyjqZ6BzCYioR5e5I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=fIVNEsM08IzfXGa1bQdj/7QkiuU2r+WW09gf8P6918/9xtkBL7ZoPonPmARuascf7lNBWoDHaYIFpFkDhAjGv2977izLkkreNdNZu+Rwp7iCqXOzhg9D9czDdLMEtINNOZ/9PtPQ426rwUHQjeSLT95PUpgQt3uVKsoQuD8rU/M=
Received: by 10.150.229.16 with SMTP id b16mr1317323ybh.239.1210112149699;
        Tue, 06 May 2008 15:15:49 -0700 (PDT)
Received: by 10.151.99.7 with HTTP; Tue, 6 May 2008 15:15:49 -0700 (PDT)
Message-ID: <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com>
Date: Tue, 6 May 2008 19:15:49 -0300
From: "Marcelo Ochoa" <marcelo.ochoa@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Help to solve an issue when upgrading Lucene-Oracle integration to lucene 2.3.1
In-Reply-To: <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com>
	 <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Mike:
  Well the problem is consitently, but to test the code and the
project its necesary an Oracle 11g database :(
  I don't know why the computation of bufferUpto variable is wrong in
the last step, during all other calls pool.buffers.length is
consitently to 366 so I asume that its OK. And the value 8192 for
byfferUpto is suspicious because seem a bit shift or overrun.
  How bufferUpto variable is computed?
  Using some segment info alredy writed into the disk, or is in memory
at this point?
  I am still investigating the problem by adding more debugging information.
  Best regards, Marcelo.
On Tue, May 6, 2008 at 7:00 PM, Michael McCandless
<lucene@mikemccandless.com> wrote:
>
>  Hi Marcelo,
>
>  Hmmm something is not right.
>
>  Somehow the byte slices, which DocumentsWriter uses to hold the postings in
> RAM, became corrupt.
>
>  Is this easily reproduced?
>
>  Mike
>
>  Marcelo Ochoa wrote:
>
> >
> >
> >
> > Hi Lucene experts:
> >  I am working upgrading Lucene-Oracle integration project to latest
> > Lucene 2.3.1 code.
> >  After correcting a minor issue on OJVMDirectory file implementation I
> > have the integration running with latest 2.3.1 code.
> >  But it only works with small indexes, I think index which are lower
> > than the Memory threshold.
> >  If I performs an index in a big table, I got this exception:
> >  Exception in thread "Root Thread"
> java.lang.ArrayIndexOutOfBoundsException
> >        at
> org.apache.lucene.index.DocumentsWriter$ByteSliceReader.nextSlice(DocumentsWriter.java)
> >        at
> org.apache.lucene.index.DocumentsWriter$ByteSliceReader.readByte(DocumentsWriter.java)
> >        at org.apache.lucene.store.IndexInput.readVInt(IndexInput.java)
> >        at
> org.apache.lucene.index.DocumentsWriter.appendPostings(DocumentsWriter.java)
> >        at
> org.apache.lucene.index.DocumentsWriter.writeSegment(DocumentsWriter.java:2011)
> >        at
> org.apache.lucene.index.DocumentsWriter.flush(DocumentsWriter.java:548)
> >        at
> org.apache.lucene.index.IndexWriter.doFlush(IndexWriter.java:2497)
> >        at org.apache.lucene.index.IndexWriter.flush(IndexWriter.java:2397)
> >        at
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
> >        at
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
> >        at org.apache.lucene.indexer.TableIndexer.index(TableIndexer.java)
> >        at
> org.apache.lucene.indexer.LuceneDomainIndex.ODCIIndexCreate(LuceneDomainIndex.java:477)
> >
> >  Something is wrong at nextSlice method :(
> >  I added some System.out info and, before the exception is thrown,
> > index and arrays have this information:
> >
> > .nextSlice (previous)
> > limit: 11393 buffer.length: 32768
> > level: 0 nextLevelArray.length: 10
> > bufferUpto: 147 pool.buffers.length: 366
> > .nextSlice (current)
> > limit: 6189 buffer.length: 32768
> > level: 0 nextLevelArray.length: 10
> > bufferUpto: 8192 pool.buffers.length: 366
> >
> >   As you can see bufferUpto variable have 8192 value and pool.buffers
> > is an array of 366 elements, this cause the exception  nextSlice()
> > method is:
> >    public void nextSlice() {
> >
> >      // Skip to our next slice
> >      System.out.println(".nextSlice");
> >      System.out.println("limit: "+limit+" buffer.length: "+buffer.length);
> >      final int nextIndex = ((buffer[limit]&0xff)<<24) +
> > ((buffer[1+limit]&0xff)<<16) + ((buffer[2+limit]&0xff)<<8) +
> > (buffer[3+limit]&0xff);
> >
> >      System.out.println("level: "+level+" nextLevelArray.length:
> > "+nextLevelArray.length);
> >      level = nextLevelArray[level];
> >      final int newSize = levelSizeArray[level];
> >
> >      bufferUpto = nextIndex / BYTE_BLOCK_SIZE;
> >      bufferOffset = bufferUpto * BYTE_BLOCK_SIZE;
> >
> >      System.out.println("bufferUpto: "+bufferUpto+"
> > pool.buffers.length: "+pool.buffers.length);
> >      buffer = pool.buffers[bufferUpto];
> >      upto = nextIndex & BYTE_BLOCK_MASK;
> >
> >      if (nextIndex + newSize >= endIndex) {
> >        // We are advancing to the final slice
> >        assert endIndex - nextIndex > 0;
> >        limit = endIndex - bufferOffset;
> >      } else {
> >        // This is not the final slice (subtract 4 for the
> >        // forwarding address at the end of this new slice)
> >        limit = upto+newSize-4;
> >      }
> >    }
> >
> >    IndexWriter InfoStream information is:
> >  RAM: now flush @ usedMB=53.016 allocMB=53.016 triggerMB=53
> > IW 0 [Root Thread]:   flush: segment=_0 docStoreSegment=_0
> > docStoreOffset=0 flushDocs=true flushDeletes=false
> > flushDocStores=false numDocs=85
> > 564 numBufDelTerms=0
> > IW 0 [Root Thread]:   index before flush
> > flush postings as segment _0 numDocs=85564
> > ..... nextSlice output here.....
> > docWriter: now abort
> > IW 1 [Root Thread]: hit exception flushing segment _0
> > docWriter: now abort
> > IFD [Root Thread]: now checkpoint "segments_1" [0 segments ; isCommit =
> false]
> > IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> > unreferenced file "_0.tii"
> > IFD [Root Thread]: delete "_0.tii"
> > IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> > unreferenced file "_0.fdx"
> > IFD [Root Thread]: delete "_0.fdx"
> > IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> > unreferenced file "_0.fnm"
> > IFD [Root Thread]: delete "_0.fnm"
> > IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> > unreferenced file "_0.fdt"
> > IFD [Root Thread]: delete "_0.fdt"
> > IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> > unreferenced file "_0.prx"
> > IFD [Root Thread]: delete "_0.prx"
> > IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> > unreferenced file "_0.frq"
> > IFD [Root Thread]: delete "_0.frq"
> > IFD [Root Thread]: refresh [prefix=_0]: removing newly created
> > unreferenced file "_0.tis"
> > IFD [Root Thread]: delete "_0.tis"
> > IW 1 [Root Thread]: now flush at close
> > IW 1 [Root Thread]:   flush: segment=null docStoreSegment=null
> > docStoreOffset=0 flushDocs=false flushDeletes=false
> > flushDocStores=false numDocs=0 numBufDelTerms=0
> > IW 1 [Root Thread]:   index before flush
> > IW 1 [Root Thread]: close: wrote segments file "segments_2"
> > IFD [Root Thread]: now checkpoint "segments_2" [0 segments ; isCommit =
> true]
> > IFD [Root Thread]: deleteCommits: now remove commit "segments_1"
> > IFD [Root Thread]: delete "segments_1"
> > IW 1 [Root Thread]: at close:
> > Exception in thread "Root Thread" java.lang.ArrayIndexOutOfBoundsException
> >        at
> org.apache.lucene.index.DocumentsWriter$ByteSliceReader.nextSlice(DocumentsWriter.java)
> >        at
> org.apache.lucene.index.DocumentsWriter$ByteSliceReader.readByte(DocumentsWriter.java)
> >        at org.apache.lucene.store.IndexInput.readVInt(IndexInput.java)
> >        at
> org.apache.lucene.index.DocumentsWriter.appendPostings(DocumentsWriter.java)
> >        at
> org.apache.lucene.index.DocumentsWriter.writeSegment(DocumentsWriter.java:2011)
> >        at
> org.apache.lucene.index.DocumentsWriter.flush(DocumentsWriter.java:548)
> >        at
> org.apache.lucene.index.IndexWriter.doFlush(IndexWriter.java:2497)
> >        at org.apache.lucene.index.IndexWriter.flush(IndexWriter.java:2397)
> >        at
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
> >        at
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
> >        at org.apache.lucene.indexer.TableIndexer.index(TableIndexer.java)
> >        at
> org.apache.lucene.indexer.LuceneDomainIndex.ODCIIndexCreate(LuceneDomainIndex.java:477)
> >
> >  Any help to find the incompatibility issue will be great.
> >  Best regards, Marcelo.
> >
> > PD: If anybody needs the complete log I can send it my email.
> > --
> > Marcelo F. Ochoa
> > http://marceloochoa.blogspot.com/
> > http://marcelo.ochoa.googlepages.com/home
> > ______________
> > Do you Know DBPrism? Look @ DB Prism's Web Site
> > http://www.dbprism.com.ar/index.html
> > More info?
> > Chapter 17 of the book "Programming the Oracle Database using Java &
> > Web Services"
> > http://www.amazon.com/gp/product/1555583296/
> > Chapter 21 of the book "Professional XML Databases" - Wrox Press
> > http://www.amazon.com/gp/product/1861003587/
> > Chapter 8 of the book "Oracle & Open Source" - O'Reilly
> > http://www.oreilly.com/catalog/oracleopen/
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
>  ---------------------------------------------------------------------
>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 
Marcelo F. Ochoa
http://marceloochoa.blogspot.com/
http://marcelo.ochoa.googlepages.com/home
______________
Do you Know DBPrism? Look @ DB Prism's Web Site
http://www.dbprism.com.ar/index.html
More info?
Chapter 17 of the book "Programming the Oracle Database using Java &
Web Services"
http://www.amazon.com/gp/product/1555583296/
Chapter 21 of the book "Professional XML Databases" - Wrox Press
http://www.amazon.com/gp/product/1861003587/
Chapter 8 of the book "Oracle & Open Source" - O'Reilly
http://www.oreilly.com/catalog/oracleopen/

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33953-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 00:02:40 2008
Return-Path: <java-user-return-33953-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90615 invoked from network); 7 May 2008 00:02:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 00:02:40 -0000
Received: (qmail 87113 invoked by uid 500); 7 May 2008 00:02:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87082 invoked by uid 500); 7 May 2008 00:02:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87071 invoked by uid 99); 7 May 2008 00:02:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 17:02:33 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of michaelysiu@hotmail.com designates 65.54.246.139 as permitted sender)
Received: from [65.54.246.139] (HELO bay0-omc2-s3.bay0.hotmail.com) (65.54.246.139)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 00:01:46 +0000
Received: from hotmail.com ([65.55.133.22]) by bay0-omc2-s3.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 6 May 2008 17:02:00 -0700
Received: from mail pickup service by hotmail.com with Microsoft SMTPSVC;
	 Tue, 6 May 2008 17:02:00 -0700
Message-ID: <BAY128-DAV1244CF5F29619CE4CA024DBED10@phx.gbl>
Received: from 209.189.193.162 by BAY128-DAV12.phx.gbl with DAV;
	Wed, 07 May 2008 00:01:56 +0000
X-Originating-IP: [209.189.193.162]
X-Originating-Email: [michaelysiu@hotmail.com]
X-Sender: michaelysiu@hotmail.com
From: "Michael Siu" <michaelysiu@hotmail.com>
To: <java-user@lucene.apache.org>
References: <BAY128-DAV48197750816BF4C0A00ACBED60@phx.gbl>	 <359a92830805060936x1d5f8ecm6eff1b1f67a0c97d@mail.gmail.com>	 <BAY128-DAV1069EA00480B28A058C536BED60@phx.gbl> <359a92830805061246g7b2d8949r39f390c0258c535b@mail.gmail.com>
In-Reply-To: <359a92830805061246g7b2d8949r39f390c0258c535b@mail.gmail.com>
Subject: RE: How to make a query that associates 2 index files
Date: Tue, 6 May 2008 17:02:32 -0700
Message-ID: <029401c8afd5$a5a073b0$f0e15b10$@com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
thread-index: AcivsfOJH81DA8MuQ0ayWZAjPc/xTQAIzKYg
Content-Language: en-us
X-OriginalArrivalTime: 07 May 2008 00:02:00.0485 (UTC) FILETIME=[92BD8D50:01C8AFD5]
X-Virus-Checked: Checked by ClamAV on apache.org

Yes, there is many-to-one mapping to the content index. And the size of
content data is varying say from 1K to multiple Gs. That why it is not wise
to repeat the same content in a index document. 

Thanks for telling that the doc IDs are not constant. Yes, the keys to
content are generated on the fly and be unique per different content.

Thanks.
-m

-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com] 
Sent: Tuesday, May 06, 2008 12:46 PM
To: java-user@lucene.apache.org
Subject: Re: How to make a query that associates 2 index files

Sure, just include different fields in different docs in your index.
Then, when you search since each term is on a field, docs without
that field are excluded from the search.

But this is really not very different in terms of a solution than
your earlier one. You still have the issue of searching the index
once to get the keys, then using those keys as part of another
search.

Are you saying that there is a many-to-one mapping to your content
index? And how much data are we talking about here? 10M, 100G?
this makes an enormous difference in your options.

I hope you're aware that Lucene doc IDs can change as the index is
modified, so I assume your "keys" are something you created and
NOT the lucene doc IDs.

Best
Erick

On Tue, May 6, 2008 at 3:03 PM, Michael Siu <michaelysiu@hotmail.com> wrote:

> My problem is: the [content] value can be huge. Duplicating it in more
> than
> one index document waste disk space (and search time?). In additions, when
> new documents are added to the second index, it will be faster to just
> index
> the linked [content] once (in first index file) and any subsequent
> reference
> to the same [content] will not need to re-index.
>
> In fact, I do not really need to physically separate the indices into 2
> files because Lucene supports Heterogeneous documents in an index file. I
> have no idea of how that work in a search. Does anyone know?
>
> Thanks in advance.
>
>
>
> -----Original Message-----
> From: Erick Erickson [mailto:erickerickson@gmail.com]
> Sent: Tuesday, May 06, 2008 9:36 AM
> To: java-user@lucene.apache.org
> Subject: Re: How to make a query that associates 2 index files
>
> You don't. You really have to roll your own solution here, there's
> no "inter-index" awareness that I know of in Lucene.
>
> Typically, people either do a half-half solution (that is, put the
> text search in Lucene and leave the DB parts in the DB) or
> de-normalize the data in a Lucene index so you don't have
> to even try to do things cross-index.
>
> And then there's Marcelo Ochoa (I may have the spelling wrong) who's
> put together some way to embed Lucene in an Oracle database, but
> that's magic to me.
>
> Why do you want to arrange your index this way in the first place?
> Perhaps there's a more specific answer waiting out there...
>
> Best
> Erick
>
> On Tue, May 6, 2008 at 12:14 PM, Michael Siu <michaelysiu@hotmail.com>
> wrote:
>
> > Hi,
> >
> >
> >
> > I am a newbie to Lucene. I have a question for making a query that
> > associate
> > 2 index files:
> >
> >
> >
> > - One index has the content index for a list of documents and a key to
> the
> > document. That means the Lucene document of this index contains 2
> fields:
> >
> > the 'content' and the 'key'.
> >
> > - another index has the some data indexed associated with the 'key' in
> the
> > previous index. The Lucene document of this index contains several
> fields:
> >
> > the 'who' that contains some data and the 'key' that _points_ to the
> > document in the first index.
> >
> >
> >
> > Sample data:
> >
> > Index_1:   [key] [content]
> >
> >            Abc   "blah blah 123 ..."
> >
> >            Xyz   "123 321 a nice day ..."
> >
> >
> >
> > Index_2:   [who]    [accessed]   [key]
> >
> >            David    1/1/2007     Abc
> >
> >            Someone  1/2/2005     Abc
> >
> >            Guess    12/1/2000    Xyz
> >
> >            Harry    1/1/2008     Abc
> >
> >            Sandra   1/1/2003     Xyz
> >
> >
> >
> > As shown, the [key] field in Index_2 has repeated value that _points_ to
> > the
> > [key] values in Index_1. How do I make a query for the following:
> >
> >
> >
> > Find out all documents in Index_2:
> >
> > - [who] is in range of 'David' to 'Guess' and
> >
> > - [accessed] in range '1/1/1900' to '1/1/2010' and
> >
> > - [key] associated [content] in Index_1 that contains the term 'blah'
> >
> >
> >
> > I know this is more SQL like query. Is Lucene capable of doing this type
> > of
> > query that needs associations among index files?
> >
> >
> >
> > Thanks in advance.
> >
> >
> >
> > - m
> >
> >
> >
> >
> >
> >
> >
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33954-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 04:12:04 2008
Return-Path: <java-user-return-33954-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97374 invoked from network); 7 May 2008 04:12:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 04:12:04 -0000
Received: (qmail 28515 invoked by uid 500); 7 May 2008 04:11:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28486 invoked by uid 500); 7 May 2008 04:11:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28475 invoked by uid 99); 7 May 2008 04:11:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 21:11:58 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of crspan@gmail.com designates 66.249.82.239 as permitted sender)
Received: from [66.249.82.239] (HELO wx-out-0506.google.com) (66.249.82.239)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 04:11:12 +0000
Received: by wx-out-0506.google.com with SMTP id h29so127277wxd.20
        for <java-user@lucene.apache.org>; Tue, 06 May 2008 21:11:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:cc:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=oybe5VxK+6gpI5Vr/wGMZ5u59tP5IsY4swegbukMaQI=;
        b=NrGJ+gzF9EAZibD63KyPNI5yb6tuO+XaKhV7TTsM0o4kaBxYLY2g+V94T3WO7iXIhQLWEqrqXqsiTd27CpEFnIlI4SGzjXArp0f40IyLQfXfu6qvUwcHzbh+b6+BzUQviNYrA7pL5hz1im1oip2uO/g8vly48K9yiRpn3wHCW0Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:cc:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=tzAVdtE/+TcMzNmLGy0DynXa+h/opNcymH7/k9AVhKoIPi6koavSFsv0hX/wS1pATL3rAU6xrdVd1/UH1eGSTx0ukM51vEoNLA9nQl0aZYZ2Bv4+dm6IvUu5kVdKwfOBv9k0wErUct1sTofGfGaooFxi957EaPbVVzicEj2rU6k=
Received: by 10.90.82.8 with SMTP id f8mr2305619agb.2.1210133486992;
        Tue, 06 May 2008 21:11:26 -0700 (PDT)
Received: from ?192.168.168.3? ( [72.179.149.134])
        by mx.google.com with ESMTPS id s30sm3432760elf.16.2008.05.06.21.11.25
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 06 May 2008 21:11:26 -0700 (PDT)
Message-ID: <48212BEB.50801@gmail.com>
Date: Tue, 06 May 2008 23:11:23 -0500
From: crspan <crspan@gmail.com>
User-Agent: Thunderbird 2.0.0.12 (Windows/20080213)
MIME-Version: 1.0
To: Michael McCandless <lucene@mikemccandless.com>
CC: java-user@lucene.apache.org
Subject: Re: Are those runtime errors about the jdk, or lucene's jar, or my
 code?
References: <48209D62.2000103@gmail.com> <D0DBD255-D484-481B-88E1-A4D8BF5BE038@mikemccandless.com>
In-Reply-To: <D0DBD255-D484-481B-88E1-A4D8BF5BE038@mikemccandless.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks so much, Mike. Those runtime errors were caused by one corrupted 
index, somehow corrupted during scp. It has Nothing to do with lucene 2.3.2.

For those who come by this thread:
    
    Please "CheckIndex"

That would saved me many hours of fruitless debugging.

Cheers,
Charlie


Michael McCandless wrote:
>
> Hi,
>
> Could you run org.apache.lucene.index.CheckIndex on your index and 
> post the result?
>
> Are these exceptions easily reproduced starting from scratch (new index)? 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33955-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 06:55:12 2008
Return-Path: <java-user-return-33955-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91634 invoked from network); 7 May 2008 06:55:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 06:55:11 -0000
Received: (qmail 52036 invoked by uid 500); 7 May 2008 06:55:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51030 invoked by uid 500); 7 May 2008 06:55:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51019 invoked by uid 99); 7 May 2008 06:55:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 May 2008 23:55:05 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 06:54:18 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JtdXs-0000YE-0V
	for java-user@lucene.apache.org; Tue, 06 May 2008 23:54:32 -0700
Message-ID: <17098552.post@talk.nabble.com>
Date: Tue, 6 May 2008 23:54:32 -0700 (PDT)
From: Vizzini <paolo.vizzini@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: lucene farsi problem
In-Reply-To: <16977096.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: paolo.vizzini@gmail.com
References: <16977096.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Sorry for cross posting, but why the word 'Farsi' instead of 'Persian'?  No
one says Lucnce fran=C3=A7ais or Espa=C3=B1ol, or Deutsch - so why Farsi?

Please read the following article, I found it quite enlightening.=20
http://www.cais-soas.com/CAIS/Languages/persian_not_farsi.htm

PV

--=20
View this message in context: http://www.nabble.com/lucene-farsi-problem-tp=
16977096p17098552.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33956-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 07:34:58 2008
Return-Path: <java-user-return-33956-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4729 invoked from network); 7 May 2008 07:34:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 07:34:58 -0000
Received: (qmail 95292 invoked by uid 500); 7 May 2008 07:34:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95262 invoked by uid 500); 7 May 2008 07:34:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95251 invoked by uid 99); 7 May 2008 07:34:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 00:34:51 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.30] (HELO smtp-vbr10.xs4all.nl) (194.109.24.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 07:33:58 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr10.xs4all.nl (8.13.8/8.13.8) with ESMTP id m477YJQj076517
	for <java-user@lucene.apache.org>; Wed, 7 May 2008 09:34:20 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Filtering a SpanQuery
Date: Wed, 7 May 2008 09:34:19 +0200
User-Agent: KMail/1.9.9
References: <74f928500805060115k6c6373bdib50b0e1ec88ecbbc@mail.gmail.com> <200805061739.38357.paul.elschot@xs4all.nl>
In-Reply-To: <200805061739.38357.paul.elschot@xs4all.nl>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805070934.19544.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Op Tuesday 06 May 2008 17:39:38 schreef Paul Elschot:
> Eran,
>
> Op Tuesday 06 May 2008 10:15:10 schreef Eran Sevi:
> > Hi,
> >
> > I am looking for a way to filter a SpanQuery according to some
> > other query (on another field from the one used for the SpanQuery).
> > I need to get access to the spans themselves of course.
> >  I don't care about the scoring of the filter results and just need
> > the positions of hits found in the documents that matches the
> > filter.
>
> I think you'll have to implement the filtering on the Spans yourself.
> That's not really difficult, just use Spans.skipTo().
> The code to do that could look sth like this (untested):
>
> Spans spans = yourSpanQuery.getSpans(reader);
> BitSet bits = yourFilter.bits(reader);
> int filterDoc = bits.nextSetBit(0);
> while ((filterDoc >= 0) and spans.skipTo(filterDoc)) {
>   boolean more = true;
>   while (more and (spans.doc() == filterDoc)) {
>      // use spans.start() and spans.end() here
>      // ...
>      more = spans.next();
>   }
>   if (! more) {
>     break;
>   }
>   filterDoc = bits.nextSetBit(spans.doc());

At this point, no skipping on the spans should be done when filterDoc 
equals spans.doc(), so this code still needs some work.
But I think you get the idea.

Regards,
Paul Elschot


> }
>
> Please check the javadocs of java.util.BitSet, there may
> be a 1 off error in the arguments to nextSetBit().
>
> Regards,
> Paul Elschot
>
> > I tried looking through the archives and found some reference to a
> > SpanQueryFilter patch, however I don't see how it can help me
> > achieve what I want to do. This class receives only one query
> > parameter (which I guess is the actual query) and not a query and a
> > filter for example.
> >
> > Any help about how I can achieve this will be appreciated.
> >
> > Thanks,
> > Eran.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33957-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 08:19:16 2008
Return-Path: <java-user-return-33957-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22912 invoked from network); 7 May 2008 08:19:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 08:19:15 -0000
Received: (qmail 54346 invoked by uid 500); 7 May 2008 08:19:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54319 invoked by uid 500); 7 May 2008 08:19:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54308 invoked by uid 99); 7 May 2008 08:19:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 01:19:09 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of eransevi@gmail.com designates 209.85.200.172 as permitted sender)
Received: from [209.85.200.172] (HELO wf-out-1314.google.com) (209.85.200.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 08:18:24 +0000
Received: by wf-out-1314.google.com with SMTP id 28so173303wfc.20
        for <java-user@lucene.apache.org>; Wed, 07 May 2008 01:18:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=HkShJ2Rt+Vbk+rkemkdmVmcUkoj+qjUdxIsnMPdtdnw=;
        b=nKeysIczNZfI1Xy0hplJxjR4xgCGG3x4JqKmc0UlcpJ7rJW1q/bm2B7uI6gMaNZZ3uqUs6VXVDfLM5j78yxSInhlNkd4QFIfNUbBRyNnNUjpJvFgeRu3XM6IIFmjvzhtJdc8hCMeXemUovnhQ6SRsmeJXHi5ErjeP4O5jcXc+gQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=bfQVrGDc/Fzh32+0CaRbMw5fKwfsWfYweLBLnE8yx1YOCY9I+zeT84aXKZIkB+/20g882Cw5mtBpwrpXbHMrR/dPj4/QJB21WoTmnz4h7Jnk240s/YvySP9C/j99TsT86rXPOjVlM8Pjy93nuugQ/MoUu5NKB8d1sNc2icHhwRg=
Received: by 10.142.53.9 with SMTP id b9mr739538wfa.250.1210148318997;
        Wed, 07 May 2008 01:18:38 -0700 (PDT)
Received: by 10.142.191.18 with HTTP; Wed, 7 May 2008 01:18:38 -0700 (PDT)
Message-ID: <74f928500805070118l2adddae7g13db7c6e0180b4ab@mail.gmail.com>
Date: Wed, 7 May 2008 11:18:38 +0300
From: "Eran Sevi" <eransevi@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Filtering a SpanQuery
In-Reply-To: <200805070934.19544.paul.elschot@xs4all.nl>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_35209_6484346.1210148318982"
References: <74f928500805060115k6c6373bdib50b0e1ec88ecbbc@mail.gmail.com>
	 <200805061739.38357.paul.elschot@xs4all.nl>
	 <200805070934.19544.paul.elschot@xs4all.nl>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_35209_6484346.1210148318982
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Thanks Paul for your reply,

Since my index contains a couple of millions documents and the filter is
supposed to limit the search space to a few thousands I was hoping I won't
have to do the filtering myself after running the query on all the index.

Maybe this is the case anyway and behind the scenes the filter does exactly
what you suggested.

>From what I tested the number of results of the SpanQuery greatly affects
the running speed so if I'm going to use about 0.1% of the results I'm
loosing a lot of time and memory for gathering and storing the spans I'm not
going to use.

I don't know how SpanQuery works internally but I guess that if the filter
is known beforehand, it could speed things up quite a bit.

Eran.


On Wed, May 7, 2008 at 10:34 AM, Paul Elschot <paul.elschot@xs4all.nl>
wrote:

> Op Tuesday 06 May 2008 17:39:38 schreef Paul Elschot:
> > Eran,
> >
> > Op Tuesday 06 May 2008 10:15:10 schreef Eran Sevi:
> > > Hi,
> > >
> > > I am looking for a way to filter a SpanQuery according to some
> > > other query (on another field from the one used for the SpanQuery).
> > > I need to get access to the spans themselves of course.
> > >  I don't care about the scoring of the filter results and just need
> > > the positions of hits found in the documents that matches the
> > > filter.
> >
> > I think you'll have to implement the filtering on the Spans yourself.
> > That's not really difficult, just use Spans.skipTo().
> > The code to do that could look sth like this (untested):
> >
> > Spans spans = yourSpanQuery.getSpans(reader);
> > BitSet bits = yourFilter.bits(reader);
> > int filterDoc = bits.nextSetBit(0);
> > while ((filterDoc >= 0) and spans.skipTo(filterDoc)) {
> >   boolean more = true;
> >   while (more and (spans.doc() == filterDoc)) {
> >      // use spans.start() and spans.end() here
> >      // ...
> >      more = spans.next();
> >   }
> >   if (! more) {
> >     break;
> >   }
> >   filterDoc = bits.nextSetBit(spans.doc());
>
> At this point, no skipping on the spans should be done when filterDoc
> equals spans.doc(), so this code still needs some work.
> But I think you get the idea.
>
> Regards,
> Paul Elschot
>
>
> > }
> >
> > Please check the javadocs of java.util.BitSet, there may
> > be a 1 off error in the arguments to nextSetBit().
> >
> > Regards,
> > Paul Elschot
> >
> > > I tried looking through the archives and found some reference to a
> > > SpanQueryFilter patch, however I don't see how it can help me
> > > achieve what I want to do. This class receives only one query
> > > parameter (which I guess is the actual query) and not a query and a
> > > filter for example.
> > >
> > > Any help about how I can achieve this will be appreciated.
> > >
> > > Thanks,
> > > Eran.
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_35209_6484346.1210148318982--

From java-user-return-33958-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 09:00:22 2008
Return-Path: <java-user-return-33958-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42052 invoked from network); 7 May 2008 09:00:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 09:00:19 -0000
Received: (qmail 7270 invoked by uid 500); 7 May 2008 09:00:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6951 invoked by uid 500); 7 May 2008 09:00:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6940 invoked by uid 99); 7 May 2008 09:00:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 02:00:13 -0700
X-ASF-Spam-Status: No, hits=1.5 required=10.0
	tests=SPF_NEUTRAL,URIBL_GREY
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.233.178.240] (HELO hs-out-0708.google.com) (64.233.178.240)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 08:59:24 +0000
Received: by hs-out-0708.google.com with SMTP id 4so151586hsl.5
        for <java-user@lucene.apache.org>; Wed, 07 May 2008 01:59:37 -0700 (PDT)
Received: by 10.90.80.18 with SMTP id d18mr2634307agb.52.1210150776911;
        Wed, 07 May 2008 01:59:36 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 5sm2012884agc.27.2008.05.07.01.59.36
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 07 May 2008 01:59:36 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com>
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com> <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com> <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: Help to solve an issue when upgrading Lucene-Oracle integration to lucene 2.3.1
Date: Wed, 7 May 2008 05:00:26 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Is there any way to capture & serialize the actual documents being
added (this way I can "replay" those docs to reproduce it)?

Are you using threads?  Is autoCommit true or false?

Are you using payloads?

Were there any previous exceptions in this IndexWriter before flushing
this segment?  Could you post the full infoStream output?

The computation of bufferUpto is entirely in memory (not using a
previous segment).  When a posting list is first created (new term is
first encountered), it allocates an initial slice of 5 bytes.  The
slice address, a single int, encodes the byte[] buffer index and the
offset into that buffer as bufferIndex*32768 + bufferOffset.

Then, if that first slice fills up, a larger slice is allocated and
the "forwarding address" of that larger slice is left in the last 4
bytes of the previous slice.

Then, when reading the byte stream, during appendPostings, this
process is reversed so as to write the single contiguous byte stream
into the real segment's postings frq/prx files.  Somehow, during this
reading step, you are hitting an out of bounds forwarding address
when switching to the next slice.

Could you apply the patch below & re-run?  It will likely produce
insane amounts of output, but we only need the last section to see
which term is hitting the bug.  If that term consistently hits the bug
then we can focus on how/when it gets indexed...

Mike

Index: src/java/org/apache/lucene/index/DocumentsWriter.java
===================================================================
--- src/java/org/apache/lucene/index/DocumentsWriter.java	(revision  
638310)
+++ src/java/org/apache/lucene/index/DocumentsWriter.java	(working copy)
@@ -1763,6 +1763,7 @@
              writeProxVInt((proxCode<<1)|1);
              writeProxVInt(payload.length);
              writeProxBytes(payload.data, payload.offset,  
payload.length);
+            // nocommit -- not sync!!
              fieldInfo.storePayloads = true;
            } else
              writeProxVInt(proxCode<<1);
@@ -2216,6 +2217,8 @@
        while(text[pos] != 0xffff)
          pos++;

+      System.out.println("term=" + new String(text, start, pos- 
start) + " numToMerge=" + numToMerge);
+
        long freqPointer = freqOut.getFilePointer();
        long proxPointer = proxOut.getFilePointer();

@@ -2239,6 +2242,8 @@
          final int doc = minState.docID;
          final int termDocFreq = minState.termFreq;

+        System.out.println("  doc=" + doc + " freq=" + termDocFreq);
+
          assert doc < numDocsInRAM;
          assert doc > lastDoc || df == 1;

@@ -2251,14 +2256,18 @@
          // changing the format to match Lucene's segment
          // format.
          for(int j=0;j<termDocFreq;j++) {
+          System.out.println("    pos=" + j);
            final int code = prox.readVInt();
+          System.out.println("      code=" + code);
            if (currentFieldStorePayloads) {
+            System.out.println("      payload");
              final int payloadLength;
              if ((code & 1) != 0) {
                // This position has a payload
                payloadLength = prox.readVInt();
              } else
                payloadLength = 0;
+            System.out.println("      pl=" + payloadLength);
              if (payloadLength != lastPayloadLength) {
                proxOut.writeVInt(code|1);
                proxOut.writeVInt(payloadLength);

Marcelo Ochoa wrote:
> Hi Mike:
>   Well the problem is consitently, but to test the code and the
> project its necesary an Oracle 11g database :(
>   I don't know why the computation of bufferUpto variable is wrong in
> the last step, during all other calls pool.buffers.length is
> consitently to 366 so I asume that its OK. And the value 8192 for
> byfferUpto is suspicious because seem a bit shift or overrun.
>   How bufferUpto variable is computed?
>   Using some segment info alredy writed into the disk, or is in memory
> at this point?
>   I am still investigating the problem by adding more debugging  
> information.
>   Best regards, Marcelo.
> On Tue, May 6, 2008 at 7:00 PM, Michael McCandless
> <lucene@mikemccandless.com> wrote:
>>
>>  Hi Marcelo,
>>
>>  Hmmm something is not right.
>>
>>  Somehow the byte slices, which DocumentsWriter uses to hold the  
>> postings in
>> RAM, became corrupt.
>>
>>  Is this easily reproduced?
>>
>>  Mike
>>
>>  Marcelo Ochoa wrote:
>>
>>>
>>>
>>>
>>> Hi Lucene experts:
>>>  I am working upgrading Lucene-Oracle integration project to latest
>>> Lucene 2.3.1 code.
>>>  After correcting a minor issue on OJVMDirectory file  
>>> implementation I
>>> have the integration running with latest 2.3.1 code.
>>>  But it only works with small indexes, I think index which are lower
>>> than the Memory threshold.
>>>  If I performs an index in a big table, I got this exception:
>>>  Exception in thread "Root Thread"
>> java.lang.ArrayIndexOutOfBoundsException
>>>        at
>> org.apache.lucene.index.DocumentsWriter$ByteSliceReader.nextSlice 
>> (DocumentsWriter.java)
>>>        at
>> org.apache.lucene.index.DocumentsWriter$ByteSliceReader.readByte 
>> (DocumentsWriter.java)
>>>        at org.apache.lucene.store.IndexInput.readVInt 
>>> (IndexInput.java)
>>>        at
>> org.apache.lucene.index.DocumentsWriter.appendPostings 
>> (DocumentsWriter.java)
>>>        at
>> org.apache.lucene.index.DocumentsWriter.writeSegment 
>> (DocumentsWriter.java:2011)
>>>        at
>> org.apache.lucene.index.DocumentsWriter.flush(DocumentsWriter.java: 
>> 548)
>>>        at
>> org.apache.lucene.index.IndexWriter.doFlush(IndexWriter.java:2497)
>>>        at org.apache.lucene.index.IndexWriter.flush 
>>> (IndexWriter.java:2397)
>>>        at
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
>>>        at
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
>>>        at org.apache.lucene.indexer.TableIndexer.index 
>>> (TableIndexer.java)
>>>        at
>> org.apache.lucene.indexer.LuceneDomainIndex.ODCIIndexCreate 
>> (LuceneDomainIndex.java:477)
>>>
>>>  Something is wrong at nextSlice method :(
>>>  I added some System.out info and, before the exception is thrown,
>>> index and arrays have this information:
>>>
>>> .nextSlice (previous)
>>> limit: 11393 buffer.length: 32768
>>> level: 0 nextLevelArray.length: 10
>>> bufferUpto: 147 pool.buffers.length: 366
>>> .nextSlice (current)
>>> limit: 6189 buffer.length: 32768
>>> level: 0 nextLevelArray.length: 10
>>> bufferUpto: 8192 pool.buffers.length: 366
>>>
>>>   As you can see bufferUpto variable have 8192 value and  
>>> pool.buffers
>>> is an array of 366 elements, this cause the exception  nextSlice()
>>> method is:
>>>    public void nextSlice() {
>>>
>>>      // Skip to our next slice
>>>      System.out.println(".nextSlice");
>>>      System.out.println("limit: "+limit+" buffer.length:  
>>> "+buffer.length);
>>>      final int nextIndex = ((buffer[limit]&0xff)<<24) +
>>> ((buffer[1+limit]&0xff)<<16) + ((buffer[2+limit]&0xff)<<8) +
>>> (buffer[3+limit]&0xff);
>>>
>>>      System.out.println("level: "+level+" nextLevelArray.length:
>>> "+nextLevelArray.length);
>>>      level = nextLevelArray[level];
>>>      final int newSize = levelSizeArray[level];
>>>
>>>      bufferUpto = nextIndex / BYTE_BLOCK_SIZE;
>>>      bufferOffset = bufferUpto * BYTE_BLOCK_SIZE;
>>>
>>>      System.out.println("bufferUpto: "+bufferUpto+"
>>> pool.buffers.length: "+pool.buffers.length);
>>>      buffer = pool.buffers[bufferUpto];
>>>      upto = nextIndex & BYTE_BLOCK_MASK;
>>>
>>>      if (nextIndex + newSize >= endIndex) {
>>>        // We are advancing to the final slice
>>>        assert endIndex - nextIndex > 0;
>>>        limit = endIndex - bufferOffset;
>>>      } else {
>>>        // This is not the final slice (subtract 4 for the
>>>        // forwarding address at the end of this new slice)
>>>        limit = upto+newSize-4;
>>>      }
>>>    }
>>>
>>>    IndexWriter InfoStream information is:
>>>  RAM: now flush @ usedMB=53.016 allocMB=53.016 triggerMB=53
>>> IW 0 [Root Thread]:   flush: segment=_0 docStoreSegment=_0
>>> docStoreOffset=0 flushDocs=true flushDeletes=false
>>> flushDocStores=false numDocs=85
>>> 564 numBufDelTerms=0
>>> IW 0 [Root Thread]:   index before flush
>>> flush postings as segment _0 numDocs=85564
>>> ..... nextSlice output here.....
>>> docWriter: now abort
>>> IW 1 [Root Thread]: hit exception flushing segment _0
>>> docWriter: now abort
>>> IFD [Root Thread]: now checkpoint "segments_1" [0 segments ;  
>>> isCommit =
>> false]
>>> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
>>> unreferenced file "_0.tii"
>>> IFD [Root Thread]: delete "_0.tii"
>>> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
>>> unreferenced file "_0.fdx"
>>> IFD [Root Thread]: delete "_0.fdx"
>>> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
>>> unreferenced file "_0.fnm"
>>> IFD [Root Thread]: delete "_0.fnm"
>>> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
>>> unreferenced file "_0.fdt"
>>> IFD [Root Thread]: delete "_0.fdt"
>>> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
>>> unreferenced file "_0.prx"
>>> IFD [Root Thread]: delete "_0.prx"
>>> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
>>> unreferenced file "_0.frq"
>>> IFD [Root Thread]: delete "_0.frq"
>>> IFD [Root Thread]: refresh [prefix=_0]: removing newly created
>>> unreferenced file "_0.tis"
>>> IFD [Root Thread]: delete "_0.tis"
>>> IW 1 [Root Thread]: now flush at close
>>> IW 1 [Root Thread]:   flush: segment=null docStoreSegment=null
>>> docStoreOffset=0 flushDocs=false flushDeletes=false
>>> flushDocStores=false numDocs=0 numBufDelTerms=0
>>> IW 1 [Root Thread]:   index before flush
>>> IW 1 [Root Thread]: close: wrote segments file "segments_2"
>>> IFD [Root Thread]: now checkpoint "segments_2" [0 segments ;  
>>> isCommit =
>> true]
>>> IFD [Root Thread]: deleteCommits: now remove commit "segments_1"
>>> IFD [Root Thread]: delete "segments_1"
>>> IW 1 [Root Thread]: at close:
>>> Exception in thread "Root Thread"  
>>> java.lang.ArrayIndexOutOfBoundsException
>>>        at
>> org.apache.lucene.index.DocumentsWriter$ByteSliceReader.nextSlice 
>> (DocumentsWriter.java)
>>>        at
>> org.apache.lucene.index.DocumentsWriter$ByteSliceReader.readByte 
>> (DocumentsWriter.java)
>>>        at org.apache.lucene.store.IndexInput.readVInt 
>>> (IndexInput.java)
>>>        at
>> org.apache.lucene.index.DocumentsWriter.appendPostings 
>> (DocumentsWriter.java)
>>>        at
>> org.apache.lucene.index.DocumentsWriter.writeSegment 
>> (DocumentsWriter.java:2011)
>>>        at
>> org.apache.lucene.index.DocumentsWriter.flush(DocumentsWriter.java: 
>> 548)
>>>        at
>> org.apache.lucene.index.IndexWriter.doFlush(IndexWriter.java:2497)
>>>        at org.apache.lucene.index.IndexWriter.flush 
>>> (IndexWriter.java:2397)
>>>        at
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
>>>        at
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java)
>>>        at org.apache.lucene.indexer.TableIndexer.index 
>>> (TableIndexer.java)
>>>        at
>> org.apache.lucene.indexer.LuceneDomainIndex.ODCIIndexCreate 
>> (LuceneDomainIndex.java:477)
>>>
>>>  Any help to find the incompatibility issue will be great.
>>>  Best regards, Marcelo.
>>>
>>> PD: If anybody needs the complete log I can send it my email.
>>> --
>>> Marcelo F. Ochoa
>>> http://marceloochoa.blogspot.com/
>>> http://marcelo.ochoa.googlepages.com/home
>>> ______________
>>> Do you Know DBPrism? Look @ DB Prism's Web Site
>>> http://www.dbprism.com.ar/index.html
>>> More info?
>>> Chapter 17 of the book "Programming the Oracle Database using Java &
>>> Web Services"
>>> http://www.amazon.com/gp/product/1555583296/
>>> Chapter 21 of the book "Professional XML Databases" - Wrox Press
>>> http://www.amazon.com/gp/product/1861003587/
>>> Chapter 8 of the book "Oracle & Open Source" - O'Reilly
>>> http://www.oreilly.com/catalog/oracleopen/
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>>   
>> ---------------------------------------------------------------------
>>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>  For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> -- 
> Marcelo F. Ochoa
> http://marceloochoa.blogspot.com/
> http://marcelo.ochoa.googlepages.com/home
> ______________
> Do you Know DBPrism? Look @ DB Prism's Web Site
> http://www.dbprism.com.ar/index.html
> More info?
> Chapter 17 of the book "Programming the Oracle Database using Java &
> Web Services"
> http://www.amazon.com/gp/product/1555583296/
> Chapter 21 of the book "Professional XML Databases" - Wrox Press
> http://www.amazon.com/gp/product/1861003587/
> Chapter 8 of the book "Oracle & Open Source" - O'Reilly
> http://www.oreilly.com/catalog/oracleopen/
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33959-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 09:03:13 2008
Return-Path: <java-user-return-33959-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43785 invoked from network); 7 May 2008 09:03:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 09:03:13 -0000
Received: (qmail 13537 invoked by uid 500); 7 May 2008 09:03:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13511 invoked by uid 500); 7 May 2008 09:03:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13500 invoked by uid 99); 7 May 2008 09:03:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 02:03:07 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [64.233.178.250] (HELO hs-out-0708.google.com) (64.233.178.250)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 09:02:14 +0000
Received: by hs-out-0708.google.com with SMTP id 4so152262hsl.5
        for <java-user@lucene.apache.org>; Wed, 07 May 2008 02:02:33 -0700 (PDT)
Received: by 10.90.50.5 with SMTP id x5mr2626577agx.70.1210150953149;
        Wed, 07 May 2008 02:02:33 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 8sm1727728hsp.4.2008.05.07.02.02.32
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 07 May 2008 02:02:32 -0700 (PDT)
In-Reply-To: <48212BEB.50801@gmail.com>
References: <48209D62.2000103@gmail.com> <D0DBD255-D484-481B-88E1-A4D8BF5BE038@mikemccandless.com> <48212BEB.50801@gmail.com>
Mime-Version: 1.0 (Apple Message framework v753)
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <11EFE28B-E740-4D51-A6E5-DDFAE3B47188@mikemccandless.com>
Cc: java-user@lucene.apache.org
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: Are those runtime errors about the jdk, or lucene's jar, or my code?
Date: Wed, 7 May 2008 05:03:22 -0400
To: crspan <crspan@gmail.com>
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


OK, phew.  Thanks for bringing closure here.

You mean you ran CheckIndex on the original index (input to scp) and  
it was fine, but CheckIndex on the copy produced by scp showed the  
corruption?

I think it's unusual for scp to corrupt the copy unless something  
catastrophic happens (eg disk full, disk is bad, RAM is bad, etc.).

Mike

crspan wrote:
> Thanks so much, Mike. Those runtime errors were caused by one  
> corrupted index, somehow corrupted during scp. It has Nothing to do  
> with lucene 2.3.2.
>
> For those who come by this thread:
>       Please "CheckIndex"
>
> That would saved me many hours of fruitless debugging.
>
> Cheers,
> Charlie
>
>
> Michael McCandless wrote:
>>
>> Hi,
>>
>> Could you run org.apache.lucene.index.CheckIndex on your index and  
>> post the result?
>>
>> Are these exceptions easily reproduced starting from scratch (new  
>> index)?
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33960-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 10:59:44 2008
Return-Path: <java-user-return-33960-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76761 invoked from network); 7 May 2008 10:59:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 10:59:44 -0000
Received: (qmail 49415 invoked by uid 500); 7 May 2008 10:59:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49383 invoked by uid 500); 7 May 2008 10:59:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49371 invoked by uid 99); 7 May 2008 10:59:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 03:59:33 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=SPF_PASS,URIBL_BLACK
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [216.75.55.147] (HELO stimulussoft.com) (216.75.55.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 10:58:45 +0000
Received: (qmail 2702 invoked by uid 511); 7 May 2008 03:58:57 -0700
Received: from 196.35.71.95 by live.stimulussoft.com (envelope-from <jamie@stimulussoft.com>, uid 509) with qmail-scanner-1.25-st-qms 
 (spamassassin: 3.2.3. perlscan: 1.25-st-qms.  
 Clear:RC:0(196.35.71.95):SA:0(-0.9/5.0):. 
 Processed in 3.493083 secs); 07 May 2008 10:58:57 -0000
X-Antivirus-MYDOMAIN-Mail-From: jamie@stimulussoft.com via live.stimulussoft.com
X-Antivirus-MYDOMAIN: 1.25-st-qms (Clear:RC:0(196.35.71.95):SA:0(-0.9/5.0):. Processed in 3.493083 secs Process 2691)
Received: from schenker-fw-bry-master.onsite.hosting.co.za (HELO ?10.206.0.8?) (jamie@stimulussoft.com@196.35.71.95)
  by stimulussoft.com with SMTP; 7 May 2008 03:58:54 -0700
Message-ID: <48218C59.2030100@stimulussoft.com>
Date: Wed, 07 May 2008 13:02:49 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Serious Index Corruption Error - FileNotFoundException 
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com> <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com> <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com> <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com>
In-Reply-To: <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com>
Content-Type: multipart/mixed;
 boundary="------------010008030004010205030108"
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-0.9 required=5.0

--------------010008030004010205030108
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hi there

It appears my Lucene 2.3.1 index is corrupted. I get the following error 
when searching:

/mnt/indexnew/_3wk0.cfs (No such file or directory)
java.io.FileNotFoundException: /mnt/indexnew/_3wk0.cfs (No such file or 
directory)
        at java.io.RandomAccessFile.open(Native Method)
        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
        at 
org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:506)
        at 
org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:536)
        at 
org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:445)
        at 
org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70)
        at 
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:277)
        at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:262)
        at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:197)
        at 
org.apache.lucene.index.MultiSegmentReader.<init>(MultiSegmentReader.java:55)
        at 
org.apache.lucene.index.DirectoryIndexReader$1.doBody(DirectoryIndexReader.java:75)
        at 
org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:636)
        at 
org.apache.lucene.index.DirectoryIndexReader.open(DirectoryIndexReader.java:63)
        at org.apache.lucene.index.IndexReader.open(IndexReader.java:209)
        at org.apache.lucene.index.IndexReader.open(IndexReader.java:173)
        at 
org.apache.lucene.search.IndexSearcher.<init>(IndexSearcher.java:48)
        at

Question #1: How can I recover from this error without regenerating the 
entire index?

Is there a utility I could use?

Question #2: What is the reason why I am missing a segument cfs file?

Could it be a problem with the synchronization of threads during 
Indexing (see attached code)?
Could it be a bug in MailArchiva?
I have tried to implement locks in appropriate places.
java.io.FileNotFoundException: /mnt/indexnew/_3wk0.cfs (No such file or 
directory)

Any help would be much appreciated!

Jamie


--------------010008030004010205030108
Content-Type: text/plain;
 name="MessageIndex.java"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="MessageIndex.java"

package com.stimulus.archiva.index;

/* Copyright (C) 2005-2007 Jamie Angus Band 
 * MailArchiva Open Source Edition Copyright (c) 2005-2007 Jamie Angus Band
 * This program is free software; you can redistribute it and/or modify it under the terms of
 * the GNU General Public License as published by the Free Software Foundation; either version
 * 2 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program;
 * if not, see http://www.gnu.org/licenses or write to the Free Software Foundation,Inc., 51
 * Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA
 */


import javax.mail.*;
import javax.mail.internet.*;
import java.io.*;
import java.util.*;
import java.util.zip.*;
import com.ice.tar.*;
import org.apache.log4j.Logger;
import org.apache.lucene.document.*;
import org.apache.lucene.index.*;
import org.apache.lucene.store.*;
import com.stimulus.archiva.domain.*;
import com.stimulus.archiva.exception.*;
import com.stimulus.archiva.language.*;
import com.stimulus.archiva.extraction.*;
import com.stimulus.archiva.search.*;
import com.stimulus.util.TempFiles;
import com.stimulus.archiva.domain.fields.*;
import com.stimulus.util.*;
import java.nio.charset.Charset;
import org.apache.log4j.Level;

public class MessageIndex extends Indexer implements Serializable {
	
	  
	  private static final long serialVersionUID = -17692874371162272L;
	  protected static final Logger logger = Logger.getLogger(MessageIndex.class.getName());
	  protected static int INDEX_WAIT_PERIOD = 50;
	  protected static int DEAD_PERIOD = 300000000;
	  protected boolean shutdown = false;
	  static Hashtable<Volume,VolumeIndex> volumeIndexes = new Hashtable<Volume,VolumeIndex>();
	  static Object volumeIndexLock = new Object();
 
    public MessageIndex() {
	  
    }
 

	public void deleteIndex(Volume volume) throws MessageSearchException {
		  VolumeIndex volumeIndex = getVolumeIndex(volume);
		  volumeIndex.deleteIndex();
	}
		 
 	
	public VolumeIndex getVolumeIndex(Volume volume) {
		 VolumeIndex volumeIndex = null;
		  synchronized (volumeIndexLock) {
			  volumeIndex = volumeIndexes.get(volume);
			  if (volumeIndex==null) {
				  volumeIndex = new VolumeIndex(this,volume);
				  volumeIndexes.put(volume,volumeIndex);
			  }
		  }
		  return volumeIndex;
	}
	  	
	public void indexMessage(Email email) throws MessageSearchException {
		  VolumeIndex volumeIndex = getVolumeIndex(email.getEmailId().getVolume());
		  volumeIndex.indexMessage(email);
	}
		
		
		  // Enterprise version
	  
	public void deleteMessage(EmailID emailID) throws MessageSearchException {
		  if (emailID == null)
	            throw new MessageSearchException("assertion failure: null emailID",logger);
	  logger.debug("delete message {'"+emailID+"'}");
	  Volume volume = emailID.getVolume();
	  File indexDir = new File(volume.getIndexPath());
	  if (!indexDir.exists())
		  throw new MessageSearchException("could not delete email from index. volume does not exist. {'"+emailID+"}",logger);
	  IndexReader indexReader = null;
	  try {
		  indexReader = IndexReader.open(indexDir);
	  } catch (IOException e ) {
		  throw new MessageSearchException("failed to open index to delete email",e,logger);
	  }
	  try {
		  indexReader.deleteDocuments(new Term("uid",emailID.getUniqueID()));
		  indexReader.close();
	  } catch (Exception e) {
		  throw new MessageSearchException("failed to delete email from index.",e,logger);
	  }
	}
	  
	public void prepareIndex(Volume volume) throws MessageSearchException {
			
		  if (volume==null)
		            throw new MessageSearchException("assertion failure: null volume",logger);
	
	  if (volume.getIndexPath().startsWith("rmi://"))
			  return;
			  
	  File indexDir = new File(volume.getIndexPath());
	  if (!indexDir.exists()) {
		logger.info("index directory does not exist. will proceed with creation {location='" + volume.getIndexPath() + "'}");
		boolean success = indexDir.mkdir();
		if (!success)
				throw new MessageSearchException("failed to create index directory {location='" + volume.getIndexPath() + "'}",logger);
		logger.info("index directory successfully created {location='" + volume.getIndexPath() + "'}");
		  }
	
	}
	  
	protected void finalize() throws Throwable {
	    logger.debug("messagindex class is shutting down");
	    try {
	    	shutdown = true;
	    } finally {
		super.finalize();
	    }
	}

}

--------------010008030004010205030108
Content-Type: text/plain;
 name="VolumeIndex.java"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="VolumeIndex.java"

package com.stimulus.archiva.index;

import java.io.File;
import java.io.IOException;
import java.io.PrintStream;
import javax.mail.MessagingException;
import org.apache.log4j.Level;
import org.apache.log4j.Logger;
import org.apache.lucene.document.Document;
import org.apache.lucene.index.*;
import org.apache.lucene.store.FSDirectory;
import com.stimulus.archiva.domain.Config;
import com.stimulus.archiva.domain.Email;
import com.stimulus.archiva.domain.Indexer;
import com.stimulus.archiva.domain.Volume;
import com.stimulus.archiva.exception.ExtractionException;
import com.stimulus.archiva.exception.MessageSearchException;
import com.stimulus.archiva.language.AnalyzerFactory;
import com.stimulus.archiva.search.*;
import java.util.*;
import org.apache.lucene.store.AlreadyClosedException;

public class VolumeIndex {
	
		 protected static final Logger logger = Logger.getLogger(VolumeIndex.class.getName());
		 public static final int indexOpenTime = 2000;
	   	 IndexWriter writer = null;
	   	 Volume volume;
	   	 Timer closeIndexTimer = new Timer();
		 Object indexLock = new Object();
		
		 
		 ArchivaAnalyzer analyzer 	= new ArchivaAnalyzer();
		 Indexer indexer = null;
	  	  public VolumeIndex(Indexer indexer, Volume volume) {
	  		  	this.volume = volume;
	  		  	this.indexer = indexer;
		  		closeIndexTimer.scheduleAtFixedRate(new TimerTask() {
		            public void run() {
		             	closeIndex();
		            }
		        }, indexOpenTime, indexOpenTime);
	  	  }

		  protected void openIndex(boolean retry) throws MessageSearchException {
			 Exception lastError = null;
			 synchronized(indexLock) {
		    	if (writer==null) {
		    		logger.debug("openIndex() index will be opened. it is currently closed.");
		    	} else {
		    		logger.debug("openIndex() did not bother opening index. it is already open.");
		    		return; 
		    	}

				logger.debug("opening index for write {"+volume+"}");
				indexer.prepareIndex(volume);
				logger.debug("opening search index for write {indexpath='"+volume.getIndexPath()+"'}");
			
				try {
						writer = new IndexWriter(FSDirectory.getDirectory(volume.getIndexPath()),false, analyzer);
						writer.setMaxFieldLength(50000);
						if (logger.isDebugEnabled()) {
							File file = new File(Config.getFileSystem().getLogPath()+File.separator+"index.log");
							PrintStream debugout = new PrintStream(file);
							writer.setInfoStream(debugout);
						}
				} catch (IOException io) {
					lastError = io;
					if (!retry) {
						// most obvious reason for error is that there is a lock on the index, due hard shutdown
						    // resolution delete the lock, and try again
						    logger.warn("failed to open search index for write. possible write lock due to hard system shutdown.",io);
						    logger.info("attempting recovery. deleting index lock file and retrying..");
						    File lockFile = new File(volume.getIndexPath()+File.separatorChar + "write.lock");
						    lockFile.delete();
						    openIndex(true);
					} else {
						throw new MessageSearchException("failed to open/ index writer {location='"+volume.getIndexPath()+"'}",lastError,logger);
					}
				}
			}
		}
		
		public void indexMessage(Email message) throws MessageSearchException  {
      
			long s = (new Date()).getTime();
			if (message == null)
			    throw new MessageSearchException("assertion failure: null message",logger);
			logger.debug("indexing message {"+message+"}");
			
			Document doc = new Document();
			try {
			 
			   DocumentIndex docIndex = new DocumentIndex(indexer);
			   docIndex.write(message,doc);  
			   String language = doc.get("lang");
			   if (language==null)
				   language = indexer.getIndexLanguage();
		   		synchronized (indexLock) {
		   			openIndex(false);
		   			writer.addDocument(doc,AnalyzerFactory.getAnalyzer(language,AnalyzerFactory.Operation.INDEX));
		   		}
		   		doc = null;
			   logger.debug("message indexed successfully {"+message+",language='"+language+"'}");
			} catch (MessagingException me)
			{
			   throw new MessageSearchException("failed to decode message during indexing",me,logger, Level.DEBUG);
			} catch (IOException me) {
			    throw new MessageSearchException("failed to index message {"+message+"}",me,logger, Level.DEBUG);
			} catch (ExtractionException ee)
			{
				// we will want to continue indexing
			   //throw new MessageSearchException("failed to decode attachments in message {"+message+"}",ee,logger, Level.DEBUG);
			} catch (AlreadyClosedException ace) {
				indexMessage(message);
			} catch (Exception e) {
			    throw new MessageSearchException("failed to index message",e,logger, Level.DEBUG);
			}
			logger.debug("indexing message end {"+message+"}");
			
			long e = (new Date()).getTime();
		    logger.debug("indexing time {time='"+(e-s)+"'}");
		}
			
		protected void closeIndex() {
		
			   synchronized(indexLock) {
			        if (writer==null)
			        		return;
			        try {
			        	writer.close();
					    logger.debug("writer closed");
					} catch (Exception io) {
						logger.error("failed to close index writer:"+io.getMessage(),io);
	
					}
			        writer = null;
			   	}
	   	}
		 //	 deliberately non recursive (so we avoid situations where the whole h/d is deleted)
		  public void deleteIndex() throws MessageSearchException {
			  logger.debug("delete index {indexpath='"+volume.getIndexPath()+"'}");
			 
				try {
					  writer = new IndexWriter(FSDirectory.getDirectory(volume.getIndexPath()),false, analyzer,true);
				} catch (Exception cie) {
					 logger.error("failed to delete index {index='"+volume.getIndexPath()+"'}",cie);
					 File indexDir = new File(volume.getIndexPath());
             		 if (!indexDir.exists()) return;
             		 if (indexDir.isDirectory()) {
          	            String[] children = indexDir.list();
          	            for (int i=0; i<children.length; i++) {
          	                String filepath = volume.getIndexPath()+File.separatorChar+children[i];
          	                logger.debug("deleting file {path='" + filepath +"'}");
          	                File file = new File(filepath);
          	                boolean success = file.delete();
          	                if (!success) {
          	                	try {
          	                		File newFile = File.createTempFile("temp","idx");
          	                		file.renameTo(newFile);
          	                	} catch (Exception e2) {
          	                		throw new MessageSearchException("failed to delete file in existing index {filepath='"+filepath+"'}",logger);
          	                	}
          	                } else
                                   logger.debug("deleted file successfully {filepath='" + filepath +"'}");
          	            }
             		 }
             		 return;
				}
				try {
				  writer.close();
              	} catch (Exception e) {
              		logger.error("failed to delete index {index='"+volume.getIndexPath()+"'}",e);
              	}
             
              	MessageIndex.volumeIndexes.remove(this);
              

		  }
		
		protected void finalize() throws Throwable {
		    logger.debug("volumeindex class is shutting down");
		    try {
		    	closeIndexTimer.cancel();
		    	closeIndex();
		    } finally {
			super.finalize();
		    }
		}
		
}

	



--------------010008030004010205030108
Content-Type: text/plain; charset=us-ascii

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--------------010008030004010205030108--

From java-user-return-33961-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 11:56:37 2008
Return-Path: <java-user-return-33961-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5969 invoked from network); 7 May 2008 11:56:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 11:56:37 -0000
Received: (qmail 12201 invoked by uid 500); 7 May 2008 11:56:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12172 invoked by uid 500); 7 May 2008 11:56:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12161 invoked by uid 99); 7 May 2008 11:56:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 04:56:29 -0700
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=SPF_NEUTRAL,URIBL_BLACK
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.233.178.249] (HELO hs-out-0708.google.com) (64.233.178.249)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 11:55:41 +0000
Received: by hs-out-0708.google.com with SMTP id 4so188846hsl.5
        for <java-user@lucene.apache.org>; Wed, 07 May 2008 04:55:54 -0700 (PDT)
Received: by 10.90.84.2 with SMTP id h2mr2867511agb.30.1210161353502;
        Wed, 07 May 2008 04:55:53 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 23sm1849049hsd.10.2008.05.07.04.55.52
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 07 May 2008 04:55:53 -0700 (PDT)
In-Reply-To: <48218C59.2030100@stimulussoft.com>
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com> <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com> <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com> <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com> <48218C59.2030100@stimulussoft.com>
Mime-Version: 1.0 (Apple Message framework v753)
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <BCF0F18B-E6F8-4DEC-8B09-414C0202AD3B@mikemccandless.com>
Cc: Jamie <jamie@stimulussoft.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: Serious Index Corruption Error - FileNotFoundException
Date: Wed, 7 May 2008 07:56:43 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


On quickly looking through the code I think there are some serious  
hazards that could lead to this exception.

First, in your openIndex code, if you hit a LockObtainFailedException  
in trying to open your writer, you are forcefully removing the write  
lock and then retrying.  Yet, you also open an IndexReader to delete  
documents, which acquires the write lock.  If ever you have this  
IndexReader open, and then you forcefully remove the write lock and  
open the writer, that would cause this exception.

Second, you have a deletIndex method, which first tries to use the  
writer with create=true (good) but then falls back to manually  
removing the files.  Why is that fallback necessary?  If, for  
example, you are also hitting a LockObtainFailedException, then  
forcefully removing files while an IndexReader or IndexWriter holds  
the write lock is also dangerous and would lead to this exception.

In general it's very dangerous to forcibly remove, or ignore,  
Lucene's write lock.  It really should only be necessary when  
something catastrophic occurred (JVM crashed).

Also, note that IndexWriter can now delete documents.  This would  
simplify your code and possibly fix these two hazards.

Do you see any of the error/warnings that you send to your logger?   
(They would be corroborating evidence here).

Mike

Jamie wrote:
> Hi there
>
> It appears my Lucene 2.3.1 index is corrupted. I get the following  
> error when searching:
>
> /mnt/indexnew/_3wk0.cfs (No such file or directory)
> java.io.FileNotFoundException: /mnt/indexnew/_3wk0.cfs (No such  
> file or directory)
>        at java.io.RandomAccessFile.open(Native Method)
>        at java.io.RandomAccessFile.<init>(RandomAccessFile.java:231)
>        at org.apache.lucene.store.FSDirectory$FSIndexInput 
> $Descriptor.<init>(FSDirectory.java:506)
>        at org.apache.lucene.store.FSDirectory$FSIndexInput.<init> 
> (FSDirectory.java:536)
>        at org.apache.lucene.store.FSDirectory.openInput 
> (FSDirectory.java:445)
>        at org.apache.lucene.index.CompoundFileReader.<init> 
> (CompoundFileReader.java:70)
>        at org.apache.lucene.index.SegmentReader.initialize 
> (SegmentReader.java:277)
>        at org.apache.lucene.index.SegmentReader.get 
> (SegmentReader.java:262)
>        at org.apache.lucene.index.SegmentReader.get 
> (SegmentReader.java:197)
>        at org.apache.lucene.index.MultiSegmentReader.<init> 
> (MultiSegmentReader.java:55)
>        at org.apache.lucene.index.DirectoryIndexReader$1.doBody 
> (DirectoryIndexReader.java:75)
>        at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run 
> (SegmentInfos.java:636)
>        at org.apache.lucene.index.DirectoryIndexReader.open 
> (DirectoryIndexReader.java:63)
>        at org.apache.lucene.index.IndexReader.open(IndexReader.java: 
> 209)
>        at org.apache.lucene.index.IndexReader.open(IndexReader.java: 
> 173)
>        at org.apache.lucene.search.IndexSearcher.<init> 
> (IndexSearcher.java:48)
>        at
>
> Question #1: How can I recover from this error without regenerating  
> the entire index?
>
> Is there a utility I could use?
>
> Question #2: What is the reason why I am missing a segument cfs file?
>
> Could it be a problem with the synchronization of threads during  
> Indexing (see attached code)?
> Could it be a bug in MailArchiva?
> I have tried to implement locks in appropriate places.
> java.io.FileNotFoundException: /mnt/indexnew/_3wk0.cfs (No such  
> file or directory)
>
> Any help would be much appreciated!
>
> Jamie
>
> package com.stimulus.archiva.index;
>
> /* Copyright (C) 2005-2007 Jamie Angus Band
>  * MailArchiva Open Source Edition Copyright (c) 2005-2007 Jamie  
> Angus Band
>  * This program is free software; you can redistribute it and/or  
> modify it under the terms of
>  * the GNU General Public License as published by the Free Software  
> Foundation; either version
>  * 2 of the License, or (at your option) any later version.
>  *
>  * This program is distributed in the hope that it will be useful,  
> but WITHOUT ANY WARRANTY;
>  * without even the implied warranty of MERCHANTABILITY or FITNESS  
> FOR A PARTICULAR PURPOSE.
>  * See the GNU General Public License for more details.
>  *
>  * You should have received a copy of the GNU General Public  
> License along with this program;
>  * if not, see http://www.gnu.org/licenses or write to the Free  
> Software Foundation,Inc., 51
>  * Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA
>  */
>
>
> import javax.mail.*;
> import javax.mail.internet.*;
> import java.io.*;
> import java.util.*;
> import java.util.zip.*;
> import com.ice.tar.*;
> import org.apache.log4j.Logger;
> import org.apache.lucene.document.*;
> import org.apache.lucene.index.*;
> import org.apache.lucene.store.*;
> import com.stimulus.archiva.domain.*;
> import com.stimulus.archiva.exception.*;
> import com.stimulus.archiva.language.*;
> import com.stimulus.archiva.extraction.*;
> import com.stimulus.archiva.search.*;
> import com.stimulus.util.TempFiles;
> import com.stimulus.archiva.domain.fields.*;
> import com.stimulus.util.*;
> import java.nio.charset.Charset;
> import org.apache.log4j.Level;
>
> public class MessageIndex extends Indexer implements Serializable {
> 	
> 	
> 	  private static final long serialVersionUID = -17692874371162272L;
> 	  protected static final Logger logger = Logger.getLogger 
> (MessageIndex.class.getName());
> 	  protected static int INDEX_WAIT_PERIOD = 50;
> 	  protected static int DEAD_PERIOD = 300000000;
> 	  protected boolean shutdown = false;
> 	  static Hashtable<Volume,VolumeIndex> volumeIndexes = new  
> Hashtable<Volume,VolumeIndex>();
> 	  static Object volumeIndexLock = new Object();
>
>     public MessageIndex() {
> 	
>     }
>
>
> 	public void deleteIndex(Volume volume) throws  
> MessageSearchException {
> 		  VolumeIndex volumeIndex = getVolumeIndex(volume);
> 		  volumeIndex.deleteIndex();
> 	}
> 		
>  	
> 	public VolumeIndex getVolumeIndex(Volume volume) {
> 		 VolumeIndex volumeIndex = null;
> 		  synchronized (volumeIndexLock) {
> 			  volumeIndex = volumeIndexes.get(volume);
> 			  if (volumeIndex==null) {
> 				  volumeIndex = new VolumeIndex(this,volume);
> 				  volumeIndexes.put(volume,volumeIndex);
> 			  }
> 		  }
> 		  return volumeIndex;
> 	}
> 	  	
> 	public void indexMessage(Email email) throws MessageSearchException {
> 		  VolumeIndex volumeIndex = getVolumeIndex(email.getEmailId 
> ().getVolume());
> 		  volumeIndex.indexMessage(email);
> 	}
> 		
> 		
> 		  // Enterprise version
> 	
> 	public void deleteMessage(EmailID emailID) throws  
> MessageSearchException {
> 		  if (emailID == null)
> 	            throw new MessageSearchException("assertion failure:  
> null emailID",logger);
> 	  logger.debug("delete message {'"+emailID+"'}");
> 	  Volume volume = emailID.getVolume();
> 	  File indexDir = new File(volume.getIndexPath());
> 	  if (!indexDir.exists())
> 		  throw new MessageSearchException("could not delete email from  
> index. volume does not exist. {'"+emailID+"}",logger);
> 	  IndexReader indexReader = null;
> 	  try {
> 		  indexReader = IndexReader.open(indexDir);
> 	  } catch (IOException e ) {
> 		  throw new MessageSearchException("failed to open index to  
> delete email",e,logger);
> 	  }
> 	  try {
> 		  indexReader.deleteDocuments(new Term("uid",emailID.getUniqueID 
> ()));
> 		  indexReader.close();
> 	  } catch (Exception e) {
> 		  throw new MessageSearchException("failed to delete email from  
> index.",e,logger);
> 	  }
> 	}
> 	
> 	public void prepareIndex(Volume volume) throws  
> MessageSearchException {
> 			
> 		  if (volume==null)
> 		            throw new MessageSearchException("assertion failure:  
> null volume",logger);
> 	
> 	  if (volume.getIndexPath().startsWith("rmi://"))
> 			  return;
> 			
> 	  File indexDir = new File(volume.getIndexPath());
> 	  if (!indexDir.exists()) {
> 		logger.info("index directory does not exist. will proceed with  
> creation {location='" + volume.getIndexPath() + "'}");
> 		boolean success = indexDir.mkdir();
> 		if (!success)
> 				throw new MessageSearchException("failed to create index  
> directory {location='" + volume.getIndexPath() + "'}",logger);
> 		logger.info("index directory successfully created {location='" +  
> volume.getIndexPath() + "'}");
> 		  }
> 	
> 	}
> 	
> 	protected void finalize() throws Throwable {
> 	    logger.debug("messagindex class is shutting down");
> 	    try {
> 	    	shutdown = true;
> 	    } finally {
> 		super.finalize();
> 	    }
> 	}
>
> }
> package com.stimulus.archiva.index;
>
> import java.io.File;
> import java.io.IOException;
> import java.io.PrintStream;
> import javax.mail.MessagingException;
> import org.apache.log4j.Level;
> import org.apache.log4j.Logger;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.index.*;
> import org.apache.lucene.store.FSDirectory;
> import com.stimulus.archiva.domain.Config;
> import com.stimulus.archiva.domain.Email;
> import com.stimulus.archiva.domain.Indexer;
> import com.stimulus.archiva.domain.Volume;
> import com.stimulus.archiva.exception.ExtractionException;
> import com.stimulus.archiva.exception.MessageSearchException;
> import com.stimulus.archiva.language.AnalyzerFactory;
> import com.stimulus.archiva.search.*;
> import java.util.*;
> import org.apache.lucene.store.AlreadyClosedException;
>
> public class VolumeIndex {
> 	
> 		 protected static final Logger logger = Logger.getLogger 
> (VolumeIndex.class.getName());
> 		 public static final int indexOpenTime = 2000;
> 	   	 IndexWriter writer = null;
> 	   	 Volume volume;
> 	   	 Timer closeIndexTimer = new Timer();
> 		 Object indexLock = new Object();
> 		
> 		
> 		 ArchivaAnalyzer analyzer 	= new ArchivaAnalyzer();
> 		 Indexer indexer = null;
> 	  	  public VolumeIndex(Indexer indexer, Volume volume) {
> 	  		  	this.volume = volume;
> 	  		  	this.indexer = indexer;
> 		  		closeIndexTimer.scheduleAtFixedRate(new TimerTask() {
> 		            public void run() {
> 		             	closeIndex();
> 		            }
> 		        }, indexOpenTime, indexOpenTime);
> 	  	  }
>
> 		  protected void openIndex(boolean retry) throws  
> MessageSearchException {
> 			 Exception lastError = null;
> 			 synchronized(indexLock) {
> 		    	if (writer==null) {
> 		    		logger.debug("openIndex() index will be opened. it is  
> currently closed.");
> 		    	} else {
> 		    		logger.debug("openIndex() did not bother opening index. it  
> is already open.");
> 		    		return;
> 		    	}
>
> 				logger.debug("opening index for write {"+volume+"}");
> 				indexer.prepareIndex(volume);
> 				logger.debug("opening search index for write  
> {indexpath='"+volume.getIndexPath()+"'}");
> 			
> 				try {
> 						writer = new IndexWriter(FSDirectory.getDirectory 
> (volume.getIndexPath()),false, analyzer);
> 						writer.setMaxFieldLength(50000);
> 						if (logger.isDebugEnabled()) {
> 							File file = new File(Config.getFileSystem().getLogPath() 
> +File.separator+"index.log");
> 							PrintStream debugout = new PrintStream(file);
> 							writer.setInfoStream(debugout);
> 						}
> 				} catch (IOException io) {
> 					lastError = io;
> 					if (!retry) {
> 						// most obvious reason for error is that there is a lock on  
> the index, due hard shutdown
> 						    // resolution delete the lock, and try again
> 						    logger.warn("failed to open search index for write.  
> possible write lock due to hard system shutdown.",io);
> 						    logger.info("attempting recovery. deleting index lock  
> file and retrying..");
> 						    File lockFile = new File(volume.getIndexPath() 
> +File.separatorChar + "write.lock");
> 						    lockFile.delete();
> 						    openIndex(true);
> 					} else {
> 						throw new MessageSearchException("failed to open/ index  
> writer {location='"+volume.getIndexPath()+"'}",lastError,logger);
> 					}
> 				}
> 			}
> 		}
> 		
> 		public void indexMessage(Email message) throws  
> MessageSearchException  {
>
> 			long s = (new Date()).getTime();
> 			if (message == null)
> 			    throw new MessageSearchException("assertion failure: null  
> message",logger);
> 			logger.debug("indexing message {"+message+"}");
> 			
> 			Document doc = new Document();
> 			try {
> 			
> 			   DocumentIndex docIndex = new DocumentIndex(indexer);
> 			   docIndex.write(message,doc);
> 			   String language = doc.get("lang");
> 			   if (language==null)
> 				   language = indexer.getIndexLanguage();
> 		   		synchronized (indexLock) {
> 		   			openIndex(false);
> 		   			writer.addDocument(doc,AnalyzerFactory.getAnalyzer 
> (language,AnalyzerFactory.Operation.INDEX));
> 		   		}
> 		   		doc = null;
> 			   logger.debug("message indexed successfully {"+message 
> +",language='"+language+"'}");
> 			} catch (MessagingException me)
> 			{
> 			   throw new MessageSearchException("failed to decode message  
> during indexing",me,logger, Level.DEBUG);
> 			} catch (IOException me) {
> 			    throw new MessageSearchException("failed to index message  
> {"+message+"}",me,logger, Level.DEBUG);
> 			} catch (ExtractionException ee)
> 			{
> 				// we will want to continue indexing
> 			   //throw new MessageSearchException("failed to decode  
> attachments in message {"+message+"}",ee,logger, Level.DEBUG);
> 			} catch (AlreadyClosedException ace) {
> 				indexMessage(message);
> 			} catch (Exception e) {
> 			    throw new MessageSearchException("failed to index  
> message",e,logger, Level.DEBUG);
> 			}
> 			logger.debug("indexing message end {"+message+"}");
> 			
> 			long e = (new Date()).getTime();
> 		    logger.debug("indexing time {time='"+(e-s)+"'}");
> 		}
> 			
> 		protected void closeIndex() {
> 		
> 			   synchronized(indexLock) {
> 			        if (writer==null)
> 			        		return;
> 			        try {
> 			        	writer.close();
> 					    logger.debug("writer closed");
> 					} catch (Exception io) {
> 						logger.error("failed to close index writer:"+io.getMessage 
> (),io);
> 	
> 					}
> 			        writer = null;
> 			   	}
> 	   	}
> 		 //	 deliberately non recursive (so we avoid situations where the  
> whole h/d is deleted)
> 		  public void deleteIndex() throws MessageSearchException {
> 			  logger.debug("delete index {indexpath='"+volume.getIndexPath() 
> +"'}");
> 			
> 				try {
> 					  writer = new IndexWriter(FSDirectory.getDirectory 
> (volume.getIndexPath()),false, analyzer,true);
> 				} catch (Exception cie) {
> 					 logger.error("failed to delete index  
> {index='"+volume.getIndexPath()+"'}",cie);
> 					 File indexDir = new File(volume.getIndexPath());
>              		 if (!indexDir.exists()) return;
>              		 if (indexDir.isDirectory()) {
>           	            String[] children = indexDir.list();
>           	            for (int i=0; i<children.length; i++) {
>           	                String filepath = volume.getIndexPath() 
> +File.separatorChar+children[i];
>           	                logger.debug("deleting file {path='" +  
> filepath +"'}");
>           	                File file = new File(filepath);
>           	                boolean success = file.delete();
>           	                if (!success) {
>           	                	try {
>           	                		File newFile = File.createTempFile 
> ("temp","idx");
>           	                		file.renameTo(newFile);
>           	                	} catch (Exception e2) {
>           	                		throw new MessageSearchException 
> ("failed to delete file in existing index {filepath='"+filepath 
> +"'}",logger);
>           	                	}
>           	                } else
>                                    logger.debug("deleted file  
> successfully {filepath='" + filepath +"'}");
>           	            }
>              		 }
>              		 return;
> 				}
> 				try {
> 				  writer.close();
>               	} catch (Exception e) {
>               		logger.error("failed to delete index  
> {index='"+volume.getIndexPath()+"'}",e);
>               	}
>
>               	MessageIndex.volumeIndexes.remove(this);
>
>
> 		  }
> 		
> 		protected void finalize() throws Throwable {
> 		    logger.debug("volumeindex class is shutting down");
> 		    try {
> 		    	closeIndexTimer.cancel();
> 		    	closeIndex();
> 		    } finally {
> 			super.finalize();
> 		    }
> 		}
> 		
> }
>
> 	
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33962-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 11:56:47 2008
Return-Path: <java-user-return-33962-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6122 invoked from network); 7 May 2008 11:56:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 11:56:46 -0000
Received: (qmail 13785 invoked by uid 500); 7 May 2008 11:56:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13757 invoked by uid 500); 7 May 2008 11:56:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13746 invoked by uid 99); 7 May 2008 11:56:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 04:56:40 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mzhasan@gmail.com designates 64.233.166.176 as permitted sender)
Received: from [64.233.166.176] (HELO py-out-1112.google.com) (64.233.166.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 11:55:51 +0000
Received: by py-out-1112.google.com with SMTP id z74so409587pyg.9
        for <java-user@lucene.apache.org>; Wed, 07 May 2008 04:56:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:mime-version:content-type;
        bh=kji2Qso1moCvx2sL3Wq73mpDdpDGqFKQQGEmHhsS0sI=;
        b=KfpyWftdbRi6Op7Tz1RQ0EphHsWk8Bv0qTYa8hVenu5DxLf+uuZ8IXNDgesdw1AkkC4FyMRcjyEzErMmq7652J0yep3FtQlF+ndAO27PKwT23R+5JVAa+ltHW4Fo/nK8J7WHgfjtTfE5L10yAvOhW4gnV+IqIYqs9wOOKVzgX3A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:cc:mime-version:content-type;
        b=ek/1ZAnm7LmZokL3U7n1uoeknDLBQZFOZvRGUUBVijbAXOyYQHt5QXBh4Yj6KswpeB2k+kJKWw7/BjBj78uok4CSSIQ1klsCFFEcU13TGC72qIjdSlwXQGmdIIP1nhkm9009sdCMjRmq/xsMfQGhPxiWLRuokcv9m8GgKlWcvUU=
Received: by 10.115.106.7 with SMTP id i7mr1786729wam.18.1210161365159;
        Wed, 07 May 2008 04:56:05 -0700 (PDT)
Received: by 10.114.136.13 with HTTP; Wed, 7 May 2008 04:56:05 -0700 (PDT)
Message-ID: <b0aae42b0805070456k18cb6a1bpb434f5ff2526c723@mail.gmail.com>
Date: Wed, 7 May 2008 17:56:05 +0600
From: "Mohammad Hasan" <mzhasan@gmail.com>
To: java-user@lucene.apache.org
Subject: GradientFormatter Exception during runtime
Cc: markharw00d@yahoo.co.uk
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_11552_30121298.1210161365150"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_11552_30121298.1210161365150
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi Mark & All,



I am trying to implement NHibernate Search with Lucene.Net Highlight in my
project. All I am trying to do is finding the item that stored in a
database. I am successful in that, but when I try to highlight the result
with GradientFormatter, I run into trouble. I get FormatException error
which says, "One of the identified items was in an invalid format". I am
using Visual Studio 2005 to develop the ASP.NET application. The program
compiles correctly, but during run time it throws exception and tells one of
the arguments in the GradientFormatter constructor is wrong which I do not
understand since I think all the arguments are in correct format. I put the
code below. If you, Mark or Any body can help me in this regards that will
be really great. Thanks a lot.



Hasan



public IList searchBook(string searchItem)

{

protected IList highlightedText = null;

Analyzer analyzer = new SimpleAnalyzer();

ISession session = factory.OpenSession(new SearchInterceptor());

IFullTextSession fullTextSession = Search.CreateFullTextSession(session);

IndexReader indexReader = IndexReader.Open(SearchFactory
.GetSearchFactory(session)

.GetDirectoryProvider(typeof(Book)).Directory);

IndexSearcher searcher = new IndexSearcher(indexReader);

MultiFieldQueryParser parser = new MultiFieldQueryParser(new string[] {
"Name", "Author"}, analyzer);

Query queryObj;

using (ITransaction transaction = session.BeginTransaction())

{

List<string> queryParts = new List<string>();

string[] searchWords = searchItem.Split(new char[] { ' ' });

foreach (string searchWord in searchWords)

{

queryParts.Add("Name:" + searchWord.Trim() + "*");

queryParts.Add("Author:" + searchWord.Trim() + "*");

}

//queryParts are probably ArrayList. ArrayList al = new ArrayList();



//Basically above Name & Author are the fields where the search sould be
performed



//If only Name is mentioned then nothing will be searched in Author



try



{

string query = string.Join(" or ", queryParts.ToArray());

queryObj = parser.Parse(query);

//IQuery nhQuery = fullTextSession.CreateFullTextQuery(queryObj, new Type[]
{ typeof(Book) });



//IList<Book> books = nhQuery.List<Book>();



//QueryScorer fragScorer = new QueryScorer(queryObj, indexReader, "Name");



QueryScorer fragScorer = new QueryScorer(queryObj.Rewrite(indexReader));

float topScore = fragScorer.GetMaxTermWeight();

      //Create a gradient formatter with appropriate color ranges



GradientFormatter formatter = new GradientFormatter(topScore, "#888888",
"#ff8888","#ffffff","#ffffff");

  //create the highlighter



  Highlighter highlighter=new Highlighter(formatter,fragScorer);

  //run the query and highlight the results - graded by color to reflect
value of match



  Hits hits = searcher.Search(queryObj);

  //int numToShow=Math.min(10,hits.length());



  for (int i = 0; i < hits.Length(); i++)

  {

      String text=hits.Doc(i).Get("Name");

        TokenStream tokenStream = analyzer.TokenStream("Name", new
StringReader(text));

        String highlightText = highlighter.GetBestFragments(tokenStream,
text, 2, "...");

highlightedText.Add(highlightText);

  }

//_results = fullTextSession.CreateFullTextQuery<Book>(query).List<Book>();



return highlightedText;

}

finally



{

fullTextSession.Close();

}

//transaction.Commit();



}

}

------=_Part_11552_30121298.1210161365150--

From java-user-return-33963-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 12:07:49 2008
Return-Path: <java-user-return-33963-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13400 invoked from network); 7 May 2008 12:07:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 12:07:49 -0000
Received: (qmail 33216 invoked by uid 500); 7 May 2008 12:07:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33186 invoked by uid 500); 7 May 2008 12:07:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33175 invoked by uid 99); 7 May 2008 12:07:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 05:07:44 -0700
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=SPF_PASS,URIBL_BLACK,URIBL_GREY
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of marcelo.ochoa@gmail.com designates 74.125.46.28 as permitted sender)
Received: from [74.125.46.28] (HELO yw-out-2324.google.com) (74.125.46.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 12:06:55 +0000
Received: by yw-out-2324.google.com with SMTP id 3so147278ywj.5
        for <java-user@lucene.apache.org>; Wed, 07 May 2008 05:07:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=Qi3wb/0WLCKnZPfeSEy+rfqN2uAS+fa6vqzdzi8pO7M=;
        b=Dyk5eGYc0UnT4zJziXrNI35P1iBsXTLqXI1hWj8/V47HnyGUgX0gBvwMS0yRxUkuiVOmtTOxecmsZVin8tZQfRq/vK7UFLjvHpEcSft5SpcKhifnWKRdJrg8F6uq8StTWBUfyI/JNaxvU4Zocws9x44oUSLnwON8FXp0taUxYc4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=m19QqFIJfjtUB7VHrCiWNF7ta9q+H7tEOjHWOENNSu7vNAlb2bJ/mrHPiSLkOJHPi1hbMVkoo5kTVA+2uMEGhWG3OQyMNyCORG9DsDfkOuftKDGCZZ0UJZzJ7T7VOosvlbv2fcBk3TL8SccwTm3Y42D+24Q2+5yBaRZQDlMXj4A=
Received: by 10.150.228.2 with SMTP id a2mr1823851ybh.245.1210162021789;
        Wed, 07 May 2008 05:07:01 -0700 (PDT)
Received: by 10.151.99.7 with HTTP; Wed, 7 May 2008 05:07:01 -0700 (PDT)
Message-ID: <126142c0805070507l68f13795m8496e6803fdbc6ab@mail.gmail.com>
Date: Wed, 7 May 2008 09:07:01 -0300
From: "Marcelo Ochoa" <marcelo.ochoa@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Help to solve an issue when upgrading Lucene-Oracle integration to lucene 2.3.1
In-Reply-To: <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com>
MIME-Version: 1.0
Content-Type: multipart/mixed; 
	boundary="----=_Part_10253_30037504.1210162021755"
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com>
	 <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com>
	 <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com>
	 <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_10253_30037504.1210162021755
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi Michael:
  First thanks a lot for your time.
  See comments below.
>  Is there any way to capture & serialize the actual documents being
>  added (this way I can "replay" those docs to reproduce it)?
  Documents are a column VARCHAR2 from all_source Oracle's System
view, in fact is a table as:
create table test_source_big as (select * from all_source);
>
>  Are you using threads?  Is autoCommit true or false?
  Oracle JVM uses by default a single Thread model, except that Lucene
is starting a parallel Thread. InfoStream information shows only one
Thread.
  AutoCommit is false.
  I am creating LuceneWritter with this code:
        IndexWriter writer = null;
        Parameters parameters = dir.getParameters();
        int mergeFactor =
            Integer.parseInt(parameters.getParameter("MergeFactor",
                                                     "" +
LogMergePolicy.DEFAULT_MERGE_FACTOR));
        int maxBufferedDocs =
            Integer.parseInt(parameters.getParameter("MaxBufferedDocs",
                                                     "" +
IndexWriter.DEFAULT_MAX_BUFFERED_DOCS));
        int maxMergeDocs =
            Integer.parseInt(parameters.getParameter("MaxMergeDocs",
                                                     "" +
LogDocMergePolicy.DEFAULT_MAX_MERGE_DOCS));
        int maxBufferedDeleteTerms =
            Integer.parseInt(parameters.getParameter("MaxBufferedDeleteTerms",
                                                     "" +

IndexWriter.DEFAULT_MAX_BUFFERED_DELETE_TERMS));
        Analyzer analyzer = getAnalyzer(parameters);
        boolean useCompountFileName =
            "true".equalsIgnoreCase(parameters.getParameter("UseCompoundFile",
                                                            "false"));
        boolean autoTuneMemory =
            "true".equalsIgnoreCase(parameters.getParameter("AutoTuneMemory",
                                                            "true"));
        writer =
                new IndexWriter(dir, autoCommitEnable, analyzer, createEnable);
        if (autoTuneMemory) {
            long memLimit =
((OracleRuntime.getJavaPoolSize()/100)*50)/(1024*1024);
            logger.info(".getIndexWriterForDir - Memory limit for
indexing (Mb): "+memLimit);
            writer.setRAMBufferSizeMB(memLimit);
        } else
            writer.setMaxBufferedDocs(maxBufferedDocs);
        writer.setMaxMergeDocs(maxMergeDocs);
        writer.setMaxBufferedDeleteTerms(maxBufferedDeleteTerms);
        writer.setMergeFactor(mergeFactor);
        writer.setUseCompoundFile(useCompountFileName);
        if (logger.isLoggable(Level.FINE))
            writer.setInfoStream(System.out);
   The example pass these relevant parameters:
   AutoTuneMemory:true;LogLevel:FINE;Analyzer:org.apache.lucene.analysis.StopAnalyzer;MergeFactor:500
   So, because AutoTuneMemory is true, instead of setting
MaxBufferedDocs I am setting RAMBufferSizeMB(53) which is calculated
using Oracle SGA free memory.
>
>  Are you using payloads?
  No.
>
>  Were there any previous exceptions in this IndexWriter before flushing
>  this segment?  Could you post the full infoStream output?
  There is no provious exception. Attached a .trc file generated by
Oracle 11g, it have infoStream information plus logging informartion
from Oracle-Lucene data cartridge.
>
<snip>
>  Could you apply the patch below & re-run?  It will likely produce
>  insane amounts of output, but we only need the last section to see
>  which term is hitting the bug.  If that term consistently hits the bug
>  then we can focus on how/when it gets indexed...
  I'll patch my lucene-2.3.1 source and send again the .trc file.
  Also, I am comparing FSDirectory implementation (2.3.1) with my
OJVMDirectory implementation to see changes on how the API of
BufferedIndex[Input|Output].java is used, may be here is the problem.
  For example latest implementation wait an IOException when open an
IndexInput and a file doesn't exists, my code throw a RuntimeException
wich works with Lucene 2.2.x but doesn't work with 2.3.1, this was the
first change to get Lucene-Oracle integration working.
  Best regards. Marcelo.
-- 
Marcelo F. Ochoa
http://marceloochoa.blogspot.com/
http://marcelo.ochoa.googlepages.com/home
______________
Do you Know DBPrism? Look @ DB Prism's Web Site
http://www.dbprism.com.ar/index.html
More info?
Chapter 17 of the book "Programming the Oracle Database using Java &
Web Services"
http://www.amazon.com/gp/product/1555583296/
Chapter 21 of the book "Professional XML Databases" - Wrox Press
http://www.amazon.com/gp/product/1861003587/
Chapter 8 of the book "Oracle & Open Source" - O'Reilly
http://www.oreilly.com/catalog/oracleopen/


------=_Part_10253_30037504.1210162021755
Content-Type: text/plain; charset=us-ascii

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
------=_Part_10253_30037504.1210162021755--

From java-user-return-33964-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 12:45:09 2008
Return-Path: <java-user-return-33964-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34689 invoked from network); 7 May 2008 12:45:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 12:45:09 -0000
Received: (qmail 88077 invoked by uid 500); 7 May 2008 12:45:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88050 invoked by uid 500); 7 May 2008 12:45:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88039 invoked by uid 99); 7 May 2008 12:45:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 05:45:03 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.214] (HELO web26003.mail.ukl.yahoo.com) (217.12.10.214)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 07 May 2008 12:44:13 +0000
Received: (qmail 35881 invoked by uid 60001); 7 May 2008 12:44:26 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=ySsi3vpkrjjkPes0/k5CarXxFQxQ4Tf2+/tpm+5JzwH7kKFvEWlxDZrc0oz3ncRwAwZJiQq3GZx82lobomEP8k0Yws7SMzEwFfmWQetNrki37cDF4+BmJIVbDcVFn658QKnOL0YuJU7OvSzXluvs301FJgzdcI73CMUI281/Qq8=;
X-YMail-OSG: IXSYtDAVM1kDJrcXlOSKWq5rg4auHdlRZ2_Z9af3l6I0F3cngIGTAYarXlfy8ng2a1wNMMoRge25M9vTvrDhT9A5y38jUls1bdZ0GN2p4.l9uudVV4NjcDOw1.o-
Received: from [193.36.230.96] by web26003.mail.ukl.yahoo.com via HTTP; Wed, 07 May 2008 12:44:26 GMT
X-Mailer: YahooMailRC/975.37 YahooMailWebService/0.7.185
Date: Wed, 7 May 2008 12:44:26 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: GradientFormatter Exception during runtime
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Message-ID: <337227.35858.qm@web26003.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Sorry, no ideas based on a quick look at the code.=0AUnforunately this isn'=
t the forum for questions relating to Lucene.net so I would suggest seeking=
 the support of that community who may at least be in a position to run you=
r code.=0A=0ACheers,=0AMark=0A=0A----- Original Message ----=0AFrom: Mohamm=
ad Hasan <mzhasan@gmail.com>=0ATo: java-user@lucene.apache.org=0ACc: markha=
rw00d@yahoo.co.uk=0ASent: Wednesday, 7 May, 2008 12:56:05 PM=0ASubject: Gra=
dientFormatter Exception during runtime=0A=0AHi Mark & All,=0A=0A=0A=0AI am=
 trying to implement NHibernate Search with Lucene.Net Highlight in my=0Apr=
oject. All I am trying to do is finding the item that stored in a=0Adatabas=
e. I am successful in that, but when I try to highlight the result=0Awith G=
radientFormatter, I run into trouble. I get FormatException error=0Awhich s=
ays, "One of the identified items was in an invalid format". I am=0Ausing V=
isual Studio 2005 to develop the ASP.NET application. The program=0Acompile=
s correctly, but during run time it throws exception and tells one of=0Athe=
 arguments in the GradientFormatter constructor is wrong which I do not=0Au=
nderstand since I think all the arguments are in correct format. I put the=
=0Acode below. If you, Mark or Any body can help me in this regards that wi=
ll=0Abe really great. Thanks a lot.=0A=0A=0A=0AHasan=0A=0A=0A=0Apublic ILis=
t searchBook(string searchItem)=0A=0A{=0A=0Aprotected IList highlightedText=
 =3D null;=0A=0AAnalyzer analyzer =3D new SimpleAnalyzer();=0A=0AISession s=
ession =3D factory.OpenSession(new SearchInterceptor());=0A=0AIFullTextSess=
ion fullTextSession =3D Search.CreateFullTextSession(session);=0A=0AIndexRe=
ader indexReader =3D IndexReader.Open(SearchFactory=0A.GetSearchFactory(ses=
sion)=0A=0A.GetDirectoryProvider(typeof(Book)).Directory);=0A=0AIndexSearch=
er searcher =3D new IndexSearcher(indexReader);=0A=0AMultiFieldQueryParser =
parser =3D new MultiFieldQueryParser(new string[] {=0A"Name", "Author"}, an=
alyzer);=0A=0AQuery queryObj;=0A=0Ausing (ITransaction transaction =3D sess=
ion.BeginTransaction())=0A=0A{=0A=0AList<string> queryParts =3D new List<st=
ring>();=0A=0Astring[] searchWords =3D searchItem.Split(new char[] { ' ' })=
;=0A=0Aforeach (string searchWord in searchWords)=0A=0A{=0A=0AqueryParts.Ad=
d("Name:" + searchWord.Trim() + "*");=0A=0AqueryParts.Add("Author:" + searc=
hWord.Trim() + "*");=0A=0A}=0A=0A//queryParts are probably ArrayList. Array=
List al =3D new ArrayList();=0A=0A=0A=0A//Basically above Name & Author are=
 the fields where the search sould be=0Aperformed=0A=0A=0A=0A//If only Name=
 is mentioned then nothing will be searched in Author=0A=0A=0A=0Atry=0A=0A=
=0A=0A{=0A=0Astring query =3D string.Join(" or ", queryParts.ToArray());=0A=
=0AqueryObj =3D parser.Parse(query);=0A=0A//IQuery nhQuery =3D fullTextSess=
ion.CreateFullTextQuery(queryObj, new Type[]=0A{ typeof(Book) });=0A=0A=0A=
=0A//IList<Book> books =3D nhQuery.List<Book>();=0A=0A=0A=0A//QueryScorer f=
ragScorer =3D new QueryScorer(queryObj, indexReader, "Name");=0A=0A=0A=0AQu=
eryScorer fragScorer =3D new QueryScorer(queryObj.Rewrite(indexReader));=0A=
=0Afloat topScore =3D fragScorer.GetMaxTermWeight();=0A=0A      //Create a =
gradient formatter with appropriate color ranges=0A=0A=0A=0AGradientFormatt=
er formatter =3D new GradientFormatter(topScore, "#888888",=0A"#ff8888","#f=
fffff","#ffffff");=0A=0A  //create the highlighter=0A=0A=0A=0A  Highlighter=
 highlighter=3Dnew Highlighter(formatter,fragScorer);=0A=0A  //run the quer=
y and highlight the results - graded by color to reflect=0Avalue of match=
=0A=0A=0A=0A  Hits hits =3D searcher.Search(queryObj);=0A=0A  //int numToSh=
ow=3DMath.min(10,hits.length());=0A=0A=0A=0A  for (int i =3D 0; i < hits.Le=
ngth(); i++)=0A=0A  {=0A=0A      String text=3Dhits.Doc(i).Get("Name");=0A=
=0A        TokenStream tokenStream =3D analyzer.TokenStream("Name", new=0AS=
tringReader(text));=0A=0A        String highlightText =3D highlighter.GetBe=
stFragments(tokenStream,=0Atext, 2, "...");=0A=0AhighlightedText.Add(highli=
ghtText);=0A=0A  }=0A=0A//_results =3D fullTextSession.CreateFullTextQuery<=
Book>(query).List<Book>();=0A=0A=0A=0Areturn highlightedText;=0A=0A}=0A=0Af=
inally=0A=0A=0A=0A{=0A=0AfullTextSession.Close();=0A=0A}=0A=0A//transaction=
.Commit();=0A=0A=0A=0A}=0A=0A}=0A=0A=0A=0A      ___________________________=
_______________________________=0ASent from Yahoo! Mail.=0AA Smarter Email =
http://uk.docs.yahoo.com/nowyoucan.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33965-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 13:51:12 2008
Return-Path: <java-user-return-33965-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60831 invoked from network); 7 May 2008 13:51:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 13:51:11 -0000
Received: (qmail 6308 invoked by uid 500); 7 May 2008 13:51:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5619 invoked by uid 500); 7 May 2008 13:51:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5608 invoked by uid 99); 7 May 2008 13:51:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 06:51:05 -0700
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=SPF_NEUTRAL,URIBL_BLACK,URIBL_GREY
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.233.178.241] (HELO hs-out-0708.google.com) (64.233.178.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 13:50:16 +0000
Received: by hs-out-0708.google.com with SMTP id 4so217993hsl.5
        for <java-user@lucene.apache.org>; Wed, 07 May 2008 06:50:24 -0700 (PDT)
Received: by 10.90.118.19 with SMTP id q19mr2970880agc.83.1210168224753;
        Wed, 07 May 2008 06:50:24 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 5sm2385103agc.27.2008.05.07.06.50.24
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 07 May 2008 06:50:24 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <126142c0805070507l68f13795m8496e6803fdbc6ab@mail.gmail.com>
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com> <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com> <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com> <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com> <126142c0805070507l68f13795m8496e6803fdbc6ab@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <7C5084D2-1682-4D2F-AE25-C70E585AED76@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: Help to solve an issue when upgrading Lucene-Oracle integration to lucene 2.3.1
Date: Wed, 7 May 2008 09:51:14 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


I didn't see any attachments on this email?  (I was expecting  
the .trc file so I could look at the full infoStream output).

Mike

Marcelo Ochoa wrote:
> Hi Michael:
>   First thanks a lot for your time.
>   See comments below.
>>  Is there any way to capture & serialize the actual documents being
>>  added (this way I can "replay" those docs to reproduce it)?
>   Documents are a column VARCHAR2 from all_source Oracle's System
> view, in fact is a table as:
> create table test_source_big as (select * from all_source);
>>
>>  Are you using threads?  Is autoCommit true or false?
>   Oracle JVM uses by default a single Thread model, except that Lucene
> is starting a parallel Thread. InfoStream information shows only one
> Thread.
>   AutoCommit is false.
>   I am creating LuceneWritter with this code:
>         IndexWriter writer = null;
>         Parameters parameters = dir.getParameters();
>         int mergeFactor =
>             Integer.parseInt(parameters.getParameter("MergeFactor",
>                                                      "" +
> LogMergePolicy.DEFAULT_MERGE_FACTOR));
>         int maxBufferedDocs =
>             Integer.parseInt(parameters.getParameter 
> ("MaxBufferedDocs",
>                                                      "" +
> IndexWriter.DEFAULT_MAX_BUFFERED_DOCS));
>         int maxMergeDocs =
>             Integer.parseInt(parameters.getParameter("MaxMergeDocs",
>                                                      "" +
> LogDocMergePolicy.DEFAULT_MAX_MERGE_DOCS));
>         int maxBufferedDeleteTerms =
>             Integer.parseInt(parameters.getParameter 
> ("MaxBufferedDeleteTerms",
>                                                      "" +
>
> IndexWriter.DEFAULT_MAX_BUFFERED_DELETE_TERMS));
>         Analyzer analyzer = getAnalyzer(parameters);
>         boolean useCompountFileName =
>             "true".equalsIgnoreCase(parameters.getParameter 
> ("UseCompoundFile",
>                                                             "false"));
>         boolean autoTuneMemory =
>             "true".equalsIgnoreCase(parameters.getParameter 
> ("AutoTuneMemory",
>                                                             "true"));
>         writer =
>                 new IndexWriter(dir, autoCommitEnable, analyzer,  
> createEnable);
>         if (autoTuneMemory) {
>             long memLimit =
> ((OracleRuntime.getJavaPoolSize()/100)*50)/(1024*1024);
>             logger.info(".getIndexWriterForDir - Memory limit for
> indexing (Mb): "+memLimit);
>             writer.setRAMBufferSizeMB(memLimit);
>         } else
>             writer.setMaxBufferedDocs(maxBufferedDocs);
>         writer.setMaxMergeDocs(maxMergeDocs);
>         writer.setMaxBufferedDeleteTerms(maxBufferedDeleteTerms);
>         writer.setMergeFactor(mergeFactor);
>         writer.setUseCompoundFile(useCompountFileName);
>         if (logger.isLoggable(Level.FINE))
>             writer.setInfoStream(System.out);
>    The example pass these relevant parameters:
>     
> AutoTuneMemory:true;LogLevel:FINE;Analyzer:org.apache.lucene.analysis. 
> StopAnalyzer;MergeFactor:500
>    So, because AutoTuneMemory is true, instead of setting
> MaxBufferedDocs I am setting RAMBufferSizeMB(53) which is calculated
> using Oracle SGA free memory.
>>
>>  Are you using payloads?
>   No.
>>
>>  Were there any previous exceptions in this IndexWriter before  
>> flushing
>>  this segment?  Could you post the full infoStream output?
>   There is no provious exception. Attached a .trc file generated by
> Oracle 11g, it have infoStream information plus logging informartion
> from Oracle-Lucene data cartridge.
>>
> <snip>
>>  Could you apply the patch below & re-run?  It will likely produce
>>  insane amounts of output, but we only need the last section to see
>>  which term is hitting the bug.  If that term consistently hits  
>> the bug
>>  then we can focus on how/when it gets indexed...
>   I'll patch my lucene-2.3.1 source and send again the .trc file.
>   Also, I am comparing FSDirectory implementation (2.3.1) with my
> OJVMDirectory implementation to see changes on how the API of
> BufferedIndex[Input|Output].java is used, may be here is the problem.
>   For example latest implementation wait an IOException when open an
> IndexInput and a file doesn't exists, my code throw a RuntimeException
> wich works with Lucene 2.2.x but doesn't work with 2.3.1, this was the
> first change to get Lucene-Oracle integration working.
>   Best regards. Marcelo.
> -- 
> Marcelo F. Ochoa
> http://marceloochoa.blogspot.com/
> http://marcelo.ochoa.googlepages.com/home
> ______________
> Do you Know DBPrism? Look @ DB Prism's Web Site
> http://www.dbprism.com.ar/index.html
> More info?
> Chapter 17 of the book "Programming the Oracle Database using Java &
> Web Services"
> http://www.amazon.com/gp/product/1555583296/
> Chapter 21 of the book "Professional XML Databases" - Wrox Press
> http://www.amazon.com/gp/product/1861003587/
> Chapter 8 of the book "Oracle & Open Source" - O'Reilly
> http://www.oreilly.com/catalog/oracleopen/
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33966-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 15:33:28 2008
Return-Path: <java-user-return-33966-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45429 invoked from network); 7 May 2008 15:33:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 15:33:28 -0000
Received: (qmail 91122 invoked by uid 500); 7 May 2008 15:33:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91095 invoked by uid 500); 7 May 2008 15:33:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91084 invoked by uid 99); 7 May 2008 15:33:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 08:33:22 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of crspan@gmail.com designates 64.233.178.249 as permitted sender)
Received: from [64.233.178.249] (HELO hs-out-0708.google.com) (64.233.178.249)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 15:32:36 +0000
Received: by hs-out-0708.google.com with SMTP id 4so245675hsl.5
        for <java-user@lucene.apache.org>; Wed, 07 May 2008 08:32:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:cc:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=yOJWL972YVo0sq8H8tPKzEUAbGWDbHD6GcDb3F8Z+oE=;
        b=u7De0rvPmelsaCQQm6a4mivb6XWwM6ZmtQ+4QrjKAxzL41RJV+h+9eZhlEjp+i9WmW4avtEhlrAxh4CBscJepO6Judu1ZeW4NbgY7hvlnScsMUVp2MpKp0rf5pnn+tjkCn0TKrnhOJEeC4SVZGAa5TtEkMGdVpz8Q56ghEIuAXY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:cc:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=Lrph80fXPZEJPMZtv9vK4l/cMIE92bzdPS7+GlWCfYcq7XavlY2xPxxeJp4T2UKxW3uCSU51v8CDU2Vc2AaXB83mQHp2gLIOPLevTbs1T7hFAUIjGnsX8ozmo/skXDIds7VaZoXtquRDJobS5wR72Vlw+vgIRk3+zXX4bmpNhX4=
Received: by 10.90.73.17 with SMTP id v17mr3134090aga.45.1210174369467;
        Wed, 07 May 2008 08:32:49 -0700 (PDT)
Received: from ?192.168.168.3? ( [72.179.149.134])
        by mx.google.com with ESMTPS id q26sm5206043ele.0.2008.05.07.08.32.47
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 07 May 2008 08:32:48 -0700 (PDT)
Message-ID: <4821CB9B.7040104@gmail.com>
Date: Wed, 07 May 2008 10:32:43 -0500
From: crspan <crspan@gmail.com>
User-Agent: Thunderbird 2.0.0.12 (Windows/20080213)
MIME-Version: 1.0
To: Michael McCandless <lucene@mikemccandless.com>
CC: java-user@lucene.apache.org
Subject: Re: Are those runtime errors about the jdk, or lucene's jar, or my
 code?
References: <48209D62.2000103@gmail.com> <D0DBD255-D484-481B-88E1-A4D8BF5BE038@mikemccandless.com> <48212BEB.50801@gmail.com> <11EFE28B-E740-4D51-A6E5-DDFAE3B47188@mikemccandless.com>
In-Reply-To: <11EFE28B-E740-4D51-A6E5-DDFAE3B47188@mikemccandless.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Exactly the case you have described. Not sure why it got corrupted after 
scp. IF compare the index size, exact bytes. But I also noticed that the 
scp process was dangling there long after, so I killed that process. 
Maybe that is why.

    Lesson learned: Still "CheckIndex", even index size matches.

Thanks again, Mike.

Charlie




Michael McCandless wrote:
>
> OK, phew.  Thanks for bringing closure here.
>
> You mean you ran CheckIndex on the original index (input to scp) and 
> it was fine, but CheckIndex on the copy produced by scp showed the 
> corruption?
>
> I think it's unusual for scp to corrupt the copy unless something 
> catastrophic happens (eg disk full, disk is bad, RAM is bad, etc.).
>
> Mike
>
> crspan wrote:
>> Thanks so much, Mike. Those runtime errors were caused by one 
>> corrupted index, somehow corrupted during scp. It has Nothing to do 
>> with lucene 2.3.2.
>>
>> For those who come by this thread:
>>       Please "CheckIndex"
>>
>> That would saved me many hours of fruitless debugging.
>>
>> Cheers,
>> Charlie
>>
>>
>> Michael McCandless wrote:
>>>
>>> Hi,
>>>
>>> Could you run org.apache.lucene.index.CheckIndex on your index and 
>>> post the result?
>>>
>>> Are these exceptions easily reproduced starting from scratch (new 
>>> index)?
>>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33967-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 15:51:33 2008
Return-Path: <java-user-return-33967-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52104 invoked from network); 7 May 2008 15:51:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 15:51:32 -0000
Received: (qmail 19820 invoked by uid 500); 7 May 2008 15:51:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19782 invoked by uid 500); 7 May 2008 15:51:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19771 invoked by uid 99); 7 May 2008 15:51:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 08:51:25 -0700
X-ASF-Spam-Status: No, hits=-3.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.108.46] (HELO SUEXCL-02.ad.syr.edu) (128.230.108.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 15:50:28 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
Subject: RE: lucene farsi problem
Date: Wed, 7 May 2008 11:49:11 -0400
Message-ID: <9294E20AED46934EA459020706463F94A04BF1@SUEXCL-02.ad.syr.edu>
In-Reply-To: <17080852.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: lucene farsi problem
Thread-Index: AcivbcbkljNhLxXISZ+QHj1O25bwLQA6lXAg
From: "Steven A Rowe" <sarowe@syr.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgRXNyYSwNCg0KT24gMDUvMDYvMjAwOCBhdCA3OjM4IEFNLCBlc3JhIHdyb3RlOg0KPiBpIHRy
aWVkIHRoZSBjbGFzcyBhbmQgaXQgd29ya3MgZmluZSB3aXRoIHRoZSBsb2NhbGUgcGFyYW1ldGVy
ICJhciIuDQoNCkNvb2wsIEknbSBnbGFkIHRoaXMgYWRkcmVzc2VkIHlvdXIgcHJvYmxlbSENCg0K
PiBBY3R1YWxseSB3ZSBhcmUgdXNpbmcgImZhIiBmb3IgZmFyc2kgYW5kICJhciIgZm9yIGFyYWJp
Yy4NCj4gSSBoYXZlIGFkZGVkIGEgbGl0dGxlIGNvbnRyb2wgZm9yIHRoZSBsb2NhbGUgcGFyYW1l
dGVyIGluIG15DQo+IGNvZGUgYW5kIG5vdyBpIGNhbiBzZWUgdGhlIGNvcnJlY3QgcmVzdWx0cy4N
Cg0KRnJvbSB3aGF0IEkgY291bGQgdGVsbCwgdGhlIENvbGxhdG9yIGF2YWlsYWJsZSBmb3IgTG9j
YWxlKCJmYSIpIGluIHRoZSBTdW4gMS40LjIgYW5kIDEuNS4wIEpES3MgZG9lcyBub3QgY29udGFp
biBGYXJzaSBjaGFyYWN0ZXIgY29sbGF0aW9uLCBidXQgdGhlIENvbGxhdG9yIGF2YWlsYWJsZSBm
b3IgTG9jYWxlKCJhciIpICpkb2VzKiBjb250YWluIEZhcnNpIGNvbGxhdGlvbi4gIEkgc3dpdGNo
ZWQgVGVzdENvbGxhdGluZ1JhbmdlUXVlcnkgZnJvbSBMb2NhbGUoImZhIikgdG8gTG9jYWxlKCJh
ciIpIHdoZW4gSSBjb3VsZG4ndCBnZXQgdGhlIENvbGxhdG9yIHJldHVybmVkIGZvciBGYXJzaSBb
IHZpYSBDb2xsYXRvci5nZXRJbnN0YW5jZShuZXcgTG9jYWxlKCJmYSIpIF0gdG8gcHJvZHVjZSBj
b3JyZWN0IHJlc3VsdHMuDQoNCkRpZCB5b3UgZmluZCB0aGF0IExvY2FsZSgiZmEiKSBwcm9kdWNl
cyB0aGUgY29ycmVjdCByZXN1bHRzPyAgSWYgc28sIHdoaWNoIFZNIGFyZSB5b3UgdXNpbmc/DQoN
CkF0IENocmlzIEhvc3RldHRlcidzIHN1Z2dlc3Rpb24sIEkgYW0gcmV3cml0aW5nIHRoZSBwYXRj
aCBhdHRhY2hlZCB0byBMVUNFTkUtMTI3OSwgaW5jbHVkaW5nIHRoZSBmb2xsb3dpbmcgY2hhbmdl
czoNCg0KLSBNZXJnZWQgdGhlIGNvbnRlbnRzIG9mIHRoZSBDb2xsYXRpbmdSYW5nZVF1ZXJ5IGNs
YXNzIGludG8gUmFuZ2VRdWVyeSBhbmQgUmFuZ2VGaWx0ZXINCi0gU3dpdGNoZWQgdGhlIExvY2Fs
ZSBwYXJhbWV0ZXIgdG8gaW5zdGVhZCB0YWtlIGFuIGluc3RhbmNlIG9mIENvbGxhdG9yDQotIE1v
ZGlmaWVkIFF1ZXJ5UGFyc2VyLmpqIHRvIGNvbnN0cnVjdCBhIFF1ZXJ5UGFyc2VyIGNsYXNzIHRo
YXQgY2FuIGFjY2VwdCBhIHJhbmdlIGNvbGxhdG9yIGFuZCBwYXNzIGl0IGVpdGhlciB0byBSYW5n
ZVF1ZXJ5IG9yIHRocm91Z2ggQ29uc3RhbnRTY29yZVJhbmdlUXVlcnkgdG8gUmFuZ2VGaWx0ZXIu
DQoNCkkgcGxhbiBvbiBwb3N0aW5nIHRoZSByZXZpc2VkIHBhdGNoIGluIHRoZSBuZXh0IGRheSBv
ciB0d28uDQoNClN0ZXZlDQoNCk9uIDA1LzA2LzIwMDggYXQgNzozOCBBTSwgZXNyYSB3cm90ZToN
Cj4gDQo+IEhpIFN0ZXZlbiAsDQo+IEhpIFN0ZXZlbiwNCj4gDQo+IGkgdHJpZWQgdGhlIGNsYXNz
IGFuZCBpdCB3b3JrcyBmaW5lIHdpdGggdGhlIGxvY2FsZSBwYXJhbWV0ZXIgImFyIi4NCj4gDQo+
IEFjdHVhbGx5IHdlIGFyZSB1c2luZyAiZmEiIGZvciBmYXJzaSBhbmQgImFyIiBmb3IgYXJhYmlj
Lg0KPiBJIGhhdmUgYWRkZWQgYSBsaXR0bGUgY29udHJvbCBmb3IgdGhlIGxvY2FsZSBwYXJhbWV0
ZXIgaW4gbXkNCj4gY29kZSBhbmQgbm93IGkgY2FuIHNlZSB0aGUgY29ycmVjdCByZXN1bHRzLg0K
PiANCj4gVGhhbmsgeW91IHZlcnkgbXVjaCBmb3IgeXB1ciBoZWxwLg0KPiANCj4gRXNyYS4NCj4g
DQo+IFN0ZXZlbiBBIFJvd2Ugd3JvdGU6DQo+ID4gDQo+ID4gSGkgRXNyYSwNCj4gPiANCj4gPiBJ
IGhhdmUgYXR0YWNoZWQgYSBwYXRjaCB0byBMVUNFTkUtMTI3OSBjb250YWluaW5nIGEgbmV3IGNs
YXNzOg0KPiA+IENvbGxhdGluZ1JhbmdlUXVlcnkuDQo+ID4gDQo+ID4gVGhlIHBhdGNoIGFsc28g
Y29udGFpbnMgYSB0ZXN0IGNsYXNzOiBUZXN0Q29sbGF0aW5nUmFuZ2VRdWVyeS4gIE9uZSBvZg0K
PiA+IHRoZSB0ZXN0IG1ldGhvZHMgY2hlY2tzIGZvciB0aGUgRmFyc2kgcmFuZ2UgeW91IHdlcmUg
aGF2aW5nIHRyb3VibGUNCj4gPiB3aXRoLg0KPiA+IA0KPiA+IEl0IHNob3VsZCBiZSBtZW50aW9u
ZWQgdGhhdCBhY2NvcmRpbmcgdG8NCj4gPiBDb2xsYXRvci5nZXRBdmFpbGFibGVMb2NhbGVzKCks
IG5laXRoZXIgSmF2YSAxLjQuMiBub3IgSmF2YSAxLjUuMA0KPiA+IGNvbnRhaW5zIEZhcnNpIGNv
bGxhdGlvbiBpbmZvcm1hdGlvbi4gSG93ZXZlciwgaW4gdGhlIHRlc3QgY2xhc3MgSSB1c2UNCj4g
PiB0aGUgQXJhYmljIExvY2FsZSwgd2hpY2ggc2VlbXMgdG8gcHJvcGVybHkgY29sbGF0ZSB0aGUg
bm9uLUFyYWJpYyBGYXJzaQ0KPiA+IGxldHRlciBVKzA2OTgsIGFuZCBob3BlZnVsbHkgYmVoYXZl
cyB3ZWxsIHdpdGggb3RoZXIgRmFyc2kgbGV0dGVycy4gIElmDQo+ID4geW91IGZpbmQgdGhhdCB0
aGlzIGlzIG5vdCB0aGUgY2FzZSwgeW91IGNhbiBsb29rIGludG8gd3JpdGluZyBjb2xsYXRpb24N
Cj4gPiBydWxlcyB1c2luZyBSdWxlQmFzZWRDb2xsYXRvciAtIHlvdSBzaG91bGQgYmUgYWJsZSB0
byBkaXJlY3RseSBzcGVjaWZ5DQo+ID4gdGhlIHByb3BlciBsZXR0ZXIgb3JkZXJpbmdzIGZvciBG
YXJzaTsgQ29sbGF0aW5nUmFuZ2VRdWVyeSB3b3VsZCBhbHNvDQo+ID4gaGF2ZSB0byBzdXBwbHkg
YSBjb25zdHJ1Y3RvciB0aGF0IHRha2VzIGluIGEgQ29sbGF0b3IgaW5zdGVhZCBvZiBhDQo+ID4g
TG9jYWxlLg0KPiA+IA0KPiA+IFBsZWFzZSBnaXZlIHRoZSBjbGFzcyBhIHRyeSBhbmQgcG9zdCBi
YWNrIGFib3V0IGhvdyBpdCB3b3Jrcy4NCj4gPiANCj4gPiBUaGFua3MsDQo+ID4gU3RldmUNCj4g
PiANCj4gPiBPbiAwNS8wMy8yMDA4IGF0IDg6MzMgQU0sIGVzcmEgd3JvdGU6DQo+ID4gPiANCj4g
PiA+IEhpIFN0ZXZlbiwNCj4gPiA+IA0KPiA+ID4gdGhhbmtzIGZvciB5b3VyIGhlbHAuLi4uDQo+
ID4gPiANCj4gPiA+IEVzcmENCj4gPiA+IA0KPiA+ID4gDQo+ID4gPiBTdGV2ZW4gQSBSb3dlIHdy
b3RlOg0KPiA+ID4gPiANCj4gPiA+ID4gSGkgRXNyYSwNCj4gPiA+ID4gDQo+ID4gPiA+IEkgaGF2
ZSBjcmVhdGVkIGFuIGlzc3VlIGZvciB0aGlzIC0gc2VlDQo+ID4gPiA+IDxodHRwczovL2lzc3Vl
cy5hcGFjaGUub3JnL2ppcmEvYnJvd3NlL0xVQ0VORS0xMjc5Pi4NCj4gPiA+ID4gDQo+ID4gPiA+
IEknbGwgdHJ5IHRvIHRha2UgYSBjcmFjayBhdCBhIHBhdGNoIHRoaXMgd2Vla2VuZC4NCj4gPiA+
ID4gDQo+ID4gPiA+IFN0ZXZlDQo+ID4gPiA+IA0KPiA+ID4gPiBPbiAwNS8wMi8yMDA4IGF0IDEy
OjU1IFBNLCBlc3JhIHdyb3RlOg0KPiA+ID4gPiA+IA0KPiA+ID4gPiA+IEhpIFN0ZXZlbiAsDQo+
ID4gPiA+ID4gDQo+ID4gPiA+ID4geWVzIHlvdSBhcmUgcmlnaHQsIHNvcnJ5IGkgYW0gYSBiaXQg
Y29uZnVzZWQuDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gaSBjaGVja2VkIGFnYWluIGFuZCB0aGUg
Y29ycmVjdCBvbmUgaXMgICJ6aGUiL1UrNjk4Lg0KPiA+ID4gPiA+IA0KPiA+ID4gPiA+IEl0IHNl
ZW1zIHRoZSB3b3JkIGlzIGluIHRoZSByYW5nZSBidXQgbXkgY3VzdG9tZXIgc2F5cyBpdA0KPiA+
ID4gPiA+IHNob3VsZG4ndCBiZS4NCj4gPiA+ID4gPiANCj4gPiA+ID4gPiBJIHRoaW5rIHByb2Js
ZW0gb2NjdXJzIGJlY2F1c2UgICJ6aGUiIGlzIGEgUGVyc2lhbiBsZXR0ZXINCj4gPiA+ID4gPiBv
dXRzaWRlIHRoZSBBcmFiaWMNCj4gPiA+ID4gPiBhbHBoYWJldC4gSW4gZmFyc2kgYWxwaGFiZXQg
dGhpcyBsZXR0ZXIgaXMgbm90IGFmdGVyIHRoZSAi2LMiDQo+ID4gPiA+ID4gbGV0dGVyIGJ1dCBp
dCdzDQo+ID4gPiA+ID4gdW5pY29kZSBpcyBiaWdnZXIgdGhhbiAi2LMiIGxldHRlcidzIGFuZCB0
aGUgc2VhcmNoZXIgd29ya3MNCj4gPiA+ID4gPiB3aXRoIHVuaWNvZGVzLg0KPiA+ID4gPiA+IA0K
PiA+ID4gPiA+IEVzcmENCj4gPiA+ID4gPiANCj4gPiA+ID4gPiANCj4gPiA+ID4gPiBTdGV2ZW4g
QSBSb3dlIHdyb3RlOg0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiBIaSBFc3JhLA0KPiA+ID4g
PiA+ID4gDQo+ID4gPiA+ID4gPiBZb3UgYXJlICpzdGlsbCogaW5jb3JyZWN0bHkgcmVmZXJyaW5n
IHRvIHRoZSBnbHlwaCB3aXRoIHRocmVlIGRvdHMNCj4gPiA+ID4gPiA+IG92ZXIgaXQ6DQo+ID4g
PiA+ID4gPiANCj4gPiA+ID4gPiA+IE9uIDA1LzAyLzIwMDggYXQgMTI6MTggUE0sIGVzcmEgd3Jv
dGU6DQo+ID4gPiA+ID4gPiA+IHllcyB0aGUgY29ycmVjdCBvbmUgaXMgItqYICIvInplIi9VKzYz
Mi4NCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gItqYIiBpcyAqbm90KiAiemUiL1UrNjMyIC0g
aXQgaXMgInpoZSIvVSs2OTguDQo+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+IEhhdmUgeW91IGlu
Y3JlYXNlZCB0aGUgZm9udCBzaXplPyAgQ2FuIHlvdSBzZWUgdGhlIGRpZmZlcmVuY2UNCj4gPiA+
ID4gPiA+IGJldHdlZW4gdGhlc2UgdHdvPzoNCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gItqY
Ii8iemhlIi9VKzY5OA0KPiA+ID4gPiA+ID4gItiyIi8iemUiL1UrNjMyDQo+ID4gPiA+ID4gPiAN
Cj4gPiA+ID4gPiA+ID4gbXkgcHJvYmxlbSBpcyB3aGVuIGkgZG8gc2VhcmNoIGZvciAgItivLdqY
IiByYW5nZS4NCj4gVGhlIHJlc3VsdCBpcw0KPiA+ID4gItiz2KfYqA0KPiA+ID4gPiA+ID4gPiDZ
iNmI2YHYsSIgYW5kIHRoaXMgd29yZCdzIGZpcnN0IGxldHRlciBpcyAi2LMiIGFuZCBpdCdzIHVu
aWNvZGUgaXMNCj4gPiA+ID4gPiA+ID4gIlUrNjMzIiBhbmQgaXQgaXMgbm90IGluIHRoZSBpbiB0
aGUgWyBVKzA2MkYgLQ0KPiBVKzA2MzIgXSByYW5nZS4NCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+
ID4gTGlrZSBJIGtlZXAgc2F5aW5nLCBpbiB0aGUgYWJvdmUgZGVzY3JpcHRpb24sIHlvdSdyZQ0K
PiB1c2luZyB0aGUNCj4gPiA+IGdseXBoDQo+ID4gPiA+ID4gPiAi2pgiLyJ6aGUiL1UrNjk4LCB3
aGlsZSBjYWxsaW5nIGF0IHRoZSBzYW1lIHRpbWUgaW5jb3JyZWN0bHkNCj4gPiA+ID4gPiA+IHJl
ZmVycmluZyB0byBpdCBhcyAiemUiL1UrNjMyLg0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiBJ
IGRvbid0IG1lYW4gdG8gY29udGludWFsbHkgYmFuZyBvbiBhYm91dCB0aGlzIC0gaWYgeW91J3Jl
ICpzdXJlKg0KPiA+ID4gPiA+ID4gdGhhdCB3aGVuIHlvdSBzZWFyY2gsIHlvdSdyZSB1c2luZyB0
aGUgY2hhcmFjdGVyIHJlcHJlc2VudGVkIGJ5IHRoZQ0KPiA+ID4gPiA+ID4gZ2x5cGggd2l0aCBv
bmUgZG90IChhbmQgbm90IHRocmVlKSwgaS5lLiAi2LIiLyJ6ZSIvVSs2MzIsIHRoZW4gdGhlDQo+
ID4gPiA+ID4gPiBwcm9ibGVtIGxpZXMgZWxzZXdoZXJlLg0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+
ID4gPiBTdGV2ZQ0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiBPbiAwNS8wMi8yMDA4IGF0IDEy
OjE4IFBNLCBlc3JhIHdyb3RlOg0KPiA+ID4gPiA+ID4gPiB5ZXMgdGhlIGNvcnJlY3Qgb25lIGlz
ICLamCAiLyJ6ZSIvVSs2MzIuDQo+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiBteSBwcm9i
bGVtIGlzIHdoZW4gaSBkbyBzZWFyY2ggZm9yICAiICDYry3amCIgcmFuZ2UuIFRoZSByZXN1bHQg
aXMgDQo+ID4gPiA+ID4gPiA+ICIi2LPYp9ioINmI2YjZgdixICIgYW5kIHRoaXMgd29yZCdzIGZp
cnN0IGxldHRlciBpcyAi2LMgIiBhbmQgaXQncyB1bmljb2RlDQo+ID4gPiA+ID4gPiA+IGlzICJV
KzYzMyIgIGFuZCAgaXQgaXMgbm90IGluIHRoZSBpbiB0aGUgWyBVKzA2MkYgLSBVKzA2MzIgXSBy
YW5nZS4NCj4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+IGFtIGkgd3Jvbmc/DQo+ID4gPiA+
ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiBFc3JhDQo+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4g
PiBTdGV2ZW4gQSBSb3dlIHdyb3RlOg0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+
IEhpIEVzcmEsDQo+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gSSBzdGlsbCB0aGlu
ayB5b3UncmUgd3JvbmcgOikuDQo+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gT24g
MDUvMDIvMjAwOCBhdCA5OjMxIEFNLCBlc3JhIHdyb3RlOg0KPiA+ID4gPiA+ID4gPiA+ID4gPiDa
mCA9IFUrNjMyDQo+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gQWNjb3JkaW5nIHRv
IHRoZSB3ZWJzaXRlIHlvdSBsaW5rZWQgdG8sIHRoZQ0KPiBhYm92ZSBjaGFyYWN0ZXIsDQo+ID4g
PiB3aGljaA0KPiA+ID4gPiA+ID4gPiA+IGhhcyB0aHJlZSBkb3RzIG92ZXIgaXQsIGlzIG5hbWVk
ICJ6aGUiLCBhbmQgaXRzDQo+ID4gPiBVbmljb2RlIGNvZGUgcG9pbnQNCj4gPiA+ID4gPiBpcw0K
PiA+ID4gPiA+ID4gPiA+IFUrNjk4LiAoSSBoYWQgdG8gaW5jcmVhc2UgdGhlIGZvbnQgc2l6ZSB0
byBzZWUgdGhlIHRocmVlIGRvdHMuKQ0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+
IEkgdGhpbmsgeW91IGFyZSBjb25mdXNpbmcgItqYIi8iemhlIi9VKzY5OCB3aXRoIHRoZSBsZXR0
ZXINCj4gPiA+ID4gPiA+ID4gPiAi2LIiLyJ6ZSIvVSs2MzIsIHdoaWNoIGhhcyBqdXN0IG9uZSBk
b3Qgb3ZlciBpdC4NCj4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiBVbmxlc3MgeW91
IHdlcmUgbWlzdGFrZW4gaW4gYWxsIG9mIHlvdXIgZW1haWxzIHdoZW4NCj4gPiA+IHlvdSBpbmNs
dWRlZA0KPiA+ID4gPiA+IHRoZQ0KPiA+ID4gPiA+ID4gPiA+IGNoYXJhY3RlciAi2pgiLyJ6aGUi
IGluc3RlYWQgb2YgItiyIi8iemUiLCB0aGVuIHdoYXQgSSBzYWlkIGluIG15DQo+ID4gPiA+ID4g
PiA+ID4gcHJldmlvdXMgZW1haWwgc3RpbGwgc3RhbmRzOiB0aGVyZSBpcyBubyBwcm9ibGVtIGhl
cmUuDQo+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gU3RldmUNCj4gPiA+ID4gPiA+
ID4gPiANCj4gPiA+ID4gPiA+ID4gPiBPbiAwNS8wMi8yMDA4IGF0IDk6MzEgQU0sIGVzcmEgd3Jv
dGU6DQo+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+IEhpIFN0ZXZlbiwNCj4g
PiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gc29ycnkgaSBtYWRlIGEgbWlzdGFr
ZS4gdW5pY29kZXMgYXJlIGxpa2UgdGhpczoNCj4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+
ID4gPiA+ID4gPiDYrz1VKzYyRg0KPiA+ID4gPiA+ID4gPiA+ID4gPiDamCA9IFUrNjMyDQo+ID4g
PiA+ID4gPiA+ID4gPiA+IGFuZCB0aGUgZmlyc3QgbGV0dGVyIG9mICLYs9in2Kgg2YjZiNmB2LEg
IiBpcyAg2LMgPSBVKzYzMw0KPiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiB5
b3UgY2FuIGFsc28gY2hlY2sgdGhlbSBoZXJlDQo+ID4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4g
PiA+IGh0dHA6Ly93d3cudW5pY3MudW5pLWhhbm5vdmVyLmRlL25odGNhcHJpL3BlcnNpYW4tYWxw
aGFiZXQuaHRtbA0KPiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiBFc3JhDQo+
ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4g
U3RldmVuIEEgUm93ZSB3cm90ZToNCj4gPiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+
ID4gPiA+IEhpIEVzcmEsDQo+ID4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4g
PiBHb2luZyBiYWNrIHRvIHRoZSBvcmlnaW5hbCBwcm9ibGVtIHN0YXRlbWVudCwgSQ0KPiA+ID4g
c2VlIHNvbWV0aGluZw0KPiA+ID4gPiA+IHRoYXQNCj4gPiA+ID4gPiA+ID4gPiA+ID4gbG9va3Mg
aWxsb2dpY2FsIHRvIG1lIC0gcGxlYXNlIGNvcnJlY3QgbWUgaWYgSSdtIHdyb25nOg0KPiA+ID4g
PiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gT24gQXByIDMwLCAyMDA4LCBhdCAz
OjIxIEFNLCBlc3JhIHdyb3RlOg0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+IGkgYW0gdXNpbmcgbHVj
ZW5lJ3MgIkluZGV4U2VhcmNoZXIiIHRvIHNlYXJjaA0KPiA+ID4gdGhlIGdpdmVuIHhtbA0KPiA+
ID4gPiA+IGJ5DQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4ga2V5d29yZCB3aGljaCBjb250YWlucyBm
YXJzaSBpbmZvcm1hdGlvbi4NCj4gPiA+IHdoaWxlIHNlYXJjaGluZyBpDQo+ID4gPiA+ID4gdXNl
DQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gcmFuZ2VzIGxpa2UNCj4gPiA+ID4gPiA+ID4gPiA+ID4g
PiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiDYoi3YqyAgfCAg2Kwt2K4gIHwgINivLdqYICB8ICDY
sy3YuCAgfCAg2Lkt2YIgIHwgINqpLdmEICB8ICDZhS3bjA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+
IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+IHdoZW4gaSBkbyBzZWFyY2ggZm9yICAi2K8t2pgiICBy
YW5nZSB0aGUgcmVzdWx0cw0KPiA+ID4gYXJlIHdyb25nICwNCj4gPiA+ID4gPiB0aGV5DQo+ID4g
PiA+ID4gPiA+ID4gPiA+ID4gYXJlIHRoZSByZXN1bHRzIG9mICAiINizLdi4ICJyYW5nZS4NCj4g
PiA+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiBmb3IgZXhhbXBsZSB3
aGVuIGkgZG8gc2VhcmNoIGZvciAi2K8t2pgiDQo+IG9uZSBvZiB0aGUgdGhlDQo+ID4gPiByZXN1
bHRzDQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gaXMgItiz2KfYqCDZiNmI2YHYsSIsIHRoaXMgcmVz
dWx0IGFsc28gc2hvd24gb24gdGhlICINCj4gPiA+INizLdi4ICIgcmFuZ2Uncw0KPiA+ID4gPiA+
IHJlc3VsdA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+IGxpc3Qgd2hpY2ggaXMgdGhlIGNvcnJldCBy
YW5nZS4NCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiBBcyBJ
bmRleFNlYXJjaGVyIHVzZSAiY29tcGFyZVRvIiBtZXRob2QNCj4gYW5kIHRoaXMgbWV0aG9kDQo+
ID4gPiB1c2VzDQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gdW5pY29kZXMgZm9yIGNvbXBhcmluZywg
aSBmb3VuZCB0aGUgdW5pY29kZXMgb2YgdGhlIGNoYXJhY3RlcnMuDQo+ID4gPiA+ID4gPiA+ID4g
PiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4g2K89VSs2MkYNCj4gPiA+ID4gPiA+ID4gPiA+
ID4gPiDamCA9IFUrNjk4DQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gYW5kIHRoZSBmaXJzdCBsZXR0
ZXIgb2YgItiz2KfYqCDZiNmI2YHYsSAiIGlzICDYsyA9IFUrNjMzDQo+ID4gPiA+ID4gPiA+ID4g
PiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiBJdCBhcHBlYXJzIHRvIG1lIHRoYXQgKmJvdGgqIHRo
ZSAi2K8t2pgiIHJhbmdlIFsNCj4gPiA+ID4gPiBVKzA2MkYgLSBVKzA2OTggXQ0KPiA+ID4gPiA+
ID4gPiBhbmQNCj4gPiA+ID4gPiA+ID4gPiA+ID4gdGhlICLYsy3YuCIgcmFuZ2UgWyBVKzA2MzMg
LSBVKzA2MzggXSBjb250YWluIHRoZQ0KPiA+ID4gPiA+IGZpcnN0IGxldHRlciBvZg0KPiA+ID4g
PiA+ID4gPiAi2LPYp9ioDQo+ID4gPiA+ID4gPiA+ID4gPiA+INmI2YjZgdixIiwgd2hpY2ggaXMg
ItizIiA9IFUrMDYzMy4NCj4gPiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiA+
IFlvdSBzdGF0ZWQgdGhhdCBVKzA2MzMgc2hvdWxkIGJlIGNvbnRhaW5lZCBpbiB0aGUgWw0KPiA+
ID4gPiA+IFUrMDYzMyAtIFUrMDYzOA0KPiA+ID4gPiA+ID4gPiBdDQo+ID4gPiA+ID4gPiA+ID4g
PiA+IHJhbmdlIC0gSSBhZ3JlZSAtIGJ1dCB3aHkgZG8geW91IHRoaW5rIFUrMDYzMyBzaG91bGQg
bm90IGJlDQo+ID4gPiA+ID4gPiA+ID4gPiA+IGNvbnRhaW5lZCBpbiB0aGUgWyBVKzA2MkYgLSBV
KzA2OTggXSByYW5nZT8NCj4gPiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiA+
IEluIG90aGVyIHdvcmRzLCBpdCBsb29rcyB0byBtZSBsaWtlIHlvdXIgcHJvYmxlbSBpcw0KPiA+
ID4gPiA+IG5vdCBhIHByb2JsZW0NCj4gPiA+ID4gPiA+ID4gYXQNCj4gPiA+ID4gPiA+ID4gPiA+
ID4gYWxsLg0KPiA+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gU3RldmUN
Cj4gPiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4g
PiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiAtLSBWaWV3IHRoaXMgbWVzc2FnZSBpbiBjb250ZXh0
Og0KPiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiBodHRw
Oi8vd3d3Lm5hYmJsZS5jb20vbHVjZW5lLWZhcnNpLXByb2JsZW0tdHAxNjk3NzA5NnAxNzAxOTQ5
OA0KPiA+ID4gPiA+ID4gPiAuaHRtbCBTZW50DQo+ID4gPiA+ID4gPiA+ID4gZnJvbSB0aGUgTHVj
ZW5lIC0gSmF2YSBVc2VycyBtYWlsaW5nIGxpc3QgYXJjaGl2ZSBhdCBOYWJibGUuY29tLg0KPiA+
ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4g
PiA+IA0KPiA+ID4gDQo+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KPiA+ID4gPiA+ID4gPiBUbw0KPiA+ID4gPiA+
ID4gPiA+IHVuc3Vic2NyaWJlLCBlLW1haWw6DQo+IGphdmEtdXNlci11bnN1YnNjcmliZUBsdWNl
bmUuYXBhY2hlLm9yZw0KPiA+ID4gRm9yDQo+ID4gPiA+ID4gPiA+ID4gYWRkaXRpb25hbCBjb21t
YW5kcywgZS1tYWlsOiBqYXZhLXVzZXItaGVscEBsdWNlbmUuYXBhY2hlLm9yZw0KPiA+ID4gPiA+
ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4g
DQo+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+
ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiAtLSBWaWV3IHRoaXMgbWVzc2FnZSBpbiBjb250ZXh0Og0K
PiA+ID4gPiA+ID4gDQo+ID4gPiBodHRwOi8vd3d3Lm5hYmJsZS5jb20vbHVjZW5lLWZhcnNpLXBy
b2JsZW0tdHAxNjk3NzA5NnAxNzAyMjg2MS5odG1sDQo+ID4gPiA+ID4gPiAgU2VudCBmcm9tIHRo
ZSBMdWNlbmUgLSBKYXZhIFVzZXJzIG1haWxpbmcgbGlzdCBhcmNoaXZlIGF0DQo+ID4gPiA+ID4g
TmFiYmxlLmNvbS4NCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiANCj4g
PiA+ID4gPiANCj4gPiA+IA0KPiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4gPiA+ID4gPiA+ICBUbyB1bnN1YnNj
cmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVAbHVjZW5lLmFwYWNoZS5vcmcNCj4g
PiA+ID4gPiA+ICBGb3IgYWRkaXRpb25hbCBjb21tYW5kcywgZS1tYWlsOg0KPiA+ID4gamF2YS11
c2VyLWhlbHBAbHVjZW5lLmFwYWNoZS5vcmcNCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gDQo+
ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+ID4g
PiA+ID4gLS0gVmlldyB0aGlzIG1lc3NhZ2UgaW4gY29udGV4dDoNCj4gPiA+ID4gPiANCj4gPiA+
IGh0dHA6Ly93d3cubmFiYmxlLmNvbS9sdWNlbmUtZmFyc2ktcHJvYmxlbS10cDE2OTc3MDk2cDE3
MDIzNTU3DQo+ID4gPiAuaHRtbCBTZW50DQo+ID4gPiA+IGZyb20gdGhlIEx1Y2VuZSAtIEphdmEg
VXNlcnMgbWFpbGluZyBsaXN0IGFyY2hpdmUgYXQgTmFiYmxlLmNvbS4NCj4gPiA+ID4gDQo+ID4g
PiA+IA0KPiA+ID4gPiANCj4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQo+ID4gPiBUbw0KPiA+ID4gPiB1bnN1YnNj
cmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVAbHVjZW5lLmFwYWNoZS5vcmcgRm9y
DQo+ID4gPiA+IGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDogamF2YS11c2VyLWhlbHBAbHVj
ZW5lLmFwYWNoZS5vcmcNCj4gPiA+ID4gDQo+ID4gPiA+IA0KPiA+ID4gDQo+ID4gPiANCj4gPiA+
IA0KPiA+ID4gDQo+ID4gPiANCj4gPiA+IA0KPiA+ICAtLSBWaWV3IHRoaXMgbWVzc2FnZSBpbiBj
b250ZXh0Og0KPiA+ICBodHRwOi8vd3d3Lm5hYmJsZS5jb20vbHVjZW5lLWZhcnNpLXByb2JsZW0t
dHAxNjk3NzA5NnAxNzAzNDcxNS5odG1sDQo+ID4gIFNlbnQgZnJvbSB0aGUgTHVjZW5lIC0gSmF2
YSBVc2VycyBtYWlsaW5nIGxpc3QgYXJjaGl2ZSBhdA0KPiBOYWJibGUuY29tLg0KPiA+IA0KPiA+
IA0KPiA+IA0KPiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4gPiAgVG8gdW5zdWJzY3JpYmUsIGUtbWFpbDogamF2
YS11c2VyLXVuc3Vic2NyaWJlQGx1Y2VuZS5hcGFjaGUub3JnDQo+ID4gIEZvciBhZGRpdGlvbmFs
IGNvbW1hbmRzLCBlLW1haWw6IGphdmEtdXNlci1oZWxwQGx1Y2VuZS5hcGFjaGUub3JnDQo+ID4g
DQo+ID4gDQo+ID4gDQo+ID4gDQo+ID4gDQo+IA0KPiAtLSBWaWV3IHRoaXMgbWVzc2FnZSBpbiBj
b250ZXh0Og0KPiBodHRwOi8vd3d3Lm5hYmJsZS5jb20vbHVjZW5lLWZhcnNpLXByb2JsZW0tdHAx
Njk3NzA5NnAxNzA4MDg1Mi5odG1sIFNlbnQNCj4gZnJvbSB0aGUgTHVjZW5lIC0gSmF2YSBVc2Vy
cyBtYWlsaW5nIGxpc3QgYXJjaGl2ZSBhdCBOYWJibGUuY29tLg0KPiANCj4gDQo+IC0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLSBUbw0KPiB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVAbHVj
ZW5lLmFwYWNoZS5vcmcgRm9yDQo+IGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDogamF2YS11
c2VyLWhlbHBAbHVjZW5lLmFwYWNoZS5vcmcNCj4gDQo+DQoNCiANCg0K


From java-user-return-33968-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 16:19:21 2008
Return-Path: <java-user-return-33968-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61919 invoked from network); 7 May 2008 16:19:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 16:19:21 -0000
Received: (qmail 61526 invoked by uid 500); 7 May 2008 16:19:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61262 invoked by uid 500); 7 May 2008 16:19:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61251 invoked by uid 99); 7 May 2008 16:19:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 09:19:15 -0700
X-ASF-Spam-Status: No, hits=-3.8 required=10.0
	tests=NORMAL_HTTP_TO_IP,RCVD_IN_DNSWL_MED,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.108.46] (HELO SUEXCL-02.ad.syr.edu) (128.230.108.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 16:18:21 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
Subject: RE: lucene farsi problem
Date: Wed, 7 May 2008 12:17:04 -0400
Message-ID: <9294E20AED46934EA459020706463F94A04BF4@SUEXCL-02.ad.syr.edu>
In-Reply-To: <17098552.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: lucene farsi problem
Thread-Index: AciwD05JnMQA8FwdTZajRL9PEJeYuAASpjmw
From: "Steven A Rowe" <sarowe@syr.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgUFYsDQoNCk9uIDA1LzA3LzIwMDggYXQgMjo1NCBBTSwgUFYgd3JvdGU6DQo+IFNvcnJ5IGZv
ciBjcm9zcyBwb3N0aW5nLCBidXQgd2h5IHRoZSB3b3JkICdGYXJzaScgaW5zdGVhZCBvZg0KPiAn
UGVyc2lhbic/ICBObyBvbmUgc2F5cyBMdWNuY2UgZnJhbsOnYWlzIG9yIEVzcGHDsW9sLCBvciBE
ZXV0c2NoIC0gc28gd2h5IEZhcnNpPw0KPiANCj4gUGxlYXNlIHJlYWQgdGhlIGZvbGxvd2luZyBh
cnRpY2xlLCBJIGZvdW5kIGl0IHF1aXRlIGVubGlnaHRlbmluZy4NCj4gaHR0cDovL3d3dy5jYWlz
LXNvYXMuY29tL0NBSVMvTGFuZ3VhZ2VzL3BlcnNpYW5fbm90X2ZhcnNpLmh0bQ0KPiANCj4gUFYN
Cg0KSSB3YXMgdW5hYmxlIHRvIGZvbGxvdyB5b3VyIGxpbmsgLS0gSSBnZXQgdGhlIG1lc3NhZ2Ug
IlRoZSBwYWdlIGNhbm5vdCBiZSBmb3VuZCIgLS0gYnV0IEdvb2dsZSdzIGNhY2hlIGNhbWUgdG8g
bXkgcmVzY3VlOg0KDQo8aHR0cDovLzIwOS44NS4xNjUuMTA0L3NlYXJjaD9xPWNhY2hlOnZKbzF5
ZTA5TXpZSjp3d3cuY2Fpcy1zb2FzLmNvbS9DQUlTL0xhbmd1YWdlcy9wZXJzaWFuX25vdF9mYXJz
aS5odG0rcGVyc2lhbitmYXJzaStzaXRlOmNhaXMtc29hcy5jb20maGw9ZW4mY3Q9Y2xuayZjZD0x
JmdsPXVzJmNsaWVudD1maXJlZm94LWE+DQoNClRoZSBhcnRpY2xlIG1ha2VzIGZpbmUgbG9naWNh
bCBhcmd1bWVudHMgYWdhaW5zdCB0aGUgdXNlIG9mICJGYXJzaSIsIGJ1dCBjbGVhcmx5IGRvZXMg
bm90IHRha2UgYSBiYWxhbmNlZCBwb2ludCBvZiB2aWV3IG9uIHRoZSBjb250cm92ZXJzeS4NCg0K
SSBjb3VudCBteXNlbGYgYW1vbmcgdGhlIGlnbm9yYW50IC0gSSBoYWQgbm90IHJlYWxpemVkIHRo
YXQgIkZhcnNpIiB3YXMgYSBwb2xpdGljYWxseSBjaGFyZ2VkIHRlcm0uICBUaGF0IHNhaWQsIEkg
ZG9uJ3QgcGxhbiBvbiByZWZ1c2luZyB0byB1c2UgdGhlIHRlcm0uICBJJ2xsIGp1c3QgdGhpbmsg
YWJvdXQgdGhlIGltcGFjdCBvZiB0aGUgY2hvaWNlIChub3cgdGhhdCBJJ20gYXdhcmUgdGhlcmUg
aXMgb25lKSBiZWZvcmUgSSBkbyB1c2UgaXQuDQoNClRoYW5rcyBmb3IgdGhlIHBvaW50ZXIuICBL
bm93bGVkZ2UgaXMgZ29vZC4NCg0KU3RldmUNCg0KT24gMDUvMDcvMjAwOCBhdCAyOjU0IEFNLCBW
aXp6aW5pIHdyb3RlOg0KPiANCj4gU29ycnkgZm9yIGNyb3NzIHBvc3RpbmcsIGJ1dCB3aHkgdGhl
IHdvcmQgJ0ZhcnNpJyBpbnN0ZWFkIG9mDQo+ICdQZXJzaWFuJz8gIE5vIG9uZSBzYXlzIEx1Y25j
ZSBmcmFuw6dhaXMgb3IgRXNwYcOxb2wsIG9yIERldXRzY2ggLSBzbyB3aHkgRmFyc2k/DQo+IA0K
PiBQbGVhc2UgcmVhZCB0aGUgZm9sbG93aW5nIGFydGljbGUsIEkgZm91bmQgaXQgcXVpdGUgZW5s
aWdodGVuaW5nLg0KPiBodHRwOi8vd3d3LmNhaXMtc29hcy5jb20vQ0FJUy9MYW5ndWFnZXMvcGVy
c2lhbl9ub3RfZmFyc2kuaHRtDQo+IA0KPiBQVg0KPiANCj4gLS0gVmlldyB0aGlzIG1lc3NhZ2Ug
aW4gY29udGV4dDoNCj4gaHR0cDovL3d3dy5uYWJibGUuY29tL2x1Y2VuZS1mYXJzaS1wcm9ibGVt
LXRwMTY5NzcwOTZwMTcwOTg1NTIuaHRtbCBTZW50DQo+IGZyb20gdGhlIEx1Y2VuZSAtIEphdmEg
VXNlcnMgbWFpbGluZyBsaXN0IGFyY2hpdmUgYXQgTmFiYmxlLmNvbS4NCg==


From java-user-return-33969-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 16:23:02 2008
Return-Path: <java-user-return-33969-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63143 invoked from network); 7 May 2008 16:23:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 16:23:01 -0000
Received: (qmail 70977 invoked by uid 500); 7 May 2008 16:22:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70768 invoked by uid 500); 7 May 2008 16:22:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70757 invoked by uid 99); 7 May 2008 16:22:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 09:22:55 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.25] (HELO smtp-vbr5.xs4all.nl) (194.109.24.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 16:22:02 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr5.xs4all.nl (8.13.8/8.13.8) with ESMTP id m47GMNos098982
	for <java-user@lucene.apache.org>; Wed, 7 May 2008 18:22:24 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Filtering a SpanQuery
Date: Wed, 7 May 2008 18:22:23 +0200
User-Agent: KMail/1.9.9
References: <74f928500805060115k6c6373bdib50b0e1ec88ecbbc@mail.gmail.com> <200805070934.19544.paul.elschot@xs4all.nl> <74f928500805070118l2adddae7g13db7c6e0180b4ab@mail.gmail.com>
In-Reply-To: <74f928500805070118l2adddae7g13db7c6e0180b4ab@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805071822.24048.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Op Wednesday 07 May 2008 10:18:38 schreef Eran Sevi:
> Thanks Paul for your reply,
>
> Since my index contains a couple of millions documents and the filter
> is supposed to limit the search space to a few thousands I was hoping
> I won't have to do the filtering myself after running the query on
> all the index.

The code I gave earlier effectively does a filtered query search
on the index. It visits the resulting Spans, and does not provide
a score value per document as SpanScorer would do.
Please make sure to test that code thoroughly for reliable results.

>
> Maybe this is the case anyway and behind the scenes the filter does
> exactly what you suggested.

Yes, a filtered query search would use skipTo() on the Spans via
SpanScorer. But the difference between the normal case
and your case is that you don't need SpanScorer.

> From what I tested the number of results of the SpanQuery greatly
> affects the running speed so if I'm going to use about 0.1% of the
> results I'm loosing a lot of time and memory for gathering and
> storing the spans I'm not going to use.
>
> I don't know how SpanQuery works internally but I guess that if the
> filter is known beforehand,

A Filter needs to make a BitSet available before the query search.

> it could speed things up quite a bit. 

I would expect a substantial speedup from using skipTo() on the
Spans when only 0.1% of the results passes the filter.

Regards,
Paul Elschot

> Eran.
>
>
> On Wed, May 7, 2008 at 10:34 AM, Paul Elschot
> <paul.elschot@xs4all.nl>
>
> wrote:
> > Op Tuesday 06 May 2008 17:39:38 schreef Paul Elschot:
> > > Eran,
> > >
> > > Op Tuesday 06 May 2008 10:15:10 schreef Eran Sevi:
> > > > Hi,
> > > >
> > > > I am looking for a way to filter a SpanQuery according to some
> > > > other query (on another field from the one used for the
> > > > SpanQuery). I need to get access to the spans themselves of
> > > > course. I don't care about the scoring of the filter results
> > > > and just need the positions of hits found in the documents that
> > > > matches the filter.
> > >
> > > I think you'll have to implement the filtering on the Spans
> > > yourself. That's not really difficult, just use Spans.skipTo().
> > > The code to do that could look sth like this (untested):
> > >
> > > Spans spans = yourSpanQuery.getSpans(reader);
> > > BitSet bits = yourFilter.bits(reader);
> > > int filterDoc = bits.nextSetBit(0);
> > > while ((filterDoc >= 0) and spans.skipTo(filterDoc)) {
> > >   boolean more = true;
> > >   while (more and (spans.doc() == filterDoc)) {
> > >      // use spans.start() and spans.end() here
> > >      // ...
> > >      more = spans.next();
> > >   }
> > >   if (! more) {
> > >     break;
> > >   }
> > >   filterDoc = bits.nextSetBit(spans.doc());
> >
> > At this point, no skipping on the spans should be done when
> > filterDoc equals spans.doc(), so this code still needs some work.
> > But I think you get the idea.
> >
> > Regards,
> > Paul Elschot
> >
> > > }
> > >
> > > Please check the javadocs of java.util.BitSet, there may
> > > be a 1 off error in the arguments to nextSetBit().
> > >
> > > Regards,
> > > Paul Elschot
> > >
> > > > I tried looking through the archives and found some reference
> > > > to a SpanQueryFilter patch, however I don't see how it can help
> > > > me achieve what I want to do. This class receives only one
> > > > query parameter (which I guess is the actual query) and not a
> > > > query and a filter for example.
> > > >
> > > > Any help about how I can achieve this will be appreciated.
> > > >
> > > > Thanks,
> > > > Eran.
> > >
> > > -----------------------------------------------------------------
> > >---- To unsubscribe, e-mail:
> > > java-user-unsubscribe@lucene.apache.org For additional commands,
> > > e-mail: java-user-help@lucene.apache.org
> >
> > -------------------------------------------------------------------
> >-- To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33970-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 17:54:32 2008
Return-Path: <java-user-return-33970-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28277 invoked from network); 7 May 2008 17:54:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 17:54:32 -0000
Received: (qmail 14352 invoked by uid 500); 7 May 2008 17:54:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14323 invoked by uid 500); 7 May 2008 17:54:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14310 invoked by uid 99); 7 May 2008 17:54:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 10:54:26 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 17:53:31 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 5E94A71C340; Wed,  7 May 2008 10:53:52 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 1565571C316
	for <java-user@lucene.apache.org>; Wed,  7 May 2008 10:53:52 -0700 (PDT)
Date: Wed, 7 May 2008 10:53:52 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Serious Index Corruption Error - FileNotFoundException 
In-Reply-To: <48218C59.2030100@stimulussoft.com>
Message-ID: <Pine.LNX.4.62.0805071052240.23208@radix.cryptio.net>
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com>
 <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com>
 <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com>
 <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com>
 <48218C59.2030100@stimulussoft.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


http://people.apache.org/~hossman/#threadhijack

Thread Hijacking on Mailing Lists

When starting a new discussion on a mailing list, please do not reply to 
an existing message, instead start a fresh email.  Even if you change the 
subject line of your email, other mail headers still track which thread 
you replied to and your question is "hidden" in that thread and gets less 
attention.   It makes following discussions in the mailing list archives 
particularly difficult.
See Also:  http://en.wikipedia.org/wiki/Thread_hijacking




: Message-ID: <48218C59.2030100@stimulussoft.com>
: Subject: Serious Index Corruption Error - FileNotFoundException 
: References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com>
:     <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com>
:     <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com>
:     <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com>
: In-Reply-To: <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com>

-Hoss

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33971-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 07 22:54:01 2008
Return-Path: <java-user-return-33971-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50691 invoked from network); 7 May 2008 22:54:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 May 2008 22:54:01 -0000
Received: (qmail 53105 invoked by uid 500); 7 May 2008 22:53:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52700 invoked by uid 500); 7 May 2008 22:53:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52689 invoked by uid 99); 7 May 2008 22:53:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 15:53:54 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chris.lu@gmail.com designates 209.85.134.191 as permitted sender)
Received: from [209.85.134.191] (HELO mu-out-0910.google.com) (209.85.134.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 May 2008 22:53:06 +0000
Received: by mu-out-0910.google.com with SMTP id g7so504117muf.5
        for <java-user@lucene.apache.org>; Wed, 07 May 2008 15:53:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=j9dJqOhw5E51rydzTHpsAbwWpiTNtCCDOMlwpObXWX8=;
        b=x60B4XDHKNVEspjVzoHTuM12aBSEoxtbVqttq/GuxlwbvWCzdwZoq0e+Ia41N4GB9EWf34JY9OVX4YEX+SqSQcfo7gpJFO/OV1tpjDexQHe5WDbZfsZ+8657jCTWF6M9PtX2nRUzfL1rl7V/jYDsP/1w6UkFTo0G2UThxIVJrEw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=UwFoEW/pvZ9VsqxTcf80DpjZXvbArZiyCwjXOKRt6p9PNymg2WS42UURg+PGqN1/PJznuleldtA3p3qqFXJuRxlLtaIrtlIYMg33E065VL9+UYhVkk9a/dW2XCZSKsBNbX/7XB8BjLaKyK0Bv/SBHlkP9Xx0tSq/athZBlK/2Ls=
Received: by 10.78.143.13 with SMTP id q13mr736218hud.35.1210200799453;
        Wed, 07 May 2008 15:53:19 -0700 (PDT)
Received: by 10.78.155.15 with HTTP; Wed, 7 May 2008 15:53:19 -0700 (PDT)
Message-ID: <6e3ae6310805071553n51c98df2t394e2e9fd55aed7c@mail.gmail.com>
Date: Wed, 7 May 2008 15:53:19 -0700
From: "Chris Lu" <chris.lu@gmail.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Subject: how to change the segment file names
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_29696_15240585.1210200799453"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_29696_15240585.1210200799453
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Currently, segment file names all start with _0, and increase with each new
segment created. But seems there is no easy way to change the segment file
names.

This causes trouble when copying one index to another index's directory, if
the .cfs files have the same name.

How to change the segmant file names after it's built?
Or, how to set a different starting counter for the segment file names?

Thanks!

-- 
Chris Lu
-------------------------
Instant Scalable Full-Text Search On Any Database/Application
site: http://www.dbsight.net
demo: http://search.dbsight.com
Lucene Database Search in 3 minutes:
http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
DBSight customer, a shopping comparison site, (anonymous per request) got
2.6 Million Euro funding!

------=_Part_29696_15240585.1210200799453--

From java-user-return-33972-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 07:44:22 2008
Return-Path: <java-user-return-33972-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95149 invoked from network); 8 May 2008 07:44:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 07:44:22 -0000
Received: (qmail 54075 invoked by uid 500); 8 May 2008 07:44:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54052 invoked by uid 500); 8 May 2008 07:44:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54041 invoked by uid 99); 8 May 2008 07:44:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 00:44:16 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [216.75.55.147] (HELO stimulussoft.com) (216.75.55.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 07:43:29 +0000
Received: (qmail 9511 invoked by uid 511); 8 May 2008 00:43:43 -0700
Received: from 41.243.250.164 by live.stimulussoft.com (envelope-from <jamie@stimulussoft.com>, uid 509) with qmail-scanner-1.25-st-qms 
 (spamassassin: 3.2.3. perlscan: 1.25-st-qms.  
 Clear:RC:0(41.243.250.164):SA:0(-1.9/5.0):. 
 Processed in 2.519127 secs); 08 May 2008 07:43:43 -0000
X-Antivirus-MYDOMAIN-Mail-From: jamie@stimulussoft.com via live.stimulussoft.com
X-Antivirus-MYDOMAIN: 1.25-st-qms (Clear:RC:0(41.243.250.164):SA:0(-1.9/5.0):. Processed in 2.519127 secs Process 9501)
Received: from dsl-243-250-164.telkomadsl.co.za (HELO ?192.168.0.50?) (jamie@stimulussoft.com@41.243.250.164)
  by stimulussoft.com with SMTP; 8 May 2008 00:43:40 -0700
Message-ID: <4822B00F.3070308@stimulussoft.com>
Date: Thu, 08 May 2008 09:47:27 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Serious Index Corruption Error - FileNotFoundException
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com> <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com> <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com> <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com> <48218C59.2030100@stimulussoft.com> <BCF0F18B-E6F8-4DEC-8B09-414C0202AD3B@mikemccandless.com>
In-Reply-To: <BCF0F18B-E6F8-4DEC-8B09-414C0202AD3B@mikemccandless.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-1.9 required=5.0

Hi Mike

Thanks for the suggestions. I've implemented all of them. The main 
reason why I manually deleted the lock file was that sometimes users 
kill the server process manually or there is a hard reboot without any 
warning. In such circumstances, Lucene leaves a lock file lying around 
as it was busy writing to the index. Now, I understand that one 
shouldn't simply delete the lock file, but what do you suggest my users 
do? The server must continue running... the only way that I see how is 
to delete the lock file, unless there is the equivalent of chkdsk for 
Lucene indexes that I could run.

Regards,

Jmaie


Michael McCandless wrote:
>
> On quickly looking through the code I think there are some serious 
> hazards that could lead to this exception.
>
> First, in your openIndex code, if you hit a LockObtainFailedException 
> in trying to open your writer, you are forcefully removing the write 
> lock and then retrying.  Yet, you also open an IndexReader to delete 
> documents, which acquires the write lock.  If ever you have this 
> IndexReader open, and then you forcefully remove the write lock and 
> open the writer, that would cause this exception.
>
> Second, you have a deletIndex method, which first tries to use the 
> writer with create=true (good) but then falls back to manually 
> removing the files.  Why is that fallback necessary?  If, for example, 
> you are also hitting a LockObtainFailedException, then forcefully 
> removing files while an IndexReader or IndexWriter holds the write 
> lock is also dangerous and would lead to this exception.
>
> In general it's very dangerous to forcibly remove, or ignore, Lucene's 
> write lock.  It really should only be necessary when something 
> catastrophic occurred (JVM crashed).
>
> Also, note that IndexWriter can now delete documents.  This would 
> simplify your code and possibly fix these two hazards.
>
> Do you see any of the error/warnings that you send to your logger?  
> (They would be corroborating evidence here).
>
> Mike


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33973-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 07:56:06 2008
Return-Path: <java-user-return-33973-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98688 invoked from network); 8 May 2008 07:56:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 07:56:05 -0000
Received: (qmail 73545 invoked by uid 500); 8 May 2008 07:56:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73518 invoked by uid 500); 8 May 2008 07:56:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73507 invoked by uid 99); 8 May 2008 07:56:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 00:56:00 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [66.249.82.225] (HELO wx-out-0506.google.com) (66.249.82.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 07:55:13 +0000
Received: by wx-out-0506.google.com with SMTP id h29so597463wxd.20
        for <java-user@lucene.apache.org>; Thu, 08 May 2008 00:55:27 -0700 (PDT)
Received: by 10.90.52.1 with SMTP id z1mr4343346agz.72.1210233326920;
        Thu, 08 May 2008 00:55:26 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 38sm2217324aga.38.2008.05.08.00.55.26
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 08 May 2008 00:55:26 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <4822B00F.3070308@stimulussoft.com>
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com> <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com> <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com> <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com> <48218C59.2030100@stimulussoft.com> <BCF0F18B-E6F8-4DEC-8B09-414C0202AD3B@mikemccandless.com> <4822B00F.3070308@stimulussoft.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <E206CA64-F840-4E6D-994D-DF33FE3C5AAA@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: Serious Index Corruption Error - FileNotFoundException
Date: Thu, 8 May 2008 03:55:25 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


OK, that sounds like a legitimate reason to forcibly remove the write  
lock, but it would be better to do that only on startup of your  
process rather than in every openIndex() call.

If ever you hit LockObtainFailedException in openIndex, even after  
having deleted the write lock on startup, then that means there's a  
bug (ie, two writers are in fact trying to open on the same index,  
one of the two cases below).

Mike

Jamie wrote:
> Hi Mike
>
> Thanks for the suggestions. I've implemented all of them. The main  
> reason why I manually deleted the lock file was that sometimes  
> users kill the server process manually or there is a hard reboot  
> without any warning. In such circumstances, Lucene leaves a lock  
> file lying around as it was busy writing to the index. Now, I  
> understand that one shouldn't simply delete the lock file, but what  
> do you suggest my users do? The server must continue running... the  
> only way that I see how is to delete the lock file, unless there is  
> the equivalent of chkdsk for Lucene indexes that I could run.
>
> Regards,
>
> Jmaie
>
>
> Michael McCandless wrote:
>>
>> On quickly looking through the code I think there are some serious  
>> hazards that could lead to this exception.
>>
>> First, in your openIndex code, if you hit a  
>> LockObtainFailedException in trying to open your writer, you are  
>> forcefully removing the write lock and then retrying.  Yet, you  
>> also open an IndexReader to delete documents, which acquires the  
>> write lock.  If ever you have this IndexReader open, and then you  
>> forcefully remove the write lock and open the writer, that would  
>> cause this exception.
>>
>> Second, you have a deletIndex method, which first tries to use the  
>> writer with create=true (good) but then falls back to manually  
>> removing the files.  Why is that fallback necessary?  If, for  
>> example, you are also hitting a LockObtainFailedException, then  
>> forcefully removing files while an IndexReader or IndexWriter  
>> holds the write lock is also dangerous and would lead to this  
>> exception.
>>
>> In general it's very dangerous to forcibly remove, or ignore,  
>> Lucene's write lock.  It really should only be necessary when  
>> something catastrophic occurred (JVM crashed).
>>
>> Also, note that IndexWriter can now delete documents.  This would  
>> simplify your code and possibly fix these two hazards.
>>
>> Do you see any of the error/warnings that you send to your  
>> logger?  (They would be corroborating evidence here).
>>
>> Mike
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33974-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 08:02:57 2008
Return-Path: <java-user-return-33974-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99967 invoked from network); 8 May 2008 08:02:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 08:02:57 -0000
Received: (qmail 78179 invoked by uid 500); 8 May 2008 08:02:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78140 invoked by uid 500); 8 May 2008 08:02:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78129 invoked by uid 99); 8 May 2008 08:02:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 01:02:51 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [216.75.55.147] (HELO stimulussoft.com) (216.75.55.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 08:02:05 +0000
Received: (qmail 9695 invoked by uid 511); 8 May 2008 01:02:19 -0700
Received: from 41.243.250.164 by live.stimulussoft.com (envelope-from <jamie@stimulussoft.com>, uid 509) with qmail-scanner-1.25-st-qms 
 (spamassassin: 3.2.3. perlscan: 1.25-st-qms.  
 Clear:RC:0(41.243.250.164):SA:0(-1.9/5.0):. 
 Processed in 1.397995 secs); 08 May 2008 08:02:19 -0000
X-Antivirus-MYDOMAIN-Mail-From: jamie@stimulussoft.com via live.stimulussoft.com
X-Antivirus-MYDOMAIN: 1.25-st-qms (Clear:RC:0(41.243.250.164):SA:0(-1.9/5.0):. Processed in 1.397995 secs Process 9685)
Received: from dsl-243-250-164.telkomadsl.co.za (HELO ?192.168.0.50?) (jamie@stimulussoft.com@41.243.250.164)
  by stimulussoft.com with SMTP; 8 May 2008 01:02:17 -0700
Message-ID: <4822B474.8020806@stimulussoft.com>
Date: Thu, 08 May 2008 10:06:12 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Serious Index Corruption Error - FileNotFoundException
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com> <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com> <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com> <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com> <48218C59.2030100@stimulussoft.com> <BCF0F18B-E6F8-4DEC-8B09-414C0202AD3B@mikemccandless.com> <4822B00F.3070308@stimulussoft.com> <E206CA64-F840-4E6D-994D-DF33FE3C5AAA@mikemccandless.com>
In-Reply-To: <E206CA64-F840-4E6D-994D-DF33FE3C5AAA@mikemccandless.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-1.9 required=5.0

Hi Michael

I had in fact preempted you and moved the delete lock code to a startup 
function. However, I found a nice little optimization that seems to 
force the writer to close when the process is manually killed. I added a 
JVM shutdown hook (i.e. using Runtime.getRuntime().addShutdownHook(this) 
) that closes the writer. This seems to reduce the number of instances 
where the lock file is left lying around.  Perhaps, it is something that 
could be included in the base lucene code. Also, are you aware of any 
chkdsk like utility for Lucene? i.e. in the event that an index is 
corrupted through disk error or otherwise?

Many thanks!

Jamie


Michael McCandless wrote:
>
> OK, that sounds like a legitimate reason to forcibly remove the write 
> lock, but it would be better to do that only on startup of your 
> process rather than in every openIndex() call.
>
> If ever you hit LockObtainFailedException in openIndex, even after 
> having deleted the write lock on startup, then that means there's a 
> bug (ie, two writers are in fact trying to open on the same index, one 
> of the two cases below).
>
> Mike
>
> Jamie wrote:
>> Hi Mike
>>
>> Thanks for the suggestions. I've implemented all of them. The main 
>> reason why I manually deleted the lock file was that sometimes users 
>> kill the server process manually or there is a hard reboot without 
>> any warning. In such circumstances, Lucene leaves a lock file lying 
>> around as it was busy writing to the index. Now, I understand that 
>> one shouldn't simply delete the lock file, but what do you suggest my 
>> users do? The server must continue running... the only way that I see 
>> how is to delete the lock file, unless there is the equivalent of 
>> chkdsk for Lucene indexes that I could run.
>>
>> Regards,
>>
>> Jmaie
>>
>>
>> Michael McCandless wrote:
>>>
>>> On quickly looking through the code I think there are some serious 
>>> hazards that could lead to this exception.
>>>
>>> First, in your openIndex code, if you hit a 
>>> LockObtainFailedException in trying to open your writer, you are 
>>> forcefully removing the write lock and then retrying.  Yet, you also 
>>> open an IndexReader to delete documents, which acquires the write 
>>> lock.  If ever you have this IndexReader open, and then you 
>>> forcefully remove the write lock and open the writer, that would 
>>> cause this exception.
>>>
>>> Second, you have a deletIndex method, which first tries to use the 
>>> writer with create=true (good) but then falls back to manually 
>>> removing the files.  Why is that fallback necessary?  If, for 
>>> example, you are also hitting a LockObtainFailedException, then 
>>> forcefully removing files while an IndexReader or IndexWriter holds 
>>> the write lock is also dangerous and would lead to this exception.
>>>
>>> In general it's very dangerous to forcibly remove, or ignore, 
>>> Lucene's write lock.  It really should only be necessary when 
>>> something catastrophic occurred (JVM crashed).
>>>
>>> Also, note that IndexWriter can now delete documents.  This would 
>>> simplify your code and possibly fix these two hazards.
>>>
>>> Do you see any of the error/warnings that you send to your logger?  
>>> (They would be corroborating evidence here).
>>>
>>> Mike


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33975-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 08:05:44 2008
Return-Path: <java-user-return-33975-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1562 invoked from network); 8 May 2008 08:05:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 08:05:44 -0000
Received: (qmail 85485 invoked by uid 500); 8 May 2008 08:05:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85443 invoked by uid 500); 8 May 2008 08:05:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85432 invoked by uid 99); 8 May 2008 08:05:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 01:05:39 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 08:04:51 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Ju17h-0006Rt-4G
	for java-user@lucene.apache.org; Thu, 08 May 2008 01:05:05 -0700
Message-ID: <17122272.post@talk.nabble.com>
Date: Thu, 8 May 2008 01:05:05 -0700 (PDT)
From: JP O'Gorman <jp.ogorman@documatics.com>
To: java-user@lucene.apache.org
Subject: Using single or multiple indices for searching different entity
 types
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: jp.ogorman@documatics.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,

Just to provide some backround information. We have 4 main entities that we
can search over in our product. These entities represent... 
* Client Information (Has 30+ fields storing client information so user can
search clientName:"Ian")
* Project Information (Has 20+ fields)
* Contact Information (Has 30+ fields)
* Document Information (Has 5 fields with one containing tokenized text of
word, txt, pdf, etc documents)

All this information is stored within the one index. All the documents have
a type and an id field to uniquely identify the entity instance. We allow
the user to choose what entity types to search over e.g. Just Client and
Project information or all information etc. We use the type field to specify
what entity type to restrict the search to. 

My question surrounds the best mechanism to index this information? Should I
be storing these entities in different indices? This would mean I might have
to preform four searches if searching over all information and maybe lose
search relevance ordering. The problem with using one index is that I have a
large amount of fields for each Lucene document that are not populated or
relevent when the document represents only one of my entities.

Thank you,
JP

Also, I am a Lucene.Net user. Is this still the best place for me to post my
questions?
-- 
View this message in context: http://www.nabble.com/Using-single-or-multiple-indices-for-searching-different-entity-types-tp17122272p17122272.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33976-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 08:39:29 2008
Return-Path: <java-user-return-33976-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10381 invoked from network); 8 May 2008 08:39:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 08:39:29 -0000
Received: (qmail 32341 invoked by uid 500); 8 May 2008 08:39:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32311 invoked by uid 500); 8 May 2008 08:39:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32300 invoked by uid 99); 8 May 2008 08:39:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 01:39:23 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.233.178.245] (HELO hs-out-0708.google.com) (64.233.178.245)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 08:38:36 +0000
Received: by hs-out-0708.google.com with SMTP id 4so477992hsl.5
        for <java-user@lucene.apache.org>; Thu, 08 May 2008 01:38:50 -0700 (PDT)
Received: by 10.90.103.13 with SMTP id a13mr4365146agc.111.1210235929914;
        Thu, 08 May 2008 01:38:49 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 7sm3255536agb.8.2008.05.08.01.38.49
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 08 May 2008 01:38:49 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <4822B474.8020806@stimulussoft.com>
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com> <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com> <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com> <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com> <48218C59.2030100@stimulussoft.com> <BCF0F18B-E6F8-4DEC-8B09-414C0202AD3B@mikemccandless.com> <4822B00F.3070308@stimulussoft.com> <E206CA64-F840-4E6D-994D-DF33FE3C5AAA@mikemccandless.com> <4822B474.8020806@stimulussoft.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <9BBE3752-A0E2-4ABF-BA8D-DAA254E2DF94@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: Serious Index Corruption Error - FileNotFoundException
Date: Thu, 8 May 2008 04:38:47 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


It would make me nervous to have Lucene insert that shutdown hook.   
EG closing the IndexWriter could in general be a time-consuming  
process.  But if it's working for you, that's great.  Though, if you  
explicitly kill the JVM (eg kill -9) those shutdown hooks won't run.

You should use org.apache.lucene.index.CheckIndex to check the health  
of your index.

Mike

On May 8, 2008, at 4:06 AM, Jamie wrote:
> Hi Michael
>
> I had in fact preempted you and moved the delete lock code to a  
> startup function. However, I found a nice little optimization that  
> seems to force the writer to close when the process is manually  
> killed. I added a JVM shutdown hook (i.e. using Runtime.getRuntime 
> ().addShutdownHook(this) ) that closes the writer. This seems to  
> reduce the number of instances where the lock file is left lying  
> around.  Perhaps, it is something that could be included in the  
> base lucene code. Also, are you aware of any chkdsk like utility  
> for Lucene? i.e. in the event that an index is corrupted through  
> disk error or otherwise?
>
> Many thanks!
>
> Jamie
>
>
> Michael McCandless wrote:
>>
>> OK, that sounds like a legitimate reason to forcibly remove the  
>> write lock, but it would be better to do that only on startup of  
>> your process rather than in every openIndex() call.
>>
>> If ever you hit LockObtainFailedException in openIndex, even after  
>> having deleted the write lock on startup, then that means there's  
>> a bug (ie, two writers are in fact trying to open on the same  
>> index, one of the two cases below).
>>
>> Mike
>>
>> Jamie wrote:
>>> Hi Mike
>>>
>>> Thanks for the suggestions. I've implemented all of them. The  
>>> main reason why I manually deleted the lock file was that  
>>> sometimes users kill the server process manually or there is a  
>>> hard reboot without any warning. In such circumstances, Lucene  
>>> leaves a lock file lying around as it was busy writing to the  
>>> index. Now, I understand that one shouldn't simply delete the  
>>> lock file, but what do you suggest my users do? The server must  
>>> continue running... the only way that I see how is to delete the  
>>> lock file, unless there is the equivalent of chkdsk for Lucene  
>>> indexes that I could run.
>>>
>>> Regards,
>>>
>>> Jmaie
>>>
>>>
>>> Michael McCandless wrote:
>>>>
>>>> On quickly looking through the code I think there are some  
>>>> serious hazards that could lead to this exception.
>>>>
>>>> First, in your openIndex code, if you hit a  
>>>> LockObtainFailedException in trying to open your writer, you are  
>>>> forcefully removing the write lock and then retrying.  Yet, you  
>>>> also open an IndexReader to delete documents, which acquires the  
>>>> write lock.  If ever you have this IndexReader open, and then  
>>>> you forcefully remove the write lock and open the writer, that  
>>>> would cause this exception.
>>>>
>>>> Second, you have a deletIndex method, which first tries to use  
>>>> the writer with create=true (good) but then falls back to  
>>>> manually removing the files.  Why is that fallback necessary?   
>>>> If, for example, you are also hitting a  
>>>> LockObtainFailedException, then forcefully removing files while  
>>>> an IndexReader or IndexWriter holds the write lock is also  
>>>> dangerous and would lead to this exception.
>>>>
>>>> In general it's very dangerous to forcibly remove, or ignore,  
>>>> Lucene's write lock.  It really should only be necessary when  
>>>> something catastrophic occurred (JVM crashed).
>>>>
>>>> Also, note that IndexWriter can now delete documents.  This  
>>>> would simplify your code and possibly fix these two hazards.
>>>>
>>>> Do you see any of the error/warnings that you send to your  
>>>> logger?  (They would be corroborating evidence here).
>>>>
>>>> Mike
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33977-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 08:52:49 2008
Return-Path: <java-user-return-33977-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14552 invoked from network); 8 May 2008 08:52:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 08:52:49 -0000
Received: (qmail 49588 invoked by uid 500); 8 May 2008 08:52:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48798 invoked by uid 500); 8 May 2008 08:52:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48787 invoked by uid 99); 8 May 2008 08:52:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 01:52:43 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,NORMAL_HTTP_TO_IP,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 08:51:57 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Ju1rH-0007YR-5t
	for java-user@lucene.apache.org; Thu, 08 May 2008 01:52:11 -0700
Message-ID: <17122444.post@talk.nabble.com>
Date: Thu, 8 May 2008 01:52:11 -0700 (PDT)
From: Vizzini <paolo.vizzini@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: lucene farsi problem
In-Reply-To: <9294E20AED46934EA459020706463F94A04BF4@SUEXCL-02.ad.syr.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: paolo.vizzini@gmail.com
References: <16977096.post@talk.nabble.com> <17098552.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04BF4@SUEXCL-02.ad.syr.edu>
X-Virus-Checked: Checked by ClamAV on apache.org


Dear Steven

Thanks for reply. I've just checked the link and it was working. Anyway, yo=
u
are right, but my point is to use the correct term for main 3 reasons:=20

1. Respect the host language, i.e. English
3. Apparently the Islamic regime in Tehran is against the word =E2=80=98Per=
sian=E2=80=99,
and we as the free world have responsibility to fight them in any possible
way =E2=80=93 and in the meantime assist Iranians in their fight against th=
e tyrant
Moslem clerics.

Kind Regards
PV



Steven A Rowe wrote:
>=20
> Hi PV,
>=20
> On 05/07/2008 at 2:54 AM, PV wrote:
>> Sorry for cross posting, but why the word 'Farsi' instead of
>> 'Persian'?  No one says Lucnce fran=C3=A7ais or Espa=C3=B1ol, or Deutsch=
 - so why
>> Farsi?
>>=20
>> Please read the following article, I found it quite enlightening.
>> http://www.cais-soas.com/CAIS/Languages/persian_not_farsi.htm
>>=20
>> PV
>=20
> I was unable to follow your link -- I get the message "The page cannot be
> found" -- but Google's cache came to my rescue:
>=20
> <http://209.85.165.104/search?q=3Dcache:vJo1ye09MzYJ:www.cais-soas.com/CA=
IS/Languages/persian_not_farsi.htm+persian+farsi+site:cais-soas.com&hl=3Den=
&ct=3Dclnk&cd=3D1&gl=3Dus&client=3Dfirefox-a>
>=20
> The article makes fine logical arguments against the use of "Farsi", but
> clearly does not take a balanced point of view on the controversy.
>=20
> I count myself among the ignorant - I had not realized that "Farsi" was a
> politically charged term.  That said, I don't plan on refusing to use the
> term.  I'll just think about the impact of the choice (now that I'm aware
> there is one) before I do use it.
>=20
> Thanks for the pointer.  Knowledge is good.
>=20
> Steve
>=20
> On 05/07/2008 at 2:54 AM, Vizzini wrote:
>>=20
>> Sorry for cross posting, but why the word 'Farsi' instead of
>> 'Persian'?  No one says Lucnce fran=C3=A7ais or Espa=C3=B1ol, or Deutsch=
 - so why
>> Farsi?
>>=20
>> Please read the following article, I found it quite enlightening.
>> http://www.cais-soas.com/CAIS/Languages/persian_not_farsi.htm
>>=20
>> PV
>>=20
>> -- View this message in context:
>> http://www.nabble.com/lucene-farsi-problem-tp16977096p17098552.html Sent
>> from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20

--=20
View this message in context: http://www.nabble.com/lucene-farsi-problem-tp=
16977096p17122444.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33978-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 10:43:48 2008
Return-Path: <java-user-return-33978-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46193 invoked from network); 8 May 2008 10:43:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 10:43:47 -0000
Received: (qmail 77908 invoked by uid 500); 8 May 2008 10:43:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77881 invoked by uid 500); 8 May 2008 10:43:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77865 invoked by uid 99); 8 May 2008 10:43:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 03:43:41 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=NORMAL_HTTP_TO_IP,SPF_NEUTRAL,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.207] (HELO spunkymail-a19.g.dreamhost.com) (208.97.132.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 10:42:53 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a19.g.dreamhost.com (Postfix) with ESMTP id 153BB11E35
	for <java-user@lucene.apache.org>; Thu,  8 May 2008 03:43:05 -0700 (PDT)
Message-Id: <E43A6D99-7EF2-497A-98C9-8174D62301DE@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <17122444.post@talk.nabble.com>
Content-Type: text/plain; charset=WINDOWS-1252; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: lucene farsi problem
Date: Thu, 8 May 2008 06:43:04 -0400
References: <16977096.post@talk.nabble.com> <17098552.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04BF4@SUEXCL-02.ad.syr.edu> <17122444.post@talk.nabble.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org


Point #2 does not belong on this forum.  This is a forum for Lucene =20
Java, not for political views.  There are plenty of other places for =20
that, so let's close this discussion off on this particular point and =20=

simply address the issue at hand with Lucene and LUCENE-1279.

Cheers,
Grant


On May 8, 2008, at 4:52 AM, Vizzini wrote:

>
> Dear Steven
>
> Thanks for reply. I've just checked the link and it was working. =20
> Anyway, you
> are right, but my point is to use the correct term for main 3 reasons:
>
> 1. Respect the host language, i.e. English
> 3. Apparently the Islamic regime in Tehran is against the word =20
> =91Persian=92,
> and we as the free world have responsibility to fight them in any =20
> possible
> way =96 and in the meantime assist Iranians in their fight against the =
=20
> tyrant
> Moslem clerics.
>
> Kind Regards
> PV
>
>
>
> Steven A Rowe wrote:
>>
>> Hi PV,
>>
>> On 05/07/2008 at 2:54 AM, PV wrote:
>>> Sorry for cross posting, but why the word 'Farsi' instead of
>>> 'Persian'?  No one says Lucnce fran=E7ais or Espa=F1ol, or Deutsch - =
=20
>>> so why
>>> Farsi?
>>>
>>> Please read the following article, I found it quite enlightening.
>>> http://www.cais-soas.com/CAIS/Languages/persian_not_farsi.htm
>>>
>>> PV
>>
>> I was unable to follow your link -- I get the message "The page =20
>> cannot be
>> found" -- but Google's cache came to my rescue:
>>
>> =
<http://209.85.165.104/search?q=3Dcache:vJo1ye09MzYJ:www.cais-soas.com/CAI=
S/Languages/persian_not_farsi.htm+persian+farsi+site:cais-soas.com&hl=3Den=
&ct=3Dclnk&cd=3D1&gl=3Dus&client=3Dfirefox-a=20
>> >
>>
>> The article makes fine logical arguments against the use of =20
>> "Farsi", but
>> clearly does not take a balanced point of view on the controversy.
>>
>> I count myself among the ignorant - I had not realized that "Farsi" =20=

>> was a
>> politically charged term.  That said, I don't plan on refusing to =20
>> use the
>> term.  I'll just think about the impact of the choice (now that I'm =20=

>> aware
>> there is one) before I do use it.
>>
>> Thanks for the pointer.  Knowledge is good.
>>
>> Steve
>>
>> On 05/07/2008 at 2:54 AM, Vizzini wrote:
>>>
>>> Sorry for cross posting, but why the word 'Farsi' instead of
>>> 'Persian'?  No one says Lucnce fran=E7ais or Espa=F1ol, or Deutsch - =
=20
>>> so why
>>> Farsi?
>>>
>>> Please read the following article, I found it quite enlightening.
>>> http://www.cais-soas.com/CAIS/Languages/persian_not_farsi.htm
>>>
>>> PV
>>>
>>> -- View this message in context:
>>> http://www.nabble.com/lucene-farsi-problem-=20
>>> tp16977096p17098552.html Sent
>>> from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>
> --=20
> View this message in context: =
http://www.nabble.com/lucene-farsi-problem-tp16977096p17122444.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33979-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 11:48:20 2008
Return-Path: <java-user-return-33979-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62732 invoked from network); 8 May 2008 11:48:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 11:48:20 -0000
Received: (qmail 74256 invoked by uid 500); 8 May 2008 11:48:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74223 invoked by uid 500); 8 May 2008 11:48:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74212 invoked by uid 99); 8 May 2008 11:48:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 04:48:14 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of karl.wettin@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 11:47:26 +0000
Received: by fg-out-1718.google.com with SMTP id l27so543810fgb.27
        for <java-user@lucene.apache.org>; Thu, 08 May 2008 04:47:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=HRtbj8G/aTBp3PwNmkHNM3zkC/saW7wD+X3MfBBjTjU=;
        b=WXbuRZleGRUDRgnca8z+Qkkmk12eRkdkKhpIEt/lnwy4fAHBfJHR8KXrr4xmo4IfBDqGs7IAjzMAIna7mQLfbVwCc0/SBrGo+OVA1R2/PL8G+2AR++79o7OdeMt1NVyOfVJ4GxD8t/OwyxtA9s6q96tGOhc9gj19R8SD5fecKSU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=uppVOG0X0Qof/xBddJuP9ZuXfoZ954jvyC5v6gsWzOF9rE+m8/PGKkNufUAnNC4dJtohw2PzJO0fRmGfcUfowR/JLKqUP2HsyjmTwwqOfJ0/k1/Vudaj5TdkejmMpqBB+En+5nmRPLeAWSlZHNotUFKaTM5vAjJMvpBM1iWcz3g=
Received: by 10.86.66.11 with SMTP id o11mr6021255fga.74.1210247259393;
        Thu, 08 May 2008 04:47:39 -0700 (PDT)
Received: from kodapan.local ( [82.93.70.124])
        by mx.google.com with ESMTPS id d4sm2794328fga.4.2008.05.08.04.47.37
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 08 May 2008 04:47:38 -0700 (PDT)
Message-ID: <4822E858.80400@gmail.com>
Date: Thu, 08 May 2008 13:47:36 +0200
From: Karl Wettin <karl.wettin@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Macintosh/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Using single or multiple indices for searching different entity
 types
References: <17122272.post@talk.nabble.com>
In-Reply-To: <17122272.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

JP O'Gorman skrev:

> All this information is stored within the one index. All the documents have
> a type and an id field to uniquely identify the entity instance. We allow
> the user to choose what entity types to search over e.g. Just Client and
> Project information or all information etc. We use the type field to specify
> what entity type to restrict the search to. 

Do you use a filter or a term query to restrict the search? Filters 
usually speed things up a lot.

> My question surrounds the best mechanism to index this information? Should I
> be storing these entities in different indices? This would mean I might have
> to preform four searches if searching over all information and maybe lose

MultiReader

> search relevance ordering. The problem with using one index is that I have a
> large amount of fields for each Lucene document that are not populated or
> relevent when the document represents only one of my entities.

FieldSelector


What is your current problem? Do you want to optimize for reponse speed 
or for hardware resources? I think you want a single index. I also think 
you want to benchmark all sort of strategies so you will see what 
affects what.

> Also, I am a Lucene.Net user. Is this still the best place for me to post my
> questions?

We can only help you with basic conceptual things. I don't even know if 
the things I've mentioned exists for Lucene.Net. Look here:

http://incubator.apache.org/lucene.net/


     karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33980-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 17:23:27 2008
Return-Path: <java-user-return-33980-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38882 invoked from network); 8 May 2008 17:23:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 17:23:26 -0000
Received: (qmail 52642 invoked by uid 500); 8 May 2008 17:23:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52606 invoked by uid 500); 8 May 2008 17:23:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52589 invoked by uid 99); 8 May 2008 17:23:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 10:23:20 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of michaelysiu@hotmail.com designates 65.54.246.169 as permitted sender)
Received: from [65.54.246.169] (HELO bay0-omc2-s33.bay0.hotmail.com) (65.54.246.169)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 17:22:25 +0000
Received: from hotmail.com ([65.55.133.21]) by bay0-omc2-s33.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 8 May 2008 10:22:45 -0700
Received: from mail pickup service by hotmail.com with Microsoft SMTPSVC;
	 Thu, 8 May 2008 10:22:45 -0700
Message-ID: <BAY128-DAV11E8999B36A8334A837342BED00@phx.gbl>
Received: from 209.189.193.162 by BAY128-DAV11.phx.gbl with DAV;
	Thu, 08 May 2008 17:22:44 +0000
X-Originating-IP: [209.189.193.162]
X-Originating-Email: [michaelysiu@hotmail.com]
X-Sender: michaelysiu@hotmail.com
From: "Michael Siu" <michaelysiu@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: Limit of Lucene
Date: Thu, 8 May 2008 10:23:24 -0700
Message-ID: <02e501c8b130$389f2700$a9dd7500$@com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_02E6_01C8B0F5.8C404F00"
X-Mailer: Microsoft Office Outlook 12.0
thread-index: AcixMDdFOtPP2PWLSaWEPrEGDkNScA==
Content-Language: en-us
X-OriginalArrivalTime: 08 May 2008 17:22:45.0886 (UTC) FILETIME=[218351E0:01C8B130]
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_02E6_01C8B0F5.8C404F00
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

What is the limit of Lucene:  # of docs per index?

 

If RangeFilter.Bits(), for example, it initializes a bitset to the size of
maxDoc from the indexReader.  I wonder what happen if the # of docs is huge,
say MaxInt (4G in 32bit or 2^63 in 64 bit)?

 

 

 

 


------=_NextPart_000_02E6_01C8B0F5.8C404F00--


From java-user-return-33981-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 18:00:19 2008
Return-Path: <java-user-return-33981-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54935 invoked from network); 8 May 2008 18:00:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 18:00:17 -0000
Received: (qmail 2693 invoked by uid 500); 8 May 2008 18:00:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2662 invoked by uid 500); 8 May 2008 18:00:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2648 invoked by uid 99); 8 May 2008 18:00:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 11:00:11 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of karl.wettin@gmail.com designates 66.249.92.170 as permitted sender)
Received: from [66.249.92.170] (HELO ug-out-1314.google.com) (66.249.92.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 17:59:25 +0000
Received: by ug-out-1314.google.com with SMTP id h3so142823ugf.29
        for <java-user@lucene.apache.org>; Thu, 08 May 2008 10:59:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=+mwowyF4WmkjtkYgb59LeFT3ulsLETxSNshMCO3Lkh4=;
        b=b76qWqvz6KHc5w4RrtZAQLxjhO9ufYD0HmvfYV0aGgQ+5Qexn/EigPvBOxop3OFgOR1OyVYopGe3EbUK8lC8u+QS89z55XtrXK1d+QVjqi9FSRrGBHFSjhCQ3uRkqzdV6GJ7iPG6v3QQuT3V1r9fTSAJkaVUFoyhYV1W6Kgi8F4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=kZ+XUsKskeIA37+J+QoIZ6njML3mt+G+VG4i2HMk4YfchaeM+HP1pWtsXbMDEQtN+tbpT1bHcM6J8wxDuHqypCaJhV+bq5Qbz3007x3Wo3cbwBexLTd72QywB95Z+HU/Znx64/iTF4iuKesnELAWM+t4xX5+O2Fu3AvNaGqqdgs=
Received: by 10.67.99.14 with SMTP id b14mr882243ugm.10.1210269578711;
        Thu, 08 May 2008 10:59:38 -0700 (PDT)
Received: from kodapan.local ( [82.93.70.124])
        by mx.google.com with ESMTPS id a1sm1403419ugf.74.2008.05.08.10.59.35
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 08 May 2008 10:59:36 -0700 (PDT)
Message-ID: <48233F86.6050205@gmail.com>
Date: Thu, 08 May 2008 19:59:34 +0200
From: Karl Wettin <karl.wettin@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Macintosh/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Limit of Lucene
References: <BAY128-DAV11E8999B36A8334A837342BED00@phx.gbl>
In-Reply-To: <BAY128-DAV11E8999B36A8334A837342BED00@phx.gbl>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Michael Siu skrev:
> What is the limit of Lucene:  # of docs per index?

Integer.MAX_VALUE

Multiple indices joined in a single MultiWhatNot is still limited to 
that number.


> If RangeFilter.Bits(), for example, it initializes a bitset to the size of
> maxDoc from the indexReader.  I wonder what happen if the # of docs is huge,
> say MaxInt (4G in 32bit or 2^63 in 64 bit)?

ArrayIndexOutOfBoundsException ?

It should not be that difficult to upgrade int to longs, but it is a 
rather large job.

How many documents do you have? You might want to consider alternative 
ways to represent your corpus in the index so it takes less documents.


           karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33982-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 18:13:39 2008
Return-Path: <java-user-return-33982-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61043 invoked from network); 8 May 2008 18:13:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 18:13:39 -0000
Received: (qmail 20620 invoked by uid 500); 8 May 2008 18:13:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20587 invoked by uid 500); 8 May 2008 18:13:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20576 invoked by uid 99); 8 May 2008 18:13:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 11:13:33 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of michaelysiu@hotmail.com designates 65.54.246.90 as permitted sender)
Received: from [65.54.246.90] (HELO bay0-omc1-s18.bay0.hotmail.com) (65.54.246.90)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 18:12:46 +0000
Received: from hotmail.com ([65.55.133.18]) by bay0-omc1-s18.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 8 May 2008 11:13:00 -0700
Received: from mail pickup service by hotmail.com with Microsoft SMTPSVC;
	 Thu, 8 May 2008 11:13:00 -0700
Message-ID: <BAY128-DAV8FF678B31E31CDBCE4037BED00@phx.gbl>
Received: from 209.189.193.162 by BAY128-DAV8.phx.gbl with DAV;
	Thu, 08 May 2008 18:12:56 +0000
X-Originating-IP: [209.189.193.162]
X-Originating-Email: [michaelysiu@hotmail.com]
X-Sender: michaelysiu@hotmail.com
From: "Michael Siu" <michaelysiu@hotmail.com>
To: <java-user@lucene.apache.org>
References: <BAY128-DAV11E8999B36A8334A837342BED00@phx.gbl> <48233F86.6050205@gmail.com>
In-Reply-To: <48233F86.6050205@gmail.com>
Subject: RE: Limit of Lucene
Date: Thu, 8 May 2008 11:13:36 -0700
Message-ID: <02ef01c8b137$3b9d95c0$b2d8c140$@com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
thread-index: AcixNV6v8eNVgYTLS76GD5UTZcje8wAAUe4g
Content-Language: en-us
X-OriginalArrivalTime: 08 May 2008 18:13:00.0342 (UTC) FILETIME=[2644CD60:01C8B137]
X-Virus-Checked: Checked by ClamAV on apache.org

The # of documents that we are going to index could be potentially more than
2G. So I guess I have to split the index file into multiple of files with
each contain up to 2G files. Any other suggestion?

Thanks.

-----Original Message-----
From: Karl Wettin [mailto:karl.wettin@gmail.com] 
Sent: Thursday, May 08, 2008 11:00 AM
To: java-user@lucene.apache.org
Subject: Re: Limit of Lucene

Michael Siu skrev:
> What is the limit of Lucene:  # of docs per index?

Integer.MAX_VALUE

Multiple indices joined in a single MultiWhatNot is still limited to 
that number.


> If RangeFilter.Bits(), for example, it initializes a bitset to the size of
> maxDoc from the indexReader.  I wonder what happen if the # of docs is
huge,
> say MaxInt (4G in 32bit or 2^63 in 64 bit)?

ArrayIndexOutOfBoundsException ?

It should not be that difficult to upgrade int to longs, but it is a 
rather large job.

How many documents do you have? You might want to consider alternative 
ways to represent your corpus in the index so it takes less documents.


           karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33983-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 08 18:29:06 2008
Return-Path: <java-user-return-33983-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70950 invoked from network); 8 May 2008 18:29:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 May 2008 18:29:05 -0000
Received: (qmail 35084 invoked by uid 500); 8 May 2008 18:28:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35048 invoked by uid 500); 8 May 2008 18:28:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35037 invoked by uid 99); 8 May 2008 18:28:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 11:28:59 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.5] (HELO spunkymail-a16.g.dreamhost.com) (208.97.132.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 May 2008 18:28:05 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a16.g.dreamhost.com (Postfix) with ESMTP id 4278F7D1DB
	for <java-user@lucene.apache.org>; Thu,  8 May 2008 11:28:24 -0700 (PDT)
Message-Id: <8245E02A-AFDA-449F-AD29-77244B1B6036@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <BAY128-DAV8FF678B31E31CDBCE4037BED00@phx.gbl>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Limit of Lucene
Date: Thu, 8 May 2008 14:28:23 -0400
References: <BAY128-DAV11E8999B36A8334A837342BED00@phx.gbl> <48233F86.6050205@gmail.com> <BAY128-DAV8FF678B31E31CDBCE4037BED00@phx.gbl>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

In practice, you will more than likely have to distribute your index  
across multiple nodes once you get somewhere in the range of tens of  
millions of documents, but it all depends on your hardware, documents,  
throughput needs, etc.


On May 8, 2008, at 2:13 PM, Michael Siu wrote:

> The # of documents that we are going to index could be potentially  
> more than
> 2G. So I guess I have to split the index file into multiple of files  
> with
> each contain up to 2G files. Any other suggestion?
>
> Thanks.
>
> -----Original Message-----
> From: Karl Wettin [mailto:karl.wettin@gmail.com]
> Sent: Thursday, May 08, 2008 11:00 AM
> To: java-user@lucene.apache.org
> Subject: Re: Limit of Lucene
>
> Michael Siu skrev:
>> What is the limit of Lucene:  # of docs per index?
>
> Integer.MAX_VALUE
>
> Multiple indices joined in a single MultiWhatNot is still limited to
> that number.
>
>
>> If RangeFilter.Bits(), for example, it initializes a bitset to the  
>> size of
>> maxDoc from the indexReader.  I wonder what happen if the # of docs  
>> is
> huge,
>> say MaxInt (4G in 32bit or 2^63 in 64 bit)?
>
> ArrayIndexOutOfBoundsException ?
>
> It should not be that difficult to upgrade int to longs, but it is a
> rather large job.
>
> How many documents do you have? You might want to consider alternative
> ways to represent your corpus in the index so it takes less documents.
>
>
>           karl
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33984-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 08:20:55 2008
Return-Path: <java-user-return-33984-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33782 invoked from network); 9 May 2008 08:20:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 08:20:55 -0000
Received: (qmail 10891 invoked by uid 500); 9 May 2008 08:20:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10865 invoked by uid 500); 9 May 2008 08:20:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10854 invoked by uid 99); 9 May 2008 08:20:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 01:20:49 -0700
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Jon.Loken@bipsolutions.com designates 85.119.2.190 as permitted sender)
Received: from [85.119.2.190] (HELO cluster-f.mailcontrol.com) (85.119.2.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 08:19:54 +0000
Received: from mailx02.virtual-email.net ([213.228.203.171])
	by rly03f.srv.mailcontrol.com (MailControl) with ESMTP id m498K3Ih022272
	for <java-user@lucene.apache.org>; Fri, 9 May 2008 09:20:03 +0100
Received: from mailx10.virtual-email.net ([213.228.203.166]) by mailx02.virtual-email.net with Microsoft SMTPSVC(6.0.3790.1830);
	 Fri, 9 May 2008 09:24:01 +0100
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: Wild carded phrases
Date: Fri, 9 May 2008 09:19:56 +0100
Message-ID: <73C3337877023246872FB2E97FD1636C01B38368@mailx10.virtual-email.net>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Wild carded phrases
Thread-Index: AcixrXdLmGMXEhkRSSGP5w68yhiPAA==
From: "Jon Loken" <Jon.Loken@bipsolutions.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 09 May 2008 08:24:01.0515 (UTC) FILETIME=[09197BB0:01C8B1AE]
X-Scanned-By: MailControl A-08-50-00 (www.mailcontrol.com) on 10.70.0.113
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,=20

First of all, well done to the implementers of Lucene. The performance
is incredible! We get search results within 20-40 ms on an index about
1.5GB.=20

I could not find a Lucene maillist search engine, something I am a bit
surprised about!

My question is how I can implement wild carded phrases searches like:
"boiler replac*"
This will pick up text:
"boiler replacement" and "boiler replacing"
But not:
"boiling replacement" or "boiler user replacment"

I am using the queryParser through Spring-lucene-module.=20



I did simply try textToSearch=3D "boiler replac*", but this did not work
as anticipated. Have not analyzed properly, but it seemed to interpret
this as:=20
boiler OR replac*


Is there a way to implements this?

Many thanks,=20
Jon


BiP Solutions Limited is a company registered in Scotland with Company Numb=
er SC086146 and VAT number 38303966 and having its registered office at Par=
k House, 300 Glasgow Road, Shawfield, Glasgow, G73 1SQ ********************=
********************************************************
This e-mail (and any attachment) is intended only for the attention of the =
addressee(s). Its unauthorised use, disclosure, storage or copying is not p=
ermitted. If you are not the intended recipient, please destroyall copies a=
nd inform the sender by return e-mail.
This e-mail (whether you are the sender or the recipient) may be monitored,=
 recorded and retained by BiP Solutions Ltd.
E-mail monitoring/ blocking software may be used, and e-mail content may be=
 read at any time. You have a responsibility to ensure laws are not broken =
when composing or forwarding e-mails and their contents.
****************************************************************************

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33985-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 09:27:08 2008
Return-Path: <java-user-return-33985-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53722 invoked from network); 9 May 2008 09:27:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 09:27:06 -0000
Received: (qmail 91227 invoked by uid 500); 9 May 2008 09:27:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91184 invoked by uid 500); 9 May 2008 09:26:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91145 invoked by uid 99); 9 May 2008 09:26:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 02:26:59 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.125.145.37] (HELO mercury.propylon.com) (194.125.145.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 09:26:11 +0000
Received: from propylon-sdsl.sdsl.esat.net ([193.120.101.26] helo=[192.168.213.119])
	by mercury.propylon.com with esmtp (Exim 4.50)
	id 1JuOnj-0006Pc-V2
	for java-user@lucene.apache.org; Fri, 09 May 2008 10:22:08 +0100
Message-ID: <482418B7.9070608@propylon.com>
Date: Fri, 09 May 2008 10:26:15 +0100
From: John Byrne <john.byrne@propylon.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
References: <73C3337877023246872FB2E97FD1636C01B38368@mailx10.virtual-email.net>
In-Reply-To: <73C3337877023246872FB2E97FD1636C01B38368@mailx10.virtual-email.net>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-SA-Exim-Connect-IP: 193.120.101.26
X-SA-Exim-Mail-From: john.byrne@propylon.com
Subject: Re: Wild carded phrases
X-Spam-Checker-Version: SpamAssassin 3.0.3 (2005-04-27) on 
	mercury.propylon.com
X-Spam-Level: 
X-SA-Exim-Version: 4.2 (built Thu, 03 Mar 2005 10:44:12 +0100)
X-SA-Exim-Scanned: Yes (on mercury.propylon.com)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=0.1 required=5.0 tests=AWL autolearn=failed 
	version=3.0.3

Hi,

Here's a searchable mailing list archive: 
http://www.gossamer-threads.com/lists/lucene/java-user/

As regards the wildcard phrase queries, here's one way I think you could 
do it, but it's a bit of extra work. If you're using QueryParser, you'd 
have to override the "getFieldQuery" method to use span queries instead 
of phrase queries.

A phrase query can be implemented as a span query with a span or "slop"  
factor of 1. So, once you have the PhraseQuery object, you would:

1. Extract the terms
2. For each one, check if it contains a "*" or a "?"
3. If it does, create a WildcardQuery using that term, and re-write it 
using IndexReader.rewrite method. This expands the wildcard query into 
all it's matches.
4. Create an array of SpanTermQuery objects, (one SpanTermQuery for each 
term that matched you wildcard); then add that array to a SpanOrQuery.
5. Repeat 2 to 4 for each wildcard term in the phrase.
6. Finally (!), create a SpanNearQuery, adding all the original terms in 
order, but substituting your SpanOrQuerys for the wildcard terms. Use a 
slop of 1, and set the inOrder flag to true.

So, essentially, you'd end up with: (you'll have to excuse me if I 
haven't rendered the span queries correctly as strings here - but this 
should give the general idea...)

spanNear[boiler (spanOr[replacement replacing])]

So it will accept *either* "replacement" or "replacing" adjacent to 
"boiler", which is what you want.

As you can see, it's a bit of work - but if you add this functionality 
to the QueryParser, you'll can re-use it a lot!

Hope that helps!

-JB








Jon Loken wrote:
> Hi all, 
>
> First of all, well done to the implementers of Lucene. The performance
> is incredible! We get search results within 20-40 ms on an index about
> 1.5GB. 
>
> I could not find a Lucene maillist search engine, something I am a bit
> surprised about!
>
> My question is how I can implement wild carded phrases searches like:
> "boiler replac*"
> This will pick up text:
> "boiler replacement" and "boiler replacing"
> But not:
> "boiling replacement" or "boiler user replacment"
>
> I am using the queryParser through Spring-lucene-module. 
>
>
>
> I did simply try textToSearch= "boiler replac*", but this did not work
> as anticipated. Have not analyzed properly, but it seemed to interpret
> this as: 
> boiler OR replac*
>
>
> Is there a way to implements this?
>
> Many thanks, 
> Jon
>
>
> BiP Solutions Limited is a company registered in Scotland with Company Number SC086146 and VAT number 38303966 and having its registered office at Park House, 300 Glasgow Road, Shawfield, Glasgow, G73 1SQ ****************************************************************************
> This e-mail (and any attachment) is intended only for the attention of the addressee(s). Its unauthorised use, disclosure, storage or copying is not permitted. If you are not the intended recipient, please destroyall copies and inform the sender by return e-mail.
> This e-mail (whether you are the sender or the recipient) may be monitored, recorded and retained by BiP Solutions Ltd.
> E-mail monitoring/ blocking software may be used, and e-mail content may be read at any time. You have a responsibility to ensure laws are not broken when composing or forwarding e-mails and their contents.
> ****************************************************************************
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33986-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 12:06:13 2008
Return-Path: <java-user-return-33986-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93800 invoked from network); 9 May 2008 12:06:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 12:06:13 -0000
Received: (qmail 71902 invoked by uid 500); 9 May 2008 12:06:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71873 invoked by uid 500); 9 May 2008 12:06:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71858 invoked by uid 99); 9 May 2008 12:06:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 05:06:08 -0700
X-ASF-Spam-Status: No, hits=-2.0 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [64.18.3.29] (HELO psmtp.com) (64.18.3.29)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 09 May 2008 12:05:12 +0000
Received: from source ([193.201.197.58]) by exprod8ob115.postini.com ([64.18.7.12]) with SMTP;
	Fri, 09 May 2008 05:05:31 PDT
Content-Transfer-Encoding: 7bit
Importance: normal
Priority: normal
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.4133
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C8B1CC.FA4FFB72"
x-cr-puzzleid: {DC8FF468-8694-4E46-98A4-ACF294553D03}
x-cr-hashedpuzzle: D182 D9OO EbXF EmhK EnNM Enb+ En78 FB+d Fecs GA9a GESz Gz8W HvKk ILhQ IcAp I1dj;1;agBhAHYAYQAtAHUAcwBlAHIAQABsAHUAYwBlAG4AZQAuAGEAcABhAGMAaABlAC4AbwByAGcA;Sosha1_v1;7;{DC8FF468-8694-4E46-98A4-ACF294553D03};YQBhAG0AaQByAC4AeQBhAHMAZQBlAG4AQABnAGwAbwBiAGEAbABkAGEAdABhAHAAbwBpAG4AdAAuAGMAbwBtAA==;Fri, 09 May 2008 12:05:25 GMT;VQBwAGQAYQB0AGkAbgBnACAATAB1AGMAZQBuAGUAIABJAG4AZABlAHgAIABEAHkAbgBhAG0AaQBjAGEAbABsAHkA
Content-class: urn:content-classes:message
Subject: Updating Lucene Index Dynamically
Date: Fri, 9 May 2008 13:05:25 +0100
Message-ID: <39F273ED33612448863A19BBC1FBCFA002D0FE18@ms2.lsc.net>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Updating Lucene Index Dynamically
Thread-Index: AcixzPcuepGfOb8xSdWM1iAaMd05/Q==
From: <Aamir.Yaseen@globaldatapoint.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C8B1CC.FA4FFB72
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi,

I am using Lucene 2.1.0 at the moment and I have huge data which is
being indexed.

I am re indexing my data on daily basis. Now I would like to index my
data dynamically at any point in time.=20

I cannot afford to re index whole data due to its huge size and time it
requires.

=20

How can I update my index dynamically? Any suggessions?

=20

Aamir Yaseen=20
Senior Java Developer

=20

Global DataPoint Ltd
Middlesex House, 34- 42 Cleveland Street=20
London W1T 4LB, UK

T +44 (0)20 7323 0323 Ext: 4829

M +44 (0)7951 895299

www.globaldatapoint.com

=20


=20
This e-mail is confidential and should not be used by anyone who is not =
the original intended recipient. Global DataPoint Limited does not =
accept liability for any statements made which are clearly the sender's =
own and not expressly made on behalf of Global DataPoint Limited. No =
contracts may be concluded on behalf of Global DataPoint Limited by =
means of e-mail communication. Global DataPoint Limited Registered in =
England and Wales with registered number 3739752 Registered Office =
Middlesex House, 34-42 Cleveland Street, London W1T 4LB


------_=_NextPart_001_01C8B1CC.FA4FFB72--

From java-user-return-33987-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 12:15:35 2008
Return-Path: <java-user-return-33987-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95843 invoked from network); 9 May 2008 12:15:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 12:15:34 -0000
Received: (qmail 88286 invoked by uid 500); 9 May 2008 12:15:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88261 invoked by uid 500); 9 May 2008 12:15:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88250 invoked by uid 99); 9 May 2008 12:15:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 05:15:29 -0700
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.108.46] (HELO SUEXCL-02.ad.syr.edu) (128.230.108.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 12:14:44 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
Subject: RE: lucene farsi problem
Date: Fri, 9 May 2008 08:13:18 -0400
Message-ID: <9294E20AED46934EA459020706463F94A04C67@SUEXCL-02.ad.syr.edu>
In-Reply-To: <9294E20AED46934EA459020706463F94A04BF1@SUEXCL-02.ad.syr.edu>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: lucene farsi problem
Thread-Index: AcivbcbkljNhLxXISZ+QHj1O25bwLQA6lXAgAF1WTfA=
From: "Steven A Rowe" <sarowe@syr.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgRXNyYSwNCg0KT24gMDUvMDcvMjAwOCBhdCAxMTo0OSBBTSwgU3RldmVuIEEgUm93ZSB3cm90
ZToNCj4gQXQgQ2hyaXMgSG9zdGV0dGVyJ3Mgc3VnZ2VzdGlvbiwgSSBhbSByZXdyaXRpbmcgdGhl
IHBhdGNoDQo+IGF0dGFjaGVkIHRvIExVQ0VORS0xMjc5LCBpbmNsdWRpbmcgdGhlIGZvbGxvd2lu
ZyBjaGFuZ2VzOg0KPiANCj4gLSBNZXJnZWQgdGhlIGNvbnRlbnRzIG9mIHRoZSBDb2xsYXRpbmdS
YW5nZVF1ZXJ5IGNsYXNzIGludG8NCj4gUmFuZ2VRdWVyeSBhbmQgUmFuZ2VGaWx0ZXINCj4gLSBT
d2l0Y2hlZCB0aGUgTG9jYWxlIHBhcmFtZXRlciB0byBpbnN0ZWFkIHRha2UgYW4gaW5zdGFuY2UN
Cj4gb2YgQ29sbGF0b3INCj4gLSBNb2RpZmllZCBRdWVyeVBhcnNlci5qaiB0byBjb25zdHJ1Y3Qg
YSBRdWVyeVBhcnNlciBjbGFzcw0KPiB0aGF0IGNhbiBhY2NlcHQgYSByYW5nZSBjb2xsYXRvciBh
bmQgcGFzcyBpdCBlaXRoZXIgdG8NCj4gUmFuZ2VRdWVyeSBvciB0aHJvdWdoIENvbnN0YW50U2Nv
cmVSYW5nZVF1ZXJ5IHRvIFJhbmdlRmlsdGVyLg0KDQpJIGhhdmUgYXR0YWNoZWQgdGhlIGFib3Zl
LWRlc2NyaWJlZCByZXZpc2VkIHBhdGNoIHRvIExVQ0VORS0xMjc5IC0gRXNyYSwgaWYgeW91IGdl
dCBhIGNoYW5jZSwgY291bGQgeW91IHRyeSBpdCBvdXQ/ICBUaGUgaW1wbGVtZW50YXRpb24gaGFz
bid0IGNoYW5nZWQgKGV4Y2VwdCBmb3IgdGhlIGNvc21ldGljIGNoYW5nZXMgbm90ZWQgYWJvdmUp
IC0tIHlvdSdsbCBqdXN0IGJlIHVzaW5nIFJhbmdlUXVlcnkgaW5zdGVhZCBvZiBDb2xsYXRpbmdS
YW5nZVF1ZXJ5Lg0KDQpUaGFua3MsDQpTdGV2ZQ0K


From java-user-return-33988-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 13:03:33 2008
Return-Path: <java-user-return-33988-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20440 invoked from network); 9 May 2008 13:03:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 13:03:33 -0000
Received: (qmail 68467 invoked by uid 500); 9 May 2008 13:03:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68437 invoked by uid 500); 9 May 2008 13:03:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68426 invoked by uid 99); 9 May 2008 13:03:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 06:03:27 -0700
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of peterlkeegan@gmail.com designates 64.233.184.227 as permitted sender)
Received: from [64.233.184.227] (HELO wr-out-0506.google.com) (64.233.184.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 13:02:41 +0000
Received: by wr-out-0506.google.com with SMTP id c30so526742wra.14
        for <java-user@lucene.apache.org>; Fri, 09 May 2008 06:02:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=X0JZzDU7JWUTPBsui16t0TDg/w9eeWOg005zCNC2ebo=;
        b=j2Vr/mOsIjwAq1HC0K1Lynw7OY0uRvQVBsfYAD4byRN+t2zKOPFU4RX0JOG/i1km7Jl+mZJsdumL5uiXEsppM0+XqJZQOVsn4w921hJy7i24UDf//hnj0zDAbyPsazeFWAWkkkmQDHIwCZDxV9D1yCp9ipFPes0k8BUGrSnhnqE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=aJ8MOi2vbxIr4aiy+noYOqB6Mf+PGKppJ4f8wXFCc8SDnjTdZqHK54zusGldLTM45N+fBT4UNOOlscTLMGjox7W55GVZZzcIrF6tvPutgbJAwPkPJbktpO/xRYoKOnAQNZTTHdvrb2QiANv0Sp5TKXZ5bAm+TlECsaRTerGH/O4=
Received: by 10.142.79.15 with SMTP id c15mr1950006wfb.105.1210338174967;
        Fri, 09 May 2008 06:02:54 -0700 (PDT)
Received: by 10.142.14.17 with HTTP; Fri, 9 May 2008 06:02:54 -0700 (PDT)
Message-ID: <e994873a0805090602g6e16623fi4585a6b50fcdc8ae@mail.gmail.com>
Date: Fri, 9 May 2008 09:02:54 -0400
From: "Peter Keegan" <peterlkeegan@gmail.com>
To: java-user <java-user@lucene.apache.org>
Subject: theoretical maximum score
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_6290_16308679.1210338174963"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_6290_16308679.1210338174963
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Is it possible to compute a theoretical maximum score for a given query if
constraints are placed on 'tf' and 'lengthNorm'? If so, scores could be
compared to a 'perfect score' (a feature request from our customers)

Here are some related threads on this:

In this thread:

http://www.nabble.com/Newbie-questions-re%3A-scoring-td4228776.html#a4228776

Hoss writes:

> the only way I can think of to fairly compare scores from queries for
> foo:bar with queries for yak:baz is to normalize them relative a maximum
> possible score across the entire term query space -- but finding that
> maximum is a pretty complicated problem just for simple term queries ...
> when you start talking about more complicated query structures you really
> get messy -- and even then it's only fair as long as the query structures
> are identical, you can never compare the scores from apples and oranges

And in this thread:

http://www.nabble.com/non-relative-scoring-td8956299.html#a8956299

Walt writes:

> A tf.idf engine, like Lucene, might not have a maximum score.
> What if a document contains the word a thousand times?
> A million times?

It seems that if 'tf' is limited to a max value and 'lengthNorm' is a
constant, it might be possible, at least for 'simple' term queries. But Hoss
says that things get messing with complicated queries.

Could someone elaborate a bit? Does the index contain enough info to do this
efficiently?
I realize that scores values must be interpreted 'carefully', but I'm seeing
a push to get more leverage from the absolute values, not just the relative
values.

Peter

------=_Part_6290_16308679.1210338174963--

From java-user-return-33989-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 13:14:29 2008
Return-Path: <java-user-return-33989-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27156 invoked from network); 9 May 2008 13:14:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 13:14:29 -0000
Received: (qmail 92986 invoked by uid 500); 9 May 2008 13:14:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92958 invoked by uid 500); 9 May 2008 13:14:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92947 invoked by uid 99); 9 May 2008 13:14:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 06:14:24 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.184 as permitted sender)
Received: from [209.85.128.184] (HELO fk-out-0910.google.com) (209.85.128.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 13:13:37 +0000
Received: by fk-out-0910.google.com with SMTP id 18so1275801fkq.5
        for <java-user@lucene.apache.org>; Fri, 09 May 2008 06:13:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=DY6L/YREvq9ytDik9HZCxN2w4MAHD29BE4Thi1EsrMQ=;
        b=Xwpk/tY7CXdR7g8l/bqo4EayliIVEsTclPI8HZz8vrwDghIRhRhUvmLB7X0F2XplrerspW83kAxEgfZYtM+YUL2mi7gG806R4YUsowp+ODWe7Xv5fjiaPFWQQE5cvp4s3B5ZFKXcIeCq0s4lIBYp6ppokl+p9hluhpETkEWU93s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=gcvCCPJ37F6jX7eXkXqTDlvGdMAjrqfSVU0Zmo+EmWfkkd7D3bPjKHocE4tobwjiP71oM/8vjw7UHz/HC6+rG4oGMFZt5uTguVJVC9CreYrMvP6GnWrDAs+Hh0YHOLn8IkwKdslr20ekqpjkIxVxcQ6KMJAf93z6MUfKLMYbi1E=
Received: by 10.82.191.3 with SMTP id o3mr577916buf.17.1210338829859;
        Fri, 09 May 2008 06:13:49 -0700 (PDT)
Received: by 10.82.191.6 with HTTP; Fri, 9 May 2008 06:13:49 -0700 (PDT)
Message-ID: <359a92830805090613t4226f43alad330b3acb3ea1ba@mail.gmail.com>
Date: Fri, 9 May 2008 09:13:49 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Updating Lucene Index Dynamically
In-Reply-To: <39F273ED33612448863A19BBC1FBCFA002D0FE18@ms2.lsc.net>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_3000_1701231.1210338829839"
References: <39F273ED33612448863A19BBC1FBCFA002D0FE18@ms2.lsc.net>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_3000_1701231.1210338829839
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

See the IndexModifier class. This assumes that by dynamically modify you
mean
change existing documents.

If all you're doing is adding new documents, you can freely add new docs to
an
existing index. There's a parameter on IndexWriter that determines whether
your index is opened for appending or overwritten.

If these don't work for you, perhaps you could explain more about how your
data changes so better suggestions can be offered.

Best
Erick

On Fri, May 9, 2008 at 8:05 AM, <Aamir.Yaseen@globaldatapoint.com> wrote:

> Hi,
>
> I am using Lucene 2.1.0 at the moment and I have huge data which is
> being indexed.
>
> I am re indexing my data on daily basis. Now I would like to index my
> data dynamically at any point in time.
>
> I cannot afford to re index whole data due to its huge size and time it
> requires.
>
>
>
> How can I update my index dynamically? Any suggessions?
>
>
>
> Aamir Yaseen
> Senior Java Developer
>
>
>
> Global DataPoint Ltd
> Middlesex House, 34- 42 Cleveland Street
> London W1T 4LB, UK
>
> T +44 (0)20 7323 0323 Ext: 4829
>
> M +44 (0)7951 895299
>
> www.globaldatapoint.com
>
>
>
>
>
> This e-mail is confidential and should not be used by anyone who is not the
> original intended recipient. Global DataPoint Limited does not accept
> liability for any statements made which are clearly the sender's own and not
> expressly made on behalf of Global DataPoint Limited. No contracts may be
> concluded on behalf of Global DataPoint Limited by means of e-mail
> communication. Global DataPoint Limited Registered in England and Wales with
> registered number 3739752 Registered Office Middlesex House, 34-42 Cleveland
> Street, London W1T 4LB
>
>

------=_Part_3000_1701231.1210338829839--

From java-user-return-33990-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 14:08:41 2008
Return-Path: <java-user-return-33990-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51950 invoked from network); 9 May 2008 14:08:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 14:08:41 -0000
Received: (qmail 17854 invoked by uid 500); 9 May 2008 14:08:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17829 invoked by uid 500); 9 May 2008 14:08:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17818 invoked by uid 99); 9 May 2008 14:08:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 07:08:35 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [140.203.201.100] (HELO mx1.nuigalway.ie) (140.203.201.100)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 14:07:42 +0000
X-IronPort-AV: E=Sophos;i="4.27,460,1204502400"; 
   d="scan'208";a="216368471"
Received: from exbe1.ac.nuigalway.ie (HELO EVS1.ac.nuigalway.ie) ([10.132.157.11])
  by mx1.nuigalway.ie with ESMTP; 09 May 2008 15:08:23 +0100
Received: from [10.2.17.36] ([140.203.154.11]) by EVS1.ac.nuigalway.ie with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 9 May 2008 15:07:33 +0100
Message-ID: <48245AB3.2000102@deri.org>
Date: Fri, 09 May 2008 15:07:47 +0100
From: Paolo Capriotti <paolo.capriotti@deri.org>
User-Agent: Thunderbird 2.0.0.12 (X11/20080227)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Using stored fields for scoring
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 09 May 2008 14:07:34.0051 (UTC) FILETIME=[0720DF30:01C8B1DE]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,
I am looking for a way to include a stored (non-indexed) field in the 
computation of scores for a query.
I have tried using a ValueSourceQuery with a ValueSource subclass that 
simply retrieves the document and gets the field, like:

public float floatVal(int doc) {
   reader.document(doc, selector).getBinaryValue("myfield");
   ....
}

but that's too slow, because it ends up doing a lookup for each matching 
document.
Is it possible to use a stored field in a FunctionQuery or 
ValueSourceQuery in an efficient way (i.e. not dependent on the number 
of retrieved documents)?
If the answer is yes, is it possible to update such a value in place 
without removing and reindexing the document?

Thanks in advance.

Paolo Capriotti

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33991-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 14:33:30 2008
Return-Path: <java-user-return-33991-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60628 invoked from network); 9 May 2008 14:33:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 14:33:29 -0000
Received: (qmail 86994 invoked by uid 500); 9 May 2008 14:33:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86961 invoked by uid 500); 9 May 2008 14:33:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86945 invoked by uid 99); 9 May 2008 14:33:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 07:33:22 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.190 as permitted sender)
Received: from [209.85.128.190] (HELO fk-out-0910.google.com) (209.85.128.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 14:32:36 +0000
Received: by fk-out-0910.google.com with SMTP id 18so1304400fkq.5
        for <java-user@lucene.apache.org>; Fri, 09 May 2008 07:32:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=FGCyNYm2ZJRZZG7yF6Svz+f+oLhwdvopDyMB2KL/L2E=;
        b=Z2zmQhmFd8NozmYAwyUA8hP/ckp7g/yfZwM1RX3yoGcrsyfMWMoeqHW+RHbOLlJRy+UJKrErxLoSx8NCDDs6WV8JezY50cCmjf0MzCJ76GnwEEGeEL5SkUzux1QUiPO4q8gaT1nWt/IAj+nLa+zAU+l6khC4t9j2TaTjaSElmjg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=B3FmsBrfbhxaGPL8aWvdFEZ9/hbbvbSgUrGd5SBPfa7Fs2PBFsn2J1ajMuCJm0AGkoJCc9jGqpe50rW+XimO34EfRzyjDT47RbiLvDfBJAevpngN+wTfdLs1PkDnJ3zRPJkVYQiibZqpWQ19pw1+zzx1fYsUMmZ1joOV/bJuYq8=
Received: by 10.82.105.1 with SMTP id d1mr589850buc.26.1210343569281;
        Fri, 09 May 2008 07:32:49 -0700 (PDT)
Received: by 10.82.191.6 with HTTP; Fri, 9 May 2008 07:32:49 -0700 (PDT)
Message-ID: <359a92830805090732l48efe930j4a0a82b814780d8e@mail.gmail.com>
Date: Fri, 9 May 2008 10:32:49 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Using stored fields for scoring
In-Reply-To: <48245AB3.2000102@deri.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_3317_7277977.1210343569265"
References: <48245AB3.2000102@deri.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_3317_7277977.1210343569265
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Well, all things are possible <G>.... But I don't think there's a way to get
the field from each document at scoring time efficiently. It looks like
you're already lazy-loading the field, which was going to be my suggestion.

You could get it much faster if you *did* index it (UN_TOKENIZED?) and
went after it with TermDocs/TermEnum.....

So what is the nature of the field you're using? Is it possible to build
up the list of doc<->binaryfield at, say, startup time and just use a
map or some such?

You could even think about putting all the binary data in your
 index in a special document that had a field(s) orthogonal to
all other document. Essentially take the map I suggested
earlier and stuff it in a doc with one field (say,
"MySpecialMapField"). Then read *that* document in
at startup (or even search time) to get your binary field for
scoring.

All this pre-supposes that your binary field/doc_id map will fit
in memory....

What about index-time boosting? This only does you good
if your binary data above is some sort of importance ranking.
Index time boosting says something like "This document title
is more important than normal" so this would *automatically*
affect your scoring. You'd have to apply the index-time boosts
selectively to the fields you want....

And if none of this is relevant, could you expand a bit more on what
you're trying to do? What is the nature and purpose of your
field you want to use to influence scoring?

Best
Erick

On Fri, May 9, 2008 at 10:07 AM, Paolo Capriotti <paolo.capriotti@deri.org>
wrote:

> Hi all,
> I am looking for a way to include a stored (non-indexed) field in the
> computation of scores for a query.
> I have tried using a ValueSourceQuery with a ValueSource subclass that
> simply retrieves the document and gets the field, like:
>
> public float floatVal(int doc) {
>  reader.document(doc, selector).getBinaryValue("myfield");
>  ....
> }
>
> but that's too slow, because it ends up doing a lookup for each matching
> document.
> Is it possible to use a stored field in a FunctionQuery or ValueSourceQuery
> in an efficient way (i.e. not dependent on the number of retrieved
> documents)?
> If the answer is yes, is it possible to update such a value in place
> without removing and reindexing the document?
>
> Thanks in advance.
>
> Paolo Capriotti
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_3317_7277977.1210343569265--

From java-user-return-33992-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 15:39:23 2008
Return-Path: <java-user-return-33992-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11208 invoked from network); 9 May 2008 15:39:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 15:39:22 -0000
Received: (qmail 15805 invoked by uid 500); 9 May 2008 15:39:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15363 invoked by uid 500); 9 May 2008 15:39:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15351 invoked by uid 99); 9 May 2008 15:39:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 08:39:16 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 15:38:22 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JuUgF-0001lA-Ix
	for java-user@lucene.apache.org; Fri, 09 May 2008 08:38:43 -0700
Message-ID: <17150728.post@talk.nabble.com>
Date: Fri, 9 May 2008 08:38:43 -0700 (PDT)
From: wolvernie88 <mwang.zheng@gmail.com>
To: java-user@lucene.apache.org
Subject: Is this the right way to use Lucene in multithread env?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: mwang.zheng@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

Here is what I am using Lucene.

I build the index (from different data source) during midnight. I build a
FSDirectory. Then I load it into RAMDirectory for the best performance. When
I built it, I called IndexWriter.optimize() once. 

Once the index is built, I will never update it.

I have static variable defined as IndexSearcher. Once I load RAMDirectory, I
do

		        newIndexDirectory = new RAMDirectory(fsDirectory);
			IndexWriter newWriter = new IndexWriter(newIndexDirectory, new
StandardAnalyzer(), true);
			newWriter.optimize();
			newWriter.close();
		        searcher = new IndexSearcher(newIndexDirectory );

For every new search, I do

			QueryParser parser = new QueryParser("field1", new StandardAnalyzer());
			Query query = parser.parse(queryString);
			Hits hits = searcher.search(query);

Is this the right way? Do I need to close parse, query or hits?

As I have only one IndexSearcher, will it cause any problem?

I found  using the same query does not always give me the same response
time.

Thanks much.
-- 
View this message in context: http://www.nabble.com/Is-this-the-right-way-to-use-Lucene-in-multithread-env--tp17150728p17150728.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33993-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 17:05:26 2008
Return-Path: <java-user-return-33993-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38773 invoked from network); 9 May 2008 17:05:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 17:05:26 -0000
Received: (qmail 44955 invoked by uid 500); 9 May 2008 17:05:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44041 invoked by uid 500); 9 May 2008 17:05:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44030 invoked by uid 99); 9 May 2008 17:05:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 10:05:19 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.62] (HELO web50308.mail.re2.yahoo.com) (206.190.38.62)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 09 May 2008 17:04:32 +0000
Received: (qmail 92562 invoked by uid 60001); 9 May 2008 17:04:46 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=donLaF0Vfybp9/LIbC1Ubb6ayJ1bjztWP6BwZBndDvF8dqsgyrtxdPET4Rh54EV/gUI5+t7mjicbFFPbtUOBRE/eZWxpPVHUw5rDnTF6G1TdxJZdoC4RrUq3vu9XtIQ5eSec59ebMo8KQlq415rC0tYz8j0z9UMXX/0n1kCPEPU=;
X-YMail-OSG: _txMOH4VM1mDZXt.dzPsLctYwUgazUzHX5p8YPUCznxftaIvNLdf5XmM2rZi3Bhe5It_UnGr6F166y2f2MibtaRifR6Ap279pAyb5XmhacLZ_S5SzXyR1I_OKA--
Received: from [208.125.28.220] by web50308.mail.re2.yahoo.com via HTTP; Fri, 09 May 2008 10:04:45 PDT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Fri, 9 May 2008 10:04:45 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Is this the right way to use Lucene in multithread env?
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <99341.91784.qm@web50308.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

No need to close parse and it is good to use the same searcher.
I don't understand why you have that IndexWriter there if you are searching...

Also, you may not benefit from explicit loading of the index into RAM.  Try without it first.


Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: wolvernie88 <mwang.zheng@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Friday, May 9, 2008 11:38:43 AM
> Subject: Is this the right way to use Lucene in multithread env?
> 
> 
> Hi,
> 
> Here is what I am using Lucene.
> 
> I build the index (from different data source) during midnight. I build a
> FSDirectory. Then I load it into RAMDirectory for the best performance. When
> I built it, I called IndexWriter.optimize() once. 
> 
> Once the index is built, I will never update it.
> 
> I have static variable defined as IndexSearcher. Once I load RAMDirectory, I
> do
> 
>                 newIndexDirectory = new RAMDirectory(fsDirectory);
>             IndexWriter newWriter = new IndexWriter(newIndexDirectory, new
> StandardAnalyzer(), true);
>             newWriter.optimize();
>             newWriter.close();
>                 searcher = new IndexSearcher(newIndexDirectory );
> 
> For every new search, I do
> 
>             QueryParser parser = new QueryParser("field1", new 
> StandardAnalyzer());
>             Query query = parser.parse(queryString);
>             Hits hits = searcher.search(query);
> 
> Is this the right way? Do I need to close parse, query or hits?
> 
> As I have only one IndexSearcher, will it cause any problem?
> 
> I found  using the same query does not always give me the same response
> time.
> 
> Thanks much.
> -- 
> View this message in context: 
> http://www.nabble.com/Is-this-the-right-way-to-use-Lucene-in-multithread-env--tp17150728p17150728.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33994-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 17:19:24 2008
Return-Path: <java-user-return-33994-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43527 invoked from network); 9 May 2008 17:19:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 17:19:23 -0000
Received: (qmail 63799 invoked by uid 500); 9 May 2008 17:19:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63770 invoked by uid 500); 9 May 2008 17:19:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63759 invoked by uid 99); 9 May 2008 17:19:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 10:19:17 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 17:18:30 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JuWF1-0005rQ-1M
	for java-user@lucene.apache.org; Fri, 09 May 2008 10:18:43 -0700
Message-ID: <17152621.post@talk.nabble.com>
Date: Fri, 9 May 2008 10:18:43 -0700 (PDT)
From: wolvernie88 <mwang.zheng@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Is this the right way to use Lucene in multithread env?
In-Reply-To: <99341.91784.qm@web50308.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: mwang.zheng@gmail.com
References: <17150728.post@talk.nabble.com> <99341.91784.qm@web50308.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I am creating a new indexWriter to optimize the directory.

I will try using FSDirectory later.



Otis Gospodnetic wrote:
> 
> Hi,
> 
> No need to close parse and it is good to use the same searcher.
> I don't understand why you have that IndexWriter there if you are
> searching...
> 
> Also, you may not benefit from explicit loading of the index into RAM. 
> Try without it first.
> 
> 
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
> 
> 
> ----- Original Message ----
>> From: wolvernie88 <mwang.zheng@gmail.com>
>> To: java-user@lucene.apache.org
>> Sent: Friday, May 9, 2008 11:38:43 AM
>> Subject: Is this the right way to use Lucene in multithread env?
>> 
>> 
>> Hi,
>> 
>> Here is what I am using Lucene.
>> 
>> I build the index (from different data source) during midnight. I build a
>> FSDirectory. Then I load it into RAMDirectory for the best performance.
>> When
>> I built it, I called IndexWriter.optimize() once. 
>> 
>> Once the index is built, I will never update it.
>> 
>> I have static variable defined as IndexSearcher. Once I load
>> RAMDirectory, I
>> do
>> 
>>                 newIndexDirectory = new RAMDirectory(fsDirectory);
>>             IndexWriter newWriter = new IndexWriter(newIndexDirectory,
>> new
>> StandardAnalyzer(), true);
>>             newWriter.optimize();
>>             newWriter.close();
>>                 searcher = new IndexSearcher(newIndexDirectory );
>> 
>> For every new search, I do
>> 
>>             QueryParser parser = new QueryParser("field1", new 
>> StandardAnalyzer());
>>             Query query = parser.parse(queryString);
>>             Hits hits = searcher.search(query);
>> 
>> Is this the right way? Do I need to close parse, query or hits?
>> 
>> As I have only one IndexSearcher, will it cause any problem?
>> 
>> I found  using the same query does not always give me the same response
>> time.
>> 
>> Thanks much.
>> -- 
>> View this message in context: 
>> http://www.nabble.com/Is-this-the-right-way-to-use-Lucene-in-multithread-env--tp17150728p17150728.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> 
>> 
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Is-this-the-right-way-to-use-Lucene-in-multithread-env--tp17150728p17152621.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33995-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 09 23:27:24 2008
Return-Path: <java-user-return-33995-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53443 invoked from network); 9 May 2008 23:27:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 May 2008 23:27:23 -0000
Received: (qmail 79869 invoked by uid 500); 9 May 2008 23:27:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79828 invoked by uid 500); 9 May 2008 23:27:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79817 invoked by uid 99); 9 May 2008 23:27:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 16:27:17 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephen.cresswell@gmail.com designates 209.85.132.245 as permitted sender)
Received: from [209.85.132.245] (HELO an-out-0708.google.com) (209.85.132.245)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 May 2008 23:26:32 +0000
Received: by an-out-0708.google.com with SMTP id c37so327129anc.49
        for <java-user@lucene.apache.org>; Fri, 09 May 2008 16:26:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:reply-to:to:subject:in-reply-to:mime-version:content-type:references;
        bh=nybKVmHyFPOFxWuhfN+LMgBS1f0iD2Nr0uQGvhe2ha0=;
        b=wExESvJPGQ9dV1A1Sgz1QFSEKy5z94KkG5CbACFUuAZQAWhbbUafUEeBqOHT5Oioc55RZ9qYuYMIz/waWAWa6N2/1xV882TL9nMYwkj+lV1PkOnNDfTzuuysfENCsEl8M2f7KPtZEVilwgCVIOJad7AyuOS5JB0fTSSKBBJmOTo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:reply-to:to:subject:in-reply-to:mime-version:content-type:references;
        b=kMdg+VHeZN4YNm3hR00Prr8h+lMoLY0ksKbWyEla8e04l4kJREGrJ2C/FJiLAncPlF+COJm+ur/tDjTVcFsbr4LRxvJ0mWvp+ZdjxXvFDypc4Z+Icy/HFtsNMa3Apiubb9rjg/xYoPN0QKIUZ0a+/zskm0Wu8znMSTSwMZ54T8U=
Received: by 10.100.41.15 with SMTP id o15mr6602384ano.48.1210375606299;
        Fri, 09 May 2008 16:26:46 -0700 (PDT)
Received: by 10.100.229.17 with HTTP; Fri, 9 May 2008 16:26:46 -0700 (PDT)
Message-ID: <b4bc9acc0805091626k3fe668ecub9972fbc38a485de@mail.gmail.com>
Date: Sat, 10 May 2008 00:26:46 +0100
From: "Stephen Cresswell" <stephen.cresswell@gmail.com>
Reply-To: email@stephen-cresswell.net
To: java-user@lucene.apache.org
Subject: Fwd: Snowball not finding "purple"
In-Reply-To: <b4bc9acc0804220140k4f13f201j93ce8ec5f1a88dc3@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_10630_12679963.1210375606304"
References: <b4bc9acc0804220140k4f13f201j93ce8ec5f1a88dc3@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_10630_12679963.1210375606304
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

For some reason it seems that either Lucene or Snowball has a problem with
the color purple. According the snowball experts the problem is with lucene.
Can anyone shed any light? Thanks,

Steve

---------- Forwarded message ----------
From: Stephen Cresswell <stephen.cresswell@gmail.com>
Date: 2008/4/22
Subject: Snowball not finding "purple"
To: snowball-discuss@lists.tartarus.org


Hi,

I'm using Compass/Lucene + snowball/English to search the following text
which appears in several documents

"The road was a ribbon of moonlight looping the purple moor,"

Searching for the word "ribbon" returns the document, but not the word
"purple"

[945354] compass.DefaultSearchableMethodFactory search defaults: {max=10,
offset=0, reload=false, escape=false}
[945397] search.DefaultSearchMethod query: [+(+(name:ribbon^8.0
firstMessageText:ribbon^0.0 text:ribbon)) +(alias:ALIASConversationALIAS)],
[4] hits, took [2] millis
[956176] compass.DefaultSearchableMethodFactory search defaults: {max=10,
offset=0, reload=false, escape=false}
[956184] search.DefaultSearchMethod query: [+(+(name:purple^8.0
firstMessageText:purple^0.0 text:purple)) +(alias:ALIASConversationALIAS)],
[0] hits, took [1] millis

If the only change I make is to switch to  Lucene's StandardAnalyzer results
for both "ribbon" and "purple" are returned

Is this a bug or is there some strange intended behavior I'm not aware of?

Thanks

Steve

------=_Part_10630_12679963.1210375606304--

From java-user-return-33996-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 07:12:38 2008
Return-Path: <java-user-return-33996-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86174 invoked from network); 10 May 2008 07:12:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 07:12:37 -0000
Received: (qmail 49768 invoked by uid 500); 10 May 2008 07:12:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49732 invoked by uid 500); 10 May 2008 07:12:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49721 invoked by uid 99); 10 May 2008 07:12:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 00:12:31 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.18.43 as permitted sender)
Received: from [80.67.18.43] (HELO smtprelay05.ispgateway.de) (80.67.18.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 07:11:36 +0000
Received: from [91.37.195.108] (helo=p5b25c36c.dip.t-dialin.net)
	by smtprelay05.ispgateway.de with esmtpsa (TLSv1:AES256-SHA:256)
	(Exim 4.68)
	(envelope-from <lucenelist2007@danielnaber.de>)
	id 1JujFN-0000nl-TQ
	for java-user@lucene.apache.org; Sat, 10 May 2008 09:11:58 +0200
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: Fwd: Snowball not finding "purple"
Date: Sat, 10 May 2008 09:12:05 +0200
User-Agent: KMail/1.9.6 (enterprise 20070904.708012)
References: <b4bc9acc0804220140k4f13f201j93ce8ec5f1a88dc3@mail.gmail.com> <b4bc9acc0805091626k3fe668ecub9972fbc38a485de@mail.gmail.com>
In-Reply-To: <b4bc9acc0805091626k3fe668ecub9972fbc38a485de@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805100912.05769@danielnaber.de>
X-Df-Sender: 695637
X-Virus-Checked: Checked by ClamAV on apache.org

On Samstag, 10. Mai 2008, Stephen Cresswell wrote:

> For some reason it seems that either Lucene or Snowball has a problem
> with the color purple. According the snowball experts the problem is
> with lucene. Can anyone shed any light? Thanks,

You are aware that you need to use the same analyzer for indexing and for 
parsing the query, aren't you?

Some debugging instructions are also on the FAQ:
http://wiki.apache.org/lucene-java/LuceneFAQ#head-3558e5121806fb4fce80fc022d889484a9248b71

Regards
 Daniel

-- 
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33997-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 07:30:22 2008
Return-Path: <java-user-return-33997-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88963 invoked from network); 10 May 2008 07:30:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 07:30:22 -0000
Received: (qmail 54803 invoked by uid 500); 10 May 2008 07:30:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54773 invoked by uid 500); 10 May 2008 07:30:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54762 invoked by uid 99); 10 May 2008 07:30:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 00:30:16 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephen.cresswell@gmail.com designates 209.85.132.246 as permitted sender)
Received: from [209.85.132.246] (HELO an-out-0708.google.com) (209.85.132.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 07:29:29 +0000
Received: by an-out-0708.google.com with SMTP id c37so348320anc.49
        for <java-user@lucene.apache.org>; Sat, 10 May 2008 00:29:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:reply-to:to:subject:in-reply-to:mime-version:content-type:references;
        bh=0DlSMyjWJe2WA98FqZkSH8tIgzfjQEsM44b5eyCcqOM=;
        b=HWbOMZDNaClYad70j8NhmQr68bx5by30lbN3/lm44gzY3h/Ls8IQmI0kqVXtPd7+9JWLTzSBxbOyQ4hKDm75Bg9SjV8TYmnYnxO/NPvmueIDSeu9fm6PDBzKjxafLrhNwNZ0qdGTMVHYxqaKZmBysNVdGjbrqw2Atp4nVWuDbI4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:reply-to:to:subject:in-reply-to:mime-version:content-type:references;
        b=K6QnYvsafjSNZbm7cgyIDHKywuP71115PWrLo7PCNmYFFx9nSA8xLWW8jVEuRvLRV62Kf4Yf5IalDGRDAzwmU9VZB/MTP8fMP8TDmcalGSLEuRCaWbrh+Jy7JV0qBPmtbncPVwdOp53qhK+RMkYogd22MGm12OeDzMhwe0dFiLQ=
Received: by 10.100.214.3 with SMTP id m3mr6745503ang.55.1210404582829;
        Sat, 10 May 2008 00:29:42 -0700 (PDT)
Received: by 10.100.229.17 with HTTP; Sat, 10 May 2008 00:29:42 -0700 (PDT)
Message-ID: <b4bc9acc0805100029v63f7d73dq84e1929988519abe@mail.gmail.com>
Date: Sat, 10 May 2008 08:29:42 +0100
From: "Stephen Cresswell" <stephen.cresswell@gmail.com>
Reply-To: email@stephen-cresswell.net
To: java-user@lucene.apache.org
Subject: Re: Fwd: Snowball not finding "purple"
In-Reply-To: <200805100912.05769@danielnaber.de>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_11674_3490438.1210404582833"
References: <b4bc9acc0804220140k4f13f201j93ce8ec5f1a88dc3@mail.gmail.com>
	 <b4bc9acc0805091626k3fe668ecub9972fbc38a485de@mail.gmail.com>
	 <200805100912.05769@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_11674_3490438.1210404582833
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

If it was a difference between indexing / querying, why would lucene find
the word "ribbon" and not "purple" even though they appear in the same
document and are both exact matches?

AFAIK with grails searchable plugin all you have to do to the correct config
file.

Map compassSettings = ['compass.engine.analyzer.default.type': 'snowball', '
compass.engine.analyzer.default.name': 'English']

I've used Luke for tuning the queries. I'll see if I can replicate the
problem using Luke and an index. Should help narrow the problem space if I
can.

Thanks

Steve

2008/5/10 Daniel Naber <lucenelist2007@danielnaber.de>:

> On Samstag, 10. Mai 2008, Stephen Cresswell wrote:
>
> > For some reason it seems that either Lucene or Snowball has a problem
> > with the color purple. According the snowball experts the problem is
> > with lucene. Can anyone shed any light? Thanks,
>
> You are aware that you need to use the same analyzer for indexing and for
> parsing the query, aren't you?
>
> Some debugging instructions are also on the FAQ:
>
> http://wiki.apache.org/lucene-java/LuceneFAQ#head-3558e5121806fb4fce80fc022d889484a9248b71
>
> Regards
>  Daniel
>
> --
> http://www.danielnaber.de
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_11674_3490438.1210404582833--

From java-user-return-33998-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 07:46:12 2008
Return-Path: <java-user-return-33998-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92079 invoked from network); 10 May 2008 07:46:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 07:46:12 -0000
Received: (qmail 59950 invoked by uid 500); 10 May 2008 07:46:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59914 invoked by uid 500); 10 May 2008 07:46:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59903 invoked by uid 99); 10 May 2008 07:46:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 00:46:06 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.18.14 as permitted sender)
Received: from [80.67.18.14] (HELO smtprelay02.ispgateway.de) (80.67.18.14)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 07:45:17 +0000
Received: from [91.37.195.108] (helo=p5b25c36c.dip.t-dialin.net)
	by smtprelay02.ispgateway.de with esmtpsa (TLSv1:AES256-SHA:256)
	(Exim 4.68)
	(envelope-from <lucenelist2007@danielnaber.de>)
	id 1Jujlr-00028W-1d
	for java-user@lucene.apache.org; Sat, 10 May 2008 09:45:31 +0200
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: Fwd: Snowball not finding "purple"
Date: Sat, 10 May 2008 09:45:39 +0200
User-Agent: KMail/1.9.6 (enterprise 20070904.708012)
References: <b4bc9acc0804220140k4f13f201j93ce8ec5f1a88dc3@mail.gmail.com> <200805100912.05769@danielnaber.de> <b4bc9acc0805100029v63f7d73dq84e1929988519abe@mail.gmail.com>
In-Reply-To: <b4bc9acc0805100029v63f7d73dq84e1929988519abe@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805100945.39580@danielnaber.de>
X-Df-Sender: 695637
X-Virus-Checked: Checked by ClamAV on apache.org

On Samstag, 10. Mai 2008, Stephen Cresswell wrote:

> If it was a difference between indexing / querying, why would lucene
> find the word "ribbon" and not "purple" even though they appear in the
> same document and are both exact matches?

Using Snowball, "purple" becomes "purpl" but "ribbon" isn't modified, at 
least according to the online demo at 
http://snowball.tartarus.org/demo.php. Not sure if that's exactly the same 
algorithm.

Regards
 Daniel

-- 
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-33999-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 08:22:56 2008
Return-Path: <java-user-return-33999-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97341 invoked from network); 10 May 2008 08:22:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 08:22:56 -0000
Received: (qmail 72306 invoked by uid 500); 10 May 2008 08:22:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72268 invoked by uid 500); 10 May 2008 08:22:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72257 invoked by uid 99); 10 May 2008 08:22:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 01:22:51 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of stephen.cresswell@gmail.com designates 209.85.132.244 as permitted sender)
Received: from [209.85.132.244] (HELO an-out-0708.google.com) (209.85.132.244)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 08:21:55 +0000
Received: by an-out-0708.google.com with SMTP id c37so350481anc.49
        for <java-user@lucene.apache.org>; Sat, 10 May 2008 01:22:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:reply-to:to:subject:in-reply-to:mime-version:content-type:references;
        bh=TVi4WiJjAzkIx2YEXvxVxQU2RCjuYcL+eyAaEk9988I=;
        b=u7Z+9o2tOR4umaebxLX7GwzN8zmtyhFOXLkookvMXgNTjhsS5PHKC3GXKHptWzktb4Sp7EwHauejC7tABewJGqhcg0geLNXYR7RddW1LlbF4TMjDf2414VtJmwwuxrCr1C7Da/luBYzdIfyTWCeQZJbXYNVyQJMDlwfxjDX8zVs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:reply-to:to:subject:in-reply-to:mime-version:content-type:references;
        b=uap84hRsmjQjUoYNkCCIB4XjXuNF7/Ooj3+/BlHK1sN8QD/FFRj2HzGpbulYXeN0EPN2ERf9NkbnzIs6YCM94hzN4mGs5Zj4wvI8NEAy6FTohwGB8vytOfT0u8Z1BDMUz37HGJm7YlbTIiB7edqb+DI7Js8aWhG9lDDv8wTktCk=
Received: by 10.101.69.6 with SMTP id w6mr6739546ank.92.1210407735979;
        Sat, 10 May 2008 01:22:15 -0700 (PDT)
Received: by 10.100.229.17 with HTTP; Sat, 10 May 2008 01:22:15 -0700 (PDT)
Message-ID: <b4bc9acc0805100122k760b4906l6219074f1cf03642@mail.gmail.com>
Date: Sat, 10 May 2008 09:22:15 +0100
From: "Stephen Cresswell" <stephen.cresswell@gmail.com>
Reply-To: email@stephen-cresswell.net
To: java-user@lucene.apache.org
Subject: Re: Fwd: Snowball not finding "purple"
In-Reply-To: <200805100945.39580@danielnaber.de>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_11756_20665700.1210407735993"
References: <b4bc9acc0804220140k4f13f201j93ce8ec5f1a88dc3@mail.gmail.com>
	 <200805100912.05769@danielnaber.de>
	 <b4bc9acc0805100029v63f7d73dq84e1929988519abe@mail.gmail.com>
	 <200805100945.39580@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_11756_20665700.1210407735993
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Daniel,

Think you've cracked it thanks. If I search for "purpl" I get the hits I
expect. Suspect I'm doing something wrong with compass as I presume it
should be converting "purple" to "purpl" before passing the query  to
lucene. I've tried explicitly telling it to use snowball at point of query,
but it didn't make any difference. Guess I'll have to start pestering the
grails mailing list.

Thanks very much for your help.

Steve

2008/5/10 Daniel Naber <lucenelist2007@danielnaber.de>:

> On Samstag, 10. Mai 2008, Stephen Cresswell wrote:
>
> > If it was a difference between indexing / querying, why would lucene
> > find the word "ribbon" and not "purple" even though they appear in the
> > same document and are both exact matches?
>
> Using Snowball, "purple" becomes "purpl" but "ribbon" isn't modified, at
> least according to the online demo at
> http://snowball.tartarus.org/demo.php. Not sure if that's exactly the same
> algorithm.
>
> Regards
>  Daniel
>
> --
> http://www.danielnaber.de
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_11756_20665700.1210407735993--

From java-user-return-34000-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 09:13:40 2008
Return-Path: <java-user-return-34000-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4495 invoked from network); 10 May 2008 09:13:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 09:13:40 -0000
Received: (qmail 94740 invoked by uid 500); 10 May 2008 09:13:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94704 invoked by uid 500); 10 May 2008 09:13:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94687 invoked by uid 99); 10 May 2008 09:13:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 02:13:35 -0700
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=SPF_NEUTRAL,URIBL_BLACK,URIBL_GREY
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [74.125.46.29] (HELO yw-out-2324.google.com) (74.125.46.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 09:12:46 +0000
Received: by yw-out-2324.google.com with SMTP id 3so933818ywj.5
        for <java-user@lucene.apache.org>; Sat, 10 May 2008 02:12:40 -0700 (PDT)
Received: by 10.150.82.41 with SMTP id f41mr5908690ybb.175.1210410759933;
        Sat, 10 May 2008 02:12:39 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 9sm10452880yws.5.2008.05.10.02.12.39
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 10 May 2008 02:12:39 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <126142c0805070507l68f13795m8496e6803fdbc6ab@mail.gmail.com>
References: <126142c0805061426n1168421ya5594ef854fae5e4@mail.gmail.com> <B58D6ABE-CD90-4C8B-B05F-5C63BAFE9227@mikemccandless.com> <126142c0805061515p652410ebt1744c2ccd7afb8e2@mail.gmail.com> <0208CA7F-6822-4B1E-95B4-9BCF1ADD6EFB@mikemccandless.com> <126142c0805070507l68f13795m8496e6803fdbc6ab@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <28B31813-2F18-41D1-9701-DE9BC5AFC80C@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: Help to solve an issue when upgrading Lucene-Oracle integration to lucene 2.3.1
Date: Sat, 10 May 2008 05:12:37 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Just to bring closure on this issue... after numerous iterations with
Marcelo, adding diagnostics to Lucene to isolate the cause of this
exception, it turns out that it's a bug in Oracle 11g's JRE.

Marcelo worked it down to a single document, which when added to a new
index, would hit the exception.  Except, the first time he created
this single doc index it would run fine.  Only the 2nd time he created
it would it hit the exception.

A standalone test (static void main(..)) indexing that one doc runs
fine as well, on multiple OS's / JRE versions.

The bug seems to be related to the JIT compiler; specifically it seems
to cause quickSort to only partially run such that the array of terms
that are about to be flushed are not properly sorted and is left with
duplicate entries.  Very weird.

Marcelo is trying to find a workaround, eg maybe tweaking the JIT
settings, to prevent this from happening.  He's also trying to modify
the standalone test to get it to fail inside Oracle so he can submit
an issue to Oracle.

This isn't the first JRE bug that's affecting Lucene.  Here's another:

   https://issues.apache.org/jira/browse/LUCENE-1282

I don't like JRE bugs!

Mike

Marcelo Ochoa wrote:
> Hi Michael:
>   First thanks a lot for your time.
>   See comments below.
>>  Is there any way to capture & serialize the actual documents being
>>  added (this way I can "replay" those docs to reproduce it)?
>   Documents are a column VARCHAR2 from all_source Oracle's System
> view, in fact is a table as:
> create table test_source_big as (select * from all_source);
>>
>>  Are you using threads?  Is autoCommit true or false?
>   Oracle JVM uses by default a single Thread model, except that Lucene
> is starting a parallel Thread. InfoStream information shows only one
> Thread.
>   AutoCommit is false.
>   I am creating LuceneWritter with this code:
>         IndexWriter writer = null;
>         Parameters parameters = dir.getParameters();
>         int mergeFactor =
>             Integer.parseInt(parameters.getParameter("MergeFactor",
>                                                      "" +
> LogMergePolicy.DEFAULT_MERGE_FACTOR));
>         int maxBufferedDocs =
>             Integer.parseInt(parameters.getParameter 
> ("MaxBufferedDocs",
>                                                      "" +
> IndexWriter.DEFAULT_MAX_BUFFERED_DOCS));
>         int maxMergeDocs =
>             Integer.parseInt(parameters.getParameter("MaxMergeDocs",
>                                                      "" +
> LogDocMergePolicy.DEFAULT_MAX_MERGE_DOCS));
>         int maxBufferedDeleteTerms =
>             Integer.parseInt(parameters.getParameter 
> ("MaxBufferedDeleteTerms",
>                                                      "" +
>
> IndexWriter.DEFAULT_MAX_BUFFERED_DELETE_TERMS));
>         Analyzer analyzer = getAnalyzer(parameters);
>         boolean useCompountFileName =
>             "true".equalsIgnoreCase(parameters.getParameter 
> ("UseCompoundFile",
>                                                             "false"));
>         boolean autoTuneMemory =
>             "true".equalsIgnoreCase(parameters.getParameter 
> ("AutoTuneMemory",
>                                                             "true"));
>         writer =
>                 new IndexWriter(dir, autoCommitEnable, analyzer,  
> createEnable);
>         if (autoTuneMemory) {
>             long memLimit =
> ((OracleRuntime.getJavaPoolSize()/100)*50)/(1024*1024);
>             logger.info(".getIndexWriterForDir - Memory limit for
> indexing (Mb): "+memLimit);
>             writer.setRAMBufferSizeMB(memLimit);
>         } else
>             writer.setMaxBufferedDocs(maxBufferedDocs);
>         writer.setMaxMergeDocs(maxMergeDocs);
>         writer.setMaxBufferedDeleteTerms(maxBufferedDeleteTerms);
>         writer.setMergeFactor(mergeFactor);
>         writer.setUseCompoundFile(useCompountFileName);
>         if (logger.isLoggable(Level.FINE))
>             writer.setInfoStream(System.out);
>    The example pass these relevant parameters:
>     
> AutoTuneMemory:true;LogLevel:FINE;Analyzer:org.apache.lucene.analysis. 
> StopAnalyzer;MergeFactor:500
>    So, because AutoTuneMemory is true, instead of setting
> MaxBufferedDocs I am setting RAMBufferSizeMB(53) which is calculated
> using Oracle SGA free memory.
>>
>>  Are you using payloads?
>   No.
>>
>>  Were there any previous exceptions in this IndexWriter before  
>> flushing
>>  this segment?  Could you post the full infoStream output?
>   There is no provious exception. Attached a .trc file generated by
> Oracle 11g, it have infoStream information plus logging informartion
> from Oracle-Lucene data cartridge.
>>
> <snip>
>>  Could you apply the patch below & re-run?  It will likely produce
>>  insane amounts of output, but we only need the last section to see
>>  which term is hitting the bug.  If that term consistently hits  
>> the bug
>>  then we can focus on how/when it gets indexed...
>   I'll patch my lucene-2.3.1 source and send again the .trc file.
>   Also, I am comparing FSDirectory implementation (2.3.1) with my
> OJVMDirectory implementation to see changes on how the API of
> BufferedIndex[Input|Output].java is used, may be here is the problem.
>   For example latest implementation wait an IOException when open an
> IndexInput and a file doesn't exists, my code throw a RuntimeException
> wich works with Lucene 2.2.x but doesn't work with 2.3.1, this was the
> first change to get Lucene-Oracle integration working.
>   Best regards. Marcelo.
> -- 
> Marcelo F. Ochoa
> http://marceloochoa.blogspot.com/
> http://marcelo.ochoa.googlepages.com/home
> ______________
> Do you Know DBPrism? Look @ DB Prism's Web Site
> http://www.dbprism.com.ar/index.html
> More info?
> Chapter 17 of the book "Programming the Oracle Database using Java &
> Web Services"
> http://www.amazon.com/gp/product/1555583296/
> Chapter 21 of the book "Professional XML Databases" - Wrox Press
> http://www.amazon.com/gp/product/1861003587/
> Chapter 8 of the book "Oracle & Open Source" - O'Reilly
> http://www.oreilly.com/catalog/oracleopen/
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34001-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 10:33:24 2008
Return-Path: <java-user-return-34001-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14934 invoked from network); 10 May 2008 10:33:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 10:33:24 -0000
Received: (qmail 21516 invoked by uid 500); 10 May 2008 10:33:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21475 invoked by uid 500); 10 May 2008 10:33:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21463 invoked by uid 99); 10 May 2008 10:33:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 03:33:18 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.146.176.40] (HELO web26503.mail.ukl.yahoo.com) (217.146.176.40)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 10 May 2008 10:32:21 +0000
Received: (qmail 6506 invoked by uid 60001); 10 May 2008 10:32:42 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=X-YMail-OSG:Received:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=JyVbJSFNIjB1aFCWQR1PEBJ6JiQBta5rm4pF8vgEwuY6T5FoImHP5dGxvT9pfCQCgQxdnsPiL/lUCcsL79SFC1hQmIW2ZZ3eRoqd7wYiZsF/u+maeu9NqddGUxVsnDKN58y0Z7fkHrDb8Is6CtcknF0KjZ784PtOaaflXHNHG6Y=;
X-YMail-OSG: wBhVwkYVM1nuV5YOkYqBApGQQ_GDmjQxVx1_5c3IyAo96pGg56UoaLX1IkVPdgokdxW07ZqabgDzeltyKrUgtMMvs0wLgu5fWNBBv8ueQg34GL7TKHxyTvj2B10-
Received: from [82.232.236.170] by web26503.mail.ukl.yahoo.com via HTTP; Sat, 10 May 2008 12:32:42 CEST
Date: Sat, 10 May 2008 12:32:42 +0200 (CEST)
From: legrand thomas <thomaslegrand14@yahoo.fr>
Subject: Search for long titles - wildcard queries
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-2129271626-1210415562=:6426"
Content-Transfer-Encoding: 8bit
Message-ID: <742076.6426.qm@web26503.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-2129271626-1210415562=:6426
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

Dear all,
   
  I'm a recent Lucene user and I'm looking for the best way to perform searches over long titles (ad titles on a website).
   
  For example, if the following documents exist:
   
  - TITLE, "Fender telecaster"
  - TITLE, "Land rover defender"
  - TITLE, "I sale a wonderful fender stratocaster"
   
  When searching "fender", I'd like to get these three documents. I expect the same results with "fende*" or "*ender*" (I want to let the possibility to the final user to manually enter a "*" ).
  When searching "I sale a wonderful fender stratocaster", I'd like to get the third document (easy to guess :-).
   
  I think I cannot use the WildcardQuery because the term shouldn't start with "*" of "?". Should I use a QueryParser ? How can I do it ?
   
  It would be great if you could help me,
   
  Thanks in advance,
  Tom

 __________________________________________________
Do You Yahoo!?
En finir avec le spam? Yahoo! Mail vous offre la meilleure protection possible contre les messages non sollicits 
http://mail.yahoo.fr Yahoo! Mail 
--0-2129271626-1210415562=:6426--

From java-user-return-34002-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 13:36:27 2008
Return-Path: <java-user-return-34002-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51913 invoked from network); 10 May 2008 13:36:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 13:36:27 -0000
Received: (qmail 9181 invoked by uid 500); 10 May 2008 13:36:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9152 invoked by uid 500); 10 May 2008 13:36:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9141 invoked by uid 99); 10 May 2008 13:36:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 06:36:21 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephane.nicoll@gmail.com designates 209.85.132.247 as permitted sender)
Received: from [209.85.132.247] (HELO an-out-0708.google.com) (209.85.132.247)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 13:35:35 +0000
Received: by an-out-0708.google.com with SMTP id c37so363331anc.49
        for <java-user@lucene.apache.org>; Sat, 10 May 2008 06:35:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=EH/lmMFo7r1POap/mefVStINj4IQYs8rfoEG3wNHsOc=;
        b=U+qpbhdGNQyhA+0o0jn6qUV7Jqj6pPVdyKZYEX4k2gJu5b8LMSELcbHNxbiyJlcgY2H8RgK/NWx4iF0AWBRJ1QNoaRskQZGx8ongy7/KFQhylsjXzR1LsdYmpGvB7i62gP3evqtUC0wruAmmTBOXi5wuHvFtRq3eqC5TPLwhV24=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=sel9Lzd+YsSML+Lv7drN0xE/SLrF6BUClfUkpzLlB87sxtYZT0ZlHUiy+ELc4RU/VxCYRkRQ6D1KNoHxyB8sklqTxD1zN5aaSUqLTlwySCVSBVD2vmITD8VBMnlbDjNcoKV21NosF8/jsxfm1gDqr8STUAApOF3eEtWHYBbasyA=
Received: by 10.100.242.20 with SMTP id p20mr6842253anh.153.1210426547205;
        Sat, 10 May 2008 06:35:47 -0700 (PDT)
Received: by 10.100.178.12 with HTTP; Sat, 10 May 2008 06:35:47 -0700 (PDT)
Message-ID: <541f12ca0805100635sf9629abs4cb9b8c0f41f6a79@mail.gmail.com>
Date: Sat, 10 May 2008 15:35:47 +0200
From: "Stephane Nicoll" <stephane.nicoll@gmail.com>
To: java-user@lucene.apache.org
Subject: confused about an entry in the FAQ
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

>From the FAQ:

"Don't iterate over more hits than needed.
Iterating over all hits is slow for two reasons. Firstly, the search()
method that returns a Hits object re-executes the search internally
when you need more than 100 hits. Solution: use the search method that
takes a HitCollector instead."

I had a look to HitCollector but it returns the documentId and the
javadoc recommends not fetching the original query there.

I have to return *one* indexed field from the query result and
currently I am iterating on all results and it's slow. Can you explain
a bit more how I could improve this?

Thanks,
St=E9phane


--=20
Large Systems Suck: This rule is 100% transitive. If you build one,
you suck" -- S.Yegge

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34003-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 15:44:15 2008
Return-Path: <java-user-return-34003-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3000 invoked from network); 10 May 2008 15:44:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 15:44:15 -0000
Received: (qmail 71741 invoked by uid 500); 10 May 2008 15:44:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71706 invoked by uid 500); 10 May 2008 15:44:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71695 invoked by uid 99); 10 May 2008 15:44:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 08:44:09 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.128.190 as permitted sender)
Received: from [209.85.128.190] (HELO fk-out-0910.google.com) (209.85.128.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 15:43:24 +0000
Received: by fk-out-0910.google.com with SMTP id 18so1589875fkq.5
        for <java-user@lucene.apache.org>; Sat, 10 May 2008 08:43:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=owD5QbKyC08H4Jr53ZmNJl4+cdXybKqEhBLR7M1dMJg=;
        b=Kj6rc7B+yRfHnmUfOV3U0V6jrSXCIXQIHW4HIH2gGprlRoYI9tlGrzlosu/yINKq9N0I/y9ET8hVKeg18sbBlZiqvVHmjQk3UPm3mwZ/7JIaZD4bifBF33i6B06FjFruL5o1hJqEInnP5fQI3HAC0WfHvkvnX7bthHamNfflVUk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=HyRxDp9dHk3OA2MmSsxH5Q+AD7XvfgGZ+F7T7gLz4TYP/9Jf6RD5xzM+l1W29vl0YPLjkgBIsk+VMZSTVXb16v77UAO/iOBsjuV1QSCloXcsIDoiUGXaIBBe0PcIrL+q5MSCEfR6vor+ToZh/XuFItNj5EqP1tZwfwhQ4JyoN54=
Received: by 10.82.107.15 with SMTP id f15mr661713buc.86.1210434218091;
        Sat, 10 May 2008 08:43:38 -0700 (PDT)
Received: by 10.82.136.20 with HTTP; Sat, 10 May 2008 08:43:38 -0700 (PDT)
Message-ID: <8837fb770805100843t6ef3c1e0oe5a40abeca1ab9e9@mail.gmail.com>
Date: Sat, 10 May 2008 08:43:38 -0700
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: confused about an entry in the FAQ
In-Reply-To: <541f12ca0805100635sf9629abs4cb9b8c0f41f6a79@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5195_27757385.1210434218101"
References: <541f12ca0805100635sf9629abs4cb9b8c0f41f6a79@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5195_27757385.1210434218101
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

If your indexed field is not used to further filtering out the doc nor
further scoring, you should use some sort of priority queueing mechanism to
gather the top N documents. You can then call reader.document() on those
docs if necc.

-John

On Sat, May 10, 2008 at 6:35 AM, Stephane Nicoll <stephane.nicoll@gmail.com=
>
wrote:

> From the FAQ:
>
> "Don't iterate over more hits than needed.
> Iterating over all hits is slow for two reasons. Firstly, the search()
> method that returns a Hits object re-executes the search internally
> when you need more than 100 hits. Solution: use the search method that
> takes a HitCollector instead."
>
> I had a look to HitCollector but it returns the documentId and the
> javadoc recommends not fetching the original query there.
>
> I have to return *one* indexed field from the query result and
> currently I am iterating on all results and it's slow. Can you explain
> a bit more how I could improve this?
>
> Thanks,
> St=E9phane
>
>
> --
> Large Systems Suck: This rule is 100% transitive. If you build one,
> you suck" -- S.Yegge
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_5195_27757385.1210434218101--

From java-user-return-34004-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 16:43:47 2008
Return-Path: <java-user-return-34004-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14827 invoked from network); 10 May 2008 16:43:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 16:43:47 -0000
Received: (qmail 4346 invoked by uid 500); 10 May 2008 16:43:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4322 invoked by uid 500); 10 May 2008 16:43:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4311 invoked by uid 99); 10 May 2008 16:43:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 09:43:42 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 16:42:49 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 0F4CC71CE17; Sat, 10 May 2008 09:43:10 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 0B9DE71CE16
	for <java-user@lucene.apache.org>; Sat, 10 May 2008 09:43:10 -0700 (PDT)
Date: Sat, 10 May 2008 09:43:10 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Subject: Re: how to change the segment file names
In-Reply-To: <6e3ae6310805071553n51c98df2t394e2e9fd55aed7c@mail.gmail.com>
Message-ID: <Pine.LNX.4.62.0805100941180.26610@radix.cryptio.net>
References: <6e3ae6310805071553n51c98df2t394e2e9fd55aed7c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org

: Currently, segment file names all start with _0, and increase with each new
: segment created. But seems there is no easy way to change the segment file
: names.
: 
: This causes trouble when copying one index to another index's directory, if
: the .cfs files have the same name.

This isn't something that's really supported in Lucene.  A Lucene index is 
a directory -- you should treat the entire directory as special, and not 
add your own files (or files from another Lucene index) in to it.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34005-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 16:50:21 2008
Return-Path: <java-user-return-34005-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16686 invoked from network); 10 May 2008 16:50:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 16:50:21 -0000
Received: (qmail 10952 invoked by uid 500); 10 May 2008 16:50:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10912 invoked by uid 500); 10 May 2008 16:50:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10901 invoked by uid 99); 10 May 2008 16:50:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 09:50:16 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephane.nicoll@gmail.com designates 72.14.220.155 as permitted sender)
Received: from [72.14.220.155] (HELO fg-out-1718.google.com) (72.14.220.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 16:49:30 +0000
Received: by fg-out-1718.google.com with SMTP id l27so1379443fgb.27
        for <java-user@lucene.apache.org>; Sat, 10 May 2008 09:49:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to:in-reply-to:content-type:x-mailer:mime-version:subject:content-transfer-encoding:date:references;
        bh=lStst3psLlSpCZb1oLfAZDFAZlPgOe+0JK6Vu+5SOI8=;
        b=gyjSyNeN4zKbicH9u+3RZM7fpoTaKpYdE4IdCQ4HwIR6KQFbBYN3nOS6rTPU35hpgPKNkwzt7aQx/RyKUZZF9kr+df1Nk3QiMJOnUpBMdxOjhS/xIjqJBQzqWXHXtGiNcpCll6g3o3Jf0y32hsxygaju9Oki5EjB5Ja4zHGVrx4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type:x-mailer:mime-version:subject:content-transfer-encoding:date:references;
        b=R1F50tvY0BhUF5E3+r1FqE6+2oX1TTwi8rmE2t0vLWSkBg4YYzZAGEauIVZP0j5sNnx/O0go9f1ec1d2jzJeR8OHw+B2ojj7ENaMHzLdgkjcjiS52VUeRAfkauuAoG6fsmIy9k7OiFGLm8+rWbFVeA2nMg56ZHjPNQpx2mhy+y4=
Received: by 10.86.26.11 with SMTP id 11mr10827345fgz.21.1210438184443;
        Sat, 10 May 2008 09:49:44 -0700 (PDT)
Received: from ?192.168.1.7? ( [87.67.152.23])
        by mx.google.com with ESMTPS id 22sm9432254fkr.11.2008.05.10.09.49.42
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 10 May 2008 09:49:43 -0700 (PDT)
Message-Id: <CF53C86E-3A1C-41F8-ABC3-CEFD8F4146BC@gmail.com>
From: =?UTF-8?Q?St=C3=A9phane_Nicoll?= <stephane.nicoll@gmail.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
In-Reply-To: <8837fb770805100843t6ef3c1e0oe5a40abeca1ab9e9@mail.gmail.com>
Content-Type: text/plain;
	charset=UTF-8;
	format=flowed;
	delsp=yes
X-Mailer: iPhone Mail (4A93)
Mime-Version: 1.0 (iPhone Mail 4A93)
Subject: Re: confused about an entry in the FAQ
Content-Transfer-Encoding: quoted-printable
Date: Sat, 10 May 2008 18:50:02 +0200
References: <541f12ca0805100635sf9629abs4cb9b8c0f41f6a79@mail.gmail.com> <8837fb770805100843t6ef3c1e0oe5a40abeca1ab9e9@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Sorry I don't get it. Do you have a sample code?

Sent from my iPhone

On 10 May 2008, at 17:43, "John Wang" <john.wang@gmail.com> wrote:

> If your indexed field is not used to further filtering out the doc nor
> further scoring, you should use some sort of priority queueing =20
> mechanism to
> gather the top N documents. You can then call reader.document() on =20
> those
> docs if necc.
>
> -John
>
> On Sat, May 10, 2008 at 6:35 AM, Stephane Nicoll =
<stephane.nicoll@gmail.com=20
> >
> wrote:
>
>> =46rom the FAQ:
>>
>> "Don't iterate over more hits than needed.
>> Iterating over all hits is slow for two reasons. Firstly, the search=20=

>> ()
>> method that returns a Hits object re-executes the search internally
>> when you need more than 100 hits. Solution: use the search method =20
>> that
>> takes a HitCollector instead."
>>
>> I had a look to HitCollector but it returns the documentId and the
>> javadoc recommends not fetching the original query there.
>>
>> I have to return *one* indexed field from the query result and
>> currently I am iterating on all results and it's slow. Can you =20
>> explain
>> a bit more how I could improve this?
>>
>> Thanks,
>> St=C3=A9phane
>>
>>
>> --
>> Large Systems Suck: This rule is 100% transitive. If you build one,
>> you suck" -- S.Yegge
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: j

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34006-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 17:23:24 2008
Return-Path: <java-user-return-34006-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20778 invoked from network); 10 May 2008 17:23:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 17:23:24 -0000
Received: (qmail 21859 invoked by uid 500); 10 May 2008 17:23:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21823 invoked by uid 500); 10 May 2008 17:23:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21812 invoked by uid 99); 10 May 2008 17:23:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 10:23:17 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 17:22:28 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JusmP-00043a-Ca
	for java-user@lucene.apache.org; Sat, 10 May 2008 10:22:41 -0700
Message-ID: <17165550.post@talk.nabble.com>
Date: Sat, 10 May 2008 10:22:41 -0700 (PDT)
From: esra <esraersan@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: lucene farsi problem
In-Reply-To: <9294E20AED46934EA459020706463F94A04BF1@SUEXCL-02.ad.syr.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: esraersan@gmail.com
References: <16977096.post@talk.nabble.com> <08DF1421-37F0-4124-BCE3-DCD68EEC189A@apache.org> <16980977.post@talk.nabble.com> <1B1FC94C-66E4-4A8D-8C92-38CCCEFDF3E8@apache.org> <16993174.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04A4E@SUEXCL-02.ad.syr.edu> <17019498.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04AD2@SUEXCL-02.ad.syr.edu> <17022861.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04ADD@SUEXCL-02.ad.syr.edu> <17023557.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04AE6@SUEXCL-02.ad.syr.edu> <17034715.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04B4C@SUEXCL-02.ad.syr.edu> <17080852.post@talk.nabble.com> <9294E20AED46934EA459020706463F94A04BF1@SUEXCL-02.ad.syr.edu>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Steve,

i used the locale as "ar" and it works fine .

again thanks a lot for your help.

Esra


Steven A Rowe wrote:
>=20
> Hi Esra,
>=20
> On 05/06/2008 at 7:38 AM, esra wrote:
>> i tried the class and it works fine with the locale parameter "ar".
>=20
> Cool, I'm glad this addressed your problem!
>=20
>> Actually we are using "fa" for farsi and "ar" for arabic.
>> I have added a little control for the locale parameter in my
>> code and now i can see the correct results.
>=20
> From what I could tell, the Collator available for Locale("fa") in the Su=
n
> 1.4.2 and 1.5.0 JDKs does not contain Farsi character collation, but the
> Collator available for Locale("ar") *does* contain Farsi collation.  I
> switched TestCollatingRangeQuery from Locale("fa") to Locale("ar") when I
> couldn't get the Collator returned for Farsi [ via
> Collator.getInstance(new Locale("fa") ] to produce correct results.
>=20
> Did you find that Locale("fa") produces the correct results?  If so, whic=
h
> VM are you using?
>=20
> At Chris Hostetter's suggestion, I am rewriting the patch attached to
> LUCENE-1279, including the following changes:
>=20
> - Merged the contents of the CollatingRangeQuery class into RangeQuery an=
d
> RangeFilter
> - Switched the Locale parameter to instead take an instance of Collator
> - Modified QueryParser.jj to construct a QueryParser class that can accep=
t
> a range collator and pass it either to RangeQuery or through
> ConstantScoreRangeQuery to RangeFilter.
>=20
> I plan on posting the revised patch in the next day or two.
>=20
> Steve
>=20
> On 05/06/2008 at 7:38 AM, esra wrote:
>>=20
>> Hi Steven ,
>> Hi Steven,
>>=20
>> i tried the class and it works fine with the locale parameter "ar".
>>=20
>> Actually we are using "fa" for farsi and "ar" for arabic.
>> I have added a little control for the locale parameter in my
>> code and now i can see the correct results.
>>=20
>> Thank you very much for ypur help.
>>=20
>> Esra.
>>=20
>> Steven A Rowe wrote:
>> >=20
>> > Hi Esra,
>> >=20
>> > I have attached a patch to LUCENE-1279 containing a new class:
>> > CollatingRangeQuery.
>> >=20
>> > The patch also contains a test class: TestCollatingRangeQuery.  One of
>> > the test methods checks for the Farsi range you were having trouble
>> > with.
>> >=20
>> > It should be mentioned that according to
>> > Collator.getAvailableLocales(), neither Java 1.4.2 nor Java 1.5.0
>> > contains Farsi collation information. However, in the test class I use
>> > the Arabic Locale, which seems to properly collate the non-Arabic Fars=
i
>> > letter U+0698, and hopefully behaves well with other Farsi letters.  I=
f
>> > you find that this is not the case, you can look into writing collatio=
n
>> > rules using RuleBasedCollator - you should be able to directly specify
>> > the proper letter orderings for Farsi; CollatingRangeQuery would also
>> > have to supply a constructor that takes in a Collator instead of a
>> > Locale.
>> >=20
>> > Please give the class a try and post back about how it works.
>> >=20
>> > Thanks,
>> > Steve
>> >=20
>> > On 05/03/2008 at 8:33 AM, esra wrote:
>> > >=20
>> > > Hi Steven,
>> > >=20
>> > > thanks for your help....
>> > >=20
>> > > Esra
>> > >=20
>> > >=20
>> > > Steven A Rowe wrote:
>> > > >=20
>> > > > Hi Esra,
>> > > >=20
>> > > > I have created an issue for this - see
>> > > > <https://issues.apache.org/jira/browse/LUCENE-1279>.
>> > > >=20
>> > > > I'll try to take a crack at a patch this weekend.
>> > > >=20
>> > > > Steve
>> > > >=20
>> > > > On 05/02/2008 at 12:55 PM, esra wrote:
>> > > > >=20
>> > > > > Hi Steven ,
>> > > > >=20
>> > > > > yes you are right, sorry i am a bit confused.
>> > > > >=20
>> > > > > i checked again and the correct one is  "zhe"/U+698.
>> > > > >=20
>> > > > > It seems the word is in the range but my customer says it
>> > > > > shouldn't be.
>> > > > >=20
>> > > > > I think problem occurs because  "zhe" is a Persian letter
>> > > > > outside the Arabic
>> > > > > alphabet. In farsi alphabet this letter is not after the "=D8=B3=
"
>> > > > > letter but it's
>> > > > > unicode is bigger than "=D8=B3" letter's and the searcher works
>> > > > > with unicodes.
>> > > > >=20
>> > > > > Esra
>> > > > >=20
>> > > > >=20
>> > > > > Steven A Rowe wrote:
>> > > > > >=20
>> > > > > > Hi Esra,
>> > > > > >=20
>> > > > > > You are *still* incorrectly referring to the glyph with three
>> dots
>> > > > > > over it:
>> > > > > >=20
>> > > > > > On 05/02/2008 at 12:18 PM, esra wrote:
>> > > > > > > yes the correct one is "=DA=98 "/"ze"/U+632.
>> > > > > >=20
>> > > > > > "=DA=98" is *not* "ze"/U+632 - it is "zhe"/U+698.
>> > > > > >=20
>> > > > > > Have you increased the font size?  Can you see the difference
>> > > > > > between these two?:
>> > > > > >=20
>> > > > > > "=DA=98"/"zhe"/U+698
>> > > > > > "=D8=B2"/"ze"/U+632
>> > > > > >=20
>> > > > > > > my problem is when i do search for  "=D8=AF-=DA=98" range.
>> The result is
>> > > "=D8=B3=D8=A7=D8=A8
>> > > > > > > =D9=88=D9=88=D9=81=D8=B1" and this word's first letter is "=
=D8=B3" and it's unicode is
>> > > > > > > "U+633" and it is not in the in the [ U+062F -
>> U+0632 ] range.
>> > > > > >=20
>> > > > > > Like I keep saying, in the above description, you're
>> using the
>> > > glyph
>> > > > > > "=DA=98"/"zhe"/U+698, while calling at the same time incorrect=
ly
>> > > > > > referring to it as "ze"/U+632.
>> > > > > >=20
>> > > > > > I don't mean to continually bang on about this - if you're
>> *sure*
>> > > > > > that when you search, you're using the character represented b=
y
>> the
>> > > > > > glyph with one dot (and not three), i.e. "=D8=B2"/"ze"/U+632, =
then
>> the
>> > > > > > problem lies elsewhere.
>> > > > > >=20
>> > > > > > Steve
>> > > > > >=20
>> > > > > > On 05/02/2008 at 12:18 PM, esra wrote:
>> > > > > > > yes the correct one is "=DA=98 "/"ze"/U+632.
>> > > > > > >=20
>> > > > > > > my problem is when i do search for  "  =D8=AF-=DA=98" range.=
 The result
>> is=20
>> > > > > > > ""=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1 " and this wor=
d's first letter is "=D8=B3 " and it's
>> unicode
>> > > > > > > is "U+633"  and  it is not in the in the [ U+062F - U+0632 ]
>> range.
>> > > > > > >=20
>> > > > > > > am i wrong?
>> > > > > > >=20
>> > > > > > > Esra
>> > > > > > >=20
>> > > > > > > Steven A Rowe wrote:
>> > > > > > > >=20
>> > > > > > > > Hi Esra,
>> > > > > > > >=20
>> > > > > > > > I still think you're wrong :).
>> > > > > > > >=20
>> > > > > > > > On 05/02/2008 at 9:31 AM, esra wrote:
>> > > > > > > > > > =DA=98 =3D U+632
>> > > > > > > >=20
>> > > > > > > > According to the website you linked to, the
>> above character,
>> > > which
>> > > > > > > > has three dots over it, is named "zhe", and its
>> > > Unicode code point
>> > > > > is
>> > > > > > > > U+698. (I had to increase the font size to see the three
>> dots.)
>> > > > > > > >=20
>> > > > > > > > I think you are confusing "=DA=98"/"zhe"/U+698 with the le=
tter
>> > > > > > > > "=D8=B2"/"ze"/U+632, which has just one dot over it.
>> > > > > > > >=20
>> > > > > > > > Unless you were mistaken in all of your emails when
>> > > you included
>> > > > > the
>> > > > > > > > character "=DA=98"/"zhe" instead of "=D8=B2"/"ze", then wh=
at I said
>> in my
>> > > > > > > > previous email still stands: there is no problem here.
>> > > > > > > >=20
>> > > > > > > > Steve
>> > > > > > > >=20
>> > > > > > > > On 05/02/2008 at 9:31 AM, esra wrote:
>> > > > > > > > >=20
>> > > > > > > > > Hi Steven,
>> > > > > > > > >=20
>> > > > > > > > > sorry i made a mistake. unicodes are like this:
>> > > > > > > > >=20
>> > > > > > > > > > =D8=AF=3DU+62F
>> > > > > > > > > > =DA=98 =3D U+632
>> > > > > > > > > > and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=D9=
=88=D9=81=D8=B1 " is  =D8=B3 =3D U+633
>> > > > > > > > >=20
>> > > > > > > > > you can also check them here
>> > > > > > > > > >=20
>> > > > > http://www.unics.uni-hannover.de/nhtcapri/persian-alphabet.html
>> > > > > > > > >=20
>> > > > > > > > > Esra
>> > > > > > > > >=20
>> > > > > > > > >=20
>> > > > > > > > > Steven A Rowe wrote:
>> > > > > > > > > >=20
>> > > > > > > > > > Hi Esra,
>> > > > > > > > > >=20
>> > > > > > > > > > Going back to the original problem statement, I
>> > > see something
>> > > > > that
>> > > > > > > > > > looks illogical to me - please correct me if I'm wrong=
:
>> > > > > > > > > >=20
>> > > > > > > > > > On Apr 30, 2008, at 3:21 AM, esra wrote:
>> > > > > > > > > > > i am using lucene's "IndexSearcher" to search
>> > > the given xml
>> > > > > by
>> > > > > > > > > > > keyword which contains farsi information.
>> > > while searching i
>> > > > > use
>> > > > > > > > > > > ranges like
>> > > > > > > > > > >=20
>> > > > > > > > > > > =D8=A2-=D8=AB  |  =D8=AC-=D8=AE  |  =D8=AF-=DA=98  |=
  =D8=B3-=D8=B8  |  =D8=B9-=D9=82  |  =DA=A9-=D9=84  |  =D9=85-=DB=8C
>> > > > > > > > > > >=20
>> > > > > > > > > > > when i do search for  "=D8=AF-=DA=98"  range the res=
ults
>> > > are wrong ,
>> > > > > they
>> > > > > > > > > > > are the results of  " =D8=B3-=D8=B8 "range.
>> > > > > > > > > > >=20
>> > > > > > > > > > > for example when i do search for "=D8=AF-=DA=98"
>> one of the the
>> > > results
>> > > > > > > > > > > is "=D8=B3=D8=A7=D8=A8 =D9=88=D9=88=D9=81=D8=B1", th=
is result also shown on the "
>> > > =D8=B3-=D8=B8 " range's
>> > > > > result
>> > > > > > > > > > > list which is the corret range.
>> > > > > > > > > > >=20
>> > > > > > > > > > > As IndexSearcher use "compareTo" method
>> and this method
>> > > uses
>> > > > > > > > > > > unicodes for comparing, i found the unicodes of the
>> characters.
>> > > > > > > > > > >=20
>> > > > > > > > > > > =D8=AF=3DU+62F
>> > > > > > > > > > > =DA=98 =3D U+698
>> > > > > > > > > > > and the first letter of "=D8=B3=D8=A7=D8=A8 =D9=88=
=D9=88=D9=81=D8=B1 " is  =D8=B3 =3D U+633
>> > > > > > > > > >=20
>> > > > > > > > > > It appears to me that *both* the "=D8=AF-=DA=98" range=
 [
>> > > > > U+062F - U+0698 ]
>> > > > > > > and
>> > > > > > > > > > the "=D8=B3-=D8=B8" range [ U+0633 - U+0638 ] contain =
the
>> > > > > first letter of
>> > > > > > > "=D8=B3=D8=A7=D8=A8
>> > > > > > > > > > =D9=88=D9=88=D9=81=D8=B1", which is "=D8=B3" =3D U+063=
3.
>> > > > > > > > > >=20
>> > > > > > > > > > You stated that U+0633 should be contained in the [
>> > > > > U+0633 - U+0638
>> > > > > > > ]
>> > > > > > > > > > range - I agree - but why do you think U+0633 should
>> not be
>> > > > > > > > > > contained in the [ U+062F - U+0698 ] range?
>> > > > > > > > > >=20
>> > > > > > > > > > In other words, it looks to me like your problem is
>> > > > > not a problem
>> > > > > > > at
>> > > > > > > > > > all.
>> > > > > > > > > >=20
>> > > > > > > > > > Steve
>> > > > > > > > > >=20
>> > > > > > > > > >=20
>> > > > > > > > >=20
>> > > > > > > > > -- View this message in context:
>> > > > > > > > >=20
>> > > > > > >=20
>> > > > > > >
>> http://www.nabble.com/lucene-farsi-problem-tp16977096p17019498
>> > > > > > > .html Sent
>> > > > > > > > from the Lucene - Java Users mailing list archive at
>> Nabble.com.
>> > > > > > > >=20
>> > > > > > > >=20
>> > > > > > > >=20
>> > > > >=20
>> > >=20
>> ---------------------------------------------------------------------
>> > > > > > > To
>> > > > > > > > unsubscribe, e-mail:
>> java-user-unsubscribe@lucene.apache.org
>> > > For
>> > > > > > > > additional commands, e-mail:
>> java-user-help@lucene.apache.org
>> > > > > > > >=20
>> > > > > > > >=20
>> > > > > > >=20
>> > > > > > >=20
>> > > > > > >=20
>> > > > > > >=20
>> > > > > > >=20
>> > > > > > >=20
>> > > > > > > -- View this message in context:
>> > > > > >=20
>> > > http://www.nabble.com/lucene-farsi-problem-tp16977096p17022861.html
>> > > > > >  Sent from the Lucene - Java Users mailing list archive at
>> > > > > Nabble.com.
>> > > > > >=20
>> > > > > >=20
>> > > > > >=20
>> > > > >=20
>> > >=20
>> ---------------------------------------------------------------------
>> > > > > >  To unsubscribe, e-mail:
>> java-user-unsubscribe@lucene.apache.org
>> > > > > >  For additional commands, e-mail:
>> > > java-user-help@lucene.apache.org
>> > > > > >=20
>> > > > > >=20
>> > > > > >=20
>> > > > > >=20
>> > > > > >=20
>> > > > >=20
>> > > > > -- View this message in context:
>> > > > >=20
>> > > http://www.nabble.com/lucene-farsi-problem-tp16977096p17023557
>> > > .html Sent
>> > > > from the Lucene - Java Users mailing list archive at Nabble.com.
>> > > >=20
>> > > >=20
>> > > >=20
>> ---------------------------------------------------------------------
>> > > To
>> > > > unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org For
>> > > > additional commands, e-mail: java-user-help@lucene.apache.org
>> > > >=20
>> > > >=20
>> > >=20
>> > >=20
>> > >=20
>> > >=20
>> > >=20
>> > >=20
>> >  -- View this message in context:
>> >  http://www.nabble.com/lucene-farsi-problem-tp16977096p17034715.html
>> >  Sent from the Lucene - Java Users mailing list archive at
>> Nabble.com.
>> >=20
>> >=20
>> >=20
>> ---------------------------------------------------------------------
>> >  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >  For additional commands, e-mail: java-user-help@lucene.apache.org
>> >=20
>> >=20
>> >=20
>> >=20
>> >=20
>>=20
>> -- View this message in context:
>> http://www.nabble.com/lucene-farsi-problem-tp16977096p17080852.html Sent
>> from the Lucene - Java Users mailing list archive at Nabble.com.
>>=20
>>=20
>> --------------------------------------------------------------------- To
>> unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org For
>> additional commands, e-mail: java-user-help@lucene.apache.org
>>=20
>>
>=20
> =20
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/lucene-farsi-problem-tp=
16977096p17165550.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34007-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 10 18:05:51 2008
Return-Path: <java-user-return-34007-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25976 invoked from network); 10 May 2008 18:05:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 May 2008 18:05:51 -0000
Received: (qmail 37904 invoked by uid 500); 10 May 2008 18:05:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37870 invoked by uid 500); 10 May 2008 18:05:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37859 invoked by uid 99); 10 May 2008 18:05:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 11:05:44 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of patrek@gmail.com designates 209.85.146.179 as permitted sender)
Received: from [209.85.146.179] (HELO wa-out-1112.google.com) (209.85.146.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 18:04:59 +0000
Received: by wa-out-1112.google.com with SMTP id l24so2321978waf.11
        for <java-user@lucene.apache.org>; Sat, 10 May 2008 11:05:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=q4Jl1F2Qtn6prSvN8XQrOt5eSUrgfUV/Kwvq3cyB1Go=;
        b=RFwY1Nb2cGJLtCxu46JXksts3GG7Ufm5OV+ts3GtkE32Ht4M+4QcK7ODJbyPV9GUAmYT4P0pvEQnI6kHvw72yY8amvMNLCiO8VS1D4xzxu/voEjCzlmoMyicHr1pAJ00B2NS1jSIch622k1tWfHq6WwxH9wT5OUkSFOdF+EoPOQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=VZShCUzpgF+qFQJqgzAXlHIDksPqxTwFpvxEhLKmRPn+rHDMKFjwwT4kNLHWSjjDA82D+4axc6HhB+hMA+dpueQBcS1TslRlhrPL2GulIiCz2XHSpigh0zHPeKf/8/wn4tMOEOkyv70iszisF8aHf1McW7BAjNeN90D4rmAX5/Q=
Received: by 10.115.76.5 with SMTP id d5mr5509281wal.191.1210442713714;
        Sat, 10 May 2008 11:05:13 -0700 (PDT)
Received: by 10.114.184.8 with HTTP; Sat, 10 May 2008 11:05:12 -0700 (PDT)
Message-ID: <48b038c60805101105q767968a2sc9de677130100742@mail.gmail.com>
Date: Sat, 10 May 2008 14:05:12 -0400
From: "Patrick Turcotte" <patrek@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: confused about an entry in the FAQ
In-Reply-To: <541f12ca0805100635sf9629abs4cb9b8c0f41f6a79@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <541f12ca0805100635sf9629abs4cb9b8c0f41f6a79@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Did you try the IndexSearcher.doc(int i, FieldSelector fieldSelector)  meth=
od?

Could be faster because Lucene don't have do "prepare" the whole document.

Patrick

On Sat, May 10, 2008 at 9:35 AM, Stephane Nicoll
<stephane.nicoll@gmail.com> wrote:
> From the FAQ:
>
> "Don't iterate over more hits than needed.
> Iterating over all hits is slow for two reasons. Firstly, the search()
> method that returns a Hits object re-executes the search internally
> when you need more than 100 hits. Solution: use the search method that
> takes a HitCollector instead."
>
> I had a look to HitCollector but it returns the documentId and the
> javadoc recommends not fetching the original query there.
>
> I have to return *one* indexed field from the query result and
> currently I am iterating on all results and it's slow. Can you explain
> a bit more how I could improve this?
>
> Thanks,
> St=E9phane
>
>
> --
> Large Systems Suck: This rule is 100% transitive. If you build one,
> you suck" -- S.Yegge
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34008-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 11 01:38:11 2008
Return-Path: <java-user-return-34008-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39586 invoked from network); 11 May 2008 01:38:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 May 2008 01:38:11 -0000
Received: (qmail 90265 invoked by uid 500); 11 May 2008 01:38:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90235 invoked by uid 500); 11 May 2008 01:38:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90224 invoked by uid 99); 11 May 2008 01:38:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 May 2008 18:38:06 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.242] (HELO web50309.mail.re2.yahoo.com) (206.190.38.242)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 11 May 2008 01:37:10 +0000
Received: (qmail 62888 invoked by uid 60001); 11 May 2008 01:37:30 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=gAM9p3voNJPG2F8oCF26js0+ly5TuuHpTzV0hZ9SO7XUZoYNQHBvpx2vSWyJ8VFs/cDA8rBI64JRwn3n+p1sa7R0pk5uN/ddnHwnWLqhZgvEgv8Geh0PrvTgtojbjOFQ0X6Kg4YYSVpYaemO+iA5gj+K0fNxHj6eDCH1Fdo0Jas=;
X-YMail-OSG: fgA4QiIVM1m_HHGnaTNix6XfgOpk_6bCptdw3sdqsHrX1N9g6cgf5aW6cH7c2ZzA3w--
Received: from [72.231.9.236] by web50309.mail.re2.yahoo.com via HTTP; Sat, 10 May 2008 18:37:30 PDT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Sat, 10 May 2008 18:37:30 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: how to change the segment file names
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <726711.62625.qm@web50309.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Of course, you can make use of addIndexes and merge existing indices that way.


Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: Chris Hostetter <hossman_lucene@fucit.org>
> To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
> Sent: Saturday, May 10, 2008 12:43:10 PM
> Subject: Re: how to change the segment file names
> 
> : Currently, segment file names all start with _0, and increase with each new
> : segment created. But seems there is no easy way to change the segment file
> : names.
> : 
> : This causes trouble when copying one index to another index's directory, if
> : the .cfs files have the same name.
> 
> This isn't something that's really supported in Lucene.  A Lucene index is 
> a directory -- you should treat the entire directory as special, and not 
> add your own files (or files from another Lucene index) in to it.
> 
> 
> -Hoss
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34009-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 11 18:32:01 2008
Return-Path: <java-user-return-34009-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58327 invoked from network); 11 May 2008 18:32:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 May 2008 18:32:01 -0000
Received: (qmail 85038 invoked by uid 500); 11 May 2008 18:31:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85005 invoked by uid 500); 11 May 2008 18:31:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84994 invoked by uid 99); 11 May 2008 18:31:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 May 2008 11:31:56 -0700
X-ASF-Spam-Status: No, hits=-3.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.108.46] (HELO SUEXCL-02.ad.syr.edu) (128.230.108.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 May 2008 18:30:58 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
Subject: RE: lucene farsi problem
Date: Sun, 11 May 2008 14:29:35 -0400
Message-ID: <9294E20AED46934EA459020706463F94A04CB1@SUEXCL-02.ad.syr.edu>
In-Reply-To: <17165550.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: lucene farsi problem
Thread-Index: AciywpEGH4rc3en4SOS8m9aZ+0r/LAA0d9fg
From: "Steven A Rowe" <sarowe@syr.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgRXNyYSwNCg0KRGlkIHlvdSB0cnkgdGhlIG5ldyB2ZXJzaW9uIG9mIHRoZSBwYXRjaD8NCg0K
SW4gdGhlIGxhdGVzdCB2ZXJzb24sIEkgaGF2ZSB0YWtlbiB0aGUgY29kZSB0aGF0IHdhcyBpbiBD
b2xsYXRpbmdSYW5nZVF1ZXJ5IGFuZCBwdXQgaXQgaW50byBSYW5nZVF1ZXJ5Lg0KDQpJIGFsc28g
cHV0IHRoZSBzYW1lIGZ1bmN0aW9uYWxpdHkgaW50byBSYW5nZUZpbHRlciwgYW5kIHByb3ZpZGVk
IGNvZGUgdG8gY2FsbCBpdCBmcm9tIENvbnN0YW50U2NvcmVSYW5nZVF1ZXJ5IGFuZCBRdWVyeVBh
cnNlci4gIE5vdGUgdGhhdCBDb25zdGFudFNjb3JlUmFuZ2VRdWVyeSBkb2Vzbid0IGhhdmUgdGhl
IGNsYXVzZSBsaW1pdCByZXN0cmljdGlvbiB0aGF0IFJhbmdlUXVlcnkgaGFzICgxMDI0IG1heCBj
bGF1c2VzLCBJSVJDKS4NCg0KU3RldmUNCg0KT24gMDUvMTAvMjAwOCBhdCAxOjIyIFBNLCBlc3Jh
IHdyb3RlOg0KPiANCj4gSGkgU3RldmUsDQo+IA0KPiBpIHVzZWQgdGhlIGxvY2FsZSBhcyAiYXIi
IGFuZCBpdCB3b3JrcyBmaW5lIC4NCj4gDQo+IGFnYWluIHRoYW5rcyBhIGxvdCBmb3IgeW91ciBo
ZWxwLg0KPiANCj4gRXNyYQ0KPiANCj4gDQo+IFN0ZXZlbiBBIFJvd2Ugd3JvdGU6DQo+ID4gDQo+
ID4gSGkgRXNyYSwNCj4gPiANCj4gPiBPbiAwNS8wNi8yMDA4IGF0IDc6MzggQU0sIGVzcmEgd3Jv
dGU6DQo+ID4gPiBpIHRyaWVkIHRoZSBjbGFzcyBhbmQgaXQgd29ya3MgZmluZSB3aXRoIHRoZSBs
b2NhbGUgcGFyYW1ldGVyICJhciIuDQo+ID4gDQo+ID4gQ29vbCwgSSdtIGdsYWQgdGhpcyBhZGRy
ZXNzZWQgeW91ciBwcm9ibGVtIQ0KPiA+IA0KPiA+ID4gQWN0dWFsbHkgd2UgYXJlIHVzaW5nICJm
YSIgZm9yIGZhcnNpIGFuZCAiYXIiIGZvciBhcmFiaWMuDQo+ID4gPiBJIGhhdmUgYWRkZWQgYSBs
aXR0bGUgY29udHJvbCBmb3IgdGhlIGxvY2FsZSBwYXJhbWV0ZXIgaW4gbXkNCj4gPiA+IGNvZGUg
YW5kIG5vdyBpIGNhbiBzZWUgdGhlIGNvcnJlY3QgcmVzdWx0cy4NCj4gPiANCj4gPiBGcm9tIHdo
YXQgSSBjb3VsZCB0ZWxsLCB0aGUgQ29sbGF0b3IgYXZhaWxhYmxlIGZvciBMb2NhbGUoImZhIikg
aW4gdGhlDQo+ID4gU3VuIDEuNC4yIGFuZCAxLjUuMCBKREtzIGRvZXMgbm90IGNvbnRhaW4gRmFy
c2kgY2hhcmFjdGVyIGNvbGxhdGlvbiwNCj4gPiBidXQgdGhlIENvbGxhdG9yIGF2YWlsYWJsZSBm
b3IgTG9jYWxlKCJhciIpICpkb2VzKiBjb250YWluIEZhcnNpDQo+ID4gY29sbGF0aW9uLiAgSSBz
d2l0Y2hlZCBUZXN0Q29sbGF0aW5nUmFuZ2VRdWVyeSBmcm9tIExvY2FsZSgiZmEiKSB0bw0KPiA+
IExvY2FsZSgiYXIiKSB3aGVuIEkgY291bGRuJ3QgZ2V0IHRoZSBDb2xsYXRvciByZXR1cm5lZCBm
b3IgRmFyc2kgWyB2aWENCj4gPiBDb2xsYXRvci5nZXRJbnN0YW5jZShuZXcgTG9jYWxlKCJmYSIp
IF0gdG8gcHJvZHVjZSBjb3JyZWN0IHJlc3VsdHMuDQo+ID4gDQo+ID4gRGlkIHlvdSBmaW5kIHRo
YXQgTG9jYWxlKCJmYSIpIHByb2R1Y2VzIHRoZSBjb3JyZWN0IHJlc3VsdHM/ICBJZiBzbywNCj4g
PiB3aGljaCBWTSBhcmUgeW91IHVzaW5nPw0KPiA+IA0KPiA+IEF0IENocmlzIEhvc3RldHRlcidz
IHN1Z2dlc3Rpb24sIEkgYW0gcmV3cml0aW5nIHRoZSBwYXRjaCBhdHRhY2hlZCB0bw0KPiA+IExV
Q0VORS0xMjc5LCBpbmNsdWRpbmcgdGhlIGZvbGxvd2luZyBjaGFuZ2VzOg0KPiA+IA0KPiA+IC0g
TWVyZ2VkIHRoZSBjb250ZW50cyBvZiB0aGUgQ29sbGF0aW5nUmFuZ2VRdWVyeSBjbGFzcyBpbnRv
IFJhbmdlUXVlcnkNCj4gPiBhbmQgUmFuZ2VGaWx0ZXIgLSBTd2l0Y2hlZCB0aGUgTG9jYWxlIHBh
cmFtZXRlciB0byBpbnN0ZWFkIHRha2UgYW4NCj4gPiBpbnN0YW5jZSBvZiBDb2xsYXRvciAtIE1v
ZGlmaWVkIFF1ZXJ5UGFyc2VyLmpqIHRvIGNvbnN0cnVjdCBhDQo+ID4gUXVlcnlQYXJzZXIgY2xh
c3MgdGhhdCBjYW4gYWNjZXB0IGEgcmFuZ2UgY29sbGF0b3IgYW5kIHBhc3MgaXQgZWl0aGVyDQo+
ID4gdG8gUmFuZ2VRdWVyeSBvciB0aHJvdWdoIENvbnN0YW50U2NvcmVSYW5nZVF1ZXJ5IHRvIFJh
bmdlRmlsdGVyLg0KPiA+IA0KPiA+IEkgcGxhbiBvbiBwb3N0aW5nIHRoZSByZXZpc2VkIHBhdGNo
IGluIHRoZSBuZXh0IGRheSBvciB0d28uDQo+ID4gDQo+ID4gU3RldmUNCj4gPiANCj4gPiBPbiAw
NS8wNi8yMDA4IGF0IDc6MzggQU0sIGVzcmEgd3JvdGU6DQo+ID4gPiANCj4gPiA+IEhpIFN0ZXZl
biAsDQo+ID4gPiBIaSBTdGV2ZW4sDQo+ID4gPiANCj4gPiA+IGkgdHJpZWQgdGhlIGNsYXNzIGFu
ZCBpdCB3b3JrcyBmaW5lIHdpdGggdGhlIGxvY2FsZSBwYXJhbWV0ZXIgImFyIi4NCj4gPiA+IA0K
PiA+ID4gQWN0dWFsbHkgd2UgYXJlIHVzaW5nICJmYSIgZm9yIGZhcnNpIGFuZCAiYXIiIGZvciBh
cmFiaWMuDQo+ID4gPiBJIGhhdmUgYWRkZWQgYSBsaXR0bGUgY29udHJvbCBmb3IgdGhlIGxvY2Fs
ZSBwYXJhbWV0ZXIgaW4gbXkNCj4gPiA+IGNvZGUgYW5kIG5vdyBpIGNhbiBzZWUgdGhlIGNvcnJl
Y3QgcmVzdWx0cy4NCj4gPiA+IA0KPiA+ID4gVGhhbmsgeW91IHZlcnkgbXVjaCBmb3IgeXB1ciBo
ZWxwLg0KPiA+ID4gDQo+ID4gPiBFc3JhLg0KPiA+ID4gDQo+ID4gPiBTdGV2ZW4gQSBSb3dlIHdy
b3RlOg0KPiA+ID4gPiANCj4gPiA+ID4gSGkgRXNyYSwNCj4gPiA+ID4gDQo+ID4gPiA+IEkgaGF2
ZSBhdHRhY2hlZCBhIHBhdGNoIHRvIExVQ0VORS0xMjc5IGNvbnRhaW5pbmcgYSBuZXcgY2xhc3M6
DQo+ID4gPiA+IENvbGxhdGluZ1JhbmdlUXVlcnkuDQo+ID4gPiA+IA0KPiA+ID4gPiBUaGUgcGF0
Y2ggYWxzbyBjb250YWlucyBhIHRlc3QgY2xhc3M6IFRlc3RDb2xsYXRpbmdSYW5nZVF1ZXJ5LiAg
T25lDQo+ID4gPiA+IG9mIHRoZSB0ZXN0IG1ldGhvZHMgY2hlY2tzIGZvciB0aGUgRmFyc2kgcmFu
Z2UgeW91IHdlcmUgaGF2aW5nDQo+ID4gPiA+IHRyb3VibGUgd2l0aC4NCj4gPiA+ID4gDQo+ID4g
PiA+IEl0IHNob3VsZCBiZSBtZW50aW9uZWQgdGhhdCBhY2NvcmRpbmcgdG8NCj4gPiA+ID4gQ29s
bGF0b3IuZ2V0QXZhaWxhYmxlTG9jYWxlcygpLCBuZWl0aGVyIEphdmEgMS40LjIgbm9yIEphdmEg
MS41LjANCj4gPiA+ID4gY29udGFpbnMgRmFyc2kgY29sbGF0aW9uIGluZm9ybWF0aW9uLiBIb3dl
dmVyLCBpbiB0aGUgdGVzdCBjbGFzcyBJDQo+ID4gPiA+IHVzZSB0aGUgQXJhYmljIExvY2FsZSwg
d2hpY2ggc2VlbXMgdG8gcHJvcGVybHkgY29sbGF0ZSB0aGUgbm9uLUFyYWJpYw0KPiA+ID4gPiBG
YXJzaSBsZXR0ZXIgVSswNjk4LCBhbmQgaG9wZWZ1bGx5IGJlaGF2ZXMgd2VsbCB3aXRoIG90aGVy
IEZhcnNpDQo+ID4gPiA+IGxldHRlcnMuICBJZiB5b3UgZmluZCB0aGF0IHRoaXMgaXMgbm90IHRo
ZSBjYXNlLCB5b3UgY2FuIGxvb2sgaW50bw0KPiA+ID4gPiB3cml0aW5nIGNvbGxhdGlvbiBydWxl
cyB1c2luZyBSdWxlQmFzZWRDb2xsYXRvciAtIHlvdSBzaG91bGQgYmUgYWJsZQ0KPiA+ID4gPiB0
byBkaXJlY3RseSBzcGVjaWZ5IHRoZSBwcm9wZXIgbGV0dGVyIG9yZGVyaW5ncyBmb3IgRmFyc2k7
DQo+ID4gPiA+IENvbGxhdGluZ1JhbmdlUXVlcnkgd291bGQgYWxzbyBoYXZlIHRvIHN1cHBseSBh
IGNvbnN0cnVjdG9yIHRoYXQNCj4gPiA+ID4gdGFrZXMgaW4gYSBDb2xsYXRvciBpbnN0ZWFkIG9m
IGEgTG9jYWxlLg0KPiA+ID4gPiANCj4gPiA+ID4gUGxlYXNlIGdpdmUgdGhlIGNsYXNzIGEgdHJ5
IGFuZCBwb3N0IGJhY2sgYWJvdXQgaG93IGl0IHdvcmtzLg0KPiA+ID4gPiANCj4gPiA+ID4gVGhh
bmtzLA0KPiA+ID4gPiBTdGV2ZQ0KPiA+ID4gPiANCj4gPiA+ID4gT24gMDUvMDMvMjAwOCBhdCA4
OjMzIEFNLCBlc3JhIHdyb3RlOg0KPiA+ID4gPiA+IA0KPiA+ID4gPiA+IEhpIFN0ZXZlbiwNCj4g
PiA+ID4gPiANCj4gPiA+ID4gPiB0aGFua3MgZm9yIHlvdXIgaGVscC4uLi4NCj4gPiA+ID4gPiAN
Cj4gPiA+ID4gPiBFc3JhDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gU3RldmVu
IEEgUm93ZSB3cm90ZToNCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gSGkgRXNyYSwNCj4gPiA+
ID4gPiA+IA0KPiA+ID4gPiA+ID4gSSBoYXZlIGNyZWF0ZWQgYW4gaXNzdWUgZm9yIHRoaXMgLSBz
ZWUNCj4gPiA+ID4gPiA+IDxodHRwczovL2lzc3Vlcy5hcGFjaGUub3JnL2ppcmEvYnJvd3NlL0xV
Q0VORS0xMjc5Pi4NCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gSSdsbCB0cnkgdG8gdGFrZSBh
IGNyYWNrIGF0IGEgcGF0Y2ggdGhpcyB3ZWVrZW5kLg0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4g
PiBTdGV2ZQ0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiBPbiAwNS8wMi8yMDA4IGF0IDEyOjU1
IFBNLCBlc3JhIHdyb3RlOg0KPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gSGkgU3RldmVu
ICwNCj4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+IHllcyB5b3UgYXJlIHJpZ2h0LCBzb3Jy
eSBpIGFtIGEgYml0IGNvbmZ1c2VkLg0KPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gaSBj
aGVja2VkIGFnYWluIGFuZCB0aGUgY29ycmVjdCBvbmUgaXMgICJ6aGUiL1UrNjk4Lg0KPiA+ID4g
PiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gSXQgc2VlbXMgdGhlIHdvcmQgaXMgaW4gdGhlIHJhbmdl
IGJ1dCBteSBjdXN0b21lciBzYXlzIGl0DQo+ID4gPiA+ID4gPiA+IHNob3VsZG4ndCBiZS4NCj4g
PiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+IEkgdGhpbmsgcHJvYmxlbSBvY2N1cnMgYmVjYXVz
ZSAgInpoZSIgaXMgYSBQZXJzaWFuIGxldHRlciBvdXRzaWRlDQo+ID4gPiA+ID4gPiA+IHRoZSBB
cmFiaWMgYWxwaGFiZXQuIEluIGZhcnNpIGFscGhhYmV0IHRoaXMgbGV0dGVyIGlzIG5vdCBhZnRl
cg0KPiA+ID4gPiA+ID4gPiB0aGUgItizIiBsZXR0ZXIgYnV0IGl0J3MgdW5pY29kZSBpcyBiaWdn
ZXIgdGhhbiAi2LMiIGxldHRlcidzIGFuZA0KPiA+ID4gPiA+ID4gPiB0aGUgc2VhcmNoZXIgd29y
a3Mgd2l0aCB1bmljb2Rlcy4NCj4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+IEVzcmENCj4g
PiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiBTdGV2ZW4gQSBSb3dl
IHdyb3RlOg0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+IEhpIEVzcmEsDQo+ID4g
PiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gWW91IGFyZSAqc3RpbGwqIGluY29ycmVjdGx5
IHJlZmVycmluZyB0byB0aGUNCj4gZ2x5cGggd2l0aCB0aHJlZQ0KPiA+ID4gZG90cw0KPiA+ID4g
PiA+ID4gPiA+IG92ZXIgaXQ6DQo+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gT24g
MDUvMDIvMjAwOCBhdCAxMjoxOCBQTSwgZXNyYSB3cm90ZToNCj4gPiA+ID4gPiA+ID4gPiA+IHll
cyB0aGUgY29ycmVjdCBvbmUgaXMgItqYICIvInplIi9VKzYzMi4NCj4gPiA+ID4gPiA+ID4gPiAN
Cj4gPiA+ID4gPiA+ID4gPiAi2pgiIGlzICpub3QqICJ6ZSIvVSs2MzIgLSBpdCBpcyAiemhlIi9V
KzY5OC4NCj4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiBIYXZlIHlvdSBpbmNyZWFz
ZWQgdGhlIGZvbnQgc2l6ZT8gIENhbiB5b3Ugc2VlIHRoZSBkaWZmZXJlbmNlDQo+ID4gPiA+ID4g
PiA+ID4gYmV0d2VlbiB0aGVzZSB0d28/Og0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4g
PiA+ICLamCIvInpoZSIvVSs2OTgNCj4gPiA+ID4gPiA+ID4gPiAi2LIiLyJ6ZSIvVSs2MzINCj4g
PiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+IG15IHByb2JsZW0gaXMgd2hlbiBpIGRv
IHNlYXJjaCBmb3IgICLYry3amCIgcmFuZ2UuDQo+ID4gPiBUaGUgcmVzdWx0IGlzDQo+ID4gPiA+
ID4gItiz2KfYqA0KPiA+ID4gPiA+ID4gPiA+ID4g2YjZiNmB2LEiIGFuZCB0aGlzIHdvcmQncyBm
aXJzdCBsZXR0ZXIgaXMgItizIiBhbmQgaXQncyB1bmljb2RlIGlzDQo+ID4gPiA+ID4gPiA+ID4g
PiAiVSs2MzMiIGFuZCBpdCBpcyBub3QgaW4gdGhlIGluIHRoZSBbIFUrMDYyRiAtDQo+ID4gPiBV
KzA2MzIgXSByYW5nZS4NCj4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiBMaWtlIEkg
a2VlcCBzYXlpbmcsIGluIHRoZSBhYm92ZSBkZXNjcmlwdGlvbiwgeW91J3JlDQo+ID4gPiB1c2lu
ZyB0aGUNCj4gPiA+ID4gPiBnbHlwaA0KPiA+ID4gPiA+ID4gPiA+ICLamCIvInpoZSIvVSs2OTgs
IHdoaWxlIGNhbGxpbmcgYXQgdGhlIHNhbWUgdGltZSBpbmNvcnJlY3RseQ0KPiA+ID4gPiA+ID4g
PiA+IHJlZmVycmluZyB0byBpdCBhcyAiemUiL1UrNjMyLg0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+
ID4gPiA+ID4gPiA+IEkgZG9uJ3QgbWVhbiB0byBjb250aW51YWxseSBiYW5nIG9uIGFib3V0IHRo
aXMgLQ0KPiBpZiB5b3UncmUNCj4gPiA+ICpzdXJlKg0KPiA+ID4gPiA+ID4gPiA+IHRoYXQgd2hl
biB5b3Ugc2VhcmNoLCB5b3UncmUgdXNpbmcgdGhlIGNoYXJhY3Rlcg0KPiByZXByZXNlbnRlZCBi
eQ0KPiA+ID4gdGhlDQo+ID4gPiA+ID4gPiA+ID4gZ2x5cGggd2l0aCBvbmUgZG90IChhbmQgbm90
IHRocmVlKSwgaS5lLg0KPiAi2LIiLyJ6ZSIvVSs2MzIsIHRoZW4NCj4gPiA+IHRoZQ0KPiA+ID4g
PiA+ID4gPiA+IHByb2JsZW0gbGllcyBlbHNld2hlcmUuDQo+ID4gPiA+ID4gPiA+ID4gDQo+ID4g
PiA+ID4gPiA+ID4gU3RldmUNCj4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiBPbiAw
NS8wMi8yMDA4IGF0IDEyOjE4IFBNLCBlc3JhIHdyb3RlOg0KPiA+ID4gPiA+ID4gPiA+ID4geWVz
IHRoZSBjb3JyZWN0IG9uZSBpcyAi2pggIi8iemUiL1UrNjMyLg0KPiA+ID4gPiA+ID4gPiA+ID4g
DQo+ID4gPiA+ID4gPiA+ID4gPiBteSBwcm9ibGVtIGlzIHdoZW4gaSBkbyBzZWFyY2ggZm9yICAi
ICDYry3amCINCj4gcmFuZ2UuIFRoZSByZXN1bHQNCj4gPiA+IGlzDQo+ID4gPiA+ID4gPiA+ID4g
PiAiItiz2KfYqCDZiNmI2YHYsSAiIGFuZCB0aGlzIHdvcmQncyBmaXJzdCBsZXR0ZXIgaXMNCj4g
ItizICIgYW5kIGl0J3MNCj4gPiA+IHVuaWNvZGUNCj4gPiA+ID4gPiA+ID4gPiA+IGlzICJVKzYz
MyIgIGFuZCAgaXQgaXMgbm90IGluIHRoZSBpbiB0aGUgWw0KPiBVKzA2MkYgLSBVKzA2MzIgXQ0K
PiA+ID4gcmFuZ2UuDQo+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+IGFtIGkg
d3Jvbmc/DQo+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+IEVzcmENCj4gPiA+
ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gU3RldmVuIEEgUm93ZSB3cm90ZToNCj4g
PiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiA+IEhpIEVzcmEsDQo+ID4gPiA+
ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiBJIHN0aWxsIHRoaW5rIHlvdSdyZSB3
cm9uZyA6KS4NCj4gPiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiA+IE9uIDA1
LzAyLzIwMDggYXQgOTozMSBBTSwgZXNyYSB3cm90ZToNCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+
INqYID0gVSs2MzINCj4gPiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiA+IEFj
Y29yZGluZyB0byB0aGUgd2Vic2l0ZSB5b3UgbGlua2VkIHRvLCB0aGUNCj4gPiA+IGFib3ZlIGNo
YXJhY3RlciwNCj4gPiA+ID4gPiB3aGljaA0KPiA+ID4gPiA+ID4gPiA+ID4gPiBoYXMgdGhyZWUg
ZG90cyBvdmVyIGl0LCBpcyBuYW1lZCAiemhlIiwgYW5kIGl0cw0KPiA+ID4gPiA+IFVuaWNvZGUg
Y29kZSBwb2ludA0KPiA+ID4gPiA+ID4gPiBpcw0KPiA+ID4gPiA+ID4gPiA+ID4gPiBVKzY5OC4g
KEkgaGFkIHRvIGluY3JlYXNlIHRoZSBmb250IHNpemUgdG8NCj4gc2VlIHRoZSB0aHJlZQ0KPiA+
ID4gZG90cy4pDQo+ID4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiBJIHRo
aW5rIHlvdSBhcmUgY29uZnVzaW5nICLamCIvInpoZSIvVSs2OTggd2l0aCB0aGUgbGV0dGVyDQo+
ID4gPiA+ID4gPiA+ID4gPiA+ICLYsiIvInplIi9VKzYzMiwgd2hpY2ggaGFzIGp1c3Qgb25lIGRv
dCBvdmVyIGl0Lg0KPiA+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gVW5s
ZXNzIHlvdSB3ZXJlIG1pc3Rha2VuIGluIGFsbCBvZiB5b3VyIGVtYWlscyB3aGVuDQo+ID4gPiA+
ID4geW91IGluY2x1ZGVkDQo+ID4gPiA+ID4gPiA+IHRoZQ0KPiA+ID4gPiA+ID4gPiA+ID4gPiBj
aGFyYWN0ZXIgItqYIi8iemhlIiBpbnN0ZWFkIG9mICLYsiIvInplIiwNCj4gdGhlbiB3aGF0IEkg
c2FpZA0KPiA+ID4gaW4gbXkNCj4gPiA+ID4gPiA+ID4gPiA+ID4gcHJldmlvdXMgZW1haWwgc3Rp
bGwgc3RhbmRzOiB0aGVyZSBpcyBubyBwcm9ibGVtIGhlcmUuDQo+ID4gPiA+ID4gPiA+ID4gPiA+
IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiBTdGV2ZQ0KPiA+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+
ID4gPiA+ID4gPiA+ID4gT24gMDUvMDIvMjAwOCBhdCA5OjMxIEFNLCBlc3JhIHdyb3RlOg0KPiA+
ID4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+IEhpIFN0ZXZlbiwNCj4g
PiA+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiBzb3JyeSBpIG1hZGUg
YSBtaXN0YWtlLiB1bmljb2RlcyBhcmUgbGlrZSB0aGlzOg0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+
IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4g2K89VSs2MkYNCj4gPiA+ID4gPiA+ID4gPiA+ID4g
PiA+INqYID0gVSs2MzINCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+IGFuZCB0aGUgZmlyc3QgbGV0
dGVyIG9mICLYs9in2Kgg2YjZiNmB2LEgIiBpcyAg2LMgPSBVKzYzMw0KPiA+ID4gPiA+ID4gPiA+
ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+IHlvdSBjYW4gYWxzbyBjaGVjayB0aGVtIGhl
cmUNCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiANCj4gaHR0cDovL3d3
dy51bmljcy51bmktaGFubm92ZXIuZGUvbmh0Y2FwcmkvcGVyc2lhbi1hbHBoYWJldC5odG1sDQo+
ID4gPiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gRXNyYQ0KPiA+ID4g
PiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+
ID4gPiA+IFN0ZXZlbiBBIFJvd2Ugd3JvdGU6DQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiANCj4g
PiA+ID4gPiA+ID4gPiA+ID4gPiA+IEhpIEVzcmEsDQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiAN
Cj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+IEdvaW5nIGJhY2sgdG8gdGhlIG9yaWdpbmFsIHByb2Js
ZW0gc3RhdGVtZW50LCBJDQo+ID4gPiA+ID4gc2VlIHNvbWV0aGluZw0KPiA+ID4gPiA+ID4gPiB0
aGF0DQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiBsb29rcyBpbGxvZ2ljYWwgdG8gbWUgLSBwbGVh
c2UgY29ycmVjdCBtZSBpZiBJJ20gd3Jvbmc6DQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiANCj4g
PiA+ID4gPiA+ID4gPiA+ID4gPiA+IE9uIEFwciAzMCwgMjAwOCwgYXQgMzoyMSBBTSwgZXNyYSB3
cm90ZToNCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gaSBhbSB1c2luZyBsdWNlbmUncyAiSW5k
ZXhTZWFyY2hlciIgdG8gc2VhcmNoDQo+ID4gPiA+ID4gdGhlIGdpdmVuIHhtbA0KPiA+ID4gPiA+
ID4gPiBieQ0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiBrZXl3b3JkIHdoaWNoIGNvbnRhaW5z
IGZhcnNpIGluZm9ybWF0aW9uLg0KPiA+ID4gPiA+IHdoaWxlIHNlYXJjaGluZyBpDQo+ID4gPiA+
ID4gPiA+IHVzZQ0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiByYW5nZXMgbGlrZQ0KPiA+ID4g
PiA+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4g2KIt2KsgIHwg
INisLdiuICB8ICDYry3amCAgfCAg2LMt2LggIHwgINi5LdmCICB8INqpLdmEICB8ICDZhS3bjA0K
PiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gd2hl
biBpIGRvIHNlYXJjaCBmb3IgICLYry3amCIgIHJhbmdlIHRoZSByZXN1bHRzDQo+ID4gPiA+ID4g
YXJlIHdyb25nICwNCj4gPiA+ID4gPiA+ID4gdGhleQ0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4g
PiBhcmUgdGhlIHJlc3VsdHMgb2YgICIg2LMt2LggInJhbmdlLg0KPiA+ID4gPiA+ID4gPiA+ID4g
PiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gZm9yIGV4YW1wbGUgd2hlbiBpIGRv
IHNlYXJjaCBmb3IgItivLdqYIg0KPiA+ID4gb25lIG9mIHRoZSB0aGUNCj4gPiA+ID4gPiByZXN1
bHRzDQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+IGlzICLYs9in2Kgg2YjZiNmB2LEiLCB0aGlz
IHJlc3VsdCBhbHNvIHNob3duIG9uIHRoZSAiDQo+ID4gPiA+ID4g2LMt2LggIiByYW5nZSdzDQo+
ID4gPiA+ID4gPiA+IHJlc3VsdA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiBsaXN0IHdoaWNo
IGlzIHRoZSBjb3JyZXQgcmFuZ2UuDQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4g
PiA+ID4gPiA+ID4gPiA+ID4gPiBBcyBJbmRleFNlYXJjaGVyIHVzZSAiY29tcGFyZVRvIiBtZXRo
b2QNCj4gPiA+IGFuZCB0aGlzIG1ldGhvZA0KPiA+ID4gPiA+IHVzZXMNCj4gPiA+ID4gPiA+ID4g
PiA+ID4gPiA+ID4gdW5pY29kZXMgZm9yIGNvbXBhcmluZywgaSBmb3VuZCB0aGUNCj4gdW5pY29k
ZXMgb2YgdGhlDQo+ID4gPiBjaGFyYWN0ZXJzLg0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiAN
Cj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4g2K89VSs2MkYNCj4gPiA+ID4gPiA+ID4gPiA+ID4g
PiA+ID4g2pggPSBVKzY5OA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiBhbmQgdGhlIGZpcnN0
IGxldHRlciBvZiAi2LPYp9ioINmI2YjZgdixICIgaXMNCj4gINizID0gVSs2MzMNCj4gPiA+ID4g
PiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gSXQgYXBwZWFycyB0byBt
ZSB0aGF0ICpib3RoKiB0aGUgItivLdqYIiByYW5nZSBbDQo+ID4gPiA+ID4gPiA+IFUrMDYyRiAt
IFUrMDY5OCBdDQo+ID4gPiA+ID4gPiA+ID4gPiBhbmQNCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+
IHRoZSAi2LMt2LgiIHJhbmdlIFsgVSswNjMzIC0gVSswNjM4IF0gY29udGFpbiB0aGUNCj4gPiA+
ID4gPiA+ID4gZmlyc3QgbGV0dGVyIG9mDQo+ID4gPiA+ID4gPiA+ID4gPiAi2LPYp9ioDQo+ID4g
PiA+ID4gPiA+ID4gPiA+ID4gPiDZiNmI2YHYsSIsIHdoaWNoIGlzICLYsyIgPSBVKzA2MzMuDQo+
ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+IFlvdSBzdGF0
ZWQgdGhhdCBVKzA2MzMgc2hvdWxkIGJlDQo+IGNvbnRhaW5lZCBpbiB0aGUgWw0KPiA+ID4gPiA+
ID4gPiBVKzA2MzMgLSBVKzA2MzgNCj4gPiA+ID4gPiA+ID4gPiA+IF0NCj4gPiA+ID4gPiA+ID4g
PiA+ID4gPiA+IHJhbmdlIC0gSSBhZ3JlZSAtIGJ1dCB3aHkgZG8geW91IHRoaW5rDQo+IFUrMDYz
MyBzaG91bGQNCj4gPiA+IG5vdCBiZQ0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gY29udGFpbmVk
IGluIHRoZSBbIFUrMDYyRiAtIFUrMDY5OCBdIHJhbmdlPw0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+
ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gPiBJbiBvdGhlciB3b3JkcywgaXQgbG9va3MgdG8g
bWUgbGlrZSB5b3VyDQo+IHByb2JsZW0gaXMNCj4gPiA+ID4gPiA+ID4gbm90IGEgcHJvYmxlbQ0K
PiA+ID4gPiA+ID4gPiA+ID4gYXQNCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiA+IGFsbC4NCj4gPiA+
ID4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gU3RldmUNCj4gPiA+
ID4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4g
PiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiA+ID4gLS0gVmlldyB0aGlzIG1lc3NhZ2Ug
aW4gY29udGV4dDoNCj4gPiA+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+IA0K
PiA+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiBodHRwOi8vd3d3Lm5hYmJsZS5j
b20vbHVjZW5lLWZhcnNpLXByb2JsZW0tdHAxNjk3NzA5NnAxNzAxOTQ5OA0KPiA+ID4gPiA+ID4g
PiA+ID4gLmh0bWwgU2VudA0KPiA+ID4gPiA+ID4gPiA+ID4gPiBmcm9tIHRoZSBMdWNlbmUgLSBK
YXZhIFVzZXJzIG1haWxpbmcgbGlzdCBhcmNoaXZlIGF0IE5hYmJsZS5jb20uDQo+ID4gPiA+ID4g
PiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+ID4gDQo+
ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+IA0KPiA+ID4gDQo+IC0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KPiA+ID4g
PiA+ID4gPiA+ID4gVG8NCj4gPiA+ID4gPiA+ID4gPiA+ID4gdW5zdWJzY3JpYmUsIGUtbWFpbDoN
Cj4gPiA+IGphdmEtdXNlci11bnN1YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZw0KPiA+ID4gPiA+
IEZvcg0KPiA+ID4gPiA+ID4gPiA+ID4gPiBhZGRpdGlvbmFsIGNvbW1hbmRzLCBlLW1haWw6IGph
dmEtdXNlci1oZWxwQGx1Y2VuZS5hcGFjaGUub3JnDQo+ID4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+
ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+ID4g
DQo+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+
ID4gDQo+ID4gPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+ID4gPiA+IC0tIFZpZXcgdGhpcyBt
ZXNzYWdlIGluIGNvbnRleHQ6DQo+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+IGh0dHA6
Ly93d3cubmFiYmxlLmNvbS9sdWNlbmUtZmFyc2ktcHJvYmxlbS10cDE2OTc3MDk2cDE3MDIyODYx
Lmh0bWwNCj4gPiA+ID4gPiA+ID4gPiAgU2VudCBmcm9tIHRoZSBMdWNlbmUgLSBKYXZhIFVzZXJz
IG1haWxpbmcgbGlzdA0KPiBhcmNoaXZlIGF0DQo+ID4gPiA+ID4gPiA+IE5hYmJsZS5jb20uDQo+
ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gPiA+ID4gDQo+ID4g
PiA+ID4gPiA+IA0KPiA+ID4gPiA+IA0KPiA+ID4gDQo+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KPiA+ID4gPiA+
ID4gPiA+ICBUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVAbHVj
ZW5lLmFwYWNoZS5vcmcNCj4gPiA+ID4gPiA+ID4gPiAgRm9yIGFkZGl0aW9uYWwgY29tbWFuZHMs
IGUtbWFpbDoNCj4gPiA+ID4gPiBqYXZhLXVzZXItaGVscEBsdWNlbmUuYXBhY2hlLm9yZw0KPiA+
ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4g
PiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+
ID4gLS0gVmlldyB0aGlzIG1lc3NhZ2UgaW4gY29udGV4dDoNCj4gPiA+ID4gPiA+ID4gDQo+ID4g
PiA+ID4gaHR0cDovL3d3dy5uYWJibGUuY29tL2x1Y2VuZS1mYXJzaS1wcm9ibGVtLXRwMTY5Nzcw
OTZwMTcwMjM1NTcNCj4gPiA+ID4gPiAuaHRtbCBTZW50DQo+ID4gPiA+ID4gPiBmcm9tIHRoZSBM
dWNlbmUgLSBKYXZhIFVzZXJzIG1haWxpbmcgbGlzdCBhcmNoaXZlIGF0IE5hYmJsZS5jb20uDQo+
ID4gPiA+ID4gPiANCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gDQo+ID4gPiANCj4gLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tDQo+ID4gPiA+ID4gVG8NCj4gPiA+ID4gPiA+IHVuc3Vic2NyaWJlLCBlLW1haWw6IGph
dmEtdXNlci11bnN1YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZyBGb3INCj4gPiA+ID4gPiA+IGFk
ZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDogamF2YS11c2VyLWhlbHBAbHVjZW5lLmFwYWNoZS5v
cmcNCj4gPiA+ID4gPiA+IA0KPiA+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+
ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4gDQo+ID4gPiA+ID4g
LS0gVmlldyB0aGlzIG1lc3NhZ2UgaW4gY29udGV4dDoNCj4gPiA+ID4gDQo+IGh0dHA6Ly93d3cu
bmFiYmxlLmNvbS9sdWNlbmUtZmFyc2ktcHJvYmxlbS10cDE2OTc3MDk2cDE3MDM0NzE1Lmh0bWwN
Cj4gPiA+ID4gIFNlbnQgZnJvbSB0aGUgTHVjZW5lIC0gSmF2YSBVc2VycyBtYWlsaW5nIGxpc3Qg
YXJjaGl2ZSBhdA0KPiA+ID4gTmFiYmxlLmNvbS4NCj4gPiA+ID4gDQo+ID4gPiA+IA0KPiA+ID4g
PiANCj4gPiA+IA0KPiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4gPiA+ID4gIFRvIHVuc3Vic2NyaWJlLCBlLW1h
aWw6IGphdmEtdXNlci11bnN1YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZw0KPiA+ID4gPiAgRm9y
IGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDoNCj4gamF2YS11c2VyLWhlbHBAbHVjZW5lLmFw
YWNoZS5vcmcNCj4gPiA+ID4gDQo+ID4gPiA+IA0KPiA+ID4gPiANCj4gPiA+ID4gDQo+ID4gPiA+
IA0KPiA+ID4gDQo+ID4gPiAtLSBWaWV3IHRoaXMgbWVzc2FnZSBpbiBjb250ZXh0Og0KPiA+ID4g
DQo+IGh0dHA6Ly93d3cubmFiYmxlLmNvbS9sdWNlbmUtZmFyc2ktcHJvYmxlbS10cDE2OTc3MDk2
cDE3MDgwODUyDQogLmh0bWwgU2VudA0KPiA+IGZyb20gdGhlIEx1Y2VuZSAtIEphdmEgVXNlcnMg
bWFpbGluZyBsaXN0IGFyY2hpdmUgYXQgTmFiYmxlLmNvbS4NCj4gPiANCj4gPiANCj4gPiAtLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0gVG8NCj4gPiB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3Jp
YmVAbHVjZW5lLmFwYWNoZS5vcmcgRm9yDQo+ID4gYWRkaXRpb25hbCBjb21tYW5kcywgZS1tYWls
OiBqYXZhLXVzZXItaGVscEBsdWNlbmUuYXBhY2hlLm9yZw0KPiA+IA0KPiA+IA0KPiANCj4gDQo+
IA0KPiANCj4gDQogDQogLS0NCiBWaWV3IHRoaXMgbWVzc2FnZSBpbiBjb250ZXh0OiBodHRwOi8v
d3d3Lm5hYmJsZS5jb20vbHVjZW5lLWZhcnNpLXByb2JsZW0tdHAxNjk3NzA5NnAxNzE2NTU1MC5o
dG1sDQogU2VudCBmcm9tIHRoZSBMdWNlbmUgLSBKYXZhIFVzZXJzIG1haWxpbmcgbGlzdCBhcmNo
aXZlIGF0IE5hYmJsZS5jb20uDQogDQogDQogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogVG8gdW5zdWJzY3JpYmUs
IGUtbWFpbDogamF2YS11c2VyLXVuc3Vic2NyaWJlQGx1Y2VuZS5hcGFjaGUub3JnDQogRm9yIGFk
ZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDogamF2YS11c2VyLWhlbHBAbHVjZW5lLmFwYWNoZS5v
cmcNCg0KIA0KDQo=


From java-user-return-34010-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 11 20:55:01 2008
Return-Path: <java-user-return-34010-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83899 invoked from network); 11 May 2008 20:55:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 May 2008 20:55:01 -0000
Received: (qmail 39847 invoked by uid 500); 11 May 2008 20:54:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39807 invoked by uid 500); 11 May 2008 20:54:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39796 invoked by uid 99); 11 May 2008 20:54:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 May 2008 13:54:56 -0700
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [192.115.188.196] (HELO out1.bezeqint.net) (192.115.188.196)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 May 2008 20:54:01 +0000
Received: from your0548c161e1 (unknown [80.250.149.60])
	by out1.bezeqint.net (Postfix) with ESMTPA id BB677BA54DF
	for <java-user@lucene.apache.org>; Sun, 11 May 2008 23:41:29 +0300 (IDT)
From: "Itamar Syn-Hershko" <itamar@divrei-tora.com>
To: <java-user@lucene.apache.org>
References: <4F16A37C073944A9BA3A47C3C3CDAA36.MAI@mail.livedns.co.il> <Pine.LNX.4.62.0803292249110.16762@radix.cryptio.net>
Subject: RE: setPositionIncrement questions
Date: Sun, 11 May 2008 23:54:13 +0300
Message-ID: <004c01c8b3a9$2d033910$bc2510ac@your0548c161e1>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <Pine.LNX.4.62.0803292249110.16762@radix.cryptio.net>
Thread-Index: AciSMx7utLH+7cY0SpWY0tOd1VwB4whdQa+Q
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198
X-Virus-Checked: Checked by ClamAV on apache.org


Chris,

I ended up hacking StandardTokenizer::next() to check for $^$^$, and if it
is there then set the current Token PositionIncrement to 500 and resume the
tokenizing loop (so the word which will be read into that Term will have
position increment of 500). As far as I can tell it is working well - how
can I check the terms positions in a document's field and see they have been
incremented indeed? I have tried Luke, but it doesn't seem to allow this. My
field is tokenized and not stored.

Itamar.

-----Original Message-----
From: Chris Hostetter [mailto:hossman_lucene@fucit.org] 
Sent: Sunday, March 30, 2008 8:56 AM
To: Lucene Users
Subject: Re: setPositionIncrement questions


: Breaking proximity data has been discussed several times before, and
: concluded that setPositionIncrement is the way to go. In regards of it:
: 
: 1. Where should it be called exactly to create the gap properly?

any part of your Analyzer can set the position increment on any token to
indicate how far after the previous token it should be.

: 2. Is there a way to call it directly somehow while indexing (e.g. after
: adding a new paragraph to an existing field) instead of appending $$$
: for example after the new string I'm indexing, and having to update my
: tokenizer and filters so they will retain the $$$ chars, indicating the
: gap request?

if you add multiple Fields with the same name, Lucene will call the
"getPositionIncrementGap" method on your Analyzer to determine how much
positionIncreiment to put in between the last token of the first Field and
the first token of the second Field -- so you could just pass each paragraph
as a seperate Field instance .. alternately you can have a single Field
instance, and your Analyzer can use whatever mechanims it wants to decide to
set the position incriment to something high (a line break, a magic char
sequence you put in the string, ... whatever you want)

: 3. What is the recommended value to pass setPositionIncrement to create
: a reasonable gap, and not risk large documents being indexed improperly
: (I mean, is there some sort of high-bound for the position value?).

MAX_INT .. pick gaps based on your data and the queries you expect (if you
want gaps betwen paragraps, and your paragraphs tend to be under 200 words
long, make the gap 500 so "lucene java"~300 can find those words in the same
paragram, but can never span multiple paragraphs

: 4. What are the consequences of setting PositionIncrement to 0? Does
: this mean I can index synonyms or stems aside of the "real" words
: without risking data corruption?

it means the words appear at the same position - synonyms is a great example
of this use case.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34011-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 07:07:15 2008
Return-Path: <java-user-return-34011-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59724 invoked from network); 12 May 2008 07:07:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 07:07:15 -0000
Received: (qmail 23050 invoked by uid 500); 12 May 2008 07:07:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23018 invoked by uid 500); 12 May 2008 07:07:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23007 invoked by uid 99); 12 May 2008 07:07:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 00:07:10 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of eransevi@gmail.com designates 209.85.200.172 as permitted sender)
Received: from [209.85.200.172] (HELO wf-out-1314.google.com) (209.85.200.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 07:06:16 +0000
Received: by wf-out-1314.google.com with SMTP id 28so2246813wfc.20
        for <java-user@lucene.apache.org>; Mon, 12 May 2008 00:06:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=q382fC7P+7f+Ztf5P/p5YePi+gjby9nuWYgSeN+P0rs=;
        b=IItdDAHAHOYPGKJqOI1F+90A0RZnT8B+NL9MNoKMuZ0iXoAuAGDJ/B03Lr/jxy9WYdIPXd7sTa/9M1U7NUTIQ9fFD+CsO2aLzkSDY+XB0UKuE7XMmOJrLZA9PJs7c9XVYMNQeoXfTZecexyl0BAltxxv2KJTOzA4BLqcz12XUhE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=EVZSYl9HIBu5TUw4xwqpLP/Z50/pZTT7b1Xqi5U1ruPJADkt7keVnfeJ6msyLq9OjXQp6YzGW5z4m1JFDPrHnQZr8S5yKJFwCVxSw4vVOHd0ew7zMvToX4M4bm+HCXo6nR+bQk2fAE311Placo6Yl+erpq8lbfa8+NiGJqSDz7A=
Received: by 10.142.213.9 with SMTP id l9mr3124373wfg.180.1210575996603;
        Mon, 12 May 2008 00:06:36 -0700 (PDT)
Received: by 10.142.245.20 with HTTP; Mon, 12 May 2008 00:06:36 -0700 (PDT)
Message-ID: <74f928500805120006n1e2dccccqeb410def1fd2e63f@mail.gmail.com>
Date: Mon, 12 May 2008 10:06:36 +0300
From: "Eran Sevi" <eransevi@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Filtering a SpanQuery
In-Reply-To: <200805071822.24048.paul.elschot@xs4all.nl>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_13924_22644685.1210575996606"
References: <74f928500805060115k6c6373bdib50b0e1ec88ecbbc@mail.gmail.com>
	 <200805070934.19544.paul.elschot@xs4all.nl>
	 <74f928500805070118l2adddae7g13db7c6e0180b4ab@mail.gmail.com>
	 <200805071822.24048.paul.elschot@xs4all.nl>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_13924_22644685.1210575996606
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Thanks Paul,

I'll give your code sample a try.
I still think that calling getSpans (the first line of code) that returns
millions of results is going to be much slower than calling getSpans that's
going to return only a few thousands of results. Since the filtering is only
performed after calling this method it can't help in this case.

I guess your suggested solution is my best option without changing the way
getSpans works (which I'm not going to change any time soon )
Eran.
On Wed, May 7, 2008 at 7:22 PM, Paul Elschot <paul.elschot@xs4all.nl> wrote:

> Op Wednesday 07 May 2008 10:18:38 schreef Eran Sevi:
> > Thanks Paul for your reply,
> >
> > Since my index contains a couple of millions documents and the filter
> > is supposed to limit the search space to a few thousands I was hoping
> > I won't have to do the filtering myself after running the query on
> > all the index.
>
> The code I gave earlier effectively does a filtered query search
> on the index. It visits the resulting Spans, and does not provide
> a score value per document as SpanScorer would do.
> Please make sure to test that code thoroughly for reliable results.
>
> >
> > Maybe this is the case anyway and behind the scenes the filter does
> > exactly what you suggested.
>
> Yes, a filtered query search would use skipTo() on the Spans via
> SpanScorer. But the difference between the normal case
> and your case is that you don't need SpanScorer.
>
> > From what I tested the number of results of the SpanQuery greatly
> > affects the running speed so if I'm going to use about 0.1% of the
> > results I'm loosing a lot of time and memory for gathering and
> > storing the spans I'm not going to use.
> >
> > I don't know how SpanQuery works internally but I guess that if the
> > filter is known beforehand,
>
> A Filter needs to make a BitSet available before the query search.
>
> > it could speed things up quite a bit.
>
> I would expect a substantial speedup from using skipTo() on the
> Spans when only 0.1% of the results passes the filter.
>
> Regards,
> Paul Elschot
>
> > Eran.
> >
> >
> > On Wed, May 7, 2008 at 10:34 AM, Paul Elschot
> > <paul.elschot@xs4all.nl>
> >
> > wrote:
> > > Op Tuesday 06 May 2008 17:39:38 schreef Paul Elschot:
> > > > Eran,
> > > >
> > > > Op Tuesday 06 May 2008 10:15:10 schreef Eran Sevi:
> > > > > Hi,
> > > > >
> > > > > I am looking for a way to filter a SpanQuery according to some
> > > > > other query (on another field from the one used for the
> > > > > SpanQuery). I need to get access to the spans themselves of
> > > > > course. I don't care about the scoring of the filter results
> > > > > and just need the positions of hits found in the documents that
> > > > > matches the filter.
> > > >
> > > > I think you'll have to implement the filtering on the Spans
> > > > yourself. That's not really difficult, just use Spans.skipTo().
> > > > The code to do that could look sth like this (untested):
> > > >
> > > > Spans spans = yourSpanQuery.getSpans(reader);
> > > > BitSet bits = yourFilter.bits(reader);
> > > > int filterDoc = bits.nextSetBit(0);
> > > > while ((filterDoc >= 0) and spans.skipTo(filterDoc)) {
> > > >   boolean more = true;
> > > >   while (more and (spans.doc() == filterDoc)) {
> > > >      // use spans.start() and spans.end() here
> > > >      // ...
> > > >      more = spans.next();
> > > >   }
> > > >   if (! more) {
> > > >     break;
> > > >   }
> > > >   filterDoc = bits.nextSetBit(spans.doc());
> > >
> > > At this point, no skipping on the spans should be done when
> > > filterDoc equals spans.doc(), so this code still needs some work.
> > > But I think you get the idea.
> > >
> > > Regards,
> > > Paul Elschot
> > >
> > > > }
> > > >
> > > > Please check the javadocs of java.util.BitSet, there may
> > > > be a 1 off error in the arguments to nextSetBit().
> > > >
> > > > Regards,
> > > > Paul Elschot
> > > >
> > > > > I tried looking through the archives and found some reference
> > > > > to a SpanQueryFilter patch, however I don't see how it can help
> > > > > me achieve what I want to do. This class receives only one
> > > > > query parameter (which I guess is the actual query) and not a
> > > > > query and a filter for example.
> > > > >
> > > > > Any help about how I can achieve this will be appreciated.
> > > > >
> > > > > Thanks,
> > > > > Eran.
> > > >
> > > > -----------------------------------------------------------------
> > > >---- To unsubscribe, e-mail:
> > > > java-user-unsubscribe@lucene.apache.org For additional commands,
> > > > e-mail: java-user-help@lucene.apache.org
> > >
> > > -------------------------------------------------------------------
> > >-- To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_13924_22644685.1210575996606--

From java-user-return-34012-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 08:04:28 2008
Return-Path: <java-user-return-34012-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74616 invoked from network); 12 May 2008 08:04:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 08:04:27 -0000
Received: (qmail 79341 invoked by uid 500); 12 May 2008 08:04:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79312 invoked by uid 500); 12 May 2008 08:04:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 68354 invoked by uid 99); 7 May 2008 23:14:19 -0000
X-ASF-Spam-Status: No, hits=-2000.0 required=10.0
	tests=ALL_TRUSTED
X-Spam-Check-By: apache.org
Message-ID: <48223735.4040902@apache.org>
Date: Wed, 07 May 2008 16:11:49 -0700
From: Michael Busch <buschmi@apache.org>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org, java-dev@lucene.apache.org
Subject: [ANNOUNCE] Lucene Java 2.3.2 release available
X-Enigmail-Version: 0.95.6
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Release 2.3.2 of Lucene Java is now available!

This release contains fixes for bugs found in 2.3.1. It does not contain
any new features, API or file format changes, which makes it fully
compatible to 2.3.0 and 2.3.1.

The detailed change log is at:
http://svn.apache.org/repos/asf/lucene/java/tags/lucene_2_3_2/CHANGES.txt

Binary and source distributions are available at
http://www.apache.org/dyn/closer.cgi/lucene/java/

Lucene artifacts are also available in the Maven2 repository at
http://repo1.maven.org/maven2/org/apache/lucene/

- -Michael (on behalf of the Lucene team)

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFIIjc1HyEjw2vYcqARAtQwAJ9ECy0rHTa4/PZ44BZu65GAmOMUCwCfVd/y
boi+Th6nTuXpoziHJ8tBTx0=
=bg/N
-----END PGP SIGNATURE-----

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34013-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 09:51:46 2008
Return-Path: <java-user-return-34013-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3326 invoked from network); 12 May 2008 09:51:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 09:51:46 -0000
Received: (qmail 70286 invoked by uid 500); 12 May 2008 09:51:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70252 invoked by uid 500); 12 May 2008 09:51:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70241 invoked by uid 99); 12 May 2008 09:51:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 02:51:40 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of madan.lucene@gmail.com designates 209.85.200.175 as permitted sender)
Received: from [209.85.200.175] (HELO wf-out-1314.google.com) (209.85.200.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 09:50:55 +0000
Received: by wf-out-1314.google.com with SMTP id 28so2292883wfc.20
        for <java-user@lucene.apache.org>; Mon, 12 May 2008 02:51:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=DLa9VZiHttjK1nyRt1OXqjYBrP4OYUooeIzv3215zKI=;
        b=i9BKzF2jB+/VWZrECEUmOJ8TefsxiSpZ029EumVtZ5lKNt0ZohpOj19h6TbTwi5gY8zOk4R8Tw+x+IvPyMtI6LhVI4efGIlUcYhkFuwLcZgApj7g4+EV1m6O2asFH0uQvPHTt17v9ZiE36o0qYN2DkPmfPRf49TB18ehCK0SmzA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=nRJqaNH09ZGDy10LRjd7HCmKmOnhL2Tjum2LkdWKJcRyezHqLlud0gxQPWlFmQDEM+DiLHNYHiPUZWDMGHTEijV6B6qpVfn/ezigVU460nxiQLYQCUzsHlANiFXZw1A98h3XcX4i9Edda/tS/oDUbqcqXYWb1KSVAWj+hDdMTKc=
Received: by 10.142.126.17 with SMTP id y17mr3182636wfc.300.1210585870022;
        Mon, 12 May 2008 02:51:10 -0700 (PDT)
Received: by 10.142.89.18 with HTTP; Mon, 12 May 2008 02:51:10 -0700 (PDT)
Message-ID: <ddef46640805120251i157862dflcc6c21efe6a3adc2@mail.gmail.com>
Date: Mon, 12 May 2008 15:21:10 +0530
From: "Madan Narra" <madan.lucene@gmail.com>
To: java-user@lucene.apache.org
Subject: Search and retrieve the line data from the File
In-Reply-To: <ddef46640805120235o7b771fe8l6c0c27181c9dc8b5@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_200_6016451.1210585870029"
References: <ddef46640805120235o7b771fe8l6c0c27181c9dc8b5@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_200_6016451.1210585870029
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi All,

I am very much new to Lucene and want to extend my skills over this tool....

But i am in need of a quick assignment which i would need to complete
soon...so haven't got much time to read over the docs/books over net..

So please suggest how can i archive the below task and the rest i can make
over.

I have a inbound file of around 10k records , each line is a new record.

I need to search for a word or phrase in the inbound file, and retrieve all
the line data which consists the word.

Ex:

102652;ABN AMRO  Monthly Income Plan-Regular Plan-Growth Option;13.3054
102653;ABN AMRO  Monthly Income Plan-Regular Plan-Monthly Dividend
Option;10.0011
102654;ABN AMRO  Monthly Income Plan-Regular Plan-Quarterly Dividend
Option;10.0498
102645;ABN AMRO  Short Term Income Fund-Institutional Plan-Daily Dividend
Option;10.0104
106524;AIG India Treasury Plus Fund-Institutional Plan-Daily Dividend
Option;10.0109
100601;Canara Robeco Cigo-Growth Plan;21.88
101620;Franklin India International Fund;10.3648
100948;Franklin India Monthly Income Plan-Growth;23.1588

As Shown above, if i search for "*Franklin*" i  need to show up the below
thing :

101620;*Franklin *India International Fund;10.3648
100948*;**Franklin ** *India Monthly Income Plan-Growth;23.1588

If i search for "*ABN*" , than the result should be as below :

102652;*ABN *AMRO  Monthly Income Plan-Regular Plan-Growth Option;13.3054
102653;*ABN *AMRO  Monthly Income Plan-Regular Plan-Monthly Dividend
Option;10.0011
102654;*ABN *AMRO  Monthly Income Plan-Regular Plan-Quarterly Dividend
Option;10.0498
102645;*ABN *AMRO  Short Term Income Fund-Institutional Plan-Daily Dividend
Option;10.0104

Hope my question is clear and understanding...

Please help me over how could i achieve the above process to search for a
word in the file and display the results as discussed.

Thanks,
Madan N

------=_Part_200_6016451.1210585870029--

From java-user-return-34014-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 10:14:19 2008
Return-Path: <java-user-return-34014-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8690 invoked from network); 12 May 2008 10:14:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 10:14:18 -0000
Received: (qmail 90051 invoked by uid 500); 12 May 2008 10:14:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89354 invoked by uid 500); 12 May 2008 10:14:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89343 invoked by uid 99); 12 May 2008 10:14:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 03:14:12 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephane.nicoll@gmail.com designates 209.85.132.251 as permitted sender)
Received: from [209.85.132.251] (HELO an-out-0708.google.com) (209.85.132.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 10:13:27 +0000
Received: by an-out-0708.google.com with SMTP id c37so484460anc.49
        for <java-user@lucene.apache.org>; Mon, 12 May 2008 03:13:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=hPf4JojQ0CSqWuY0bMPYOoMIIDgTJkLOwK6Azpf8dFE=;
        b=iLn/TPo0xex+J5V3sd86KR+4DANcFCJ3unuYwzTGH3wPV7qNc8iJ8roRvR5XmtoiQA13axe1QL4efuL+Tz0q+HpYeg/RPaC20rTNFMBUH0alE9Y/BUTLKg5/p/CS2ggNGPtjyrDCygiJ20P+y/euptYm0y8/zHNcC4KAESpHnBM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=PAoZVfnnnmUXz2z+WRWRMD0N9vykkeiHf3dBiqXnpjYDfhS1srXz+Sov9zCACeVaY2hlyDZQEXvQyZlzqRsShEpmGoSGmO9sX8I2yps22X5sUba1r0AAoUUrkJPY8wc0UWXteS3TWRdQKs8LKp7YPINbWHlO0ltl9KyYwwI0U5A=
Received: by 10.101.68.10 with SMTP id v10mr7929380ank.17.1210587221330;
        Mon, 12 May 2008 03:13:41 -0700 (PDT)
Received: by 10.100.178.12 with HTTP; Mon, 12 May 2008 03:13:41 -0700 (PDT)
Message-ID: <541f12ca0805120313y302ece2cu374d25e378bc45e2@mail.gmail.com>
Date: Mon, 12 May 2008 12:13:41 +0200
From: "Stephane Nicoll" <stephane.nicoll@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: confused about an entry in the FAQ
In-Reply-To: <48b038c60805101105q767968a2sc9de677130100742@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <541f12ca0805100635sf9629abs4cb9b8c0f41f6a79@mail.gmail.com>
	 <48b038c60805101105q767968a2sc9de677130100742@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I tried all this and I am confused about the result. I am trying to
implement an hybrid query handler where I fetch the IDs from a
database criteria and the IDs from a full text lucene query and I
intersect them to return the result to the user. The database query
and the intersection works fine even with high load. However the
lucene query is much slower when the number of concurrent users
raises.

Here is what I am doing on the lucene side

        final QueryParser queryParser =3D new
QueryParser(criteria.getDefaultField(), analyzer);
        final Query q =3D queryParser.parse(criteria.getFullTextQuery());
        // Index Searcher is shared for all threads and is not
reopened during the load test
        final IndexSearcher indexSearcher =3D getIndexSearcher();
        final Set<Long> result =3D new TreeSet<Long>();
        indexSearcher.search(q, new HitCollector() {
            public void collect(int i, float v) {
                try {
                    final Document d =3D
indexSearcher.getIndexReader().document(i, new FieldSelector() {
                        public FieldSelectorResult accept(String s) {
                            if (s.equals(CatalogItem.ATTR_ID)) {
                                return FieldSelectorResult.LOAD;
                            } else {
                                return FieldSelectorResult.NO_LOAD;
                            }
                        }
                    });
                    result.add(Long.parseLong(d.get(CatalogItem.ATTR_ID)));
                } catch (IOException e) {
                    throw new RuntimeException("Could not collect
lucene IDs", e);
                }
            }
        });
        return result;


When running with one thread, I have the following figures per test:

Database query is done in[125 msecs] (size=3D598]
Lucene query is done in[80 msecs (size=3D15204]
Intersect is done in[4 msecs] (size=3D103]
Hybrid query is done in[97 msecs]

-> 327 msec / user

When running with ten threads, I have the following figures per user per te=
st:

Database query is done in[222 msecs] (size=3D94]
Lucene query is done in[2364 msecs (size=3D15367]
Intersect is done in[0 msecs] (size=3D12]
Hybrid query is done in[18 msecs]

-> 2.5 sec / user !!

I am just wondering how I can improve this. Clearly there is something
wrong in my code since it's much slower with multiple threads running
concurrently on the same index. The size of the index is 5Mb, I only
store:

* an "id" field (which is the primary key of the related object in the db
* a "class" field which is the class nazme of the related object
(Hibernate search does that for me)

The "keywords" field is indexed but not stored as it is a
representation of other data stored in the db. The searches are
performed on the keywords field only ("foo AND bar" is a typical
query)

Any help is appreciated. If you also know a Spring bean that could
take care of opening/closing the index readers properly, let me know.
Hibernate Search introduces deadlock with multiple threads and the
lucene integration in spring modules does not seeem to do what I want.

Thanks,
St=E9phane


On Sat, May 10, 2008 at 8:05 PM, Patrick Turcotte <patrek@gmail.com> wrote:
> Did you try the IndexSearcher.doc(int i, FieldSelector fieldSelector)  me=
thod?
>
>  Could be faster because Lucene don't have do "prepare" the whole documen=
t.
>
>  Patrick
>
>
>  On Sat, May 10, 2008 at 9:35 AM, Stephane Nicoll
>  <stephane.nicoll@gmail.com> wrote:
>
>
> > From the FAQ:
>  >
>  > "Don't iterate over more hits than needed.
>  > Iterating over all hits is slow for two reasons. Firstly, the search()
>  > method that returns a Hits object re-executes the search internally
>  > when you need more than 100 hits. Solution: use the search method that
>  > takes a HitCollector instead."
>  >
>  > I had a look to HitCollector but it returns the documentId and the
>  > javadoc recommends not fetching the original query there.
>  >
>  > I have to return *one* indexed field from the query result and
>  > currently I am iterating on all results and it's slow. Can you explain
>  > a bit more how I could improve this?
>  >
>  > Thanks,
>  > St=E9phane
>  >
>  >
>  > --
>  > Large Systems Suck: This rule is 100% transitive. If you build one,
>  > you suck" -- S.Yegge
>  >
>
> > ---------------------------------------------------------------------
>  > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>  >
>  >
>
>
> ---------------------------------------------------------------------
>  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>
>
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Large Systems Suck: This rule is 100% transitive. If you build one,
you suck" -- S.Yegge

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34015-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 14:04:03 2008
Return-Path: <java-user-return-34015-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99531 invoked from network); 12 May 2008 14:04:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 14:04:02 -0000
Received: (qmail 90016 invoked by uid 500); 12 May 2008 14:03:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89986 invoked by uid 500); 12 May 2008 14:03:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89975 invoked by uid 99); 12 May 2008 14:03:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 07:03:56 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lukas.vlcek@gmail.com designates 209.85.198.226 as permitted sender)
Received: from [209.85.198.226] (HELO rv-out-0506.google.com) (209.85.198.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 14:03:09 +0000
Received: by rv-out-0506.google.com with SMTP id f6so2286632rvb.5
        for <java-user@lucene.apache.org>; Mon, 12 May 2008 07:03:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=LWby5wLmAlYsI1WEZ/X5zmoGi/jOCq6zCWSx670Uros=;
        b=HXKAIlOm73fBIw3uHEoOAwB+vg2v4jC/UmwyTFDobtMei9Y41B5gnqkRevPyN1817VEaqTU6Q9CazZQNPeyv0QjwuilvdtmqD9AslHQtgj69nJxjPwgfo+tjQr3UrpTqbO2U4lstGVERbOCXPMzNERnloL6gampYu2+enmUPevc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=qNHCiQhTvPIc5OlAg8vWOIz88kpSfFXvP2oceKSnJSlF1KG34NPjS4FQ+b1OOzPNOA2kakcYHFlQUXRNYcD1zKyVlxarknLhmRPH85h0EzGoVzHy7CqM/pluKafDGQjlcJMeqVZP+SQAU0hj2u38QGxyqDjaD/AH6Y0wYBio9xc=
Received: by 10.141.189.4 with SMTP id r4mr3701237rvp.98.1210601004200;
        Mon, 12 May 2008 07:03:24 -0700 (PDT)
Received: by 10.141.163.6 with HTTP; Mon, 12 May 2008 07:03:24 -0700 (PDT)
Message-ID: <52c3ddca0805120703k25c56c4chbc68d18a5cfacb8@mail.gmail.com>
Date: Mon, 12 May 2008 16:03:24 +0200
From: "Lukas Vlcek" <lukas.vlcek@gmail.com>
To: java-user@lucene.apache.org
Subject: Can POI provide reliable text extraction results for production search engine for Word, Excel and PowerPoint formats?
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_2546_13816977.1210601004187"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_2546_13816977.1210601004187
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,

I need to find a reliable way how to extract content out of Word, Excel and
PowerPoint formats prior to indexing and I am not sure if POI is the best
way to go. Can anybody share experience with POI and/or other [commercial]
Java library for text extraction from MS formats?

My experience with POI is such that sometimes it can be a pain to get the
content out of the MS files properly. I also know that Nutch plugin uses POI
for MS formats but as far as I remember it is not 100% reliable (my more
then one year old experience is that about 1-2% of files were not parsed).

My requirements are that the text extraction software must run on Linux and
should be written in Java, it can be open source or commercial library.

Regards,
Lukas

-- 
http://blog.lukas-vlcek.com/

------=_Part_2546_13816977.1210601004187--

From java-user-return-34016-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 15:51:36 2008
Return-Path: <java-user-return-34016-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53797 invoked from network); 12 May 2008 15:51:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 15:51:36 -0000
Received: (qmail 44256 invoked by uid 500); 12 May 2008 15:51:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43484 invoked by uid 500); 12 May 2008 15:51:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43470 invoked by uid 99); 12 May 2008 15:51:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 08:51:30 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of miguel.costa@fccn.pt designates 193.137.198.36 as permitted sender)
Received: from [193.137.198.36] (HELO app04.fccn.pt) (193.137.198.36)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 15:50:33 +0000
Received: from mx.anubis.local (ste [10.1.2.2])
	by ste.anubis.internal (Postfix) with ESMTP id D294B1ABAC2
	for <java-user@lucene.apache.org>; Mon, 12 May 2008 16:50:54 +0100 (WEST)
Received: from NAUPLIOS (unknown [193.136.44.100])
	(using TLSv1 with cipher RC4-MD5 (128/128 bits))
	(No client certificate requested)
	by mx.anubis.local (Postfix) with ESMTP id B45E41BFD7B
	for <java-user@lucene.apache.org>; Mon, 12 May 2008 16:50:54 +0100 (WEST)
From: "Miguel Costa" <miguel.costa@fccn.pt>
To: <java-user@lucene.apache.org>
Subject: posting lists of index are sorted?
Date: Mon, 12 May 2008 16:51:30 +0100
Message-ID: <004701c8b448$0cde7650$642c88c1@corp.fccn.pt>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0048_01C8B450.6EA2DE50"
X-Mailer: Microsoft Office Outlook 11
thread-index: Aci0SAugOXMjh8ZVRJSAPQqfsgyNoQ==
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Warning-Anubis: User opted out of Anti-Virus checks
X-Warning-Anubis: User opted out of Anti-Spam checks
X-Content-Checker: AnubisNetworks MPS
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_0048_01C8B450.6EA2DE50
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Hi all,
=20
I have two questions related to the Lucene ranking.
=20
1) Does anyone know how the posting lists (term -> doc1 doc2 doc3) from =
the
index are sorted?
It is used a TFxIDF value, the boost value or none to sort documents =
(doc1
doc2 doc3)? Does Lucene compute the ranking for all the documents in the
posting lists or only part?
=20
2) Does anyone know how to add more ranking features to the ranking =
function
of Lucene (eg. Pagerank, BM25)?
Extending the DefaultSimilarity class from Lucene is insufficient to =
achieve
this. It is only prepared to change the TFxIDF function.
=20
Thanks in advance.
=20

--

Miguel Costa=20

HYPERLINK "http://xldb.fc.ul.pt/~mcosta/"http://xldb.fc.ul.pt/~mcosta/

=20

FCCN-Funda=E7=E3o para a Computa=E7=E3o Cient=EDfica Nacional Av. do =
Brasil, n.=BA 101

1700-066 Lisboa

Tel.: +351 21 8440190

Fax: +351 218472167

HYPERLINK "outbind://25/www.fccn.pt"www.fccn.pt

Aviso de Confidencialidade

Esta mensagem =E9 exclusivamente destinada ao seu destinat=E1rio, =
podendo conter
informa=E7=E3o CONFIDENCIAL, cuja divulga=E7=E3o est=E1 expressamente =
vedada nos
termos da lei. Caso tenha recepcionado indevidamente esta mensagem,
solicitamos-lhe que nos comunique esse mesmo facto por esta via ou para =
o
telefone +351 218440100 devendo apagar o seu conte=FAdo de imediato.=20

This message is intended exclusively for its addressee. It may contain
CONFIDENTIAL information protected by law. If this message has been =
received
by error, please notify us via e-mail or by telephone +351 218440100 and
delete it immediately.

=20

No virus found in this outgoing message.
Checked by AVG.=20
Version: 7.5.524 / Virus Database: 269.23.14/1425 - Release Date: =
09-05-2008
12:38
=20

------=_NextPart_000_0048_01C8B450.6EA2DE50--


From java-user-return-34017-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 15:59:28 2008
Return-Path: <java-user-return-34017-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56347 invoked from network); 12 May 2008 15:59:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 15:59:28 -0000
Received: (qmail 55256 invoked by uid 500); 12 May 2008 15:59:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55229 invoked by uid 500); 12 May 2008 15:59:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55218 invoked by uid 99); 12 May 2008 15:59:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 08:59:22 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [81.187.40.70] (HELO fluffy.torchbox.com) (81.187.40.70)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 15:58:29 +0000
Received: from [2001:8b0:c5:1:213:2ff:fedc:110d] (helo=grenache.internal.torchbox.com)
	by fluffy.torchbox.com with esmtp (Exim 4.63)
	(envelope-from <nick@torchbox.com>)
	id 1JvaQM-0005xh-9V
	for java-user@lucene.apache.org; Mon, 12 May 2008 16:58:50 +0100
Date: Mon, 12 May 2008 16:58:21 +0100 (BST)
From: Nick Burch <nick@torchbox.com>
X-X-Sender: nick@localhost.localdomain
To: java-user@lucene.apache.org
Subject: Re: Can POI provide reliable text extraction results for production
 search engine for Word, Excel and PowerPoint formats?
In-Reply-To: <52c3ddca0805120703k25c56c4chbc68d18a5cfacb8@mail.gmail.com>
Message-ID: <alpine.LFD.1.10.0805121655350.8332@localhost.localdomain>
References: <52c3ddca0805120703k25c56c4chbc68d18a5cfacb8@mail.gmail.com>
User-Agent: Alpine 1.10 (LFD 962 2008-03-14)
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
X-Spam-Score: -0.9 (/)
Organization: Torchbox Ltd, Registered Company #3983354, Unit 9, Southill Business Park, OX7 3EW, UK
X-Virus-Checked: Checked by ClamAV on apache.org

On Mon, 12 May 2008, Lukas Vlcek wrote:
> I need to find a reliable way how to extract content out of Word, Excel 
> and PowerPoint formats prior to indexing and I am not sure if POI is the 
> best way to go. Can anybody share experience with POI and/or other 
> [commercial] Java library for text extraction from MS formats?

We use poi for text extraction, and it works just fine for us. POI 3.1 
should offer a few improvements on text extraction, and POI 3.5 will give 
you OOXML text extraction too.

You might also like to take a look at Apache Tika 
<http://incubator.apache.org/tika/>. It wraps up POI (and a few other 
document extractor libraries), giving you a simple, common interface for 
text extraction

Nick

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34018-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 16:06:53 2008
Return-Path: <java-user-return-34018-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59263 invoked from network); 12 May 2008 16:06:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 16:06:52 -0000
Received: (qmail 63159 invoked by uid 500); 12 May 2008 16:06:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63121 invoked by uid 500); 12 May 2008 16:06:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63110 invoked by uid 99); 12 May 2008 16:06:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 09:06:46 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of brendan.grainger@gmail.com designates 74.125.46.31 as permitted sender)
Received: from [74.125.46.31] (HELO yw-out-2324.google.com) (74.125.46.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 16:06:00 +0000
Received: by yw-out-2324.google.com with SMTP id 3so1387116ywj.5
        for <java-user@lucene.apache.org>; Mon, 12 May 2008 09:06:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to:content-type:mime-version:subject:date:x-mailer;
        bh=7WhXCMKLMFC7l3qPsD4ydv0bpNM19ftOI6WC4rlvjDk=;
        b=Dj+sSGA/ztiZltub66+3MPyI1vrU9iVUeVStzjYO+YdXYIWRt30Aqt76YW/MFY6ZYULtZ4teaej16cu/gwVU6U5p+0O4ySieUHVgYYB98YSF92ETYMNH5MV23z6rdk+87Qo6WdfmJ4TnyTqpGPWdaXVwLkbrAzw+dwYWpjBP2tw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:content-type:mime-version:subject:date:x-mailer;
        b=t3KjArCsJahDy5ZfjaVa2mZp8UHgIvkZs/COZkD1Uh79Q+mF0yfDu+Jloc9OnuKJwvdu2008n56UoToftObD3qCL6nrq6SCAYNznj9kcLgWMkLc52VUbteJjps4Sx2ELTSFABAyEemaN4lNrXqVtg4fenW2p7pSRAU5j/zGP2ng=
Received: by 10.150.69.5 with SMTP id r5mr8400471yba.97.1210608369976;
        Mon, 12 May 2008 09:06:09 -0700 (PDT)
Received: from ?192.168.1.108? ( [216.57.31.115])
        by mx.google.com with ESMTPS id m6sm7010147wrm.35.2008.05.12.09.06.07
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 12 May 2008 09:06:08 -0700 (PDT)
Message-Id: <077BBCF2-2E6C-4459-A924-417CA088EAA3@gmail.com>
From: Brendan Grainger <brendan.grainger@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=Apple-Mail-1-372932370
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Question about startOffset and endOffset
Date: Mon, 12 May 2008 12:06:06 -0400
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail-1-372932370
Content-Type: text/plain;
	charset=US-ASCII;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: 7bit

Hi,

I have a TokenStream that inserts synonym tokens into the stream when  
matched. One thing I am wondering about is what is the effect of the  
startOffset and endOffset. I have something like this:

Token synonymToken = new Token(originalToken.startOffset(),  
originalToken.endOffset(), "SYNONYM");
synonymToken.setPositionIncrement(0);

What I am wondering is if I set the startOffset and endOffset to 0 and  
the endOffset to the length of the synonym string what effect will  
this have?

eg
Token synonymToken = new Token(0, repTok.endOffset(), "SYNONYM");
synonymToken.setPositionIncrement(0);

Thanks


--Apple-Mail-1-372932370--

From java-user-return-34019-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 16:23:41 2008
Return-Path: <java-user-return-34019-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67554 invoked from network); 12 May 2008 16:23:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 16:23:41 -0000
Received: (qmail 92374 invoked by uid 500); 12 May 2008 16:23:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92345 invoked by uid 500); 12 May 2008 16:23:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92333 invoked by uid 99); 12 May 2008 16:23:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 09:23:35 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 72.14.220.155 as permitted sender)
Received: from [72.14.220.155] (HELO fg-out-1718.google.com) (72.14.220.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 16:22:49 +0000
Received: by fg-out-1718.google.com with SMTP id l27so2129502fgb.27
        for <java-user@lucene.apache.org>; Mon, 12 May 2008 09:23:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=67V7Ms6XowYfowLbIk7HjClexTXASjzcs1HucFXkBdw=;
        b=ohmVBZVBLd+NZ4BTy9YA4FFbY69pKFRARZmJIG0rG2d/b5r5mor5b08nvbYYSOnwoK4VKL1+36Yx3uCPoTllEHPfjj3kLnJ8kYwezFeRdoUZKuxXaDJo7bid59r4hQMzZb5/9f8dHTEEIEI/r/UldJIrilF59umHxGh/U56UMXI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=UGU/1PUq8OVWeTx46xVtN16g8ljKdfJkZ8XY+v+trnvLtgNTVEOuZVYU62SVQ4muVQnRSjzY65uHBFH7gC+Gx2co6a2CRb+88ViXPiOijHh7oAxXLqakGaF7UCfzTS0F5tuFl7BdSaE0RgBDr1T+nlmvGn7aFBVJzpHlQYs97P4=
Received: by 10.86.97.7 with SMTP id u7mr1652455fgb.25.1210609382980;
        Mon, 12 May 2008 09:23:02 -0700 (PDT)
Received: by 10.86.59.14 with HTTP; Mon, 12 May 2008 09:23:02 -0700 (PDT)
Message-ID: <359a92830805120923v67bd2e75n1af679957d75292e@mail.gmail.com>
Date: Mon, 12 May 2008 12:23:02 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Question about startOffset and endOffset
In-Reply-To: <077BBCF2-2E6C-4459-A924-417CA088EAA3@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_4545_17039753.1210609382946"
References: <077BBCF2-2E6C-4459-A924-417CA088EAA3@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_4545_17039753.1210609382946
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Is this a theoretical question or is there a use-case you're trying
to support? If the latter, a statement of the problem you're trying
to solve would be helpful.

If the former, setting all your start offsets to 0 seems wrong. You're
essentially saying that all tokens are at the beginning of the document
and each one is some ever-increasing distance from the start. Some
of your later words will look really, really long (like the length
of your document).

Offhand, I expect this will affect up span queries, phrase
queries, and who knows what else? Maybe scoring?
Or maybe not, maybe some (or all) of these work off of
termpositions rather than offsets. So unless you're trying to
accomplish something specific, I sure wouldn't do this
given the problems it *could* create.

That said, I'm not much of an expert on how the offsets are
used, but I'd be really leery of changing them "just for the fun of
it" <G>......

Best
Erick

On Mon, May 12, 2008 at 12:06 PM, Brendan Grainger <
brendan.grainger@gmail.com> wrote:

> Hi,
>
> I have a TokenStream that inserts synonym tokens into the stream when
> matched. One thing I am wondering about is what is the effect of the
> startOffset and endOffset. I have something like this:
>
> Token synonymToken = new Token(originalToken.startOffset(),
> originalToken.endOffset(), "SYNONYM");
> synonymToken.setPositionIncrement(0);
>
> What I am wondering is if I set the startOffset and endOffset to 0 and the
> endOffset to the length of the synonym string what effect will this have?
>
> eg
> Token synonymToken = new Token(0, repTok.endOffset(), "SYNONYM");
> synonymToken.setPositionIncrement(0);
>
> Thanks
>
>

------=_Part_4545_17039753.1210609382946--

From java-user-return-34020-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 16:40:34 2008
Return-Path: <java-user-return-34020-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73654 invoked from network); 12 May 2008 16:40:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 16:40:33 -0000
Received: (qmail 18803 invoked by uid 500); 12 May 2008 16:40:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18772 invoked by uid 500); 12 May 2008 16:40:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18761 invoked by uid 99); 12 May 2008 16:40:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 09:40:28 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of karl.wettin@gmail.com designates 72.14.220.159 as permitted sender)
Received: from [72.14.220.159] (HELO fg-out-1718.google.com) (72.14.220.159)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 16:39:42 +0000
Received: by fg-out-1718.google.com with SMTP id l27so2135485fgb.27
        for <java-user@lucene.apache.org>; Mon, 12 May 2008 09:39:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=FlP87sVKNd0ciMn9ZJKLvzazNBPxPaUHJDq0OeuoFaA=;
        b=a7VTggdbQYqQwKHNfcQCv6Ia4VCln7D50emcOBfD5wNxDciko9k+16K4r87yQpB8HGFoiUfdBdr0Q+lfO7od0gg0bVD3zQv+91ahn7+mdybppP74aTUn3ubPlTjOkRy6XATLeH9hmy8AUhbrmPFzK/owpJE9wcfZhWYG/ncMdE8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=xY5gSDf4PlErgYPlelpAkczTnKYotamlMHIFf4/MW20HO2c749Os78AGytMqC+cOMd0sx/uSugY9fYoAV54mS2AwCp7RLCLTa761mJTG68qrkJCCWfdkUUl0YsIsGKLGO/YWnPRKYlyy+3EAqcqT0reUOU9+ZwcFT/NUfiAft/s=
Received: by 10.86.77.5 with SMTP id z5mr12322716fga.42.1210610395769;
        Mon, 12 May 2008 09:39:55 -0700 (PDT)
Received: from kodapan.local ( [82.93.70.124])
        by mx.google.com with ESMTPS id l12sm6247100fgb.8.2008.05.12.09.39.54
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 12 May 2008 09:39:54 -0700 (PDT)
Message-ID: <482872D8.4060701@gmail.com>
Date: Mon, 12 May 2008 18:39:52 +0200
From: Karl Wettin <karl.wettin@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Macintosh/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Question about startOffset and endOffset
References: <077BBCF2-2E6C-4459-A924-417CA088EAA3@gmail.com> <359a92830805120923v67bd2e75n1af679957d75292e@mail.gmail.com>
In-Reply-To: <359a92830805120923v67bd2e75n1af679957d75292e@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Erick Erickson skrev:
> Offhand, I expect this will affect up span queries, phrase
> queries, and who knows what else? Maybe scoring?

I belive that the offsets are just meta data stored with the term 
vectors, used by the highlighter et c. Phrase and span queries use term 
position in the stream (positionIncrement) for sloppy matching and scoring.

So if you don't store the term vectors with offsets for some reason you 
really don't have to bother about them.

       karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34021-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 16:42:56 2008
Return-Path: <java-user-return-34021-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74454 invoked from network); 12 May 2008 16:42:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 16:42:56 -0000
Received: (qmail 21601 invoked by uid 500); 12 May 2008 16:42:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21565 invoked by uid 500); 12 May 2008 16:42:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21554 invoked by uid 99); 12 May 2008 16:42:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 09:42:50 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of karl.wettin@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 16:42:02 +0000
Received: by fg-out-1718.google.com with SMTP id l27so2136175fgb.27
        for <java-user@lucene.apache.org>; Mon, 12 May 2008 09:42:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=tvm1NbftDuZUiyQd8WIP5zoudgrk45xujkzcib507Sc=;
        b=cMF/aIQeFk5TB47k0mhsvqwA72+N1lqjWUUYb3Sc9HSLkwqotoh8wgAJq7T0cZaygPct8Livrm9J1dG9y1Pd9XCgR7012h/sHe809P5IsJ3l5Hqj7HJWVpwvusOi8mXNinrvaRz8Jh2R7WLCg5oIIxCrKHxEF+e9ryAeZL+EcUk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=mD53O/bNqzAipbnOD0HC16n1wntkaHBa767Ya53iRopKIVJWkP1vl3md59bgxE43RLteue46eTcS8Cnc3rGcT73UgpfyxMtytgZ86wQtTEQCNwqnsqY0AbPVIUVyr0Y2gq/KOGwFMBuQvPOT2Ndt/O+0yKBrNUfrNgp0e5yLSGw=
Received: by 10.86.98.18 with SMTP id v18mr14618334fgb.33.1210610536706;
        Mon, 12 May 2008 09:42:16 -0700 (PDT)
Received: from kodapan.local ( [82.93.70.124])
        by mx.google.com with ESMTPS id l19sm6883327fgb.9.2008.05.12.09.42.14
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 12 May 2008 09:42:15 -0700 (PDT)
Message-ID: <48287365.2080800@gmail.com>
Date: Mon, 12 May 2008 18:42:13 +0200
From: Karl Wettin <karl.wettin@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Macintosh/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Can POI provide reliable text extraction results for production
 search engine for Word, Excel and PowerPoint formats?
References: <52c3ddca0805120703k25c56c4chbc68d18a5cfacb8@mail.gmail.com>
In-Reply-To: <52c3ddca0805120703k25c56c4chbc68d18a5cfacb8@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Lukas Vlcek skrev:
> Hi,
> 
> I need to find a reliable way how to extract content out of Word, Excel and
> PowerPoint formats prior to indexing and I am not sure if POI is the best
> way to go. Can anybody share experience with POI and/or other [commercial]
> Java library for text extraction from MS formats?

I like Antiword for .doc files.

http://www.winfield.demon.nl/


        karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34022-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 17:40:47 2008
Return-Path: <java-user-return-34022-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93143 invoked from network); 12 May 2008 17:40:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 17:40:47 -0000
Received: (qmail 95046 invoked by uid 500); 12 May 2008 17:40:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95017 invoked by uid 500); 12 May 2008 17:40:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95006 invoked by uid 99); 12 May 2008 17:40:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 10:40:41 -0700
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [193.111.201.130] (HELO lon-mail-4.gradwell.net) (193.111.201.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 17:39:54 +0000
Received: from dsl-217-155-211-14.zen.co.uk ([217.155.211.14] helo=dantoppro.local country=GB ident=postmaster*pop3*hardiker#co^uk)
          by lon-mail-4.gradwell.net with esmtpa (Gradwell gwh-smtpd 1.290) id 482880f3.b0ce.293
          for java-user@lucene.apache.org; Mon, 12 May 2008 18:40:03 +0100
          (envelope-sender <dhardiker@adaptavist.com>)
Message-ID: <482880EC.5070305@adaptavist.com>
Date: Mon, 12 May 2008 18:39:56 +0100
From: Dan Hardiker <dhardiker@adaptavist.com>
Organization: Adaptavist.com Ltd
User-Agent: Thunderbird 2.0.0.9 (Macintosh/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Numerical Range Query
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I've got an application which stores ratings for content in a Lucene 
index. It works a treat for the most part, apart from the use-case I 
have for being able to filter out ratings that have less than a given 
number of rates. It kinda works, but seems to use Alpha ranging rather 
than Numeric ranging.

Here is the Java code I am using:

luceneQuery.add( new RangeQuery( new Term(RateUtils.SF_FILTERED_CNT, 
minRatesString), null, true), BooleanClause.Occur.MUST );

For context:

* luceneQuery is a org.apache.lucene.search.BooleanQuery
* RateUtils.SF_FILTERED_CNT is the String containing the appropriate 
field name "rating-filtered-count"
* minRatesString is an integer as a String

Here is where the field is added into the index:

document.add( new Field(RateUtils.SF_FILTERED_CNT, String.valueOf( 
filteredCount ), Field.Store.YES, Field.Index.UN_TOKENIZED) );

For context:

* document is a org.apache.lucene.document.Document
* filteredCount is an int (counting the number of rates that have occurred)

Unfortunately it doesn't work quite as I expected as if I have 5 
documents in the index:

# 5 ratings
# 9 ratings
# 1 rating
# 0 ratings
# 11 ratings

If minRatesString is "5" then only the first document is returned, if 
it's "1" then the 3rd and 5th are returned, if its "6" then none are 
returned. It appears to be filtering alphabetically (starting with the 
first digit/character and matching on that) rather than numerically.

Oddly enough, if I sort on that field ... it works as I expect.

Am I missing something?


--
Dan Hardiker

PS: I've been googling for well over an hour, if I'm not searching with 
the right terms - please advise me! I tried to find a way to search the 
archives specifically, but I could only browse them month by month.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34023-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 18:16:30 2008
Return-Path: <java-user-return-34023-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4080 invoked from network); 12 May 2008 18:16:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 18:16:30 -0000
Received: (qmail 44489 invoked by uid 500); 12 May 2008 18:16:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44461 invoked by uid 500); 12 May 2008 18:16:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44450 invoked by uid 99); 12 May 2008 18:16:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 11:16:23 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 72.14.220.155 as permitted sender)
Received: from [72.14.220.155] (HELO fg-out-1718.google.com) (72.14.220.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 18:15:37 +0000
Received: by fg-out-1718.google.com with SMTP id l27so2162448fgb.27
        for <java-user@lucene.apache.org>; Mon, 12 May 2008 11:15:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=0IFW6TytiKZiOwEmaVfmOxb33/V6pSgV8o0b7aZ4sro=;
        b=FSZ5OB8ac95LdUgHR41tiqFNZ5NwhuJ6gMzWOcctetxt3P56xDiA0FMBGpeTTaLAdvTVJXzzwY4SOOd4CCaFC3SMgQVHqW1c/zMMJ0DpiSzzYROymKXwCuZU8biv/DabKbGY/rSVYIuD142yit3WkK6a2PbfG4KfBmieXPdTTm4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=SmYjjaelWlnDqXF85YiPuCeE6uhroI/hFHmUT9RwynZTW4+u1qcKmWyQw2BlnKW0C0G4dpV5M5AC1CW9rOhKRijOPwazkNtVNBR0VOvHhOnoaDpVEdGsAYtnIxbeDD2dkk3WYUZYZfCjU/LYsE0cN+h6RgB97L69G4q10I+ynSc=
Received: by 10.86.89.1 with SMTP id m1mr14775791fgb.45.1210616151546;
        Mon, 12 May 2008 11:15:51 -0700 (PDT)
Received: by 10.86.59.14 with HTTP; Mon, 12 May 2008 11:15:51 -0700 (PDT)
Message-ID: <359a92830805121115kb4e4ac5xd728303a95cfabe5@mail.gmail.com>
Date: Mon, 12 May 2008 14:15:51 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Numerical Range Query
In-Reply-To: <482880EC.5070305@adaptavist.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_4939_27145973.1210616151538"
References: <482880EC.5070305@adaptavist.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_4939_27145973.1210616151538
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Yep, lucene works with strings, not numbers so the fact that you're
not getting what you expect is expected <G>.

Although I'm a bit puzzled by what you're actually getting back.
You might try using Luke to look at your index to see what's
there.

See the NumberTools class for some help here.......

BTW, at least in Lucene 2.1, the preferred way to go about this
would be ConstantScoreRangeQuery...

Best
Erick

On Mon, May 12, 2008 at 1:39 PM, Dan Hardiker <dhardiker@adaptavist.com>
wrote:

> Hi,
>
> I've got an application which stores ratings for content in a Lucene
> index. It works a treat for the most part, apart from the use-case I have
> for being able to filter out ratings that have less than a given number of
> rates. It kinda works, but seems to use Alpha ranging rather than Numeric
> ranging.
>
> Here is the Java code I am using:
>
> luceneQuery.add( new RangeQuery( new Term(RateUtils.SF_FILTERED_CNT,
> minRatesString), null, true), BooleanClause.Occur.MUST );
>
> For context:
>
> * luceneQuery is a org.apache.lucene.search.BooleanQuery
> * RateUtils.SF_FILTERED_CNT is the String containing the appropriate field
> name "rating-filtered-count"
> * minRatesString is an integer as a String
>
> Here is where the field is added into the index:
>
> document.add( new Field(RateUtils.SF_FILTERED_CNT, String.valueOf(
> filteredCount ), Field.Store.YES, Field.Index.UN_TOKENIZED) );
>
> For context:
>
> * document is a org.apache.lucene.document.Document
> * filteredCount is an int (counting the number of rates that have
> occurred)
>
> Unfortunately it doesn't work quite as I expected as if I have 5 documents
> in the index:
>
> # 5 ratings
> # 9 ratings
> # 1 rating
> # 0 ratings
> # 11 ratings
>
> If minRatesString is "5" then only the first document is returned, if it's
> "1" then the 3rd and 5th are returned, if its "6" then none are returned. It
> appears to be filtering alphabetically (starting with the first
> digit/character and matching on that) rather than numerically.
>
> Oddly enough, if I sort on that field ... it works as I expect.
>
> Am I missing something?
>
>
> --
> Dan Hardiker
>
> PS: I've been googling for well over an hour, if I'm not searching with
> the right terms - please advise me! I tried to find a way to search the
> archives specifically, but I could only browse them month by month.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_4939_27145973.1210616151538--

From java-user-return-34024-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 19:21:45 2008
Return-Path: <java-user-return-34024-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28524 invoked from network); 12 May 2008 19:21:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 19:21:44 -0000
Received: (qmail 20090 invoked by uid 500); 12 May 2008 19:21:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20062 invoked by uid 500); 12 May 2008 19:21:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20051 invoked by uid 99); 12 May 2008 19:21:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 12:21:38 -0700
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [193.111.201.130] (HELO lon-mail-4.gradwell.net) (193.111.201.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 19:20:49 +0000
Received: from dsl-217-155-211-14.zen.co.uk ([217.155.211.14] helo=dantoppro.local country=GB ident=postmaster#pop3$hardiker&co#uk)
          by lon-mail-4.gradwell.net with esmtpa (Gradwell gwh-smtpd 1.290) id 4828989d.15653.276
          for java-user@lucene.apache.org; Mon, 12 May 2008 20:21:01 +0100
          (envelope-sender <dhardiker@adaptavist.com>)
Message-ID: <4828989D.4040606@adaptavist.com>
Date: Mon, 12 May 2008 20:21:01 +0100
From: Dan Hardiker <dhardiker@adaptavist.com>
Organization: Adaptavist.com Ltd
User-Agent: Thunderbird 2.0.0.9 (Macintosh/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Numerical Range Query
References: <482880EC.5070305@adaptavist.com> <359a92830805121115kb4e4ac5xd728303a95cfabe5@mail.gmail.com>
In-Reply-To: <359a92830805121115kb4e4ac5xd728303a95cfabe5@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Erick Erickson wrote:
> Although I'm a bit puzzled by what you're actually getting back.
> You might try using Luke to look at your index to see what's
> there.

I've looked through with Luke and it doesn't look like much has changed 
between using NumberTools and not. NumberTools definitely does some 
padding which makes sense, however even though I'm using that, Lucene or 
Luke seems to be boiling it down to just the number. I'm not sure which.

> See the NumberTools class for some help here.......
> 
> BTW, at least in Lucene 2.1, the preferred way to go about this
> would be ConstantScoreRangeQuery...

Taking your advice I'm now indexing using:

document.add( new Field(RateUtils.SF_FILTERED_CNT, 
NumberTools.longToString( filteredCount ), Field.Store.YES, 
Field.Index.UN_TOKENIZED) );

and searching using:

I'm now
int minRates = Long.valueOf( minRatesString ).intValue();
luceneQuery.add( new ConstantScoreRangeQuery( RateUtils.SF_FILTERED_CNT, 
NumberTools.longToString(minRates), "", true, false ), 
BooleanClause.Occur.MUST );

I get very odd results back now, but they seem to work similarly. The 
documentation for ConstantScoreRangeQuery is rather thin however I did 
find this example which suggests I'm doing the right thing:

http://github.com/we4tech/semantic-repository/tree/master/development/idea-repository-core/src/main/java/com/ideabase/repository/core/index/ExtendedQueryParser.java

The code _looks_ like it should work, it makes sense logically but it 
still doesn't do what I'm expecting.

I've tried changing the indexing over to Field.Index.NO_NORMS and it 
makes the field value "0000000000000b" instead of "11", and 
"00000000000002" instead of "2" ... but that meant that the searching 
didn't pick up on that field _at all_.

Surely "find me results where numeric field x is higher than y" can't be 
an uncommon request? I can think of many areas where you want to do that 
(age filtering for example).

Any other suggestions of what I should be looking for, or where I can 
look to find out the next step to take?


--
Dan Hardiker

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34025-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 20:34:01 2008
Return-Path: <java-user-return-34025-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56550 invoked from network); 12 May 2008 20:34:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 20:34:01 -0000
Received: (qmail 8082 invoked by uid 500); 12 May 2008 20:33:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8057 invoked by uid 500); 12 May 2008 20:33:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8046 invoked by uid 99); 12 May 2008 20:33:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 13:33:54 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.185 as permitted sender)
Received: from [209.85.128.185] (HELO fk-out-0910.google.com) (209.85.128.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 20:33:06 +0000
Received: by fk-out-0910.google.com with SMTP id 18so2034452fkq.5
        for <java-user@lucene.apache.org>; Mon, 12 May 2008 13:33:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=Z9VkdQrowcthaXU78Jbk66zGdKRZhLkiw59fitq+zpk=;
        b=otv9LLRfnqgVN2iJPBNyUVqUy1sKf+EpEgimUjgPT8tb14CZZQCCbza60D4tUTYB7hiTYwjQfO0cr6cK9fzc3mSvztkk0DD6SekHnMYXq3ahWHEWNXbrIMGmBt32X0Jsf519NzIP6LpI33Ln1JkT94MZmIL5lrhohUXStZrduFM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=jaLfGOKRAvCigH2Qew0hMiBQMnsrjO06J4Vb9AB8eimk5TKe35sqlDwcIWHteT9fs1/KMwkXwc5dXG70e1+g+XsqqmZpG1EyxvWIq3cIEnwC5Lk7pV2u6F9gXbrYyqYVJ/m9WJA82VWlETEPCkxsUhKMvDOpZa7rHVb7D3qziqI=
Received: by 10.86.57.9 with SMTP id f9mr15090376fga.8.1210624399331;
        Mon, 12 May 2008 13:33:19 -0700 (PDT)
Received: by 10.86.59.14 with HTTP; Mon, 12 May 2008 13:33:19 -0700 (PDT)
Message-ID: <359a92830805121333r1bc887afx6d8b85d7333e896f@mail.gmail.com>
Date: Mon, 12 May 2008 16:33:19 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Numerical Range Query
In-Reply-To: <4828989D.4040606@adaptavist.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5480_7969329.1210624399303"
References: <482880EC.5070305@adaptavist.com>
	 <359a92830805121115kb4e4ac5xd728303a95cfabe5@mail.gmail.com>
	 <4828989D.4040606@adaptavist.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5480_7969329.1210624399303
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Are you using NumberTools both at index and query time? Because
this works exactly as I expect....

import org.apache.lucene.index.IndexWriter;
import org.apache.lucene.store.FSDirectory;
import org.apache.lucene.analysis.standard.StandardAnalyzer;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.document.NumberTools;
import org.apache.lucene.search.IndexSearcher;
import org.apache.lucene.search.Hits;
import org.apache.lucene.search.ConstantScoreRangeQuery;

import java.io.IOException;

/**
 * Created by: eoericks
 * Date: May 12, 2008
 * History: $Log$
 */
public class Test {
    public static void main(String args[]) {
        try {
            Test test = new Test();
            test.doIndex();
            test.doSearch();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    private void doIndex() throws IOException {

        IndexWriter w = new
IndexWriter(FSDirectory.getDirectory("C:/lucidx"), new StandardAnalyzer(),
true);
        Document doc = new Document();
        doc.add(new Field("num", NumberTools.longToString(1), Field.Store.NO,
Field.Index.UN_TOKENIZED));
        doc.add(new Field("name", "doc 1", Field.Store.YES,
Field.Index.UN_TOKENIZED));
        w.addDocument(doc);

        doc = new Document();
        doc.add(new Field("num", NumberTools.longToString(11),
Field.Store.NO, Field.Index.UN_TOKENIZED));
        doc.add(new Field("name", "doc 11", Field.Store.YES,
Field.Index.UN_TOKENIZED));
        w.addDocument(doc);

        doc = new Document();
        doc.add(new Field("num", NumberTools.longToString(5), Field.Store.NO,
Field.Index.UN_TOKENIZED));
        doc.add(new Field("name", "doc 5", Field.Store.YES,
Field.Index.UN_TOKENIZED));
        w.addDocument(doc);

        doc = new Document();
        doc.add(new Field("num", NumberTools.longToString(9), Field.Store.NO,
Field.Index.UN_TOKENIZED));
        doc.add(new Field("name", "doc 9", Field.Store.YES,
Field.Index.UN_TOKENIZED));
        w.addDocument(doc);

        w.close();

    }

    private void doSearch() throws IOException {
        IndexSearcher r = new
IndexSearcher(FSDirectory.getDirectory("c:/lucidx"));
        oneSearch(r, 1L);
        oneSearch(r, 2L);
        oneSearch(r, 5L);
        oneSearch(r, 9L);
        oneSearch(r, 0L);

    }
    private void oneSearch(IndexSearcher r, Long lower) throws IOException {
        System.out.println("\n\nSearching for greater than " +
Long.toString(lower));
        Hits hits = r.search(new ConstantScoreRangeQuery("num",
NumberTools.longToString(lower), null,  false, true));
        for (int idx = 0; idx < hits.length(); ++idx) {
            System.out.println(hits.doc(idx).get("name"));
        }

    }
}


***output***

Searching for greater than 1
doc 11
doc 5
doc 9


Searching for greater than 2
doc 11
doc 5
doc 9


Searching for greater than 5
doc 11
doc 9


Searching for greater than 9
doc 11


Searching for greater than 0
doc 1
doc 11
doc 5
doc 9


On Mon, May 12, 2008 at 3:21 PM, Dan Hardiker <dhardiker@adaptavist.com>
wrote:

> Erick Erickson wrote:
>
> > Although I'm a bit puzzled by what you're actually getting back.
> > You might try using Luke to look at your index to see what's
> > there.
> >
>
> I've looked through with Luke and it doesn't look like much has changed
> between using NumberTools and not. NumberTools definitely does some padding
> which makes sense, however even though I'm using that, Lucene or Luke seems
> to be boiling it down to just the number. I'm not sure which.
>
>  See the NumberTools class for some help here.......
> >
> > BTW, at least in Lucene 2.1, the preferred way to go about this
> > would be ConstantScoreRangeQuery...
> >
>
> Taking your advice I'm now indexing using:
>
> document.add( new Field(RateUtils.SF_FILTERED_CNT,
> NumberTools.longToString( filteredCount ), Field.Store.YES,
> Field.Index.UN_TOKENIZED) );
>
> and searching using:
>
> I'm now
> int minRates = Long.valueOf( minRatesString ).intValue();
> luceneQuery.add( new ConstantScoreRangeQuery( RateUtils.SF_FILTERED_CNT,
> NumberTools.longToString(minRates), "", true, false ),
> BooleanClause.Occur.MUST );
>
> I get very odd results back now, but they seem to work similarly. The
> documentation for ConstantScoreRangeQuery is rather thin however I did find
> this example which suggests I'm doing the right thing:
>
>
> http://github.com/we4tech/semantic-repository/tree/master/development/idea-repository-core/src/main/java/com/ideabase/repository/core/index/ExtendedQueryParser.java
>
> The code _looks_ like it should work, it makes sense logically but it
> still doesn't do what I'm expecting.
>
> I've tried changing the indexing over to Field.Index.NO_NORMS and it makes
> the field value "0000000000000b" instead of "11", and "00000000000002"
> instead of "2" ... but that meant that the searching didn't pick up on that
> field _at all_.
>
> Surely "find me results where numeric field x is higher than y" can't be
> an uncommon request? I can think of many areas where you want to do that
> (age filtering for example).
>
> Any other suggestions of what I should be looking for, or where I can look
> to find out the next step to take?
>
>
> --
> Dan Hardiker
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_5480_7969329.1210624399303--

From java-user-return-34026-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 21:12:08 2008
Return-Path: <java-user-return-34026-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72906 invoked from network); 12 May 2008 21:12:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 21:12:08 -0000
Received: (qmail 62596 invoked by uid 500); 12 May 2008 21:12:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62572 invoked by uid 500); 12 May 2008 21:12:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62561 invoked by uid 99); 12 May 2008 21:12:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 14:12:02 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of brendan.grainger@gmail.com designates 209.85.132.251 as permitted sender)
Received: from [209.85.132.251] (HELO an-out-0708.google.com) (209.85.132.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 21:11:15 +0000
Received: by an-out-0708.google.com with SMTP id c37so544332anc.49
        for <java-user@lucene.apache.org>; Mon, 12 May 2008 14:11:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to:in-reply-to:content-type:content-transfer-encoding:mime-version:subject:date:references:x-mailer;
        bh=xwh/WGeCHvgusirBAXlo1h4+6K2Gj0agH6zU9N3KgEU=;
        b=iGvUo0A3P4ZEDQvRMnpuaS9ecyQNg2qWKyhogNDNyWdwADJ60h1GxW69aiYvLrjFVpXZjxu/HBCcM5A/cUF6H15cORlgzSAyGUHS5iQFhZ2+N68sV1F2u5RSdCRFRyHXLMlJqj8aGnKAgsNuDQdqtpf11oDkw7hyM8fOmBoURRA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type:content-transfer-encoding:mime-version:subject:date:references:x-mailer;
        b=xhRe9cJZcOGbyKEQ4KC5zpUQHa37LaxBrDU2sJna7sTS7ZzoyZOWHWL6d66B3h6Woe2KI6BR8k0opvX7kJ2FZ4Q+U2EdXhjmvpvlZz46uCCy8RgdO67zTZ9A9ZpJ3XwPc6d7yht6r2MRulKZNpSXYT6E+U9TDf0nWMvOzHWyeKc=
Received: by 10.100.93.12 with SMTP id q12mr1201496anb.34.1210626689237;
        Mon, 12 May 2008 14:11:29 -0700 (PDT)
Received: from ?192.168.1.108? ( [216.57.31.115])
        by mx.google.com with ESMTPS id i10sm69051wxd.33.2008.05.12.14.11.27
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 12 May 2008 14:11:27 -0700 (PDT)
Message-Id: <5A2A079E-CC77-4E36-B739-85D084D69CB0@gmail.com>
From: Brendan Grainger <brendan.grainger@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <359a92830805120923v67bd2e75n1af679957d75292e@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Question about startOffset and endOffset
Date: Mon, 12 May 2008 17:11:25 -0400
References: <077BBCF2-2E6C-4459-A924-417CA088EAA3@gmail.com> <359a92830805120923v67bd2e75n1af679957d75292e@mail.gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Erick,

Thanks for the reply. The use case I have is this:

Say you have a synonym expansion like this:

ac -> air conditioning

And to keep it simple, a document where the first term is ac. When  
analyzing the document I currently create a token stream that looks  
something like this for the 'ac' term:

ac -> Token(positionIncrement = 1, startOffset = 0, endOffset = 2,  
type = 'word')
air -> Token(positionIncrement = 0, startOffset = 0, endOffset = 2,  
type = 'synonym')
conditioning -> Token(positionIncrement = 0, startOffset = 0,  
endOffset = 2, type = 'synonym')

Now what I'd like to do is be able to do is to display the fact that  
this expansion took place to the user when they query. However, now I  
don't know how to reconstruct the word 'air conditioning'. If however,  
I do this:

ac -> Token(positionIncrement = 1, startOffset = 0, endOffset = 2,  
type = 'word')
air -> Token(positionIncrement = 0, startOffset = 0, endOffset = 3,  
type = 'synonym')
conditioning -> Token(positionIncrement = 0, startOffset = 3,  
endOffset = 15, type = 'synonym')

I can reconstruct the fact that ac maps to air conditioning.

Thanks
Brendan

On May 12, 2008, at 12:23 PM, Erick Erickson wrote:

> Is this a theoretical question or is there a use-case you're trying
> to support? If the latter, a statement of the problem you're trying
> to solve would be helpful.
>
> If the former, setting all your start offsets to 0 seems wrong. You're
> essentially saying that all tokens are at the beginning of the  
> document
> and each one is some ever-increasing distance from the start. Some
> of your later words will look really, really long (like the length
> of your document).
>
> Offhand, I expect this will affect up span queries, phrase
> queries, and who knows what else? Maybe scoring?
> Or maybe not, maybe some (or all) of these work off of
> termpositions rather than offsets. So unless you're trying to
> accomplish something specific, I sure wouldn't do this
> given the problems it *could* create.
>
> That said, I'm not much of an expert on how the offsets are
> used, but I'd be really leery of changing them "just for the fun of
> it" <G>......
>
> Best
> Erick
>
> On Mon, May 12, 2008 at 12:06 PM, Brendan Grainger <
> brendan.grainger@gmail.com> wrote:
>
>> Hi,
>>
>> I have a TokenStream that inserts synonym tokens into the stream when
>> matched. One thing I am wondering about is what is the effect of the
>> startOffset and endOffset. I have something like this:
>>
>> Token synonymToken = new Token(originalToken.startOffset(),
>> originalToken.endOffset(), "SYNONYM");
>> synonymToken.setPositionIncrement(0);
>>
>> What I am wondering is if I set the startOffset and endOffset to 0  
>> and the
>> endOffset to the length of the synonym string what effect will this  
>> have?
>>
>> eg
>> Token synonymToken = new Token(0, repTok.endOffset(), "SYNONYM");
>> synonymToken.setPositionIncrement(0);
>>
>> Thanks
>>
>>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34027-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 12 22:17:42 2008
Return-Path: <java-user-return-34027-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5884 invoked from network); 12 May 2008 22:17:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 May 2008 22:17:42 -0000
Received: (qmail 24993 invoked by uid 500); 12 May 2008 22:17:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24960 invoked by uid 500); 12 May 2008 22:17:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24949 invoked by uid 99); 12 May 2008 22:17:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 15:17:35 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.34] (HELO smtp-vbr14.xs4all.nl) (194.109.24.34)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 May 2008 22:16:49 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr14.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4CMH1pe087233
	for <java-user@lucene.apache.org>; Tue, 13 May 2008 00:17:01 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Filtering a SpanQuery
Date: Tue, 13 May 2008 00:17:00 +0200
User-Agent: KMail/1.9.9
References: <74f928500805060115k6c6373bdib50b0e1ec88ecbbc@mail.gmail.com> <200805071822.24048.paul.elschot@xs4all.nl> <74f928500805120006n1e2dccccqeb410def1fd2e63f@mail.gmail.com>
In-Reply-To: <74f928500805120006n1e2dccccqeb410def1fd2e63f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805130017.00787.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Op Monday 12 May 2008 09:06:36 schreef Eran Sevi:
> Thanks Paul,
>
> I'll give your code sample a try.
> I still think that calling getSpans (the first line of code) that
> returns millions of results is going to be much slower than calling
> getSpans that's going to return only a few thousands of results.
> Since the filtering is only performed after calling this method it
> can't help in this case.

The given untested code (apart from possible bugs) would process
exactly as many documents and their Spans as SpanScorer would
in the explicitly filtered case.

> I guess your suggested solution is my best option without changing
> the way getSpans works (which I'm not going to change any time soon )

Before doing that, have a look at the code of SpanWeight/SpanScorer,
ConjunctionScorer, and the filtering code in IndexSearcher.

Regards,
Paul Elschot.



> Eran.
>
> On Wed, May 7, 2008 at 7:22 PM, Paul Elschot <paul.elschot@xs4all.nl> 
wrote:
> > Op Wednesday 07 May 2008 10:18:38 schreef Eran Sevi:
> > > Thanks Paul for your reply,
> > >
> > > Since my index contains a couple of millions documents and the
> > > filter is supposed to limit the search space to a few thousands I
> > > was hoping I won't have to do the filtering myself after running
> > > the query on all the index.
> >
> > The code I gave earlier effectively does a filtered query search
> > on the index. It visits the resulting Spans, and does not provide
> > a score value per document as SpanScorer would do.
> > Please make sure to test that code thoroughly for reliable results.
> >
> > > Maybe this is the case anyway and behind the scenes the filter
> > > does exactly what you suggested.
> >
> > Yes, a filtered query search would use skipTo() on the Spans via
> > SpanScorer. But the difference between the normal case
> > and your case is that you don't need SpanScorer.
> >
> > > From what I tested the number of results of the SpanQuery greatly
> > > affects the running speed so if I'm going to use about 0.1% of
> > > the results I'm loosing a lot of time and memory for gathering
> > > and storing the spans I'm not going to use.
> > >
> > > I don't know how SpanQuery works internally but I guess that if
> > > the filter is known beforehand,
> >
> > A Filter needs to make a BitSet available before the query search.
> >
> > > it could speed things up quite a bit.
> >
> > I would expect a substantial speedup from using skipTo() on the
> > Spans when only 0.1% of the results passes the filter.
> >
> > Regards,
> > Paul Elschot
> >
> > > Eran.
> > >
> > >
> > > On Wed, May 7, 2008 at 10:34 AM, Paul Elschot
> > > <paul.elschot@xs4all.nl>
> > >
> > > wrote:
> > > > Op Tuesday 06 May 2008 17:39:38 schreef Paul Elschot:
> > > > > Eran,
> > > > >
> > > > > Op Tuesday 06 May 2008 10:15:10 schreef Eran Sevi:
> > > > > > Hi,
> > > > > >
> > > > > > I am looking for a way to filter a SpanQuery according to
> > > > > > some other query (on another field from the one used for
> > > > > > the SpanQuery). I need to get access to the spans
> > > > > > themselves of course. I don't care about the scoring of the
> > > > > > filter results and just need the positions of hits found in
> > > > > > the documents that matches the filter.
> > > > >
> > > > > I think you'll have to implement the filtering on the Spans
> > > > > yourself. That's not really difficult, just use
> > > > > Spans.skipTo(). The code to do that could look sth like this
> > > > > (untested):
> > > > >
> > > > > Spans spans = yourSpanQuery.getSpans(reader);
> > > > > BitSet bits = yourFilter.bits(reader);
> > > > > int filterDoc = bits.nextSetBit(0);
> > > > > while ((filterDoc >= 0) and spans.skipTo(filterDoc)) {
> > > > >   boolean more = true;
> > > > >   while (more and (spans.doc() == filterDoc)) {
> > > > >      // use spans.start() and spans.end() here
> > > > >      // ...
> > > > >      more = spans.next();
> > > > >   }
> > > > >   if (! more) {
> > > > >     break;
> > > > >   }
> > > > >   filterDoc = bits.nextSetBit(spans.doc());
> > > >
> > > > At this point, no skipping on the spans should be done when
> > > > filterDoc equals spans.doc(), so this code still needs some
> > > > work. But I think you get the idea.
> > > >
> > > > Regards,
> > > > Paul Elschot
> > > >
> > > > > }
> > > > >
> > > > > Please check the javadocs of java.util.BitSet, there may
> > > > > be a 1 off error in the arguments to nextSetBit().
> > > > >
> > > > > Regards,
> > > > > Paul Elschot
> > > > >
> > > > > > I tried looking through the archives and found some
> > > > > > reference to a SpanQueryFilter patch, however I don't see
> > > > > > how it can help me achieve what I want to do. This class
> > > > > > receives only one query parameter (which I guess is the
> > > > > > actual query) and not a query and a filter for example.
> > > > > >
> > > > > > Any help about how I can achieve this will be appreciated.
> > > > > >
> > > > > > Thanks,
> > > > > > Eran.
> > > > >
> > > > > -------------------------------------------------------------
> > > > >---- ---- To unsubscribe, e-mail:
> > > > > java-user-unsubscribe@lucene.apache.org For additional
> > > > > commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > > ---------------------------------------------------------------
> > > >---- -- To unsubscribe, e-mail:
> > > > java-user-unsubscribe@lucene.apache.org For additional
> > > > commands, e-mail: java-user-help@lucene.apache.org
> >
> > -------------------------------------------------------------------
> >-- To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34028-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 07:39:52 2008
Return-Path: <java-user-return-34028-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76022 invoked from network); 13 May 2008 07:39:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 07:39:51 -0000
Received: (qmail 48372 invoked by uid 500); 13 May 2008 07:39:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48346 invoked by uid 500); 13 May 2008 07:39:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48323 invoked by uid 99); 13 May 2008 07:39:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 00:39:45 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of madan.lucene@gmail.com designates 209.85.200.171 as permitted sender)
Received: from [209.85.200.171] (HELO wf-out-1314.google.com) (209.85.200.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 07:38:59 +0000
Received: by wf-out-1314.google.com with SMTP id 28so2679269wfc.20
        for <java-user@lucene.apache.org>; Tue, 13 May 2008 00:39:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=6Rs7/I/mBRp9SnFfTF3qlUE7bAFb967azTvimPU4CbA=;
        b=x3fYdc0Yd0qBpFX6o+gZlr2LhAFmjntLUqGDOYJB3wCs9/A3s3Ho7E+6//dT9DHtpUJBF2Ks4+CRqMG/qLVrpso8cS8qIo1d5rz+JskkuOJKTLRHWrGgvzudrobltq0Bu/dUVWjtnvI0AFGZy5i3VTQhcLHwaNl7fFTnbnwkrt4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=BNsCss2eyROaAVLenvXIryf0PPg7iNQHh8kL1DFTj3pL7ccz0If35dnZ07qphstHRWVZnlghxQaFosB0Omti9dM014C4eV4dr1Q1bP/6fOuwpjE2yzE2Bakjc5rWcqNL2JZmaBcR0Scun+Xhv23F1CNNSa9uAj5J//jROROyY4M=
Received: by 10.142.157.9 with SMTP id f9mr3657318wfe.311.1210664354577;
        Tue, 13 May 2008 00:39:14 -0700 (PDT)
Received: by 10.142.89.18 with HTTP; Tue, 13 May 2008 00:39:14 -0700 (PDT)
Message-ID: <ddef46640805130039vb881ac2r218792f93b1e4ff5@mail.gmail.com>
Date: Tue, 13 May 2008 13:09:14 +0530
From: "Madan Narra" <madan.lucene@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Search and retrieve the line data from the File
In-Reply-To: <ddef46640805120251i157862dflcc6c21efe6a3adc2@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <ddef46640805120235o7b771fe8l6c0c27181c9dc8b5@mail.gmail.com>
	 <ddef46640805120251i157862dflcc6c21efe6a3adc2@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,

Can anyone please explain how can the below explained task accomplished...

Thanks,
Madan N

On Mon, May 12, 2008 at 3:21 PM, Madan Narra <madan.lucene@gmail.com> wrote:
>
>
>
>
> Hi All,
>
> I am very much new to Lucene and want to extend my skills over this tool....
>
> But i am in need of a quick assignment which i would need to complete soon...so haven't got much time to read over the docs/books over net..
>
> So please suggest how can i archive the below task and the rest i can make over.
>
> I have a inbound file of around 10k records , each line is a new record.
>
> I need to search for a word or phrase in the inbound file, and retrieve all the line data which consists the word.
>
> Ex:
>
> 102652;ABN AMRO  Monthly Income Plan-Regular Plan-Growth Option;13.3054
> 102653;ABN AMRO  Monthly Income Plan-Regular Plan-Monthly Dividend Option;10.0011
> 102654;ABN AMRO  Monthly Income Plan-Regular Plan-Quarterly Dividend Option;10.0498
> 102645;ABN AMRO  Short Term Income Fund-Institutional Plan-Daily Dividend Option;10.0104
> 106524;AIG India Treasury Plus Fund-Institutional Plan-Daily Dividend Option;10.0109
> 100601;Canara Robeco Cigo-Growth Plan;21.88
> 101620;Franklin India International Fund;10.3648
> 100948;Franklin India Monthly Income Plan-Growth;23.1588
>
> As Shown above, if i search for "Franklin" i  need to show up the below thing :
>
> 101620;Franklin India International Fund;10.3648
> 100948;Franklin India Monthly Income Plan-Growth;23.1588
>
> If i search for "ABN" , than the result should be as below :
>
> 102652;ABN AMRO  Monthly Income Plan-Regular Plan-Growth Option;13.3054
> 102653;ABN AMRO  Monthly Income Plan-Regular Plan-Monthly Dividend Option;10.0011
> 102654;ABN AMRO  Monthly Income Plan-Regular Plan-Quarterly Dividend Option;10.0498
> 102645;ABN AMRO  Short Term Income Fund-Institutional Plan-Daily Dividend Option;10.0104
>
> Hope my question is clear and understanding...
>
> Please help me over how could i achieve the above process to search for a word in the file and display the results as discussed.
>
> Thanks,
> Madan N
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34029-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 07:50:39 2008
Return-Path: <java-user-return-34029-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78164 invoked from network); 13 May 2008 07:50:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 07:50:39 -0000
Received: (qmail 54807 invoked by uid 500); 13 May 2008 07:50:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54776 invoked by uid 500); 13 May 2008 07:50:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54765 invoked by uid 99); 13 May 2008 07:50:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 00:50:34 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of adb@teamware.com designates 212.226.92.15 as permitted sender)
Received: from [212.226.92.15] (HELO monkey.teamware.com) (212.226.92.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 07:49:38 +0000
Received: from intrepid.teamw.com (intrepid.teamw.com [10.142.128.11])
	by monkey.teamware.com (8.13.1/8.13.1) with ESMTP id m4D7nhNR008047
	for <java-user@lucene.apache.org>; Tue, 13 May 2008 10:49:43 +0300
X-Map-MIXER-Originators: false
To: java-user@lucene.apache.org
From: "Bowesman Antony"
 <adb@teamware.com>
MIME-Version: 1.0
Date: 13 May 2008 10:49:00 +0300
Subject: Re: Can POI provide reliable text extraction results for productionsearch engine for Word, Excel and PowerPoint formats?
Envelope-ID: JA8AAAAAAPkcKAABYQABSOwLQb5U@teamware.com
Message-Id: <JA8AAAAAAPkcKAABYQABSOwLQb5U@teamware.com>
References: <52c3ddca0805120703k25c56c4chbc68d18a5cfacb8@mail.gmail.com>
X-Mailer: TeamWARE Connector for MIME
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-1.6 (monkey.teamware.com [212.226.92.15]); Tue, 13 May 2008 10:49:43 +0300 (EEST)
X-TWG-MailScanner-Information: See www.mailscanner.info for information
X-TWG-MailScanner: Found to be clean
X-TWG-MailScanner-SpamCheck: not spam, SpamAssassin (score=0, required 5,
	autolearn=not spam)
X-MailScanner-From: adb@teamware.com
X-Virus-Checked: Checked by ClamAV on apache.org

We are using POI 3.0.2 FINAL.  Like you, it is not very reliable for many Word 
files.  It does not support Word 2, Fast saved files, files which are not padded 
to 256 bytes.  PPT and Excel are quite bad, a large % of our PPT files throw 
Exceptions.  Not tried 3.1 as it's just gone BETA 1, but I expect that the Word 
parsing is unchanged and the changelog doesn't show any Word changes.

TestMining.org http://www.textmining.org/ is quite good, but the 0.4 version did 
not do Word 2 or Fast Saved files.  1.0 version should fix that, but I've not 
yet tried it.  Licene for 1.0 is LGPL, whereas 0.4 was Apache 2.

AbiWord http://www.abisource.com/ is pretty good, but it's a complete GUI so is 
quite slow if you want to use it for a lot of parsing.  It can do text 
extraction via the command line.  The Linux versions suports pipes.    It's 
based on WvWare http://wvware.sourceforge.net/

Catdoc (http://ftp.wagner.pp.ru/~vitus/software/catdoc/) is quite effective, 
fast.  It also has catppt.  I'm not sure if the text order is 100% according to 
the original though.

The last two are not licence friendly for distribution.

I've extracted the Nutch parsing framework and am using it in our product and 
have tested all of the above and the priority for Word parsing is TextMining 
v0.4, before POI and then the other two which I plugged in via the parse-ext parser.

HTH
Antony





Lukas Vlcek wrote:
> Hi,
> 
> I need to find a reliable way how to extract content out of Word, Excel and
> PowerPoint formats prior to indexing and I am not sure if POI is the best
> way to go. Can anybody share experience with POI and/or other [commercial]
> Java library for text extraction from MS formats?
> 
> My experience with POI is such that sometimes it can be a pain to get the
> content out of the MS files properly. I also know that Nutch plugin uses POI
> for MS formats but as far as I remember it is not 100% reliable (my more
> then one year old experience is that about 1-2% of files were not parsed).
> 
> My requirements are that the text extraction software must run on Linux and
> should be written in Java, it can be open source or commercial library.
> 
> Regards,
> Lukas
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34030-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 07:58:56 2008
Return-Path: <java-user-return-34030-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79594 invoked from network); 13 May 2008 07:58:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 07:58:56 -0000
Received: (qmail 62636 invoked by uid 500); 13 May 2008 07:58:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62606 invoked by uid 500); 13 May 2008 07:58:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62595 invoked by uid 99); 13 May 2008 07:58:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 00:58:50 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of adb@teamware.com designates 212.226.92.15 as permitted sender)
Received: from [212.226.92.15] (HELO monkey.teamware.com) (212.226.92.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 07:57:57 +0000
Received: from intrepid.teamw.com (intrepid.teamw.com [10.142.128.11])
	by monkey.teamware.com (8.13.1/8.13.1) with ESMTP id m4D7wBxQ008450
	for <java-user@lucene.apache.org>; Tue, 13 May 2008 10:58:11 +0300
X-Map-MIXER-Originators: false
To: java-user@lucene.apache.org
From: "Bowesman Antony"
 <adb@teamware.com>
MIME-Version: 1.0
Date: 13 May 2008 10:57:00 +0300
Subject: Re: Numerical Range Query
Envelope-ID: JA8AAAAAAPkcQgABYQABSOwLQb5U@teamware.com
Message-Id: <JA8AAAAAAPkcQgABYQABSOwLQb5U@teamware.com>
References: <482880EC.5070305@adaptavist.com>
X-Mailer: TeamWARE Connector for MIME
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-1.6 (monkey.teamware.com [212.226.92.15]); Tue, 13 May 2008 10:58:11 +0300 (EEST)
X-TWG-MailScanner-Information: See www.mailscanner.info for information
X-TWG-MailScanner: Found to be clean
X-TWG-MailScanner-SpamCheck: not spam, SpamAssassin (score=0, required 5,
	autolearn=not spam)
X-MailScanner-From: adb@teamware.com
X-Virus-Checked: Checked by ClamAV on apache.org

An alternative to Lucene's NumberTools, is Solr's NumberUtils, which is more 
space efficient for indexing numbers, but not as pretty to look at

http://lucene.apache.org/solr/api/org/apache/solr/util/NumberUtils.html



Dan Hardiker wrote:
> Hi,
> 
> I've got an application which stores ratings for content in a Lucene 
> index. It works a treat for the most part, apart from the use-case I 
> have for being able to filter out ratings that have less than a given 
> number of rates. It kinda works, but seems to use Alpha ranging rather 
> than Numeric ranging.
> 
> Here is the Java code I am using:
> 
> luceneQuery.add( new RangeQuery( new Term(RateUtils.SF_FILTERED_CNT, 
> minRatesString), null, true), BooleanClause.Occur.MUST );
> 
> For context:
> 
> * luceneQuery is a org.apache.lucene.search.BooleanQuery
> * RateUtils.SF_FILTERED_CNT is the String containing the appropriate 
> field name "rating-filtered-count"
> * minRatesString is an integer as a String
> 
> Here is where the field is added into the index:
> 
> document.add( new Field(RateUtils.SF_FILTERED_CNT, String.valueOf( 
> filteredCount ), Field.Store.YES, Field.Index.UN_TOKENIZED) );
> 
> For context:
> 
> * document is a org.apache.lucene.document.Document
> * filteredCount is an int (counting the number of rates that have occurred)
> 
> Unfortunately it doesn't work quite as I expected as if I have 5 
> documents in the index:
> 
> # 5 ratings
> # 9 ratings
> # 1 rating
> # 0 ratings
> # 11 ratings
> 
> If minRatesString is "5" then only the first document is returned, if 
> it's "1" then the 3rd and 5th are returned, if its "6" then none are 
> returned. It appears to be filtering alphabetically (starting with the 
> first digit/character and matching on that) rather than numerically.
> 
> Oddly enough, if I sort on that field ... it works as I expect.
> 
> Am I missing something?
> 
> 
> --
> Dan Hardiker
> 
> PS: I've been googling for well over an hour, if I'm not searching with 
> the right terms - please advise me! I tried to find a way to search the 
> archives specifically, but I could only browse them month by month.
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34031-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 12:45:11 2008
Return-Path: <java-user-return-34031-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66484 invoked from network); 13 May 2008 12:45:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 12:45:10 -0000
Received: (qmail 84185 invoked by uid 500); 13 May 2008 12:45:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84162 invoked by uid 500); 13 May 2008 12:45:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84151 invoked by uid 99); 13 May 2008 12:45:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 05:45:04 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.214] (HELO web26003.mail.ukl.yahoo.com) (217.12.10.214)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 13 May 2008 12:44:15 +0000
Received: (qmail 70550 invoked by uid 60001); 13 May 2008 12:44:27 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=cZ/ZiEFeIqsh+GNzFM8L8mlnwtZmgRlPTsh9AOtKYgiR8bZeTFnRS5MmYZsGziP/6hd9/6rwjX9vlB2X2sGWAuawirJ+G9hKw4gIAAvPKcdyZFL4rWX9jHapSZyujoBGNXyyIROOvK1ysdj4Q8WinW43KR4Uh5T0M1F6GxmVltw=;
X-YMail-OSG: 59s1dRMVM1kiltB6zhNFuXSjSxMIW_Dk2QRc8pg6gSldWW6FnchwW9eKksFKd0Ql2w--
Received: from [62.189.26.100] by web26003.mail.ukl.yahoo.com via HTTP; Tue, 13 May 2008 12:44:27 GMT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Tue, 13 May 2008 12:44:27 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: Can POI provide reliable text extraction results for productionsearch engine for Word, Excel and PowerPoint formats?
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Message-ID: <805156.69412.qm@web26003.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

On the commercial front, Oracle's "Outside In" (previously Stellent) is the=
 one that gets used in a lot of search engines.=0A=0ABeing a C-based produc=
t though, integration isn't quite as nice/easy as pure Java solutions.=0A=
=0A=0A----- Original Message ----=0AFrom: Bowesman Antony <adb@teamware.com=
>=0ATo: java-user@lucene.apache.org=0ASent: Tuesday, 13 May, 2008 8:49:00 A=
M=0ASubject: Re: Can POI provide reliable text extraction results for produ=
ctionsearch engine for Word, Excel and PowerPoint formats?=0A=0AWe are usin=
g POI 3.0.2 FINAL.  Like you, it is not very reliable for many Word =0Afile=
s.  It does not support Word 2, Fast saved files, files which are not padde=
d =0Ato 256 bytes.  PPT and Excel are quite bad, a large % of our PPT files=
 throw =0AExceptions.  Not tried 3.1 as it's just gone BETA 1, but I expect=
 that the Word =0Aparsing is unchanged and the changelog doesn't show any W=
ord changes.=0A=0ATestMining.org http://www.textmining.org/ is quite good, =
but the 0.4 version did =0Anot do Word 2 or Fast Saved files.  1.0 version =
should fix that, but I've not =0Ayet tried it.  Licene for 1.0 is LGPL, whe=
reas 0.4 was Apache 2.=0A=0AAbiWord http://www.abisource.com/ is pretty goo=
d, but it's a complete GUI so is =0Aquite slow if you want to use it for a =
lot of parsing.  It can do text =0Aextraction via the command line.  The Li=
nux versions suports pipes.    It's =0Abased on WvWare http://wvware.source=
forge.net/=0A=0ACatdoc (http://ftp.wagner.pp.ru/~vitus/software/catdoc/) is=
 quite effective, =0Afast.  It also has catppt.  I'm not sure if the text o=
rder is 100% according to =0Athe original though.=0A=0AThe last two are not=
 licence friendly for distribution.=0A=0AI've extracted the Nutch parsing f=
ramework and am using it in our product and =0Ahave tested all of the above=
 and the priority for Word parsing is TextMining =0Av0.4, before POI and th=
en the other two which I plugged in via the parse-ext parser.=0A=0AHTH=0AAn=
tony=0A=0A=0A=0A=0A=0ALukas Vlcek wrote:=0A> Hi,=0A> =0A> I need to find a =
reliable way how to extract content out of Word, Excel and=0A> PowerPoint f=
ormats prior to indexing and I am not sure if POI is the best=0A> way to go=
. Can anybody share experience with POI and/or other [commercial]=0A> Java =
library for text extraction from MS formats?=0A> =0A> My experience with PO=
I is such that sometimes it can be a pain to get the=0A> content out of the=
 MS files properly. I also know that Nutch plugin uses POI=0A> for MS forma=
ts but as far as I remember it is not 100% reliable (my more=0A> then one y=
ear old experience is that about 1-2% of files were not parsed).=0A> =0A> M=
y requirements are that the text extraction software must run on Linux and=
=0A> should be written in Java, it can be open source or commercial library=
.=0A> =0A> Regards,=0A> Lukas=0A> =0A=0A=0A--------------------------------=
-------------------------------------=0ATo unsubscribe, e-mail: java-user-u=
nsubscribe@lucene.apache.org=0AFor additional commands, e-mail: java-user-h=
elp@lucene.apache.org=0A=0A=0A      _______________________________________=
___________________=0ASent from Yahoo! Mail.=0AA Smarter Email http://uk.do=
cs.yahoo.com/nowyoucan.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34032-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 13:23:02 2008
Return-Path: <java-user-return-34032-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85189 invoked from network); 13 May 2008 13:23:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 13:23:02 -0000
Received: (qmail 58381 invoked by uid 500); 13 May 2008 13:22:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58354 invoked by uid 500); 13 May 2008 13:22:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58343 invoked by uid 99); 13 May 2008 13:22:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 06:22:56 -0700
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [66.173.27.67] (HELO mail.nasi.com) (66.173.27.67)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 13:22:00 +0000
In-Reply-To: <805156.69412.qm@web26003.mail.ukl.yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Can POI provide reliable text extraction results for productionsearch
 engine for Word, Excel and PowerPoint formats?
MIME-Version: 1.0
X-Mailer: Lotus Notes Release 6.5.4 March 27, 2005
Message-ID: <OFE01BCEF1.9CEAD769-ON86257448.0048D7D6-86257448.00497341@nasi.com>
From: Robert.Hastings@ancept.com
Date: Tue, 13 May 2008 08:22:03 -0500
X-MIMETrack: Serialize by Router on notes1/NASI(Release 6.5.5FP1|April 11, 2006) at 05/13/2008
 08:22:27,
	Serialize complete at 05/13/2008 08:22:27
Content-Type: multipart/alternative; boundary="=_alternative 0049733E86257448_="
X-Virus-Checked: Checked by ClamAV on apache.org

--=_alternative 0049733E86257448_=
Content-Type: text/plain; charset="US-ASCII"

We are using Aspose: www.aspose.com.  We are still in pre-release, it 
works fine for all of the MS products.  It's commercial, but is a good 
deal as long as you don't have too many developers working on it, since 
the licensing is per seat.  We had a little trouble with thier PDF 
product.  The other thing is that their main product line is .NET but the 
Java line has kept up pretty well.  For text extraction the APIs are 
straight forward.





mark harwood <markharw00d@yahoo.co.uk> 
05/13/2008 07:44 AM
Please respond to
java-user@lucene.apache.org


To
java-user@lucene.apache.org
cc

Subject
Re: Can POI provide reliable text extraction results for productionsearch 
engine for Word, Excel and PowerPoint formats?






On the commercial front, Oracle's "Outside In" (previously Stellent) is 
the one that gets used in a lot of search engines.

Being a C-based product though, integration isn't quite as nice/easy as 
pure Java solutions.


----- Original Message ----
From: Bowesman Antony <adb@teamware.com>
To: java-user@lucene.apache.org
Sent: Tuesday, 13 May, 2008 8:49:00 AM
Subject: Re: Can POI provide reliable text extraction results for 
productionsearch engine for Word, Excel and PowerPoint formats?

We are using POI 3.0.2 FINAL.  Like you, it is not very reliable for many 
Word 
files.  It does not support Word 2, Fast saved files, files which are not 
padded 
to 256 bytes.  PPT and Excel are quite bad, a large % of our PPT files 
throw 
Exceptions.  Not tried 3.1 as it's just gone BETA 1, but I expect that the 
Word 
parsing is unchanged and the changelog doesn't show any Word changes.

TestMining.org http://www.textmining.org/ is quite good, but the 0.4 
version did 
not do Word 2 or Fast Saved files.  1.0 version should fix that, but I've 
not 
yet tried it.  Licene for 1.0 is LGPL, whereas 0.4 was Apache 2.

AbiWord http://www.abisource.com/ is pretty good, but it's a complete GUI 
so is 
quite slow if you want to use it for a lot of parsing.  It can do text 
extraction via the command line.  The Linux versions suports pipes. It's 
based on WvWare http://wvware.sourceforge.net/

Catdoc (http://ftp.wagner.pp.ru/~vitus/software/catdoc/) is quite 
effective, 
fast.  It also has catppt.  I'm not sure if the text order is 100% 
according to 
the original though.

The last two are not licence friendly for distribution.

I've extracted the Nutch parsing framework and am using it in our product 
and 
have tested all of the above and the priority for Word parsing is 
TextMining 
v0.4, before POI and then the other two which I plugged in via the 
parse-ext parser.

HTH
Antony





Lukas Vlcek wrote:
> Hi,
> 
> I need to find a reliable way how to extract content out of Word, Excel 
and
> PowerPoint formats prior to indexing and I am not sure if POI is the 
best
> way to go. Can anybody share experience with POI and/or other 
[commercial]
> Java library for text extraction from MS formats?
> 
> My experience with POI is such that sometimes it can be a pain to get 
the
> content out of the MS files properly. I also know that Nutch plugin uses 
POI
> for MS formats but as far as I remember it is not 100% reliable (my more
> then one year old experience is that about 1-2% of files were not 
parsed).
> 
> My requirements are that the text extraction software must run on Linux 
and
> should be written in Java, it can be open source or commercial library.
> 
> Regards,
> Lukas
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


      __________________________________________________________
Sent from Yahoo! Mail.
A Smarter Email http://uk.docs.yahoo.com/nowyoucan.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



--=_alternative 0049733E86257448_=--

From java-user-return-34033-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 13:42:39 2008
Return-Path: <java-user-return-34033-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95471 invoked from network); 13 May 2008 13:42:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 13:42:39 -0000
Received: (qmail 94143 invoked by uid 500); 13 May 2008 13:42:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94120 invoked by uid 500); 13 May 2008 13:42:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94104 invoked by uid 99); 13 May 2008 13:42:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 06:42:30 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a16.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 13:41:42 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a16.g.dreamhost.com (Postfix) with ESMTP id 70C6D7D1CE
	for <java-user@lucene.apache.org>; Tue, 13 May 2008 06:41:56 -0700 (PDT)
Message-Id: <7A9F0D7D-FC9B-41DC-8620-BA256B826ABD@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <52c3ddca0805120703k25c56c4chbc68d18a5cfacb8@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Can POI provide reliable text extraction results for production search engine for Word, Excel and PowerPoint formats?
Date: Tue, 13 May 2008 09:41:55 -0400
References: <52c3ddca0805120703k25c56c4chbc68d18a5cfacb8@mail.gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

I've used POI, as well as commercial providers.  As always, it  
depends :-)  I wasn't particularly impressed with the commercial  
providers given the amount of money they wanted for it.   PDF was  
particularly tricky, but you weren't asking about that.   At least w/  
POI, you have the opportunity to fix things that don't work based on  
your priorities.  I don't know what the failure rate is for the  
commercial providers, but my experience is they will all fail at least  
once, so you better plan on it.  I'd look to use a framework like Tika  
or Aperture, where you can easily upgrade or plug in new or different  
libraries (including commercial providers) as needed w/o rewriting  
your code.  Additionally, with something like Tika or Aperture, you  
could easily mix and match your solutions, such that you use one for  
Word and a different one for PPT or PDF.

One issue with any of them is how you plan to use them.  If you need  
more than bag of words, they all get less reliable, especially when it  
comes to PDFs and Office docs.  Dealing with things like tables,  
columns, captions, labels, etc. has always been problematic in my  
experience when one wants to do higher level processing (beyond  
keyword search).

HTH,
Grant

On May 12, 2008, at 10:03 AM, Lukas Vlcek wrote:

> Hi,
>
> I need to find a reliable way how to extract content out of Word,  
> Excel and
> PowerPoint formats prior to indexing and I am not sure if POI is the  
> best
> way to go. Can anybody share experience with POI and/or other  
> [commercial]
> Java library for text extraction from MS formats?
>
> My experience with POI is such that sometimes it can be a pain to  
> get the
> content out of the MS files properly. I also know that Nutch plugin  
> uses POI
> for MS formats but as far as I remember it is not 100% reliable (my  
> more
> then one year old experience is that about 1-2% of files were not  
> parsed).
>
> My requirements are that the text extraction software must run on  
> Linux and
> should be written in Java, it can be open source or commercial  
> library.
>
> Regards,
> Lukas
>
> -- 
> http://blog.lukas-vlcek.com/

--------------------------
Grant Ingersoll
http://lucidimagination.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34034-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 13:44:02 2008
Return-Path: <java-user-return-34034-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96104 invoked from network); 13 May 2008 13:44:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 13:44:02 -0000
Received: (qmail 516 invoked by uid 500); 13 May 2008 13:43:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 257 invoked by uid 500); 13 May 2008 13:43:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 246 invoked by uid 99); 13 May 2008 13:43:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 06:43:57 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of gshankar.sahu@gmail.com designates 209.85.142.184 as permitted sender)
Received: from [209.85.142.184] (HELO ti-out-0910.google.com) (209.85.142.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 13:43:11 +0000
Received: by ti-out-0910.google.com with SMTP id b8so1129056tic.11
        for <java-user@lucene.apache.org>; Tue, 13 May 2008 06:43:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=LFKseWyFTSanYkYXAunRT7RjmBbQK34DYPIhMgldb8A=;
        b=C+/Kiz2pu4J4OCvux0OrRwxd1jwEApZyK/YJKxTFJxgtgh9fb/P5juvUW3RAn9vs11BwNgV8rW46xw+dGgBY1t75JS8CotG86A9MACngK/podztGwXHYtu9cQB/46tvkPstWLe2FOMpp9Mw7wDIr63q0GNBu2rhLFdUrFyssHvM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=FZvn4Sd4P3KzaAVeDZfHEo/d/5qBR3dTpm0bm4PqftHtHYE5V5837Q7/nYkNmtqFwMNoMW/W0b5T1JEnTmfkngk/wYxcNtcI8X8GrBI0Y6JbFxnqxISSMh9W4gMtoUen+jek+h+2J50YM2vuQsD8AjDXYSK2CoD2ee3idhVMEqs=
Received: by 10.110.37.3 with SMTP id k3mr965190tik.29.1210686204420;
        Tue, 13 May 2008 06:43:24 -0700 (PDT)
Received: by 10.110.17.14 with HTTP; Tue, 13 May 2008 06:43:24 -0700 (PDT)
Message-ID: <979a94470805130643w6e613c15ke397bb97483f239@mail.gmail.com>
Date: Tue, 13 May 2008 19:13:24 +0530
From: "Gauri Shankar" <gshankar.sahu@gmail.com>
To: java-user@lucene.apache.org
Subject: Exact match query on a field in index which has been indexed using StandardAnalyzer
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_7423_19952607.1210686204402"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_7423_19952607.1210686204402
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,

I have a field in index which has been indexed using StandardAnalyzer and as
TOKENIZED. Now I would like to write a query which returns the hit if there
is a exact match on the field value.

Say, if field value is : Member of Technical Staff
then "member of technical staff" OR "Member of Technical Staff" should
returns this document. Note that I am writing the phrase query for matching
the query string.



-- 
Regards,
Gauri Shankar

------=_Part_7423_19952607.1210686204402--

From java-user-return-34035-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 14:02:01 2008
Return-Path: <java-user-return-34035-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3614 invoked from network); 13 May 2008 14:02:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 14:02:01 -0000
Received: (qmail 31624 invoked by uid 500); 13 May 2008 14:01:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31585 invoked by uid 500); 13 May 2008 14:01:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31574 invoked by uid 99); 13 May 2008 14:01:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 07:01:55 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 72.14.220.156 as permitted sender)
Received: from [72.14.220.156] (HELO fg-out-1718.google.com) (72.14.220.156)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 14:01:09 +0000
Received: by fg-out-1718.google.com with SMTP id l27so2504949fgb.27
        for <java-user@lucene.apache.org>; Tue, 13 May 2008 07:01:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=KC8YLuBhZPkK+Kg7ZAqH6ody6lfdalEz/YKQbHKZ3Tg=;
        b=txpQQbF3n+Ry+0nuG89VBX0k27/0Q85O+ATzkQJ6Dy4ih7j+X5Hb27o5a6zRsIKuoSarTIgpwr1WEydk4ZxlE7TxBahg/T0I2p8k5WiN7qrs1AStmrZXkO5m0XGUNlSssCMdCG2/qCpfgcBl6iNJceXl3SctY64V7FwrZDjuI68=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=jyMs11tiWKNceaET+ti7b2YQPC/DFqbJyrU4qi/e38YAJi7YySvOPiRabk1KgO+Zn7Ylsu22V38iBoG5uSefkfhgXQmPzIIpkGv7RrOMyxgF2pnkqf1kNRCMiKA3AJKLO4xFIGD/WiZ7zaK33xLCWAsGwYKY7QJ+RGIAj+Pgwrg=
Received: by 10.86.59.18 with SMTP id h18mr16562785fga.30.1210687283119;
        Tue, 13 May 2008 07:01:23 -0700 (PDT)
Received: by 10.86.59.14 with HTTP; Tue, 13 May 2008 07:01:23 -0700 (PDT)
Message-ID: <359a92830805130701y23f91470tfe1e8d2578fc466@mail.gmail.com>
Date: Tue, 13 May 2008 10:01:23 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Exact match query on a field in index which has been indexed using StandardAnalyzer
In-Reply-To: <979a94470805130643w6e613c15ke397bb97483f239@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1376_11317810.1210687283093"
References: <979a94470805130643w6e613c15ke397bb97483f239@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1376_11317810.1210687283093
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

First, why do you OR together the different cases? Assuming
you're pushing your query through StandardAnalyzer, it'll lowercase
for you (just as it did during indexing).

But to your question. Would you expect your query to match a document
with the field value "Member of Technical Staff for Accounting"? because
your phrase would match this as well.......

Not to mention stop words. "Member Technical Staff" would be equivalent to
your query, is that acceptable?

Probably the simplest way would be to index the field UN_TOKENIZED too
(perhaps normalizing it by, say, lower casing it and taking out stop words)
and search against the duplicate field with KeywordAnalyzer. Yes it'll cost
you some space but disk space is cheap <G>. How big is your index anyway?

I suppose you could also STORE the field and take any documents returned,
get the field and compare, but then stop words, casing, etc are tricky.

What is the use case you're trying to support? There may be other ways
to accomplish your goal than messing around with exact matches.

On Tue, May 13, 2008 at 9:43 AM, Gauri Shankar <gshankar.sahu@gmail.com>
wrote:

> Hi,
>
> I have a field in index which has been indexed using StandardAnalyzer and
> as
> TOKENIZED. Now I would like to write a query which returns the hit if
> there
> is a exact match on the field value.
>
> Say, if field value is : Member of Technical Staff
> then "member of technical staff" OR "Member of Technical Staff" should
> returns this document. Note that I am writing the phrase query for
> matching
> the query string.
>
>
>
> --
> Regards,
> Gauri Shankar
>

------=_Part_1376_11317810.1210687283093--

From java-user-return-34036-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 14:14:27 2008
Return-Path: <java-user-return-34036-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7976 invoked from network); 13 May 2008 14:14:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 14:14:27 -0000
Received: (qmail 49947 invoked by uid 500); 13 May 2008 14:14:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49917 invoked by uid 500); 13 May 2008 14:14:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49906 invoked by uid 99); 13 May 2008 14:14:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 07:14:21 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 14:13:25 +0000
Received: from [192.168.1.102] ([81.219.54.251])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id m4DEDsG19046
	for <java-user@lucene.apache.org>; Tue, 13 May 2008 09:13:54 -0500
Message-ID: <4829A1FB.9090800@getopt.org>
Date: Tue, 13 May 2008 16:13:15 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Can POI provide reliable text extraction results for production
 search engine for Word, Excel and PowerPoint formats?
References: <52c3ddca0805120703k25c56c4chbc68d18a5cfacb8@mail.gmail.com> <7A9F0D7D-FC9B-41DC-8620-BA256B826ABD@apache.org>
In-Reply-To: <7A9F0D7D-FC9B-41DC-8620-BA256B826ABD@apache.org>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Grant Ingersoll wrote:
> I've used POI, as well as commercial providers.  As always, it depends 
> :-)  I wasn't particularly impressed with the commercial providers given 
> the amount of money they wanted for it.   PDF was particularly tricky, 
> but you weren't asking about that.   At least w/ POI, you have the 
> opportunity to fix things that don't work based on your priorities.  I 
> don't know what the failure rate is for the commercial providers, but my 
> experience is they will all fail at least once, so you better plan on 
> it.  I'd look to use a framework like Tika or Aperture, where you can 
> easily upgrade or plug in new or different libraries (including 
> commercial providers) as needed w/o rewriting your code.  Additionally, 
> with something like Tika or Aperture, you could easily mix and match 
> your solutions, such that you use one for Word and a different one for 
> PPT or PDF.
> 
> One issue with any of them is how you plan to use them.  If you need 
> more than bag of words, they all get less reliable, especially when it 
> comes to PDFs and Office docs.  Dealing with things like tables, 
> columns, captions, labels, etc. has always been problematic in my 
> experience when one wants to do higher level processing (beyond keyword 
> search).

Yet another option ... In the past I used a licensed copy of MS Office 
to extract things that I wanted, using a bit of OLE automation and 
VBscript. Worked reasonably well, in the sense that I had no issues 
whatsoever with extracting the content _and_ formatting from any 
documents that could be normally opened with MS Office - however, 
performance was an issue, ie. it was slow, CPU/memory hog, and 
occasionally it would get stuck in a weird state when only complete 
reboot would help.


-- 
Best regards,
Andrzej Bialecki     <><
  ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34037-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 14:24:14 2008
Return-Path: <java-user-return-34037-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10758 invoked from network); 13 May 2008 14:24:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 14:24:14 -0000
Received: (qmail 68185 invoked by uid 500); 13 May 2008 14:24:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68158 invoked by uid 500); 13 May 2008 14:24:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68147 invoked by uid 99); 13 May 2008 14:24:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 07:24:08 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lukas.vlcek@gmail.com designates 209.85.198.233 as permitted sender)
Received: from [209.85.198.233] (HELO rv-out-0506.google.com) (209.85.198.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 14:23:20 +0000
Received: by rv-out-0506.google.com with SMTP id f6so2800241rvb.5
        for <java-user@lucene.apache.org>; Tue, 13 May 2008 07:23:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=RmLNuXxk4Nms008cmf/bxsE2pHmH6bZdmaRWguc3RRo=;
        b=bytImWL1UnEzaJnlewa/qy/Xh0mvQZ+BNWb8kOk+BJnM1Q/7Ab6MMS6H3L70So5yq2xmuimA7IWNVOcipKIOGXKmuxqy1oDVrF/o0/Nm0s1IJRPHjMDePSQuGJG0aMz/dNKivm7CUYOP6WhvVwThbnVYqCAEvDjj+hQAHFmYF7o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=hfdDh/FH+6NKzGTLjk95QwOIWpEtlUcRQHXfVfSb2rIbZW+4OccuOCxH/HE88YQHBnswGZ0bE+u8l/v8uaMGp7MwcZYD6jSXNA3YV5QReTsVvBoVRu3DOUXSc8f4GX/g6JuwH0MZInIAYT+uAa1yf3ZkrM6LdTtQLuv62iH8flI=
Received: by 10.141.141.3 with SMTP id t3mr4305875rvn.52.1210688615372;
        Tue, 13 May 2008 07:23:35 -0700 (PDT)
Received: by 10.141.163.6 with HTTP; Tue, 13 May 2008 07:23:35 -0700 (PDT)
Message-ID: <52c3ddca0805130723u49f777a3q5ccffd73de7d87d6@mail.gmail.com>
Date: Tue, 13 May 2008 16:23:35 +0200
From: "Lukas Vlcek" <lukas.vlcek@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Can POI provide reliable text extraction results for production search engine for Word, Excel and PowerPoint formats?
In-Reply-To: <4829A1FB.9090800@getopt.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1459_5029043.1210688615369"
References: <52c3ddca0805120703k25c56c4chbc68d18a5cfacb8@mail.gmail.com>
	 <7A9F0D7D-FC9B-41DC-8620-BA256B826ABD@apache.org>
	 <4829A1FB.9090800@getopt.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1459_5029043.1210688615369
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Does it make sense to consider using OpenOffice to convert from MS formats
to PDF or HTML before indexing. Would this yield me a lower fail rate as
opposed to pure POI approach? I don't care about formating now I care about
content in the first place. Formating would be important only in the case
that Nutch or other piece of software would be able to accommodate this
information into Lucene index (such that words in headline would yield
higher boost for example).

Couple of words about my motivation:

We released SharePoint 2007 in our company. We are not very satisfied with
its search capabilities so I started to looking for some alternatives. The
first thing I was looking at is Google Search Appliance as they claim it can
crawl, index and search SharePoint portals.

I realized that their integration with outer world is done via connector
manager which is itself an open source project written in Java and
Sharepoint connector implementation is as well released as a open source in
Java. This makes me think that I should be able to test Sharepoint connector
replacing GSA black box with Lucene,Nutch,Solr or whatever and test how well
this connector thing works. This would be a perfect test before we invest
more in GSA. On the other hand if I would be able to run the Sharepoint
connector without GSA (replaced by Lucene based product) then text
extraction from MS family formats can be the main impenetrable barrier.

Lukas

On Tue, May 13, 2008 at 4:13 PM, Andrzej Bialecki <ab@getopt.org> wrote:

> Grant Ingersoll wrote:
>
> > I've used POI, as well as commercial providers.  As always, it depends
> > :-)  I wasn't particularly impressed with the commercial providers given the
> > amount of money they wanted for it.   PDF was particularly tricky, but you
> > weren't asking about that.   At least w/ POI, you have the opportunity to
> > fix things that don't work based on your priorities.  I don't know what the
> > failure rate is for the commercial providers, but my experience is they will
> > all fail at least once, so you better plan on it.  I'd look to use a
> > framework like Tika or Aperture, where you can easily upgrade or plug in new
> > or different libraries (including commercial providers) as needed w/o
> > rewriting your code.  Additionally, with something like Tika or Aperture,
> > you could easily mix and match your solutions, such that you use one for
> > Word and a different one for PPT or PDF.
> >
> > One issue with any of them is how you plan to use them.  If you need
> > more than bag of words, they all get less reliable, especially when it comes
> > to PDFs and Office docs.  Dealing with things like tables, columns,
> > captions, labels, etc. has always been problematic in my experience when one
> > wants to do higher level processing (beyond keyword search).
> >
>
> Yet another option ... In the past I used a licensed copy of MS Office to
> extract things that I wanted, using a bit of OLE automation and VBscript.
> Worked reasonably well, in the sense that I had no issues whatsoever with
> extracting the content _and_ formatting from any documents that could be
> normally opened with MS Office - however, performance was an issue, ie. it
> was slow, CPU/memory hog, and occasionally it would get stuck in a weird
> state when only complete reboot would help.
>
>
> --
> Best regards,
> Andrzej Bialecki     <><
>  ___. ___ ___ ___ _ _   __________________________________
> [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
> ___|||__||  \|  ||  |  Embedded Unix, System Integration
> http://www.sigram.com  Contact: info at sigram dot com
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
http://blog.lukas-vlcek.com/

------=_Part_1459_5029043.1210688615369--

From java-user-return-34038-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 15:50:21 2008
Return-Path: <java-user-return-34038-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70535 invoked from network); 13 May 2008 15:50:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 15:50:21 -0000
Received: (qmail 62814 invoked by uid 500); 13 May 2008 15:50:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62639 invoked by uid 500); 13 May 2008 15:50:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62628 invoked by uid 99); 13 May 2008 15:50:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 08:50:14 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jay.oleary@gmail.com designates 64.233.170.191 as permitted sender)
Received: from [64.233.170.191] (HELO rn-out-0910.google.com) (64.233.170.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 15:49:26 +0000
Received: by rn-out-0910.google.com with SMTP id j40so634922rnf.4
        for <java-user@lucene.apache.org>; Tue, 13 May 2008 08:49:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=2Gf2oRj/f/O6rF2m995GiUWQScIrnuHpbuWWPnD0u/M=;
        b=WrJLcSd+LXc30Dnqj+6edMvq/rQioCUcnFhkrO/e7jHl2hjM9dUUePuL+1z9vKhQX0Ona7/ZDmN8KD7DoVMb5l3/pf9IQLVriRGEGs6KSb3VqlqQHqC4WMsJvx+rCBiVtrMoZAwBuGzf1Jtnh6ThxOlQoTBIYF6Yc5qDXYTQenQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=BdMNO+JzF2B/zoBIwTRaKTmMQO8qxawjHjFQlV8qSWg2H23Yy/BsyRssczZuyXR/am/U+Z7XFqWIlul+TpzqW7JdqnP93UjfRLYRLCGkQ+RTaFsSY7V0sRaHC0N3/mQrS/4n7l+grILY3bAzGVAEx62zRaPGAE+1OIxEIYGJRV4=
Received: by 10.143.162.8 with SMTP id p8mr3859152wfo.49.1210693780612;
        Tue, 13 May 2008 08:49:40 -0700 (PDT)
Received: by 10.142.135.3 with HTTP; Tue, 13 May 2008 08:49:40 -0700 (PDT)
Message-ID: <f76c6b7d0805130849l553974b4l1419b8b66ee70a09@mail.gmail.com>
Date: Tue, 13 May 2008 11:49:40 -0400
From: "Jay O'Leary" <jay.oleary@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Can POI provide reliable text extraction results for production search engine for Word, Excel and PowerPoint formats?
In-Reply-To: <52c3ddca0805130723u49f777a3q5ccffd73de7d87d6@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5985_25359453.1210693780605"
References: <52c3ddca0805120703k25c56c4chbc68d18a5cfacb8@mail.gmail.com>
	 <7A9F0D7D-FC9B-41DC-8620-BA256B826ABD@apache.org>
	 <4829A1FB.9090800@getopt.org>
	 <52c3ddca0805130723u49f777a3q5ccffd73de7d87d6@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5985_25359453.1210693780605
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

If it's windows only, you can roll your own with IFilters (
http://www.ifilter.org/).

On Tue, May 13, 2008 at 10:23 AM, Lukas Vlcek <lukas.vlcek@gmail.com> wrote:

> Does it make sense to consider using OpenOffice to convert from MS formats
> to PDF or HTML before indexing. Would this yield me a lower fail rate as
> opposed to pure POI approach? I don't care about formating now I care
> about
> content in the first place. Formating would be important only in the case
> that Nutch or other piece of software would be able to accommodate this
> information into Lucene index (such that words in headline would yield
> higher boost for example).
>
> Couple of words about my motivation:
>
> We released SharePoint 2007 in our company. We are not very satisfied with
> its search capabilities so I started to looking for some alternatives. The
> first thing I was looking at is Google Search Appliance as they claim it
> can
> crawl, index and search SharePoint portals.
>
> I realized that their integration with outer world is done via connector
> manager which is itself an open source project written in Java and
> Sharepoint connector implementation is as well released as a open source
> in
> Java. This makes me think that I should be able to test Sharepoint
> connector
> replacing GSA black box with Lucene,Nutch,Solr or whatever and test how
> well
> this connector thing works. This would be a perfect test before we invest
> more in GSA. On the other hand if I would be able to run the Sharepoint
> connector without GSA (replaced by Lucene based product) then text
> extraction from MS family formats can be the main impenetrable barrier.
>
> Lukas
>
> On Tue, May 13, 2008 at 4:13 PM, Andrzej Bialecki <ab@getopt.org> wrote:
>
> > Grant Ingersoll wrote:
> >
> > > I've used POI, as well as commercial providers.  As always, it depends
> > > :-)  I wasn't particularly impressed with the commercial providers
> given the
> > > amount of money they wanted for it.   PDF was particularly tricky, but
> you
> > > weren't asking about that.   At least w/ POI, you have the opportunity
> to
> > > fix things that don't work based on your priorities.  I don't know
> what the
> > > failure rate is for the commercial providers, but my experience is
> they will
> > > all fail at least once, so you better plan on it.  I'd look to use a
> > > framework like Tika or Aperture, where you can easily upgrade or plug
> in new
> > > or different libraries (including commercial providers) as needed w/o
> > > rewriting your code.  Additionally, with something like Tika or
> Aperture,
> > > you could easily mix and match your solutions, such that you use one
> for
> > > Word and a different one for PPT or PDF.
> > >
> > > One issue with any of them is how you plan to use them.  If you need
> > > more than bag of words, they all get less reliable, especially when it
> comes
> > > to PDFs and Office docs.  Dealing with things like tables, columns,
> > > captions, labels, etc. has always been problematic in my experience
> when one
> > > wants to do higher level processing (beyond keyword search).
> > >
> >
> > Yet another option ... In the past I used a licensed copy of MS Office
> to
> > extract things that I wanted, using a bit of OLE automation and
> VBscript.
> > Worked reasonably well, in the sense that I had no issues whatsoever
> with
> > extracting the content _and_ formatting from any documents that could be
> > normally opened with MS Office - however, performance was an issue, ie.
> it
> > was slow, CPU/memory hog, and occasionally it would get stuck in a weird
> > state when only complete reboot would help.
> >
> >
> > --
> > Best regards,
> > Andrzej Bialecki     <><
> >  ___. ___ ___ ___ _ _   __________________________________
> > [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
> > ___|||__||  \|  ||  |  Embedded Unix, System Integration
> > http://www.sigram.com  Contact: info at sigram dot com
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
>  --
> http://blog.lukas-vlcek.com/
>

------=_Part_5985_25359453.1210693780605--

From java-user-return-34039-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 16:29:20 2008
Return-Path: <java-user-return-34039-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87470 invoked from network); 13 May 2008 16:29:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 16:29:20 -0000
Received: (qmail 42073 invoked by uid 500); 13 May 2008 16:29:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42034 invoked by uid 500); 13 May 2008 16:29:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42023 invoked by uid 99); 13 May 2008 16:29:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 09:29:14 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 66.249.82.226 as permitted sender)
Received: from [66.249.82.226] (HELO wx-out-0506.google.com) (66.249.82.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 16:28:28 +0000
Received: by wx-out-0506.google.com with SMTP id h29so2291481wxd.20
        for <java-user@lucene.apache.org>; Tue, 13 May 2008 09:28:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=ncMaUs9p5jbAaIu8VlCb8bZB2lAgxxMmdoJvCwuL3oc=;
        b=yD0yGeJqQCDKPqB5GlDJHsIQmZlVnULAzNmg+tIxfYD+7+l64IRobEZcoQ+e1Y6PgyDQMwHeRU9tcNZLPBzyIYKTJ8Wl2QLyGAUhKHRHvdThcFbX0/9DBgoZYqsx4xqsNHzDamzLNoEXA5m1R6L0GF0Xc3BqkKfwEHaVwd9w6SI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=S4THC3ylFZHWoSrIRkWw76h8fzRiETjuXJ+Mf6nSNqSs50MSZXcHTw48RGSDAGRUAi76/rTIIxmcc+tQ+wuf4Gqow87pQgcx20d5I/GDglsF+7CeA9/Cdc+xTVMGE6HCwDocyium4cggu7LT3T5YuWOeHIHhBUQbka+rB49bddE=
Received: by 10.100.215.14 with SMTP id n14mr9976736ang.110.1210696122448;
        Tue, 13 May 2008 09:28:42 -0700 (PDT)
Received: by 10.100.124.16 with HTTP; Tue, 13 May 2008 09:28:42 -0700 (PDT)
Message-ID: <85d3c3b60805130928j3383c0e9r15b044ec85c59760@mail.gmail.com>
Date: Tue, 13 May 2008 12:28:42 -0400
From: "Jason Rutherglen" <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Subject: Find last term
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_11118_18969440.1210696122424"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_11118_18969440.1210696122424
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

It is easy to find the first term using TermEnum.  Is there a way to find
the last term without using StringIndex and binarysearch?  Are there plans
to offer this functionality?

------=_Part_11118_18969440.1210696122424--

From java-user-return-34040-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 16:35:16 2008
Return-Path: <java-user-return-34040-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88937 invoked from network); 13 May 2008 16:35:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 16:35:16 -0000
Received: (qmail 48715 invoked by uid 500); 13 May 2008 16:35:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48681 invoked by uid 500); 13 May 2008 16:35:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48670 invoked by uid 99); 13 May 2008 16:35:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 09:35:09 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 72.14.220.157 as permitted sender)
Received: from [72.14.220.157] (HELO fg-out-1718.google.com) (72.14.220.157)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 16:34:24 +0000
Received: by fg-out-1718.google.com with SMTP id l27so2559958fgb.27
        for <java-user@lucene.apache.org>; Tue, 13 May 2008 09:34:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=cLUdx05OGlkrxfzDxjD7wR6T7J8PaqbKcVofKJIOksA=;
        b=ZxnCft9A1A+85UoL3m2yp4TZNd2hyQc958CKj6+9125yr5Obaq+AQnO5jCf6xFHBGLn5ydRQslu7pUrch0hWP7QRatRe/iPKLi6P/cjl0tooEGyCuU7WO+mSTMrPkksh1c5sdT2hYKBYcfwnqPuyXychIIkw9QUvDdTW+NrIDQA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Qk7KvhPXJTA7WEBk0tCGx+4IbIpHvGqarBiXYDYzh55LR4l/vsgE2pKADUgxpi3yo7VQPuvRzwpizzcMkbydsGgr3r306mBT9jddGeqBSXsm0iqINzXz56U84Sd3E1JZmLQhlel/vIat6XS0If/Jj6Z8DxrxJqmr+u9I8UkwGVc=
Received: by 10.86.92.7 with SMTP id p7mr16830518fgb.72.1210696478074;
        Tue, 13 May 2008 09:34:38 -0700 (PDT)
Received: by 10.86.59.14 with HTTP; Tue, 13 May 2008 09:34:38 -0700 (PDT)
Message-ID: <359a92830805130934t4307dcabof24dacadf13ef6ae@mail.gmail.com>
Date: Tue, 13 May 2008 12:34:38 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Find last term
In-Reply-To: <85d3c3b60805130928j3383c0e9r15b044ec85c59760@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_2023_2918951.1210696478077"
References: <85d3c3b60805130928j3383c0e9r15b044ec85c59760@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_2023_2918951.1210696478077
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Find the last term of what? Document? Field in an index? Query?

Best
Erick

On Tue, May 13, 2008 at 12:28 PM, Jason Rutherglen <
jason.rutherglen@gmail.com> wrote:

> It is easy to find the first term using TermEnum.  Is there a way to find
> the last term without using StringIndex and binarysearch?  Are there plans
> to offer this functionality?
>

------=_Part_2023_2918951.1210696478077--

From java-user-return-34041-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 16:48:35 2008
Return-Path: <java-user-return-34041-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94412 invoked from network); 13 May 2008 16:48:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 16:48:34 -0000
Received: (qmail 69581 invoked by uid 500); 13 May 2008 16:48:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69265 invoked by uid 500); 13 May 2008 16:48:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69254 invoked by uid 99); 13 May 2008 16:48:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 09:48:29 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.198.238 as permitted sender)
Received: from [209.85.198.238] (HELO rv-out-0506.google.com) (209.85.198.238)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 16:47:43 +0000
Received: by rv-out-0506.google.com with SMTP id f6so2866355rvb.5
        for <java-user@lucene.apache.org>; Tue, 13 May 2008 09:47:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=/wtNIhuHNUETgeY7UdFAQzW/BqdBT4XHSHx04crYzf4=;
        b=LSBSe21t150EjMd+9BJIWuBpISyRWZUT88uEB/XNPqjujB8BiIMyQQKRZ3tcwPhAmtA44glrFsrAlIsWOQ9ICswRjyNd8mSSX0vC+RT1v7ARA+TrAiOyJ0CDeNaz7xlwZjhlvs65MMCXipAo0VVv3uf8pOKvAlh3TnY/awFWms4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=B3KA9Gj6mK9kAd0nfEel2Vlx+sqm2PRbwD/w+zl1StfzwQDbDq3mbF6xNllA/berC8jFakUxqrmomv5P9a0y0ta5KUWfjxvTKMmIhnZfwsmCcIJszef0bWdM9RrsWRXrEDOjsIQgDKdIho+rHMNTg0/id/hZaEUkTtiUv/E5Wxc=
Received: by 10.140.164.1 with SMTP id m1mr4372271rve.266.1210697277746;
        Tue, 13 May 2008 09:47:57 -0700 (PDT)
Received: by 10.141.156.17 with HTTP; Tue, 13 May 2008 09:47:57 -0700 (PDT)
Message-ID: <85d3c3b60805130947v9caa57fq200e8543d8b74746@mail.gmail.com>
Date: Tue, 13 May 2008 12:47:57 -0400
From: "Jason Rutherglen" <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Find last term
In-Reply-To: <359a92830805130934t4307dcabof24dacadf13ef6ae@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1305_2919255.1210697277734"
References: <85d3c3b60805130928j3383c0e9r15b044ec85c59760@mail.gmail.com>
	 <359a92830805130934t4307dcabof24dacadf13ef6ae@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1305_2919255.1210697277734
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Last term, field, TermEnum

On Tue, May 13, 2008 at 12:34 PM, Erick Erickson <erickerickson@gmail.com>
wrote:

> Find the last term of what? Document? Field in an index? Query?
>
> Best
> Erick
>
> On Tue, May 13, 2008 at 12:28 PM, Jason Rutherglen <
> jason.rutherglen@gmail.com> wrote:
>
> > It is easy to find the first term using TermEnum.  Is there a way to
> find
> > the last term without using StringIndex and binarysearch?  Are there
> plans
> > to offer this functionality?
> >
>

------=_Part_1305_2919255.1210697277734--

From java-user-return-34042-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 18:56:58 2008
Return-Path: <java-user-return-34042-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63691 invoked from network); 13 May 2008 18:56:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 18:56:58 -0000
Received: (qmail 13376 invoked by uid 500); 13 May 2008 18:56:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13340 invoked by uid 500); 13 May 2008 18:56:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13329 invoked by uid 99); 13 May 2008 18:56:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 11:56:51 -0700
X-ASF-Spam-Status: No, hits=2.4 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of stuhood@mailtrust.com designates 207.97.245.171 as permitted sender)
Received: from [207.97.245.171] (HELO smtp171.iad.emailsrvr.com) (207.97.245.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 18:55:55 +0000
Received: from relay7.relay.iad.mlsrvr.com (localhost [127.0.0.1])
	by relay7.relay.iad.mlsrvr.com (SMTP Server) with ESMTP id 9B8301B4F27
	for <java-user@lucene.apache.org>; Tue, 13 May 2008 14:56:16 -0400 (EDT)
Received: from webmail17.webmail.iad.mlsrvr.com (webmail17.webmail.iad.mlsrvr.com [192.168.1.16])
	by relay7.relay.iad.mlsrvr.com (SMTP Server) with ESMTP id 92B891B4EF1
	for <java-user@lucene.apache.org>; Tue, 13 May 2008 14:56:16 -0400 (EDT)
Received: from mailtrust.com (localhost [127.0.0.1])
	by webmail17.webmail.iad.mlsrvr.com (Postfix) with ESMTP id 81DB24C8063
	for <java-user@lucene.apache.org>; Tue, 13 May 2008 14:56:16 -0400 (EDT)
Received: by beta.mailtrust.com
    (Authenticated sender: stuhood@mailtrust.com, from: stuhood@mailtrust.com) 
    with HTTP; Tue, 13 May 2008 14:56:16 -0400 (EDT)
Date: Tue, 13 May 2008 14:56:16 -0400 (EDT)
Subject: "Off By One": CorruptIndexException
From: "Stu Hood" <stuhood@mailtrust.com>
To: java-user@lucene.apache.org
Reply-To: stuhood@mailtrust.com
MIME-Version: 1.0
Content-Type: text/plain;charset=UTF-8
Content-Transfer-Encoding: quoted-printable
Importance: Normal
X-Priority: 3 (Normal)
X-Type: plain
Message-ID: <42208.192.168.1.71.1210704976.webmail@192.168.1.71>
X-Mailer: webmail6.6.1
X-Virus-Checked: Checked by ClamAV on apache.org

Hey gang,=0A=0AI think we've been suffering from the following bug, and I h=
ave a question about the JVM fix.=0A=0Ahttp://markmail.org/message/di3vdyfq=
5odfbai6=0A=0AWe're running 1.6.0_05 and Lucene 2.3.2.=0A=0ASupposedly down=
grading to 1.6.0_02 will fix the issue, but I'd much rather upgrade if poss=
ible. 1.6.0_06 is out, and I was wondering if anyone had tested it with Luc=
ene 2.3.2?=0A=0AThanks,=0A=0AStu Hood=0AArchitecture Software Developer=0AM=
ailtrust, a Division of Rackspace


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34043-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 13 23:32:25 2008
Return-Path: <java-user-return-34043-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91766 invoked from network); 13 May 2008 23:32:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 May 2008 23:32:25 -0000
Received: (qmail 84168 invoked by uid 500); 13 May 2008 23:32:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84045 invoked by uid 500); 13 May 2008 23:32:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84034 invoked by uid 99); 13 May 2008 23:32:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 16:32:19 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [203.217.22.128] (HELO file1.syd.nuix.com.au) (203.217.22.128)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 23:31:33 +0000
Received: from host68.syd.nuix.com.au (host68.syd.nuix.com.au [192.168.222.68])
	by file1.syd.nuix.com.au (Postfix) with ESMTP id 388624A8173
	for <java-user@lucene.apache.org>; Wed, 14 May 2008 09:32:57 +1000 (EST)
From: Daniel Noll <daniel@nuix.com>
Organization: Nuix Pty Ltd
To: java-user@lucene.apache.org
Subject: Re: Search for long titles - wildcard queries
Date: Wed, 14 May 2008 09:28:52 +1000
User-Agent: KMail/1.9.6 (enterprise 0.20070907.709405)
References: <742076.6426.qm@web26503.mail.ukl.yahoo.com>
In-Reply-To: <742076.6426.qm@web26503.mail.ukl.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805140928.52543.daniel@nuix.com>
X-Virus-Checked: Checked by ClamAV on apache.org

On Saturday 10 May 2008 20:32:42 legrand thomas wrote:
>   I think I cannot use the WildcardQuery because the term shouldn't start
> with "*" of "?". Should I use a QueryParser ? How can I do it ?

WildcardQuery does permit a wildcard at the front, it's just much slower.

Also, QueryParser allows wildcards at the front, but you have to 
setAllowLeadingWildcard(true).  At the end of the day it's still creating a 
WildcardQuery though.

Daniel

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34044-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 05:15:23 2008
Return-Path: <java-user-return-34044-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38716 invoked from network); 14 May 2008 05:15:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 05:15:22 -0000
Received: (qmail 78681 invoked by uid 500); 14 May 2008 05:15:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78412 invoked by uid 500); 14 May 2008 05:15:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78401 invoked by uid 99); 14 May 2008 05:15:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 22:15:16 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of gshankar.sahu@gmail.com designates 209.85.142.185 as permitted sender)
Received: from [209.85.142.185] (HELO ti-out-0910.google.com) (209.85.142.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 05:14:30 +0000
Received: by ti-out-0910.google.com with SMTP id b8so1300319tic.11
        for <java-user@lucene.apache.org>; Tue, 13 May 2008 22:14:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=/7SUrhpCNJNcfsm849/HHM4JuCkLV82gHZlkystiBkE=;
        b=JBr8lB3F5XwoUJ1ZJY+QJtkSIShL74CuxaUnsJt97XYVtYWPvOZ9La20XZUGI80AP+Fkcxh755iRSsugqviTNED0KfscpsXdcpb1QP9SFqsIqNTBV9mOMPJWNK4YoyGax2eHaQGId5iOU1U3pv3H3st0bS/nWBKDbCxrSPPF0HQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=N1haMpI07UUREKjoGc+u4VcJr3y7f2OmUTwecUOtFtXbPb7tK5nOUUYADLw6vlCtbyMWrFKXgFLNxP39/JAU/xQ7DfecXjvfumb6NZ92H/V/8Xw8pCMhQ6ePu21mwSk0EpSCYMtOyeQkiik4OcuwrnzbRH21aCqXdHd4PPSIH98=
Received: by 10.110.46.14 with SMTP id t14mr72184tit.28.1210742083020;
        Tue, 13 May 2008 22:14:43 -0700 (PDT)
Received: by 10.110.17.14 with HTTP; Tue, 13 May 2008 22:14:43 -0700 (PDT)
Message-ID: <979a94470805132214x475626e4ycb6e55f2cd1179a2@mail.gmail.com>
Date: Wed, 14 May 2008 10:44:43 +0530
From: "Gauri Shankar" <gshankar.sahu@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Exact match query on a field in index which has been indexed using StandardAnalyzer
In-Reply-To: <359a92830805130701y23f91470tfe1e8d2578fc466@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_14253_17421271.1210742083033"
References: <979a94470805130643w6e613c15ke397bb97483f239@mail.gmail.com>
	 <359a92830805130701y23f91470tfe1e8d2578fc466@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_14253_17421271.1210742083033
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Thanks Erick...

My index size is  ~2 GB. Is it a good idea to keep another duplicate field
as UN_TOKENIZED and search using KeywordAnalyzer?

Few points:
1. when I say exact match then I mean the exact phrase match only. That
implies the query should not match a document with the field value "Member
of Technical Staff for Accounting".

2. stopwords are fine. So "Member Technical Staff" would be equivalent to
  my query, and is acceptable.

Thanks,
Gauri

On Tue, May 13, 2008 at 7:31 PM, Erick Erickson <erickerickson@gmail.com>
wrote:

> First, why do you OR together the different cases? Assuming
> you're pushing your query through StandardAnalyzer, it'll lowercase
> for you (just as it did during indexing).
>
> But to your question. Would you expect your query to match a document
> with the field value "Member of Technical Staff for Accounting"? because
> your phrase would match this as well.......
>
> Not to mention stop words. "Member Technical Staff" would be equivalent to
> your query, is that acceptable?
>
> Probably the simplest way would be to index the field UN_TOKENIZED too
> (perhaps normalizing it by, say, lower casing it and taking out stop
> words)
> and search against the duplicate field with KeywordAnalyzer. Yes it'll
> cost
> you some space but disk space is cheap <G>. How big is your index anyway?
>
> I suppose you could also STORE the field and take any documents returned,
> get the field and compare, but then stop words, casing, etc are tricky.
>
> What is the use case you're trying to support? There may be other ways
> to accomplish your goal than messing around with exact matches.
>
> On Tue, May 13, 2008 at 9:43 AM, Gauri Shankar <gshankar.sahu@gmail.com>
> wrote:
>
> > Hi,
> >
> > I have a field in index which has been indexed using StandardAnalyzer
> and
> > as
> > TOKENIZED. Now I would like to write a query which returns the hit if
> > there
> > is a exact match on the field value.
> >
> > Say, if field value is : Member of Technical Staff
> > then "member of technical staff" OR "Member of Technical Staff" should
> > returns this document. Note that I am writing the phrase query for
> > matching
> > the query string.
> >
> >
> >
> > --
> > Regards,
> > Gauri Shankar
> >
>



-- 
Regards,
Gauri Shankar

------=_Part_14253_17421271.1210742083033--

From java-user-return-34045-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 06:39:05 2008
Return-Path: <java-user-return-34045-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88097 invoked from network); 14 May 2008 06:39:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 06:39:04 -0000
Received: (qmail 38002 invoked by uid 500); 14 May 2008 06:38:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37956 invoked by uid 500); 14 May 2008 06:38:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37945 invoked by uid 99); 14 May 2008 06:38:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 May 2008 23:38:56 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephane.nicoll@gmail.com designates 209.85.132.244 as permitted sender)
Received: from [209.85.132.244] (HELO an-out-0708.google.com) (209.85.132.244)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 06:38:11 +0000
Received: by an-out-0708.google.com with SMTP id c37so696799anc.49
        for <java-user@lucene.apache.org>; Tue, 13 May 2008 23:38:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=f24O4owizFzrJrO5SHK1ioGexJl92Wkrjmxc0MP+gl8=;
        b=u0YCd3miY/7YooWYKHEk3b3JYmlyElQ9ZIekjDWmprCxJL8qg5z6ZOmbqxg/1tDCVfkaz9y5Ac/S083iCNSTFV6MHQnH7Mt+0snn1/++s4ViS1NTEHXSA+cZgk/JB//qFL17CSCnXzVf2s7+eI/vICo8RUQWNd9S/Q2+S53g4do=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=Y58Aw1HdEEvQvh6RqUgcy/XZAYRYpQuttjwBz79pfe/wWDN8ghqvGJSJv0NQqwpw4x6OJ6RZrNmGx0YhC8Ihuc1bh4vutBJwNzG8TUHNr6zv6pYz4226WkSw1fu22JEeL8mwwn7eSKKyeXZUIVahUOTflFfjIBISafFUOB44rv4=
Received: by 10.100.213.4 with SMTP id l4mr719950ang.53.1210747105414;
        Tue, 13 May 2008 23:38:25 -0700 (PDT)
Received: by 10.100.178.12 with HTTP; Tue, 13 May 2008 23:38:25 -0700 (PDT)
Message-ID: <541f12ca0805132338t7e4819ebw27f4211371e49d28@mail.gmail.com>
Date: Wed, 14 May 2008 08:38:25 +0200
From: "Stephane Nicoll" <stephane.nicoll@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: confused about an entry in the FAQ
In-Reply-To: <541f12ca0805120313y302ece2cu374d25e378bc45e2@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <541f12ca0805100635sf9629abs4cb9b8c0f41f6a79@mail.gmail.com>
	 <48b038c60805101105q767968a2sc9de677130100742@mail.gmail.com>
	 <541f12ca0805120313y302ece2cu374d25e378bc45e2@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

ping. Sorry for the long email but I prefer to provide all information firs=
t.

On Mon, May 12, 2008 at 12:13 PM, Stephane Nicoll
<stephane.nicoll@gmail.com> wrote:
> I tried all this and I am confused about the result. I am trying to
>  implement an hybrid query handler where I fetch the IDs from a
>  database criteria and the IDs from a full text lucene query and I
>  intersect them to return the result to the user. The database query
>  and the intersection works fine even with high load. However the
>  lucene query is much slower when the number of concurrent users
>  raises.
>
>  Here is what I am doing on the lucene side
>
>         final QueryParser queryParser =3D new
>  QueryParser(criteria.getDefaultField(), analyzer);
>         final Query q =3D queryParser.parse(criteria.getFullTextQuery());
>         // Index Searcher is shared for all threads and is not
>  reopened during the load test
>         final IndexSearcher indexSearcher =3D getIndexSearcher();
>         final Set<Long> result =3D new TreeSet<Long>();
>         indexSearcher.search(q, new HitCollector() {
>             public void collect(int i, float v) {
>                 try {
>                     final Document d =3D
>  indexSearcher.getIndexReader().document(i, new FieldSelector() {
>                         public FieldSelectorResult accept(String s) {
>                             if (s.equals(CatalogItem.ATTR_ID)) {
>                                 return FieldSelectorResult.LOAD;
>                             } else {
>                                 return FieldSelectorResult.NO_LOAD;
>                             }
>                         }
>                     });
>                     result.add(Long.parseLong(d.get(CatalogItem.ATTR_ID))=
);
>                 } catch (IOException e) {
>                     throw new RuntimeException("Could not collect
>  lucene IDs", e);
>                 }
>             }
>         });
>         return result;
>
>
>  When running with one thread, I have the following figures per test:
>
>  Database query is done in[125 msecs] (size=3D598]
>  Lucene query is done in[80 msecs (size=3D15204]
>  Intersect is done in[4 msecs] (size=3D103]
>  Hybrid query is done in[97 msecs]
>
>  -> 327 msec / user
>
>  When running with ten threads, I have the following figures per user per=
 test:
>
>  Database query is done in[222 msecs] (size=3D94]
>  Lucene query is done in[2364 msecs (size=3D15367]
>  Intersect is done in[0 msecs] (size=3D12]
>  Hybrid query is done in[18 msecs]
>
>  -> 2.5 sec / user !!
>
>  I am just wondering how I can improve this. Clearly there is something
>  wrong in my code since it's much slower with multiple threads running
>  concurrently on the same index. The size of the index is 5Mb, I only
>  store:
>
>  * an "id" field (which is the primary key of the related object in the d=
b
>  * a "class" field which is the class nazme of the related object
>  (Hibernate search does that for me)
>
>  The "keywords" field is indexed but not stored as it is a
>  representation of other data stored in the db. The searches are
>  performed on the keywords field only ("foo AND bar" is a typical
>  query)
>
>  Any help is appreciated. If you also know a Spring bean that could
>  take care of opening/closing the index readers properly, let me know.
>  Hibernate Search introduces deadlock with multiple threads and the
>  lucene integration in spring modules does not seeem to do what I want.
>
>  Thanks,
>  St=E9phane
>
>
>
>
>  On Sat, May 10, 2008 at 8:05 PM, Patrick Turcotte <patrek@gmail.com> wro=
te:
>  > Did you try the IndexSearcher.doc(int i, FieldSelector fieldSelector) =
 method?
>  >
>  >  Could be faster because Lucene don't have do "prepare" the whole docu=
ment.
>  >
>  >  Patrick
>  >
>  >
>  >  On Sat, May 10, 2008 at 9:35 AM, Stephane Nicoll
>  >  <stephane.nicoll@gmail.com> wrote:
>  >
>  >
>  > > From the FAQ:
>  >  >
>  >  > "Don't iterate over more hits than needed.
>  >  > Iterating over all hits is slow for two reasons. Firstly, the searc=
h()
>  >  > method that returns a Hits object re-executes the search internally
>  >  > when you need more than 100 hits. Solution: use the search method t=
hat
>  >  > takes a HitCollector instead."
>  >  >
>  >  > I had a look to HitCollector but it returns the documentId and the
>  >  > javadoc recommends not fetching the original query there.
>  >  >
>  >  > I have to return *one* indexed field from the query result and
>  >  > currently I am iterating on all results and it's slow. Can you expl=
ain
>  >  > a bit more how I could improve this?
>  >  >
>  >  > Thanks,
>  >  > St=E9phane
>  >  >
>  >  >
>  >  > --
>  >  > Large Systems Suck: This rule is 100% transitive. If you build one,
>  >  > you suck" -- S.Yegge
>  >  >
>  >
>  > > --------------------------------------------------------------------=
-
>  >  > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  >
>  > > For additional commands, e-mail: java-user-help@lucene.apache.org
>  >  >
>  >  >
>  >
>  >
>  > ---------------------------------------------------------------------
>  >  To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>  >
>  >
>  > For additional commands, e-mail: java-user-help@lucene.apache.org
>  >
>  >
>
>
>
>  --
>
>
> Large Systems Suck: This rule is 100% transitive. If you build one,
>  you suck" -- S.Yegge
>



--=20
Large Systems Suck: This rule is 100% transitive. If you build one,
you suck" -- S.Yegge

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34046-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 09:32:33 2008
Return-Path: <java-user-return-34046-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98346 invoked from network); 14 May 2008 09:32:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 09:32:32 -0000
Received: (qmail 22536 invoked by uid 500); 14 May 2008 09:32:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22514 invoked by uid 500); 14 May 2008 09:32:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22503 invoked by uid 99); 14 May 2008 09:32:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 02:32:26 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cambazz@gmail.com designates 209.85.198.224 as permitted sender)
Received: from [209.85.198.224] (HELO rv-out-0506.google.com) (209.85.198.224)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 09:31:40 +0000
Received: by rv-out-0506.google.com with SMTP id f6so3210491rvb.5
        for <java-user@lucene.apache.org>; Wed, 14 May 2008 02:31:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=c55gz5GFTuyrC/iup1t4PDZq3tu3T7xqEFB7XplxB2o=;
        b=mOcPJFQ58LKnSAmRFpIETpTzcz5+u89ezPCLapapyzKTo9HZy+u6bHv3POcoBrnE8Be+i6QNFrEf2eyGa6IPHblci8Pq806/b0ULpkcrj7xMP+Ic/B1tZ5IgOyIwlcEXYox4hFdeK1QyRZ9SXcS73w9sXI1NrmX/Ofe1AMDdwOU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=UeQnTiaoTxi4+R1f5o2jboLCrHbBSs5s3+nG1KtPZrjJiIaTTdlkhb/+w4cMt0Fqp6HbJk9/VTRWg69HrZ4ieT7E4DVjnb0vuMOQ3JxQVIRXbe2i7YV10yf56LJmwqxAgk2qNPNdLlF2rp583TlAI+xl6/6oFxryoZdQacYi8E4=
Received: by 10.140.126.10 with SMTP id y10mr367591rvc.214.1210757516043;
        Wed, 14 May 2008 02:31:56 -0700 (PDT)
Received: by 10.141.164.2 with HTTP; Wed, 14 May 2008 02:31:55 -0700 (PDT)
Message-ID: <1bcb7c7f0805140231j6bb6c1dn323794cd739bfd00@mail.gmail.com>
Date: Wed, 14 May 2008 12:31:55 +0300
From: "Cam Bazz" <cambazz@gmail.com>
To: java-user@lucene.apache.org
Subject: text extraction from pdf
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_6988_14337894.1210757516033"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_6988_14337894.1210757516033
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hello All,

Any suggestions for extracting text from PDF? I have tried pdfbox, but it
works nice, however if the pdf is structured, it wont provide good results.
For example consider the pdf:


P1 Lorem Ipsum Bla bla                                      P3 Lorem2 Ipsum2
P1 bla bla

P2 bla bla bla
P2 bla bla bla



above P1,2 and 3 are meaningful paragraphs or fields. The pdfbox will
convert

P1 Lorem Ipsim Bla bla P3 Lorem2 Ipsum2
P1 bla bla

which is not useful to me.

the unix program pdf2text can convert keeping the text places, but I wanted
to ask you guys if you know something better,

Best,
-C.B.

------=_Part_6988_14337894.1210757516033--

From java-user-return-34047-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 11:35:53 2008
Return-Path: <java-user-return-34047-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79186 invoked from network); 14 May 2008 11:35:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 11:35:53 -0000
Received: (qmail 89473 invoked by uid 500); 14 May 2008 11:35:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89446 invoked by uid 500); 14 May 2008 11:35:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89435 invoked by uid 99); 14 May 2008 11:35:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 04:35:46 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [69.44.16.11] (HELO getopt.org) (69.44.16.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 11:34:58 +0000
Received: from [10.116.49.48] (inet20908ni-0.eranet.pl [213.158.196.112])
	(authenticated)
	by getopt.org (8.11.6/8.11.6) with ESMTP id m4EBZDV27196
	for <java-user@lucene.apache.org>; Wed, 14 May 2008 06:35:14 -0500
Message-ID: <482ACE49.9030507@getopt.org>
Date: Wed, 14 May 2008 13:34:33 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: text extraction from pdf
References: <1bcb7c7f0805140231j6bb6c1dn323794cd739bfd00@mail.gmail.com>
In-Reply-To: <1bcb7c7f0805140231j6bb6c1dn323794cd739bfd00@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Cam Bazz wrote:
> Hello All,
> 
> Any suggestions for extracting text from PDF? I have tried pdfbox, but it
> works nice, however if the pdf is structured, it wont provide good results.
> For example consider the pdf:
> 
> 
> P1 Lorem Ipsum Bla bla                                      P3 Lorem2 Ipsum2
> P1 bla bla
> 
> P2 bla bla bla
> P2 bla bla bla
> 
> 
> 
> above P1,2 and 3 are meaningful paragraphs or fields. The pdfbox will
> convert
> 
> P1 Lorem Ipsim Bla bla P3 Lorem2 Ipsum2
> P1 bla bla
> 
> which is not useful to me.
> 
> the unix program pdf2text can convert keeping the text places, but I wanted
> to ask you guys if you know something better,

AFAIK, PDFBox has a lower-level API that allows you to get hold of text 
positions.



-- 
Best regards,
Andrzej Bialecki     <><
  ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34048-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 13:10:03 2008
Return-Path: <java-user-return-34048-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32887 invoked from network); 14 May 2008 13:10:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 13:10:03 -0000
Received: (qmail 44170 invoked by uid 500); 14 May 2008 13:09:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44149 invoked by uid 500); 14 May 2008 13:09:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44138 invoked by uid 99); 14 May 2008 13:09:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 06:09:57 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 209.85.146.183 as permitted sender)
Received: from [209.85.146.183] (HELO wa-out-1112.google.com) (209.85.146.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 13:09:09 +0000
Received: by wa-out-1112.google.com with SMTP id l24so4466693waf.11
        for <java-user@lucene.apache.org>; Wed, 14 May 2008 06:09:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=HMN7DkKj/sQpAbYOYwdDK4yFfqsetndmvzvimGSc500=;
        b=davYzuh56fqKzNZxtcXgsziwE1vwtPnJn75VCxtUYFgBgKWtg558KnZfVVKaiHUk7O/s+4keC0JEmxMVnySe1GvF5xaiJRaspUmFmBOrbafukvGBTPjvY7y/AnZmKeBUhmWsiAEx6LTWmT6eCVbhRjnZDk/zN/BLA/aBBKKlE+c=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=ZZJY3LAO5nyOUzG3IdqX7CIhzF2dnZVXLhbC/wCLx0M9Ty8LinjaQXqHp/msDMhvfVIUOR1lLVXuKcFscQRQ1sBVcM9KZQYr+dWUPtLG694GSkndqqFAuXFFG1wGQOH3ayHYQrKi5LgMOxDvVpudKW2GIuamXhQzGZ3PzPJ2F4Y=
Received: by 10.114.156.1 with SMTP id d1mr1042795wae.120.1210770564412;
        Wed, 14 May 2008 06:09:24 -0700 (PDT)
Received: by 10.114.210.1 with HTTP; Wed, 14 May 2008 06:09:24 -0700 (PDT)
Message-ID: <8c4e68610805140609j6127e3b6t6f6f70f865b8a6be@mail.gmail.com>
Date: Wed, 14 May 2008 14:09:24 +0100
From: "Ian Lea" <ian.lea@gmail.com>
To: java-user@lucene.apache.org, stuhood@mailtrust.com
Subject: Re: "Off By One": CorruptIndexException
In-Reply-To: <42208.192.168.1.71.1210704976.webmail@192.168.1.71>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <42208.192.168.1.71.1210704976.webmail@192.168.1.71>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi


My job (http://lucene.markmail.org/message/awkkunr7j24nh4qj) still
fails with java version 1.6.0_06 (build 1.6.0_06-b02), downloaded
today, with both lucene 2.3.1 and 2.3.2.

For me, downgrading to 1.6.0_03-b05 fixed things.


--
Ian.


On Tue, May 13, 2008 at 7:56 PM, Stu Hood <stuhood@mailtrust.com> wrote:
> Hey gang,
>
>  I think we've been suffering from the following bug, and I have a question about the JVM fix.
>
>  http://markmail.org/message/di3vdyfq5odfbai6
>
>  We're running 1.6.0_05 and Lucene 2.3.2.
>
>  Supposedly downgrading to 1.6.0_02 will fix the issue, but I'd much rather upgrade if possible. 1.6.0_06 is out, and I was wondering if anyone had tested it with Lucene 2.3.2?
>
>  Thanks,
>
>  Stu Hood
>  Architecture Software Developer
>  Mailtrust, a Division of Rackspace

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34049-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 13:59:11 2008
Return-Path: <java-user-return-34049-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73636 invoked from network); 14 May 2008 13:59:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 13:59:11 -0000
Received: (qmail 42603 invoked by uid 500); 14 May 2008 13:59:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42576 invoked by uid 500); 14 May 2008 13:59:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42565 invoked by uid 99); 14 May 2008 13:59:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 06:59:05 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [74.125.46.31] (HELO yw-out-2324.google.com) (74.125.46.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 13:58:16 +0000
Received: by yw-out-2324.google.com with SMTP id 3so1897036ywj.5
        for <java-user@lucene.apache.org>; Wed, 14 May 2008 06:58:30 -0700 (PDT)
Received: by 10.150.83.22 with SMTP id g22mr993779ybb.140.1210773510128;
        Wed, 14 May 2008 06:58:30 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 66sm1940497wra.15.2008.05.14.06.58.29
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 14 May 2008 06:58:29 -0700 (PDT)
In-Reply-To: <8c4e68610805140609j6127e3b6t6f6f70f865b8a6be@mail.gmail.com>
References: <42208.192.168.1.71.1210704976.webmail@192.168.1.71> <8c4e68610805140609j6127e3b6t6f6f70f865b8a6be@mail.gmail.com>
Mime-Version: 1.0 (Apple Message framework v753)
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <240861EF-06C3-43FB-A453-9F4464AA9924@mikemccandless.com>
Cc: stuhood@mailtrust.com
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: "Off By One": CorruptIndexException
Date: Wed, 14 May 2008 09:58:29 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


OK thanks for the update.  It's another datapoint, and it tells us  
_06 doesn't fix it.  I'll add it to the Jira issue.

Mike

Ian Lea wrote:
> Hi
>
>
> My job (http://lucene.markmail.org/message/awkkunr7j24nh4qj) still
> fails with java version 1.6.0_06 (build 1.6.0_06-b02), downloaded
> today, with both lucene 2.3.1 and 2.3.2.
>
> For me, downgrading to 1.6.0_03-b05 fixed things.
>
>
> --
> Ian.
>
>
> On Tue, May 13, 2008 at 7:56 PM, Stu Hood <stuhood@mailtrust.com>  
> wrote:
>> Hey gang,
>>
>>  I think we've been suffering from the following bug, and I have a  
>> question about the JVM fix.
>>
>>  http://markmail.org/message/di3vdyfq5odfbai6
>>
>>  We're running 1.6.0_05 and Lucene 2.3.2.
>>
>>  Supposedly downgrading to 1.6.0_02 will fix the issue, but I'd  
>> much rather upgrade if possible. 1.6.0_06 is out, and I was  
>> wondering if anyone had tested it with Lucene 2.3.2?
>>
>>  Thanks,
>>
>>  Stu Hood
>>  Architecture Software Developer
>>  Mailtrust, a Division of Rackspace
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34050-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 14:43:23 2008
Return-Path: <java-user-return-34050-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9232 invoked from network); 14 May 2008 14:43:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 14:43:23 -0000
Received: (qmail 56828 invoked by uid 500); 14 May 2008 14:43:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56792 invoked by uid 500); 14 May 2008 14:43:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56781 invoked by uid 99); 14 May 2008 14:43:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 07:43:16 -0700
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [193.111.201.130] (HELO lon-mail-4.gradwell.net) (193.111.201.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 14:42:30 +0000
Received: from dsl-217-155-211-14.zen.co.uk ([217.155.211.14] helo=dantoppro.local country=GB ident=postmaster#pop3$hardiker^co$uk)
          by lon-mail-4.gradwell.net with esmtpa (Gradwell gwh-smtpd 1.290) id 482afa61.4fa3.b6
          for java-user@lucene.apache.org; Wed, 14 May 2008 15:42:41 +0100
          (envelope-sender <dhardiker@adaptavist.com>)
Message-ID: <482AFA5E.6010500@adaptavist.com>
Date: Wed, 14 May 2008 15:42:38 +0100
From: Dan Hardiker <dhardiker@adaptavist.com>
Organization: Adaptavist.com Ltd
User-Agent: Thunderbird 2.0.0.9 (Macintosh/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Numerical Range Query
References: <482880EC.5070305@adaptavist.com>	 <359a92830805121115kb4e4ac5xd728303a95cfabe5@mail.gmail.com>	 <4828989D.4040606@adaptavist.com> <359a92830805121333r1bc887afx6d8b85d7333e896f@mail.gmail.com>
In-Reply-To: <359a92830805121333r1bc887afx6d8b85d7333e896f@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Erick Erickson wrote:
> Are you using NumberTools both at index and query time? Because
> this works exactly as I expect....

Yes, the code I posted showed the usage of NumberTools -- here it is 
from my 2nd reply:

>> Taking your advice I'm now indexing using:
>>
>> document.add( new Field(RateUtils.SF_FILTERED_CNT,
>> NumberTools.longToString( filteredCount ), Field.Store.YES,
>> Field.Index.UN_TOKENIZED) );
>>
>> and searching using:
>>
>> I'm now
>> int minRates = Long.valueOf( minRatesString ).intValue();
>> luceneQuery.add( new ConstantScoreRangeQuery( RateUtils.SF_FILTERED_CNT,
>> NumberTools.longToString(minRates), "", true, false ),
>> BooleanClause.Occur.MUST );

I'll take your code and use it to create a comparative index which I can 
use Luke to see where the differences are.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34051-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 15:30:57 2008
Return-Path: <java-user-return-34051-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71236 invoked from network); 14 May 2008 15:30:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 15:30:57 -0000
Received: (qmail 66927 invoked by uid 500); 14 May 2008 15:30:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66884 invoked by uid 500); 14 May 2008 15:30:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66873 invoked by uid 99); 14 May 2008 15:30:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 08:30:51 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.184 as permitted sender)
Received: from [209.85.134.184] (HELO mu-out-0910.google.com) (209.85.134.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 15:30:06 +0000
Received: by mu-out-0910.google.com with SMTP id g7so1790356muf.5
        for <java-user@lucene.apache.org>; Wed, 14 May 2008 08:30:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=ElZQCGeGUBfCS7whiJfcLbhxIYPHaaPGBCz906/6dUU=;
        b=sA5t59N4XCpXBMLYrrxW7P0RRi7ZLw5tlY47ApRBmMI4gU9O6xWyeFsdjPsA5fHv6LPLP3EW+/xpeGa6buQZZSOlY6Ni3REqoGXGIl9wGtOaF9uVy+WNdeF3iuns8yb+y7WhvGiQfZYzeG2hzQXwNkLJUBfMByIxFtvY1tdpQNg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=pfUbgtn9zyw8ZjkXaPoWkKCRzDV/ahmn3XoF9Nulfpo/LJHoInbxpGA7G4MngNFg05SME6TxovyokSCe2brmKj7Whb43Dhvpa/SYhSrNd9WoKtE/ie01+gOhnD+PaBpVVYUbSY8GZsvUSL6BsN3jk/fYiCs4CWQQKkO6y0DIY7I=
Received: by 10.125.128.7 with SMTP id f7mr517624mkn.59.1210779018850;
        Wed, 14 May 2008 08:30:18 -0700 (PDT)
Received: by 10.86.59.14 with HTTP; Wed, 14 May 2008 08:30:18 -0700 (PDT)
Message-ID: <359a92830805140830r31be100fjcd0b582dc7f7a058@mail.gmail.com>
Date: Wed, 14 May 2008 11:30:18 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Exact match query on a field in index which has been indexed using StandardAnalyzer
In-Reply-To: <979a94470805132214x475626e4ycb6e55f2cd1179a2@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_2069_18118065.1210779018826"
References: <979a94470805130643w6e613c15ke397bb97483f239@mail.gmail.com>
	 <359a92830805130701y23f91470tfe1e8d2578fc466@mail.gmail.com>
	 <979a94470805132214x475626e4ycb6e55f2cd1179a2@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_2069_18118065.1210779018826
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Keeping a duplicate field is certainly one way to go, and assuming that
it's just the title the duplicate field probably won't increase your
index much. I'd recommend just giving it a try, it probably costs less
resource wise than you think.

You'll have to do something like this to get things to work. Another
possibility would be to introduce marker tokens in your field, index
something like "$ member of technical staff $" and then, when
querying for exact matches, *add* the $ tokens to the beginning
and end of the query.

But I'd go with the duplicate UN_TOKENIZED field first

Best
Erick

On Wed, May 14, 2008 at 1:14 AM, Gauri Shankar <gshankar.sahu@gmail.com>
wrote:

> Thanks Erick...
>
> My index size is  ~2 GB. Is it a good idea to keep another duplicate field
> as UN_TOKENIZED and search using KeywordAnalyzer?
>
> Few points:
> 1. when I say exact match then I mean the exact phrase match only. That
> implies the query should not match a document with the field value "Member
> of Technical Staff for Accounting".
>
> 2. stopwords are fine. So "Member Technical Staff" would be equivalent to
>  my query, and is acceptable.
>
> Thanks,
> Gauri
>
> On Tue, May 13, 2008 at 7:31 PM, Erick Erickson <erickerickson@gmail.com>
> wrote:
>
> > First, why do you OR together the different cases? Assuming
> > you're pushing your query through StandardAnalyzer, it'll lowercase
> > for you (just as it did during indexing).
> >
> > But to your question. Would you expect your query to match a document
> > with the field value "Member of Technical Staff for Accounting"? because
> > your phrase would match this as well.......
> >
> > Not to mention stop words. "Member Technical Staff" would be equivalent
> to
> > your query, is that acceptable?
> >
> > Probably the simplest way would be to index the field UN_TOKENIZED too
> > (perhaps normalizing it by, say, lower casing it and taking out stop
> > words)
> > and search against the duplicate field with KeywordAnalyzer. Yes it'll
> > cost
> > you some space but disk space is cheap <G>. How big is your index anyway?
> >
> > I suppose you could also STORE the field and take any documents returned,
> > get the field and compare, but then stop words, casing, etc are tricky.
> >
> > What is the use case you're trying to support? There may be other ways
> > to accomplish your goal than messing around with exact matches.
> >
> > On Tue, May 13, 2008 at 9:43 AM, Gauri Shankar <gshankar.sahu@gmail.com>
> > wrote:
> >
> > > Hi,
> > >
> > > I have a field in index which has been indexed using StandardAnalyzer
> > and
> > > as
> > > TOKENIZED. Now I would like to write a query which returns the hit if
> > > there
> > > is a exact match on the field value.
> > >
> > > Say, if field value is : Member of Technical Staff
> > > then "member of technical staff" OR "Member of Technical Staff" should
> > > returns this document. Note that I am writing the phrase query for
> > > matching
> > > the query string.
> > >
> > >
> > >
> > > --
> > > Regards,
> > > Gauri Shankar
> > >
> >
>
>
>
> --
> Regards,
> Gauri Shankar
>

------=_Part_2069_18118065.1210779018826--

From java-user-return-34052-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 15:38:30 2008
Return-Path: <java-user-return-34052-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82211 invoked from network); 14 May 2008 15:38:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 15:38:30 -0000
Received: (qmail 90569 invoked by uid 500); 14 May 2008 15:38:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90540 invoked by uid 500); 14 May 2008 15:38:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90529 invoked by uid 99); 14 May 2008 15:38:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 08:38:23 -0700
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of janssen@parc.com designates 13.1.64.93 as permitted sender)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 15:37:27 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <150975(1)>; Wed, 14 May 2008 08:35:16 PDT
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Wed, 14 May 2008 08:35:05 PDT
To: java-user@lucene.apache.org
Subject: Re: text extraction from pdf 
In-reply-to: <482ACE49.9030507@getopt.org> 
References: <1bcb7c7f0805140231j6bb6c1dn323794cd739bfd00@mail.gmail.com> <482ACE49.9030507@getopt.org>
Comments: In-reply-to Andrzej Bialecki <ab@getopt.org>
    message dated "Wed, 14 May 2008 04:34:33 -0700."
Date: Wed, 14 May 2008 08:35:01 PDT
From: Bill Janssen <janssen@parc.com>
Message-Id: <08May14.083505pdt."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> > the unix program pdf2text can convert keeping the text places, but I wanted
> > to ask you guys if you know something better,
> 
> AFAIK, PDFBox has a lower-level API that allows you to get hold of text 
> positions.

In UpLib, I use xpdf-3.02pl2 with a patch which gives me position and
font information for each word.  You can get the xpdf sources from
http://www.foolabs.com/xpdf/, and the patch file is at
http://uplib.parc.com/misc/xpdf-3.02-PATCH.  To extract the byte
positions, use pdftotext with the "-wordboxes" switch, and see the
pdftotext man page for more info.  This is run automatically in UpLib
before the indexing is done.

Bill

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34053-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 15:44:31 2008
Return-Path: <java-user-return-34053-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87142 invoked from network); 14 May 2008 15:44:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 15:44:31 -0000
Received: (qmail 5521 invoked by uid 500); 14 May 2008 15:44:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5484 invoked by uid 500); 14 May 2008 15:44:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5473 invoked by uid 99); 14 May 2008 15:44:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 08:44:25 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.190 as permitted sender)
Received: from [209.85.134.190] (HELO mu-out-0910.google.com) (209.85.134.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 15:43:39 +0000
Received: by mu-out-0910.google.com with SMTP id g7so1794599muf.5
        for <java-user@lucene.apache.org>; Wed, 14 May 2008 08:43:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=WR/zwEIF6/tesXzb27Au+D0swd2b8Va21Zs/swuxri4=;
        b=MTXqWSMtTNX2W3VLsMTPxzPHUhXxQCI67o3ilo3Mx+tSPONmLz3htFugsVTgl290amQJKdAgijqbgCXuABRwCmWRb7uxd+0jR5HDx1VQvLnQUU9+5lCopAJT0yrl3CBEQbX0DQJ9WMpThLtgjpzvSzB8PQC9kXVXbH1G+Sm+59w=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=Xf/mqIJKcQL2W3zXvMc9ewACUO7qlBc7vuVzbKXabUsMw8FrcGA+HTeGGvR9s0ohue6gBZwCfbvXMOrEgJFziJ+cbPUtiXR07tzTXWPvodKOFv5xRCyj/Fs+FhC/MeY2yprwoa2Djl2H2/IcI8oIgzy9ryCzCB7RY71A43fM1fQ=
Received: by 10.125.106.10 with SMTP id i10mr530029mkm.7.1210779833130;
        Wed, 14 May 2008 08:43:53 -0700 (PDT)
Received: by 10.86.59.14 with HTTP; Wed, 14 May 2008 08:43:53 -0700 (PDT)
Message-ID: <359a92830805140843q40b9b77fl203a5fe037575433@mail.gmail.com>
Date: Wed, 14 May 2008 11:43:53 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Boosting more-recent documents in an index
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_2126_18680836.1210779833091"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_2126_18680836.1210779833091
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Don't ask me why this occurred to me, since I'm working on a
completely different project... Mostly, this is intended to have
folks who really understand the scoring algorithms chime in and
tell me it's a silly idea <G>.

We've seen multiple threads asking the question: "How can I
cause more-recent documents to be scored higher?" and
several suggestions have been put forward.

What would happen if you had a "date factor" that you persisted
that was the *index-time* boost you applied to documents and
you kept increasing this factor every time period? Or boosted
each document by some factor based on the relevant date?

For instance, let's say I was indexing e-mails starting today.
All e-mails indexed today would get a boost (for all fields?) of 1.0.
Tomorrow, the boost would be 1.1, and the next day 1.2 etc.
Now, any search would automatically push more recent documents
toward the top. The operative word here is "tend" since it wouldn't
have the problem of sorting on dates, which ignores scores.....

I chose 1.0, 1.1, 1.2 at random, but you get the idea.

My main concern is that sometime you would have *very* large
factor differences and I don't know if you'd *ever* see really old
documents, but that's a danger no matter what you do. And
since I'm not even working on a lucene project now, I don't have
the time to try it <G>. Can you recognize a plea for having
others do the hard work when you see it?

And who knows, I may just be parroting something already suggested,
which means that it took this long to actually sink in...

Best
Erick

------=_Part_2126_18680836.1210779833091--

From java-user-return-34054-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 18:51:14 2008
Return-Path: <java-user-return-34054-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69378 invoked from network); 14 May 2008 18:51:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 18:51:14 -0000
Received: (qmail 27714 invoked by uid 500); 14 May 2008 18:51:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27680 invoked by uid 500); 14 May 2008 18:51:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27669 invoked by uid 99); 14 May 2008 18:51:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 11:51:07 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a14.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 18:50:20 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a14.g.dreamhost.com (Postfix) with ESMTP id 667BC190E2D
	for <java-user@lucene.apache.org>; Wed, 14 May 2008 11:50:35 -0700 (PDT)
Message-Id: <D960145D-6954-4DBB-8912-8C539B5280D3@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <359a92830805140843q40b9b77fl203a5fe037575433@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Boosting more-recent documents in an index
Date: Wed, 14 May 2008 14:50:32 -0400
References: <359a92830805140843q40b9b77fl203a5fe037575433@mail.gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

Index time boosts don't have much granularity, so you would run out of  
values pretty quickly, unless I am misunderstanding your proposal.

 From Similarity.encodeNorm:
/** Encodes a normalization factor for storage in an index.
    *
    * <p>The encoding uses a three-bit mantissa, a five-bit exponent,  
and
    * the zero-exponent point at 15, thus
    * representing values from around 7x10^9 to 2x10^-9 with about one
    * significant decimal digit of accuracy.  Zero is also represented.
    * Negative numbers are rounded up to zero.  Values too large to  
represent
    * are rounded down to the largest representable value.  Positive  
values too
    * small to represent are rounded up to the smallest positive  
representable
    * value.
    *
    * @see org.apache.lucene.document.Field#setBoost(float)
    * @see org.apache.lucene.util.SmallFloat
    */
   public static byte encodeNorm(float f) {

On May 14, 2008, at 11:43 AM, Erick Erickson wrote:

> Don't ask me why this occurred to me, since I'm working on a
> completely different project... Mostly, this is intended to have
> folks who really understand the scoring algorithms chime in and
> tell me it's a silly idea <G>.
>
> We've seen multiple threads asking the question: "How can I
> cause more-recent documents to be scored higher?" and
> several suggestions have been put forward.
>
> What would happen if you had a "date factor" that you persisted
> that was the *index-time* boost you applied to documents and
> you kept increasing this factor every time period? Or boosted
> each document by some factor based on the relevant date?
>
> For instance, let's say I was indexing e-mails starting today.
> All e-mails indexed today would get a boost (for all fields?) of 1.0.
> Tomorrow, the boost would be 1.1, and the next day 1.2 etc.
> Now, any search would automatically push more recent documents
> toward the top. The operative word here is "tend" since it wouldn't
> have the problem of sorting on dates, which ignores scores.....
>
> I chose 1.0, 1.1, 1.2 at random, but you get the idea.
>
> My main concern is that sometime you would have *very* large
> factor differences and I don't know if you'd *ever* see really old
> documents, but that's a danger no matter what you do. And
> since I'm not even working on a lucene project now, I don't have
> the time to try it <G>. Can you recognize a plea for having
> others do the hard work when you see it?
>
> And who knows, I may just be parroting something already suggested,
> which means that it took this long to actually sink in...
>
> Best
> Erick



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34055-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 19:16:58 2008
Return-Path: <java-user-return-34055-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78902 invoked from network); 14 May 2008 19:16:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 19:16:58 -0000
Received: (qmail 61210 invoked by uid 500); 14 May 2008 19:16:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61178 invoked by uid 500); 14 May 2008 19:16:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61167 invoked by uid 99); 14 May 2008 19:16:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 12:16:52 -0700
X-ASF-Spam-Status: No, hits=4.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,HTML_MESSAGE,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 19:16:05 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JwMSa-0004fn-5w
	for java-user@lucene.apache.org; Wed, 14 May 2008 12:16:20 -0700
Message-ID: <17238836.post@talk.nabble.com>
Date: Wed, 14 May 2008 12:16:20 -0700 (PDT)
From: broddoi <yanosaudron@gmail.com>
To: java-user@lucene.apache.org
Subject: Using more tokens in TokenFilter :(
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_13066_29037540.1210792580179"
X-Nabble-From: yanosaudron@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_13066_29037540.1210792580179
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit


Hello I created for a project a new class that extends TokenFilter but I have
a big problem... I have a dictionary of terms loaded using an Hashset, but
this terms have more than one token (for example "computer science") so I
can only search 1-word token (I tried adding one invented by me) and it
works but don't finds terms with more than one word can someone help me
please? It's urgent... I post my code thanks to everyone!

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.HashSet;

import org.apache.lucene.analysis.Token;
import org.apache.lucene.analysis.TokenFilter;
import org.apache.lucene.analysis.TokenStream;

public class TermTokenFilter extends TokenFilter {

	protected HashSet terms = new HashSet();
	public TermTokenFilter(TokenStream input) throws IOException
	{
		super(input);
		
		//apro i file
		//ricontrollare se input o cosa va messo.
		File f = new File("ADDRESS OF FILE TXT WITH TERMS\\TERMS.txt");
		
		FileInputStream fip = new FileInputStream(f);
		BufferedReader d = new BufferedReader(new InputStreamReader(fip));
		String readLine;
		
		while((readLine = d.readLine())!=null)
		{
			terms.add(readLine);
		}
		
	}
	
	public Token next(Token result) throws IOException
	{
		
		while((result = input.next(result)) != null)
		{
			if (terms.contains(new String(result.termBuffer(), 0,
result.termLength())))
			{
				return result;
			}
		}
		return null;
	}
}
-- 
View this message in context: http://www.nabble.com/Using-more-tokens-in-TokenFilter-%3A%28-tp17238836p17238836.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.

------=_Part_13066_29037540.1210792580179--


From java-user-return-34056-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 20:22:39 2008
Return-Path: <java-user-return-34056-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 306 invoked from network); 14 May 2008 20:22:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 20:22:38 -0000
Received: (qmail 89797 invoked by uid 500); 14 May 2008 20:22:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89270 invoked by uid 500); 14 May 2008 20:22:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89259 invoked by uid 99); 14 May 2008 20:22:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 13:22:31 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.142.207.200] (HELO web32407.mail.mud.yahoo.com) (68.142.207.200)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 14 May 2008 20:21:36 +0000
Received: (qmail 9299 invoked by uid 60001); 14 May 2008 20:21:56 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=EFUoEG/hGNPr1u4QgxpsgvxTPG2d1uXlf3RgjnBvRXW8YnU8hQrxwguUH4DeDXhbqDdjl+DzmQH78gOg+70UjYpRi+3Q3brG/yWOWNk74mNKdYAVuJbpTiJ0FFp7qyxqvm5U/NVeavGQ+PsQhMlME7Mxnj6AvgtbwlHhvM79QJs=;
X-YMail-OSG: dWQ1pzQVM1la6tHBII_gevqUsuLf2gX5N5g5FqM1jL9ixxJ1HU2zItiUntLT.Ne8m3MPuzq1Iawp9MqJCY0ZUwHNqGcORk7iyinrjw--
Received: from [213.60.24.174] by web32407.mail.mud.yahoo.com via HTTP; Wed, 14 May 2008 13:21:56 PDT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Wed, 14 May 2008 13:21:56 -0700 (PDT)
From: nch <underscore_dot@yahoo.com>
Subject: RedHad GFS
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-440906735-1210796516=:8792"
Message-ID: <770933.8792.qm@web32407.mail.mud.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-440906735-1210796516=:8792
Content-Type: text/plain; charset=us-ascii

Hi, all.
I'd like to know about your experience sharing Lucene index on a RedHat GFS filesystem.
Is that a good choice? Is it reliable? What other good alternatives exist?

Kind regards



      
--0-440906735-1210796516=:8792--

From java-user-return-34057-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 21:28:24 2008
Return-Path: <java-user-return-34057-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28470 invoked from network); 14 May 2008 21:28:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 21:28:24 -0000
Received: (qmail 1281 invoked by uid 500); 14 May 2008 21:28:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1247 invoked by uid 500); 14 May 2008 21:28:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1236 invoked by uid 99); 14 May 2008 21:28:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 14:28:17 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.242] (HELO web50309.mail.re2.yahoo.com) (206.190.38.242)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 14 May 2008 21:27:20 +0000
Received: (qmail 32846 invoked by uid 60001); 14 May 2008 21:27:41 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=wiJQoyjeY0hzcFTKpw9zYjdlmCNl5mMNODnhQvdJgz4TCEZVln8XQccyXK7NjOkfENYqIStw027TIxMRcbuwsEhEzkaRbYOfKU5SYr4LkXkgM+M4OD5XEXOrfeuuK1o0Uuf54nwf+NJnOIUnCBF6DkpWLMMSb/jHMni62b7zhSI=;
X-YMail-OSG: bAlSAqAVM1m0_cvXM91fG.7DycIpI5WylD_6egufOtCkKktq1ocKHKwdTw91RutsKMF25DAmm3Q8829r6C4M3yqhd5iZ9kQNa7ewDe5Jcgq5GL5NraEZ0zoUJw--
Received: from [72.231.9.236] by web50309.mail.re2.yahoo.com via HTTP; Wed, 14 May 2008 14:27:41 PDT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Wed, 14 May 2008 14:27:41 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: RedHad GFS
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <181504.32480.qm@web50309.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I have note used RedHat GFS personally, but I know one of Sematext's big customers (see http://sematext.com/clients ) has used it or is still using it and they were happy with it.  I bet Wikipedia has a good list of RH GFS alternatives.  Here is what I've got: http://www.simpy.com/user/otis/search/cluster%20filesystem


Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: nch <underscore_dot@yahoo.com>
> To: java-user@lucene.apache.org
> Sent: Wednesday, May 14, 2008 4:21:56 PM
> Subject: RedHad GFS
> 
> Hi, all.
> I'd like to know about your experience sharing Lucene index on a RedHat GFS 
> filesystem.
> Is that a good choice? Is it reliable? What other good alternatives exist?
> 
> Kind regards


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34058-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 14 23:41:48 2008
Return-Path: <java-user-return-34058-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60651 invoked from network); 14 May 2008 23:41:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 May 2008 23:41:48 -0000
Received: (qmail 45946 invoked by uid 500); 14 May 2008 23:41:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45919 invoked by uid 500); 14 May 2008 23:41:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45908 invoked by uid 99); 14 May 2008 23:41:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 16:41:42 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 194.109.24.23 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.23] (HELO smtp-vbr3.xs4all.nl) (194.109.24.23)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 23:40:55 +0000
Received: from kodapan.lan (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr3.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4ENf8Vl003394
	for <java-user@lucene.apache.org>; Thu, 15 May 2008 01:41:08 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <E7F35C85-7111-4F5E-93DD-EA1080FEB6E6@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: IndexWriter cache swetspots
Date: Thu, 15 May 2008 01:41:08 +0200
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

I have an index with several million documents that each contains  
between a few hundred terms and up to about a million terms. To me it  
feels like there would be a rather big difference between the swetspot  
setting for the cache size when adding very large and very small  
documents.

What are the other factors I have to consider when benchmarking this?  
Number of threads? Initial index size?


The things is that I don't know what good the cache does in the first  
place nor what it does. Perhaps this is all in vain, but I'm sort of  
hoping it's possible to automatically find and set the cache sweetspot  
by sampling miscellaneous data in realtime.

Does this make sense?


         karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34059-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 01:36:58 2008
Return-Path: <java-user-return-34059-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40915 invoked from network); 15 May 2008 01:36:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 01:36:57 -0000
Received: (qmail 41547 invoked by uid 500); 15 May 2008 01:36:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41505 invoked by uid 500); 15 May 2008 01:36:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41491 invoked by uid 99); 15 May 2008 01:36:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 18:36:51 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.39.214] (HELO web50312.mail.re2.yahoo.com) (206.190.39.214)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 15 May 2008 01:36:03 +0000
Received: (qmail 6425 invoked by uid 60001); 15 May 2008 01:36:15 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=4z7PSrwPCBVDlEqQZou2bcvPIArqEMAm4N5pIUe2rwN9fA8aL7F1XrDt85cKY9xCm/iV8bQS/u6D8/YXk3steVysfhkdAZ0jgBXZFBseuMHcpI6i/aXXd1heK5urcu/GM/7NvJEJBrnC0ihGT4tvAe0X0XEEw2BS59/Lue2nj7w=;
X-YMail-OSG: WV7uGtkVM1mFhGfgciEqFSvkt.RLxM1JSGuUphnAoJeBH.RXcZDAtp30A.1B4rhXi22XwZax1KytN3lkE5gxGB48IXQSBqMa3URTWCvowhxLR24gBNgyJOZbgw--
Received: from [72.231.9.236] by web50312.mail.re2.yahoo.com via HTTP; Wed, 14 May 2008 18:36:15 PDT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Wed, 14 May 2008 18:36:15 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: IndexWriter cache swetspots
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <576097.5198.qm@web50312.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Karl, which caches are you referring to?  Things like maxBufferedDocs and the recent memory-based in-memory buffer?  If so, isn't "the bigger the better" the answer?


Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: Karl Wettin <karl.wettin@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Wednesday, May 14, 2008 7:41:08 PM
> Subject: IndexWriter cache swetspots
> 
> I have an index with several million documents that each contains  
> between a few hundred terms and up to about a million terms. To me it  
> feels like there would be a rather big difference between the swetspot  
> setting for the cache size when adding very large and very small  
> documents.
> 
> What are the other factors I have to consider when benchmarking this?  
> Number of threads? Initial index size?
> 
> 
> The things is that I don't know what good the cache does in the first  
> place nor what it does. Perhaps this is all in vain, but I'm sort of  
> hoping it's possible to automatically find and set the cache sweetspot  
> by sampling miscellaneous data in realtime.
> 
> Does this make sense?
> 
> 
>          karl
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34060-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 01:56:49 2008
Return-Path: <java-user-return-34060-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48600 invoked from network); 15 May 2008 01:56:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 01:56:49 -0000
Received: (qmail 59915 invoked by uid 500); 15 May 2008 01:56:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59889 invoked by uid 500); 15 May 2008 01:56:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59878 invoked by uid 99); 15 May 2008 01:56:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 18:56:43 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 64.233.166.183 as permitted sender)
Received: from [64.233.166.183] (HELO py-out-1112.google.com) (64.233.166.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 01:55:54 +0000
Received: by py-out-1112.google.com with SMTP id z74so180755pyg.9
        for <java-user@lucene.apache.org>; Wed, 14 May 2008 18:56:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=Nj9gZHhzvK0efUBwiztA54DNHHrNbNC8gK6Wk9E0TEs=;
        b=Px3SlTMUqP0P5Za6fqT4lDQc0wZvzbml2JuTD2Yq7GNYQHIdPUbEctYKVzqx7qa0EsZ0OL54J6pvWHouWM0xgoVAG/uxT3da2+bT2j8gN6WBjYcpc8IT7Wmp66UtbGhub9hw00jeG7OutAbVkRyf6oKtUt7nsf7OKn+rPEmrRH8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=subject:from:to:in-reply-to:references:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=Xh5Z3x6I0xfUBazb/gOC2eMAAJwS9EyGeNk9pC7i9dWWDhDH4eStnNLam5QkL31RD3VXXacPKEfm1VMvBu1ARMab8L32Kde8yDrR9xTYncXpIz9291xoioIrvsDQmAmP/jwEZLV87hdmNlFFXg1+xHlrWhUJhZBvHLdPxasGldc=
Received: by 10.65.44.5 with SMTP id w5mr2142040qbj.65.1210816569528;
        Wed, 14 May 2008 18:56:09 -0700 (PDT)
Received: from ?192.168.1.104? ( [69.124.234.149])
        by mx.google.com with ESMTPS id f13sm2749219qba.1.2008.05.14.18.56.08
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 14 May 2008 18:56:08 -0700 (PDT)
Subject: Re: IndexWriter cache swetspots
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <576097.5198.qm@web50312.mail.re2.yahoo.com>
References: <576097.5198.qm@web50312.mail.re2.yahoo.com>
Content-Type: text/plain
Date: Wed, 14 May 2008 21:56:08 -0400
Message-Id: <1210816569.24592.2.camel@m-laptop>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.1.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Its been months since i've tested this sort of thing, but from what I
remember there is a point where as you go higher, performance starts to
very slowly drop. The point was lower than I'd expect, and def created
what looked like sweet spot settings.

On Wed, 2008-05-14 at 18:36 -0700, Otis Gospodnetic wrote:
> Karl, which caches are you referring to?  Things like maxBufferedDocs and the recent memory-based in-memory buffer?  If so, isn't "the bigger the better" the answer?
> 
> 
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
> 
> 
> ----- Original Message ----
> > From: Karl Wettin <karl.wettin@gmail.com>
> > To: java-user@lucene.apache.org
> > Sent: Wednesday, May 14, 2008 7:41:08 PM
> > Subject: IndexWriter cache swetspots
> > 
> > I have an index with several million documents that each contains  
> > between a few hundred terms and up to about a million terms. To me it  
> > feels like there would be a rather big difference between the swetspot  
> > setting for the cache size when adding very large and very small  
> > documents.
> > 
> > What are the other factors I have to consider when benchmarking this?  
> > Number of threads? Initial index size?
> > 
> > 
> > The things is that I don't know what good the cache does in the first  
> > place nor what it does. Perhaps this is all in vain, but I'm sort of  
> > hoping it's possible to automatically find and set the cache sweetspot  
> > by sampling miscellaneous data in realtime.
> > 
> > Does this make sense?
> > 
> > 
> >          karl
> > 
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34061-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 03:24:28 2008
Return-Path: <java-user-return-34061-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68596 invoked from network); 15 May 2008 03:24:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 03:24:28 -0000
Received: (qmail 93792 invoked by uid 500); 15 May 2008 03:24:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93759 invoked by uid 500); 15 May 2008 03:24:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93748 invoked by uid 99); 15 May 2008 03:24:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 20:24:22 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.191.85.22] (HELO web36605.mail.mud.yahoo.com) (209.191.85.22)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 15 May 2008 03:23:25 +0000
Received: (qmail 66110 invoked by uid 60001); 15 May 2008 03:23:45 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Reply-To:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=uDEfBaCUny6CVrJIOrwEf90dZgXCaYHxrZ7vZWOfXLOecuD8V+F3tWrLCaOQVR5Gtl9Y5laE+loDxrfJYQHgnPeJB7X8rtRTW5HHF6eTGGsG7MKP0GK4i2rKDYTHTV+dKWwXIripTpykYkS8vYJ6YdlvP/vyAXVk1yWInB7nL84=;
X-YMail-OSG: WP138KwVM1nbcRj3dXoTiEVZw2cWSyXIQ0_s5zSIw4Ow3mk1qQ15t9uCgHBWxnXjXEGJ49ljy4wPpvfwCya89Ksv_lXRJuI9R7K5bgmYefRShNtXl1k4LY6d8W0-
Received: from [133.9.4.11] by web36605.mail.mud.yahoo.com via HTTP; Wed, 14 May 2008 20:23:45 PDT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Wed, 14 May 2008 20:23:45 -0700 (PDT)
From: Supheakmungkol SARIN <supheakmungkol@yahoo.com>
Reply-To: Supheakmungkol SARIN <supheakmungkol.sarin@gmail.com>
Subject: Document clustering with Lucene
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-922645916-1210821825=:65483"
Message-ID: <888586.65483.qm@web36605.mail.mud.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-922645916-1210821825=:65483
Content-Type: text/plain; charset=us-ascii

Dear all,

I'd like to do document clustering using full-text with Lucene. In other words, I would like to group similar documents in their respective groups. I searched the mailing list and found that there are two ways around. The first method is to represent the one document as query and search the collection.  The other way would be to construct the vector of terms of each of the documents and use the cosine distance function to compute the similarity. I found these methods here:

- http://www.mail-archive.com/lucene-user@jakarta.apache.org/msg04916.html). 

I would like to know whether there are better way? or any built-in functions to do clustering in the recent release version of Lucene?

Thank you.

Kind regards,

Supheakmungkol

--0-922645916-1210821825=:65483--

From java-user-return-34062-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 04:37:24 2008
Return-Path: <java-user-return-34062-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81245 invoked from network); 15 May 2008 04:37:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 04:37:24 -0000
Received: (qmail 29528 invoked by uid 500); 15 May 2008 04:37:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29500 invoked by uid 500); 15 May 2008 04:37:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29489 invoked by uid 99); 15 May 2008 04:37:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 May 2008 21:37:18 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 72.14.220.152 as permitted sender)
Received: from [72.14.220.152] (HELO fg-out-1718.google.com) (72.14.220.152)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 04:36:29 +0000
Received: by fg-out-1718.google.com with SMTP id l27so267268fgb.27
        for <java-user@lucene.apache.org>; Wed, 14 May 2008 21:36:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=/aatzz6LUWXW1gjC84met6Ilmo1bJbx32VPKBU5xzsI=;
        b=gCHA9KUpb7ekkyRby9JxQ/hfO1faPtKVpCWzpYcxs9oT4asGSCG5NnkCtpKLCG7ROtjHfZdkOLorVrLS8nc+76mkkiF/0hlwFZgz0i0l49DGckM1KTUy0pQGLaSH/wjYTYC78M7nz7JuHk+OnOqK7cLsGqtv9Ju6WRsGVMKgwkw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=VzudYijmEXOu8brztnx5cL6GJ9YguUV+6g4nt3HlRwaleDANEFhnhsJTX2RvCLzSKiuYniJdJ+bt4KDzzkaH584G/LKBJvdKCEguaRJpypj9fWGFCpPp1nEbpNU+X+1W/7ZgT+G2At/aUNQNiTJaiPIrIMzrP7OciWwWda5WcRI=
Received: by 10.82.167.9 with SMTP id p9mr262875bue.81.1210826203478;
        Wed, 14 May 2008 21:36:43 -0700 (PDT)
Received: by 10.82.141.17 with HTTP; Wed, 14 May 2008 21:36:43 -0700 (PDT)
Message-ID: <8837fb770805142136s5d72cec4p5b75c4b5b824bcc2@mail.gmail.com>
Date: Wed, 14 May 2008 21:36:43 -0700
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: distributed lucene progress
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_3763_6210399.1210826203473"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_3763_6210399.1210826203473
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi:

   What is the current status on the distributed lucene project proposed at:

http://www.mail-archive.com/general@lucene.apache.org/msg00338.html

Thanks

-John

------=_Part_3763_6210399.1210826203473--

From java-user-return-34063-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 07:47:20 2008
Return-Path: <java-user-return-34063-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33897 invoked from network); 15 May 2008 07:47:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 07:47:19 -0000
Received: (qmail 71395 invoked by uid 500); 15 May 2008 07:47:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71358 invoked by uid 500); 15 May 2008 07:47:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71347 invoked by uid 99); 15 May 2008 07:47:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 00:47:14 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [66.249.82.234] (HELO wx-out-0506.google.com) (66.249.82.234)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 07:46:27 +0000
Received: by wx-out-0506.google.com with SMTP id h29so207783wxd.20
        for <java-user@lucene.apache.org>; Thu, 15 May 2008 00:46:41 -0700 (PDT)
Received: by 10.90.87.7 with SMTP id k7mr2830591agb.25.1210837600897;
        Thu, 15 May 2008 00:46:40 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 38sm2428293agd.37.2008.05.15.00.46.39
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 15 May 2008 00:46:40 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <1210816569.24592.2.camel@m-laptop>
References: <576097.5198.qm@web50312.mail.re2.yahoo.com> <1210816569.24592.2.camel@m-laptop>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <F8E8752C-BE3A-4290-875F-CE956C501252@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: IndexWriter cache swetspots
Date: Thu, 15 May 2008 03:46:43 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Mark Miller wrote:
> Its been months since i've tested this sort of thing, but from what I
> remember there is a point where as you go higher, performance  
> starts to
> very slowly drop. The point was lower than I'd expect, and def created
> what looked like sweet spot settings.

This was my recollection as well, though, it's really quite  
application dependent.  You should just test a spectrum and pick the  
best: let the computer tell you.

Note that if you use multiple threads, your sweet spot is likely  
quite a bit higher RAM buffer than with a single thread (but test it!).

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34064-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 10:24:14 2008
Return-Path: <java-user-return-34064-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83817 invoked from network); 15 May 2008 10:24:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 10:24:14 -0000
Received: (qmail 42103 invoked by uid 500); 15 May 2008 10:24:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41749 invoked by uid 500); 15 May 2008 10:24:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41737 invoked by uid 99); 15 May 2008 10:24:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 03:24:08 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cambazz@gmail.com designates 209.85.198.236 as permitted sender)
Received: from [209.85.198.236] (HELO rv-out-0506.google.com) (209.85.198.236)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 10:23:19 +0000
Received: by rv-out-0506.google.com with SMTP id f6so358866rvb.5
        for <java-user@lucene.apache.org>; Thu, 15 May 2008 03:23:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=/+/qUwW102GaDCncQNLjdfQt7O1JDKzl0AmEV9QsXf8=;
        b=sYWSx7tfB1yXFk9DkDIGRYSo7C2Gwf01N2YXif0j7dyhzJBtfycYKBAWzwOvVeirE+qlRk7gbKoM5y/DSjBQecZVHPvgOrtEv5DuJBqqoawNhCe9Z7n+7RVIva8AAo0wVkAOSEMA5EUB4qBXXJf5I0u1gN0ckOMGqjg6JwHz2/Y=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=gcBfyxMFaHHNel4MR6IBxjNk1GZ6Xfl8/P+zKgDvwXJhbWbv14vI1nyE10DuMaxoy9QPWhRDKdq9tJXUs3G0kCkPm6tF1+xuxScOfQsVYaTdjftnc3BAMVKPknS3wufZv0JI10l97Hdo79VA+gwUXme2DVOaEvRNxz20AGrHsIc=
Received: by 10.140.133.16 with SMTP id g16mr1020295rvd.231.1210847014536;
        Thu, 15 May 2008 03:23:34 -0700 (PDT)
Received: by 10.141.164.2 with HTTP; Thu, 15 May 2008 03:23:34 -0700 (PDT)
Message-ID: <1bcb7c7f0805150323k2ba0b8e8ic814efcaf881c33b@mail.gmail.com>
Date: Thu, 15 May 2008 13:23:34 +0300
From: "Cam Bazz" <cambazz@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: text extraction from pdf
In-Reply-To: <-5037462568277521439@unknownmsgid>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_6490_11453754.1210847014540"
References: <1bcb7c7f0805140231j6bb6c1dn323794cd739bfd00@mail.gmail.com>
	 <482ACE49.9030507@getopt.org> <-5037462568277521439@unknownmsgid>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_6490_11453754.1210847014540
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hello Bill,

Problem I am having is that some of them has multiple columns. and multiple
word boxes. Does the xpdf patch extract different columns and wordboxes?

Best,
-C.B.


On Wed, May 14, 2008 at 6:35 PM, Bill Janssen <janssen@parc.com> wrote:

> > > the unix program pdf2text can convert keeping the text places, but I
> wanted
> > > to ask you guys if you know something better,
> >
> > AFAIK, PDFBox has a lower-level API that allows you to get hold of text
> > positions.
>
> In UpLib, I use xpdf-3.02pl2 with a patch which gives me position and
> font information for each word.  You can get the xpdf sources from
> http://www.foolabs.com/xpdf/, and the patch file is at
> http://uplib.parc.com/misc/xpdf-3.02-PATCH.  To extract the byte
> positions, use pdftotext with the "-wordboxes" switch, and see the
> pdftotext man page for more info.  This is run automatically in UpLib
> before the indexing is done.
>
> Bill
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_6490_11453754.1210847014540--

From java-user-return-34065-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 11:20:06 2008
Return-Path: <java-user-return-34065-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96333 invoked from network); 15 May 2008 11:20:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 11:20:05 -0000
Received: (qmail 93333 invoked by uid 500); 15 May 2008 11:19:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93307 invoked by uid 500); 15 May 2008 11:19:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93296 invoked by uid 99); 15 May 2008 11:19:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 04:19:59 -0700
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of davekor@gmail.com designates 209.85.142.189 as permitted sender)
Received: from [209.85.142.189] (HELO ti-out-0910.google.com) (209.85.142.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 11:19:11 +0000
Received: by ti-out-0910.google.com with SMTP id b8so236543tic.11
        for <java-user@lucene.apache.org>; Thu, 15 May 2008 04:19:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=Iwhki/dM2aFYbRLBgH8A/ezg7vh5kAK1R3ZMyqOfb1M=;
        b=SEVXRQNNh3SR/5/MtjwiEHJ6N7Nwkbbn9+2DXZINu533KSiMNo13DTn+xXFVAgJG/NB5lHdEU/K0B8Fy66b0Inra6ayHOWOCb0rXEOgGkOH2W+iLldaz3KaQxO48GLYuTUjxczR+NRRQPGO2ru7Zwr1tfS4WmFGSfJFDLK2WQCA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=umB6BXvythg8yYZ/cyW/VTmPiyaFKiTTZRMh5W4ZRazP+JK713vZXPDyLAYk7Q93l3y35aLfpIrg6661lA2XsSG50JP9iqUG1Q0h6DBd4P+Z9TRX1/ibxbNNUNH1PjQHEQCLL15uOmHvTembWQ4nnuR+YvbqglVuPm6n6Fzi2Ro=
Received: by 10.110.26.20 with SMTP id 20mr298378tiz.23.1210850365115;
        Thu, 15 May 2008 04:19:25 -0700 (PDT)
Received: by 10.110.57.12 with HTTP; Thu, 15 May 2008 04:19:24 -0700 (PDT)
Message-ID: <901c03930805150419j4dd1dcfbj239a504923a21c70@mail.gmail.com>
Date: Thu, 15 May 2008 19:19:24 +0800
From: "Dave Kor" <davekor@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene's Mean Average Precision
In-Reply-To: <17049412.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5464_8715265.1210850365124"
References: <17049412.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5464_8715265.1210850365124
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

I haven't participated in TREC for the past 2 years, so I am wonder which
TREC track were you comparing your results against? The last time I checked,
Lucene's score for the Terabyte track wasn't wonderful, but it was still
pretty decent.

Bear in mind that Lucene uses the plain old vanilla TF-IDF formula to score
documents. That is, Lucene simply assumes that if a search term appears
often in a short document, then that document would be ranked very highly.
Lucene by itself does not do query expansion (although it is relatively easy
to add Rocchio's algorithm), nor any of the other stuff that modern search
engines do.

On Mon, May 5, 2008 at 2:13 AM, DanaWhite <philrymek@comcast.net> wrote:

>
> Hello all,
>
> I have been doing some evaluation of Lucene on a TReC collection and get a
> rather disappointing mean average precision (MAP) of 11%.  Other sources
> seem to report a MAP of about 20%.
>
> So I am here to ask all of you who have done some Lucene evaluation - what
> did you find Lucene's MAP to be?  Did you do anything to special (e.g.
> query
> expansion) to get it higher?
>
> Thanks
> Dana
> --
> View this message in context:
> http://www.nabble.com/Lucene%27s-Mean-Average-Precision-tp17049412p17049412.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Regards,
Dave Kor

------=_Part_5464_8715265.1210850365124--

From java-user-return-34066-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 15:49:36 2008
Return-Path: <java-user-return-34066-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8470 invoked from network); 15 May 2008 15:49:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 15:49:36 -0000
Received: (qmail 54731 invoked by uid 500); 15 May 2008 15:49:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54698 invoked by uid 500); 15 May 2008 15:49:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54687 invoked by uid 99); 15 May 2008 15:49:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 08:49:29 -0700
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of janssen@parc.com designates 13.1.64.93 as permitted sender)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 15:48:39 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <170397(1)>; Thu, 15 May 2008 08:48:47 PDT
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Thu, 15 May 2008 08:48:38 PDT
To: java-user@lucene.apache.org
Subject: Re: text extraction from pdf 
In-reply-to: <1bcb7c7f0805150323k2ba0b8e8ic814efcaf881c33b@mail.gmail.com> 
References: <1bcb7c7f0805140231j6bb6c1dn323794cd739bfd00@mail.gmail.com> <482ACE49.9030507@getopt.org> <-5037462568277521439@unknownmsgid> <1bcb7c7f0805150323k2ba0b8e8ic814efcaf881c33b@mail.gmail.com>
Comments: In-reply-to "Cam Bazz" <cambazz@gmail.com>
    message dated "Thu, 15 May 2008 03:23:34 -0700."
Date: Thu, 15 May 2008 08:48:30 PDT
From: Bill Janssen <janssen@parc.com>
Message-Id: <08May15.084838pdt."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> Problem I am having is that some of them has multiple columns. and multiple
> word boxes. Does the xpdf patch extract different columns and wordboxes?

It tells you where each word is.  Columns you have to do for yourself.

Bill

> > In UpLib, I use xpdf-3.02pl2 with a patch which gives me position and
> > font information for each word.  You can get the xpdf sources from
> > http://www.foolabs.com/xpdf/, and the patch file is at
> > http://uplib.parc.com/misc/xpdf-3.02-PATCH.  To extract the byte
> > positions, use pdftotext with the "-wordboxes" switch, and see the
> > pdftotext man page for more info.  This is run automatically in UpLib
> > before the indexing is done.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34067-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 15:55:19 2008
Return-Path: <java-user-return-34067-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11363 invoked from network); 15 May 2008 15:55:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 15:55:19 -0000
Received: (qmail 68177 invoked by uid 500); 15 May 2008 15:55:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68144 invoked by uid 500); 15 May 2008 15:55:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68104 invoked by uid 99); 15 May 2008 15:55:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 08:55:12 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: 194.109.24.36 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.36] (HELO smtp-vbr16.xs4all.nl) (194.109.24.36)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 15:54:18 +0000
Received: from kodapan.lan (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr16.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4FFsdmx041738
	for <java-user@lucene.apache.org>; Thu, 15 May 2008 17:54:39 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <2514D938-BD8E-45DE-8AD2-B7FE5D3CFDCF@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <F8E8752C-BE3A-4290-875F-CE956C501252@mikemccandless.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: IndexWriter cache swetspots
Date: Thu, 15 May 2008 17:54:39 +0200
References: <576097.5198.qm@web50312.mail.re2.yahoo.com> <1210816569.24592.2.camel@m-laptop> <F8E8752C-BE3A-4290-875F-CE956C501252@mikemccandless.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org


15 maj 2008 kl. 09.46 skrev Michael McCandless:
>
> Mark Miller wrote:
>> Its been months since i've tested this sort of thing, but from what I
>> remember there is a point where as you go higher, performance  
>> starts to
>> very slowly drop. The point was lower than I'd expect, and def  
>> created
>> what looked like sweet spot settings.
>
> This was my recollection as well, though, it's really quite  
> application dependent.  You should just test a spectrum and pick the  
> best: let the computer tell you.

Sometimes my documents contains two million terms, sometimes they  
contain a few hundred. It is often so that a few hundred thousand  
documents in a row have aproximatly the same amount of terms. I belive  
that my cache size sweet spot is variable over time and depends on a  
number of factors that could be simulated rather easy: number of  
threads, size of index to merge the cache to, term saturation in cache  
and size of documents about to be added. Are there any other things I  
should look at?


        karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34068-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 16:35:39 2008
Return-Path: <java-user-return-34068-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41784 invoked from network); 15 May 2008 16:35:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 16:35:39 -0000
Received: (qmail 76580 invoked by uid 500); 15 May 2008 16:35:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76403 invoked by uid 500); 15 May 2008 16:35:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76392 invoked by uid 99); 15 May 2008 16:35:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 09:35:33 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 16:34:46 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.13.8/8.13.8) with ESMTP id m4FGYtXG023830
	for <java-user@lucene.apache.org>; Thu, 15 May 2008 12:34:56 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <482C65E9.7040304@informatics.jax.org>
Date: Thu, 15 May 2008 12:33:45 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 1.5.0.14 (Windows/20071210)
MIME-Version: 1.0
To: lucene <java-user@lucene.apache.org>
Subject: Possible Bug when Querying?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.4.2.338381, Antispam-Engine: 2.6.0.325393, Antispam-Data: 2008.5.15.91710
X-PerlMx-Spam: Gauge=IIIIIII, Probability=7%, Report='BODY_SIZE_1500_1599 0, BODY_SIZE_5000_LESS 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __HAS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __SANE_MSGID 0, __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

Greetings,

I'm searching against a data set using lucene that contains searches 
such as the following:

*ache*
*aChe*

etc and so forth, sadly this part of the dataset is imported via an 
external client, so we have no real way of controlling how they format it.

Now, to make matters a bit more complex, my clients have decided to turn 
off all wildcard searching, EXCEPT for prefix searches, so when I 
process the query string I go ahead and go through it and escape out all 
lucene special characters, except for the trailing *.

So I end up sending the following string to the query parser:

\*ache* (I'm doing standard things like converting everything to lowercase)

and when I put that into the query parser its throwing the following 
exception:

12:23:05,602 INFO  [STDOUT] 
org.apache.lucene.queryParser.ParseException: Cannot parse '\*ache*': 
'*' not allowed as first character in PrefixQuery
12:23:05,602 INFO  [STDOUT] Failure in QS_MarkerSearch.searchMarkerNomen
12:23:05,602 ERROR [STDERR] java.lang.NullPointerException
12:23:05,602 ERROR [STDERR]     at 
org.jax.mgi.search.model.QS_MarkerSearch.searchInexactMatches(Unknown 
Source)


Which looks to me alot like something akin to the AllowLeadingWildcard 
stuff that comes along with wildcardqueries.

But, the odd thing is the leading character in my search string ISN'T *, 
its the escaped star character, which I would have thought would work 
with no problems at all.

Have I stumbled across a bug here?

Matt


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34069-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 17:16:20 2008
Return-Path: <java-user-return-34069-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85977 invoked from network); 15 May 2008 17:16:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 17:16:20 -0000
Received: (qmail 65358 invoked by uid 500); 15 May 2008 17:16:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65329 invoked by uid 500); 15 May 2008 17:16:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65309 invoked by uid 99); 15 May 2008 17:16:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 10:16:11 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [212.27.42.28] (HELO smtp2-g19.free.fr) (212.27.42.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 17:15:17 +0000
Received: from smtp2-g19.free.fr (localhost.localdomain [127.0.0.1])
	by smtp2-g19.free.fr (Postfix) with ESMTP id 325F612BD80
	for <java-user@lucene.apache.org>; Thu, 15 May 2008 19:15:38 +0200 (CEST)
Received: from [192.168.0.6] (dau94-8-88-166-28-143.fbx.proxad.net [88.166.28.143])
	by smtp2-g19.free.fr (Postfix) with ESMTP id 0205B12B88B
	for <java-user@lucene.apache.org>; Thu, 15 May 2008 19:15:37 +0200 (CEST)
Message-ID: <482C6FC5.509@arcetis.com>
Date: Thu, 15 May 2008 19:15:49 +0200
From: Jean-Claude Antonio <jcantonio@arcetis.com>
Reply-To: jcantonio@arcetis.com
Organization: Arcetis
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Update document with fields which are not stored
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

We are using lucene for a while, and we are happy with it. Now we want 
to optimize some space.
We are parsing versions of files and we want to keep track of history 
and also know which one is the newest we set a flag to it (field 
newest=true).
so when a new version comes along :
- we want to set the field "newest" of the current document to false.
To do so, we delete the document
and add a new document with the same fields
- then we add this new file with field newest=true

This work perfectly, but for this we need to have a content field as
new Field("content", content, Field.Store.YES, Field.Index.TOKENIZED)
to be able to update the current document which stores the content.

We wish not to store the content as the size of the index gets big.

Is there a way to get the tokenized field value which is not stored?
Or it would be great if we could use a method like 
IndexWriter.updateDocuments(Query) but the only one is 
IndexWriter.updateDocuments(Term).

Any hint?

Best regards,

Jean-Claude

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34070-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 17:52:53 2008
Return-Path: <java-user-return-34070-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 739 invoked from network); 15 May 2008 17:52:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 17:52:53 -0000
Received: (qmail 23398 invoked by uid 500); 15 May 2008 17:52:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23358 invoked by uid 500); 15 May 2008 17:52:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23347 invoked by uid 99); 15 May 2008 17:52:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 10:52:46 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 194.109.24.21 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.21] (HELO smtp-vbr1.xs4all.nl) (194.109.24.21)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 17:52:00 +0000
Received: from [10.0.2.2] (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr1.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4FHqE4d052080
	for <java-user@lucene.apache.org>; Thu, 15 May 2008 19:52:14 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <01C9D92E-9D00-42CF-92AD-22110A384A39@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <359a92830805140830r31be100fjcd0b582dc7f7a058@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Exact match query on a field in index which has been indexed using StandardAnalyzer
Date: Thu, 15 May 2008 19:52:13 +0200
References: <979a94470805130643w6e613c15ke397bb97483f239@mail.gmail.com> <359a92830805130701y23f91470tfe1e8d2578fc466@mail.gmail.com> <979a94470805132214x475626e4ycb6e55f2cd1179a2@mail.gmail.com> <359a92830805140830r31be100fjcd0b582dc7f7a058@mail.gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org


14 maj 2008 kl. 17.30 skrev Erick Erickson:
> Another
> possibility would be to introduce marker tokens in your field, index
> something like "$ member of technical staff $" and then, when
> querying for exact matches, *add* the $ tokens to the beginning
> and end of the query.

Just a note, I've hit problems with idf/tf when prefixing and  
suffixing field boundaries in a single field like this. You will  
probably have to override Similarity to ignore the prefix and suffix  
tokens to avoid bad scores.


       karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34071-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 18:21:57 2008
Return-Path: <java-user-return-34071-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19168 invoked from network); 15 May 2008 18:21:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 18:21:57 -0000
Received: (qmail 57710 invoked by uid 500); 15 May 2008 18:21:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57675 invoked by uid 500); 15 May 2008 18:21:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57664 invoked by uid 99); 15 May 2008 18:21:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 11:21:50 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: 194.109.24.26 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.26] (HELO smtp-vbr6.xs4all.nl) (194.109.24.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 18:20:57 +0000
Received: from [10.0.2.2] (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr6.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4FILJb5052593
	for <java-user@lucene.apache.org>; Thu, 15 May 2008 20:21:19 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <CB445EFA-FE7B-40CA-A3E4-CAEE66B17F29@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <482C6FC5.509@arcetis.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Update document with fields which are not stored
Date: Thu, 15 May 2008 20:21:18 +0200
References: <482C6FC5.509@arcetis.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org


15 maj 2008 kl. 19.15 skrev Jean-Claude Antonio:
> This work perfectly, but for this we need to have a content field as
> new Field("content", content, Field.Store.YES, Field.Index.TOKENIZED)
> to be able to update the current document which stores the content.
>
> We wish not to store the content as the size of the index gets big.
>
> Is there a way to get the tokenized field value which is not stored?
> Or it would be great if we could use a method like  
> IndexWriter.updateDocuments(Query) but the only one is  
> IndexWriter.updateDocuments(Term).


Is Lucene your primary data store? That is considered to be a scary  
solution according to many people (although I like the idea) and they  
would probably recommend you storing a link to the source data rather  
than the data it self. An URL, a primary key, or what not.

Do you store the term vectors? It is then a peice of cake. If not you  
have to rebuild the document from the inverted index and that is a  
very expensive procedure.

LUCENE-1016 can be used to reconstruct token streams from any index.  
Luke also does stuff like this. Again, this is expensive.



        karl




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34072-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 19:50:16 2008
Return-Path: <java-user-return-34072-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59494 invoked from network); 15 May 2008 19:50:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 19:50:15 -0000
Received: (qmail 77250 invoked by uid 500); 15 May 2008 19:50:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77014 invoked by uid 500); 15 May 2008 19:50:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77003 invoked by uid 99); 15 May 2008 19:50:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 12:50:09 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [212.27.42.28] (HELO smtp2-g19.free.fr) (212.27.42.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 19:49:22 +0000
Received: from smtp2-g19.free.fr (localhost.localdomain [127.0.0.1])
	by smtp2-g19.free.fr (Postfix) with ESMTP id A4E2712B75F
	for <java-user@lucene.apache.org>; Thu, 15 May 2008 21:49:33 +0200 (CEST)
Received: from [192.168.0.6] (dau94-8-88-166-28-143.fbx.proxad.net [88.166.28.143])
	by smtp2-g19.free.fr (Postfix) with ESMTP id D566012B8CF
	for <java-user@lucene.apache.org>; Thu, 15 May 2008 21:49:28 +0200 (CEST)
Message-ID: <482C93D4.9000705@arcetis.com>
Date: Thu, 15 May 2008 21:49:40 +0200
From: Jean-Claude Antonio <jcantonio@arcetis.com>
Reply-To: jcantonio@arcetis.com
Organization: Arcetis
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Update document with fields which are not stored
References: <482C6FC5.509@arcetis.com>
In-Reply-To: <482C6FC5.509@arcetis.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

We are using lucene for a while, and we are happy with it. Now we want 
to optimize some space.
We are parsing versions of files and we want to keep track of history 
and also know which one is the newest we set a flag to it (field 
newest=true).
so when a new version comes along :
- we want to set the field "newest" of the current document to false.
To do so, we delete the document
and add a new document with the same fields
- then we add this new file with field newest=true

This work perfectly, but for this we need to have a content field as
new Field("content", content, Field.Store.YES, Field.Index.TOKENIZED)
to be able to update the current document which stores the content.

We wish not to store the content as the size of the index gets big.

Is there a way to get the tokenized field value which is not stored?
Or it would be great if we could use a method like 
IndexWriter.updateDocuments(Query) but the only one is 
IndexWriter.updateDocuments(Term).

Any hint?

Best regards,

Jean-Claude


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34073-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 20:35:05 2008
Return-Path: <java-user-return-34073-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80494 invoked from network); 15 May 2008 20:35:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 20:35:02 -0000
Received: (qmail 38815 invoked by uid 500); 15 May 2008 20:34:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38140 invoked by uid 500); 15 May 2008 20:34:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38129 invoked by uid 99); 15 May 2008 20:34:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 13:34:56 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.62] (HELO web50308.mail.re2.yahoo.com) (206.190.38.62)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 15 May 2008 20:34:00 +0000
Received: (qmail 49479 invoked by uid 60001); 15 May 2008 20:34:21 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=QZ5tFWzhIOMd9LFQQzVf50VBvez8U5z7NkG4CqB1+G49HUKwUA+AZ3d+j6p7Y8Rhg0gaVSamR07XxJXhJRJwnXusvCqnNLQlZ3mvyxhNJHrXBjWLvpSZPoHfBiLsB/RmZ69laW85gwIpwvLI1YIFk1uXeV7J4O/S0RXh3kyjmbM=;
X-YMail-OSG: Qc5XqRgVM1lqdV_h77ks3u4ocK5wosXk03kAECOn64nKcfZrCenIyQnk01WtigH5c84N.4nUtJM1L5aee8K3rCqY40ooZyOGQ2hTus4UaqZllAbV0HeX67G8mw--
Received: from [72.231.9.236] by web50308.mail.re2.yahoo.com via HTTP; Thu, 15 May 2008 13:34:21 PDT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Thu, 15 May 2008 13:34:21 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Document clustering with Lucene
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <307975.49378.qm@web50308.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Have you tried using Carrot2 with Lucene?  They work quite well in tandem!

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: Supheakmungkol SARIN <supheakmungkol@yahoo.com>
> To: java-user@lucene.apache.org
> Sent: Wednesday, May 14, 2008 11:23:45 PM
> Subject: Document clustering with Lucene
> 
> Dear all,
> 
> I'd like to do document clustering using full-text with Lucene. In other words, 
> I would like to group similar documents in their respective groups. I searched 
> the mailing list and found that there are two ways around. The first method is 
> to represent the one document as query and search the collection.  The other way 
> would be to construct the vector of terms of each of the documents and use the 
> cosine distance function to compute the similarity. I found these methods here:
> 
> - http://www.mail-archive.com/lucene-user@jakarta.apache.org/msg04916.html). 
> 
> I would like to know whether there are better way? or any built-in functions to 
> do clustering in the recent release version of Lucene?
> 
> Thank you.
> 
> Kind regards,
> 
> Supheakmungkol


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34074-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 22:35:54 2008
Return-Path: <java-user-return-34074-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57220 invoked from network); 15 May 2008 22:35:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 22:35:53 -0000
Received: (qmail 17638 invoked by uid 500); 15 May 2008 22:35:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17601 invoked by uid 500); 15 May 2008 22:35:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17590 invoked by uid 99); 15 May 2008 22:35:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 15:35:47 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 194.109.24.27 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.27] (HELO smtp-vbr7.xs4all.nl) (194.109.24.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 22:34:59 +0000
Received: from kodapan.lan (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr7.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4FMZDeM069266
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 00:35:13 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <5F0F4086-BF97-4963-8C39-194C1A297F52@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <482C65E9.7040304@informatics.jax.org>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Possible Bug when Querying?
Date: Fri, 16 May 2008 00:35:12 +0200
References: <482C65E9.7040304@informatics.jax.org>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org


15 maj 2008 kl. 18.33 skrev Matthew Hall:
>
> 12:23:05,602 INFO  [STDOUT]  
> org.apache.lucene.queryParser.ParseException: Cannot parse  
> '\*ache*': '*' not allowed as first character in PrefixQuery
> 12:23:05,602 INFO  [STDOUT] Failure in  
> QS_MarkerSearch.searchMarkerNomen
> 12:23:05,602 ERROR [STDERR] java.lang.NullPointerException
> 12:23:05,602 ERROR [STDERR]     at  
> org 
> .jax.mgi.search.model.QS_MarkerSearch.searchInexactMatches(Unknown  
> Source)
>
>
> Which looks to me alot like something akin to the  
> AllowLeadingWildcard stuff that comes along with wildcardqueries.
>
> But, the odd thing is the leading character in my search string  
> ISN'T *, its the escaped star character, which I would have thought  
> would work with no problems at all.
>
> Have I stumbled across a bug here?


Did you setAllowLeadingWildcard(true)?

   /**
    * Set to <code>true</code> to allow leading wildcard characters.
    * <p>
    * When set, <code>*</code> or <code>?</code> are allowed as
    * the first character of a PrefixQuery and WildcardQuery.
    * Note that this can produce very slow
    * queries on big indexes.
    * <p>
    * Default: false.
    */
   public void setAllowLeadingWildcard(boolean allowLeadingWildcard) {



      karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34075-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 15 23:33:36 2008
Return-Path: <java-user-return-34075-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80651 invoked from network); 15 May 2008 23:33:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 May 2008 23:33:36 -0000
Received: (qmail 58673 invoked by uid 500); 15 May 2008 23:33:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58644 invoked by uid 500); 15 May 2008 23:33:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58633 invoked by uid 99); 15 May 2008 23:33:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 16:33:30 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 23:32:44 +0000
Received: from [127.0.0.1] (ckpvpnclient117.jax.org [10.150.1.117])
	by mirkwood.informatics.jax.org (8.13.8/8.13.8) with ESMTP id m4FNWt2W001753
	for <java-user@lucene.apache.org>; Thu, 15 May 2008 19:32:57 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <482CC7F7.5020503@informatics.jax.org>
Date: Thu, 15 May 2008 19:32:07 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 1.5.0.14 (Windows/20071210)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Possible Bug when Querying?
References: <482C65E9.7040304@informatics.jax.org> <5F0F4086-BF97-4963-8C39-194C1A297F52@gmail.com>
In-Reply-To: <5F0F4086-BF97-4963-8C39-194C1A297F52@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

No I did not, because I'm not performing a search with a leading 
wildcard, nor am I intending to allow that behavior.  But what I do want 
to be able to search on is a word that starts with a * by escaping it, 
because sadly our data contains such things.

Matt

Karl Wettin wrote:
>
> 15 maj 2008 kl. 18.33 skrev Matthew Hall:
>>
>> 12:23:05,602 INFO  [STDOUT] 
>> org.apache.lucene.queryParser.ParseException: Cannot parse '\*ache*': 
>> '*' not allowed as first character in PrefixQuery
>> 12:23:05,602 INFO  [STDOUT] Failure in QS_MarkerSearch.searchMarkerNomen
>> 12:23:05,602 ERROR [STDERR] java.lang.NullPointerException
>> 12:23:05,602 ERROR [STDERR]     at 
>> org.jax.mgi.search.model.QS_MarkerSearch.searchInexactMatches(Unknown 
>> Source)
>>
>>
>> Which looks to me alot like something akin to the 
>> AllowLeadingWildcard stuff that comes along with wildcardqueries.
>>
>> But, the odd thing is the leading character in my search string ISN'T 
>> *, its the escaped star character, which I would have thought would 
>> work with no problems at all.
>>
>> Have I stumbled across a bug here?
>
>
> Did you setAllowLeadingWildcard(true)?
>
>   /**
>    * Set to <code>true</code> to allow leading wildcard characters.
>    * <p>
>    * When set, <code>*</code> or <code>?</code> are allowed as
>    * the first character of a PrefixQuery and WildcardQuery.
>    * Note that this can produce very slow
>    * queries on big indexes.
>    * <p>
>    * Default: false.
>    */
>   public void setAllowLeadingWildcard(boolean allowLeadingWildcard) {
>
>
>
>      karl
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

-- 
Matthew Hall
Software Engineer
Mouse Genome Informatics
mhall@informatics.jax.org
(207) 288-6012



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34076-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 00:02:56 2008
Return-Path: <java-user-return-34076-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90569 invoked from network); 16 May 2008 00:02:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 00:02:55 -0000
Received: (qmail 84877 invoked by uid 500); 16 May 2008 00:02:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84745 invoked by uid 500); 16 May 2008 00:02:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84734 invoked by uid 99); 16 May 2008 00:02:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 17:02:49 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [212.27.42.28] (HELO smtp2-g19.free.fr) (212.27.42.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 00:01:55 +0000
Received: from smtp2-g19.free.fr (localhost.localdomain [127.0.0.1])
	by smtp2-g19.free.fr (Postfix) with ESMTP id 5F9AA12B6B9
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 02:02:17 +0200 (CEST)
Received: from [192.168.0.6] (dau94-8-88-166-28-143.fbx.proxad.net [88.166.28.143])
	by smtp2-g19.free.fr (Postfix) with ESMTP id 318B912B6A8
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 02:02:17 +0200 (CEST)
Message-ID: <482CCF14.2090802@arcetis.com>
Date: Fri, 16 May 2008 02:02:28 +0200
From: Jean-Claude Antonio <jcantonio@arcetis.com>
Reply-To: jcantonio@arcetis.com
Organization: Arcetis
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Update document with fields which are not stored
References: <482C6FC5.509@arcetis.com> <CB445EFA-FE7B-40CA-A3E4-CAEE66B17F29@gmail.com>
In-Reply-To: <CB445EFA-FE7B-40CA-A3E4-CAEE66B17F29@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Karl.
My apologies for the duplicate mail sent.

 >>Is Lucene your primary data store?
Almost, as most properties of my items can be queried. I would like to 
be able to "not" store these fields though, but the fact that I need to 
update my documents (delete + create), forces me to store them.
I do not store term vectors (I have never used them).
I will have a look at it + LUCENE-1016 if can help. And let you know.
Thanks for your help!



Karl Wettin a crit :
>
> 15 maj 2008 kl. 19.15 skrev Jean-Claude Antonio:
>> This work perfectly, but for this we need to have a content field as
>> new Field("content", content, Field.Store.YES, Field.Index.TOKENIZED)
>> to be able to update the current document which stores the content.
>>
>> We wish not to store the content as the size of the index gets big.
>>
>> Is there a way to get the tokenized field value which is not stored?
>> Or it would be great if we could use a method like 
>> IndexWriter.updateDocuments(Query) but the only one is 
>> IndexWriter.updateDocuments(Term).
>
>
> Is Lucene your primary data store? That is considered to be a scary 
> solution according to many people (although I like the idea) and they 
> would probably recommend you storing a link to the source data rather 
> than the data it self. An URL, a primary key, or what not.
>
> Do you store the term vectors? It is then a peice of cake. If not you 
> have to rebuild the document from the inverted index and that is a 
> very expensive procedure.
>
> LUCENE-1016 can be used to reconstruct token streams from any index. 
> Luke also does stuff like this. Again, this is expensive.
>
>
>
>        karl
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34077-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 02:53:52 2008
Return-Path: <java-user-return-34077-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56238 invoked from network); 16 May 2008 02:53:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 02:53:52 -0000
Received: (qmail 72052 invoked by uid 500); 16 May 2008 02:53:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72020 invoked by uid 500); 16 May 2008 02:53:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72009 invoked by uid 99); 16 May 2008 02:53:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 19:53:46 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of adb@teamware.com designates 212.226.92.15 as permitted sender)
Received: from [212.226.92.15] (HELO monkey.teamware.com) (212.226.92.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 02:52:53 +0000
Received: from intrepid.teamw.com (intrepid.teamw.com [10.142.128.11])
	by monkey.teamware.com (8.13.1/8.13.1) with ESMTP id m4G2r7Ew020529
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 05:53:07 +0300
X-Map-MIXER-Originators: false
To: java-user@lucene.apache.org
From: "Bowesman Antony"
 <adb@teamware.com>
MIME-Version: 1.0
Date: 16 May 2008 05:52:00 +0300
Subject: OT: Parsing Russian text from RTF
Envelope-ID: JA8AAAAAAPlBaQABYQABSOwLQb5U@teamware.com
Message-Id: <JA8AAAAAAPlBaQABYQABSOwLQb5U@teamware.com>
X-Mailer: TeamWARE Connector for MIME
Content-Type: text/plain; charset=koi8-r
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-1.6 (monkey.teamware.com [212.226.92.15]); Fri, 16 May 2008 05:53:07 +0300 (EEST)
X-TWG-MailScanner-Information: See www.mailscanner.info for information
X-TWG-MailScanner: Found to be clean
X-TWG-MailScanner-SpamCheck: not spam, SpamAssassin (score=2.1, required 5,
	AHKYY__XXX 2.10)
X-TWG-MailScanner-SpamScore: 2
X-MailScanner-From: adb@teamware.com
X-Virus-Checked: Checked by ClamAV on apache.org

Not directly Lucene related, but I'm out of ideas and I'm not a Russian speaker...

I'm extracting text from RTF to pump into Lucene.  I'm using the original 
RTFEditorKit() code shown in LIA, p252 (actually, it's Nutch's RTFParser)

I have an RTF document, which starts with

---
{\rtf1\ansi\ansicpg1252\deff0\deflang1033{\fonttbl{\f0\froman\fprq2\fcharset204{\*\fname 
Times New Roman;}Times New Roman CYR;}{\f1\fswiss\fprq2\fcharset0 Arial;}}
{\colortbl ;\red0\green0\blue128;\red0\green0\blue0;}
\viewkind4\uc1\pard\tx360\cf1\f0\fs20\'c1\'ee\'eb\'fc\'f8\'e8\'ed\'f1\'f2\'e2\'ee
---

which should be '', but when the RTFReader translationTable always 
maps the RTF bytes to char using latin1 and it never sets the correct 
translationTable.  The "fcharset204" is Russian, apparently CP1251, but there's 
a lovely line in the RTFReader class

/* TODO: per-font font encodings ( \fcharset control word ) ? */

Does anyone know if the RTF above is correct - the only place the translation 
table is set during the parse is when the 'ansi' keyword is set.

Other than that, anyone have any ideas about getting the text out of the RTF 
properly?

Thanks
Antony


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34078-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 03:55:25 2008
Return-Path: <java-user-return-34078-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68043 invoked from network); 16 May 2008 03:55:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 03:55:24 -0000
Received: (qmail 99908 invoked by uid 500); 16 May 2008 03:55:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99719 invoked by uid 500); 16 May 2008 03:55:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99708 invoked by uid 99); 16 May 2008 03:55:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 20:55:18 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of hasan.diwan@gmail.com designates 209.85.146.180 as permitted sender)
Received: from [209.85.146.180] (HELO wa-out-1112.google.com) (209.85.146.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 03:54:33 +0000
Received: by wa-out-1112.google.com with SMTP id l24so907666waf.11
        for <java-user@lucene.apache.org>; Thu, 15 May 2008 20:54:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=7VocU0QnulkLyGHdYlG3bGb1f7RovlBsgOztwFw9OnQ=;
        b=SOSBmwN8jvYg6fSGe/cqu4y23GGy4HuL2hP9BlrJ7Zs/fwbfJBscPksp3Jdwv3xZGVABCuMidJMls1Ke/IkvkFpKyvt4et3gcAFeTqf6tCkKOyO4hzQpIC7wbhvkncFy4mTzQlPzHeF3nxvb9//rG2zf4Q238OB1MNcqf41M7Rs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=Zk4qUgx5pTksUPbVb9JK1/VmjiHH1oR2MzRtCW3yyNTQjpiQ7bXneKOoHRFbnf0EtDPaTKxOCVJnINW1WR+yiuhXQGa2APwOdrwi+mkYIGHOh13kZqg0HNH8X0e/F/kF6WDZGrDmZzkc1go+UO2yLg3Droh+yCm+yLVl8JwEuHk=
Received: by 10.114.95.1 with SMTP id s1mr3259186wab.221.1210910088958;
        Thu, 15 May 2008 20:54:48 -0700 (PDT)
Received: by 10.114.200.20 with HTTP; Thu, 15 May 2008 20:54:48 -0700 (PDT)
Message-ID: <2cda2fc90805152054u36379cfcq18d266e88be4c368@mail.gmail.com>
Date: Thu, 15 May 2008 20:54:48 -0700
From: "Hasan Diwan" <hasan.diwan@gmail.com>
To: java-user@lucene.apache.org
Subject: All results
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

It would appear that to see all results (including low scoring) I need
to pass a different Filter to Searcher.search[1]. If filter is null,
only the highest-scoring results are returned. How do I change the
threshold for hits returned?

-- 
Cheers,
Hasan Diwan <hasan.diwan@gmail.com>
1. http://lucene.apache.org/java/2_3_1/api/core/org/apache/lucene/search/Searchable.html#search(org.apache.lucene.search.Weight,
org.apache.lucene.search.Filter,
org.apache.lucene.search.HitCollector)

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34079-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 04:01:16 2008
Return-Path: <java-user-return-34079-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69242 invoked from network); 16 May 2008 04:01:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 04:01:15 -0000
Received: (qmail 6388 invoked by uid 500); 16 May 2008 04:01:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6363 invoked by uid 500); 16 May 2008 04:01:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6352 invoked by uid 99); 16 May 2008 04:01:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 21:01:09 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.39.202] (HELO web50311.mail.re2.yahoo.com) (206.190.39.202)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 16 May 2008 04:00:21 +0000
Received: (qmail 58462 invoked by uid 60001); 16 May 2008 04:00:34 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=Rsi859AlZE6VQL2QJEZrkvKIaG1XBBCC/W7Jp+eUh2dgKPIETqivSgVLbRnCQIWQ2wdljmuvyxaQBPyHdF8b6n6rxSIk0EPj9I5v1nGapH7KHVoK0RfXhcBZfXd0xdfuT8tnMuX1vogkDNDZo3WuE399UH3eWDiOKeNt/gRV/Lc=;
X-YMail-OSG: LghhdmEVM1khsWdj4R5KNBUOAEtut6Pr946jvijKY1YNjusBS_YXAqapZfdBueK6biGxTbYqgDBNtpa1_G4XRXVQBR7Mb5BcL4OlqzdG7VUj2QV6_w7FUhGM3w--
Received: from [72.231.9.236] by web50311.mail.re2.yahoo.com via HTTP; Thu, 15 May 2008 21:00:34 PDT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Thu, 15 May 2008 21:00:34 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: confused about an entry in the FAQ
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
Message-ID: <769085.58226.qm@web50311.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

pong.=0AIs that the most optimal use of FieldSelector?  What happens if you=
 remove it from that HitCollector.collect method?=0AIt looks like you are c=
reating a new FieldSelector object for each hit found in each search thread=
.=0A=0AIf it's not that, is the index optimized?=0AIf not, does optimizing =
it make a difference?=0A=0AYou are also examining every each and every Docu=
ment in the result set.  Do you really need to do that?  That's expensive a=
nd you may be witnessing the cost.=0A=0AOtis=0A--=0ASematext -- http://sema=
text.com/ -- Lucene - Solr - Nutch=0A=0A=0A----- Original Message ----=0A> =
From: Stephane Nicoll <stephane.nicoll@gmail.com>=0A> To: java-user@lucene.=
apache.org=0A> Sent: Wednesday, May 14, 2008 2:38:25 AM=0A> Subject: Re: co=
nfused about an entry in the FAQ=0A> =0A> ping. Sorry for the long email bu=
t I prefer to provide all information first.=0A> =0A> On Mon, May 12, 2008 =
at 12:13 PM, Stephane Nicoll=0A> wrote:=0A> > I tried all this and I am con=
fused about the result. I am trying to=0A> >  implement an hybrid query han=
dler where I fetch the IDs from a=0A> >  database criteria and the IDs from=
 a full text lucene query and I=0A> >  intersect them to return the result =
to the user. The database query=0A> >  and the intersection works fine even=
 with high load. However the=0A> >  lucene query is much slower when the nu=
mber of concurrent users=0A> >  raises.=0A> >=0A> >  Here is what I am doin=
g on the lucene side=0A> >=0A> >         final QueryParser queryParser =3D =
new=0A> >  QueryParser(criteria.getDefaultField(), analyzer);=0A> >        =
 final Query q =3D queryParser.parse(criteria.getFullTextQuery());=0A> >   =
      // Index Searcher is shared for all threads and is not=0A> >  reopene=
d during the load test=0A> >         final IndexSearcher indexSearcher =3D =
getIndexSearcher();=0A> >         final Setresult =3D new TreeSet();=0A> > =
        indexSearcher.search(q, new HitCollector() {=0A> >             publ=
ic void collect(int i, float v) {=0A> >                 try {=0A> >        =
             final Document d =3D=0A> >  indexSearcher.getIndexReader().doc=
ument(i, new FieldSelector() {=0A> >                         public FieldSe=
lectorResult accept(String s) {=0A> >                             if (s.equ=
als(CatalogItem.ATTR_ID)) {=0A> >                                 return Fi=
eldSelectorResult.LOAD;=0A> >                             } else {=0A> >   =
                              return FieldSelectorResult.NO_LOAD;=0A> >    =
                         }=0A> >                         }=0A> >           =
          });=0A> >                     result.add(Long.parseLong(d.get(Cat=
alogItem.ATTR_ID)));=0A> >                 } catch (IOException e) {=0A> > =
                    throw new RuntimeException("Could not collect=0A> >  lu=
cene IDs", e);=0A> >                 }=0A> >             }=0A> >         })=
;=0A> >         return result;=0A> >=0A> >=0A> >  When running with one thr=
ead, I have the following figures per test:=0A> >=0A> >  Database query is =
done in[125 msecs] (size=3D598]=0A> >  Lucene query is done in[80 msecs (si=
ze=3D15204]=0A> >  Intersect is done in[4 msecs] (size=3D103]=0A> >  Hybrid=
 query is done in[97 msecs]=0A> >=0A> >  -> 327 msec / user=0A> >=0A> >  Wh=
en running with ten threads, I have the following figures per user per =0A>=
 test:=0A> >=0A> >  Database query is done in[222 msecs] (size=3D94]=0A> > =
 Lucene query is done in[2364 msecs (size=3D15367]=0A> >  Intersect is done=
 in[0 msecs] (size=3D12]=0A> >  Hybrid query is done in[18 msecs]=0A> >=0A>=
 >  -> 2.5 sec / user !!=0A> >=0A> >  I am just wondering how I can improve=
 this. Clearly there is something=0A> >  wrong in my code since it's much s=
lower with multiple threads running=0A> >  concurrently on the same index. =
The size of the index is 5Mb, I only=0A> >  store:=0A> >=0A> >  * an "id" f=
ield (which is the primary key of the related object in the db=0A> >  * a "=
class" field which is the class nazme of the related object=0A> >  (Hiberna=
te search does that for me)=0A> >=0A> >  The "keywords" field is indexed bu=
t not stored as it is a=0A> >  representation of other data stored in the d=
b. The searches are=0A> >  performed on the keywords field only ("foo AND b=
ar" is a typical=0A> >  query)=0A> >=0A> >  Any help is appreciated. If you=
 also know a Spring bean that could=0A> >  take care of opening/closing the=
 index readers properly, let me know.=0A> >  Hibernate Search introduces de=
adlock with multiple threads and the=0A> >  lucene integration in spring mo=
dules does not seeem to do what I want.=0A> >=0A> >  Thanks,=0A> >  St=E9ph=
ane=0A> >=0A> >=0A> >=0A> >=0A> >  On Sat, May 10, 2008 at 8:05 PM, Patrick=
 Turcotte wrote:=0A> >  > Did you try the IndexSearcher.doc(int i, FieldSel=
ector fieldSelector)  =0A> method?=0A> >  >=0A> >  >  Could be faster becau=
se Lucene don't have do "prepare" the whole document.=0A> >  >=0A> >  >  Pa=
trick=0A> >  >=0A> >  >=0A> >  >  On Sat, May 10, 2008 at 9:35 AM, Stephane=
 Nicoll=0A> >  >  wrote:=0A> >  >=0A> >  >=0A> >  > > From the FAQ:=0A> >  =
>  >=0A> >  >  > "Don't iterate over more hits than needed.=0A> >  >  > Ite=
rating over all hits is slow for two reasons. Firstly, the search()=0A> >  =
>  > method that returns a Hits object re-executes the search internally=0A=
> >  >  > when you need more than 100 hits. Solution: use the search method=
 that=0A> >  >  > takes a HitCollector instead."=0A> >  >  >=0A> >  >  > I =
had a look to HitCollector but it returns the documentId and the=0A> >  >  =
> javadoc recommends not fetching the original query there.=0A> >  >  >=0A>=
 >  >  > I have to return *one* indexed field from the query result and=0A>=
 >  >  > currently I am iterating on all results and it's slow. Can you exp=
lain=0A> >  >  > a bit more how I could improve this?=0A> >  >  >=0A> >  > =
 > Thanks,=0A> >  >  > St=E9phane=0A> >  >  >=0A> >  >  >=0A> >  >  > --=0A=
> >  >  > Large Systems Suck: This rule is 100% transitive. If you build on=
e,=0A> >  >  > you suck" -- S.Yegge=0A> >  >  >=0A> >  >=0A> >  > > -------=
--------------------------------------------------------------=0A> >  >  > =
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org=0A> >  >=0A=
> >  > > For additional commands, e-mail: java-user-help@lucene.apache.org=
=0A> >  >  >=0A> >  >  >=0A> >  >=0A> >  >=0A> >  > -----------------------=
----------------------------------------------=0A> >  >  To unsubscribe, e-=
mail: java-user-unsubscribe@lucene.apache.org=0A> >  >=0A> >  >=0A> >  > Fo=
r additional commands, e-mail: java-user-help@lucene.apache.org=0A> >  >=0A=
> >  >=0A> >=0A> >=0A> >=0A> >  --=0A> >=0A> >=0A> > Large Systems Suck: Th=
is rule is 100% transitive. If you build one,=0A> >  you suck" -- S.Yegge=
=0A> >=0A> =0A> =0A> =0A> -- =0A> Large Systems Suck: This rule is 100% tra=
nsitive. If you build one,=0A> you suck" -- S.Yegge=0A> =0A> --------------=
-------------------------------------------------------=0A> To unsubscribe,=
 e-mail: java-user-unsubscribe@lucene.apache.org=0A> For additional command=
s, e-mail: java-user-help@lucene.apache.org=0A

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34080-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 04:05:33 2008
Return-Path: <java-user-return-34080-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70873 invoked from network); 16 May 2008 04:05:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 04:05:33 -0000
Received: (qmail 9939 invoked by uid 500); 16 May 2008 04:05:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9901 invoked by uid 500); 16 May 2008 04:05:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9890 invoked by uid 99); 16 May 2008 04:05:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 21:05:28 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.243] (HELO web50310.mail.re2.yahoo.com) (206.190.38.243)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 16 May 2008 04:04:31 +0000
Received: (qmail 42161 invoked by uid 60001); 16 May 2008 04:04:52 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=seQYiNerY/VPjoeHLWN5PfU0QvYZXWQZARnQeVs4jSR1pxoiNeiPyOKV7/k3Lri5bpdPvmH7+Dl47AWslkB9K7tNFu1CjDHTyAcrLALQvak0/6xHGjba2veCM5jMnJKx5EWQ6cX0c8NuX9z3PBXp+69DeSSgm20ihE1aIM7/Jv4=;
X-YMail-OSG: tq83GuQVM1kzxJoRV.yMClvur5_Ab_CEsvxYxD9T3UvB1rQ..OLlIzCWDACtTtNZFn8e2_N8P5VFIeS7SD3iCKA_zHgxIpHuuvrVhY5GRfHNMt80MneBgYlofg--
Received: from [72.231.9.236] by web50310.mail.re2.yahoo.com via HTTP; Thu, 15 May 2008 21:04:52 PDT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Thu, 15 May 2008 21:04:52 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: All results
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <313829.42047.qm@web50310.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Hasan,

That method should let you have *all* non-zero scoring docs if filter == null.
If that's not the case then I think that's a bug.  If you can come up with a unit test that shows the bug, please post it in JIRA.


Thanks,
Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: Hasan Diwan <hasan.diwan@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Thursday, May 15, 2008 11:54:48 PM
> Subject: All results
> 
> It would appear that to see all results (including low scoring) I need
> to pass a different Filter to Searcher.search[1]. If filter is null,
> only the highest-scoring results are returned. How do I change the
> threshold for hits returned?
> 
> -- 
> Cheers,
> Hasan Diwan 
> 1. 
> http://lucene.apache.org/java/2_3_1/api/core/org/apache/lucene/search/Searchable.html#search(org.apache.lucene.search.Weight,
> org.apache.lucene.search.Filter,
> org.apache.lucene.search.HitCollector)
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34081-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 04:29:23 2008
Return-Path: <java-user-return-34081-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74925 invoked from network); 16 May 2008 04:29:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 04:29:22 -0000
Received: (qmail 27779 invoked by uid 500); 16 May 2008 04:29:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27739 invoked by uid 500); 16 May 2008 04:29:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27728 invoked by uid 99); 16 May 2008 04:29:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 21:29:17 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of hasan.diwan@gmail.com designates 209.85.198.233 as permitted sender)
Received: from [209.85.198.233] (HELO rv-out-0506.google.com) (209.85.198.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 04:28:31 +0000
Received: by rv-out-0506.google.com with SMTP id f6so763463rvb.5
        for <java-user@lucene.apache.org>; Thu, 15 May 2008 21:28:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=GG8iJ272sUZjfIBTLTJTyg1+R5eqE5O91XPXAei0l/c=;
        b=onlfOse8uMOSIzxakdDQHFb5CmzHZ/zM35RXoab9Ak++kHHU00polG9zOZPCL1j7usJEhp7uPM3c1tLn2iylhpmhu33zVz0EK/f4ryNG31gsI2564v1iktJtQqUwqSnqeHKGaL01AhB/hJBcqNW2vavKII1d82Qup+hR3lQGuX0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=XGLKLNxNFAPc2AiXr3S9eSimB4UPFZCc+LPIhjNnvkWKG+3Cx8XOnkm95IaZje1Ca+XzP7ksa0MFuwXu9Bs+s5y98q5VMlZ6y0ZLuPfU2BVrN86E8WBDeWEpZHwPBoI81Cu8HdtzPa+cNMifRI7FpjMg94D/TrwqVigy/dRYU9Y=
Received: by 10.114.174.2 with SMTP id w2mr3331587wae.17.1210912126560;
        Thu, 15 May 2008 21:28:46 -0700 (PDT)
Received: by 10.114.200.20 with HTTP; Thu, 15 May 2008 21:28:46 -0700 (PDT)
Message-ID: <2cda2fc90805152128i4b42883fl90620a3a6b29738b@mail.gmail.com>
Date: Thu, 15 May 2008 21:28:46 -0700
From: "Hasan Diwan" <hasan.diwan@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: All results
In-Reply-To: <313829.42047.qm@web50310.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <313829.42047.qm@web50310.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Otis,

On 15/05/2008, Otis Gospodnetic <otis_gospodnetic@yahoo.com> wrote:
>  That method should let you have *all* non-zero scoring docs if filter == null.
>  If that's not the case then I think that's a bug.  If you can come up with a unit test that shows the bug, please post it in JIRA.

>From the lucene source...
  public final Hits search(Query query) throws IOException {
    return search(query, (Filter)null);
  }[1]

this will not print all results, according to [2]. I would like it to.

By default, lucene will not display low-scoring results -- how you set
this minimum score is beyond a cursory glance at the source code --
I'd like lucene to return all matching documents, irrespective of hit
score. Many thanks for the help.
-- 
Cheers,
Hasan Diwan <hasan.diwan@gmail.com>
1. Search.java, 2.3.1
2.  http://lucene.apache.org/java/2_3_1/api/core/org/apache/lucene/search/Searchable.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34082-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 05:30:19 2008
Return-Path: <java-user-return-34082-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89903 invoked from network); 16 May 2008 05:30:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 05:30:19 -0000
Received: (qmail 54760 invoked by uid 500); 16 May 2008 05:30:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54731 invoked by uid 500); 16 May 2008 05:30:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54720 invoked by uid 99); 16 May 2008 05:30:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 22:30:13 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.39.214] (HELO web50312.mail.re2.yahoo.com) (206.190.39.214)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 16 May 2008 05:29:24 +0000
Received: (qmail 52983 invoked by uid 60001); 16 May 2008 05:29:38 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=V2zd9Q5VUsP/5fRM6czuEcOSyHHApUANgenV05q22o/nfA2tPjPxf8SnHqnh4jjy5ZIrFkTSv1D8c2M/91/6ISuhMUx0T/uEEJuiciXs1FZ8K+neE2tBC351ZpHdUHZO1ltcZfzZik2Le7xd7NAl5ICUEiLfei05Nir4guuODsg=;
X-YMail-OSG: s099rLsVM1lac_WA7cTkCqEnEq_XDm.zubSlvWpltUNkgz7VGX6Hu1NvfUpyMLNnxSln.wlzzO.yGq.MkawGTMfLbkrcz5o099zD3NAMaXMvn1tkGXrUngYXGw--
Received: from [72.231.9.236] by web50312.mail.re2.yahoo.com via HTTP; Thu, 15 May 2008 22:29:37 PDT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Thu, 15 May 2008 22:29:37 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: All results
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <133621.52956.qm@web50312.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

You can get all matches via Hits if you want, it's just that Lucene will need to do some re-querying under the hood.  Why don't you use the search(....) method that takes HitCollector to get all docs - I thought that's what you were trying to use in the first place.

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: Hasan Diwan <hasan.diwan@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Friday, May 16, 2008 12:28:46 AM
> Subject: Re: All results
> 
> Otis,
> 
> On 15/05/2008, Otis Gospodnetic wrote:
> >  That method should let you have *all* non-zero scoring docs if filter == 
> null.
> >  If that's not the case then I think that's a bug.  If you can come up with a 
> unit test that shows the bug, please post it in JIRA.
> 
> From the lucene source...
>   public final Hits search(Query query) throws IOException {
>     return search(query, (Filter)null);
>   }[1]
> 
> this will not print all results, according to [2]. I would like it to.
> 
> By default, lucene will not display low-scoring results -- how you set
> this minimum score is beyond a cursory glance at the source code --
> I'd like lucene to return all matching documents, irrespective of hit
> score. Many thanks for the help.
> -- 
> Cheers,
> Hasan Diwan 
> 1. Search.java, 2.3.1
> 2.  
> http://lucene.apache.org/java/2_3_1/api/core/org/apache/lucene/search/Searchable.html
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34083-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 05:59:38 2008
Return-Path: <java-user-return-34083-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94457 invoked from network); 16 May 2008 05:59:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 05:59:36 -0000
Received: (qmail 69126 invoked by uid 500); 16 May 2008 05:59:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68511 invoked by uid 500); 16 May 2008 05:59:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68500 invoked by uid 99); 16 May 2008 05:59:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 22:59:31 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of hasan.diwan@gmail.com designates 209.85.146.182 as permitted sender)
Received: from [209.85.146.182] (HELO wa-out-1112.google.com) (209.85.146.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 05:58:43 +0000
Received: by wa-out-1112.google.com with SMTP id l24so4044waf.11
        for <java-user@lucene.apache.org>; Thu, 15 May 2008 22:58:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=njDJDdp1QT+Au1aA1IHuy15fp0fwPvX12Us49QAIo3Q=;
        b=FMwrz9Ma8jHG3MccmSsUpJkxQ1JWewLYRnxyOjwMXLh+HBJYPvwLtM/VepClAw8ZLdERhb2iu5R5CslGA33qJVY77QL3SVwZuhV0nWS0sFY1DKIr12vydGq/p8nmbYB7YvANqgRIQ8yDZib+qemnNTNl+ykrlmGGIzTt8tg9nN4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=eZza3jQPcqBwK8S3rJgGDfUGa92+RKKUSit9suOO190ueAe/N4QgarO2XqWZAD+4+ErhS78oUbRW/Yr8GvLs5AiUDjGMofdC0e1TRxB4k7SQYRDeonmekV4hvsQYBN1DG16O90hVkq9M3J4y9A1bhL1WSE25/CB2UlqF9kl7qfQ=
Received: by 10.114.144.1 with SMTP id r1mr3340314wad.136.1210916936369;
        Thu, 15 May 2008 22:48:56 -0700 (PDT)
Received: by 10.114.200.20 with HTTP; Thu, 15 May 2008 22:48:56 -0700 (PDT)
Message-ID: <2cda2fc90805152248r15306dbenddca2c09c35deec5@mail.gmail.com>
Date: Thu, 15 May 2008 22:48:56 -0700
From: "Hasan Diwan" <hasan.diwan@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: All results
In-Reply-To: <133621.52956.qm@web50312.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <133621.52956.qm@web50312.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

On 15/05/2008, Otis Gospodnetic <otis_gospodnetic@yahoo.com> wrote:
>  You can get all matches via Hits if you want, it's just that Lucene will need to do some re-querying under the hood.  Why don't you use the search(....) method that takes HitCollector to get all docs - I thought that's what you were trying to use in the first place.

I'm missing something elementary here. My query, done in luke[1]
produces 4 documents for the term "book". But, submitted via my code,
produces only 3. The one seems to be eliminated because the scores are
the same. However, it's a different document. How do I get lucene to
reflect this?

-- 
Cheers,
Hasan Diwan <hasan.diwan@gmail.com>
1. http://luke.getopt.org

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34084-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 06:07:58 2008
Return-Path: <java-user-return-34084-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96445 invoked from network); 16 May 2008 06:07:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 06:07:58 -0000
Received: (qmail 73882 invoked by uid 500); 16 May 2008 06:07:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73846 invoked by uid 500); 16 May 2008 06:07:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73835 invoked by uid 99); 16 May 2008 06:07:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 May 2008 23:07:52 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.58] (HELO web50304.mail.re2.yahoo.com) (206.190.38.58)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 16 May 2008 06:06:56 +0000
Received: (qmail 63498 invoked by uid 60001); 16 May 2008 06:07:17 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=qY9Xm/jE+sYmmXnP5S2DXFUMeL1/OuYTsRV82x2nycvm/cd1RAjoUSJWr0CnkTsgdCWg8RkEOwPMnSiAYiO8TELjRQKtmI7zPk1gk0TDFC047WfLRZIi7knEKdA2DTkjj7yi7v5fVz+hChcYbrDmMy9a6apMDT+9ymXAkIcyOA0=;
X-YMail-OSG: OkqNskAVM1kYC5.aHG3FOR3GfG59B.ZYHTgPJgNRJsMA4em.fBHqEpXxktx8h.UlPvK5C7zZ666oWBrTpEQ8ZS.1BNiaAzVGZpbaCwUgMMTCsvxNRLzgDe50Zw--
Received: from [72.231.9.236] by web50304.mail.re2.yahoo.com via HTTP; Thu, 15 May 2008 23:07:16 PDT
X-Mailer: YahooMailRC/975.38 YahooMailWebService/0.7.185
Date: Thu, 15 May 2008 23:07:16 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: All results
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <67084.62993.qm@web50304.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

What does your code look like?  If you are using Hits, what does hits.length() give you?

 Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: Hasan Diwan <hasan.diwan@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Friday, May 16, 2008 1:48:56 AM
> Subject: Re: All results
> 
> On 15/05/2008, Otis Gospodnetic wrote:
> >  You can get all matches via Hits if you want, it's just that Lucene will need 
> to do some re-querying under the hood.  Why don't you use the search(....) 
> method that takes HitCollector to get all docs - I thought that's what you were 
> trying to use in the first place.
> 
> I'm missing something elementary here. My query, done in luke[1]
> produces 4 documents for the term "book". But, submitted via my code,
> produces only 3. The one seems to be eliminated because the scores are
> the same. However, it's a different document. How do I get lucene to
> reflect this?
> 
> -- 
> Cheers,
> Hasan Diwan 
> 1. http://luke.getopt.org
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34085-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 09:02:46 2008
Return-Path: <java-user-return-34085-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54653 invoked from network); 16 May 2008 09:02:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 09:02:46 -0000
Received: (qmail 21179 invoked by uid 500); 16 May 2008 09:02:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20974 invoked by uid 500); 16 May 2008 09:02:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20963 invoked by uid 99); 16 May 2008 09:02:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 02:02:40 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [76.13.9.27] (HELO web65407.mail.ac4.yahoo.com) (76.13.9.27)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 16 May 2008 09:01:53 +0000
Received: (qmail 74427 invoked by uid 60001); 16 May 2008 09:02:07 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=FIj06jyLVUsCvnyThvIkItIup0rmT0hBtdWi2nK4qz44e31K186PWnHa5/B9mavmU859d4cehmFEkSyrrPj7R7RRc01+kbrg+tc8gsjJuquETTiQhzA5W8yJ/zRBcBleJCiFYGoczD+4vitH2q5vBtwdWkdxfMycgasdMs+OB4E=;
X-YMail-OSG: tDS.cugVM1nmiNIDo0GRmJI0KBqjNwW59BV8FvUonBqvjH7hL9mKQhbA6Z9ad.BPwcUMvOYqgPOdZMdYGM9PhgLwvajAQkLdVAh3
Received: from [85.178.138.242] by web65407.mail.ac4.yahoo.com via HTTP; Fri, 16 May 2008 02:02:07 PDT
Date: Fri, 16 May 2008 02:02:07 -0700 (PDT)
From: Ulf Dittmer <udittmer@yahoo.com>
Subject: search problem - not finding field values ending in "X"
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
Message-ID: <606064.73705.qm@web65407.mail.ac4.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hello-

I'm experiencing a weird issue searching an index. The
index has information about books, and one of the
fields is the ISBN number. It is stored in the index
in untokenized form to enable searches by ISBN. So a
query like "isbn:0071490833" would return the Document
for that book. But it doesn't find the document if the
ISBN ends in an "X", like "isbn:007149216X".

I know it's stored correctly, because if I retrieve
the document through a different query, I see that the
field contains the correct value.

It also works fine if I search for "isbn:007149216?".

Is the "X" some kind of special syntax?

Many thanks in advance for any hints,
Ulf



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34086-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 09:34:14 2008
Return-Path: <java-user-return-34086-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63928 invoked from network); 16 May 2008 09:34:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 09:34:14 -0000
Received: (qmail 58576 invoked by uid 500); 16 May 2008 09:34:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58549 invoked by uid 500); 16 May 2008 09:34:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58520 invoked by uid 99); 16 May 2008 09:34:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 02:34:08 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 209.85.146.182 as permitted sender)
Received: from [209.85.146.182] (HELO wa-out-1112.google.com) (209.85.146.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 09:33:22 +0000
Received: by wa-out-1112.google.com with SMTP id l24so97269waf.11
        for <java-user@lucene.apache.org>; Fri, 16 May 2008 02:33:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=ho5KeLwom7QkjaecDJdDKhLofNvJ0/EaXEjfYe+Apl0=;
        b=YKn6Q4ehpkjWdq+Jf7JHaRjCXiun2xH2NlFZaH0GlqLEQzSmTK5xnCB6LTis6V1i/8/Z53FwWX1tRnaeHFFVLPHn1WKGfpn4eqv40yxeSg6CvYA7bEv57jvBW7a/VkH04fQTtoEB/UitBkPYhUHjHDeg3oj1c450f7yZhOIIU9E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=g+B3Bv0C8MVDg2uREQKEZVokxTvbqMJXOVGKwzJhMFNu8yLvQMKvpLpq67kCIIIG8iN0vrVUqnUg4u8DroIMXJcDZuiBWr9m0JS/+Lykl6Dx+tSVHkOPWiIC84TMRd4Tn0fItDhBm5f8dNOSAZhOnewTkQWbNaF2ZJ2kxuW1QaI=
Received: by 10.114.132.5 with SMTP id f5mr3532459wad.201.1210930417247;
        Fri, 16 May 2008 02:33:37 -0700 (PDT)
Received: by 10.114.210.1 with HTTP; Fri, 16 May 2008 02:33:37 -0700 (PDT)
Message-ID: <8c4e68610805160233l3270fa0apee93514bab397b89@mail.gmail.com>
Date: Fri, 16 May 2008 10:33:37 +0100
From: "Ian Lea" <ian.lea@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: search problem - not finding field values ending in "X"
In-Reply-To: <606064.73705.qm@web65407.mail.ac4.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <606064.73705.qm@web65407.mail.ac4.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi


I bet you are using an analyzer that is downcasing isbn:007149216X to
isbn:007149216x.  I've been there! Options include creating the query
programmatically, using PerFieldAnalyzerWrapper, downcasing everything
yourself in advance.  Or convert to ISBN-13.


--
Ian.


On Fri, May 16, 2008 at 10:02 AM, Ulf Dittmer <udittmer@yahoo.com> wrote:
> Hello-
>
> I'm experiencing a weird issue searching an index. The
> index has information about books, and one of the
> fields is the ISBN number. It is stored in the index
> in untokenized form to enable searches by ISBN. So a
> query like "isbn:0071490833" would return the Document
> for that book. But it doesn't find the document if the
> ISBN ends in an "X", like "isbn:007149216X".
>
> I know it's stored correctly, because if I retrieve
> the document through a different query, I see that the
> field contains the correct value.
>
> It also works fine if I search for "isbn:007149216?".
>
> Is the "X" some kind of special syntax?
>
> Many thanks in advance for any hints,
> Ulf

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34087-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 09:48:35 2008
Return-Path: <java-user-return-34087-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67097 invoked from network); 16 May 2008 09:48:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 09:48:35 -0000
Received: (qmail 72162 invoked by uid 500); 16 May 2008 09:48:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72136 invoked by uid 500); 16 May 2008 09:48:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72125 invoked by uid 99); 16 May 2008 09:48:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 02:48:29 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [76.13.9.23] (HELO web65403.mail.ac4.yahoo.com) (76.13.9.23)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 16 May 2008 09:47:35 +0000
Received: (qmail 40480 invoked by uid 60001); 16 May 2008 09:47:56 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=xlKAdyTDZX8WqawUNEs7/De5yzRD+6i4WkckjC8Ayj+RxLutoUlTOKbxDGugDyTCDlzinsKBDm2gq7WVC26RPo2OLWC/F/MZoWBGSWyEVfTFEUdTpnrBmUKOJ1rHaA2WrULGsUhr82jBuCHtOHfK3Frnn0Ug4sxkBiowI/EzhBE=;
X-YMail-OSG: jfY5LvkVM1nHUxblQ3.tjvqO.kBtQMrANOzTWwSHp.v7ciyFG18I9Ot6223MkFhE88XhBmxX2tauxR5QgUwB._LE2xO0JZJeWYlE
Received: from [85.178.138.242] by web65403.mail.ac4.yahoo.com via HTTP; Fri, 16 May 2008 02:47:56 PDT
Date: Fri, 16 May 2008 02:47:56 -0700 (PDT)
From: Ulf Dittmer <udittmer@yahoo.com>
Subject: Re: search problem - not finding field values ending in "X"
To: java-user@lucene.apache.org
In-Reply-To: <8c4e68610805160233l3270fa0apee93514bab397b89@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
Message-ID: <218249.29619.qm@web65403.mail.ac4.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

D'oh!

Of course - I'm using StandardAnalyzer. Changing to a
PerFieldAnalyzerWrapper with a KeywordAnalyzer for
that field fixes the issue.

Thanks so much for fast response. 

Ulf


--- Ian Lea <ian.lea@gmail.com> wrote:

> Hi
> 
> 
> I bet you are using an analyzer that is downcasing
> isbn:007149216X to
> isbn:007149216x.  I've been there! Options include
> creating the query
> programmatically, using PerFieldAnalyzerWrapper,
> downcasing everything
> yourself in advance.  Or convert to ISBN-13.



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34088-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 10:23:32 2008
Return-Path: <java-user-return-34088-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76186 invoked from network); 16 May 2008 10:23:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 10:23:32 -0000
Received: (qmail 95862 invoked by uid 500); 16 May 2008 10:23:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95829 invoked by uid 500); 16 May 2008 10:23:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95548 invoked by uid 99); 16 May 2008 10:23:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 03:23:17 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.5] (HELO spunkymail-a16.g.dreamhost.com) (208.97.132.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 10:22:21 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a16.g.dreamhost.com (Postfix) with ESMTP id 29E9B7D2C5
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 03:22:40 -0700 (PDT)
Message-Id: <DBFB3AA8-FE30-442D-9E2B-693A96C23110@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <307975.49378.qm@web50308.mail.re2.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Document clustering with Lucene
Date: Fri, 16 May 2008 06:22:39 -0400
References: <307975.49378.qm@web50308.mail.re2.yahoo.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

Do you want search result clustering or document clustering?  My  
understanding of Carrot2 is it isn't designed for the latter.  The  
difference being it is designed to work off of shorter snippets of  
text, as opposed to the whole document.  FWIW, you _might_ find some  
help over on the Mahout project (http://lucene.apache.org/mahout) in  
terms of different approaches.  We have a couple of clustering  
approaches implemented there, but they just work off a matrix and it  
is up to you to fill the matrix (presumably with some distance  
calculation.)  The Carrot2 list may also help clarify if it is the  
appropriate place.

-Grant

On May 15, 2008, at 4:34 PM, Otis Gospodnetic wrote:

> Have you tried using Carrot2 with Lucene?  They work quite well in  
> tandem!
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
>> From: Supheakmungkol SARIN <supheakmungkol@yahoo.com>
>> To: java-user@lucene.apache.org
>> Sent: Wednesday, May 14, 2008 11:23:45 PM
>> Subject: Document clustering with Lucene
>>
>> Dear all,
>>
>> I'd like to do document clustering using full-text with Lucene. In  
>> other words,
>> I would like to group similar documents in their respective groups.  
>> I searched
>> the mailing list and found that there are two ways around. The  
>> first method is
>> to represent the one document as query and search the collection.   
>> The other way
>> would be to construct the vector of terms of each of the documents  
>> and use the
>> cosine distance function to compute the similarity. I found these  
>> methods here:
>>
>> - http://www.mail-archive.com/lucene-user@jakarta.apache.org/msg04916.html) 
>> .
>>
>> I would like to know whether there are better way? or any built-in  
>> functions to
>> do clustering in the recent release version of Lucene?
>>
>> Thank you.
>>
>> Kind regards,
>>
>> Supheakmungkol
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34089-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 12:34:41 2008
Return-Path: <java-user-return-34089-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33373 invoked from network); 16 May 2008 12:34:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 12:34:41 -0000
Received: (qmail 62591 invoked by uid 500); 16 May 2008 12:34:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62563 invoked by uid 500); 16 May 2008 12:34:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62552 invoked by uid 99); 16 May 2008 12:34:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 05:34:35 -0700
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=EXTRA_MPART_TYPE,HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS,TVD_FW_GRAPHIC_NAME_MID
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of kedaly@cisco.com designates 144.254.224.140 as permitted sender)
Received: from [144.254.224.140] (HELO ams-iport-1.cisco.com) (144.254.224.140)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 12:33:47 +0000
X-IronPort-AV: E=Sophos;i="4.27,497,1204498800"; 
   d="gif'147?scan'147,208,217,147";a="9097712"
Received: from ams-dkim-2.cisco.com ([144.254.224.139])
  by ams-iport-1.cisco.com with ESMTP; 16 May 2008 14:33:58 +0200
Received: from ams-core-1.cisco.com (ams-core-1.cisco.com [144.254.224.150])
	by ams-dkim-2.cisco.com (8.12.11/8.12.11) with ESMTP id m4GCXw8d023626
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 14:33:58 +0200
Received: from xbh-ams-332.emea.cisco.com (xbh-ams-332.cisco.com [144.254.231.87])
	by ams-core-1.cisco.com (8.13.8/8.13.8) with ESMTP id m4GCXwsD018611
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 12:33:58 GMT
Received: from xmb-ams-334.cisco.com ([144.254.231.79]) by xbh-ams-332.emea.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Fri, 16 May 2008 14:33:58 +0200
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/related;
	boundary="----_=_NextPart_001_01C8B751.1CA46A44";
	type="multipart/alternative"
Subject: CLucene and Lucene
Date: Fri, 16 May 2008 14:33:58 +0200
Message-ID: <67B9209ADB926A4EB3BB7111DB09E98403BD30D0@xmb-ams-334.emea.cisco.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: CLucene and Lucene
Thread-Index: Aci3URzUi/eV/5sHQ9mo8ufbBvxl6g==
From: "Kevin Daly (kedaly)" <kedaly@cisco.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 16 May 2008 12:33:58.0206 (UTC) FILETIME=[1CB72DE0:01C8B751]
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; l=7245; t=1210941238; x=1211805238;
	c=relaxed/simple; s=amsdkim2001;
	h=Content-Type:From:Subject:Content-Transfer-Encoding:MIME-Version;
	d=cisco.com; i=kedaly@cisco.com;
	z=From:=20=22Kevin=20Daly=20(kedaly)=22=20<kedaly@cisco.com>
	|Subject:=20CLucene=20and=20Lucene
	|Sender:=20;
	bh=HU9In88S7Y1IEf7IDlCD67OYt3QH0ieKQ8SsT4hMaEs=;
	b=jhuLLkII+VXleuTxhe5TdRUUpzAfDSZg8GSfEgdnzxrWx2PZopsPo9RJb7
	rfwyGuq2J2aXwChgti2M0GSQxSgJ+au4MESKW1Ym9YBhduq67lQ9L1v9Nniz
	TtrYqkzWTw;
Authentication-Results: ams-dkim-2; header.From=kedaly@cisco.com; dkim=pass (
	sig from cisco.com/amsdkim2001 verified; ); 
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C8B751.1CA46A44
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_002_01C8B751.1CA46A44"


------_=_NextPart_002_01C8B751.1CA46A44
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

I am have a question concerning interop between CLucene and Lucene. It
is possible to have a C++ Application using CLucene acting as an
IndexWriter, and then have a Web Applicaltion using Lucene to query the
index. Could there be issues with locking under load for example.
=20
I have done some basic test where I can write/read to/from index using
Clucene and Lucene.
=20
- Kevin.
 =09
Kevin Daly
Software Engineer
IP Communications Business Unit

kedaly@cisco.com
Phone :+35391384651



Block 10
Parkmore
Galway
Ireland
Ireland
www.cisco.com/

 =09
 =09
This e-mail may contain confidential and privileged material for the
sole use of the intended recipient. Any review, use, distribution or
disclosure by others is strictly prohibited. If you are not the intended
recipient (or authorized to receive for the recipient), please contact
the sender by reply e-mail and delete all copies of this message.=09
=20


=20

------_=_NextPart_002_01C8B751.1CA46A44
Content-Type: text/html;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD>
<META http-equiv=3DContent-Type content=3D"text/html; =
charset=3Dus-ascii">
<META content=3D"MSHTML 6.00.6000.16640" name=3DGENERATOR></HEAD>
<BODY>
<DIV><FONT face=3DArial size=3D2><SPAN class=3D959483012-16052008>I am =
have a question=20
concerning interop between CLucene and Lucene. It is possible to have a =
C++=20
Application using CLucene acting as an IndexWriter, and then have a Web=20
Applicaltion using Lucene to query the index. Could there be issues with =
locking=20
under load for example.</SPAN></FONT></DIV>
<DIV><FONT face=3DArial size=3D2><SPAN=20
class=3D959483012-16052008></SPAN></FONT>&nbsp;</DIV>
<DIV><FONT face=3DArial size=3D2><SPAN class=3D959483012-16052008>I have =
done some=20
basic test where I can write/read to/from index using Clucene and=20
Lucene.</SPAN></FONT></DIV>
<DIV><FONT face=3DArial size=3D2><SPAN=20
class=3D959483012-16052008></SPAN></FONT>&nbsp;</DIV>
<DIV><FONT face=3DArial size=3D2><SPAN class=3D959483012-16052008>-=20
Kevin.</SPAN></FONT></DIV>
<DIV align=3Dleft>
<TABLE cellSpacing=3D0 cellPadding=3D0 width=3D543 align=3Dleft =
border=3D0>
  <TBODY>
  <TR>
    <TD>
      <TABLE=20
      style=3D"BACKGROUND: =
url(http://www.cisco.com/global/EMEA/brand/signature/corporate/bg4.jpg) =
no-repeat 50% top"=20
      cellSpacing=3D0 cellPadding=3D0 width=3D543 border=3D0>
        <TBODY>
        <TR>
          <TD colSpan=3D3><IMG height=3D68=20
            =
src=3D"http://www.cisco.com/global/EMEA/brand/signature/default/spacer.gi=
f"=20
            width=3D200></TD></TR>
        <TR>
          <TD style=3D"PADDING-LEFT: 24px; PADDING-BOTTOM: 15px" =
vAlign=3Dtop noWrap=20
          align=3Dleft>
            <P=20
            style=3D"FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: =
#666666; FONT-FAMILY: Arial, Helvetica, sans-serif"><STRONG>Kevin=20
            Daly</STRONG><BR><STRONG>Software=20
            Engineer</STRONG><BR><STRONG><STRONG>IP Communications =
Business=20
            Unit</STRONG><BR></STRONG><BR><A style=3D"COLOR: #666666"=20
            =
href=3D"mailto:kedaly@cisco.com">kedaly@cisco.com</A><BR>Phone=20
            :<STRONG>+35391384651</STRONG><BR></P></TD>
          <TD style=3D"PADDING-LEFT: 20px; PADDING-BOTTOM: 10px" =
vAlign=3Dtop=20
noWrap>
            <P=20
            style=3D"FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: =
#666666; FONT-FAMILY: Arial, Helvetica, =
sans-serif"><STRONG></STRONG><BR>Block=20
            10<BR>Parkmore<BR>Galway<BR>Ireland<BR>Ireland<BR><A=20
            style=3D"COLOR: #666666"=20
            href=3D"http://www.cisco.com/">www.cisco.com/</A></P></TD>
          <TD width=3D200>&nbsp;</TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=3D0 cellPadding=3D0 width=3D"100%" border=3D0>
        <TBODY>
        <TR>
          <TD><IMG height=3D1=20
            =
src=3D"http://www.cisco.com/global/EMEA/brand/signature/default/footerHea=
d.gif"=20
            width=3D543></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=3D0 cellPadding=3D0 width=3D"100%"=20
      =
background=3Dhttp://www.cisco.com/global/EMEA/brand/signature/default/foo=
terBG.gif=20
      border=3D0>
        <TBODY>
        <TR>
          <TD=20
          style=3D"PADDING-RIGHT: 24px; PADDING-LEFT: 24px; FONT-SIZE: =
10px; PADDING-BOTTOM: 6px; COLOR: #999999; PADDING-TOP: 16px; =
FONT-FAMILY: Arial, Helvetica, sans-serif">This=20
            e-mail may contain confidential and privileged material for =
the sole=20
            use of the intended recipient. Any review, use, distribution =
or=20
            disclosure by others is strictly prohibited. If you are not =
the=20
            intended recipient (or authorized to receive for the =
recipient),=20
            please contact the sender by reply e-mail and delete all =
copies of=20
            this message.</TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=3D0 cellPadding=3D0 width=3D"100%" border=3D0>
        <TBODY>
        <TR>
          <TD>
            <P><IMG height=3D17=20
            =
src=3D"http://www.cisco.com/global/EMEA/brand/signature/default/footer.gi=
f"=20
            =
width=3D543></P></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV=
><BR=20
clear=3Dall>
<DIV>&nbsp;</DIV></BODY></HTML>

------_=_NextPart_002_01C8B751.1CA46A44--

------_=_NextPart_001_01C8B751.1CA46A44--

From java-user-return-34090-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 13:21:20 2008
Return-Path: <java-user-return-34090-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54537 invoked from network); 16 May 2008 13:21:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 13:21:19 -0000
Received: (qmail 31994 invoked by uid 500); 16 May 2008 13:21:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31971 invoked by uid 500); 16 May 2008 13:21:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31960 invoked by uid 99); 16 May 2008 13:21:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 06:21:13 -0700
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=EXTRA_MPART_TYPE,HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS,TVD_FW_GRAPHIC_NAME_MID
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of kedaly@cisco.com designates 144.254.224.140 as permitted sender)
Received: from [144.254.224.140] (HELO ams-iport-1.cisco.com) (144.254.224.140)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 13:20:18 +0000
X-IronPort-AV: E=Sophos;i="4.27,497,1204498800"; 
   d="gif'147?scan'147,208,217,147";a="9104844"
Received: from ams-dkim-2.cisco.com ([144.254.224.139])
  by ams-iport-1.cisco.com with ESMTP; 16 May 2008 15:20:40 +0200
Received: from ams-core-1.cisco.com (ams-core-1.cisco.com [144.254.224.150])
	by ams-dkim-2.cisco.com (8.12.11/8.12.11) with ESMTP id m4GDKeoP008396
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 15:20:40 +0200
Received: from xbh-ams-331.emea.cisco.com (xbh-ams-331.cisco.com [144.254.231.71])
	by ams-core-1.cisco.com (8.13.8/8.13.8) with ESMTP id m4GDKclP010500
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 13:20:40 GMT
Received: from xmb-ams-334.cisco.com ([144.254.231.79]) by xbh-ams-331.emea.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Fri, 16 May 2008 15:20:35 +0200
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/related;
	boundary="----_=_NextPart_001_01C8B757.9FCC1FC8";
	type="multipart/alternative"
Subject: RE: CLucene and Lucene
Date: Fri, 16 May 2008 15:20:35 +0200
Message-ID: <67B9209ADB926A4EB3BB7111DB09E98403BD30D2@xmb-ams-334.emea.cisco.com>
In-Reply-To: <67B9209ADB926A4EB3BB7111DB09E98403BD30D0@xmb-ams-334.emea.cisco.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: CLucene and Lucene
Thread-Index: Aci3URzUi/eV/5sHQ9mo8ufbBvxl6gABnl2A
References: <67B9209ADB926A4EB3BB7111DB09E98403BD30D0@xmb-ams-334.emea.cisco.com>
From: "Kevin Daly (kedaly)" <kedaly@cisco.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 16 May 2008 13:20:35.0309 (UTC) FILETIME=[9FEB39D0:01C8B757]
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; l=7911; t=1210944040; x=1211808040;
	c=relaxed/simple; s=amsdkim2001;
	h=Content-Type:From:Subject:Content-Transfer-Encoding:MIME-Version;
	d=cisco.com; i=kedaly@cisco.com;
	z=From:=20=22Kevin=20Daly=20(kedaly)=22=20<kedaly@cisco.com>
	|Subject:=20RE=3A=20CLucene=20and=20Lucene
	|Sender:=20;
	bh=X6P024AWrVdv7I0+BXyV+HyqFlTo2JdPjmL00778RQY=;
	b=avuZlsxmOYQLRitxKC68WXY14Guon3FYTVipd14U/NgYBIewZfKWIEnYbK
	cyR9lY2rUpDp/J9j+7t9WD6Wr1ngXbSInO27PdIXFH1+2fog8IOWBT1czm8u
	T4Kxi0IXmb;
Authentication-Results: ams-dkim-2; header.From=kedaly@cisco.com; dkim=pass (
	sig from cisco.com/amsdkim2001 verified; ); 
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C8B757.9FCC1FC8
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_002_01C8B757.9FCC1FC8"


------_=_NextPart_002_01C8B757.9FCC1FC8
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

=20


________________________________

From: Kevin Daly (kedaly)=20
Sent: Friday, May 16, 2008 1:34 PM
To: 'java-user@lucene.apache.org'
Subject: CLucene and Lucene


I am have a question concerning interop between CLucene and Lucene. It
is possible to have a C++ Application using CLucene acting as an
IndexWriter, and then have a Web Applicaltion using Lucene to query the
index. Could there be issues with locking under load for example.
=20
I have done some basic test where I can write/read to/from index using
Clucene and Lucene.
=20
- Kevin.
 =09
Kevin Daly
Software Engineer
IP Communications Business Unit

kedaly@cisco.com
Phone :+35391384651



Block 10
Parkmore
Galway
Ireland
Ireland
www.cisco.com/

 =09
 =09
This e-mail may contain confidential and privileged material for the
sole use of the intended recipient. Any review, use, distribution or
disclosure by others is strictly prohibited. If you are not the intended
recipient (or authorized to receive for the recipient), please contact
the sender by reply e-mail and delete all copies of this message.=09
=20


=20

------_=_NextPart_002_01C8B757.9FCC1FC8
Content-Type: text/html;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD>
<META http-equiv=3DContent-Type content=3D"text/html; =
charset=3Dus-ascii">
<META content=3D"MSHTML 6.00.6000.16640" name=3DGENERATOR></HEAD>
<BODY>
<DIV dir=3Dltr align=3Dleft><FONT face=3DArial color=3D#0000ff=20
size=3D2></FONT>&nbsp;</DIV><FONT face=3DArial color=3D#0000ff =
size=3D2></FONT><BR>
<DIV class=3DOutlookMessageHeader lang=3Den-us dir=3Dltr align=3Dleft>
<HR tabIndex=3D-1>
<FONT face=3DTahoma size=3D2><B>From:</B> Kevin Daly (kedaly) =
<BR><B>Sent:</B>=20
Friday, May 16, 2008 1:34 PM<BR><B>To:</B>=20
'java-user@lucene.apache.org'<BR><B>Subject:</B> CLucene and=20
Lucene<BR></FONT><BR></DIV>
<DIV></DIV>
<DIV><FONT face=3DArial size=3D2><SPAN class=3D959483012-16052008>I am =
have a question=20
concerning interop between CLucene and Lucene. It is possible to have a =
C++=20
Application using CLucene acting as an IndexWriter, and then have a Web=20
Applicaltion using Lucene to query the index. Could there be issues with =
locking=20
under load for example.</SPAN></FONT></DIV>
<DIV><FONT face=3DArial size=3D2><SPAN=20
class=3D959483012-16052008></SPAN></FONT>&nbsp;</DIV>
<DIV><FONT face=3DArial size=3D2><SPAN class=3D959483012-16052008>I have =
done some=20
basic test where I can write/read to/from index using Clucene and=20
Lucene.</SPAN></FONT></DIV>
<DIV><FONT face=3DArial size=3D2><SPAN=20
class=3D959483012-16052008></SPAN></FONT>&nbsp;</DIV>
<DIV><FONT face=3DArial size=3D2><SPAN class=3D959483012-16052008>-=20
Kevin.</SPAN></FONT></DIV>
<DIV align=3Dleft>
<TABLE cellSpacing=3D0 cellPadding=3D0 width=3D543 align=3Dleft =
border=3D0>
  <TBODY>
  <TR>
    <TD>
      <TABLE=20
      style=3D"BACKGROUND: =
url(http://www.cisco.com/global/EMEA/brand/signature/corporate/bg4.jpg) =
no-repeat 50% top"=20
      cellSpacing=3D0 cellPadding=3D0 width=3D543 border=3D0>
        <TBODY>
        <TR>
          <TD colSpan=3D3><IMG height=3D68=20
            =
src=3D"http://www.cisco.com/global/EMEA/brand/signature/default/spacer.gi=
f"=20
            width=3D200></TD></TR>
        <TR>
          <TD style=3D"PADDING-LEFT: 24px; PADDING-BOTTOM: 15px" =
vAlign=3Dtop noWrap=20
          align=3Dleft>
            <P=20
            style=3D"FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: =
#666666; FONT-FAMILY: Arial, Helvetica, sans-serif"><STRONG>Kevin=20
            Daly</STRONG><BR><STRONG>Software=20
            Engineer</STRONG><BR><STRONG><STRONG>IP Communications =
Business=20
            Unit</STRONG><BR></STRONG><BR><A style=3D"COLOR: #666666"=20
            =
href=3D"mailto:kedaly@cisco.com">kedaly@cisco.com</A><BR>Phone=20
            :<STRONG>+35391384651</STRONG><BR></P></TD>
          <TD style=3D"PADDING-LEFT: 20px; PADDING-BOTTOM: 10px" =
vAlign=3Dtop=20
noWrap>
            <P=20
            style=3D"FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: =
#666666; FONT-FAMILY: Arial, Helvetica, =
sans-serif"><STRONG></STRONG><BR>Block=20
            10<BR>Parkmore<BR>Galway<BR>Ireland<BR>Ireland<BR><A=20
            style=3D"COLOR: #666666"=20
            href=3D"http://www.cisco.com/">www.cisco.com/</A></P></TD>
          <TD width=3D200>&nbsp;</TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=3D0 cellPadding=3D0 width=3D"100%" border=3D0>
        <TBODY>
        <TR>
          <TD><IMG height=3D1=20
            =
src=3D"http://www.cisco.com/global/EMEA/brand/signature/default/footerHea=
d.gif"=20
            width=3D543></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=3D0 cellPadding=3D0 width=3D"100%"=20
      =
background=3Dhttp://www.cisco.com/global/EMEA/brand/signature/default/foo=
terBG.gif=20
      border=3D0>
        <TBODY>
        <TR>
          <TD=20
          style=3D"PADDING-RIGHT: 24px; PADDING-LEFT: 24px; FONT-SIZE: =
10px; PADDING-BOTTOM: 6px; COLOR: #999999; PADDING-TOP: 16px; =
FONT-FAMILY: Arial, Helvetica, sans-serif">This=20
            e-mail may contain confidential and privileged material for =
the sole=20
            use of the intended recipient. Any review, use, distribution =
or=20
            disclosure by others is strictly prohibited. If you are not =
the=20
            intended recipient (or authorized to receive for the =
recipient),=20
            please contact the sender by reply e-mail and delete all =
copies of=20
            this message.</TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=3D0 cellPadding=3D0 width=3D"100%" border=3D0>
        <TBODY>
        <TR>
          <TD>
            <P><IMG height=3D17=20
            =
src=3D"http://www.cisco.com/global/EMEA/brand/signature/default/footer.gi=
f"=20
            =
width=3D543></P></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV=
><BR=20
clear=3Dall>
<DIV>&nbsp;</DIV></BODY></HTML>

------_=_NextPart_002_01C8B757.9FCC1FC8--

------_=_NextPart_001_01C8B757.9FCC1FC8--

From java-user-return-34091-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 16:17:59 2008
Return-Path: <java-user-return-34091-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84654 invoked from network); 16 May 2008 16:17:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 16:17:59 -0000
Received: (qmail 73193 invoked by uid 500); 16 May 2008 16:17:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72846 invoked by uid 500); 16 May 2008 16:17:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72835 invoked by uid 99); 16 May 2008 16:17:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 09:17:53 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.60] (HELO web50306.mail.re2.yahoo.com) (206.190.38.60)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 16 May 2008 16:16:55 +0000
Received: (qmail 29178 invoked by uid 60001); 16 May 2008 16:17:14 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=WTtrN2QVNE5vgkGfCXhejMPvfoB0/vr8P5AejAhilhGsVfEhwd9KECYFEyNsDbX2NWmtECb0QuO+T+2NgFXUdR33UqWox+PPg8kUx7j04QTYFHhhpY0B8plDr4/weyg1Nmv/OwUvqaN0jh3JMz5R2bj6E39ZKNsbyipPseJbt38=;
X-YMail-OSG: qZmM4QYVM1lXEYe1jGN97Z8Xg.sGh3kfB3VW7JjeoMAQz8BCTk99gfxKc.6x59KhpmTxwFJZ7jdOkouSOK4w.mqdHBz5N5VDmJ4oRIts9KcFiuwZ0GJdKGUDMA--
Received: from [208.125.28.220] by web50306.mail.re2.yahoo.com via HTTP; Fri, 16 May 2008 09:17:13 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.185
Date: Fri, 16 May 2008 09:17:13 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: CLucene and Lucene
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1685445075-1210954633=:28773"
Message-ID: <961914.28773.qm@web50306.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1685445075-1210954633=:28773
Content-Type: text/plain; charset=us-ascii

Kevin,
CLucene is behind Lucene Java in terms of
 functionality and index format, thus you'd have to be careful about which version of CLucene and Lucene Java you use.  A better place to ask is the CLucene mailing list, as Ben & Co. know exactly which Lucene Java version they are compatible with.

You've got some giant image in your signature....


Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch



----- Original Message ----
From: Kevin Daly (kedaly) <kedaly@cisco.com>
To: java-user@lucene.apache.org
Sent: Friday, May 16, 2008 8:33:58 AM
Subject: CLucene and Lucene


I am have a question 
concerning interop between CLucene and Lucene. It is possible to have a C++ 
Application using CLucene acting as an IndexWriter, and then have a Web 
Applicaltion using Lucene to query the index. Could there be issues with locking 
under load for example.
 
I have done some 
basic test where I can write/read to/from index using Clucene and 
Lucene.
 
- 
Kevin.
 
Kevin  Daly
Software  Engineer
IP Communications Business  Unit

kedaly@cisco.com
Phone  :+35391384651
 
Block  10
Parkmore
Galway
Ireland
Ireland
www.cisco.com/    
This  e-mail may contain confidential and privileged material for the sole  use of the intended recipient. Any review, use, distribution or  disclosure by others is strictly prohibited. If you are not the  intended recipient (or authorized to receive for the recipient),  please contact the sender by reply e-mail and delete all copies of  this message.   
--0-1685445075-1210954633=:28773--

From java-user-return-34092-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 17:20:42 2008
Return-Path: <java-user-return-34092-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16050 invoked from network); 16 May 2008 17:20:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 17:20:42 -0000
Received: (qmail 90029 invoked by uid 500); 16 May 2008 17:20:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89999 invoked by uid 500); 16 May 2008 17:20:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89988 invoked by uid 99); 16 May 2008 17:20:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 10:20:36 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of viniciusccarvalho@gmail.com designates 209.85.146.183 as permitted sender)
Received: from [209.85.146.183] (HELO wa-out-1112.google.com) (209.85.146.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 17:19:51 +0000
Received: by wa-out-1112.google.com with SMTP id l24so306157waf.11
        for <java-user@lucene.apache.org>; Fri, 16 May 2008 10:20:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=R1EKoLxVhATg07Cb7w0IxAMw+WurEqBZcU+l1hET4hE=;
        b=tzk0FuJ/00FOtfEtKnMddb/pkgu4+sae4jqr9T6HZWMn3x8pL8olzLHYHBN03aWU5Ntw+T5VtTgJ8Jiwo6RhHC9wRFJblWr43DaOb50hqRNs1IGjmPlMoRoLKUO2NKbaoz29Msxw22m4yY1ucCr4qOT1EJDYcDXrsJnUISHfZXw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=CnU0ba5vNbfZ7RlSCKN8CQAXgJAUHzmtjFfBCeCr4C4KjFjceqE/i9SkzX91UQ/CfF+vcgxC7r6tZtysx20L9yvXpZoNgW9snrwukuPpHtgNuv4WoEto43dajPflTe3YKPzb5GJAI1zKaUDXjxhC6uTrPqO2yPZtr4qhqkn3jvw=
Received: by 10.114.59.1 with SMTP id h1mr3972197waa.39.1210958406642;
        Fri, 16 May 2008 10:20:06 -0700 (PDT)
Received: by 10.114.131.10 with HTTP; Fri, 16 May 2008 10:20:06 -0700 (PDT)
Message-ID: <9d2777b60805161020g1eba7108l4ae078a4be9ea9d@mail.gmail.com>
Date: Fri, 16 May 2008 14:20:06 -0300
From: "Vinicius Carvalho" <viniciusccarvalho@gmail.com>
To: java-user@lucene.apache.org
Subject: Boosting Search
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_11934_20186665.1210958406630"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_11934_20186665.1210958406630
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hello there! We are starting with lucene, and in order to prove it's usage
one of the benefits is performance. I do know that lucene (as other full
text search engines) provide many more benefits than using a SGDB.
Ok, so here's a simple test:

I have a Table with 17.700 rows. It is stored on mysql, and has no index on
the title row.

A query using: SELECT * FROM MOVIE WHERE LOWER(TITLE) like '%matrix%'. It
returns 9 matches in 4ms (I'm not counting the opening connection time)

Ok, now, I have indexed this same table in lucene (indexed title,id, and
stored both). After performing a termquery(term("title","matrix")) the time
was 27ms (not counting the indexsearcher  instantiation time).

I know its a dumb test, but what can be done in order to speed things up?

Regards

-- 
"In a world without fences and walls, who needs Gates and Windows?"

------=_Part_11934_20186665.1210958406630--

From java-user-return-34093-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 17:26:35 2008
Return-Path: <java-user-return-34093-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17873 invoked from network); 16 May 2008 17:26:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 17:26:34 -0000
Received: (qmail 2344 invoked by uid 500); 16 May 2008 17:26:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2307 invoked by uid 500); 16 May 2008 17:26:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2289 invoked by uid 99); 16 May 2008 17:26:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 10:26:29 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: 194.109.24.27 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.27] (HELO smtp-vbr7.xs4all.nl) (194.109.24.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 17:25:35 +0000
Received: from kodapan.lan (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr7.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4GHPu4Q096927
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 19:25:56 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <6A8B8EBC-FB60-4E9C-ABF8-255A82BB7142@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <9d2777b60805161020g1eba7108l4ae078a4be9ea9d@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Boosting Search
Date: Fri, 16 May 2008 19:25:55 +0200
References: <9d2777b60805161020g1eba7108l4ae078a4be9ea9d@mail.gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org


16 maj 2008 kl. 19.20 skrev Vinicius Carvalho:
>
> I know its a dumb test

There is a lot of initial latency. You want to "warm" the index.

> but what can be done in order to speed things up?


http://wiki.apache.org/lucene-java/BasicsOfPerformance


     karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34094-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 17:32:53 2008
Return-Path: <java-user-return-34094-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20643 invoked from network); 16 May 2008 17:32:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 17:32:53 -0000
Received: (qmail 10838 invoked by uid 500); 16 May 2008 17:32:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10801 invoked by uid 500); 16 May 2008 17:32:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10790 invoked by uid 99); 16 May 2008 17:32:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 10:32:46 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of hasan.diwan@gmail.com designates 209.85.146.183 as permitted sender)
Received: from [209.85.146.183] (HELO wa-out-1112.google.com) (209.85.146.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 17:32:01 +0000
Received: by wa-out-1112.google.com with SMTP id l24so311700waf.11
        for <java-user@lucene.apache.org>; Fri, 16 May 2008 10:32:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=9oGk6lJwYsQbNCU4YTymCXtQbQhYUOxJFz4ZoiGwcyc=;
        b=rhIIdA+CRQHAF4kGh2IpuP6LMbuc1x139DhsG6AI1F/Gua7ad0yP8GE5ocgXxRUnTKkTGD+Y4QMprqlKXUgkHGpvNQrY1qOnm+ImZNJPf5lk9v1NIwUzsLxN9CCKLpGQr2kLQUDqi4pq/Yec9Ak3TbbR1ZsznRatcXwclY+1hvM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=Y/OVbZXW+tNg1W87P9KUa1CBLNjAt7nD7ohtU8L+98yCO5X9umMzj6AmSlCbi4OAtR3+xfg+KIPIa7FQiCN7DcVgiWiLpwVwV+s8QO4pU2XTqGJ8sbBndk5c6fqgYOn2iIK8YTOHN9kIoHT0yhmpvU9U2vyVQQ/6a2+/5vYrra4=
Received: by 10.114.80.4 with SMTP id d4mr3979124wab.44.1210959136916;
        Fri, 16 May 2008 10:32:16 -0700 (PDT)
Received: by 10.114.200.20 with HTTP; Fri, 16 May 2008 10:32:16 -0700 (PDT)
Message-ID: <2cda2fc90805161032v6d67996q543fb50d26283a7b@mail.gmail.com>
Date: Fri, 16 May 2008 10:32:16 -0700
From: "Hasan Diwan" <hasan.diwan@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: All results
In-Reply-To: <67084.62993.qm@web50304.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <67084.62993.qm@web50304.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

On 15/05/2008, Otis Gospodnetic <otis_gospodnetic@yahoo.com> wrote:
> What does your code look like?  If you are using Hits, what does hits.length() give you?

Me code is below:
Hits hits = searcher.search(parsedQuery);
				if (hits.length() == 0) {
					writer.print("Sorry, no results found. <a href=\""
							+ request.getSession().getServletContext()
									.getServletContextName()
							+ "\">Try again</a>?");
					error = true;
				} else {
					if ((startIndex + maxPage) > hits.length()) {
					}
					for (int i = startIndex; i != hits.length(); i++) {
						final Document document = hits.doc(i);
						writer.print("<br/>"
								+ document	.get("all")) + "<hr/>");
					} // iterated through every hit
					if (searcher != null)
						searcher.close();
				}

-- 
Cheers,
Hasan Diwan <hasan.diwan@gmail.com>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34095-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 17:37:53 2008
Return-Path: <java-user-return-34095-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22089 invoked from network); 16 May 2008 17:37:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 17:37:53 -0000
Received: (qmail 18699 invoked by uid 500); 16 May 2008 17:37:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18660 invoked by uid 500); 16 May 2008 17:37:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18649 invoked by uid 99); 16 May 2008 17:37:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 10:37:47 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chris.lu@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 17:36:58 +0000
Received: by fg-out-1718.google.com with SMTP id l27so1022314fgb.27
        for <java-user@lucene.apache.org>; Fri, 16 May 2008 10:37:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=hp4LYev2jI1n/pe85mWcyq8EMB1/+RI21tqyU1np3kg=;
        b=pBIPPlt54kZpr2XCBTLf+Qu8Nh8Hswk2FgJgDAoz0MSQzr2hAlH2VeYZAJJpmasaZwWRSl3neW+ZfBfTlZ88N5QVohRKTo7xUH+rjWHT44dPlZ3Dr5OjfcnJVpFwZkvPWnCHuoK8+fdr2YWg+I1ONsdBFKCfxMcDRv2W+Pe6XHs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=NSxcTcRvB4Sk3+9Wh9uzA8uu6VlWSet1enlHfrGpmfyfS35HfR1LU8cRkPLwICMH5iZMXTLYDBswCWjdNVxk1eiEbutNdrNj4dVXU96ci83M7fMxXoNwDiZeZ5Mr+xjT49xPWoQOVxsti0kKAGl6dPaiXDkaP6II96163QBB024=
Received: by 10.78.37.7 with SMTP id k7mr1023636huk.25.1210959432075;
        Fri, 16 May 2008 10:37:12 -0700 (PDT)
Received: by 10.78.165.13 with HTTP; Fri, 16 May 2008 10:37:12 -0700 (PDT)
Message-ID: <6e3ae6310805161037l48ff5c75qccf7265a798c16f7@mail.gmail.com>
Date: Fri, 16 May 2008 10:37:12 -0700
From: "Chris Lu" <chris.lu@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Boosting Search
In-Reply-To: <9d2777b60805161020g1eba7108l4ae078a4be9ea9d@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_7807_12660508.1210959432074"
References: <9d2777b60805161020g1eba7108l4ae078a4be9ea9d@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_7807_12660508.1210959432074
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

You may need some more data to really compare the performance.

>From previous experience, I would expect MySql's search time would increase
as data grows, but Lucene's time stays almost unchanged.

-- 
Chris Lu
-------------------------
Instant Scalable Full-Text Search On Any Database/Application
site: http://www.dbsight.net
demo: http://search.dbsight.com
Lucene Database Search in 3 minutes:
http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
DBSight customer, a shopping comparison site, (anonymous per request) got
2.6 Million Euro funding!

On Fri, May 16, 2008 at 10:20 AM, Vinicius Carvalho <
viniciusccarvalho@gmail.com> wrote:

> Hello there! We are starting with lucene, and in order to prove it's usage
> one of the benefits is performance. I do know that lucene (as other full
> text search engines) provide many more benefits than using a SGDB.
> Ok, so here's a simple test:
>
> I have a Table with 17.700 rows. It is stored on mysql, and has no index on
> the title row.
>
> A query using: SELECT * FROM MOVIE WHERE LOWER(TITLE) like '%matrix%'. It
> returns 9 matches in 4ms (I'm not counting the opening connection time)
>
> Ok, now, I have indexed this same table in lucene (indexed title,id, and
> stored both). After performing a termquery(term("title","matrix")) the time
> was 27ms (not counting the indexsearcher  instantiation time).
>
> I know its a dumb test, but what can be done in order to speed things up?
>
> Regards
>
> --
> "In a world without fences and walls, who needs Gates and Windows?"
>

------=_Part_7807_12660508.1210959432074--

From java-user-return-34096-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 17:41:39 2008
Return-Path: <java-user-return-34096-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22975 invoked from network); 16 May 2008 17:41:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 17:41:39 -0000
Received: (qmail 27578 invoked by uid 500); 16 May 2008 17:41:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27543 invoked by uid 500); 16 May 2008 17:41:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27532 invoked by uid 99); 16 May 2008 17:41:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 10:41:34 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of viniciusccarvalho@gmail.com designates 64.233.166.183 as permitted sender)
Received: from [64.233.166.183] (HELO py-out-1112.google.com) (64.233.166.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 17:40:48 +0000
Received: by py-out-1112.google.com with SMTP id z74so984807pyg.9
        for <java-user@lucene.apache.org>; Fri, 16 May 2008 10:41:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=L3LFMw1pSAb1bDs6weicrqAKiXwx20RiKKsoOjXeNNI=;
        b=DSYYOa3ET0JJ3pDV3eMGHrx2NXb09ZwehC1xTVKGJw+chh6V1LvR+6metxFQrAuF4l0llqDUpV5w64fu6oGoXMGdVhcYopPpG48RMYzkiEJL86WbT5hSP5eo6UnbemlHjX8Clx5IA/0sNu+4rXm8tuFUe+npIw9SdKQKLhuMBRs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=fwT+ifLfw9b0f2GgMdNnWH7JvLH9fxrQCpzEaqDBKimmstKkAP1/IUyWRcsyfOPlJEqbaBvlZxR1DjuXf4esuNrTQddMOsA8f3Ygk/9xelXfIudFClmQ4PIrVQXu945jqP9hqAv674DXVjbpMMndfjvs/2UPEupzUrSdhwqgerM=
Received: by 10.114.120.1 with SMTP id s1mr3961135wac.137.1210959662472;
        Fri, 16 May 2008 10:41:02 -0700 (PDT)
Received: by 10.114.131.10 with HTTP; Fri, 16 May 2008 10:41:02 -0700 (PDT)
Message-ID: <9d2777b60805161041q7d87034eg736afcf9f8968153@mail.gmail.com>
Date: Fri, 16 May 2008 14:41:02 -0300
From: "Vinicius Carvalho" <viniciusccarvalho@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Boosting Search
In-Reply-To: <6A8B8EBC-FB60-4E9C-ABF8-255A82BB7142@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_12053_25075570.1210959662467"
References: <9d2777b60805161020g1eba7108l4ae078a4be9ea9d@mail.gmail.com>
	 <6A8B8EBC-FB60-4E9C-ABF8-255A82BB7142@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_12053_25075570.1210959662467
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Thanks a lot. That was it: new times:

4ms -> mysql

2-4ms -> lucene

Now I tried a few times, with a pause and and open index so it would
simulate the correct behaviour during a server usage of my index.

Regards

On Fri, May 16, 2008 at 2:25 PM, Karl Wettin <karl.wettin@gmail.com> wrote:

>
> 16 maj 2008 kl. 19.20 skrev Vinicius Carvalho:
>
>>
>> I know its a dumb test
>>
>
> There is a lot of initial latency. You want to "warm" the index.
>
>  but what can be done in order to speed things up?
>>
>
>
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
>
>
>    karl
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
"In a world without fences and walls, who needs Gates and Windows?"

------=_Part_12053_25075570.1210959662467--

From java-user-return-34097-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 17:49:10 2008
Return-Path: <java-user-return-34097-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27581 invoked from network); 16 May 2008 17:49:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 17:49:10 -0000
Received: (qmail 41684 invoked by uid 500); 16 May 2008 17:49:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41664 invoked by uid 500); 16 May 2008 17:49:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 2833 invoked by uid 99); 16 May 2008 15:38:58 -0000
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,UNPARSEABLE_RELAY
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
X-Warning: RFC compliance checks disabled due to whitelist
X-Warning: Maximum message size check skipped due to whitelist
X-Warning: Realtime Block Lists skipped due to whitelist
X-Warning: System filters skipped due to whitelist
X-Warning: Domain filters skipped due to whitelist
X-Warning: User filters skipped due to whitelist
X-Warning: Anti-Spam check skipped due to whitelist
X-Whitelist: 2147483581
X-Envelope-From: Dan2@redlasso.com
X-Envelope-To: java-user@lucene.apache.org
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C8B76A.D095F882"
Subject: Version 2.3 Does Not Index/Digest All Document Tokens
Date: Fri, 16 May 2008 11:37:11 -0400
Message-ID: <CF94BA56C9A3504BB6678C85B56D528E853FD7@lassomsx01.redlasso.local>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Version 2.3 Does Not Index/Digest All Document Tokens
Thread-Index: Aci3arU46DzyZ4kKTJaBvTLA+veCdg==
From: "Dan Rugg" <Dan2@redlasso.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C8B76A.D095F882
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

After upgrading to version 2.3.x from 2.2.0, we started experiencing
issues with our index searches.  Some searches produced false positives,
while others produce no hits for terms known to be in specific documents
that where digested.  After setting up tests that created indexes
containing single documents we found that version 2.3.x did not add all
the tokens from a document the index while 2.2.0 did.  The only thing
that changed between the tests were the lucene jar being used, and a
fresh index was created for each test.

=20

It seems to be some random action that 2.3.x is taking, or not taking.
While tokens such as 'traffic' will not be digested in one document, it
will in another.  Token frequency, order, and relative position seem to
not matter, as indexed and non-indexed tokens where across the board.
The documents being ingested where XML, and the tokenizer for the
documents were the same for 2.2.0 and 2.3.x.  We even did a token dump
of the documents and verified the documents where being tokenized
correctly.

=20

I did notice rebuilding the index was quicker with 2.3.x and the index
was smaller, but I guess if you aren't adding tokens to the index it is
bound to smaller.  BTW, we tested versions 2.3.1, 2.3.2, and 2.2.0.  We
are now back to using 2.2.0.

=20

Daniel Rugg


------_=_NextPart_001_01C8B76A.D095F882--

From java-user-return-34098-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 17:54:51 2008
Return-Path: <java-user-return-34098-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29282 invoked from network); 16 May 2008 17:54:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 17:54:50 -0000
Received: (qmail 51125 invoked by uid 500); 16 May 2008 17:54:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50951 invoked by uid 500); 16 May 2008 17:54:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50940 invoked by uid 99); 16 May 2008 17:54:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 10:54:46 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.5] (HELO spunkymail-a1.g.dreamhost.com) (208.97.132.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 17:53:59 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a1.g.dreamhost.com (Postfix) with ESMTP id 794F4FFED8
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 10:54:13 -0700 (PDT)
Message-Id: <940060D7-0633-45A7-8F49-130D7EA6D888@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <CF94BA56C9A3504BB6678C85B56D528E853FD7@lassomsx01.redlasso.local>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Version 2.3 Does Not Index/Digest All Document Tokens
Date: Fri, 16 May 2008 13:54:11 -0400
References: <CF94BA56C9A3504BB6678C85B56D528E853FD7@lassomsx01.redlasso.local>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

Can you reduce this down to a unit test?

Thanks,
Grant

On May 16, 2008, at 11:37 AM, Dan Rugg wrote:

> After upgrading to version 2.3.x from 2.2.0, we started experiencing
> issues with our index searches.  Some searches produced false  
> positives,
> while others produce no hits for terms known to be in specific  
> documents
> that where digested.  After setting up tests that created indexes
> containing single documents we found that version 2.3.x did not add  
> all
> the tokens from a document the index while 2.2.0 did.  The only thing
> that changed between the tests were the lucene jar being used, and a
> fresh index was created for each test.
>
>
>
> It seems to be some random action that 2.3.x is taking, or not taking.
> While tokens such as 'traffic' will not be digested in one document,  
> it
> will in another.  Token frequency, order, and relative position seem  
> to
> not matter, as indexed and non-indexed tokens where across the board.
> The documents being ingested where XML, and the tokenizer for the
> documents were the same for 2.2.0 and 2.3.x.  We even did a token dump
> of the documents and verified the documents where being tokenized
> correctly.
>
>
>
> I did notice rebuilding the index was quicker with 2.3.x and the index
> was smaller, but I guess if you aren't adding tokens to the index it  
> is
> bound to smaller.  BTW, we tested versions 2.3.1, 2.3.2, and 2.2.0.   
> We
> are now back to using 2.2.0.
>
>
>
> Daniel Rugg
>

--------------------------
Grant Ingersoll

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34099-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 18:39:42 2008
Return-Path: <java-user-return-34099-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50884 invoked from network); 16 May 2008 18:39:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 18:39:42 -0000
Received: (qmail 12702 invoked by uid 500); 16 May 2008 18:39:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12673 invoked by uid 500); 16 May 2008 18:39:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12392 invoked by uid 99); 16 May 2008 18:39:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 11:39:34 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 18:38:39 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.13.8/8.13.8) with ESMTP id m4GIcro0007289
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 14:38:54 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <482DD488.9000702@informatics.jax.org>
Date: Fri, 16 May 2008 14:38:00 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 1.5.0.14 (Windows/20071210)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Possible Bug when Querying?
References: <482C65E9.7040304@informatics.jax.org> <5F0F4086-BF97-4963-8C39-194C1A297F52@gmail.com>
In-Reply-To: <5F0F4086-BF97-4963-8C39-194C1A297F52@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.4.2.338381, Antispam-Engine: 2.6.0.325393, Antispam-Data: 2008.5.16.112442
X-PerlMx-Spam: Gauge=IIIIIII, Probability=7%, Report='BODY_SIZE_2000_2999 0, BODY_SIZE_5000_LESS 0, __BOUNCE_CHALLENGE_SUBJ 0, __C230066_P5 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __HAS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __SANE_MSGID 0, __USER_AGENT 0, __pbl.spamhaus.org_TIMEOUT , __sbl.spamhaus.org_TIMEOUT '
X-Virus-Checked: Checked by ClamAV on apache.org

Very very interesting.

I went ahead and turned on the AllowLeadingWildcard toggle and 
everything works just as expected now, which is odd in a way.

I'm still not certain why a search for '\*ache*' would be considered to 
have a  leading wildcard.  I'm searching for the literal * character 
here which I would have assumed would be a completely fine thing to do 
in a search, but somehow its triggering the leading wildcard checking 
logic. 

Well, anyhow thanks much for the suggestion, things are working properly 
now.

Matt

Karl Wettin wrote:
>
> 15 maj 2008 kl. 18.33 skrev Matthew Hall:
>>
>> 12:23:05,602 INFO  [STDOUT] 
>> org.apache.lucene.queryParser.ParseException: Cannot parse '\*ache*': 
>> '*' not allowed as first character in PrefixQuery
>> 12:23:05,602 INFO  [STDOUT] Failure in QS_MarkerSearch.searchMarkerNomen
>> 12:23:05,602 ERROR [STDERR] java.lang.NullPointerException
>> 12:23:05,602 ERROR [STDERR]     at 
>> org.jax.mgi.search.model.QS_MarkerSearch.searchInexactMatches(Unknown 
>> Source)
>>
>>
>> Which looks to me alot like something akin to the 
>> AllowLeadingWildcard stuff that comes along with wildcardqueries.
>>
>> But, the odd thing is the leading character in my search string ISN'T 
>> *, its the escaped star character, which I would have thought would 
>> work with no problems at all.
>>
>> Have I stumbled across a bug here?
>
>
> Did you setAllowLeadingWildcard(true)?
>
>   /**
>    * Set to <code>true</code> to allow leading wildcard characters.
>    * <p>
>    * When set, <code>*</code> or <code>?</code> are allowed as
>    * the first character of a PrefixQuery and WildcardQuery.
>    * Note that this can produce very slow
>    * queries on big indexes.
>    * <p>
>    * Default: false.
>    */
>   public void setAllowLeadingWildcard(boolean allowLeadingWildcard) {
>
>
>
>      karl
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

-- 
Matthew Hall
Software Engineer
Mouse Genome Informatics
mhall@informatics.jax.org
(207) 288-6012



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34100-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 22:05:09 2008
Return-Path: <java-user-return-34100-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69986 invoked from network); 16 May 2008 22:05:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 22:05:09 -0000
Received: (qmail 70948 invoked by uid 500); 16 May 2008 22:05:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70910 invoked by uid 500); 16 May 2008 22:05:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70899 invoked by uid 99); 16 May 2008 22:05:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 15:05:03 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 22:04:10 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id B417971C18B; Fri, 16 May 2008 15:04:31 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 980D571C14C
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 15:04:31 -0700 (PDT)
Date: Fri, 16 May 2008 15:04:31 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user <java-user@lucene.apache.org>
Subject: Re: theoretical maximum score
In-Reply-To: <e994873a0805090602g6e16623fi4585a6b50fcdc8ae@mail.gmail.com>
Message-ID: <Pine.LNX.4.62.0805161452230.17485@radix.cryptio.net>
References: <e994873a0805090602g6e16623fi4585a6b50fcdc8ae@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Is it possible to compute a theoretical maximum score for a given query if
: constraints are placed on 'tf' and 'lengthNorm'? If so, scores could be
: compared to a 'perfect score' (a feature request from our customers)

without thinking about it two hard, you'd also need to constrain:
 * field and document boosts (which are combined with lengthNorm to create 
   the fieldNorm)
 * query time boosts
 * idf (there's no law that says Similarity.idf has to return a number 
   less then 1) 
 * queryNorm

...you'd also need to use query structures that are simple -- a 
ValueSourceQuery can break all the rules it wants -- but if you used only 
basic types of queries (boolean, term, phrase) and you imposed those 
constraints you could probably pull it off.

the key thing to watch out for is that even if you can do it, and you can 
start to say meaninful things like "doc A scored X out of a max possible Y 
against query Q" that doesn't neccessarily help you compare that with doc 
B which scored V out of a max possible W against query R ... even if X/Y == V/W 
... because the *structure* and complexity of Q and R play havock 
with the scores.

but comparisons like that are what people are going to start to do as 
soome as you give them a number like that.  People are going to start to 
tihnk "well doc A is an N% match for Q, and doc B is an N% match for R, 
but A is clearly a better match Q then B is for R .. what the heck?"

...i would do a lot of "subjective" testing using a variety of queries of 
various complexities before i put any faith in producing a number like 
that.

I suspect what you'd find is that the constraints you need to impose in 
order to give you a meaningful number wind up hobbling Lucene so much it 
doesn't do a very good job of scoring anything.




-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34101-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 22:25:17 2008
Return-Path: <java-user-return-34101-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72978 invoked from network); 16 May 2008 22:25:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 22:25:16 -0000
Received: (qmail 82235 invoked by uid 500); 16 May 2008 22:25:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82199 invoked by uid 500); 16 May 2008 22:25:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82188 invoked by uid 99); 16 May 2008 22:25:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 15:25:11 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 22:24:26 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 56EB471C352; Fri, 16 May 2008 15:24:41 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 5378771C349
	for <java-user@lucene.apache.org>; Fri, 16 May 2008 15:24:41 -0700 (PDT)
Date: Fri, 16 May 2008 15:24:41 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: RE: setPositionIncrement questions
In-Reply-To: <004c01c8b3a9$2d033910$bc2510ac@your0548c161e1>
Message-ID: <Pine.LNX.4.62.0805161516200.17485@radix.cryptio.net>
References: <4F16A37C073944A9BA3A47C3C3CDAA36.MAI@mail.livedns.co.il>
 <Pine.LNX.4.62.0803292249110.16762@radix.cryptio.net>
 <004c01c8b3a9$2d033910$bc2510ac@your0548c161e1>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: I ended up hacking StandardTokenizer::next() to check for $^$^$, and if it
: is there then set the current Token PositionIncrement to 500 and resume the

from what i remember of your use case, it probably would have been a lot 
easier to just add each paragraph as a seperate field instance (and rely 
on IndexWriter to call yourAnalyzer.getPositionIncrementGap() where you 
would return 500) then to inject magic tokens and make your analyzer treat 
them special -- but if you've already done it, you've already done it.

: tokenizing loop (so the word which will be read into that Term will have
: position increment of 500). As far as I can tell it is working well - how
: can I check the terms positions in a document's field and see they have been
: incremented indeed? I have tried Luke, but it doesn't seem to allow this. My
: field is tokenized and not stored.

you could trust that it works :) ... or you could query for a phrase that 
shouldn't work untill you increase teh slop to 500 ... or you could use 
something like IndexReader.termPositions to iterate over all the terms and 
see where they are.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34102-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 16 23:13:09 2008
Return-Path: <java-user-return-34102-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87455 invoked from network); 16 May 2008 23:13:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 May 2008 23:13:09 -0000
Received: (qmail 25037 invoked by uid 500); 16 May 2008 23:13:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25010 invoked by uid 500); 16 May 2008 23:13:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24999 invoked by uid 99); 16 May 2008 23:13:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 16:13:04 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chenjian1227@gmail.com designates 209.85.132.251 as permitted sender)
Received: from [209.85.132.251] (HELO an-out-0708.google.com) (209.85.132.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 23:12:19 +0000
Received: by an-out-0708.google.com with SMTP id c37so275803anc.49
        for <java-user@lucene.apache.org>; Fri, 16 May 2008 16:12:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=/odxuIDXvkW/6aEAmSbJaYJQ29CyJFjbKn6gjID+aqE=;
        b=Gt0v4CncLAfx1QctHI7XVv2yLF2x/yEPLLYRA68Uq4iHeu0n+2DS74dOuRk9D9DuBWjfomoO4Q/D5UWL/IdmOTgk8R/Ofdp4ROhgh9Fc/0vNQ8KSrXP8SVcRqwS/DC7HwokpmNADicmNra0SBzR7vjqyHWnPk4/DSPYitudGiJM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=Vi0/l/UTqBjelZAn8Y0VAadQG4jHZy7CPZGpVTgjPXnEk6Y1rV5nNdnDQtr/Nmx7WvooPf6ey9itpXXrFtLCyRUNK5l7YtRBa5kEVavZtcHS/2McP7pZsUrCmydWQ1jQS+ys1e9kL4oIqG9Ng9P33XCIfuMIuWr2EY0HZEH5s7g=
Received: by 10.100.128.20 with SMTP id a20mr5514436and.121.1210979554185;
        Fri, 16 May 2008 16:12:34 -0700 (PDT)
Received: by 10.100.205.4 with HTTP; Fri, 16 May 2008 16:12:34 -0700 (PDT)
Message-ID: <7ca123910805161612k5c9f3e69ia1eab150fdf2a343@mail.gmail.com>
Date: Fri, 16 May 2008 16:12:34 -0700
From: "jian chen" <chenjian1227@gmail.com>
To: java-user@lucene.apache.org
Subject: simultaneous read and writes to the RAMDirectory
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_18588_15475770.1210979554156"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_18588_15475770.1210979554156
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Lucene gurus,

I have a question regarding RAMDirectory usage. Can the IndexWriter keep
adding documents to the index meanwhile the IndexReader is open on this
RAMDirectory and searches going on?

I know in a FSDirectory case, the IndexWriter can add documents to the index
meanwhile IndexReader reads from the index. This is because the IndexWriter
just writes new index files rather than modifying existing index files. The
only place (I remember) that the new and old indexes will conflict is the
segment file. Again, once the IndexWriter commits the change (by calling
close() method), the segment.new is renamed to segment atomically. Since the
old segment file is cached in memory by the IndexReader, so not a problem
for the IndexReader to serve search requests. The old segment file is cached
in memory, the other files pointed to by the old segment file are cached by
Linux anyway, or not removed by windows due to still being used.

Anyway, back to the RAMDirectory case. Having an IndexReader open while
IndexWriter adding documents to it, will that cause any issue?

Thanks,

Jian

------=_Part_18588_15475770.1210979554156--

From java-user-return-34103-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 17 00:59:13 2008
Return-Path: <java-user-return-34103-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20153 invoked from network); 17 May 2008 00:59:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 May 2008 00:59:13 -0000
Received: (qmail 73021 invoked by uid 500); 17 May 2008 00:59:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72983 invoked by uid 500); 17 May 2008 00:59:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72972 invoked by uid 99); 17 May 2008 00:59:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 17:59:08 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.39.202] (HELO web50311.mail.re2.yahoo.com) (206.190.39.202)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 17 May 2008 00:58:13 +0000
Received: (qmail 9113 invoked by uid 60001); 17 May 2008 00:58:33 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=WOg83rstnh5D13juP83oGsUpg4B5QElM28lrpz3Uu38VeG9QuWfuCrKuSz/iuFgX+wj0e69v8Et3+QTTtpC2lHwisBlBDwaURO44zq/JEQ/t+k70adrZpQVorzCgcROsmU+a7tQnF3oO4jKlWjUUkxu/w++JW6WVOB60miEUmxo=;
X-YMail-OSG: 8a.4jwAVM1nAjYj8RuAkR1kkvQR19wUXwMowTzXYY_rqzKa8l_PZRfPY9SIDgSCpQsEgZ1lmP7_4ZFTgPPa4roS.8ikRNsvtMjOYJyP4YqEPmVvgfxGo.SpH3g--
Received: from [72.231.9.236] by web50311.mail.re2.yahoo.com via HTTP; Fri, 16 May 2008 17:58:33 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.185
Date: Fri, 16 May 2008 17:58:33 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: simultaneous read and writes to the RAMDirectory
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <382004.9085.qm@web50311.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I don't think there are any problems with doing both operations at the same time.


Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: jian chen <chenjian1227@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Friday, May 16, 2008 7:12:34 PM
> Subject: simultaneous read and writes to the RAMDirectory
> 
> Lucene gurus,
> 
> I have a question regarding RAMDirectory usage. Can the IndexWriter keep
> adding documents to the index meanwhile the IndexReader is open on this
> RAMDirectory and searches going on?
> 
> I know in a FSDirectory case, the IndexWriter can add documents to the index
> meanwhile IndexReader reads from the index. This is because the IndexWriter
> just writes new index files rather than modifying existing index files. The
> only place (I remember) that the new and old indexes will conflict is the
> segment file. Again, once the IndexWriter commits the change (by calling
> close() method), the segment.new is renamed to segment atomically. Since the
> old segment file is cached in memory by the IndexReader, so not a problem
> for the IndexReader to serve search requests. The old segment file is cached
> in memory, the other files pointed to by the old segment file are cached by
> Linux anyway, or not removed by windows due to still being used.
> 
> Anyway, back to the RAMDirectory case. Having an IndexReader open while
> IndexWriter adding documents to it, will that cause any issue?
> 
> Thanks,
> 
> Jian


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34104-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 17 01:05:50 2008
Return-Path: <java-user-return-34104-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21645 invoked from network); 17 May 2008 01:05:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 May 2008 01:05:50 -0000
Received: (qmail 76708 invoked by uid 500); 17 May 2008 01:05:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76460 invoked by uid 500); 17 May 2008 01:05:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76448 invoked by uid 99); 17 May 2008 01:05:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 18:05:44 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.62] (HELO web50308.mail.re2.yahoo.com) (206.190.38.62)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 17 May 2008 01:04:48 +0000
Received: (qmail 33621 invoked by uid 60001); 17 May 2008 01:05:08 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=g5kgvoQVdnta75rfRBD090iP2QTiHGtFJ5uwvtnOm5aoGYdcKWBLgvLjIPnLpzbn6zIEcond7POCeQ6kRdJ2+DJdGJrM0/ftr3ahPX6hKdNU+0bbFz+3X1NyA+yfl4DIQMwcBy3W3aeWO/WQ4GTfjPmmHe9mFKKK1Dflu+Oj2O4=;
X-YMail-OSG: YFQm3LcVM1lCaHNi4CzrvlVlXBXLp2TQBks8QnunAb19k0.3bZTUGa6JfKguqlCZ_.vIAsn63sHrYIHUeFlmZBwkcUaQm8JjsUq.S4JE9sR.TOUtsNosdYHLow--
Received: from [72.231.9.236] by web50308.mail.re2.yahoo.com via HTTP; Fri, 16 May 2008 18:05:08 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.185
Date: Fri, 16 May 2008 18:05:08 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: All results
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <884746.91215.qm@web50308.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I can't tell where you have a bug, but a couple of things look bad here:
1) java + HTML
2) opening/closing of the searcher for each request
3) empty if block in the else block.  who knows, maybe you are hitting that.

I think you simply need to do a little bit more debugging on your end.  Write a simple class that calls searcher.search(query string here) and *just* loop through all Hits without any if/else tests, and you'll see you'll loop though hits.length() matches.

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: Hasan Diwan <hasan.diwan@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Friday, May 16, 2008 1:32:16 PM
> Subject: Re: All results
> 
> On 15/05/2008, Otis Gospodnetic wrote:
> > What does your code look like?  If you are using Hits, what does hits.length() 
> give you?
> 
> Me code is below:
> Hits hits = searcher.search(parsedQuery);
>                 if (hits.length() == 0) {
>                     writer.print("Sorry, no results found. >                             + request.getSession().getServletContext()
>                                     .getServletContextName()
>                             + "\">Try again?");
>                     error = true;
>                 } else {
>                     if ((startIndex + maxPage) > hits.length()) {
>                     }
>                     for (int i = startIndex; i != hits.length(); i++) {
>                         final Document document = hits.doc(i);
>                         writer.print("
"
>                                 + document    .get("all")) + "
________________________________
");
>                     } // iterated through every hit
>                     if (searcher != null)
>                         searcher.close();
>                 }
> 
> -- 
> Cheers,
> Hasan Diwan 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34105-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 17 03:33:52 2008
Return-Path: <java-user-return-34105-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55927 invoked from network); 17 May 2008 03:33:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 May 2008 03:33:52 -0000
Received: (qmail 53535 invoked by uid 500); 17 May 2008 03:33:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53512 invoked by uid 500); 17 May 2008 03:33:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53501 invoked by uid 99); 17 May 2008 03:33:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 May 2008 20:33:46 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chenjian1227@gmail.com designates 209.85.132.242 as permitted sender)
Received: from [209.85.132.242] (HELO an-out-0708.google.com) (209.85.132.242)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 03:33:00 +0000
Received: by an-out-0708.google.com with SMTP id c37so288223anc.49
        for <java-user@lucene.apache.org>; Fri, 16 May 2008 20:33:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=PpB/HtdEc3fYBWLL9/zKybWdyaHm0VrfwiFCuf/B+gg=;
        b=BQQBVEZaMnD03hbGOcOkQD4WVuwD+FRm6eSoF4Mq3FXhxYD0co8eWXEHFpk1yrOZnn3r12QtlvjLVty/AF19UG1z2E0KOBpLMk+4FD92nMkGMRIXWHbEMzPvIBiRuCpX1uv8irEjNlx7nB45y+0spk4WAY8rkGvpZw4d/Q6jNsg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=g+IvGSXtyngiCwG6VUBVkmRq0Nw3+G26YQrjf3iwluHMnm1TGl2Wf/ZUAfnb2jSxQxSJCHozBOplpW8RjagPnkJe+hkUuI0a1CHyDv80ITGnFCT9yFjxiT1LJhbb6VTmESiyQbIDXh6KuSJzDnSY9oTzx6XUtI5EZ6x4addNtwc=
Received: by 10.100.108.20 with SMTP id g20mr5634143anc.106.1210995194984;
        Fri, 16 May 2008 20:33:14 -0700 (PDT)
Received: by 10.100.205.4 with HTTP; Fri, 16 May 2008 20:33:14 -0700 (PDT)
Message-ID: <7ca123910805162033y35473e2bqb705242ca52a5006@mail.gmail.com>
Date: Fri, 16 May 2008 20:33:14 -0700
From: "jian chen" <chenjian1227@gmail.com>
To: java-user@lucene.apache.org
Subject: two copies of indexes vs. master/slave indexes
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_19103_26945210.1210995194965"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_19103_26945210.1210995194965
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

I have seen two different designs for incremental index updates.

1) Have two copies of indexes A and B. The incremental updates happens on A
index while B index is being used for search. Then, hot swap the two
indexes. Bring B index up to date and perform incremental updates
thereafter.  In this scenario, searches are performed on index A or B
alternatively.

2) Have a master index where the incremental updates are applied. Then, the
slave indexes got synced up with the master index. Searches are performed
only on the slave indexes.

So, I want to know what are the trade offs between the two approaches? For
scalability, what's the best approach?

Thanks,

Jian

------=_Part_19103_26945210.1210995194965--

From java-user-return-34106-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 17 07:19:22 2008
Return-Path: <java-user-return-34106-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96641 invoked from network); 17 May 2008 07:19:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 May 2008 07:19:22 -0000
Received: (qmail 33347 invoked by uid 500); 17 May 2008 07:19:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33316 invoked by uid 500); 17 May 2008 07:19:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33305 invoked by uid 99); 17 May 2008 07:19:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 00:19:16 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.26] (HELO smtp-vbr6.xs4all.nl) (194.109.24.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 07:18:23 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr6.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4H7IjRG045651
	for <java-user@lucene.apache.org>; Sat, 17 May 2008 09:18:45 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: theoretical maximum score
Date: Sat, 17 May 2008 09:18:45 +0200
User-Agent: KMail/1.9.9
References: <e994873a0805090602g6e16623fi4585a6b50fcdc8ae@mail.gmail.com> <Pine.LNX.4.62.0805161452230.17485@radix.cryptio.net>
In-Reply-To: <Pine.LNX.4.62.0805161452230.17485@radix.cryptio.net>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805170918.45682.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Op Saturday 17 May 2008 00:04:31 schreef Chris Hostetter:
> : Is it possible to compute a theoretical maximum score for a given
> : query if constraints are placed on 'tf' and 'lengthNorm'? If so,
> : scores could be compared to a 'perfect score' (a feature request
> : from our customers)
 
I think a theoretical maximum score is only going to work when that
maximum applies to queries of any structure. So, start with the
simplest query, associate it with a theoretical maximum score, and
then for each possible combination of subqueries ((weighted)
and/or/phrase/span) make sure that the subscore values are
combined into another value that has the same theoretical
maximum.

Have a look here to start:
https://issues.apache.org/jira/browse/LUCENE-293

Regards,
Paul Elschot

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34107-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 17 08:22:09 2008
Return-Path: <java-user-return-34107-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8744 invoked from network); 17 May 2008 08:22:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 May 2008 08:22:09 -0000
Received: (qmail 59787 invoked by uid 500); 17 May 2008 08:22:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59752 invoked by uid 500); 17 May 2008 08:22:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59741 invoked by uid 99); 17 May 2008 08:22:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 01:22:02 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.132.251] (HELO an-out-0708.google.com) (209.85.132.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 08:21:14 +0000
Received: by an-out-0708.google.com with SMTP id c37so300474anc.49
        for <java-user@lucene.apache.org>; Sat, 17 May 2008 01:21:27 -0700 (PDT)
Received: by 10.100.110.15 with SMTP id i15mr5703981anc.130.1211012486916;
        Sat, 17 May 2008 01:21:26 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id d25sm10270753and.15.2008.05.17.01.21.25
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 17 May 2008 01:21:26 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <382004.9085.qm@web50311.mail.re2.yahoo.com>
References: <382004.9085.qm@web50311.mail.re2.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <EB4E3618-17C4-4646-9F80-C757F981EEAC@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: simultaneous read and writes to the RAMDirectory
Date: Sat, 17 May 2008 04:21:24 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


That's right, this is fine.  Many unit tests rely on it.

RAMDirectory is similar to UNIX in that deletion of an open file is  
allowed, yet anything that had the file open can continue to read  
from it.  "Delete on last close".

Also note that we don't write & rename a segments.new file anymore  
(as of 2.1).  Instead we write segments_N, where N increases each  
time the writer commits.

Mike

Otis Gospodnetic wrote:
> I don't think there are any problems with doing both operations at  
> the same time.
>
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
>> From: jian chen <chenjian1227@gmail.com>
>> To: java-user@lucene.apache.org
>> Sent: Friday, May 16, 2008 7:12:34 PM
>> Subject: simultaneous read and writes to the RAMDirectory
>>
>> Lucene gurus,
>>
>> I have a question regarding RAMDirectory usage. Can the  
>> IndexWriter keep
>> adding documents to the index meanwhile the IndexReader is open on  
>> this
>> RAMDirectory and searches going on?
>>
>> I know in a FSDirectory case, the IndexWriter can add documents to  
>> the index
>> meanwhile IndexReader reads from the index. This is because the  
>> IndexWriter
>> just writes new index files rather than modifying existing index  
>> files. The
>> only place (I remember) that the new and old indexes will conflict  
>> is the
>> segment file. Again, once the IndexWriter commits the change (by  
>> calling
>> close() method), the segment.new is renamed to segment atomically.  
>> Since the
>> old segment file is cached in memory by the IndexReader, so not a  
>> problem
>> for the IndexReader to serve search requests. The old segment file  
>> is cached
>> in memory, the other files pointed to by the old segment file are  
>> cached by
>> Linux anyway, or not removed by windows due to still being used.
>>
>> Anyway, back to the RAMDirectory case. Having an IndexReader open  
>> while
>> IndexWriter adding documents to it, will that cause any issue?
>>
>> Thanks,
>>
>> Jian
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34108-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 17 17:16:01 2008
Return-Path: <java-user-return-34108-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9329 invoked from network); 17 May 2008 17:16:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 May 2008 17:16:00 -0000
Received: (qmail 64524 invoked by uid 500); 17 May 2008 17:15:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64483 invoked by uid 500); 17 May 2008 17:15:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64472 invoked by uid 99); 17 May 2008 17:15:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 10:15:50 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.191.85.18] (HELO web36601.mail.mud.yahoo.com) (209.191.85.18)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 17 May 2008 17:14:53 +0000
Received: (qmail 52088 invoked by uid 60001); 17 May 2008 17:15:10 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Reply-To:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=Xim5f+bR9xlGLK3Qdh835cAnvKYL16kynvTeujntXwcuOEfTwTE+xrmyHHYAspfi03XFNJg7lk7BQgkvnDpoNW7+MNKhJZbpV/xErKqvDrqorFNJV5l9w44hgYkNYfEyXAPzJ76uiQUiApkqrDFTo9OVaYNehprs9si5tpmXHn4=;
X-YMail-OSG: 8BzLAFgVM1m6ArzOXLmeDJ12b0CtIMsZ1WdOmdQqXstEQjMJ4KpfXvqb.HJ1QNMJW1G8I1gxfh.gA6vIS_LNMCkNGVWjkehKAXdZi86QqQIMzacEklx2A3HQknI-
Received: from [133.9.4.12] by web36601.mail.mud.yahoo.com via HTTP; Sat, 17 May 2008 10:15:10 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.185
Date: Sat, 17 May 2008 10:15:10 -0700 (PDT)
From: Supheakmungkol SARIN <supheakmungkol@yahoo.com>
Reply-To: Supheakmungkol SARIN <supheakmungkol.sarin@gmail.com>
Subject: Re: Document clustering with Lucene
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1620799875-1211044510=:49153"
Message-ID: <345962.49153.qm@web36601.mail.mud.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1620799875-1211044510=:49153
Content-Type: text/plain; charset=us-ascii

You're right. I want document clustering precisely the documents that are already in the index. I don't know much about Mahout project, but it seems that it doesn't help much. What I want is simply to group together similar documents according to their similarity distance of the term vectors.

Anyway, thank you Otis and Grant for your suggestions. I appreciate them.

Regards,

Supheakmungkol


----- Original Message ----
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
Sent: Friday, May 16, 2008 7:22:39 PM
Subject: Re: Document clustering with Lucene

Do you want search result clustering or document clustering?  My  
understanding of Carrot2 is it isn't designed for the latter.  The  
difference being it is designed to work off of shorter snippets of  
text, as opposed to the whole document.  FWIW, you _might_ find some  
help over on the Mahout project (http://lucene.apache.org/mahout) in  
terms of different approaches.  We have a couple of clustering  
approaches implemented there, but they just work off a matrix and it  
is up to you to fill the matrix (presumably with some distance  
calculation.)  The Carrot2 list may also help clarify if it is the  
appropriate place.

-Grant

On May 15, 2008, at 4:34 PM, Otis Gospodnetic wrote:

> Have you tried using Carrot2 with Lucene?  They work quite well in  
> tandem!
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
>> From: Supheakmungkol SARIN <supheakmungkol@yahoo.com>
>> To: java-user@lucene.apache.org
>> Sent: Wednesday, May 14, 2008 11:23:45 PM
>> Subject: Document clustering with Lucene
>>
>> Dear all,
>>
>> I'd like to do document clustering using full-text with Lucene. In  
>> other words,
>> I would like to group similar documents in their respective groups.  
>> I searched
>> the mailing list and found that there are two ways around. The  
>> first method is
>> to represent the one document as query and search the collection.  
>> The other way
>> would be to construct the vector of terms of each of the documents  
>> and use the
>> cosine distance function to compute the similarity. I found these  
>> methods here:
>>
>> - http://www.mail-archive.com/lucene-user@jakarta.apache.org/msg04916.html) 
>> .
>>
>> I would like to know whether there are better way? or any built-in  
>> functions to
>> do clustering in the recent release version of Lucene?
>>
>> Thank you.
>>
>> Kind regards,
>>
>> Supheakmungkol
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--0-1620799875-1211044510=:49153--

From java-user-return-34109-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 17 17:52:31 2008
Return-Path: <java-user-return-34109-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14905 invoked from network); 17 May 2008 17:52:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 May 2008 17:52:31 -0000
Received: (qmail 91192 invoked by uid 500); 17 May 2008 17:52:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91154 invoked by uid 500); 17 May 2008 17:52:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91142 invoked by uid 99); 17 May 2008 17:52:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 10:52:25 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 17:51:39 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id A37C671C459; Sat, 17 May 2008 10:51:54 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 9F6D671C458
	for <java-user@lucene.apache.org>; Sat, 17 May 2008 10:51:54 -0700 (PDT)
Date: Sat, 17 May 2008 10:51:54 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Using more tokens in TokenFilter :(
In-Reply-To: <17238836.post@talk.nabble.com>
Message-ID: <Pine.LNX.4.62.0805171041580.11799@radix.cryptio.net>
References: <17238836.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


each call of next can only return one token ... if you wnat to return more 
then one token based on each token you find in "input" then you need to 
buffer them.

There's an abstract class in Solr that you can look at to see how this can 
be done, and you can subclass it to get all the benefits...

http://svn.apache.org/viewvc/lucene/solr/trunk/src/java/org/apache/solr/analysis/BufferedTokenStream.java?revision=643465&view=markup


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34110-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 17 18:23:02 2008
Return-Path: <java-user-return-34110-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28369 invoked from network); 17 May 2008 18:23:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 May 2008 18:23:02 -0000
Received: (qmail 5487 invoked by uid 500); 17 May 2008 18:22:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5451 invoked by uid 500); 17 May 2008 18:22:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5440 invoked by uid 99); 17 May 2008 18:22:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 11:22:57 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 18:22:11 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 110DA71C41A; Sat, 17 May 2008 11:22:27 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 0D20971C419
	for <java-user@lucene.apache.org>; Sat, 17 May 2008 11:22:27 -0700 (PDT)
Date: Sat, 17 May 2008 11:22:27 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Search and retrieve the line data from the File
In-Reply-To: <ddef46640805120251i157862dflcc6c21efe6a3adc2@mail.gmail.com>
Message-ID: <Pine.LNX.4.62.0805171120410.20701@radix.cryptio.net>
References: <ddef46640805120235o7b771fe8l6c0c27181c9dc8b5@mail.gmail.com>
 <ddef46640805120251i157862dflcc6c21efe6a3adc2@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Please help me over how could i achieve the above process to search for a
: word in the file and display the results as discussed.

make each line in the file a seperate Lucene "Document" then the results 
of each Query will be a "line"



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34111-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 17 18:29:18 2008
Return-Path: <java-user-return-34111-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29666 invoked from network); 17 May 2008 18:29:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 May 2008 18:29:18 -0000
Received: (qmail 10005 invoked by uid 500); 17 May 2008 18:29:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9969 invoked by uid 500); 17 May 2008 18:29:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9955 invoked by uid 99); 17 May 2008 18:29:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 11:29:14 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 194.109.24.37 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.37] (HELO smtp-vbr17.xs4all.nl) (194.109.24.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 18:28:27 +0000
Received: from [10.0.2.2] (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr17.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4HISeY2061500
	for <java-user@lucene.apache.org>; Sat, 17 May 2008 20:28:41 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <2FDF2C5D-79F4-4EAB-8606-D571E78FC133@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: multi word synonyms
Date: Sat, 17 May 2008 20:28:40 +0200
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

As far as I know Lucene only handle single word synonyms at index  
time. My life would be much simpler if it was possible to add synonyms  
that spanned over multiple tokens, such as "lucene in action"="lia". I  
have a couple of workarounds that are OK but it really isn't the same  
thing when it comes down to the scoring.

The thing that does the best job at scoring was to assemble several  
permutations of the same document. But it doesn't feel good. I have  
cases where that means several hundred documents, and I have to do  
post processing to filter out the "duplicate" hits. It can turn out to  
be rather expensive. And I'm sure it mess with the scoring in several  
ways I did not notice yet.

I've also considering creating some multi dimensional term position  
space, but I'd say that could take a lot of time to implement.

Are there any good solutions to this?


         karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34112-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 17 22:01:46 2008
Return-Path: <java-user-return-34112-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79993 invoked from network); 17 May 2008 22:01:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 May 2008 22:01:46 -0000
Received: (qmail 12366 invoked by uid 500); 17 May 2008 22:01:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12327 invoked by uid 500); 17 May 2008 22:01:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12316 invoked by uid 99); 17 May 2008 22:01:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 15:01:39 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.30] (HELO smtp-vbr10.xs4all.nl) (194.109.24.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 22:00:52 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr10.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4HM14sT055917
	for <java-user@lucene.apache.org>; Sun, 18 May 2008 00:01:05 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: multi word synonyms
Date: Sun, 18 May 2008 00:01:04 +0200
User-Agent: KMail/1.9.9
References: <2FDF2C5D-79F4-4EAB-8606-D571E78FC133@gmail.com>
In-Reply-To: <2FDF2C5D-79F4-4EAB-8606-D571E78FC133@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805180001.04351.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Op Saturday 17 May 2008 20:28:40 schreef Karl Wettin:
> As far as I know Lucene only handle single word synonyms at index
> time. My life would be much simpler if it was possible to add
> synonyms that spanned over multiple tokens, such as "lucene in
> action"="lia". I have a couple of workarounds that are OK but it
> really isn't the same thing when it comes down to the scoring.
>
> The thing that does the best job at scoring was to assemble several
> permutations of the same document. But it doesn't feel good. I have
> cases where that means several hundred documents, and I have to do
> post processing to filter out the "duplicate" hits. It can turn out
> to be rather expensive. And I'm sure it mess with the scoring in
> several ways I did not notice yet.
>
> I've also considering creating some multi dimensional term position
> space, but I'd say that could take a lot of time to implement.
>
> Are there any good solutions to this?

The simplest solution is to index such synonyms at the first or last
or middle position of the source tokens, using a zero position
increment for the synonym. Was this one of the workarounds?

The advantage of the zero position increment is that the original
token positions are not affected, so at least there is no influence
on scoring because of changes in the original token positions.

Regards,
Paul Elschot

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34113-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 18 00:26:35 2008
Return-Path: <java-user-return-34113-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13141 invoked from network); 18 May 2008 00:26:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 May 2008 00:26:34 -0000
Received: (qmail 62376 invoked by uid 500); 18 May 2008 00:26:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62350 invoked by uid 500); 18 May 2008 00:26:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62339 invoked by uid 99); 18 May 2008 00:26:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 17:26:28 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of johnbjensen@gmail.com designates 209.85.198.236 as permitted sender)
Received: from [209.85.198.236] (HELO rv-out-0506.google.com) (209.85.198.236)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 00:25:36 +0000
Received: by rv-out-0506.google.com with SMTP id f6so689966rvb.5
        for <java-user@lucene.apache.org>; Sat, 17 May 2008 17:25:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=fq2N+JCWwBv/wJwbaM2vu+pSwLk0+w29CtpE7PzldiI=;
        b=iLU5ljybxEnV4bnBPomxuquaHgQeDVJVkzeLPesQFbX2DNh0G52CETnOEmWTNGSrtzsshmvc1OGJyvPH3M3YMP5e8CYmPMOBsURsdReGIjwHNy36SJIgykLWcIAoe/NnAyz6klq4nOLEsY64xD7QfpZ80F3Uz/RtIJ2BdYjC34Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=TFOfqaMZlpLj5TLw1JRhdWGWax6iSoEc0aXqTLleI1VS2BH4AXZOvcxW/gbYI0PzUnDr0/mygvw0VNfa1vyANp2OEtqTwaFDM8hlMfLuuOYtHJjNGsabei7gk0EK0w3lPzsaWTDS03LtAs1gv844p6EB9k4oQmlUCo5xCRsrx6Q=
Received: by 10.141.129.14 with SMTP id g14mr2712971rvn.274.1211070357579;
        Sat, 17 May 2008 17:25:57 -0700 (PDT)
Received: by 10.141.114.9 with HTTP; Sat, 17 May 2008 17:25:57 -0700 (PDT)
Message-ID: <54208a510805171725r7988e8c8xfca2e279eb4021b@mail.gmail.com>
Date: Sat, 17 May 2008 17:25:57 -0700
From: "John Jensen" <johnbjensen@gmail.com>
To: java-user@lucene.apache.org
Subject: MultiTerm Or Query with per-term boost. Does it exist?
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_17835_18317774.1211070357573"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_17835_18317774.1211070357573
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,

I have an application where I need to issue queries with a large number of
or-terms with individual boosts.

Currently I just construct a BooleanQuery with a large number (often 1000)
of constituent TermQueries. I'm wondering if there is a better way to do
this?
I'm open to implementing my own Query subclass if I can expect significant
performance improvements from doing this.

TIA for any insights and suggestions.

-- John

------=_Part_17835_18317774.1211070357573--

From java-user-return-34114-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 18 01:53:59 2008
Return-Path: <java-user-return-34114-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34185 invoked from network); 18 May 2008 01:53:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 May 2008 01:53:58 -0000
Received: (qmail 91356 invoked by uid 500); 18 May 2008 01:53:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91323 invoked by uid 500); 18 May 2008 01:53:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91312 invoked by uid 99); 18 May 2008 01:53:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 May 2008 18:53:52 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a19.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 01:53:06 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a19.g.dreamhost.com (Postfix) with ESMTP id E15B912002
	for <java-user@lucene.apache.org>; Sat, 17 May 2008 18:53:20 -0700 (PDT)
Message-Id: <C1595812-F0CF-4FF5-8514-1DD7D87CFF01@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <345962.49153.qm@web36601.mail.mud.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Document clustering with Lucene
Date: Sat, 17 May 2008 21:53:19 -0400
References: <345962.49153.qm@web36601.mail.mud.yahoo.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org


On May 17, 2008, at 1:15 PM, Supheakmungkol SARIN wrote:

> You're right. I want document clustering precisely the documents  
> that are already in the index. I don't know much about Mahout  
> project, but it seems that it doesn't help much. What I want is  
> simply to group together similar documents according to their  
> similarity distance of the term vectors.

I was just suggesting you ask there, not that there is a solution yet  
for what you need in Mahout.  There are a fair number of people  
interested in clustering on Mahout.

Cheers,
Grant

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34115-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 18 14:31:07 2008
Return-Path: <java-user-return-34115-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64534 invoked from network); 18 May 2008 14:31:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 May 2008 14:31:06 -0000
Received: (qmail 58636 invoked by uid 500); 18 May 2008 14:31:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58608 invoked by uid 500); 18 May 2008 14:31:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58597 invoked by uid 99); 18 May 2008 14:31:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 07:31:01 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=SPF_NEUTRAL,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 194.109.24.21 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.21] (HELO smtp-vbr1.xs4all.nl) (194.109.24.21)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 14:30:13 +0000
Received: from [10.0.2.2] (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr1.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4IEUQdX032792
	for <java-user@lucene.apache.org>; Sun, 18 May 2008 16:30:27 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <A89C80AE-5AE7-4C09-8B87-F712CCE36931@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <200805180001.04351.paul.elschot@xs4all.nl>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: multi word synonyms
Date: Sun, 18 May 2008 16:30:26 +0200
References: <2FDF2C5D-79F4-4EAB-8606-D571E78FC133@gmail.com> <200805180001.04351.paul.elschot@xs4all.nl>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org


18 maj 2008 kl. 00.01 skrev Paul Elschot:
> Op Saturday 17 May 2008 20:28:40 schreef Karl Wettin:
>> As far as I know Lucene only handle single word synonyms at index
>> time. My life would be much simpler if it was possible to add
>> synonyms that spanned over multiple tokens, such as "lucene in
>> action"="lia". I have a couple of workarounds that are OK but it
>> really isn't the same thing when it comes down to the scoring.
>>
> The simplest solution is to index such synonyms at the first or last
> or middle position of the source tokens, using a zero position
> increment for the synonym. Was this one of the workarounds?

I get sloppyFreq problems with that.

> The advantage of the zero position increment is that the original
> token positions are not affected, so at least there is no influence
> on scoring because of changes in the original token positions.


I copy a number of fields to a single one. Each such field can be  
represented in a number of languages or aliases in the same language.

[a, b, c, d, e, f], [g, h, i],    [j, k, l ,m]
                     [o, p]        [u, v]
                     [q, r, s, t]

It would be great if the phrase query on [f, o, p, u, v] could yeild a  
0 distance.

If I'd been using the same synonyms for the same phrases in all  
documents at all times the edit distance would be static when scoring,  
but I don't.

The terms of these synonyms are not really compatible with each other.  
For instance [f, g, s, t, j] should not be allowed or at least be  
heavily penalised compared to [f, o, p, j].

Searching a combination of languages should be allowed but preferably  
only one per field copied to the big field. (Disjunction is not  
applicable.)

It is OK the way I have it running now, but more dimensions as  
described above really increases the score quality. I confirmed that  
using permutations of documents and filtering out the "duplicates".  
Now I'm thinking it could be solved using token payloads and a brand  
new MultiDimensionalSpanQuery. Not too different from what you  
suggested way back in http://www.nabble.com/Using-Lucene-for-searching-tokens%2C-not-storing-them.-to3918462.html#a3944016

There are some other issues too, but I'm not at liberty to disclose  
too much. I hope it still makes sense?


         karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34116-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 18 16:31:16 2008
Return-Path: <java-user-return-34116-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28644 invoked from network); 18 May 2008 16:31:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 May 2008 16:31:16 -0000
Received: (qmail 15530 invoked by uid 500); 18 May 2008 16:31:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15496 invoked by uid 500); 18 May 2008 16:31:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15485 invoked by uid 99); 18 May 2008 16:31:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 09:31:11 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 194.109.24.34 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.34] (HELO smtp-vbr14.xs4all.nl) (194.109.24.34)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 16:30:24 +0000
Received: from [10.0.2.2] (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr14.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4IGUalh011288
	for <java-user@lucene.apache.org>; Sun, 18 May 2008 18:30:36 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <39321CEC-3124-43A3-AB9D-90905A6C17EF@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <54208a510805171725r7988e8c8xfca2e279eb4021b@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: MultiTerm Or Query with per-term boost. Does it exist?
Date: Sun, 18 May 2008 18:30:35 +0200
References: <54208a510805171725r7988e8c8xfca2e279eb4021b@mail.gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org


18 maj 2008 kl. 02.25 skrev John Jensen:
> Hi,
>
> I have an application where I need to issue queries with a large  
> number of
> or-terms with individual boosts.
>
> Currently I just construct a BooleanQuery with a large number (often  
> 1000)
> of constituent TermQueries. I'm wondering if there is a better way  
> to do
> this?
> I'm open to implementing my own Query subclass if I can expect  
> significant
> performance improvements from doing this.

What is the general problem with your approach? And what does all  
these boosted term queries represent?

Would it be perhaps be possible for you to add the boost at index time  
instead of at query time?


      karl



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34117-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 18 17:18:26 2008
Return-Path: <java-user-return-34117-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36307 invoked from network); 18 May 2008 17:18:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 May 2008 17:18:26 -0000
Received: (qmail 45494 invoked by uid 500); 18 May 2008 17:18:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45452 invoked by uid 500); 18 May 2008 17:18:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45441 invoked by uid 99); 18 May 2008 17:18:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 10:18:21 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.36] (HELO smtp-vbr16.xs4all.nl) (194.109.24.36)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 17:17:32 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr16.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4IHHkwM051306
	for <java-user@lucene.apache.org>; Sun, 18 May 2008 19:17:46 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: multi word synonyms
Date: Sun, 18 May 2008 19:17:49 +0200
User-Agent: KMail/1.9.9
References: <2FDF2C5D-79F4-4EAB-8606-D571E78FC133@gmail.com> <200805180001.04351.paul.elschot@xs4all.nl> <A89C80AE-5AE7-4C09-8B87-F712CCE36931@gmail.com>
In-Reply-To: <A89C80AE-5AE7-4C09-8B87-F712CCE36931@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805181917.49715.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Op Sunday 18 May 2008 16:30:26 schreef Karl Wettin:
> 18 maj 2008 kl. 00.01 skrev Paul Elschot:
> > Op Saturday 17 May 2008 20:28:40 schreef Karl Wettin:
> >> As far as I know Lucene only handle single word synonyms at index
> >> time. My life would be much simpler if it was possible to add
> >> synonyms that spanned over multiple tokens, such as "lucene in
> >> action"="lia". I have a couple of workarounds that are OK but it
> >> really isn't the same thing when it comes down to the scoring.
> >
> > The simplest solution is to index such synonyms at the first or
> > last or middle position of the source tokens, using a zero position
> > increment for the synonym. Was this one of the workarounds?
>
> I get sloppyFreq problems with that.
>
> > The advantage of the zero position increment is that the original
> > token positions are not affected, so at least there is no influence
> > on scoring because of changes in the original token positions.
>
> I copy a number of fields to a single one. Each such field can be
> represented in a number of languages or aliases in the same language.
>
> [a, b, c, d, e, f], [g, h, i],    [j, k, l ,m]
>                      [o, p]        [u, v]
>                      [q, r, s, t]
>
> It would be great if the phrase query on [f, o, p, u, v] could yeild
> a 0 distance.
>
> If I'd been using the same synonyms for the same phrases in all
> documents at all times the edit distance would be static when
> scoring, but I don't.
>
> The terms of these synonyms are not really compatible with each
> other. For instance [f, g, s, t, j] should not be allowed or at least
> be heavily penalised compared to [f, o, p, j].
>
> Searching a combination of languages should be allowed but preferably
> only one per field copied to the big field. (Disjunction is not
> applicable.)
>
> It is OK the way I have it running now, but more dimensions as
> described above really increases the score quality. I confirmed that
> using permutations of documents and filtering out the "duplicates".
> Now I'm thinking it could be solved using token payloads and a brand
> new MultiDimensionalSpanQuery. Not too different from what you
> suggested way back in
> http://www.nabble.com/Using-Lucene-for-searching-tokens%2C-not-storin
>g-them.-to3918462.html#a3944016

That would mean a term extending tag to indicate that a term is on
an alternative path?

>
> There are some other issues too, but I'm not at liberty to disclose
> too much. I hope it still makes sense?

Yes. I suppose the payload would indicate how much the alternative
path length differs from the original path?

In case you can't disclose more, no answer would off course be ok, too.

Regards,
Paul Elschot

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34118-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 18 18:00:01 2008
Return-Path: <java-user-return-34118-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41881 invoked from network); 18 May 2008 18:00:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 May 2008 18:00:01 -0000
Received: (qmail 65393 invoked by uid 500); 18 May 2008 17:59:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65364 invoked by uid 500); 18 May 2008 17:59:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65349 invoked by uid 99); 18 May 2008 17:59:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 10:59:52 -0700
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=SPF_NEUTRAL,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 194.109.24.30 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.30] (HELO smtp-vbr10.xs4all.nl) (194.109.24.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 17:59:03 +0000
Received: from [10.0.2.2] (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr10.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4IHxHwX027814
	for <java-user@lucene.apache.org>; Sun, 18 May 2008 19:59:17 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <4DB1369D-A748-4ED5-89CE-A1F49C1954EB@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <200805181917.49715.paul.elschot@xs4all.nl>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: multi word synonyms
Date: Sun, 18 May 2008 19:59:16 +0200
References: <2FDF2C5D-79F4-4EAB-8606-D571E78FC133@gmail.com> <200805180001.04351.paul.elschot@xs4all.nl> <A89C80AE-5AE7-4C09-8B87-F712CCE36931@gmail.com> <200805181917.49715.paul.elschot@xs4all.nl>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org


18 maj 2008 kl. 19.17 skrev Paul Elschot:
>> Now I'm thinking it could be solved using token payloads and a brand
>> new MultiDimensionalSpanQuery. Not too different from what you
>> suggested way back in
>> http://www.nabble.com/Using-Lucene-for-searching-tokens%2C-not-storin
>> g-them.-to3918462.html#a3944016
>
> That would mean a term extending tag to indicate that a term is on
> an alternative path?

No extra token, just payloads. I think. Really didn't think that much  
about it yet.

> I suppose the payload would indicate how much the alternative
> path length differs from the original path?

Something like that. Maybe it could be nice if it allowed for terms in  
diffrent places of the index to be part of the same synonym dimension  
for some extra boost the more the query matches tokens in the same  
dimension. But I'm not completely sure about that either.


This brings me to another thing: isn't there a layer of code missing  
that partition and read payload data? I already use payloads for  
position boosts and would have to hack a bit extra to combine that.


      karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34119-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 18 19:03:55 2008
Return-Path: <java-user-return-34119-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61244 invoked from network); 18 May 2008 19:03:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 May 2008 19:03:55 -0000
Received: (qmail 98165 invoked by uid 500); 18 May 2008 19:03:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98141 invoked by uid 500); 18 May 2008 19:03:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98130 invoked by uid 99); 18 May 2008 19:03:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 12:03:50 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of johnbjensen@gmail.com designates 209.85.198.224 as permitted sender)
Received: from [209.85.198.224] (HELO rv-out-0506.google.com) (209.85.198.224)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 19:03:03 +0000
Received: by rv-out-0506.google.com with SMTP id f6so926406rvb.5
        for <java-user@lucene.apache.org>; Sun, 18 May 2008 12:03:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=FquKTkjB+/rkZ/hpKL8a/VU4f77ybaCEZNOtgHTq6gQ=;
        b=hCv0O5FA800Az9JrZpCopLdEX5Nqq7Y7iCF8Uv5V4EdiddO47B1r8zt6I6sFq/cOekFm+n73dqK54wgtGmmMWj/ByMrxBUlZ2tGTr1kmeZNr7hSQf9Uh966T6vBkP4hHiahwmUodgos1T4ZKiVX0+MICmkVABjZ+5qAC5QAfn5w=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=JoeucjqCQt50ZPPg1Xcag51Rc9KoNRst/MiZwTzhL1e07wubPYNipkZ9vCtYf3lnGs0hxJrkxLOFIgOSjP5VOrdP4c5cNO7ReG/sfk1/SVxJ25i+i1ADZ/ATMnfTOyPSxnmVZuBtrZjh3OV7FW30N5ZXpLhhtgNW9xubt4s08LU=
Received: by 10.140.127.13 with SMTP id z13mr3180329rvc.142.1211137399160;
        Sun, 18 May 2008 12:03:19 -0700 (PDT)
Received: by 10.141.114.9 with HTTP; Sun, 18 May 2008 12:03:19 -0700 (PDT)
Message-ID: <54208a510805181203l4fd8a364n4cfd9d34ab4ab28b@mail.gmail.com>
Date: Sun, 18 May 2008 12:03:19 -0700
From: "John Jensen" <johnbjensen@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: MultiTerm Or Query with per-term boost. Does it exist?
In-Reply-To: <39321CEC-3124-43A3-AB9D-90905A6C17EF@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_19513_29514182.1211137399171"
References: <54208a510805171725r7988e8c8xfca2e279eb4021b@mail.gmail.com>
	 <39321CEC-3124-43A3-AB9D-90905A6C17EF@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_19513_29514182.1211137399171
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

The only problem is, that I'm thinking that a special purpose Query subclass
might be faster, but I was wondering if others have run into similar
situations, and whether they saw performance win by replacing complex
BooleanQueries with a special purpose Query subclass.

Unfortunately the boosts are query specific and can't be done at index time.

Thanks,
  John





On Sun, May 18, 2008 at 9:30 AM, Karl Wettin <karl.wettin@gmail.com> wrote:

>
> 18 maj 2008 kl. 02.25 skrev John Jensen:
>
>> Hi,
>>
>> I have an application where I need to issue queries with a large number of
>> or-terms with individual boosts.
>>
>> Currently I just construct a BooleanQuery with a large number (often 1000)
>> of constituent TermQueries. I'm wondering if there is a better way to do
>> this?
>> I'm open to implementing my own Query subclass if I can expect significant
>> performance improvements from doing this.
>>
>
> What is the general problem with your approach? And what does all these
> boosted term queries represent?
>
> Would it be perhaps be possible for you to add the boost at index time
> instead of at query time?
>
>
>     karl
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_19513_29514182.1211137399171--

From java-user-return-34120-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 18 19:20:31 2008
Return-Path: <java-user-return-34120-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64821 invoked from network); 18 May 2008 19:20:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 May 2008 19:20:31 -0000
Received: (qmail 9853 invoked by uid 500); 18 May 2008 19:20:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9824 invoked by uid 500); 18 May 2008 19:20:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9813 invoked by uid 99); 18 May 2008 19:20:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 12:20:26 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.31] (HELO smtp-vbr11.xs4all.nl) (194.109.24.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 19:19:32 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr11.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4IJJskW055728
	for <java-user@lucene.apache.org>; Sun, 18 May 2008 21:19:55 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: MultiTerm Or Query with per-term boost. Does it exist?
Date: Sun, 18 May 2008 21:19:59 +0200
User-Agent: KMail/1.9.9
References: <54208a510805171725r7988e8c8xfca2e279eb4021b@mail.gmail.com> <39321CEC-3124-43A3-AB9D-90905A6C17EF@gmail.com> <54208a510805181203l4fd8a364n4cfd9d34ab4ab28b@mail.gmail.com>
In-Reply-To: <54208a510805181203l4fd8a364n4cfd9d34ab4ab28b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805182119.59807.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

See below.

Op Sunday 18 May 2008 21:03:19 schreef John Jensen:
> The only problem is, that I'm thinking that a special purpose Query
> subclass might be faster, but I was wondering if others have run into
> similar situations, and whether they saw performance win by replacing
> complex BooleanQueries with a special purpose Query subclass.
>
> Unfortunately the boosts are query specific and can't be done at
> index time.
>
> Thanks,
>   John
>
> On Sun, May 18, 2008 at 9:30 AM, Karl Wettin <karl.wettin@gmail.com> 
wrote:
> > 18 maj 2008 kl. 02.25 skrev John Jensen:
> >> Hi,
> >>
> >> I have an application where I need to issue queries with a large
> >> number of or-terms with individual boosts.
> >>
> >> Currently I just construct a BooleanQuery with a large number
> >> (often 1000) of constituent TermQueries. I'm wondering if there is
> >> a better way to do this?
> >> I'm open to implementing my own Query subclass if I can expect
> >> significant performance improvements from doing this.

Does BooleanQuery.setAllowDocsOutOfOrder() make a difference?

Regards,
Paul Elschot


> >
> > What is the general problem with your approach? And what does all
> > these boosted term queries represent?
> >
> > Would it be perhaps be possible for you to add the boost at index
> > time instead of at query time?
> >
> >
> >     karl
> >
> >
> >
> > -------------------------------------------------------------------
> >-- To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34121-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 18 20:32:51 2008
Return-Path: <java-user-return-34121-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86676 invoked from network); 18 May 2008 20:32:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 May 2008 20:32:51 -0000
Received: (qmail 64318 invoked by uid 500); 18 May 2008 20:32:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64287 invoked by uid 500); 18 May 2008 20:32:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64276 invoked by uid 99); 18 May 2008 20:32:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 13:32:46 -0700
X-ASF-Spam-Status: No, hits=3.8 required=10.0
	tests=MIME_QP_LONG_LINE,RCVD_IN_BL_SPAMCOP_NET,SPF_PASS,UNPARSEABLE_RELAY
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [62.219.78.209] (HELO smtpin.livedns.co.il) (62.219.78.209)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 May 2008 20:31:57 +0000
Received: from ([127.0.0.1]) with MailEnable ESMTP; Sun, 18 May 2008 23:33:41 +0200
Received: from ([80.250.149.60]) by mail.livedns.co.il with MailEnable WebMail; Sun, 18 May 2008 23:32:05 +0300
To: <java-user@lucene.apache.org>
From: "Itamar Syn-Hershko" <itamar@divrei-tora.com>
Subject: Getting Terms Position Gaps
Date: Sun, 18 May 2008 23:32:05 +0300
Message-ID: <1B853E13A351495E8C59A5BFFD82BF91.MAI@mail.livedns.co.il>
MIME-Version: 1.0
X-Mailer: MailEnable WebMail.NET
X-MimeOLE: Produced By MailEnable WebMail.NET V3.14.0.0
X-Read: 0
Content-Type: multipart/mixed;
	boundary="--=_Part_FACA524E797B4FDBA3373DCEF637E1FF"
X-Priority: 3
X-MSMail-Priority: Medium
X-Virus-Checked: Checked by ClamAV on apache.org

----=_Part_FACA524E797B4FDBA3373DCEF637E1FF
Content-Type: text/plain; charset="windows-1255"
Content-Transfer-Encoding: quoted-printable

Hi all,
 
How can I see the position gaps in my indexed field=3F I've set up some sort of mechanism to increment position gap for specific terms in specific circumstances, and I want to make sure it is working as expected. I've tried Luke but it doesn't seem to be able to view this info.
 
Thanks in advance,
 
Itamar.



----=_Part_FACA524E797B4FDBA3373DCEF637E1FF
Content-Type: text/plain; charset=us-ascii

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
----=_Part_FACA524E797B4FDBA3373DCEF637E1FF--



From java-user-return-34122-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 19 08:17:25 2008
Return-Path: <java-user-return-34122-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59125 invoked from network); 19 May 2008 08:17:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 May 2008 08:17:25 -0000
Received: (qmail 94330 invoked by uid 500); 19 May 2008 08:17:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93592 invoked by uid 500); 19 May 2008 08:17:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93581 invoked by uid 99); 19 May 2008 08:17:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 01:17:17 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of dckorah@gmail.com designates 64.233.182.187 as permitted sender)
Received: from [64.233.182.187] (HELO nf-out-0910.google.com) (64.233.182.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 08:16:30 +0000
Received: by nf-out-0910.google.com with SMTP id f5so760028nfh.15
        for <java-user@lucene.apache.org>; Mon, 19 May 2008 01:16:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:from:to:subject:date:mime-version:content-type:x-mailer:x-mimeole:thread-index:message-id;
        bh=EsTIeQqw4jSRoO0G931DDIE62cHyXtyG2O1oIgUyWW8=;
        b=WpquXmkYABLCly0fekOsEdseBO4OehrkzA93SqeDtEGLKqFCgTkbLE4X4lTZYBGlIWyOAD9jNPuHRuXc8sN3tsON3HDJZSxPnxKYUJv8Agxkb7+cxTm/vbUge7p0KhlnoHlUTuWd5v9MS/Srva/w3uN1v/0XIoTbdv6qSOvmDeU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=from:to:subject:date:mime-version:content-type:x-mailer:x-mimeole:thread-index:message-id;
        b=PHANXylu9rW1Xm6m0Xq1Iy8sh1DGM+T/0ynlochZBr8kCT7AaGK5qOptEs9Xb1jzQMBrtJEYIOwvusfSNkM2pdoHRnEbUud9r9HuuoFgr0n1s4yo7EbSEZ1q0yoxBrqCO3/KCP5JSlWJ/M6VNLneYTt6foD4TCoFI1mQIEiwOC4=
Received: by 10.210.109.10 with SMTP id h10mr6433314ebc.170.1211185004705;
        Mon, 19 May 2008 01:16:44 -0700 (PDT)
Received: from SCWDEVDINOKVM ( [195.2.245.68])
        by mx.google.com with ESMTPS id g12sm10321750nfb.28.2008.05.19.01.16.41
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 19 May 2008 01:16:42 -0700 (PDT)
From: "Dino Korah" <dckorah@gmail.com>
To: <java-user@lucene.apache.org>
Subject: Transaction semantics in Document addition
Date: Mon, 19 May 2008 09:16:18 +0100
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0049_01C8B991.00E82730"
X-Mailer: Microsoft Office Outlook, Build 11.0.5510
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198
Thread-Index: Aci5iJ1MTIMTbabHSWeRAwy6OAce4w==
Message-ID: <4831376a.0c53300a.5cc6.2012@mx.google.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_0049_01C8B991.00E82730
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit

Hi All,
 
I am dealing with a situation where a document could possibly have multiple
attachments to it, and they are all added to the index under a document-id
(not lucene doc-id). Now if one of the attachments fail to get indexed due
to failure of any subsystem like the text extraction module, I need to abort
the complete set of documents under the document id. I add individual
attachments as a seperate documents in lucene.
 
Whats the best mechanism to accomplish this.
 
One possible solution I have in mind is to create a RAMDirectory for each
document with attachems to it and add everything to the RAMDirectory. Once
we are satisfied with the indexing, merge it into the main index.
 
Would that work?
 
Many thanks
Dino
 

------=_NextPart_000_0049_01C8B991.00E82730--


From java-user-return-34123-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 19 09:03:33 2008
Return-Path: <java-user-return-34123-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74025 invoked from network); 19 May 2008 09:03:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 May 2008 09:03:32 -0000
Received: (qmail 50874 invoked by uid 500); 19 May 2008 09:03:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50836 invoked by uid 500); 19 May 2008 09:03:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50825 invoked by uid 99); 19 May 2008 09:03:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 02:03:27 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.14.246.241] (HELO ag-out-0708.google.com) (72.14.246.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 09:02:40 +0000
Received: by ag-out-0708.google.com with SMTP id 23so792684agd.11
        for <java-user@lucene.apache.org>; Mon, 19 May 2008 02:02:54 -0700 (PDT)
Received: by 10.70.92.12 with SMTP id p12mr9028442wxb.47.1211187773978;
        Mon, 19 May 2008 02:02:53 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id h8sm11092997wxd.26.2008.05.19.02.02.53
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 19 May 2008 02:02:53 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <4831376a.0c53300a.5cc6.2012@mx.google.com>
References: <4831376a.0c53300a.5cc6.2012@mx.google.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <E81D4DA5-6FC5-4BD8-9C10-72658F1E7516@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: Transaction semantics in Document addition
Date: Mon, 19 May 2008 05:02:52 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Dino Korah wrote:
> Hi All,
>
> I am dealing with a situation where a document could possibly have  
> multiple
> attachments to it, and they are all added to the index under a  
> document-id
> (not lucene doc-id). Now if one of the attachments fail to get  
> indexed due
> to failure of any subsystem like the text extraction module, I need  
> to abort
> the complete set of documents under the document id. I add individual
> attachments as a seperate documents in lucene.
>
> Whats the best mechanism to accomplish this.
>
> One possible solution I have in mind is to create a RAMDirectory  
> for each
> document with attachems to it and add everything to the  
> RAMDirectory. Once
> we are satisfied with the indexing, merge it into the main index.
>
> Would that work?

That will work but performance may not be great.

You could also open the IndexWriter with autoCommit=false, and then  
if you hit a failure in the text extraction, call abort() to cancel  
all docs you had added to this IndexWriter?  But that's bad because  
you lose all the documents that had succeeded.

Or, on hitting a failure in one of a document's attachments, you  
could just call deleteDocument on those attachments already added, to  
"undo" them?  This is in fact how IndexWriter itself deals with an  
exception while adding a document (to avoid having only a part of the  
document in the index): if it his an exception after processing some  
number of tokens, it just marks that document as deleted.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34124-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 19 10:02:41 2008
Return-Path: <java-user-return-34124-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98135 invoked from network); 19 May 2008 10:02:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 May 2008 10:02:41 -0000
Received: (qmail 32599 invoked by uid 500); 19 May 2008 10:02:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32563 invoked by uid 500); 19 May 2008 10:02:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32552 invoked by uid 99); 19 May 2008 10:02:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 03:02:35 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.14.246.240] (HELO ag-out-0708.google.com) (72.14.246.240)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 10:01:46 +0000
Received: by ag-out-0708.google.com with SMTP id 23so848146agd.11
        for <java-user@lucene.apache.org>; Mon, 19 May 2008 03:02:00 -0700 (PDT)
Received: by 10.100.242.20 with SMTP id p20mr7268512anh.153.1211191320727;
        Mon, 19 May 2008 03:02:00 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 15sm12696496wrl.25.2008.05.19.03.01.59
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 19 May 2008 03:02:00 -0700 (PDT)
In-Reply-To: <940060D7-0633-45A7-8F49-130D7EA6D888@apache.org>
References: <CF94BA56C9A3504BB6678C85B56D528E853FD7@lassomsx01.redlasso.local> <940060D7-0633-45A7-8F49-130D7EA6D888@apache.org>
Mime-Version: 1.0 (Apple Message framework v753)
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <A4D1A943-13CD-485D-86E2-DDBF642FDDBF@mikemccandless.com>
Cc: Dan Rugg <Dan2@redlasso.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: Version 2.3 Does Not Index/Digest All Document Tokens
Date: Mon, 19 May 2008 06:01:58 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Or, if it's hard to reduce this to a compact test, can you post the  
code you are using and describe where/how it finds a difference?  I'd  
like to get to the bottom of this.

Mike

Grant Ingersoll wrote:
> Can you reduce this down to a unit test?
>
> Thanks,
> Grant
>
> On May 16, 2008, at 11:37 AM, Dan Rugg wrote:
>
>> After upgrading to version 2.3.x from 2.2.0, we started experiencing
>> issues with our index searches.  Some searches produced false  
>> positives,
>> while others produce no hits for terms known to be in specific  
>> documents
>> that where digested.  After setting up tests that created indexes
>> containing single documents we found that version 2.3.x did not  
>> add all
>> the tokens from a document the index while 2.2.0 did.  The only thing
>> that changed between the tests were the lucene jar being used, and a
>> fresh index was created for each test.
>>
>>
>>
>> It seems to be some random action that 2.3.x is taking, or not  
>> taking.
>> While tokens such as 'traffic' will not be digested in one  
>> document, it
>> will in another.  Token frequency, order, and relative position  
>> seem to
>> not matter, as indexed and non-indexed tokens where across the board.
>> The documents being ingested where XML, and the tokenizer for the
>> documents were the same for 2.2.0 and 2.3.x.  We even did a token  
>> dump
>> of the documents and verified the documents where being tokenized
>> correctly.
>>
>>
>>
>> I did notice rebuilding the index was quicker with 2.3.x and the  
>> index
>> was smaller, but I guess if you aren't adding tokens to the index  
>> it is
>> bound to smaller.  BTW, we tested versions 2.3.1, 2.3.2, and  
>> 2.2.0.  We
>> are now back to using 2.2.0.
>>
>>
>>
>> Daniel Rugg
>>
>
> --------------------------
> Grant Ingersoll
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34125-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 19 17:31:51 2008
Return-Path: <java-user-return-34125-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20336 invoked from network); 19 May 2008 17:31:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 May 2008 17:31:51 -0000
Received: (qmail 36447 invoked by uid 500); 19 May 2008 17:31:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36426 invoked by uid 500); 19 May 2008 17:31:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36415 invoked by uid 99); 19 May 2008 17:31:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 10:31:45 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [206.190.49.56] (HELO web53106.mail.re2.yahoo.com) (206.190.49.56)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 19 May 2008 17:30:51 +0000
Received: (qmail 41743 invoked by uid 60001); 19 May 2008 17:31:11 -0000
X-YMail-OSG: OiXKNyMVM1lkb2MfALmMhyX9spcLszBQNpgkqW5Oz42HbGk.vC8kyHT52FptzcHtvw--
Received: from [75.168.8.173] by web53106.mail.re2.yahoo.com via HTTP; Mon, 19 May 2008 10:31:11 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.185
Date: Mon, 19 May 2008 10:31:11 -0700 (PDT)
From: N Hira <nhira@cognocys.com>
Subject: Re: Transaction semantics in Document addition
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <203222.38389.qm@web53106.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

How about an attribute (fullyIndexed=true/false) to keep track of whether the indexing was successful?

We used a similar attribute for a similar problem, but stored it in the accompanying database instead.

-h




----- Original Message ----
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Sent: Monday, May 19, 2008 4:02:52 AM
Subject: Re: Transaction semantics in Document addition


Dino Korah wrote:
> Hi All,
>
> I am dealing with a situation where a document could possibly have  
> multiple
> attachments to it, and they are all added to the index under a  
> document-id
> (not lucene doc-id). Now if one of the attachments fail to get  
> indexed due
> to failure of any subsystem like the text extraction module, I need  
> to abort
> the complete set of documents under the document id. I add individual
> attachments as a seperate documents in lucene.
>
> Whats the best mechanism to accomplish this.
>
> One possible solution I have in mind is to create a RAMDirectory  
> for each
> document with attachems to it and add everything to the  
> RAMDirectory. Once
> we are satisfied with the indexing, merge it into the main index.
>
> Would that work?

That will work but performance may not be great.

You could also open the IndexWriter with autoCommit=false, and then  
if you hit a failure in the text extraction, call abort() to cancel  
all docs you had added to this IndexWriter?  But that's bad because  
you lose all the documents that had succeeded.

Or, on hitting a failure in one of a document's attachments, you  
could just call deleteDocument on those attachments already added, to  
"undo" them?  This is in fact how IndexWriter itself deals with an  
exception while adding a document (to avoid having only a part of the  
document in the index): if it his an exception after processing some  
number of tokens, it just marks that document as deleted.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34126-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 19 18:30:48 2008
Return-Path: <java-user-return-34126-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51196 invoked from network); 19 May 2008 18:30:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 May 2008 18:30:48 -0000
Received: (qmail 38579 invoked by uid 500); 19 May 2008 18:30:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38548 invoked by uid 500); 19 May 2008 18:30:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38537 invoked by uid 99); 19 May 2008 18:30:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 11:30:42 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of dckorah@gmail.com designates 64.233.184.238 as permitted sender)
Received: from [64.233.184.238] (HELO wr-out-0506.google.com) (64.233.184.238)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 18:29:55 +0000
Received: by wr-out-0506.google.com with SMTP id c30so818862wra.14
        for <java-user@lucene.apache.org>; Mon, 19 May 2008 11:30:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:from:to:subject:date:mime-version:content-type:content-transfer-encoding:x-mailer:thread-index:in-reply-to:x-mimeole:message-id;
        bh=5FU7OuobmCKqdER/76mntCgKJS3hM/PnVSgsz6jJF88=;
        b=BDuzcyUGk/hbkVWtDu3GFkiCGnpsUm3KbyQySIlP5MErXExEbjX61eRLBzKm3sPe3NgRrnby28dNIhO+mnYdHru6aVUWqkYJFTY9CxukO3g1Z5IrAjglLsD582HI+18xDuzqKzSJz57SMDmqrOwMI63FtihY2cIZEJDwsWVy+8I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=from:to:subject:date:mime-version:content-type:content-transfer-encoding:x-mailer:thread-index:in-reply-to:x-mimeole:message-id;
        b=hSGiwlhx4SeBahDPhN0UOYQ8c88jrEMOODJU/0CmiAO8De2YT3yL4SN77OkKrTaWTcUkswehHY0xpuhQx6Eco9uRIbqdbnlKlGfO4Lrtx6XbFjhQzcgDP+iRym7WuTU6IvvHEIVMZyBCN0jQu5hd765tDc6exQmN+4US6eUDIrA=
Received: by 10.125.99.13 with SMTP id b13mr6297126mkm.98.1211221805653;
        Mon, 19 May 2008 11:30:05 -0700 (PDT)
Received: from SCWDEVDINOKVM ( [77.96.94.123])
        by mx.google.com with ESMTPS id p9sm19015060fkb.9.2008.05.19.11.29.59
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 19 May 2008 11:30:03 -0700 (PDT)
From: "Dino Korah" <dckorah@gmail.com>
To: <java-user@lucene.apache.org>
Subject: RE: Transaction semantics in Document addition
Date: Mon, 19 May 2008 19:32:09 +0100
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook, Build 11.0.5510
Thread-Index: Aci51jaWBpiPyQRtT0GVSQ/cL0aafwACDswg
In-Reply-To: <203222.38389.qm@web53106.mail.re2.yahoo.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198
Message-ID: <4831c72b.095c5e0a.3075.09bc@mx.google.com>
X-Virus-Checked: Checked by ClamAV on apache.org

In your scenario, it might work, but I wonder how you generate hits,
excluding the fullyindexed=false.

-----Original Message-----
From: N Hira [mailto:nhira@cognocys.com] 
Sent: 19 May 2008 18:31
To: java-user@lucene.apache.org
Subject: Re: Transaction semantics in Document addition

How about an attribute (fullyIndexed=true/false) to keep track of whether
the indexing was successful?

We used a similar attribute for a similar problem, but stored it in the
accompanying database instead.

-h




----- Original Message ----
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Sent: Monday, May 19, 2008 4:02:52 AM
Subject: Re: Transaction semantics in Document addition


Dino Korah wrote:
> Hi All,
>
> I am dealing with a situation where a document could possibly have 
> multiple attachments to it, and they are all added to the index under 
> a document-id (not lucene doc-id). Now if one of the attachments fail 
> to get indexed due to failure of any subsystem like the text 
> extraction module, I need to abort the complete set of documents under 
> the document id. I add individual attachments as a seperate documents 
> in lucene.
>
> Whats the best mechanism to accomplish this.
>
> One possible solution I have in mind is to create a RAMDirectory for 
> each document with attachems to it and add everything to the 
> RAMDirectory. Once we are satisfied with the indexing, merge it into 
> the main index.
>
> Would that work?

That will work but performance may not be great.

You could also open the IndexWriter with autoCommit=false, and then if you
hit a failure in the text extraction, call abort() to cancel all docs you
had added to this IndexWriter?  But that's bad because you lose all the
documents that had succeeded.

Or, on hitting a failure in one of a document's attachments, you could just
call deleteDocument on those attachments already added, to "undo" them?
This is in fact how IndexWriter itself deals with an exception while adding
a document (to avoid having only a part of the document in the index): if it
his an exception after processing some number of tokens, it just marks that
document as deleted.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34127-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 19 18:36:11 2008
Return-Path: <java-user-return-34127-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52764 invoked from network); 19 May 2008 18:36:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 May 2008 18:36:11 -0000
Received: (qmail 51819 invoked by uid 500); 19 May 2008 18:36:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51784 invoked by uid 500); 19 May 2008 18:36:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51773 invoked by uid 99); 19 May 2008 18:36:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 11:36:05 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [206.190.49.51] (HELO web53101.mail.re2.yahoo.com) (206.190.49.51)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 19 May 2008 18:35:12 +0000
Received: (qmail 79260 invoked by uid 60001); 19 May 2008 18:35:31 -0000
X-YMail-OSG: XmIrVZwVM1mKnMJx5FiJYXVvs2o1nB8Ln5ugD06K7lEgsWe4m0OSMtsxn0cIqOMAcekOVS0QOs7OR_sjBcck4cnJeKfSPBMhbqQPkQ--
Received: from [75.168.8.173] by web53101.mail.re2.yahoo.com via HTTP; Mon, 19 May 2008 11:35:30 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.185
Date: Mon, 19 May 2008 11:35:30 -0700 (PDT)
From: N Hira <nhira@cognocys.com>
Subject: Re: Transaction semantics in Document addition
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <974482.79220.qm@web53101.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

You could probably add a query filter, but we use that attribute to find the documents that need to be re-indexed...

-h



----- Original Message ----
From: Dino Korah <dckorah@gmail.com>
To: java-user@lucene.apache.org
Sent: Monday, May 19, 2008 1:32:09 PM
Subject: RE: Transaction semantics in Document addition

In your scenario, it might work, but I wonder how you generate hits,
excluding the fullyindexed=false.

-----Original Message-----
From: N Hira [mailto:nhira@cognocys.com] 
Sent: 19 May 2008 18:31
To: java-user@lucene.apache.org
Subject: Re: Transaction semantics in Document addition

How about an attribute (fullyIndexed=true/false) to keep track of whether
the indexing was successful?

We used a similar attribute for a similar problem, but stored it in the
accompanying database instead.

-h


----- Original Message ----
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Sent: Monday, May 19, 2008 4:02:52 AM
Subject: Re: Transaction semantics in Document addition


Dino Korah wrote:
> Hi All,
>
> I am dealing with a situation where a document could possibly have 
> multiple attachments to it, and they are all added to the index under 
> a document-id (not lucene doc-id). Now if one of the attachments fail 
> to get indexed due to failure of any subsystem like the text 
> extraction module, I need to abort the complete set of documents under 
> the document id. I add individual attachments as a seperate documents 
> in lucene.
>
> Whats the best mechanism to accomplish this.
>
> One possible solution I have in mind is to create a RAMDirectory for 
> each document with attachems to it and add everything to the 
> RAMDirectory. Once we are satisfied with the indexing, merge it into 
> the main index.
>
> Would that work?

That will work but performance may not be great.

You could also open the IndexWriter with autoCommit=false, and then if you
hit a failure in the text extraction, call abort() to cancel all docs you
had added to this IndexWriter?  But that's bad because you lose all the
documents that had succeeded.

Or, on hitting a failure in one of a document's attachments, you could just
call deleteDocument on those attachments already added, to "undo" them?
This is in fact how IndexWriter itself deals with an exception while adding
a document (to avoid having only a part of the document in the index): if it
his an exception after processing some number of tokens, it just marks that
document as deleted.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34128-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 19 18:57:30 2008
Return-Path: <java-user-return-34128-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62488 invoked from network); 19 May 2008 18:57:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 May 2008 18:57:30 -0000
Received: (qmail 97537 invoked by uid 500); 19 May 2008 18:57:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97510 invoked by uid 500); 19 May 2008 18:57:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97499 invoked by uid 99); 19 May 2008 18:57:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 11:57:25 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of chy1013m1@hotmail.com designates 65.54.246.237 as permitted sender)
Received: from [65.54.246.237] (HELO bay0-omc3-s37.bay0.hotmail.com) (65.54.246.237)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 18:56:28 +0000
Received: from BAY143-W34 ([65.55.154.69]) by bay0-omc3-s37.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Mon, 19 May 2008 11:56:49 -0700
Message-ID: <BAY143-W3416C4C2F7D5148C6B32EFE2C50@phx.gbl>
Content-Type: multipart/alternative;
	boundary="_39eb9334-23c1-42fd-ad45-b0a0a677b0fb_"
X-Originating-IP: [67.55.8.11]
From: Alex <chy1013m1@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: slow FieldCacheImpl.createValue
Date: Mon, 19 May 2008 18:56:48 +0000
Importance: Normal
MIME-Version: 1.0
X-OriginalArrivalTime: 19 May 2008 18:56:49.0233 (UTC) FILETIME=[17C0FC10:01C8B9E2]
X-Virus-Checked: Checked by ClamAV on apache.org

--_39eb9334-23c1-42fd-ad45-b0a0a677b0fb_
Content-Type: text/plain; charset="big5"
Content-Transfer-Encoding: 8bit

hi,
I have a ValueSourceQuery that makes use of a stored field. The field contains roughly 27.27 million untokenized terms.
The average length of each term is 8 digits.
The first search always takes around 5 minutes, and it is due to the createValue function in the FieldCacheImpl.
The search is executed on a RAID5 disk array of 15k rpm. 


any hints as to make the fieldcache createvalue faster ? I have tried a bigger cache size for BufferedIndexReader (8kb or more) ,
but the time it took for createValue to execute is still in the realm of 4, 5 minutes. 


thanks

_________________________________________________________________
5 GB Wjeq BsKBw@UlMfr X Y Windows Live Hotmail
http://mail.live.com 
--_39eb9334-23c1-42fd-ad45-b0a0a677b0fb_--

From java-user-return-34129-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 20 05:33:20 2008
Return-Path: <java-user-return-34129-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25981 invoked from network); 20 May 2008 05:33:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 May 2008 05:33:20 -0000
Received: (qmail 31356 invoked by uid 500); 20 May 2008 05:33:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31326 invoked by uid 500); 20 May 2008 05:33:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31315 invoked by uid 99); 20 May 2008 05:33:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 22:33:13 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anshumg@gmail.com designates 72.14.220.157 as permitted sender)
Received: from [72.14.220.157] (HELO fg-out-1718.google.com) (72.14.220.157)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 05:32:24 +0000
Received: by fg-out-1718.google.com with SMTP id l27so2362876fgb.27
        for <java-user@lucene.apache.org>; Mon, 19 May 2008 22:32:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=V3D1HigVTercYBkhdVXVeJbo4qQlw4uFLOIo1ap13xs=;
        b=m+0cSX2xpjBIidC280YTts+rOemILIB8LSN9SLODCryqJLzQijT7FhZBG5WhrBEvhS/4aJEZR9y/c0sKn0lTklYBpl7ZPBCSUz4blP1oY5ZKiccjbZkXKf8dP/a9qZ5hRoToDUBKPDWO711XvF4OHmcSOH/f+fFnqxvVKR9xKVA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=hGK1E6uXbLJOBfYvzjP54Nx3vpYSruYjpXJ5coDnrZYT0RI2eYmEiZdGEkbq+HZkNsIdUagd3veS8FKUR06qkbg8HigKIbvJI1cevHgREreoF1BE7KVYfphclqi0hW7BOgsqBeW10uUGDOyZqnbKjfHJXNsUpHTKaIajprPiv3E=
Received: by 10.125.91.14 with SMTP id t14mr6800638mkl.23.1211261558562;
        Mon, 19 May 2008 22:32:38 -0700 (PDT)
Received: by 10.125.130.6 with HTTP; Mon, 19 May 2008 22:32:38 -0700 (PDT)
Message-ID: <867513fe0805192232x269c7664jbc582506d84671e@mail.gmail.com>
Date: Tue, 20 May 2008 11:02:38 +0530
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: slow FieldCacheImpl.createValue
In-Reply-To: <BAY143-W3416C4C2F7D5148C6B32EFE2C50@phx.gbl>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_13_28108319.1211261558531"
References: <BAY143-W3416C4C2F7D5148C6B32EFE2C50@phx.gbl>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_13_28108319.1211261558531
Content-Type: text/plain; charset=BIG5
Content-Transfer-Encoding: base64
Content-Disposition: inline

SGV5IEFsZXgsCkkgZ3Vlc3MgeW91IGhhdmVuJ3QgdHJpZWQgd2FybWluZyB1cCB0aGUgZW5naW5l
IGJlZm9yZSBwdXR0aW5nIGl0IHRvIHVzZS4KVGhvdWdoIG9uZSBvZiB0aGUgc2ltcGxlciBpbXBs
ZW1lbnRhdGlvbiwgeW91IGNvdWxkIHRyeSB3YXJtaW5nIHVwIHRoZQplbmdpbmUgZmlyc3QgYnkg
c2VuZGluZyBhIGZldyBzZWFyY2hlcyBhbmQgdGhlbiBwdXQgaXQgdG8gdXNlIChwdXQgaXQgaW50
bwp0aGUgc2VydmluZyBtYWNoaW5lIGxvb3ApLiBZb3UgY291bGQgYWxzbyBkbyBhIGxpdHRsZSBi
aXQgb2YgcHJlcHJvY2Vzc2luZwp3aGlsZSBpbml0aWFsaXppbmcgdGhlIGRhZW1vbiByYXRoZXIg
dGhhbiB3YWl0aW5nIGZvciB0aGUgc2VhcmNoIHRvIGhpdCBpdC4KSSBob3BlIEkgdW5kZXJzdG9v
ZCB0aGUgcHJvYmxlbSBjb3JyZWN0bHkgaGVyZSwgZWxzZSB3b3VsZCBoYXZlIHRvIGxvb2sgaW50
bwppdC4KCi0tCkFuc2h1bQoKMjAwOC81LzIwIEFsZXggPGNoeTEwMTNtMUBob3RtYWlsLmNvbT46
Cgo+IGhpLAo+IEkgaGF2ZSBhIFZhbHVlU291cmNlUXVlcnkgdGhhdCBtYWtlcyB1c2Ugb2YgYSBz
dG9yZWQgZmllbGQuIFRoZSBmaWVsZAo+IGNvbnRhaW5zIHJvdWdobHkgMjcuMjcgbWlsbGlvbiB1
bnRva2VuaXplZCB0ZXJtcy4KPiBUaGUgYXZlcmFnZSBsZW5ndGggb2YgZWFjaCB0ZXJtIGlzIDgg
ZGlnaXRzLgo+IFRoZSBmaXJzdCBzZWFyY2ggYWx3YXlzIHRha2VzIGFyb3VuZCA1IG1pbnV0ZXMs
IGFuZCBpdCBpcyBkdWUgdG8gdGhlCj4gY3JlYXRlVmFsdWUgZnVuY3Rpb24gaW4gdGhlIEZpZWxk
Q2FjaGVJbXBsLgo+IFRoZSBzZWFyY2ggaXMgZXhlY3V0ZWQgb24gYSBSQUlENSBkaXNrIGFycmF5
IG9mIDE1ayBycG0uCj4KPgo+IGFueSBoaW50cyBhcyB0byBtYWtlIHRoZSBmaWVsZGNhY2hlIGNy
ZWF0ZXZhbHVlIGZhc3RlciA/IEkgaGF2ZSB0cmllZCBhCj4gYmlnZ2VyIGNhY2hlIHNpemUgZm9y
IEJ1ZmZlcmVkSW5kZXhSZWFkZXIgKDhrYiBvciBtb3JlKSAsCj4gYnV0IHRoZSB0aW1lIGl0IHRv
b2sgZm9yIGNyZWF0ZVZhbHVlIHRvIGV4ZWN1dGUgaXMgc3RpbGwgaW4gdGhlIHJlYWxtIG9mIDQs
Cj4gNSBtaW51dGVzLgo+Cj4KPiB0aGFua3MKPgo+IF9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCj4gNSBHQiC2V6RqrmW2cSCh
QrPQt3OrS7G2oUKmd6X+qL7FQKlVp6O2bKXzqU2vZqxyIKFYIKXfp1mkya/FIFdpbmRvd3MgTGl2
ZSBIb3RtYWlsCj4gaHR0cDovL21haWwubGl2ZS5jb20KPgoKCgotLSAKLS0KVGhlIGZhY3RzIGV4
cHJlc3NlZCBoZXJlIGJlbG9uZyB0byBldmVyeWJvZHksIHRoZSBvcGluaW9ucyB0byBtZS4KVGhl
IGRpc3RpbmN0aW9uIGlzIHlvdXJzIHRvIGRyYXcuLi4uLi4uLi4uLi4K
------=_Part_13_28108319.1211261558531--

From java-user-return-34130-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 20 06:54:54 2008
Return-Path: <java-user-return-34130-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73550 invoked from network); 20 May 2008 06:54:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 May 2008 06:54:54 -0000
Received: (qmail 14267 invoked by uid 500); 20 May 2008 06:54:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13201 invoked by uid 500); 20 May 2008 06:54:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13186 invoked by uid 99); 20 May 2008 06:54:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 May 2008 23:54:48 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chy1013m1@hotmail.com designates 65.54.246.233 as permitted sender)
Received: from [65.54.246.233] (HELO bay0-omc3-s33.bay0.hotmail.com) (65.54.246.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 06:53:59 +0000
Received: from BAY143-W50 ([65.55.154.85]) by bay0-omc3-s33.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Mon, 19 May 2008 23:54:14 -0700
Message-ID: <BAY143-W500EAB27644690F0E43C8CE2C40@phx.gbl>
Content-Type: multipart/alternative;
	boundary="_52319958-e0bd-4d9d-9872-220181559a1e_"
X-Originating-IP: [67.55.8.11]
From: Alex <chy1013m1@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: RE: slow FieldCacheImpl.createValue
Date: Tue, 20 May 2008 06:54:14 +0000
Importance: Normal
In-Reply-To: <867513fe0805192232x269c7664jbc582506d84671e@mail.gmail.com>
References: <BAY143-W3416C4C2F7D5148C6B32EFE2C50@phx.gbl>
 <867513fe0805192232x269c7664jbc582506d84671e@mail.gmail.com>
MIME-Version: 1.0
X-OriginalArrivalTime: 20 May 2008 06:54:14.0966 (UTC) FILETIME=[51029560:01C8BA46]
X-Virus-Checked: Checked by ClamAV on apache.org

--_52319958-e0bd-4d9d-9872-220181559a1e_
Content-Type: text/plain; charset="big5"
Content-Transfer-Encoding: 8bit

Hi,
thanks for the reply. Yes, after the first slow search, subsequent searches have good performance.

I guess the issue is why exactally, is createValue taking so long, or should it take so long (4 ~ 5 minutes ).
Given roughly 27million terms, each of roughly 8 characters long and few other bytes for the TermInfo record,
a modern disk can easily read over the portion of the index (the .frq portion ) in a few seconds. Also,
when I use tools like dstat, I see bunch of 1kb reads initiated while running createValue. 




> Date: Tue, 20 May 2008 11:02:38 +0530
> From: anshumg@gmail.com
> To: java-user@lucene.apache.org
> Subject: Re: slow FieldCacheImpl.createValue
> 
> Hey Alex,
> I guess you haven't tried warming up the engine before putting it to use.
> Though one of the simpler implementation, you could try warming up the
> engine first by sending a few searches and then put it to use (put it into
> the serving machine loop). You could also do a little bit of preprocessing
> while initializing the daemon rather than waiting for the search to hit it.
> I hope I understood the problem correctly here, else would have to look into
> it.
> 
> --
> Anshum


_________________________________________________________________
BvBpuMRMAqXAv X Windows Live Spaces
http://spaces.live.com/
--_52319958-e0bd-4d9d-9872-220181559a1e_--

From java-user-return-34131-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 20 14:38:28 2008
Return-Path: <java-user-return-34131-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7315 invoked from network); 20 May 2008 14:38:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 May 2008 14:38:28 -0000
Received: (qmail 85579 invoked by uid 500); 20 May 2008 14:38:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85548 invoked by uid 500); 20 May 2008 14:38:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85537 invoked by uid 99); 20 May 2008 14:38:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 07:38:21 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.198.226 as permitted sender)
Received: from [209.85.198.226] (HELO rv-out-0506.google.com) (209.85.198.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 14:37:31 +0000
Received: by rv-out-0506.google.com with SMTP id f6so1777480rvb.5
        for <java-user@lucene.apache.org>; Tue, 20 May 2008 07:37:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=Cx7ALKm1qItcJQa/N3iRayqK2hWlPcHiiS5KxKaRkXI=;
        b=jNxdryRWkSe+9tgR81xkCaa23Rz/4/hPJ4Wpu+w9JX2V9nWMiKyevpuBNQLvUjMi6p0KmW7BS+JBdoRUD0rLTlBnhdU3xSsjYnYig/r8GSM2ksXJeqIf8GBx/rwjRbHjNclyIbTIXrLXqQjSXwGoloeFH/c7XA2Oq3r+7RJdtW4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=YiTlBhJl4+mkHtZ0135oyGMDqk0jlqqXPngMXSKDihFOaqdABanQqYUfSk6ISFCwayrxTl5GnATdjkkF1RCpnj8lregd5gfEtV7eDJA8wgK6yzplcn0CRBq0coc1RFkQ1KqdBaajgV5SPOhatge3lIAKVGuQCDRI35mQKcDG0Ys=
Received: by 10.140.208.14 with SMTP id f14mr4457082rvg.283.1211294267442;
        Tue, 20 May 2008 07:37:47 -0700 (PDT)
Received: by 10.140.188.20 with HTTP; Tue, 20 May 2008 07:37:47 -0700 (PDT)
Message-ID: <85d3c3b60805200737p6843412p8cd206b6d2b3b314@mail.gmail.com>
Date: Tue, 20 May 2008 10:37:47 -0400
From: "Jason Rutherglen" <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: slow FieldCacheImpl.createValue
In-Reply-To: <867513fe0805192232x269c7664jbc582506d84671e@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1328_23443693.1211294267438"
References: <BAY143-W3416C4C2F7D5148C6B32EFE2C50@phx.gbl>
	 <867513fe0805192232x269c7664jbc582506d84671e@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1328_23443693.1211294267438
Content-Type: text/plain; charset=BIG5
Content-Transfer-Encoding: base64
Content-Disposition: inline

aHR0cHM6Ly9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJhL2Jyb3dzZS9MVUNFTkUtMTI3OCBzb2x2ZXMg
dGhpcyBwcm9ibGVtCgpPbiBUdWUsIE1heSAyMCwgMjAwOCBhdCAxOjMyIEFNLCBBbnNodW0gPGFu
c2h1bWdAZ21haWwuY29tPiB3cm90ZToKCj4gSGV5IEFsZXgsCj4gSSBndWVzcyB5b3UgaGF2ZW4n
dCB0cmllZCB3YXJtaW5nIHVwIHRoZSBlbmdpbmUgYmVmb3JlIHB1dHRpbmcgaXQgdG8gdXNlLgo+
IFRob3VnaCBvbmUgb2YgdGhlIHNpbXBsZXIgaW1wbGVtZW50YXRpb24sIHlvdSBjb3VsZCB0cnkg
d2FybWluZyB1cCB0aGUKPiBlbmdpbmUgZmlyc3QgYnkgc2VuZGluZyBhIGZldyBzZWFyY2hlcyBh
bmQgdGhlbiBwdXQgaXQgdG8gdXNlIChwdXQgaXQgaW50bwo+IHRoZSBzZXJ2aW5nIG1hY2hpbmUg
bG9vcCkuIFlvdSBjb3VsZCBhbHNvIGRvIGEgbGl0dGxlIGJpdCBvZiBwcmVwcm9jZXNzaW5nCj4g
d2hpbGUgaW5pdGlhbGl6aW5nIHRoZSBkYWVtb24gcmF0aGVyIHRoYW4gd2FpdGluZyBmb3IgdGhl
IHNlYXJjaCB0byBoaXQgaXQuCj4gSSBob3BlIEkgdW5kZXJzdG9vZCB0aGUgcHJvYmxlbSBjb3Jy
ZWN0bHkgaGVyZSwgZWxzZSB3b3VsZCBoYXZlIHRvIGxvb2sKPiBpbnRvCj4gaXQuCj4KPiAtLQo+
IEFuc2h1bQo+Cj4gMjAwOC81LzIwIEFsZXggPGNoeTEwMTNtMUBob3RtYWlsLmNvbT46Cj4KPiA+
IGhpLAo+ID4gSSBoYXZlIGEgVmFsdWVTb3VyY2VRdWVyeSB0aGF0IG1ha2VzIHVzZSBvZiBhIHN0
b3JlZCBmaWVsZC4gVGhlIGZpZWxkCj4gPiBjb250YWlucyByb3VnaGx5IDI3LjI3IG1pbGxpb24g
dW50b2tlbml6ZWQgdGVybXMuCj4gPiBUaGUgYXZlcmFnZSBsZW5ndGggb2YgZWFjaCB0ZXJtIGlz
IDggZGlnaXRzLgo+ID4gVGhlIGZpcnN0IHNlYXJjaCBhbHdheXMgdGFrZXMgYXJvdW5kIDUgbWlu
dXRlcywgYW5kIGl0IGlzIGR1ZSB0byB0aGUKPiA+IGNyZWF0ZVZhbHVlIGZ1bmN0aW9uIGluIHRo
ZSBGaWVsZENhY2hlSW1wbC4KPiA+IFRoZSBzZWFyY2ggaXMgZXhlY3V0ZWQgb24gYSBSQUlENSBk
aXNrIGFycmF5IG9mIDE1ayBycG0uCj4gPgo+ID4KPiA+IGFueSBoaW50cyBhcyB0byBtYWtlIHRo
ZSBmaWVsZGNhY2hlIGNyZWF0ZXZhbHVlIGZhc3RlciA/IEkgaGF2ZSB0cmllZCBhCj4gPiBiaWdn
ZXIgY2FjaGUgc2l6ZSBmb3IgQnVmZmVyZWRJbmRleFJlYWRlciAoOGtiIG9yIG1vcmUpICwKPiA+
IGJ1dCB0aGUgdGltZSBpdCB0b29rIGZvciBjcmVhdGVWYWx1ZSB0byBleGVjdXRlIGlzIHN0aWxs
IGluIHRoZSByZWFsbSBvZgo+IDQsCj4gPiA1IG1pbnV0ZXMuCj4gPgo+ID4KPiA+IHRoYW5rcwo+
ID4KPiA+IF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCj4gPiA1IEdCILZXpGquZbZxIKFCs9C3c6tLsbahQqZ3pf6ovsVAqVWn
o7ZspfOpTa9mrHIgoVggpd+nWaTJr8UgV2luZG93cyBMaXZlIEhvdG1haWwKPiA+IGh0dHA6Ly9t
YWlsLmxpdmUuY29tCj4gPgo+Cj4KPgo+IC0tCj4gLS0KPiBUaGUgZmFjdHMgZXhwcmVzc2VkIGhl
cmUgYmVsb25nIHRvIGV2ZXJ5Ym9keSwgdGhlIG9waW5pb25zIHRvIG1lLgo+IFRoZSBkaXN0aW5j
dGlvbiBpcyB5b3VycyB0byBkcmF3Li4uLi4uLi4uLi4uCj4K
------=_Part_1328_23443693.1211294267438--

From java-user-return-34132-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 20 17:36:18 2008
Return-Path: <java-user-return-34132-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29679 invoked from network); 20 May 2008 17:36:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 May 2008 17:36:18 -0000
Received: (qmail 20406 invoked by uid 500); 20 May 2008 17:36:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20375 invoked by uid 500); 20 May 2008 17:36:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20364 invoked by uid 99); 20 May 2008 17:36:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 10:36:11 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of listacctc@gmail.com designates 64.233.166.181 as permitted sender)
Received: from [64.233.166.181] (HELO py-out-1112.google.com) (64.233.166.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 17:35:24 +0000
Received: by py-out-1112.google.com with SMTP id z74so2556216pyg.9
        for <java-user@lucene.apache.org>; Tue, 20 May 2008 10:35:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=vEJE4Ep1wPK/na8Bivuf+QeyNicUcuSnKZs9Zh2sEnk=;
        b=dQpG6sgXLtD/2nomnEHrKwlQXmEiid7u9I5Q8szd/3cEoxzBaU5CsMrg/33hCwrNkX0NoHd8yrudZyqHZOmt5tXUlmy9D6acLFgGhx/GSp/X3uxHU37POHjGWbozRAslfBY3h0X/vtRxkZqnYlnpIiRXlGEbwAclhC96aA4d5OQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=VfzTgrUTJpxEapNg6+zydAAVmtXP+Ede3e1wdSFgI7oDI+M5fFkg5/r56V9LdpRvMnQmm7A33GnqjnsM2HyrLiwrsc3n82XOBI1PEgKWRzFCP2ZZM0PIJQ9M+tFNEo2tOEZ8AZZHPWvZThc13cDWIXzFAGVLNvyhwvkTlE9jWdo=
Received: by 10.35.103.6 with SMTP id f6mr14600153pym.22.1211304939934;
        Tue, 20 May 2008 10:35:39 -0700 (PDT)
Received: from ?10.1.129.45? ( [167.156.63.253])
        by mx.google.com with ESMTPS id y67sm1129520pyg.33.2008.05.20.10.35.32
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 20 May 2008 10:35:33 -0700 (PDT)
Message-ID: <48330BE2.3070306@gmail.com>
Date: Tue, 20 May 2008 13:35:30 -0400
From: Tod <listacctc@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Treatment of Metadata
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I have a couple of quick questions about how Lucene indexes metadata:

- Does it do anything special with metadata or treat it as a supplement 
to the words in the document?

I have a feeling that the answer is that out of the box lucene does 
nothing special with metadata and that its treated just like any other 
regular words in the document.  It would be up to the developer to 
design in its special treatment.

- If a particular document contains metadata is there a way after the 
indexing process to query a specific document to determine what metadata 
was indexed for it?

Simple example, I have a word document that has a specific title and a 
number of other properties.  Once that document is indexed I'd like to 
be able to call a method that would identify all of the properties 
Lucene indexed from the document, completely separate from the 
document's actual content.


Thanks!

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34133-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 20 18:07:01 2008
Return-Path: <java-user-return-34133-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40728 invoked from network); 20 May 2008 18:07:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 May 2008 18:07:01 -0000
Received: (qmail 60615 invoked by uid 500); 20 May 2008 18:06:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59646 invoked by uid 500); 20 May 2008 18:06:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59635 invoked by uid 99); 20 May 2008 18:06:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 11:06:55 -0700
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [192.115.188.199] (HELO out4.bezeqint.net) (192.115.188.199)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 18:06:09 +0000
Received: from your0548c161e1 (unknown [80.250.149.60])
	by out4.bezeqint.net (Postfix) with ESMTPA id D2012B08342
	for <java-user@lucene.apache.org>; Tue, 20 May 2008 20:56:01 +0300 (IDT)
From: "Itamar Syn-Hershko" <itamar@divrei-tora.com>
To: <java-user@lucene.apache.org>
References: <CF94BA56C9A3504BB6678C85B56D528E853FD7@lassomsx01.redlasso.local>
Subject: RE: Version 2.3 Does Not Index/Digest All Document Tokens
Date: Tue, 20 May 2008 21:06:00 +0300
Message-ID: <015201c8baa4$2bb31a60$609b10ac@your0548c161e1>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <CF94BA56C9A3504BB6678C85B56D528E853FD7@lassomsx01.redlasso.local>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198
Thread-Index: Aci3arU46DzyZ4kKTJaBvTLA+veCdgDOOUKQ
X-Virus-Checked: Checked by ClamAV on apache.org


Just a thought - are the files you're indexing larger than 10,000 words
(MAX_FIELD_LENGTH)? If so, maybe either your code or Lucene 2.3.* have
changed something in maxFieldLength implementation...

Itamar.

-----Original Message-----
From: Dan Rugg [mailto:Dan2@redlasso.com] 
Sent: Friday, May 16, 2008 6:37 PM
To: java-user@lucene.apache.org
Subject: Version 2.3 Does Not Index/Digest All Document Tokens

After upgrading to version 2.3.x from 2.2.0, we started experiencing issues
with our index searches.  Some searches produced false positives, while
others produce no hits for terms known to be in specific documents that
where digested.  After setting up tests that created indexes containing
single documents we found that version 2.3.x did not add all the tokens from
a document the index while 2.2.0 did.  The only thing that changed between
the tests were the lucene jar being used, and a fresh index was created for
each test.

 

It seems to be some random action that 2.3.x is taking, or not taking.
While tokens such as 'traffic' will not be digested in one document, it will
in another.  Token frequency, order, and relative position seem to not
matter, as indexed and non-indexed tokens where across the board.
The documents being ingested where XML, and the tokenizer for the documents
were the same for 2.2.0 and 2.3.x.  We even did a token dump of the
documents and verified the documents where being tokenized correctly.

 

I did notice rebuilding the index was quicker with 2.3.x and the index was
smaller, but I guess if you aren't adding tokens to the index it is bound to
smaller.  BTW, we tested versions 2.3.1, 2.3.2, and 2.2.0.  We are now back
to using 2.2.0.

 

Daniel Rugg




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34134-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 20 18:12:23 2008
Return-Path: <java-user-return-34134-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42944 invoked from network); 20 May 2008 18:12:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 May 2008 18:12:23 -0000
Received: (qmail 65354 invoked by uid 500); 20 May 2008 18:12:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65319 invoked by uid 500); 20 May 2008 18:12:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65308 invoked by uid 99); 20 May 2008 18:12:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 11:12:18 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chris.lu@gmail.com designates 209.85.128.191 as permitted sender)
Received: from [209.85.128.191] (HELO fk-out-0910.google.com) (209.85.128.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 18:11:29 +0000
Received: by fk-out-0910.google.com with SMTP id 18so2413446fkq.5
        for <java-user@lucene.apache.org>; Tue, 20 May 2008 11:11:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=zWLz59YWGtGvit4+RInLHJG1RIhqvfE3LDogC9hkn4E=;
        b=W5STHloquMca3agS80tsjxP1tx/6vgFnhYpXRpUtOQ75TJ6xkuDdLihB4AXYJQG+/AJ4D6ERxZaMkDpEQaQ2B9ehwCDOlpe2mhIPKOXBPyxLcHgPJ91H1F1hTWNXPNZRX+UjeWnjic4jlnjTqupoZHyTRtpk9L9hE4hRqg6svJs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=PJnMm0myXmdJ6prOGdR6PxkNStenZaoivh9H6nmx89ZGgVKFlvqi7sNWrZDUakA/a0n3I1k0h+QhggtxhGcnk9jAv37gYLKIVSiMbFIk6OVMkdB3bItt4BBboa7tl/WyBvldDQbatG0cITV+/7J8XjqW5+t+iHPTyOtX6SREq5g=
Received: by 10.78.138.6 with SMTP id l6mr2525196hud.71.1211307103508;
        Tue, 20 May 2008 11:11:43 -0700 (PDT)
Received: by 10.78.165.13 with HTTP; Tue, 20 May 2008 11:11:43 -0700 (PDT)
Message-ID: <6e3ae6310805201111i48abb229r892d29415af3fa56@mail.gmail.com>
Date: Tue, 20 May 2008 11:11:43 -0700
From: "Chris Lu" <chris.lu@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: slow FieldCacheImpl.createValue
In-Reply-To: <85d3c3b60805200737p6843412p8cd206b6d2b3b314@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_17074_32312935.1211307103497"
References: <BAY143-W3416C4C2F7D5148C6B32EFE2C50@phx.gbl>
	 <867513fe0805192232x269c7664jbc582506d84671e@mail.gmail.com>
	 <85d3c3b60805200737p6843412p8cd206b6d2b3b314@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_17074_32312935.1211307103497
Content-Type: text/plain; charset=BIG5
Content-Transfer-Encoding: base64
Content-Disposition: inline

VGhpcyBzaG91bGQgaGF2ZSBhIGdyZWF0IGJvb3N0IHRvIHBlcmZvcm1hbmNlLiBBbnkgcGxhbiB0
byBtZXJnZSBpdCBpbnRvIHRoZQptYWluIGJyYW5jZSBpbnN0ZWFkIG9mIHBhdGNoPwoKLS0gCkNo
cmlzIEx1Ci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KSW5zdGFudCBTY2FsYWJsZSBGdWxsLVRl
eHQgU2VhcmNoIE9uIEFueSBEYXRhYmFzZS9BcHBsaWNhdGlvbgpzaXRlOiBodHRwOi8vd3d3LmRi
c2lnaHQubmV0CmRlbW86IGh0dHA6Ly9zZWFyY2guZGJzaWdodC5jb20KTHVjZW5lIERhdGFiYXNl
IFNlYXJjaCBpbiAzIG1pbnV0ZXM6Cmh0dHA6Ly93aWtpLmRic2lnaHQuY29tL2luZGV4LnBocD90
aXRsZT1DcmVhdGVfTHVjZW5lX0RhdGFiYXNlX1NlYXJjaF9pbl8zX21pbnV0ZXMKREJTaWdodCBj
dXN0b21lciwgYSBzaG9wcGluZyBjb21wYXJpc29uIHNpdGUsIChhbm9ueW1vdXMgcGVyIHJlcXVl
c3QpIGdvdAoyLjYgTWlsbGlvbiBFdXJvIGZ1bmRpbmchCgpPbiBUdWUsIE1heSAyMCwgMjAwOCBh
dCA3OjM3IEFNLCBKYXNvbiBSdXRoZXJnbGVuIDwKamFzb24ucnV0aGVyZ2xlbkBnbWFpbC5jb20+
IHdyb3RlOgoKPiBodHRwczovL2lzc3Vlcy5hcGFjaGUub3JnL2ppcmEvYnJvd3NlL0xVQ0VORS0x
Mjc4IHNvbHZlcyB0aGlzIHByb2JsZW0KPgo+IE9uIFR1ZSwgTWF5IDIwLCAyMDA4IGF0IDE6MzIg
QU0sIEFuc2h1bSA8YW5zaHVtZ0BnbWFpbC5jb20+IHdyb3RlOgo+Cj4gPiBIZXkgQWxleCwKPiA+
IEkgZ3Vlc3MgeW91IGhhdmVuJ3QgdHJpZWQgd2FybWluZyB1cCB0aGUgZW5naW5lIGJlZm9yZSBw
dXR0aW5nIGl0IHRvIHVzZS4KPiA+IFRob3VnaCBvbmUgb2YgdGhlIHNpbXBsZXIgaW1wbGVtZW50
YXRpb24sIHlvdSBjb3VsZCB0cnkgd2FybWluZyB1cCB0aGUKPiA+IGVuZ2luZSBmaXJzdCBieSBz
ZW5kaW5nIGEgZmV3IHNlYXJjaGVzIGFuZCB0aGVuIHB1dCBpdCB0byB1c2UgKHB1dCBpdAo+IGlu
dG8KPiA+IHRoZSBzZXJ2aW5nIG1hY2hpbmUgbG9vcCkuIFlvdSBjb3VsZCBhbHNvIGRvIGEgbGl0
dGxlIGJpdCBvZgo+IHByZXByb2Nlc3NpbmcKPiA+IHdoaWxlIGluaXRpYWxpemluZyB0aGUgZGFl
bW9uIHJhdGhlciB0aGFuIHdhaXRpbmcgZm9yIHRoZSBzZWFyY2ggdG8gaGl0Cj4gaXQuCj4gPiBJ
IGhvcGUgSSB1bmRlcnN0b29kIHRoZSBwcm9ibGVtIGNvcnJlY3RseSBoZXJlLCBlbHNlIHdvdWxk
IGhhdmUgdG8gbG9vawo+ID4gaW50bwo+ID4gaXQuCj4gPgo+ID4gLS0KPiA+IEFuc2h1bQo+ID4K
PiA+IDIwMDgvNS8yMCBBbGV4IDxjaHkxMDEzbTFAaG90bWFpbC5jb20+Ogo+ID4KPiA+ID4gaGks
Cj4gPiA+IEkgaGF2ZSBhIFZhbHVlU291cmNlUXVlcnkgdGhhdCBtYWtlcyB1c2Ugb2YgYSBzdG9y
ZWQgZmllbGQuIFRoZSBmaWVsZAo+ID4gPiBjb250YWlucyByb3VnaGx5IDI3LjI3IG1pbGxpb24g
dW50b2tlbml6ZWQgdGVybXMuCj4gPiA+IFRoZSBhdmVyYWdlIGxlbmd0aCBvZiBlYWNoIHRlcm0g
aXMgOCBkaWdpdHMuCj4gPiA+IFRoZSBmaXJzdCBzZWFyY2ggYWx3YXlzIHRha2VzIGFyb3VuZCA1
IG1pbnV0ZXMsIGFuZCBpdCBpcyBkdWUgdG8gdGhlCj4gPiA+IGNyZWF0ZVZhbHVlIGZ1bmN0aW9u
IGluIHRoZSBGaWVsZENhY2hlSW1wbC4KPiA+ID4gVGhlIHNlYXJjaCBpcyBleGVjdXRlZCBvbiBh
IFJBSUQ1IGRpc2sgYXJyYXkgb2YgMTVrIHJwbS4KPiA+ID4KPiA+ID4KPiA+ID4gYW55IGhpbnRz
IGFzIHRvIG1ha2UgdGhlIGZpZWxkY2FjaGUgY3JlYXRldmFsdWUgZmFzdGVyID8gSSBoYXZlIHRy
aWVkIGEKPiA+ID4gYmlnZ2VyIGNhY2hlIHNpemUgZm9yIEJ1ZmZlcmVkSW5kZXhSZWFkZXIgKDhr
YiBvciBtb3JlKSAsCj4gPiA+IGJ1dCB0aGUgdGltZSBpdCB0b29rIGZvciBjcmVhdGVWYWx1ZSB0
byBleGVjdXRlIGlzIHN0aWxsIGluIHRoZSByZWFsbQo+IG9mCj4gPiA0LAo+ID4gPiA1IG1pbnV0
ZXMuCj4gPiA+Cj4gPiA+Cj4gPiA+IHRoYW5rcwo+ID4gPgo+ID4gPiBfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwo+ID4gPiA1
IEdCILZXpGquZbZxIKFCs9C3c6tLsbahQqZ3pf6ovsVAqVWno7ZspfOpTa9mrHIgoVggpd+nWaTJ
r8UgV2luZG93cyBMaXZlIEhvdG1haWwKPiA+ID4gaHR0cDovL21haWwubGl2ZS5jb20KPiA+ID4K
PiA+Cj4gPgo+ID4KPiA+IC0tCj4gPiAtLQo+ID4gVGhlIGZhY3RzIGV4cHJlc3NlZCBoZXJlIGJl
bG9uZyB0byBldmVyeWJvZHksIHRoZSBvcGluaW9ucyB0byBtZS4KPiA+IFRoZSBkaXN0aW5jdGlv
biBpcyB5b3VycyB0byBkcmF3Li4uLi4uLi4uLi4uCj4gPgo+Cg==
------=_Part_17074_32312935.1211307103497--

From java-user-return-34135-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 20 19:20:10 2008
Return-Path: <java-user-return-34135-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86580 invoked from network); 20 May 2008 19:20:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 May 2008 19:20:10 -0000
Received: (qmail 82617 invoked by uid 500); 20 May 2008 19:20:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82584 invoked by uid 500); 20 May 2008 19:20:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82573 invoked by uid 99); 20 May 2008 19:20:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 12:20:03 -0700
X-ASF-Spam-Status: No, hits=3.7 required=10.0
	tests=DNS_FROM_OPENWHOIS,FORGED_HOTMAIL_RCVD2,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 19:19:10 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JyXMx-0003B2-QP
	for java-user@lucene.apache.org; Tue, 20 May 2008 12:19:31 -0700
Message-ID: <17348537.post@talk.nabble.com>
Date: Tue, 20 May 2008 12:19:31 -0700 (PDT)
From: jjiao <jianjiao1982@hotmail.com>
To: java-user@lucene.apache.org
Subject: Document Frequency Error
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: jianjiao1982@hotmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello, guys,

I know this forum is for java user. But I think the .Net version is
converted from Java and I was really blocked by the error. I am using the
NLucene. I am trying to get the document frequency for each term.
The code is as follows.

IndexReader reader = IndexReader.Open("temp_index");
for (ITermEnum termEnum = reader.Terms(); termEnum.Next(); )
{
    Term indexedTerm = termEnum.Term();
    Console.Write(indexedTerm.Text + " " + reader.DocFreq(indexedTerm));
}
reader.close();

Error Message
---
Unhandled Exception: System.ArgumentOutOfRangeException: Index was out of
range. Must be non-negative and less than the
size of the collection.
Parameter name: index
   at System.Collections.ArrayList.get_Item(Int32 index)
   at DotnetPark.NLucene.Index.FieldInfos.FieldInfo(Int32 fieldNumber) in
E:\temp\nlucene-1.2b2\src\Index\FieldInfos.cs:
line 143
   at DotnetPark.NLucene.Index.FieldInfos.FieldName(Int32 fieldNumber) in
E:\temp\nlucene-1.2b2\src\Index\FieldInfos.cs:
line 138
   at DotnetPark.NLucene.Index.SegmentTermEnum.ReadTerm() in
E:\temp\nlucene-1.2b2\src\Index\SegmentTermEnum.cs:line 183

   at DotnetPark.NLucene.Index.SegmentTermEnum.Next() in
E:\temp\nlucene-1.2b2\src\Index\SegmentTermEnum.cs:line 161
   at DotnetPark.NLucene.Index.TermInfosReader.ScanEnum(Term term) in
E:\temp\nlucene-1.2b2\src\Index\TermInfosReader.cs
:line 184
   at DotnetPark.NLucene.Index.TermInfosReader.Get(Term term) in
E:\temp\nlucene-1.2b2\src\Index\TermInfosReader.cs:line
 172
   at DotnetPark.NLucene.Index.SegmentReader.DocFreq(Term t) in
E:\temp\nlucene-1.2b2\src\Index\SegmentReader.cs:line 25
6
   at DotnetPark.NLucene.Index.SegmentsReader.DocFreq(Term t) in
E:\temp\nlucene-1.2b2\src\Index\SegmentsReader.cs:line
175
   at Test.Program.Main(String[] args) in F:\My
work\CShape\FraudDetection\Test\Program.cs:line 116
---

The code ran successfully for several terms, then I got an error saying that
"System.ArgumentOutOfRangeException: Index was out of range."
I debugged the code and found that "FieldInfos.FieldName(Int32 fieldNumber)"
the fieldNumber for the term causing the error is 112 which is much greater
than the normal values 0, 1, or 2.

I don't know what is the problem. Can someone help me to solve that?
Thanks a million.

Jian
-- 
View this message in context: http://www.nabble.com/Document-Frequency-Error-tp17348537p17348537.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34136-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 20 21:58:51 2008
Return-Path: <java-user-return-34136-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89736 invoked from network); 20 May 2008 21:58:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 May 2008 21:58:51 -0000
Received: (qmail 49952 invoked by uid 500); 20 May 2008 21:58:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49920 invoked by uid 500); 20 May 2008 21:58:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49909 invoked by uid 99); 20 May 2008 21:58:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 14:58:45 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 21:57:49 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id B320571C402; Tue, 20 May 2008 14:58:08 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 9218E71C3FE
	for <java-user@lucene.apache.org>; Tue, 20 May 2008 14:58:08 -0700 (PDT)
Date: Tue, 20 May 2008 14:58:08 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: distributed lucene progress
In-Reply-To: <8837fb770805142136s5d72cec4p5b75c4b5b824bcc2@mail.gmail.com>
Message-ID: <Pine.LNX.4.62.0805201457350.9729@radix.cryptio.net>
References: <8837fb770805142136s5d72cec4p5b75c4b5b824bcc2@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org

:    What is the current status on the distributed lucene project proposed at:
: 
: http://www.mail-archive.com/general@lucene.apache.org/msg00338.html

I don't think it ever got passed the initial idea stage ... or, if it did: 
I haven't heard about it.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34137-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 20 23:24:23 2008
Return-Path: <java-user-return-34137-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19938 invoked from network); 20 May 2008 23:24:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 May 2008 23:24:23 -0000
Received: (qmail 41615 invoked by uid 500); 20 May 2008 23:24:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41584 invoked by uid 500); 20 May 2008 23:24:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41573 invoked by uid 99); 20 May 2008 23:24:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 16:24:17 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.207] (HELO spunkymail-a19.g.dreamhost.com) (208.97.132.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 23:23:23 +0000
Received: from [10.0.1.2] (unknown [131.171.30.37])
	by spunkymail-a19.g.dreamhost.com (Postfix) with ESMTP id AB13D11FE8
	for <java-user@lucene.apache.org>; Tue, 20 May 2008 16:23:29 -0700 (PDT)
Message-Id: <918B6A14-FD6E-41E8-86FE-FEA645982D9A@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <48330BE2.3070306@gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Treatment of Metadata
Date: Tue, 20 May 2008 19:23:28 -0400
References: <48330BE2.3070306@gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Tod,

Lucene doesn't know anything you don't tell it about your documents/ 
metadata.  You would need to create fields for the metadata for a  
document and then index them.  You could just do something like a  
document with fields:
text
author
createDate
...

These all can be "separate" when it comes to searching by creating the  
appropriate query against the fields.

So, I think the answer to your questions is yes, there is a way to  
query documents for metadata, but it isn't any different from querying  
anything else.  After all, Lucene has no clue what a word document is  
to begin with anyway.


-Grant

On May 20, 2008, at 1:35 PM, Tod wrote:

> I have a couple of quick questions about how Lucene indexes metadata:
>
> - Does it do anything special with metadata or treat it as a  
> supplement to the words in the document?
>
> I have a feeling that the answer is that out of the box lucene does  
> nothing special with metadata and that its treated just like any  
> other regular words in the document.  It would be up to the  
> developer to design in its special treatment.
>
> - If a particular document contains metadata is there a way after  
> the indexing process to query a specific document to determine what  
> metadata was indexed for it?
>
> Simple example, I have a word document that has a specific title and  
> a number of other properties.  Once that document is indexed I'd  
> like to be able to call a method that would identify all of the  
> properties Lucene indexed from the document, completely separate  
> from the document's actual content.
>
>
> Thanks!
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34138-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 21 01:34:15 2008
Return-Path: <java-user-return-34138-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69111 invoked from network); 21 May 2008 01:34:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 21 May 2008 01:34:15 -0000
Received: (qmail 45712 invoked by uid 500); 21 May 2008 01:34:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45676 invoked by uid 500); 21 May 2008 01:34:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45665 invoked by uid 99); 21 May 2008 01:34:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 18:34:10 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 May 2008 01:33:16 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JydCz-0007os-J7
	for java-user@lucene.apache.org; Tue, 20 May 2008 18:33:37 -0700
Message-ID: <17354272.post@talk.nabble.com>
Date: Tue, 20 May 2008 18:33:37 -0700 (PDT)
From: syedfa <fayyazuddin@gmail.com>
To: java-user@lucene.apache.org
Subject: How to return entire resultset which includes the highlighted
 keywords
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fayyazuddin@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Dear Fellow Java/Lucene developers:

I am trying to use the Highlighter class to return the keywords that the
user is searching for in bold.  However, instead of returning a fragment of
the block of text where the keyword is found, I would like to return the
ENTIRE block of text.  Here is the block of code that I am using:

QueryScorer scorer = new QueryScorer(parser);
Highlighter highlighter = new Highlighter(scorer);
for(int i=0; i<hits.length(); i++){
         Document doc=hits.doc(i);
         String lns = doc.get("LINES");
         String spkr = doc.get("SPEAKER");
         TokenStream lines = analyser.tokenStream("LINES", new
StringReader(lns));
         String highlightedLines = highlighter.getBestFragment(lines, lns);
         SearchResult resultBean = new SearchResult();
         resultBean.setNarrator(hits.doc(i).get("SPEAKER"));
         resultBean.setQuote(highlightedLines);
         System.out.println(resultBean.getNarrator());
         System.out.println(resultBean.getQuote());
         System.out.println("");
        }

I am searching through some quotes that have been taken from Shakespeare's
"Hamlet" that is in xml format.  If I search for the keyword "arrows", I
would like to return:

HAMLET
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them? To die: to sleep;
No more; and by a sleep to say we end
The heart-ache and the thousand natural shocks
That flesh is heir to, 'tis a consummation
Devoutly to be wish'd. To die, to sleep;
To sleep: perchance to dream: ay, there's the rub;
For in that sleep of death what dreams may come
When we have shuffled off this mortal coil,
Must give us pause: there's the respect
That makes calamity of so long life;
For who would bear the whips and scorns of time,
The oppressor's wrong, the proud man's contumely,
The pangs of despised love, the law's delay,
The insolence of office and the spurns
That patient merit of the unworthy takes,
When he himself might his quietus make
With a bare bodkin? who would fardels bear,
To grunt and sweat under a weary life,
But that the dread of something after death,
The undiscover'd country from whose bourn
No traveller returns, puzzles the will
And makes us rather bear those ills we have
Than fly to others that we know not of?
Thus conscience does make cowards of us all;
And thus the native hue of resolution
Is sicklied o'er with the pale cast of thought,
And enterprises of great pith and moment
With this regard their currents turn awry,
And lose the name of action.--Soft you now!
The fair Ophelia! Nymph, in thy orisons
Be all my sins remember'd.

and not:

HAMLET
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them? To die: to sleep;
No more; and by a sleep to say

Is this possible, and if so, how?  

My sincerest thanks to each and everyone who replies.

Sincerely;
Fayyaz
-- 
View this message in context: http://www.nabble.com/How-to-return-entire-resultset-which-includes-the-highlighted-keywords-tp17354272p17354272.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34139-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 21 04:05:27 2008
Return-Path: <java-user-return-34139-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2380 invoked from network); 21 May 2008 04:05:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 21 May 2008 04:05:27 -0000
Received: (qmail 17538 invoked by uid 500); 21 May 2008 04:05:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17498 invoked by uid 500); 21 May 2008 04:05:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17487 invoked by uid 99); 21 May 2008 04:05:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 21:05:20 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.57] (HELO web50303.mail.re2.yahoo.com) (206.190.38.57)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 21 May 2008 04:04:24 +0000
Received: (qmail 69938 invoked by uid 60001); 21 May 2008 04:04:45 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=ADvvydZI3jtW2OY3mlJ4kgE4nlorXGnLQJBkoOb7PHS4TCkD8JYrqUswwS/e1mMqFAjh8Mp+nz4C87KYRxFYYUqk3nXT6qfW1JSxMR8Qravj2/IakmGS4nXVNlkoVUIwta9LlIHHBan9BvPBqasfXvTNEkGRvYQUYUlWyyn8n+Y=;
X-YMail-OSG: sE.sjl8VM1k30lgMRKZyFqqUxYy.iO360kPuGl.PQKXfD0Jl0fqp7sbXkR.gHLBuerOv7JMVqBdjOPELKFI_YZixLjKR6IGAmu_g49w4ovTBr.Ld54K05Yh6UA--
Received: from [72.231.9.236] by web50303.mail.re2.yahoo.com via HTTP; Tue, 20 May 2008 21:04:45 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.185
Date: Tue, 20 May 2008 21:04:45 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: distributed lucene progress
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <402908.69886.qm@web50303.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Oh, it very much did.  Check Hadoop Wiki's "Recent Changes", it's there.


Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: Chris Hostetter <hossman_lucene@fucit.org>
> To: java-user@lucene.apache.org
> Sent: Tuesday, May 20, 2008 5:58:08 PM
> Subject: Re: distributed lucene progress
> 
> :    What is the current status on the distributed lucene project proposed at:
> : 
> : http://www.mail-archive.com/general@lucene.apache.org/msg00338.html
> 
> I don't think it ever got passed the initial idea stage ... or, if it did: 
> I haven't heard about it.
> 
> 
> -Hoss
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34140-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 21 04:09:54 2008
Return-Path: <java-user-return-34140-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2925 invoked from network); 21 May 2008 04:09:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 21 May 2008 04:09:54 -0000
Received: (qmail 20991 invoked by uid 500); 21 May 2008 04:09:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20954 invoked by uid 500); 21 May 2008 04:09:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20943 invoked by uid 99); 21 May 2008 04:09:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 May 2008 21:09:49 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.58] (HELO web50304.mail.re2.yahoo.com) (206.190.38.58)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 21 May 2008 04:09:01 +0000
Received: (qmail 76812 invoked by uid 60001); 21 May 2008 04:09:15 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=uWCv7rgbU3O1hX2MKn+e5hv2NaZ90C/rUbGDrO4BXMNU0rYy6jf+pfNE9fjGFjWvYumq1+I2+v3SM7ZbxkGWbjXwjlztQXD7yacze88HLivGEg3nR680wd3kHVcQKD6tvih7Y2k2kzIBOMqxDl2uf/irYn5+ccvX8H4a/fQvfuY=;
X-YMail-OSG: EokOapEVM1n3QuPLNTmRx8Y9jYSFeDQwGEratp1lU_Gq9kNXFPhfS.4DrQ_019o2jWu6uSNcvsMoTLNOmQFIGtGD.RLvP5X.igb.0Fl8KcKbi0mCve50_sD6RQ--
Received: from [72.231.9.236] by web50304.mail.re2.yahoo.com via HTTP; Tue, 20 May 2008 21:09:15 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.185
Date: Tue, 20 May 2008 21:09:15 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Document Frequency Error
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <487472.76308.qm@web50304.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,
I have a feeling we won't be able to help.  Not sure if you are aware of it, but Lucene.net has its own mailing list.  But you seem to be using NLucene, which is supported by a commercial company, in Russia I believe, and this is different from the .Net port of Lucene called Lucene.Net.

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: jjiao <jianjiao1982@hotmail.com>
> To: java-user@lucene.apache.org
> Sent: Tuesday, May 20, 2008 3:19:31 PM
> Subject: Document Frequency Error
> 
> 
> Hello, guys,
> 
> I know this forum is for java user. But I think the .Net version is
> converted from Java and I was really blocked by the error. I am using the
> NLucene. I am trying to get the document frequency for each term.
> The code is as follows.
> 
> IndexReader reader = IndexReader.Open("temp_index");
> for (ITermEnum termEnum = reader.Terms(); termEnum.Next(); )
> {
>     Term indexedTerm = termEnum.Term();
>     Console.Write(indexedTerm.Text + " " + reader.DocFreq(indexedTerm));
> }
> reader.close();
> 
> Error Message
> ---
> Unhandled Exception: System.ArgumentOutOfRangeException: Index was out of
> range. Must be non-negative and less than the
> size of the collection.
> Parameter name: index
>    at System.Collections.ArrayList.get_Item(Int32 index)
>    at DotnetPark.NLucene.Index.FieldInfos.FieldInfo(Int32 fieldNumber) in
> E:\temp\nlucene-1.2b2\src\Index\FieldInfos.cs:
> line 143
>    at DotnetPark.NLucene.Index.FieldInfos.FieldName(Int32 fieldNumber) in
> E:\temp\nlucene-1.2b2\src\Index\FieldInfos.cs:
> line 138
>    at DotnetPark.NLucene.Index.SegmentTermEnum.ReadTerm() in
> E:\temp\nlucene-1.2b2\src\Index\SegmentTermEnum.cs:line 183
> 
>    at DotnetPark.NLucene.Index.SegmentTermEnum.Next() in
> E:\temp\nlucene-1.2b2\src\Index\SegmentTermEnum.cs:line 161
>    at DotnetPark.NLucene.Index.TermInfosReader.ScanEnum(Term term) in
> E:\temp\nlucene-1.2b2\src\Index\TermInfosReader.cs
> :line 184
>    at DotnetPark.NLucene.Index.TermInfosReader.Get(Term term) in
> E:\temp\nlucene-1.2b2\src\Index\TermInfosReader.cs:line
> 172
>    at DotnetPark.NLucene.Index.SegmentReader.DocFreq(Term t) in
> E:\temp\nlucene-1.2b2\src\Index\SegmentReader.cs:line 25
> 6
>    at DotnetPark.NLucene.Index.SegmentsReader.DocFreq(Term t) in
> E:\temp\nlucene-1.2b2\src\Index\SegmentsReader.cs:line
> 175
>    at Test.Program.Main(String[] args) in F:\My
> work\CShape\FraudDetection\Test\Program.cs:line 116
> ---
> 
> The code ran successfully for several terms, then I got an error saying that
> "System.ArgumentOutOfRangeException: Index was out of range."
> I debugged the code and found that "FieldInfos.FieldName(Int32 fieldNumber)"
> the fieldNumber for the term causing the error is 112 which is much greater
> than the normal values 0, 1, or 2.
> 
> I don't know what is the problem. Can someone help me to solve that?
> Thanks a million.
> 
> Jian
> -- 
> View this message in context: 
> http://www.nabble.com/Document-Frequency-Error-tp17348537p17348537.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34141-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 21 10:59:07 2008
Return-Path: <java-user-return-34141-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15657 invoked from network); 21 May 2008 10:59:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 21 May 2008 10:59:07 -0000
Received: (qmail 57965 invoked by uid 500); 21 May 2008 10:59:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57932 invoked by uid 500); 21 May 2008 10:59:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57920 invoked by uid 99); 21 May 2008 10:59:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 May 2008 03:59:01 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of listacctc@gmail.com designates 64.233.166.177 as permitted sender)
Received: from [64.233.166.177] (HELO py-out-1112.google.com) (64.233.166.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 May 2008 10:58:14 +0000
Received: by py-out-1112.google.com with SMTP id z74so2932899pyg.9
        for <java-user@lucene.apache.org>; Wed, 21 May 2008 03:58:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=gjNDx2HxvddB9XxpeEBYDaHYE6ghM2XBR/JhMM4ZZfo=;
        b=HlGk3CnWDMa94/osc4fIk1RCSFQDMDmRTIAwOOiWWKf3Fwak75bI+oAmPUADJiL5rLd7ZLdR1khFsr01eot9feYLRaRsL4xCiT9kSiTzlA8hizJ9Srf42n5Rs3DOk0g+orFIgj6TTVovlurs08voGdilAGfqNWwa+dz+wIyRcSA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=eT/Vun3f8Q/3S5ekHzksG/wku08TNXt6G68fTQk2+nuYTrghPV6TCBXt7D73hmkjO88vgi9cP1psk6MHtmDugKv3i25zNGMJrwrdhhvOlUsD/weGtus5LfhIsGZRqFF8YH9jQrnDPrq6yWF1GKhbngprF0QUl+ah/iNTkspq/fw=
Received: by 10.35.33.15 with SMTP id l15mr16200961pyj.35.1211367509301;
        Wed, 21 May 2008 03:58:29 -0700 (PDT)
Received: from ?10.1.129.45? ( [167.156.63.253])
        by mx.google.com with ESMTPS id w67sm5410577pyg.20.2008.05.21.03.58.28
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 21 May 2008 03:58:28 -0700 (PDT)
Message-ID: <4834004E.1020003@gmail.com>
Date: Wed, 21 May 2008 06:58:22 -0400
From: Tod <listacctc@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Treatment of Metadata
References: <48330BE2.3070306@gmail.com> <918B6A14-FD6E-41E8-86FE-FEA645982D9A@apache.org>
In-Reply-To: <918B6A14-FD6E-41E8-86FE-FEA645982D9A@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Grant Ingersoll wrote:
> Hi Tod,
> 
> Lucene doesn't know anything you don't tell it about your 
> documents/metadata.  You would need to create fields for the metadata 
> for a document and then index them.  You could just do something like a 
> document with fields:
> text
> author
> createDate
> ...
> 
> These all can be "separate" when it comes to searching by creating the 
> appropriate query against the fields.
> 
> So, I think the answer to your questions is yes, there is a way to query 
> documents for metadata, but it isn't any different from querying 
> anything else.  After all, Lucene has no clue what a word document is to 
> begin with anyway.
> 
> 
> -Grant
> 

Thanks Grant, that's pretty much what I suspected.


- Tod

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34142-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 21 13:39:56 2008
Return-Path: <java-user-return-34142-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81035 invoked from network); 21 May 2008 13:39:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 21 May 2008 13:39:56 -0000
Received: (qmail 81088 invoked by uid 500); 21 May 2008 13:39:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80854 invoked by uid 500); 21 May 2008 13:39:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80843 invoked by uid 99); 21 May 2008 13:39:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 May 2008 06:39:49 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.132.241 as permitted sender)
Received: from [209.85.132.241] (HELO an-out-0708.google.com) (209.85.132.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 May 2008 13:39:02 +0000
Received: by an-out-0708.google.com with SMTP id c37so725430anc.49
        for <java-user@lucene.apache.org>; Wed, 21 May 2008 06:39:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=XLJLE1NVcgbjHXUDfwbLGG7O7vGTcGYCrLYR/CbyXGc=;
        b=izAUPGEmWjWZUgdXAyhDSlMkfi8lxtTm2UPLyRk+HFZUxoLk+mWkZGR/mN8d6K0TGyDnBAVv5kNQ9vipCFdrKJfLc4+HrWsWzJzcRs5aZgAZvHhtG6nBSEdcuyw9/s0L/2eq6uh0d8353PwoDb+hRIhW96PQS7m48XY1caHtwwk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=iL8gYMeVLRB4Jwvr0ErkGuGrSJ+tLtQiGnyrSP0usL7DcZQqUqqEDIYy4GuXrytIbfzc5R1VySBIZuD+PGWI18PmrA2X8LM0K4TWACqw5UeANsDqqkuJvpPNxR9VnuFIW/nnNez7nQVHPnONWuO/U2ij+jor8eIVXAfUQUGWhKU=
Received: by 10.100.123.4 with SMTP id v4mr371703anc.7.1211377157421;
        Wed, 21 May 2008 06:39:17 -0700 (PDT)
Received: from ?192.168.1.2? ( [63.131.32.77])
        by mx.google.com with ESMTPS id d35sm3851915and.13.2008.05.21.06.39.14
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 21 May 2008 06:39:16 -0700 (PDT)
Message-ID: <483425FF.805@gmail.com>
Date: Wed, 21 May 2008 09:39:11 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: How to return entire resultset which includes the highlighted
 keywords
References: <17354272.post@talk.nabble.com>
In-Reply-To: <17354272.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Check out NullFragmenter.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34143-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 21 15:46:44 2008
Return-Path: <java-user-return-34143-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33245 invoked from network); 21 May 2008 15:46:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 21 May 2008 15:46:44 -0000
Received: (qmail 88909 invoked by uid 500); 21 May 2008 15:46:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88880 invoked by uid 500); 21 May 2008 15:46:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88869 invoked by uid 99); 21 May 2008 15:46:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 May 2008 08:46:37 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 May 2008 15:45:48 +0000
Received: by fg-out-1718.google.com with SMTP id l27so2874082fgb.27
        for <java-user@lucene.apache.org>; Wed, 21 May 2008 08:46:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=8OB53CJCxmxAoTGYSk0gQM74vRbezW90GVSGaOoM+RY=;
        b=ET1nNj56whhZ+WwiQJVi2oqtG863WViQdQ0OnwWfzan6qL/IiTu42NgaB29Uy6OjsPkjYYMgrnQ+2h29kEurQZ2ICdqhC8MrP42UR1l3CbuxZTPbXvGrPiCoZyCdj0u+ahtaLNy8LKn9s4G3+k0Cd6OFDBhu6xwwrXQyrAvZIaY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Blwvz0c5csI166TS38ts7JCZ2bx/9gywmEfS5kBC+LODjEaO27A1YhpLuOQSlyDTHfIzCGCDSZ2uhO8iDvp0zdS7B0PVyahs4wnQ0S8JJoLneGqGxhJjIzdYAPqTews0MoODwKkkQBsq5QUXfN+nj/hEyXR2+n5A3uHVwLBR/b4=
Received: by 10.82.182.1 with SMTP id e1mr1339899buf.7.1211384762485;
        Wed, 21 May 2008 08:46:02 -0700 (PDT)
Received: by 10.82.141.17 with HTTP; Wed, 21 May 2008 08:46:02 -0700 (PDT)
Message-ID: <8837fb770805210846l4a439e66v304800c36c8da0db@mail.gmail.com>
Date: Wed, 21 May 2008 08:46:02 -0700
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: distributed lucene progress
In-Reply-To: <402908.69886.qm@web50303.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_2558_23983531.1211384762484"
References: <402908.69886.qm@web50303.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_2558_23983531.1211384762484
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

I see. So is it then the bailey project?
-John

On Tue, May 20, 2008 at 9:04 PM, Otis Gospodnetic <
otis_gospodnetic@yahoo.com> wrote:

> Oh, it very much did.  Check Hadoop Wiki's "Recent Changes", it's there.
>
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
> > From: Chris Hostetter <hossman_lucene@fucit.org>
> > To: java-user@lucene.apache.org
> > Sent: Tuesday, May 20, 2008 5:58:08 PM
> > Subject: Re: distributed lucene progress
> >
> > :    What is the current status on the distributed lucene project
> proposed at:
> > :
> > : http://www.mail-archive.com/general@lucene.apache.org/msg00338.html
> >
> > I don't think it ever got passed the initial idea stage ... or, if it
> did:
> > I haven't heard about it.
> >
> >
> > -Hoss
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_2558_23983531.1211384762484--

From java-user-return-34144-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 21 20:19:45 2008
Return-Path: <java-user-return-34144-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65957 invoked from network); 21 May 2008 20:19:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 21 May 2008 20:19:45 -0000
Received: (qmail 2804 invoked by uid 500); 21 May 2008 20:19:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2781 invoked by uid 500); 21 May 2008 20:19:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2770 invoked by uid 99); 21 May 2008 20:19:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 May 2008 13:19:38 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.39.214] (HELO web50312.mail.re2.yahoo.com) (206.190.39.214)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 21 May 2008 20:18:49 +0000
Received: (qmail 35839 invoked by uid 60001); 21 May 2008 20:19:04 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=L9kNXU04Hx/t0yJw+3Rbln4gHANGzNZj7IzyvV7Xo0Bpmiq05APDcKW2JufYffh7SmeHyVUuedPZa4T5cC4CvPYnoIyW+uyCThR6DrBeS7x7HRoKntboA7wBpfKJe1p3B6pNHhDsODdR67Lz2fs+qY8uEuEDev7hoRG33JqQKHE=;
Received: from [72.231.9.236] by web50312.mail.re2.yahoo.com via HTTP; Wed, 21 May 2008 13:19:04 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.199
Date: Wed, 21 May 2008 13:19:04 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: distributed lucene progress
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <479722.35659.qm@web50312.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

No, that's a separate project on SF, IIRC.


Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: John Wang <john.wang@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Wednesday, May 21, 2008 11:46:02 AM
> Subject: Re: distributed lucene progress
> 
> I see. So is it then the bailey project?
> -John
> 
> On Tue, May 20, 2008 at 9:04 PM, Otis Gospodnetic <
> otis_gospodnetic@yahoo.com> wrote:
> 
> > Oh, it very much did.  Check Hadoop Wiki's "Recent Changes", it's there.
> >
> >
> > Otis
> > --
> > Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
> >
> >
> > ----- Original Message ----
> > > From: Chris Hostetter 
> > > To: java-user@lucene.apache.org
> > > Sent: Tuesday, May 20, 2008 5:58:08 PM
> > > Subject: Re: distributed lucene progress
> > >
> > > :    What is the current status on the distributed lucene project
> > proposed at:
> > > :
> > > : http://www.mail-archive.com/general@lucene.apache.org/msg00338.html
> > >
> > > I don't think it ever got passed the initial idea stage ... or, if it
> > did:
> > > I haven't heard about it.
> > >
> > >
> > > -Hoss
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34145-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 08:03:47 2008
Return-Path: <java-user-return-34145-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82511 invoked from network); 22 May 2008 08:03:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 08:03:47 -0000
Received: (qmail 20280 invoked by uid 500); 22 May 2008 08:03:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20253 invoked by uid 500); 22 May 2008 08:03:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20241 invoked by uid 99); 22 May 2008 08:03:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 01:03:41 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of eransevi@gmail.com designates 209.85.200.175 as permitted sender)
Received: from [209.85.200.175] (HELO wf-out-1314.google.com) (209.85.200.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 08:02:55 +0000
Received: by wf-out-1314.google.com with SMTP id 28so2523951wfc.20
        for <java-user@lucene.apache.org>; Thu, 22 May 2008 01:03:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=PkSY+A5CKovVCLpKPJMHTOwC05P0jQVHgshRD3q3QIg=;
        b=o2bAUqc65KBMFIND/QgSeitCGza9oJFRURnRwNtkd+IKFYcL/DpoaAJyNXr64zTz6a/aTYzHhzcdInXBnWq3T+wRa5LuUrTOEsuV53JeL1pJXfqJPHbMuFjbpfNywCGLWzphEQSVyvhKGcsq/2HKh17Pvd/K9hdOL1uTs2iPBU8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=ifcKgwYY2Ug6RvNGv0/IBzVcciZc8lhVVV6c3+YJ+BjJSoCcmHUOFPrb37/kqlstp9m2IHK9higB689cwHJKb+v+4dcrctan0DQzj2EmGfHDlNnrcvFKXbB7ZLQi4UW3FGWPS1TKbNsQG9tXrOTlH37PNkF4AYZyR5/xusDrA3M=
Received: by 10.142.154.20 with SMTP id b20mr4302950wfe.150.1211443390948;
        Thu, 22 May 2008 01:03:10 -0700 (PDT)
Received: by 10.142.245.20 with HTTP; Thu, 22 May 2008 01:03:10 -0700 (PDT)
Message-ID: <74f928500805220103q2bff6e2ob1f833149dd33ef5@mail.gmail.com>
Date: Thu, 22 May 2008 11:03:10 +0300
From: "Eran Sevi" <eransevi@gmail.com>
To: java-user@lucene.apache.org
Subject: Best way to get payloads
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_10826_12368481.1211443390939"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_10826_12368481.1211443390939
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,

I'm running a SpanQuery and get the Spans result which tell me the documents
and positions of what I searched for.
I would now like to get the payloads in those documents and positions
without having to iterate on TermPositions since I don't have a term but I
do have the document and position.

Maybe Spans should be extended to also hold the payloads as well as the
start and end positions of the span.

Another option might be to extend TermPositionVector and return an array of
payloads.

 Can anyone think on a way to do it ?

Thanks,
Eran.

------=_Part_10826_12368481.1211443390939--

From java-user-return-34146-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 09:45:07 2008
Return-Path: <java-user-return-34146-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22313 invoked from network); 22 May 2008 09:45:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 09:45:07 -0000
Received: (qmail 70523 invoked by uid 500); 22 May 2008 09:45:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70154 invoked by uid 500); 22 May 2008 09:45:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70143 invoked by uid 99); 22 May 2008 09:45:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 02:45:01 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of luz290@gmail.com designates 64.233.178.243 as permitted sender)
Received: from [64.233.178.243] (HELO hs-out-0708.google.com) (64.233.178.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 09:44:15 +0000
Received: by hs-out-0708.google.com with SMTP id 4so2750898hsl.5
        for <java-user@lucene.apache.org>; Thu, 22 May 2008 02:44:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=1nqhCpxgcCKSvADokfG6USI0WqA65U6dRUf6T+qqDe0=;
        b=diBTKTW1t19a12aEc2uGvRpbapt0ZtkwFbR5UX/dlM1bIVOojIago/W+WIW//M4dYK0FEDFMeIs3JPnKOp08+wU6MOZ4HWCGoriKlHEqZkFuMdbdYC6L25vVhRfQR36qnQflTdZl+PCgoUGa7VGyEnB7peaSTk0PbZRnKKOodZo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=uELV+05tlLLR2dizoNaL0yQAQFO4Jj0YKTOkqmMlS+i6kQViEQkfRjFselmhiL3qJhGjO5PxqBVGVHzUy2DWiTDxU++tNlahp36W/RW5CGpBXKJ4LSmstnirjonSBqIh7+RQDX26YuGSGohZyyRQxKbjcR175i6oHcvKs9TzXFM=
Received: by 10.90.98.13 with SMTP id v13mr1790711agb.54.1211449470239;
        Thu, 22 May 2008 02:44:30 -0700 (PDT)
Received: by 10.100.132.15 with HTTP; Thu, 22 May 2008 02:44:29 -0700 (PDT)
Message-ID: <cec089090805220244o4f4a8c80p6edc104202a6537d@mail.gmail.com>
Date: Thu, 22 May 2008 05:44:29 -0400
From: "lucene user" <luz290@gmail.com>
To: java-user@lucene.apache.org
Subject: Handeling when a field does not exist in the document
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_9164_32139120.1211449470153"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_9164_32139120.1211449470153
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

We have a requirement to inform users on a regular basis of new material on
which they have expressed interest. How are we to know what is "new" from
the point of view of a particular user? Our idea is to tag each new item in
some way (perhaps a date/time stamp in the lucene index indicating when the
new document was indexed) and remember when the last time we sent out an
alert to that user.
How should we tag the documents? With a date/time of indexing stamp? An
incrementing batch import ID number? Does it matter much?

*I am reminded that ranges of dates and numbers, (as well as wild cards) are
evaluated as if they were a large OR query covering all the values that
exist in the index. Lucene only finds exact matches - it does not do
comparisons. This means that ranges with lots of different values in them
are bad - and can actually crash with a 'too many clauses' exception if
there are enough distinct values to push the number of clauses over 1024. Do
I understand this correctly?*

*How do we handle existing documents which do not have such a new field
associated with them? Can we provide a default value for the existing
documents? *

I did not find the place in the Lucene Documentation where it explains what
you get when you try to retrieve or search on a field that does not exist in
the document. I remember it not being a problem, but I couldn't find it. How
do I do this? What should I read?

Thanks!

------=_Part_9164_32139120.1211449470153--

From java-user-return-34147-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 13:01:42 2008
Return-Path: <java-user-return-34147-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96858 invoked from network); 22 May 2008 13:01:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 13:01:42 -0000
Received: (qmail 62154 invoked by uid 500); 22 May 2008 13:01:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62115 invoked by uid 500); 22 May 2008 13:01:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62104 invoked by uid 99); 22 May 2008 13:01:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 06:01:35 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a10.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 13:00:39 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a10.g.dreamhost.com (Postfix) with ESMTP id A2C02163985
	for <java-user@lucene.apache.org>; Thu, 22 May 2008 06:01:00 -0700 (PDT)
Message-Id: <58738D9F-6782-426A-A5A0-E28260AD2327@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <74f928500805220103q2bff6e2ob1f833149dd33ef5@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Best way to get payloads
Date: Thu, 22 May 2008 09:00:59 -0400
References: <74f928500805220103q2bff6e2ob1f833149dd33ef5@mail.gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

Unfortunately, I haven't had time to work on https://issues.apache.org/jira/browse/LUCENE-1001

There is a _HALF BAKED_ patch up there, but I got stuck on it at the  
time due to not being sure how to handle NearSpans and haven't had a  
chance to go back to it.  I do believe it is possible to expose it via  
the Spans, so if you are so inclined, it is definitely something that  
needs to be implemented.

-Grant

On May 22, 2008, at 4:03 AM, Eran Sevi wrote:

> Hi,
>
> I'm running a SpanQuery and get the Spans result which tell me the  
> documents
> and positions of what I searched for.
> I would now like to get the payloads in those documents and positions
> without having to iterate on TermPositions since I don't have a term  
> but I
> do have the document and position.
>
> Maybe Spans should be extended to also hold the payloads as well as  
> the
> start and end positions of the span.
>
> Another option might be to extend TermPositionVector and return an  
> array of
> payloads.
>
> Can anyone think on a way to do it ?
>
> Thanks,
> Eran.




--------------------------
Grant Ingersoll
http://www.lucidimagination.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34148-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 13:45:29 2008
Return-Path: <java-user-return-34148-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20930 invoked from network); 22 May 2008 13:45:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 13:45:29 -0000
Received: (qmail 46615 invoked by uid 500); 22 May 2008 13:45:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46594 invoked by uid 500); 22 May 2008 13:45:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46583 invoked by uid 99); 22 May 2008 13:45:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 06:45:22 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 216.239.58.185 as permitted sender)
Received: from [216.239.58.185] (HELO gv-out-0910.google.com) (216.239.58.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 13:44:36 +0000
Received: by gv-out-0910.google.com with SMTP id u5so34507gve.23
        for <java-user@lucene.apache.org>; Thu, 22 May 2008 06:44:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=QH99IcJIG30lum5jc/cr+sl/G0FoBw/qG5hpnvk5k38=;
        b=EN8GPPAGh/jukhg7EgOKPToJNtVSckEQiIB1JIRUfobZBOcQ99GLvEHJ1EjkftYARu1Pme0+9ivmzcJjm8pc4jTLVpsyoq+0xDvYabikHyLvLZNEirlZ9NW2FPaGAR88luMgFvZ/Vt5BQzmWOEzvwmXEQhy2c8bJLh8gz9RL0es=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=JzjcQ8MF5+rpOqsbIxYtcvAOxUpuxi87hlS3pIUC0IUqmTvpMpem6nuyuu0YeTPFtW5iaCKFw05hzYZV/qc0SuBZE5dorqo8JIx/sukTuMjStr7qB0b1a5UX49Aj0Fn+5xwA133MLlEG1DSt4Fnx/KrewVVebOwtVgMips7SJ00=
Received: by 10.125.74.20 with SMTP id b20mr47148mkl.64.1211463890656;
        Thu, 22 May 2008 06:44:50 -0700 (PDT)
Received: by 10.86.59.14 with HTTP; Thu, 22 May 2008 06:44:50 -0700 (PDT)
Message-ID: <359a92830805220644g36e56e15t99ad857aade9a3f4@mail.gmail.com>
Date: Thu, 22 May 2008 09:44:50 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Handeling when a field does not exist in the document
In-Reply-To: <cec089090805220244o4f4a8c80p6edc104202a6537d@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_7566_9616259.1211463890648"
References: <cec089090805220244o4f4a8c80p6edc104202a6537d@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_7566_9616259.1211463890648
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

See below...

On Thu, May 22, 2008 at 5:44 AM, lucene user <luz290@gmail.com> wrote:

> We have a requirement to inform users on a regular basis of new material on
> which they have expressed interest. How are we to know what is "new" from
> the point of view of a particular user? Our idea is to tag each new item in
> some way (perhaps a date/time stamp in the lucene index indicating when the
> new document was indexed) and remember when the last time we sent out an
> alert to that user.
> How should we tag the documents? With a date/time of indexing stamp? An
> incrementing batch import ID number? Does it matter much?
>
> *I am reminded that ranges of dates and numbers, (as well as wild cards)
> are
> evaluated as if they were a large OR query covering all the values that
> exist in the index. Lucene only finds exact matches - it does not do
> comparisons. This means that ranges with lots of different values in them
> are bad - and can actually crash with a 'too many clauses' exception if
> there are enough distinct values to push the number of clauses over 1024.
> Do
> I understand this correctly?*


Yes, but.. I think ConstantScoreRangeQuery is your friend here. From the
doc...

"It does not have an upper bound on the number of clauses covered in the
range.  "

The whole expansion thing was designed to work well with scoring as I
understand.
In cases like this I don't think you care about how the tag contributes to
the score,
it's just yes/no. You could create your own Filter instead, but why bother?


>
> *How do we handle existing documents which do not have such a new field
> associated with them? Can we provide a default value for the existing
> documents? *


Not that I know of. You can certainly test if each document you are
returning has
the field. Document.get(<field>) returns null if the doc doesn't have the
field so that
should fix you up. But there's no way I know of to assign a default for a
non-existent
field.


>
>
> I did not find the place in the Lucene Documentation where it explains what
> you get when you try to retrieve or search on a field that does not exist
> in
> the document. I remember it not being a problem, but I couldn't find it.
> How
> do I do this? What should I read?
>

Searching on a field that doesn't exist just means that field isn't part of
the
scoring. So if you have a search that includes the field as an AND clause,
you'll get no matches. Imagine that each document *did* have such a
field with a value that never matched any value you search on and you'll
get the idea. So, +field1:stuff +nonexistentfield:morestuff will never turn
any document that doesn't have any value in nonexistentfield


Best
Erick

>
> Thanks!
>

------=_Part_7566_9616259.1211463890648--

From java-user-return-34149-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 17:16:52 2008
Return-Path: <java-user-return-34149-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95024 invoked from network); 22 May 2008 17:16:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 17:16:52 -0000
Received: (qmail 72785 invoked by uid 500); 22 May 2008 17:16:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72753 invoked by uid 500); 22 May 2008 17:16:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72733 invoked by uid 99); 22 May 2008 17:16:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 10:16:46 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rakesh_shete@hotmail.com designates 65.54.246.240 as permitted sender)
Received: from [65.54.246.240] (HELO bay0-omc3-s40.bay0.hotmail.com) (65.54.246.240)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 17:15:57 +0000
Received: from BAY112-W5 ([64.4.26.105]) by bay0-omc3-s40.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 22 May 2008 10:16:13 -0700
Message-ID: <BAY112-W5ABE111A74A8CDC3DA3E1F9C60@phx.gbl>
Content-Type: multipart/alternative;
	boundary="_a76ddf4f-7740-4a90-852f-7463131d8c04_"
X-Originating-IP: [125.99.82.185]
From: Rakesh Shete <rakesh_shete@hotmail.com>
To: <java-user-info@lucene.apache.org>, <java-user@lucene.apache.org>
Subject: Improving search performance
Date: Thu, 22 May 2008 22:46:13 +0530
Importance: Normal
MIME-Version: 1.0
X-OriginalArrivalTime: 22 May 2008 17:16:13.0626 (UTC) FILETIME=[897DB1A0:01C8BC2F]
X-Virus-Checked: Checked by ClamAV on apache.org

--_a76ddf4f-7740-4a90-852f-7463131d8c04_
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable


Hi all,

I have index of size 85MB. My query looks as follows:

+(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:[20080410 T=
O 20081010] +rT:[002 TO 005]

All the fields used in the query are stored in the indexes (Indexed & Store=
d)

The query response time for me is around 30 seconds when running mutliple s=
imultanoeous threads (~100). The no. of matches is ~30k but I retrieve only=
 the top 100 results. I am using Hibernate Search which is a wrapper around=
 Lucene. I retrieve the "id" filed from the index which is also indexex and=
 stored.

What is the approach that I should take for improving the performance?

Will just indexing the values without storing them work (Index & UnStored)?

My machine configuration is:
P4 2.66GHz 1.99 GB RAM

The code for searching runs in JBoss application server which has a maximum=
 heap size of 1024MB. When these 100 threads are running in the application=
 server the CPU utilization is 100% and JBoss consumes all of the heap size=
.=20

Any pointers on index optimization would be really appreciated.

--Regards,
Rakesh Shete

_________________________________________________________________
No Harvard, No Oxford. We are here. Find out !!
http://ss1.richmedia.in/recurl.asp?pid=3D500=

--_a76ddf4f-7740-4a90-852f-7463131d8c04_--

From java-user-return-34150-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 17:23:08 2008
Return-Path: <java-user-return-34150-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99724 invoked from network); 22 May 2008 17:23:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 17:23:07 -0000
Received: (qmail 82177 invoked by uid 500); 22 May 2008 17:23:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82145 invoked by uid 500); 22 May 2008 17:23:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82134 invoked by uid 99); 22 May 2008 17:23:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 10:23:01 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.57] (HELO web50303.mail.re2.yahoo.com) (206.190.38.57)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 22 May 2008 17:22:13 +0000
Received: (qmail 42656 invoked by uid 60001); 22 May 2008 17:22:27 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=Lf0E5Dk5z1PpkRlG4IK74X8hC3MdKlEHiyGIvp+IVYs8uqYsIcNJKYXAbAN8NvWgzloO5is5QoHrizCeyyaA8rQs9f6UKUVshq4/GmZzV6etNFXhiujoxAuE65tr8ZhIgbmF7uw3OQm6Zwx8v6U4iAB3ZJwwCndExPCqsm5t7x4=;
Received: from [208.125.28.220] by web50303.mail.re2.yahoo.com via HTTP; Thu, 22 May 2008 10:22:27 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.199
Date: Thu, 22 May 2008 10:22:27 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Improving search performance
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <620720.42018.qm@web50303.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Some quick feedback.  Those are all very expensive queries (wildcards and ranges).  The first thing I'd do is try without Hibernate Search (to make sure HS is not the bottleneck).  100 threads is a lot, I'm guessing you are reusing your searcher, which is good, but you will actually improve performance a bit if you work with a small pool of searchers instead of a single searcher.

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: Rakesh Shete <rakesh_shete@hotmail.com>
> To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
> Sent: Thursday, May 22, 2008 1:16:13 PM
> Subject: Improving search performance
> 
> 
> Hi all,
> 
> I have index of size 85MB. My query looks as follows:
> 
> +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:[20080410 TO 
> 20081010] +rT:[002 TO 005]
> 
> All the fields used in the query are stored in the indexes (Indexed & Stored)
> 
> The query response time for me is around 30 seconds when running mutliple 
> simultanoeous threads (~100). The no. of matches is ~30k but I retrieve only the 
> top 100 results. I am using Hibernate Search which is a wrapper around Lucene. I 
> retrieve the "id" filed from the index which is also indexex and stored.
> 
> What is the approach that I should take for improving the performance?
> 
> Will just indexing the values without storing them work (Index & UnStored)?
> 
> My machine configuration is:
> P4 2.66GHz 1.99 GB RAM
> 
> The code for searching runs in JBoss application server which has a maximum heap 
> size of 1024MB. When these 100 threads are running in the application server the 
> CPU utilization is 100% and JBoss consumes all of the heap size. 
> 
> Any pointers on index optimization would be really appreciated.
> 
> --Regards,
> Rakesh Shete
> 
> _________________________________________________________________
> No Harvard, No Oxford. We are here. Find out !!
> http://ss1.richmedia.in/recurl.asp?pid=500


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34151-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 17:26:34 2008
Return-Path: <java-user-return-34151-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1086 invoked from network); 22 May 2008 17:26:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 17:26:34 -0000
Received: (qmail 88342 invoked by uid 500); 22 May 2008 17:26:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88316 invoked by uid 500); 22 May 2008 17:26:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88305 invoked by uid 99); 22 May 2008 17:26:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 10:26:29 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.39.202] (HELO web50311.mail.re2.yahoo.com) (206.190.39.202)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 22 May 2008 17:25:34 +0000
Received: (qmail 21233 invoked by uid 60001); 22 May 2008 17:25:55 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=0hDlV+4tTUXVFMW+/4b5IdHa15Vy36o99iYReY66D1aiCV8Id9dF6RazGmMQknFSU3y8kZsi8JRnG1SVEDwBDDQ2tCzXPNRAqcjLy3IKbDfJHzAGYMTpMYZfHeTldQmaAZoQLfmPSv09DUJLZWSC/dkTxa/9Ymu1zepOktDINy4=;
Received: from [208.125.28.220] by web50311.mail.re2.yahoo.com via HTTP; Thu, 22 May 2008 10:25:54 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.199
Date: Thu, 22 May 2008 10:25:54 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Handeling when a field does not exist in the document
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <26623.21165.qm@web50311.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

"lucene user",

Look at MemoryIndex (in Lucene contrib) for the "alert about new documents that match an interest" part of the problem.


Otis 
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: lucene user <luz290@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Thursday, May 22, 2008 5:44:29 AM
> Subject: Handeling when a field does not exist in the document
> 
> We have a requirement to inform users on a regular basis of new material on
> which they have expressed interest. How are we to know what is "new" from
> the point of view of a particular user? Our idea is to tag each new item in
> some way (perhaps a date/time stamp in the lucene index indicating when the
> new document was indexed) and remember when the last time we sent out an
> alert to that user.
> How should we tag the documents? With a date/time of indexing stamp? An
> incrementing batch import ID number? Does it matter much?
> 
> *I am reminded that ranges of dates and numbers, (as well as wild cards) are
> evaluated as if they were a large OR query covering all the values that
> exist in the index. Lucene only finds exact matches - it does not do
> comparisons. This means that ranges with lots of different values in them
> are bad - and can actually crash with a 'too many clauses' exception if
> there are enough distinct values to push the number of clauses over 1024. Do
> I understand this correctly?*
> 
> *How do we handle existing documents which do not have such a new field
> associated with them? Can we provide a default value for the existing
> documents? *
> 
> I did not find the place in the Lucene Documentation where it explains what
> you get when you try to retrieve or search on a field that does not exist in
> the document. I remember it not being a problem, but I couldn't find it. How
> do I do this? What should I read?
> 
> Thanks!


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34152-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 17:58:07 2008
Return-Path: <java-user-return-34152-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35625 invoked from network); 22 May 2008 17:58:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 17:58:06 -0000
Received: (qmail 47647 invoked by uid 500); 22 May 2008 17:58:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47621 invoked by uid 500); 22 May 2008 17:58:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47610 invoked by uid 99); 22 May 2008 17:58:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 10:58:00 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rakesh_shete@hotmail.com designates 65.54.246.233 as permitted sender)
Received: from [65.54.246.233] (HELO bay0-omc3-s33.bay0.hotmail.com) (65.54.246.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 17:57:03 +0000
Received: from BAY112-W48 ([64.4.26.148]) by bay0-omc3-s33.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 22 May 2008 10:57:24 -0700
Message-ID: <BAY112-W48459FF432A4AF813A70BDF9C60@phx.gbl>
Content-Type: multipart/alternative;
	boundary="_d92091b8-97e2-4358-ab6c-f6a6745d294e_"
X-Originating-IP: [125.99.82.185]
From: Rakesh Shete <rakesh_shete@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: RE: Improving search performance
Date: Thu, 22 May 2008 23:27:24 +0530
Importance: Normal
In-Reply-To: <620720.42018.qm@web50303.mail.re2.yahoo.com>
References: <620720.42018.qm@web50303.mail.re2.yahoo.com>
MIME-Version: 1.0
X-OriginalArrivalTime: 22 May 2008 17:57:24.0463 (UTC) FILETIME=[4A397FF0:01C8BC35]
X-Virus-Checked: Checked by ClamAV on apache.org

--_d92091b8-97e2-4358-ab6c-f6a6745d294e_
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable


Hi Otis,

Thanks for the quick response.

Yes my application requirements mandate me to perform wildcard and range ma=
tches. I can't avoid it.

HibernateSearch(HS) uses a kind of IndexReader (HS specific) for optimizing=
 querying over indexes. I'll explore on the idea of using a pool of searche=
rs.

However, should just indexing the data for each fields without storing them=
 improve performance? My understanding is that this will reduce the size of=
 the index and hence improve performance.

Also does query time boosting has any performance bottlenecks?

Like: +(t:boss*^10 d:boss*^5 dd:boss*^3 tg:boss*^2) +st:act +ntid:0 +cid:1 =
+dr:[20080410 TO 20081010] +rT:[002 TO 005]

Thanks,
Rakesh S


> Date: Thu, 22 May 2008 10:22:27 -0700
> From: otis_gospodnetic@yahoo.com
> Subject: Re: Improving search performance
> To: java-user@lucene.apache.org
>=20
> Some quick feedback.  Those are all very expensive queries (wildcards and=
 ranges).  The first thing I'd do is try without Hibernate Search (to make =
sure HS is not the bottleneck).  100 threads is a lot, I'm guessing you are=
 reusing your searcher, which is good, but you will actually improve perfor=
mance a bit if you work with a small pool of searchers instead of a single =
searcher.
>=20
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>=20
>=20
> ----- Original Message ----
> > From: Rakesh Shete <rakesh_shete@hotmail.com>
> > To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
> > Sent: Thursday, May 22, 2008 1:16:13 PM
> > Subject: Improving search performance
> >=20
> >=20
> > Hi all,
> >=20
> > I have index of size 85MB. My query looks as follows:
> >=20
> > +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:[200804=
10 TO=20
> > 20081010] +rT:[002 TO 005]
> >=20
> > All the fields used in the query are stored in the indexes (Indexed & S=
tored)
> >=20
> > The query response time for me is around 30 seconds when running mutlip=
le=20
> > simultanoeous threads (~100). The no. of matches is ~30k but I retrieve=
 only the=20
> > top 100 results. I am using Hibernate Search which is a wrapper around =
Lucene. I=20
> > retrieve the "id" filed from the index which is also indexex and stored=
.
> >=20
> > What is the approach that I should take for improving the performance?
> >=20
> > Will just indexing the values without storing them work (Index & UnStor=
ed)?
> >=20
> > My machine configuration is:
> > P4 2.66GHz 1.99 GB RAM
> >=20
> > The code for searching runs in JBoss application server which has a max=
imum heap=20
> > size of 1024MB. When these 100 threads are running in the application s=
erver the=20
> > CPU utilization is 100% and JBoss consumes all of the heap size.=20
> >=20
> > Any pointers on index optimization would be really appreciated.
> >=20
> > --Regards,
> > Rakesh Shete
> >=20
> > _________________________________________________________________
> > No Harvard, No Oxford. We are here. Find out !!
> > http://ss1.richmedia.in/recurl.asp?pid=3D500
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20

_________________________________________________________________
Watch hottest Bollywood videos, clips, movie tailors, star interviews, song=
s and more on MSN videos.
http://video.msn.com/?mkt=3Den-in=

--_d92091b8-97e2-4358-ab6c-f6a6745d294e_--

From java-user-return-34153-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 17:59:48 2008
Return-Path: <java-user-return-34153-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43551 invoked from network); 22 May 2008 17:59:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 17:59:48 -0000
Received: (qmail 51430 invoked by uid 500); 22 May 2008 17:59:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51401 invoked by uid 500); 22 May 2008 17:59:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51390 invoked by uid 99); 22 May 2008 17:59:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 10:59:42 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of glen.newton@gmail.com designates 209.85.198.234 as permitted sender)
Received: from [209.85.198.234] (HELO rv-out-0506.google.com) (209.85.198.234)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 17:58:54 +0000
Received: by rv-out-0506.google.com with SMTP id f6so177712rvb.5
        for <java-user@lucene.apache.org>; Thu, 22 May 2008 10:59:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=2EpeRjLzHn/Sx6W+xfJMe6bERNMRhYHQ8ktpV3lwV9M=;
        b=tS0RyWADSLgnwqKgiGWhzKCX6TTZsTlUaCBQ2Dbn1Greb5QAXpivUPJaOiC7ZAGecgc0F9aL/rRFyx7owNBoSQhrrNo9phdtxwYWMgth+SciGXl3jojMEAjNkhR6EsczPWm9xi2lFmsiCAVZ85SbYg7wUY6qVPIwN9Drcl8eDPY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=d1UZAbGQfvR0Nv80kLKSpVoN76y/BJLc5DgW/pqX9RzZ3LirUi4J7bzNPyEMy8+QWQVJh+bFn1NHG8wpgiLzwtt5wUik89tfgBpWXtCjSUnpMhdzku6UJDfDf/W0ZpAKpVqlPK8jENuMUKmbitH18JNZc9v258konedh+kRS+3s=
Received: by 10.141.75.6 with SMTP id c6mr155334rvl.286.1211479150475;
        Thu, 22 May 2008 10:59:10 -0700 (PDT)
Received: by 10.140.166.14 with HTTP; Thu, 22 May 2008 10:59:10 -0700 (PDT)
Message-ID: <5e76f3840805221059o5797756fif3d5c28ac6bbfef4@mail.gmail.com>
Date: Thu, 22 May 2008 13:59:10 -0400
From: "Glen Newton" <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Improving search performance
In-Reply-To: <620720.42018.qm@web50303.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <620720.42018.qm@web50303.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

2008/5/22 Otis Gospodnetic <otis_gospodnetic@yahoo.com>:
> Some quick feedback.  Those are all very expensive queries (wildcards and ranges).  The first thing I'd do is try without Hibernate Search (to make sure HS is not the bottleneck).  100 threads is a lot, I'm guessing you are reusing your searcher, which is good, but you will actually improve performance a bit if you work with a small pool of searchers instead of a single searcher.

Any chance you could explain why this is the case? Is it because the
parallel searches are serialized in the single searcher?

-Glen

>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
>> From: Rakesh Shete <rakesh_shete@hotmail.com>
>> To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
>> Sent: Thursday, May 22, 2008 1:16:13 PM
>> Subject: Improving search performance
>>
>>
>> Hi all,
>>
>> I have index of size 85MB. My query looks as follows:
>>
>> +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:[20080410 TO
>> 20081010] +rT:[002 TO 005]
>>
>> All the fields used in the query are stored in the indexes (Indexed & Stored)
>>
>> The query response time for me is around 30 seconds when running mutliple
>> simultanoeous threads (~100). The no. of matches is ~30k but I retrieve only the
>> top 100 results. I am using Hibernate Search which is a wrapper around Lucene. I
>> retrieve the "id" filed from the index which is also indexex and stored.
>>
>> What is the approach that I should take for improving the performance?
>>
>> Will just indexing the values without storing them work (Index & UnStored)?
>>
>> My machine configuration is:
>> P4 2.66GHz 1.99 GB RAM
>>
>> The code for searching runs in JBoss application server which has a maximum heap
>> size of 1024MB. When these 100 threads are running in the application server the
>> CPU utilization is 100% and JBoss consumes all of the heap size.
>>
>> Any pointers on index optimization would be really appreciated.
>>
>> --Regards,
>> Rakesh Shete
>>
>> _________________________________________________________________
>> No Harvard, No Oxford. We are here. Find out !!
>> http://ss1.richmedia.in/recurl.asp?pid=500
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34154-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 20:23:51 2008
Return-Path: <java-user-return-34154-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53825 invoked from network); 22 May 2008 20:23:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 20:23:51 -0000
Received: (qmail 1939 invoked by uid 500); 22 May 2008 20:23:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1020 invoked by uid 500); 22 May 2008 20:23:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1008 invoked by uid 99); 22 May 2008 20:23:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 13:23:44 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.198.233 as permitted sender)
Received: from [209.85.198.233] (HELO rv-out-0506.google.com) (209.85.198.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 20:22:58 +0000
Received: by rv-out-0506.google.com with SMTP id f6so269348rvb.5
        for <java-user@lucene.apache.org>; Thu, 22 May 2008 13:23:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=UsNlqR302HJ49Cg2AWiCrv/dfWLiRAB8bCbcbbEmDUk=;
        b=nhJGblhIQi/Pa7UfEiyfJ8ypaE9uBh3QJK3fM6BljlUYTJgknnLKXUgNIWBishnMoXjd1Gbq1FxkJVhS5hbqSRrhiOqxjwAYIvTRQMlA4l1axScfZqeBbL3JnzLHKnV45R9r79aR7qlRwoxt/fQYsHbFP8F4c3szQ2PxekKZi9E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=OAFa97ur4IMCNjF1bjVdFtFmp3ln6RPj5WJaFs7Oc5UFQKVRZaJGeFAglGlTfnJdoSBrJuyn9gqDZ2aNUYhbje6c1TD1BUuIeqVTxlu0yAGtxa3VH9DBbK0GBTbOaJVS5QUPJTFjQVPPhOV275/urAOWt4qCubO63oycahPnM14=
Received: by 10.141.211.13 with SMTP id n13mr234929rvq.184.1211487794270;
        Thu, 22 May 2008 13:23:14 -0700 (PDT)
Received: by 10.140.188.20 with HTTP; Thu, 22 May 2008 13:23:14 -0700 (PDT)
Message-ID: <85d3c3b60805221323i4f26ec30j9aa31be1e34f933e@mail.gmail.com>
Date: Thu, 22 May 2008 16:23:14 -0400
From: "Jason Rutherglen" <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Handeling when a field does not exist in the document
In-Reply-To: <cec089090805220244o4f4a8c80p6edc104202a6537d@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_9193_2646366.1211487794275"
References: <cec089090805220244o4f4a8c80p6edc104202a6537d@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_9193_2646366.1211487794275
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

That is an interesting problem.
https://issues.apache.org/jira/browse/LUCENE-1292 will build a tag index
that uses a ParallelReader to allow tag fields to be searchable.  The tag
index does not use the usual IndexWriter but uses a specialized realtime
updateable index built for tags.  Depending on the requirements, the Tag
Index could be implemented in a variety of ways.  It depends on how many
tags, documents, and in this case users.

On Thu, May 22, 2008 at 5:44 AM, lucene user <luz290@gmail.com> wrote:

> We have a requirement to inform users on a regular basis of new material on
> which they have expressed interest. How are we to know what is "new" from
> the point of view of a particular user? Our idea is to tag each new item in
> some way (perhaps a date/time stamp in the lucene index indicating when the
> new document was indexed) and remember when the last time we sent out an
> alert to that user.
> How should we tag the documents? With a date/time of indexing stamp? An
> incrementing batch import ID number? Does it matter much?
>
> *I am reminded that ranges of dates and numbers, (as well as wild cards)
> are
> evaluated as if they were a large OR query covering all the values that
> exist in the index. Lucene only finds exact matches - it does not do
> comparisons. This means that ranges with lots of different values in them
> are bad - and can actually crash with a 'too many clauses' exception if
> there are enough distinct values to push the number of clauses over 1024.
> Do
> I understand this correctly?*
>
> *How do we handle existing documents which do not have such a new field
> associated with them? Can we provide a default value for the existing
> documents? *
>
> I did not find the place in the Lucene Documentation where it explains what
> you get when you try to retrieve or search on a field that does not exist
> in
> the document. I remember it not being a problem, but I couldn't find it.
> How
> do I do this? What should I read?
>
> Thanks!
>

------=_Part_9193_2646366.1211487794275--

From java-user-return-34155-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 20:32:38 2008
Return-Path: <java-user-return-34155-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56535 invoked from network); 22 May 2008 20:32:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 20:32:38 -0000
Received: (qmail 14681 invoked by uid 500); 22 May 2008 20:32:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14299 invoked by uid 500); 22 May 2008 20:32:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14288 invoked by uid 99); 22 May 2008 20:32:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 13:32:32 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.198.229 as permitted sender)
Received: from [209.85.198.229] (HELO rv-out-0506.google.com) (209.85.198.229)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 20:31:44 +0000
Received: by rv-out-0506.google.com with SMTP id f6so274354rvb.5
        for <java-user@lucene.apache.org>; Thu, 22 May 2008 13:32:00 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=qxVtMrwmonbrI4H3zSp0wHM56LV7jm7rZ2tDIzYOKnk=;
        b=JgQvffE7Poy1fD5E6XHCi11PDGlfyQz/KzZDEVo6HOEXT3mRf9oCrGBBkkwJEl6upZZGtO7ko6oMJHSrlmvEMiCPMAYqcimwwypt/E0GixZE7WlVbQhUrFBGQujO5aKmcGU4aLXJ5kPZ3p2y+1uOPdPVja89nBG7Z8BWd+AaVvI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Ep4u6y9rhDhY/ELd1NjzxZwGDO7kcSTWQesNOW4E2+LmAJNrLHaLbqayM50gpPnc6DFmOfTKGh4sLtW5b4HhhDkJ3TK6WBwh4K9fOtFPo2dZRxSBcnC2hlmIpM2eIYwYHPsitJNnkd6N5wPUCLDowzLucqcm9prySHFruKLOBcQ=
Received: by 10.141.76.21 with SMTP id d21mr234088rvl.270.1211488319432;
        Thu, 22 May 2008 13:31:59 -0700 (PDT)
Received: by 10.140.188.20 with HTTP; Thu, 22 May 2008 13:31:59 -0700 (PDT)
Message-ID: <85d3c3b60805221331qfb8f439idd508e6c9dd6731c@mail.gmail.com>
Date: Thu, 22 May 2008 16:31:59 -0400
From: "Jason Rutherglen" <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Improving search performance
In-Reply-To: <620720.42018.qm@web50303.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_9216_16021993.1211488319451"
References: <620720.42018.qm@web50303.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_9216_16021993.1211488319451
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

It would be interesting to see the results of using a custom IndexReader
that implements
http://dsiutils.dsi.unimi.it/docs/it/unimi/dsi/util/ImmutableExternalPrefixMap.htmlor
something like it.  The only problem right now would be hooking into
the
Lucene SegmentMerger to merge other indices such as a specialized prefix
index.

On Thu, May 22, 2008 at 1:22 PM, Otis Gospodnetic <
otis_gospodnetic@yahoo.com> wrote:

> Some quick feedback.  Those are all very expensive queries (wildcards and
> ranges).  The first thing I'd do is try without Hibernate Search (to make
> sure HS is not the bottleneck).  100 threads is a lot, I'm guessing you are
> reusing your searcher, which is good, but you will actually improve
> performance a bit if you work with a small pool of searchers instead of a
> single searcher.
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
> > From: Rakesh Shete <rakesh_shete@hotmail.com>
> > To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
> > Sent: Thursday, May 22, 2008 1:16:13 PM
> > Subject: Improving search performance
> >
> >
> > Hi all,
> >
> > I have index of size 85MB. My query looks as follows:
> >
> > +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:[20080410
> TO
> > 20081010] +rT:[002 TO 005]
> >
> > All the fields used in the query are stored in the indexes (Indexed &
> Stored)
> >
> > The query response time for me is around 30 seconds when running mutliple
> > simultanoeous threads (~100). The no. of matches is ~30k but I retrieve
> only the
> > top 100 results. I am using Hibernate Search which is a wrapper around
> Lucene. I
> > retrieve the "id" filed from the index which is also indexex and stored.
> >
> > What is the approach that I should take for improving the performance?
> >
> > Will just indexing the values without storing them work (Index &
> UnStored)?
> >
> > My machine configuration is:
> > P4 2.66GHz 1.99 GB RAM
> >
> > The code for searching runs in JBoss application server which has a
> maximum heap
> > size of 1024MB. When these 100 threads are running in the application
> server the
> > CPU utilization is 100% and JBoss consumes all of the heap size.
> >
> > Any pointers on index optimization would be really appreciated.
> >
> > --Regards,
> > Rakesh Shete
> >
> > _________________________________________________________________
> > No Harvard, No Oxford. We are here. Find out !!
> > http://ss1.richmedia.in/recurl.asp?pid=500
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_9216_16021993.1211488319451--

From java-user-return-34156-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 21:41:13 2008
Return-Path: <java-user-return-34156-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96049 invoked from network); 22 May 2008 21:41:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 21:41:12 -0000
Received: (qmail 7321 invoked by uid 500); 22 May 2008 21:41:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7295 invoked by uid 500); 22 May 2008 21:41:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7284 invoked by uid 99); 22 May 2008 21:41:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 14:41:06 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.198.230 as permitted sender)
Received: from [209.85.198.230] (HELO rv-out-0506.google.com) (209.85.198.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 21:40:18 +0000
Received: by rv-out-0506.google.com with SMTP id f6so307432rvb.5
        for <java-user@lucene.apache.org>; Thu, 22 May 2008 14:40:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=UU95fZ1btz23QiRgDrXjapO33BfU8bXg/Xlkbj5ZxUo=;
        b=F811kGfkT6VjFrj74uV/3qMxxMsGu55Ar3VgtlELG/6dYT6NpTlNqC1IuUIyXEwleFAi7oJi3eQXm80My/jh5TlZHdp3QOoQAvQQsIjXvHZNQcEITpjFjJaTyfkHXl9dOoI4Tq8oDGEUZA/drsRjKO4xQ6c0flLQ/Xh/XnBRFY8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Nzdij3xwSf137ZDbs5ewlognoHfC7M0Dg0NszzZi4sJIqX0OaspQAQysvkJtrVWq6hmyPem+Rh8Lf1rIlqdsZmYOtDPlSikpJOKmdoajTwpsoz0Ox9DcyX51FFmyZWqm7U8Yv/+x0L8V5jg3OXR/Cu+9Si5YFZMrMlzVg3SDEvg=
Received: by 10.141.170.10 with SMTP id x10mr272975rvo.139.1211492433850;
        Thu, 22 May 2008 14:40:33 -0700 (PDT)
Received: by 10.140.188.20 with HTTP; Thu, 22 May 2008 14:40:33 -0700 (PDT)
Message-ID: <85d3c3b60805221440l1d8cdec8jda1d2eab65871cad@mail.gmail.com>
Date: Thu, 22 May 2008 17:40:33 -0400
From: "Jason Rutherglen" <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Improving search performance
In-Reply-To: <BAY112-W48459FF432A4AF813A70BDF9C60@phx.gbl>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_9324_22700971.1211492433879"
References: <620720.42018.qm@web50303.mail.re2.yahoo.com>
	 <BAY112-W48459FF432A4AF813A70BDF9C60@phx.gbl>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_9324_22700971.1211492433879
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Query time boosting has no bottlenecks.  Storing will not affect
performance.  You will probably want to use PrefixFilter and
ConstantScoreRangeQuery.  Solr has ConstantScorePrefixQuery.  Simply means
if the document contains the term, the result will show, the scoring will
not be quite the same because there is one score no matter how many times
the term is in a document.

On Thu, May 22, 2008 at 1:57 PM, Rakesh Shete <rakesh_shete@hotmail.com>
wrote:

>
> Hi Otis,
>
> Thanks for the quick response.
>
> Yes my application requirements mandate me to perform wildcard and range
> matches. I can't avoid it.
>
> HibernateSearch(HS) uses a kind of IndexReader (HS specific) for optimizing
> querying over indexes. I'll explore on the idea of using a pool of
> searchers.
>
> However, should just indexing the data for each fields without storing them
> improve performance? My understanding is that this will reduce the size of
> the index and hence improve performance.
>
> Also does query time boosting has any performance bottlenecks?
>
> Like: +(t:boss*^10 d:boss*^5 dd:boss*^3 tg:boss*^2) +st:act +ntid:0 +cid:1
> +dr:[20080410 TO 20081010] +rT:[002 TO 005]
>
> Thanks,
> Rakesh S
>
>
> > Date: Thu, 22 May 2008 10:22:27 -0700
> > From: otis_gospodnetic@yahoo.com
> > Subject: Re: Improving search performance
> > To: java-user@lucene.apache.org
> >
> > Some quick feedback.  Those are all very expensive queries (wildcards and
> ranges).  The first thing I'd do is try without Hibernate Search (to make
> sure HS is not the bottleneck).  100 threads is a lot, I'm guessing you are
> reusing your searcher, which is good, but you will actually improve
> performance a bit if you work with a small pool of searchers instead of a
> single searcher.
> >
> > Otis
> > --
> > Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
> >
> >
> > ----- Original Message ----
> > > From: Rakesh Shete <rakesh_shete@hotmail.com>
> > > To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
> > > Sent: Thursday, May 22, 2008 1:16:13 PM
> > > Subject: Improving search performance
> > >
> > >
> > > Hi all,
> > >
> > > I have index of size 85MB. My query looks as follows:
> > >
> > > +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1
> +dr:[20080410 TO
> > > 20081010] +rT:[002 TO 005]
> > >
> > > All the fields used in the query are stored in the indexes (Indexed &
> Stored)
> > >
> > > The query response time for me is around 30 seconds when running
> mutliple
> > > simultanoeous threads (~100). The no. of matches is ~30k but I retrieve
> only the
> > > top 100 results. I am using Hibernate Search which is a wrapper around
> Lucene. I
> > > retrieve the "id" filed from the index which is also indexex and
> stored.
> > >
> > > What is the approach that I should take for improving the performance?
> > >
> > > Will just indexing the values without storing them work (Index &
> UnStored)?
> > >
> > > My machine configuration is:
> > > P4 2.66GHz 1.99 GB RAM
> > >
> > > The code for searching runs in JBoss application server which has a
> maximum heap
> > > size of 1024MB. When these 100 threads are running in the application
> server the
> > > CPU utilization is 100% and JBoss consumes all of the heap size.
> > >
> > > Any pointers on index optimization would be really appreciated.
> > >
> > > --Regards,
> > > Rakesh Shete
> > >
> > > _________________________________________________________________
> > > No Harvard, No Oxford. We are here. Find out !!
> > > http://ss1.richmedia.in/recurl.asp?pid=500
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
> _________________________________________________________________
> Watch hottest Bollywood videos, clips, movie tailors, star interviews,
> songs and more on MSN videos.
> http://video.msn.com/?mkt=en-in
>

------=_Part_9324_22700971.1211492433879--

From java-user-return-34157-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 22 22:21:53 2008
Return-Path: <java-user-return-34157-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56959 invoked from network); 22 May 2008 22:21:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 May 2008 22:21:53 -0000
Received: (qmail 66628 invoked by uid 500); 22 May 2008 22:21:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66599 invoked by uid 500); 22 May 2008 22:21:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66580 invoked by uid 99); 22 May 2008 22:21:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 15:21:47 -0700
X-ASF-Spam-Status: No, hits=1.6 required=10.0
	tests=RCVD_IN_DNSWL_LOW,RCVD_NUMERIC_HELO,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [65.212.71.225] (HELO prw2k3mm03.dmz.weather.com) (65.212.71.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 May 2008 22:21:00 +0000
Received: from ATLMAIL01.corp.weather.com (Not Verified[10.31.24.101]) by prw2k3mm03.dmz.weather.com with MailMarshal (v6,2,1,3252)
	id <B4835f3e50000>; Thu, 22 May 2008 18:29:57 -0400
Received: from 65.5.180.247 ([65.5.180.247]) by ATLMAIL01.corp.weather.com ([10.31.24.121]) via Exchange Front-End Server exchange.weather.com ([65.212.71.81]) with Microsoft Exchange Server HTTP-DAV ;
 Thu, 22 May 2008 22:21:15 +0000
User-Agent: Microsoft-Entourage/12.10.0.080409
Date: Thu, 22 May 2008 18:21:14 -0400
Subject: Query works in Luke but not in code...
From: Casey Dement <cdement@weather.com>
To: <java-user@lucene.apache.org>
Message-ID: <C45B6A1A.5C4B%cdement@weather.com>
Thread-Topic: Query works in Luke but not in code...
Thread-Index: Aci8WiVdlRPLChjIuE2fJD690RGw8w==
Mime-version: 1.0
Content-type: text/plain;
	charset="US-ASCII"
Content-transfer-encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi - trying to execute a search in Lucene and getting results I don't
understand :(

The index contains fields search_text and type - both indexed tokenized.
I'm attempting to execute the query:

  +(search_text:austell~0.9 search_text:ga~0.9) +(type:1 type:4)

And expect to match document 156297 (search_text=="Austell GA", type==1).

I am executing this query both directly in code and via the tool Luke - but
getting WILDLY different answers.  In Luke, the expected document is found
no problem, but in my own code I find no results.  Obviously I suspect my
code of being crap ;)

Oh, FYI, in both my local code and Luke I am using a StandardAnalyzer and
the default column is "search_text".

Here's what I'm doing:

  /******************************************************************/
  File location = new File("/the/correct/path");
  IndexReader index = IndexReader.open(location);
  Searcher searcher = new IndexSearcher(index);
  QueryParser parser = new QueryParser("search_text", new
StandardAnalyzer());
  Query query = parser.parse("+(search_text:austell~0.9 search_text:ga~0.9)
+(type:1 type:4)");
  System.out.println(searcher.explain(query, 156296));
  /******************************************************************/

When I run this, I get:
|  0.0000 = (NON-MATCH) Failure to meet condition(s) of required/prohibited
clause(s)
|    0.0000 = no match on required clause (() ())
|      0.0000 = (NON-MATCH) product of:
|        0.0000 = (NON-MATCH) sum of:
|        0.0000 = coord(0/2)
|    0.2133 = (MATCH) product of:
|      0.4267 = (MATCH) sum of:
|        0.4267 = (MATCH) weight(type:1 in 156296), product of:
|          0.3672 = queryWeight(type:1), product of:
|            1.1618 = idf(docFreq=315734, numDocs=371197)
|            0.3161 = queryNorm
|          1.1618 = (MATCH) fieldWeight(type:1 in 156296), product of:
|            1.0000 = tf(termFreq(type:1)=1)
|            1.1618 = idf(docFreq=315734, numDocs=371197)
|            1.0000 = fieldNorm(field=type, doc=156296)
|      0.5000 = coord(1/2)

So obviously I'm loading the index (since it did match the "type") - but it
seems to be COMPLETELY ignoring the criteria on "search_text".

When I run this exact same string in Luke, I get:
|  8.0079 = (MATCH) sum of:
|    7.9578 = (MATCH) sum of:
|      5.4904 = (MATCH) weight(search_text:austell in 156297), product of:
|        0.8074 = queryWeight(search_text:austell), product of:
|          10.8800 = idf(docFreq=18, numDocs=371197)
|          0.0742 = queryNorm
|        6.8000 = (MATCH) fieldWeight(search_text:austell in 156297),
product of:
|          1.0000 = tf(termFreq(search_text:austell)=1)
|          10.8800 = idf(docFreq=18, numDocs=371197)
|          0.6250 = fieldNorm(field=search_text, doc=156297)
|      2.4673 = (MATCH) weight(search_text:ga in 156297), product of:
|        0.5413 = queryWeight(search_text:ga), product of:
|          7.2936 = idf(docFreq=685, numDocs=371197)
|          0.0742 = queryNorm
|        4.5585 = (MATCH) fieldWeight(search_text:ga in 156297), product of:
|          1.0000 = tf(termFreq(search_text:ga)=1)
|          7.2936 = idf(docFreq=685, numDocs=371197)
|          0.6250 = fieldNorm(field=search_text, doc=156297)
|    0.0501 = (MATCH) product of:
|      0.1002 = (MATCH) sum of:
|        0.1002 = (MATCH) weight(type:1 in 156296), product of:
|          0.0862 = queryWeight(type:1), product of:
|            1.1618 = idf(docFreq=315734, numDocs=371197)
|            0.0742 = queryNorm
|          1.1618 = (MATCH) fieldWeight(type:1 in 156296), product of:
|            1.0000 = tf(termFreq(type:1)=1)
|            1.1618 = idf(docFreq=315734, numDocs=371197)
|            1.0000 = fieldNorm(field=type, doc=156296)
|      0.5000 = coord(1/2)

Which while clearly looking at the same document ID in the same index is
conversely working perfectly!

Does anybody have any idea where I am screwing up?  Thanks!

Casey


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34158-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 23 09:00:21 2008
Return-Path: <java-user-return-34158-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84140 invoked from network); 23 May 2008 09:00:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 May 2008 09:00:20 -0000
Received: (qmail 8210 invoked by uid 500); 23 May 2008 09:00:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8170 invoked by uid 500); 23 May 2008 09:00:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8159 invoked by uid 99); 23 May 2008 09:00:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 02:00:13 -0700
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=SPF_PASS,UNPARSEABLE_RELAY
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [212.202.226.200] (HELO gate.abas.de) (212.202.226.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 08:59:20 +0000
Received: from gate.abas.de (localhost [127.0.0.1])
	by gate.abas.de (8.13.8/8.13.8) with ESMTP id m4N8xgFM015125
	for <java-user@lucene.apache.org>; Fri, 23 May 2008 10:59:42 +0200 (CEST)
Received: (from localhost) by gate.abas.de (MSCAN) id 5/gate.abas.de/smtp-gw/mscan; Fri May 23 10:59:42 2008
From: Stefan Trcek <wzzelfzzel@abas.de>
To: java-user@lucene.apache.org
Subject: How to get the error position in QueryParser/ParseException
Date: Fri, 23 May 2008 10:59:36 +0200
User-Agent: KMail/1.9.6 (enterprise 0.20070907.709405)
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805231059.37109.wzzelfzzel@abas.de>
X-ABAS-MAIL-MARK: added by mailmarker.abas.de
X-Virus-Checked: Checked by ClamAV on apache.org

Hello

When using "new QueryParser(...).parse(...)" I'd like to get the 
position where the error was detected (to show it to the user).
See (and run) the code below.

This is not possible via "e.currentToken" (that's null). Nevertheless 
this position will be printed within the getMessage() method but is not 
accessible directly.

The reason is that ParseException has two different modes of 
instantiation distinguished by "specialConstructor". As it gets copied 
within the lucene code (specialConstructor==false) the currentToken 
variable is lost.

I guess it would be nice to add the position of the error. Any other way 
I have overlooked? I could parse the output of getMessage(), but that 
is not fine.

==================================================================
import org.apache.lucene.analysis.WhitespaceAnalyzer;
import org.apache.lucene.queryParser.ParseException;
import org.apache.lucene.queryParser.QueryParser;

public class TestParseException {

    public static void main(String[] args) {
        QueryParser parser = new QueryParser("any",
                new WhitespaceAnalyzer());
        try {
            parser.parse("b("); // yields ParseException
        }
        catch (ParseException e) {
            System.out.println("e.currentToken=" + e.currentToken);
            if (e.currentToken != null) {
                System.out.println("e.currentToken.beginColumn="
                        + e.currentToken.beginColumn);
            }
            System.out.println("message=" + e.getMessage());
        }
    }

}
==================================================================

Stefan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34159-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 23 09:01:11 2008
Return-Path: <java-user-return-34159-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84451 invoked from network); 23 May 2008 09:01:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 May 2008 09:01:11 -0000
Received: (qmail 11928 invoked by uid 500); 23 May 2008 09:00:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11886 invoked by uid 500); 23 May 2008 09:00:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11835 invoked by uid 99); 23 May 2008 09:00:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 02:00:58 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 209.85.146.182 as permitted sender)
Received: from [209.85.146.182] (HELO wa-out-1112.google.com) (209.85.146.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 09:00:11 +0000
Received: by wa-out-1112.google.com with SMTP id l24so533796waf.11
        for <java-user@lucene.apache.org>; Fri, 23 May 2008 02:00:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=KRuAY+BDXWGeOJQNWGiQYLCi7jLCtn/XIbmefxY6QsU=;
        b=CcpumolYQxkejEfjsxWH6c/DACQacCmWigJx7qrVtrm34IUhPZAE2uB43Fd3gnvd/s79ZWxW983vhw305RHCqdnAFnSbslmE2Kyymho0gY+yMPV+JPSoPrzZcNK2xB0wYO4/u8Kp7bQsSRPFrGmOoqt7vhz/l9jn1rqSlVOToYw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=FoZBGsQLG/denrProyRnqdsI6kXreCGMSpdHlu1b5yojSYauxg/Bt9EF3wlykGy2EYJzrZ5tTQMeg9jZIJ5KRc4Q+blelB4kKZyvGzyKtRKNu6IYCOeienuvqBVagw9TnrJVsVSqgTkoDEUibZSC4x6qAXMgPh3NWhvSIAHznh4=
Received: by 10.114.14.1 with SMTP id 1mr1499139wan.9.1211533227746;
        Fri, 23 May 2008 02:00:27 -0700 (PDT)
Received: by 10.114.210.9 with HTTP; Fri, 23 May 2008 02:00:27 -0700 (PDT)
Message-ID: <8c4e68610805230200s5714cea9g9a4e1b951c36d423@mail.gmail.com>
Date: Fri, 23 May 2008 10:00:27 +0100
From: "Ian Lea" <ian.lea@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Query works in Luke but not in code...
In-Reply-To: <C45B6A1A.5C4B%cdement@weather.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <C45B6A1A.5C4B%cdement@weather.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> ...
> And expect to match document 156297 (search_text=="Austell GA", type==1).
> ...
>  System.out.println(searcher.explain(query, 156296));

156297 != 156296

Could that be it?


--
Ian.


On Thu, May 22, 2008 at 11:21 PM, Casey Dement <cdement@weather.com> wrote:
> Hi - trying to execute a search in Lucene and getting results I don't
> understand :(
>
> The index contains fields search_text and type - both indexed tokenized.
> I'm attempting to execute the query:
>
>  +(search_text:austell~0.9 search_text:ga~0.9) +(type:1 type:4)
>
> And expect to match document 156297 (search_text=="Austell GA", type==1).
>
> I am executing this query both directly in code and via the tool Luke - but
> getting WILDLY different answers.  In Luke, the expected document is found
> no problem, but in my own code I find no results.  Obviously I suspect my
> code of being crap ;)
>
> Oh, FYI, in both my local code and Luke I am using a StandardAnalyzer and
> the default column is "search_text".
>
> Here's what I'm doing:
>
>  /******************************************************************/
>  File location = new File("/the/correct/path");
>  IndexReader index = IndexReader.open(location);
>  Searcher searcher = new IndexSearcher(index);
>  QueryParser parser = new QueryParser("search_text", new
> StandardAnalyzer());
>  Query query = parser.parse("+(search_text:austell~0.9 search_text:ga~0.9)
> +(type:1 type:4)");
>  System.out.println(searcher.explain(query, 156296));
>  /******************************************************************/
>
> When I run this, I get:
> |  0.0000 = (NON-MATCH) Failure to meet condition(s) of required/prohibited
> clause(s)
> |    0.0000 = no match on required clause (() ())
> |      0.0000 = (NON-MATCH) product of:
> |        0.0000 = (NON-MATCH) sum of:
> |        0.0000 = coord(0/2)
> |    0.2133 = (MATCH) product of:
> |      0.4267 = (MATCH) sum of:
> |        0.4267 = (MATCH) weight(type:1 in 156296), product of:
> |          0.3672 = queryWeight(type:1), product of:
> |            1.1618 = idf(docFreq=315734, numDocs=371197)
> |            0.3161 = queryNorm
> |          1.1618 = (MATCH) fieldWeight(type:1 in 156296), product of:
> |            1.0000 = tf(termFreq(type:1)=1)
> |            1.1618 = idf(docFreq=315734, numDocs=371197)
> |            1.0000 = fieldNorm(field=type, doc=156296)
> |      0.5000 = coord(1/2)
>
> So obviously I'm loading the index (since it did match the "type") - but it
> seems to be COMPLETELY ignoring the criteria on "search_text".
>
> When I run this exact same string in Luke, I get:
> |  8.0079 = (MATCH) sum of:
> |    7.9578 = (MATCH) sum of:
> |      5.4904 = (MATCH) weight(search_text:austell in 156297), product of:
> |        0.8074 = queryWeight(search_text:austell), product of:
> |          10.8800 = idf(docFreq=18, numDocs=371197)
> |          0.0742 = queryNorm
> |        6.8000 = (MATCH) fieldWeight(search_text:austell in 156297),
> product of:
> |          1.0000 = tf(termFreq(search_text:austell)=1)
> |          10.8800 = idf(docFreq=18, numDocs=371197)
> |          0.6250 = fieldNorm(field=search_text, doc=156297)
> |      2.4673 = (MATCH) weight(search_text:ga in 156297), product of:
> |        0.5413 = queryWeight(search_text:ga), product of:
> |          7.2936 = idf(docFreq=685, numDocs=371197)
> |          0.0742 = queryNorm
> |        4.5585 = (MATCH) fieldWeight(search_text:ga in 156297), product of:
> |          1.0000 = tf(termFreq(search_text:ga)=1)
> |          7.2936 = idf(docFreq=685, numDocs=371197)
> |          0.6250 = fieldNorm(field=search_text, doc=156297)
> |    0.0501 = (MATCH) product of:
> |      0.1002 = (MATCH) sum of:
> |        0.1002 = (MATCH) weight(type:1 in 156296), product of:
> |          0.0862 = queryWeight(type:1), product of:
> |            1.1618 = idf(docFreq=315734, numDocs=371197)
> |            0.0742 = queryNorm
> |          1.1618 = (MATCH) fieldWeight(type:1 in 156296), product of:
> |            1.0000 = tf(termFreq(type:1)=1)
> |            1.1618 = idf(docFreq=315734, numDocs=371197)
> |            1.0000 = fieldNorm(field=type, doc=156296)
> |      0.5000 = coord(1/2)
>
> Which while clearly looking at the same document ID in the same index is
> conversely working perfectly!
>
> Does anybody have any idea where I am screwing up?  Thanks!
>
> Casey

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34160-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 23 13:19:41 2008
Return-Path: <java-user-return-34160-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71446 invoked from network); 23 May 2008 13:19:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 May 2008 13:19:41 -0000
Received: (qmail 20576 invoked by uid 500); 23 May 2008 13:19:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20543 invoked by uid 500); 23 May 2008 13:19:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20532 invoked by uid 99); 23 May 2008 13:19:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 06:19:36 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: 194.109.24.30 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.30] (HELO smtp-vbr10.xs4all.nl) (194.109.24.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 13:18:42 +0000
Received: from kodapan.lan (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr10.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4NDJ4mD017557
	for <java-user@lucene.apache.org>; Fri, 23 May 2008 15:19:04 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <6CFEE209-F0DA-4D3C-8BD7-861279D6185B@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: SpanNearQuery scoring
Date: Fri, 23 May 2008 15:19:03 +0200
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Everything (scores, explainations and not hitting breakpoints while  
debugging) seems to point at that SpanNearQuery doesn't use the  
scoring of the inner spans. Is this true? If so, is it intentional? It  
messes with BoostingTermQuery, SpanFuzzyTermQuery, et c.


       karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34161-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 23 13:24:17 2008
Return-Path: <java-user-return-34161-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72731 invoked from network); 23 May 2008 13:24:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 May 2008 13:24:17 -0000
Received: (qmail 30292 invoked by uid 500); 23 May 2008 13:24:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29885 invoked by uid 500); 23 May 2008 13:24:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29874 invoked by uid 99); 23 May 2008 13:24:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 06:24:11 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: 194.109.24.29 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.29] (HELO smtp-vbr9.xs4all.nl) (194.109.24.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 13:23:16 +0000
Received: from kodapan.lan (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr9.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4NDNc3S074302
	for <java-user@lucene.apache.org>; Fri, 23 May 2008 15:23:38 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <CC4C627C-BFE3-44CB-88EC-F2619F8D0E67@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <58738D9F-6782-426A-A5A0-E28260AD2327@apache.org>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Best way to get payloads
Date: Fri, 23 May 2008 15:23:38 +0200
References: <74f928500805220103q2bff6e2ob1f833149dd33ef5@mail.gmail.com> <58738D9F-6782-426A-A5A0-E28260AD2327@apache.org>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Is this perhaps sort of pre-written response to the question on  
SpanNearQuery I sent just a minute ago?

      karl

22 maj 2008 kl. 15.00 skrev Grant Ingersoll:
> Unfortunately, I haven't had time to work on https://issues.apache.org/jira/browse/LUCENE-1001
>
> There is a _HALF BAKED_ patch up there, but I got stuck on it at the  
> time due to not being sure how to handle NearSpans and haven't had a  
> chance to go back to it.  I do believe it is possible to expose it  
> via the Spans, so if you are so inclined, it is definitely something  
> that needs to be implemented.
>
> -Grant
>
> On May 22, 2008, at 4:03 AM, Eran Sevi wrote:
>
>> Hi,
>>
>> I'm running a SpanQuery and get the Spans result which tell me the  
>> documents
>> and positions of what I searched for.
>> I would now like to get the payloads in those documents and positions
>> without having to iterate on TermPositions since I don't have a  
>> term but I
>> do have the document and position.
>>
>> Maybe Spans should be extended to also hold the payloads as well as  
>> the
>> start and end positions of the span.
>>
>> Another option might be to extend TermPositionVector and return an  
>> array of
>> payloads.
>>
>> Can anyone think on a way to do it ?
>>
>> Thanks,
>> Eran.
>
>
>
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34162-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 23 14:41:38 2008
Return-Path: <java-user-return-34162-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3333 invoked from network); 23 May 2008 14:41:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 May 2008 14:41:38 -0000
Received: (qmail 61950 invoked by uid 500); 23 May 2008 14:41:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61918 invoked by uid 500); 23 May 2008 14:41:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61907 invoked by uid 99); 23 May 2008 14:41:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 07:41:32 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 14:40:37 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JzYS3-0000c6-4d
	for java-user@lucene.apache.org; Fri, 23 May 2008 07:40:59 -0700
Message-ID: <17427121.post@talk.nabble.com>
Date: Fri, 23 May 2008 07:40:59 -0700 (PDT)
From: syedfa <fayyazuddin@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to return entire resultset which includes the highlighted
 keywords
In-Reply-To: <483425FF.805@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fayyazuddin@gmail.com
References: <17354272.post@talk.nabble.com> <483425FF.805@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks so much for your reply Mr.Miller, that's exactly what I was trying to
accomplish!  :-)

I have however, run into another problem now, and thus I have a follow up
question:

My goal is to provide a set of results like google to the user that presents
a set of results with the keyword highlighted along with about two lines of
text surrounding it.  When the user clicks on this link, they should be able
to see the entire block of text with the highlighted keyword on the next
page.  I have found that I am able to do one or the other (i.e. retrieve the
entire block of text with the highlighted keyword, or the highlighted
keyword and just the surrounding text, but not both at the same time).
My code where I am trying to do this is as follows:

     QueryScorer scorer = new QueryScorer(parser);
     Highlighter highlighter = new Highlighter(scorer);  //reference to
highlight the keyword in the entire block of text
     Highlighter high = new Highlighter(scorer); //reference to highlight
the keyword in the surrounding text
     Fragmenter fragmenter = new NullFragmenter();  //reference to retrieve
the entire block of text
     Fragmenter fragment = new SimpleFragmenter(250);// reference to
retrieve the surrounding text
     highlighter.setTextFragmenter(fragmenter);
     high.setTextFragmenter(fragment);
     
        for(int i=0; i<hits.length(); i++){
         Document doc=hits.doc(i);
         String lns = doc.get("LINES");
         TokenStream lines = analyser.tokenStream("LINES", new
StringReader(lns));
         String highlightedLines = highlighter.getBestFragment(lines, lns);
         String highlight = high.getBestFragment(lines, lns);
         SearchResult resultBean = new SearchResult();
         resultBean.setNarrator(hits.doc(i).get("SPEAKER"));
         resultBean.setQuote(highlightedLines);
         resultBean.setHitResult(highlight);
         searchResult.add(resultBean);
         System.out.println(resultBean.getNarrator());
         System.out.println(resultBean.getHitResult());
         System.out.println("");
         //System.out.println(resultBean.getQuote());
         System.out.println("");
         System.out.println("");
         System.out.println("");
        }
        
        System.err.println("Found " + hits.length() + " document(s)(in " +
(end-start) + " milliseconds) that matched query '" + q + "':"); 
        
        return searchResult;        
    }



How would I accomplish this?  Based on my above code, what am I doing wrong? 
My code retrieves the entire block of text with the highilghted keyword
correctly, but I am getting null as my output when I try to print the
results of the highlighted keyword and the surrounding text.

Thanks again for all of your help.

Sincerely;
Fayyaz

markrmiller wrote:
> 
> Check out NullFragmenter.
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/How-to-return-entire-resultset-which-includes-the-highlighted-keywords-tp17354272p17427121.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34163-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 23 15:46:59 2008
Return-Path: <java-user-return-34163-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90108 invoked from network); 23 May 2008 15:46:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 May 2008 15:46:59 -0000
Received: (qmail 92580 invoked by uid 500); 23 May 2008 15:46:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92555 invoked by uid 500); 23 May 2008 15:46:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92544 invoked by uid 99); 23 May 2008 15:46:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 08:46:53 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.29] (HELO smtp-vbr9.xs4all.nl) (194.109.24.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 15:46:06 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr9.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4NFkKUn016305
	for <java-user@lucene.apache.org>; Fri, 23 May 2008 17:46:20 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: SpanNearQuery scoring
Date: Fri, 23 May 2008 17:46:19 +0200
User-Agent: KMail/1.9.9
References: <6CFEE209-F0DA-4D3C-8BD7-861279D6185B@gmail.com>
In-Reply-To: <6CFEE209-F0DA-4D3C-8BD7-861279D6185B@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805231746.19838.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Op Friday 23 May 2008 15:19:03 schreef Karl Wettin:
> Everything (scores, explainations and not hitting breakpoints while
> debugging) seems to point at that SpanNearQuery doesn't use the
> scoring of the inner spans. Is this true? 

Yes.

> If so, is it intentional?

I don't know. The Spans interface does not contain a weight() or
score() method, so there is no way to pass such information
to SpanScorer.

Regards,
Paul Elschot

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34164-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 23 22:19:25 2008
Return-Path: <java-user-return-34164-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34966 invoked from network); 23 May 2008 22:19:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 May 2008 22:19:25 -0000
Received: (qmail 92215 invoked by uid 500); 23 May 2008 22:19:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92188 invoked by uid 500); 23 May 2008 22:19:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92177 invoked by uid 99); 23 May 2008 22:19:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 15:19:18 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 64.233.166.177 as permitted sender)
Received: from [64.233.166.177] (HELO py-out-1112.google.com) (64.233.166.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 22:18:31 +0000
Received: by py-out-1112.google.com with SMTP id z74so654962pyg.9
        for <java-user@lucene.apache.org>; Fri, 23 May 2008 15:18:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=oQcZoEzc5U7SkvH1wSaStdfCXr2ToKn6OV95bCagXlI=;
        b=PupjM9xWkmNP3ppiUAdQX4P95yiIXpZuEAysyEmUhS4FuT3/w6aBz78pJ94r4nYCUYpjNaVLML9K+5rwMVJSo/5uRLsLIvcNTDlLo8fYHpHl/SG2Se3wwb5tWkot/lArDWpgEDYS9Ut2bSgchUdtj0ZRgMV/kw7HkeDIqWaLQe0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=Y2XN5R1YD4bFnRoW2SFWm/h+b52uI6cMtse85TtIj/9gF565DUAFf2wH8lWAZcok90mMTQPpAlByea4zs/fidR+fjrpSwz1WDpJ+ThlAiE8Y1PWlID1ZUl8EKWPWTtupD9Oemn+U2OqIZfj3PL7u7uwW5dzGdxyh+uXkRxI6So8=
Received: by 10.64.209.6 with SMTP id h6mr3651600qbg.7.1211581127215;
        Fri, 23 May 2008 15:18:47 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id q14sm5499775qbq.29.2008.05.23.15.18.45
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 23 May 2008 15:18:46 -0700 (PDT)
Message-ID: <483742C6.2020804@gmail.com>
Date: Fri, 23 May 2008 18:18:46 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: How to return entire resultset which includes the highlighted
 keywords
References: <17354272.post@talk.nabble.com> <483425FF.805@gmail.com> <17427121.post@talk.nabble.com>
In-Reply-To: <17427121.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

A TokenStream can only be read once unless you wrap it with a 
CachingTokenFilter and call reset between uses. So thats what you should do.

- Mark

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34165-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 23 22:26:18 2008
Return-Path: <java-user-return-34165-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36204 invoked from network); 23 May 2008 22:26:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 May 2008 22:26:17 -0000
Received: (qmail 96667 invoked by uid 500); 23 May 2008 22:26:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96643 invoked by uid 500); 23 May 2008 22:26:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96632 invoked by uid 99); 23 May 2008 22:26:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 15:26:13 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 22:25:19 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Jzfhl-0000LF-2n
	for java-user@lucene.apache.org; Fri, 23 May 2008 15:25:41 -0700
Message-ID: <17442008.post@talk.nabble.com>
Date: Fri, 23 May 2008 15:25:41 -0700 (PDT)
From: syedfa <fayyazuddin@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to return entire resultset which includes the highlighted
 keywords
In-Reply-To: <483742C6.2020804@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fayyazuddin@gmail.com
References: <17354272.post@talk.nabble.com> <483425FF.805@gmail.com> <17427121.post@talk.nabble.com> <483742C6.2020804@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks for your reply, can you give an example of how this is done?

Sincerely;
Fayyaz


markrmiller wrote:
> 
> A TokenStream can only be read once unless you wrap it with a 
> CachingTokenFilter and call reset between uses. So thats what you should
> do.
> 
> - Mark
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/How-to-return-entire-resultset-which-includes-the-highlighted-keywords-tp17354272p17442008.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34166-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 23 22:40:05 2008
Return-Path: <java-user-return-34166-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38446 invoked from network); 23 May 2008 22:40:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 May 2008 22:40:05 -0000
Received: (qmail 10145 invoked by uid 500); 23 May 2008 22:39:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10121 invoked by uid 500); 23 May 2008 22:39:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10110 invoked by uid 99); 23 May 2008 22:39:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 15:39:59 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [69.89.20.232] (HELO outbound-mail-17.bluehost.com) (69.89.20.232)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 23 May 2008 22:39:11 +0000
Received: (qmail 26945 invoked by uid 0); 23 May 2008 22:39:24 -0000
Received: from unknown (HELO box108.bluehost.com) (69.89.22.108)
  by outboundproxy1.bluehost.com with SMTP; 23 May 2008 22:39:24 -0000
Received: from c-71-204-121-58.hsd1.ga.comcast.net ([71.204.121.58] helo=[10.0.1.200])
	by box108.bluehost.com with esmtpsa (TLSv1:AES128-SHA:128)
	(Exim 4.68)
	(envelope-from <emmanuel@hibernate.org>)
	id 1Jzfv2-0004vI-J8; Fri, 23 May 2008 16:39:24 -0600
Cc: java-user@lucene.apache.org
Message-Id: <25DFC494-499E-4EFF-8CDA-FD3EB7032357@hibernate.org>
From: Emmanuel Bernard <emmanuel@hibernate.org>
To: Stephane Nicoll <stephane.nicoll@gmail.com>
In-Reply-To: <541f12ca0805120313y302ece2cu374d25e378bc45e2@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: confused about an entry in the FAQ
Date: Fri, 23 May 2008 18:39:22 -0400
References: <541f12ca0805100635sf9629abs4cb9b8c0f41f6a79@mail.gmail.com> <48b038c60805101105q767968a2sc9de677130100742@mail.gmail.com> <541f12ca0805120313y302ece2cu374d25e378bc45e2@mail.gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Identified-User: {1307:box108.bluehost.com:emmanue2:emmanuelbernard.com} {sentby:smtp auth 71.204.121.58 authed with oss+emmanuelbernard.com}
DomainKey-Status: no signature
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Stephane
Can you tell me a bit more about the deadlocks you experience with  
Hibernate Search. I have not seen such a situation so far and am  
interested to see how to fix the problem.

Emmanuel

On  May 12, 2008, at 06:13, Stephane Nicoll wrote:

> Hibernate Search introduces deadlock with multiple threads and the
> lucene integration in spring modules does not seeem to do what I want.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34167-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 23 22:42:23 2008
Return-Path: <java-user-return-34167-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39111 invoked from network); 23 May 2008 22:42:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 May 2008 22:42:22 -0000
Received: (qmail 14233 invoked by uid 500); 23 May 2008 22:42:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13573 invoked by uid 500); 23 May 2008 22:42:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13562 invoked by uid 99); 23 May 2008 22:42:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 15:42:17 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [67.222.39.34] (HELO outbound-mail-154.bluehost.com) (67.222.39.34)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 23 May 2008 22:41:20 +0000
Received: (qmail 20335 invoked by uid 0); 23 May 2008 22:41:40 -0000
Received: from unknown (HELO box108.bluehost.com) (69.89.22.108)
  by outboundproxy5.bluehost.com with SMTP; 23 May 2008 22:41:40 -0000
Received: from c-71-204-121-58.hsd1.ga.comcast.net ([71.204.121.58] helo=[10.0.1.200])
	by box108.bluehost.com with esmtpsa (TLSv1:AES128-SHA:128)
	(Exim 4.68)
	(envelope-from <emmanuel@hibernate.org>)
	id 1JzfxD-0005Jc-PP
	for java-user@lucene.apache.org; Fri, 23 May 2008 16:41:39 -0600
Message-Id: <50386E70-FC3D-4379-A988-E4AC3BFB0C0E@hibernate.org>
From: Emmanuel Bernard <emmanuel@hibernate.org>
To: java-user@lucene.apache.org
In-Reply-To: <620720.42018.qm@web50303.mail.re2.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Improving search performance
Date: Fri, 23 May 2008 18:41:36 -0400
References: <620720.42018.qm@web50303.mail.re2.yahoo.com>
X-Mailer: Apple Mail (2.919.2)
X-Identified-User: {1307:box108.bluehost.com:emmanue2:emmanuelbernard.com} {sentby:smtp auth 71.204.121.58 authed with oss+emmanuelbernard.com}
DomainKey-Status: no signature
X-Virus-Checked: Checked by ClamAV on apache.org

Hi
Hibernate Search does not pool the Searcher but pools the underlying  
IndexReader(s). From what i've seen, a Searcher is stateless and all  
the state is kept in the Readers. so this essentially is equivalent to  
reusing the searcher.

Out of curiosity why is a pool of Searcher more efficient?

Emmanuel

On  May 22, 2008, at 13:22, Otis Gospodnetic wrote:

> Some quick feedback.  Those are all very expensive queries  
> (wildcards and ranges).  The first thing I'd do is try without  
> Hibernate Search (to make sure HS is not the bottleneck).  100  
> threads is a lot, I'm guessing you are reusing your searcher, which  
> is good, but you will actually improve performance a bit if you work  
> with a small pool of searchers instead of a single searcher.
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
>> From: Rakesh Shete <rakesh_shete@hotmail.com>
>> To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
>> Sent: Thursday, May 22, 2008 1:16:13 PM
>> Subject: Improving search performance
>>
>>
>> Hi all,
>>
>> I have index of size 85MB. My query looks as follows:
>>
>> +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr: 
>> [20080410 TO
>> 20081010] +rT:[002 TO 005]
>>
>> All the fields used in the query are stored in the indexes (Indexed  
>> & Stored)
>>
>> The query response time for me is around 30 seconds when running  
>> mutliple
>> simultanoeous threads (~100). The no. of matches is ~30k but I  
>> retrieve only the
>> top 100 results. I am using Hibernate Search which is a wrapper  
>> around Lucene. I
>> retrieve the "id" filed from the index which is also indexex and  
>> stored.
>>
>> What is the approach that I should take for improving the  
>> performance?
>>
>> Will just indexing the values without storing them work (Index &  
>> UnStored)?
>>
>> My machine configuration is:
>> P4 2.66GHz 1.99 GB RAM
>>
>> The code for searching runs in JBoss application server which has a  
>> maximum heap
>> size of 1024MB. When these 100 threads are running in the  
>> application server the
>> CPU utilization is 100% and JBoss consumes all of the heap size.
>>
>> Any pointers on index optimization would be really appreciated.
>>
>> --Regards,
>> Rakesh Shete
>>
>> _________________________________________________________________
>> No Harvard, No Oxford. We are here. Find out !!
>> http://ss1.richmedia.in/recurl.asp?pid=500
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34168-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 24 00:56:56 2008
Return-Path: <java-user-return-34168-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70901 invoked from network); 24 May 2008 00:56:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 May 2008 00:56:55 -0000
Received: (qmail 84108 invoked by uid 500); 24 May 2008 00:56:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84081 invoked by uid 500); 24 May 2008 00:56:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84070 invoked by uid 99); 24 May 2008 00:56:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 17:56:51 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.146.176 as permitted sender)
Received: from [209.85.146.176] (HELO wa-out-1112.google.com) (209.85.146.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 00:56:04 +0000
Received: by wa-out-1112.google.com with SMTP id l24so845492waf.11
        for <java-user@lucene.apache.org>; Fri, 23 May 2008 17:56:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=wNsieKje+MaraCRrsjyRC9fGyNLE3IXqdeGhWvidK5o=;
        b=pJQXret3H9oDSHo9ldUgCpWzJqxdLDhRXgg5suDfsQYLSpMsPyF3YptKTZ7UrUyy+Y5bPC4wR9RfwUsHxW+KkEkYtSbo0JrxC33PXiVvaXWdsfBs1ICmjFqixtYBusTn4YyF0kqNzjzYQmMT0Hf1SRdXV2WRL+ZOUyFb0GzbX1o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=D/FQiRL2OG7WN+RCpFfSEJsf2AwoYfZ1NH7eA09kAT5Ru4yzn3QVZxJSn8gdYreq62DCmPT08DclXhjk2sRrHIfS5pQUOyKwhrFVjBbRgMbXBtyPLCRYv3aeMDMjoM+IUe6OntxcRzFPVinhOP8p8amQL2at6VIAvzK+EFv1gw0=
Received: by 10.114.144.1 with SMTP id r1mr2511698wad.140.1211590580353;
        Fri, 23 May 2008 17:56:20 -0700 (PDT)
Received: by 10.115.17.5 with HTTP; Fri, 23 May 2008 17:56:20 -0700 (PDT)
Message-ID: <c68e39170805231756v31feb891sde92f132c23cf631@mail.gmail.com>
Date: Fri, 23 May 2008 20:56:20 -0400
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: Improving search performance
In-Reply-To: <50386E70-FC3D-4379-A988-E4AC3BFB0C0E@hibernate.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <620720.42018.qm@web50303.mail.re2.yahoo.com>
	 <50386E70-FC3D-4379-A988-E4AC3BFB0C0E@hibernate.org>
X-Google-Sender-Auth: 9fe7db04d9f99951
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, May 23, 2008 at 6:41 PM, Emmanuel Bernard
<emmanuel@hibernate.org> wrote:
> From what i've seen, a Searcher is stateless and all the
> state is kept in the Readers. so this essentially is equivalent to reusing
> the searcher.

You're right, for a normal IndexSearcher, caching the Searcher is
pretty equivalent to caching the IndexReader.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34169-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 24 01:47:31 2008
Return-Path: <java-user-return-34169-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90304 invoked from network); 24 May 2008 01:47:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 May 2008 01:47:31 -0000
Received: (qmail 6698 invoked by uid 500); 24 May 2008 01:47:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6663 invoked by uid 500); 24 May 2008 01:47:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6652 invoked by uid 99); 24 May 2008 01:47:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 18:47:26 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 01:46:38 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JziqU-0006Uy-Ax
	for java-user@lucene.apache.org; Fri, 23 May 2008 18:46:54 -0700
Message-ID: <17443570.post@talk.nabble.com>
Date: Fri, 23 May 2008 18:46:54 -0700 (PDT)
From: sairam123 <sanjay.pattnaik@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Indexing the ORACLE using lucene
In-Reply-To: <20070511172017.M17413@www.botspiritcompany.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sanjay.pattnaik@gmail.com
References: <0EBBD6FA3D0E7F4385D69764942C752E181962AD@HS-MAILSVR.Virtusa.com> <359a92830705110602p2b7889bo1d207e9a2b6f45ed@mail.gmail.com> <20070511172017.M17413@www.botspiritcompany.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I could able to create create the index . However, when i am trying to
search, i am hitting 0.

Environment : Windows
DB : Oracle 
-> I have created a directory called : c://dbindex. I am seeing the indexes
are created.
My sql Query fetches just one row 
select id, CSC_SITE_ID, ADDRESS1,CITY, STATE from WIPS_ADDRESSES where
csc_site_id = 41813612;

Result :
41813612	BUIDING 2166 12TH LGGETTE	FORT LEWIS	WA

-> I have created another directory called c://qa//a.query where I have an
entry called
FORT LEWIS
Also, tried with 41813612
I am not hitting any result.

Please let me know what is going wrong.

Please explain more on this syntax :

SearchFiles 
      [-index dir]    ** This is index directory
      [-field f]        ** Are these fileds same as filed in the table
      [-repeat n]     ** Please throw more lights on this
      [-queries file]  ** Do I have to copy paste the sql query or the
result i am expecting 
      [-raw]           ** What is this
      [-norms field]";  ** What is this

I am attaching both the 
 




http://www.nabble.com/file/p17443570/SearchDatabase.java SearchDatabase.java 
http://www.nabble.com/file/p17443570/SearchDatabase.java SearchDatabase.java 
http://www.nabble.com/file/p17443570/IndexDatabase.java IndexDatabase.java 
-- 
View this message in context: http://www.nabble.com/Indexing-the-ORACLE-using-lucene-tp10429479p17443570.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34170-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 24 03:24:44 2008
Return-Path: <java-user-return-34170-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7862 invoked from network); 24 May 2008 03:24:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 May 2008 03:24:44 -0000
Received: (qmail 59394 invoked by uid 500); 24 May 2008 03:24:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59369 invoked by uid 500); 24 May 2008 03:24:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59358 invoked by uid 99); 24 May 2008 03:24:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 20:24:38 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.243] (HELO web50310.mail.re2.yahoo.com) (206.190.38.243)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 24 May 2008 03:23:42 +0000
Received: (qmail 56882 invoked by uid 60001); 24 May 2008 03:24:03 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=JZ2hgbB5elH0DrRWbf0dsjdpPRdBOchw0WIdomkBEUdGZdIyHTqywwXoqmXScd66bmdW6pl5+qP656SYtPbGM48M4K+/l53dOoQN396/QUtAsuH95BQL7t8OJEThhxFx5A6YexG+ItbPkRqrhthfIhQ5AqB2xkjVuTbYi3hwzRY=;
Received: from [72.231.9.236] by web50310.mail.re2.yahoo.com via HTTP; Fri, 23 May 2008 20:24:03 PDT
X-Mailer: YahooMailRC/975.41 YahooMailWebService/0.7.199
Date: Fri, 23 May 2008 20:24:03 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Improving search performance
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <822105.56332.qm@web50310.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Emmanuel,

Because there are some synchronized methods, like the one that checks whether a doc is deleted, that get called during search.  If you have a pile of threads (op. p. mentioned 100 threads) there could be contention around those methods.

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: Emmanuel Bernard <emmanuel@hibernate.org>
> To: java-user@lucene.apache.org
> Sent: Friday, May 23, 2008 6:41:36 PM
> Subject: Re: Improving search performance
> 
> Hi
> Hibernate Search does not pool the Searcher but pools the underlying  
> IndexReader(s). From what i've seen, a Searcher is stateless and all  
> the state is kept in the Readers. so this essentially is equivalent to  
> reusing the searcher.
> 
> Out of curiosity why is a pool of Searcher more efficient?
> 
> Emmanuel
> 
> On  May 22, 2008, at 13:22, Otis Gospodnetic wrote:
> 
> > Some quick feedback.  Those are all very expensive queries  
> > (wildcards and ranges).  The first thing I'd do is try without  
> > Hibernate Search (to make sure HS is not the bottleneck).  100  
> > threads is a lot, I'm guessing you are reusing your searcher, which  
> > is good, but you will actually improve performance a bit if you work  
> > with a small pool of searchers instead of a single searcher.
> >
> > Otis
> > --
> > Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
> >
> >
> > ----- Original Message ----
> >> From: Rakesh Shete 
> >> To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
> >> Sent: Thursday, May 22, 2008 1:16:13 PM
> >> Subject: Improving search performance
> >>
> >>
> >> Hi all,
> >>
> >> I have index of size 85MB. My query looks as follows:
> >>
> >> +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr: 
> >> [20080410 TO
> >> 20081010] +rT:[002 TO 005]
> >>
> >> All the fields used in the query are stored in the indexes (Indexed  
> >> & Stored)
> >>
> >> The query response time for me is around 30 seconds when running  
> >> mutliple
> >> simultanoeous threads (~100). The no. of matches is ~30k but I  
> >> retrieve only the
> >> top 100 results. I am using Hibernate Search which is a wrapper  
> >> around Lucene. I
> >> retrieve the "id" filed from the index which is also indexex and  
> >> stored.
> >>
> >> What is the approach that I should take for improving the  
> >> performance?
> >>
> >> Will just indexing the values without storing them work (Index &  
> >> UnStored)?
> >>
> >> My machine configuration is:
> >> P4 2.66GHz 1.99 GB RAM
> >>
> >> The code for searching runs in JBoss application server which has a  
> >> maximum heap
> >> size of 1024MB. When these 100 threads are running in the  
> >> application server the
> >> CPU utilization is 100% and JBoss consumes all of the heap size.
> >>
> >> Any pointers on index optimization would be really appreciated.
> >>
> >> --Regards,
> >> Rakesh Shete
> >>
> >> _________________________________________________________________
> >> No Harvard, No Oxford. We are here. Find out !!
> >> http://ss1.richmedia.in/recurl.asp?pid=500
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34171-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 24 04:25:19 2008
Return-Path: <java-user-return-34171-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16069 invoked from network); 24 May 2008 04:25:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 May 2008 04:25:19 -0000
Received: (qmail 72295 invoked by uid 500); 24 May 2008 04:25:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72265 invoked by uid 500); 24 May 2008 04:25:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72254 invoked by uid 99); 24 May 2008 04:25:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 May 2008 21:25:13 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 04:24:26 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1JzlJC-0002bo-CD
	for java-user@lucene.apache.org; Fri, 23 May 2008 21:24:42 -0700
Message-ID: <17444292.post@talk.nabble.com>
Date: Fri, 23 May 2008 21:24:42 -0700 (PDT)
From: syedfa <fayyazuddin@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to return entire resultset which includes the highlighted
 keywords
In-Reply-To: <483742C6.2020804@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fayyazuddin@gmail.com
References: <17354272.post@talk.nabble.com> <483425FF.805@gmail.com> <17427121.post@talk.nabble.com> <483742C6.2020804@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Dear Mr.Miller:

I figured out how to use the CachingTokenFilter and it worked exactly as you
described.  Thanks so much once again for sharing your time and expertise! 
:-)

All the best.
Sincerely;
Fayyaz



markrmiller wrote:
> 
> A TokenStream can only be read once unless you wrap it with a 
> CachingTokenFilter and call reset between uses. So thats what you should
> do.
> 
> - Mark
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/How-to-return-entire-resultset-which-includes-the-highlighted-keywords-tp17354272p17444292.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34172-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 24 08:59:25 2008
Return-Path: <java-user-return-34172-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65198 invoked from network); 24 May 2008 08:59:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 May 2008 08:59:25 -0000
Received: (qmail 41781 invoked by uid 500); 24 May 2008 08:59:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41747 invoked by uid 500); 24 May 2008 08:59:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41736 invoked by uid 99); 24 May 2008 08:59:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 01:59:20 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stephane.nicoll@gmail.com designates 209.85.132.250 as permitted sender)
Received: from [209.85.132.250] (HELO an-out-0708.google.com) (209.85.132.250)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 08:58:34 +0000
Received: by an-out-0708.google.com with SMTP id c37so243326anc.49
        for <java-user@lucene.apache.org>; Sat, 24 May 2008 01:58:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=UK9PX9DgqH7gUVUwkXVl1qwo06TgH1pFovP87iKUG0Q=;
        b=J4NMIPRBep6xSUEvwQXrNx4bHHewh8HE0PUrGcE5L8Dm8vOjZ60ECefu95UYtcM+gLW/VUH8CZS0NrqMJe62UX8PfAPOpv6m8+MchmWzoJz5Yi9MfB6wcZpzLVOFCiaggn7sZ8VMwQzB7aV0r2iuqHyR90trRk1Rd0YL/+EyF4E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=NNGg5J+c0Gd06ZqAcbeo1QyAoFFnuYRtsu58QM1vdbqF5mOpZqBFMlx7gmiaIgj02huZyAHWXKsNzBi7saRrb+S8lKltwI349WeGx0UFpnK4pG7NxKNN8qonBxaOzzySh0aB3x/myJdbEORL4ySPk/kkMR1o+fDwBoMyBDAF5lg=
Received: by 10.100.37.20 with SMTP id k20mr323631ank.5.1211619530491;
        Sat, 24 May 2008 01:58:50 -0700 (PDT)
Received: by 10.100.178.12 with HTTP; Sat, 24 May 2008 01:58:50 -0700 (PDT)
Message-ID: <541f12ca0805240158m63c62e51x757c322596135eba@mail.gmail.com>
Date: Sat, 24 May 2008 10:58:50 +0200
From: "Stephane Nicoll" <stephane.nicoll@gmail.com>
To: "Emmanuel Bernard" <emmanuel@hibernate.org>
Subject: Re: confused about an entry in the FAQ
Cc: java-user@lucene.apache.org
In-Reply-To: <25DFC494-499E-4EFF-8CDA-FD3EB7032357@hibernate.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
References: <541f12ca0805100635sf9629abs4cb9b8c0f41f6a79@mail.gmail.com>
	 <48b038c60805101105q767968a2sc9de677130100742@mail.gmail.com>
	 <541f12ca0805120313y302ece2cu374d25e378bc45e2@mail.gmail.com>
	 <25DFC494-499E-4EFF-8CDA-FD3EB7032357@hibernate.org>
X-Virus-Checked: Checked by ClamAV on apache.org

On Sat, May 24, 2008 at 12:39 AM, Emmanuel Bernard
<emmanuel@hibernate.org> wrote:
> Hi Stephane
> Can you tell me a bit more about the deadlocks you experience with Hibern=
ate
> Search. I have not seen such a situation so far and am interested to see =
how
> to fix the problem.

It is hard to externalize a unit test since it relies on many factor.
You need to have a significant amount of data (100.000 documents) and
you need to browse all results in the lucene index (15.000 results for
a typicial query in my case). I still don't find any optimized
solution to do this even if I only need one field from the search
result and the index is 5MB. I could put that into memory but that's
not a viable solution mid-term.

I've stopped using lucene. I am using sql like for now and we are
investigating Oracle Text and postigs test extension.

If anyone has an idea, i'm interested. For instance, knowing that the
IDs I got from the database are < 500, would it be reasonable to build
a lucene query like

"my search query  AND (id IN (the list of 500 ids)" <- will this hit
the toomanyclausesexception? How can I build such a query efficently?

Thanks,
St=E9phane


>
> Emmanuel
>
> On  May 12, 2008, at 06:13, Stephane Nicoll wrote:
>
>> Hibernate Search introduces deadlock with multiple threads and the
>> lucene integration in spring modules does not seeem to do what I want.
>
>



--=20
Large Systems Suck: This rule is 100% transitive. If you build one,
you suck" -- S.Yegge

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34173-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 24 09:16:29 2008
Return-Path: <java-user-return-34173-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68015 invoked from network); 24 May 2008 09:16:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 May 2008 09:16:29 -0000
Received: (qmail 48348 invoked by uid 500); 24 May 2008 09:16:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48315 invoked by uid 500); 24 May 2008 09:16:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48304 invoked by uid 99); 24 May 2008 09:16:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 02:16:23 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.171] (HELO wf-out-1314.google.com) (209.85.200.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 09:15:34 +0000
Received: by wf-out-1314.google.com with SMTP id 28so877638wfc.20
        for <java-user@lucene.apache.org>; Sat, 24 May 2008 02:15:45 -0700 (PDT)
Received: by 10.142.155.4 with SMTP id c4mr115626wfe.208.1211620545561;
        Sat, 24 May 2008 02:15:45 -0700 (PDT)
Received: from ?192.168.1.98? ( [124.191.72.31])
        by mx.google.com with ESMTPS id 20sm12035680wfi.11.2008.05.24.02.15.43
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 24 May 2008 02:15:44 -0700 (PDT)
Message-ID: <4837DCBA.8030806@holsman.net>
Date: Sat, 24 May 2008 19:15:38 +1000
From: "Ian Holsman (Lists)" <lists@holsman.net>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Postcode/zipcode search
References: <463477.55913.qm@web26008.mail.ukl.yahoo.com>
In-Reply-To: <463477.55913.qm@web26008.mail.ukl.yahoo.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

have you had a look at WOEID's ?
https://developer.yahoo.com/geo/


http://where.yahooapis.com/v1/places.q('NW10%207NY')
gives you details about the postcode, as well as a lat/long bounding box 
and the 'real' name of it (Willesden) in this case.

http://where.yahooapis.com/v1/place/26556102/neighbors

gives you the neighbors to it
http://where.yahooapis.com/v1/place/26556102/siblings
gives you it's children.
and
http://where.yahooapis.com/v1/place/26556102/parent?select=long
gives you 1 level up. (NW2 4) apparently.


So I'm guessing you could use 2 calls. 1 to get the WOEID of what the 
user has entered. the 2nd to get the siblings. using that you can 
construct a query to get all the entries in NW10 7NY.


(note: I don't work for yahoo, but work with people who used to)

mark harwood wrote:
> Can you not convert all postcodes to coordinates and do actual distance-based matching?
> 
> You will have to pay Royal Mail or 3rd party suppliers to get hold of the PAF data required for this geocoding (despite having funded this already as a UK tax payer- grrrr)
> 
> Cheers
> Mark
> 
> ----- Original Message ----
> From: Chris Mannion <chris.mannion@nonstopgov.com>
> To: java-user@lucene.apache.org
> Sent: Tuesday, 6 May, 2008 5:28:25 PM
> Subject: Postcode/zipcode search
> 
> Hi all
> 
> I've got a bit of a niggling problem with how one of my searches is working
> as opposed to how my users would like it too work.  We're indexing on UK
> postcodes, which are in the format of a 3 or 4 character area code followed
> by a 3 or 4 character street specific code, e.g. "NW10 7NY" or "M11 1LQ".
> We originally had the values being indexed as tokenized and used a very
> simple search string in the format "postcode:xxx xxx", with no grouping or
> boosting or fuzzy searching, just an straight search on whatever the user
> answered.  This had the benefit of finding exact matches to searches and
> allowing us to search just on the area part of the code to return all
> records with that area code, eg a search on "NW2" returning anything
> starting NW2, like "NW2 6TB", "NW2 1ER" etc etc.
> 
> However, the downside to that was that searches could also return records
> only tenuously related to what was searched for, eg. a search for "NW10 7NY"
> would also return a record with a postcode "SE9 6NY" because of the slight
> match of the "NY".  Obviously this was technically correct but users
> complained because their searches were returning records from completely
> different areas.  Our first step to put this right was to take off the
> tokenization of the field, which we also weren't happy with so have
> continued to fiddle.
> 
> The current status is as follows - we index the values by stripping out
> spaces and tokeniing them and use a keywordAnalyzer.  In searching we also
> strip spaces from the search term entered and search with a
> keywordAnalyzer.  Searches for full postcodes, e.g. "NW10 7NY" find all
> exact matches but also any full values that are partial matches (e.g. some
> records just have "NW10" as their postcode field and the "NW10 7NY" search
> pulls them back too), but searches for partial postcodes e.g. "NW10" still
> only finds exact matches, e.g. it only pulls back those record that have
> just "NW10" as their postcode, rather than anything *starting* with NW10 as
> we'd like it to do.
> 
> Can anyone help me get this working in the way we need it too please?
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34174-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 24 10:42:08 2008
Return-Path: <java-user-return-34174-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78316 invoked from network); 24 May 2008 10:42:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 May 2008 10:42:08 -0000
Received: (qmail 79929 invoked by uid 500); 24 May 2008 10:42:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79892 invoked by uid 500); 24 May 2008 10:42:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79880 invoked by uid 99); 24 May 2008 10:42:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 03:42:02 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [217.41.57.100] (HELO 2ls.com) (217.41.57.100)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 10:41:15 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: Is it possible to add multiple keywords to a single field from one doc?
X-MimeOLE: Produced By Microsoft Exchange V6.5
Date: Sat, 24 May 2008 11:41:28 +0100
Message-ID: <562BCF4FF1D14343BC81378BA0050AD90AB7FB@SBS2003.2LSHQ.local>
In-Reply-To: <85d3c3b60805221440l1d8cdec8jda1d2eab65871cad@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Is it possible to add multiple keywords to a single field from one doc?
Thread-Index: Aci8VI7AJH2oMcTTRcuKvMdVj4mmFgBNa+Eg
From: "Tom Conlon" <tomc@2ls.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I haven't been able to find the answer to this question easily=20
so any help would be appreciated.

Thanks,
Tom

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34175-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 24 15:22:23 2008
Return-Path: <java-user-return-34175-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80923 invoked from network); 24 May 2008 15:22:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 May 2008 15:22:23 -0000
Received: (qmail 28923 invoked by uid 500); 24 May 2008 15:22:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28767 invoked by uid 500); 24 May 2008 15:22:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28756 invoked by uid 99); 24 May 2008 15:22:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 08:22:17 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.198.233 as permitted sender)
Received: from [209.85.198.233] (HELO rv-out-0506.google.com) (209.85.198.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 15:21:27 +0000
Received: by rv-out-0506.google.com with SMTP id f6so1193771rvb.5
        for <java-user@lucene.apache.org>; Sat, 24 May 2008 08:21:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=PrE2hM2gqBBAVc3d5zPcY5qpJtmO8p9fCQ9qlvRJgjE=;
        b=S5eMiaXg14FL3Js2rxI7a/Gzw4kD2HJrQejpxB4xYNfBXE4sANMFgwn6l0YCCG/pLC8eq1omVIVbsfr+ULhPxyQorHuf0HUuQOtrfa+gQy1/lQA0d3SyWzy6GdVjkZl9j1nM04EKQPLfoCL3/+uRoraYoOj8nLKs4xdKCp1s4EI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=uy2IVO7Cq9iwzLX3jG1QAgA48qNZfVW/pudFqwidiftwzH20YM/lP4fyBNVYgEcq5Vgo2rO/jNIUtTKJbrizyaPiVhsbbviFMXXHveO94L24ws1txjBuUxD3k/82JjI0I+zFy8UJVnOWJ6W8RNOb1Hokt7hIdngPyieCBeAfb/g=
Received: by 10.141.86.14 with SMTP id o14mr1244460rvl.148.1211642503271;
        Sat, 24 May 2008 08:21:43 -0700 (PDT)
Received: by 10.140.188.20 with HTTP; Sat, 24 May 2008 08:21:43 -0700 (PDT)
Message-ID: <85d3c3b60805240821s551061s315340dc377414d5@mail.gmail.com>
Date: Sat, 24 May 2008 11:21:43 -0400
From: "Jason Rutherglen" <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Improving search performance
In-Reply-To: <822105.56332.qm@web50310.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1622_15590384.1211642503276"
References: <822105.56332.qm@web50310.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1622_15590384.1211642503276
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

There needs to be a solution to that problem.  I noticed it several years
ago which is why ever since have designed systems using MultiSearcher
concepts.  There should only be one instance of deleted docs per IndexReader
now that there is reopen.  Editing the live deleted docs does not seem like
something most people do.  One should be able to delete docs, flush, then
have to reopen to get the changes.  Or this should be one option by
extending SegmentReader.  Also think it is important to keep the ability to
delete docs using an open IndexReader rather than deprecate it because
realtime search systems cannot switch between IndexReaders and IndexWriters.

On Fri, May 23, 2008 at 11:24 PM, Otis Gospodnetic <
otis_gospodnetic@yahoo.com> wrote:

> Hi Emmanuel,
>
> Because there are some synchronized methods, like the one that checks
> whether a doc is deleted, that get called during search.  If you have a pile
> of threads (op. p. mentioned 100 threads) there could be contention around
> those methods.
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
> > From: Emmanuel Bernard <emmanuel@hibernate.org>
> > To: java-user@lucene.apache.org
> > Sent: Friday, May 23, 2008 6:41:36 PM
> > Subject: Re: Improving search performance
> >
> > Hi
> > Hibernate Search does not pool the Searcher but pools the underlying
> > IndexReader(s). From what i've seen, a Searcher is stateless and all
> > the state is kept in the Readers. so this essentially is equivalent to
> > reusing the searcher.
> >
> > Out of curiosity why is a pool of Searcher more efficient?
> >
> > Emmanuel
> >
> > On  May 22, 2008, at 13:22, Otis Gospodnetic wrote:
> >
> > > Some quick feedback.  Those are all very expensive queries
> > > (wildcards and ranges).  The first thing I'd do is try without
> > > Hibernate Search (to make sure HS is not the bottleneck).  100
> > > threads is a lot, I'm guessing you are reusing your searcher, which
> > > is good, but you will actually improve performance a bit if you work
> > > with a small pool of searchers instead of a single searcher.
> > >
> > > Otis
> > > --
> > > Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
> > >
> > >
> > > ----- Original Message ----
> > >> From: Rakesh Shete
> > >> To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
> > >> Sent: Thursday, May 22, 2008 1:16:13 PM
> > >> Subject: Improving search performance
> > >>
> > >>
> > >> Hi all,
> > >>
> > >> I have index of size 85MB. My query looks as follows:
> > >>
> > >> +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:
> > >> [20080410 TO
> > >> 20081010] +rT:[002 TO 005]
> > >>
> > >> All the fields used in the query are stored in the indexes (Indexed
> > >> & Stored)
> > >>
> > >> The query response time for me is around 30 seconds when running
> > >> mutliple
> > >> simultanoeous threads (~100). The no. of matches is ~30k but I
> > >> retrieve only the
> > >> top 100 results. I am using Hibernate Search which is a wrapper
> > >> around Lucene. I
> > >> retrieve the "id" filed from the index which is also indexex and
> > >> stored.
> > >>
> > >> What is the approach that I should take for improving the
> > >> performance?
> > >>
> > >> Will just indexing the values without storing them work (Index &
> > >> UnStored)?
> > >>
> > >> My machine configuration is:
> > >> P4 2.66GHz 1.99 GB RAM
> > >>
> > >> The code for searching runs in JBoss application server which has a
> > >> maximum heap
> > >> size of 1024MB. When these 100 threads are running in the
> > >> application server the
> > >> CPU utilization is 100% and JBoss consumes all of the heap size.
> > >>
> > >> Any pointers on index optimization would be really appreciated.
> > >>
> > >> --Regards,
> > >> Rakesh Shete
> > >>
> > >> _________________________________________________________________
> > >> No Harvard, No Oxford. We are here. Find out !!
> > >> http://ss1.richmedia.in/recurl.asp?pid=500
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_1622_15590384.1211642503276--

From java-user-return-34176-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 24 15:53:13 2008
Return-Path: <java-user-return-34176-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93412 invoked from network); 24 May 2008 15:53:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 May 2008 15:53:13 -0000
Received: (qmail 45857 invoked by uid 500); 24 May 2008 15:53:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45828 invoked by uid 500); 24 May 2008 15:53:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45817 invoked by uid 99); 24 May 2008 15:53:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 08:53:07 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 64.233.166.183 as permitted sender)
Received: from [64.233.166.183] (HELO py-out-1112.google.com) (64.233.166.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 May 2008 15:52:20 +0000
Received: by py-out-1112.google.com with SMTP id z74so876300pyg.9
        for <java-user@lucene.apache.org>; Sat, 24 May 2008 08:52:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=DN7VUB8c+RntktXUkLWDTkxBPT8YJ7KLuUndZz+QTf0=;
        b=UV/twgNYGvg/ePVsSJTkEpXov0r6FUygzg4+CYzVUYnadCE2QPEWnrOOQ6L2NPG5831k6IkNpNugjygsr109IuqObz5JXoZpL3oB8VpV815EcZauqAhedDTzmqFxQuZnaQVfUbLNcPUIFleuA76AOmJTIWBg4zF3sNiEne3tEW0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=gF3QtShuH4UH5s4tHxrMHrWlB2ri9WZnCMEIpW9loNRXxCF6XaU3RsbbsJiXlWxCY+MMPHbtR6aPVdbDpPqkm1vQ44b4xbWB6T3ld/Ngrfx5252RDRY3Yy4oUZ731MMim6404PkXIgZOPidQFiJNVYVOrwSNUOhW+ZkuWXCWUY4=
Received: by 10.64.204.19 with SMTP id b19mr326681qbg.62.1211644355977;
        Sat, 24 May 2008 08:52:35 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id e15sm6192414qba.31.2008.05.24.08.52.34
        (version=SSLv3 cipher=RC4-MD5);
        Sat, 24 May 2008 08:52:34 -0700 (PDT)
Message-ID: <483839C1.2000307@gmail.com>
Date: Sat, 24 May 2008 11:52:33 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Is it possible to add multiple keywords to a single field from
 one doc?
References: <562BCF4FF1D14343BC81378BA0050AD90AB7FB@SBS2003.2LSHQ.local>
In-Reply-To: <562BCF4FF1D14343BC81378BA0050AD90AB7FB@SBS2003.2LSHQ.local>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Tom Conlon wrote:
> Hi,
>
> I haven't been able to find the answer to this question easily 
> so any help would be appreciated.
>
> Thanks,
> Tom
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   
Could you elaborate a bit Tom? Your question is not very clear. If by 
keywords, you mean terms, and instead of from one doc, you mean to one 
doc, then the answer is yes. But as phrased, I am not sure what the 
question is.

- Mark

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34177-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 25 08:47:13 2008
Return-Path: <java-user-return-34177-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75679 invoked from network); 25 May 2008 08:47:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 May 2008 08:47:13 -0000
Received: (qmail 34786 invoked by uid 500); 25 May 2008 08:47:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34753 invoked by uid 500); 25 May 2008 08:47:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34742 invoked by uid 99); 25 May 2008 08:47:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 May 2008 01:47:08 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rakesh_shete@hotmail.com designates 65.54.246.206 as permitted sender)
Received: from [65.54.246.206] (HELO bay0-omc3-s6.bay0.hotmail.com) (65.54.246.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 May 2008 08:46:11 +0000
Received: from BAY112-W26 ([64.4.26.126]) by bay0-omc3-s6.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Sun, 25 May 2008 01:46:32 -0700
Message-ID: <BAY112-W26256AC61ED1181DF3DB6EF9C30@phx.gbl>
Content-Type: multipart/mixed;
	boundary="_07bb8cc3-8d7e-403f-abc4-d9d88975b62b_"
X-Originating-IP: [125.99.82.185]
From: Rakesh Shete <rakesh_shete@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: RE: Improving search performance
Date: Sun, 25 May 2008 14:16:32 +0530
Importance: Normal
MIME-Version: 1.0
X-OriginalArrivalTime: 25 May 2008 08:46:32.0287 (UTC) FILETIME=[D4D4EEF0:01C8BE43]
X-Virus-Checked: Checked by ClamAV on apache.org

--_07bb8cc3-8d7e-403f-abc4-d9d88975b62b_
Content-Type: multipart/alternative;
	boundary="_6395d1a1-cb9b-428d-be49-0f8c52705986_"

--_6395d1a1-cb9b-428d-be49-0f8c52705986_
Content-Type: text/plain; charset="Windows-1252"
Content-Transfer-Encoding: quoted-printable


Hi Otis, Emmanuel


I have written a program to simulate the multi-thread behavior and check th=
e performance. I have attached the program and results.


The JVM parameters when running the program: -Xms128m -Xmx1028m on a P4 2.6=
6 Ghz, 1.99GB RAM machine.

Here are the observations:

1. The response time to fire a query and return back increases as the numbe=
r of threads increases: from 10-100 (I haven=92t used any threadpool. JVM d=
efault behavior is used)

2. After optimizing the index, the response time improved significantly. Li=
ke in case of 100 threads, the average response time, using optimized index=
, is between 1-1.3 seconds as compared to 4-5.5 seconds using the non-optim=
ized index

Is there anything else that I should be looking into to further improve the=
 performance?


-- Regards,

Rakesh S


> Date: Fri, 23 May 2008 20:24:03 -0700
> From: otis_gospodnetic@yahoo.com
> Subject: Re: Improving search performance
> To: java-user@lucene.apache.org
>
> Hi Emmanuel,
>
> Because there are some synchronized methods, like the one that checks whe=
ther a doc is deleted, that get called during search. If you have a pile of=
 threads (op. p. mentioned 100 threads) there could be contention around th=
ose methods.
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
>> From: Emmanuel Bernard
>> To: java-user@lucene.apache.org
>> Sent: Friday, May 23, 2008 6:41:36 PM
>> Subject: Re: Improving search performance
>>
>> Hi
>> Hibernate Search does not pool the Searcher but pools the underlying
>> IndexReader(s). From what i've seen, a Searcher is stateless and all
>> the state is kept in the Readers. so this essentially is equivalent to
>> reusing the searcher.
>>
>> Out of curiosity why is a pool of Searcher more efficient?
>>
>> Emmanuel
>>
>> On May 22, 2008, at 13:22, Otis Gospodnetic wrote:
>>
>>> Some quick feedback. Those are all very expensive queries
>>> (wildcards and ranges). The first thing I'd do is try without
>>> Hibernate Search (to make sure HS is not the bottleneck). 100
>>> threads is a lot, I'm guessing you are reusing your searcher, which
>>> is good, but you will actually improve performance a bit if you work
>>> with a small pool of searchers instead of a single searcher.
>>>
>>> Otis
>>> --
>>> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>>>
>>>
>>> ----- Original Message ----
>>>> From: Rakesh Shete
>>>> To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
>>>> Sent: Thursday, May 22, 2008 1:16:13 PM
>>>> Subject: Improving search performance
>>>>
>>>>
>>>> Hi all,
>>>>
>>>> I have index of size 85MB. My query looks as follows:
>>>>
>>>> +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:
>>>> [20080410 TO
>>>> 20081010] +rT:[002 TO 005]
>>>>
>>>> All the fields used in the query are stored in the indexes (Indexed
>>>> & Stored)
>>>>
>>>> The query response time for me is around 30 seconds when running
>>>> mutliple
>>>> simultanoeous threads (~100). The no. of matches is ~30k but I
>>>> retrieve only the
>>>> top 100 results. I am using Hibernate Search which is a wrapper
>>>> around Lucene. I
>>>> retrieve the "id" filed from the index which is also indexex and
>>>> stored.
>>>>
>>>> What is the approach that I should take for improving the
>>>> performance?
>>>>
>>>> Will just indexing the values without storing them work (Index &
>>>> UnStored)?
>>>>
>>>> My machine configuration is:
>>>> P4 2.66GHz 1.99 GB RAM
>>>>
>>>> The code for searching runs in JBoss application server which has a
>>>> maximum heap
>>>> size of 1024MB. When these 100 threads are running in the
>>>> application server the
>>>> CPU utilization is 100% and JBoss consumes all of the heap size.
>>>>
>>>> Any pointers on index optimization would be really appreciated.
>>>>
>>>> --Regards,
>>>> Rakesh Shete
>>>>
>>>> _________________________________________________________________
>>>> No Harvard, No Oxford. We are here. Find out !!
>>>> http://ss1.richmedia.in/recurl.asp?pid=3D500
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

_________________________________________________________________
Catch the latest fashion shows, get beauty tips and learn more on fashion a=
nd lifestyle.
http://video.msn.com/?mkt=3Den-in=

--_6395d1a1-cb9b-428d-be49-0f8c52705986_
Content-Type: text/html; charset="Windows-1252"
Content-Transfer-Encoding: quoted-printable

<html>
<head>
<style>
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
FONT-SIZE: 10pt;
FONT-FAMILY:Tahoma
}
</style>
</head>
<body class=3D'hmmessage'>
Hi Otis, Emmanuel


I have written a program to simulate the multi-thread behavior and check th=
e performance. I have attached the program and results.


The JVM parameters when running the program: -Xms128m -Xmx1028m on a P4 2.6=
6 Ghz, 1.99GB RAM machine.

Here are the observations:

1. The response time to fire a query and return back increases as the numbe=
r of threads increases: from 10-100 (I haven=92t used any threadpool. JVM d=
efault behavior is used)

2. After optimizing the index, the response time improved significantly. Li=
ke in case of 100 threads, the average response time, using optimized index=
, is between 1-1.3 seconds as compared to 4-5.5 seconds using the non-optim=
ized index

Is there anything else that I should be looking into to further improve the=
 performance?


-- Regards,

Rakesh S


> Date: Fri, 23 May 2008 20:24:03 -0700
> From: otis_gospodnetic@yahoo.com
> Subject: Re: Improving search performance
> To: java-user@lucene.apache.org
>
> Hi Emmanuel,
>
> Because there are some synchronized methods, like the one that checks whe=
ther a doc is deleted, that get called during search. If you have a pile of=
 threads (op. p. mentioned 100 threads) there could be contention around th=
ose methods.
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
>> From: Emmanuel Bernard
>> To: java-user@lucene.apache.org
>> Sent: Friday, May 23, 2008 6:41:36 PM
>> Subject: Re: Improving search performance
>>
>> Hi
>> Hibernate Search does not pool the Searcher but pools the underlying
>> IndexReader(s). From what i've seen, a Searcher is stateless and all
>> the state is kept in the Readers. so this essentially is equivalent to
>> reusing the searcher.
>>
>> Out of curiosity why is a pool of Searcher more efficient?
>>
>> Emmanuel
>>
>> On May 22, 2008, at 13:22, Otis Gospodnetic wrote:
>>
>>> Some quick feedback. Those are all very expensive queries
>>> (wildcards and ranges). The first thing I'd do is try without
>>> Hibernate Search (to make sure HS is not the bottleneck). 100
>>> threads is a lot, I'm guessing you are reusing your searcher, which
>>> is good, but you will actually improve performance a bit if you work
>>> with a small pool of searchers instead of a single searcher.
>>>
>>> Otis
>>> --
>>> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>>>
>>>
>>> ----- Original Message ----
>>>> From: Rakesh Shete
>>>> To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
>>>> Sent: Thursday, May 22, 2008 1:16:13 PM
>>>> Subject: Improving search performance
>>>>
>>>>
>>>> Hi all,
>>>>
>>>> I have index of size 85MB. My query looks as follows:
>>>>
>>>> +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:
>>>> [20080410 TO
>>>> 20081010] +rT:[002 TO 005]
>>>>
>>>> All the fields used in the query are stored in the indexes (Indexed
>>>> & Stored)
>>>>
>>>> The query response time for me is around 30 seconds when running
>>>> mutliple
>>>> simultanoeous threads (~100). The no. of matches is ~30k but I
>>>> retrieve only the
>>>> top 100 results. I am using Hibernate Search which is a wrapper
>>>> around Lucene. I
>>>> retrieve the "id" filed from the index which is also indexex and
>>>> stored.
>>>>
>>>> What is the approach that I should take for improving the
>>>> performance?
>>>>
>>>> Will just indexing the values without storing them work (Index &
>>>> UnStored)?
>>>>
>>>> My machine configuration is:
>>>> P4 2.66GHz 1.99 GB RAM
>>>>
>>>> The code for searching runs in JBoss application server which has a
>>>> maximum heap
>>>> size of 1024MB. When these 100 threads are running in the
>>>> application server the
>>>> CPU utilization is 100% and JBoss consumes all of the heap size.
>>>>
>>>> Any pointers on index optimization would be really appreciated.
>>>>
>>>> --Regards,
>>>> Rakesh Shete
>>>>
>>>> _________________________________________________________________
>>>> No Harvard, No Oxford. We are here. Find out !!
>>>> http://ss1.richmedia.in/recurl.asp?pid=3D500
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
<br /><hr />Live.in : Get your yourname@live.in email id today. Powered by =
Windows Live Hotmail. <a href=3D'http://get.live.com/' target=3D'_new'>Chec=
k it out!</a></body>
</html>=

--_6395d1a1-cb9b-428d-be49-0f8c52705986_--

--_07bb8cc3-8d7e-403f-abc4-d9d88975b62b_
Content-Type: application/zip
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="Performance logs.zip"

UEsDBBQAAAAIACebuDhFShwTYgUAAEARAAAaAAAAVGVzdFNlYXJjaFBlcmZvcm1hbmNlLmphdmG1
V1tPGzkUfh4k/sNR9mUCqZOgIlVhK5XSVhsJBF2yF6kXZGZM4mViJ7YHaCv++x5fJvEM08B2dx9g
ZuzvXP2d45P+zs72FuzACf0Ce897sDcYvOjBcPR8ONrfh7MTu+kAE6bNOaMqm50xdSXVnIqMkb/o
DbXb/e2tBc2u6ZRBUWZMMLJYow62t7a3+HwhlQErQLgk49O3dxlbGC5FvC3VlFDUNGMk6KGCFl80
10QbKnKqcnIeXg7tzlemDjZIc5GzO3IklSoXZmw/YrOPiDn8H4qbzTaWJVNfzqjSTBH3eJKJWOr9
+n2TiHbpJ6+lLBgVTugJ8F+40U+AuWD9AT/Ji8fNG6kYOZbZ9emloVy8o7xgef3Ut7f6gX9HBdUa
jASDPANvAyIOOdArWpqZVKDoNdOzCz1jhlUEtQwsLwueQeZUtfIVvm1vJQFWCxh47esliLIoDixY
8RtqGCD7DAqdG8XFFNzh+ffho2Cn+oya2aNIiZmZ868sH7eIeKgNIKlpZLdBPO28GfXfH168LnmR
X9hCHuwP9/vH7jicRqb73D87XasyaTf4iMaLldRG3c0cRVp309SMPnZsL4BLqfXHzue9ARmAXbaL
O2BGdn2n+3n4ggy6XUjzJp7sIzwP8LyC7wV0Ez4kLyx8hV8JDMlzK2CmDwT2rDvTyp/pWmCw30WR
XW1GNDOwKwzPRwMf9D3+rRkWDvdG8hzmWAGpj//DJ6BqqrtgZkreamjtTj2IOqSjbdLvV4kPCU99
ovt908b1dMUSD2sHPWSAR6+DcRWaYPW9K0XmvNlUpYmrxCa/XQraHYiLZGHNPz0tLivtdW50oFzr
tkucTx0cKWYdpQJdsFcMCsurRnPA+wZKzYAbBAG7QWKH4F1iNXnQPdByTUW6js+lFz0BXEN9iB4e
4ONnfA4G+La72/XnHXtnk8Jo7jzh4kZeW2ccqLIw8QBd/3yJmSCu9GrrKe/ZjbhE3UItDu9pUtdo
r2FlAvPu1yyJiRJsI02QpVlpaVAlq84O36kbEbA7w0SuKy3fAhtXQjZrPhvj/CDeeNiba9st/V6v
r7vKig/CRjEW3HBaYG3ALcfG6G0+43nPm9DORK+uycv2nV3fBJqJj7zvtbjc23QvVcQwM5yHKi32
jON0+N1IJQKaOfGYmueI4o0RwB9wIy2vNGN+iiuomJJfSyHoZcF+UqVIuw/Dd5Xv9oLv3jwWkP9M
otkHlotQO9Fi2jGdnocmib9E6uNf2g1ETZYLHE7MsbxlKqN2DFsgkuUTpuY6NapkVdm70nLqMXXM
ZyfyBpY2ZQuysIg0yl1liF9Bulz1C2wX8UhWBZokaVpfX3arOBLr6Am9w6kH+8qRLIVJx8KwKQ6D
J4d/Xvx+ePzb28ravX/4/4XEA3U1iD6eIwnZnGSlUkyYCZ+zE14UvLoYXJjnqz6VJHYUhBl3zbF2
+GGoS5eVoDNjpKGF1brRFDzz/gTJAJSlIVh5whQi7XwIxYzFAyPowO6KsfjagU8wsZbAWFMGZzsB
tj+G64XrSmblDgrNdahKJykksV17Tk02s4xXLJMqrwRtxKRgYmpmK7L4pGZWANL61A5sdYSYv8np
m1M4LI18NsVRR2EnycGLXRY42/6LoD0B12ZtzHHZeqEW+jFvBAshu54oGu6zZlDx/LCO6Ic8HZ/+
gJv3jRtidT2chpHD1Z6j4cax4cHQ4yJZd5DoVxrc+kd0AfuNljGnB+3NpAdXtNAsBLEut0frwAt4
D0hlL431/LN6smteuO3MJvVaCfaoPaFGtdQdywqpWXR9V2xpnbbWvHliIXyPmbGl7/4i/F+stVbB
f6D/3t4k+O9vUEsDBBQAAAAIANmYuDjk2+h3pAAAAAMEAAAOAAAAUmVzdWx0cy0xMC50eHS1000K
gzAQhuG94B2+Cyhq/Ul7g266cle6CCY2oTVTkoGWnr7qsitBshx4hwcG5kIuoxfbyX61wtkp/cnT
pCzAxmupQpqkyRX9OmRW4YQWN/TE8ol5S4PlQzuM5BG09IOBDUtUF1PA27IBr62jHDRikjwY6+7w
eiCvlrSuxD8h4hPdJqKrdhCH+EQTnzhuIpp2B1FvIoTYQZTxiSr+oea3jGD8AFBLAwQUAAAACAD3
mLg4do4qq54AAAD9AwAAEgAAAFJlc3VsdHMtMTBfb3B0LnR4dLXRTQrCMBCG4X2hd/guYOm/tTdw
5aY7cRGaqQmaRJIBxdNbu3RVqFkOvMPDMKcHa6PfJHG0kl5ZmhQ5WHkSMqRJmpwxLMNOS/TocMHg
WNwxbxFY3Mhich6BhB8VdJijsmpMwFOzAi+tdRncBCN4VNpe4Wl0Xn7Tuux+iSo+UcQn9vGJQ3yi
XUW0W4hy3RX1lnfn8Y16FdHkG4jm/8QHUEsDBBQAAAAIAA2ZuDh8fCbDrgIAAJEnAAAPAAAAUmVz
dWx0cy0xMDAudHh0vZpNahtREIT3Bt/hXcBm3v8b3yCbrLwLWQhrHInEmiANJOT0kb3M6gsfaCkY
UXRXdXd1z3xeTw/rz+34dvyz7MOn0375/Xh/F6cpbIfzsttf7u/u776E548fD8d9eAplCl/D87rt
foTr/5aw7b4vp/C6nsNl2Z1fDuF4uT6V+0hvl/DruB3C9vHwaX0M62t4220vh+PpWzgvL+t5//5s
SeNfkDgTkDL1IUDmhCIZ8yRA0i0iiQ2BxG44mTuLJDYB0goC6SOaSFi6epxNJAhjrllgDJatNoy4
BsIYyWBkViWtdgFSKwIp2URSGEiuRlsjI5CkqqQzTpKqksLUlZppKjPjZGqmPSJK6tRMvWfUgus0
mYk1w4Lv1Sg43iJdKJLqxmJkkeSoIkGNvrpaHDBdyRDfmYRjNQWf0PCVnMzICEt1FdZWXKcfjJM0
KQmzdOVSDPGsTrLqXYWlKytHNNByIomPLJKiTGqCIEl1YYRxrXjjHyHvSsGZ8X41K6YJs67iFNxg
Ey5GXA2Z1Orsdkf+UYJUJuEymRVohmZFSbhBCauCL0xdpakdnjmiphxRYelySzzDGMoQVZitorZS
pmBHSWc2woEkli55hYLpUpxUqGB1vUkskq4uBZWNE0c8myayFll7lLXILH2bjIJnVotVHdA7TJeK
ZLB0uUgq5KSolxrMP3a1MCZWJw4kwkiamvCwqyhOOhsn1V3UWLqau3nAmaXGyfs7TpQv9Tor01DU
tYuNX1coM9NwVafnCC2RiqSxvuJuBSxbzttlNrTqbJY5Nn1dIJEx4rpKu0W9N9YfHciAq6+62nW4
xA8jrsGId5FkWO/FjJMCXapqKg1eUpv6lgQuc8qsVFYnZRjbNUMQd3i+xamA8e6WuQT7o5omg81F
d92OcAVySzzj/X9b119QSwMEFAAAAAgAJ5m4OCl+wZpwAgAAjScAABMAAABSZXN1bHRzLTEwMF9v
cHQudHh0vZoxbttAEEV7AbrDXsAGd5fkkrlBqjTughSESEdEIjGQCDjI6SO7TPWCB2xpgMbHzM7/
82dGX37t62X9s8zh83Vefj8fD7Fpwn6+LdN8Px6Oh6/h5eOPp3UOn8LYhW/hZdunn+Hxf0vYpx/L
Nbxut3BfptvpHNb746vYxO5yD2/rfg77x8fX7Tlsr+Ey7afzev0ebstpu83v37Zp+BckjQgkliRA
cqwAMgwsXW0xICxdDiRnlq6uFyAxIZA0mkhiUwGkg+lS1TWyEm7G1kTSVogkMp6k3lRXy0BiMtrV
lhqywkDkwzOpd5G0jIxxUGSEUq+0q2Pa5UAyJKNKV2EgrroSK+HUZPMm0EgoxhdoiVS6RsaTpgxG
ViCIi4TxxEWSIRkVTzKUegUyQqnvlQrXkPrIQFyPT9DcdY1JVxVL1FdIV4aWyPEEqrBrWsxwO+3q
2Zs8UEy6KownTB5zVKJSYwQa2Iu4bhJZATtRGWoUcILFpSLJsJsovreQim4fwYQ+DdGYVBiJMqkJ
blbUw0fo6d0UD7uJevihhqePkIyqulo4+zoyQrvtpB4ODm46gbtUZbdH2LQcCJziHQhsWqr9Fvrw
alUAnbCydjXaCRwbHAYcgFSyIlOu1Ju+CJ2dwuihOqps9dBtKxDY311tQfeoAoGrCBUILF+XLNiu
nDTCPZerX3gIUCD0yqTYTo9y5kl6eFd2IPTKZEAK3TkbkFRjIs01TlnvP85gx34z/pQaNZygG1IX
oFRjwVkgG50LhlLvQGqs0xLsjNkMcgMsYXcwgzOWAhnpb4gU46HWq0g6qJCt2j7CdVoxvitRkP8b
rv8CUEsBAhQAFAAAAAgAJ5u4OEVKHBNiBQAAQBEAABoAAAAAAAAAAQAgAAAAAAAAAFRlc3RTZWFy
Y2hQZXJmb3JtYW5jZS5qYXZhUEsBAhQAFAAAAAgA2Zi4OOTb6HekAAAAAwQAAA4AAAAAAAAAAQAg
AAAAmgUAAFJlc3VsdHMtMTAudHh0UEsBAhQAFAAAAAgA95i4OHaOKqueAAAA/QMAABIAAAAAAAAA
AQAgAAAAagYAAFJlc3VsdHMtMTBfb3B0LnR4dFBLAQIUABQAAAAIAA2ZuDh8fCbDrgIAAJEnAAAP
AAAAAAAAAAEAIAAAADgHAABSZXN1bHRzLTEwMC50eHRQSwECFAAUAAAACAAnmbg4KX7BmnACAACN
JwAAEwAAAAAAAAABACAAAAATCgAAUmVzdWx0cy0xMDBfb3B0LnR4dFBLBQYAAAAABQAFAEIBAAC0
DAAAAAA=


--_07bb8cc3-8d7e-403f-abc4-d9d88975b62b_
Content-Type: text/plain; charset=us-ascii

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--_07bb8cc3-8d7e-403f-abc4-d9d88975b62b_--

From java-user-return-34178-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 25 08:54:15 2008
Return-Path: <java-user-return-34178-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76241 invoked from network); 25 May 2008 08:54:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 May 2008 08:54:15 -0000
Received: (qmail 36781 invoked by uid 500); 25 May 2008 08:54:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36742 invoked by uid 500); 25 May 2008 08:54:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36731 invoked by uid 99); 25 May 2008 08:54:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 May 2008 01:54:10 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rakesh_shete@hotmail.com designates 65.54.246.230 as permitted sender)
Received: from [65.54.246.230] (HELO bay0-omc3-s30.bay0.hotmail.com) (65.54.246.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 May 2008 08:53:13 +0000
Received: from BAY112-W44 ([64.4.26.144]) by bay0-omc3-s30.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Sun, 25 May 2008 01:53:34 -0700
Message-ID: <BAY112-W4466FFA10841E02A9ACE2AF9C30@phx.gbl>
Content-Type: multipart/mixed;
	boundary="_6333255d-1685-40a7-80a0-86fae2a3ba94_"
X-Originating-IP: [125.99.82.185]
From: Rakesh Shete <rakesh_shete@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: RE: Improving search performance
Date: Sun, 25 May 2008 14:23:32 +0530
Importance: Normal
MIME-Version: 1.0
X-OriginalArrivalTime: 25 May 2008 08:53:34.0308 (UTC) FILETIME=[D0603A40:01C8BE44]
X-Virus-Checked: Checked by ClamAV on apache.org

--_6333255d-1685-40a7-80a0-86fae2a3ba94_
Content-Type: text/plain; charset="Windows-1252"
Content-Transfer-Encoding: quoted-printable


Hi ,

I have written a program to simulate the multi-thread behavior and check th=
e performance.
I have attached the program and results.

The JVM parameters when running the program: -Xms128m -Xmx1028m on a P4 2.6=
6 Ghz, 1.99GB RAM machine.

Here are the observations:
 1. The response time to fire a query and return back increases as the numb=
er of threads increases: from 10-100 (I haven=92t used any threadpool. JVM =
default behavior is used)
 2. After optimizing the index, the response time improved significantly. L=
ike in case of 100 threads, the average response time, using optimized inde=
x, is between 1-1.3 seconds as compared to 4-5.5 seconds using the non-opti=
mized index

Is there anything else that I should be looking into to further improve the=
 performance?

--Rakesh S

> Date: Fri, 23 May 2008 20:24:03 -0700
> From: otis_gospodnetic@yahoo.com
> Subject: Re: Improving search performance
> To: java-user@lucene.apache.org
>
> Hi Emmanuel,
>
> Because there are some synchronized methods, like the one that checks whe=
ther a doc is deleted, that get called during search. If you have a pile of=
 threads (op. p. mentioned 100 threads) there could be contention around th=
ose methods.
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
>> From: Emmanuel Bernard=20
>> To: java-user@lucene.apache.org
>> Sent: Friday, May 23, 2008 6:41:36 PM
>> Subject: Re: Improving search performance
>>
>> Hi
>> Hibernate Search does not pool the Searcher but pools the underlying
>> IndexReader(s). From what i've seen, a Searcher is stateless and all
>> the state is kept in the Readers. so this essentially is equivalent to
>> reusing the searcher.
>>
>> Out of curiosity why is a pool of Searcher more efficient?
>>
>> Emmanuel
>>
>> On May 22, 2008, at 13:22, Otis Gospodnetic wrote:
>>
>>> Some quick feedback. Those are all very expensive queries
>>> (wildcards and ranges). The first thing I'd do is try without
>>> Hibernate Search (to make sure HS is not the bottleneck). 100
>>> threads is a lot, I'm guessing you are reusing your searcher, which
>>> is good, but you will actually improve performance a bit if you work
>>> with a small pool of searchers instead of a single searcher.
>>>
>>> Otis
>>> --
>>> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>>>
>>>
>>> ----- Original Message ----
>>>> From: Rakesh Shete
>>>> To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
>>>> Sent: Thursday, May 22, 2008 1:16:13 PM
>>>> Subject: Improving search performance
>>>>
>>>>
>>>> Hi all,
>>>>
>>>> I have index of size 85MB. My query looks as follows:
>>>>
>>>> +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:
>>>> [20080410 TO
>>>> 20081010] +rT:[002 TO 005]
>>>>
>>>> All the fields used in the query are stored in the indexes (Indexed
>>>> & Stored)
>>>>
>>>> The query response time for me is around 30 seconds when running
>>>> mutliple
>>>> simultanoeous threads (~100). The no. of matches is ~30k but I
>>>> retrieve only the
>>>> top 100 results. I am using Hibernate Search which is a wrapper
>>>> around Lucene. I
>>>> retrieve the "id" filed from the index which is also indexex and
>>>> stored.
>>>>
>>>> What is the approach that I should take for improving the
>>>> performance?
>>>>
>>>> Will just indexing the values without storing them work (Index &
>>>> UnStored)?
>>>>
>>>> My machine configuration is:
>>>> P4 2.66GHz 1.99 GB RAM
>>>>
>>>> The code for searching runs in JBoss application server which has a
>>>> maximum heap
>>>> size of 1024MB. When these 100 threads are running in the
>>>> application server the
>>>> CPU utilization is 100% and JBoss consumes all of the heap size.
>>>>
>>>> Any pointers on index optimization would be really appreciated.
>>>>
>>>> --Regards,
>>>> Rakesh Shete
>>>>
>>>> _________________________________________________________________
>>>> No Harvard, No Oxford. We are here. Find out !!
>>>> http://ss1.richmedia.in/recurl.asp?pid=3D500
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

_________________________________________________________________
Catch the latest fashion shows, get beauty tips and learn more on fashion a=
nd lifestyle.
http://video.msn.com/?mkt=3Den-in=

--_6333255d-1685-40a7-80a0-86fae2a3ba94_
Content-Type: application/zip
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="Performance logs.zip"

UEsDBBQAAAAIACebuDhFShwTYgUAAEARAAAaAAAAVGVzdFNlYXJjaFBlcmZvcm1hbmNlLmphdmG1
V1tPGzkUfh4k/sNR9mUCqZOgIlVhK5XSVhsJBF2yF6kXZGZM4mViJ7YHaCv++x5fJvEM08B2dx9g
ZuzvXP2d45P+zs72FuzACf0Ce897sDcYvOjBcPR8ONrfh7MTu+kAE6bNOaMqm50xdSXVnIqMkb/o
DbXb/e2tBc2u6ZRBUWZMMLJYow62t7a3+HwhlQErQLgk49O3dxlbGC5FvC3VlFDUNGMk6KGCFl80
10QbKnKqcnIeXg7tzlemDjZIc5GzO3IklSoXZmw/YrOPiDn8H4qbzTaWJVNfzqjSTBH3eJKJWOr9
+n2TiHbpJ6+lLBgVTugJ8F+40U+AuWD9AT/Ji8fNG6kYOZbZ9emloVy8o7xgef3Ut7f6gX9HBdUa
jASDPANvAyIOOdArWpqZVKDoNdOzCz1jhlUEtQwsLwueQeZUtfIVvm1vJQFWCxh47esliLIoDixY
8RtqGCD7DAqdG8XFFNzh+ffho2Cn+oya2aNIiZmZ868sH7eIeKgNIKlpZLdBPO28GfXfH168LnmR
X9hCHuwP9/vH7jicRqb73D87XasyaTf4iMaLldRG3c0cRVp309SMPnZsL4BLqfXHzue9ARmAXbaL
O2BGdn2n+3n4ggy6XUjzJp7sIzwP8LyC7wV0Ez4kLyx8hV8JDMlzK2CmDwT2rDvTyp/pWmCw30WR
XW1GNDOwKwzPRwMf9D3+rRkWDvdG8hzmWAGpj//DJ6BqqrtgZkreamjtTj2IOqSjbdLvV4kPCU99
ovt908b1dMUSD2sHPWSAR6+DcRWaYPW9K0XmvNlUpYmrxCa/XQraHYiLZGHNPz0tLivtdW50oFzr
tkucTx0cKWYdpQJdsFcMCsurRnPA+wZKzYAbBAG7QWKH4F1iNXnQPdByTUW6js+lFz0BXEN9iB4e
4ONnfA4G+La72/XnHXtnk8Jo7jzh4kZeW2ccqLIw8QBd/3yJmSCu9GrrKe/ZjbhE3UItDu9pUtdo
r2FlAvPu1yyJiRJsI02QpVlpaVAlq84O36kbEbA7w0SuKy3fAhtXQjZrPhvj/CDeeNiba9st/V6v
r7vKig/CRjEW3HBaYG3ALcfG6G0+43nPm9DORK+uycv2nV3fBJqJj7zvtbjc23QvVcQwM5yHKi32
jON0+N1IJQKaOfGYmueI4o0RwB9wIy2vNGN+iiuomJJfSyHoZcF+UqVIuw/Dd5Xv9oLv3jwWkP9M
otkHlotQO9Fi2jGdnocmib9E6uNf2g1ETZYLHE7MsbxlKqN2DFsgkuUTpuY6NapkVdm70nLqMXXM
ZyfyBpY2ZQuysIg0yl1liF9Bulz1C2wX8UhWBZokaVpfX3arOBLr6Am9w6kH+8qRLIVJx8KwKQ6D
J4d/Xvx+ePzb28ravX/4/4XEA3U1iD6eIwnZnGSlUkyYCZ+zE14UvLoYXJjnqz6VJHYUhBl3zbF2
+GGoS5eVoDNjpKGF1brRFDzz/gTJAJSlIVh5whQi7XwIxYzFAyPowO6KsfjagU8wsZbAWFMGZzsB
tj+G64XrSmblDgrNdahKJykksV17Tk02s4xXLJMqrwRtxKRgYmpmK7L4pGZWANL61A5sdYSYv8np
m1M4LI18NsVRR2EnycGLXRY42/6LoD0B12ZtzHHZeqEW+jFvBAshu54oGu6zZlDx/LCO6Ic8HZ/+
gJv3jRtidT2chpHD1Z6j4cax4cHQ4yJZd5DoVxrc+kd0AfuNljGnB+3NpAdXtNAsBLEut0frwAt4
D0hlL431/LN6smteuO3MJvVaCfaoPaFGtdQdywqpWXR9V2xpnbbWvHliIXyPmbGl7/4i/F+stVbB
f6D/3t4k+O9vUEsDBBQAAAAIANmYuDjk2+h3pAAAAAMEAAAOAAAAUmVzdWx0cy0xMC50eHS1000K
gzAQhuG94B2+Cyhq/Ul7g266cle6CCY2oTVTkoGWnr7qsitBshx4hwcG5kIuoxfbyX61wtkp/cnT
pCzAxmupQpqkyRX9OmRW4YQWN/TE8ol5S4PlQzuM5BG09IOBDUtUF1PA27IBr62jHDRikjwY6+7w
eiCvlrSuxD8h4hPdJqKrdhCH+EQTnzhuIpp2B1FvIoTYQZTxiSr+oea3jGD8AFBLAwQUAAAACAD3
mLg4do4qq54AAAD9AwAAEgAAAFJlc3VsdHMtMTBfb3B0LnR4dLXRTQrCMBCG4X2hd/guYOm/tTdw
5aY7cRGaqQmaRJIBxdNbu3RVqFkOvMPDMKcHa6PfJHG0kl5ZmhQ5WHkSMqRJmpwxLMNOS/TocMHg
WNwxbxFY3Mhich6BhB8VdJijsmpMwFOzAi+tdRncBCN4VNpe4Wl0Xn7Tuux+iSo+UcQn9vGJQ3yi
XUW0W4hy3RX1lnfn8Y16FdHkG4jm/8QHUEsDBBQAAAAIAA2ZuDh8fCbDrgIAAJEnAAAPAAAAUmVz
dWx0cy0xMDAudHh0vZpNahtREIT3Bt/hXcBm3v8b3yCbrLwLWQhrHInEmiANJOT0kb3M6gsfaCkY
UXRXdXd1z3xeTw/rz+34dvyz7MOn0375/Xh/F6cpbIfzsttf7u/u776E548fD8d9eAplCl/D87rt
foTr/5aw7b4vp/C6nsNl2Z1fDuF4uT6V+0hvl/DruB3C9vHwaX0M62t4220vh+PpWzgvL+t5//5s
SeNfkDgTkDL1IUDmhCIZ8yRA0i0iiQ2BxG44mTuLJDYB0goC6SOaSFi6epxNJAhjrllgDJatNoy4
BsIYyWBkViWtdgFSKwIp2URSGEiuRlsjI5CkqqQzTpKqksLUlZppKjPjZGqmPSJK6tRMvWfUgus0
mYk1w4Lv1Sg43iJdKJLqxmJkkeSoIkGNvrpaHDBdyRDfmYRjNQWf0PCVnMzICEt1FdZWXKcfjJM0
KQmzdOVSDPGsTrLqXYWlKytHNNByIomPLJKiTGqCIEl1YYRxrXjjHyHvSsGZ8X41K6YJs67iFNxg
Ey5GXA2Z1Orsdkf+UYJUJuEymRVohmZFSbhBCauCL0xdpakdnjmiphxRYelySzzDGMoQVZitorZS
pmBHSWc2woEkli55hYLpUpxUqGB1vUkskq4uBZWNE0c8myayFll7lLXILH2bjIJnVotVHdA7TJeK
ZLB0uUgq5KSolxrMP3a1MCZWJw4kwkiamvCwqyhOOhsn1V3UWLqau3nAmaXGyfs7TpQv9Tor01DU
tYuNX1coM9NwVafnCC2RiqSxvuJuBSxbzttlNrTqbJY5Nn1dIJEx4rpKu0W9N9YfHciAq6+62nW4
xA8jrsGId5FkWO/FjJMCXapqKg1eUpv6lgQuc8qsVFYnZRjbNUMQd3i+xamA8e6WuQT7o5omg81F
d92OcAVySzzj/X9b119QSwMEFAAAAAgAJ5m4OCl+wZpwAgAAjScAABMAAABSZXN1bHRzLTEwMF9v
cHQudHh0vZoxbttAEEV7AbrDXsAGd5fkkrlBqjTughSESEdEIjGQCDjI6SO7TPWCB2xpgMbHzM7/
82dGX37t62X9s8zh83Vefj8fD7Fpwn6+LdN8Px6Oh6/h5eOPp3UOn8LYhW/hZdunn+Hxf0vYpx/L
Nbxut3BfptvpHNb746vYxO5yD2/rfg77x8fX7Tlsr+Ey7afzev0ebstpu83v37Zp+BckjQgkliRA
cqwAMgwsXW0xICxdDiRnlq6uFyAxIZA0mkhiUwGkg+lS1TWyEm7G1kTSVogkMp6k3lRXy0BiMtrV
lhqywkDkwzOpd5G0jIxxUGSEUq+0q2Pa5UAyJKNKV2EgrroSK+HUZPMm0EgoxhdoiVS6RsaTpgxG
ViCIi4TxxEWSIRkVTzKUegUyQqnvlQrXkPrIQFyPT9DcdY1JVxVL1FdIV4aWyPEEqrBrWsxwO+3q
2Zs8UEy6KownTB5zVKJSYwQa2Iu4bhJZATtRGWoUcILFpSLJsJsovreQim4fwYQ+DdGYVBiJMqkJ
blbUw0fo6d0UD7uJevihhqePkIyqulo4+zoyQrvtpB4ODm46gbtUZbdH2LQcCJziHQhsWqr9Fvrw
alUAnbCydjXaCRwbHAYcgFSyIlOu1Ju+CJ2dwuihOqps9dBtKxDY311tQfeoAoGrCBUILF+XLNiu
nDTCPZerX3gIUCD0yqTYTo9y5kl6eFd2IPTKZEAK3TkbkFRjIs01TlnvP85gx34z/pQaNZygG1IX
oFRjwVkgG50LhlLvQGqs0xLsjNkMcgMsYXcwgzOWAhnpb4gU46HWq0g6qJCt2j7CdVoxvitRkP8b
rv8CUEsBAhQAFAAAAAgAJ5u4OEVKHBNiBQAAQBEAABoAAAAAAAAAAQAgAAAAAAAAAFRlc3RTZWFy
Y2hQZXJmb3JtYW5jZS5qYXZhUEsBAhQAFAAAAAgA2Zi4OOTb6HekAAAAAwQAAA4AAAAAAAAAAQAg
AAAAmgUAAFJlc3VsdHMtMTAudHh0UEsBAhQAFAAAAAgA95i4OHaOKqueAAAA/QMAABIAAAAAAAAA
AQAgAAAAagYAAFJlc3VsdHMtMTBfb3B0LnR4dFBLAQIUABQAAAAIAA2ZuDh8fCbDrgIAAJEnAAAP
AAAAAAAAAAEAIAAAADgHAABSZXN1bHRzLTEwMC50eHRQSwECFAAUAAAACAAnmbg4KX7BmnACAACN
JwAAEwAAAAAAAAABACAAAAATCgAAUmVzdWx0cy0xMDBfb3B0LnR4dFBLBQYAAAAABQAFAEIBAAC0
DAAAAAA=


--_6333255d-1685-40a7-80a0-86fae2a3ba94_
Content-Type: text/plain; charset=us-ascii

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--_6333255d-1685-40a7-80a0-86fae2a3ba94_--

From java-user-return-34179-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 25 16:26:18 2008
Return-Path: <java-user-return-34179-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83782 invoked from network); 25 May 2008 16:26:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 May 2008 16:26:18 -0000
Received: (qmail 98981 invoked by uid 500); 25 May 2008 16:26:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98950 invoked by uid 500); 25 May 2008 16:26:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98939 invoked by uid 99); 25 May 2008 16:26:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 May 2008 09:26:11 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [217.41.57.100] (HELO 2ls.com) (217.41.57.100)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 May 2008 16:25:18 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Is it possible to add multiple keywords to a single field from one doc?
X-MimeOLE: Produced By Microsoft Exchange V6.5
Date: Sun, 25 May 2008 17:25:40 +0100
Message-ID: <562BCF4FF1D14343BC81378BA0050AD90AB7FC@SBS2003.2LSHQ.local>
In-Reply-To: <483839C1.2000307@gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Is it possible to add multiple keywords to a single field from one doc?
Thread-Index: Aci9tkXOdjBqzKDfTH2zIPez5hebrwAzOZQg
From: "Tom Conlon" <tomc@2ls.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Mark,

For example:
you have a content field (default) and you also have an 'attributes'
field.

I'd like to add multiple attributes for a given document rather than
just one value and be able to somehow search on the attributes.

Ie. Similar to a One-to-many DB relationship between document table(pk
docid) and docattribute table (pk docid,attributeid)

TIA,
Tom
=20

-----Original Message-----
From: Mark Miller [mailto:markrmiller@gmail.com]=20
Sent: 24 May 2008 16:53
To: java-user@lucene.apache.org
Subject: Re: Is it possible to add multiple keywords to a single field
from one doc?

Tom Conlon wrote:
> Hi,
>
> I haven't been able to find the answer to this question easily so any=20
> help would be appreciated.
>
> Thanks,
> Tom
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>  =20
Could you elaborate a bit Tom? Your question is not very clear. If by
keywords, you mean terms, and instead of from one doc, you mean to one
doc, then the answer is yes. But as phrased, I am not sure what the
question is.

- Mark

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34180-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun May 25 17:06:43 2008
Return-Path: <java-user-return-34180-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88221 invoked from network); 25 May 2008 17:06:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 May 2008 17:06:43 -0000
Received: (qmail 17181 invoked by uid 500); 25 May 2008 17:06:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17135 invoked by uid 500); 25 May 2008 17:06:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17124 invoked by uid 99); 25 May 2008 17:06:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 May 2008 10:06:37 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 64.233.166.179 as permitted sender)
Received: from [64.233.166.179] (HELO py-out-1112.google.com) (64.233.166.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 May 2008 17:05:50 +0000
Received: by py-out-1112.google.com with SMTP id z74so1175433pyg.9
        for <java-user@lucene.apache.org>; Sun, 25 May 2008 10:06:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=kgkzdkTANkZmAzVfX/SoG34tIEE0g3AQ9HYVyYagoLw=;
        b=UN6j5lZAvIfvnV9+/bRoCw3h4oqNOfwCmKdbmVvpWPBhXisAx8YyxzauvkVuSSqk5eTp/q6EoJgNmOpkrmw0P1raGqPDfvSXSlCeqh+HHmi7UDYcJoLxFWYPdpDCeTSkgf63X3OhUxcRx0ebPpfDOaIUJphWSY6bdxSmsorAEpI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=YlJ5YRXaMs2LPt9bOfM0zly6U74+55060tgAJaUWXPIyxtazfV0sud851/xppZfW558K14SymrV+1/xPe7YsjN9yK2yXlAc3aIKdVVbGIraKlntq6zIixJYARZmriOAWJ0prEfXDxFhc47JSCkDtdaln5B1NwpXgK4cvZ8ZuRyk=
Received: by 10.64.242.5 with SMTP id p5mr1967488qbh.5.1211735166409;
        Sun, 25 May 2008 10:06:06 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id p4sm7219338qba.21.2008.05.25.10.06.05
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 25 May 2008 10:06:05 -0700 (PDT)
Message-ID: <48399C81.4080903@gmail.com>
Date: Sun, 25 May 2008 13:06:09 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Is it possible to add multiple keywords to a single field from
 one doc?
References: <562BCF4FF1D14343BC81378BA0050AD90AB7FC@SBS2003.2LSHQ.local>
In-Reply-To: <562BCF4FF1D14343BC81378BA0050AD90AB7FC@SBS2003.2LSHQ.local>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Okay, this is easy then. As long as you are using an analyzer that 
breaks up terms when it encounters a space, you just add all of the 
attributes as a single Field entry to the document (attribute field="big 
large black bulky"), with each attribute separated by a space. This will 
result in a hit on that document for every search query that searches 
the attribute field and that contains a term thats listed in the space 
separated attribute field.

- Mark

Tom Conlon wrote:
> Hi Mark,
>
> For example:
> you have a content field (default) and you also have an 'attributes'
> field.
>
> I'd like to add multiple attributes for a given document rather than
> just one value and be able to somehow search on the attributes.
>
> Ie. Similar to a One-to-many DB relationship between document table(pk
> docid) and docattribute table (pk docid,attributeid)
>
> TIA,
> Tom
>  
>
> -----Original Message-----
> From: Mark Miller [mailto:markrmiller@gmail.com] 
> Sent: 24 May 2008 16:53
> To: java-user@lucene.apache.org
> Subject: Re: Is it possible to add multiple keywords to a single field
> from one doc?
>
> Tom Conlon wrote:
>   
>> Hi,
>>
>> I haven't been able to find the answer to this question easily so any 
>> help would be appreciated.
>>
>> Thanks,
>> Tom
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>   
>>     
> Could you elaborate a bit Tom? Your question is not very clear. If by
> keywords, you mean terms, and instead of from one doc, you mean to one
> doc, then the answer is yes. But as phrased, I am not sure what the
> question is.
>
> - Mark
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34181-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 26 04:24:49 2008
Return-Path: <java-user-return-34181-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48833 invoked from network); 26 May 2008 04:24:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 May 2008 04:24:49 -0000
Received: (qmail 92917 invoked by uid 500); 26 May 2008 04:24:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92880 invoked by uid 500); 26 May 2008 04:24:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92869 invoked by uid 99); 26 May 2008 04:24:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 May 2008 21:24:43 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [203.217.22.128] (HELO file1.syd.nuix.com.au) (203.217.22.128)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 May 2008 04:23:50 +0000
Received: from host68.syd.nuix.com.au (host68.syd.nuix.com.au [192.168.222.68])
	by file1.syd.nuix.com.au (Postfix) with ESMTP id D0BA24A8173
	for <java-user@lucene.apache.org>; Mon, 26 May 2008 14:25:36 +1000 (EST)
From: Daniel Noll <daniel@nuix.com>
Organization: Nuix Pty Ltd
To: java-user@lucene.apache.org
Subject: Re: Is it possible to add multiple keywords to a single field from one doc?
Date: Mon, 26 May 2008 14:24:19 +1000
User-Agent: KMail/1.9.6 (enterprise 0.20070907.709405)
References: <562BCF4FF1D14343BC81378BA0050AD90AB7FC@SBS2003.2LSHQ.local>
In-Reply-To: <562BCF4FF1D14343BC81378BA0050AD90AB7FC@SBS2003.2LSHQ.local>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805261424.19569.daniel@nuix.com>
X-Virus-Checked: Checked by ClamAV on apache.org

On Monday 26 May 2008 02:25:40 Tom Conlon wrote:
> Hi Mark,
>
> For example:
> you have a content field (default) and you also have an 'attributes'
> field.
>
> I'd like to add multiple attributes for a given document rather than
> just one value and be able to somehow search on the attributes.
>
> Ie. Similar to a One-to-many DB relationship between document table(pk
> docid) and docattribute table (pk docid,attributeid)

Try adding two Field objects with the same name to the same Document, it's 
probably the easiest and most intuitive way to do what you want.

Not sure if there is a drawback to doing it this way, vs. using a single field 
and breaking on the whitespace.

Daniel

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34182-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 26 07:27:40 2008
Return-Path: <java-user-return-34182-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88615 invoked from network); 26 May 2008 07:27:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 May 2008 07:27:39 -0000
Received: (qmail 11380 invoked by uid 500); 26 May 2008 07:27:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11355 invoked by uid 500); 26 May 2008 07:27:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11344 invoked by uid 99); 26 May 2008 07:27:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 May 2008 00:27:33 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of eransevi@gmail.com designates 64.233.166.178 as permitted sender)
Received: from [64.233.166.178] (HELO py-out-1112.google.com) (64.233.166.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 May 2008 07:26:45 +0000
Received: by py-out-1112.google.com with SMTP id z74so1329085pyg.9
        for <java-user@lucene.apache.org>; Mon, 26 May 2008 00:27:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=k+RXZbi9H55yIP0Tf4jWWDixtLbro9ueZ59jR1yWXfY=;
        b=YPT6XZ0FKWrhrMRYCJ4j0wEtIh6CBUfcnQVHBkiv/9CRqt75JJ8khlUzrMzK8wQv3mIPAlbPrXoKLWtYHBVOECJgGxNz/YAYCcaSV1d7zHMhyCYYaPJr6R7t2WRh9t4yFpYyQgRYnD+KrYr0IjYnW+N6yB1yrh+hmWEa65vOV48=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=kD/pZmty4HhaHlhyitj0Jp4GCFCVF4S9Ph3bZMgIFO/ey0aZr/KhInVpnKcyIM4Vb5clyaL5Sdm5b0ETUFbGxNkHtENwF5MHfTL+vL/JWQzStRml4sRvl3Nqp/oDd26r06+tfkdtB5VcyCbplfD4xst1/x10ijLqEwFm48zB9Tw=
Received: by 10.143.1.12 with SMTP id d12mr1853883wfi.297.1211786821217;
        Mon, 26 May 2008 00:27:01 -0700 (PDT)
Received: by 10.142.245.20 with HTTP; Mon, 26 May 2008 00:27:01 -0700 (PDT)
Message-ID: <74f928500805260027w14dd318fr342633c190b3ccf5@mail.gmail.com>
Date: Mon, 26 May 2008 10:27:01 +0300
From: "Eran Sevi" <eransevi@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Best way to get payloads
In-Reply-To: <58738D9F-6782-426A-A5A0-E28260AD2327@apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_4208_2492481.1211786821225"
References: <74f928500805220103q2bff6e2ob1f833149dd33ef5@mail.gmail.com>
	 <58738D9F-6782-426A-A5A0-E28260AD2327@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_4208_2492481.1211786821225
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Thanks Grant,

I think it will take me too long to figure out all the details for
implementing it correctly.
Maybe someone else will pick up the glove.
On Thu, May 22, 2008 at 4:00 PM, Grant Ingersoll <gsingers@apache.org>
wrote:

> Unfortunately, I haven't had time to work on
> https://issues.apache.org/jira/browse/LUCENE-1001
>
> There is a _HALF BAKED_ patch up there, but I got stuck on it at the time
> due to not being sure how to handle NearSpans and haven't had a chance to go
> back to it.  I do believe it is possible to expose it via the Spans, so if
> you are so inclined, it is definitely something that needs to be
> implemented.
>
> -Grant
>
>
> On May 22, 2008, at 4:03 AM, Eran Sevi wrote:
>
> Hi,
>>
>> I'm running a SpanQuery and get the Spans result which tell me the
>> documents
>> and positions of what I searched for.
>> I would now like to get the payloads in those documents and positions
>> without having to iterate on TermPositions since I don't have a term but I
>> do have the document and position.
>>
>> Maybe Spans should be extended to also hold the payloads as well as the
>> start and end positions of the span.
>>
>> Another option might be to extend TermPositionVector and return an array
>> of
>> payloads.
>>
>> Can anyone think on a way to do it ?
>>
>> Thanks,
>> Eran.
>>
>
>
>
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_4208_2492481.1211786821225--

From java-user-return-34183-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 26 11:22:18 2008
Return-Path: <java-user-return-34183-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44374 invoked from network); 26 May 2008 11:22:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 May 2008 11:22:18 -0000
Received: (qmail 67368 invoked by uid 500); 26 May 2008 11:22:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66876 invoked by uid 500); 26 May 2008 11:22:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66865 invoked by uid 99); 26 May 2008 11:22:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 May 2008 04:22:12 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 May 2008 11:21:17 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1K0aln-0007Pi-8V
	for java-user@lucene.apache.org; Mon, 26 May 2008 04:21:39 -0700
Message-ID: <17470154.post@talk.nabble.com>
Date: Mon, 26 May 2008 04:21:39 -0700 (PDT)
From: stlecho <stlecho@gmail.com>
To: java-user@lucene.apache.org
Subject: Date Range Query: How to get a higher score for dates close to a
 reference date ?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: stlecho@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

In the application I'm developing I'm able to query on 2 properties of my
model: Name and BirthDay. Records that have an exact match on the name
property and for which the birthday is close to the specified BirthDay query
parameter should have a higher score.

Does Lucene support the following scenario ? The user specifies a
ReferenceDate with a Tolerance. The ReferenceDate and Tolerance are used to
query the index and get the hits. The score of the hits should be based on
the "distance" between the ReferenceDate and the BirthDay of the hit. In
other words: BirthDays that are in the specified range, but closer to the
ReferenceDate should have a higher score.

Example:
The user wants to search persons born on 2003-05-01, but with a tolerance of
5 years (because the user is no sure about the exact birthyear)
-Reference Date: 2003-05-01
-Range Query: [1998-05-01 TO 2008-05-01]
-Results with birthday 1998-05-01 should have a lower score than results
with birthday 2003-01-01 (because this date is closer to the reference date
2003-05-01)

Regards, Stefan Lecho.
-- 
View this message in context: http://www.nabble.com/Date-Range-Query%3A-How-to-get-a-higher-score-for-dates-close-to-a-reference-date---tp17470154p17470154.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34184-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon May 26 13:55:52 2008
Return-Path: <java-user-return-34184-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88027 invoked from network); 26 May 2008 13:55:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 May 2008 13:55:52 -0000
Received: (qmail 26935 invoked by uid 500); 26 May 2008 13:55:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26887 invoked by uid 500); 26 May 2008 13:55:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26871 invoked by uid 99); 26 May 2008 13:55:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 May 2008 06:55:46 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.188 as permitted sender)
Received: from [209.85.128.188] (HELO fk-out-0910.google.com) (209.85.128.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 May 2008 13:54:59 +0000
Received: by fk-out-0910.google.com with SMTP id 18so1788520fkq.5
        for <java-user@lucene.apache.org>; Mon, 26 May 2008 06:55:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=oNzEyTqXJvQQrO0Pk+ZVHAUde2glQM47ZoGLxw0GWME=;
        b=o9w0iha5zXTND4/7FzU0wvlCmfSkkWHwm8m+yiaEyUcqTd93nHOSzc0rkHmFHthhioQ5QmM/d4oJZmWzfQwOzHzohAHEmWoL4gK2qY+iVgwTpl6iRgX23FskL8bZnZUN7raVwRo6maWL7PNeuQgZi7v4/NtiNEt5/PEYoFWtdEc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=k4FniCjY5Rd4TRgDIq8ElVZSZWpN/1n2xhJujTjKN+Vn0OsCgzo8lbZVl5mUFBYLFXVrT9Xwn5q9U0yhSnNwU+nYQWajUxM+zsofTTCcuMGrNHb+60w07d8NhF2HNunojIBC2ZbGxUJ8PvQlGTef9MPZQnHJKlTjSLFoRW45gYg=
Received: by 10.86.84.5 with SMTP id h5mr5727387fgb.11.1211810114268;
        Mon, 26 May 2008 06:55:14 -0700 (PDT)
Received: by 10.86.95.19 with HTTP; Mon, 26 May 2008 06:55:14 -0700 (PDT)
Message-ID: <359a92830805260655r775ea3eaka03809a02b06e421@mail.gmail.com>
Date: Mon, 26 May 2008 09:55:14 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Is it possible to add multiple keywords to a single field from one doc?
In-Reply-To: <200805261424.19569.daniel@nuix.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5738_24533083.1211810114270"
References: <562BCF4FF1D14343BC81378BA0050AD90AB7FC@SBS2003.2LSHQ.local>
	 <200805261424.19569.daniel@nuix.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5738_24533083.1211810114270
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

I looked at this at one point, and the only difference is that when you
add a field multiple times, the first token for fields 2-n are offset by
the IncrementGap. Unless you override the analyzer and return the
non-default value for GetIncrementGap, there's no difference that I
could find...

Erick

On Mon, May 26, 2008 at 12:24 AM, Daniel Noll <daniel@nuix.com> wrote:

> On Monday 26 May 2008 02:25:40 Tom Conlon wrote:
> > Hi Mark,
> >
> > For example:
> > you have a content field (default) and you also have an 'attributes'
> > field.
> >
> > I'd like to add multiple attributes for a given document rather than
> > just one value and be able to somehow search on the attributes.
> >
> > Ie. Similar to a One-to-many DB relationship between document table(pk
> > docid) and docattribute table (pk docid,attributeid)
>
> Try adding two Field objects with the same name to the same Document, it's
> probably the easiest and most intuitive way to do what you want.
>
> Not sure if there is a drawback to doing it this way, vs. using a single
> field
> and breaking on the whitespace.
>
> Daniel
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_5738_24533083.1211810114270--

From java-user-return-34185-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 27 06:15:26 2008
Return-Path: <java-user-return-34185-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38776 invoked from network); 27 May 2008 06:15:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 May 2008 06:15:26 -0000
Received: (qmail 2295 invoked by uid 500); 27 May 2008 06:15:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2263 invoked by uid 500); 27 May 2008 06:15:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2251 invoked by uid 99); 27 May 2008 06:15:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 May 2008 23:15:20 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [130.225.24.87] (HELO luna.statsbiblioteket.dk) (130.225.24.87)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 May 2008 06:14:26 +0000
Received: from [172.18.249.244] (PC990.sb.statsbiblioteket.dk [172.18.249.244])
 by luna.statsbiblioteket.dk
 (iPlanet Messaging Server 5.2 HotFix 1.16 (built May 14 2003))
 with ESMTP id <0K1I009S1K0OF4@luna.statsbiblioteket.dk> for
 java-user@lucene.apache.org; Tue, 27 May 2008 08:14:48 +0200 (MEST)
Date: Tue, 27 May 2008 08:14:48 +0200
From: Toke Eskildsen <te@statsbiblioteket.dk>
Subject: RE: Improving search performance
In-reply-to: <BAY112-W4466FFA10841E02A9ACE2AF9C30@phx.gbl>
To: java-user@lucene.apache.org
Reply-to: te@statsbiblioteket.dk
Message-id: <1211868888.2134.33.camel@PC990.sb.statsbiblioteket.dk>
Organization: Statsbiblioteket
MIME-version: 1.0
X-Mailer: Evolution 2.8.3 (2.8.3-2.fc6)
Content-type: text/plain; charset=UTF-8
Content-transfer-encoding: 8BIT
References: <BAY112-W4466FFA10841E02A9ACE2AF9C30@phx.gbl>
X-Virus-Checked: Checked by ClamAV on apache.org

On Sun, 2008-05-25 at 14:23 +0530, Rakesh Shete wrote:
>  1. The response time to fire a query and return back increases as the
>  number of threads increases: from 10-100 (I havent used any
>  threadpool. JVM default behavior is used)
>  2. After optimizing the index, the response time improved significantly.
>  Like in case of 100 threads, the average response time, using optimized
>  index, is between 1-1.3 seconds as compared to 4-5.5 seconds using the
>  non-optimized index

What is the speed if you queue the queries and perform them one at a
time?

As for your code, then you don't do any warm-up. Looking at your
result-list it seems clear that the first 10 threads takes longer to
execute than the other threads. Try performing a short warm-up before
measuring by running the query a couple of times.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34186-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 27 16:37:38 2008
Return-Path: <java-user-return-34186-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38446 invoked from network); 27 May 2008 16:37:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 May 2008 16:37:38 -0000
Received: (qmail 2241 invoked by uid 500); 27 May 2008 16:37:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1739 invoked by uid 500); 27 May 2008 16:37:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1728 invoked by uid 99); 27 May 2008 16:37:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 May 2008 09:37:30 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: 131.246.120.220 is neither permitted nor denied by domain of christian.reuschling@gmail.com)
Received: from [131.246.120.220] (HELO mailgw1.uni-kl.de) (131.246.120.220)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 May 2008 16:36:36 +0000
Received: from dfki.uni-kl.de (dfki-1002.dfki.uni-kl.de [131.246.195.2])
	by mailgw1.uni-kl.de (8.13.8/8.13.8/Debian-3) with ESMTP id m4RGavFf002845
	for <java-user@lucene.apache.org>; Tue, 27 May 2008 18:36:57 +0200
Received: from serv-4100.kl.dfki.de (serv-4100.kl.dfki.de [192.168.41.180])
	by dfki.uni-kl.de (8.13.8+Sun/8.11.4) with ESMTP id m4RGauPF002134
	for <java-user@lucene.apache.org>; Tue, 27 May 2008 18:36:56 +0200 (CEST)
Received: from [192.168.41.166] (pc-4176.kl.dfki.de [192.168.41.166])
	by serv-4100.kl.dfki.de (8.13.8+Sun/8.13.8) with ESMTP id m4RGauVY013038
	for <java-user@lucene.apache.org>; Tue, 27 May 2008 18:36:56 +0200 (CEST)
Message-ID: <483C389F.9030301@gmail.com>
Date: Tue, 27 May 2008 18:36:47 +0200
From: Christian Reuschling <christian.reuschling@gmail.com>
User-Agent: Thunderbird 2.0.0.12 (X11/20080226)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Refreshing IndexReaders for our desktop searching app
X-Enigmail-Version: 0.95.6
OpenPGP: id=AF96660F;
	url=hkp://wwwkeys.eu.pgp.net
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="------------enig2DAFF2E837BE9FEDA7100086"
X-Virus-Checked: Checked by ClamAV on apache.org

--------------enig2DAFF2E837BE9FEDA7100086
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: quoted-printable

Hello out there,

We have implemented some open source desktop searching app based on Lucen=
e
http://sourceforge.net/projects/dynaq

Development always goes further, and currently we make experiments with t=
he
file-lock based writer (/reader) synchronization capabilities of Lucene, =
in
order to waste our current synchronization method, which is not such comf=
ortable
to use.

I have a global writer Object and an according Reader, which is also glob=
al
accessible inside the application. For both there are getter methods, ins=
ide
the getReader() method we check with reader.isCurrent() whether there are=

modifications inside the index or not. In the case there are modification=
s,
I close the reader and create a new one, returning it.

And this is exactly the problem. In the case there are still some referen=
ces
to the old reader object, I get an IndexAlreadyClosedException.

I'm thinking for a while about this problem, and have also searched long =
time
inside the Lucene mailing list repository. The root of the problem is not=
 to
close a reader Object if there is at least one reference to it left.

To ensure this, for my impression, we have the following possibilities:

1. Add a new method 'release reader' and count whether there are some unr=
eleased
    reader Objects left. Only close if not. This makes coding much less c=
omfortable,
    if you forget to release a reader after using it, it will end in exce=
ssive
    debugging sessions. Further, I personally think that this is not the =
'spirit'
    of Lucene for this scenario...correct me if I'm wrong ;)

2. Add a finalizer to the reader object and perform a close() there. Refe=
rences to
    reader objects will stay valid. For this, I have to wrap the all Read=
ers in order
    to add the finalize()...the wrap is also not so nice

3. Use the garbage collector for counting the references, and - maybe - u=
se
    PhantomReferences to initialize a close process. I don't exactly know=
 whether
    this is possible, because the Phantom reference gets null for its ref=
erent, so
    the invocation oof close() seems to be unpossible...

4. Simply don't close the reader Objects, and hope that this is no proble=
m..


To change this hope into knowledge: Is it critical NOT closing an IndexRe=
ader Object
in the case it is used only and entirely read-only? We use the new IndexW=
riter
to delete documents in all cases.

If it is critical - is there a common  - or uncommon but good - solution =
for this, that
I have forgotten?


Christian


--------------enig2DAFF2E837BE9FEDA7100086
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.4-svn0 (GNU/Linux)
Comment: Using GnuPG with SUSE - http://enigmail.mozdev.org

iD8DBQFIPDio6EqMXq+WZg8RAirQAKCc3ZyyfjCx4+bxmZeemJvDC5Ux3QCdFFLi
C0LqQichRismVqFl3USx62o=
=73b7
-----END PGP SIGNATURE-----

--------------enig2DAFF2E837BE9FEDA7100086--

From java-user-return-34187-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue May 27 20:38:17 2008
Return-Path: <java-user-return-34187-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68707 invoked from network); 27 May 2008 20:38:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 May 2008 20:38:17 -0000
Received: (qmail 12471 invoked by uid 500); 27 May 2008 20:38:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12431 invoked by uid 500); 27 May 2008 20:38:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12420 invoked by uid 99); 27 May 2008 20:38:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 May 2008 13:38:12 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 May 2008 20:37:19 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id F390371C3FA; Tue, 27 May 2008 13:37:40 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id F0CFF71C3F1
	for <java-user@lucene.apache.org>; Tue, 27 May 2008 13:37:40 -0700 (PDT)
Date: Tue, 27 May 2008 13:37:40 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: Lucene Users <java-user@lucene.apache.org>
Subject: Re: Date Range Query: How to get a higher score for dates close to
 a reference date ?
In-Reply-To: <17470154.post@talk.nabble.com>
Message-ID: <Pine.LNX.4.62.0805271336130.13298@radix.cryptio.net>
References: <17470154.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: In the application I'm developing I'm able to query on 2 properties of my
: model: Name and BirthDay. Records that have an exact match on the name
: property and for which the birthday is close to the specified BirthDay query
: parameter should have a higher score.

use a RangeFilter to constrain your results to therange you want, then use 
a ValueSourceQuery to score documents higher when the value of the 
BirthDay field is "nearer" your target date.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34188-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 06:25:39 2008
Return-Path: <java-user-return-34188-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76261 invoked from network); 28 May 2008 06:25:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 06:25:39 -0000
Received: (qmail 29470 invoked by uid 500); 28 May 2008 06:25:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29439 invoked by uid 500); 28 May 2008 06:25:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29421 invoked by uid 99); 28 May 2008 06:25:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 May 2008 23:25:33 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.128.184 as permitted sender)
Received: from [209.85.128.184] (HELO fk-out-0910.google.com) (209.85.128.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 06:24:46 +0000
Received: by fk-out-0910.google.com with SMTP id 18so2546283fkq.5
        for <java-user@lucene.apache.org>; Tue, 27 May 2008 23:25:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=FKmhF0vmN9osebfCzE2aZ0CfX77LnQV8YqIaJT1bDK8=;
        b=dlPWxMoMzsD+Y7lwxNDMqf7gaKE/dZSH5+tWzICvcfkRSVh1qU7oLZ2Qp8nWAnSMtFZRQ92wXl11BnQHzFipmENLbnShlQkcKDXIEhQHp7eKI0LXBML0VTWufTOa/TIMTitniOxnN7g9m5izfqhLOFMOjHz+ygbLxCk1UM6juhI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=hUMS0cWc1bJ1dNG+QZgt/Z6+bSoge0KZY+BEcVS46ZVTQNgoCT/uGpvJVRpOe7cKUrIOtUSSKrdidhlo6bRskBQ7de0jn7LewHzNoM5KFbdkdEVD3Gn5nAcmIVghnftG7DPwVYqfJDjmzM8DUlDT8CGnGuiKXEi+1FOKYhU/WC0=
Received: by 10.82.115.8 with SMTP id n8mr333904buc.44.1211955901133;
        Tue, 27 May 2008 23:25:01 -0700 (PDT)
Received: by 10.82.135.16 with HTTP; Tue, 27 May 2008 23:25:01 -0700 (PDT)
Message-ID: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com>
Date: Tue, 27 May 2008 23:25:01 -0700
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: IndexReader.reopen memory leak
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_10796_30674986.1211955901156"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_10796_30674986.1211955901156
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi:

  We are experiencing memory leak with calling IndexReader.reopen().

   From eyeballing the lucene source code, I am seeing normCache is not
cleared.


   Anyone else experiencing this?

Thanks

-John

------=_Part_10796_30674986.1211955901156--

From java-user-return-34189-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 08:22:07 2008
Return-Path: <java-user-return-34189-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16212 invoked from network); 28 May 2008 08:22:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 08:22:07 -0000
Received: (qmail 65215 invoked by uid 500); 28 May 2008 08:21:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65168 invoked by uid 500); 28 May 2008 08:21:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65128 invoked by uid 99); 28 May 2008 08:21:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 01:21:54 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 131.246.120.220 is neither permitted nor denied by domain of christian.reuschling@gmail.com)
Received: from [131.246.120.220] (HELO mailgw1.uni-kl.de) (131.246.120.220)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 08:21:06 +0000
Received: from dfki.uni-kl.de (dfki-1002.dfki.uni-kl.de [131.246.195.2])
	by mailgw1.uni-kl.de (8.13.8/8.13.8/Debian-3) with ESMTP id m4S8LKKq025591
	for <java-user@lucene.apache.org>; Wed, 28 May 2008 10:21:20 +0200
Received: from serv-4100.kl.dfki.de (serv-4100.kl.dfki.de [192.168.41.180])
	by dfki.uni-kl.de (8.13.8+Sun/8.11.4) with ESMTP id m4S8LJDw008692
	for <java-user@lucene.apache.org>; Wed, 28 May 2008 10:21:19 +0200 (CEST)
Received: from [192.168.41.166] (pc-4176.kl.dfki.de [192.168.41.166])
	by serv-4100.kl.dfki.de (8.13.8+Sun/8.13.8) with ESMTP id m4S8LJgd028404
	for <java-user@lucene.apache.org>; Wed, 28 May 2008 10:21:19 +0200 (CEST)
Message-ID: <483D15FF.2000902@gmail.com>
Date: Wed, 28 May 2008 10:21:19 +0200
From: Christian Reuschling <christian.reuschling@gmail.com>
User-Agent: Thunderbird 2.0.0.12 (X11/20080226)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Refreshing IndexReaders for our desktop searching app
X-Enigmail-Version: 0.95.6
OpenPGP: id=AF96660F;
	url=hkp://wwwkeys.eu.pgp.net
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="------------enig9852BE5F1E1504FEC20D7FF6"
X-Virus-Checked: Checked by ClamAV on apache.org

--------------enig9852BE5F1E1504FEC20D7FF6
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: quoted-printable

Hello out there,

We have implemented some open source desktop searching app based on Lucen=
e
http://sourceforge.net/projects/dynaq

Development always goes further, and currently we make experiments with t=
he
file-lock based writer (/reader) synchronization capabilities of Lucene, =
in
order to waste our current synchronization method, which is not such comf=
ortable
to use.

I have a global writer Object and an according Reader, which is also glob=
al
accessible inside the application. For both there are getter methods, ins=
ide
the getReader() method we check with reader.isCurrent() whether there are=

modifications inside the index or not. In the case there are modification=
s,
I close the reader and create a new one, returning it.

And this is exactly the problem. In the case there are still some referen=
ces
to the old reader object, I get an IndexAlreadyClosedException.

I'm thinking for a while about this problem, and have also searched long =
time
inside the Lucene mailing list repository. The root of the problem is not=
 to
close a reader Object if there is at least one reference to it left.

To ensure this, for my impression, we have the following possibilities:

1. Add a new method 'release reader' and count whether there are some unr=
eleased
    reader Objects left. Only close if not. This makes coding much less c=
omfortable,
    if you forget to release a reader after using it, it will end in exce=
ssive
    debugging sessions. Further, I personally think that this is not the =
'spirit'
    of Lucene for this scenario...correct me if I'm wrong  ;)

2. Add a finalizer to the reader object and perform a close() there. Refe=
rences to
    reader objects will stay valid. For this, I have to wrap the all Read=
ers in order
    to add the finalize()...the wrap is also not so nice

3. Use the garbage collector for counting the references, and - maybe - u=
se
    PhantomReferences to initialize a close process. I don't exactly know=
 whether
    this is possible, because the Phantom reference gets null for its ref=
erent, so
    the invocation oof close() seems to be unpossible...

4. Simply don't close the reader Objects, and hope that this is no proble=
m..


To change this hope into knowledge: Is it critical NOT closing an IndexRe=
ader Object
in the case it is used only and entirely read-only? We use the new IndexW=
riter
to delete documents in all cases.

If it is critical - is there a common  - or uncommon but good - solution =
for this, that
I have forgotten?


Christian



--------------enig9852BE5F1E1504FEC20D7FF6
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.4-svn0 (GNU/Linux)
Comment: Using GnuPG with SUSE - http://enigmail.mozdev.org

iD8DBQFIPRX/6EqMXq+WZg8RAkPJAJ4gn8yEMxEDn5vT9cEpLQsG1/PDIQCgsZVj
tmXlpzX70zEaEND6By8IkFc=
=eGYJ
-----END PGP SIGNATURE-----

--------------enig9852BE5F1E1504FEC20D7FF6--

From java-user-return-34190-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 09:36:53 2008
Return-Path: <java-user-return-34190-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47459 invoked from network); 28 May 2008 09:36:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 09:36:52 -0000
Received: (qmail 56906 invoked by uid 500); 28 May 2008 09:36:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56870 invoked by uid 500); 28 May 2008 09:36:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56858 invoked by uid 99); 28 May 2008 09:36:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 02:36:47 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stefano.coppi@gmail.com designates 66.249.92.168 as permitted sender)
Received: from [66.249.92.168] (HELO ug-out-1314.google.com) (66.249.92.168)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 09:36:00 +0000
Received: by ug-out-1314.google.com with SMTP id h3so79773ugf.29
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 02:36:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=ZCRQkoIPSDtTRYpWSkyKOqCCYQF8AywB6l1FhFqNPeI=;
        b=m2zj5D2NQoaHRCG2v5Xzapy99791LHFoVOhVxLBcJhnQ3aK07oY+0k9z1PIV5UCaA/SiZAY33jaEYOj9IExmU/9rT51qn3wguNn+/I4d6NSa4jbJCh7Y9957kO/HAOPXjj/rysa7fAMSDxpCzWwoiiIAtp/oNpeupcOZCQrEqy0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=i0yUSTETVGlFUB+dzWZ3tjhXG06Y/JL3vFYiSAfCAD4RB/9PvLxyXD9ObDW61M8SKg32m5585GJ2sjCC0hgLuc6Jb9JrRRK+H+DiPE3qsYQYwKuSkD4koGQkJwDrk5pAXdracC4ZvjdZu3+Ap6fYQxphdFJ5CnulsrZina+Sg5U=
Received: by 10.86.95.20 with SMTP id s20mr6527957fgb.70.1211967375415;
        Wed, 28 May 2008 02:36:15 -0700 (PDT)
Received: by 10.86.86.1 with HTTP; Wed, 28 May 2008 02:36:15 -0700 (PDT)
Message-ID: <a2e3b6200805280236i5e624ee1k8f13c9bbc8b25873@mail.gmail.com>
Date: Wed, 28 May 2008 11:36:15 +0200
From: "stefano coppi" <stefano.coppi@gmail.com>
To: java-user@lucene.apache.org
Subject: proximity search
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_13907_28323117.1211967375411"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_13907_28323117.1211967375411
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hello everyone,

I'm testing the use of proximity search operator (~) in Lucene.
I noticed a strange behaviour when the terms in the text are not in the same
order of the query.
Here are some examples:

 text: AA BB
query: "AA BB"~0
result: true

 text: AA ZZ BB
query: "AA BB"~0
result: false

 text: AA ZZ BB
query: "AA BB"~1
result: true

 text: BB AA
query: "AA BB"~0 why the result is false? Aren't BB AA contigous?
result: false

 text: BB AA
query: "AA BB"~1
result: false

 text: BB AA
query: "AA BB"~2 why with proximity=2 the result is true??
result: true

 text: BB ZZ AA
query: "AA BB"~2
result: false

text: BB ZZ AA
query: "A B"~3 why with proximity=3 the result is true??
result: true

text: AA ZZ BB CC
query; "AA BB CC"~0
result: false

 text: AA ZZ BB CC
query; "AA BB CC"~1
result: true

 text: CC BB  AA
query; "AA BB CC"~3
result: false

 text: CC BB  AA
query; "AA BB CC"~4
result: true

 text: CC AA BB
query; "AA BB CC"~2
result: false

 text: CC AA BB
query; "AA BB CC"~3
result: true

Does anyone know why Lucene behaves in that way??

Thanks,
Eng. Stefano Coppi

Information Systems Consultant

IC Technology s.r.l. - Gruppo InfoCamere SCpA
Via Bertolini, 37/C
70125 - Bari - Italy

------=_Part_13907_28323117.1211967375411--

From java-user-return-34191-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 09:44:12 2008
Return-Path: <java-user-return-34191-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51004 invoked from network); 28 May 2008 09:44:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 09:44:12 -0000
Received: (qmail 65470 invoked by uid 500); 28 May 2008 09:44:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65447 invoked by uid 500); 28 May 2008 09:44:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65436 invoked by uid 99); 28 May 2008 09:44:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 02:44:07 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 131.246.120.220 is neither permitted nor denied by domain of christian.reuschling@gmail.com)
Received: from [131.246.120.220] (HELO mailgw1.uni-kl.de) (131.246.120.220)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 09:43:19 +0000
Received: from dfki.uni-kl.de (dfki-1002.dfki.uni-kl.de [131.246.195.2])
	by mailgw1.uni-kl.de (8.13.8/8.13.8/Debian-3) with ESMTP id m4S9hNnr003257
	for <java-user@lucene.apache.org>; Wed, 28 May 2008 11:43:29 +0200
Received: from serv-4100.kl.dfki.de (serv-4100.kl.dfki.de [192.168.41.180])
	by dfki.uni-kl.de (8.13.8+Sun/8.11.4) with ESMTP id m4S9hJFU010022
	for <java-user@lucene.apache.org>; Wed, 28 May 2008 11:43:19 +0200 (CEST)
Received: from [192.168.41.166] (pc-4176.kl.dfki.de [192.168.41.166])
	by serv-4100.kl.dfki.de (8.13.8+Sun/8.13.8) with ESMTP id m4S9hIYd008008
	for <java-user@lucene.apache.org>; Wed, 28 May 2008 11:43:18 +0200 (CEST)
Message-ID: <483D2936.2030103@gmail.com>
Date: Wed, 28 May 2008 11:43:18 +0200
From: Christian Reuschling <christian.reuschling@gmail.com>
User-Agent: Thunderbird 2.0.0.12 (X11/20080226)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Refreshing IndexReaders for our desktop searching app
X-Enigmail-Version: 0.95.6
OpenPGP: id=AF96660F;
	url=hkp://wwwkeys.eu.pgp.net
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hello out there,

We have implemented some open source desktop searching app based on Lucene
http://sourceforge.net/projects/dynaq

Development always goes further, and currently we make experiments with the
file-lock based writer (/reader) synchronization capabilities of Lucene, in
order to waste our current synchronization method, which is not such comfortable
to use.

I have a global writer Object and an according Reader, which is also global
accessible inside the application. For both there are getter methods, inside
the getReader() method we check with reader.isCurrent() whether there are
modifications inside the index or not. In the case there are modifications,
I close the reader and create a new one, returning it.

And this is exactly the problem. In the case there are still some references
to the old reader object, I get an IndexAlreadyClosedException.

I'm thinking for a while about this problem, and have also searched long time
inside the Lucene mailing list repository. The root of the problem is not to
close a reader Object if there is at least one reference to it left.

To ensure this, for my impression, we have the following possibilities:

1. Add a new method 'release reader' and count whether there are some unreleased
    reader Objects left. Only close if not. This makes coding much less comfortable,
    if you forget to release a reader after using it, it will end in excessive
    debugging sessions. Further, I personally think that this is not the 'spirit'
    of Lucene for this scenario...correct me if I'm wrong   ;)

2. Add a finalizer to the reader object and perform a close() there. References to
    reader objects will stay valid. For this, I have to wrap the all Readers in order
    to add the finalize()...the wrap is also not so nice

3. Use the garbage collector for counting the references, and - maybe - use
    PhantomReferences to initialize a close process. I don't exactly know whether
    this is possible, because the Phantom reference gets null for its referent, so
    the invocation oof close() seems to be unpossible...

4. Simply don't close the reader Objects, and hope that this is no problem..


To change this hope into knowledge: Is it critical NOT closing an IndexReader Object
in the case it is used only and entirely read-only? We use the new IndexWriter
to delete documents in all cases.

If it is critical - is there a common  - or uncommon but good - solution for this, that
I have forgotten?


Christian


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34192-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 10:03:04 2008
Return-Path: <java-user-return-34192-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57569 invoked from network); 28 May 2008 10:03:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 10:03:04 -0000
Received: (qmail 4822 invoked by uid 500); 28 May 2008 10:02:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4798 invoked by uid 500); 28 May 2008 10:02:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4787 invoked by uid 99); 28 May 2008 10:02:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 03:02:58 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nttstar@gmail.com designates 209.85.142.186 as permitted sender)
Received: from [209.85.142.186] (HELO ti-out-0910.google.com) (209.85.142.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 10:02:11 +0000
Received: by ti-out-0910.google.com with SMTP id b8so2227270tic.11
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 03:02:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=Tdv6XDo5apBcJfnTwCufMF3HAHXxIYHS21TYaMqgzX0=;
        b=lCe/1xmOrokteDnne3Da61bqoH6TcKle1nWCKlkWcibjhPTo69+M4YDWqGi66LcakkP1+PwJ7+dFn5bdOmeqmmvhjEo1WjFxrhJfOm1KLRl+cY7DfkQRv6El7spchjDNE6xWNifZnQ2sCuV6JILRntT4J9HjDW8P3lOcMPizLfU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=v8woeNt0r75DMb9jIvxk4fPIUGqdp2U5lMzRBjx/yTOivGgtIAbzJsogae/epWf1G3AhxpHxq6HyzWUWPQLFvFD3MY7bzc6wYckU4BMST4nGMZqrOYBmb6fLaSAKyUDcZsDYYMBHfTDMvomKE9xFbriv9pFqBSiS2iUQv8QM/jQ=
Received: by 10.110.37.17 with SMTP id k17mr347737tik.13.1211968945128;
        Wed, 28 May 2008 03:02:25 -0700 (PDT)
Received: by 10.110.16.20 with HTTP; Wed, 28 May 2008 03:02:24 -0700 (PDT)
Message-ID: <11e088b10805280302q933d019k2a7baad10d43e04f@mail.gmail.com>
Date: Wed, 28 May 2008 18:02:24 +0800
From: "=?GB2312?B?uf280Q==?=" <nttstar@gmail.com>
To: java-user@lucene.apache.org
Subject: How to add PageRank score with lucene's relevant score in sorting
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_19456_20267765.1211968945115"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_19456_20267765.1211968945115
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

hi all ,
     I have a problem that how to "combine" two score to sort the search
result documents.
     for example I  have 10 million pages in lucene index , and i know their
pagerank scores. i give a query to it , every docs returned have a
lucene-score, mark it as R (relevant score), and  i  also  have its
pagerank score, mark it as P,  what i need is i want to sort the search
result base on the value "P+R".  You know if i store the pagerank score in
index and get it every search time , then compute P+R , then sort it , this
way is too slow. in my system , when the search hits 500000 result , the
sort may cost about 20s.
   Sorry for my poor english.  Anyone has a good idea?

Best
Jarvis

------=_Part_19456_20267765.1211968945115--

From java-user-return-34193-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 10:12:56 2008
Return-Path: <java-user-return-34193-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60044 invoked from network); 28 May 2008 10:12:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 10:12:56 -0000
Received: (qmail 15834 invoked by uid 500); 28 May 2008 10:12:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15810 invoked by uid 500); 28 May 2008 10:12:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15799 invoked by uid 99); 28 May 2008 10:12:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 03:12:49 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 209.85.146.182 as permitted sender)
Received: from [209.85.146.182] (HELO wa-out-1112.google.com) (209.85.146.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 10:12:02 +0000
Received: by wa-out-1112.google.com with SMTP id l24so3244598waf.11
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 03:12:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=/u4P73vqwA30R3Ymmvyx1jMPPaxcjYV4Fx7A4rHIrQM=;
        b=IfYJiyMO9BqfSex805pnyHpqCP8IFAW0bXYlNsYF8iHtWD4any4W9izeKFWquPkqxhm5eNliXBXS1fH8sKXfX4AYggcte1FqX45llFZAjRwxzmpLeCu5UmkFSUd7XEfgS5sGRn7q94t9UNNrkjcEk9lgUHgR4uY0i0pducl5zig=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=nhT6I99xe5MeOzn1vXKam7+eusV2+uOJPK/V8DEcsAjC9GCFKDh9MKI6c5KzvUr27MgDIPwVdOb3Z+rJs/1HJMqkFJuaUUX4NXzpKqDu7K679Fv9QlbKU+kt5AmK4HfCm6KLiXXsvZNpG5yZdUpUl2OdNsLFBsW3knBMhQvbEow=
Received: by 10.115.16.1 with SMTP id t1mr2312771wai.19.1211969538574;
        Wed, 28 May 2008 03:12:18 -0700 (PDT)
Received: by 10.114.210.9 with HTTP; Wed, 28 May 2008 03:12:18 -0700 (PDT)
Message-ID: <8c4e68610805280312wc7e7d9at399a323d9f248832@mail.gmail.com>
Date: Wed, 28 May 2008 11:12:18 +0100
From: "Ian Lea" <ian.lea@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to add PageRank score with lucene's relevant score in sorting
In-Reply-To: <11e088b10805280302q933d019k2a7baad10d43e04f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: base64
Content-Disposition: inline
References: <11e088b10805280302q933d019k2a7baad10d43e04f@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkKCgpNYXliZSB5b3UgY291bGQgdXNlIHRoZSBwYWdlcmFuayBzY29yZSwgcG9zc2libHkgbW9k
aWZpZWQsIGFzIGRvY3VtZW50CmJvb3N0IGF0IGluZGV4aW5nIHRpbWUuICBGcm9tIHRoZSBqYXZh
ZG9jcyBmb3IKRG9jdW1lbnQuc2V0Qm9vc3QoYm9vc3QpCgoiU2V0cyBhIGJvb3N0IGZhY3RvciBm
b3IgaGl0cyBvbiBhbnkgZmllbGQgb2YgdGhpcyBkb2N1bWVudC4gVGhpcwp2YWx1ZSB3aWxsIGJl
IG11bHRpcGxpZWQgaW50byB0aGUgc2NvcmUgb2YgYWxsIGhpdHMgb24gdGhpcyBkb2N1bWVudCIK
CnNvIHdpbGwgZ2l2ZSB5b3UgUCAqIFIgcmF0aGVyIHRoYW4gUCArIFIuICBTaG91bGQgYmUgcXVp
Y2ssIHRob3VnaC4KCgotLQpJYW4uCgoKT24gV2VkLCBNYXkgMjgsIDIwMDggYXQgMTE6MDIgQU0s
ILn9vNEgPG50dHN0YXJAZ21haWwuY29tPiB3cm90ZToKPiBoaSBhbGwgLAo+ICAgICBJIGhhdmUg
YSBwcm9ibGVtIHRoYXQgaG93IHRvICJjb21iaW5lIiB0d28gc2NvcmUgdG8gc29ydCB0aGUgc2Vh
cmNoCj4gcmVzdWx0IGRvY3VtZW50cy4KPiAgICAgZm9yIGV4YW1wbGUgSSAgaGF2ZSAxMCBtaWxs
aW9uIHBhZ2VzIGluIGx1Y2VuZSBpbmRleCAsIGFuZCBpIGtub3cgdGhlaXIKPiBwYWdlcmFuayBz
Y29yZXMuIGkgZ2l2ZSBhIHF1ZXJ5IHRvIGl0ICwgZXZlcnkgZG9jcyByZXR1cm5lZCBoYXZlIGEK
PiBsdWNlbmUtc2NvcmUsIG1hcmsgaXQgYXMgUiAocmVsZXZhbnQgc2NvcmUpLCBhbmQgIGkgIGFs
c28gIGhhdmUgaXRzCj4gcGFnZXJhbmsgc2NvcmUsIG1hcmsgaXQgYXMgUCwgIHdoYXQgaSBuZWVk
IGlzIGkgd2FudCB0byBzb3J0IHRoZSBzZWFyY2gKPiByZXN1bHQgYmFzZSBvbiB0aGUgdmFsdWUg
IlArUiIuICBZb3Uga25vdyBpZiBpIHN0b3JlIHRoZSBwYWdlcmFuayBzY29yZSBpbgo+IGluZGV4
IGFuZCBnZXQgaXQgZXZlcnkgc2VhcmNoIHRpbWUgLCB0aGVuIGNvbXB1dGUgUCtSICwgdGhlbiBz
b3J0IGl0ICwgdGhpcwo+IHdheSBpcyB0b28gc2xvdy4gaW4gbXkgc3lzdGVtICwgd2hlbiB0aGUg
c2VhcmNoIGhpdHMgNTAwMDAwIHJlc3VsdCAsIHRoZQo+IHNvcnQgbWF5IGNvc3QgYWJvdXQgMjBz
Lgo+ICAgU29ycnkgZm9yIG15IHBvb3IgZW5nbGlzaC4gIEFueW9uZSBoYXMgYSBnb29kIGlkZWE/
Cj4KPiBCZXN0Cj4gSmFydmlzCj4K


From java-user-return-34194-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 10:41:48 2008
Return-Path: <java-user-return-34194-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67298 invoked from network); 28 May 2008 10:41:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 10:41:48 -0000
Received: (qmail 48757 invoked by uid 500); 28 May 2008 10:41:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48721 invoked by uid 500); 28 May 2008 10:41:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48710 invoked by uid 99); 28 May 2008 10:41:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 03:41:42 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 209.85.146.176 as permitted sender)
Received: from [209.85.146.176] (HELO wa-out-1112.google.com) (209.85.146.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 10:40:55 +0000
Received: by wa-out-1112.google.com with SMTP id l24so3255823waf.11
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 03:41:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=31lh/XySVkM7NbRgq6YLPDNJXYrEzsksLmaip8Mi1lw=;
        b=toHUqZpBspPQu3Vrk4uDzwxTNlXKSqMei5UBZZui+kWfsSZtTKI1DHyNUEyO6Huq0JTJcAs/hI88bg1+Rz6Ju05k/xPzyY8JXuLALXQP+ddkc90y8agrAEJnCllsRP0qN4wqvcgoM37jNLToJN0KjGIhybMQExRKjmiet3IrcqE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=naDAseHhwbLur2mg/hwC3hz4/Q6BaaZNdPaeojQ6zkbYb/RsWT8IiHUvQkLDGaqW/2fDJgHKSqVR9nlUiC5Adq3uZlD2RhhAa77f+LT3kGsXyzGMUeHMMoQ4Oj9J5aB0mGpXsTTEmR7tWp8oOdLsSjy1hloVWVQ9c0wQc7y/zW0=
Received: by 10.114.159.1 with SMTP id h1mr2319006wae.98.1211971271762;
        Wed, 28 May 2008 03:41:11 -0700 (PDT)
Received: by 10.114.210.9 with HTTP; Wed, 28 May 2008 03:41:11 -0700 (PDT)
Message-ID: <8c4e68610805280341j6e40803g226405df6c8f831f@mail.gmail.com>
Date: Wed, 28 May 2008 11:41:11 +0100
From: "Ian Lea" <ian.lea@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Refreshing IndexReaders for our desktop searching app
In-Reply-To: <483D15FF.2000902@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <483D15FF.2000902@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi


I think that you will need to close your reader objects.  Hanging on
to them may prevent files from being deleted and you are likely to hit
memory or open file limitations.

We generally use a low tech approach:

 save reference to old reader/searcher
 create new one and give that out to those who want it
 sleep for as long as longest searches normally take
 close old reader.

Works for us.


--
Ian.

P.S.  Please don't post same message twice.


On Wed, May 28, 2008 at 9:21 AM, Christian Reuschling
<christian.reuschling@gmail.com> wrote:
> Hello out there,
>
> We have implemented some open source desktop searching app based on Lucene
> http://sourceforge.net/projects/dynaq
>
> Development always goes further, and currently we make experiments with the
> file-lock based writer (/reader) synchronization capabilities of Lucene, in
> order to waste our current synchronization method, which is not such
> comfortable
> to use.
>
> I have a global writer Object and an according Reader, which is also global
> accessible inside the application. For both there are getter methods, inside
> the getReader() method we check with reader.isCurrent() whether there are
> modifications inside the index or not. In the case there are modifications,
> I close the reader and create a new one, returning it.
>
> And this is exactly the problem. In the case there are still some references
> to the old reader object, I get an IndexAlreadyClosedException.
>
> I'm thinking for a while about this problem, and have also searched long
> time
> inside the Lucene mailing list repository. The root of the problem is not to
> close a reader Object if there is at least one reference to it left.
>
> To ensure this, for my impression, we have the following possibilities:
>
> 1. Add a new method 'release reader' and count whether there are some
> unreleased
>   reader Objects left. Only close if not. This makes coding much less
> comfortable,
>   if you forget to release a reader after using it, it will end in excessive
>   debugging sessions. Further, I personally think that this is not the
> 'spirit'
>   of Lucene for this scenario...correct me if I'm wrong  ;)
>
> 2. Add a finalizer to the reader object and perform a close() there.
> References to
>   reader objects will stay valid. For this, I have to wrap the all Readers
> in order
>   to add the finalize()...the wrap is also not so nice
>
> 3. Use the garbage collector for counting the references, and - maybe - use
>   PhantomReferences to initialize a close process. I don't exactly know
> whether
>   this is possible, because the Phantom reference gets null for its
> referent, so
>   the invocation oof close() seems to be unpossible...
>
> 4. Simply don't close the reader Objects, and hope that this is no problem..
>
>
> To change this hope into knowledge: Is it critical NOT closing an
> IndexReader Object
> in the case it is used only and entirely read-only? We use the new
> IndexWriter
> to delete documents in all cases.
>
> If it is critical - is there a common  - or uncommon but good - solution for
> this, that
> I have forgotten?
>
>
> Christian
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34195-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 11:33:25 2008
Return-Path: <java-user-return-34195-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4142 invoked from network); 28 May 2008 11:33:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 11:33:25 -0000
Received: (qmail 25183 invoked by uid 500); 28 May 2008 11:33:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25144 invoked by uid 500); 28 May 2008 11:33:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25133 invoked by uid 99); 28 May 2008 11:33:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 04:33:19 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.132.249 as permitted sender)
Received: from [209.85.132.249] (HELO an-out-0708.google.com) (209.85.132.249)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 11:32:31 +0000
Received: by an-out-0708.google.com with SMTP id c37so657526anc.49
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 04:32:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=zFgjv0bXWUEjpqjGXWsIuWwfaBgMdlpjHCXc2RfO5Vw=;
        b=fGulBWzAhU9bf/bfFcKERGOBcW6x4Cgg99gyXUKXAClvkmmThfX9wH/x7Md+ZLGYQiczLj81Y7Uh0+MivotCICFnfkEU4k3Xzq6J6LVFexZjSdkeaZHLZyzssSTESKRL2jLMDXaYnnnHqhEi4GRTg4HRadOha7t+Abjw9pvLWZc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=hhu98Nptyu8GMRaiqNn95dgBzCsKyxZeiuGXeB8W20kOiS7X4VmxLAptscN9heRlDJbaxbGCuzEuPQ8MbR5FqS6241Mq+eYDZPh/V7K3kPChGkGjJth7HKsujdSENuo6XmeXyj+xe6321gY84F3bhmlTxpMx3IFXul86Zt0Y01w=
Received: by 10.100.41.9 with SMTP id o9mr3635864ano.42.1211974366820;
        Wed, 28 May 2008 04:32:46 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id e10sm11794013qbe.24.2008.05.28.04.32.45
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 28 May 2008 04:32:46 -0700 (PDT)
Message-ID: <483D42DD.6000403@gmail.com>
Date: Wed, 28 May 2008 07:32:45 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Refreshing IndexReaders for our desktop searching app
References: <483D15FF.2000902@gmail.com> <8c4e68610805280341j6e40803g226405df6c8f831f@mail.gmail.com>
In-Reply-To: <8c4e68610805280341j6e40803g226405df6c8f831f@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

If you are using a more recent version of Lucene you might check out 
https://issues.apache.org/jira/browse/LUCENE-1026 and try the 
WarmingIndexAccessor. Even if you don't use it, it will serve as a 
decent example.


Ian Lea wrote:
> Hi
>
>
> I think that you will need to close your reader objects.  Hanging on
> to them may prevent files from being deleted and you are likely to hit
> memory or open file limitations.
>
> We generally use a low tech approach:
>
>  save reference to old reader/searcher
>  create new one and give that out to those who want it
>  sleep for as long as longest searches normally take
>  close old reader.
>
> Works for us.
>
>
> --
> Ian.
>
> P.S.  Please don't post same message twice.
>
>
> On Wed, May 28, 2008 at 9:21 AM, Christian Reuschling
> <christian.reuschling@gmail.com> wrote:
>   
>> Hello out there,
>>
>> We have implemented some open source desktop searching app based on Lucene
>> http://sourceforge.net/projects/dynaq
>>
>> Development always goes further, and currently we make experiments with the
>> file-lock based writer (/reader) synchronization capabilities of Lucene, in
>> order to waste our current synchronization method, which is not such
>> comfortable
>> to use.
>>
>> I have a global writer Object and an according Reader, which is also global
>> accessible inside the application. For both there are getter methods, inside
>> the getReader() method we check with reader.isCurrent() whether there are
>> modifications inside the index or not. In the case there are modifications,
>> I close the reader and create a new one, returning it.
>>
>> And this is exactly the problem. In the case there are still some references
>> to the old reader object, I get an IndexAlreadyClosedException.
>>
>> I'm thinking for a while about this problem, and have also searched long
>> time
>> inside the Lucene mailing list repository. The root of the problem is not to
>> close a reader Object if there is at least one reference to it left.
>>
>> To ensure this, for my impression, we have the following possibilities:
>>
>> 1. Add a new method 'release reader' and count whether there are some
>> unreleased
>>   reader Objects left. Only close if not. This makes coding much less
>> comfortable,
>>   if you forget to release a reader after using it, it will end in excessive
>>   debugging sessions. Further, I personally think that this is not the
>> 'spirit'
>>   of Lucene for this scenario...correct me if I'm wrong  ;)
>>
>> 2. Add a finalizer to the reader object and perform a close() there.
>> References to
>>   reader objects will stay valid. For this, I have to wrap the all Readers
>> in order
>>   to add the finalize()...the wrap is also not so nice
>>
>> 3. Use the garbage collector for counting the references, and - maybe - use
>>   PhantomReferences to initialize a close process. I don't exactly know
>> whether
>>   this is possible, because the Phantom reference gets null for its
>> referent, so
>>   the invocation oof close() seems to be unpossible...
>>
>> 4. Simply don't close the reader Objects, and hope that this is no problem..
>>
>>
>> To change this hope into knowledge: Is it critical NOT closing an
>> IndexReader Object
>> in the case it is used only and entirely read-only? We use the new
>> IndexWriter
>> to delete documents in all cases.
>>
>> If it is critical - is there a common  - or uncommon but good - solution for
>> this, that
>> I have forgotten?
>>
>>
>> Christian
>>
>>
>>
>>     
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34196-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 11:44:41 2008
Return-Path: <java-user-return-34196-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8938 invoked from network); 28 May 2008 11:44:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 11:44:40 -0000
Received: (qmail 36469 invoked by uid 500); 28 May 2008 11:44:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36446 invoked by uid 500); 28 May 2008 11:44:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36435 invoked by uid 99); 28 May 2008 11:44:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 04:44:35 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of sonusr@gmail.com designates 64.233.184.235 as permitted sender)
Received: from [64.233.184.235] (HELO wr-out-0506.google.com) (64.233.184.235)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 11:43:48 +0000
Received: by wr-out-0506.google.com with SMTP id c30so1728618wra.14
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 04:44:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=vb4DW/JHfYFz90Q0ja524ZuvJ/BerwN5YIu/pliiBsE=;
        b=fDrz/RlQh0hS+HwIARiQpjfXy8I0yyXdnqeIeHAC2MkS5DShmKPNsTGmMb5uGaWRxJTVgrtbDijsGfzkTH5uRnSQqTV13ZHFPk4S0PgtN4QLDDmIxgmV8nOruzc/9DNbDD/8lbb9xGHCS8l+UclowEdFKOMR3jGYHTH0+P+0tkE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=PFDmYjW/2NEhcAI7dsniiMvg6tHQ4G7l3+ElXxQS3KaLLX1+0Js238rKLallFOMYg6bg07fQ7IgixUY5qGoHogowMkJ3RZAs2DI3mQscPruf750Q4xhKGqyGA9dF0aCGZHW35mY46DjYuHvZsmsFqKfyKe+TSY/7PBjmNOMO/ig=
Received: by 10.143.36.15 with SMTP id o15mr996074wfj.182.1211975043067;
        Wed, 28 May 2008 04:44:03 -0700 (PDT)
Received: by 10.142.132.12 with HTTP; Wed, 28 May 2008 04:44:03 -0700 (PDT)
Message-ID: <d5b3ea330805280444s313e0e86n5948ac73081263c0@mail.gmail.com>
Date: Wed, 28 May 2008 17:14:03 +0530
From: "Sonu Sudhakar" <sonusr@gmail.com>
To: java-user@lucene.apache.org
Subject: Boolean Query Issue
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_10497_11417580.1211975043066"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_10497_11417580.1211975043066
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,

I have some issue with boolean queries.

I am using Lucene-core-2.3.1.

I have done test on boolean query with 3 terms (data, store, variable) in my
TTL field. The TTL field is indexed and searched using StandardAnalyzer.

The three terms when searched individually gave the following result

1. TTL:data  => 3,733 results
2. TTL:store  => 76 results
3. TTL:variable  => 1,496 results

But found issue when combining these terms with boolean operators.

e.g.
1. TTL:data AND TTL:store OR TTL:variable => 3,733 results
it considered the TTL:data part only.

2. TTL:store AND TTL:data OR TTL:variable => 76 results
it considered  the TTL:store part only.

3. TTL:variable AND TTL:data OR  TTL:store => 1,496 results
it considered  the TTL:variable part only.

But I am getting correct result when combining terms with 'AND' operator. I
think the issue is with 'OR' operator.


Could anybody give an explanation for this behavior of lucene?
Could you give suggestions to rectify this?

Thanks,
Sonu

------=_Part_10497_11417580.1211975043066--

From java-user-return-34197-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 11:48:35 2008
Return-Path: <java-user-return-34197-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10150 invoked from network); 28 May 2008 11:48:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 11:48:34 -0000
Received: (qmail 40903 invoked by uid 500); 28 May 2008 11:48:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40860 invoked by uid 500); 28 May 2008 11:48:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40849 invoked by uid 99); 28 May 2008 11:48:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 04:48:30 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nttstar@gmail.com designates 209.85.142.189 as permitted sender)
Received: from [209.85.142.189] (HELO ti-out-0910.google.com) (209.85.142.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 11:47:43 +0000
Received: by ti-out-0910.google.com with SMTP id b8so2241217tic.11
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 04:47:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=Tbd2DAdfFJJjDVp3c9lDZbJJgTjUzjM9lhWJWHxYQ5o=;
        b=ppEcaNDPn58UxorwLJCjgEw0vH2Yjcb+E9J9nIfAakWLC3jZjkVok6gXGuAiKOK9C/VM9bTX3NeGO1DGlAyFacuYclZffEda2NL+OJ2oEhDSNmr7KjMD4hVlxGwRt3u2shwioRa6RCDyCRsQMaaQjA+ynpwkzzs+DDfa55hqK6M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=URRllAkWi/ZSqwfdbLJUErC2Lq3J4LJfnenKICO7/2FqUiCv9fGAf+WjOHhnIJ/Mxnk8Y3TlqwT3iejMMau4mk9OmgeCLU1nRTGIgCwCg8pleqyzY6ggfWytDlM9BoU34V5LUS3rgAPoP+pFWlwfm4l/4JEp8jbDWeaF8vUWcSE=
Received: by 10.110.28.15 with SMTP id b15mr360174tib.26.1211975278596;
        Wed, 28 May 2008 04:47:58 -0700 (PDT)
Received: by 10.110.16.20 with HTTP; Wed, 28 May 2008 04:47:58 -0700 (PDT)
Message-ID: <11e088b10805280447w35d83c4ewc076a6ce2778f25@mail.gmail.com>
Date: Wed, 28 May 2008 19:47:58 +0800
From: "=?GB2312?B?uf280Q==?=" <nttstar@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to add PageRank score with lucene's relevant score in sorting
In-Reply-To: <8c4e68610805280312wc7e7d9at399a323d9f248832@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_20145_10924757.1211975278589"
References: <11e088b10805280302q933d019k2a7baad10d43e04f@mail.gmail.com>
	 <8c4e68610805280312wc7e7d9at399a323d9f248832@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_20145_10924757.1211975278589
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: base64
Content-Disposition: inline

dGhhbmtzIGxhbiwgYnV0IHRoaXMgbWVhbnMgdGhhdCBpIG11c3QgcmVpbmRleCB0aGVzZSBwYWdl
cyB3aGlsZSB0aGUKcGFnZXJhbmsgc2NvcmUgY2hhbmdlZD8KCtTaMDgtNS0yOKOsSWFuIExlYSA8
aWFuLmxlYUBnbWFpbC5jb20+INC0tcCjugo+Cj4gSGkKPgo+Cj4gTWF5YmUgeW91IGNvdWxkIHVz
ZSB0aGUgcGFnZXJhbmsgc2NvcmUsIHBvc3NpYmx5IG1vZGlmaWVkLCBhcyBkb2N1bWVudAo+IGJv
b3N0IGF0IGluZGV4aW5nIHRpbWUuICBGcm9tIHRoZSBqYXZhZG9jcyBmb3IKPiBEb2N1bWVudC5z
ZXRCb29zdChib29zdCkKPgo+ICJTZXRzIGEgYm9vc3QgZmFjdG9yIGZvciBoaXRzIG9uIGFueSBm
aWVsZCBvZiB0aGlzIGRvY3VtZW50LiBUaGlzCj4gdmFsdWUgd2lsbCBiZSBtdWx0aXBsaWVkIGlu
dG8gdGhlIHNjb3JlIG9mIGFsbCBoaXRzIG9uIHRoaXMgZG9jdW1lbnQiCj4KPiBzbyB3aWxsIGdp
dmUgeW91IFAgKiBSIHJhdGhlciB0aGFuIFAgKyBSLiAgU2hvdWxkIGJlIHF1aWNrLCB0aG91Z2gu
Cj4KPgo+IC0tCj4gSWFuLgo+Cj4KPiBPbiBXZWQsIE1heSAyOCwgMjAwOCBhdCAxMTowMiBBTSwg
uf280SA8bnR0c3RhckBnbWFpbC5jb20+IHdyb3RlOgo+ID4gaGkgYWxsICwKPiA+ICAgICBJIGhh
dmUgYSBwcm9ibGVtIHRoYXQgaG93IHRvICJjb21iaW5lIiB0d28gc2NvcmUgdG8gc29ydCB0aGUg
c2VhcmNoCj4gPiByZXN1bHQgZG9jdW1lbnRzLgo+ID4gICAgIGZvciBleGFtcGxlIEkgIGhhdmUg
MTAgbWlsbGlvbiBwYWdlcyBpbiBsdWNlbmUgaW5kZXggLCBhbmQgaSBrbm93Cj4gdGhlaXIKPiA+
IHBhZ2VyYW5rIHNjb3Jlcy4gaSBnaXZlIGEgcXVlcnkgdG8gaXQgLCBldmVyeSBkb2NzIHJldHVy
bmVkIGhhdmUgYQo+ID4gbHVjZW5lLXNjb3JlLCBtYXJrIGl0IGFzIFIgKHJlbGV2YW50IHNjb3Jl
KSwgYW5kICBpICBhbHNvICBoYXZlIGl0cwo+ID4gcGFnZXJhbmsgc2NvcmUsIG1hcmsgaXQgYXMg
UCwgIHdoYXQgaSBuZWVkIGlzIGkgd2FudCB0byBzb3J0IHRoZSBzZWFyY2gKPiA+IHJlc3VsdCBi
YXNlIG9uIHRoZSB2YWx1ZSAiUCtSIi4gIFlvdSBrbm93IGlmIGkgc3RvcmUgdGhlIHBhZ2VyYW5r
IHNjb3JlCj4gaW4KPiA+IGluZGV4IGFuZCBnZXQgaXQgZXZlcnkgc2VhcmNoIHRpbWUgLCB0aGVu
IGNvbXB1dGUgUCtSICwgdGhlbiBzb3J0IGl0ICwKPiB0aGlzCj4gPiB3YXkgaXMgdG9vIHNsb3cu
IGluIG15IHN5c3RlbSAsIHdoZW4gdGhlIHNlYXJjaCBoaXRzIDUwMDAwMCByZXN1bHQgLCB0aGUK
PiA+IHNvcnQgbWF5IGNvc3QgYWJvdXQgMjBzLgo+ID4gICBTb3JyeSBmb3IgbXkgcG9vciBlbmds
aXNoLiAgQW55b25lIGhhcyBhIGdvb2QgaWRlYT8KPiA+Cj4gPiBCZXN0Cj4gPiBKYXJ2aXMKPiA+
Cj4K
------=_Part_20145_10924757.1211975278589--

From java-user-return-34198-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 13:04:31 2008
Return-Path: <java-user-return-34198-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47222 invoked from network); 28 May 2008 13:04:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 13:04:31 -0000
Received: (qmail 50755 invoked by uid 500); 28 May 2008 13:04:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50498 invoked by uid 500); 28 May 2008 13:04:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50486 invoked by uid 99); 28 May 2008 13:04:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 06:04:25 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.162.182 as permitted sender)
Received: from [209.85.162.182] (HELO el-out-1112.google.com) (209.85.162.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 13:03:31 +0000
Received: by el-out-1112.google.com with SMTP id v27so1192056ele.14
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 06:03:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=KO7uyNV5kYPsnB6Eg9ACAZbPRWwD+YuweSVjh1l559w=;
        b=Wij5Yh2M8TMjkO3kk9ParQkunMWAOuula2TMR8OcwkYmh6k9q8XoizxYlAQv7nfuk84R8ckRDl2t6BCqE0K2VGrY35lepcMxxx7QxK7mHKbspdTI+rb6rgn6dPrXZMXPOuAl/RJrKOxTBPttyMeuS47HAb9PCu50S6jcaQ6uByw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=iZ1KVMNYO3UPwQrUXtvtUdbFJ30gjBe6Zyu5+/8gQuwtamOgq5ghNPyL5oK7Cy9EMicHuyWozN8iTPHhrFAAS9NG1EeryA2xocNrI1m7x9B+Mk1lsR5vHnkO4o1lGA1eSH1NCqWTQ3/fGqbXpWsEjJCkYc0IVbi3cv5+EKSXapU=
Received: by 10.114.159.17 with SMTP id h17mr2478344wae.227.1211979820860;
        Wed, 28 May 2008 06:03:40 -0700 (PDT)
Received: by 10.114.210.9 with HTTP; Wed, 28 May 2008 06:03:40 -0700 (PDT)
Message-ID: <8c4e68610805280603l51631a89t87de0764f7965439@mail.gmail.com>
Date: Wed, 28 May 2008 14:03:40 +0100
From: "Ian Lea" <ian.lea@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to add PageRank score with lucene's relevant score in sorting
In-Reply-To: <11e088b10805280447w35d83c4ewc076a6ce2778f25@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: base64
Content-Disposition: inline
References: <11e088b10805280302q933d019k2a7baad10d43e04f@mail.gmail.com>
	 <8c4e68610805280312wc7e7d9at399a323d9f248832@mail.gmail.com>
	 <11e088b10805280447w35d83c4ewc076a6ce2778f25@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

WWVzLiAgQnV0IHlvdSdkIGhhdmUgdG8gZG8gdGhhdCBhbnl3YXkgaWYgeW91IGFyZSBzdG9yaW5n
IHBhZ2VyYW5rIGluIHRoZSBpbmRleC4KCk9uZSBwb2ludCBvbiB5b3VyIDIwcyByZXNwb25zZSB0
aW1lIGZvciBzb3J0aW5nIC0gaXMgdGhhdCBmb3IgdGhlCmZpcnN0IHNvcnQgb3Igc3Vic2VxdWVu
dCBvbmVzPwpJIGJlbGlldmUgdGhhdCB0aGUgZmlyc3Qgb25lIHdpbGwgdXN1YWxseSBiZSBzdWJz
dGFudGlhbGx5IHNsb3dlci4KQnV0IHNvcnRpbmcgaXMgYWx3YXlzIGxpa2VseSB0byBiZSBzbG93
ZXIgdGhhbiBub3Qgc29ydGluZy4KCgotLQpJYW4uCgoKT24gV2VkLCBNYXkgMjgsIDIwMDggYXQg
MTI6NDcgUE0sILn9vNEgPG50dHN0YXJAZ21haWwuY29tPiB3cm90ZToKPiB0aGFua3MgbGFuLCBi
dXQgdGhpcyBtZWFucyB0aGF0IGkgbXVzdCByZWluZGV4IHRoZXNlIHBhZ2VzIHdoaWxlIHRoZQo+
IHBhZ2VyYW5rIHNjb3JlIGNoYW5nZWQ/Cj4KPiDU2jA4LTUtMjijrElhbiBMZWEgPGlhbi5sZWFA
Z21haWwuY29tPiDQtLXAo7oKPj4KPj4gSGkKPj4KPj4KPj4gTWF5YmUgeW91IGNvdWxkIHVzZSB0
aGUgcGFnZXJhbmsgc2NvcmUsIHBvc3NpYmx5IG1vZGlmaWVkLCBhcyBkb2N1bWVudAo+PiBib29z
dCBhdCBpbmRleGluZyB0aW1lLiAgRnJvbSB0aGUgamF2YWRvY3MgZm9yCj4+IERvY3VtZW50LnNl
dEJvb3N0KGJvb3N0KQo+Pgo+PiAiU2V0cyBhIGJvb3N0IGZhY3RvciBmb3IgaGl0cyBvbiBhbnkg
ZmllbGQgb2YgdGhpcyBkb2N1bWVudC4gVGhpcwo+PiB2YWx1ZSB3aWxsIGJlIG11bHRpcGxpZWQg
aW50byB0aGUgc2NvcmUgb2YgYWxsIGhpdHMgb24gdGhpcyBkb2N1bWVudCIKPj4KPj4gc28gd2ls
bCBnaXZlIHlvdSBQICogUiByYXRoZXIgdGhhbiBQICsgUi4gIFNob3VsZCBiZSBxdWljaywgdGhv
dWdoLgo+Pgo+Pgo+PiAtLQo+PiBJYW4uCj4+Cj4+Cj4+IE9uIFdlZCwgTWF5IDI4LCAyMDA4IGF0
IDExOjAyIEFNLCC5/bzRIDxudHRzdGFyQGdtYWlsLmNvbT4gd3JvdGU6Cj4+ID4gaGkgYWxsICwK
Pj4gPiAgICAgSSBoYXZlIGEgcHJvYmxlbSB0aGF0IGhvdyB0byAiY29tYmluZSIgdHdvIHNjb3Jl
IHRvIHNvcnQgdGhlIHNlYXJjaAo+PiA+IHJlc3VsdCBkb2N1bWVudHMuCj4+ID4gICAgIGZvciBl
eGFtcGxlIEkgIGhhdmUgMTAgbWlsbGlvbiBwYWdlcyBpbiBsdWNlbmUgaW5kZXggLCBhbmQgaSBr
bm93Cj4+IHRoZWlyCj4+ID4gcGFnZXJhbmsgc2NvcmVzLiBpIGdpdmUgYSBxdWVyeSB0byBpdCAs
IGV2ZXJ5IGRvY3MgcmV0dXJuZWQgaGF2ZSBhCj4+ID4gbHVjZW5lLXNjb3JlLCBtYXJrIGl0IGFz
IFIgKHJlbGV2YW50IHNjb3JlKSwgYW5kICBpICBhbHNvICBoYXZlIGl0cwo+PiA+IHBhZ2VyYW5r
IHNjb3JlLCBtYXJrIGl0IGFzIFAsICB3aGF0IGkgbmVlZCBpcyBpIHdhbnQgdG8gc29ydCB0aGUg
c2VhcmNoCj4+ID4gcmVzdWx0IGJhc2Ugb24gdGhlIHZhbHVlICJQK1IiLiAgWW91IGtub3cgaWYg
aSBzdG9yZSB0aGUgcGFnZXJhbmsgc2NvcmUKPj4gaW4KPj4gPiBpbmRleCBhbmQgZ2V0IGl0IGV2
ZXJ5IHNlYXJjaCB0aW1lICwgdGhlbiBjb21wdXRlIFArUiAsIHRoZW4gc29ydCBpdCAsCj4+IHRo
aXMKPj4gPiB3YXkgaXMgdG9vIHNsb3cuIGluIG15IHN5c3RlbSAsIHdoZW4gdGhlIHNlYXJjaCBo
aXRzIDUwMDAwMCByZXN1bHQgLCB0aGUKPj4gPiBzb3J0IG1heSBjb3N0IGFib3V0IDIwcy4KPj4g
PiAgIFNvcnJ5IGZvciBteSBwb29yIGVuZ2xpc2guICBBbnlvbmUgaGFzIGEgZ29vZCBpZGVhPwo+
PiA+Cj4+ID4gQmVzdAo+PiA+IEphcnZpcwo+PiA+Cj4+Cj4K


From java-user-return-34199-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 13:40:15 2008
Return-Path: <java-user-return-34199-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69057 invoked from network); 28 May 2008 13:40:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 13:40:15 -0000
Received: (qmail 32745 invoked by uid 500); 28 May 2008 13:40:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32711 invoked by uid 500); 28 May 2008 13:40:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32700 invoked by uid 99); 28 May 2008 13:40:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 06:40:09 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 72.14.220.155 as permitted sender)
Received: from [72.14.220.155] (HELO fg-out-1718.google.com) (72.14.220.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 13:39:22 +0000
Received: by fg-out-1718.google.com with SMTP id l27so1994265fgb.27
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 06:39:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=PvCHgIU6OBpeuYlKrzheYnqbZ9p6PxnuEvdaiBIspQQ=;
        b=Plfsqt/c4MVsQXf7TonsI9NcMyB/yb5xQ45rhQ+wTlsxymLd8Ljlw885yqaaCbqy6Tv+I/swi7Oiz09hTLuHbTu4NchT2gmailKb3xcz/NbighKn9OJLpykUmQU+FY0SPd/GztY4cZolvyEPprrjftUcBlYDwfB9qM0q2Sq99CQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=pBOpZEexmnXFrfxrCSA9r/8t0VWwv9AnxbZMS4DK+3YfbAvbpur/uXed3NHxvyZmXjmzV+Bi0EnQqDdrUhywajXqr0mITvJQkMUnM7bSCpXSzGjMfLmI+E/8hWK59a/FM9hcHP9yCgPUsw7gOZInrXEPMcDy29c+0+LYVa4XUeA=
Received: by 10.86.100.19 with SMTP id x19mr8693944fgb.61.1211981976993;
        Wed, 28 May 2008 06:39:36 -0700 (PDT)
Received: by 10.86.95.19 with HTTP; Wed, 28 May 2008 06:39:36 -0700 (PDT)
Message-ID: <359a92830805280639t947f608o6bf280d131e8b7a9@mail.gmail.com>
Date: Wed, 28 May 2008 09:39:36 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Boolean Query Issue
In-Reply-To: <d5b3ea330805280444s313e0e86n5948ac73081263c0@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_14568_32116985.1211981977027"
References: <d5b3ea330805280444s313e0e86n5948ac73081263c0@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_14568_32116985.1211981977027
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

It's unclear what you *should* expect. How is your data
distributed?

In other words, how many documents do you have? In this example,
for instance,
1. TTL:data AND TTL:store OR TTL:variable => 3,733 results
it considered the TTL:data part only.

it's perfecily reasonable if every document that had "variable" in the
field *also* has "data" and "store" in the field. So your numbers
don't give us much to work with.....

Remember, though, that Lucene syntax isn't a pure boolean syntax. See

http://wiki.apache.org/lucene-java/BooleanQuerySyntax

And when in doubt parenthesize <G>...

Best
Erick

On Wed, May 28, 2008 at 7:44 AM, Sonu Sudhakar <sonusr@gmail.com> wrote:

> Hi,
>
> I have some issue with boolean queries.
>
> I am using Lucene-core-2.3.1.
>
> I have done test on boolean query with 3 terms (data, store, variable) in
> my
> TTL field. The TTL field is indexed and searched using StandardAnalyzer.
>
> The three terms when searched individually gave the following result
>
> 1. TTL:data  => 3,733 results
> 2. TTL:store  => 76 results
> 3. TTL:variable  => 1,496 results
>
> But found issue when combining these terms with boolean operators.
>
> e.g.
> 1. TTL:data AND TTL:store OR TTL:variable => 3,733 results
> it considered the TTL:data part only.
>
> 2. TTL:store AND TTL:data OR TTL:variable => 76 results
> it considered  the TTL:store part only.
>
> 3. TTL:variable AND TTL:data OR  TTL:store => 1,496 results
> it considered  the TTL:variable part only.
>
> But I am getting correct result when combining terms with 'AND' operator. I
> think the issue is with 'OR' operator.
>
>
> Could anybody give an explanation for this behavior of lucene?
> Could you give suggestions to rectify this?
>
> Thanks,
> Sonu
>

------=_Part_14568_32116985.1211981977027--

From java-user-return-34200-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 13:46:24 2008
Return-Path: <java-user-return-34200-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72302 invoked from network); 28 May 2008 13:46:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 13:46:24 -0000
Received: (qmail 46863 invoked by uid 500); 28 May 2008 13:46:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46838 invoked by uid 500); 28 May 2008 13:46:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46824 invoked by uid 99); 28 May 2008 13:46:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 06:46:18 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nttstar@gmail.com designates 209.85.142.185 as permitted sender)
Received: from [209.85.142.185] (HELO ti-out-0910.google.com) (209.85.142.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 13:45:31 +0000
Received: by ti-out-0910.google.com with SMTP id b8so2257157tic.11
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 06:45:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=j/3Ma26lTqV0iHAyDokP+h6AxQVt25wzh5KDTPhQLac=;
        b=YCEtVumgRRhT5H+puOzbbdtqYmEjajetbKny2/ropcqb8FPYV8eTLU54XVa72DwLmX8LejXzv1BcfTO/s9NDIh7CQvXFOVqsiD0vA5Md2waS6yjTG613y8nhgs5a1HD0gOhJG8ixtzNHaOJrgRFWRVo1mniQfFRXjYFx1Tp9dek=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=RHZck77OCS318OV8u1KXOVVxNnn1Q52YzJkexcfK88QS0O6CkHEPuJt9WzmsYP83Ffezb60b7n+Ng3usHxYUYGFN/UasSg2YlzdNjwZwkKJobb8oX2+EMXb5y/+FBMtBKQuibkKgnO5SwrZ055lVB89g4ua+QzPX0Fv7HthVwV8=
Received: by 10.110.26.20 with SMTP id 20mr377102tiz.20.1211982344860;
        Wed, 28 May 2008 06:45:44 -0700 (PDT)
Received: by 10.110.16.20 with HTTP; Wed, 28 May 2008 06:45:44 -0700 (PDT)
Message-ID: <11e088b10805280645j45427491s4764238051e94432@mail.gmail.com>
Date: Wed, 28 May 2008 21:45:44 +0800
From: "=?GB2312?B?uf280Q==?=" <nttstar@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to add PageRank score with lucene's relevant score in sorting
In-Reply-To: <8c4e68610805280603l51631a89t87de0764f7965439@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_16_28302354.1211982344851"
References: <11e088b10805280302q933d019k2a7baad10d43e04f@mail.gmail.com>
	 <8c4e68610805280312wc7e7d9at399a323d9f248832@mail.gmail.com>
	 <11e088b10805280447w35d83c4ewc076a6ce2778f25@mail.gmail.com>
	 <8c4e68610805280603l51631a89t87de0764f7965439@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_16_28302354.1211982344851
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: base64
Content-Disposition: inline

SSB0aGluayB0aGlzIGlzIG5vdCBzdWl0YWJsZSBmb3IgbXkgc3lzdGVtIHNpbmNlIHRoZSBudW0g
b2YgcGFnZXMgaXMgdmVyeQpsYXJnZSB0aGF0IHdpbGwgY29zdCBtdWNoIHRpbWUgZm9yIHJlaW5k
ZXgKCjIwMDgvNS8yOCwgSWFuIExlYSA8aWFuLmxlYUBnbWFpbC5jb20+Ogo+Cj4gWWVzLiAgQnV0
IHlvdSdkIGhhdmUgdG8gZG8gdGhhdCBhbnl3YXkgaWYgeW91IGFyZSBzdG9yaW5nIHBhZ2VyYW5r
IGluIHRoZQo+IGluZGV4Lgo+Cj4gT25lIHBvaW50IG9uIHlvdXIgMjBzIHJlc3BvbnNlIHRpbWUg
Zm9yIHNvcnRpbmcgLSBpcyB0aGF0IGZvciB0aGUKPiBmaXJzdCBzb3J0IG9yIHN1YnNlcXVlbnQg
b25lcz8KPiBJIGJlbGlldmUgdGhhdCB0aGUgZmlyc3Qgb25lIHdpbGwgdXN1YWxseSBiZSBzdWJz
dGFudGlhbGx5IHNsb3dlci4KPiBCdXQgc29ydGluZyBpcyBhbHdheXMgbGlrZWx5IHRvIGJlIHNs
b3dlciB0aGFuIG5vdCBzb3J0aW5nLgo+Cj4KPiAtLQo+IElhbi4KPgo+Cj4gT24gV2VkLCBNYXkg
MjgsIDIwMDggYXQgMTI6NDcgUE0sILn9vNEgPG50dHN0YXJAZ21haWwuY29tPiB3cm90ZToKPiA+
IHRoYW5rcyBsYW4sIGJ1dCB0aGlzIG1lYW5zIHRoYXQgaSBtdXN0IHJlaW5kZXggdGhlc2UgcGFn
ZXMgd2hpbGUgdGhlCj4gPiBwYWdlcmFuayBzY29yZSBjaGFuZ2VkPwo+ID4KPiA+INTaMDgtNS0y
OKOsSWFuIExlYSA8aWFuLmxlYUBnbWFpbC5jb20+INC0tcCjugo+ID4+Cj4gPj4gSGkKPiA+Pgo+
ID4+Cj4gPj4gTWF5YmUgeW91IGNvdWxkIHVzZSB0aGUgcGFnZXJhbmsgc2NvcmUsIHBvc3NpYmx5
IG1vZGlmaWVkLCBhcyBkb2N1bWVudAo+ID4+IGJvb3N0IGF0IGluZGV4aW5nIHRpbWUuICBGcm9t
IHRoZSBqYXZhZG9jcyBmb3IKPiA+PiBEb2N1bWVudC5zZXRCb29zdChib29zdCkKPiA+Pgo+ID4+
ICJTZXRzIGEgYm9vc3QgZmFjdG9yIGZvciBoaXRzIG9uIGFueSBmaWVsZCBvZiB0aGlzIGRvY3Vt
ZW50LiBUaGlzCj4gPj4gdmFsdWUgd2lsbCBiZSBtdWx0aXBsaWVkIGludG8gdGhlIHNjb3JlIG9m
IGFsbCBoaXRzIG9uIHRoaXMgZG9jdW1lbnQiCj4gPj4KPiA+PiBzbyB3aWxsIGdpdmUgeW91IFAg
KiBSIHJhdGhlciB0aGFuIFAgKyBSLiAgU2hvdWxkIGJlIHF1aWNrLCB0aG91Z2guCj4gPj4KPiA+
Pgo+ID4+IC0tCj4gPj4gSWFuLgo+ID4+Cj4gPj4KPiA+PiBPbiBXZWQsIE1heSAyOCwgMjAwOCBh
dCAxMTowMiBBTSwguf280SA8bnR0c3RhckBnbWFpbC5jb20+IHdyb3RlOgo+ID4+ID4gaGkgYWxs
ICwKPiA+PiA+ICAgICBJIGhhdmUgYSBwcm9ibGVtIHRoYXQgaG93IHRvICJjb21iaW5lIiB0d28g
c2NvcmUgdG8gc29ydCB0aGUKPiBzZWFyY2gKPiA+PiA+IHJlc3VsdCBkb2N1bWVudHMuCj4gPj4g
PiAgICAgZm9yIGV4YW1wbGUgSSAgaGF2ZSAxMCBtaWxsaW9uIHBhZ2VzIGluIGx1Y2VuZSBpbmRl
eCAsIGFuZCBpIGtub3cKPiA+PiB0aGVpcgo+ID4+ID4gcGFnZXJhbmsgc2NvcmVzLiBpIGdpdmUg
YSBxdWVyeSB0byBpdCAsIGV2ZXJ5IGRvY3MgcmV0dXJuZWQgaGF2ZSBhCj4gPj4gPiBsdWNlbmUt
c2NvcmUsIG1hcmsgaXQgYXMgUiAocmVsZXZhbnQgc2NvcmUpLCBhbmQgIGkgIGFsc28gIGhhdmUg
aXRzCj4gPj4gPiBwYWdlcmFuayBzY29yZSwgbWFyayBpdCBhcyBQLCAgd2hhdCBpIG5lZWQgaXMg
aSB3YW50IHRvIHNvcnQgdGhlCj4gc2VhcmNoCj4gPj4gPiByZXN1bHQgYmFzZSBvbiB0aGUgdmFs
dWUgIlArUiIuICBZb3Uga25vdyBpZiBpIHN0b3JlIHRoZSBwYWdlcmFuawo+IHNjb3JlCj4gPj4g
aW4KPiA+PiA+IGluZGV4IGFuZCBnZXQgaXQgZXZlcnkgc2VhcmNoIHRpbWUgLCB0aGVuIGNvbXB1
dGUgUCtSICwgdGhlbiBzb3J0IGl0ICwKPiA+PiB0aGlzCj4gPj4gPiB3YXkgaXMgdG9vIHNsb3cu
IGluIG15IHN5c3RlbSAsIHdoZW4gdGhlIHNlYXJjaCBoaXRzIDUwMDAwMCByZXN1bHQgLAo+IHRo
ZQo+ID4+ID4gc29ydCBtYXkgY29zdCBhYm91dCAyMHMuCj4gPj4gPiAgIFNvcnJ5IGZvciBteSBw
b29yIGVuZ2xpc2guICBBbnlvbmUgaGFzIGEgZ29vZCBpZGVhPwo+ID4+ID4KPiA+PiA+IEJlc3QK
PiA+PiA+IEphcnZpcwo+ID4+ID4KPiA+Pgo+ID4KPgo=
------=_Part_16_28302354.1211982344851--

From java-user-return-34201-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 14:49:08 2008
Return-Path: <java-user-return-34201-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97148 invoked from network); 28 May 2008 14:49:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 14:49:07 -0000
Received: (qmail 66019 invoked by uid 500); 28 May 2008 14:49:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65926 invoked by uid 500); 28 May 2008 14:49:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65914 invoked by uid 99); 28 May 2008 14:49:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 07:49:01 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of sandy.hider@jhuapl.edu designates 128.244.198.200 as permitted sender)
Received: from [128.244.198.200] (HELO jhuapl.edu) (128.244.198.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 14:48:07 +0000
Received: from ([128.244.198.195])
	by pilot.jhuapl.edu with ESMTP  id 5502123.94808732;
	Wed, 28 May 2008 10:48:06 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C8C0D1.D65D97A0"
Subject: Frequencies sorted by frequencies
Date: Wed, 28 May 2008 10:48:05 -0400
Message-ID: <4FA0A45B21AD65488AFF8D679CF0E09A014FE6BD@aplesnation.dom1.jhuapl.edu>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Frequencies sorted by frequencies
Thread-Index: AcjA0dZmKc/yzZptSRm6WyNdiwOBig==
From: "Hider, Sandy" <Sandy.Hider@jhuapl.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C8C0D1.D65D97A0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi All,
I am trying to figure out a quick way to find the top N documents sorted
by frequency of a term.

I found:

IndexRead.termDocs()=20

which provides an enumeration of doc() and freq() but it returns an
enumeration sorted by doc number.   Is there a way to get the results
sorted by freq?  Or is there another query I can run the find these
results?

Thanks in advance,

Sandy


------_=_NextPart_001_01C8C0D1.D65D97A0--

From java-user-return-34202-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 14:52:29 2008
Return-Path: <java-user-return-34202-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98979 invoked from network); 28 May 2008 14:52:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 14:52:29 -0000
Received: (qmail 79395 invoked by uid 500); 28 May 2008 14:52:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79369 invoked by uid 500); 28 May 2008 14:52:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79358 invoked by uid 99); 28 May 2008 14:52:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 07:52:23 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of glen.newton@gmail.com designates 74.125.46.30 as permitted sender)
Received: from [74.125.46.30] (HELO yw-out-2324.google.com) (74.125.46.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 14:51:36 +0000
Received: by yw-out-2324.google.com with SMTP id 3so1629644ywj.5
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 07:51:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=V2WYexYBBgWKRSENZv0c1H6m1OD4X4RaCeyWhH8HaNM=;
        b=J6Ht/Yd+qr9BIqdKm2j3d+9aT+7Qyha8kUNF/aDz160gcj4wreMzOnJElrO82+WRxO6m7Tk4Xc3emziQNShVKncOHzR+/KmJwmrXrffRHyN5WB6/wrNwyvHXbKE9j+l6Sdh6kk4e37PZX2NXGKC91e/K2UiDb6wKu5FhbZQedXk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=iSXMlBGCnZGij03RdX2d9LPc7rjlYLmvFbD8PzkMCgs5cb/FI6Lf46LMTaN7V9GxEZH06PCqZOT18Rsu5YZ8Ui2xl8WU/mnSFoUgY5777UwL8HfX8WFUp5mtvGgwJl74JndxzxkpVQCn9k83UWpm/VhwhqO/guu2XnxmkJRcbDY=
Received: by 10.143.168.14 with SMTP id v14mr1073152wfo.226.1211986293882;
        Wed, 28 May 2008 07:51:33 -0700 (PDT)
Received: by 10.142.98.3 with HTTP; Wed, 28 May 2008 07:51:33 -0700 (PDT)
Message-ID: <5e76f3840805280751s11443ed1i3653edd5e764b09e@mail.gmail.com>
Date: Wed, 28 May 2008 10:51:33 -0400
From: "Glen Newton" <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to add PageRank score with lucene's relevant score in sorting
In-Reply-To: <11e088b10805280645j45427491s4764238051e94432@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
Content-Disposition: inline
References: <11e088b10805280302q933d019k2a7baad10d43e04f@mail.gmail.com>
	 <8c4e68610805280312wc7e7d9at399a323d9f248832@mail.gmail.com>
	 <11e088b10805280447w35d83c4ewc076a6ce2778f25@mail.gmail.com>
	 <8c4e68610805280603l51631a89t87de0764f7965439@mail.gmail.com>
	 <11e088b10805280645j45427491s4764238051e94432@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

WW91IHNob3VsZCBjb25zaWRlciBrZWVwaW5nIHRoZSBQYWdlUmFuayAoYW5kIGFueSBvdGhlciBt
b3JlIGR5bmFtaWMKZGF0YSkgaW4gYSBzZXBhcmF0ZSBpbmRleCAod2l0aCB0aGUgZG9jdW1lbnRz
IGluIHRoZSBzYW1lIG9kZXIgYXMgeW91cgpiaWdnZXIsIG1vcmUgc3RhdGljIGluZGV4KSBhbmQg
dGhlbiB1c2UgYSBQYXJhbGxlbFJlYWRlciBvbiBib3RoIG9mCnRoZW0uIFNlZToKICBodHRwOi8v
bHVjZW5lLmFwYWNoZS5vcmcvamF2YS8yXzFfMC9hcGkvb3JnL2FwYWNoZS9sdWNlbmUvaW5kZXgv
UGFyYWxsZWxSZWFkZXIuaHRtbAoKLUdsZW4KCjIwMDgvNS8yOCDov4fkvbMgPG50dHN0YXJAZ21h
aWwuY29tPjoKPiBJIHRoaW5rIHRoaXMgaXMgbm90IHN1aXRhYmxlIGZvciBteSBzeXN0ZW0gc2lu
Y2UgdGhlIG51bSBvZiBwYWdlcyBpcyB2ZXJ5Cj4gbGFyZ2UgdGhhdCB3aWxsIGNvc3QgbXVjaCB0
aW1lIGZvciByZWluZGV4Cj4KPiAyMDA4LzUvMjgsIElhbiBMZWEgPGlhbi5sZWFAZ21haWwuY29t
PjoKPj4KPj4gWWVzLiAgQnV0IHlvdSdkIGhhdmUgdG8gZG8gdGhhdCBhbnl3YXkgaWYgeW91IGFy
ZSBzdG9yaW5nIHBhZ2VyYW5rIGluIHRoZQo+PiBpbmRleC4KPj4KPj4gT25lIHBvaW50IG9uIHlv
dXIgMjBzIHJlc3BvbnNlIHRpbWUgZm9yIHNvcnRpbmcgLSBpcyB0aGF0IGZvciB0aGUKPj4gZmly
c3Qgc29ydCBvciBzdWJzZXF1ZW50IG9uZXM/Cj4+IEkgYmVsaWV2ZSB0aGF0IHRoZSBmaXJzdCBv
bmUgd2lsbCB1c3VhbGx5IGJlIHN1YnN0YW50aWFsbHkgc2xvd2VyLgo+PiBCdXQgc29ydGluZyBp
cyBhbHdheXMgbGlrZWx5IHRvIGJlIHNsb3dlciB0aGFuIG5vdCBzb3J0aW5nLgo+Pgo+Pgo+PiAt
LQo+PiBJYW4uCj4+Cj4+Cj4+IE9uIFdlZCwgTWF5IDI4LCAyMDA4IGF0IDEyOjQ3IFBNLCDov4fk
vbMgPG50dHN0YXJAZ21haWwuY29tPiB3cm90ZToKPj4gPiB0aGFua3MgbGFuLCBidXQgdGhpcyBt
ZWFucyB0aGF0IGkgbXVzdCByZWluZGV4IHRoZXNlIHBhZ2VzIHdoaWxlIHRoZQo+PiA+IHBhZ2Vy
YW5rIHNjb3JlIGNoYW5nZWQ/Cj4+ID4KPj4gPiDlnKgwOC01LTI477yMSWFuIExlYSA8aWFuLmxl
YUBnbWFpbC5jb20+IOWGmemBk++8mgo+PiA+Pgo+PiA+PiBIaQo+PiA+Pgo+PiA+Pgo+PiA+PiBN
YXliZSB5b3UgY291bGQgdXNlIHRoZSBwYWdlcmFuayBzY29yZSwgcG9zc2libHkgbW9kaWZpZWQs
IGFzIGRvY3VtZW50Cj4+ID4+IGJvb3N0IGF0IGluZGV4aW5nIHRpbWUuICBGcm9tIHRoZSBqYXZh
ZG9jcyBmb3IKPj4gPj4gRG9jdW1lbnQuc2V0Qm9vc3QoYm9vc3QpCj4+ID4+Cj4+ID4+ICJTZXRz
IGEgYm9vc3QgZmFjdG9yIGZvciBoaXRzIG9uIGFueSBmaWVsZCBvZiB0aGlzIGRvY3VtZW50LiBU
aGlzCj4+ID4+IHZhbHVlIHdpbGwgYmUgbXVsdGlwbGllZCBpbnRvIHRoZSBzY29yZSBvZiBhbGwg
aGl0cyBvbiB0aGlzIGRvY3VtZW50Igo+PiA+Pgo+PiA+PiBzbyB3aWxsIGdpdmUgeW91IFAgKiBS
IHJhdGhlciB0aGFuIFAgKyBSLiAgU2hvdWxkIGJlIHF1aWNrLCB0aG91Z2guCj4+ID4+Cj4+ID4+
Cj4+ID4+IC0tCj4+ID4+IElhbi4KPj4gPj4KPj4gPj4KPj4gPj4gT24gV2VkLCBNYXkgMjgsIDIw
MDggYXQgMTE6MDIgQU0sIOi/h+S9syA8bnR0c3RhckBnbWFpbC5jb20+IHdyb3RlOgo+PiA+PiA+
IGhpIGFsbCAsCj4+ID4+ID4gICAgIEkgaGF2ZSBhIHByb2JsZW0gdGhhdCBob3cgdG8gImNvbWJp
bmUiIHR3byBzY29yZSB0byBzb3J0IHRoZQo+PiBzZWFyY2gKPj4gPj4gPiByZXN1bHQgZG9jdW1l
bnRzLgo+PiA+PiA+ICAgICBmb3IgZXhhbXBsZSBJICBoYXZlIDEwIG1pbGxpb24gcGFnZXMgaW4g
bHVjZW5lIGluZGV4ICwgYW5kIGkga25vdwo+PiA+PiB0aGVpcgo+PiA+PiA+IHBhZ2VyYW5rIHNj
b3Jlcy4gaSBnaXZlIGEgcXVlcnkgdG8gaXQgLCBldmVyeSBkb2NzIHJldHVybmVkIGhhdmUgYQo+
PiA+PiA+IGx1Y2VuZS1zY29yZSwgbWFyayBpdCBhcyBSIChyZWxldmFudCBzY29yZSksIGFuZCAg
aSAgYWxzbyAgaGF2ZSBpdHMKPj4gPj4gPiBwYWdlcmFuayBzY29yZSwgbWFyayBpdCBhcyBQLCAg
d2hhdCBpIG5lZWQgaXMgaSB3YW50IHRvIHNvcnQgdGhlCj4+IHNlYXJjaAo+PiA+PiA+IHJlc3Vs
dCBiYXNlIG9uIHRoZSB2YWx1ZSAiUCtSIi4gIFlvdSBrbm93IGlmIGkgc3RvcmUgdGhlIHBhZ2Vy
YW5rCj4+IHNjb3JlCj4+ID4+IGluCj4+ID4+ID4gaW5kZXggYW5kIGdldCBpdCBldmVyeSBzZWFy
Y2ggdGltZSAsIHRoZW4gY29tcHV0ZSBQK1IgLCB0aGVuIHNvcnQgaXQgLAo+PiA+PiB0aGlzCj4+
ID4+ID4gd2F5IGlzIHRvbyBzbG93LiBpbiBteSBzeXN0ZW0gLCB3aGVuIHRoZSBzZWFyY2ggaGl0
cyA1MDAwMDAgcmVzdWx0ICwKPj4gdGhlCj4+ID4+ID4gc29ydCBtYXkgY29zdCBhYm91dCAyMHMu
Cj4+ID4+ID4gICBTb3JyeSBmb3IgbXkgcG9vciBlbmdsaXNoLiAgQW55b25lIGhhcyBhIGdvb2Qg
aWRlYT8KPj4gPj4gPgo+PiA+PiA+IEJlc3QKPj4gPj4gPiBKYXJ2aXMKPj4gPj4gPgo+PiA+Pgo+
PiA+Cj4+Cj4KCgoKLS0gCgotCg==


From java-user-return-34203-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 18:34:53 2008
Return-Path: <java-user-return-34203-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66285 invoked from network); 28 May 2008 18:34:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 18:34:52 -0000
Received: (qmail 39122 invoked by uid 500); 28 May 2008 18:34:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39078 invoked by uid 500); 28 May 2008 18:34:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39067 invoked by uid 99); 28 May 2008 18:34:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 11:34:47 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a16.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 18:33:50 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a16.g.dreamhost.com (Postfix) with ESMTP id C6DD47D2D3
	for <java-user@lucene.apache.org>; Wed, 28 May 2008 11:34:10 -0700 (PDT)
Message-Id: <3974D529-828C-45A4-88E9-A23D0F048915@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <4FA0A45B21AD65488AFF8D679CF0E09A014FE6BD@aplesnation.dom1.jhuapl.edu>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Frequencies sorted by frequencies
Date: Wed, 28 May 2008 14:34:02 -0400
References: <4FA0A45B21AD65488AFF8D679CF0E09A014FE6BD@aplesnation.dom1.jhuapl.edu>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

I think you could override all the Similarity factors except tf() with  
1, such that the term frequency is the only factor in the scoring.   
Then you just submit the term as a query.  Note, I think you will need  
to override the similarity during indexing, too, so that norm length  
is turned off, too.  Note, I haven't tried it :-).  Use the explain()  
functionality to double check.  At any rate, it should be quick to test.

See http://lucene.apache.org/java/2_3_2/api/org/apache/lucene/search/Similarity.html

-Grant


On May 28, 2008, at 10:48 AM, Hider, Sandy wrote:

> Hi All,
> I am trying to figure out a quick way to find the top N documents  
> sorted
> by frequency of a term.
>
> I found:
>
> IndexRead.termDocs()
>
> which provides an enumeration of doc() and freq() but it returns an
> enumeration sorted by doc number.   Is there a way to get the results
> sorted by freq?  Or is there another query I can run the find these
> results?
>
> Thanks in advance,
>
> Sandy
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ








---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34204-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 21:11:29 2008
Return-Path: <java-user-return-34204-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24180 invoked from network); 28 May 2008 21:11:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 21:11:28 -0000
Received: (qmail 44447 invoked by uid 500); 28 May 2008 21:11:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44418 invoked by uid 500); 28 May 2008 21:11:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44398 invoked by uid 99); 28 May 2008 21:11:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 14:11:23 -0700
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [65.212.71.225] (HELO prw2k3mm03.dmz.weather.com) (65.212.71.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 21:10:35 +0000
Received: from ATLMAIL01.corp.weather.com (Not Verified[10.31.24.101]) by prw2k3mm03.dmz.weather.com with MailMarshal (v6,2,1,3252)
	id <B483dcc6d0001>; Wed, 28 May 2008 17:19:41 -0400
Received: from 10.50.89.111 ([10.50.89.111]) by ATLMAIL01.corp.weather.com ([10.31.24.121]) via Exchange Front-End Server exchange.weather.com ([65.212.71.81]) with Microsoft Exchange Server HTTP-DAV ;
 Wed, 28 May 2008 21:10:50 +0000
User-Agent: Microsoft-Entourage/12.10.0.080409
Date: Wed, 28 May 2008 17:10:47 -0400
Subject: Re: Query works in Luke but not in code...
From: Casey Dement <cdement@weather.com>
To: <java-user@lucene.apache.org>
Message-ID: <C4634297.5D48%cdement@weather.com>
Thread-Topic: Query works in Luke but not in code...
Thread-Index: AcjBB0xa17iOlM3EvU2M0LzNmqRNVg==
In-Reply-To: <8c4e68610805230200s5714cea9g9a4e1b951c36d423@mail.gmail.com>
Mime-version: 1.0
Content-type: text/plain;
	charset="US-ASCII"
Content-transfer-encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

LOL - I sure wish it was! :)

Sadly, that was a typo (Luke, for all its beauties, does not seem to grasp
the concept of a clipboard so the sample was a manual transcription).

A few more details - don't know if this will help or not.

Same query as before, when I do a rewrite of the query in Luke I get back a
set of 44 matching tokens for the given "Austell" ranging between a boost of
0.1429 for "turrel" up to 1.0 for "austell".  That the token "austell" gets
a 1.0 is rather obvious since it's a perfect match...

BUT - when I rewrite the query in my local code, I get 2 matches, austell
(at 0.14285707) and (austerlitz at 0.20000005).  This is disturbing on two
fronts - first of all where are the other 42?  And secondly - why is the
exact match evaluating to such a low boost?

Does that point at all to where I'm going astray?

Thanks!

 Casey 


On 5/23/08 5:00 AM, "Ian Lea" <ian.lea@gmail.com> wrote:

>> ...
>> And expect to match document 156297 (search_text=="Austell GA", type==1).
>> ...
>>  System.out.println(searcher.explain(query, 156296));
> 
> 156297 != 156296
> 
> Could that be it?
> 
> 
> --
> Ian.
> 
> 
> On Thu, May 22, 2008 at 11:21 PM, Casey Dement <cdement@weather.com> wrote:
>> Hi - trying to execute a search in Lucene and getting results I don't
>> understand :(
>> 
>> The index contains fields search_text and type - both indexed tokenized.
>> I'm attempting to execute the query:
>> 
>>  +(search_text:austell~0.9 search_text:ga~0.9) +(type:1 type:4)
>> 
>> And expect to match document 156297 (search_text=="Austell GA", type==1).
>> 
>> I am executing this query both directly in code and via the tool Luke - but
>> getting WILDLY different answers.  In Luke, the expected document is found
>> no problem, but in my own code I find no results.  Obviously I suspect my
>> code of being crap ;)
>> 
>> Oh, FYI, in both my local code and Luke I am using a StandardAnalyzer and
>> the default column is "search_text".
>> 
>> Here's what I'm doing:
>> 
>>  /******************************************************************/
>>  File location = new File("/the/correct/path");
>>  IndexReader index = IndexReader.open(location);
>>  Searcher searcher = new IndexSearcher(index);
>>  QueryParser parser = new QueryParser("search_text", new
>> StandardAnalyzer());
>>  Query query = parser.parse("+(search_text:austell~0.9 search_text:ga~0.9)
>> +(type:1 type:4)");
>>  System.out.println(searcher.explain(query, 156296));
>>  /******************************************************************/
>> 
>> When I run this, I get:
>> |  0.0000 = (NON-MATCH) Failure to meet condition(s) of required/prohibited
>> clause(s)
>> |    0.0000 = no match on required clause (() ())
>> |      0.0000 = (NON-MATCH) product of:
>> |        0.0000 = (NON-MATCH) sum of:
>> |        0.0000 = coord(0/2)
>> |    0.2133 = (MATCH) product of:
>> |      0.4267 = (MATCH) sum of:
>> |        0.4267 = (MATCH) weight(type:1 in 156296), product of:
>> |          0.3672 = queryWeight(type:1), product of:
>> |            1.1618 = idf(docFreq=315734, numDocs=371197)
>> |            0.3161 = queryNorm
>> |          1.1618 = (MATCH) fieldWeight(type:1 in 156296), product of:
>> |            1.0000 = tf(termFreq(type:1)=1)
>> |            1.1618 = idf(docFreq=315734, numDocs=371197)
>> |            1.0000 = fieldNorm(field=type, doc=156296)
>> |      0.5000 = coord(1/2)
>> 
>> So obviously I'm loading the index (since it did match the "type") - but it
>> seems to be COMPLETELY ignoring the criteria on "search_text".
>> 
>> When I run this exact same string in Luke, I get:
>> |  8.0079 = (MATCH) sum of:
>> |    7.9578 = (MATCH) sum of:
>> |      5.4904 = (MATCH) weight(search_text:austell in 156297), product of:
>> |        0.8074 = queryWeight(search_text:austell), product of:
>> |          10.8800 = idf(docFreq=18, numDocs=371197)
>> |          0.0742 = queryNorm
>> |        6.8000 = (MATCH) fieldWeight(search_text:austell in 156297),
>> product of:
>> |          1.0000 = tf(termFreq(search_text:austell)=1)
>> |          10.8800 = idf(docFreq=18, numDocs=371197)
>> |          0.6250 = fieldNorm(field=search_text, doc=156297)
>> |      2.4673 = (MATCH) weight(search_text:ga in 156297), product of:
>> |        0.5413 = queryWeight(search_text:ga), product of:
>> |          7.2936 = idf(docFreq=685, numDocs=371197)
>> |          0.0742 = queryNorm
>> |        4.5585 = (MATCH) fieldWeight(search_text:ga in 156297), product of:
>> |          1.0000 = tf(termFreq(search_text:ga)=1)
>> |          7.2936 = idf(docFreq=685, numDocs=371197)
>> |          0.6250 = fieldNorm(field=search_text, doc=156297)
>> |    0.0501 = (MATCH) product of:
>> |      0.1002 = (MATCH) sum of:
>> |        0.1002 = (MATCH) weight(type:1 in 156296), product of:
>> |          0.0862 = queryWeight(type:1), product of:
>> |            1.1618 = idf(docFreq=315734, numDocs=371197)
>> |            0.0742 = queryNorm
>> |          1.1618 = (MATCH) fieldWeight(type:1 in 156296), product of:
>> |            1.0000 = tf(termFreq(type:1)=1)
>> |            1.1618 = idf(docFreq=315734, numDocs=371197)
>> |            1.0000 = fieldNorm(field=type, doc=156296)
>> |      0.5000 = coord(1/2)
>> 
>> Which while clearly looking at the same document ID in the same index is
>> conversely working perfectly!
>> 
>> Does anybody have any idea where I am screwing up?  Thanks!
>> 
>> Casey
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34205-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 21:59:21 2008
Return-Path: <java-user-return-34205-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49763 invoked from network); 28 May 2008 21:59:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 21:59:20 -0000
Received: (qmail 18291 invoked by uid 500); 28 May 2008 21:59:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18244 invoked by uid 500); 28 May 2008 21:59:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17551 invoked by uid 99); 28 May 2008 21:59:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 14:59:10 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 66.249.82.230 as permitted sender)
Received: from [66.249.82.230] (HELO wx-out-0506.google.com) (66.249.82.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 21:58:22 +0000
Received: by wx-out-0506.google.com with SMTP id h29so2588570wxd.20
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 14:58:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=dE2xbOPcRi1/OLzJnPmTUtwbw+IjCSQDIrQ/FszLtW0=;
        b=bq0R16+2Jjt9URk67ra53z5ZCl895fV1uIGMjwhi+nAzxrdc7WKSZNDnaEvwIoOONFeCXDt6NTUFcrmJvYTUcolNm1Lk6vakLtpXjTw23l4iFETfRIiY7PdlT5pONidofATRHzsHA726Ppq3XNSfw52LPDdn/rEr3Gi4q79SV4g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=hMbyFWkbykrn58+Y9gWcAMzYrNX1iKQh3A+hM6laes0XER1sYAjd2zf3/dAZu2u5S3g7+JczlHM+FYQHzdOfUgKx6nsJgkiQs23zitTJX8kjzjucG2uAVbTBxXUoLwlFUF6hbu4BGxOWa1VFV2LQXngIN+VGmr9w+aP8cV1hQkk=
Received: by 10.90.71.15 with SMTP id t15mr4183855aga.4.1212011917911;
        Wed, 28 May 2008 14:58:37 -0700 (PDT)
Received: from ?9.30.38.211? ( [129.42.184.35])
        by mx.google.com with ESMTPS id u2sm41104795pyb.16.2008.05.28.14.58.35
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 28 May 2008 14:58:36 -0700 (PDT)
Message-ID: <483DD50C.3080908@gmail.com>
Date: Wed, 28 May 2008 14:56:28 -0700
From: Michael Busch <buschmic@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: IndexReader.reopen memory leak
References: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com>
In-Reply-To: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi John,

hmm not good. I will take a look. It has probably to do with the 
reference counting. Are you doing anything special? E. g. do you have 
own reader implementations that you call reopen() on? What kinds of 
readers are you using?

Are you maybe able to provide a heapdump?

-Michael

John Wang wrote:
> Hi:
> 
>   We are experiencing memory leak with calling IndexReader.reopen().
> 
>    From eyeballing the lucene source code, I am seeing normCache is not
> cleared.
> 
> 
>    Anyone else experiencing this?
> 
> Thanks
> 
> -John
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34206-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed May 28 23:23:44 2008
Return-Path: <java-user-return-34206-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76273 invoked from network); 28 May 2008 23:23:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 May 2008 23:23:44 -0000
Received: (qmail 803 invoked by uid 500); 28 May 2008 23:23:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 766 invoked by uid 500); 28 May 2008 23:23:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 755 invoked by uid 99); 28 May 2008 23:23:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 16:23:39 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 64.233.184.228 as permitted sender)
Received: from [64.233.184.228] (HELO wr-out-0506.google.com) (64.233.184.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 23:22:51 +0000
Received: by wr-out-0506.google.com with SMTP id c30so2000135wra.14
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 16:23:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=y5dncG1ADBji/YaM54zcvWjSfOCXRkzjJGMyqR8rzTU=;
        b=kmUIYw4JKZsIJHhaSiD+VcHu8XAZCS9Jem0qhm4zfDsdZY+KRv9A6GyB7S+hkn8XkEY1OyAIP08mg8RWTzRskY8isEtSL2bBFIUd4P0v0jlY70grrR6IQXSiDr6uiIZ1k+A975uh8vwYqPQCzBMzEmCs1CqztAnqAl2vTuNQalE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=LVBltk+KEGCGK4dX0mS9elY9nm+2RCHnGrJc9Ux5f/PA81KUtGZ6hzkQD9shFpnbRbh8Woq5KbhpmSK50TPPsdozkvxAIdie7UNWFaE7Sj/fTRidnCM9X62Ke/O3SQs3PU824qoWiTaq/tdGaVB1MwbuUm+KI+N1GaLe92OAUJM=
Received: by 10.100.142.4 with SMTP id p4mr19107and.23.1212016987094;
        Wed, 28 May 2008 16:23:07 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id q14sm13030393qbq.29.2008.05.28.16.23.05
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 28 May 2008 16:23:06 -0700 (PDT)
Message-ID: <483DE95C.9030501@gmail.com>
Date: Wed, 28 May 2008 19:23:08 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: IndexReader.reopen memory leak
References: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com> <483DD50C.3080908@gmail.com>
In-Reply-To: <483DD50C.3080908@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

As someone that has done a lot of reopens, I can vouch there is no leak 
under simple, normal usage. Are you sure your closing the original 
reader after getting the reopened reference?

Michael Busch wrote:
> Hi John,
>
> hmm not good. I will take a look. It has probably to do with the 
> reference counting. Are you doing anything special? E. g. do you have 
> own reader implementations that you call reopen() on? What kinds of 
> readers are you using?
>
> Are you maybe able to provide a heapdump?
>
> -Michael
>
> John Wang wrote:
>> Hi:
>>
>>   We are experiencing memory leak with calling IndexReader.reopen().
>>
>>    From eyeballing the lucene source code, I am seeing normCache is not
>> cleared.
>>
>>
>>    Anyone else experiencing this?
>>
>> Thanks
>>
>> -John
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34207-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 01:55:08 2008
Return-Path: <java-user-return-34207-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68452 invoked from network); 29 May 2008 01:55:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 01:55:08 -0000
Received: (qmail 12864 invoked by uid 500); 29 May 2008 01:55:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12825 invoked by uid 500); 29 May 2008 01:55:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12814 invoked by uid 99); 29 May 2008 01:55:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 18:55:02 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 74.125.46.28 as permitted sender)
Received: from [74.125.46.28] (HELO yw-out-2324.google.com) (74.125.46.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 01:54:15 +0000
Received: by yw-out-2324.google.com with SMTP id 3so1769816ywj.5
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 18:54:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=Jre0zcn7HAtXjFycHB25p6r8qKWPx+YkohI2YOU40nY=;
        b=LP3AcyqJuhKwI4ijiXhqips3IFK/CII1Cs19r5jto36OLx/j1CB5lV+X/STPfy+AC+fWN82HMCJ6s8bMKxKpZkPx/hQOlKlLydwhIf8Tiye1OwZC+Z8g8Juh7ymW0Pf0nG5mLFZizoM87lsJMmyuNzDxmqxqnZJh9MzpPDU+a5o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=OdWvMVzb09PUUtrZxRxsHRnvZmqYDzjpVAdClqmt/6FGWEWEyJ/l7WmEcfDbGbjgg9TdM+AG0BpJYZFXImYEi18668odE0Lt/OgB5XbasR+NIdhfidf+1U8doROy0mog/WSxbtGUxMDkNee5e5Jh4H5hoLKreAon5sq1uA2RBLc=
Received: by 10.150.86.10 with SMTP id j10mr5420516ybb.211.1212026068780;
        Wed, 28 May 2008 18:54:28 -0700 (PDT)
Received: by 10.151.41.21 with HTTP; Wed, 28 May 2008 18:54:28 -0700 (PDT)
Message-ID: <c68e39170805281854v49c520c6x87ca9c9010e3fc1d@mail.gmail.com>
Date: Wed, 28 May 2008 21:54:28 -0400
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: proximity search
In-Reply-To: <a2e3b6200805280236i5e624ee1k8f13c9bbc8b25873@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <a2e3b6200805280236i5e624ee1k8f13c9bbc8b25873@mail.gmail.com>
X-Google-Sender-Auth: 751a3b6ebb712e1d
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, May 28, 2008 at 5:36 AM, stefano coppi <stefano.coppi@gmail.com> wrote:
>  text: BB AA
> query: "AA BB"~0 why the result is false? Aren't BB AA contigous?
> result: false
>
>  text: BB AA
> query: "AA BB"~1
> result: false
>
>  text: BB AA
> query: "AA BB"~2 why with proximity=2 the result is true??
> result: true

Sloppy phrase queries are ordered, and the slop is the allowable edit
distance. So to get a match in your example, AA needs to move two
spaces to the left (a slop of 2).

Look at span queries if you need something unordered.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34208-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 03:04:16 2008
Return-Path: <java-user-return-34208-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84841 invoked from network); 29 May 2008 03:04:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 03:04:16 -0000
Received: (qmail 54523 invoked by uid 500); 29 May 2008 03:04:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54491 invoked by uid 500); 29 May 2008 03:04:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54480 invoked by uid 99); 29 May 2008 03:04:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 20:04:11 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 03:03:17 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1K1YQU-0006GV-Ss
	for java-user@lucene.apache.org; Wed, 28 May 2008 20:03:38 -0700
Message-ID: <17526678.post@talk.nabble.com>
Date: Wed, 28 May 2008 20:03:38 -0700 (PDT)
From: Ravi_116 <ravi116@gmail.com>
To: java-user@lucene.apache.org
Subject: Opening an index directory inside a jar
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ravi116@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


I get the following error trace -

java.io.FileNotFoundException: no segments* file found in
org.apache.lucene.store.FSDirectory@/Users/projects/workspace/project_name/web/file:/Users/.m2/repository/com/mycompany/project_name/2.1.0-internal-65-SNAPSHOT/suggesters-2.1.0-internal-65-SNAPSHOT.jar!/luceneFiles/index:
files:
        at
org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:587)

The crux of the issue seems to be that lucene cannot open segments file that
is inside the jar (under luceneFiles/index directory)

The current project structure involves creating module jars in maven and
having a web tier module use the lucene module jar. The index files are
built at build time as part of lucene module project. The issue with
building the index separate from the application  is that a bunch of
unit/integration/functional tests depend on index files to be created. The
manual step of creating the index files breaks the automated CI builds or
some reliance on building the index in some tmp directory. Unfortunately
that approach has issues if we run tests concurrently. Also, building the
index takes a couple of minutes, so generating them on the fly for tests is
expensive and increases the build time.

The only options suggested in the forums is to do something special like
extending the Directory class to open the jar. Is there another way to solve
this problem in an easier manner or am i missing something simple ?

Any thoughts/suggestions are appreciated,

Ravi 


-- 
View this message in context: http://www.nabble.com/Opening-an-index-directory-inside-a-jar-tp17526678p17526678.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34209-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 04:26:06 2008
Return-Path: <java-user-return-34209-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1669 invoked from network); 29 May 2008 04:26:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 04:26:05 -0000
Received: (qmail 90759 invoked by uid 500); 29 May 2008 04:26:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90729 invoked by uid 500); 29 May 2008 04:26:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90717 invoked by uid 99); 29 May 2008 04:26:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 21:26:00 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 72.14.220.157 as permitted sender)
Received: from [72.14.220.157] (HELO fg-out-1718.google.com) (72.14.220.157)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 04:25:13 +0000
Received: by fg-out-1718.google.com with SMTP id l27so2175893fgb.27
        for <java-user@lucene.apache.org>; Wed, 28 May 2008 21:25:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=ILMYJF9X+sl9QybxAixpgyHe7rnMveVn4sxpGtzyp4g=;
        b=vXDjHVxj5q+vyuuVLwgyEK0TEPTRm/GhGwd2ilow12AjfNU4UDdBAs2XppwdJCa0awa/SI2pUeX993NnDvu1ov2boJyOfvqUta5Zj8fVQsP5ZZK5wBa2sWBmEGFgUpsvq0SlzHjzCWodAkbPsK/AQkSNwenOWesQR1RxFXNp4I4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=MYrUsqCSJzWCioG9GhPjw6hFrzg7YKnizgW57k4aYrXgOT2d32hzfME3nAPc15BRJGDt/tvIM37MihO2qdpbHt06bn9LFNFPempVWR5r4DoPZ0i9l1X6ON7NFk2+MR5grozIaeUSpRA8KfYdcgBMSxdO29vraCgoA8xCH5QSf0s=
Received: by 10.82.136.4 with SMTP id j4mr435878bud.46.1212035128035;
        Wed, 28 May 2008 21:25:28 -0700 (PDT)
Received: by 10.82.135.16 with HTTP; Wed, 28 May 2008 21:25:27 -0700 (PDT)
Message-ID: <8837fb770805282125w5f3d7101i4b42b0c55edd3a5a@mail.gmail.com>
Date: Wed, 28 May 2008 21:25:27 -0700
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: IndexReader.reopen memory leak
In-Reply-To: <483DE95C.9030501@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_15412_19260067.1212035127974"
References: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com>
	 <483DD50C.3080908@gmail.com> <483DE95C.9030501@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_15412_19260067.1212035127974
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Yes, I do close the old reader.
I have a large index, my system is doing real time updates: 1 thread writing
batches of updates to the index, after each index update, it updates the
reader. I have two readers open always, one is serving the search requests,
while the other updates and the two flips. Reader update implies index
reopen here.

I am using my implementation of a FilteredIndexReader.

Index leaks very slowly, but obvious.

No, I am not able to provide heap dumps.

-John

On Wed, May 28, 2008 at 4:23 PM, Mark Miller <markrmiller@gmail.com> wrote:

> As someone that has done a lot of reopens, I can vouch there is no leak
> under simple, normal usage. Are you sure your closing the original reader
> after getting the reopened reference?
>
>
> Michael Busch wrote:
>
>> Hi John,
>>
>> hmm not good. I will take a look. It has probably to do with the reference
>> counting. Are you doing anything special? E. g. do you have own reader
>> implementations that you call reopen() on? What kinds of readers are you
>> using?
>>
>> Are you maybe able to provide a heapdump?
>>
>> -Michael
>>
>> John Wang wrote:
>>
>>> Hi:
>>>
>>>  We are experiencing memory leak with calling IndexReader.reopen().
>>>
>>>   From eyeballing the lucene source code, I am seeing normCache is not
>>> cleared.
>>>
>>>
>>>   Anyone else experiencing this?
>>>
>>> Thanks
>>>
>>> -John
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_15412_19260067.1212035127974--

From java-user-return-34210-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 06:23:05 2008
Return-Path: <java-user-return-34210-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30658 invoked from network); 29 May 2008 06:23:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 06:23:05 -0000
Received: (qmail 63748 invoked by uid 500); 29 May 2008 06:23:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63721 invoked by uid 500); 29 May 2008 06:23:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63710 invoked by uid 99); 29 May 2008 06:23:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 May 2008 23:23:00 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [69.89.20.190] (HELO outbound-mail-36.bluehost.com) (69.89.20.190)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 29 May 2008 06:22:09 +0000
Received: (qmail 9482 invoked by uid 0); 29 May 2008 06:22:23 -0000
Received: from unknown (HELO box108.bluehost.com) (69.89.22.108)
  by outboundproxy2.bluehost.com with SMTP; 29 May 2008 06:22:23 -0000
Received: from c-71-204-121-58.hsd1.ga.comcast.net ([71.204.121.58] helo=[10.0.1.200])
	by box108.bluehost.com with esmtpsa (TLSv1:AES128-SHA:128)
	(Exim 4.68)
	(envelope-from <emmanuel@hibernate.org>)
	id 1K1bWo-0005ZR-0g
	for java-user@lucene.apache.org; Thu, 29 May 2008 00:22:23 -0600
Message-Id: <57D07470-589F-4965-95A3-50157474E222@hibernate.org>
From: Emmanuel Bernard <emmanuel@hibernate.org>
To: java-user@lucene.apache.org
In-Reply-To: <BAY112-W4466FFA10841E02A9ACE2AF9C30@phx.gbl>
Content-Type: text/plain; charset=WINDOWS-1252; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Improving search performance
Date: Thu, 29 May 2008 02:22:19 -0400
References: <BAY112-W4466FFA10841E02A9ACE2AF9C30@phx.gbl>
X-Mailer: Apple Mail (2.919.2)
X-Identified-User: {1307:box108.bluehost.com:emmanue2:emmanuelbernard.com} {sentby:smtp auth 71.204.121.58 authed with oss+emmanuelbernard.com}
DomainKey-Status: no signature
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Rakesh,
I've spend the afternoon and the evening playing around your test =20
because I could not stand Hibernate Search to be significantly slower =20=

than native Lucene ;)
I found several causes but as far as your test case is concerned, it =20
turns out you are reaching the scalability limit of a single =20
IndexSearcher as Otis mentioned a couple of emails ago. 100 threads in =20=

parallel are too much. You are better off using a pool of IndexSearcher.

How much? It's hard to say, because the less  IndexSearchers, the =20
better you benefit from the warm up effect. I guess the optimal value =20=

depends on your index size and the number of expected concurrent =20
threads. Give it a try with different values.

Not related to this thread specifically but I have kept notes of some =20=

ideas to bring back HSearch and Lucene neck to neck performance wise. =20=

I've also explained there why your HSearch vs Lucene perf test was not =20=

fair.
http://opensource.atlassian.com/projects/hibernate/browse/HSEARCH-194

HTH

Emmanuel

On  May 25, 2008, at 04:53, Rakesh Shete wrote:

>
> Hi ,
>
> I have written a program to simulate the multi-thread behavior and =20
> check the performance.
> I have attached the program and results.
>
> The JVM parameters when running the program: -Xms128m -Xmx1028m on a =20=

> P4 2.66 Ghz, 1.99GB RAM machine.
>
> Here are the observations:
> 1. The response time to fire a query and return back increases as =20
> the number of threads increases: from 10-100 (I haven=92t used any =20
> threadpool. JVM default behavior is used)
> 2. After optimizing the index, the response time improved =20
> significantly. Like in case of 100 threads, the average response =20
> time, using optimized index, is between 1-1.3 seconds as compared to =20=

> 4-5.5 seconds using the non-optimized index
>
> Is there anything else that I should be looking into to further =20
> improve the performance?
>
> --Rakesh S
>
>> Date: Fri, 23 May 2008 20:24:03 -0700
>> From: otis_gospodnetic@yahoo.com
>> Subject: Re: Improving search performance
>> To: java-user@lucene.apache.org
>>
>> Hi Emmanuel,
>>
>> Because there are some synchronized methods, like the one that =20
>> checks whether a doc is deleted, that get called during search. If =20=

>> you have a pile of threads (op. p. mentioned 100 threads) there =20
>> could be contention around those methods.
>>
>> Otis
>> --
>> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>>
>>
>> ----- Original Message ----
>>> From: Emmanuel Bernard
>>> To: java-user@lucene.apache.org
>>> Sent: Friday, May 23, 2008 6:41:36 PM
>>> Subject: Re: Improving search performance
>>>
>>> Hi
>>> Hibernate Search does not pool the Searcher but pools the underlying
>>> IndexReader(s). =46rom what i've seen, a Searcher is stateless and =
all
>>> the state is kept in the Readers. so this essentially is =20
>>> equivalent to
>>> reusing the searcher.
>>>
>>> Out of curiosity why is a pool of Searcher more efficient?
>>>
>>> Emmanuel
>>>
>>> On May 22, 2008, at 13:22, Otis Gospodnetic wrote:
>>>
>>>> Some quick feedback. Those are all very expensive queries
>>>> (wildcards and ranges). The first thing I'd do is try without
>>>> Hibernate Search (to make sure HS is not the bottleneck). 100
>>>> threads is a lot, I'm guessing you are reusing your searcher, which
>>>> is good, but you will actually improve performance a bit if you =20
>>>> work
>>>> with a small pool of searchers instead of a single searcher.
>>>>
>>>> Otis
>>>> --
>>>> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>>>>
>>>>
>>>> ----- Original Message ----
>>>>> From: Rakesh Shete
>>>>> To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
>>>>> Sent: Thursday, May 22, 2008 1:16:13 PM
>>>>> Subject: Improving search performance
>>>>>
>>>>>
>>>>> Hi all,
>>>>>
>>>>> I have index of size 85MB. My query looks as follows:
>>>>>
>>>>> +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:
>>>>> [20080410 TO
>>>>> 20081010] +rT:[002 TO 005]
>>>>>
>>>>> All the fields used in the query are stored in the indexes =20
>>>>> (Indexed
>>>>> & Stored)
>>>>>
>>>>> The query response time for me is around 30 seconds when running
>>>>> mutliple
>>>>> simultanoeous threads (~100). The no. of matches is ~30k but I
>>>>> retrieve only the
>>>>> top 100 results. I am using Hibernate Search which is a wrapper
>>>>> around Lucene. I
>>>>> retrieve the "id" filed from the index which is also indexex and
>>>>> stored.
>>>>>
>>>>> What is the approach that I should take for improving the
>>>>> performance?
>>>>>
>>>>> Will just indexing the values without storing them work (Index &
>>>>> UnStored)?
>>>>>
>>>>> My machine configuration is:
>>>>> P4 2.66GHz 1.99 GB RAM
>>>>>
>>>>> The code for searching runs in JBoss application server which =20
>>>>> has a
>>>>> maximum heap
>>>>> size of 1024MB. When these 100 threads are running in the
>>>>> application server the
>>>>> CPU utilization is 100% and JBoss consumes all of the heap size.
>>>>>
>>>>> Any pointers on index optimization would be really appreciated.
>>>>>
>>>>> --Regards,
>>>>> Rakesh Shete
>>>>>
>>>>> _________________________________________________________________
>>>>> No Harvard, No Oxford. We are here. Find out !!
>>>>> http://ss1.richmedia.in/recurl.asp?pid=3D500
>>>>
>>>>
>>>> =
---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>>
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
> _________________________________________________________________
> Catch the latest fashion shows, get beauty tips and learn more on =20
> fashion and lifestyle.
> http://video.msn.com/?mkt=3Den-in<Performance =20
> logs=20
> .zip=20
> >---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34211-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 07:38:49 2008
Return-Path: <java-user-return-34211-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54128 invoked from network); 29 May 2008 07:38:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 07:38:48 -0000
Received: (qmail 45513 invoked by uid 500); 29 May 2008 07:38:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45483 invoked by uid 500); 29 May 2008 07:38:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45414 invoked by uid 99); 29 May 2008 07:38:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 00:38:34 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 74.125.46.30 as permitted sender)
Received: from [74.125.46.30] (HELO yw-out-2324.google.com) (74.125.46.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 07:37:46 +0000
Received: by yw-out-2324.google.com with SMTP id 3so1817865ywj.5
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 00:37:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=xSpHv54SwHdoTznVpRJfZttQOvMeNP5+/IAqSba5EKk=;
        b=dAicbZGK5A4LOJH4V6bNd+H1AyQOPBc3BfCsOMg1HXzGAAtLmrjxikgWvO7KMyy6eEOeEkIhzhP+LrCLihVK1+tqNEcWiRw0c954zg1FhyMGecN4SqiVo1lntRpJrS10521NNRdJL2xSY7DypBqe0/nBqdBPlyKMvBQWgjJW0O4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=QntSsOYcTuNpvFF1GeplV7sruPfgkdoAJcjEDmYGQ/Le9u+gkNwN0YDtzpaS09X8ctDOVPGNat+7/njKsKXiF66LTujXzftz3YAu+q4NSOwXjd3ILNXsM/efUnHBCCdNfnylsxgpXfP0uPRBVNckBITHpbdRUBvccI/oZcnyXPY=
Received: by 10.151.113.5 with SMTP id q5mr4798957ybm.120.1212046677903;
        Thu, 29 May 2008 00:37:57 -0700 (PDT)
Received: from ?192.168.1.103? ( [70.137.152.170])
        by mx.google.com with ESMTPS id 4sm505021yxq.8.2008.05.29.00.37.55
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 00:37:56 -0700 (PDT)
Message-ID: <483E5CD9.8080005@gmail.com>
Date: Thu, 29 May 2008 00:35:53 -0700
From: Michael Busch <buschmic@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: IndexReader.reopen memory leak
References: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com>	 <483DD50C.3080908@gmail.com> <483DE95C.9030501@gmail.com> <8837fb770805282125w5f3d7101i4b42b0c55edd3a5a@mail.gmail.com>
In-Reply-To: <8837fb770805282125w5f3d7101i4b42b0c55edd3a5a@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Could you share some details about how you implemented reopen() in your 
reader?

-Michael

John Wang wrote:
> Yes, I do close the old reader.
> I have a large index, my system is doing real time updates: 1 thread writing
> batches of updates to the index, after each index update, it updates the
> reader. I have two readers open always, one is serving the search requests,
> while the other updates and the two flips. Reader update implies index
> reopen here.
> 
> I am using my implementation of a FilteredIndexReader.
> 
> Index leaks very slowly, but obvious.
> 
> No, I am not able to provide heap dumps.
> 
> -John
> 
> On Wed, May 28, 2008 at 4:23 PM, Mark Miller <markrmiller@gmail.com> wrote:
> 
>> As someone that has done a lot of reopens, I can vouch there is no leak
>> under simple, normal usage. Are you sure your closing the original reader
>> after getting the reopened reference?
>>
>>
>> Michael Busch wrote:
>>
>>> Hi John,
>>>
>>> hmm not good. I will take a look. It has probably to do with the reference
>>> counting. Are you doing anything special? E. g. do you have own reader
>>> implementations that you call reopen() on? What kinds of readers are you
>>> using?
>>>
>>> Are you maybe able to provide a heapdump?
>>>
>>> -Michael
>>>
>>> John Wang wrote:
>>>
>>>> Hi:
>>>>
>>>>  We are experiencing memory leak with calling IndexReader.reopen().
>>>>
>>>>   From eyeballing the lucene source code, I am seeing normCache is not
>>>> cleared.
>>>>
>>>>
>>>>   Anyone else experiencing this?
>>>>
>>>> Thanks
>>>>
>>>> -John
>>>>
>>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34212-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 08:57:10 2008
Return-Path: <java-user-return-34212-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80734 invoked from network); 29 May 2008 08:57:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 08:57:10 -0000
Received: (qmail 45712 invoked by uid 500); 29 May 2008 08:57:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45686 invoked by uid 500); 29 May 2008 08:57:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45675 invoked by uid 99); 29 May 2008 08:57:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 01:57:05 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 08:56:11 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1K1dw1-0007tx-K0
	for java-user@lucene.apache.org; Thu, 29 May 2008 01:56:33 -0700
Message-ID: <17530428.post@talk.nabble.com>
Date: Thu, 29 May 2008 01:56:33 -0700 (PDT)
From: "Pablo B." <pablo@dcs.gla.ac.uk>
To: java-user@lucene.apache.org
Subject: "No tvx file" error
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: pablo@dcs.gla.ac.uk
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,

I am writing a code to convert all text files in subdirectories from a given
path to Arff file for weka. To do so, I am using lucene-1.4.3.jar. The call
to method writer.add(doc) outputs (only for some text files) the error
message "No tvx file", were writer is type IndexWriter and doc is type
Document.
If I change the name of the files that trigger this message, the error does
not occur on them but it is output for other files with which it worked
correctly. i am going crazy! 

In some forums I have read it is only a warning message, but I cannot ignore
it because it does not index those files, so later, in my own code, when I
call termFreqVector.getTerms() for the failing file, it returns a null
pointer exception, which does not make sense because the file has text in
it!

Any one can help?
Thank you in advanced,
Pablo.

-- 
View this message in context: http://www.nabble.com/%22No-tvx-file%22-error-tp17530428p17530428.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34213-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 10:20:19 2008
Return-Path: <java-user-return-34213-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18483 invoked from network); 29 May 2008 10:20:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 10:20:18 -0000
Received: (qmail 33657 invoked by uid 500); 29 May 2008 10:20:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33417 invoked by uid 500); 29 May 2008 10:20:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33399 invoked by uid 99); 29 May 2008 10:20:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 03:20:12 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of sonusr@gmail.com designates 209.85.198.228 as permitted sender)
Received: from [209.85.198.228] (HELO rv-out-0506.google.com) (209.85.198.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 10:19:25 +0000
Received: by rv-out-0506.google.com with SMTP id f6so3404321rvb.5
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 03:19:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=XGW+YipicsSFkVgfggPznN34NwpIqJIzPm/Un4Nx0/Q=;
        b=RK1/sPeUNLpK9IMViGMJlhrQUzDCmbT6a+hkbJtIPoHHL4VfwHIA3Zl0TiBvNl+IyObs/aHCebQZXr3yTMyeXlssY6syNqM5tRz3jqB+iWiNzXGHGq8XUwx+1RB/x2XZkJn49fV2Vqglefc9QkLy7Sa4yja6o9AZiGyuDzoCSsQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=FauDrl/M1qP0GuBEDaRm9rIif7bRBPEQG8MllMV0Zma0TU3QQdYQqnojUPGwMJwf0MhId/Nuuisvz/xIZsxDzU5xrDKBalzBHzqz/veBWwRXhcrfJD27LMsECbt9VBz3GdVrul94YUAjzsehdniHoU9ZFjdbAoraOc6anm6NFAE=
Received: by 10.140.250.14 with SMTP id x14mr1940038rvh.79.1212056381841;
        Thu, 29 May 2008 03:19:41 -0700 (PDT)
Received: by 10.141.179.14 with HTTP; Thu, 29 May 2008 03:19:41 -0700 (PDT)
Message-ID: <d5b3ea330805290319sa68fc9dtf5197ad839a87ecc@mail.gmail.com>
Date: Thu, 29 May 2008 15:49:41 +0530
From: "Sonu Sudhakar" <sonusr@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Boolean Query Issue
In-Reply-To: <359a92830805280639t947f608o6bf280d131e8b7a9@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_3504_31383239.1212056381841"
References: <d5b3ea330805280444s313e0e86n5948ac73081263c0@mail.gmail.com>
	 <359a92830805280639t947f608o6bf280d131e8b7a9@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_3504_31383239.1212056381841
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Erick,

Thanks for your reply.

I am working with approximately 1 million documents. They are indexed in 4
servers. Each document has multiple fields. I am using ParallelMultiSearcher
for searching purpose.

I tried a few queries in the title(TTL) field.

i started with a simple query without boolean operators.

*1. TTL:data => 3733 results (all matches had "data" in title)*

Then I tried a second one with AND operator.

*2. TTL:data AND TTL:store => 19 results*

I analyzed the results. the results had both "data" and "store" in the
title.

*I then tried OR operator*

*3. TTL:data AND TTL:store OR TTL:variable*

I got 3,733 results., same as the query TTL:data.

I even tried giving a meaningless query

TTL:data AND TTL:storettttt OR TTL:variablettttt => 3,733 results (The
results were same as that of TTL:data.)

TTL:data AND TTL:computer OR TTL:device => 3,733 results (this also showed
the same results as above)

The same thing repeats for other cases too. The queries below also behaved
the same way.
i.e. -

1. TTL:store AND TTL:data OR TTL:variable => 76 results
2. TTL:store AND TTL:datatttt OR TTL:variabletttt => 76 results
3. TTL:store AND TTL:computer OR TTL:device => 76 results


1. TTL:variable AND TTL:data OR  TTL:store => 1,496 results
2. TTL:variable AND TTL:datatttt OR  TTL:storetttt => 1,496 results
3. TTL:variable AND TTL:computer OR  TTL:device => 1,496 results

I hope you have a clearer picture of my issue now.

Thanks,
Sonu

On Wed, May 28, 2008 at 7:09 PM, Erick Erickson <erickerickson@gmail.com>
wrote:

> It's unclear what you *should* expect. How is your data
> distributed?
>
> In other words, how many documents do you have? In this example,
> for instance,
> 1. TTL:data AND TTL:store OR TTL:variable => 3,733 results
> it considered the TTL:data part only.
>
> it's perfecily reasonable if every document that had "variable" in the
> field *also* has "data" and "store" in the field. So your numbers
> don't give us much to work with.....
>
> Remember, though, that Lucene syntax isn't a pure boolean syntax. See
>
> http://wiki.apache.org/lucene-java/BooleanQuerySyntax
>
> And when in doubt parenthesize <G>...
>
> Best
> Erick
>
> On Wed, May 28, 2008 at 7:44 AM, Sonu Sudhakar <sonusr@gmail.com> wrote:
>
> > Hi,
> >
> > I have some issue with boolean queries.
> >
> > I am using Lucene-core-2.3.1.
> >
> > I have done test on boolean query with 3 terms (data, store, variable) in
> > my
> > TTL field. The TTL field is indexed and searched using StandardAnalyzer.
> >
> > The three terms when searched individually gave the following result
> >
> > 1. TTL:data  => 3,733 results
> > 2. TTL:store  => 76 results
> > 3. TTL:variable  => 1,496 results
> >
> > But found issue when combining these terms with boolean operators.
> >
> > e.g.
> > 1. TTL:data AND TTL:store OR TTL:variable => 3,733 results
> > it considered the TTL:data part only.
> >
> > 2. TTL:store AND TTL:data OR TTL:variable => 76 results
> > it considered  the TTL:store part only.
> >
> > 3. TTL:variable AND TTL:data OR  TTL:store => 1,496 results
> > it considered  the TTL:variable part only.
> >
> > But I am getting correct result when combining terms with 'AND' operator.
> I
> > think the issue is with 'OR' operator.
> >
> >
> > Could anybody give an explanation for this behavior of lucene?
> > Could you give suggestions to rectify this?
> >
> > Thanks,
> > Sonu
> >
>

------=_Part_3504_31383239.1212056381841--

From java-user-return-34214-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 12:29:28 2008
Return-Path: <java-user-return-34214-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63761 invoked from network); 29 May 2008 12:29:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 12:29:28 -0000
Received: (qmail 80310 invoked by uid 500); 29 May 2008 12:29:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80234 invoked by uid 500); 29 May 2008 12:29:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80207 invoked by uid 99); 29 May 2008 12:29:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 05:29:17 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nttstar@gmail.com designates 209.85.142.187 as permitted sender)
Received: from [209.85.142.187] (HELO ti-out-0910.google.com) (209.85.142.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 12:28:30 +0000
Received: by ti-out-0910.google.com with SMTP id b8so2571564tic.11
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 05:28:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=VQqj0OeSCEwgvV+Ngxsrmmn/NKzdMU1ZtiFZm/UbCPg=;
        b=rV9fyG92EYpoq3lOdIf9Q93WHXabc82gO9zV1iDFQdUD/WU4+OSMv4O0QA3jBm5pCNAF8EIYR145OgVEj50f5tITt77bXY6AUZjX8vSOvnksWBtiRBttDtaN5HVWgeKaj/nbpCo0bJCKIYQd6KFMQ6GI49hc99cVAHW294kl4Ts=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Kwcnb5IB9dn5QLWo+9seNkUm6iD4pXJrlyTZNSklm8O7BQQ/gm2OETHWT9w/bUM2Y6HP2qoaDNiLxdAqFbr44lCWyvrwnN/Nl2HvH5UwnGqC9p5DGAUknZYukdIBR39n+vrbWY4C1+6Jugemzu1HEyIzGclykyoQFn+nBOUQIf0=
Received: by 10.110.41.17 with SMTP id o17mr544992tio.5.1212064124244;
        Thu, 29 May 2008 05:28:44 -0700 (PDT)
Received: by 10.110.16.20 with HTTP; Thu, 29 May 2008 05:28:43 -0700 (PDT)
Message-ID: <11e088b10805290528gfa20aa2rc4fc4f0622038644@mail.gmail.com>
Date: Thu, 29 May 2008 20:28:43 +0800
From: "=?GB2312?B?uf280Q==?=" <nttstar@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to add PageRank score with lucene's relevant score in sorting
In-Reply-To: <5e76f3840805280751s11443ed1i3653edd5e764b09e@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5995_33461000.1212064124263"
References: <11e088b10805280302q933d019k2a7baad10d43e04f@mail.gmail.com>
	 <8c4e68610805280312wc7e7d9at399a323d9f248832@mail.gmail.com>
	 <11e088b10805280447w35d83c4ewc076a6ce2778f25@mail.gmail.com>
	 <8c4e68610805280603l51631a89t87de0764f7965439@mail.gmail.com>
	 <11e088b10805280645j45427491s4764238051e94432@mail.gmail.com>
	 <5e76f3840805280751s11443ed1i3653edd5e764b09e@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5995_33461000.1212064124263
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: base64
Content-Disposition: inline

dGhhbmtzIEdsZW4gLCB3ZSBoYXZlIHRyaWVkIGl0ICwgYnV0IHRoZSBib3R0bGVuZWNrIGlzIHRv
IGdldCB0aGUgZG9jdW1lbnQKKGluZGV4UmVhZGVyLmRvY3VtZW50KG51bSkpLCBzbyBpdCBpcyBu
b3QgZWZmaWNpZW50IGVub3VnaCAuCgoyMDA4LzUvMjgsIEdsZW4gTmV3dG9uIDxnbGVuLm5ld3Rv
bkBnbWFpbC5jb20+Ogo+Cj4gWW91IHNob3VsZCBjb25zaWRlciBrZWVwaW5nIHRoZSBQYWdlUmFu
ayAoYW5kIGFueSBvdGhlciBtb3JlIGR5bmFtaWMKPiBkYXRhKSBpbiBhIHNlcGFyYXRlIGluZGV4
ICh3aXRoIHRoZSBkb2N1bWVudHMgaW4gdGhlIHNhbWUgb2RlciBhcyB5b3VyCj4gYmlnZ2VyLCBt
b3JlIHN0YXRpYyBpbmRleCkgYW5kIHRoZW4gdXNlIGEgUGFyYWxsZWxSZWFkZXIgb24gYm90aCBv
Zgo+IHRoZW0uIFNlZToKPgo+IGh0dHA6Ly9sdWNlbmUuYXBhY2hlLm9yZy9qYXZhLzJfMV8wL2Fw
aS9vcmcvYXBhY2hlL2x1Y2VuZS9pbmRleC9QYXJhbGxlbFJlYWRlci5odG1sCj4KPiAtR2xlbgo+
Cj4gMjAwOC81LzI4ILn9vNEgPG50dHN0YXJAZ21haWwuY29tPjoKPiA+IEkgdGhpbmsgdGhpcyBp
cyBub3Qgc3VpdGFibGUgZm9yIG15IHN5c3RlbSBzaW5jZSB0aGUgbnVtIG9mIHBhZ2VzIGlzIHZl
cnkKPiA+IGxhcmdlIHRoYXQgd2lsbCBjb3N0IG11Y2ggdGltZSBmb3IgcmVpbmRleAo+ID4KPiA+
IDIwMDgvNS8yOCwgSWFuIExlYSA8aWFuLmxlYUBnbWFpbC5jb20+Ogo+ID4+Cj4gPj4gWWVzLiAg
QnV0IHlvdSdkIGhhdmUgdG8gZG8gdGhhdCBhbnl3YXkgaWYgeW91IGFyZSBzdG9yaW5nIHBhZ2Vy
YW5rIGluCj4gdGhlCj4gPj4gaW5kZXguCj4gPj4KPiA+PiBPbmUgcG9pbnQgb24geW91ciAyMHMg
cmVzcG9uc2UgdGltZSBmb3Igc29ydGluZyAtIGlzIHRoYXQgZm9yIHRoZQo+ID4+IGZpcnN0IHNv
cnQgb3Igc3Vic2VxdWVudCBvbmVzPwo+ID4+IEkgYmVsaWV2ZSB0aGF0IHRoZSBmaXJzdCBvbmUg
d2lsbCB1c3VhbGx5IGJlIHN1YnN0YW50aWFsbHkgc2xvd2VyLgo+ID4+IEJ1dCBzb3J0aW5nIGlz
IGFsd2F5cyBsaWtlbHkgdG8gYmUgc2xvd2VyIHRoYW4gbm90IHNvcnRpbmcuCj4gPj4KPiA+Pgo+
ID4+IC0tCj4gPj4gSWFuLgo+ID4+Cj4gPj4KPiA+PiBPbiBXZWQsIE1heSAyOCwgMjAwOCBhdCAx
Mjo0NyBQTSwguf280SA8bnR0c3RhckBnbWFpbC5jb20+IHdyb3RlOgo+ID4+ID4gdGhhbmtzIGxh
biwgYnV0IHRoaXMgbWVhbnMgdGhhdCBpIG11c3QgcmVpbmRleCB0aGVzZSBwYWdlcyB3aGlsZSB0
aGUKPiA+PiA+IHBhZ2VyYW5rIHNjb3JlIGNoYW5nZWQ/Cj4gPj4gPgo+ID4+ID4g1NowOC01LTI4
o6xJYW4gTGVhIDxpYW4ubGVhQGdtYWlsLmNvbT4g0LS1wKO6Cj4gPj4gPj4KPiA+PiA+PiBIaQo+
ID4+ID4+Cj4gPj4gPj4KPiA+PiA+PiBNYXliZSB5b3UgY291bGQgdXNlIHRoZSBwYWdlcmFuayBz
Y29yZSwgcG9zc2libHkgbW9kaWZpZWQsIGFzCj4gZG9jdW1lbnQKPiA+PiA+PiBib29zdCBhdCBp
bmRleGluZyB0aW1lLiAgRnJvbSB0aGUgamF2YWRvY3MgZm9yCj4gPj4gPj4gRG9jdW1lbnQuc2V0
Qm9vc3QoYm9vc3QpCj4gPj4gPj4KPiA+PiA+PiAiU2V0cyBhIGJvb3N0IGZhY3RvciBmb3IgaGl0
cyBvbiBhbnkgZmllbGQgb2YgdGhpcyBkb2N1bWVudC4gVGhpcwo+ID4+ID4+IHZhbHVlIHdpbGwg
YmUgbXVsdGlwbGllZCBpbnRvIHRoZSBzY29yZSBvZiBhbGwgaGl0cyBvbiB0aGlzIGRvY3VtZW50
Igo+ID4+ID4+Cj4gPj4gPj4gc28gd2lsbCBnaXZlIHlvdSBQICogUiByYXRoZXIgdGhhbiBQICsg
Ui4gIFNob3VsZCBiZSBxdWljaywgdGhvdWdoLgo+ID4+ID4+Cj4gPj4gPj4KPiA+PiA+PiAtLQo+
ID4+ID4+IElhbi4KPiA+PiA+Pgo+ID4+ID4+Cj4gPj4gPj4gT24gV2VkLCBNYXkgMjgsIDIwMDgg
YXQgMTE6MDIgQU0sILn9vNEgPG50dHN0YXJAZ21haWwuY29tPiB3cm90ZToKPiA+PiA+PiA+IGhp
IGFsbCAsCj4gPj4gPj4gPiAgICAgSSBoYXZlIGEgcHJvYmxlbSB0aGF0IGhvdyB0byAiY29tYmlu
ZSIgdHdvIHNjb3JlIHRvIHNvcnQgdGhlCj4gPj4gc2VhcmNoCj4gPj4gPj4gPiByZXN1bHQgZG9j
dW1lbnRzLgo+ID4+ID4+ID4gICAgIGZvciBleGFtcGxlIEkgIGhhdmUgMTAgbWlsbGlvbiBwYWdl
cyBpbiBsdWNlbmUgaW5kZXggLCBhbmQgaQo+IGtub3cKPiA+PiA+PiB0aGVpcgo+ID4+ID4+ID4g
cGFnZXJhbmsgc2NvcmVzLiBpIGdpdmUgYSBxdWVyeSB0byBpdCAsIGV2ZXJ5IGRvY3MgcmV0dXJu
ZWQgaGF2ZSBhCj4gPj4gPj4gPiBsdWNlbmUtc2NvcmUsIG1hcmsgaXQgYXMgUiAocmVsZXZhbnQg
c2NvcmUpLCBhbmQgIGkgIGFsc28gIGhhdmUgaXRzCj4gPj4gPj4gPiBwYWdlcmFuayBzY29yZSwg
bWFyayBpdCBhcyBQLCAgd2hhdCBpIG5lZWQgaXMgaSB3YW50IHRvIHNvcnQgdGhlCj4gPj4gc2Vh
cmNoCj4gPj4gPj4gPiByZXN1bHQgYmFzZSBvbiB0aGUgdmFsdWUgIlArUiIuICBZb3Uga25vdyBp
ZiBpIHN0b3JlIHRoZSBwYWdlcmFuawo+ID4+IHNjb3JlCj4gPj4gPj4gaW4KPiA+PiA+PiA+IGlu
ZGV4IGFuZCBnZXQgaXQgZXZlcnkgc2VhcmNoIHRpbWUgLCB0aGVuIGNvbXB1dGUgUCtSICwgdGhl
biBzb3J0Cj4gaXQgLAo+ID4+ID4+IHRoaXMKPiA+PiA+PiA+IHdheSBpcyB0b28gc2xvdy4gaW4g
bXkgc3lzdGVtICwgd2hlbiB0aGUgc2VhcmNoIGhpdHMgNTAwMDAwIHJlc3VsdAo+ICwKPiA+PiB0
aGUKPiA+PiA+PiA+IHNvcnQgbWF5IGNvc3QgYWJvdXQgMjBzLgo+ID4+ID4+ID4gICBTb3JyeSBm
b3IgbXkgcG9vciBlbmdsaXNoLiAgQW55b25lIGhhcyBhIGdvb2QgaWRlYT8KPiA+PiA+PiA+Cj4g
Pj4gPj4gPiBCZXN0Cj4gPj4gPj4gPiBKYXJ2aXMKPiA+PiA+PiA+Cj4gPj4gPj4KPiA+PiA+Cj4g
Pj4KPiA+Cj4KPgo+Cj4gLS0KPgo+IC0KPgo=
------=_Part_5995_33461000.1212064124263--

From java-user-return-34215-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 13:03:46 2008
Return-Path: <java-user-return-34215-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82319 invoked from network); 29 May 2008 13:03:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 13:03:46 -0000
Received: (qmail 34463 invoked by uid 500); 29 May 2008 13:03:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34435 invoked by uid 500); 29 May 2008 13:03:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34424 invoked by uid 99); 29 May 2008 13:03:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 06:03:41 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chrislin0426@gmail.com designates 74.125.44.28 as permitted sender)
Received: from [74.125.44.28] (HELO yx-out-2324.google.com) (74.125.44.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 13:02:53 +0000
Received: by yx-out-2324.google.com with SMTP id 31so270393yxl.5
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 06:03:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=x9cGcsXKHY9vFr7cVVyGZkXZrS2gWfs345dYY0KvevI=;
        b=h6e9IsuL0NCAPMhRkFhkwlmSY0A6u/oG+/cS1fNQxIuEw/pigxt9IVasfv1PzcL9RU15TRk3lEXv+8mGRAuvDF5C1x0AiK5GeEn+l6/SAs9KJaEBevtDayXEHvR8ekTtIAhhHaqidTA71DvlZ3caH9trtTUKMGxQxF2rEKbqE90=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=Kb9I2V0z6anjbPljP7U/N13dM7ACvCxB4VdW5KmHU9UYi9Vju8pOIETjOXRDxYur2xxf/aXiGiwWfAY5hj7FZEBPuuL0P658YhKSv2KGTRFBfzGs7oRXQiwT9j6pPnU9QWqlA/ZtKAxorSVmzmimBBTpVSOY50wQdbLE+6a/pRg=
Received: by 10.150.86.10 with SMTP id j10mr6173542ybb.211.1212066189218;
        Thu, 29 May 2008 06:03:09 -0700 (PDT)
Received: by 10.150.202.10 with HTTP; Thu, 29 May 2008 06:03:09 -0700 (PDT)
Message-ID: <89762a530805290603l42ee0b13m4d569512d19d343e@mail.gmail.com>
Date: Thu, 29 May 2008 21:03:09 +0800
From: Chris <chrislin0426@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to add PageRank score with lucene's relevant score in sorting (with Paralle Index modify)
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_20042_12473784.1212066189237"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_20042_12473784.1212066189237
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: base64
Content-Disposition: inline

SSBoYXZlIGEgcXVlc3Rpb24gd2l0aCBQYXJhbGxlUmVhZGVyLgpJIHdhbnQgdG8gbW9kaWZ5IHRo
ZSBkeW5hbWljIGluZGV4ICwgaG93IGNvdWxkIEkgc2V0IHRoZSBzYW1lIGRvY2lkIHRvIGFkZAp0
aGUgb3JpZ2luYWwgZG9jaWQgd2l0aCB0aGUgbW9yZSBzdGF0aWMgaW5kZXggPwoKRG9lcyBhbnlv
bmUgaGF2ZSB0aGUgaWRlYSBvciBtZXRob2QgdG8gZG8gaXQgd2VsbCA/CgpUaGFuayB5b3UuCgph
Ym92ZQogICAgICAgICAgICAgICAgICAgICAgICAgIENocmlzTGluCgoyMDA4LzUvMjggR2xlbiBO
ZXd0b24gPGdsZW4ubmV3dG9uQGdtYWlsLmNvbT46Cgo+IFlvdSBzaG91bGQgY29uc2lkZXIga2Vl
cGluZyB0aGUgUGFnZVJhbmsgKGFuZCBhbnkgb3RoZXIgbW9yZSBkeW5hbWljCj4gZGF0YSkgaW4g
YSBzZXBhcmF0ZSBpbmRleCAod2l0aCB0aGUgZG9jdW1lbnRzIGluIHRoZSBzYW1lIG9kZXIgYXMg
eW91cgo+IGJpZ2dlciwgbW9yZSBzdGF0aWMgaW5kZXgpIGFuZCB0aGVuIHVzZSBhIFBhcmFsbGVs
UmVhZGVyIG9uIGJvdGggb2YKPiB0aGVtLiBTZWU6Cj4KPiBodHRwOi8vbHVjZW5lLmFwYWNoZS5v
cmcvamF2YS8yXzFfMC9hcGkvb3JnL2FwYWNoZS9sdWNlbmUvaW5kZXgvUGFyYWxsZWxSZWFkZXIu
aHRtbAo+Cj4gLUdsZW4KPgo+IDIwMDgvNS8yOCC5/bzRIDxudHRzdGFyQGdtYWlsLmNvbT46Cj4g
PiBJIHRoaW5rIHRoaXMgaXMgbm90IHN1aXRhYmxlIGZvciBteSBzeXN0ZW0gc2luY2UgdGhlIG51
bSBvZiBwYWdlcyBpcyB2ZXJ5Cj4gPiBsYXJnZSB0aGF0IHdpbGwgY29zdCBtdWNoIHRpbWUgZm9y
IHJlaW5kZXgKPiA+Cj4gPiAyMDA4LzUvMjgsIElhbiBMZWEgPGlhbi5sZWFAZ21haWwuY29tPjoK
PiA+Pgo+ID4+IFllcy4gIEJ1dCB5b3UnZCBoYXZlIHRvIGRvIHRoYXQgYW55d2F5IGlmIHlvdSBh
cmUgc3RvcmluZyBwYWdlcmFuayBpbgo+IHRoZQo+ID4+IGluZGV4Lgo+ID4+Cj4gPj4gT25lIHBv
aW50IG9uIHlvdXIgMjBzIHJlc3BvbnNlIHRpbWUgZm9yIHNvcnRpbmcgLSBpcyB0aGF0IGZvciB0
aGUKPiA+PiBmaXJzdCBzb3J0IG9yIHN1YnNlcXVlbnQgb25lcz8KPiA+PiBJIGJlbGlldmUgdGhh
dCB0aGUgZmlyc3Qgb25lIHdpbGwgdXN1YWxseSBiZSBzdWJzdGFudGlhbGx5IHNsb3dlci4KPiA+
PiBCdXQgc29ydGluZyBpcyBhbHdheXMgbGlrZWx5IHRvIGJlIHNsb3dlciB0aGFuIG5vdCBzb3J0
aW5nLgo+ID4+Cj4gPj4KPiA+PiAtLQo+ID4+IElhbi4KPiA+Pgo+ID4+Cj4gPj4gT24gV2VkLCBN
YXkgMjgsIDIwMDggYXQgMTI6NDcgUE0sILn9vNEgPG50dHN0YXJAZ21haWwuY29tPiB3cm90ZToK
PiA+PiA+IHRoYW5rcyBsYW4sIGJ1dCB0aGlzIG1lYW5zIHRoYXQgaSBtdXN0IHJlaW5kZXggdGhl
c2UgcGFnZXMgd2hpbGUgdGhlCj4gPj4gPiBwYWdlcmFuayBzY29yZSBjaGFuZ2VkPwo+ID4+ID4K
PiA+PiA+INTaMDgtNS0yOKOsSWFuIExlYSA8aWFuLmxlYUBnbWFpbC5jb20+INC0tcCjugo+ID4+
ID4+Cj4gPj4gPj4gSGkKPiA+PiA+Pgo+ID4+ID4+Cj4gPj4gPj4gTWF5YmUgeW91IGNvdWxkIHVz
ZSB0aGUgcGFnZXJhbmsgc2NvcmUsIHBvc3NpYmx5IG1vZGlmaWVkLCBhcwo+IGRvY3VtZW50Cj4g
Pj4gPj4gYm9vc3QgYXQgaW5kZXhpbmcgdGltZS4gIEZyb20gdGhlIGphdmFkb2NzIGZvcgo+ID4+
ID4+IERvY3VtZW50LnNldEJvb3N0KGJvb3N0KQo+ID4+ID4+Cj4gPj4gPj4gIlNldHMgYSBib29z
dCBmYWN0b3IgZm9yIGhpdHMgb24gYW55IGZpZWxkIG9mIHRoaXMgZG9jdW1lbnQuIFRoaXMKPiA+
PiA+PiB2YWx1ZSB3aWxsIGJlIG11bHRpcGxpZWQgaW50byB0aGUgc2NvcmUgb2YgYWxsIGhpdHMg
b24gdGhpcyBkb2N1bWVudCIKPiA+PiA+Pgo+ID4+ID4+IHNvIHdpbGwgZ2l2ZSB5b3UgUCAqIFIg
cmF0aGVyIHRoYW4gUCArIFIuICBTaG91bGQgYmUgcXVpY2ssIHRob3VnaC4KPiA+PiA+Pgo+ID4+
ID4+Cj4gPj4gPj4gLS0KPiA+PiA+PiBJYW4uCj4gPj4gPj4KPiA+PiA+Pgo+ID4+ID4+IE9uIFdl
ZCwgTWF5IDI4LCAyMDA4IGF0IDExOjAyIEFNLCC5/bzRIDxudHRzdGFyQGdtYWlsLmNvbT4gd3Jv
dGU6Cj4gPj4gPj4gPiBoaSBhbGwgLAo+ID4+ID4+ID4gICAgIEkgaGF2ZSBhIHByb2JsZW0gdGhh
dCBob3cgdG8gImNvbWJpbmUiIHR3byBzY29yZSB0byBzb3J0IHRoZQo+ID4+IHNlYXJjaAo+ID4+
ID4+ID4gcmVzdWx0IGRvY3VtZW50cy4KPiA+PiA+PiA+ICAgICBmb3IgZXhhbXBsZSBJICBoYXZl
IDEwIG1pbGxpb24gcGFnZXMgaW4gbHVjZW5lIGluZGV4ICwgYW5kIGkKPiBrbm93Cj4gPj4gPj4g
dGhlaXIKPiA+PiA+PiA+IHBhZ2VyYW5rIHNjb3Jlcy4gaSBnaXZlIGEgcXVlcnkgdG8gaXQgLCBl
dmVyeSBkb2NzIHJldHVybmVkIGhhdmUgYQo+ID4+ID4+ID4gbHVjZW5lLXNjb3JlLCBtYXJrIGl0
IGFzIFIgKHJlbGV2YW50IHNjb3JlKSwgYW5kICBpICBhbHNvICBoYXZlIGl0cwo+ID4+ID4+ID4g
cGFnZXJhbmsgc2NvcmUsIG1hcmsgaXQgYXMgUCwgIHdoYXQgaSBuZWVkIGlzIGkgd2FudCB0byBz
b3J0IHRoZQo+ID4+IHNlYXJjaAo+ID4+ID4+ID4gcmVzdWx0IGJhc2Ugb24gdGhlIHZhbHVlICJQ
K1IiLiAgWW91IGtub3cgaWYgaSBzdG9yZSB0aGUgcGFnZXJhbmsKPiA+PiBzY29yZQo+ID4+ID4+
IGluCj4gPj4gPj4gPiBpbmRleCBhbmQgZ2V0IGl0IGV2ZXJ5IHNlYXJjaCB0aW1lICwgdGhlbiBj
b21wdXRlIFArUiAsIHRoZW4gc29ydAo+IGl0ICwKPiA+PiA+PiB0aGlzCj4gPj4gPj4gPiB3YXkg
aXMgdG9vIHNsb3cuIGluIG15IHN5c3RlbSAsIHdoZW4gdGhlIHNlYXJjaCBoaXRzIDUwMDAwMCBy
ZXN1bHQKPiAsCj4gPj4gdGhlCj4gPj4gPj4gPiBzb3J0IG1heSBjb3N0IGFib3V0IDIwcy4KPiA+
PiA+PiA+ICAgU29ycnkgZm9yIG15IHBvb3IgZW5nbGlzaC4gIEFueW9uZSBoYXMgYSBnb29kIGlk
ZWE/Cj4gPj4gPj4gPgo+ID4+ID4+ID4gQmVzdAo+ID4+ID4+ID4gSmFydmlzCj4gPj4gPj4gPgo+
ID4+ID4+Cj4gPj4gPgo+ID4+Cj4gPgo+Cj4KPgo+IC0tCj4KPiAtCj4KCgoKLS0gCkNocmlzIExp
bgpjaHJpc2xpbjA0MjZAZ21haWwuY29tClRhaXBlaSAsIFRhaXdhbi4KLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0K
------=_Part_20042_12473784.1212066189237--

From java-user-return-34216-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 13:21:30 2008
Return-Path: <java-user-return-34216-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91957 invoked from network); 29 May 2008 13:21:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 13:21:29 -0000
Received: (qmail 63776 invoked by uid 500); 29 May 2008 13:21:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63750 invoked by uid 500); 29 May 2008 13:21:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63736 invoked by uid 99); 29 May 2008 13:21:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 06:21:17 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of sandy.hider@jhuapl.edu designates 128.244.198.200 as permitted sender)
Received: from [128.244.198.200] (HELO jhuapl.edu) (128.244.198.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 13:20:21 +0000
Received: from ([128.244.198.195])
	by pilot.jhuapl.edu with ESMTP  id 5502123.95013745;
	Thu, 29 May 2008 09:20:27 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Frequencies sorted by frequencies
Date: Thu, 29 May 2008 09:20:27 -0400
Message-ID: <4FA0A45B21AD65488AFF8D679CF0E09A02FFC244@aplesnation.dom1.jhuapl.edu>
In-Reply-To: <3974D529-828C-45A4-88E9-A23D0F048915@apache.org>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Frequencies sorted by frequencies
Thread-Index: AcjA8YtJOSSQHOyDS0u8G3k+fAbwIAAnL/mg
References: <4FA0A45B21AD65488AFF8D679CF0E09A014FE6BD@aplesnation.dom1.jhuapl.edu> <3974D529-828C-45A4-88E9-A23D0F048915@apache.org>
From: "Hider, Sandy" <Sandy.Hider@jhuapl.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks for taking the time to answer.  I see what you mean.  The thing
is I also plan on using the standard score.  Would there be a way to use
the both the standard score and the TF-only Score in a single index?

Sandy


-----Original Message-----
From: Grant Ingersoll [mailto:gsingers@apache.org]=20
Sent: Wednesday, May 28, 2008 2:34 PM
To: java-user@lucene.apache.org
Subject: Re: Frequencies sorted by frequencies

I think you could override all the Similarity factors except tf() with =20
1, such that the term frequency is the only factor in the scoring.  =20
Then you just submit the term as a query.  Note, I think you will need
to override the similarity during indexing, too, so that norm length is
turned off, too.  Note, I haven't tried it :-).  Use the explain()
functionality to double check.  At any rate, it should be quick to test.

See
http://lucene.apache.org/java/2_3_2/api/org/apache/lucene/search/Similar
ity.html

-Grant


On May 28, 2008, at 10:48 AM, Hider, Sandy wrote:

> Hi All,
> I am trying to figure out a quick way to find the top N documents=20
> sorted by frequency of a term.
>
> I found:
>
> IndexRead.termDocs()
>
> which provides an enumeration of doc() and freq() but it returns an
> enumeration sorted by doc number.   Is there a way to get the results
> sorted by freq?  Or is there another query I can run the find these=20
> results?
>
> Thanks in advance,
>
> Sandy
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ








---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34217-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 14:44:08 2008
Return-Path: <java-user-return-34217-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23536 invoked from network); 29 May 2008 14:44:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 14:44:08 -0000
Received: (qmail 34756 invoked by uid 500); 29 May 2008 14:44:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34721 invoked by uid 500); 29 May 2008 14:44:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34710 invoked by uid 99); 29 May 2008 14:44:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 07:44:02 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of viniciusccarvalho@gmail.com designates 64.233.170.189 as permitted sender)
Received: from [64.233.170.189] (HELO rn-out-0910.google.com) (64.233.170.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 14:43:15 +0000
Received: by rn-out-0910.google.com with SMTP id j40so1961566rnf.4
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 07:43:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=sjeQt9qmFTY6E1+bgGpBcPL4HTjqQLRjZWO/Ey0vI0c=;
        b=Ld+g8jL/1EaQ8xVdCm4uwb1eRxwXlJxJZ9naGSEwYesJoE+0pNxcGYVjI55zI1uzEFRyqef4v6j+zYAXjmzuPhs4XQGePXfmOHQQ/FaFglNJI/iMi4sEFmSFAbt8+H1AnL0wZ58eA5kK/hxaXsnCLbVDCbPY1te/YCczdUiN1e0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=gAKpinOKSCyFrMG1vs/OXvh1Zn7HMdFTPsIZ9jGORpDiNUQf+TgxBSjivbx7vHNS5O2RoUF+jbRYBWrY/15mOefE/RYqm6IVkofSMdK0WPU1ykLxXnDDchLejfYr1y9GJzqATY+ypE0izvP0mNsypWokEQw4wppFeCCCkRKFtxk=
Received: by 10.115.111.1 with SMTP id o1mr3895911wam.87.1212072210500;
        Thu, 29 May 2008 07:43:30 -0700 (PDT)
Received: by 10.115.95.8 with HTTP; Thu, 29 May 2008 07:43:30 -0700 (PDT)
Message-ID: <9d2777b60805290743l2ad05d60pf0ba82e628000ac@mail.gmail.com>
Date: Thu, 29 May 2008 11:43:30 -0300
From: "Vinicius Carvalho" <viniciusccarvalho@gmail.com>
To: java-user@lucene.apache.org
Subject: Using highlighter
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_19912_30428099.1212072210478"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_19912_30428099.1212072210478
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hello there! When I use an wildcard with my query, for instance: java*.
Lucene finds the document, but when using the highlighter, the
getBestFragment() is returning null for a fragment that contains the word
javadoc for instance. Is it possible to use the hightlighter with wildcards?
One option I found is to display the original contents instead, but, the
nice thing about the highlighter is that it allows me to define a fragment
size, so I don't need to display an entire string, just a part of it. If I
skip the highlighter for the null fragments, is it possible to display only
a fragment of the indexed field?

Regards

-- 
"In a world without fences and walls, who needs Gates and Windows?"

------=_Part_19912_30428099.1212072210478--

From java-user-return-34218-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 14:44:53 2008
Return-Path: <java-user-return-34218-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23969 invoked from network); 29 May 2008 14:44:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 14:44:53 -0000
Received: (qmail 37493 invoked by uid 500); 29 May 2008 14:44:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37456 invoked by uid 500); 29 May 2008 14:44:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37445 invoked by uid 99); 29 May 2008 14:44:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 07:44:47 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cambazz@gmail.com designates 209.85.198.236 as permitted sender)
Received: from [209.85.198.236] (HELO rv-out-0506.google.com) (209.85.198.236)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 14:43:59 +0000
Received: by rv-out-0506.google.com with SMTP id f6so3493497rvb.5
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 07:44:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=ABJIGZqdHJyTD3CI6M/pUB3tmN9Tv/csnFkh4zMROl4=;
        b=giWzmX2J+SXMgVcKC2yHsw7EB9awCMGiwmOb4pNmLW50yIlRQinmi3fzrDf2A1MZn9poudiL8E5YQpdlWrP14OG+qiEOd9bsv6X/lpsolLNKfpn8pIGgXT9DnXKvzQ5HEZQTSH3jpFWrrwSdfQ4QRq8v8u01QFjNPeZk2dmNpds=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=XYWh5qIfiO03Ps8P28GhoD4/OzuZ4h6fOrLl6RzVhbxv4+QbpmuVlMIOUOM+t9gfZWtQlcCEDHHnaDI6bw2vWRD8Rs9zUS5fI98z+bvAzLKPg9a6YQEUDovQQ04NjqdgLDTu585VpNwNGzPqYJnRZxpKtvuFciKp00EmE5tSdt4=
Received: by 10.141.18.14 with SMTP id v14mr2086679rvi.125.1212072256517;
        Thu, 29 May 2008 07:44:16 -0700 (PDT)
Received: by 10.141.164.2 with HTTP; Thu, 29 May 2008 07:44:16 -0700 (PDT)
Message-ID: <1bcb7c7f0805290744sd3f9cc2naa3b78c348fb8b9e@mail.gmail.com>
Date: Thu, 29 May 2008 17:44:16 +0300
From: "Cam Bazz" <cambazz@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to add PageRank score with lucene's relevant score in sorting
In-Reply-To: <11e088b10805290528gfa20aa2rc4fc4f0622038644@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_3103_15742412.1212072256502"
References: <11e088b10805280302q933d019k2a7baad10d43e04f@mail.gmail.com>
	 <8c4e68610805280312wc7e7d9at399a323d9f248832@mail.gmail.com>
	 <11e088b10805280447w35d83c4ewc076a6ce2778f25@mail.gmail.com>
	 <8c4e68610805280603l51631a89t87de0764f7965439@mail.gmail.com>
	 <11e088b10805280645j45427491s4764238051e94432@mail.gmail.com>
	 <5e76f3840805280751s11443ed1i3653edd5e764b09e@mail.gmail.com>
	 <11e088b10805290528gfa20aa2rc4fc4f0622038644@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_3103_15742412.1212072256502
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: base64
Content-Disposition: inline

SGVsbG8sCgpsaXR0bGUgb2ZmIHRvcGljLCBidXQgaG93IGRpZCB5b3Ugb2J0YWluIHRoZSBwYWdl
cmFuayBmb3IgZWFjaCBwYWdlLiBkaWQgeW91CmNhbGN1bGF0ZSBpdCwgb3IgaGF2ZSB5b3Ugb2J0
YWluZWQgaXQgd2l0aCBzb21lIG90aGVyIHdheSB3aGlsZSBnZXR0aW5nIGEKc3BlY2lmaWMgc2l0
ZS4KCkJlc3QuCgpPbiBUaHUsIE1heSAyOSwgMjAwOCBhdCAzOjI4IFBNLCC5/bzRIDxudHRzdGFy
QGdtYWlsLmNvbT4gd3JvdGU6Cgo+IHRoYW5rcyBHbGVuICwgd2UgaGF2ZSB0cmllZCBpdCAsIGJ1
dCB0aGUgYm90dGxlbmVjayBpcyB0byBnZXQgdGhlIGRvY3VtZW50Cj4gKGluZGV4UmVhZGVyLmRv
Y3VtZW50KG51bSkpLCBzbyBpdCBpcyBub3QgZWZmaWNpZW50IGVub3VnaCAuCj4KPiAyMDA4LzUv
MjgsIEdsZW4gTmV3dG9uIDxnbGVuLm5ld3RvbkBnbWFpbC5jb20+Ogo+ID4KPiA+IFlvdSBzaG91
bGQgY29uc2lkZXIga2VlcGluZyB0aGUgUGFnZVJhbmsgKGFuZCBhbnkgb3RoZXIgbW9yZSBkeW5h
bWljCj4gPiBkYXRhKSBpbiBhIHNlcGFyYXRlIGluZGV4ICh3aXRoIHRoZSBkb2N1bWVudHMgaW4g
dGhlIHNhbWUgb2RlciBhcyB5b3VyCj4gPiBiaWdnZXIsIG1vcmUgc3RhdGljIGluZGV4KSBhbmQg
dGhlbiB1c2UgYSBQYXJhbGxlbFJlYWRlciBvbiBib3RoIG9mCj4gPiB0aGVtLiBTZWU6Cj4gPgo+
ID4KPiBodHRwOi8vbHVjZW5lLmFwYWNoZS5vcmcvamF2YS8yXzFfMC9hcGkvb3JnL2FwYWNoZS9s
dWNlbmUvaW5kZXgvUGFyYWxsZWxSZWFkZXIuaHRtbAo+ID4KPiA+IC1HbGVuCj4gPgo+ID4gMjAw
OC81LzI4ILn9vNEgPG50dHN0YXJAZ21haWwuY29tPjoKPiA+ID4gSSB0aGluayB0aGlzIGlzIG5v
dCBzdWl0YWJsZSBmb3IgbXkgc3lzdGVtIHNpbmNlIHRoZSBudW0gb2YgcGFnZXMgaXMKPiB2ZXJ5
Cj4gPiA+IGxhcmdlIHRoYXQgd2lsbCBjb3N0IG11Y2ggdGltZSBmb3IgcmVpbmRleAo+ID4gPgo+
ID4gPiAyMDA4LzUvMjgsIElhbiBMZWEgPGlhbi5sZWFAZ21haWwuY29tPjoKPiA+ID4+Cj4gPiA+
PiBZZXMuICBCdXQgeW91J2QgaGF2ZSB0byBkbyB0aGF0IGFueXdheSBpZiB5b3UgYXJlIHN0b3Jp
bmcgcGFnZXJhbmsgaW4KPiA+IHRoZQo+ID4gPj4gaW5kZXguCj4gPiA+Pgo+ID4gPj4gT25lIHBv
aW50IG9uIHlvdXIgMjBzIHJlc3BvbnNlIHRpbWUgZm9yIHNvcnRpbmcgLSBpcyB0aGF0IGZvciB0
aGUKPiA+ID4+IGZpcnN0IHNvcnQgb3Igc3Vic2VxdWVudCBvbmVzPwo+ID4gPj4gSSBiZWxpZXZl
IHRoYXQgdGhlIGZpcnN0IG9uZSB3aWxsIHVzdWFsbHkgYmUgc3Vic3RhbnRpYWxseSBzbG93ZXIu
Cj4gPiA+PiBCdXQgc29ydGluZyBpcyBhbHdheXMgbGlrZWx5IHRvIGJlIHNsb3dlciB0aGFuIG5v
dCBzb3J0aW5nLgo+ID4gPj4KPiA+ID4+Cj4gPiA+PiAtLQo+ID4gPj4gSWFuLgo+ID4gPj4KPiA+
ID4+Cj4gPiA+PiBPbiBXZWQsIE1heSAyOCwgMjAwOCBhdCAxMjo0NyBQTSwguf280SA8bnR0c3Rh
ckBnbWFpbC5jb20+IHdyb3RlOgo+ID4gPj4gPiB0aGFua3MgbGFuLCBidXQgdGhpcyBtZWFucyB0
aGF0IGkgbXVzdCByZWluZGV4IHRoZXNlIHBhZ2VzIHdoaWxlIHRoZQo+ID4gPj4gPiBwYWdlcmFu
ayBzY29yZSBjaGFuZ2VkPwo+ID4gPj4gPgo+ID4gPj4gPiDU2jA4LTUtMjijrElhbiBMZWEgPGlh
bi5sZWFAZ21haWwuY29tPiDQtLXAo7oKPiA+ID4+ID4+Cj4gPiA+PiA+PiBIaQo+ID4gPj4gPj4K
PiA+ID4+ID4+Cj4gPiA+PiA+PiBNYXliZSB5b3UgY291bGQgdXNlIHRoZSBwYWdlcmFuayBzY29y
ZSwgcG9zc2libHkgbW9kaWZpZWQsIGFzCj4gPiBkb2N1bWVudAo+ID4gPj4gPj4gYm9vc3QgYXQg
aW5kZXhpbmcgdGltZS4gIEZyb20gdGhlIGphdmFkb2NzIGZvcgo+ID4gPj4gPj4gRG9jdW1lbnQu
c2V0Qm9vc3QoYm9vc3QpCj4gPiA+PiA+Pgo+ID4gPj4gPj4gIlNldHMgYSBib29zdCBmYWN0b3Ig
Zm9yIGhpdHMgb24gYW55IGZpZWxkIG9mIHRoaXMgZG9jdW1lbnQuIFRoaXMKPiA+ID4+ID4+IHZh
bHVlIHdpbGwgYmUgbXVsdGlwbGllZCBpbnRvIHRoZSBzY29yZSBvZiBhbGwgaGl0cyBvbiB0aGlz
Cj4gZG9jdW1lbnQiCj4gPiA+PiA+Pgo+ID4gPj4gPj4gc28gd2lsbCBnaXZlIHlvdSBQICogUiBy
YXRoZXIgdGhhbiBQICsgUi4gIFNob3VsZCBiZSBxdWljaywgdGhvdWdoLgo+ID4gPj4gPj4KPiA+
ID4+ID4+Cj4gPiA+PiA+PiAtLQo+ID4gPj4gPj4gSWFuLgo+ID4gPj4gPj4KPiA+ID4+ID4+Cj4g
PiA+PiA+PiBPbiBXZWQsIE1heSAyOCwgMjAwOCBhdCAxMTowMiBBTSwguf280SA8bnR0c3RhckBn
bWFpbC5jb20+IHdyb3RlOgo+ID4gPj4gPj4gPiBoaSBhbGwgLAo+ID4gPj4gPj4gPiAgICAgSSBo
YXZlIGEgcHJvYmxlbSB0aGF0IGhvdyB0byAiY29tYmluZSIgdHdvIHNjb3JlIHRvIHNvcnQgdGhl
Cj4gPiA+PiBzZWFyY2gKPiA+ID4+ID4+ID4gcmVzdWx0IGRvY3VtZW50cy4KPiA+ID4+ID4+ID4g
ICAgIGZvciBleGFtcGxlIEkgIGhhdmUgMTAgbWlsbGlvbiBwYWdlcyBpbiBsdWNlbmUgaW5kZXgg
LCBhbmQgaQo+ID4ga25vdwo+ID4gPj4gPj4gdGhlaXIKPiA+ID4+ID4+ID4gcGFnZXJhbmsgc2Nv
cmVzLiBpIGdpdmUgYSBxdWVyeSB0byBpdCAsIGV2ZXJ5IGRvY3MgcmV0dXJuZWQgaGF2ZQo+IGEK
PiA+ID4+ID4+ID4gbHVjZW5lLXNjb3JlLCBtYXJrIGl0IGFzIFIgKHJlbGV2YW50IHNjb3JlKSwg
YW5kICBpICBhbHNvICBoYXZlCj4gaXRzCj4gPiA+PiA+PiA+IHBhZ2VyYW5rIHNjb3JlLCBtYXJr
IGl0IGFzIFAsICB3aGF0IGkgbmVlZCBpcyBpIHdhbnQgdG8gc29ydCB0aGUKPiA+ID4+IHNlYXJj
aAo+ID4gPj4gPj4gPiByZXN1bHQgYmFzZSBvbiB0aGUgdmFsdWUgIlArUiIuICBZb3Uga25vdyBp
ZiBpIHN0b3JlIHRoZSBwYWdlcmFuawo+ID4gPj4gc2NvcmUKPiA+ID4+ID4+IGluCj4gPiA+PiA+
PiA+IGluZGV4IGFuZCBnZXQgaXQgZXZlcnkgc2VhcmNoIHRpbWUgLCB0aGVuIGNvbXB1dGUgUCtS
ICwgdGhlbiBzb3J0Cj4gPiBpdCAsCj4gPiA+PiA+PiB0aGlzCj4gPiA+PiA+PiA+IHdheSBpcyB0
b28gc2xvdy4gaW4gbXkgc3lzdGVtICwgd2hlbiB0aGUgc2VhcmNoIGhpdHMgNTAwMDAwCj4gcmVz
dWx0Cj4gPiAsCj4gPiA+PiB0aGUKPiA+ID4+ID4+ID4gc29ydCBtYXkgY29zdCBhYm91dCAyMHMu
Cj4gPiA+PiA+PiA+ICAgU29ycnkgZm9yIG15IHBvb3IgZW5nbGlzaC4gIEFueW9uZSBoYXMgYSBn
b29kIGlkZWE/Cj4gPiA+PiA+PiA+Cj4gPiA+PiA+PiA+IEJlc3QKPiA+ID4+ID4+ID4gSmFydmlz
Cj4gPiA+PiA+PiA+Cj4gPiA+PiA+Pgo+ID4gPj4gPgo+ID4gPj4KPiA+ID4KPiA+Cj4gPgo+ID4K
PiA+IC0tCj4gPgo+ID4gLQo+ID4KPgo=
------=_Part_3103_15742412.1212072256502--

From java-user-return-34219-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 14:50:38 2008
Return-Path: <java-user-return-34219-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25833 invoked from network); 29 May 2008 14:50:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 14:50:38 -0000
Received: (qmail 50959 invoked by uid 500); 29 May 2008 14:50:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50214 invoked by uid 500); 29 May 2008 14:50:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50203 invoked by uid 99); 29 May 2008 14:50:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 07:50:32 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rakesh_shete@hotmail.com designates 65.54.246.233 as permitted sender)
Received: from [65.54.246.233] (HELO bay0-omc3-s33.bay0.hotmail.com) (65.54.246.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 14:49:42 +0000
Received: from BAY112-W3 ([64.4.26.103]) by bay0-omc3-s33.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 29 May 2008 07:49:58 -0700
Message-ID: <BAY112-W3A5649B0A37EEE9E2F9B5F9BF0@phx.gbl>
Content-Type: multipart/alternative;
	boundary="_ac46f5cf-d145-409f-9404-b59c0c73013c_"
X-Originating-IP: [125.99.82.185]
From: Rakesh Shete <rakesh_shete@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: RE: Improving search performance
Date: Thu, 29 May 2008 20:19:58 +0530
Importance: Normal
In-Reply-To: <57D07470-589F-4965-95A3-50157474E222@hibernate.org>
References: <BAY112-W4466FFA10841E02A9ACE2AF9C30@phx.gbl>
 <57D07470-589F-4965-95A3-50157474E222@hibernate.org>
MIME-Version: 1.0
X-OriginalArrivalTime: 29 May 2008 14:49:58.0067 (UTC) FILETIME=[43BDE830:01C8C19B]
X-Virus-Checked: Checked by ClamAV on apache.org

--_ac46f5cf-d145-409f-9404-b59c0c73013c_
Content-Type: text/plain; charset="Windows-1252"
Content-Transfer-Encoding: quoted-printable


Hi Emmanuel,

Thanks for sparing time for this. Atleast now it looks like the problem is =
clear. I will definitley try the pooled IndexSearch approach.=20

Could you let me know if there is a way of providing the indexsearcher inst=
ance to the Hibernate Search FullTextQuery API?

If that's not possible then probably I will have to use Lucene APIs directl=
y. Atleast from this thread it seems to be so:=20
http://forum.hibernate.org/viewtopic.php?t=3D987104

--Rakesh S


> From: emmanuel@hibernate.org
> To: java-user@lucene.apache.org
> Subject: Re: Improving search performance
> Date: Thu, 29 May 2008 02:22:19 -0400
>=20
> Hi Rakesh,
> I've spend the afternoon and the evening playing around your test =20
> because I could not stand Hibernate Search to be significantly slower =20
> than native Lucene ;)
> I found several causes but as far as your test case is concerned, it =20
> turns out you are reaching the scalability limit of a single =20
> IndexSearcher as Otis mentioned a couple of emails ago. 100 threads in =20
> parallel are too much. You are better off using a pool of IndexSearcher.
>=20
> How much? It's hard to say, because the less  IndexSearchers, the =20
> better you benefit from the warm up effect. I guess the optimal value =20
> depends on your index size and the number of expected concurrent =20
> threads. Give it a try with different values.
>=20
> Not related to this thread specifically but I have kept notes of some =20
> ideas to bring back HSearch and Lucene neck to neck performance wise. =20
> I've also explained there why your HSearch vs Lucene perf test was not =20
> fair.
> http://opensource.atlassian.com/projects/hibernate/browse/HSEARCH-194
>=20
> HTH
>=20
> Emmanuel
>=20
> On  May 25, 2008, at 04:53, Rakesh Shete wrote:
>=20
> >
> > Hi ,
> >
> > I have written a program to simulate the multi-thread behavior and =20
> > check the performance.
> > I have attached the program and results.
> >
> > The JVM parameters when running the program: -Xms128m -Xmx1028m on a =20
> > P4 2.66 Ghz, 1.99GB RAM machine.
> >
> > Here are the observations:
> > 1. The response time to fire a query and return back increases as =20
> > the number of threads increases: from 10-100 (I haven=92t used any =20
> > threadpool. JVM default behavior is used)
> > 2. After optimizing the index, the response time improved =20
> > significantly. Like in case of 100 threads, the average response =20
> > time, using optimized index, is between 1-1.3 seconds as compared to =20
> > 4-5.5 seconds using the non-optimized index
> >
> > Is there anything else that I should be looking into to further =20
> > improve the performance?
> >
> > --Rakesh S
> >
> >> Date: Fri, 23 May 2008 20:24:03 -0700
> >> From: otis_gospodnetic@yahoo.com
> >> Subject: Re: Improving search performance
> >> To: java-user@lucene.apache.org
> >>
> >> Hi Emmanuel,
> >>
> >> Because there are some synchronized methods, like the one that =20
> >> checks whether a doc is deleted, that get called during search. If =20
> >> you have a pile of threads (op. p. mentioned 100 threads) there =20
> >> could be contention around those methods.
> >>
> >> Otis
> >> --
> >> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
> >>
> >>
> >> ----- Original Message ----
> >>> From: Emmanuel Bernard
> >>> To: java-user@lucene.apache.org
> >>> Sent: Friday, May 23, 2008 6:41:36 PM
> >>> Subject: Re: Improving search performance
> >>>
> >>> Hi
> >>> Hibernate Search does not pool the Searcher but pools the underlying
> >>> IndexReader(s). From what i've seen, a Searcher is stateless and all
> >>> the state is kept in the Readers. so this essentially is =20
> >>> equivalent to
> >>> reusing the searcher.
> >>>
> >>> Out of curiosity why is a pool of Searcher more efficient?
> >>>
> >>> Emmanuel
> >>>
> >>> On May 22, 2008, at 13:22, Otis Gospodnetic wrote:
> >>>
> >>>> Some quick feedback. Those are all very expensive queries
> >>>> (wildcards and ranges). The first thing I'd do is try without
> >>>> Hibernate Search (to make sure HS is not the bottleneck). 100
> >>>> threads is a lot, I'm guessing you are reusing your searcher, which
> >>>> is good, but you will actually improve performance a bit if you =20
> >>>> work
> >>>> with a small pool of searchers instead of a single searcher.
> >>>>
> >>>> Otis
> >>>> --
> >>>> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
> >>>>
> >>>>
> >>>> ----- Original Message ----
> >>>>> From: Rakesh Shete
> >>>>> To: java-user-info@lucene.apache.org; java-user@lucene.apache.org
> >>>>> Sent: Thursday, May 22, 2008 1:16:13 PM
> >>>>> Subject: Improving search performance
> >>>>>
> >>>>>
> >>>>> Hi all,
> >>>>>
> >>>>> I have index of size 85MB. My query looks as follows:
> >>>>>
> >>>>> +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:
> >>>>> [20080410 TO
> >>>>> 20081010] +rT:[002 TO 005]
> >>>>>
> >>>>> All the fields used in the query are stored in the indexes =20
> >>>>> (Indexed
> >>>>> & Stored)
> >>>>>
> >>>>> The query response time for me is around 30 seconds when running
> >>>>> mutliple
> >>>>> simultanoeous threads (~100). The no. of matches is ~30k but I
> >>>>> retrieve only the
> >>>>> top 100 results. I am using Hibernate Search which is a wrapper
> >>>>> around Lucene. I
> >>>>> retrieve the "id" filed from the index which is also indexex and
> >>>>> stored.
> >>>>>
> >>>>> What is the approach that I should take for improving the
> >>>>> performance?
> >>>>>
> >>>>> Will just indexing the values without storing them work (Index &
> >>>>> UnStored)?
> >>>>>
> >>>>> My machine configuration is:
> >>>>> P4 2.66GHz 1.99 GB RAM
> >>>>>
> >>>>> The code for searching runs in JBoss application server which =20
> >>>>> has a
> >>>>> maximum heap
> >>>>> size of 1024MB. When these 100 threads are running in the
> >>>>> application server the
> >>>>> CPU utilization is 100% and JBoss consumes all of the heap size.
> >>>>>
> >>>>> Any pointers on index optimization would be really appreciated.
> >>>>>
> >>>>> --Regards,
> >>>>> Rakesh Shete
> >>>>>
> >>>>> _________________________________________________________________
> >>>>> No Harvard, No Oxford. We are here. Find out !!
> >>>>> http://ss1.richmedia.in/recurl.asp?pid=3D500
> >>>>
> >>>>
> >>>> --------------------------------------------------------------------=
-
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>
> >>>
> >>> ---------------------------------------------------------------------
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> > _________________________________________________________________
> > Catch the latest fashion shows, get beauty tips and learn more on =20
> > fashion and lifestyle.
> > http://video.msn.com/?mkt=3Den-in<Performance =20
> > logs=20
> > .zip=20
> > >---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20

_________________________________________________________________
2000 Placements last year. Are You next ? Find out
http://ss1.richmedia.in/recurl.asp?pid=3D499=

--_ac46f5cf-d145-409f-9404-b59c0c73013c_--

From java-user-return-34220-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 15:56:13 2008
Return-Path: <java-user-return-34220-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81344 invoked from network); 29 May 2008 15:56:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 15:56:13 -0000
Received: (qmail 25622 invoked by uid 500); 29 May 2008 15:56:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25591 invoked by uid 500); 29 May 2008 15:56:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25580 invoked by uid 99); 29 May 2008 15:56:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 08:56:06 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.146.180 as permitted sender)
Received: from [209.85.146.180] (HELO wa-out-1112.google.com) (209.85.146.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 15:55:18 +0000
Received: by wa-out-1112.google.com with SMTP id l24so3878830waf.11
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 08:55:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=NJ5VOtAm0gUR28bjge/zQHL8aLeUIQmuJBKuvOqZguo=;
        b=Z9mGHrOcRNTGe0fl20f29/tGP9INCjsbVUanD83aRwOyqYa9VJExGoeGSx1/0me2DzclDWs0hh9DZP+AAAqypeau6dgaMzjXacqvhQeop97TXStI8ruG7tIDtqKSCQryk+ztk87HZ/9ns2eOnNIfRcTot5pTVjT6ZLBXaVOppbw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=WMnLRVBxzEJuLksYs93Uun/Tv1OhteYqevEF/zyi5o4j6kX4wxskGFYLPrxDwIL/KNdyhRo/7iyvB+SMzoHfJNjA9nOecgNy/QI0P92uvzaLxCw0oCMvn64VXP9M4WHmLFZvGkak9ZrZYJsdf6m0kv3NdHTPzTwRCNt2Lm+SFUs=
Received: by 10.114.66.2 with SMTP id o2mr4540039waa.102.1212076534560;
        Thu, 29 May 2008 08:55:34 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id q18sm1077320qbq.23.2008.05.29.08.55.33
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 08:55:34 -0700 (PDT)
Message-ID: <483ED1F6.5000603@gmail.com>
Date: Thu, 29 May 2008 11:55:34 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Using highlighter
References: <9d2777b60805290743l2ad05d60pf0ba82e628000ac@mail.gmail.com>
In-Reply-To: <9d2777b60805290743l2ad05d60pf0ba82e628000ac@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Vinicius Carvalho wrote:
> Hello there! When I use an wildcard with my query, for instance: java*.
> Lucene finds the document, but when using the highlighter, the
> getBestFragment() is returning null for a fragment that contains the word
> javadoc for instance. Is it possible to use the hightlighter with wildcards?
> One option I found is to display the original contents instead, but, the
> nice thing about the highlighter is that it allows me to define a fragment
> size, so I don't need to display an entire string, just a part of it. If I
> skip the highlighter for the null fragments, is it possible to display only
> a fragment of the indexed field?
>
> Regards
>
>   
Try calling query.rewrite before passing it to the Highlighter. You have 
to do this to cover all of the truncation queries.

- Mark

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34221-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 16:42:07 2008
Return-Path: <java-user-return-34221-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93903 invoked from network); 29 May 2008 16:42:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 16:42:07 -0000
Received: (qmail 9481 invoked by uid 500); 29 May 2008 16:42:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9443 invoked by uid 500); 29 May 2008 16:42:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9432 invoked by uid 99); 29 May 2008 16:42:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 09:42:00 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 72.14.220.155 as permitted sender)
Received: from [72.14.220.155] (HELO fg-out-1718.google.com) (72.14.220.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 16:41:09 +0000
Received: by fg-out-1718.google.com with SMTP id l27so2344383fgb.27
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 09:41:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=WkvrzOkBYahlYM9T/RUBgbzjDErjQBSS402qesffDw8=;
        b=R8ptYH1di4mCDkc7UQamR3JUZGMa9UaWDjKyRrc4TuYdekicVlho9fxjn4DX+hYc5SenE6kRrIxBad6gkxdoS1av7SNvUVF5Ijl7Bx8GmL7Cs1q8fv6tyeqwEq6lOFwD/5zDMnd/Xq6NmU+xPkNKuBIgZzeelGsawTY45koWt9s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=MWvVV/H75qCEnrdqXNkZUmCfe/+h3WF6z6z0R+9PMGO8AQ2JIvGZJ91d6/y2dUpjGWfdYtl671cdIwQX+fZw338VOlCgguPGXVsy0pHiBzsVs38h1uirlVl80kkVJ58fUA+q2IiXR/5HWH254YjjSAPMGgIbWzPd3FXc9weY9h8=
Received: by 10.82.118.2 with SMTP id q2mr15503buc.80.1212079284217;
        Thu, 29 May 2008 09:41:24 -0700 (PDT)
Received: by 10.82.135.16 with HTTP; Thu, 29 May 2008 09:41:24 -0700 (PDT)
Message-ID: <8837fb770805290941p3ae6dff1g1be9f2222cc49bbf@mail.gmail.com>
Date: Thu, 29 May 2008 09:41:24 -0700
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: IndexReader.reopen memory leak
In-Reply-To: <483E5CD9.8080005@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_17292_29008788.1212079284190"
References: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com>
	 <483DD50C.3080908@gmail.com> <483DE95C.9030501@gmail.com>
	 <8837fb770805282125w5f3d7101i4b42b0c55edd3a5a@mail.gmail.com>
	 <483E5CD9.8080005@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_17292_29008788.1212079284190
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Yes:

IndexReader newInner=in.reopen();
      if (in!=newInner)
      {
        in.close();
        this.in=newInner;

        // code to clean up my data
        _cache.clear();
        _indexData.load(this, true);
        init(_fieldConfig);
      }

if I change this code to:
try
      {
        this.in.close();     force close
      }
      catch(Exception e)
      {
        logger.warn(e.getMessage());
      }
      finally
      {
        this.in=newReader(); <-- new instance of IndexReader
        _cache.clear();
        _indexData.load(this, true);
        init(_fieldConfig);
      }

fixes my leak.

-John

On Thu, May 29, 2008 at 12:35 AM, Michael Busch <buschmic@gmail.com> wrote:

> Could you share some details about how you implemented reopen() in your
> reader?
>
> -Michael
>
>
> John Wang wrote:
>
>> Yes, I do close the old reader.
>> I have a large index, my system is doing real time updates: 1 thread
>> writing
>> batches of updates to the index, after each index update, it updates the
>> reader. I have two readers open always, one is serving the search
>> requests,
>> while the other updates and the two flips. Reader update implies index
>> reopen here.
>>
>> I am using my implementation of a FilteredIndexReader.
>>
>> Index leaks very slowly, but obvious.
>>
>> No, I am not able to provide heap dumps.
>>
>> -John
>>
>> On Wed, May 28, 2008 at 4:23 PM, Mark Miller <markrmiller@gmail.com>
>> wrote:
>>
>>  As someone that has done a lot of reopens, I can vouch there is no leak
>>> under simple, normal usage. Are you sure your closing the original reader
>>> after getting the reopened reference?
>>>
>>>
>>> Michael Busch wrote:
>>>
>>>  Hi John,
>>>>
>>>> hmm not good. I will take a look. It has probably to do with the
>>>> reference
>>>> counting. Are you doing anything special? E. g. do you have own reader
>>>> implementations that you call reopen() on? What kinds of readers are you
>>>> using?
>>>>
>>>> Are you maybe able to provide a heapdump?
>>>>
>>>> -Michael
>>>>
>>>> John Wang wrote:
>>>>
>>>>  Hi:
>>>>>
>>>>>  We are experiencing memory leak with calling IndexReader.reopen().
>>>>>
>>>>>  From eyeballing the lucene source code, I am seeing normCache is not
>>>>> cleared.
>>>>>
>>>>>
>>>>>  Anyone else experiencing this?
>>>>>
>>>>> Thanks
>>>>>
>>>>> -John
>>>>>
>>>>>
>>>>>  ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>  ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_17292_29008788.1212079284190--

From java-user-return-34222-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 17:19:20 2008
Return-Path: <java-user-return-34222-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9281 invoked from network); 29 May 2008 17:19:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 17:19:18 -0000
Received: (qmail 76270 invoked by uid 500); 29 May 2008 17:19:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76234 invoked by uid 500); 29 May 2008 17:19:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76223 invoked by uid 99); 29 May 2008 17:19:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 10:19:13 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.162.181 as permitted sender)
Received: from [209.85.162.181] (HELO el-out-1112.google.com) (209.85.162.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 17:18:25 +0000
Received: by el-out-1112.google.com with SMTP id v27so119788ele.14
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 10:18:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=vev5HiSOFxew4PXJ6e5t3ht3Adh7uCCbuv47Xg8uukc=;
        b=tncz6n3/RkTkgpNy2HRzun1Xu299TC4+h6e6C7cmWhGZMNtLiSQg1OrNx8oJAsQBgcTJayBaG5uz4YYEeh/c/0I0Eiq5qZgfaOqUfqkfP+cd+53suq6tmLX5x5z33iKBpz9ngSKjXtd4jAmMUwcOUBTBYvni4jqGiaR6q5r+S1s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=H7KdtorKhnwXWZot0pPsOGT5ZbJc3XXtQCSqbm0foju8YhCyX7cgkYk9x31BA7WTaQQP9IU0IcJtZxohom0SsvVxiLwbITX04u5gszA8I6onnDgqk7XshDYje2uOPoeOUlWtjohV6ulrnIn7rLIbsb1B6J+ueQdF3Iys+ax0d5U=
Received: by 10.114.135.6 with SMTP id i6mr4669125wad.216.1212081520876;
        Thu, 29 May 2008 10:18:40 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id d12sm1186231qbc.26.2008.05.29.10.18.39
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 10:18:40 -0700 (PDT)
Message-ID: <483EE570.5050804@gmail.com>
Date: Thu, 29 May 2008 13:18:40 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: IndexReader.reopen memory leak
References: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com>	 <483DD50C.3080908@gmail.com> <483DE95C.9030501@gmail.com>	 <8837fb770805282125w5f3d7101i4b42b0c55edd3a5a@mail.gmail.com>	 <483E5CD9.8080005@gmail.com> <8837fb770805290941p3ae6dff1g1be9f2222cc49bbf@mail.gmail.com>
In-Reply-To: <8837fb770805290941p3ae6dff1g1be9f2222cc49bbf@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

You are sure you don't have a reference to that old Reader somewhere, 
hanging around? Maybe this is fixed since I grabbed my copy of Lucene , 
but I can loop a reopen pretty much forever, and monitoring the memory I 
see not even the tiniest leak over many many many reopens. Ive been 
using visualgc, jconsole, and netbeans profiler. I am reopening pretty 
much exactly as your code shows.


John Wang wrote:
> Yes:
>
> IndexReader newInner=in.reopen();
>       if (in!=newInner)
>       {
>         in.close();
>         this.in=newInner;
>
>         // code to clean up my data
>         _cache.clear();
>         _indexData.load(this, true);
>         init(_fieldConfig);
>       }
>
> if I change this code to:
> try
>       {
>         this.in.close();     force close
>       }
>       catch(Exception e)
>       {
>         logger.warn(e.getMessage());
>       }
>       finally
>       {
>         this.in=newReader(); <-- new instance of IndexReader
>         _cache.clear();
>         _indexData.load(this, true);
>         init(_fieldConfig);
>       }
>
> fixes my leak.
>
> -John
>
> On Thu, May 29, 2008 at 12:35 AM, Michael Busch <buschmic@gmail.com> wrote:
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34223-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 17:22:44 2008
Return-Path: <java-user-return-34223-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10414 invoked from network); 29 May 2008 17:22:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 17:22:44 -0000
Received: (qmail 84580 invoked by uid 500); 29 May 2008 17:22:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84548 invoked by uid 500); 29 May 2008 17:22:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84537 invoked by uid 99); 29 May 2008 17:22:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 10:22:39 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.162.177 as permitted sender)
Received: from [209.85.162.177] (HELO el-out-1112.google.com) (209.85.162.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 17:21:52 +0000
Received: by el-out-1112.google.com with SMTP id v27so120388ele.14
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 10:22:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=n3MzKk6QkIA+pBQLGLrdT3e+odURjuV87c7WSD4v7VA=;
        b=IyAlD5/CoRbYFglb12ij4NBVW+JgrQj7cAV0eYI+29HKtgZz4Sio3+7+UsYmH+UxW099O28ibMhg8UHNbmx0Cyhbovo/uepCGPbzPryPIhvadaW3THCzL/lvo3IPCSzmjrUhMxclWwleGK1Tth7gcqEJF11KjvtCUlKUYNnyR80=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=eqoeYW/pYfYYKcwQ50WYNAlhE+JaExf+5Cl+3xZYf+aSohcn6BS2JpdGP0kXbLmCFTRsH91h1uNCZi+zoIcNBF6xt9T7dX6oSJJjzte9JdSsOD74EeHdJEJy5Gh4Sgi0ume8W5SWM9OuGOUvP8RBXrvqUPGHIpWoD0nVQst4XJU=
Received: by 10.114.184.11 with SMTP id h11mr4692645waf.175.1212081727459;
        Thu, 29 May 2008 10:22:07 -0700 (PDT)
Received: by 10.115.17.5 with HTTP; Thu, 29 May 2008 10:22:07 -0700 (PDT)
Message-ID: <c68e39170805291022k51949c59u61d2cf19a0d6d694@mail.gmail.com>
Date: Thu, 29 May 2008 13:22:07 -0400
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: IndexReader.reopen memory leak
In-Reply-To: <8837fb770805282125w5f3d7101i4b42b0c55edd3a5a@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com>
	 <483DD50C.3080908@gmail.com> <483DE95C.9030501@gmail.com>
	 <8837fb770805282125w5f3d7101i4b42b0c55edd3a5a@mail.gmail.com>
X-Google-Sender-Auth: acc3478ce4c9232c
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, May 29, 2008 at 12:25 AM, John Wang <john.wang@gmail.com> wrote:
> I am using my implementation of a FilteredIndexReader.

Perhaps this is the issue?
Can you distill a testcase that shows the problem?

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34224-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 17:32:29 2008
Return-Path: <java-user-return-34224-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14342 invoked from network); 29 May 2008 17:32:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 17:32:29 -0000
Received: (qmail 7894 invoked by uid 500); 29 May 2008 17:32:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7869 invoked by uid 500); 29 May 2008 17:32:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7856 invoked by uid 99); 29 May 2008 17:32:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 10:32:23 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 209.85.132.245 as permitted sender)
Received: from [209.85.132.245] (HELO an-out-0708.google.com) (209.85.132.245)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 17:31:35 +0000
Received: by an-out-0708.google.com with SMTP id c37so131376anc.49
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 10:31:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=jQsYJ3yd8bhoRpRtyHD+UCkKFX4b+OwHDlPTaatCv50=;
        b=CbxDnIzeFH2/kpJHW217hPsnNXux7T6AqWQVDWU3rYFZUevDR0X0Iy9C32MFb0bi+72wCebLJjbwujSb61ItmUV0xrAz9F2hW3liaSX+dMdM2mVLVlAn8gHRF/Lqdu8/qAZeEfi3l9OozU8rxzgC//osHSw4oFuRFU7pxDWfDh4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=vDd/3mXU8zd6NsEqsa09Rs8FwNXrWFui4r/u8VO/Om+SQyrQ6Jx4UMTatl9os5m8j98oHLIAnuvBM8AUPXowdOKTf3sBuXNoPPoHS3M7hQIXnlSIzlJzLMJW2srdKT52NIkfj9mnkau58LD/r4mQiz1xMthqs/cU6phYzfCInM0=
Received: by 10.100.125.12 with SMTP id x12mr1885465anc.71.1212082310970;
        Thu, 29 May 2008 10:31:50 -0700 (PDT)
Received: from ?9.30.38.211? ( [129.42.184.35])
        by mx.google.com with ESMTPS id n45sm1440333pyh.29.2008.05.29.10.31.47
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 10:31:50 -0700 (PDT)
Message-ID: <483EE805.3090500@gmail.com>
Date: Thu, 29 May 2008 10:29:41 -0700
From: Michael Busch <buschmic@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: IndexReader.reopen memory leak
References: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com>	 <483DD50C.3080908@gmail.com> <483DE95C.9030501@gmail.com>	 <8837fb770805282125w5f3d7101i4b42b0c55edd3a5a@mail.gmail.com>	 <483E5CD9.8080005@gmail.com> <8837fb770805290941p3ae6dff1g1be9f2222cc49bbf@mail.gmail.com>
In-Reply-To: <8837fb770805290941p3ae6dff1g1be9f2222cc49bbf@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Does your FilteredIndexReader.reopen() return a new instance of 
FilteredIndexReader in case the inner reader was updated (i. e. 
in!=newInner)?

-Michael


John Wang wrote:
> Yes:
> 
> IndexReader newInner=in.reopen();
>       if (in!=newInner)
>       {
>         in.close();
>         this.in=newInner;
> 
>         // code to clean up my data
>         _cache.clear();
>         _indexData.load(this, true);
>         init(_fieldConfig);
>       }
> 
> if I change this code to:
> try
>       {
>         this.in.close();     force close
>       }
>       catch(Exception e)
>       {
>         logger.warn(e.getMessage());
>       }
>       finally
>       {
>         this.in=newReader(); <-- new instance of IndexReader
>         _cache.clear();
>         _indexData.load(this, true);
>         init(_fieldConfig);
>       }
> 
> fixes my leak.
> 
> -John
> 
> On Thu, May 29, 2008 at 12:35 AM, Michael Busch <buschmic@gmail.com> wrote:
> 
>> Could you share some details about how you implemented reopen() in your
>> reader?
>>
>> -Michael
>>
>>
>> John Wang wrote:
>>
>>> Yes, I do close the old reader.
>>> I have a large index, my system is doing real time updates: 1 thread
>>> writing
>>> batches of updates to the index, after each index update, it updates the
>>> reader. I have two readers open always, one is serving the search
>>> requests,
>>> while the other updates and the two flips. Reader update implies index
>>> reopen here.
>>>
>>> I am using my implementation of a FilteredIndexReader.
>>>
>>> Index leaks very slowly, but obvious.
>>>
>>> No, I am not able to provide heap dumps.
>>>
>>> -John
>>>
>>> On Wed, May 28, 2008 at 4:23 PM, Mark Miller <markrmiller@gmail.com>
>>> wrote:
>>>
>>>  As someone that has done a lot of reopens, I can vouch there is no leak
>>>> under simple, normal usage. Are you sure your closing the original reader
>>>> after getting the reopened reference?
>>>>
>>>>
>>>> Michael Busch wrote:
>>>>
>>>>  Hi John,
>>>>> hmm not good. I will take a look. It has probably to do with the
>>>>> reference
>>>>> counting. Are you doing anything special? E. g. do you have own reader
>>>>> implementations that you call reopen() on? What kinds of readers are you
>>>>> using?
>>>>>
>>>>> Are you maybe able to provide a heapdump?
>>>>>
>>>>> -Michael
>>>>>
>>>>> John Wang wrote:
>>>>>
>>>>>  Hi:
>>>>>>  We are experiencing memory leak with calling IndexReader.reopen().
>>>>>>
>>>>>>  From eyeballing the lucene source code, I am seeing normCache is not
>>>>>> cleared.
>>>>>>
>>>>>>
>>>>>>  Anyone else experiencing this?
>>>>>>
>>>>>> Thanks
>>>>>>
>>>>>> -John
>>>>>>
>>>>>>
>>>>>>  ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>>  ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34225-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 18:27:39 2008
Return-Path: <java-user-return-34225-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44963 invoked from network); 29 May 2008 18:27:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 18:27:38 -0000
Received: (qmail 13860 invoked by uid 500); 29 May 2008 18:27:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13700 invoked by uid 500); 29 May 2008 18:27:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13653 invoked by uid 99); 29 May 2008 18:27:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 11:27:32 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of viniciusccarvalho@gmail.com designates 74.125.46.30 as permitted sender)
Received: from [74.125.46.30] (HELO yw-out-2324.google.com) (74.125.46.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 18:26:45 +0000
Received: by yw-out-2324.google.com with SMTP id 3so1927764ywj.5
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 11:27:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=B+Bpi3c5ZedjLfcrO4VYqo9ZrSCsnZs0t2W7aqHHqwM=;
        b=jGX4R75xMJLxayLQXsjuCpGS30cUCxRWFvrZvzq0S4HQuX77hCD2Ym4X30/rt1ZWZj4qVgy3MudFkNaCunq+cqlqDDnC6Wfrv+waMnPI4sSSrRfs0cFkJH3nDceLtuuslMQHvWSw1RWicpmh3cEuwUdupiEbguVzD2ewnhXeg3s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=IT+Xwo81ftph0Y8G333XvU9dTUUzxD7EHGWlvda6SJ+jsVQruttePFfuW0frXU/bhMIfI5SZazs+yc7HMH6Mw9JLGy2z3vs1SZzu/NEzP0CA6obU3kBdMk3eZaF8CjygthsaJpCxmkTzytN/lm3NLKd7wBJkFU7ibybHgTzGBZc=
Received: by 10.114.13.1 with SMTP id 1mr4814174wam.96.1212085621227;
        Thu, 29 May 2008 11:27:01 -0700 (PDT)
Received: by 10.115.95.8 with HTTP; Thu, 29 May 2008 11:26:54 -0700 (PDT)
Message-ID: <9d2777b60805291126x20e653a3r27dd2e7af9ecf0cf@mail.gmail.com>
Date: Thu, 29 May 2008 15:26:54 -0300
From: "Vinicius Carvalho" <viniciusccarvalho@gmail.com>
To: java-user@lucene.apache.org
Subject: Single IndexReader vs Single IndexSearcher
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_21272_30771257.1212085614530"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_21272_30771257.1212085614530
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hello there! My application uses multiple indexes, so I create a multireader
based on my indexreaders. What I've done is create a Map of Readers, and
whenever the user needs a reader I iterate over my collection, checking if
it is the current index, if not I reopen it, else, I add it to my
multireader.

So, for each thread I have a new MultiReader, but my readers are kept open
for a long period (few updates to the index, many reads). But I also create
a new Searcher based on the Multireader for each thread. On the faqs it says
that we should have only one searcher as well. The overhead of the searcher
creation is due to the reader it uses or it has an internal overhead forcing
other to have a single instance of it as well?

Regards

-- 
"In a world without fences and walls, who needs Gates and Windows?"

------=_Part_21272_30771257.1212085614530--

From java-user-return-34226-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 18:30:07 2008
Return-Path: <java-user-return-34226-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45918 invoked from network); 29 May 2008 18:30:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 18:30:07 -0000
Received: (qmail 21942 invoked by uid 500); 29 May 2008 18:30:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21908 invoked by uid 500); 29 May 2008 18:30:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21897 invoked by uid 99); 29 May 2008 18:30:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 11:30:01 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 64.233.170.188 as permitted sender)
Received: from [64.233.170.188] (HELO rn-out-0910.google.com) (64.233.170.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 18:29:13 +0000
Received: by rn-out-0910.google.com with SMTP id j40so2028079rnf.4
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 11:29:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=NU0Cv1J1NjH0Knj0xIdv3lnwK2rf2Ks8dK2cHauRdUA=;
        b=ICVFj27tQpHH+eynhjpNU+DZi1Ep/QR/VWne/BLyzpEPyxoM11K6RasGQ46eoSCaPZnXkiBkKUOMoY1l0UADNBOv11+HFttpCG4aqY+FB0A9f4MMYG1ImgGlo+gmizBPvSPkiIw0t9O0G9GAr9AiCA1leNfyc9Ua2Spe5FV9kSw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=hqkIYZxV5mls9/JcKQUtMfV1YYzMJCjt9hRS6fkJrF8lb5lE7Xsasxmhe7/9E+E6JCy6KEnb2KwR5Jj5pebRBSvJAisdEZl2d9kGa9Ikgey7vrFW6bzaJYouzrHJSNYH7S9kmwQ/+QJNjPZn+3EUoM9BTGss61kd5/xb4FMVZF0=
Received: by 10.115.108.1 with SMTP id k1mr2966037wam.109.1212085768219;
        Thu, 29 May 2008 11:29:28 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id c6sm1268360qbc.13.2008.05.29.11.29.26
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 11:29:27 -0700 (PDT)
Message-ID: <483EF607.5020907@gmail.com>
Date: Thu, 29 May 2008 14:29:27 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Single IndexReader vs Single IndexSearcher
References: <9d2777b60805291126x20e653a3r27dd2e7af9ecf0cf@mail.gmail.com>
In-Reply-To: <9d2777b60805291126x20e653a3r27dd2e7af9ecf0cf@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Vinicius Carvalho wrote:
> Hello there! My application uses multiple indexes, so I create a multireader
> based on my indexreaders. What I've done is create a Map of Readers, and
> whenever the user needs a reader I iterate over my collection, checking if
> it is the current index, if not I reopen it, else, I add it to my
> multireader.
>
> So, for each thread I have a new MultiReader, but my readers are kept open
> for a long period (few updates to the index, many reads). But I also create
> a new Searcher based on the Multireader for each thread. On the faqs it says
> that we should have only one searcher as well. The overhead of the searcher
> creation is due to the reader it uses or it has an internal overhead forcing
> other to have a single instance of it as well?
>
> Regards
>
>   
99.9% of the overhead is the reader...if your caching that there is 
little value in caching the searcher.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34227-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 19:32:07 2008
Return-Path: <java-user-return-34227-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77345 invoked from network); 29 May 2008 19:32:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 19:32:07 -0000
Received: (qmail 30415 invoked by uid 500); 29 May 2008 19:32:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30384 invoked by uid 500); 29 May 2008 19:32:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30373 invoked by uid 99); 29 May 2008 19:32:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 12:32:01 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [207.97.245.151] (HELO smtp151.iad.emailsrvr.com) (207.97.245.151)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 19:31:07 +0000
Received: from relay5.relay.iad.emailsrvr.com (localhost [127.0.0.1])
	by relay5.relay.iad.emailsrvr.com (SMTP Server) with ESMTP id 9598D6C406B
	for <java-user@lucene.apache.org>; Thu, 29 May 2008 15:31:28 -0400 (EDT)
Received: from rhoderunner.com (webmail20.webmail.iad.mlsrvr.com [192.168.1.41])
	by relay5.relay.iad.emailsrvr.com (SMTP Server) with ESMTP id 2360A6B4DDA
	for <java-user@lucene.apache.org>; Thu, 29 May 2008 15:31:27 -0400 (EDT)
Received: by webmail.emailsrvr.com
    (Authenticated sender: prhodes@rhoderunner.com, from: spamsucks@rhoderunner.com) 
    with HTTP; Thu, 29 May 2008 15:31:27 -0400 (EDT)
Date: Thu, 29 May 2008 15:31:27 -0400 (EDT)
Subject: =?UTF-8?Q?date=20filter=20filtering=20out=20non-dated=20items=3F?=
From: "Phillip Rhodes" <spamsucks@rhoderunner.com>
To: java-user@lucene.apache.org
Reply-To: spamsucks@rhoderunner.com
MIME-Version: 1.0
Content-Type: text/plain;charset=UTF-8
Content-Transfer-Encoding: quoted-printable
Importance: Normal
X-Priority: 3 (Normal)
X-Type: 1
Message-ID: <52191.192.168.1.35.1212089487.webmail@192.168.1.35>
X-Mailer: webmail6.6.1
X-Virus-Checked: Checked by ClamAV on apache.org

=0AWe have many different types of objects that we are indexing with Lucene=
 (coupons, roadtrips, events, attractions, etc).  =0A=0ABecause events and =
coupons can expire, we would like to apply a date filter to the query to fi=
lter out the expired items, but the problem is that there are other objects=
 like attractions and roadtrips that do not expire.  Anything that doesn't =
have a start/end date would be filtered out of the results.=0A=0AWhile I co=
uld add a future date to these documents, this kind of feels hackish and I =
would be interested in other ideas on how to filter out expired documents. =
 =0A=0AThanks for your time.=0A=0APhillip


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34228-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 22:18:34 2008
Return-Path: <java-user-return-34228-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45885 invoked from network); 29 May 2008 22:18:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 22:18:33 -0000
Received: (qmail 96483 invoked by uid 500); 29 May 2008 22:18:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96455 invoked by uid 500); 29 May 2008 22:18:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96444 invoked by uid 99); 29 May 2008 22:18:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 15:18:28 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of chy1013m1@hotmail.com designates 65.54.246.216 as permitted sender)
Received: from [65.54.246.216] (HELO bay0-omc3-s16.bay0.hotmail.com) (65.54.246.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 22:17:31 +0000
Received: from BAY143-W18 ([65.55.154.53]) by bay0-omc3-s16.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 29 May 2008 15:17:53 -0700
Message-ID: <BAY143-W18127970EE447A95E9AEFAE2BF0@phx.gbl>
X-Originating-IP: [128.100.5.115]
From: Alex <chy1013m1@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: lucene memory consumption
Date: Thu, 29 May 2008 22:17:52 +0000
Importance: Normal
Content-Type: text/plain; charset="big5"
Content-Transfer-Encoding: 8bit
MIME-Version: 1.0
X-OriginalArrivalTime: 29 May 2008 22:17:53.0311 (UTC) FILETIME=[D6A2B2F0:01C8C1D9]
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,
other than the in memory terms (.tii), and the few kilobytes of opened file buffer, where are some other sources of significant memory consumption
when searching on a large index ?  (> 100GB). The queries are just normal term queries.


_________________________________________________________________
H Windows Live Messenger M HotmailAaxTb X Windows Live for Mobile 
http://www.msn.com.tw/msnmobile/ 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34229-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 22:26:27 2008
Return-Path: <java-user-return-34229-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47533 invoked from network); 29 May 2008 22:26:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 22:26:27 -0000
Received: (qmail 1165 invoked by uid 500); 29 May 2008 22:26:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1125 invoked by uid 500); 29 May 2008 22:26:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1114 invoked by uid 99); 29 May 2008 22:26:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 15:26:18 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chenjian1227@gmail.com designates 64.233.178.251 as permitted sender)
Received: from [64.233.178.251] (HELO hs-out-0708.google.com) (64.233.178.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 22:25:28 +0000
Received: by hs-out-0708.google.com with SMTP id 4so2535624hsl.5
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 15:25:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=TYqKbhEW9G5uPIEfrA7UAr2ktX8HN89boUHaRvkoGq0=;
        b=d6bDMy2cHFLaNnJw9KJu3gUaYWE4qYE0bVYBzlheiGnVLll5Esrd2e8Jbyu0ym0p7Zl/4XAN1QvGgk7VDuRsPjGp0sfmcYSiAJG8OBZcz2ZJynYS9booaO+C2Gv/3PGIzQpupBK/yad9/cDx5OBWJX3rVkMdGE3vM6sxfUtQ4tg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=HoCiSKw1nn5b0rOJIyfNVWjmtEdh5+NN1ZDeH2PmNZyXAI3eRigcXx2h/kRmRENN+A/aPvs5cy14MNFbMBKaUPJJjW4grwGF7GKNNz07E8e9r8Ar9SnY4v7DkWbC0MoZeiCzqIn6vLjcvOZYGzgHoJUs5VoiorPzzLlta8VaeHo=
Received: by 10.100.91.17 with SMTP id o17mr7381950anb.145.1212099943251;
        Thu, 29 May 2008 15:25:43 -0700 (PDT)
Received: by 10.100.205.4 with HTTP; Thu, 29 May 2008 15:25:43 -0700 (PDT)
Message-ID: <7ca123910805291525m2cfa7580k6d6876fd9bb36859@mail.gmail.com>
Date: Thu, 29 May 2008 15:25:43 -0700
From: "jian chen" <chenjian1227@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: lucene memory consumption
In-Reply-To: <BAY143-W18127970EE447A95E9AEFAE2BF0@phx.gbl>
MIME-Version: 1.0
Content-Type: text/plain; charset=BIG5
Content-Transfer-Encoding: base64
Content-Disposition: inline
References: <BAY143-W18127970EE447A95E9AEFAE2BF0@phx.gbl>
X-Virus-Checked: Checked by ClamAV on apache.org

Tm90IHRoYXQgSSBjYW4gdGhpbmsgYWJvdXQuIEJ1dCwgaWYgeW91IGhhdmUgYW55IGNhY2hlZCBm
aWVsZCBkYXRhLApub3JtcyBhcnJheSwgdGhhdCBjb3VsZCBiZSBodWdlLgoKV291bGQgYmUgaW50
ZXJlc3RlZCBpbiBrbm93aW5nIGZyb20gb3RoZXJzIHJlZ2FyZGluZyB0aGlzIHRvcGljIGFzIHdl
bGwuCgpKaWFuCgpPbiA1LzI5LzA4LCBBbGV4IDxjaHkxMDEzbTFAaG90bWFpbC5jb20+IHdyb3Rl
Ogo+Cj4gSGksCj4gb3RoZXIgdGhhbiB0aGUgaW4gbWVtb3J5IHRlcm1zICgudGlpKSwgYW5kIHRo
ZSBmZXcga2lsb2J5dGVzIG9mIG9wZW5lZCBmaWxlCj4gYnVmZmVyLCB3aGVyZSBhcmUgc29tZSBv
dGhlciBzb3VyY2VzIG9mIHNpZ25pZmljYW50IG1lbW9yeSBjb25zdW1wdGlvbgo+IHdoZW4gc2Vh
cmNoaW5nIG9uIGEgbGFyZ2UgaW5kZXggPyAgKD4gMTAwR0IpLiBUaGUgcXVlcmllcyBhcmUganVz
dCBub3JtYWwKPiB0ZXJtIHF1ZXJpZXMuCj4KPgo+IF9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCj4gwEioraq6IFdpbmRvd3Mg
TGl2ZSBNZXNzZW5nZXIgqU0gSG90bWFpbKFBpKOtra7JpmG0eLSkuOqwVLrJpmKr/LahIKFYIFdp
bmRvd3MgTGl2ZSBmb3IgTW9iaWxlCj4gaHR0cDovL3d3dy5tc24uY29tLnR3L21zbm1vYmlsZS8K
Pgo+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQo+IFRvIHVuc3Vic2NyaWJlLCBlLW1haWw6IGphdmEtdXNlci11bnN1
YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZwo+IEZvciBhZGRpdGlvbmFsIGNvbW1hbmRzLCBlLW1h
aWw6IGphdmEtdXNlci1oZWxwQGx1Y2VuZS5hcGFjaGUub3JnCj4KPgo=


From java-user-return-34230-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 22:31:27 2008
Return-Path: <java-user-return-34230-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49495 invoked from network); 29 May 2008 22:31:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 22:31:27 -0000
Received: (qmail 10422 invoked by uid 500); 29 May 2008 22:31:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10383 invoked by uid 500); 29 May 2008 22:31:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10372 invoked by uid 99); 29 May 2008 22:31:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 15:31:21 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of chy1013m1@hotmail.com designates 65.54.246.236 as permitted sender)
Received: from [65.54.246.236] (HELO bay0-omc3-s36.bay0.hotmail.com) (65.54.246.236)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 22:30:23 +0000
Received: from BAY143-W47 ([65.55.154.82]) by bay0-omc3-s36.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 29 May 2008 15:30:44 -0700
Message-ID: <BAY143-W47FC99D4F4FB962EF25300E2BF0@phx.gbl>
X-Originating-IP: [128.100.5.115]
From: Alex <chy1013m1@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: RE: lucene memory consumption
Date: Thu, 29 May 2008 22:30:44 +0000
Importance: Normal
In-Reply-To: <7ca123910805291525m2cfa7580k6d6876fd9bb36859@mail.gmail.com>
References: <BAY143-W18127970EE447A95E9AEFAE2BF0@phx.gbl>
 <7ca123910805291525m2cfa7580k6d6876fd9bb36859@mail.gmail.com>
Content-Type: text/plain; charset="big5"
Content-Transfer-Encoding: 8bit
MIME-Version: 1.0
X-OriginalArrivalTime: 29 May 2008 22:30:44.0810 (UTC) FILETIME=[A27C1AA0:01C8C1DB]
X-Virus-Checked: Checked by ClamAV on apache.org


Currently, searching on our index consumes around 2.5GB of ram. 
This is just a single term query, nothing that requires the in memory cache like in
the FieldScoreQuery. 


Alex

----------------------------------------
> Date: Thu, 29 May 2008 15:25:43 -0700
> From: chenjian1227@gmail.com
> To: java-user@lucene.apache.org
> Subject: Re: lucene memory consumption
> 
> Not that I can think about. But, if you have any cached field data,
> norms array, that could be huge.
> 
> Would be interested in knowing from others regarding this topic as well.
> 
> Jian
> 
> On 5/29/08, Alex  wrote:
>>
>> Hi,
>> other than the in memory terms (.tii), and the few kilobytes of opened file
>> buffer, where are some other sources of significant memory consumption
>> when searching on a large index ?  (> 100GB). The queries are just normal
>> term queries.
>>
>>
>> _________________________________________________________________
>> H Windows Live Messenger M HotmailAaxTb X Windows Live for Mobile
>> http://www.msn.com.tw/msnmobile/
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>

_________________________________________________________________
H Windows Live Messenger M HotmailAaxTb X Windows Live for Mobile 
http://www.msn.com.tw/msnmobile/ 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34231-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 22:40:09 2008
Return-Path: <java-user-return-34231-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62870 invoked from network); 29 May 2008 22:40:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 22:40:08 -0000
Received: (qmail 35224 invoked by uid 500); 29 May 2008 22:40:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35189 invoked by uid 500); 29 May 2008 22:40:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35168 invoked by uid 99); 29 May 2008 22:40:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 15:40:02 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 74.125.44.29 as permitted sender)
Received: from [74.125.44.29] (HELO yx-out-2324.google.com) (74.125.44.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 22:39:14 +0000
Received: by yx-out-2324.google.com with SMTP id 31so371871yxl.5
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 15:39:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=bDsMGSF99ry+KK13Frq1jtzrUv4Lg0tdYvPfpg35mfE=;
        b=cRBIEimnt5YWtp2iOC0naYIfnmxF5Db1GQIZy2S7Gn+ZhsFmScjUDDiKViC/+GEJTKlq6R6zQZfqmt3OG8ecviXGlli7hvr6htmdjI7DPjqm9TRWHqiCGXer+O6P30mvySuq9AQJCdK/iYdg4wr4qGFfZkTZErmxpYXiUxR3GqY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=Uhec8bl8chF106OfxKU6OWL4f7s6kNaMUIRAdbl7bsZQQwJRI3rzm/B7M4stSpJ1lVqbsKu/na461VDcaOP+C6MG0gChCzAMUR958JTPf5Qcqr/1G/4B5UUOiTMLRsxU6uuqHCnLVcKKCIeumA1b0TaQeV/bk7EDAsbFaIKKL4A=
Received: by 10.150.204.8 with SMTP id b8mr8900732ybg.75.1212100770478;
        Thu, 29 May 2008 15:39:30 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id e14sm1575915qbe.35.2008.05.29.15.39.29
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 15:39:29 -0700 (PDT)
Message-ID: <483F30A3.4060905@gmail.com>
Date: Thu, 29 May 2008 18:39:31 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene memory consumption
References: <BAY143-W18127970EE447A95E9AEFAE2BF0@phx.gbl> <7ca123910805291525m2cfa7580k6d6876fd9bb36859@mail.gmail.com> <BAY143-W47FC99D4F4FB962EF25300E2BF0@phx.gbl>
In-Reply-To: <BAY143-W47FC99D4F4FB962EF25300E2BF0@phx.gbl>
Content-Type: text/plain; charset=Big5
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Alex wrote:
> Currently, searching on our index consumes around 2.5GB of ram. 
> This is just a single term query, nothing that requires the in memory cache like in
> the FieldScoreQuery. 
>
>
> Alex
>
> ----------------------------------------
>   
That seems rather high. You have 10/15 million + docs?

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34232-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 22:57:34 2008
Return-Path: <java-user-return-34232-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66966 invoked from network); 29 May 2008 22:57:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 22:57:34 -0000
Received: (qmail 54476 invoked by uid 500); 29 May 2008 22:57:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54454 invoked by uid 500); 29 May 2008 22:57:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54443 invoked by uid 99); 29 May 2008 22:57:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 15:57:29 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [203.217.22.128] (HELO file1.syd.nuix.com.au) (203.217.22.128)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 22:56:42 +0000
Received: from host68.syd.nuix.com.au (host68.syd.nuix.com.au [192.168.222.68])
	by file1.syd.nuix.com.au (Postfix) with ESMTP id 491B14A8173
	for <java-user@lucene.apache.org>; Fri, 30 May 2008 08:58:30 +1000 (EST)
From: Daniel Noll <daniel@nuix.com>
Organization: Nuix Pty Ltd
To: java-user@lucene.apache.org
Subject: Re: lucene memory consumption
Date: Fri, 30 May 2008 08:57:14 +1000
User-Agent: KMail/1.9.6 (enterprise 0.20070907.709405)
References: <BAY143-W18127970EE447A95E9AEFAE2BF0@phx.gbl>
In-Reply-To: <BAY143-W18127970EE447A95E9AEFAE2BF0@phx.gbl>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="big5"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805300857.14698.daniel@nuix.com>
X-Virus-Checked: Checked by ClamAV on apache.org

On Friday 30 May 2008 08:17:52 Alex wrote:
> Hi,
> other than the in memory terms (.tii), and the few kilobytes of opened file
> buffer, where are some other sources of significant memory consumption when
> searching on a large index ?  (> 100GB). The queries are just normal term
> queries.

Norms can also eat quite a bit of space if you have a large number of fields.

Daniel

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34233-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 23:06:35 2008
Return-Path: <java-user-return-34233-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71908 invoked from network); 29 May 2008 23:06:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 23:06:35 -0000
Received: (qmail 67351 invoked by uid 500); 29 May 2008 23:06:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67322 invoked by uid 500); 29 May 2008 23:06:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67311 invoked by uid 99); 29 May 2008 23:06:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 16:06:29 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chy1013m1@hotmail.com designates 65.54.246.213 as permitted sender)
Received: from [65.54.246.213] (HELO bay0-omc3-s13.bay0.hotmail.com) (65.54.246.213)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 23:05:39 +0000
Received: from BAY143-W2 ([65.55.154.37]) by bay0-omc3-s13.bay0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 29 May 2008 16:05:55 -0700
Message-ID: <BAY143-W254B12877FF01922F28EAE2BF0@phx.gbl>
X-Originating-IP: [128.100.5.115]
From: Alex <chy1013m1@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: RE: lucene memory consumption
Date: Thu, 29 May 2008 23:05:54 +0000
Importance: Normal
In-Reply-To: <483F30A3.4060905@gmail.com>
References: <BAY143-W18127970EE447A95E9AEFAE2BF0@phx.gbl>
 <7ca123910805291525m2cfa7580k6d6876fd9bb36859@mail.gmail.com>
 <BAY143-W47FC99D4F4FB962EF25300E2BF0@phx.gbl> <483F30A3.4060905@gmail.com>
Content-Type: text/plain; charset="big5"
Content-Transfer-Encoding: 8bit
MIME-Version: 1.0
X-OriginalArrivalTime: 29 May 2008 23:05:55.0029 (UTC) FILETIME=[8C45F850:01C8C1E0]
X-Virus-Checked: Checked by ClamAV on apache.org


I believe we have around 346 million documents


Alex

----------------------------------------
> Date: Thu, 29 May 2008 18:39:31 -0400
> From: markrmiller@gmail.com
> To: java-user@lucene.apache.org
> Subject: Re: lucene memory consumption
> 
> Alex wrote:
>> Currently, searching on our index consumes around 2.5GB of ram. 
>> This is just a single term query, nothing that requires the in memory cache like in
>> the FieldScoreQuery. 
>>
>>
>> Alex
>>
>> ----------------------------------------
>>   
> That seems rather high. You have 10/15 million + docs?
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

_________________________________________________________________
ojMMsKOuC X MSN jMuC 
http://toolbar.live.com/

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34234-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu May 29 23:16:50 2008
Return-Path: <java-user-return-34234-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73734 invoked from network); 29 May 2008 23:16:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 May 2008 23:16:50 -0000
Received: (qmail 80143 invoked by uid 500); 29 May 2008 23:16:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80109 invoked by uid 500); 29 May 2008 23:16:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80097 invoked by uid 99); 29 May 2008 23:16:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 16:16:44 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 74.125.46.30 as permitted sender)
Received: from [74.125.46.30] (HELO yw-out-2324.google.com) (74.125.46.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 23:15:57 +0000
Received: by yw-out-2324.google.com with SMTP id 3so1969062ywj.5
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 16:16:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=VNC6/vamU2eJBppK87+7N3HSk1XRYZIr4CzaVhvKlyY=;
        b=HtHSq1Au51yIktcHBzIVFpx0DGJ0lsP43EngEcdSJPKanU+RXuUNcKDLRcbVwaZbfiiDENgiPn1e9Cjud5qp1+CByzuqEnnZ3b9ZvXaB0nTAKdjP4MnWaoWQW7Dc4cAhYYGUwBVMirPi86epN+/Ewex6bwsBDgSilkSBMV1gR2U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=Jl0J5KzmkvigKOza0GmUaZ7r87MgJF4sdIn74d/RYWWwwTI8pkU7hMGlWdwgIp9ElyeJDFq/0ZrX1BGuQOM1pJJPi2JBOeoyhet5Rae9quIpHKx/r1Rs7dOMTV3feTLGhA+2YY4W9ibssdLVLkPT/KYK2x+9a7kiRDeZBeie7cQ=
Received: by 10.151.101.20 with SMTP id d20mr3533278ybm.104.1212102972559;
        Thu, 29 May 2008 16:16:12 -0700 (PDT)
Received: by 10.151.41.21 with HTTP; Thu, 29 May 2008 16:16:12 -0700 (PDT)
Message-ID: <c68e39170805291616i426fc156m18cd6537932195cc@mail.gmail.com>
Date: Thu, 29 May 2008 19:16:12 -0400
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: lucene memory consumption
In-Reply-To: <BAY143-W254B12877FF01922F28EAE2BF0@phx.gbl>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <BAY143-W18127970EE447A95E9AEFAE2BF0@phx.gbl>
	 <7ca123910805291525m2cfa7580k6d6876fd9bb36859@mail.gmail.com>
	 <BAY143-W47FC99D4F4FB962EF25300E2BF0@phx.gbl>
	 <483F30A3.4060905@gmail.com>
	 <BAY143-W254B12877FF01922F28EAE2BF0@phx.gbl>
X-Google-Sender-Auth: cf48719adeeb17a0
X-Virus-Checked: Checked by ClamAV on apache.org

2008/5/29 Alex <chy1013m1@hotmail.com>:
> I believe we have around 346 million documents

So that would be 346MB per indexed field that you search.

Also, if you sort on anything other than score, that will take up a
lot of memory to un-invert the field.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34235-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 00:06:01 2008
Return-Path: <java-user-return-34235-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87951 invoked from network); 30 May 2008 00:06:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 00:06:00 -0000
Received: (qmail 17831 invoked by uid 500); 30 May 2008 00:05:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17807 invoked by uid 500); 30 May 2008 00:05:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 99460 invoked by uid 99); 29 May 2008 23:44:16 -0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of SRS0=F5DF2w=WM=mac.com=pauljlucas@yourhostingaccount.com designates 65.254.254.73 as permitted sender)
X-EN-OrigOutIP: 10.1.18.6
X-EN-IMPSID: Xbji1Z00307rVmq0000000
Message-Id: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com>
From: "Paul J. Lucas" <pauljlucas@mac.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v924)
Subject: FileNotFoundException in ConcurrentMergeScheduler
Date: Thu, 29 May 2008 16:43:18 -0700
X-Mailer: Apple Mail (2.924)
X-EN-UserInfo: 19b3ee6e8bc35660ab25150f3ce1009e:104eb4694f5dc54e252b420fd863a3b6
X-EN-AuthUser: paul@pauljlucas.org
Sender:  "Paul J. Lucas" <pauljlucas@mac.com>
X-EN-OrigIP: 76.204.180.63
X-EN-OrigHost: adsl-76-204-180-63.dsl.pltn13.sbcglobal.net
X-Virus-Checked: Checked by ClamAV on apache.org

I occasionally get a FileNotFoundException like:

Exception in thread "Thread-44" org.apache.lucene.index.MergePolicy 
$MergeException: java.io.FileNotFoundException: /Stuff/Caches/ 
AuroraSupport/IM_IndexCache/INDEX/_27.cfs (No such file or directory)
	at org.apache.lucene.index.ConcurrentMergeScheduler 
$MergeThread.run(ConcurrentMergeScheduler.java:271)
Caused by: java.io.FileNotFoundException: /Stuff/Caches/AuroraSupport/ 
IM_IndexCache/INDEX/_27.cfs (No such file or directory)
	at java.io.RandomAccessFile.open(Native Method)
	at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
	at org.apache.lucene.store.FSDirectory$FSIndexInput 
$Descriptor.<init>(FSDirectory.java:506)
	at org.apache.lucene.store.FSDirectory 
$FSIndexInput.<init>(FSDirectory.java:536)
	at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:445)
	at  
org 
.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java: 
70)
	at  
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:277)
	at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:262)
	at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:221)
	at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java: 
3263)
	at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2968)
	at org.apache.lucene.index.ConcurrentMergeScheduler 
$MergeThread.run(ConcurrentMergeScheduler.java:240)

I'm currently using the 2.3.2 version of Lucene.  The exception  
frequency has decreased since upgrading from 2.3.1.

My code runs in a server that monitors the filesystem.  Whenever the  
contents of a directory change, my code unindexes all the files in the  
changed directory, then reindexes all the files in the directory.

I'm not doing anything complicated in my code.  To create/open the  
index, I do:

	INDEX_DIR = new File( INDEX_CACHE_DIR, "INDEX" );
	INDEX = FSDirectory.getDirectory( INDEX_DIR );
	if ( IndexReader.isLocked( INDEX ) )
	    IndexReader.unlock( INDEX );

The isLocked()/unlock() is because sometimes the server process gets  
killed and leaves teh indexed locked.

I have a thread than handles the unindexing/reindexing.  It gets  
changed from a BlockingQueue.  My unindex code is like:

	IndexWriter writer = new IndexWriter( INDEX, INDEX_ANALYZER, false );
	final Term t = new Term( DIR_FIELD, dir.getAbsolutePath() );
	writer.deleteDocuments( t );
	writer.close();

My indexing code is like:

	IndexWriter writer = new IndexWriter( INDEX, INDEX_ANALYZER );
	writer.setMergeFactor( INDEX_MERGE_FACTOR );
	Document doc = new Document();
	// ... add fields to doc ...
	writer.addDocument( doc );
	writer.close();

While that thread is executing, other threads can search the index by  
doing:

	IndexSearcher searcher = new IndexSearcher( INDEX );
	// ... prepare Query and Sort ...
	Hits hits = searcher.search( query, sort );
	Iterator hitIterator  hits.iterator();
	// ... iterate over hitIterator ...
	searcher.close();

Any ideas?  Is this a bug in Lucene?

- Paul


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34236-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 00:19:03 2008
Return-Path: <java-user-return-34236-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95968 invoked from network); 30 May 2008 00:19:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 00:19:03 -0000
Received: (qmail 25912 invoked by uid 500); 30 May 2008 00:18:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25883 invoked by uid 500); 30 May 2008 00:18:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25872 invoked by uid 99); 30 May 2008 00:18:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 17:18:57 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 66.249.82.230 as permitted sender)
Received: from [66.249.82.230] (HELO wx-out-0506.google.com) (66.249.82.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 00:18:08 +0000
Received: by wx-out-0506.google.com with SMTP id h29so2972711wxd.20
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 17:18:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=c4Yd2H1NLrPTYRh2LGhatB7fAfIDOvR9eLrKC07omyU=;
        b=RqAqQHvgjK8ZHh0WfkLtSM6ZI6Q37PeUXimlUeD7DoqSnrdE/E+TEbri0VawTZqXsP9+DV5e6iKhOe0Suo5JIaJKGlScXCioCV+WmywK87Wg9Kd371ntHHzwaw9WmQWmD3KmYiLN04716Tx5Y+cu95Y9kR2BTHlbXfK7jILLvOk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=BxN/EVHQ/1P0RmwFjJk8vlkswooo2sueCsgfICIaiWFjV0VzIAdkqqJ31H/thIFZyE7lez/gZyh05gtTXAxd7SQquLQLXwk9c6ZTzcIHUfwwEwloDe+Dq196wYhnzyp/IHpA6MkDIOQ7R11aR7RV/72CjbPX1dnuAcTjhbgsTpk=
Received: by 10.100.251.18 with SMTP id y18mr7600283anh.2.1212106703793;
        Thu, 29 May 2008 17:18:23 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id d5sm1695735qbd.8.2008.05.29.17.18.21
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 17:18:22 -0700 (PDT)
Message-ID: <483F47CD.1050709@gmail.com>
Date: Thu, 29 May 2008 20:18:21 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com>
In-Reply-To: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

It looks to me like you are not sharing an IndexSearcher across threads. 
You really should, or use a small pool of them (depending on 
speed/ram/load).

The only time I usually see this error, I also see too many files open 
first. Are you sure you don't have another exception as well?



Paul J. Lucas wrote:
> I occasionally get a FileNotFoundException like:
>
> Exception in thread "Thread-44" 
> org.apache.lucene.index.MergePolicy$MergeException: 
> java.io.FileNotFoundException: 
> /Stuff/Caches/AuroraSupport/IM_IndexCache/INDEX/_27.cfs (No such file 
> or directory)
>     at 
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:271) 
>
> Caused by: java.io.FileNotFoundException: 
> /Stuff/Caches/AuroraSupport/IM_IndexCache/INDEX/_27.cfs (No such file 
> or directory)
>     at java.io.RandomAccessFile.open(Native Method)
>     at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
>     at 
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:506) 
>
>     at 
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:536) 
>
>     at 
> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:445)
>     at 
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.java:70) 
>
>     at 
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:277)
>     at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:262)
>     at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:221)
>     at 
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:3263)
>     at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2968)
>     at 
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:240) 
>
>
> I'm currently using the 2.3.2 version of Lucene.  The exception 
> frequency has decreased since upgrading from 2.3.1.
>
> My code runs in a server that monitors the filesystem.  Whenever the 
> contents of a directory change, my code unindexes all the files in the 
> changed directory, then reindexes all the files in the directory.
>
> I'm not doing anything complicated in my code.  To create/open the 
> index, I do:
>
>     INDEX_DIR = new File( INDEX_CACHE_DIR, "INDEX" );
>     INDEX = FSDirectory.getDirectory( INDEX_DIR );
>     if ( IndexReader.isLocked( INDEX ) )
>         IndexReader.unlock( INDEX );
>
> The isLocked()/unlock() is because sometimes the server process gets 
> killed and leaves teh indexed locked.
>
> I have a thread than handles the unindexing/reindexing.  It gets 
> changed from a BlockingQueue.  My unindex code is like:
>
>     IndexWriter writer = new IndexWriter( INDEX, INDEX_ANALYZER, false );
>     final Term t = new Term( DIR_FIELD, dir.getAbsolutePath() );
>     writer.deleteDocuments( t );
>     writer.close();
>
> My indexing code is like:
>
>     IndexWriter writer = new IndexWriter( INDEX, INDEX_ANALYZER );
>     writer.setMergeFactor( INDEX_MERGE_FACTOR );
>     Document doc = new Document();
>     // ... add fields to doc ...
>     writer.addDocument( doc );
>     writer.close();
>
> While that thread is executing, other threads can search the index by 
> doing:
>
>     IndexSearcher searcher = new IndexSearcher( INDEX );
>     // ... prepare Query and Sort ...
>     Hits hits = searcher.search( query, sort );
>     Iterator hitIterator  hits.iterator();
>     // ... iterate over hitIterator ...
>     searcher.close();
>
> Any ideas?  Is this a bug in Lucene?
>
> - Paul
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34237-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 00:38:02 2008
Return-Path: <java-user-return-34237-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99370 invoked from network); 30 May 2008 00:38:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 00:38:02 -0000
Received: (qmail 34820 invoked by uid 500); 30 May 2008 00:37:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34790 invoked by uid 500); 30 May 2008 00:37:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34779 invoked by uid 99); 30 May 2008 00:37:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 17:37:56 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [17.148.16.68] (HELO smtpoutm.mac.com) (17.148.16.68)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 00:37:01 +0000
Received: from smtpin125.mac.com (smtpin125-bge351000 [10.150.68.125])
	by smtpoutm.mac.com (Xserve/smtpout005/MantshX 4.0) with ESMTP id m4U0bNIV021231
	for <java-user@lucene.apache.org>; Thu, 29 May 2008 17:37:23 -0700 (PDT)
MIME-version: 1.0
Content-transfer-encoding: 7BIT
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Received: from [10.0.1.203]
 (adsl-76-204-180-63.dsl.pltn13.sbcglobal.net [76.204.180.63])
 by smtpin125.mac.com
 (Sun Java(tm) System Messaging Server 6.3-6.03 (built Mar 14 2008; 32bit))
 with ESMTPSA id <0K1N0055FODQIU50@smtpin125.mac.com> for
 java-user@lucene.apache.org; Thu, 29 May 2008 17:37:23 -0700 (PDT)
Message-id: <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com>
From: "Paul J. Lucas" <pauljlucas@mac.com>
To: java-user@lucene.apache.org
In-reply-to: <483F47CD.1050709@gmail.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Thu, 29 May 2008 17:36:59 -0700
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com>
 <483F47CD.1050709@gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

On May 29, 2008, at 5:18 PM, Mark Miller wrote:

> It looks to me like you are not sharing an IndexSearcher across  
> threads.

My reading of the documentation says that doing so is an optimization  
only and not a requirement.

Are you saying that using multiple IndexSearchers will definitely  
cause the problem I am experiencing and so the suggestion that using a  
single IndexSearcher for optimaztion only is wrong?

> You really should, or use a small pool of them (depending on speed/ 
> ram/load)

If performance isn't an issue, why do I need to?

> The only time I usually see this error, I also see too many files  
> open first. Are you sure you don't have another exception as well?

Yes I'm sure there is no other exception.

- Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34238-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 00:58:07 2008
Return-Path: <java-user-return-34238-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4626 invoked from network); 30 May 2008 00:58:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 00:58:07 -0000
Received: (qmail 59406 invoked by uid 500); 30 May 2008 00:58:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59371 invoked by uid 500); 30 May 2008 00:58:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59360 invoked by uid 99); 30 May 2008 00:58:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 17:58:00 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 74.125.46.29 as permitted sender)
Received: from [74.125.46.29] (HELO yw-out-2324.google.com) (74.125.46.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 00:57:11 +0000
Received: by yw-out-2324.google.com with SMTP id 3so1987149ywj.5
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 17:57:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=uPKzxmWBY8YNgl3nH1kDKsmRXcFYRSoW1rnaAK2R54g=;
        b=licWZjnCvB972oey9X8QML8/c2v2Hd8B+DXK32aBda2lFx0X8Tgon88Oe4+zwyIM2H/e2l6EaeRx58hncC1Epz1V96kQ9VpiGmf0xX6nA6QCl4/5BmibXa6nACDHDdZ+RT1wbqZJepnG+PXTEV+Exk9NYpYisHasJWunUW3EDJw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=fa2eVYIl7hPaaFJT93Xb6lCLa0XLx59XSY4wxryNl2NpeMP46Q+n/JQWM3udkafx5qcBfvQzbAVoSUV1hW6P/NoH9k9BPHvdNCuhOMvQhmMR7CcsoobOpI+nsRaACft6nEXDrqVqCc3ECtj7D/Vi7GoPXsfmDZxC/dj/Mx6i/nk=
Received: by 10.150.73.41 with SMTP id v41mr7671619yba.186.1212109047413;
        Thu, 29 May 2008 17:57:27 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id f12sm1726060qba.33.2008.05.29.17.57.26
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 17:57:26 -0700 (PDT)
Message-ID: <483F50F5.3050804@gmail.com>
Date: Thu, 29 May 2008 20:57:25 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com>
In-Reply-To: <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Paul J. Lucas wrote:
> On May 29, 2008, at 5:18 PM, Mark Miller wrote:
>
>> It looks to me like you are not sharing an IndexSearcher across threads.
>
> My reading of the documentation says that doing so is an optimization 
> only and not a requirement.
>
> Are you saying that using multiple IndexSearchers will definitely 
> cause the problem I am experiencing and so the suggestion that using a 
> single IndexSearcher for optimaztion only is wrong?
Will it definitely cause your problem? I wouldn't say that. But it 
could. Also, yes I would say its wrong that you should only do it as an 
optimization - unless you really know what you are doing. Constructing a 
Searcher is slow (actually the underlying Reader), and so you don't want 
to do it every time someone searches...it will really slow you down. 
Also, if you get a ton of concurrent searches, you will have an 
IndexReader open for each...not only is this very wasteful in terms of 
RAM and time, but as your IndexWriter merges you can have all kinds of 
momentary references to normally unneeded index files...get enough of 
this going on, and even with the compound file format you can get too 
many files open and files missing FileNotFound exceptions.
>
>> You really should, or use a small pool of them (depending on 
>> speed/ram/load)
>
> If performance isn't an issue, why do I need to?
Because its the right thing to do :)
>
>> The only time I usually see this error, I also see too many files 
>> open first. Are you sure you don't have another exception as well?
>
> Yes I'm sure there is no other exception.
Ok...normally I recall them going together but that may not always be 
the case. Basically, I can't guarantee you this is your problem...but I 
do know its very possible. Some others on the list may have other ideas too.
>
> - Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34239-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 01:15:45 2008
Return-Path: <java-user-return-34239-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9180 invoked from network); 30 May 2008 01:15:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 01:15:44 -0000
Received: (qmail 68572 invoked by uid 500); 30 May 2008 01:15:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68542 invoked by uid 500); 30 May 2008 01:15:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68531 invoked by uid 99); 30 May 2008 01:15:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 18:15:39 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 209.85.132.244 as permitted sender)
Received: from [209.85.132.244] (HELO an-out-0708.google.com) (209.85.132.244)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 01:14:50 +0000
Received: by an-out-0708.google.com with SMTP id c37so407anc.49
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 18:15:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=f1PaxkaVtMjK4JYfLg68aAb4wNOfjoKUTrWOBTCzLWs=;
        b=OyTbT5zezeCxBBmUBLnEkpAd8/bXTBj2MdciLO1a5xVHqqdChVAddpzDQfrcrq46SIO+JXeao8aYqH5reWOx0jzVXnTWpRHm/U1yAKrIA2q5cnSr6VXxFT1CwEn0a8GBKy/ZRB1dZMAs9GvG51lE1Qj2V8u5LZINZNr/N53OqYg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=XFysPQ5QEb+hfD+4sYA+JvBAkuGdpqR42ssxnjdZQ6FbQC2VzHIoHEpvyILQXX8US4S09SkqQvm+FD8Ptb8I8yZSX66jZ6hM2LypKAvajeeO/xGVXPNE31fcHDlJiJ9VvAvhavXq7eswJQ3BE00RIFV3Ww/k/cVTGpfGb81UoZ4=
Received: by 10.100.127.18 with SMTP id z18mr7689372anc.93.1212110106547;
        Thu, 29 May 2008 18:15:06 -0700 (PDT)
Received: from ?9.30.38.211? ( [129.42.184.35])
        by mx.google.com with ESMTPS id w38sm5688413pyg.3.2008.05.29.18.15.04
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 18:15:05 -0700 (PDT)
Message-ID: <483F549D.3040405@gmail.com>
Date: Thu, 29 May 2008 18:13:01 -0700
From: Michael Busch <buschmic@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com>
In-Reply-To: <483F50F5.3050804@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Mark Miller wrote:
> Paul J. Lucas wrote:

> Also, if you get a ton of concurrent searches, you will have an 
> IndexReader open for each...not only is this very wasteful in terms of 
> RAM and time, but as your IndexWriter merges you can have all kinds of 
> momentary references to normally unneeded index files...get enough of 
> this going on, and even with the compound file format you can get too 
> many files open and files missing FileNotFound exceptions.
>>


I disagree, Mark. An IndexWriter should never hit a 
FileNotFoundException. If Lucene is being used correctly in Paul's 
system, i. e. no other applications (e. g. virus scanners) modify or 
remove files in the index directory, then this is likely a bug in Lucene.

Of course it can happen that you run out of available file descriptors 
when a lot of threads open separate IndexReaders, and then the 
SegmentMerger could certainly hit IOExceptions, but I don't think a 
FileNotFoundException would be thrown in such a case.

Paul, is Lucene the only process that modifies the index directory?
Would it be possible for you to try out the current Lucene trunk version 
and verify it the error persists? Maybe LUCENE-1044 fixes this as it 
makes Lucene more robust in case of machine or OS crashes. However, 
since in your case "only" the process gets killed by the OS, it should 
still sync the files properly to disk without 1044 I believe. What do 
you thing, Mike?

-Michael

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34240-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 01:18:44 2008
Return-Path: <java-user-return-34240-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14565 invoked from network); 30 May 2008 01:18:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 01:18:41 -0000
Received: (qmail 72665 invoked by uid 500); 30 May 2008 01:18:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72638 invoked by uid 500); 30 May 2008 01:18:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72627 invoked by uid 99); 30 May 2008 01:18:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 18:18:36 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 66.249.82.226 as permitted sender)
Received: from [66.249.82.226] (HELO wx-out-0506.google.com) (66.249.82.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 01:17:47 +0000
Received: by wx-out-0506.google.com with SMTP id h29so2987208wxd.20
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 18:18:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=g2u4BZmyVeXNLdVaTQl0+1JZ9D1wTRZMJz5Mwb6rw3A=;
        b=F3yxrl1TArksGPSbSuFK3flXp/h1G6+WSllQ7Sf47S/qweApmA2gHd40cO7olsXVxplcCTZiRt9wcBurkzAa6q3nnqPNWzw1XtQUOG5XzdQHfyxflH3bq+Vw5eMAJ46pUkI/RltJK8h3IoM8LvOIHFKDUulU5lSYyqNORBB4dC4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=OqFj0Z/xoEW1iEhr800qCAyhr3RzN5c1N7nXMlcw0Hewarw+T/iPvkb05wpNvrJQnwYc0MNnaUp5T3gKcy09bFGGnSA/fZ7mqTXghyymr6AYGIvphAbAbn8RDcFoos5ardEswJwc8nmmPKmKHwAqPHGIDlPXCxfMhC9ntoDbKWM=
Received: by 10.100.225.19 with SMTP id x19mr1929592ang.68.1212110284094;
        Thu, 29 May 2008 18:18:04 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id 1sm1740782qbh.32.2008.05.29.18.18.02
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 18:18:03 -0700 (PDT)
Message-ID: <483F55CA.4010705@gmail.com>
Date: Thu, 29 May 2008 21:18:02 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com>
In-Reply-To: <483F549D.3040405@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Michael Busch wrote:
> Mark Miller wrote:
>> Paul J. Lucas wrote:
>
>> Also, if you get a ton of concurrent searches, you will have an 
>> IndexReader open for each...not only is this very wasteful in terms 
>> of RAM and time, but as your IndexWriter merges you can have all 
>> kinds of momentary references to normally unneeded index files...get 
>> enough of this going on, and even with the compound file format you 
>> can get too many files open and files missing FileNotFound exceptions.
>>>
>
>
> I disagree, Mark. An IndexWriter should never hit a 
> FileNotFoundException. If Lucene is being used correctly in Paul's 
> system, i. e. no other applications (e. g. virus scanners) modify or 
> remove files in the index directory, then this is likely a bug in Lucene.
>
> Of course it can happen that you run out of available file descriptors 
> when a lot of threads open separate IndexReaders, and then the 
> SegmentMerger could certainly hit IOExceptions, but I don't think a 
> FileNotFoundException would be thrown in such a case.
>
> Paul, is Lucene the only process that modifies the index directory?
> Would it be possible for you to try out the current Lucene trunk 
> version and verify it the error persists? Maybe LUCENE-1044 fixes this 
> as it makes Lucene more robust in case of machine or OS crashes. 
> However, since in your case "only" the process gets killed by the OS, 
> it should still sync the files properly to disk without 1044 I 
> believe. What do you thing, Mike?
>
> -Michael
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
A bug I have found and ignored then :) Once I reduced the number of 
Readers I was generating it stopped. I will see about a test when i get 
a minute. I don't think its a Lucene issue, I think the filesystem lies, 
and that if you paused and tried again you would find it.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34241-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 01:27:04 2008
Return-Path: <java-user-return-34241-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17926 invoked from network); 30 May 2008 01:27:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 01:27:04 -0000
Received: (qmail 80258 invoked by uid 500); 30 May 2008 01:26:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80228 invoked by uid 500); 30 May 2008 01:26:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80217 invoked by uid 99); 30 May 2008 01:26:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 18:26:58 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.132.242] (HELO an-out-0708.google.com) (209.85.132.242)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 01:26:09 +0000
Received: by an-out-0708.google.com with SMTP id c37so1035anc.49
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 18:26:24 -0700 (PDT)
Received: by 10.100.123.4 with SMTP id v4mr7744840anc.107.1212110784586;
        Thu, 29 May 2008 18:26:24 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 1sm25191agb.30.2008.05.29.18.26.24
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 18:26:24 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com>
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <BB1B59B4-A420-4F3C-9D68-249742F79B93@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Thu, 29 May 2008 21:26:22 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Paul J. Lucas wrote:

> 	if ( IndexReader.isLocked( INDEX ) )
> 	    IndexReader.unlock( INDEX );
>
> The isLocked()/unlock() is because sometimes the server process  
> gets killed and leaves teh indexed locked.

This makes me a bit nervous.  Does this only run on startup of your  
process, or each time you need to open the IndexWriter?  Could you  
add some logging whenever an unlock is necessary so we can double- 
check that you're not accidentally un-locking the lock out from under  
an IndexWriter (which could cause exactly this exception)?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34242-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 01:36:22 2008
Return-Path: <java-user-return-34242-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20341 invoked from network); 30 May 2008 01:36:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 01:36:22 -0000
Received: (qmail 92241 invoked by uid 500); 30 May 2008 01:36:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92204 invoked by uid 500); 30 May 2008 01:36:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92193 invoked by uid 99); 30 May 2008 01:36:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 18:36:17 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [66.249.82.233] (HELO wx-out-0506.google.com) (66.249.82.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 01:35:28 +0000
Received: by wx-out-0506.google.com with SMTP id h29so2991562wxd.20
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 18:35:44 -0700 (PDT)
Received: by 10.70.71.9 with SMTP id t9mr1338905wxa.72.1212111344103;
        Thu, 29 May 2008 18:35:44 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id i35sm5107512wxd.20.2008.05.29.18.35.43
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 18:35:43 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <483F549D.3040405@gmail.com>
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Thu, 29 May 2008 21:35:41 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Michael Busch wrote:

> Of course it can happen that you run out of available file  
> descriptors when a lot of threads open separate IndexReaders, and  
> then the SegmentMerger could certainly hit IOExceptions, but I  
> don't think a FileNotFoundException would be thrown in such a case.

I think I've actually seen a FileNotFoundException thrown when the  
underlying root cause was file descriptor exhaustion, but I'm not  
certain.

Can you use lsof (or something similar) to see how many files you have?

Merging, especially several running at once, can greatly increase  
open file count, and especially if mergeFactor is increased.

>
> Paul, is Lucene the only process that modifies the index directory?
> Would it be possible for you to try out the current Lucene trunk  
> version and verify it the error persists? Maybe LUCENE-1044 fixes  
> this as it makes Lucene more robust in case of machine or OS  
> crashes. However, since in your case "only" the process gets killed  
> by the OS, it should still sync the files properly to disk without  
> 1044 I believe. What do you thing, Mike?

Right, kill -9 should never corrupt the index, and 1044 should not  
affect the "kill -9" case; it only fixes the risk of corruption on a  
non-graceful machine/os crash/power loss.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34243-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 01:42:13 2008
Return-Path: <java-user-return-34243-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21327 invoked from network); 30 May 2008 01:42:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 01:42:12 -0000
Received: (qmail 97951 invoked by uid 500); 30 May 2008 01:42:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97913 invoked by uid 500); 30 May 2008 01:42:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 88714 invoked by uid 99); 30 May 2008 01:33:38 -0000
X-ASF-Spam-Status: No, hits=3.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Message-Id: <2D46D159-9D30-48B1-A069-9DF9EE1B05F0@mac.com>
To: java-user@lucene.apache.org
In-Reply-To: <483F50F5.3050804@gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Thu, 29 May 2008 18:27:58 -0700
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com>
X-Mailer: Apple Mail (2.919.2)
From: "Paul J. Lucas" <paul@lightcrafts.com>
Sender: "Paul J. Lucas" <pjl@lightcrafts.com>
X-Virus-Checked: Checked by ClamAV on apache.org


On May 29, 2008, at 5:57 PM, Mark Miller wrote:

> Paul J. Lucas wrote:
>> Are you saying that using multiple IndexSearchers will definitely  
>> cause the problem I am experiencing and so the suggestion that  
>> using a single IndexSearcher for optimaztion only is wrong?

> Will it definitely cause your problem? I wouldn't say that. But it  
> could.

Then, to me, it seems like a bug in Lucene.  Code as straight-forward  
as mine is should not be able to get Lucene into a bad state.

> Also, yes I would say its wrong that you should only do it as an  
> optimization - unless you really know what you are doing.  
> Constructing a Searcher is slow (actually the underlying Reader),  
> and so you don't want to do it every time someone searches...it will  
> really slow you down.

My understanding of an IndexSearcher is that, once opened, it only  
"sees" an index as a snapshot in time at the time it was opened and,  
for subsequent deletes or adds to be "seen" by an IndexSearcher, you  
have to create a new one.

If that's true, then sharing an IndexSearcher for me wouldn't be a  
great performance increase since the directory structure changes  
frequently and so the index is modified frequently and so I'd be  
creating and opening a new IndexSearcher to replace the old (now  
"stale") shared one anyway.

It also complicates my code by a lot.  I actually had it this way once  
(and it did nothing to solve my current problem).  I had to derive  
from IndexSearcher, override close() so it would truly close only when  
the IndexSearcher becomes "stale" because the index changed.

> Also, if you get a ton of concurrent searches ...

But I never do.  My server is only ever accessed by exactly one (!)  
client.  Ever.  The lone client may issue several concurrent requests,  
but they do not rise to the level of a "ton".

>>> The only time I usually see this error, I also see too many files  
>>> open first. Are you sure you don't have another exception as well?
>>
>> Yes I'm sure there is no other exception.
> Ok...normally I recall them going together but that may not always  
> be the case. Basically, I can't guarantee you this is your  
> problem...but I do know its very possible. Some others on the list  
> may have other ideas too.

I can only hope.

- Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34244-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 01:42:48 2008
Return-Path: <java-user-return-34244-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21514 invoked from network); 30 May 2008 01:42:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 01:42:48 -0000
Received: (qmail 99589 invoked by uid 500); 30 May 2008 01:42:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99553 invoked by uid 500); 30 May 2008 01:42:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 91305 invoked by uid 99); 30 May 2008 01:35:06 -0000
X-ASF-Spam-Status: No, hits=3.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Message-Id: <2CCE7302-3011-4852-8741-811BEA516AA5@mac.com>
To: java-user@lucene.apache.org
In-Reply-To: <BB1B59B4-A420-4F3C-9D68-249742F79B93@mikemccandless.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Thu, 29 May 2008 18:33:08 -0700
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <BB1B59B4-A420-4F3C-9D68-249742F79B93@mikemccandless.com>
X-Mailer: Apple Mail (2.919.2)
From: "Paul J. Lucas" <paul@lightcrafts.com>
Sender: "Paul J. Lucas" <pjl@lightcrafts.com>
X-Virus-Checked: Checked by ClamAV on apache.org

On May 29, 2008, at 6:26 PM, Michael McCandless wrote:

> Paul J. Lucas wrote:
>
>> 	if ( IndexReader.isLocked( INDEX ) )
>> 	    IndexReader.unlock( INDEX );
>>
>> The isLocked()/unlock() is because sometimes the server process  
>> gets killed and leaves teh indexed locked.
>
> This makes me a bit nervous.  Does this only run on startup of your  
> process, or each time you need to open the IndexWriter?

Exactly once on start-up.

> Could you add some logging whenever an unlock is necessary so we can  
> double-check that you're not accidentally un-locking the lock out  
> from under an IndexWriter (which could cause exactly this exception)?

Such logging is not necessary since the unlock() is done before any  
IndexWriter is ever created.

- Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34245-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 01:52:18 2008
Return-Path: <java-user-return-34245-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23535 invoked from network); 30 May 2008 01:52:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 01:52:18 -0000
Received: (qmail 9597 invoked by uid 500); 30 May 2008 01:52:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9433 invoked by uid 500); 30 May 2008 01:52:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9421 invoked by uid 99); 30 May 2008 01:52:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 18:52:13 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 66.249.82.231 as permitted sender)
Received: from [66.249.82.231] (HELO wx-out-0506.google.com) (66.249.82.231)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 01:51:22 +0000
Received: by wx-out-0506.google.com with SMTP id h29so2995519wxd.20
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 18:51:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=xMUQE3r7sb6jp0wNSWpdf3CYpG6xf7oiKGNrx5iv6Qc=;
        b=pNg4Nl11HXX97SpgdD1Vl4jX5HsbfWQVIRyi8+Q/RCFFf+jq9PJT5/dfeVrEaTpGBWmBbutS4ThMN87Vgx/d2JA0exEkVu8WiZhvySd/r+2yHo6XiLZCFJ3hBdwiiNnL4T14AShRYk4DzZebP0EOp+QZDHxI/a04XccMkfT/dzE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=KwDWETGLVizHjpXFHRnTN2eDJ6c4di7jQnXy5pq15wfeB5AfsKTuzuQej3IJX5Sy9yXscMCIF5YSQ6CggmB38kwNsH6hW1MpfUzJdz9yUBfgo/DZIwvXDgpE/zEcBs8MPw71/cedbmp+KR5Kuq6Jec2iIEOtb0uVNOrItAkklOw=
Received: by 10.100.166.9 with SMTP id o9mr7799134ane.91.1212112298604;
        Thu, 29 May 2008 18:51:38 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id e18sm1787563qba.2.2008.05.29.18.51.31
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 18:51:31 -0700 (PDT)
Message-ID: <483F5DA3.9080004@gmail.com>
Date: Thu, 29 May 2008 21:51:31 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com> <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com>
In-Reply-To: <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Michael McCandless wrote:
>
> Michael Busch wrote:
>
>> Of course it can happen that you run out of available file 
>> descriptors when a lot of threads open separate IndexReaders, and 
>> then the SegmentMerger could certainly hit IOExceptions, but I don't 
>> think a FileNotFoundException would be thrown in such a case.
>
> I think I've actually seen a FileNotFoundException thrown when the 
> underlying root cause was file descriptor exhaustion, but I'm not 
> certain.
>
> Can you use lsof (or something similar) to see how many files you have?
>
> Merging, especially several running at once, can greatly increase open 
> file count, and especially if mergeFactor is increased.

I know you can see it when your out of file descriptors...I have many times.



 >>Then, to me, it seems like a bug in Lucene.  Code as straight-forward 
as mine is should not be able to get Lucene into a bad state.

Depends I guess. I think Micahael and Michael are going to say its a 
bug...I am going to say your shouldnt be creating that many readers. I 
guess we should support it, not much point in arguing that...but I am 
telling you, you should not be doing it that way. As you wish though :)

Here is a test that will throw that exception almost instantly on my 
computer:


public class TestIndexAccessor extends TestCase {

  protected static final int MERG_FACTOR = 15;
  static private FSDirectory index1;
  static private FSDirectory index2;


  private void deleteIndex(FSDirectory indexDir) throws IOException {
    File[] files = indexDir.getFile().listFiles();
    if (files != null) {
      for (int i = 0; i < files.length; i++) {
        if (!files[i].delete()) {
          throw new RuntimeException(files[i] + " could not be deleted !");
        }
      }
    }
    indexDir.getFile().delete();
  }


  static LockFactory lockFactory = new NoLockFactory();
  String tempDir = System.getProperty("java.io.tmpdir") + File.separator
      + "indexacessor";

  protected void setUp() throws Exception {
    System.out.println("setup");
    if (index1 != null) {
      deleteIndex(index1);
    }
    if (index2 != null) {
      deleteIndex(index2);
    }
    super.setUp();

    try {
      index1 = FSDirectory.getDirectory(new File(tempDir, "testindex"),
          lockFactory);
      index2 = FSDirectory.getDirectory(new File(tempDir, "testindex2"),
          lockFactory);

    } catch (IOException e) {
      throw new RuntimeException(e);
    }
  }


 
  public void testLotsOfAccess2() throws Exception {
    final Analyzer analyzer = new WhitespaceAnalyzer();


    IndexWriter writer =  new IndexWriter(index1, analyzer, 
MaxFieldLength.LIMITED);
    writer.close();
   
    index1 = FSDirectory.getDirectory(new File(tempDir, "testindex"),
        lockFactory);
    index2 = FSDirectory.getDirectory(new File(tempDir, "testindex2"),
        lockFactory);

 

      Thread[] searchThreads = new Thread[50];

      Thread[] updateThreads = new Thread[1];

      for (int i = 0; i < searchThreads.length; i++) {
        searchThreads[i] = new Thread() {

          public void run() {
           
      

            float times = 6600f;
            Searcher searcher = null;
            for (int i = 0; i < times; i++) {
              try {
                Thread.sleep(15);
                searcher = new IndexSearcher(index1);

                QueryParser qp = new QueryParser("field", new 
KeywordAnalyzer());
                Sort sort = new Sort(new SortField("srt"));
                searcher.search(qp.parse("test"), sort);
                sleep(1000);
              } catch (IOException e) {
                e.printStackTrace();
              } catch (ParseException e) {
                e.printStackTrace();
              } catch (InterruptedException e) {
                e.printStackTrace();
              } finally {
               try {
                  searcher.close();
                } catch (IOException e) {
                  // TODO Auto-generated catch block
                  e.printStackTrace();
                }
              }
            }

          }
        };
        searchThreads[i].setName("searchThread-" + i);
      }


      for (int i = 0; i < updateThreads.length; i++) {
        updateThreads[i] = new Thread() {

          public void run() {

            float times = 6600f;
            IndexWriter writer = null;

            for (int i = 0; i < times; i++) {
              try {
     
                writer =  new IndexWriter(index1, analyzer, 
MaxFieldLength.LIMITED);
                writer.setMergeFactor(MERG_FACTOR);
                Document doc = new Document();
                doc.add(new Field("field", "test", Store.NO, 
Index.TOKENIZED));
                doc.add(new Field("srt", Integer.toString(i), Store.YES,
                    Index.UN_TOKENIZED));
                writer.addDocument(doc);
              } catch (IOException e) {
                e.printStackTrace();
                throw new RuntimeException(e);
              } finally {
                if (writer != null) {
                  try {
                    writer.close();
                  } catch (CorruptIndexException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                  } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                  }
                }
              }
            }

          }
        };

        updateThreads[i].setName("updateThread-" + i);
      }


      for (int i = 0; i < updateThreads.length; i++) {
        System.out.println("starting update thread "
            + updateThreads[i].getName());
        updateThreads[i].start();
      }


      Thread.currentThread().sleep(4000);

      for (int i = 0; i < searchThreads.length; i++) {
        System.out.println("starting search thread "
            + searchThreads[i].getName());
        searchThreads[i].start();
      }


      Thread.sleep(8000);
    
      for (int i = 0; i < searchThreads.length; i++) {
        searchThreads[i].join();
      }


      for (int i = 0; i < updateThreads.length; i++) {
        updateThreads[i].join();
      }


      Thread.sleep(4000);
      deleteIndex(index1);
      deleteIndex(index2);
   
  }

}

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34246-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 01:59:24 2008
Return-Path: <java-user-return-34246-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24460 invoked from network); 30 May 2008 01:59:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 01:59:23 -0000
Received: (qmail 13889 invoked by uid 500); 30 May 2008 01:59:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13853 invoked by uid 500); 30 May 2008 01:59:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13842 invoked by uid 99); 30 May 2008 01:59:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 18:59:18 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.132.245 as permitted sender)
Received: from [209.85.132.245] (HELO an-out-0708.google.com) (209.85.132.245)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 01:58:30 +0000
Received: by an-out-0708.google.com with SMTP id c37so2774anc.49
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 18:58:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=ZGWdWyC3olWk6emIuSMp1TfLaK6Fa3ccY3GXtTXybNY=;
        b=FaNje+eAx3ZuN0jAo64K09ZIqSPgHHv7oXaBDL7Hp4U+MQ/ejQS0wpa8CIay3s/SDZrQy6BGrUpI1hLFRLF1Yq8gAVC2EcMAQe9h2WGTW2bFwyM77ZL+qh+U9pF+JIXtMFV0Kzk+FbdcTIQPET39CHpFwjff3sOTJaM+TRCg7xs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=dW76fubmZ4RURXmji0Vk4R9imq0rgcXlDmMxFnRdfMUkL4O5PaKshtdQhS51JbP8uH9QpoFiCpPKwgJVL0tb0ifgPiaFMojzn45vsko12vYS1D4c8mjsjOSZ45rYlHH+GKfXaQ2gwx7Fpdq+PLkkYOLghuta6rFirPuqg9oXmFs=
Received: by 10.100.190.14 with SMTP id n14mr7761964anf.98.1212112726964;
        Thu, 29 May 2008 18:58:46 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id q14sm1763417qbq.29.2008.05.29.18.58.45
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 29 May 2008 18:58:46 -0700 (PDT)
Message-ID: <483F5F53.1050109@gmail.com>
Date: Thu, 29 May 2008 21:58:43 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com> <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com> <483F5DA3.9080004@gmail.com>
In-Reply-To: <483F5DA3.9080004@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Forgot to mention...keep trying if you get read past file exception...I 
get that sometimes too.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34247-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 02:54:44 2008
Return-Path: <java-user-return-34247-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36646 invoked from network); 30 May 2008 02:54:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 02:54:43 -0000
Received: (qmail 48812 invoked by uid 500); 30 May 2008 02:54:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48782 invoked by uid 500); 30 May 2008 02:54:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48771 invoked by uid 99); 30 May 2008 02:54:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 19:54:38 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [17.148.16.64] (HELO smtpoutm.mac.com) (17.148.16.64)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 02:53:50 +0000
Received: from asmtp012-bge351000 (asmtp012-bge351000 [10.150.69.75])
	by smtpoutm.mac.com (Xserve/smtpout001/MantshX 4.0) with ESMTP id m4U2s609019932
	for <java-user@lucene.apache.org>; Thu, 29 May 2008 19:54:07 -0700 (PDT)
MIME-version: 1.0
Content-transfer-encoding: 7BIT
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Received: from [192.168.1.232]
 (c-98-210-152-178.hsd1.ca.comcast.net [98.210.152.178])
 by asmtp012.mac.com (Sun Java(tm) System Messaging Server 6.3-6.03 (built Mar
 14 2008; 32bit)) with ESMTPSA id <0K1N000RZUQ6KW00@asmtp012.mac.com> for
 java-user@lucene.apache.org; Thu, 29 May 2008 19:54:06 -0700 (PDT)
Message-id: <CAC3FF9B-FBCA-424D-97DA-C022DE0B01F7@mac.com>
From: "Paul J. Lucas" <pauljlucas@mac.com>
To: java-user@lucene.apache.org
In-reply-to: <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Thu, 29 May 2008 19:54:05 -0700
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com>
 <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com>
 <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com>
 <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com>
X-Mailer: Apple Mail (2.924)
X-Virus-Checked: Checked by ClamAV on apache.org

On May 29, 2008, at 6:35 PM, Michael McCandless wrote:

> Can you use lsof (or something similar) to see how many files you  
> have?

FYI: I personally can't reproduce this; only a coworker can and even  
then it's sporadic, so it could take a little while.

> Merging, especially several running at once, can greatly increase  
> open file count, and especially if mergeFactor is increased.

That raises a few questions:

1. Should I lower my mergeFactor?

2. Is there any way to insist that only one merger runs?

3. Is there any way to insist that all merges happen synchronously,  
i.e., on IndexWriter.close() only and not to use a separate merge  
thread?

- Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34248-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 03:39:48 2008
Return-Path: <java-user-return-34248-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54551 invoked from network); 30 May 2008 03:39:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 03:39:48 -0000
Received: (qmail 74654 invoked by uid 500); 30 May 2008 03:39:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74619 invoked by uid 500); 30 May 2008 03:39:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74608 invoked by uid 99); 30 May 2008 03:39:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 May 2008 20:39:42 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 72.14.220.158 as permitted sender)
Received: from [72.14.220.158] (HELO fg-out-1718.google.com) (72.14.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 03:38:50 +0000
Received: by fg-out-1718.google.com with SMTP id l27so29038fgb.27
        for <java-user@lucene.apache.org>; Thu, 29 May 2008 20:39:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=NneRsKTDnSQfjuVJShP86A2Z6TBV5HiQoh0jC+ViSyw=;
        b=ITj3j4gsgSI+mIlBhYwUnhzOd/Vd4rW/MQZm5c81PzrTEY/PxvsbPDFuw+x8rKyjKBbdCaXjVQYLck4cYm9QOeMBUikJ7kZGteEe06k++jgRvbTKJ25UzVOOtMhSdFWlaAkHnMs4UN7y3w5mKj+6rW1HulRFmhSX+bozX5l6jlM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=wswEbH1SdDNyakKdwvMQEZGgWeaHrelfAM6ypM85PNjXvUCuThKM/vHOCx9XpZrPUY7SdpaG4+pHgwjrzTG3upSHA2IiBx1QjHgceZ/9DLkiWsGea6iMrTuDvohnddwDeoiO8N23UDOfbAUEE6lubWzMX3jGmyETsxlpQ2lpt4Q=
Received: by 10.82.191.3 with SMTP id o3mr345029buf.17.1212118744784;
        Thu, 29 May 2008 20:39:04 -0700 (PDT)
Received: by 10.82.135.16 with HTTP; Thu, 29 May 2008 20:39:04 -0700 (PDT)
Message-ID: <8837fb770805292039o661e15bfs860d6fca550619f5@mail.gmail.com>
Date: Thu, 29 May 2008 20:39:04 -0700
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: IndexReader.reopen memory leak
In-Reply-To: <483EE805.3090500@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_18863_1307302.1212118744771"
References: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com>
	 <483DD50C.3080908@gmail.com> <483DE95C.9030501@gmail.com>
	 <8837fb770805282125w5f3d7101i4b42b0c55edd3a5a@mail.gmail.com>
	 <483E5CD9.8080005@gmail.com>
	 <8837fb770805290941p3ae6dff1g1be9f2222cc49bbf@mail.gmail.com>
	 <483EE805.3090500@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_18863_1307302.1212118744771
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

My client does not call my reader.reopen(), I have implemented a reload()
method off of my reader (void reload()), and it discards the internal reader
upon a reload. Due to another issue (an api issue with IndexReader, e.g. all
derived implementations have to reimplement reopen because it has to return
its instance even if there is nothing specific to do, kinda defeats the
purpose of object overriding)

Anyway, my system only calls myReader.reload() everytime the index "flips"
Re Mark's comment, does your test do both indexing and searching during the
duration of your run? How big is your index?

Thanks

-John

On Thu, May 29, 2008 at 10:29 AM, Michael Busch <buschmic@gmail.com> wrote:

> Does your FilteredIndexReader.reopen() return a new instance of
> FilteredIndexReader in case the inner reader was updated (i. e.
> in!=newInner)?
>
>
> -Michael
>
>
> John Wang wrote:
>
>> Yes:
>>
>> IndexReader newInner=in.reopen();
>>      if (in!=newInner)
>>      {
>>        in.close();
>>        this.in=newInner;
>>
>>        // code to clean up my data
>>        _cache.clear();
>>        _indexData.load(this, true);
>>        init(_fieldConfig);
>>      }
>>
>> if I change this code to:
>> try
>>      {
>>        this.in.close();     force close
>>      }
>>      catch(Exception e)
>>      {
>>        logger.warn(e.getMessage());
>>      }
>>      finally
>>      {
>>        this.in=newReader(); <-- new instance of IndexReader
>>        _cache.clear();
>>        _indexData.load(this, true);
>>        init(_fieldConfig);
>>      }
>>
>> fixes my leak.
>>
>> -John
>>
>> On Thu, May 29, 2008 at 12:35 AM, Michael Busch <buschmic@gmail.com>
>> wrote:
>>
>>  Could you share some details about how you implemented reopen() in your
>>> reader?
>>>
>>> -Michael
>>>
>>>
>>> John Wang wrote:
>>>
>>>  Yes, I do close the old reader.
>>>> I have a large index, my system is doing real time updates: 1 thread
>>>> writing
>>>> batches of updates to the index, after each index update, it updates the
>>>> reader. I have two readers open always, one is serving the search
>>>> requests,
>>>> while the other updates and the two flips. Reader update implies index
>>>> reopen here.
>>>>
>>>> I am using my implementation of a FilteredIndexReader.
>>>>
>>>> Index leaks very slowly, but obvious.
>>>>
>>>> No, I am not able to provide heap dumps.
>>>>
>>>> -John
>>>>
>>>> On Wed, May 28, 2008 at 4:23 PM, Mark Miller <markrmiller@gmail.com>
>>>> wrote:
>>>>
>>>>  As someone that has done a lot of reopens, I can vouch there is no leak
>>>>
>>>>> under simple, normal usage. Are you sure your closing the original
>>>>> reader
>>>>> after getting the reopened reference?
>>>>>
>>>>>
>>>>> Michael Busch wrote:
>>>>>
>>>>>  Hi John,
>>>>>
>>>>>> hmm not good. I will take a look. It has probably to do with the
>>>>>> reference
>>>>>> counting. Are you doing anything special? E. g. do you have own reader
>>>>>> implementations that you call reopen() on? What kinds of readers are
>>>>>> you
>>>>>> using?
>>>>>>
>>>>>> Are you maybe able to provide a heapdump?
>>>>>>
>>>>>> -Michael
>>>>>>
>>>>>> John Wang wrote:
>>>>>>
>>>>>>  Hi:
>>>>>>
>>>>>>>  We are experiencing memory leak with calling IndexReader.reopen().
>>>>>>>
>>>>>>>  From eyeballing the lucene source code, I am seeing normCache is not
>>>>>>> cleared.
>>>>>>>
>>>>>>>
>>>>>>>  Anyone else experiencing this?
>>>>>>>
>>>>>>> Thanks
>>>>>>>
>>>>>>> -John
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>  ---------------------------------------------------------------------
>>>>>>>
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>>>  ---------------------------------------------------------------------
>>>>>>
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>>
>>>>>  ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_18863_1307302.1212118744771--

From java-user-return-34249-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 07:35:55 2008
Return-Path: <java-user-return-34249-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17034 invoked from network); 30 May 2008 07:35:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 07:35:55 -0000
Received: (qmail 50090 invoked by uid 500); 30 May 2008 07:35:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50019 invoked by uid 500); 30 May 2008 07:35:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50006 invoked by uid 99); 30 May 2008 07:35:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 00:35:50 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [196.25.240.81] (HELO ctb-mesg-1-3.saix.net) (196.25.240.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 07:34:59 +0000
Received: from [192.168.0.3] (dsl-243-225-120.telkomadsl.co.za [41.243.225.120])
	by ctb-mesg-1-3.saix.net (Postfix) with ESMTP id 64CE922E20
	for <java-user@lucene.apache.org>; Fri, 30 May 2008 09:35:07 +0200 (SAST)
Message-ID: <483FAE29.60409@stimulussoft.com>
Date: Fri, 30 May 2008 09:35:05 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com> <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com> <CAC3FF9B-FBCA-424D-97DA-C022DE0B01F7@mac.com>
In-Reply-To: <CAC3FF9B-FBCA-424D-97DA-C022DE0B01F7@mac.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Paul,

I just noticed the discussion around this.

All most all of my customers have/are experiencing the intermittant 
FileNotFound problem.

Our software uses Lucene 2.3.1. I have just upgraded to Lucene 2.3.2 in 
the hope that this was one of the bugs that was fixed.

I would be very interested in a resolution or known workaround.

Thanks!

Jamie


Paul J. Lucas wrote:
> On May 29, 2008, at 6:35 PM, Michael McCandless wrote:
>
>> Can you use lsof (or something similar) to see how many files you have?
>
> FYI: I personally can't reproduce this; only a coworker can and even 
> then it's sporadic, so it could take a little while.
>
>> Merging, especially several running at once, can greatly increase 
>> open file count, and especially if mergeFactor is increased.
>
> That raises a few questions:
>
> 1. Should I lower my mergeFactor?
>
> 2. Is there any way to insist that only one merger runs?
>
> 3. Is there any way to insist that all merges happen synchronously, 
> i.e., on IndexWriter.close() only and not to use a separate merge thread?
>
> - Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


-- 
Stimulus Software - MailArchiva
Email Archiving And Compliance
USA Tel: +1-713-366-8072 ext 3
UK Tel: +44-20-80991035 ext 3
Email: jamie@stimulussoft.com
Web: http://www.mailarchiva.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34250-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 09:48:47 2008
Return-Path: <java-user-return-34250-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62567 invoked from network); 30 May 2008 09:48:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 09:48:46 -0000
Received: (qmail 36345 invoked by uid 500); 30 May 2008 09:48:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36303 invoked by uid 500); 30 May 2008 09:48:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36292 invoked by uid 99); 30 May 2008 09:48:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 02:48:41 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [66.249.82.225] (HELO wx-out-0506.google.com) (66.249.82.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 09:47:51 +0000
Received: by wx-out-0506.google.com with SMTP id h29so3109559wxd.20
        for <java-user@lucene.apache.org>; Fri, 30 May 2008 02:48:05 -0700 (PDT)
Received: by 10.70.75.20 with SMTP id x20mr6251215wxa.29.1212140884391;
        Fri, 30 May 2008 02:48:04 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id i40sm6611722wxd.29.2008.05.30.02.48.03
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 30 May 2008 02:48:04 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <483FAE29.60409@stimulussoft.com>
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com> <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com> <CAC3FF9B-FBCA-424D-97DA-C022DE0B01F7@mac.com> <483FAE29.60409@stimulussoft.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <1236018C-25F6-4E40-A9AC-4091EC9B3DCA@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Fri, 30 May 2008 05:48:03 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Jamie,

I'd love to get to the root cause of your exception.

Last time we talked (a few weeks back) I saw several possible causes  
in the source you had posted:

     http://markmail.org/message/dqovvcwgwof5f7wl

Did you test any of the ideas there?  You are potentially manually  
deleting files from the index, and also forcibly removing the  
write.lock, which can easily cause this exception.

Mike

Jamie wrote:

> Hi Paul,
>
> I just noticed the discussion around this.
>
> All most all of my customers have/are experiencing the intermittant  
> FileNotFound problem.
>
> Our software uses Lucene 2.3.1. I have just upgraded to Lucene  
> 2.3.2 in the hope that this was one of the bugs that was fixed.
>
> I would be very interested in a resolution or known workaround.
>
> Thanks!
>
> Jamie
>
>
> Paul J. Lucas wrote:
>> On May 29, 2008, at 6:35 PM, Michael McCandless wrote:
>>
>>> Can you use lsof (or something similar) to see how many files you  
>>> have?
>>
>> FYI: I personally can't reproduce this; only a coworker can and  
>> even then it's sporadic, so it could take a little while.
>>
>>> Merging, especially several running at once, can greatly increase  
>>> open file count, and especially if mergeFactor is increased.
>>
>> That raises a few questions:
>>
>> 1. Should I lower my mergeFactor?
>>
>> 2. Is there any way to insist that only one merger runs?
>>
>> 3. Is there any way to insist that all merges happen  
>> synchronously, i.e., on IndexWriter.close() only and not to use a  
>> separate merge thread?
>>
>> - Paul
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> -- 
> Stimulus Software - MailArchiva
> Email Archiving And Compliance
> USA Tel: +1-713-366-8072 ext 3
> UK Tel: +44-20-80991035 ext 3
> Email: jamie@stimulussoft.com
> Web: http://www.mailarchiva.com
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34251-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 10:00:32 2008
Return-Path: <java-user-return-34251-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67560 invoked from network); 30 May 2008 10:00:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 10:00:32 -0000
Received: (qmail 55288 invoked by uid 500); 30 May 2008 10:00:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55256 invoked by uid 500); 30 May 2008 10:00:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55245 invoked by uid 99); 30 May 2008 10:00:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 03:00:27 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.233.178.250] (HELO hs-out-0708.google.com) (64.233.178.250)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 09:59:38 +0000
Received: by hs-out-0708.google.com with SMTP id 4so2663333hsl.5
        for <java-user@lucene.apache.org>; Fri, 30 May 2008 02:59:52 -0700 (PDT)
Received: by 10.90.27.5 with SMTP id a5mr5699098aga.85.1212141592374;
        Fri, 30 May 2008 02:59:52 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 32sm474899aga.17.2008.05.30.02.59.51
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 30 May 2008 02:59:52 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <CAC3FF9B-FBCA-424D-97DA-C022DE0B01F7@mac.com>
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com> <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com> <CAC3FF9B-FBCA-424D-97DA-C022DE0B01F7@mac.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <EA6F5635-68E8-4213-89CB-C68CCAB326CB@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Fri, 30 May 2008 05:59:51 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Paul J. Lucas wrote:

> On May 29, 2008, at 6:35 PM, Michael McCandless wrote:
>
>> Can you use lsof (or something similar) to see how many files you  
>> have?
>
> FYI: I personally can't reproduce this; only a coworker can and  
> even then it's sporadic, so it could take a little while.

If possible, could you call IndexWriter.setInfoStream(...) and  
capture the log produced leading up to the exception?  It could help  
see if there is a bug here, by showing whether IndexWriter actually  
deleted that file or not.

>> Merging, especially several running at once, can greatly increase  
>> open file count, and especially if mergeFactor is increased.
>
> That raises a few questions:
>
> 1. Should I lower my mergeFactor?

What is your mergeFactor set to now?

You can lower mergeFactor, but, if file exhaustion is the cause here,  
it simply may not be enough.

> 2. Is there any way to insist that only one merger runs?

Yes, you can do this:

   ConcurrentMergeScheduler cms = (ConcurrentMergeScheduler)  
writer.getMergeScheduler();
   cms.setMaxThreadCount(1)

This way only one BG merge may run.  The next one that wants to kick  
off will stall until the first one is done.

>
> 3. Is there any way to insist that all merges happen synchronously,  
> i.e., on IndexWriter.close() only and not to use a separate merge  
> thread?

You can fallback to SerialMergeScheduler, which matches the behavior  
pre-2.3.  In this case a merge kicks off, synchronously, in an add/ 
updateDocument call after flushing a segment.

Doing so only at close() is trickier.  Maybe, you could 1) use  
SerialMergeScheduler, 2) set mergeFactor to something immense (to  
prevent merging on a normal basis), 3) when you want to merge, set  
mergeFactor to something normal (eg the default, 10) and then call  
writer.maybeMerge().  Then call close().

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34252-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 10:06:17 2008
Return-Path: <java-user-return-34252-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68799 invoked from network); 30 May 2008 10:06:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 10:06:16 -0000
Received: (qmail 61850 invoked by uid 500); 30 May 2008 10:06:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61676 invoked by uid 500); 30 May 2008 10:06:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61665 invoked by uid 99); 30 May 2008 10:06:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 03:06:10 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [74.125.46.30] (HELO yw-out-2324.google.com) (74.125.46.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 10:05:21 +0000
Received: by yw-out-2324.google.com with SMTP id 3so2070904ywj.5
        for <java-user@lucene.apache.org>; Fri, 30 May 2008 03:05:27 -0700 (PDT)
Received: by 10.151.114.6 with SMTP id r6mr2158977ybm.153.1212141926835;
        Fri, 30 May 2008 03:05:26 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id h15sm2585426wxd.38.2008.05.30.03.05.26
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 30 May 2008 03:05:26 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com>
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <DFB61D68-7CE4-4E22-AA2C-33B158C443A4@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Fri, 30 May 2008 06:05:25 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


A few more questions, below:

Paul J. Lucas wrote:

> I have a thread than handles the unindexing/reindexing.  It gets  
> changed from a BlockingQueue.  My unindex code is like:
>
> 	IndexWriter writer = new IndexWriter( INDEX, INDEX_ANALYZER, false );
> 	final Term t = new Term( DIR_FIELD, dir.getAbsolutePath() );
> 	writer.deleteDocuments( t );
> 	writer.close();
>
> My indexing code is like:
>
> 	IndexWriter writer = new IndexWriter( INDEX, INDEX_ANALYZER );
> 	writer.setMergeFactor( INDEX_MERGE_FACTOR );
> 	Document doc = new Document();
> 	// ... add fields to doc ...
> 	writer.addDocument( doc );
> 	writer.close();

Are you indexing only one document each time you open IndexWriter?   
Or do you open a single IndexWriter, add all documents for that  
directory, then close it?  (Or, maybe there is only one document per  
directory?)

> While that thread is executing, other threads can search the index  
> by doing:
>
> 	IndexSearcher searcher = new IndexSearcher( INDEX );
> 	// ... prepare Query and Sort ...
> 	Hits hits = searcher.search( query, sort );
> 	Iterator hitIterator  hits.iterator();
> 	// ... iterate over hitIterator ...
> 	searcher.close();

When the exception occurs, do you know how many simultaneous threads  
are doing searching?  I realize you said it's extremely light load,  
but if it's possibly a good number of threads, and combined with a  
large mergeFactor, that would explain the exhaustion.

Do you know what your descriptor limit actually is?  You can use this  
simple JUnit test (from the upcoming Lucene in Action revision) to  
check:

public class TestOpenFileLimit extends LuceneTestCase {
   public void testLimit() throws IOException {
     int count = 0;
     List files = new ArrayList();
     try {
       while(true) {
         files.add(new RandomAccessFile("tmp" + count, "rw"));
         count++;
       }
     } catch (IOException ioe) {
       System.out.println("IOException after  " + count + " open  
files:");
       ioe.printStackTrace(System.out);
       for(int i=0;i<count;i++)
         new File("tmp" + i).delete();
     }
   }
}

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34253-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 10:27:56 2008
Return-Path: <java-user-return-34253-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75505 invoked from network); 30 May 2008 10:27:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 10:27:56 -0000
Received: (qmail 94544 invoked by uid 500); 30 May 2008 10:27:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94399 invoked by uid 500); 30 May 2008 10:27:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94342 invoked by uid 99); 30 May 2008 10:27:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 03:27:40 -0700
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=SPF_NEUTRAL,URIBL_BLACK
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [196.25.240.81] (HELO ctb-mesg-1-3.saix.net) (196.25.240.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 10:26:50 +0000
Received: from [192.168.0.3] (dsl-243-225-120.telkomadsl.co.za [41.243.225.120])
	by ctb-mesg-1-3.saix.net (Postfix) with ESMTP id 847012B610
	for <java-user@lucene.apache.org>; Fri, 30 May 2008 12:26:58 +0200 (SAST)
Message-ID: <483FD66F.9010001@stimulussoft.com>
Date: Fri, 30 May 2008 12:26:55 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com> <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com> <CAC3FF9B-FBCA-424D-97DA-C022DE0B01F7@mac.com> <483FAE29.60409@stimulussoft.com> <1236018C-25F6-4E40-A9AC-4091EC9B3DCA@mikemccandless.com>
In-Reply-To: <1236018C-25F6-4E40-A9AC-4091EC9B3DCA@mikemccandless.com>
Content-Type: multipart/mixed;
 boundary="------------010803010103000406030305"
X-Virus-Checked: Checked by ClamAV on apache.org

--------------010803010103000406030305
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hi Michael

Thank you. Your suggestions were great and they were implemented (see 
attached source code), however, unfortunately, I am still getting file 
not found errors on the automatic merging of indexes.

Regards,

Jamie


Michael McCandless wrote:
>
> Jamie,
>
> I'd love to get to the root cause of your exception.
>
> Last time we talked (a few weeks back) I saw several possible causes 
> in the source you had posted:
>
>     http://markmail.org/message/dqovvcwgwof5f7wl
>
> Did you test any of the ideas there?  You are potentially manually 
> deleting files from the index, and also forcibly removing the 
> write.lock, which can easily cause this exception.
>
> Mike
>
> Jamie wrote:
>
>> Hi Paul,
>>
>> I just noticed the discussion around this.
>>
>> All most all of my customers have/are experiencing the intermittant 
>> FileNotFound problem.
>>
>> Our software uses Lucene 2.3.1. I have just upgraded to Lucene 2.3.2 
>> in the hope that this was one of the bugs that was fixed.
>>
>> I would be very interested in a resolution or known workaround.
>>
>> Thanks!
>>
>> Jamie
>>
>>
>> Paul J. Lucas wrote:
>>> On May 29, 2008, at 6:35 PM, Michael McCandless wrote:
>>>
>>>> Can you use lsof (or something similar) to see how many files you 
>>>> have?
>>>
>>> FYI: I personally can't reproduce this; only a coworker can and even 
>>> then it's sporadic, so it could take a little while.
>>>
>>>> Merging, especially several running at once, can greatly increase 
>>>> open file count, and especially if mergeFactor is increased.
>>>
>>> That raises a few questions:
>>>
>>> 1. Should I lower my mergeFactor?
>>>
>>> 2. Is there any way to insist that only one merger runs?
>>>
>>> 3. Is there any way to insist that all merges happen synchronously, 
>>> i.e., on IndexWriter.close() only and not to use a separate merge 
>>> thread?
>>>
>>> - Paul
>>>


--------------010803010103000406030305
Content-Type: text/plain;
 name="MessageIndex.java"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="MessageIndex.java"

package com.stimulus.archiva.index;

/* Copyright (C) 2005-2007 Jamie Angus Band 
 * MailArchiva Open Source Edition Copyright (c) 2005-2007 Jamie Angus Band
 * This program is free software; you can redistribute it and/or modify it under the terms of
 * the GNU General Public License as published by the Free Software Foundation; either version
 * 2 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program;
 * if not, see http://www.gnu.org/licenses or write to the Free Software Foundation,Inc., 51
 * Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA
 */


import javax.mail.*;
import javax.mail.internet.*;
import java.io.*;
import java.util.*;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;
import java.util.zip.*;
import com.ice.tar.*;
import org.apache.log4j.Logger;
import org.apache.lucene.document.*;
import org.apache.lucene.index.*;
import org.apache.lucene.store.*;
import com.stimulus.archiva.domain.*;
import com.stimulus.archiva.exception.*;
import com.stimulus.archiva.language.*;
import com.stimulus.archiva.extraction.*;
import com.stimulus.archiva.search.*;
import com.stimulus.util.TempFiles;
import com.stimulus.archiva.domain.Service.Status;
import com.stimulus.archiva.domain.fields.*;
import com.stimulus.util.*;
import java.nio.charset.Charset;
import org.apache.log4j.Level;

public class MessageIndex extends Indexer implements Serializable {

	private static final long serialVersionUID = -17692874371162272L;
	protected static final Logger logger = Logger.getLogger(MessageIndex.class.getName());
	protected static int INDEX_WAIT_PERIOD = 50;
	protected static int DEAD_PERIOD = 300000000;
	static Hashtable<Volume,VolumeIndex> volumeIndexes = new Hashtable<Volume,VolumeIndex>();
	static Object volumeIndexLock = new Object();
	protected ServiceDelegate serviceDelegate;
		 
	 public MessageIndex() {
		 serviceDelegate = new ServiceDelegate("message index", this, logger);
	 }
	 public String getServiceName() {
		 return serviceDelegate.getServiceName();
	 }
	
	 public boolean isAlive() {
		 return serviceDelegate.isAlive(true);
	}
	
	 public void startup() {
		 for (VolumeIndex volumeIndex : volumeIndexes.values()) {
			 volumeIndex.startup();
		 }
		 serviceDelegate.startup();
	 }
	
	 public void prepareShutdown() {
		 serviceDelegate.prepareShutdown();
	 }
	 
	 public void shutdown() {
		 for (VolumeIndex volumeIndex : volumeIndexes.values()) {
			 volumeIndex.shutdown();
		 }
		 serviceDelegate.shutdown();
	 }
	 
	 public void reloadConfig() {
		 serviceDelegate.reloadConfig();
	 }

	public Status getStatus() {
		return serviceDelegate.getStatus();
	}
	 
	public void deleteIndex(Volume volume) throws MessageSearchException {
		  VolumeIndex volumeIndex = getVolumeIndex(volume);
		  volumeIndex.deleteIndex();
	}
		 
 	
	public VolumeIndex getVolumeIndex(Volume volume) {
		 VolumeIndex volumeIndex = null;
		  synchronized (volumeIndexLock) {
			  volumeIndex = volumeIndexes.get(volume);
			  if (volumeIndex==null) {
				  volumeIndex = new VolumeIndex(this,volume);
				  volumeIndexes.put(volume,volumeIndex);
			  }
		  }
		  return volumeIndex;
	}
	  	
	public void indexMessage(Email email) throws MessageSearchException {
		if (serviceDelegate.getStatus()!=Status.STARTED) {
			return;
		}
		VolumeIndex volumeIndex = getVolumeIndex(email.getEmailId().getVolume());
		volumeIndex.indexMessage(email);
	}
		
		
	public void deleteMessage(EmailID emailID) throws MessageSearchException {
		  VolumeIndex volumeIndex = getVolumeIndex(emailID.getVolume());
		  volumeIndex.deleteMessage(emailID);
	}
	  
	public void prepareIndex(Volume volume) throws MessageSearchException {
			
		  if (volume==null)
		            throw new MessageSearchException("assertion failure: null volume",logger);
	
	  if (volume.getIndexPath().startsWith("rmi://"))
			  return;
			  
	  File indexDir = new File(volume.getIndexPath());
	  if (!indexDir.exists()) {
		logger.info("index directory does not exist. will proceed with creation {location='" + volume.getIndexPath() + "'}");
		boolean success = indexDir.mkdir();
		if (!success)
				throw new MessageSearchException("failed to create index directory {location='" + volume.getIndexPath() + "'}",logger);
		logger.info("index directory successfully created {location='" + volume.getIndexPath() + "'}");
		  }
	
	}
	  


}


--------------010803010103000406030305
Content-Type: text/plain;
 name="VolumeIndex.java"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="VolumeIndex.java"

package com.stimulus.archiva.index;

import java.io.File;
import java.io.IOException;
import java.io.PrintStream;
import javax.mail.MessagingException;
import org.apache.log4j.Level;
import org.apache.log4j.Logger;
import org.apache.lucene.document.Document;
import org.apache.lucene.index.*;
import org.apache.lucene.store.FSDirectory;
import com.stimulus.archiva.domain.Config;
import com.stimulus.archiva.domain.Email;
import com.stimulus.archiva.domain.EmailID;
import com.stimulus.archiva.domain.Indexer;
import com.stimulus.archiva.domain.Volume;
import com.stimulus.archiva.exception.ExtractionException;
import com.stimulus.archiva.exception.MessageSearchException;
import com.stimulus.archiva.language.AnalyzerFactory;
import com.stimulus.archiva.search.*;
import java.util.*;
import org.apache.lucene.store.AlreadyClosedException;

public class VolumeIndex extends Thread {
	
		 protected static final Logger logger = Logger.getLogger(VolumeIndex.class.getName());
		 public static final int indexOpenTime = 2000;
	   	 IndexWriter writer = null;
	   	 Volume volume;
	   	 Timer closeIndexTimer = new Timer();
		 Object indexLock = new Object();
		 ArchivaAnalyzer analyzer 	= new ArchivaAnalyzer();
		 Indexer indexer = null;
		 
	  	  public VolumeIndex(Indexer indexer, Volume volume) {
	  		  	this.volume = volume;
	  		  	this.indexer = indexer;
	  		  	startup();
	  	  }
		
		public void deleteMessage(EmailID emailID) throws MessageSearchException {
			  if (emailID == null)
		            throw new MessageSearchException("assertion failure: null emailID",logger);
		  logger.debug("delete message {'"+emailID+"'}");
		  Volume volume = emailID.getVolume();
		  File indexDir = new File(volume.getIndexPath());
		  if (!indexDir.exists())
			  throw new MessageSearchException("could not delete email from index. volume does not exist. {'"+emailID+"}",logger);
		  synchronized(indexLock) {
			  IndexReader indexReader = null;
			  try {
				  indexReader = IndexReader.open(indexDir);
			  } catch (IOException e ) {
				  throw new MessageSearchException("failed to open index to delete email",e,logger);
			  }
			  try {
				  indexReader.deleteDocuments(new Term("uid",emailID.getUniqueID()));
				  indexReader.close();
			  } catch (Exception e) {
				  throw new MessageSearchException("failed to delete email from index.",e,logger);
			  }
		  }
		}
		
		  protected void openIndex() throws MessageSearchException {
			 Exception lastError = null;
			 synchronized(indexLock) {
		    	if (writer==null) {
		    		logger.debug("openIndex() index will be opened. it is currently closed.");
		    	} else {
		    		logger.debug("openIndex() did not bother opening index. it is already open.");
		    		return; 
		    	}

				logger.debug("opening index for write {"+volume+"}");
				indexer.prepareIndex(volume);
				logger.debug("opening search index for write {indexpath='"+volume.getIndexPath()+"'}");
				boolean error = false;
				int attempt = 0;
				do {
					try {
							writer = new IndexWriter(FSDirectory.getDirectory(volume.getIndexPath()),false, analyzer);
							writer.setMaxFieldLength(50000);
							if (logger.isDebugEnabled()) {
								File file = new File(Config.getFileSystem().getLogPath()+File.separator+"index.log");
								PrintStream debugout = new PrintStream(file);
								writer.setInfoStream(debugout);
							}
					} catch (IOException io) {
						lastError = io;
						if (Config.getConfig().getIndex().getMultipleIndexProcesses()) {
							logger.debug("write lock on index. will reopen in 50ms.");
							try { Thread.sleep(50); } catch (Exception e) {}
							error = true;
							attempt++;
						} else {
							 throw new MessageSearchException("failed to open index writer. you must delete the file write.lock in your the directory. {location='"+volume.getIndexPath()+"'}",lastError,logger);
						}
					}
					
			   } while (error && attempt>1000);
			   if (attempt>=1000 || error)
				 throw new MessageSearchException("failed to open index writer {location='"+volume.getIndexPath()+"'}",lastError,logger);
			}
		}
		
		public void indexMessage(Email message) throws MessageSearchException  {
      
			long s = (new Date()).getTime();
			if (message == null)
			    throw new MessageSearchException("assertion failure: null message",logger);
			logger.debug("indexing message {"+message+"}");
			
			Document doc = new Document();
			try {
			 
			   DocumentIndex docIndex = new DocumentIndex(indexer);
			   docIndex.write(message,doc);  
			   String language = doc.get("lang");
			   if (language==null)
				   language = indexer.getIndexLanguage();
		   		synchronized (indexLock) {
		   			openIndex();
		   			writer.addDocument(doc,AnalyzerFactory.getAnalyzer(language,AnalyzerFactory.Operation.INDEX));
		   			writer.flush();
		   		}
		   		doc = null;
			   logger.debug("message indexed successfully {"+message+",language='"+language+"'}");
			} catch (MessagingException me)
			{
			   throw new MessageSearchException("failed to decode message during indexing",me,logger, Level.DEBUG);
			} catch (IOException me) {
			    throw new MessageSearchException("failed to index message {"+message+"}",me,logger, Level.DEBUG);
			} catch (ExtractionException ee)
			{
				// we will want to continue indexing
			   //throw new MessageSearchException("failed to decode attachments in message {"+message+"}",ee,logger, Level.DEBUG);
			} catch (AlreadyClosedException ace) {
				indexMessage(message);
			} catch (Exception e) {
			    throw new MessageSearchException("failed to index message",e,logger, Level.DEBUG);
			}
			logger.debug("indexing message end {"+message+"}");
			
			long e = (new Date()).getTime();
		    logger.debug("indexing time {time='"+(e-s)+"'}");
		}
			
		protected void closeIndex() {
		
			   synchronized(indexLock) {
			        if (writer==null)
			        		return;
			        try {
			        	writer.close();
					    logger.debug("writer closed");
					} catch (Exception io) {
						logger.error("failed to close index writer:"+io.getMessage(),io);
	
					}
			        writer = null;
			   	}
	   	}
	
		  public void deleteIndex() throws MessageSearchException {
			  logger.debug("delete index {indexpath='"+volume.getIndexPath()+"'}");
			 
				try {
					  writer = new IndexWriter(FSDirectory.getDirectory(volume.getIndexPath()),false, analyzer,true);
				} catch (Exception cie) {
					 logger.error("failed to delete index {index='"+volume.getIndexPath()+"'}",cie);
					 return;
				}
				try {
				  writer.close();
              	} catch (Exception e) {
              		logger.error("failed to delete index {index='"+volume.getIndexPath()+"'}",e);
              	}
             
              	MessageIndex.volumeIndexes.remove(this);
              

		  }
		
		  public void startup() {
			logger.debug("volumeindex is starting up");
			File lockFile = new File(volume.getIndexPath()+File.separatorChar + "write.lock");
			if (lockFile.exists()) {
				logger.warn("The server lock file already exists. Either another indexer running or the server was not shutdown correctly.");
				logger.warn("If it is the latter, the lock file must be manually deleted at "+lockFile.getAbsolutePath());
				if (indexer.getMultipleIndexProcesses()) {
					logger.debug("index lock file detected on volumeindex startup.");
				} else {
					logger.warn("index lock file detected. the server was shutdown incorrectly. automatically deleting lock file.");
					lockFile.delete();
				}
			}
			closeIndexTimer.scheduleAtFixedRate(new TimerTask() {
	            public void run() {
	             	closeIndex();
	            }
	        }, indexOpenTime, indexOpenTime);
			Runtime.getRuntime().addShutdownHook(this);
			
/*
 * 
 * io.printStackTrace();
						if (attempt==9) {
							// most obvious reason for error is that there is a lock on the index, due hard shutdown
						    // resolution delete the lock, and try again
						    logger.warn("failed to open search index for write. possible write lock due to hard system shutdown.",io);
						    logger.info("attempting recovery. deleting index lock file and retrying..");
						    File lockFile = new File(activeIndex.getPath()+File.separatorChar + "write.lock");
						    lockFile.delete();
						} 
						attempt++;
						try { Thread.sleep(10); } catch (Exception e) {} 
						lastError = io;
 */
		  }
		  
		  public void shutdown() {
			  logger.debug("volumeindex is shutting down");
			  closeIndexTimer.cancel();
		      closeIndex();
		  }
		  
		  public void run() {
			  closeIndex();
		  }
		  
	 
}

	



--------------010803010103000406030305
Content-Type: text/plain; charset=us-ascii

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--------------010803010103000406030305--

From java-user-return-34254-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 10:39:26 2008
Return-Path: <java-user-return-34254-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78526 invoked from network); 30 May 2008 10:39:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 10:39:24 -0000
Received: (qmail 9088 invoked by uid 500); 30 May 2008 10:39:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9059 invoked by uid 500); 30 May 2008 10:39:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9047 invoked by uid 99); 30 May 2008 10:39:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 03:39:18 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [196.25.240.75] (HELO ctb-mesg5.saix.net) (196.25.240.75)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 10:38:20 +0000
Received: from [192.168.0.3] (dsl-243-225-120.telkomadsl.co.za [41.243.225.120])
	by ctb-mesg5.saix.net (Postfix) with ESMTP id 2753241D5
	for <java-user@lucene.apache.org>; Fri, 30 May 2008 12:38:34 +0200 (SAST)
Message-ID: <483FD927.3080408@stimulussoft.com>
Date: Fri, 30 May 2008 12:38:31 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Thunderbird 2.0.0.14 (Windows/20080421)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com> <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com> <CAC3FF9B-FBCA-424D-97DA-C022DE0B01F7@mac.com> <483FAE29.60409@stimulussoft.com> <1236018C-25F6-4E40-A9AC-4091EC9B3DCA@mikemccandless.com> <483FD66F.9010001@stimulussoft.com>
In-Reply-To: <483FD66F.9010001@stimulussoft.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Michael / others

The one thing I discovered was that it is quite useful to implement a 
JVM shutdown hook in your code to prevent the index from getting 
corrupted when an indexing process dies unexpectantly.

For those who don't know about shutdown hook mechanism, you do this by 
implementing:

class Indexer extends Thread {
  Indexer() {
    Runtime.getRuntime().addShutdownHook(this);
  } 
  public void run() {
      closeIndex();
  }
}
Would this be worthwhile building into Lucene or is this already 
implemented?

Regards,

Jamie

Jamie wrote:
> Hi Michael
>
> Thank you. Your suggestions were great and they were implemented (see 
> attached source code), however, unfortunately, I am still getting file 
> not found errors on the automatic merging of indexes.
>
> Regards,
>
> Jamie
>
>
> Michael McCandless wrote:
>>
>> Jamie,
>>
>> I'd love to get to the root cause of your exception.
>>
>> Last time we talked (a few weeks back) I saw several possible causes 
>> in the source you had posted:
>>
>>     http://markmail.org/message/dqovvcwgwof5f7wl
>>
>> Did you test any of the ideas there?  You are potentially manually 
>> deleting files from the index, and also forcibly removing the 
>> write.lock, which can easily cause this exception.
>>
>> Mike
>>
>> Jamie wrote:
>>
>>> Hi Paul,
>>>
>>> I just noticed the discussion around this.
>>>
>>> All most all of my customers have/are experiencing the intermittant 
>>> FileNotFound problem.
>>>
>>> Our software uses Lucene 2.3.1. I have just upgraded to Lucene 2.3.2 
>>> in the hope that this was one of the bugs that was fixed.
>>>
>>> I would be very interested in a resolution or known workaround.
>>>
>>> Thanks!
>>>
>>> Jamie
>>>
>>>
>>> Paul J. Lucas wrote:
>>>> On May 29, 2008, at 6:35 PM, Michael McCandless wrote:
>>>>
>>>>> Can you use lsof (or something similar) to see how many files you 
>>>>> have?
>>>>
>>>> FYI: I personally can't reproduce this; only a coworker can and 
>>>> even then it's sporadic, so it could take a little while.
>>>>
>>>>> Merging, especially several running at once, can greatly increase 
>>>>> open file count, and especially if mergeFactor is increased.
>>>>
>>>> That raises a few questions:
>>>>
>>>> 1. Should I lower my mergeFactor?
>>>>
>>>> 2. Is there any way to insist that only one merger runs?
>>>>
>>>> 3. Is there any way to insist that all merges happen synchronously, 
>>>> i.e., on IndexWriter.close() only and not to use a separate merge 
>>>> thread?
>>>>
>>>> - Paul
>>>>
>


-- 
Stimulus Software - MailArchiva
Email Archiving And Compliance
USA Tel: +1-713-366-8072 ext 3
UK Tel: +44-20-80991035 ext 3
Email: jamie@stimulussoft.com
Web: http://www.mailarchiva.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34255-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 10:40:55 2008
Return-Path: <java-user-return-34255-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78831 invoked from network); 30 May 2008 10:40:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 10:40:55 -0000
Received: (qmail 11109 invoked by uid 500); 30 May 2008 10:40:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11082 invoked by uid 500); 30 May 2008 10:40:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11071 invoked by uid 99); 30 May 2008 10:40:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 03:40:50 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.132.242 as permitted sender)
Received: from [209.85.132.242] (HELO an-out-0708.google.com) (209.85.132.242)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 10:40:01 +0000
Received: by an-out-0708.google.com with SMTP id c37so32641anc.49
        for <java-user@lucene.apache.org>; Fri, 30 May 2008 03:40:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=syqZEcoMxyOSCOyHf9jBZjGIrr9sYaiAhIEnPi/hu3Y=;
        b=pZdDd9v1Rz8s43/M5roPLA8yxKXgQbfFbHCFO3y2PXVTX/43Gpt2fpv6xA2RYnlex+Zhk2PkfvM6TyljFT2yPKCXFrmk253rPLJBG0CfnZWjIzaqwGaoUfSFqm/4SQ+8W4wqv80rn+vUqnB+IGaH27MgVQlaGUOafHVS4xf1cA4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=bK5FzFVRJG2vOOSLUjHMgEnUhQUp7R8+tYb1AOifdFrZaiiaKhno4qFN6UkOTtzsP1hIjW/kfBZzrra5TFuWM+F5MVtB200WZgHMhG7xQJ22YeBxqm/XsDftY+T7oa60+B38R86hK4C1FsByqPzO02vaqaL6hYPSifqG10e54sY=
Received: by 10.100.202.9 with SMTP id z9mr8749676anf.8.1212144017801;
        Fri, 30 May 2008 03:40:17 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id d5sm2301660qbd.8.2008.05.30.03.40.16
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 30 May 2008 03:40:17 -0700 (PDT)
Message-ID: <483FD992.1050905@gmail.com>
Date: Fri, 30 May 2008 06:40:18 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com> <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com> <CAC3FF9B-FBCA-424D-97DA-C022DE0B01F7@mac.com> <483FAE29.60409@stimulussoft.com> <1236018C-25F6-4E40-A9AC-4091EC9B3DCA@mikemccandless.com> <483FD66F.9010001@stimulussoft.com>
In-Reply-To: <483FD66F.9010001@stimulussoft.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I guess my test index was corrupted some other way...I can not duplicate 
my results today without breaking things with two lockless Writers 
first. Oh well.

I definitely saw it legitimately while playing with 
IndexReader.reopen...if I kept enough of the old IndexReaders around 
long enough I would get a mix of too many files open, filenotfound, and 
list returned null. Unfortunately, I don't have that code anymore.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34256-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 10:49:34 2008
Return-Path: <java-user-return-34256-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80414 invoked from network); 30 May 2008 10:49:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 10:49:33 -0000
Received: (qmail 19449 invoked by uid 500); 30 May 2008 10:49:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19410 invoked by uid 500); 30 May 2008 10:49:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19399 invoked by uid 99); 30 May 2008 10:49:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 03:49:27 -0700
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=SPF_NEUTRAL,URIBL_BLACK
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [66.249.82.234] (HELO wx-out-0506.google.com) (66.249.82.234)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 10:48:36 +0000
Received: by wx-out-0506.google.com with SMTP id h29so3124192wxd.20
        for <java-user@lucene.apache.org>; Fri, 30 May 2008 03:48:51 -0700 (PDT)
Received: by 10.90.66.14 with SMTP id o14mr5764179aga.38.1212144530790;
        Fri, 30 May 2008 03:48:50 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 1sm191793agb.30.2008.05.30.03.48.50
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 30 May 2008 03:48:50 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <483FD66F.9010001@stimulussoft.com>
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <483F47CD.1050709@gmail.com> <F0D9682E-BCFE-4F1E-9A8F-94E206BCCFBB@mac.com> <483F50F5.3050804@gmail.com> <483F549D.3040405@gmail.com> <28785928-1CE6-40B4-867B-114526A1F838@mikemccandless.com> <CAC3FF9B-FBCA-424D-97DA-C022DE0B01F7@mac.com> <483FAE29.60409@stimulussoft.com> <1236018C-25F6-4E40-A9AC-4091EC9B3DCA@mikemccandless.com> <483FD66F.9010001@stimulussoft.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <7C080E9F-C08A-4EDC-906B-1733C1593A1A@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Fri, 30 May 2008 06:48:49 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Jamie,

The code looks better!  You're not forcefully removing the write.lock  
nor deleting files from the index yourself, anymore, which is good.

One thing I spotted is your VolumeIndex.deleteIndex method fails to  
synchronize on the indexLock.  If I understand the code correctly,  
that means you could attempt to delete the index while it's being  
updated (by another writer) in a different thread, right?  However,  
in such a case, you should encounter LockObtainTimeoutException.  Are  
you seeing that?

Can you attach logs, with all verbosity turned on (so that  
IndexWriter.setInfoStream is called), leading up to the exception?  I  
think you should fix how you call setInfoStream because presently it  
looks like each time you open a writer you will overwrite the  
infoStream log from the previous writer.

Another question: how often does this process "start up"?  Is it able  
to start up when another JVM is running?  In your logs, how often are  
you forcibly removing the write.lock?  I noticed you added that  
indexer.getMultipleIndexProcesses() call as protection, but what if  
that is incorrectly configured, such that there are multiple  
processes indexing yet you removed the write.lock anyway?  (That  
would lead to this exception).

Mike

Jamie wrote:

> Hi Michael
>
> Thank you. Your suggestions were great and they were implemented  
> (see attached source code), however, unfortunately, I am still  
> getting file not found errors on the automatic merging of indexes.
>
> Regards,
>
> Jamie
>
>
> Michael McCandless wrote:
>>
>> Jamie,
>>
>> I'd love to get to the root cause of your exception.
>>
>> Last time we talked (a few weeks back) I saw several possible  
>> causes in the source you had posted:
>>
>>     http://markmail.org/message/dqovvcwgwof5f7wl
>>
>> Did you test any of the ideas there?  You are potentially manually  
>> deleting files from the index, and also forcibly removing the  
>> write.lock, which can easily cause this exception.
>>
>> Mike
>>
>> Jamie wrote:
>>
>>> Hi Paul,
>>>
>>> I just noticed the discussion around this.
>>>
>>> All most all of my customers have/are experiencing the  
>>> intermittant FileNotFound problem.
>>>
>>> Our software uses Lucene 2.3.1. I have just upgraded to Lucene  
>>> 2.3.2 in the hope that this was one of the bugs that was fixed.
>>>
>>> I would be very interested in a resolution or known workaround.
>>>
>>> Thanks!
>>>
>>> Jamie
>>>
>>>
>>> Paul J. Lucas wrote:
>>>> On May 29, 2008, at 6:35 PM, Michael McCandless wrote:
>>>>
>>>>> Can you use lsof (or something similar) to see how many files  
>>>>> you have?
>>>>
>>>> FYI: I personally can't reproduce this; only a coworker can and  
>>>> even then it's sporadic, so it could take a little while.
>>>>
>>>>> Merging, especially several running at once, can greatly  
>>>>> increase open file count, and especially if mergeFactor is  
>>>>> increased.
>>>>
>>>> That raises a few questions:
>>>>
>>>> 1. Should I lower my mergeFactor?
>>>>
>>>> 2. Is there any way to insist that only one merger runs?
>>>>
>>>> 3. Is there any way to insist that all merges happen  
>>>> synchronously, i.e., on IndexWriter.close() only and not to use  
>>>> a separate merge thread?
>>>>
>>>> - Paul
>>>>
>
> package com.stimulus.archiva.index;
>
> /* Copyright (C) 2005-2007 Jamie Angus Band
>  * MailArchiva Open Source Edition Copyright (c) 2005-2007 Jamie  
> Angus Band
>  * This program is free software; you can redistribute it and/or  
> modify it under the terms of
>  * the GNU General Public License as published by the Free Software  
> Foundation; either version
>  * 2 of the License, or (at your option) any later version.
>  *
>  * This program is distributed in the hope that it will be useful,  
> but WITHOUT ANY WARRANTY;
>  * without even the implied warranty of MERCHANTABILITY or FITNESS  
> FOR A PARTICULAR PURPOSE.
>  * See the GNU General Public License for more details.
>  *
>  * You should have received a copy of the GNU General Public  
> License along with this program;
>  * if not, see http://www.gnu.org/licenses or write to the Free  
> Software Foundation,Inc., 51
>  * Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA
>  */
>
>
> import javax.mail.*;
> import javax.mail.internet.*;
> import java.io.*;
> import java.util.*;
> import java.util.concurrent.Executors;
> import java.util.concurrent.TimeUnit;
> import java.util.zip.*;
> import com.ice.tar.*;
> import org.apache.log4j.Logger;
> import org.apache.lucene.document.*;
> import org.apache.lucene.index.*;
> import org.apache.lucene.store.*;
> import com.stimulus.archiva.domain.*;
> import com.stimulus.archiva.exception.*;
> import com.stimulus.archiva.language.*;
> import com.stimulus.archiva.extraction.*;
> import com.stimulus.archiva.search.*;
> import com.stimulus.util.TempFiles;
> import com.stimulus.archiva.domain.Service.Status;
> import com.stimulus.archiva.domain.fields.*;
> import com.stimulus.util.*;
> import java.nio.charset.Charset;
> import org.apache.log4j.Level;
>
> public class MessageIndex extends Indexer implements Serializable {
>
> 	private static final long serialVersionUID = -17692874371162272L;
> 	protected static final Logger logger = Logger.getLogger 
> (MessageIndex.class.getName());
> 	protected static int INDEX_WAIT_PERIOD = 50;
> 	protected static int DEAD_PERIOD = 300000000;
> 	static Hashtable<Volume,VolumeIndex> volumeIndexes = new  
> Hashtable<Volume,VolumeIndex>();
> 	static Object volumeIndexLock = new Object();
> 	protected ServiceDelegate serviceDelegate;
> 		
> 	 public MessageIndex() {
> 		 serviceDelegate = new ServiceDelegate("message index", this,  
> logger);
> 	 }
> 	 public String getServiceName() {
> 		 return serviceDelegate.getServiceName();
> 	 }
> 	
> 	 public boolean isAlive() {
> 		 return serviceDelegate.isAlive(true);
> 	}
> 	
> 	 public void startup() {
> 		 for (VolumeIndex volumeIndex : volumeIndexes.values()) {
> 			 volumeIndex.startup();
> 		 }
> 		 serviceDelegate.startup();
> 	 }
> 	
> 	 public void prepareShutdown() {
> 		 serviceDelegate.prepareShutdown();
> 	 }
> 	
> 	 public void shutdown() {
> 		 for (VolumeIndex volumeIndex : volumeIndexes.values()) {
> 			 volumeIndex.shutdown();
> 		 }
> 		 serviceDelegate.shutdown();
> 	 }
> 	
> 	 public void reloadConfig() {
> 		 serviceDelegate.reloadConfig();
> 	 }
>
> 	public Status getStatus() {
> 		return serviceDelegate.getStatus();
> 	}
> 	
> 	public void deleteIndex(Volume volume) throws  
> MessageSearchException {
> 		  VolumeIndex volumeIndex = getVolumeIndex(volume);
> 		  volumeIndex.deleteIndex();
> 	}
> 		
>  	
> 	public VolumeIndex getVolumeIndex(Volume volume) {
> 		 VolumeIndex volumeIndex = null;
> 		  synchronized (volumeIndexLock) {
> 			  volumeIndex = volumeIndexes.get(volume);
> 			  if (volumeIndex==null) {
> 				  volumeIndex = new VolumeIndex(this,volume);
> 				  volumeIndexes.put(volume,volumeIndex);
> 			  }
> 		  }
> 		  return volumeIndex;
> 	}
> 	  	
> 	public void indexMessage(Email email) throws MessageSearchException {
> 		if (serviceDelegate.getStatus()!=Status.STARTED) {
> 			return;
> 		}
> 		VolumeIndex volumeIndex = getVolumeIndex(email.getEmailId 
> ().getVolume());
> 		volumeIndex.indexMessage(email);
> 	}
> 		
> 		
> 	public void deleteMessage(EmailID emailID) throws  
> MessageSearchException {
> 		  VolumeIndex volumeIndex = getVolumeIndex(emailID.getVolume());
> 		  volumeIndex.deleteMessage(emailID);
> 	}
> 	
> 	public void prepareIndex(Volume volume) throws  
> MessageSearchException {
> 			
> 		  if (volume==null)
> 		            throw new MessageSearchException("assertion failure:  
> null volume",logger);
> 	
> 	  if (volume.getIndexPath().startsWith("rmi://"))
> 			  return;
> 			
> 	  File indexDir = new File(volume.getIndexPath());
> 	  if (!indexDir.exists()) {
> 		logger.info("index directory does not exist. will proceed with  
> creation {location='" + volume.getIndexPath() + "'}");
> 		boolean success = indexDir.mkdir();
> 		if (!success)
> 				throw new MessageSearchException("failed to create index  
> directory {location='" + volume.getIndexPath() + "'}",logger);
> 		logger.info("index directory successfully created {location='" +  
> volume.getIndexPath() + "'}");
> 		  }
> 	
> 	}
> 	
>
>
> }
>
> package com.stimulus.archiva.index;
>
> import java.io.File;
> import java.io.IOException;
> import java.io.PrintStream;
> import javax.mail.MessagingException;
> import org.apache.log4j.Level;
> import org.apache.log4j.Logger;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.index.*;
> import org.apache.lucene.store.FSDirectory;
> import com.stimulus.archiva.domain.Config;
> import com.stimulus.archiva.domain.Email;
> import com.stimulus.archiva.domain.EmailID;
> import com.stimulus.archiva.domain.Indexer;
> import com.stimulus.archiva.domain.Volume;
> import com.stimulus.archiva.exception.ExtractionException;
> import com.stimulus.archiva.exception.MessageSearchException;
> import com.stimulus.archiva.language.AnalyzerFactory;
> import com.stimulus.archiva.search.*;
> import java.util.*;
> import org.apache.lucene.store.AlreadyClosedException;
>
> public class VolumeIndex extends Thread {
> 	
> 		 protected static final Logger logger = Logger.getLogger 
> (VolumeIndex.class.getName());
> 		 public static final int indexOpenTime = 2000;
> 	   	 IndexWriter writer = null;
> 	   	 Volume volume;
> 	   	 Timer closeIndexTimer = new Timer();
> 		 Object indexLock = new Object();
> 		 ArchivaAnalyzer analyzer 	= new ArchivaAnalyzer();
> 		 Indexer indexer = null;
> 		
> 	  	  public VolumeIndex(Indexer indexer, Volume volume) {
> 	  		  	this.volume = volume;
> 	  		  	this.indexer = indexer;
> 	  		  	startup();
> 	  	  }
> 		
> 		public void deleteMessage(EmailID emailID) throws  
> MessageSearchException {
> 			  if (emailID == null)
> 		            throw new MessageSearchException("assertion failure:  
> null emailID",logger);
> 		  logger.debug("delete message {'"+emailID+"'}");
> 		  Volume volume = emailID.getVolume();
> 		  File indexDir = new File(volume.getIndexPath());
> 		  if (!indexDir.exists())
> 			  throw new MessageSearchException("could not delete email from  
> index. volume does not exist. {'"+emailID+"}",logger);
> 		  synchronized(indexLock) {
> 			  IndexReader indexReader = null;
> 			  try {
> 				  indexReader = IndexReader.open(indexDir);
> 			  } catch (IOException e ) {
> 				  throw new MessageSearchException("failed to open index to  
> delete email",e,logger);
> 			  }
> 			  try {
> 				  indexReader.deleteDocuments(new Term("uid",emailID.getUniqueID 
> ()));
> 				  indexReader.close();
> 			  } catch (Exception e) {
> 				  throw new MessageSearchException("failed to delete email from  
> index.",e,logger);
> 			  }
> 		  }
> 		}
> 		
> 		  protected void openIndex() throws MessageSearchException {
> 			 Exception lastError = null;
> 			 synchronized(indexLock) {
> 		    	if (writer==null) {
> 		    		logger.debug("openIndex() index will be opened. it is  
> currently closed.");
> 		    	} else {
> 		    		logger.debug("openIndex() did not bother opening index. it  
> is already open.");
> 		    		return;
> 		    	}
>
> 				logger.debug("opening index for write {"+volume+"}");
> 				indexer.prepareIndex(volume);
> 				logger.debug("opening search index for write  
> {indexpath='"+volume.getIndexPath()+"'}");
> 				boolean error = false;
> 				int attempt = 0;
> 				do {
> 					try {
> 							writer = new IndexWriter(FSDirectory.getDirectory 
> (volume.getIndexPath()),false, analyzer);
> 							writer.setMaxFieldLength(50000);
> 							if (logger.isDebugEnabled()) {
> 								File file = new File(Config.getFileSystem().getLogPath() 
> +File.separator+"index.log");
> 								PrintStream debugout = new PrintStream(file);
> 								writer.setInfoStream(debugout);
> 							}
> 					} catch (IOException io) {
> 						lastError = io;
> 						if (Config.getConfig().getIndex().getMultipleIndexProcesses()) {
> 							logger.debug("write lock on index. will reopen in 50ms.");
> 							try { Thread.sleep(50); } catch (Exception e) {}
> 							error = true;
> 							attempt++;
> 						} else {
> 							 throw new MessageSearchException("failed to open index  
> writer. you must delete the file write.lock in your the directory.  
> {location='"+volume.getIndexPath()+"'}",lastError,logger);
> 						}
> 					}
> 					
> 			   } while (error && attempt>1000);
> 			   if (attempt>=1000 || error)
> 				 throw new MessageSearchException("failed to open index writer  
> {location='"+volume.getIndexPath()+"'}",lastError,logger);
> 			}
> 		}
> 		
> 		public void indexMessage(Email message) throws  
> MessageSearchException  {
>
> 			long s = (new Date()).getTime();
> 			if (message == null)
> 			    throw new MessageSearchException("assertion failure: null  
> message",logger);
> 			logger.debug("indexing message {"+message+"}");
> 			
> 			Document doc = new Document();
> 			try {
> 			
> 			   DocumentIndex docIndex = new DocumentIndex(indexer);
> 			   docIndex.write(message,doc);
> 			   String language = doc.get("lang");
> 			   if (language==null)
> 				   language = indexer.getIndexLanguage();
> 		   		synchronized (indexLock) {
> 		   			openIndex();
> 		   			writer.addDocument(doc,AnalyzerFactory.getAnalyzer 
> (language,AnalyzerFactory.Operation.INDEX));
> 		   			writer.flush();
> 		   		}
> 		   		doc = null;
> 			   logger.debug("message indexed successfully {"+message 
> +",language='"+language+"'}");
> 			} catch (MessagingException me)
> 			{
> 			   throw new MessageSearchException("failed to decode message  
> during indexing",me,logger, Level.DEBUG);
> 			} catch (IOException me) {
> 			    throw new MessageSearchException("failed to index message  
> {"+message+"}",me,logger, Level.DEBUG);
> 			} catch (ExtractionException ee)
> 			{
> 				// we will want to continue indexing
> 			   //throw new MessageSearchException("failed to decode  
> attachments in message {"+message+"}",ee,logger, Level.DEBUG);
> 			} catch (AlreadyClosedException ace) {
> 				indexMessage(message);
> 			} catch (Exception e) {
> 			    throw new MessageSearchException("failed to index  
> message",e,logger, Level.DEBUG);
> 			}
> 			logger.debug("indexing message end {"+message+"}");
> 			
> 			long e = (new Date()).getTime();
> 		    logger.debug("indexing time {time='"+(e-s)+"'}");
> 		}
> 			
> 		protected void closeIndex() {
> 		
> 			   synchronized(indexLock) {
> 			        if (writer==null)
> 			        		return;
> 			        try {
> 			        	writer.close();
> 					    logger.debug("writer closed");
> 					} catch (Exception io) {
> 						logger.error("failed to close index writer:"+io.getMessage 
> (),io);
> 	
> 					}
> 			        writer = null;
> 			   	}
> 	   	}
> 	
> 		  public void deleteIndex() throws MessageSearchException {
> 			  logger.debug("delete index {indexpath='"+volume.getIndexPath() 
> +"'}");
> 			
> 				try {
> 					  writer = new IndexWriter(FSDirectory.getDirectory 
> (volume.getIndexPath()),false, analyzer,true);
> 				} catch (Exception cie) {
> 					 logger.error("failed to delete index  
> {index='"+volume.getIndexPath()+"'}",cie);
> 					 return;
> 				}
> 				try {
> 				  writer.close();
>               	} catch (Exception e) {
>               		logger.error("failed to delete index  
> {index='"+volume.getIndexPath()+"'}",e);
>               	}
>
>               	MessageIndex.volumeIndexes.remove(this);
>
>
> 		  }
> 		
> 		  public void startup() {
> 			logger.debug("volumeindex is starting up");
> 			File lockFile = new File(volume.getIndexPath() 
> +File.separatorChar + "write.lock");
> 			if (lockFile.exists()) {
> 				logger.warn("The server lock file already exists. Either  
> another indexer running or the server was not shutdown correctly.");
> 				logger.warn("If it is the latter, the lock file must be  
> manually deleted at "+lockFile.getAbsolutePath());
> 				if (indexer.getMultipleIndexProcesses()) {
> 					logger.debug("index lock file detected on volumeindex startup.");
> 				} else {
> 					logger.warn("index lock file detected. the server was shutdown  
> incorrectly. automatically deleting lock file.");
> 					lockFile.delete();
> 				}
> 			}
> 			closeIndexTimer.scheduleAtFixedRate(new TimerTask() {
> 	            public void run() {
> 	             	closeIndex();
> 	            }
> 	        }, indexOpenTime, indexOpenTime);
> 			Runtime.getRuntime().addShutdownHook(this);
> 			
> /*
>  *
>  * io.printStackTrace();
> 						if (attempt==9) {
> 							// most obvious reason for error is that there is a lock on  
> the index, due hard shutdown
> 						    // resolution delete the lock, and try again
> 						    logger.warn("failed to open search index for write.  
> possible write lock due to hard system shutdown.",io);
> 						    logger.info("attempting recovery. deleting index lock  
> file and retrying..");
> 						    File lockFile = new File(activeIndex.getPath() 
> +File.separatorChar + "write.lock");
> 						    lockFile.delete();
> 						}
> 						attempt++;
> 						try { Thread.sleep(10); } catch (Exception e) {}
> 						lastError = io;
>  */
> 		  }
> 		
> 		  public void shutdown() {
> 			  logger.debug("volumeindex is shutting down");
> 			  closeIndexTimer.cancel();
> 		      closeIndex();
> 		  }
> 		
> 		  public void run() {
> 			  closeIndex();
> 		  }
> 		
> 	
> }
>
> 	
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34257-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 11:08:53 2008
Return-Path: <java-user-return-34257-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88227 invoked from network); 30 May 2008 11:08:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 11:08:53 -0000
Received: (qmail 40091 invoked by uid 500); 30 May 2008 11:08:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40058 invoked by uid 500); 30 May 2008 11:08:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40047 invoked by uid 99); 30 May 2008 11:08:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 04:08:49 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.132.245 as permitted sender)
Received: from [209.85.132.245] (HELO an-out-0708.google.com) (209.85.132.245)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 11:08:00 +0000
Received: by an-out-0708.google.com with SMTP id c37so34555anc.49
        for <java-user@lucene.apache.org>; Fri, 30 May 2008 04:08:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=c+fnS3LDyNDaRMIC6haRAiafxVPurAB23V+KizmKvx0=;
        b=EyZcBDSywv7G0DB0JH2z7619RQMfBsQ4z+titeCwODIrmPc2P+AbwO4GwQl+045nbE6d7Wo72dKVjYCLsAGmFxaV4hnL4YYX6G2O4H8AuQC9iuI6aYhT85l2Lzx1nte/PPvna/ZsdSdlo7JzKoGEH/Mhjj1gwAU2r2d83syH2KQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=tF87103zXdGPx9xcxf9jWgjtxbE8VUTYxYBnnW4R2de5Fhen/KwQV3yR6dl4euKmLrTZMtQ+bYoAFRfrdHcTgVjOWan2istGcgRRCQo8hrQl3vZl4DdX/UVc9+cn16Cailxbf16xtMqJIGN5iLljyqnIWIpEsWAQYxUED/dX0Tw=
Received: by 10.100.41.15 with SMTP id o15mr8753479ano.48.1212145696489;
        Fri, 30 May 2008 04:08:16 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id q14sm2282231qbq.29.2008.05.30.04.08.14
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 30 May 2008 04:08:14 -0700 (PDT)
Message-ID: <483FE020.9080001@gmail.com>
Date: Fri, 30 May 2008 07:08:16 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: IndexReader.reopen memory leak
References: <8837fb770805272325r168211e3i23ae0314a07fe8d3@mail.gmail.com>	 <483DD50C.3080908@gmail.com> <483DE95C.9030501@gmail.com>	 <8837fb770805282125w5f3d7101i4b42b0c55edd3a5a@mail.gmail.com>	 <483E5CD9.8080005@gmail.com>	 <8837fb770805290941p3ae6dff1g1be9f2222cc49bbf@mail.gmail.com>	 <483EE805.3090500@gmail.com> <8837fb770805292039o661e15bfs860d6fca550619f5@mail.gmail.com>
In-Reply-To: <8837fb770805292039o661e15bfs860d6fca550619f5@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

John Wang wrote:
> My client does not call my reader.reopen(), I have implemented a reload()
> method off of my reader (void reload()), and it discards the internal reader
> upon a reload. Due to another issue (an api issue with IndexReader, e.g. all
> derived implementations have to reimplement reopen because it has to return
> its instance even if there is nothing specific to do, kinda defeats the
> purpose of object overriding)
>
> Anyway, my system only calls myReader.reload() everytime the index "flips"
> Re Mark's comment, does your test do both indexing and searching during the
> duration of your run? How big is your index?
>
> Thanks
>
> -John
>   
Yes...I constantly index with 8 threads on one writer while searching 
with many more threads. Then I let it run for like an hour and watch. 
The index is tiny to start and then grows to a moderate size...nothing 
crazy.

I am also reopening a lot on a real index of 3.5 million +  docs 
though...and I see no leak evidence there either.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34258-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 11:12:12 2008
Return-Path: <java-user-return-34258-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89050 invoked from network); 30 May 2008 11:12:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 11:12:12 -0000
Received: (qmail 44651 invoked by uid 500); 30 May 2008 11:12:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44607 invoked by uid 500); 30 May 2008 11:12:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44596 invoked by uid 99); 30 May 2008 11:12:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 04:12:06 -0700
X-ASF-Spam-Status: No, hits=4.4 required=10.0
	tests=HTML_MESSAGE,MSGID_MULTIPLE_AT,SPF_HELO_PASS,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [212.227.126.177] (HELO moutng.kundenserver.de) (212.227.126.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 11:11:17 +0000
Received: from DanielPC (p4FC75D5A.dip.t-dialin.net [79.199.93.90])
	by mrelayeu.kundenserver.de (node=mrelayeu7) with ESMTP (Nemesis)
	id 0ML2xA-1K22WB39gB-0005Wn; Fri, 30 May 2008 13:11:32 +0200
From: "Daniel Freudenberger" <d.freudenberger@trade-a-game.de>
To: <java-user@lucene.apache.org>
Subject: how to unsubscribe?
Date: Fri, 30 May 2008 13:10:51 +0200
Message-ID: <001b01c8c245$d2ab1ae0$780150a0$@freudenberger@trade-a-game.de>
MIME-Version: 1.0
Content-Type: multipart/related;
	boundary="----=_NextPart_000_001C_01C8C256.9633EAE0"
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcjCRdJip0xHLYNHR9m/RKGlAI2/EQ==
Content-Language: de
X-Provags-ID: V01U2FsdGVkX1+VOVigS3ShzmC/FCGvyad2ar9ZmkrMnUL8wvv
 PHAW2ETQaZkCT3747my0MEU0bCeNQiQohF1eUCpbzPA+XucXoQ
 e0uo8pXjAEt6w0h5JauHsJDvXpHsQpgxRPG3Z+as5BLOoIE0yU
 Z8g==
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_001C_01C8C256.9633EAE0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_001_001D_01C8C256.9633EAE0"


------=_NextPart_001_001D_01C8C256.9633EAE0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Hello everybody,

=20

sorry for posting to the list but I=92m kinda helpless. I=92m trying to
unsubscribe from the mailing list but my unsubscribe email is treated as
spam :)

=20

SMTP error from remote server after transfer of mail text:

host mx1.eu.apache.org[192.87.106.230]:

552 spam score (5.7) exceeded threshold

=20

Any help is appreciated.

=20

Best regards,

--

Daniel Freudenberger

Lead-Developer

=20

web:  http://www.trade-a-game.de

blog:  http://blogs.trade-a-game.de/

=20

=20

d.freudenberger@trade-a-game.de=20

Skype (VoIP): d.freudenberger

=20

mobil: +49 (0)178 297 0890

Fax: +49 (0) 30 600 313 199

=20

--------------------------------------------------------------------

 cid:121C3612-8C65-4148-A31D-E8722FB643FD

trade-a-game GmbH | Dieffenbachstr. 33

D- 10967 Berlin | www.trade-a-game.de <http://www.trade-a-game.de/>=20

=20

Sitz und Registergericht:=20

Amtsgericht Charlottenburg HRB 109344 B

USt-Id-Nr. DE237458635

=20

Gesch=E4ftsf=FChrer: Marcus B=F6rner, Lawrence Leuschner

--------------------------------------------------------------------

=20

This e-mail may contain confidential information.=20

If you are not the intended recipient please notify=20

the sender immediately and destroy this e-mail.=20

Any unauthorised copying, disclosure or distribution=20

of the material in this e-mail is strictly forbidden.=20

=20

* SAVE PAPER - THINK BEFORE YOU PRINT *


------=_NextPart_001_001D_01C8C256.9633EAE0
Content-Type: text/html;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

<html xmlns:v=3D"urn:schemas-microsoft-com:vml" =
xmlns:o=3D"urn:schemas-microsoft-com:office:office" =
xmlns:w=3D"urn:schemas-microsoft-com:office:word" =
xmlns:m=3D"http://schemas.microsoft.com/office/2004/12/omml" =
xmlns=3D"http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=3DContent-Type content=3D"text/html; =
charset=3Diso-8859-1">
<meta name=3DGenerator content=3D"Microsoft Word 12 (filtered medium)">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{mso-style-priority:99;
	mso-style-link:"Nur Text Zchn";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.5pt;
	font-family:Consolas;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-priority:99;
	mso-style-link:"Sprechblasentext Zchn";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
span.E-MailFormatvorlage17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
span.SprechblasentextZchn
	{mso-style-name:"Sprechblasentext Zchn";
	mso-style-priority:99;
	mso-style-link:Sprechblasentext;
	font-family:"Tahoma","sans-serif";}
span.NurTextZchn
	{mso-style-name:"Nur Text Zchn";
	mso-style-priority:99;
	mso-style-link:"Nur Text";
	font-family:Consolas;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page Section1
	{size:612.0pt 792.0pt;
	margin:70.85pt 70.85pt 2.0cm 70.85pt;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext=3D"edit" spidmax=3D"2050" />
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext=3D"edit">
  <o:idmap v:ext=3D"edit" data=3D"1" />
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=3DDE link=3Dblue vlink=3Dpurple>

<div class=3DSection1>

<p class=3DMsoNormal><span lang=3DEN-US>Hello =
everybody,<o:p></o:p></span></p>

<p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal><span lang=3DEN-US>sorry for posting to the list =
but I&#8217;m
kinda helpless. I&#8217;m trying to unsubscribe from the mailing list =
but my
unsubscribe email is treated as spam :)<o:p></o:p></span></p>

<p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span lang=3DEN-US>SMTP error from remote server =
after
transfer of mail text:<o:p></o:p></span></p>

<p class=3DMsoPlainText><span lang=3DEN-US>host =
mx1.eu.apache.org[192.87.106.230]:<o:p></o:p></span></p>

<p class=3DMsoPlainText><span lang=3DEN-US>552 spam score (5.7) exceeded =
threshold<o:p></o:p></span></p>

<p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal><span lang=3DEN-US>Any help is =
appreciated.<o:p></o:p></span></p>

<p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal><span lang=3DEN-US>Best =
regards,<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:8.0pt;line-height:120%;font-family:"Verdana","sans-ser=
if";
color:black'>--<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'>Daniel Freudenberger<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:8.0pt;line-height:120%;font-family:"Verdana","sans-ser=
if";
color:black'>Lead-Developer<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'>web:&nbsp; <a =
href=3D"http://www.trade-a-game.de">http://www.trade-a-game.de</a><o:p></=
o:p></span></p>

<p class=3DMsoNormal><span =
style=3D'font-size:10.0pt;font-family:"Verdana","sans-serif";
color:black'>blog:&nbsp; </span><span =
style=3D'font-size:10.5pt;font-family:Consolas'><a
href=3D"http://blogs.trade-a-game.de/">http://blogs.trade-a-game.de/</a><=
o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'><a =
href=3D"mailto:d.freudenberger@trade-a-game.de">d.freudenberger@trade-a-g=
ame.de</a>
<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'>Skype (VoIP): d.freudenberger<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'>mobil: +49 (0)178 297 0890<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-GB =
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'>Fax: +49 (0) 30 600 313 199<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-GB =
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-GB =
style=3D'font-size:7.0pt;line-height:120%;font-family:"Verdana","sans-ser=
if";
color:gray'>-------------------------------------------------------------=
-------</span><span
lang=3DEN-GB =
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:gray'><o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-GB =
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:gray'>&nbsp;</span><img border=3D0 width=3D176 height=3D44 =
id=3D"Bild_x0020_1"
src=3D"cid:image001.jpg@01C8C256.95E862F0"
alt=3D"cid:121C3612-8C65-4148-A31D-E8722FB643FD"><span lang=3DEN-GB
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:gray'><o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:#333333'>trade-a-game GmbH | Dieffenbachstr. =
33<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:#333333'>D- 10967 Berlin | <a =
href=3D"http://www.trade-a-game.de/">www.trade-a-game.de</a><o:p></o:p></=
span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:gray'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:gray'>Sitz und Registergericht: <o:p></o:p></span></p>

<p class=3DMsoNormal><span =
style=3D'font-size:10.0pt;font-family:"Arial","sans-serif";
color:gray'>Amtsgericht Charlottenburg HRB 109344 =
B<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:gray'>USt-Id-Nr. DE237458635</span><span =
style=3D'font-size:10.0pt;
line-height:120%;font-family:"Verdana","sans-serif";color:gray'><o:p></o:=
p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:gray'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:gray'>Gesch=E4ftsf=FChrer: Marcus B=F6rner, Lawrence =
Leuschner<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-GB =
style=3D'font-size:7.0pt;line-height:120%;font-family:"Verdana","sans-ser=
if";
color:gray'>-------------------------------------------------------------=
-------</span><span
lang=3DEN-GB =
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:gray'><o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-GB =
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-GB =
style=3D'font-size:7.0pt;line-height:120%;font-family:"Verdana","sans-ser=
if";
color:silver'>This e-mail may contain confidential information. =
<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-GB =
style=3D'font-size:7.0pt;line-height:120%;font-family:"Verdana","sans-ser=
if";
color:silver'>If you are not the intended recipient please notify =
<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-GB =
style=3D'font-size:7.0pt;line-height:120%;font-family:"Verdana","sans-ser=
if";
color:silver'>the sender immediately and destroy this e-mail. =
<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-GB =
style=3D'font-size:7.0pt;line-height:120%;font-family:"Verdana","sans-ser=
if";
color:silver'>Any unauthorised copying, disclosure or distribution =
<o:p></o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-GB =
style=3D'font-size:7.0pt;line-height:120%;font-family:"Verdana","sans-ser=
if";
color:silver'>of the material in this e-mail is strictly =
forbidden.</span><span
lang=3DEN-GB =
style=3D'font-size:10.0pt;line-height:120%;font-family:"Verdana","sans-se=
rif";
color:silver'> <o:p></o:p></span></p>

<p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal =
style=3D'line-height:120%;text-autospace:none'><span
lang=3DEN-US =
style=3D'font-size:10.5pt;line-height:120%;font-family:Consolas'>*
SAVE PAPER - THINK BEFORE YOU PRINT *</span><span =
lang=3DEN-US><o:p></o:p></span></p>

</div>

</body>

</html>

------=_NextPart_001_001D_01C8C256.9633EAE0--

------=_NextPart_000_001C_01C8C256.9633EAE0--


From java-user-return-34259-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 11:23:34 2008
Return-Path: <java-user-return-34259-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92883 invoked from network); 30 May 2008 11:23:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 11:23:33 -0000
Received: (qmail 65335 invoked by uid 500); 30 May 2008 11:23:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65297 invoked by uid 500); 30 May 2008 11:23:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65286 invoked by uid 99); 30 May 2008 11:23:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 04:23:29 -0700
X-ASF-Spam-Status: No, hits=3.6 required=10.0
	tests=HTML_EMBEDS,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.207] (HELO spunkymail-a10.g.dreamhost.com) (208.97.132.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 11:22:31 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a10.g.dreamhost.com (Postfix) with ESMTP id D17DB16397E
	for <java-user@lucene.apache.org>; Fri, 30 May 2008 04:22:51 -0700 (PDT)
Message-Id: <635DD931-06FC-42E6-A21D-E6F5895615C7@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <001b01c8c245$d2ab1ae0$780150a0$@freudenberger@trade-a-game.de>
Content-Type: multipart/alternative; boundary=Apple-Mail-100--236346593
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: how to unsubscribe?
Date: Fri, 30 May 2008 07:22:50 -0400
References: <001b01c8c245$d2ab1ae0$780150a0$@freudenberger@trade-a-game.de>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail-100--236346593
Content-Type: text/plain;
	charset=WINDOWS-1252;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: quoted-printable

We don't let people leave....  ;-)

I think, you may just need to put some reasonable looking text (such =20
as "unsubscribe") in the subject/body of the email.  Not sure why you =20=

need to do that, though.  Maybe one of the moderators watching can do =20=

it for you if that doesn't work.

-Grant

On May 30, 2008, at 7:10 AM, Daniel Freudenberger wrote:

> Hello everybody,
>
> sorry for posting to the list but I=92m kinda helpless. I=92m trying =
to =20
> unsubscribe from the mailing list but my unsubscribe email is =20
> treated as spam :)
>
> SMTP error from remote server after transfer of mail text:
> host mx1.eu.apache.org[192.87.106.230]:
> 552 spam score (5.7) exceeded threshold
>
> Any help is appreciated.
>
> Best regards,
> --
> Daniel Freudenberger
> Lead-Developer
>
> web:  http://www.trade-a-game.de
> blog:  http://blogs.trade-a-game.de/
>
>
> d.freudenberger@trade-a-game.de
> Skype (VoIP): d.freudenberger
>
> mobil: +49 (0)178 297 0890
> Fax: +49 (0) 30 600 313 199
>
> --------------------------------------------------------------------
>
> trade-a-game GmbH | Dieffenbachstr. 33
> D- 10967 Berlin | www.trade-a-game.de
>
> Sitz und Registergericht:
> Amtsgericht Charlottenburg HRB 109344 B
> USt-Id-Nr. DE237458635
>
> Gesch=E4ftsf=FChrer: Marcus B=F6rner, Lawrence Leuschner
> --------------------------------------------------------------------
>
> This e-mail may contain confidential information.
> If you are not the intended recipient please notify
> the sender immediately and destroy this e-mail.
> Any unauthorised copying, disclosure or distribution
> of the material in this e-mail is strictly forbidden.
>
> * SAVE PAPER - THINK BEFORE YOU PRINT *

--------------------------
Grant Ingersoll
http://www.lucidimagination.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ








--Apple-Mail-100--236346593--

From java-user-return-34260-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 11:45:54 2008
Return-Path: <java-user-return-34260-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5421 invoked from network); 30 May 2008 11:45:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 11:45:54 -0000
Received: (qmail 937 invoked by uid 500); 30 May 2008 11:45:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 896 invoked by uid 500); 30 May 2008 11:45:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 883 invoked by uid 99); 30 May 2008 11:45:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 04:45:49 -0700
X-ASF-Spam-Status: No, hits=2.4 required=10.0
	tests=MSGID_MULTIPLE_AT,SPF_HELO_PASS,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [212.227.126.187] (HELO moutng.kundenserver.de) (212.227.126.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 11:44:53 +0000
Received: from DanielPC (p4FC75D5A.dip.t-dialin.net [79.199.93.90])
	by mrelayeu.kundenserver.de (node=mrelayeu7) with ESMTP (Nemesis)
	id 0ML2xA-1K232p0rFm-0005S8; Fri, 30 May 2008 13:45:15 +0200
From: "Daniel Freudenberger" <d.freudenberger@trade-a-game.de>
To: <java-user@lucene.apache.org>
References: <001b01c8c245$d2ab1ae0$780150a0$@freudenberger@trade-a-game.de> <635DD931-06FC-42E6-A21D-E6F5895615C7@apache.org>
In-Reply-To: <635DD931-06FC-42E6-A21D-E6F5895615C7@apache.org>
Subject: RE: how to unsubscribe?
Date: Fri, 30 May 2008 13:44:35 +0200
Message-ID: <000001c8c24a$88ae1e60$9a0a5b20$@freudenberger@trade-a-game.de>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcjCR5WyeAuZ/fTGRFO1d4u9MPPFEQAAn0CA
Content-Language: de
X-Provags-ID: V01U2FsdGVkX1/Tgt3ka2IdjxtCv8xzbKwaK5Koi4V7ns5vl0x
 qXq3Md6si1l2AM44oUI+qZ6ZaoEgPplQAoALKUdrbK1bMSlRWa
 /Kt2QJtLS2PUWAa6HoDjlRAVoPUOTYc3wWvi9e9tDhSAzcxFOA
 aGg==
X-Virus-Checked: Checked by ClamAV on apache.org

Hey,

I've already tried this but the subject line is fixed and I wrote a =
roman to
convince the mail daemon that I'm not interested in spamming.. but it =
didn't
care :)

Best regards,
Daniel

-----Original Message-----
From: Grant Ingersoll [mailto:gsingers@apache.org]=20
Sent: Friday, May 30, 2008 1:23 PM
To: java-user@lucene.apache.org
Subject: Re: how to unsubscribe?

We don't let people leave....  ;-)

I think, you may just need to put some reasonable looking text (such =20
as "unsubscribe") in the subject/body of the email.  Not sure why you =20
need to do that, though.  Maybe one of the moderators watching can do =20
it for you if that doesn't work.

-Grant

On May 30, 2008, at 7:10 AM, Daniel Freudenberger wrote:

> Hello everybody,
>
> sorry for posting to the list but I=92m kinda helpless. I=92m trying =
to =20
> unsubscribe from the mailing list but my unsubscribe email is =20
> treated as spam :)
>
> SMTP error from remote server after transfer of mail text:
> host mx1.eu.apache.org[192.87.106.230]:
> 552 spam score (5.7) exceeded threshold
>
> Any help is appreciated.
>
> Best regards,
> --
> Daniel Freudenberger
> Lead-Developer
>
> web:  http://www.trade-a-game.de
> blog:  http://blogs.trade-a-game.de/
>
>
> d.freudenberger@trade-a-game.de
> Skype (VoIP): d.freudenberger
>
> mobil: +49 (0)178 297 0890
> Fax: +49 (0) 30 600 313 199
>
> --------------------------------------------------------------------
>
> trade-a-game GmbH | Dieffenbachstr. 33
> D- 10967 Berlin | www.trade-a-game.de
>
> Sitz und Registergericht:
> Amtsgericht Charlottenburg HRB 109344 B
> USt-Id-Nr. DE237458635
>
> Gesch=E4ftsf=FChrer: Marcus B=F6rner, Lawrence Leuschner
> --------------------------------------------------------------------
>
> This e-mail may contain confidential information.
> If you are not the intended recipient please notify
> the sender immediately and destroy this e-mail.
> Any unauthorised copying, disclosure or distribution
> of the material in this e-mail is strictly forbidden.
>
> * SAVE PAPER - THINK BEFORE YOU PRINT *

--------------------------
Grant Ingersoll
http://www.lucidimagination.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ









---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34261-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 14:12:47 2008
Return-Path: <java-user-return-34261-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87559 invoked from network); 30 May 2008 14:12:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 14:12:47 -0000
Received: (qmail 68459 invoked by uid 500); 30 May 2008 14:12:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68430 invoked by uid 500); 30 May 2008 14:12:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68419 invoked by uid 99); 30 May 2008 14:12:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 07:12:41 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of claudio.corsi@gmail.com designates 74.125.44.29 as permitted sender)
Received: from [74.125.44.29] (HELO yx-out-2324.google.com) (74.125.44.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 14:11:54 +0000
Received: by yx-out-2324.google.com with SMTP id 31so405691yxl.5
        for <java-user@lucene.apache.org>; Fri, 30 May 2008 07:12:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=btBh+02tCJg9pRs6Rx50DppakG7Om61wUuQ+aZ3Ouzw=;
        b=m0vmObbP3wJvV94CjdYEh06ZYwJcWzfC4myIxcPz5b4b2yYrUxOdQqy+lgxByf2u8E/hir4s0xy3MT1P6f45hqOhxMAjZAG2TE4ORzJI9n3jI1QHSpr3t/u8f83YHpxrLHdpp87a/imw/I+0Xwk8tZtEP5U74lz7gC6vAtCPnBk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=FfyuVMm/iKg4LHeZuSJ16V1lzF5XNMyFWr8ckP14rcUwPmd0bDkhhfFE7HIyAywjNEfybb7AFwHY3dji7aNq3AP6Egdkv7gI16STdD16oVvo3YXHWiYAImXU8vHHT22shEKyZ0kywv2K1nsyKF0GDdddSytRK87LV5dJFrZr0Z8=
Received: by 10.151.154.12 with SMTP id g12mr7380054ybo.110.1212156730296;
        Fri, 30 May 2008 07:12:10 -0700 (PDT)
Received: by 10.150.136.18 with HTTP; Fri, 30 May 2008 07:12:10 -0700 (PDT)
Message-ID: <b1f4be6c0805300712hdbc9cj80845dc4ab7f768c@mail.gmail.com>
Date: Fri, 30 May 2008 16:12:10 +0200
From: "Claudio Corsi" <claudio.corsi@gmail.com>
To: java-user@lucene.apache.org
Subject: SpanNearQuery: how to get the "intra-span" matching positions?
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,
I'm querying my index with a SpanNearQuery built on top of some
SpanOrQuery. Now, the Spans object I get form the SpanNearQuery
instance returns me back the sequence of text spans, each defined by
their starting/ending positions. I'm wondering if there is a simple
way to get not only the start/end positions of the entire span, but
the single matching positions inside such span.

For example, suppose that a SpanNearQuery composed by 3 SpanTermQuery
(with a slop of K) produce as resulting span the terms sequence: <t0
t1 t2 t3 .... t100> (so start() == 0, end() == 100). I know that for
sure t0 and t100 have generated a match, since the span is "minimal"
(right?). But I also know that there is a 3th match somewhere in the
span (I have 3 SpanTermQuery that have to match). Is there a way to
discover it?

The application I'm building should highlights the single matches not
the entire spans, but at the same time it have to support the "near"
queries.

Thank you!

-- 
Claudio Corsi

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34262-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 16:04:05 2008
Return-Path: <java-user-return-34262-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82701 invoked from network); 30 May 2008 16:04:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 16:04:05 -0000
Received: (qmail 22122 invoked by uid 500); 30 May 2008 16:04:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22087 invoked by uid 500); 30 May 2008 16:04:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22076 invoked by uid 99); 30 May 2008 16:04:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 09:04:00 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 16:03:05 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1K274h-0002ox-1L
	for java-user@lucene.apache.org; Fri, 30 May 2008 09:03:27 -0700
Message-ID: <17562588.post@talk.nabble.com>
Date: Fri, 30 May 2008 09:03:27 -0700 (PDT)
From: Ravi_116 <ravi116@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Opening an index directory inside a jar
In-Reply-To: <17526678.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ravi116@gmail.com
References: <17526678.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Any ideas/suggestions ??
Ravi


Ravi_116 wrote:
> 
> I get the following error trace -
> 
> java.io.FileNotFoundException: no segments* file found in
> org.apache.lucene.store.FSDirectory@/Users/projects/workspace/project_name/web/file:/Users/.m2/repository/com/mycompany/project_name/2.1.0-internal-65-SNAPSHOT/suggesters-2.1.0-internal-65-SNAPSHOT.jar!/luceneFiles/index:
> files:
>         at
> org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:587)
> 
> The crux of the issue seems to be that lucene cannot open segments file
> that is inside the jar (under luceneFiles/index directory)
> 
> The current project structure involves creating module jars in maven and
> having a web tier module use the lucene module jar. The index files are
> built at build time as part of lucene module project. The issue with
> building the index separate from the application  is that a bunch of
> unit/integration/functional tests depend on index files to be created. The
> manual step of creating the index files breaks the automated CI builds or
> some reliance on building the index in some tmp directory. Unfortunately
> that approach has issues if we run tests concurrently. Also, building the
> index takes a couple of minutes, so generating them on the fly for tests
> is expensive and increases the build time.
> 
> The only options suggested in the forums is to do something special like
> extending the Directory class to open the jar. Is there another way to
> solve this problem in an easier manner or am i missing something simple ?
> 
> Any thoughts/suggestions are appreciated,
> 
> Ravi 
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Opening-an-index-directory-inside-a-jar-tp17526678p17562588.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34263-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 16:38:17 2008
Return-Path: <java-user-return-34263-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99598 invoked from network); 30 May 2008 16:38:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 16:38:17 -0000
Received: (qmail 74144 invoked by uid 500); 30 May 2008 16:38:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74106 invoked by uid 500); 30 May 2008 16:38:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 40096 invoked by uid 99); 30 May 2008 16:13:19 -0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of SRS0=ljfWD2=WN=mac.com=pauljlucas@yourhostingaccount.com designates 65.254.253.28 as permitted sender)
X-EN-OrigOutIP: 10.1.18.4
X-EN-IMPSID: XsCj1Z00405G96J0000000
Message-Id: <362F48B4-D7FC-4784-A82B-9294E044A7F4@mac.com>
From: "Paul J. Lucas" <pauljlucas@mac.com>
To: java-user@lucene.apache.org
In-Reply-To: <DFB61D68-7CE4-4E22-AA2C-33B158C443A4@mikemccandless.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Fri, 30 May 2008 09:08:41 -0700
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <DFB61D68-7CE4-4E22-AA2C-33B158C443A4@mikemccandless.com>
X-Mailer: Apple Mail (2.919.2)
X-EN-UserInfo: 19b3ee6e8bc35660ab25150f3ce1009e:104eb4694f5dc54e252b420fd863a3b6
X-EN-AuthUser: paul@pauljlucas.org
Sender:  "Paul J. Lucas" <pauljlucas@mac.com>
X-EN-OrigIP: 76.204.180.63
X-EN-OrigHost: adsl-76-204-180-63.dsl.pltn13.sbcglobal.net
X-Virus-Checked: Checked by ClamAV on apache.org

On May 30, 2008, at 3:05 AM, Michael McCandless wrote:

> Are you indexing only one document each time you open IndexWriter?   
> Or do you open a single IndexWriter, add all documents for that  
> directory, then close it?

The latter.

> When the exception occurs, do you know how many simultaneous threads  
> are doing searching?  I realize you said it's extremely light load,  
> but if it's possibly a good number of threads, and combined with a  
> large mergeFactor, that would explain the exhaustion.

I don't know, but the answer is probably either 0 or 1.  I forgot if I  
mentioned this before, but there is exactly 1 client for my server.   
Most of the time, the number of queries is 0 because the client is  
quiescent.  A query only happens when the user (using the client)  
manually initiates a query.  (I don't work on the client code, so I'm  
not totally sure, but the client may also initiate several queries at  
once when getting information for all the files in a directory.  But  
even then, we're talking only about a handful of threads.)

The exception always happens when I call close() after unindexing the  
contents of a directory.

> Do you know what your descriptor limit actually is?  You can use  
> this simple JUnit test (from the upcoming Lucene in Action revision)  
> to check:

10237.

- Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34264-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 16:50:39 2008
Return-Path: <java-user-return-34264-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8915 invoked from network); 30 May 2008 16:50:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 16:50:39 -0000
Received: (qmail 94866 invoked by uid 500); 30 May 2008 16:50:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94830 invoked by uid 500); 30 May 2008 16:50:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94819 invoked by uid 99); 30 May 2008 16:50:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 09:50:33 -0700
X-ASF-Spam-Status: No, hits=0.4 required=10.0
	tests=SPF_PASS,URIBL_GREY,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of marcelo.ochoa@gmail.com designates 209.85.142.185 as permitted sender)
Received: from [209.85.142.185] (HELO ti-out-0910.google.com) (209.85.142.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 16:49:43 +0000
Received: by ti-out-0910.google.com with SMTP id b8so4055068tic.11
        for <java-user@lucene.apache.org>; Fri, 30 May 2008 09:49:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=i0rdoaJqYgY1oWDSd5T5IUwK6jf/aUkL8fsKAgyF9+M=;
        b=PSsdlFtqoUXwOzzxJl+Faj2FsWcZ+Co5h0/Ca3W819LQW/wG+1FpYzH7ZO+BF22oX1Wa51SzL6yuIuYJardGXzE181lbB/6755KVMizJvLrUn13vaSmt785oMVCF/v2boRQzy7axrZSvUi015tIfCkV3HpE2ogkmv4vzV2LaCOY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=o6921lCGWV5iDcwiwj0fJRlt5/ldIyhBmRHuwuoeWHZf29ZEzY0SytBsE+0c5PkiwU+SIYk/ajFDu4Mwtl7Z5Re2Sey1d/QmFTP4wZTP6QLg1rwRzw7hGIGQ4r5aWXW43O9QlNDulsRfzVyxm94qtwAejjLZu+mHuMPQBnUvQaQ=
Received: by 10.150.139.15 with SMTP id m15mr1506267ybd.132.1212166196448;
        Fri, 30 May 2008 09:49:56 -0700 (PDT)
Received: by 10.151.99.7 with HTTP; Fri, 30 May 2008 09:49:56 -0700 (PDT)
Message-ID: <126142c0805300949i1d10c8b3ifd95db1555101ba7@mail.gmail.com>
Date: Fri, 30 May 2008 13:49:56 -0300
From: "Marcelo Ochoa" <marcelo.ochoa@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Opening an index directory inside a jar
In-Reply-To: <17562588.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <17526678.post@talk.nabble.com> <17562588.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Ravi:
  I am  not a Lucene guru but IMO you has to write a new Directory
class which opens the jar a provides access to Lucene.
  May be a sub class of FSDirectory will work, but only for read-only behaviour.
  I have done this set of classes to implement Lucene storage inside
Oracle JVM using BLOB as storage.
  Best regards, Marcelo.

On Fri, May 30, 2008 at 1:03 PM, Ravi_116 <ravi116@gmail.com> wrote:
>
> Any ideas/suggestions ??
> Ravi
>
>
> Ravi_116 wrote:
>>
>> I get the following error trace -
>>
>> java.io.FileNotFoundException: no segments* file found in
>> org.apache.lucene.store.FSDirectory@/Users/projects/workspace/project_name/web/file:/Users/.m2/repository/com/mycompany/project_name/2.1.0-internal-65-SNAPSHOT/suggesters-2.1.0-internal-65-SNAPSHOT.jar!/luceneFiles/index:
>> files:
>>         at
>> org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:587)
>>
>> The crux of the issue seems to be that lucene cannot open segments file
>> that is inside the jar (under luceneFiles/index directory)
>>
>> The current project structure involves creating module jars in maven and
>> having a web tier module use the lucene module jar. The index files are
>> built at build time as part of lucene module project. The issue with
>> building the index separate from the application  is that a bunch of
>> unit/integration/functional tests depend on index files to be created. The
>> manual step of creating the index files breaks the automated CI builds or
>> some reliance on building the index in some tmp directory. Unfortunately
>> that approach has issues if we run tests concurrently. Also, building the
>> index takes a couple of minutes, so generating them on the fly for tests
>> is expensive and increases the build time.
>>
>> The only options suggested in the forums is to do something special like
>> extending the Directory class to open the jar. Is there another way to
>> solve this problem in an easier manner or am i missing something simple ?
>>
>> Any thoughts/suggestions are appreciated,
>>
>> Ravi
>>
>>
>>
>
> --
> View this message in context: http://www.nabble.com/Opening-an-index-directory-inside-a-jar-tp17526678p17562588.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 
Marcelo F. Ochoa
http://marceloochoa.blogspot.com/
http://marcelo.ochoa.googlepages.com/home
______________
Do you Know DBPrism? Look @ DB Prism's Web Site
http://www.dbprism.com.ar/index.html
More info?
Chapter 17 of the book "Programming the Oracle Database using Java &
Web Services"
http://www.amazon.com/gp/product/1555583296/
Chapter 21 of the book "Professional XML Databases" - Wrox Press
http://www.amazon.com/gp/product/1861003587/
Chapter 8 of the book "Oracle & Open Source" - O'Reilly
http://www.oreilly.com/catalog/oracleopen/

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34265-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 16:55:08 2008
Return-Path: <java-user-return-34265-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11420 invoked from network); 30 May 2008 16:55:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 16:55:08 -0000
Received: (qmail 1629 invoked by uid 500); 30 May 2008 16:55:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1601 invoked by uid 500); 30 May 2008 16:55:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1589 invoked by uid 99); 30 May 2008 16:55:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 09:55:02 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.142.187 as permitted sender)
Received: from [209.85.142.187] (HELO ti-out-0910.google.com) (209.85.142.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 16:54:14 +0000
Received: by ti-out-0910.google.com with SMTP id b8so4080287tic.11
        for <java-user@lucene.apache.org>; Fri, 30 May 2008 09:54:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=2cKNgMW7K2OSAUPwFvYCD2jAq6iSd1lAtG5BX1jR0oA=;
        b=N4I5E00VetdZ6lyjz3oEIOLuy1NCSKNLqvaeqRvx3YkpeqNI8zRQDH5K23drUeKNQV/h+IvFbG0YIh6N1VQdkEag45L3MU1BG1cNtUXD24PbEZJkIjhrQk/iRjJ2ahyGy4k04UDkeTMtlSputjjXKbUKh5Xn1oO9ExG9bagAq1Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=MYA+pPXXXMUN1KSwIbal7sz5kbzJly2l5AE09HJ+TPKZ3/9V1zt4Yc80dYRJHE1FfAXg02l0NmjeJ/AtIk+rg2H7Rfr7YNSymN90H0vWvh5dSXTpcQpxiNEr7CyWWMFGvQ6+pNSEYohFkzQfEygg33gpHQF6N2NG2OcADkkU0wU=
Received: by 10.150.217.18 with SMTP id p18mr1314140ybg.67.1212166468334;
        Fri, 30 May 2008 09:54:28 -0700 (PDT)
Received: from ?192.168.1.106? ( [69.124.234.149])
        by mx.google.com with ESMTPS id q18sm87427qbq.23.2008.05.30.09.54.27
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 30 May 2008 09:54:27 -0700 (PDT)
Message-ID: <48403142.1080808@gmail.com>
Date: Fri, 30 May 2008 12:54:26 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.14 (X11/20080505)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <DFB61D68-7CE4-4E22-AA2C-33B158C443A4@mikemccandless.com> <362F48B4-D7FC-4784-A82B-9294E044A7F4@mac.com>
In-Reply-To: <362F48B4-D7FC-4784-A82B-9294E044A7F4@mac.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Paul J. Lucas wrote:
> On May 30, 2008, at 3:05 AM, Michael McCandless wrote:
>
>> Are you indexing only one document each time you open IndexWriter?  
>> Or do you open a single IndexWriter, add all documents for that 
>> directory, then close it?
>
> The latter.
>
>> When the exception occurs, do you know how many simultaneous threads 
>> are doing searching?  I realize you said it's extremely light load, 
>> but if it's possibly a good number of threads, and combined with a 
>> large mergeFactor, that would explain the exhaustion.
>
> I don't know, but the answer is probably either 0 or 1.  I forgot if I 
> mentioned this before, but there is exactly 1 client for my server.  
> Most of the time, the number of queries is 0 because the client is 
> quiescent.  A query only happens when the user (using the client) 
> manually initiates a query.  (I don't work on the client code, so I'm 
> not totally sure, but the client may also initiate several queries at 
> once when getting information for all the files in a directory.  But 
> even then, we're talking only about a handful of threads.)
>
> The exception always happens when I call close() after unindexing the 
> contents of a directory.
>
>> Do you know what your descriptor limit actually is?  You can use this 
>> simple JUnit test (from the upcoming Lucene in Action revision) to 
>> check:
>
> 10237.
>
> - Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

Too many files open is def not the issue then. Actually, I can only get 
a segments file missing with too many files, not one of the other files 
as you are seeing. I cant get your exception unless I use two 
IndexWriters to corrupt the index.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34266-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 18:42:43 2008
Return-Path: <java-user-return-34266-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61681 invoked from network); 30 May 2008 18:42:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 18:42:43 -0000
Received: (qmail 39693 invoked by uid 500); 30 May 2008 18:42:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39661 invoked by uid 500); 30 May 2008 18:42:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39650 invoked by uid 99); 30 May 2008 18:42:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 11:42:37 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 18:41:40 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1K29YA-0000DZ-Oa
	for java-user@lucene.apache.org; Fri, 30 May 2008 11:42:02 -0700
Message-ID: <17565662.post@talk.nabble.com>
Date: Fri, 30 May 2008 11:42:02 -0700 (PDT)
From: vatsan <juggernautvatsan@gmail.com>
To: java-user@lucene.apache.org
Subject: Lucene Web Service - Client Program
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: juggernautvatsan@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


I am new to web services.

This is the situation:

We have a document/corpus indexed by Lucene and say it resides on
C:\Lucene\Index

We are hosting Lucene as a web service (following the instructions provided
at www.lucene-ws.net) where I have provided the information regarding the
index directory and stuff and started lucene.war as a webservice.


I am required to query the indices created, using search terms, from a
remote client using the Lucene Web Services API.

However, there is not enough information available on their website for a
newbie like me to be able to figure this out.

Any pointers will be very helpful.

What I am looking for is some sample code to call any function in the Lucene
Web Service API.
For example:

public String[] queryIndex(String searchTerm)
{
        // Call any function in the Lucene Search API

       //  Parse the returned result? (I believe this is in the XML form?
How do i obtain it as text?

       // return the result as say a collection of strings??
}

(I am not familiar with the GET/POST methods, so kindly be a little verbose
if you are referring to these methods in your response.)

Thank you very much.
vatsan.
-- 
View this message in context: http://www.nabble.com/Lucene-Web-Service---Client-Program-tp17565662p17565662.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34267-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 18:51:49 2008
Return-Path: <java-user-return-34267-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68105 invoked from network); 30 May 2008 18:51:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 18:51:49 -0000
Received: (qmail 50216 invoked by uid 500); 30 May 2008 18:51:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50177 invoked by uid 500); 30 May 2008 18:51:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50166 invoked by uid 99); 30 May 2008 18:51:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 11:51:44 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.24] (HELO smtp-vbr4.xs4all.nl) (194.109.24.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 18:50:55 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr4.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4UIpAI3022049
	for <java-user@lucene.apache.org>; Fri, 30 May 2008 20:51:10 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: SpanNearQuery: how to get the "intra-span" matching positions?
Date: Fri, 30 May 2008 20:51:10 +0200
User-Agent: KMail/1.9.9
References: <b1f4be6c0805300712hdbc9cj80845dc4ab7f768c@mail.gmail.com>
In-Reply-To: <b1f4be6c0805300712hdbc9cj80845dc4ab7f768c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200805302051.10287.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Op Friday 30 May 200812:10 schreef Claudio Corsi:
> Hi all,
> I'm querying my index with a SpanNearQuery built on top of some
> SpanOrQuery. Now, the Spans object I get form the SpanNearQuery
> instance returns me back the sequence of text spans, each defined by
> their starting/ending positions. I'm wondering if there is a simple
> way to get not only the start/end positions of the entire span, but
> the single matching positions inside such span.  For example, suppose
> that a SpanNearQuery composed by 3 SpanTermQuery 
> (with a slop of K) produce as resulting span the terms sequence: <t0
> t1 t2 t3 .... t100> (so start() == 0, end() == 100). I know that for
> sure t0 and t100 have generated a match, since the span is "minimal"
> (right?). 

Right. But make sure to test, some less than straightforward situations
are possible when matching spans. For example, the subqueries may
be SpanNearQuery's themselves instead of SpanTermQuery's.

> But I also know that there is a 3th match somewhere in the 
> span (I have 3 SpanTermQuery that have to match). Is there a way to
> discover it?

To get this information, you'll have to extend NearSpansOrdered and
NearSpansUnordered (package private classes in o.a.l.search.spans)
to also provide for example an int[] with the actual 
matching 'positions', or subspans each with their own begin and end.
This is fairly straightforward, but to actually use such positions
SpanScorer will also need to be extended or even replaced.

In case you want to continue this discussion, please do so
on java-dev.

Regards,
Paul Elschot.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34268-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 21:19:22 2008
Return-Path: <java-user-return-34268-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46618 invoked from network); 30 May 2008 21:19:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 21:19:21 -0000
Received: (qmail 17310 invoked by uid 500); 30 May 2008 21:19:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17275 invoked by uid 500); 30 May 2008 21:19:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17264 invoked by uid 99); 30 May 2008 21:19:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 14:19:15 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [69.89.18.155] (HELO outbound-mail-35.bluehost.com) (69.89.18.155)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 30 May 2008 21:18:25 +0000
Received: (qmail 22448 invoked by uid 0); 30 May 2008 21:18:38 -0000
Received: from unknown (HELO box108.bluehost.com) (69.89.22.108)
  by outboundproxy2.bluehost.com with SMTP; 30 May 2008 21:18:38 -0000
Received: from c-71-204-121-58.hsd1.ga.comcast.net ([71.204.121.58] helo=[10.0.1.200])
	by box108.bluehost.com with esmtpsa (TLSv1:AES128-SHA:128)
	(Exim 4.68)
	(envelope-from <emmanuel@hibernate.org>)
	id 1K2Bzi-0008Bj-A5
	for java-user@lucene.apache.org; Fri, 30 May 2008 15:18:38 -0600
Message-Id: <A4162CCC-C857-4B1A-B6F3-145C36EDA92F@hibernate.org>
From: Emmanuel Bernard <emmanuel@hibernate.org>
To: java-user@lucene.apache.org
In-Reply-To: <BAY112-W3A5649B0A37EEE9E2F9B5F9BF0@phx.gbl>
Content-Type: text/plain; charset=WINDOWS-1252; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v924)
Subject: Re: Improving search performance
Date: Fri, 30 May 2008 17:18:37 -0400
References: <BAY112-W4466FFA10841E02A9ACE2AF9C30@phx.gbl> <57D07470-589F-4965-95A3-50157474E222@hibernate.org> <BAY112-W3A5649B0A37EEE9E2F9B5F9BF0@phx.gbl>
X-Mailer: Apple Mail (2.924)
X-Identified-User: {1307:box108.bluehost.com:emmanue2:emmanuelbernard.com} {sentby:smtp auth 71.204.121.58 authed with oss+emmanuelbernard.com}
DomainKey-Status: no signature
X-Virus-Checked: Checked by ClamAV on apache.org

Not the IndexSearch directly but you can pool the underlying =20
IndexReaders which should lead to the same order of performance. You =20
need to implement a ReaderProvider implementation (see =20
SharedReaderProvider or NotSharedReaderProvider as example) and use =20
hibernate.search.reader.strategy to define your ReaderProvider =20
classname.

Let's continue the conversation if needed here =
http://forum.hibernate.org/viewtopic.php?t=3D987104
Emmanuel

On  May 29, 2008, at 10:49, Rakesh Shete wrote:

>
> Hi Emmanuel,
>
> Thanks for sparing time for this. Atleast now it looks like the =20
> problem is clear. I will definitley try the pooled IndexSearch =20
> approach.
>
> Could you let me know if there is a way of providing the =20
> indexsearcher instance to the Hibernate Search FullTextQuery API?
>
> If that's not possible then probably I will have to use Lucene APIs =20=

> directly. Atleast from this thread it seems to be so:
> http://forum.hibernate.org/viewtopic.php?t=3D987104
>
> --Rakesh S
>
>
>> From: emmanuel@hibernate.org
>> To: java-user@lucene.apache.org
>> Subject: Re: Improving search performance
>> Date: Thu, 29 May 2008 02:22:19 -0400
>>
>> Hi Rakesh,
>> I've spend the afternoon and the evening playing around your test
>> because I could not stand Hibernate Search to be significantly slower
>> than native Lucene ;)
>> I found several causes but as far as your test case is concerned, it
>> turns out you are reaching the scalability limit of a single
>> IndexSearcher as Otis mentioned a couple of emails ago. 100 threads =20=

>> in
>> parallel are too much. You are better off using a pool of =20
>> IndexSearcher.
>>
>> How much? It's hard to say, because the less  IndexSearchers, the
>> better you benefit from the warm up effect. I guess the optimal value
>> depends on your index size and the number of expected concurrent
>> threads. Give it a try with different values.
>>
>> Not related to this thread specifically but I have kept notes of some
>> ideas to bring back HSearch and Lucene neck to neck performance wise.
>> I've also explained there why your HSearch vs Lucene perf test was =20=

>> not
>> fair.
>> http://opensource.atlassian.com/projects/hibernate/browse/HSEARCH-194
>>
>> HTH
>>
>> Emmanuel
>>
>> On  May 25, 2008, at 04:53, Rakesh Shete wrote:
>>
>>>
>>> Hi ,
>>>
>>> I have written a program to simulate the multi-thread behavior and
>>> check the performance.
>>> I have attached the program and results.
>>>
>>> The JVM parameters when running the program: -Xms128m -Xmx1028m on a
>>> P4 2.66 Ghz, 1.99GB RAM machine.
>>>
>>> Here are the observations:
>>> 1. The response time to fire a query and return back increases as
>>> the number of threads increases: from 10-100 (I haven=92t used any
>>> threadpool. JVM default behavior is used)
>>> 2. After optimizing the index, the response time improved
>>> significantly. Like in case of 100 threads, the average response
>>> time, using optimized index, is between 1-1.3 seconds as compared to
>>> 4-5.5 seconds using the non-optimized index
>>>
>>> Is there anything else that I should be looking into to further
>>> improve the performance?
>>>
>>> --Rakesh S
>>>
>>>> Date: Fri, 23 May 2008 20:24:03 -0700
>>>> From: otis_gospodnetic@yahoo.com
>>>> Subject: Re: Improving search performance
>>>> To: java-user@lucene.apache.org
>>>>
>>>> Hi Emmanuel,
>>>>
>>>> Because there are some synchronized methods, like the one that
>>>> checks whether a doc is deleted, that get called during search. If
>>>> you have a pile of threads (op. p. mentioned 100 threads) there
>>>> could be contention around those methods.
>>>>
>>>> Otis
>>>> --
>>>> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>>>>
>>>>
>>>> ----- Original Message ----
>>>>> From: Emmanuel Bernard
>>>>> To: java-user@lucene.apache.org
>>>>> Sent: Friday, May 23, 2008 6:41:36 PM
>>>>> Subject: Re: Improving search performance
>>>>>
>>>>> Hi
>>>>> Hibernate Search does not pool the Searcher but pools the =20
>>>>> underlying
>>>>> IndexReader(s). =46rom what i've seen, a Searcher is stateless and =
=20
>>>>> all
>>>>> the state is kept in the Readers. so this essentially is
>>>>> equivalent to
>>>>> reusing the searcher.
>>>>>
>>>>> Out of curiosity why is a pool of Searcher more efficient?
>>>>>
>>>>> Emmanuel
>>>>>
>>>>> On May 22, 2008, at 13:22, Otis Gospodnetic wrote:
>>>>>
>>>>>> Some quick feedback. Those are all very expensive queries
>>>>>> (wildcards and ranges). The first thing I'd do is try without
>>>>>> Hibernate Search (to make sure HS is not the bottleneck). 100
>>>>>> threads is a lot, I'm guessing you are reusing your searcher, =20
>>>>>> which
>>>>>> is good, but you will actually improve performance a bit if you
>>>>>> work
>>>>>> with a small pool of searchers instead of a single searcher.
>>>>>>
>>>>>> Otis
>>>>>> --
>>>>>> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>>>>>>
>>>>>>
>>>>>> ----- Original Message ----
>>>>>>> From: Rakesh Shete
>>>>>>> To: java-user-info@lucene.apache.org; java-=20
>>>>>>> user@lucene.apache.org
>>>>>>> Sent: Thursday, May 22, 2008 1:16:13 PM
>>>>>>> Subject: Improving search performance
>>>>>>>
>>>>>>>
>>>>>>> Hi all,
>>>>>>>
>>>>>>> I have index of size 85MB. My query looks as follows:
>>>>>>>
>>>>>>> +(t:boss* d:boss* dd:boss* tg:boss*) +st:act +ntid:0 +cid:1 +dr:
>>>>>>> [20080410 TO
>>>>>>> 20081010] +rT:[002 TO 005]
>>>>>>>
>>>>>>> All the fields used in the query are stored in the indexes
>>>>>>> (Indexed
>>>>>>> & Stored)
>>>>>>>
>>>>>>> The query response time for me is around 30 seconds when running
>>>>>>> mutliple
>>>>>>> simultanoeous threads (~100). The no. of matches is ~30k but I
>>>>>>> retrieve only the
>>>>>>> top 100 results. I am using Hibernate Search which is a wrapper
>>>>>>> around Lucene. I
>>>>>>> retrieve the "id" filed from the index which is also indexex and
>>>>>>> stored.
>>>>>>>
>>>>>>> What is the approach that I should take for improving the
>>>>>>> performance?
>>>>>>>
>>>>>>> Will just indexing the values without storing them work (Index &
>>>>>>> UnStored)?
>>>>>>>
>>>>>>> My machine configuration is:
>>>>>>> P4 2.66GHz 1.99 GB RAM
>>>>>>>
>>>>>>> The code for searching runs in JBoss application server which
>>>>>>> has a
>>>>>>> maximum heap
>>>>>>> size of 1024MB. When these 100 threads are running in the
>>>>>>> application server the
>>>>>>> CPU utilization is 100% and JBoss consumes all of the heap size.
>>>>>>>
>>>>>>> Any pointers on index optimization would be really appreciated.
>>>>>>>
>>>>>>> --Regards,
>>>>>>> Rakesh Shete
>>>>>>>
>>>>>>> =
_________________________________________________________________
>>>>>>> No Harvard, No Oxford. We are here. Find out !!
>>>>>>> http://ss1.richmedia.in/recurl.asp?pid=3D500
>>>>>>
>>>>>>
>>>>>> =
---------------------------------------------------------------------
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>
>>>>>
>>>>> =
---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>> =
---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>> _________________________________________________________________
>>> Catch the latest fashion shows, get beauty tips and learn more on
>>> fashion and lifestyle.
>>> http://video.msn.com/?mkt=3Den-in<Performance
>>> logs
>>> .zip
>>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
> _________________________________________________________________
> 2000 Placements last year. Are You next ? Find out
> http://ss1.richmedia.in/recurl.asp?pid=3D499


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34269-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri May 30 21:36:25 2008
Return-Path: <java-user-return-34269-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60327 invoked from network); 30 May 2008 21:36:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 May 2008 21:36:24 -0000
Received: (qmail 39033 invoked by uid 500); 30 May 2008 21:36:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38999 invoked by uid 500); 30 May 2008 21:36:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38988 invoked by uid 99); 30 May 2008 21:36:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 14:36:19 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [66.249.82.233] (HELO wx-out-0506.google.com) (66.249.82.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 21:35:30 +0000
Received: by wx-out-0506.google.com with SMTP id h29so40385wxd.20
        for <java-user@lucene.apache.org>; Fri, 30 May 2008 14:35:45 -0700 (PDT)
Received: by 10.90.78.10 with SMTP id a10mr6599252agb.58.1212183344842;
        Fri, 30 May 2008 14:35:44 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 3sm722316hsw.13.2008.05.30.14.35.44
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 30 May 2008 14:35:44 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <362F48B4-D7FC-4784-A82B-9294E044A7F4@mac.com>
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <DFB61D68-7CE4-4E22-AA2C-33B158C443A4@mikemccandless.com> <362F48B4-D7FC-4784-A82B-9294E044A7F4@mac.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <5CBBC2CB-97F8-49C3-BC0A-A881A918EEEA@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Fri, 30 May 2008 17:35:43 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Paul,

What is your mergeFactor set to?

Can you get the exception to happen with infoStream set on the  
writer, and post that back?

Mike

Paul J. Lucas wrote:

> On May 30, 2008, at 3:05 AM, Michael McCandless wrote:
>
>> Are you indexing only one document each time you open  
>> IndexWriter?  Or do you open a single IndexWriter, add all  
>> documents for that directory, then close it?
>
> The latter.
>
>> When the exception occurs, do you know how many simultaneous  
>> threads are doing searching?  I realize you said it's extremely  
>> light load, but if it's possibly a good number of threads, and  
>> combined with a large mergeFactor, that would explain the exhaustion.
>
> I don't know, but the answer is probably either 0 or 1.  I forgot  
> if I mentioned this before, but there is exactly 1 client for my  
> server.  Most of the time, the number of queries is 0 because the  
> client is quiescent.  A query only happens when the user (using the  
> client) manually initiates a query.  (I don't work on the client  
> code, so I'm not totally sure, but the client may also initiate  
> several queries at once when getting information for all the files  
> in a directory.  But even then, we're talking only about a handful  
> of threads.)
>
> The exception always happens when I call close() after unindexing  
> the contents of a directory.
>
>> Do you know what your descriptor limit actually is?  You can use  
>> this simple JUnit test (from the upcoming Lucene in Action  
>> revision) to check:
>
> 10237.
>
> - Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34270-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 31 01:00:20 2008
Return-Path: <java-user-return-34270-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26574 invoked from network); 31 May 2008 01:00:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 31 May 2008 01:00:20 -0000
Received: (qmail 86744 invoked by uid 500); 31 May 2008 01:00:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86718 invoked by uid 500); 31 May 2008 01:00:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86707 invoked by uid 99); 31 May 2008 01:00:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 18:00:15 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [66.249.82.224] (HELO wx-out-0506.google.com) (66.249.82.224)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 00:59:25 +0000
Received: by wx-out-0506.google.com with SMTP id h29so82146wxd.20
        for <java-user@lucene.apache.org>; Fri, 30 May 2008 17:59:41 -0700 (PDT)
Received: by 10.70.38.16 with SMTP id l16mr7247294wxl.50.1212195580596;
        Fri, 30 May 2008 17:59:40 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 39sm826888hse.15.2008.05.30.17.59.40
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 30 May 2008 17:59:40 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <362F48B4-D7FC-4784-A82B-9294E044A7F4@mac.com>
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <DFB61D68-7CE4-4E22-AA2C-33B158C443A4@mikemccandless.com> <362F48B4-D7FC-4784-A82B-9294E044A7F4@mac.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <8DB9ACD7-FAFA-4375-B893-649AA4E7875C@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Fri, 30 May 2008 20:59:40 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Paul,

One more question: when you hit that exception, does the offending  
file in fact not exist (when you list the directory yourself)?

And, does the exception keep happening consistently (same file  
missing) once that happens, or, does the same index work fine the  
next time you try it (ie, the exception is intermittent)?

Mike

Paul J. Lucas wrote:

> On May 30, 2008, at 3:05 AM, Michael McCandless wrote:
>
>> Are you indexing only one document each time you open  
>> IndexWriter?  Or do you open a single IndexWriter, add all  
>> documents for that directory, then close it?
>
> The latter.
>
>> When the exception occurs, do you know how many simultaneous  
>> threads are doing searching?  I realize you said it's extremely  
>> light load, but if it's possibly a good number of threads, and  
>> combined with a large mergeFactor, that would explain the exhaustion.
>
> I don't know, but the answer is probably either 0 or 1.  I forgot  
> if I mentioned this before, but there is exactly 1 client for my  
> server.  Most of the time, the number of queries is 0 because the  
> client is quiescent.  A query only happens when the user (using the  
> client) manually initiates a query.  (I don't work on the client  
> code, so I'm not totally sure, but the client may also initiate  
> several queries at once when getting information for all the files  
> in a directory.  But even then, we're talking only about a handful  
> of threads.)
>
> The exception always happens when I call close() after unindexing  
> the contents of a directory.
>
>> Do you know what your descriptor limit actually is?  You can use  
>> this simple JUnit test (from the upcoming Lucene in Action  
>> revision) to check:
>
> 10237.
>
> - Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34271-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 31 03:36:31 2008
Return-Path: <java-user-return-34271-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60791 invoked from network); 31 May 2008 03:36:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 31 May 2008 03:36:30 -0000
Received: (qmail 62253 invoked by uid 500); 31 May 2008 03:36:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62218 invoked by uid 500); 31 May 2008 03:36:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62207 invoked by uid 99); 31 May 2008 03:36:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 20:36:26 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [69.12.216.205] (HELO theronge.com) (69.12.216.205)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 03:35:28 +0000
Received: from [192.168.1.101] (adsl-76-227-78-39.dsl.chmpil.sbcglobal.net [76.227.78.39])
	(Authenticated sender: mronge)
	by theronge.com (Postfix) with ESMTP id 6DEA664470;
	Fri, 30 May 2008 20:35:48 -0700 (PDT)
Cc: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Message-Id: <35384698-7DB7-438C-BD00-D1D3508CA429@theronge.com>
From: Matt Ronge <mronge@theronge.com>
To: java-user@lucene.apache.org
In-Reply-To: <479722.35659.qm@web50312.mail.re2.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: distributed lucene progress
Date: Fri, 30 May 2008 22:35:47 -0500
References: <479722.35659.qm@web50312.mail.re2.yahoo.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org


On May 21, 2008, at 3:19 PM, Otis Gospodnetic wrote:

> No, that's a separate project on SF, IIRC.

I am also interested in distributed lucene. I took a look on Hadoop's  
wiki and found this: http://wiki.apache.org/hadoop/DistributedLucene?highlight=%28distributed%29

which leads to many different projects:

- Baily project: http://sourceforge.net/projects/bailey
- Katta project: http://sourceforge.net/projects/katta
- Mark Butler's patch: https://issues.apache.org/jira/browse/HADOOP-3394
- Ning Li's distributed indexing patch: https://issues.apache.org/jira/browse/HADOOP-2951

and it seems there is some support in Nutch for distributed searching  
as well.

Does anyone know if these efforts are being consolidated right now?  
I'd like to use and work on distributed lucene, but with so many  
different fronts I'm not sure where to begin.

Any pointers? Where is most working being done? Has anyone used any of  
this code?
--
Matt

>
>
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
> ----- Original Message ----
>> From: John Wang <john.wang@gmail.com>
>> To: java-user@lucene.apache.org
>> Sent: Wednesday, May 21, 2008 11:46:02 AM
>> Subject: Re: distributed lucene progress
>>
>> I see. So is it then the bailey project?
>> -John
>>
>> On Tue, May 20, 2008 at 9:04 PM, Otis Gospodnetic <
>> otis_gospodnetic@yahoo.com> wrote:
>>
>>> Oh, it very much did.  Check Hadoop Wiki's "Recent Changes", it's  
>>> there.
>>>
>>>
>>> Otis
>>> --
>>> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>>>
>>>
>>> ----- Original Message ----
>>>> From: Chris Hostetter
>>>> To: java-user@lucene.apache.org
>>>> Sent: Tuesday, May 20, 2008 5:58:08 PM
>>>> Subject: Re: distributed lucene progress
>>>>
>>>> :    What is the current status on the distributed lucene project
>>> proposed at:
>>>> :
>>>> : http://www.mail-archive.com/general@lucene.apache.org/msg00338.html
>>>>
>>>> I don't think it ever got passed the initial idea stage ... or,  
>>>> if it
>>> did:
>>>> I haven't heard about it.
>>>>
>>>>
>>>> -Hoss
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34272-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 31 03:57:42 2008
Return-Path: <java-user-return-34272-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64137 invoked from network); 31 May 2008 03:57:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 31 May 2008 03:57:42 -0000
Received: (qmail 70439 invoked by uid 500); 31 May 2008 03:57:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70398 invoked by uid 500); 31 May 2008 03:57:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70384 invoked by uid 99); 31 May 2008 03:57:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 May 2008 20:57:37 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.39.214] (HELO web50312.mail.re2.yahoo.com) (206.190.39.214)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 31 May 2008 03:56:40 +0000
Received: (qmail 74333 invoked by uid 60001); 31 May 2008 03:57:01 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=UpPxzGJAJ8mIn2HCB3ub6pY44u7pyEMaqej5T5drqN+jrAuK+9LB0qZ4TQaK761ssjd6bA+H41ueoRjJMr2Sei06wbxNjejOWxwRxV/ILy6I+OEj5ZLuQoXj25+IHLDCH72ZzjAzWlvwF95vYLHbLn2U9/uG04tsgP+9iS8xZvA=;
Received: from [72.231.9.236] by web50312.mail.re2.yahoo.com via HTTP; Fri, 30 May 2008 20:57:00 PDT
X-Mailer: YahooMailRC/975.42 YahooMailWebService/0.7.199
Date: Fri, 30 May 2008 20:57:00 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Lucene Web Service - Client Program
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <977514.73062.qm@web50312.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Vatsan, are you aware of Solr?
http://lucene.apache.org/solr 

Have a look (and look for solrj - it's a Solr java client)

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch


----- Original Message ----
> From: vatsan <juggernautvatsan@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Friday, May 30, 2008 2:42:02 PM
> Subject: Lucene Web Service - Client Program
> 
> 
> I am new to web services.
> 
> This is the situation:
> 
> We have a document/corpus indexed by Lucene and say it resides on
> C:\Lucene\Index
> 
> We are hosting Lucene as a web service (following the instructions provided
> at www.lucene-ws.net) where I have provided the information regarding the
> index directory and stuff and started lucene.war as a webservice.
> 
> 
> I am required to query the indices created, using search terms, from a
> remote client using the Lucene Web Services API.
> 
> However, there is not enough information available on their website for a
> newbie like me to be able to figure this out.
> 
> Any pointers will be very helpful.
> 
> What I am looking for is some sample code to call any function in the Lucene
> Web Service API.
> For example:
> 
> public String[] queryIndex(String searchTerm)
> {
>         // Call any function in the Lucene Search API
> 
>        //  Parse the returned result? (I believe this is in the XML form?
> How do i obtain it as text?
> 
>        // return the result as say a collection of strings??
> }
> 
> (I am not familiar with the GET/POST methods, so kindly be a little verbose
> if you are referring to these methods in your response.)
> 
> Thank you very much.
> vatsan.
> -- 
> View this message in context: 
> http://www.nabble.com/Lucene-Web-Service---Client-Program-tp17565662p17565662.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34273-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 31 07:22:41 2008
Return-Path: <java-user-return-34273-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5777 invoked from network); 31 May 2008 07:22:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 31 May 2008 07:22:41 -0000
Received: (qmail 43957 invoked by uid 500); 31 May 2008 07:22:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43923 invoked by uid 500); 31 May 2008 07:22:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43911 invoked by uid 99); 31 May 2008 07:22:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 00:22:37 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [17.148.16.68] (HELO smtpoutm.mac.com) (17.148.16.68)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 07:21:42 +0000
Received: from asmtp011-bge351000 (asmtp011-bge351000 [10.150.69.74])
	by smtpoutm.mac.com (Xserve/smtpout005/MantshX 4.0) with ESMTP id m4V7M3pg002874
	for <java-user@lucene.apache.org>; Sat, 31 May 2008 00:22:03 -0700 (PDT)
MIME-version: 1.0
Content-transfer-encoding: 7BIT
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Received: from [10.0.1.203]
 (adsl-76-204-180-63.dsl.pltn13.sbcglobal.net [76.204.180.63])
 by asmtp011.mac.com
 (Sun Java(tm) System Messaging Server 6.3-6.03 (built Mar 14 2008; 32bit))
 with ESMTPSA id <0K1Q005X21SG2I50@asmtp011.mac.com> for
 java-user@lucene.apache.org; Sat, 31 May 2008 00:22:03 -0700 (PDT)
Message-id: <3AC25712-1DAF-482E-90CD-2C04AE1456F9@mac.com>
From: "Paul J. Lucas" <pauljlucas@mac.com>
To: java-user@lucene.apache.org
In-reply-to: <8DB9ACD7-FAFA-4375-B893-649AA4E7875C@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Sat, 31 May 2008 00:21:51 -0700
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com>
 <DFB61D68-7CE4-4E22-AA2C-33B158C443A4@mikemccandless.com>
 <362F48B4-D7FC-4784-A82B-9294E044A7F4@mac.com>
 <8DB9ACD7-FAFA-4375-B893-649AA4E7875C@mikemccandless.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Checked: Checked by ClamAV on apache.org

On May 30, 2008, at 5:59 PM, Michael McCandless wrote:

> One more question: when you hit that exception, does the offending  
> file in fact not exist (when you list the directory yourself)?

Yes, the file does not exist.

> And, does the exception keep happening consistently (same file  
> missing) once that happens ... ?

Yes.

- Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34274-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 31 08:23:54 2008
Return-Path: <java-user-return-34274-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14607 invoked from network); 31 May 2008 08:23:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 31 May 2008 08:23:50 -0000
Received: (qmail 67028 invoked by uid 500); 31 May 2008 08:23:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66995 invoked by uid 500); 31 May 2008 08:23:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66983 invoked by uid 99); 31 May 2008 08:23:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 01:23:45 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [74.125.46.30] (HELO yw-out-2324.google.com) (74.125.46.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 08:22:55 +0000
Received: by yw-out-2324.google.com with SMTP id 3so86733ywj.5
        for <java-user@lucene.apache.org>; Sat, 31 May 2008 01:23:11 -0700 (PDT)
Received: by 10.150.212.16 with SMTP id k16mr11245116ybg.81.1212222190868;
        Sat, 31 May 2008 01:23:10 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id 5sm997673ywd.2.2008.05.31.01.23.10
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 31 May 2008 01:23:10 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <3AC25712-1DAF-482E-90CD-2C04AE1456F9@mac.com>
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <DFB61D68-7CE4-4E22-AA2C-33B158C443A4@mikemccandless.com> <362F48B4-D7FC-4784-A82B-9294E044A7F4@mac.com> <8DB9ACD7-FAFA-4375-B893-649AA4E7875C@mikemccandless.com> <3AC25712-1DAF-482E-90CD-2C04AE1456F9@mac.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <3D8873F4-B047-465A-A0D9-4255C44D1380@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Sat, 31 May 2008 04:23:10 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


OK.

What is your mergeFactor?

Mike

Paul J. Lucas wrote:

> On May 30, 2008, at 5:59 PM, Michael McCandless wrote:
>
>> One more question: when you hit that exception, does the offending  
>> file in fact not exist (when you list the directory yourself)?
>
> Yes, the file does not exist.
>
>> And, does the exception keep happening consistently (same file  
>> missing) once that happens ... ?
>
> Yes.
>
> - Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34275-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 31 09:07:09 2008
Return-Path: <java-user-return-34275-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20447 invoked from network); 31 May 2008 09:07:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 31 May 2008 09:07:08 -0000
Received: (qmail 83265 invoked by uid 500); 31 May 2008 09:07:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83223 invoked by uid 500); 31 May 2008 09:07:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83212 invoked by uid 99); 31 May 2008 09:07:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 02:07:05 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.132.240] (HELO an-out-0708.google.com) (209.85.132.240)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 09:06:16 +0000
Received: by an-out-0708.google.com with SMTP id c37so116948anc.49
        for <java-user@lucene.apache.org>; Sat, 31 May 2008 02:06:31 -0700 (PDT)
Received: by 10.100.178.7 with SMTP id a7mr10812787anf.73.1212224791742;
        Sat, 31 May 2008 02:06:31 -0700 (PDT)
Received: from ?10.17.4.4? ( [72.93.214.93])
        by mx.google.com with ESMTPS id c14sm4650528ana.4.2008.05.31.02.06.30
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 31 May 2008 02:06:31 -0700 (PDT)
Mime-Version: 1.0 (Apple Message framework v753)
In-Reply-To: <2CCE7302-3011-4852-8741-811BEA516AA5@mac.com>
References: <EEBD1ADA-C2E8-41D1-B8AE-E90DFDC090B4@mac.com> <BB1B59B4-A420-4F3C-9D68-249742F79B93@mikemccandless.com> <2CCE7302-3011-4852-8741-811BEA516AA5@mac.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <9AC25BDF-DB70-4721-9CA6-06E4FF48A97D@mikemccandless.com>
Content-Transfer-Encoding: 7bit
From: Michael McCandless <lucene@mikemccandless.com>
Subject: Re: FileNotFoundException in ConcurrentMergeScheduler
Date: Sat, 31 May 2008 05:06:31 -0400
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.753)
X-Virus-Checked: Checked by ClamAV on apache.org


Paul,

How often does your process start up?  Are you really sure that there  
can never be two instances of your process running?  If/when you  
gather the infoStream logs running up to this exception, can you also  
log when IndexReader.unLock is called?

Two writers on the same index can definitely cause the exception you  
are seeing.

I have a simple stress test running, which first indexes files in a  
set of recursive directories, and then iterates forever picking one  
dir, deleting its files and re-indexing them.  I'm matching your code  
as far as I know so far (eg, opening a new writer to do the deletes,  
and another to index the docs).  I'm running in two different unix/ 
JRE envs and so far they are running fine.

Besides changing mergeFactor, is there anything else you change on  
the IndexWriter?

Mike

Paul J. Lucas wrote:

> On May 29, 2008, at 6:26 PM, Michael McCandless wrote:
>
>> Paul J. Lucas wrote:
>>
>>> 	if ( IndexReader.isLocked( INDEX ) )
>>> 	    IndexReader.unlock( INDEX );
>>>
>>> The isLocked()/unlock() is because sometimes the server process  
>>> gets killed and leaves teh indexed locked.
>>
>> This makes me a bit nervous.  Does this only run on startup of  
>> your process, or each time you need to open the IndexWriter?
>
> Exactly once on start-up.
>
>> Could you add some logging whenever an unlock is necessary so we  
>> can double-check that you're not accidentally un-locking the lock  
>> out from under an IndexWriter (which could cause exactly this  
>> exception)?
>
> Such logging is not necessary since the unlock() is done before any  
> IndexWriter is ever created.
>
> - Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-34276-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 31 12:25:38 2008
Return-Path: <java-user-return-34276-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54297 invoked from network); 31 May 2008 12:25:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 31 May 2008 12:25:37 -0000
Received: (qmail 64937 invoked by uid 500); 31 May 2008 12:25:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64895 invoked by uid 500); 31 May 2008 12:25:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64884 invoked by uid 99); 31 May 2008 12:25:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 05:25:32 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of luz290@gmail.com designates 209.85.132.249 as permitted sender)
Received: from [209.85.132.249] (HELO an-out-0708.google.com) (209.85.132.249)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 12:24:45 +0000
Received: by an-out-0708.google.com with SMTP id c37so126420anc.49
        for <java-user@lucene.apache.org>; Sat, 31 May 2008 05:25:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=9h8KTCpaYS1MaPcFflsb1uVff6gjWMsrpNBcwBLdw9I=;
        b=P/Jrzk33ruDNI5ZJBV6ePIqxjeNXd6Ai1ulB+ObUPPKC0rEUtX8ISVysxwqjcDv1KvgH622rZcqZXxD0GQ9rDvfFBvKQWjXoquLq9VgaRp3hLhSCUxQn2AOwRkPabmIqh8vxrNo7Z+AN/LFHXn/SeugxDwkebiOHAtPMQ/D0qmA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:to:subject:mime-version:content-type;
        b=w1kZAsqItqofeymxj3mM77dFMbDdVwAOVv6tpczuwp97eL1MtqDbmGz2QPoXRa6ZUjuJcS8cejo6iwJ74u8kyBGJjT4QtQvI4Emr7rlOL03Govfy2wTRgSUKRAS6u8KQi5PIIhcoiEu3yYYsCw4091TieCm4L0B3ijG+CTlJmC4=
Received: by 10.100.14.2 with SMTP id 2mr11133102ann.37.1212236701765;
        Sat, 31 May 2008 05:25:01 -0700 (PDT)
Received: by 10.100.132.15 with HTTP; Sat, 31 May 2008 05:25:01 -0700 (PDT)
Message-ID: <cec089090805310525o27be2eb2r53f729aff5bf1087@mail.gmail.com>
Date: Sat, 31 May 2008 08:25:01 -0400
From: "lucene user" <luz290@gmail.com>
To: java-user@lucene.apache.org
Subject: Lucene search time in real production use?
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_38_12408804.1212236701759"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_38_12408804.1212236701759
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi, Folks:

What are some average search and retrieval times for Lucene queries in real
production use? Would people include relevant stuff like the number of
documents in your index, etc.?

Thanks for your help!

------=_Part_38_12408804.1212236701759--

From java-user-return-34277-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat May 31 16:28:57 2008
Return-Path: <java-user-return-34277-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21680 invoked from network); 31 May 2008 16:28:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 31 May 2008 16:28:55 -0000
Received: (qmail 58004 invoked by uid 500); 31 May 2008 16:28:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57972 invoked by uid 500); 31 May 2008 16:28:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57961 invoked by uid 99); 31 May 2008 16:28:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 09:28:51 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 194.109.24.31 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.31] (HELO smtp-vbr11.xs4all.nl) (194.109.24.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 May 2008 16:28:02 +0000
Received: from [10.0.2.2] (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr11.xs4all.nl (8.13.8/8.13.8) with ESMTP id m4VGS9g9021674
	for <java-user@lucene.apache.org>; Sat, 31 May 2008 18:28:17 +0200 (CEST)
	(envelope-from karl.wettin@gmail.com)
Message-Id: <BC783A6B-077F-4EF8-8C16-2BE3CCED447D@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <cec089090805310525o27be2eb2r53f729aff5bf1087@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v919.2)
Subject: Re: Lucene search time in real production use?
Date: Sat, 31 May 2008 18:28:09 +0200
References: <cec089090805310525o27be2eb2r53f729aff5bf1087@mail.gmail.com>
X-Mailer: Apple Mail (2.919.2)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org


31 maj 2008 kl. 14.25 skrev lucene user:
> What are some average search and retrieval times for Lucene queries  
> in real
> production use? Would people include relevant stuff like the number of
> documents in your index, etc.?
>
> Thanks for your help!

http://lucene.apache.org/java/docs/benchmarks.html

How well it works depends on many factors. What your corpus looks  
like, load on index, what sort of queries are executed, hardware, et  
c. You can estimate how your application will work by using and  
extending the benchmarker contrib tool.


          karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


