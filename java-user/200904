From java-user-return-39436-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 02:23:27 2009
Return-Path: <java-user-return-39436-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96525 invoked from network); 1 Apr 2009 02:23:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 02:23:26 -0000
Received: (qmail 71010 invoked by uid 500); 1 Apr 2009 02:23:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70933 invoked by uid 500); 1 Apr 2009 02:23:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70923 invoked by uid 99); 1 Apr 2009 02:23:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 02:23:24 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of john.wang@gmail.com designates 209.85.198.232 as permitted sender)
Received: from [209.85.198.232] (HELO rv-out-0506.google.com) (209.85.198.232)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 02:23:14 +0000
Received: by rv-out-0506.google.com with SMTP id g9so3089639rvb.5
        for <java-user@lucene.apache.org>; Tue, 31 Mar 2009 19:22:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=grLu6PgZ4RFUbg4dVI6XM7sWk1lXC2cuwZ8GQ46G5Xs=;
        b=hhnu3dFYapPVyj/hsHSyaeL7BRpQndM7+NNx0uXnqhxYtE5Pe/17tkH/rKAMYh0K8c
         ZsgjZSd4IIGWgUfy2R7aAF6ni2mD+8JTU6EGNi9kQsy8VrjK6XFCMV9dc5XRX/FLOu+O
         pFdk6S8oMS4RxgZGMcan9yneVcte96gBw16AE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ViJeZfKBDge9U5c9GzureS97k8TDU0aEjiO9idc5GNznS5/A+6k2RSiGgPtxaSRfB0
         TYJT+TlnbF2vQ2hVL71pbmlkbJfMGa45OFnyUD6aCn3KkUctE1rOAC2t2AWBdy2Q2/Hb
         emtrIz2xK6cWP/qnbFd9k1dYrsBQ+XvK0YzrM=
MIME-Version: 1.0
Received: by 10.140.136.5 with SMTP id j5mr3756807rvd.167.1238552572926; Tue, 
	31 Mar 2009 19:22:52 -0700 (PDT)
In-Reply-To: <c68e39170903311425s6ee6728dtf9f0ad05e82f0a0c@mail.gmail.com>
References: <8837fb770903311243x45d62c8bi8c2d5d22702d65f@mail.gmail.com>
	 <c68e39170903311304r76756d0rf5282dea2d750737@mail.gmail.com>
	 <8837fb770903311355g61f6ada2mcd33292562815c@mail.gmail.com>
	 <c68e39170903311425s6ee6728dtf9f0ad05e82f0a0c@mail.gmail.com>
Date: Tue, 31 Mar 2009 19:22:52 -0700
Message-ID: <8837fb770903311922g1145ab8s83357613ac54c97c@mail.gmail.com>
Subject: Re: API to get index info
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org, yonik@lucidimagination.com
Content-Type: multipart/alternative; boundary=000e0cd2900e251cc8046674feb0
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd2900e251cc8046674feb0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Excellent!

Thanks

-John

On Tue, Mar 31, 2009 at 2:25 PM, Yonik Seeley <yonik@lucidimagination.com>wrote:

> On Tue, Mar 31, 2009 at 4:55 PM, John Wang <john.wang@gmail.com> wrote:
> > Maybe I am missing something. I don't see any calls that would gimme the
> > number of segments. Are you suggesting:
> IndexCommit.getFileNames().size()?
>
> IndexReader.getSequentialSubReaders().length
>
> The stats page of Solr now displays the number of segments in the
> current index using this.
>
> -Yonik
> http://www.lucidimagination.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd2900e251cc8046674feb0--

From java-user-return-39437-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 02:24:14 2009
Return-Path: <java-user-return-39437-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96974 invoked from network); 1 Apr 2009 02:24:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 02:24:14 -0000
Received: (qmail 72732 invoked by uid 500); 1 Apr 2009 02:24:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72652 invoked by uid 500); 1 Apr 2009 02:24:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72642 invoked by uid 99); 1 Apr 2009 02:24:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 02:24:11 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of john.wang@gmail.com designates 209.85.198.232 as permitted sender)
Received: from [209.85.198.232] (HELO rv-out-0506.google.com) (209.85.198.232)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 02:24:03 +0000
Received: by rv-out-0506.google.com with SMTP id g9so3089639rvb.5
        for <java-user@lucene.apache.org>; Tue, 31 Mar 2009 19:23:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=m+I2gSgqzq5cKQFOElZF4DWGyRhYwGrUY2QDssiDh4A=;
        b=WpxkHL7aFrftyOko9hNMS/o7HfvutIxngd+6NPf9HICsUYP/sGXifjjQtx3ry1hsXV
         pEzNKPxwmHHOUKECMxGaqKOYuTMPikFf/o+VQ0Tj3rKlUO45ANPB9oU0xJrRZIP9BXPK
         8VH/846ZrIi89XDD+8VHSHw0g16yrWjVq713Y=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=FW0OjTdbvpdSxXiLDULSycT5R8tQd4yagmwSjGRe4t+X7MuVb6BGCcvuzkQGpV/Iv/
         yQX3cMsOIgFTj2aiy1C24uwZWcmrvMyOhiavMwwNylEjV1NICiGu+tZsMsMBFxWcIHBe
         T0WjEi5ZdEGXXhAvh4yOUAH48ymekdaTzGM74=
MIME-Version: 1.0
Received: by 10.141.136.4 with SMTP id o4mr3765967rvn.90.1238552622296; Tue, 
	31 Mar 2009 19:23:42 -0700 (PDT)
In-Reply-To: <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <c68e39170903311257s6cc5056boec396d6aa145c9ad@mail.gmail.com>
	 <8837fb770903311358n77aa2065o5f8f1489f319264@mail.gmail.com>
	 <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
Date: Tue, 31 Mar 2009 19:23:42 -0700
Message-ID: <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org, yonik@lucidimagination.com
Content-Type: multipart/alternative; boundary=000e0cd214f61670cc0466750127
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd214f61670cc0466750127
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

So do you think it is a good addition/change to the current api now?

-John

On Tue, Mar 31, 2009 at 2:18 PM, Yonik Seeley <yonik@lucidimagination.com>wrote:

> On Tue, Mar 31, 2009 at 4:58 PM, John Wang <john.wang@gmail.com> wrote:
> > I fail to see the difference of exposing the api to allow for a Query
> > instance to be passed in vs a DocIdSet.
>
> I was commenting specifically on your idea to allow deletion by int[]
> (docids) on the IndexWriter.
>
> DocIdSet is a different issue - it didn't exist when the conversation
> to add deleteByQuery was going on.
>
> -Yonik
> http://www.lucidimagination.com
>
>
>  In this specific case, Query is
> > essentially a factory to produce a DocIdSetIterator (or Scorer) Isn't it
> > what DocIdSet is?
> > Thanks
> >
> > -John
> >
> > On Tue, Mar 31, 2009 at 12:57 PM, Yonik Seeley
> > <yonik@lucidimagination.com>wrote:
> >
> >> On Tue, Mar 31, 2009 at 3:41 PM, John Wang <john.wang@gmail.com> wrote:
> >> > Also, can we expose  IndexWriter.deleteDocuments(int[] docids)?
> >>
> >> Exposing internal ids from the IndexWriter may not be a good idea
> >> given that they are transient.
> >>
> >>
> >> -Yonik
> >> http://www.lucidimagination.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd214f61670cc0466750127--

From java-user-return-39438-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 03:33:08 2009
Return-Path: <java-user-return-39438-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8540 invoked from network); 1 Apr 2009 03:33:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 03:33:08 -0000
Received: (qmail 33545 invoked by uid 500); 1 Apr 2009 03:33:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33496 invoked by uid 500); 1 Apr 2009 03:33:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33486 invoked by uid 99); 1 Apr 2009 03:33:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 03:33:05 +0000
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 03:32:56 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LorBr-0006O7-7J
	for java-user@lucene.apache.org; Tue, 31 Mar 2009 20:32:35 -0700
Message-ID: <22819197.post@talk.nabble.com>
Date: Tue, 31 Mar 2009 20:32:35 -0700 (PDT)
From: Bon <bonbon@unipattern.com>
To: java-user@lucene.apache.org
Subject: What is the right query syntax for matching some field's substring?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: bonbon@unipattern.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi all,

    I've a question about the query syntax statement,
    There is a lucene text field and the value of the field like
,11,12,15,16,
    if I want to query some data and the value of the field has included
some number what I like(11 or 15),
    how can I do?
    I try to give a query like (filed_name:,11,) but it can not get the
matching.

    or I must reformat the field value with some other symbol not the symbol
comma ','

Bon
-- 
View this message in context: http://www.nabble.com/What-is-the-right-query-syntax-for-matching-some-field%27s-substring--tp22819197p22819197.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39439-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 05:17:53 2009
Return-Path: <java-user-return-39439-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23635 invoked from network); 1 Apr 2009 05:17:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 05:17:52 -0000
Received: (qmail 92921 invoked by uid 500); 1 Apr 2009 05:17:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92817 invoked by uid 500); 1 Apr 2009 05:17:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92807 invoked by uid 99); 1 Apr 2009 05:17:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 05:17:49 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of nitdaiict8@gmail.com designates 209.85.198.226 as permitted sender)
Received: from [209.85.198.226] (HELO rv-out-0506.google.com) (209.85.198.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 05:17:41 +0000
Received: by rv-out-0506.google.com with SMTP id g9so3163201rvb.5
        for <java-user@lucene.apache.org>; Tue, 31 Mar 2009 22:17:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=Pq2t+yQORDQ71MJQmWPEmLP7zVNBKuYSHeDqPo44NRw=;
        b=ahjdGWLk9m/MCFWQ6jgfNNOx9NKTTpw3Gl9Y0Q3BVXcI09Dyz1nj6fAM/to135CRXk
         JPHDxhQAPElOh+Aihtk/SOG7BebJ7tAoYPVHoeMOJ3qdesEgkGBFACCHzBeqweTZ2C75
         akW3ur5mOJhS00ntp8HdVGogGb/XubsiNXnQ0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=fkXVePJjIyuzL7bxq8k4DknDsVp3002cTCkQU78TnHj7qNvAWOvTDw6N3h4TKUsFEo
         hgMwBAJB4vJMe2bDGg4z5qayVS0wnqH6igAqchYJnAKEVFnLTMZ7mGQ60HVhR2IDW+ul
         +8kPig3eEA+Azf++DqDlcTg9Cn+MdvzD5hj6s=
MIME-Version: 1.0
Received: by 10.143.10.15 with SMTP id n15mr2952597wfi.268.1238563040596; Tue, 
	31 Mar 2009 22:17:20 -0700 (PDT)
Date: Wed, 1 Apr 2009 10:47:20 +0530
Message-ID: <7284f6e20903312217v7f56eb45u4b3475c8a0330632@mail.gmail.com>
Subject: semantic vectors
From: nitin gopi <nitdaiict8@gmail.com>
To: java-user <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=001636e90eea11143a0466776eb3
X-Virus-Checked: Checked by ClamAV on apache.org

--001636e90eea11143a0466776eb3
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

hi all,
        I want to know everything about semantic vectors. I want to know how
does it indexes the documents such that the results produced are
semantically better than normal search. I also want to know how it is
different from semantic web, which uses the concept of ontologies and
metadata. It would be very helpful if somebody mail me all the study
material related to it?

Thanking You
Nitin

--001636e90eea11143a0466776eb3--

From java-user-return-39440-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 08:02:40 2009
Return-Path: <java-user-return-39440-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38197 invoked from network); 1 Apr 2009 08:02:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 08:02:40 -0000
Received: (qmail 59391 invoked by uid 500); 1 Apr 2009 08:02:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59306 invoked by uid 500); 1 Apr 2009 08:02:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59296 invoked by uid 99); 1 Apr 2009 08:02:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 08:02:37 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.198.228] (HELO rv-out-0506.google.com) (209.85.198.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 08:02:30 +0000
Received: by rv-out-0506.google.com with SMTP id g9so3233572rvb.5
        for <java-user@lucene.apache.org>; Wed, 01 Apr 2009 01:02:09 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.43.7 with SMTP id q7mr634277wfq.282.1238572929228; Wed, 01 
	Apr 2009 01:02:09 -0700 (PDT)
In-Reply-To: <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <c68e39170903311257s6cc5056boec396d6aa145c9ad@mail.gmail.com>
	 <8837fb770903311358n77aa2065o5f8f1489f319264@mail.gmail.com>
	 <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
	 <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
Date: Wed, 1 Apr 2009 04:02:09 -0400
Message-ID: <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

John,

I think this has the same problem as exposing delete by docID, ie, how
would you produce that docIdSet?

We could consider delete by Filter instead, since that exposes the
necessary getDocIdSet(IndexReader) method.

Or, with near real-time search, we could enhance it to allow deletions
via the obtained reader (the first approach doesn't).

Mike

On Tue, Mar 31, 2009 at 10:23 PM, John Wang <john.wang@gmail.com> wrote:
> So do you think it is a good addition/change to the current api now?
>
> -John
>
> On Tue, Mar 31, 2009 at 2:18 PM, Yonik Seeley <yonik@lucidimagination.com=
>wrote:
>
>> On Tue, Mar 31, 2009 at 4:58 PM, John Wang <john.wang@gmail.com> wrote:
>> > I fail to see the difference of exposing the api to allow for a Query
>> > instance to be passed in vs a DocIdSet.
>>
>> I was commenting specifically on your idea to allow deletion by int[]
>> (docids) on the IndexWriter.
>>
>> DocIdSet is a different issue - it didn't exist when the conversation
>> to add deleteByQuery was going on.
>>
>> -Yonik
>> http://www.lucidimagination.com
>>
>>
>> =A0In this specific case, Query is
>> > essentially a factory to produce a DocIdSetIterator (or Scorer) Isn't =
it
>> > what DocIdSet is?
>> > Thanks
>> >
>> > -John
>> >
>> > On Tue, Mar 31, 2009 at 12:57 PM, Yonik Seeley
>> > <yonik@lucidimagination.com>wrote:
>> >
>> >> On Tue, Mar 31, 2009 at 3:41 PM, John Wang <john.wang@gmail.com> wrot=
e:
>> >> > Also, can we expose =A0IndexWriter.deleteDocuments(int[] docids)?
>> >>
>> >> Exposing internal ids from the IndexWriter may not be a good idea
>> >> given that they are transient.
>> >>
>> >>
>> >> -Yonik
>> >> http://www.lucidimagination.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39441-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 10:04:48 2009
Return-Path: <java-user-return-39441-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7206 invoked from network); 1 Apr 2009 10:04:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 10:04:47 -0000
Received: (qmail 9019 invoked by uid 500); 1 Apr 2009 10:04:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8941 invoked by uid 500); 1 Apr 2009 10:04:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8924 invoked by uid 99); 1 Apr 2009 10:04:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 10:04:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [130.225.24.68] (HELO sbexch03.sb.statsbiblioteket.dk) (130.225.24.68)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 10:04:38 +0000
Received: from [172.18.253.199] (172.18.253.199) by
 sbexch03.sb.statsbiblioteket.dk (130.225.24.68) with Microsoft SMTP Server id
 8.1.340.0; Wed, 1 Apr 2009 12:04:15 +0200
Subject: Re: Unable to improve performance
From: Toke Eskildsen <te@statsbiblioteket.dk>
Reply-To: te@statsbiblioteket.dk
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
In-Reply-To: <49CCB361.6090104@fastmail.fm>
References: <49CCB361.6090104@fastmail.fm>
Content-Type: text/plain
Organization: Statsbiblioteket
Date: Wed, 1 Apr 2009 12:04:15 +0200
Message-ID: <1238580255.19345.365.camel@pc286>
MIME-Version: 1.0
X-Mailer: Evolution 2.22.3.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, 2009-03-27 at 12:07 +0100, Paul Taylor wrote:

[2Gb index, 7 million documents(?)]

> I ran the test a number of times with 30 threads, and max memory of 
> 3500mb I was processing 10,000 records in about 43 seconds ( 233 
> queries/second) , the index was stored on a solid state drive running on 
> a MacBook Pro (2.66 Ghz Intel Core 2 Duo, 4GB DDR). I dont really have a 
> view on whether this is a good result or not but I was keen to try a few 
> other things to see if I could improve performance further, but all my 
> efforts have had minimal effect.

You might want to try reducing the number of threads all the way down to
3 or 4 and queue pending searches instead, but I doubt it will change
much - as far as I know, the SSDs in MacBooks are quite okay with regard
to read-latency and with such a small index the system will probably
cache most of it anyway.

I can see elsewhere that you have upped the speed to 466 q/sec by
switching to NIOFSDirectory, so my guess is that you're now CPU and
memory speed bound.

You could try the freeware tool visualVM that profiles running Java
applications. It is extremely easy to use (just run it and select your
application from a list) and it will show you where the CPU-time is
used. Of course, if you're just using simple query analysis with Lucene
supplied Analyzers, there's probably not much you can do about it. On
the other hand, it might show you that you're spending a lot of time
generating queries or similar outside-Lucene-work.

> The main thing Im suprised about is I was expecting a massive difference 
> in holding the index in memory instead on disk

Solid state Drives (and disk cache) rules. Our experiments shows very
little performance increase going from SSD to RAMDirectory.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39442-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 12:57:00 2009
Return-Path: <java-user-return-39442-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6655 invoked from network); 1 Apr 2009 12:57:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 12:57:00 -0000
Received: (qmail 45916 invoked by uid 500); 1 Apr 2009 12:56:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45829 invoked by uid 500); 1 Apr 2009 12:56:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45819 invoked by uid 99); 1 Apr 2009 12:56:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 12:56:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 12:56:48 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n31CuP8O005765
	for <java-user@lucene.apache.org>; Wed, 1 Apr 2009 08:56:26 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <49D36479.5080202@informatics.jax.org>
Date: Wed, 01 Apr 2009 08:56:25 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: What is the right query syntax for matching some field's substring?
References: <22819197.post@talk.nabble.com>
In-Reply-To: <22819197.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.5.1.360522, Antispam-Engine: 2.6.1.350677, Antispam-Data: 2009.4.1.124024
X-PerlMx-Spam: Gauge=IIIIIII, Probability=8%, Report='BODY_SIZE_1000_LESS 0, BODY_SIZE_2000_LESS 0, BODY_SIZE_5000_LESS 0, BODY_SIZE_7000_LESS 0, BODY_SIZE_900_999 0, TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __HAS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __SANE_MSGID 0, __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

Which analyzer are you using here?  Depending on your choice the comma 
separated values might be being kept together in your index, rather than 
tokenized as you expected.

Secondly, you should get Luke, and take a look into your index, this 
should give you a much better idea of what's going on in your index.

Anyhow, closely examine your analyzer choice, and then your query type 
choice and see if that's where the problem lies.

Matt

Bon wrote:
> Hi all,
>
>     I've a question about the query syntax statement,
>     There is a lucene text field and the value of the field like
> ,11,12,15,16,
>     if I want to query some data and the value of the field has included
> some number what I like(11 or 15),
>     how can I do?
>     I try to give a query like (filed_name:,11,) but it can not get the
> matching.
>
>     or I must reformat the field value with some other symbol not the symbol
> comma ','
>
> Bon
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39443-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 16:14:05 2009
Return-Path: <java-user-return-39443-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27496 invoked from network); 1 Apr 2009 16:14:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 16:14:05 -0000
Received: (qmail 98578 invoked by uid 500); 1 Apr 2009 16:14:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98505 invoked by uid 500); 1 Apr 2009 16:14:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98493 invoked by uid 99); 1 Apr 2009 16:14:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 16:14:03 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of john.wang@gmail.com designates 209.85.198.225 as permitted sender)
Received: from [209.85.198.225] (HELO rv-out-0506.google.com) (209.85.198.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 16:13:54 +0000
Received: by rv-out-0506.google.com with SMTP id g9so111077rvb.5
        for <java-user@lucene.apache.org>; Wed, 01 Apr 2009 09:13:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=wAemQjmgnRWuqgrUFXq5a9ac1j0AQ9BF0G5VUEb+yIA=;
        b=G4GNjoAvH9KotzEPaNU9Mx7Xh0jq0FpsFjoGxgSDxvBEFwZzOYvPBtS3/MOr7X4LXs
         COJNQkv0cJnZiBPkJkWfFzm8pYCsX8qkeppTkh4935JMCqD2JOFjjleUL2OyEdCRvwPm
         7IlXV+JRnGxCilAHxrFrE7cjLUmKt8BsLMq/Y=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=b9ylz6cHUwdFmqivjaTtkyTbQScuNlxnHd3m6jl6W5HYrfJsffgVJBWSXIU5yhcv3B
         w3fruQBV1gCMNG7sGEjao80CAF/PXqSPS5Xj9jVtIwPYxJ+gFLUKQvFZuGyauXpVclEk
         3d1aJEanOEzexKkmCkXxUN0TG/GVCac5ea44Q=
MIME-Version: 1.0
Received: by 10.140.141.16 with SMTP id o16mr2056865rvd.255.1238602411410; 
	Wed, 01 Apr 2009 09:13:31 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <c68e39170903311257s6cc5056boec396d6aa145c9ad@mail.gmail.com>
	 <8837fb770903311358n77aa2065o5f8f1489f319264@mail.gmail.com>
	 <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
	 <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
	 <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
Date: Wed, 1 Apr 2009 09:13:31 -0700
Message-ID: <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd16e80c0066304668098df
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd16e80c0066304668098df
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Michael:

    Let me first share what I am doing w.r.t deleting by docid:

I have a customized index reader that stores a mapping of docid -> uid in
the payload (something Michael Bush and Ning Li suggested a while back) And
that mapping is loaded a IndexReader load time and is shared by searchers.

I do realtime update, so I get a batch of updates with a uid associated with
each batch. So I do deleted on the uid and add the document. And I
implemented using IndexWriter.deleteDocuments(Term[])

I realized I have an IndexReader around already with a docId->uid mapping, I
can just find out the docid from that list and simply call
IndexReader.deleteDocument(int). So out of curiosity, I compare the times
doing deletes with these two mechanisms with 1 batch of 10000 deletes. And
on my macbook pro, I see a difference/overhead of 3-4 seconds (with various
runs and how much term table is cached etc.) And that is something I would
expect because we essentially doing a "query" per element in the batch,
albeit posting list length is only 1, but still...

Now to me that is significant enough to move away from
IndexWriter.deleteDocuments().

However, to actually implement the delete with IndexWriter on docids, I have
to create a customized Query object that iterates my int[] of docids. Which
is kinda silly, since IndexWriter calls delete on the docid anyway. I don't
want to open an IndexReader for the deletes (cuz that's where the api is at)
and then open another IndexWriter to add documents because:
1) seems like we are moving away from this paradigm with the delete apis on
IndexWriter
2) I want to have delete and add in 1 commit.

Here is my use-case, and I don't think it is that far-fetched.

Having IndexWriter.deleteDocuments take a Filter than DocIdSet makes sense.
For me at lease, IndexWriter.deleteDocument(int) would be useful.

Just my $0.02.

-John

On Wed, Apr 1, 2009 at 1:02 AM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> John,
>
> I think this has the same problem as exposing delete by docID, ie, how
> would you produce that docIdSet?
>
> We could consider delete by Filter instead, since that exposes the
> necessary getDocIdSet(IndexReader) method.
>
> Or, with near real-time search, we could enhance it to allow deletions
> via the obtained reader (the first approach doesn't).
>
> Mike
>
> On Tue, Mar 31, 2009 at 10:23 PM, John Wang <john.wang@gmail.com> wrote:
> > So do you think it is a good addition/change to the current api now?
> >
> > -John
> >
> > On Tue, Mar 31, 2009 at 2:18 PM, Yonik Seeley <
> yonik@lucidimagination.com>wrote:
> >
> >> On Tue, Mar 31, 2009 at 4:58 PM, John Wang <john.wang@gmail.com> wrote:
> >> > I fail to see the difference of exposing the api to allow for a Query
> >> > instance to be passed in vs a DocIdSet.
> >>
> >> I was commenting specifically on your idea to allow deletion by int[]
> >> (docids) on the IndexWriter.
> >>
> >> DocIdSet is a different issue - it didn't exist when the conversation
> >> to add deleteByQuery was going on.
> >>
> >> -Yonik
> >> http://www.lucidimagination.com
> >>
> >>
> >>  In this specific case, Query is
> >> > essentially a factory to produce a DocIdSetIterator (or Scorer) Isn't
> it
> >> > what DocIdSet is?
> >> > Thanks
> >> >
> >> > -John
> >> >
> >> > On Tue, Mar 31, 2009 at 12:57 PM, Yonik Seeley
> >> > <yonik@lucidimagination.com>wrote:
> >> >
> >> >> On Tue, Mar 31, 2009 at 3:41 PM, John Wang <john.wang@gmail.com>
> wrote:
> >> >> > Also, can we expose  IndexWriter.deleteDocuments(int[] docids)?
> >> >>
> >> >> Exposing internal ids from the IndexWriter may not be a good idea
> >> >> given that they are transient.
> >> >>
> >> >>
> >> >> -Yonik
> >> >> http://www.lucidimagination.com
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd16e80c0066304668098df--

From java-user-return-39444-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 17:13:38 2009
Return-Path: <java-user-return-39444-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52334 invoked from network); 1 Apr 2009 17:13:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 17:13:38 -0000
Received: (qmail 89620 invoked by uid 500); 1 Apr 2009 17:13:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89563 invoked by uid 500); 1 Apr 2009 17:13:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89553 invoked by uid 99); 1 Apr 2009 17:13:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 17:13:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.146.177 as permitted sender)
Received: from [209.85.146.177] (HELO wa-out-1112.google.com) (209.85.146.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 17:13:28 +0000
Received: by wa-out-1112.google.com with SMTP id l35so66866waf.5
        for <java-user@lucene.apache.org>; Wed, 01 Apr 2009 10:13:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=kijCG0RoFoXaHsCUoJT+uiE2s65WSqHPR81xIRB/HhE=;
        b=Lnk8aeKUCyCxQFwMoAJKAVPef6H5wyQnP1Ssv0O+3OydKI0RSTyhIIj1fSethOUx6f
         vfeXK2mI1JrSNsohoQl9hdfMMSVpWTZFkf3gF6b8xh8k32EmPXEj6OQpsInRlIgV/ycx
         3Zjn1BTQ4yqfN6Ht5ShsuAwwUxQHYQ88ac6wQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=cdXZuOHhvviISSQdcwf1gyDHdHlH17LktWL6Y4RHs8yMVu44G3FddfrRDoY5iBxKAP
         G9DjF6OcM2pluyr8ZSjzta1arcjCdDUUewI7jN43wbriyuH1GaPUg2EsVNW5yhN1U0AV
         xyQ4LE/R81MQE3moQVSF8pZIQ6xpWlEzCQCao=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.115.49.11 with SMTP id b11mr5351725wak.114.1238605988055; Wed, 
	01 Apr 2009 10:13:08 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <c68e39170903311257s6cc5056boec396d6aa145c9ad@mail.gmail.com>
	 <8837fb770903311358n77aa2065o5f8f1489f319264@mail.gmail.com>
	 <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
	 <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
	 <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
Date: Wed, 1 Apr 2009 13:13:08 -0400
X-Google-Sender-Auth: a8300e99da5567bd
Message-ID: <c68e39170904011013l65c96994p2200fccb7e6e2caf@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Apr 1, 2009 at 4:02 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> I think this has the same problem as exposing delete by docID, ie, how
> would you produce that docIdSet?

Whoops, right.  I was going by memory that there was a
get(IndexReader) type method there... but that's on Filter of course.


-Yonik
http://www.lucidimagination.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39445-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 17:17:43 2009
Return-Path: <java-user-return-39445-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53867 invoked from network); 1 Apr 2009 17:17:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 17:17:43 -0000
Received: (qmail 94866 invoked by uid 500); 1 Apr 2009 17:17:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94825 invoked by uid 500); 1 Apr 2009 17:17:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94790 invoked by uid 99); 1 Apr 2009 17:17:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 17:17:38 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.172] (HELO wf-out-1314.google.com) (209.85.200.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 17:17:30 +0000
Received: by wf-out-1314.google.com with SMTP id 29so133698wff.20
        for <java-user@lucene.apache.org>; Wed, 01 Apr 2009 10:17:08 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.155.17 with SMTP id c17mr3196108wfe.233.1238606228775; 
	Wed, 01 Apr 2009 10:17:08 -0700 (PDT)
In-Reply-To: <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <c68e39170903311257s6cc5056boec396d6aa145c9ad@mail.gmail.com>
	 <8837fb770903311358n77aa2065o5f8f1489f319264@mail.gmail.com>
	 <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
	 <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
	 <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
	 <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
Date: Wed, 1 Apr 2009 13:17:08 -0400
Message-ID: <9ac0c6aa0904011017m3bbe46a3xa8279c0c58a7a443@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

> For me at lease, IndexWriter.deleteDocument(int) would be useful.

I completely agree: delete-by-docID in IndexWriter would be a great
feature.  Long ago I became convinced of that.

Where this feature always gets stuck (search the lists -- it's gotten
stuck alot) is how to implement it?  At any time, a merge can commit,
which invalidates all docIDs stored anywhere.  We need to solve that
before we can delete by docID.

I don't see a clean solution.  Do you?

> I have a customized index reader that stores a mapping of docid -> uid in
> the payload (something Michael Bush and Ning Li suggested a while back) And
> that mapping is loaded a IndexReader load time and is shared by searchers.

OK

> I do realtime update, so I get a batch of updates with a uid associated with
> each batch. So I do deleted on the uid and add the document. And I
> implemented using IndexWriter.deleteDocuments(Term[])

OK

> I realized I have an IndexReader around already with a docId->uid mapping, I
> can just find out the docid from that list and simply call
> IndexReader.deleteDocument(int). So out of curiosity, I compare the times
> doing deletes with these two mechanisms with 1 batch of 10000 deletes. And
> on my macbook pro, I see a difference/overhead of 3-4 seconds (with various
> runs and how much term table is cached etc.) And that is something I would
> expect because we essentially doing a "query" per element in the batch,
> albeit posting list length is only 1, but still...

But, your mapping is stale (you can't trust the docIDs) as soon as you
open an IndexWriter on the same index, so this isn't really a valid
test.

3-4 seconds out of how much total time?

Can you give more details on this test?  Are you including time to
open IndexReader, time to load your docID/uid mapping, and time to
commit the changes (to be apples/apples)?

> Now to me that is significant enough to move away from
> IndexWriter.deleteDocuments().
>

> However, to actually implement the delete with IndexWriter on
> docids, I have to create a customized Query object that iterates my
> int[] of docids.

That won't work (the docIDs might be invalid by the time your Query is
visited).  The point of delete-by-Query is IW hands you a reader,
which you must use right then use to find the docIDs; only the docIDs
from that reader are valid.

> Having IndexWriter.deleteDocuments take a Filter than DocIdSet makes
> sense.

Well... when IW deletes-by-Query, it's already using the Query as a
Filter (ie, not doing any scoring).  Changing the API to
delete-by-Filter won't change the performance.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39446-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 17:32:17 2009
Return-Path: <java-user-return-39446-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67986 invoked from network); 1 Apr 2009 17:32:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 17:32:17 -0000
Received: (qmail 26088 invoked by uid 500); 1 Apr 2009 17:32:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26053 invoked by uid 500); 1 Apr 2009 17:32:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26043 invoked by uid 99); 1 Apr 2009 17:32:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 17:32:14 +0000
X-ASF-Spam-Status: No, hits=3.8 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL,SUBJECT_FUZZY_TION
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [68.142.237.91] (HELO n6.bullet.re3.yahoo.com) (68.142.237.91)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 01 Apr 2009 17:32:04 +0000
Received: from [68.142.237.90] by n6.bullet.re3.yahoo.com with NNFMP; 01 Apr 2009 17:31:43 -0000
Received: from [67.195.9.83] by t6.bullet.re3.yahoo.com with NNFMP; 01 Apr 2009 17:31:43 -0000
Received: from [67.195.9.106] by t3.bullet.mail.gq1.yahoo.com with NNFMP; 01 Apr 2009 17:31:43 -0000
Received: from [127.0.0.1] by omp110.mail.gq1.yahoo.com with NNFMP; 01 Apr 2009 17:30:07 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 223405.41116.bm@omp110.mail.gq1.yahoo.com
Received: (qmail 56534 invoked by uid 60001); 1 Apr 2009 17:31:42 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ymail.com; s=s1024; t=1238607102; bh=ER/oTjXxnHfsV58V/8chI3CulCTGE73/63f0YOOaVWk=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=JjlhlR6KXRWs1UenWfUf8V4KNbSNr0dc/6r9IKYwIHqt5f7y9/3iWCZ8bspJ/SndIM2xFTA+xQJ38JhNE8NeQrYE7iQs7h9Docbfihoj9tGm7KgyZVC7fE+65rsOa7R7qNI7beCmKvYbEkLRP+wHAMOinp2xUjZAHouBdoktB5U=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=ymail.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=rOxYR4FhtmgVLpMM0JmctRp2USayoOco/3jA8pbyVUEKbPjFtwEHdh5vuTGhRZbJuRjW5UvKY9F+S1k/SRV6UOFZdVqjVGQ265v/H/7aldvGRp6krOqbM5zeZaU2lQ4Ctf5DAKPp9zmQ+5hom2YMeH1L3Ke7fgA9WjeRvnpXBVs=;
Message-ID: <702697.55499.qm@web112220.mail.gq1.yahoo.com>
X-YMail-OSG: emG7aRwVM1m4kLPrrxmSa0MtADft3Zaf66KwLfE1KPVPHJaiDKT84weUsab_LnCmSCwySsljq7J7_zFoqMBBDJL243d4AX2r6wPQYvlKk0bkR6gpN0UvsitqJgbJkhyz965nRqdoDN5DNeF8JBPOdu.D6y.HpH2U6oexkBoWdlGaIk6XItYNA_Ve6jgIjBvKgjJFD8iWdzulEGHzJdaCfEVxQGVfDokv3ClapQ2pgnZgpFwerSyAwhaKuSM6MtEbKKfOQ2DhZ1_qE2oNPDbn
Received: from [94.194.201.108] by web112220.mail.gq1.yahoo.com via HTTP; Wed, 01 Apr 2009 10:31:37 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
Date: Wed, 1 Apr 2009 10:31:37 -0700 (PDT)
From: Lebiram <lebiram@ymail.com>
Subject: Search using MultiSearcher generates OOM on a 1GB total Partitioned indeces
To: Lucene Mailing-List <java-user@lucene.apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1297353656-1238607097=:55499"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1297353656-1238607097=:55499
Content-Type: text/plain; charset=us-ascii

Hi All, 

I have the following query on a 1GB index with about 12 million docs :
As you can see the terms consist of wildcards...

query.toString()=+(+content:g* +content:h* +content:d* +content:s* +content:a* +content:w* +content:b* +content:c* +content:m* +content:e*) +((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9) (+viewers:cpuser9 +viewers:cpuser4))

The Searcher is a MultiSearcher with 4 IndexSearchers pointing to 4 different Lucene Index.
This search returns very few records, several ten thousand hits.

Java is assigned with 1GB max memory.

Somehow this search eats the entire java heap space and causes OOM. 
Looking at jProfiler, i see org.apache.lucene package generating a lot of objects which I believe is taking all this space.

Can anyone explain the reason why this particular search might take so much memory?
Is there anything I am doing wrong here?
More importantly, is there anything I can do to improve this?

-M


      
--0-1297353656-1238607097=:55499--


From java-user-return-39447-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 17:51:47 2009
Return-Path: <java-user-return-39447-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83107 invoked from network); 1 Apr 2009 17:51:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 17:51:46 -0000
Received: (qmail 64376 invoked by uid 500); 1 Apr 2009 17:51:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64349 invoked by uid 500); 1 Apr 2009 17:51:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64339 invoked by uid 99); 1 Apr 2009 17:51:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 17:51:43 +0000
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,SUBJECT_FUZZY_TION
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 17:51:37 +0000
Received: by ewy27 with SMTP id 27so197023ewy.5
        for <java-user@lucene.apache.org>; Wed, 01 Apr 2009 10:51:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=RZGF/jJFYprTQDoIDmvQ5LQg66XgSqDBduBxnkZlW9I=;
        b=bvG540x0VtRFsBps9yaUwXSIdbEatWGbAVT/Gqp31gVmdTXFjPUfSi9eeQxg3frNLt
         oTfy2JQwEW2sbmjYay/Uz7wMZsYWzKsJCL5i7Vk7dGESgTJcX35EVi2898vgMw8yKUVL
         Tp7Lgysws+A+HD/cg9cuN5PeYklt29H/RVR58=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=vDLaKVbnst6ppZXJctvkeW0ZOBajqExwpjhhMyiWmqsZDkjhjeaJ64aqoxLWy7Mbi3
         1yyftKRaaB/tZAvmbCzjs5etc7rkCsclb56vBf/8iRFN4SDZpMqi7Z/xbwD8yK4mhEJu
         FQG/MNP9wDTSfNEzn7D272182WC863+BiVXUQ=
MIME-Version: 1.0
Received: by 10.220.72.80 with SMTP id l16mr3747023vcj.99.1238608273792; Wed, 
	01 Apr 2009 10:51:13 -0700 (PDT)
In-Reply-To: <702697.55499.qm@web112220.mail.gq1.yahoo.com>
References: <702697.55499.qm@web112220.mail.gq1.yahoo.com>
Date: Wed, 1 Apr 2009 13:51:13 -0400
Message-ID: <359a92830904011051p6a2d3abfwbf6b7279ae7c1c87@mail.gmail.com>
Subject: Re: Search using MultiSearcher generates OOM on a 1GB total 
	Partitioned indeces
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e645f8f22ce0df046681f6c2
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e645f8f22ce0df046681f6c2
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Think about putting this query in Luke and doing an "explain" for details,
but....

I'm surprised this is working at all without throwing TooManyClauses errors.
Under the covers, Lucene expands your wildcards to all terms in the field
that match. For instance, assume your document field has the following:
aa
ab
ac
ad
ae

Now, searching for a* produces a clause like:
(aa OR ab OR ac OR ad OR ae) in place of the a*

So your query is generating ginormous OR clauses, one that
contains every term in your content field starting with 'g'. Another
with every term in your content field starting with 'h' etc. So I suspect
that your content field doesn't have very many distinct terms in it....

As for why it's returning few entries, what does this part of your
query return by itself? Since it's anded with your wildcard query,
it might be what's limiting your results.

((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
(+viewers:cpuser9 +viewers:cpuser4))

But I'm puzzled, because saying that you're getting OOM errors
doesn't square very well with getting *any* results at all, so is
there something else going on?

Best
Erick@MoreQuestionsThanAnswers.


On Wed, Apr 1, 2009 at 1:31 PM, Lebiram <lebiram@ymail.com> wrote:

> Hi All,
>
> I have the following query on a 1GB index with about 12 million docs :
> As you can see the terms consist of wildcards...
>
> query.toString()=+(+content:g* +content:h* +content:d* +content:s*
> +content:a* +content:w* +content:b* +content:c* +content:m* +content:e*)
> +((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
> (+viewers:cpuser9 +viewers:cpuser4))
>
> The Searcher is a MultiSearcher with 4 IndexSearchers pointing to 4
> different Lucene Index.
> This search returns very few records, several ten thousand hits.
>
> Java is assigned with 1GB max memory.
>
> Somehow this search eats the entire java heap space and causes OOM.
> Looking at jProfiler, i see org.apache.lucene package generating a lot of
> objects which I believe is taking all this space.
>
> Can anyone explain the reason why this particular search might take so much
> memory?
> Is there anything I am doing wrong here?
> More importantly, is there anything I can do to improve this?
>
> -M
>
>
>

--0016e645f8f22ce0df046681f6c2--

From java-user-return-39448-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 17:58:40 2009
Return-Path: <java-user-return-39448-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87543 invoked from network); 1 Apr 2009 17:58:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 17:58:40 -0000
Received: (qmail 83037 invoked by uid 500); 1 Apr 2009 17:58:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82978 invoked by uid 500); 1 Apr 2009 17:58:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82968 invoked by uid 99); 1 Apr 2009 17:58:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 17:58:38 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jason.rutherglen@gmail.com designates 74.125.44.30 as permitted sender)
Received: from [74.125.44.30] (HELO yx-out-2324.google.com) (74.125.44.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 17:58:28 +0000
Received: by yx-out-2324.google.com with SMTP id 8so101085yxb.5
        for <java-user@lucene.apache.org>; Wed, 01 Apr 2009 10:58:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=lUOB7J5FjU3k3Q1BWbuK1Oxsd1UKewEqys+EynA+N4o=;
        b=Qm3ldDi8zoK7Sd8polwXbkqwILFRqsihUhEPg+Z512jnHKTM65GMy7ynKY5yB4cAUL
         AUictdHSqm1xl755wrHsEA1CoMqdr1p2ElkLxH7+AzmccxdQjh3px1iLsp255CAaoWb7
         Vf3xYYzW+Wou1Z+9MtbJ9iRo4STk/uwp/EW2o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=EpS8riyn270GU3cufRXi94JOr7Yb9IJeQ96gzbeaKjNs4CYENMVUyZwdAl5HAAyL2B
         W+YxEO8jYN+zBkQgTMiJvAj4TytwshI+RAcSCBJ8ljBFXso1knf9u/3QDk/TuoZfG0XU
         mT0e6U64r4wUAlhC0nluOLnGfkoZ4H3ozFwlg=
MIME-Version: 1.0
Received: by 10.150.153.7 with SMTP id a7mr15137354ybe.150.1238608687434; Wed, 
	01 Apr 2009 10:58:07 -0700 (PDT)
In-Reply-To: <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <c68e39170903311257s6cc5056boec396d6aa145c9ad@mail.gmail.com>
	 <8837fb770903311358n77aa2065o5f8f1489f319264@mail.gmail.com>
	 <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
	 <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
	 <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
	 <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
Date: Wed, 1 Apr 2009 10:58:07 -0700
Message-ID: <85d3c3b60904011058u47d865t3c5ba6c2df16aab0@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd3f754d4c2010466820e65
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd3f754d4c2010466820e65
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

John,

We looked at implementing delete by doc id for LUCENE-1516, however it
seemed to be something that if enough people wanted we could implement it at
as a later patch.

The implementation involves maintaining a genealogy of SegmentReaders within
IndexWriter so that deletes to a reader that has been merged away will be
imported by later readers.

-J

On Wed, Apr 1, 2009 at 9:13 AM, John Wang <john.wang@gmail.com> wrote:

> Hi Michael:
>
>    Let me first share what I am doing w.r.t deleting by docid:
>
> I have a customized index reader that stores a mapping of docid -> uid in
> the payload (something Michael Bush and Ning Li suggested a while back) And
> that mapping is loaded a IndexReader load time and is shared by searchers.
>
> I do realtime update, so I get a batch of updates with a uid associated
> with
> each batch. So I do deleted on the uid and add the document. And I
> implemented using IndexWriter.deleteDocuments(Term[])
>
> I realized I have an IndexReader around already with a docId->uid mapping,
> I
> can just find out the docid from that list and simply call
> IndexReader.deleteDocument(int). So out of curiosity, I compare the times
> doing deletes with these two mechanisms with 1 batch of 10000 deletes. And
> on my macbook pro, I see a difference/overhead of 3-4 seconds (with various
> runs and how much term table is cached etc.) And that is something I would
> expect because we essentially doing a "query" per element in the batch,
> albeit posting list length is only 1, but still...
>
> Now to me that is significant enough to move away from
> IndexWriter.deleteDocuments().
>
> However, to actually implement the delete with IndexWriter on docids, I
> have
> to create a customized Query object that iterates my int[] of docids. Which
> is kinda silly, since IndexWriter calls delete on the docid anyway. I don't
> want to open an IndexReader for the deletes (cuz that's where the api is
> at)
> and then open another IndexWriter to add documents because:
> 1) seems like we are moving away from this paradigm with the delete apis on
> IndexWriter
> 2) I want to have delete and add in 1 commit.
>
> Here is my use-case, and I don't think it is that far-fetched.
>
> Having IndexWriter.deleteDocuments take a Filter than DocIdSet makes sense.
> For me at lease, IndexWriter.deleteDocument(int) would be useful.
>
> Just my $0.02.
>
> -John
>
> On Wed, Apr 1, 2009 at 1:02 AM, Michael McCandless <
> lucene@mikemccandless.com> wrote:
>
> > John,
> >
> > I think this has the same problem as exposing delete by docID, ie, how
> > would you produce that docIdSet?
> >
> > We could consider delete by Filter instead, since that exposes the
> > necessary getDocIdSet(IndexReader) method.
> >
> > Or, with near real-time search, we could enhance it to allow deletions
> > via the obtained reader (the first approach doesn't).
> >
> > Mike
> >
> > On Tue, Mar 31, 2009 at 10:23 PM, John Wang <john.wang@gmail.com> wrote:
> > > So do you think it is a good addition/change to the current api now?
> > >
> > > -John
> > >
> > > On Tue, Mar 31, 2009 at 2:18 PM, Yonik Seeley <
> > yonik@lucidimagination.com>wrote:
> > >
> > >> On Tue, Mar 31, 2009 at 4:58 PM, John Wang <john.wang@gmail.com>
> wrote:
> > >> > I fail to see the difference of exposing the api to allow for a
> Query
> > >> > instance to be passed in vs a DocIdSet.
> > >>
> > >> I was commenting specifically on your idea to allow deletion by int[]
> > >> (docids) on the IndexWriter.
> > >>
> > >> DocIdSet is a different issue - it didn't exist when the conversation
> > >> to add deleteByQuery was going on.
> > >>
> > >> -Yonik
> > >> http://www.lucidimagination.com
> > >>
> > >>
> > >>  In this specific case, Query is
> > >> > essentially a factory to produce a DocIdSetIterator (or Scorer)
> Isn't
> > it
> > >> > what DocIdSet is?
> > >> > Thanks
> > >> >
> > >> > -John
> > >> >
> > >> > On Tue, Mar 31, 2009 at 12:57 PM, Yonik Seeley
> > >> > <yonik@lucidimagination.com>wrote:
> > >> >
> > >> >> On Tue, Mar 31, 2009 at 3:41 PM, John Wang <john.wang@gmail.com>
> > wrote:
> > >> >> > Also, can we expose  IndexWriter.deleteDocuments(int[] docids)?
> > >> >>
> > >> >> Exposing internal ids from the IndexWriter may not be a good idea
> > >> >> given that they are transient.
> > >> >>
> > >> >>
> > >> >> -Yonik
> > >> >> http://www.lucidimagination.com
> > >>
> > >> ---------------------------------------------------------------------
> > >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>
> > >>
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--000e0cd3f754d4c2010466820e65--

From java-user-return-39449-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 18:05:27 2009
Return-Path: <java-user-return-39449-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92041 invoked from network); 1 Apr 2009 18:05:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 18:05:25 -0000
Received: (qmail 93028 invoked by uid 500); 1 Apr 2009 18:05:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92973 invoked by uid 500); 1 Apr 2009 18:05:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92963 invoked by uid 99); 1 Apr 2009 18:05:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 18:05:23 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.198.237 as permitted sender)
Received: from [209.85.198.237] (HELO rv-out-0506.google.com) (209.85.198.237)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 18:05:16 +0000
Received: by rv-out-0506.google.com with SMTP id g9so156202rvb.5
        for <java-user@lucene.apache.org>; Wed, 01 Apr 2009 11:04:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=L4+W8X9pKCorEcdn0YUK+nrWRJCy0p39x+aWLazkoJM=;
        b=BhVG/Kj2M6vdEHifKVvBXjGRHkyLH3bh9fZH73uBJPttPv+u47aXTtS2wYkGVHxyif
         qzdcE9Kvih18oc0ek+9njBuvbJ1ps49yvJ0O0HcL3XxfyIMsKrO5BFMmlWQlY4/5Wl1y
         9CxHryAObXoPxScsZvFx1r7gt69z5OhH44+rs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=QBjQr/zowSGXam0hREI0iMle4QmtTJy1P71ren/Cq4bq9rYT1psUdF507XW4aMeNmp
         IZsTa8WDv5Y0DVXoERbZ33mJ8tMvyHKRIfM58FtLTEmsZErRSekCDncaPILcDp5ke6Ro
         yiMSKvl+s2af6S7Hx5C5jelZpDPUWwVJz6yVw=
MIME-Version: 1.0
Received: by 10.140.162.21 with SMTP id k21mr4121783rve.191.1238609096169; 
	Wed, 01 Apr 2009 11:04:56 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904011017m3bbe46a3xa8279c0c58a7a443@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <c68e39170903311257s6cc5056boec396d6aa145c9ad@mail.gmail.com>
	 <8837fb770903311358n77aa2065o5f8f1489f319264@mail.gmail.com>
	 <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
	 <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
	 <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
	 <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
	 <9ac0c6aa0904011017m3bbe46a3xa8279c0c58a7a443@mail.gmail.com>
Date: Wed, 1 Apr 2009 11:04:56 -0700
Message-ID: <8837fb770904011104lb86eaccr7809239f7467d709@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd22964315d050466822731
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd22964315d050466822731
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks Michael for the info.
I do guarantee there are not modifications between when
"MySpecialIndexReader" is loaded and when I iterate and find the deleted
docids. I am, however, not aware that when IndexWriter is opened, docids
move. I thought only when docs are added and when it is committed.

With this information. I agree I cannot reuse the uid mapping array from
"MySpecialIndexReader". And I would have to load this mapping using the
IndexReader given to me by the IndexWriter.

My test essentially this. I took out the reader.deleteDocuments call from
both scenarios. I took a index of 5m docs. a batch of 10000 randomly
generated uids.

Compared the following scenarios:
1)
* open index reader
* for each uid in the batch, find the corresponding docid and add to an
IntList.
*close reader

2)
* open index reader
* load uid array from payload field
* iterate uid array, and check to see if uid is in deleted set, and add to
an IntList

The datastructure holding deleted set is IntOpenHashSet from fastutil.

1) took about 3500 - 4500 ms
2) took about 815 ms

-John

On Wed, Apr 1, 2009 at 10:17 AM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> > For me at lease, IndexWriter.deleteDocument(int) would be useful.
>
> I completely agree: delete-by-docID in IndexWriter would be a great
> feature.  Long ago I became convinced of that.
>
> Where this feature always gets stuck (search the lists -- it's gotten
> stuck alot) is how to implement it?  At any time, a merge can commit,
> which invalidates all docIDs stored anywhere.  We need to solve that
> before we can delete by docID.
>
> I don't see a clean solution.  Do you?
>
> > I have a customized index reader that stores a mapping of docid -> uid in
> > the payload (something Michael Bush and Ning Li suggested a while back)
> And
> > that mapping is loaded a IndexReader load time and is shared by
> searchers.
>
> OK
>
> > I do realtime update, so I get a batch of updates with a uid associated
> with
> > each batch. So I do deleted on the uid and add the document. And I
> > implemented using IndexWriter.deleteDocuments(Term[])
>
> OK
>
> > I realized I have an IndexReader around already with a docId->uid
> mapping, I
> > can just find out the docid from that list and simply call
> > IndexReader.deleteDocument(int). So out of curiosity, I compare the times
> > doing deletes with these two mechanisms with 1 batch of 10000 deletes.
> And
> > on my macbook pro, I see a difference/overhead of 3-4 seconds (with
> various
> > runs and how much term table is cached etc.) And that is something I
> would
> > expect because we essentially doing a "query" per element in the batch,
> > albeit posting list length is only 1, but still...
>
> But, your mapping is stale (you can't trust the docIDs) as soon as you
> open an IndexWriter on the same index, so this isn't really a valid
> test.
>
> 3-4 seconds out of how much total time?
>
> Can you give more details on this test?  Are you including time to
> open IndexReader, time to load your docID/uid mapping, and time to
> commit the changes (to be apples/apples)?
>
> > Now to me that is significant enough to move away from
> > IndexWriter.deleteDocuments().
> >
>
> > However, to actually implement the delete with IndexWriter on
> > docids, I have to create a customized Query object that iterates my
> > int[] of docids.
>
> That won't work (the docIDs might be invalid by the time your Query is
> visited).  The point of delete-by-Query is IW hands you a reader,
> which you must use right then use to find the docIDs; only the docIDs
> from that reader are valid.
>
> > Having IndexWriter.deleteDocuments take a Filter than DocIdSet makes
> > sense.
>
> Well... when IW deletes-by-Query, it's already using the Query as a
> Filter (ie, not doing any scoring).  Changing the API to
> delete-by-Filter won't change the performance.
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd22964315d050466822731--

From java-user-return-39450-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 18:28:23 2009
Return-Path: <java-user-return-39450-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14111 invoked from network); 1 Apr 2009 18:28:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 18:28:21 -0000
Received: (qmail 41796 invoked by uid 500); 1 Apr 2009 18:28:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41705 invoked by uid 500); 1 Apr 2009 18:28:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41695 invoked by uid 99); 1 Apr 2009 18:28:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 18:28:18 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.173] (HELO wf-out-1314.google.com) (209.85.200.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 18:28:10 +0000
Received: by wf-out-1314.google.com with SMTP id 29so164807wff.20
        for <java-user@lucene.apache.org>; Wed, 01 Apr 2009 11:27:48 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.14.18 with SMTP id 18mr3211201wfn.215.1238610468538; Wed, 
	01 Apr 2009 11:27:48 -0700 (PDT)
In-Reply-To: <8837fb770904011104lb86eaccr7809239f7467d709@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <c68e39170903311257s6cc5056boec396d6aa145c9ad@mail.gmail.com>
	 <8837fb770903311358n77aa2065o5f8f1489f319264@mail.gmail.com>
	 <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
	 <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
	 <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
	 <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
	 <9ac0c6aa0904011017m3bbe46a3xa8279c0c58a7a443@mail.gmail.com>
	 <8837fb770904011104lb86eaccr7809239f7467d709@mail.gmail.com>
Date: Wed, 1 Apr 2009 14:27:48 -0400
Message-ID: <9ac0c6aa0904011127n35373d62h6ede92d30e4369d2@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Apr 1, 2009 at 2:04 PM, John Wang <john.wang@gmail.com> wrote:

> My test essentially this. I took out the reader.deleteDocuments call from
> both scenarios. I took a index of 5m docs. a batch of 10000 randomly
> generated uids.
>
> Compared the following scenarios:
> 1)
> * open index reader
> * for each uid in the batch, find the corresponding docid and add to an
> IntList.
> *close reader

How exactly do you find the corresponding docid?  TermDocs?

> 2)
> * open index reader
> * load uid array from payload field
> * iterate uid array, and check to see if uid is in deleted set, and add to
> an IntList

In this case, each doc has a dedicated field that only has a payload
that stores the one uid for that doc?  But I'm confused how you then
map from uid -> docID.  I must be missing something.

> The datastructure holding deleted set is IntOpenHashSet from fastutil.
>
> 1) took about 3500 - 4500 ms
> 2) took about 815 ms

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39451-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 21:22:58 2009
Return-Path: <java-user-return-39451-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80330 invoked from network); 1 Apr 2009 21:22:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 21:22:58 -0000
Received: (qmail 4709 invoked by uid 500); 1 Apr 2009 21:22:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4670 invoked by uid 500); 1 Apr 2009 21:22:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4660 invoked by uid 99); 1 Apr 2009 21:22:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 21:22:55 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.198.233 as permitted sender)
Received: from [209.85.198.233] (HELO rv-out-0506.google.com) (209.85.198.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 21:22:48 +0000
Received: by rv-out-0506.google.com with SMTP id g9so232383rvb.5
        for <java-user@lucene.apache.org>; Wed, 01 Apr 2009 14:22:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=T1/9A6oFMtRXw8WjhqYWzw/phqManU1dvZHlkHKp2Dk=;
        b=Y/1W3HDqUONmDSnqnpi0V/W3LnJFAEz2K3EHcNGhr7eNSdDxNNoSq6LTf6Hnyb3M8a
         4MfMDIR0EHllzz1UW2AbJK+YB7wKYMmIJAqBCG5FdI514Xumc55F3K4GAwE+5qLQYDTX
         j+Ascj5FN0g1ugqytuyyZGDqaoGawQJ2y4nVA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Tk+18uTlgIugr2Ecd909SRKyjn1nHTvdb5lm/cI6l8UCs2JqCaiO07uTCxDJ1RrctV
         jWRr8dSG44ryy8Jd2QLa1Onf+AWiL5q67m3ouvXkegVhXKfJFPA/Hl3SPsY+UDGaaR0S
         N5M5s+y1hvkRjq7hKYyGXO9t4nxMePBjPXP5I=
MIME-Version: 1.0
Received: by 10.141.97.5 with SMTP id z5mr4187930rvl.212.1238620948514; Wed, 
	01 Apr 2009 14:22:28 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904011127n35373d62h6ede92d30e4369d2@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <c68e39170903311257s6cc5056boec396d6aa145c9ad@mail.gmail.com>
	 <8837fb770903311358n77aa2065o5f8f1489f319264@mail.gmail.com>
	 <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
	 <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
	 <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
	 <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
	 <9ac0c6aa0904011017m3bbe46a3xa8279c0c58a7a443@mail.gmail.com>
	 <8837fb770904011104lb86eaccr7809239f7467d709@mail.gmail.com>
	 <9ac0c6aa0904011127n35373d62h6ede92d30e4369d2@mail.gmail.com>
Date: Wed, 1 Apr 2009 14:22:28 -0700
Message-ID: <8837fb770904011422p17e93c3cu6891c4b5693516d4@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1a782a5c85a046684e994
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1a782a5c85a046684e994
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Michael:

    1) Yes, we use TermDocs, exactly what IndexWriter.deleteDocuments(Term)
is doing under the cover.
    2) We iterate the docid->uid mapping, for each docid, get the
corresponding ui and check that to see if that is in the deleted set. If so,
add the docid to the list. There is no uid->docid lookup needed.

      However, in our sharded architecture, we partition by continuous uids,
in which case we keep both mappings since we know the range of the the uid.
In which case, uid->docid mapping is available.

-John

On Wed, Apr 1, 2009 at 11:27 AM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> On Wed, Apr 1, 2009 at 2:04 PM, John Wang <john.wang@gmail.com> wrote:
>
> > My test essentially this. I took out the reader.deleteDocuments call from
> > both scenarios. I took a index of 5m docs. a batch of 10000 randomly
> > generated uids.
> >
> > Compared the following scenarios:
> > 1)
> > * open index reader
> > * for each uid in the batch, find the corresponding docid and add to an
> > IntList.
> > *close reader
>
> How exactly do you find the corresponding docid?  TermDocs?
>
> > 2)
> > * open index reader
> > * load uid array from payload field
> > * iterate uid array, and check to see if uid is in deleted set, and add
> to
> > an IntList
>
> In this case, each doc has a dedicated field that only has a payload
> that stores the one uid for that doc?  But I'm confused how you then
> map from uid -> docID.  I must be missing something.
>
> > The datastructure holding deleted set is IntOpenHashSet from fastutil.
> >
> > 1) took about 3500 - 4500 ms
> > 2) took about 815 ms
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd1a782a5c85a046684e994--

From java-user-return-39452-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 21:29:44 2009
Return-Path: <java-user-return-39452-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84656 invoked from network); 1 Apr 2009 21:29:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 21:29:42 -0000
Received: (qmail 12023 invoked by uid 500); 1 Apr 2009 21:29:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11954 invoked by uid 500); 1 Apr 2009 21:29:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11941 invoked by uid 99); 1 Apr 2009 21:29:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 21:29:39 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.172] (HELO wf-out-1314.google.com) (209.85.200.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 21:29:32 +0000
Received: by wf-out-1314.google.com with SMTP id 29so241733wff.20
        for <java-user@lucene.apache.org>; Wed, 01 Apr 2009 14:29:11 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.218.4 with SMTP id q4mr3258068wfg.225.1238621351008; Wed, 
	01 Apr 2009 14:29:11 -0700 (PDT)
In-Reply-To: <8837fb770904011422p17e93c3cu6891c4b5693516d4@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <8837fb770903311358n77aa2065o5f8f1489f319264@mail.gmail.com>
	 <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
	 <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
	 <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
	 <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
	 <9ac0c6aa0904011017m3bbe46a3xa8279c0c58a7a443@mail.gmail.com>
	 <8837fb770904011104lb86eaccr7809239f7467d709@mail.gmail.com>
	 <9ac0c6aa0904011127n35373d62h6ede92d30e4369d2@mail.gmail.com>
	 <8837fb770904011422p17e93c3cu6891c4b5693516d4@mail.gmail.com>
Date: Wed, 1 Apr 2009 17:29:10 -0400
Message-ID: <9ac0c6aa0904011429j37fb2064y72afeef26620b12@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Apr 1, 2009 at 5:22 PM, John Wang <john.wang@gmail.com> wrote:
> Hi Michael:
>
> =A0 =A01) Yes, we use TermDocs, exactly what IndexWriter.deleteDocuments(=
Term)
> is doing under the cover.

This part I understand :)

> =A0 =A02) We iterate the docid->uid mapping, for each docid, get the
> corresponding ui and check that to see if that is in the deleted set. If =
so,
> add the docid to the list. There is no uid->docid lookup needed.

Does this mean you iterate all docs in the index, and only when you
come across a UID that's deleted, you add to deleted set?

Do you have a separate payload field per document?  (I'm still unclear
how you use payloads to encode the full docID -> UID map).

> =A0 =A0 =A0However, in our sharded architecture, we partition by continuo=
us uids,
> in which case we keep both mappings since we know the range of the the ui=
d.
> In which case, uid->docid mapping is available.

OK

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39453-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 22:16:46 2009
Return-Path: <java-user-return-39453-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11898 invoked from network); 1 Apr 2009 22:16:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 22:16:46 -0000
Received: (qmail 99617 invoked by uid 500); 1 Apr 2009 22:16:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99573 invoked by uid 500); 1 Apr 2009 22:16:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 99608 invoked by uid 99); 1 Apr 2009 21:20:57 -0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
X-Virus-Scanned: amavisd-new at mmu.acquiremedia.com
From: Dan OConnor <doconnor@acquiremedia.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Wed, 1 Apr 2009 17:20:26 -0400
Subject: Help to determine why an optimized index is proportionaly too big.
Thread-Topic: Help to determine why an optimized index is proportionaly too
 big.
Thread-Index: AcmzD60a9/5xc+l+Q6KmjEm8AeHspA==
Message-ID: <24098ED350C76D46A4FDBD81B51BE0E9034CB5E91B@exchange.windows.mmu.acquiremedia.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_000_24098ED350C76D46A4FDBD81B51BE0E9034CB5E91Bexchangewindo_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_24098ED350C76D46A4FDBD81B51BE0E9034CB5E91Bexchangewindo_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

All:

We are using java lucene 2.3.2 to index a fairly large number of documents =
(roughly 400,000 per day). We have divided the time history into various de=
pths.

Our first stage covers 8 days and our next stage covers 22. The index direc=
tory for the first stage is approximately 20G when fully optimized. The ind=
ex directory of our second stage is over 250GB when optimized. Our third st=
age (which is 60 days) is only ~80GB when optimized.

The second stage index failed an optimization with a disk full exception (I=
 had to move it to another lucene machine with a larger disk partition to c=
omplete the optimization. Is there a reason why a 22 day index would be 10x=
 the size of an 8 day index when the document indexing rate is fairly const=
ant? Also, is there a way to shrink the index without regenerating it?

Any help/pointers would be greatly appreciated.

Thanks and Regards,
Dan

Dan O'Connor
SVP, Engineering
Acquire Media<http://www.acquiremedia.com/>
e: doconnor@acquiremedia.com<mailto:doconnor@acquiremedia.com>


--_000_24098ED350C76D46A4FDBD81B51BE0E9034CB5E91Bexchangewindo_--

From java-user-return-39454-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 01 22:37:59 2009
Return-Path: <java-user-return-39454-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21988 invoked from network); 1 Apr 2009 22:37:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Apr 2009 22:37:59 -0000
Received: (qmail 25380 invoked by uid 500); 1 Apr 2009 22:37:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25306 invoked by uid 500); 1 Apr 2009 22:37:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25296 invoked by uid 99); 1 Apr 2009 22:37:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 22:37:56 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of john.wang@gmail.com designates 209.85.198.224 as permitted sender)
Received: from [209.85.198.224] (HELO rv-out-0506.google.com) (209.85.198.224)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 01 Apr 2009 22:37:48 +0000
Received: by rv-out-0506.google.com with SMTP id g9so258457rvb.5
        for <java-user@lucene.apache.org>; Wed, 01 Apr 2009 15:37:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=HJv+xwHHS5Od1tnhHptqBqErEvjeHxaJGxsxh4SCk8s=;
        b=NlQ79jSk/0guNLTVsFsqbDAEKDwg6mJ5U6aIKE10unbMr9rJU0uHlqHL2DNteyq328
         o5XUXb1zQxXUlLAXymYJruXIrUNksER9efMZTZLx4kM4Zj3bxz+ByLllaCTEg98XE+Bw
         xRYFzulqazCamZGFKsusy7D6GAeAykSK8jBlw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=dyec0gzPNNTY0tHbS8S0zSA+LhvU/33hKt6Gq8p7+xUtpmt4AIbEnIuPt37SAyoKNR
         9YM+noItkjAy17tGe4ZJUqovVdTK7QSeoKSv60w/dQ5ikCqUGJOJrT5+rN2wfnG6UMDx
         To6l17ZUZ3cwwzUkVvc7ujXH/N1KXt0tqEPs4=
MIME-Version: 1.0
Received: by 10.140.125.19 with SMTP id x19mr665796rvc.30.1238625446886; Wed, 
	01 Apr 2009 15:37:26 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904011429j37fb2064y72afeef26620b12@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <c68e39170903311418o18d374e4pd4eb925eddad595f@mail.gmail.com>
	 <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
	 <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
	 <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
	 <9ac0c6aa0904011017m3bbe46a3xa8279c0c58a7a443@mail.gmail.com>
	 <8837fb770904011104lb86eaccr7809239f7467d709@mail.gmail.com>
	 <9ac0c6aa0904011127n35373d62h6ede92d30e4369d2@mail.gmail.com>
	 <8837fb770904011422p17e93c3cu6891c4b5693516d4@mail.gmail.com>
	 <9ac0c6aa0904011429j37fb2064y72afeef26620b12@mail.gmail.com>
Date: Wed, 1 Apr 2009 15:37:26 -0700
Message-ID: <8837fb770904011537k4164c5c8l7fbd954cc8fa09da@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd22946c57d93046685f5fe
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd22946c57d93046685f5fe
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

a code snippet is worth 1000 words :)


private static final Term UID_TERM = new Term("uid_payload", "_UID");

private static class SinglePayloadTokenStream extends TokenStream {

   private Token token = new Token(UID_TERM.text(), 0, 0);

   private byte[] buffer = new byte[4];

   private boolean returnToken = false;


   void setUID(int uid) {

     buffer[0] = (byte) (uid);

     buffer[1] = (byte) (uid >> 8);

     buffer[2] = (byte) (uid >> 16);

     buffer[3] = (byte) (uid >> 24);

     token.setPayload(new Payload(buffer));

     returnToken = true;

   }


   public Token next() throws IOException {

     if (returnToken) {

       returnToken = false;

       return token;

     } else {

       return null;

     }

   }

 }


When building docs:

f=new Field(UID_TERM.field(), singlePayloadTokenStream);

   doc.add(f);


When we load the index, we do:


int maxDoc = reader.maxDoc();

_uidArray = new int[maxDoc];

TermPositions tp = null;

byte[] payloadBuffer = new byte[4];       // four bytes for an int

try

{

          tp = reader.termPositions(UID_TERM);

          int idx = 0;

          while (tp.next())

          {

            int doc = tp.doc();

            assert doc < maxDoc;



            while(idx < doc) _uidArray[idx++] = -1; // fill the gap



            tp.nextPosition();

            tp.getPayload(payloadBuffer, 0);

            int uid = bytesToInt(payloadBuffer);

            if(uid < _minUID) _minUID = uid;

            if(uid > _maxUID) _maxUID = uid;

            _uidArray[idx++] = uid;

      }

}

finally

{

          if (tp!=null)

          {

          tp.close();

          }

}



This is actually code Mike B. posted a while back.


-John


On Wed, Apr 1, 2009 at 2:29 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> On Wed, Apr 1, 2009 at 5:22 PM, John Wang <john.wang@gmail.com> wrote:
> > Hi Michael:
> >
> >    1) Yes, we use TermDocs, exactly what
> IndexWriter.deleteDocuments(Term)
> > is doing under the cover.
>
> This part I understand :)
>
> >    2) We iterate the docid->uid mapping, for each docid, get the
> > corresponding ui and check that to see if that is in the deleted set. If
> so,
> > add the docid to the list. There is no uid->docid lookup needed.
>
> Does this mean you iterate all docs in the index, and only when you
> come across a UID that's deleted, you add to deleted set?
>
> Do you have a separate payload field per document?  (I'm still unclear
> how you use payloads to encode the full docID -> UID map).
>
> >      However, in our sharded architecture, we partition by continuous
> uids,
> > in which case we keep both mappings since we know the range of the the
> uid.
> > In which case, uid->docid mapping is available.
>
> OK
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd22946c57d93046685f5fe--

From java-user-return-39455-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 01:29:02 2009
Return-Path: <java-user-return-39455-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74180 invoked from network); 2 Apr 2009 01:29:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 01:29:01 -0000
Received: (qmail 70999 invoked by uid 500); 2 Apr 2009 01:28:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70923 invoked by uid 500); 2 Apr 2009 01:28:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70913 invoked by uid 99); 2 Apr 2009 01:28:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 01:28:59 +0000
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 01:28:50 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LpBjJ-0003yZ-Qa
	for java-user@lucene.apache.org; Wed, 01 Apr 2009 18:28:29 -0700
Message-ID: <22837126.post@talk.nabble.com>
Date: Wed, 1 Apr 2009 18:28:29 -0700 (PDT)
From: Bon <bonbon@unipattern.com>
To: java-user@lucene.apache.org
Subject: Re: What is the right query syntax for matching some field's
 substring?
In-Reply-To: <49D36479.5080202@informatics.jax.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: bonbon@unipattern.com
References: <22819197.post@talk.nabble.com> <49D36479.5080202@informatics.jax.org>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Matt,

    Thanks for your answer,
    I'm new to lucene, so I don't know what should I know about that.
    I find a reference about discuss searching substring and it work good
for me,
    I'm not sure what analyer we used, I'll check it out and make sure why
it work for us.

    thank you very much =)

Best Regards,
Bon


Matthew Hall-7 wrote:
> 
> Which analyzer are you using here?  Depending on your choice the comma 
> separated values might be being kept together in your index, rather than 
> tokenized as you expected.
> 
> Secondly, you should get Luke, and take a look into your index, this 
> should give you a much better idea of what's going on in your index.
> 
> Anyhow, closely examine your analyzer choice, and then your query type 
> choice and see if that's where the problem lies.
> 
> Matt
> 
> Bon wrote:
>> Hi all,
>>
>>     I've a question about the query syntax statement,
>>     There is a lucene text field and the value of the field like
>> ,11,12,15,16,
>>     if I want to query some data and the value of the field has included
>> some number what I like(11 or 15),
>>     how can I do?
>>     I try to give a query like (filed_name:,11,) but it can not get the
>> matching.
>>
>>     or I must reformat the field value with some other symbol not the
>> symbol
>> comma ','
>>
>> Bon
>>   
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/What-is-the-right-query-syntax-for-matching-some-field%27s-substring--tp22819197p22837126.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39456-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 01:30:54 2009
Return-Path: <java-user-return-39456-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75140 invoked from network); 2 Apr 2009 01:30:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 01:30:53 -0000
Received: (qmail 75314 invoked by uid 500); 2 Apr 2009 01:30:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75284 invoked by uid 500); 2 Apr 2009 01:30:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75274 invoked by uid 99); 2 Apr 2009 01:30:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 01:30:50 +0000
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 01:30:43 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LpBl8-00040z-Ic
	for java-user@lucene.apache.org; Wed, 01 Apr 2009 18:30:22 -0700
Message-ID: <22837185.post@talk.nabble.com>
Date: Wed, 1 Apr 2009 18:30:22 -0700 (PDT)
From: Bon <bonbon@unipattern.com>
To: java-user@lucene.apache.org
Subject: Re: What is the right query syntax for matching some field's
 substring?
In-Reply-To: <49D36479.5080202@informatics.jax.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: bonbon@unipattern.com
References: <22819197.post@talk.nabble.com> <49D36479.5080202@informatics.jax.org>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Matt,

    Thanks for your answer,
    I'm new to lucene, so I don't know what should I know about that.
    I find a reference about discuss searching substring and it work good
for me,
    I'm not sure what analyer we used, I'll check it out and make sure why
it work for us.

    thank you very much =)

Best Regards,
Bon


Matthew Hall-7 wrote:
> 
> Which analyzer are you using here?  Depending on your choice the comma 
> separated values might be being kept together in your index, rather than 
> tokenized as you expected.
> 
> Secondly, you should get Luke, and take a look into your index, this 
> should give you a much better idea of what's going on in your index.
> 
> Anyhow, closely examine your analyzer choice, and then your query type 
> choice and see if that's where the problem lies.
> 
> Matt
> 
> Bon wrote:
>> Hi all,
>>
>>     I've a question about the query syntax statement,
>>     There is a lucene text field and the value of the field like
>> ,11,12,15,16,
>>     if I want to query some data and the value of the field has included
>> some number what I like(11 or 15),
>>     how can I do?
>>     I try to give a query like (filed_name:,11,) but it can not get the
>> matching.
>>
>>     or I must reformat the field value with some other symbol not the
>> symbol
>> comma ','
>>
>> Bon
>>   
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/What-is-the-right-query-syntax-for-matching-some-field%27s-substring--tp22819197p22837185.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39457-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 09:04:43 2009
Return-Path: <java-user-return-39457-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52261 invoked from network); 2 Apr 2009 09:04:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 09:04:43 -0000
Received: (qmail 26792 invoked by uid 500); 2 Apr 2009 09:04:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26734 invoked by uid 500); 2 Apr 2009 09:04:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26724 invoked by uid 99); 2 Apr 2009 09:04:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 09:04:40 +0000
X-ASF-Spam-Status: No, hits=3.8 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL,SUBJECT_FUZZY_TION
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [68.142.237.109] (HELO n2.bullet.mail.re3.yahoo.com) (68.142.237.109)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 02 Apr 2009 09:04:28 +0000
Received: from [68.142.230.29] by n2.bullet.mail.re3.yahoo.com with NNFMP; 02 Apr 2009 09:04:07 -0000
Received: from [67.195.9.82] by t2.bullet.re2.yahoo.com with NNFMP; 02 Apr 2009 09:04:07 -0000
Received: from [67.195.9.105] by t2.bullet.mail.gq1.yahoo.com with NNFMP; 02 Apr 2009 09:04:06 -0000
Received: from [127.0.0.1] by omp109.mail.gq1.yahoo.com with NNFMP; 02 Apr 2009 09:04:37 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 302798.67322.bm@omp109.mail.gq1.yahoo.com
Received: (qmail 68916 invoked by uid 60001); 2 Apr 2009 09:04:06 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ymail.com; s=s1024; t=1238663046; bh=36gDOEMWex9Xpb7D3LbAYfS+0Qb3DbH4fx7/FeOAe4E=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=cfjenF7GofDXSl64n6Z3BacWRwwaS+AAYnTNNgl0uzetsxm9Fd7lzeoxSPnR3vSnJ/Zj/T/IdkmxHOGJYGpdGrzlpDUkuARgLFW/TXy5caJdLCKeRQa23SRvCXMSBJxXXwaR7Goy7pjJ9AUFbW4lti/3BlXT8jdXx9TXb56TMNY=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=ymail.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=3PPTdZgmIX2ehzmLL8Wzxua73loq7/BLuCKJ7UxyAhGg1lR0inN0vcUjuu52Gn1tVP334P5g/87Rw5/GdT8g80ViUUzEzfD4aZ7dV457Tl4xqqiOftNhx/tT9m8BBJqX01GM1lLrp7E0sKmxwiXI+zWtnTJuqmqj8KuRkFejldY=;
Message-ID: <580407.67598.qm@web112207.mail.gq1.yahoo.com>
X-YMail-OSG: enn18bsVM1nXayoRuh165RGz72.0yTcxqdpGzm4LoVAujfAYSktpHuSSHkPkgUqfn7HJk9oV0iUTa.zcImwobm3OSWPso7jZ0KZ_UBReQ.JziuxD07Etgox0YRhB59ntn_cCCH1sVq8BIp_20faa9E676eSusDVT_Epp4sMUc2ayO2CGcTCE_g_a_JTE7paEho6DOyxtALxSy7.AJMcSMKOnYK0AwTFE4_CdtrOzmynQJbeXaGeDfHVjnNc_ts6TbcDjt5bw5paM0bpT5YqUGHhmQOYnbitjFLcd7y9SbwMRnlB3Jnxg
Received: from [94.194.201.108] by web112207.mail.gq1.yahoo.com via HTTP; Thu, 02 Apr 2009 02:04:06 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <702697.55499.qm@web112220.mail.gq1.yahoo.com> <359a92830904011051p6a2d3abfwbf6b7279ae7c1c87@mail.gmail.com>
Date: Thu, 2 Apr 2009 02:04:06 -0700 (PDT)
From: Lebiram <lebiram@ymail.com>
Subject: Re: Search using MultiSearcher generates OOM on a 1GB total  Partitioned indeces
To: java-user@lucene.apache.org
In-Reply-To: <359a92830904011051p6a2d3abfwbf6b7279ae7c1c87@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-11351399-1238663046=:67598"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-11351399-1238663046=:67598
Content-Type: text/plain; charset=us-ascii

Hi Erick, 

I did a search just as JVM started... so I'm thinking that the JVM is busy with some startup stuff... and that this search required more memory than what is available at that time.

Had I done this search a while after the JVM has started, then this query succeeds. 
I then pump in several similar queries running on a different thread and it takes a long time but still runs to completion until one of them generates OOM.But still, queries like this is just using too much memory.

As for clauses, the BooleanQuery was set to max clause of... 9,000,000
I'm guessing that might have caused the usage of too much memory?

I'll try the explain on you've suggested. 

Thanks, 

M




________________________________
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Sent: Wednesday, April 1, 2009 6:51:13 PM
Subject: Re: Search using MultiSearcher generates OOM on a 1GB total  Partitioned indeces

Think about putting this query in Luke and doing an "explain" for details,
but....

I'm surprised this is working at all without throwing TooManyClauses errors.
Under the covers, Lucene expands your wildcards to all terms in the field
that match. For instance, assume your document field has the following:
aa
ab
ac
ad
ae

Now, searching for a* produces a clause like:
(aa OR ab OR ac OR ad OR ae) in place of the a*

So your query is generating ginormous OR clauses, one that
contains every term in your content field starting with 'g'. Another
with every term in your content field starting with 'h' etc. So I suspect
that your content field doesn't have very many distinct terms in it....

As for why it's returning few entries, what does this part of your
query return by itself? Since it's anded with your wildcard query,
it might be what's limiting your results.

((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
(+viewers:cpuser9 +viewers:cpuser4))

But I'm puzzled, because saying that you're getting OOM errors
doesn't square very well with getting *any* results at all, so is
there something else going on?

Best
Erick@MoreQuestionsThanAnswers.


On Wed, Apr 1, 2009 at 1:31 PM, Lebiram <lebiram@ymail.com> wrote:

> Hi All,
>
> I have the following query on a 1GB index with about 12 million docs :
> As you can see the terms consist of wildcards...
>
> query.toString()=+(+content:g* +content:h* +content:d* +content:s*
> +content:a* +content:w* +content:b* +content:c* +content:m* +content:e*)
> +((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
> (+viewers:cpuser9 +viewers:cpuser4))
>
> The Searcher is a MultiSearcher with 4 IndexSearchers pointing to 4
> different Lucene Index.
> This search returns very few records, several ten thousand hits.
>
> Java is assigned with 1GB max memory.
>
> Somehow this search eats the entire java heap space and causes OOM.
> Looking at jProfiler, i see org.apache.lucene package generating a lot of
> objects which I believe is taking all this space.
>
> Can anyone explain the reason why this particular search might take so much
> memory?
> Is there anything I am doing wrong here?
> More importantly, is there anything I can do to improve this?
>
> -M
>
>
>



      
--0-11351399-1238663046=:67598--


From java-user-return-39458-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 09:21:10 2009
Return-Path: <java-user-return-39458-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59203 invoked from network); 2 Apr 2009 09:21:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 09:21:10 -0000
Received: (qmail 45474 invoked by uid 500); 2 Apr 2009 09:21:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45388 invoked by uid 500); 2 Apr 2009 09:21:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45378 invoked by uid 99); 2 Apr 2009 09:21:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 09:21:07 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.169] (HELO wf-out-1314.google.com) (209.85.200.169)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 09:20:59 +0000
Received: by wf-out-1314.google.com with SMTP id 29so538481wff.20
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 02:20:37 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.53.19 with SMTP id b19mr3433504wfa.154.1238664037348; Thu, 
	02 Apr 2009 02:20:37 -0700 (PDT)
In-Reply-To: <8837fb770904011537k4164c5c8l7fbd954cc8fa09da@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <8837fb770903311923m3d159efbtb0c9bc91e2f1928b@mail.gmail.com>
	 <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
	 <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
	 <9ac0c6aa0904011017m3bbe46a3xa8279c0c58a7a443@mail.gmail.com>
	 <8837fb770904011104lb86eaccr7809239f7467d709@mail.gmail.com>
	 <9ac0c6aa0904011127n35373d62h6ede92d30e4369d2@mail.gmail.com>
	 <8837fb770904011422p17e93c3cu6891c4b5693516d4@mail.gmail.com>
	 <9ac0c6aa0904011429j37fb2064y72afeef26620b12@mail.gmail.com>
	 <8837fb770904011537k4164c5c8l7fbd954cc8fa09da@mail.gmail.com>
Date: Thu, 2 Apr 2009 05:20:37 -0400
Message-ID: <9ac0c6aa0904020220l44fe8f93h17c7cc39c042a54e@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Apr 1, 2009 at 6:37 PM, John Wang <john.wang@gmail.com> wrote:
> a code snippet is worth 1000 words :)

Here here!

OK, now I understand the difference.

With approach 1, for each of N UIDs you use a TermDocs to find the
postings for that UID, and retrieve the one docID corresponding to
that UID.  You retrieve UID -> docID.

With approach 2, you iterate through all docs in the index, using a
single full walk through the single TermPositions instance for your
special UID_TERM, and retrieve the UID stored in the 4-byte payload.
You retrieve docID -> UID.

Approach 1 is expected to be more costly, per UID - Lucene must
consult the terms dict (binary search on the terms index, followed by
scan on disk within the 128 term block) to find the posting, then seek
to the posting and read that.

Approach 2 is an efficient "bulk" walk, but it loads all docID -> UIDs
into RAM (ie, you cannot be selective about which UIDs you load).

So if the number of UIDs you need to process is small, approach 1
should win; but after that number crosses X (apparently X < 10000 for
you), approach 2's "bulk walk" will win.

Approach 1 will get faster with the "pulsing" approach for inlining
low-frequency postings directly into the terms dict (discussed on
java-dev and implemented as a codec in the experimental flexible
indexing patch on LUCENE-1458), because we save the second seek.

Approach 2 will get much faster with column-stride fields
(LUCENE-1231).

Though we may want to take this even further and allow inversion for
special fields ("primary key int" field, ie your UID) to be stored as
a column-stride field.  Probably this could simply be another codec in
LUCENE-1458.  Then, delete-by-Term would be exceptionally fast for
such fields.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39459-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 10:03:10 2009
Return-Path: <java-user-return-39459-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90326 invoked from network); 2 Apr 2009 10:03:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 10:03:10 -0000
Received: (qmail 97988 invoked by uid 500); 2 Apr 2009 10:03:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97926 invoked by uid 500); 2 Apr 2009 10:03:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97916 invoked by uid 99); 2 Apr 2009 10:03:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 10:03:07 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of abdulazizrehan@gmail.com designates 209.85.198.233 as permitted sender)
Received: from [209.85.198.233] (HELO rv-out-0506.google.com) (209.85.198.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 10:02:59 +0000
Received: by rv-out-0506.google.com with SMTP id g9so502111rvb.5
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 03:02:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=aLoeOy/AzxRW07uar+cVqavN6E5onJoXLU35f07DzYU=;
        b=x67vkk7a6iR/lUdpfV1xdFhY6U7dbgaOMYk4i1Z9j+Px4KbxPh5oM+/r84JcpIPf16
         MQx3GaZC1vaiCtpXc77/sytpCKgQ6ZBw76HSBbUbmVFY6smySDzHp84NcezbL17TyOIc
         jZ4H1SeIdW1W3R5gvdk/MjwbWeSbqATH4qZ1A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=NQw8r5GGOZHDmnTfrl2bahyCYV1mfVQt8ATnWXfxEOVaQlL+awHTEqBKEHnd9ovJVa
         y+ra8nGa8FKxY2erfpB5OgLbiP3PHWUJgFAhkUgzESrflrQw7qfoM5n9Gvmk/lVdHaT8
         W4cO/8iWs3CK0ZIGXphIMztVuFw3wiJtdEq+4=
MIME-Version: 1.0
Received: by 10.141.196.8 with SMTP id y8mr4474458rvp.298.1238666557899; Thu, 
	02 Apr 2009 03:02:37 -0700 (PDT)
Date: Thu, 2 Apr 2009 15:02:37 +0500
Message-ID: <bd7f960f0904020302k5b892aafsfe4f6d6a708068e6@mail.gmail.com>
Subject: Lock obtain timed out
From: Rehan Abdulaziz <abdulazizrehan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd14cb42dc48604668f8842
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd14cb42dc48604668f8842
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hey,
Lucene is deployed at my Tomcat server, and when I send parallel calls from
my client to add, delete or update documents, some operations are
unsuccessful. The following exception is thrown:

org.apache.lucene.store.LockObtainFailedException: Lock obtain timed out:
SimpleFSLock@D:\testIndex\write.lock

I understand what this means, and why this exception shows up. What I'm
interested in knowing is what I can do about it. Does lucene try to send the
query for some time, and then gives up? Is there a way to increase this
time? Currently, if I send 100 documents to be added from my client, around
60-80 of them are added and the rest aren't. If I can play with the time,
then perhaps I can achieve better performance.

Secondly, can I somehow stack up all the queries at the server so as to
ensure 100% success rate, no matter how fast the queries arrive? That would
be helpful.

Thanks,
Rehan.

--000e0cd14cb42dc48604668f8842--

From java-user-return-39460-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 10:53:24 2009
Return-Path: <java-user-return-39460-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25220 invoked from network); 2 Apr 2009 10:53:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 10:53:24 -0000
Received: (qmail 61389 invoked by uid 500); 2 Apr 2009 10:53:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61327 invoked by uid 500); 2 Apr 2009 10:53:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61317 invoked by uid 99); 2 Apr 2009 10:53:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 10:53:21 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [193.92.150.103] (HELO mx-out.forthnet.gr) (193.92.150.103)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 10:53:12 +0000
Received: from mx-av-05.forthnet.gr (mx-av.forthnet.gr [193.92.150.27])
	by mx-out-04.forthnet.gr (8.14.3/8.14.3) with ESMTP id n32AqkBx030046
	for <java-user@lucene.apache.org>; Thu, 2 Apr 2009 13:52:46 +0300
Received: from MX-IN-02.forthnet.gr (mx-in-02.forthnet.gr [193.92.150.185])
	by mx-av-05.forthnet.gr (8.14.3/8.14.3) with ESMTP id n32AqksL030004
	for <java-user@lucene.apache.org>; Thu, 2 Apr 2009 13:52:46 +0300
Received: from [10.0.0.2] (adsl30-148.ath.forthnet.gr [77.49.221.148])
	by MX-IN-02.forthnet.gr (8.14.3/8.14.3) with ESMTP id n32Aqdib019167
	for <java-user@lucene.apache.org>; Thu, 2 Apr 2009 13:52:40 +0300
Authentication-Results: MX-IN-02.forthnet.gr smtp.mail=jc@eworx.gr; spf=neutral
Authentication-Results: MX-IN-02.forthnet.gr header.from=jc@eworx.gr; sender-id=neutral
Message-ID: <49D498F7.4090708@eworx.gr>
Date: Thu, 02 Apr 2009 13:52:39 +0300
From: John Cherouvim <jc@eworx.gr>
User-Agent: Thunderbird 2.0.0.18 (Windows/20081105)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: SpellChecker AlreadyClosedException issue
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hello

My code looks like this:

Directory dir = null;
try {
    dir = FSDirectory.getDirectory("/path/to/dictionary");
    SpellChecker spell = new SpellChecker(dir); // exception thrown here
    // ...
    dir.close();
} catch (IOException ex) {
    log error
} finally {
    if (dir!=null) {
        try {
            dir.close();
        } catch (IOException ex) {
            log error
        }
    }
}


This code works, but in a highly concurrent situation 
AlreadyClosedException is being thrown when I try to instantiate the 
SpellChecker:
org.apache.lucene.store.AlreadyClosedException: this Directory is closed
    at org.apache.lucene.store.Directory.ensureOpen(Directory.java:220)
    at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:481)
    at org.apache.lucene.index.SegmentInfos.read(SegmentInfos.java:214)
    at 
org.apache.lucene.index.DirectoryIndexReader$1.doBody(DirectoryIndexReader.java:95)
    at 
org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:653)
    at 
org.apache.lucene.index.DirectoryIndexReader.open(DirectoryIndexReader.java:115)
    at org.apache.lucene.index.IndexReader.open(IndexReader.java:316)
    at org.apache.lucene.index.IndexReader.open(IndexReader.java:227)
    at org.apache.lucene.search.IndexSearcher.<init>(IndexSearcher.java:55)
    at 
org.apache.lucene.search.spell.SpellChecker.setSpellIndex(SpellChecker.java:116)
    at 
org.apache.lucene.search.spell.SpellChecker.<init>(SpellChecker.java:90)
    at 
org.apache.lucene.search.spell.SpellChecker.<init>(SpellChecker.java:95)


I use lucene-core-2.4.1.jar and lucene-spellchecker-2.4.1.jar and I can 
reproduce the error in both windows and linux.
Any ideas on what is wrong?

thanks
Ioannis Cherouvim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39461-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 11:02:07 2009
Return-Path: <java-user-return-39461-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28625 invoked from network); 2 Apr 2009 11:02:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 11:02:07 -0000
Received: (qmail 71207 invoked by uid 500); 2 Apr 2009 11:02:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71119 invoked by uid 500); 2 Apr 2009 11:02:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71109 invoked by uid 99); 2 Apr 2009 11:02:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 11:02:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 11:01:56 +0000
Received: by fxm2 with SMTP id 2so517837fxm.5
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 04:01:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:in-reply-to:references:date
         :received:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=9isk2R72XmWTg2yah/3k+FI8zAGfx/7MSJ0Pe5dky+4=;
        b=uHaXaHjXIOqYd0+CsbBesJW0h/WehBB23CHoi6azvljATnqtzDZPx+q83IjARxCKpF
         UGo3wneBOLpgksdTp5cnEd2nOyYNS6YcCiYwHCLwH31S/ML4ifDNFTDjxDVY3aUMKD9s
         Sn9ey5pHjlWdeGNniiJNkrarSUd68bu0f87T0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=bGYeXmKHQgeQTWiXdTPG0kWYh82Y7We8PtqEsU7P+mw6+Duzw7pRt9v6mbHbawULT/
         Fo+SD6DDLUXVaEfTniKO673FCZaqVGdT/tJTlk3Ld4eHEdlZtW1SS7req8s2kd0U53O+
         TPsyU3jfo+V2NtIzTYQ+JL2/6+vTrkn6nG/EU=
MIME-Version: 1.0
In-Reply-To: <bd7f960f0904020302k5b892aafsfe4f6d6a708068e6@mail.gmail.com>
References: <bd7f960f0904020302k5b892aafsfe4f6d6a708068e6@mail.gmail.com>
Date: Thu, 2 Apr 2009 12:01:21 +0100
Received: by 10.204.62.135 with SMTP id x7mr3160753bkh.124.1238670096555; Thu, 
	02 Apr 2009 04:01:36 -0700 (PDT)
Message-ID: <8c4e68610904020401r1bda67e9ybf1ed19a8c27785@mail.gmail.com>
Subject: Re: Lock obtain timed out
From: Ian Lea <ian.lea@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi


>From the 2.4 javadocs for IndexWriter:

setDefaultWriteLockTimeout(long writeLockTimeout)

    Sets the default (for any instance of IndexWriter) maximum time to
wait for a write lock (in milliseconds).

Lucene waits for the max specified time, retrying every 1000 millisecs
by default, then gives up.  See the docs for Lock for details.

Your options include setting a higher timeout, trapping the timeout
exception in your code and retrying, maybe after a pause, or
queuing/stacking up the updates, as you suggest.  Several ways to do
that, from a queue or stack within the tomcat instance, if you've just
got the one, or a more wide ranging multi process solution like JMS.


--
Ian.


On Thu, Apr 2, 2009 at 11:02 AM, Rehan Abdulaziz
<abdulazizrehan@gmail.com> wrote:
> Hey,
> Lucene is deployed at my Tomcat server, and when I send parallel calls from
> my client to add, delete or update documents, some operations are
> unsuccessful. The following exception is thrown:
>
> org.apache.lucene.store.LockObtainFailedException: Lock obtain timed out:
> SimpleFSLock@D:\testIndex\write.lock
>
> I understand what this means, and why this exception shows up. What I'm
> interested in knowing is what I can do about it. Does lucene try to send the
> query for some time, and then gives up? Is there a way to increase this
> time? Currently, if I send 100 documents to be added from my client, around
> 60-80 of them are added and the rest aren't. If I can play with the time,
> then perhaps I can achieve better performance.
>
> Secondly, can I somehow stack up all the queries at the server so as to
> ensure 100% success rate, no matter how fast the queries arrive? That would
> be helpful.
>
> Thanks,
> Rehan.
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39462-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 11:31:22 2009
Return-Path: <java-user-return-39462-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38735 invoked from network); 2 Apr 2009 11:31:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 11:31:21 -0000
Received: (qmail 7099 invoked by uid 500); 2 Apr 2009 11:31:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7008 invoked by uid 500); 2 Apr 2009 11:31:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6998 invoked by uid 99); 2 Apr 2009 11:31:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 11:31:19 +0000
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of seidymam@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 11:31:11 +0000
Received: by fg-out-1718.google.com with SMTP id l27so807174fgb.4
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 04:30:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=OhfifBgOndFktQ4tML3iJR+l/rHe5Un88/5BWuzY6mo=;
        b=NrKnENiCUaCvWtjZaS6xwNhdfV+DcZZTKlbQSZpytRCxTZvAkAJ8vJoM6x08UiNx9R
         2aTEBf2GtawNxIpVCkMUTRO6e3kMxfzcItovqeAy5Qfbb6c7sf5h8i8uSJmM6tTMR51v
         1lnA3Bs/AP9c+vBiui1TWU8bq4pgF8crBPGAo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=YNtqtguuy+SpfsLCUJc02WrZN6VjL4vUgOuQgkfSpiagZ19gJUDLzxXJcsfi3F7DTz
         ep2cJaiSJgCxOvR70SiDLNOvn63PY1ldbvgPDwJtVrlecEtrtKqTrTxkZmF7r7B7KcIi
         NodgO/1DDhher67tr2NINJAQa/simtRIcVSKo=
MIME-Version: 1.0
Received: by 10.86.79.19 with SMTP id c19mr1430044fgb.12.1238671849920; Thu, 
	02 Apr 2009 04:30:49 -0700 (PDT)
In-Reply-To: <22837185.post@talk.nabble.com>
References: <22819197.post@talk.nabble.com>
	 <49D36479.5080202@informatics.jax.org> <22837185.post@talk.nabble.com>
Date: Thu, 2 Apr 2009 14:30:49 +0300
Message-ID: <179b305e0904020430la8736a4n998257b100a4985f@mail.gmail.com>
Subject: Re: What is the right query syntax for matching some field's 
	substring?
From: Seid Mohammed <seidymam@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

hi bonn,
can you give me the link you did read for substring matching

Thanks a lot

On 4/2/09, Bon <bonbon@unipattern.com> wrote:
>
> Hi Matt,
>
>     Thanks for your answer,
>     I'm new to lucene, so I don't know what should I know about that.
>     I find a reference about discuss searching substring and it work good
> for me,
>     I'm not sure what analyer we used, I'll check it out and make sure why
> it work for us.
>
>     thank you very much =)
>
> Best Regards,
> Bon
>
>
> Matthew Hall-7 wrote:
>>
>> Which analyzer are you using here?  Depending on your choice the comma
>> separated values might be being kept together in your index, rather than
>> tokenized as you expected.
>>
>> Secondly, you should get Luke, and take a look into your index, this
>> should give you a much better idea of what's going on in your index.
>>
>> Anyhow, closely examine your analyzer choice, and then your query type
>> choice and see if that's where the problem lies.
>>
>> Matt
>>
>> Bon wrote:
>>> Hi all,
>>>
>>>     I've a question about the query syntax statement,
>>>     There is a lucene text field and the value of the field like
>>> ,11,12,15,16,
>>>     if I want to query some data and the value of the field has included
>>> some number what I like(11 or 15),
>>>     how can I do?
>>>     I try to give a query like (filed_name:,11,) but it can not get the
>>> matching.
>>>
>>>     or I must reformat the field value with some other symbol not the
>>> symbol
>>> comma ','
>>>
>>> Bon
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> --
> View this message in context:
> http://www.nabble.com/What-is-the-right-query-syntax-for-matching-some-field%27s-substring--tp22819197p22837185.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
"RABI ZIDNI ILMA"

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39463-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 13:35:21 2009
Return-Path: <java-user-return-39463-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21187 invoked from network); 2 Apr 2009 13:35:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 13:35:21 -0000
Received: (qmail 44688 invoked by uid 500); 2 Apr 2009 13:35:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44654 invoked by uid 500); 2 Apr 2009 13:35:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44626 invoked by uid 99); 2 Apr 2009 13:35:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 13:35:17 +0000
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,SUBJECT_FUZZY_TION
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.221.130 as permitted sender)
Received: from [209.85.221.130] (HELO mail-qy0-f130.google.com) (209.85.221.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 13:35:09 +0000
Received: by qyk36 with SMTP id 36so970957qyk.29
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 06:34:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=jSNvoVrVnk1+P3yuWHG873pc3aB8frp+OpapK0XMGr0=;
        b=cBngaHwDWPB+kNokyme9gPNVbgxd161MscPhcfF7zyGcY5UiDkrFb5B0IGO9XnVPll
         EICT0R1d7D3ABW+2nv/OxjIqlz8AYGTAfzAzCHnn67c8jUmvVL9nNeNzrrZHFNCSuFPO
         AyNyG5dVDBmm8wRT296DmsONS1RTNA/IJ6i4g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=oQCjDStHVbcGlOcf4B+vZ4dnmwc4gj81auyp9tgu+JCopZE26f/Y5MbRstNNYQ31FB
         Eb6GR4WG9jkceJhpPdoO962FKB9XLXz4nEAtGLr/jXSZ6FoFxdt92sesW6Cl3zzt3tx2
         XmkRufm44YA329O5GJScyXkSDYezDi8hlSqHs=
MIME-Version: 1.0
Received: by 10.220.90.83 with SMTP id h19mr77279vcm.30.1238679287675; Thu, 02 
	Apr 2009 06:34:47 -0700 (PDT)
In-Reply-To: <580407.67598.qm@web112207.mail.gq1.yahoo.com>
References: <702697.55499.qm@web112220.mail.gq1.yahoo.com>
	 <359a92830904011051p6a2d3abfwbf6b7279ae7c1c87@mail.gmail.com>
	 <580407.67598.qm@web112207.mail.gq1.yahoo.com>
Date: Thu, 2 Apr 2009 09:34:47 -0400
Message-ID: <359a92830904020634n6123817cmfeeee1a416ee32a6@mail.gmail.com>
Subject: Re: Search using MultiSearcher generates OOM on a 1GB total 
	Partitioned indeces
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64611c4eeba710466927e86
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64611c4eeba710466927e86
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Ah, I get it now. Given that you bumped your max clause up, it makes
sense. I'm pretty sure that the wildcard expansion is the root or your
memory problems. The folks on the list helped me out a lot understanding
what wildcards were about, see the thread titled "I just don't get wildcards
at all" in the searchable archives from several years ago...

Why do you want to generate queries of the form you showed? I'm
wondering if this is an XY problem and if you gave us a higher level
description of the problem you're trying to solve we'd be able to
suggest other approaches. I have a really hard time imagining a use
case where a user is well served by a clause that says
"any document that has word beginning with g and h and d and s.....",
so I'm assuming you're trying to solve something specific to your
domain.....

But if you really, truly do require this form, consider Filters. If your
problem really requires single-letter starts, consider creating 26
Filters at start up time and use those (see ConstantScoreQuery)
That'll chew up about 1.5M each of memory, faaaaar less than
you're consuming presently and will be blazingly fast. If you're
not limited to single-characters, *still* consider filters. They'll
consume little memory and are quite speedy to construct.

Best
Erick


On Thu, Apr 2, 2009 at 5:04 AM, Lebiram <lebiram@ymail.com> wrote:

> Hi Erick,
>
> I did a search just as JVM started... so I'm thinking that the JVM is busy
> with some startup stuff... and that this search required more memory than
> what is available at that time.
>
> Had I done this search a while after the JVM has started, then this query
> succeeds.
> I then pump in several similar queries running on a different thread and it
> takes a long time but still runs to completion until one of them generates
> OOM.But still, queries like this is just using too much memory.
>
> As for clauses, the BooleanQuery was set to max clause of... 9,000,000
> I'm guessing that might have caused the usage of too much memory?
>
> I'll try the explain on you've suggested.
>
> Thanks,
>
> M
>
>
>
>
> ________________________________
> From: Erick Erickson <erickerickson@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Wednesday, April 1, 2009 6:51:13 PM
> Subject: Re: Search using MultiSearcher generates OOM on a 1GB total
>  Partitioned indeces
>
> Think about putting this query in Luke and doing an "explain" for details,
> but....
>
> I'm surprised this is working at all without throwing TooManyClauses
> errors.
> Under the covers, Lucene expands your wildcards to all terms in the field
> that match. For instance, assume your document field has the following:
> aa
> ab
> ac
> ad
> ae
>
> Now, searching for a* produces a clause like:
> (aa OR ab OR ac OR ad OR ae) in place of the a*
>
> So your query is generating ginormous OR clauses, one that
> contains every term in your content field starting with 'g'. Another
> with every term in your content field starting with 'h' etc. So I suspect
> that your content field doesn't have very many distinct terms in it....
>
> As for why it's returning few entries, what does this part of your
> query return by itself? Since it's anded with your wildcard query,
> it might be what's limiting your results.
>
> ((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
> (+viewers:cpuser9 +viewers:cpuser4))
>
> But I'm puzzled, because saying that you're getting OOM errors
> doesn't square very well with getting *any* results at all, so is
> there something else going on?
>
> Best
> Erick@MoreQuestionsThanAnswers.
>
>
> On Wed, Apr 1, 2009 at 1:31 PM, Lebiram <lebiram@ymail.com> wrote:
>
> > Hi All,
> >
> > I have the following query on a 1GB index with about 12 million docs :
> > As you can see the terms consist of wildcards...
> >
> > query.toString()=+(+content:g* +content:h* +content:d* +content:s*
> > +content:a* +content:w* +content:b* +content:c* +content:m* +content:e*)
> > +((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
> > (+viewers:cpuser9 +viewers:cpuser4))
> >
> > The Searcher is a MultiSearcher with 4 IndexSearchers pointing to 4
> > different Lucene Index.
> > This search returns very few records, several ten thousand hits.
> >
> > Java is assigned with 1GB max memory.
> >
> > Somehow this search eats the entire java heap space and causes OOM.
> > Looking at jProfiler, i see org.apache.lucene package generating a lot of
> > objects which I believe is taking all this space.
> >
> > Can anyone explain the reason why this particular search might take so
> much
> > memory?
> > Is there anything I am doing wrong here?
> > More importantly, is there anything I can do to improve this?
> >
> > -M
> >
> >
> >
>
>
>
>
>

--0016e64611c4eeba710466927e86--

From java-user-return-39464-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 13:37:20 2009
Return-Path: <java-user-return-39464-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23170 invoked from network); 2 Apr 2009 13:37:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 13:37:20 -0000
Received: (qmail 48944 invoked by uid 500); 2 Apr 2009 13:37:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48853 invoked by uid 500); 2 Apr 2009 13:37:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48843 invoked by uid 99); 2 Apr 2009 13:37:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 13:37:17 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 13:37:11 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C9B398.1305E05A"
Subject: Using SpanNearQuery.getSpans() in a Search Result
Date: Thu, 2 Apr 2009 09:36:44 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02B1C4D8@mail02.tveyes.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Using SpanNearQuery.getSpans() in a Search Result
thread-index: AcmzmBA6Ce8IYMb8SjKDW2k5VBI68w==
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C9B398.1305E05A
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi all,

=20

I'm trying to figure out how to use SpanNearQuery.getSpans(IndexReader)
when working with a result set from a query.=20

=20

Maybe I have a fundamental misunderstanding of what an IndexReader is -
I'm under the impression that it's a mechanism for sequentially
accessing the documents in an index. So I'm not really sure how that
helps me find the spans inside a search result.

=20

My problem is compounded by the fact that I'm using
ParallelMultiSearcher so I'm not even 100% sure that I know what index
each Hit is located in.

=20

All of the examples I find (in LIA and from CNLP) demonstrate on an
in-memory index created for the sake of the example.

Can anyone give me any guidance on this?

=20

Thanks!

=20

-Dave=20

=20


------_=_NextPart_001_01C9B398.1305E05A--

From java-user-return-39465-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 13:55:45 2009
Return-Path: <java-user-return-39465-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39323 invoked from network); 2 Apr 2009 13:55:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 13:55:45 -0000
Received: (qmail 89126 invoked by uid 500); 2 Apr 2009 13:55:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89048 invoked by uid 500); 2 Apr 2009 13:55:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89038 invoked by uid 99); 2 Apr 2009 13:55:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 13:55:42 +0000
X-ASF-Spam-Status: No, hits=3.8 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL,SUBJECT_FUZZY_TION
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [68.142.237.123] (HELO n10.bullet.re3.yahoo.com) (68.142.237.123)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 02 Apr 2009 13:55:30 +0000
Received: from [68.142.237.90] by n10.bullet.re3.yahoo.com with NNFMP; 02 Apr 2009 13:55:08 -0000
Received: from [67.195.9.83] by t6.bullet.re3.yahoo.com with NNFMP; 02 Apr 2009 13:55:07 -0000
Received: from [67.195.9.110] by t3.bullet.mail.gq1.yahoo.com with NNFMP; 02 Apr 2009 13:55:07 -0000
Received: from [127.0.0.1] by omp114.mail.gq1.yahoo.com with NNFMP; 02 Apr 2009 13:52:53 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 705804.78603.bm@omp114.mail.gq1.yahoo.com
Received: (qmail 79497 invoked by uid 60001); 2 Apr 2009 13:55:07 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ymail.com; s=s1024; t=1238680507; bh=xwWDQVbUbJt7LTkEMLSINJ7o1of9lJ4J8JGQHqmYNm8=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=ivurDJ+pdJ3DaJ3pAg5cMYYG82fLjICDm5fkOsz9Z7qw1mU1NjZ1C68n0hJF8jjRweRug62DV4lrIkj9UgODowFYDXPW//Ku+3fg0JOSi0rzBZDrhhVmLCDrXzqi6jCXh1tyUMANnYPnQWhktKiJozlm3THGmofoUeeU4ynTN4E=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=ymail.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=oz0UWgm5QmieqjLKYfckF8/lRJjqLY8T+ef3Vj0bFaHu5bGvdGM8WtgLfVvukrF3zjzdbQbPVpmPXlhDzpg8H4gicUrkxIPRCVXXQc2E2EJhoT3LV8u3fHRtbH0utjwYBs9eIg/SakPo/a3clSIPnocyRCEUkqmhUPGOfXQ2ZXM=;
Message-ID: <999310.79121.qm@web112209.mail.gq1.yahoo.com>
X-YMail-OSG: s.c0hHgVM1nhrS.I6pHsJPPxvhxtZzAcGOamq4rpDlEMJKMBMYkKpGHg58W73Rtje1_etJ0dJ_.NceFfJMxM.UEDBipu5xeqQ8Y9xN0yboT_RRLs3STGS5ABo1.Htah39s9Bpa0dGSO1x8cITZmKpTNwQ5kDwguBe04WVE75Zxtpbu9W0IUjQz_YDayWJRO6Ljjucb3l3_0zUuzoGRWtybmKdRQIJpvboiVG4cgvFtQ8Aao5v6oAkaSgb4bVie1ydTVE.ILuuqFBorF3QvXIqsDMeCiI9hsyMJxdDFJ47whkcsK1k2Nv
Received: from [94.194.201.108] by web112209.mail.gq1.yahoo.com via HTTP; Thu, 02 Apr 2009 06:55:06 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <702697.55499.qm@web112220.mail.gq1.yahoo.com>  <359a92830904011051p6a2d3abfwbf6b7279ae7c1c87@mail.gmail.com>  <580407.67598.qm@web112207.mail.gq1.yahoo.com> <359a92830904020634n6123817cmfeeee1a416ee32a6@mail.gmail.com>
Date: Thu, 2 Apr 2009 06:55:06 -0700 (PDT)
From: Lebiram <lebiram@ymail.com>
Subject: Re: Search using MultiSearcher generates OOM on a 1GB total  Partitioned indeces
To: java-user@lucene.apache.org
In-Reply-To: <359a92830904020634n6123817cmfeeee1a416ee32a6@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1607462746-1238680506=:79121"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1607462746-1238680506=:79121
Content-Type: text/plain; charset=us-ascii

Hi Erick

The query was a test data basically in anticipation of searches on all indices (4 index) with 12 million docs
that should yield very small results. Obviously that query does not happen in real life but it did break the system.
If some user thought of just inputting random words then the system will be brought to its knees and eventually die.

Essentially, all our lucene index has about 8 fields; 1 field is being used as a filter (timestamp)
the rest are normal fields which can accept wildcards.

You have a point in Filters being useful for a few other fields we do have. I'll apply that.
So that leaves about 5 fields that allows fuzzy search.

Which goes back to the max clause problem. Lucene's default Max Clause is 1024, is there any reason behind this max?

Thanks, 

M


________________________________
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Sent: Thursday, April 2, 2009 2:34:47 PM
Subject: Re: Search using MultiSearcher generates OOM on a 1GB total  Partitioned indeces

Ah, I get it now. Given that you bumped your max clause up, it makes
sense. I'm pretty sure that the wildcard expansion is the root or your
memory problems. The folks on the list helped me out a lot understanding
what wildcards were about, see the thread titled "I just don't get wildcards
at all" in the searchable archives from several years ago...

Why do you want to generate queries of the form you showed? I'm
wondering if this is an XY problem and if you gave us a higher level
description of the problem you're trying to solve we'd be able to
suggest other approaches. I have a really hard time imagining a use
case where a user is well served by a clause that says
"any document that has word beginning with g and h and d and s.....",
so I'm assuming you're trying to solve something specific to your
domain.....

But if you really, truly do require this form, consider Filters. If your
problem really requires single-letter starts, consider creating 26
Filters at start up time and use those (see ConstantScoreQuery)
That'll chew up about 1.5M each of memory, faaaaar less than
you're consuming presently and will be blazingly fast. If you're
not limited to single-characters, *still* consider filters. They'll
consume little memory and are quite speedy to construct.

Best
Erick


On Thu, Apr 2, 2009 at 5:04 AM, Lebiram <lebiram@ymail.com> wrote:

> Hi Erick,
>
> I did a search just as JVM started... so I'm thinking that the JVM is busy
> with some startup stuff... and that this search required more memory than
> what is available at that time.
>
> Had I done this search a while after the JVM has started, then this query
> succeeds.
> I then pump in several similar queries running on a different thread and it
> takes a long time but still runs to completion until one of them generates
> OOM.But still, queries like this is just using too much memory.
>
> As for clauses, the BooleanQuery was set to max clause of... 9,000,000
> I'm guessing that might have caused the usage of too much memory?
>
> I'll try the explain on you've suggested.
>
> Thanks,
>
> M
>
>
>
>
> ________________________________
> From: Erick Erickson <erickerickson@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Wednesday, April 1, 2009 6:51:13 PM
> Subject: Re: Search using MultiSearcher generates OOM on a 1GB total
>  Partitioned indeces
>
> Think about putting this query in Luke and doing an "explain" for details,
> but....
>
> I'm surprised this is working at all without throwing TooManyClauses
> errors.
> Under the covers, Lucene expands your wildcards to all terms in the field
> that match. For instance, assume your document field has the following:
> aa
> ab
> ac
> ad
> ae
>
> Now, searching for a* produces a clause like:
> (aa OR ab OR ac OR ad OR ae) in place of the a*
>
> So your query is generating ginormous OR clauses, one that
> contains every term in your content field starting with 'g'. Another
> with every term in your content field starting with 'h' etc. So I suspect
> that your content field doesn't have very many distinct terms in it....
>
> As for why it's returning few entries, what does this part of your
> query return by itself? Since it's anded with your wildcard query,
> it might be what's limiting your results.
>
> ((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
> (+viewers:cpuser9 +viewers:cpuser4))
>
> But I'm puzzled, because saying that you're getting OOM errors
> doesn't square very well with getting *any* results at all, so is
> there something else going on?
>
> Best
> Erick@MoreQuestionsThanAnswers.
>
>
> On Wed, Apr 1, 2009 at 1:31 PM, Lebiram <lebiram@ymail.com> wrote:
>
> > Hi All,
> >
> > I have the following query on a 1GB index with about 12 million docs :
> > As you can see the terms consist of wildcards...
> >
> > query.toString()=+(+content:g* +content:h* +content:d* +content:s*
> > +content:a* +content:w* +content:b* +content:c* +content:m* +content:e*)
> > +((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
> > (+viewers:cpuser9 +viewers:cpuser4))
> >
> > The Searcher is a MultiSearcher with 4 IndexSearchers pointing to 4
> > different Lucene Index.
> > This search returns very few records, several ten thousand hits.
> >
> > Java is assigned with 1GB max memory.
> >
> > Somehow this search eats the entire java heap space and causes OOM.
> > Looking at jProfiler, i see org.apache.lucene package generating a lot of
> > objects which I believe is taking all this space.
> >
> > Can anyone explain the reason why this particular search might take so
> much
> > memory?
> > Is there anything I am doing wrong here?
> > More importantly, is there anything I can do to improve this?
> >
> > -M
> >
> >
> >
>
>
>
>
>



      
--0-1607462746-1238680506=:79121--


From java-user-return-39466-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 14:46:02 2009
Return-Path: <java-user-return-39466-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77778 invoked from network); 2 Apr 2009 14:46:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 14:46:02 -0000
Received: (qmail 38403 invoked by uid 500); 2 Apr 2009 14:46:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38353 invoked by uid 500); 2 Apr 2009 14:45:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38343 invoked by uid 99); 2 Apr 2009 14:45:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 14:45:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 14:45:51 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: Retrieving TokenStream from Tokenized Non-Stored Field
Date: Thu, 2 Apr 2009 10:45:24 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02B1C509@mail02.tveyes.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Retrieving TokenStream from Tokenized Non-Stored Field
thread-index: AcmzoafYmiMrdThEQ6Oo6kJ+cw1AvA==
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,
I have a document with a field called "TextTranscript". Its created
using the following command:

myDoc.add(new Field("TextTranscript", sTranscriptBody, Field.Store.NO,
Field.Index.TOKENIZED));

I'm then trying to retrieve the TokenStream by pulling the field.

Field fTextTranscript =3D lucDoc.getField("TextTranscript");

But fTextTranscript seems always to be NULL.  My understanding is that I
should be able to retrieve the TokenString, even if it's not "Stored".
Am I incorrect? Is there a better way of doing this?

Thanks!

-Dave


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39467-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 14:46:51 2009
Return-Path: <java-user-return-39467-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77978 invoked from network); 2 Apr 2009 14:46:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 14:46:51 -0000
Received: (qmail 40258 invoked by uid 500); 2 Apr 2009 14:46:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40201 invoked by uid 500); 2 Apr 2009 14:46:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40191 invoked by uid 99); 2 Apr 2009 14:46:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 14:46:48 +0000
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,SUBJECT_FUZZY_TION
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 14:46:40 +0000
Received: by ewy27 with SMTP id 27so632025ewy.5
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 07:46:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=7yHaM7hP0isWdn/N/h/1io2EtdUflzBbPENiR8luawA=;
        b=IKzE/xBjQVdQWYSpx9Z4QjUgjMlzTDiePc9jD9ySegNvbTi5z5ruLUVsn3wneYpO3E
         UzAbMFUMQd61MkDSeSl8PgzKJ76Zefq0VUr1xAMYOh8RnJAy6ovSq7Cghg4MZ7ZL5AcC
         lxJuEDxe97nLGo1ASknomdS7oIAIiMkwBOeWw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=eHAKTY7oeO4sCmQsMIi7FBIbKDg6cVobUyOFd0UnIMP2XPvieI+GfyEeYmIkJJP3ra
         NIoS0i8GP3sz/xxNt31SenHF66ofeJiacQwUd8mtMfYsXVloh96T1tjeS9bNYQGKsrAJ
         22OPZEfzn/Lk3ve+TjAFRssTxIeDSnRgkdcDs=
MIME-Version: 1.0
Received: by 10.220.91.148 with SMTP id n20mr167029vcm.68.1238683577186; Thu, 
	02 Apr 2009 07:46:17 -0700 (PDT)
In-Reply-To: <999310.79121.qm@web112209.mail.gq1.yahoo.com>
References: <702697.55499.qm@web112220.mail.gq1.yahoo.com>
	 <359a92830904011051p6a2d3abfwbf6b7279ae7c1c87@mail.gmail.com>
	 <580407.67598.qm@web112207.mail.gq1.yahoo.com>
	 <359a92830904020634n6123817cmfeeee1a416ee32a6@mail.gmail.com>
	 <999310.79121.qm@web112209.mail.gq1.yahoo.com>
Date: Thu, 2 Apr 2009 10:46:17 -0400
Message-ID: <359a92830904020746p1d8c44abic6442c1a78ccd5d4@mail.gmail.com>
Subject: Re: Search using MultiSearcher generates OOM on a 1GB total 
	Partitioned indeces
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64758529c1e330466937edf
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64758529c1e330466937edf
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I didn't code it, so I'm speaking at least second hand....

It's a valid question whether having larger clauses is useful to
the user. Having a 1024 term OR clause isn't narrowing that much.
Plus, I think, it was a number that says, in effect, "you should know
that this is getting to be an expensive query, don't be surprised
if it takes a while". I suspect it's probably semi-arbitrary way to
define "big and expensive" <G>.

<<If some user thought of just inputting random words then the system
will be brought to its knees and eventually die.>>>

Well, yes. If you allowed this pathological query through. Which you did
by bumping the max clauses parameter. In effect, you've been forced to
consider this issue in your design rather than be left wondering,
months from now when the system is in production, "why are some
queries slow?"...

One solution is to reject prefix queries that have fewer than, say, three
leading characters. Similarly for single-character wildcard characters.
The number of terms  that have to be ORed together reduces drastically
with more characters.

I'd recommend you think first about rejecting pathological queries rather
than wasting a lot of time making them work. I had to get over thinking
that "any query should work, no matter how bizarre", which I did by
thinking about how much use to a user a query that returned 100,000
results would actually be.


You could limit pathology by either just dropping the max booleans
back to a "reasonable" number as defined by you and responding
with an appropriate message or pre-processing the query and
rejecting it up front.

Best
Erick

On Thu, Apr 2, 2009 at 9:55 AM, Lebiram <lebiram@ymail.com> wrote:

> Hi Erick
>
> The query was a test data basically in anticipation of searches on all
> indices (4 index) with 12 million docs
> that should yield very small results. Obviously that query does not happen
> in real life but it did break the system.
> If some user thought of just inputting random words then the system will be
> brought to its knees and eventually die.
>
> Essentially, all our lucene index has about 8 fields; 1 field is being used
> as a filter (timestamp)
> the rest are normal fields which can accept wildcards.
>
> You have a point in Filters being useful for a few other fields we do have.
> I'll apply that.
> So that leaves about 5 fields that allows fuzzy search.
>
> Which goes back to the max clause problem. Lucene's default Max Clause is
> 1024, is there any reason behind this max?
>
> Thanks,
>
> M
>
>
> ________________________________
> From: Erick Erickson <erickerickson@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Thursday, April 2, 2009 2:34:47 PM
> Subject: Re: Search using MultiSearcher generates OOM on a 1GB total
>  Partitioned indeces
>
> Ah, I get it now. Given that you bumped your max clause up, it makes
> sense. I'm pretty sure that the wildcard expansion is the root or your
> memory problems. The folks on the list helped me out a lot understanding
> what wildcards were about, see the thread titled "I just don't get
> wildcards
> at all" in the searchable archives from several years ago...
>
> Why do you want to generate queries of the form you showed? I'm
> wondering if this is an XY problem and if you gave us a higher level
> description of the problem you're trying to solve we'd be able to
> suggest other approaches. I have a really hard time imagining a use
> case where a user is well served by a clause that says
> "any document that has word beginning with g and h and d and s.....",
> so I'm assuming you're trying to solve something specific to your
> domain.....
>
> But if you really, truly do require this form, consider Filters. If your
> problem really requires single-letter starts, consider creating 26
> Filters at start up time and use those (see ConstantScoreQuery)
> That'll chew up about 1.5M each of memory, faaaaar less than
> you're consuming presently and will be blazingly fast. If you're
> not limited to single-characters, *still* consider filters. They'll
> consume little memory and are quite speedy to construct.
>
> Best
> Erick
>
>
> On Thu, Apr 2, 2009 at 5:04 AM, Lebiram <lebiram@ymail.com> wrote:
>
> > Hi Erick,
> >
> > I did a search just as JVM started... so I'm thinking that the JVM is
> busy
> > with some startup stuff... and that this search required more memory than
> > what is available at that time.
> >
> > Had I done this search a while after the JVM has started, then this query
> > succeeds.
> > I then pump in several similar queries running on a different thread and
> it
> > takes a long time but still runs to completion until one of them
> generates
> > OOM.But still, queries like this is just using too much memory.
> >
> > As for clauses, the BooleanQuery was set to max clause of... 9,000,000
> > I'm guessing that might have caused the usage of too much memory?
> >
> > I'll try the explain on you've suggested.
> >
> > Thanks,
> >
> > M
> >
> >
> >
> >
> > ________________________________
> > From: Erick Erickson <erickerickson@gmail.com>
> > To: java-user@lucene.apache.org
> > Sent: Wednesday, April 1, 2009 6:51:13 PM
> > Subject: Re: Search using MultiSearcher generates OOM on a 1GB total
> >  Partitioned indeces
> >
> > Think about putting this query in Luke and doing an "explain" for
> details,
> > but....
> >
> > I'm surprised this is working at all without throwing TooManyClauses
> > errors.
> > Under the covers, Lucene expands your wildcards to all terms in the field
> > that match. For instance, assume your document field has the following:
> > aa
> > ab
> > ac
> > ad
> > ae
> >
> > Now, searching for a* produces a clause like:
> > (aa OR ab OR ac OR ad OR ae) in place of the a*
> >
> > So your query is generating ginormous OR clauses, one that
> > contains every term in your content field starting with 'g'. Another
> > with every term in your content field starting with 'h' etc. So I suspect
> > that your content field doesn't have very many distinct terms in it....
> >
> > As for why it's returning few entries, what does this part of your
> > query return by itself? Since it's anded with your wildcard query,
> > it might be what's limiting your results.
> >
> > ((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
> > (+viewers:cpuser9 +viewers:cpuser4))
> >
> > But I'm puzzled, because saying that you're getting OOM errors
> > doesn't square very well with getting *any* results at all, so is
> > there something else going on?
> >
> > Best
> > Erick@MoreQuestionsThanAnswers.
> >
> >
> > On Wed, Apr 1, 2009 at 1:31 PM, Lebiram <lebiram@ymail.com> wrote:
> >
> > > Hi All,
> > >
> > > I have the following query on a 1GB index with about 12 million docs :
> > > As you can see the terms consist of wildcards...
> > >
> > > query.toString()=+(+content:g* +content:h* +content:d* +content:s*
> > > +content:a* +content:w* +content:b* +content:c* +content:m*
> +content:e*)
> > > +((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
> > > (+viewers:cpuser9 +viewers:cpuser4))
> > >
> > > The Searcher is a MultiSearcher with 4 IndexSearchers pointing to 4
> > > different Lucene Index.
> > > This search returns very few records, several ten thousand hits.
> > >
> > > Java is assigned with 1GB max memory.
> > >
> > > Somehow this search eats the entire java heap space and causes OOM.
> > > Looking at jProfiler, i see org.apache.lucene package generating a lot
> of
> > > objects which I believe is taking all this space.
> > >
> > > Can anyone explain the reason why this particular search might take so
> > much
> > > memory?
> > > Is there anything I am doing wrong here?
> > > More importantly, is there anything I can do to improve this?
> > >
> > > -M
> > >
> > >
> > >
> >
> >
> >
> >
> >
>
>
>
>
>

--0016e64758529c1e330466937edf--

From java-user-return-39468-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 14:47:50 2009
Return-Path: <java-user-return-39468-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78177 invoked from network); 2 Apr 2009 14:47:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 14:47:48 -0000
Received: (qmail 44042 invoked by uid 500); 2 Apr 2009 14:47:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43729 invoked by uid 500); 2 Apr 2009 14:47:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43683 invoked by uid 99); 2 Apr 2009 14:47:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 14:47:42 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.221.130] (HELO mail-qy0-f130.google.com) (209.85.221.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 14:47:35 +0000
Received: by qyk36 with SMTP id 36so1042030qyk.29
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 07:47:08 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.42.7 with SMTP id u7mr21761wfj.99.1238683627549; Thu, 02 
	Apr 2009 07:47:07 -0700 (PDT)
In-Reply-To: <24098ED350C76D46A4FDBD81B51BE0E9034CB5E91B@exchange.windows.mmu.acquiremedia.com>
References: <24098ED350C76D46A4FDBD81B51BE0E9034CB5E91B@exchange.windows.mmu.acquiremedia.com>
Date: Thu, 2 Apr 2009 10:47:07 -0400
Message-ID: <9ac0c6aa0904020747i3898f934r96ce4e2486047721@mail.gmail.com>
Subject: Re: Help to determine why an optimized index is proportionaly too 
	big.
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Apr 1, 2009 at 5:20 PM, Dan OConnor <doconnor@acquiremedia.com> wro=
te:
> All:
>
> We are using java lucene 2.3.2 to index a fairly large number of document=
s (roughly 400,000 per day). We have divided the time history into various =
depths.
>
> Our first stage covers 8 days and our next stage covers 22. The index dir=
ectory for the first stage is approximately 20G when fully optimized. The i=
ndex directory of our second stage is over 250GB when optimized. Our third =
stage (which is 60 days) is only ~80GB when optimized.

Are these divisions overlapping?  Ie, 2nd index includes all docs from
the first one (8 days) plus another 14 days, and 3rd index (60 days)
includes all 22 days from 2nd one plus another 38 days?

If so, I don't understand eg why the 60 day index is smaller than the
22 day index.  That's odd.

> The second stage index failed an optimization with a disk full exception =
(I had to move it to another lucene machine with a larger disk partition to=
 complete the optimization. Is there a reason why a 22 day index would be 1=
0x the size of an 8 day index when the document indexing rate is fairly con=
stant? Also, is there a way to shrink the index without regenerating it?

You can't shrink the index without deleting docs... eg you could
delete docs, and add newer docs that store less stuff, to shrink the
index over time (merging/optimizing will reclaim disk space).

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39469-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 14:53:02 2009
Return-Path: <java-user-return-39469-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80517 invoked from network); 2 Apr 2009 14:53:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 14:53:02 -0000
Received: (qmail 65501 invoked by uid 500); 2 Apr 2009 14:52:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65413 invoked by uid 500); 2 Apr 2009 14:52:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65377 invoked by uid 99); 2 Apr 2009 14:52:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 14:52:57 +0000
X-ASF-Spam-Status: No, hits=0.4 required=10.0
	tests=SPF_PASS,SUBJECT_FUZZY_TION
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 74.125.92.27 as permitted sender)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 14:52:48 +0000
Received: by qw-out-2122.google.com with SMTP id 8so447269qwh.53
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 07:52:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=1GD5y2ltuH5FwN6mZl44l/R7bOMM/O9guGCpKKJKOLw=;
        b=foCpN81FlwPEvKQbsa0rY4Qrih59k/6bg8KuDTSxZLT+xcOW7IoOX44UA0oC1bl5IN
         u3ZQwPlrQQ67kHm4Hani9w1OHxbW2qBLeunsn1i680fT3bRi/LlWFL31F4nHIaGE5uTf
         Is1NgAN/G6d4HMZ9CpE1EXInMx7pKxz/FwYDE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=Xztkz5VZ4OBhJU5Jt3OB3qyHaHrQ0ILgK48WDNC/8iqctQk3+BAUvTnnuRVITIkt9w
         qR4VfNI+jhzJdJYpB69G2fNHbJNwgZxaHdSIzEMvzzI0Hhsj6RuCxJFjPRnIjnaJ4Zue
         7ok4hoKjyZ8CaQLglwNvfTWq2+ax7SBX4Rtyc=
Received: by 10.224.3.16 with SMTP id 16mr137425qal.361.1238683947370;
        Thu, 02 Apr 2009 07:52:27 -0700 (PDT)
Received: from ?192.168.1.120? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 5sm1245831qwg.44.2009.04.02.07.52.25
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 02 Apr 2009 07:52:26 -0700 (PDT)
Message-ID: <49D4D128.8090800@gmail.com>
Date: Thu, 02 Apr 2009 10:52:24 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.21 (X11/20090319)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Search using MultiSearcher generates OOM on a 1GB total  Partitioned
 indeces
References: <702697.55499.qm@web112220.mail.gq1.yahoo.com>  <359a92830904011051p6a2d3abfwbf6b7279ae7c1c87@mail.gmail.com>  <580407.67598.qm@web112207.mail.gq1.yahoo.com> <359a92830904020634n6123817cmfeeee1a416ee32a6@mail.gmail.com> <999310.79121.qm@web112209.mail.gq1.yahoo.com>
In-Reply-To: <999310.79121.qm@web112209.mail.gq1.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

You might try a constant score wildcard query (similar to a filter) - I 
think you'd have to grab it from solr's codebase until 2.9 comes out 
though. No clause limit, and reportedly *much* faster on large indexes.

-- 
- Mark

http://www.lucidimagination.com



Lebiram wrote:
> Hi Erick
>
> The query was a test data basically in anticipation of searches on all indices (4 index) with 12 million docs
> that should yield very small results. Obviously that query does not happen in real life but it did break the system.
> If some user thought of just inputting random words then the system will be brought to its knees and eventually die.
>
> Essentially, all our lucene index has about 8 fields; 1 field is being used as a filter (timestamp)
> the rest are normal fields which can accept wildcards.
>
> You have a point in Filters being useful for a few other fields we do have. I'll apply that.
> So that leaves about 5 fields that allows fuzzy search.
>
> Which goes back to the max clause problem. Lucene's default Max Clause is 1024, is there any reason behind this max?
>
> Thanks, 
>
> M
>
>
> ________________________________
> From: Erick Erickson <erickerickson@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Thursday, April 2, 2009 2:34:47 PM
> Subject: Re: Search using MultiSearcher generates OOM on a 1GB total  Partitioned indeces
>
> Ah, I get it now. Given that you bumped your max clause up, it makes
> sense. I'm pretty sure that the wildcard expansion is the root or your
> memory problems. The folks on the list helped me out a lot understanding
> what wildcards were about, see the thread titled "I just don't get wildcards
> at all" in the searchable archives from several years ago...
>
> Why do you want to generate queries of the form you showed? I'm
> wondering if this is an XY problem and if you gave us a higher level
> description of the problem you're trying to solve we'd be able to
> suggest other approaches. I have a really hard time imagining a use
> case where a user is well served by a clause that says
> "any document that has word beginning with g and h and d and s.....",
> so I'm assuming you're trying to solve something specific to your
> domain.....
>
> But if you really, truly do require this form, consider Filters. If your
> problem really requires single-letter starts, consider creating 26
> Filters at start up time and use those (see ConstantScoreQuery)
> That'll chew up about 1.5M each of memory, faaaaar less than
> you're consuming presently and will be blazingly fast. If you're
> not limited to single-characters, *still* consider filters. They'll
> consume little memory and are quite speedy to construct.
>
> Best
> Erick
>
>
> On Thu, Apr 2, 2009 at 5:04 AM, Lebiram <lebiram@ymail.com> wrote:
>
>   
>> Hi Erick,
>>
>> I did a search just as JVM started... so I'm thinking that the JVM is busy
>> with some startup stuff... and that this search required more memory than
>> what is available at that time.
>>
>> Had I done this search a while after the JVM has started, then this query
>> succeeds.
>> I then pump in several similar queries running on a different thread and it
>> takes a long time but still runs to completion until one of them generates
>> OOM.But still, queries like this is just using too much memory.
>>
>> As for clauses, the BooleanQuery was set to max clause of... 9,000,000
>> I'm guessing that might have caused the usage of too much memory?
>>
>> I'll try the explain on you've suggested.
>>
>> Thanks,
>>
>> M
>>
>>
>>
>>
>> ________________________________
>> From: Erick Erickson <erickerickson@gmail.com>
>> To: java-user@lucene.apache.org
>> Sent: Wednesday, April 1, 2009 6:51:13 PM
>> Subject: Re: Search using MultiSearcher generates OOM on a 1GB total
>>  Partitioned indeces
>>
>> Think about putting this query in Luke and doing an "explain" for details,
>> but....
>>
>> I'm surprised this is working at all without throwing TooManyClauses
>> errors.
>> Under the covers, Lucene expands your wildcards to all terms in the field
>> that match. For instance, assume your document field has the following:
>> aa
>> ab
>> ac
>> ad
>> ae
>>
>> Now, searching for a* produces a clause like:
>> (aa OR ab OR ac OR ad OR ae) in place of the a*
>>
>> So your query is generating ginormous OR clauses, one that
>> contains every term in your content field starting with 'g'. Another
>> with every term in your content field starting with 'h' etc. So I suspect
>> that your content field doesn't have very many distinct terms in it....
>>
>> As for why it's returning few entries, what does this part of your
>> query return by itself? Since it's anded with your wildcard query,
>> it might be what's limiting your results.
>>
>> ((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
>> (+viewers:cpuser9 +viewers:cpuser4))
>>
>> But I'm puzzled, because saying that you're getting OOM errors
>> doesn't square very well with getting *any* results at all, so is
>> there something else going on?
>>
>> Best
>> Erick@MoreQuestionsThanAnswers.
>>
>>
>> On Wed, Apr 1, 2009 at 1:31 PM, Lebiram <lebiram@ymail.com> wrote:
>>
>>     
>>> Hi All,
>>>
>>> I have the following query on a 1GB index with about 12 million docs :
>>> As you can see the terms consist of wildcards...
>>>
>>> query.toString()=+(+content:g* +content:h* +content:d* +content:s*
>>> +content:a* +content:w* +content:b* +content:c* +content:m* +content:e*)
>>> +((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
>>> (+viewers:cpuser9 +viewers:cpuser4))
>>>
>>> The Searcher is a MultiSearcher with 4 IndexSearchers pointing to 4
>>> different Lucene Index.
>>> This search returns very few records, several ten thousand hits.
>>>
>>> Java is assigned with 1GB max memory.
>>>
>>> Somehow this search eats the entire java heap space and causes OOM.
>>> Looking at jProfiler, i see org.apache.lucene package generating a lot of
>>> objects which I believe is taking all this space.
>>>
>>> Can anyone explain the reason why this particular search might take so
>>>       
>> much
>>     
>>> memory?
>>> Is there anything I am doing wrong here?
>>> More importantly, is there anything I can do to improve this?
>>>
>>> -M
>>>
>>>
>>>
>>>       
>>
>>
>>
>>     
>
>
>
>       
>   





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39470-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 15:15:44 2009
Return-Path: <java-user-return-39470-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11445 invoked from network); 2 Apr 2009 15:15:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 15:15:44 -0000
Received: (qmail 22283 invoked by uid 500); 2 Apr 2009 15:15:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22212 invoked by uid 500); 2 Apr 2009 15:15:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22202 invoked by uid 99); 2 Apr 2009 15:15:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 15:15:41 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of MSchraeder@btsb.com designates 216.8.91.5 as permitted sender)
Received: from [216.8.91.5] (HELO mail.btsb.com) (216.8.91.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 15:15:35 +0000
X-IronPort-AV: E=Sophos;i="4.39,314,1235973600"; 
   d="scan'208,217";a="471084"
Received: from unknown (HELO mail.btsb.com) ([10.1.1.2])
  by mail.btsb.com with ESMTP; 02 Apr 2009 10:17:00 -0500
Received: from GWDOMAIN-MTA by mail.btsb.com
	with Novell_GroupWise; Thu, 02 Apr 2009 10:17:23 -0600
Message-Id: <s9d490b3.093@mail.btsb.com>
X-Mailer: Novell GroupWise Internet Agent 6.5.5 
Date: Thu, 02 Apr 2009 10:16:57 -0600
From: "Matt Schraeder" <MSchraeder@btsb.com>
To: <java-user@lucene.apache.org>
Subject: Speed of fuzzy searches
Mime-Version: 1.0
Content-Type: multipart/alternative; boundary="=__PartF8D068E9.0__="
X-Virus-Checked: Checked by ClamAV on apache.org

--=__PartF8D068E9.0__=
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

I've got a simple Lucene index and search built for testing purposes. 
So far everything seems great. Most searches take 0.02 seconds or less.
Searches with 4-5 terms take 0.25 seconds or less.  However, once I
began playing with fuzzy searches everything seemed to really slow down.
 A fuzzy search seems to take vastly longer time, 6 seconds for a single
term such as "cow~" and 24 seconds for fuzzy searches of multiple
terms.
 
Is there anything I can do to speed up fuzzy searches or are they by
default just simply slow?  
 
My index is only 6.1M, with ~18000 documents.  Each document has 5
fields, a combination of text and keywords. I'm afraid that when I begin
to scale up to have more fields it will only make the problem worse.

--=__PartF8D068E9.0__=--

From java-user-return-39471-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 15:25:15 2009
Return-Path: <java-user-return-39471-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14989 invoked from network); 2 Apr 2009 15:25:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 15:25:15 -0000
Received: (qmail 49767 invoked by uid 500); 2 Apr 2009 15:25:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49687 invoked by uid 500); 2 Apr 2009 15:25:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49672 invoked by uid 99); 2 Apr 2009 15:25:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 15:25:12 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.221.130 as permitted sender)
Received: from [209.85.221.130] (HELO mail-qy0-f130.google.com) (209.85.221.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 15:25:04 +0000
Received: by qyk36 with SMTP id 36so1082699qyk.29
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 08:24:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=LHtlVOEupY53JszW49pCXPbmUAkJorDlKRWmLuo6sAk=;
        b=YuQOwbTriCy52zX0Rj1etWh5mC+yW4hen2clqkC5PaoDpIhavok1cQJf8WulRIkxqP
         Ez3AhL5XT+9xPX8htduMSuaFeQOg6Se/xpbqOn4Ej0b5EtAFmivboTERdZvDdE6rRlqv
         +KVJ4/PQ7p37pfMqHb4xeWpf5NtIsxB4ZsNiU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=sGlkbKpjrgpUIYZb6m2CGKVRLeHgI2K6NucFGhV6TSO1sor3u8dmb6xT8TUOMF9cSa
         91jTswJzlNMUglLIkhn+VZ4SquF6gNgQItLXY8nWp0Uyx11myT3xJ8MDDRvniZUhTFBv
         GMybxaFwyy2oyDZc2LTS2jAk1NxQjpBHVT9ZY=
MIME-Version: 1.0
Received: by 10.220.45.208 with SMTP id g16mr200159vcf.111.1238685882565; Thu, 
	02 Apr 2009 08:24:42 -0700 (PDT)
In-Reply-To: <s9d490b3.093@mail.btsb.com>
References: <s9d490b3.093@mail.btsb.com>
Date: Thu, 2 Apr 2009 11:24:42 -0400
Message-ID: <359a92830904020824m371e4bcbq1d479bf24e8e84f6@mail.gmail.com>
Subject: Re: Speed of fuzzy searches
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016363b7a6604c8e004669408aa
X-Virus-Checked: Checked by ClamAV on apache.org

--0016363b7a6604c8e004669408aa
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

This seems really odd, especially with an index that size. The
first question is usually "Do you open an IndexReader for
each query?" If you do, be aware that opening a reader/searcher
is expensive, and the first few queries through the system are
slow as the caches are built up.

The second question is, have you looked at:

http://wiki.apache.org/lucene-java/LuceneFAQ#head-1b15abeee21b0a72492b1b97a86e260e83c61387

the section "How can I speed up searching"

which also points you here:
http://wiki.apache.org/lucene-java/ImproveSearchingSpeed

Best
Erick

On Thu, Apr 2, 2009 at 12:16 PM, Matt Schraeder <MSchraeder@btsb.com> wrote:

> I've got a simple Lucene index and search built for testing purposes.
> So far everything seems great. Most searches take 0.02 seconds or less.
> Searches with 4-5 terms take 0.25 seconds or less.  However, once I
> began playing with fuzzy searches everything seemed to really slow down.
>  A fuzzy search seems to take vastly longer time, 6 seconds for a single
> term such as "cow~" and 24 seconds for fuzzy searches of multiple
> terms.
>
> Is there anything I can do to speed up fuzzy searches or are they by
> default just simply slow?
>
> My index is only 6.1M, with ~18000 documents.  Each document has 5
> fields, a combination of text and keywords. I'm afraid that when I begin
> to scale up to have more fields it will only make the problem worse.
>

--0016363b7a6604c8e004669408aa--

From java-user-return-39472-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 15:41:35 2009
Return-Path: <java-user-return-39472-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23471 invoked from network); 2 Apr 2009 15:41:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 15:41:34 -0000
Received: (qmail 218 invoked by uid 500); 2 Apr 2009 15:41:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 154 invoked by uid 500); 2 Apr 2009 15:41:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 144 invoked by uid 99); 2 Apr 2009 15:41:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 15:41:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.221.130 as permitted sender)
Received: from [209.85.221.130] (HELO mail-qy0-f130.google.com) (209.85.221.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 15:41:22 +0000
Received: by qyk36 with SMTP id 36so1099755qyk.29
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 08:41:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=JirEqfQ95ptPJeIL3X2Qs1llOnQcYwjnST9fEl49KJU=;
        b=xzxkE1U1DJxlKbacuaCM0MKzefA7IjNDpci4OW2vANGliDaqbJErKMLMrQEtSnnf9+
         88SM1rfqOH310La5pZybx+LcZuSCtKTwRmhwHgBfSUsscdRy6yFkiTCp4kuJPRT56wp+
         JFFNNHzXtYt9vWPrzrQ9A2hMIvG+zoHPSOuWU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=kjPQyGHjBhtSQrMVr+3eeX+MTsvk4xr62E5AqIm5Lx0UjuPPeKU2pFxeDfjW+UwyZ3
         kNGBqyqqMQon9XCnXU6tux9GlijUS9gRZb/ZZhQHM5z2IOa6ELYTVrXuKq5O7VOufd2i
         N21uFeFXARXnECcKSV1NwskvJTXogTzweQGNE=
Received: by 10.224.80.193 with SMTP id u1mr277016qak.104.1238686861622;
        Thu, 02 Apr 2009 08:41:01 -0700 (PDT)
Received: from ?192.168.1.120? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 7sm1292925qwf.10.2009.04.02.08.41.00
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 02 Apr 2009 08:41:01 -0700 (PDT)
Message-ID: <49D4DC8B.5030409@gmail.com>
Date: Thu, 02 Apr 2009 11:40:59 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.21 (X11/20090319)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Speed of fuzzy searches
References: <s9d490b3.093@mail.btsb.com>
In-Reply-To: <s9d490b3.093@mail.btsb.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Matt Schraeder wrote:
> I've got a simple Lucene index and search built for testing purposes. 
> So far everything seems great. Most searches take 0.02 seconds or less.
> Searches with 4-5 terms take 0.25 seconds or less.  However, once I
> began playing with fuzzy searches everything seemed to really slow down.
>  A fuzzy search seems to take vastly longer time, 6 seconds for a single
> term such as "cow~" and 24 seconds for fuzzy searches of multiple
> terms.
>  
> Is there anything I can do to speed up fuzzy searches or are they by
> default just simply slow?  
>  
> My index is only 6.1M, with ~18000 documents.  Each document has 5
> fields, a combination of text and keywords. I'm afraid that when I begin
> to scale up to have more fields it will only make the problem worse.
>
>   
You might try setting a longer prefix. Fuzzy queries don't scale by the 
way. By default they enumerate every unique term. How many unique terms 
do you have in the index?

- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39473-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 16:34:02 2009
Return-Path: <java-user-return-39473-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40324 invoked from network); 2 Apr 2009 16:34:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 16:34:00 -0000
Received: (qmail 80908 invoked by uid 500); 2 Apr 2009 16:33:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80840 invoked by uid 500); 2 Apr 2009 16:33:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80830 invoked by uid 99); 2 Apr 2009 16:33:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 16:33:58 +0000
X-ASF-Spam-Status: No, hits=3.8 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL,SUBJECT_FUZZY_TION
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [68.142.237.108] (HELO n1.bullet.mail.re3.yahoo.com) (68.142.237.108)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 02 Apr 2009 16:33:46 +0000
Received: from [68.142.230.28] by n1.bullet.mail.re3.yahoo.com with NNFMP; 02 Apr 2009 16:33:25 -0000
Received: from [67.195.9.82] by t1.bullet.re2.yahoo.com with NNFMP; 02 Apr 2009 16:33:24 -0000
Received: from [67.195.9.101] by t2.bullet.mail.gq1.yahoo.com with NNFMP; 02 Apr 2009 16:33:24 -0000
Received: from [127.0.0.1] by omp105.mail.gq1.yahoo.com with NNFMP; 02 Apr 2009 16:31:26 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 98994.11761.bm@omp105.mail.gq1.yahoo.com
Received: (qmail 45612 invoked by uid 60001); 2 Apr 2009 16:33:24 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ymail.com; s=s1024; t=1238690004; bh=c4NmsPVNOokSbytRDmOu1ezVNwFcYnopbz+/Y2baROU=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=GG/TDb/K4Pe9ez1cV32LhGDSD5jNARFUGVo5ZcwUY5+lBVXCAY0t3Osm4KCBTcBdMMN8wEB5xds+FjTUYx9s0j0kBHokCC1eOzBfaicTsErn20rbbEYDX4dIRPdmAQWy87YVzkAB8u7DDA/mkJVQLhqxANx77pLxe3eTJxQguRU=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=ymail.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=Z//AHxy3Y7knsimAk3bHbjf9nbIfYGVtVAvhvXjz4yNN7TschkQN7b4uAK0tGj3r4/mUv6ap0/oJ87H6sOmBmwZl3J+bkIBuS3k88LAfjoTJTwo6DKrEY1AdR9f/1EQxhJ3lK4hzE+daMS/oEZ1DBiac+efzOzURlphOTr2YGi4=;
Message-ID: <269910.44369.qm@web112207.mail.gq1.yahoo.com>
X-YMail-OSG: J179sbcVM1kkgNcM7ANYNyhMzTZRu6uZFfkdHuWdNw0RGyy3hHFBUUOdS857axg00MwIRb5HLxy_iJ3aV5mp0KrViC7J3emo.oYwvhRoCpjC1knUp.BrVTMB9ibW.KvlQWNZNbVCRCkfEEGIbc8DI2ynMaEcOCYbpXgx8Npdfojvfg28YxgI9bUBrBesVwNQ4UZ2hCpNlCyo_XsHByj8CQTVMNchtbRrN7wxe1zKeb3VHdQh66HgDUghvkKl8NKiFLpl0r_WhhlLhvkVFP1SeYSsjOApPY29ShHy2wYrFyy2ug_SUCtH6nz_aeTRMuSYKgo-
Received: from [94.194.201.108] by web112207.mail.gq1.yahoo.com via HTTP; Thu, 02 Apr 2009 09:33:21 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <702697.55499.qm@web112220.mail.gq1.yahoo.com>  <359a92830904011051p6a2d3abfwbf6b7279ae7c1c87@mail.gmail.com>  <580407.67598.qm@web112207.mail.gq1.yahoo.com> <359a92830904020634n6123817cmfeeee1a416ee32a6@mail.gmail.com> <999310.79121.qm@web112209.mail.gq1.yahoo.com> <49D4D128.8090800@gmail.com>
Date: Thu, 2 Apr 2009 09:33:21 -0700 (PDT)
From: Lebiram <lebiram@ymail.com>
Subject: Re: Search using MultiSearcher generates OOM on a 1GB total  Partitioned indeces
To: java-user@lucene.apache.org
In-Reply-To: <49D4D128.8090800@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-898731007-1238690001=:44369"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-898731007-1238690001=:44369
Content-Type: text/plain; charset=us-ascii

I think I have looked at constant score queries however, the relevance is of value to the users so we left it as is. :(

Erick's idea of stripping terms with wildcards that has less then an acceptable number of characters is a good idea and I might try it once I get the time.

Thanks, 

M




________________________________
From: Mark Miller <markrmiller@gmail.com>
To: java-user@lucene.apache.org
Sent: Thursday, April 2, 2009 3:52:24 PM
Subject: Re: Search using MultiSearcher generates OOM on a 1GB total  Partitioned indeces

You might try a constant score wildcard query (similar to a filter) - I 
think you'd have to grab it from solr's codebase until 2.9 comes out 
though. No clause limit, and reportedly *much* faster on large indexes.

-- 
- Mark

http://www.lucidimagination.com



Lebiram wrote:
> Hi Erick
>
> The query was a test data basically in anticipation of searches on all indices (4 index) with 12 million docs
> that should yield very small results. Obviously that query does not happen in real life but it did break the system.
> If some user thought of just inputting random words then the system will be brought to its knees and eventually die.
>
> Essentially, all our lucene index has about 8 fields; 1 field is being used as a filter (timestamp)
> the rest are normal fields which can accept wildcards.
>
> You have a point in Filters being useful for a few other fields we do have. I'll apply that.
> So that leaves about 5 fields that allows fuzzy search.
>
> Which goes back to the max clause problem. Lucene's default Max Clause is 1024, is there any reason behind this max?
>
> Thanks, 
>
> M
>
>
> ________________________________
> From: Erick Erickson <erickerickson@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Thursday, April 2, 2009 2:34:47 PM
> Subject: Re: Search using MultiSearcher generates OOM on a 1GB total  Partitioned indeces
>
> Ah, I get it now. Given that you bumped your max clause up, it makes
> sense. I'm pretty sure that the wildcard expansion is the root or your
> memory problems. The folks on the list helped me out a lot understanding
> what wildcards were about, see the thread titled "I just don't get wildcards
> at all" in the searchable archives from several years ago...
>
> Why do you want to generate queries of the form you showed? I'm
> wondering if this is an XY problem and if you gave us a higher level
> description of the problem you're trying to solve we'd be able to
> suggest other approaches. I have a really hard time imagining a use
> case where a user is well served by a clause that says
> "any document that has word beginning with g and h and d and s.....",
> so I'm assuming you're trying to solve something specific to your
> domain.....
>
> But if you really, truly do require this form, consider Filters. If your
> problem really requires single-letter starts, consider creating 26
> Filters at start up time and use those (see ConstantScoreQuery)
> That'll chew up about 1.5M each of memory, faaaaar less than
> you're consuming presently and will be blazingly fast. If you're
> not limited to single-characters, *still* consider filters. They'll
> consume little memory and are quite speedy to construct.
>
> Best
> Erick
>
>
> On Thu, Apr 2, 2009 at 5:04 AM, Lebiram <lebiram@ymail.com> wrote:
>
>  
>> Hi Erick,
>>
>> I did a search just as JVM started... so I'm thinking that the JVM is busy
>> with some startup stuff... and that this search required more memory than
>> what is available at that time.
>>
>> Had I done this search a while after the JVM has started, then this query
>> succeeds.
>> I then pump in several similar queries running on a different thread and it
>> takes a long time but still runs to completion until one of them generates
>> OOM.But still, queries like this is just using too much memory.
>>
>> As for clauses, the BooleanQuery was set to max clause of... 9,000,000
>> I'm guessing that might have caused the usage of too much memory?
>>
>> I'll try the explain on you've suggested.
>>
>> Thanks,
>>
>> M
>>
>>
>>
>>
>> ________________________________
>> From: Erick Erickson <erickerickson@gmail.com>
>> To: java-user@lucene.apache.org
>> Sent: Wednesday, April 1, 2009 6:51:13 PM
>> Subject: Re: Search using MultiSearcher generates OOM on a 1GB total
>>  Partitioned indeces
>>
>> Think about putting this query in Luke and doing an "explain" for details,
>> but....
>>
>> I'm surprised this is working at all without throwing TooManyClauses
>> errors.
>> Under the covers, Lucene expands your wildcards to all terms in the field
>> that match. For instance, assume your document field has the following:
>> aa
>> ab
>> ac
>> ad
>> ae
>>
>> Now, searching for a* produces a clause like:
>> (aa OR ab OR ac OR ad OR ae) in place of the a*
>>
>> So your query is generating ginormous OR clauses, one that
>> contains every term in your content field starting with 'g'. Another
>> with every term in your content field starting with 'h' etc. So I suspect
>> that your content field doesn't have very many distinct terms in it....
>>
>> As for why it's returning few entries, what does this part of your
>> query return by itself? Since it's anded with your wildcard query,
>> it might be what's limiting your results.
>>
>> ((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
>> (+viewers:cpuser9 +viewers:cpuser4))
>>
>> But I'm puzzled, because saying that you're getting OOM errors
>> doesn't square very well with getting *any* results at all, so is
>> there something else going on?
>>
>> Best
>> Erick@MoreQuestionsThanAnswers.
>>
>>
>> On Wed, Apr 1, 2009 at 1:31 PM, Lebiram <lebiram@ymail.com> wrote:
>>
>>    
>>> Hi All,
>>>
>>> I have the following query on a 1GB index with about 12 million docs :
>>> As you can see the terms consist of wildcards...
>>>
>>> query.toString()=+(+content:g* +content:h* +content:d* +content:s*
>>> +content:a* +content:w* +content:b* +content:c* +content:m* +content:e*)
>>> +((+sender:cpuser9 +viewers:cpuser4) (+sender:cpuser4 +viewers:cpuser9)
>>> (+viewers:cpuser9 +viewers:cpuser4))
>>>
>>> The Searcher is a MultiSearcher with 4 IndexSearchers pointing to 4
>>> different Lucene Index.
>>> This search returns very few records, several ten thousand hits.
>>>
>>> Java is assigned with 1GB max memory.
>>>
>>> Somehow this search eats the entire java heap space and causes OOM.
>>> Looking at jProfiler, i see org.apache.lucene package generating a lot of
>>> objects which I believe is taking all this space.
>>>
>>> Can anyone explain the reason why this particular search might take so
>>>      
>> much
>>    
>>> memory?
>>> Is there anything I am doing wrong here?
>>> More importantly, is there anything I can do to improve this?
>>>
>>> -M
>>>
>>>
>>>
>>>      
>>
>>
>>
>>    
>
>
>
>      
>  





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


      
--0-898731007-1238690001=:44369--


From java-user-return-39474-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 16:50:01 2009
Return-Path: <java-user-return-39474-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47542 invoked from network); 2 Apr 2009 16:50:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 16:50:00 -0000
Received: (qmail 13353 invoked by uid 500); 2 Apr 2009 16:49:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13279 invoked by uid 500); 2 Apr 2009 16:49:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13269 invoked by uid 99); 2 Apr 2009 16:49:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 16:49:57 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [87.248.110.146] (HELO n29.bullet.mail.ukl.yahoo.com) (87.248.110.146)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 02 Apr 2009 16:49:48 +0000
Received: from [217.146.182.178] by n29.bullet.mail.ukl.yahoo.com with NNFMP; 02 Apr 2009 16:49:26 -0000
Received: from [87.248.110.106] by t4.bullet.ukl.yahoo.com with NNFMP; 02 Apr 2009 16:49:26 -0000
Received: from [127.0.0.1] by omp211.mail.ukl.yahoo.com with NNFMP; 02 Apr 2009 16:49:26 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 318966.45129.bm@omp211.mail.ukl.yahoo.com
Received: (qmail 11605 invoked by uid 60001); 2 Apr 2009 16:49:26 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1238690966; bh=3WtxtaEx6Pb5WYbdBSBs8QEUzSHjuwH/VyH62+aWaEk=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=grISlh8XIDmC21qtluPH4TEy2DM4DMpxYogvh7aYErvq0qaiyjCLQhnzE5Nuq8++QmldHf99hYkcptJj89+MnsQsjoixjn8eVU2YQrDAwpAvPgJ7+VeF77TPoogHTzpIsOLlZ7ttV5YYgU4PdwQWzbn/p6G3Pt3FbeW1pYrpQxs=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=Iz4hPvLb/DQGcntERJIwgyuYlmMreOUyB6ofvM3iosdyptujFRy0HAqNiFAh3zGRrJ/q4X2UeaksPvBZpAnXkq5Ne8nxZ0t+F8YMvWaJDIX9eGmU6Q6Ku9KXm0yvQJWzcRIW3Ug19Jx9rt9t1c8vGzy1j1GhcE2OCVUpy0w7xcU=;
Message-ID: <999162.11563.qm@web24711.mail.ird.yahoo.com>
X-YMail-OSG: DNbcy5YVM1nEduQWBvp7V9cMhTUCN3wDANg0.79q6uo0vqMTEwo0SJY9jzft1Mh4fQkXIfZORRKtsDs2aE_e6ET0815JiFbLokPb2vKNjF34hKFfa4dgvarXByBu9jCQm4t8tJ3hmk.5taEOxW95eGt72tFUzWStEqsQvFWXkIGGWXGjunVFzY0I9QSPjHt56AXwo38kCT3lvR_zdhWrVnnNhVcEk5R1eM9Q4pvZyGH9CtepNfF_fp6.LcujV0LcBOPuftrAylJJbs9bWLJURiNb.N81mw--
Received: from [193.36.230.96] by web24711.mail.ird.yahoo.com via HTTP; Thu, 02 Apr 2009 09:49:25 PDT
X-Mailer: YahooMailRC/1277.32 YahooMailWebService/0.7.289.1
References: <s9d490b3.093@mail.btsb.com>
Date: Thu, 2 Apr 2009 09:49:25 -0700 (PDT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: Speed of fuzzy searches
To: java-user@lucene.apache.org
In-Reply-To: <s9d490b3.093@mail.btsb.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org


Try setting the minimum prefix length for fuzzy queries ( I think there is =
a setting on QueryParser or you may need to subclass)=0A=0APrefix length of=
 zero does edit distance comparisons for all unique terms e.g. from "aardva=
rk" to "zzzz"=0APrefix length of one would cut this search space down to ju=
st terms "car" to "czar"=0A=0A- you should get the picture. Massive reducti=
ons in CPU usage at each increment of prefix length but you need to balance=
 that with the inability to match "cow" with "kow".=0A=0ACheers=0AMark=0A=
=0A=0A=0A----- Original Message ----=0AFrom: Matt Schraeder <MSchraeder@bts=
b.com>=0ATo: java-user@lucene.apache.org=0ASent: Thursday, 2 April, 2009 17=
:16:57=0ASubject: Speed of fuzzy searches=0A=0AI've got a simple Lucene ind=
ex and search built for testing purposes. =0ASo far everything seems great.=
 Most searches take 0.02 seconds or less.=0ASearches with 4-5 terms take 0.=
25 seconds or less.  However, once I=0Abegan playing with fuzzy searches ev=
erything seemed to really slow down.=0AA fuzzy search seems to take vastly =
longer time, 6 seconds for a single=0Aterm such as "cow~" and 24 seconds fo=
r fuzzy searches of multiple=0Aterms.=0A=0AIs there anything I can do to sp=
eed up fuzzy searches or are they by=0Adefault just simply slow?  =0A=0AMy =
index is only 6.1M, with ~18000 documents.  Each document has 5=0Afields, a=
 combination of text and keywords. I'm afraid that when I begin=0Ato scale =
up to have more fields it will only make the problem worse.=0A=0A=0A=0A    =
  


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39475-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 17:22:39 2009
Return-Path: <java-user-return-39475-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58217 invoked from network); 2 Apr 2009 17:22:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 17:22:39 -0000
Received: (qmail 65201 invoked by uid 500); 2 Apr 2009 17:22:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65167 invoked by uid 500); 2 Apr 2009 17:22:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65157 invoked by uid 99); 2 Apr 2009 17:22:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 17:22:36 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.36] (HELO smtp-vbr16.xs4all.nl) (194.109.24.36)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 17:22:27 +0000
Received: from k8u.localnet (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr16.xs4all.nl (8.13.8/8.13.8) with ESMTP id n32HM6Nt039453
	for <java-user@lucene.apache.org>; Thu, 2 Apr 2009 19:22:07 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Using SpanNearQuery.getSpans() in a Search Result
Date: Thu, 2 Apr 2009 19:22:12 +0200
User-Agent: KMail/1.10.4 (Linux/2.6.27-11-generic; KDE/4.1.4; i686; ; )
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02B1C4D8@mail02.tveyes.com>
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02B1C4D8@mail02.tveyes.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
  boundary="Boundary-00=_FRP1JAe3DC8b9S7"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200904021922.13466.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

--Boundary-00=_FRP1JAe3DC8b9S7
Content-Type: text/plain;
  charset="iso-8859-15"
Content-Transfer-Encoding: 7bit

On Thursday 02 April 2009 15:36:44 David Seltzer wrote:
> Hi all,
> 
>  
> 
> I'm trying to figure out how to use SpanNearQuery.getSpans(IndexReader)
> when working with a result set from a query. 
> 
>  
> 
> Maybe I have a fundamental misunderstanding of what an IndexReader is -
> I'm under the impression that it's a mechanism for sequentially
> accessing the documents in an index. So I'm not really sure how that
> helps me find the spans inside a search result.
> 
>  
> 
> My problem is compounded by the fact that I'm using
> ParallelMultiSearcher so I'm not even 100% sure that I know what index
> each Hit is located in.

It's the other way around: for span queries a search result is created
(internally, by SpanScorer) from the spans resulting from the getSpans()
method above.

Does that help?

Regards,
Paul Elschot

> 
>  
> 
> All of the examples I find (in LIA and from CNLP) demonstrate on an
> in-memory index created for the sake of the example.
> 
> Can anyone give me any guidance on this?
> 
>  
> 
> Thanks!
> 
>  
> 
> -Dave 
> 
>  
> 
> 

--Boundary-00=_FRP1JAe3DC8b9S7--

From java-user-return-39476-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 17:47:16 2009
Return-Path: <java-user-return-39476-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76299 invoked from network); 2 Apr 2009 17:47:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 17:47:16 -0000
Received: (qmail 5997 invoked by uid 500); 2 Apr 2009 17:47:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5930 invoked by uid 500); 2 Apr 2009 17:47:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5920 invoked by uid 99); 2 Apr 2009 17:47:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 17:47:13 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of shashi.mit@gmail.com designates 74.125.44.30 as permitted sender)
Received: from [74.125.44.30] (HELO yx-out-2324.google.com) (74.125.44.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 17:47:05 +0000
Received: by yx-out-2324.google.com with SMTP id 8so393702yxb.5
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 10:46:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        bh=TRamJMo9BctSBMUSY/AQjY7LS3kUUdWnRMeuzNaPDc8=;
        b=wtrlNjz/Cg2Dx2kIX++mgGWHEWZ00ZtrOtu21xprkVmpEf8ghvNr/8E2MZ6wm7iL0Z
         sa6SeUANuMhyxMfbYTW5iCqSA4/EiDNt9a6iOXMmYyZohOrpF+VuFOIeTigno/ipVCDR
         IwcjsADsyJO12Wocs8+ccjIlhQREj7BeuwPa0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:date:x-google-sender-auth:message-id:subject
         :from:to:content-type;
        b=JEx7RrLjT1W6d9jupzQdi3Ud3CcyX565sAC7aaBsJ7OyJOxuVRmoIpMnkHOIBoFCR0
         h+1gK1pbHiREQXokIv/p0DN2UJ/lfdwPWSYtB048ZZzZ/P/4xPsmlmtkDBfc9foog8PB
         HKA/z8jGf7XoCcfTBOS6GEiV0FkG60UShSAFQ=
MIME-Version: 1.0
Sender: shashi.mit@gmail.com
Received: by 10.151.6.15 with SMTP id j15mr527803ybi.91.1238694404192; Thu, 02 
	Apr 2009 10:46:44 -0700 (PDT)
Date: Thu, 2 Apr 2009 13:46:44 -0400
X-Google-Sender-Auth: 410ae1347094becb
Message-ID: <4d19a3630904021046l2ee749d9hc4e4bee9907874b2@mail.gmail.com>
Subject: LuSQL download link error?
From: Shashi Kant <skant@sloan.mit.edu>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd51998f27a700466960344
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd51998f27a700466960344
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi all, I have been trying to get the latest version of LuSQL from the
NRC.ca website but get 404s on the download links. I have written to the
webmaster, but anyone have the jar handy? Could I download from somewhere
else? or could you email it to me?

thanks,
Shashi

--000e0cd51998f27a700466960344--

From java-user-return-39477-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 17:57:48 2009
Return-Path: <java-user-return-39477-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81929 invoked from network); 2 Apr 2009 17:57:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 17:57:48 -0000
Received: (qmail 23383 invoked by uid 500); 2 Apr 2009 17:57:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23342 invoked by uid 500); 2 Apr 2009 17:57:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23313 invoked by uid 99); 2 Apr 2009 17:57:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 17:57:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of glen.newton@gmail.com designates 74.125.44.29 as permitted sender)
Received: from [74.125.44.29] (HELO yx-out-2324.google.com) (74.125.44.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 17:57:34 +0000
Received: by yx-out-2324.google.com with SMTP id 8so396759yxb.5
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 10:57:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=WXvdrZWtddFBZ19b6gR+59AiXIBV21AvzlAeAWf1dnI=;
        b=GoORVEuXGfOB0G6+lvxaagN0jBDj1OctTlrE9XDaED0CsPYo29ZtKz0ijjM2E1Mmlc
         vvoVxjhGTaznWv2kQgW7NgjEpPqg7MD5WWd1CuQ7Xts+g2TG8qUsjuTCddH+PEFKVsia
         va0Ppd8jD7LuxzRPe5ZGmKMllc7O9hT6LZMd0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=cPKafVBSt3c7WyK5nCKHwNp9/S9hksR21BDTW92EFkBUVfknFeMW329t9imVKx7+HA
         LzrLiMy0nfbHx/NU094AQy61ympbiaGW60DOpGGt+ujKLlwhMZy+0HSseR3J6qGiLN+t
         +WGNLBvdhTfB2euiUejCA8Q4lHtPaSpibuLO0=
MIME-Version: 1.0
Received: by 10.100.13.6 with SMTP id 6mr646752anm.6.1238695033893; Thu, 02 
	Apr 2009 10:57:13 -0700 (PDT)
In-Reply-To: <4d19a3630904021046l2ee749d9hc4e4bee9907874b2@mail.gmail.com>
References: <4d19a3630904021046l2ee749d9hc4e4bee9907874b2@mail.gmail.com>
Date: Thu, 2 Apr 2009 13:57:13 -0400
Message-ID: <5e76f3840904021057p8cde9c5n8e9c521a8b7df952@mail.gmail.com>
Subject: Re: LuSQL download link error?
From: Glen Newton <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Dear Shashi,

It should work now.
A temporary failure: our apologies.

thanks,

Glen

2009/4/2 Shashi Kant <skant@sloan.mit.edu>:
> Hi all, I have been trying to get the latest version of LuSQL from the
> NRC.ca website but get 404s on the download links. I have written to the
> webmaster, but anyone have the jar handy? Could I download from somewhere
> else? or could you email it to me?
>
> thanks,
> Shashi
>



-- 

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39478-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 18:26:57 2009
Return-Path: <java-user-return-39478-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6895 invoked from network); 2 Apr 2009 18:26:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 18:26:56 -0000
Received: (qmail 80684 invoked by uid 500); 2 Apr 2009 18:26:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80651 invoked by uid 500); 2 Apr 2009 18:26:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80641 invoked by uid 99); 2 Apr 2009 18:26:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 18:26:54 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of john.wang@gmail.com designates 209.85.198.230 as permitted sender)
Received: from [209.85.198.230] (HELO rv-out-0506.google.com) (209.85.198.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 18:26:46 +0000
Received: by rv-out-0506.google.com with SMTP id g9so693744rvb.5
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 11:26:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ZSsuqHR82YopPH4oWZbjnq7iiU6y7MDW1t/YTjcbjhU=;
        b=gWPshCby33M4S1X7py9oezGk3MmFBZElBzSo+Ip5ZbjkYhtlFyGxXDFwILf6eUjwu1
         5pRdk9afUGWxhmt3/Al5C/KwUGOvc8ehcKljnI4mv5erpWkaKaPiZQfMViRat2lkVVXS
         PqXtIVlqU806GAmt1zhib3VNvQuA9ltFzg8P0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=EQOhf+XbgQn0VcVjpa5vpKItecYOPLvxUOumSkpuf+qZwFtO2rMNeb4rPxhHhxuJzj
         Vz0gE23RpJT5r7rW/0UYvVZO/b0weAxy7+5UVoRVOpJood7KlYXmc593DWbTfWD/kCRR
         IhlM5VoLnJiNGC8F/5CKg4cQtrQAWSuayE3eg=
MIME-Version: 1.0
Received: by 10.140.187.14 with SMTP id k14mr103193rvf.246.1238696784860; Thu, 
	02 Apr 2009 11:26:24 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904020220l44fe8f93h17c7cc39c042a54e@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <9ac0c6aa0904010102t67590b1asde251d2552bf919f@mail.gmail.com>
	 <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
	 <9ac0c6aa0904011017m3bbe46a3xa8279c0c58a7a443@mail.gmail.com>
	 <8837fb770904011104lb86eaccr7809239f7467d709@mail.gmail.com>
	 <9ac0c6aa0904011127n35373d62h6ede92d30e4369d2@mail.gmail.com>
	 <8837fb770904011422p17e93c3cu6891c4b5693516d4@mail.gmail.com>
	 <9ac0c6aa0904011429j37fb2064y72afeef26620b12@mail.gmail.com>
	 <8837fb770904011537k4164c5c8l7fbd954cc8fa09da@mail.gmail.com>
	 <9ac0c6aa0904020220l44fe8f93h17c7cc39c042a54e@mail.gmail.com>
Date: Thu, 2 Apr 2009 11:26:24 -0700
Message-ID: <8837fb770904021126q4cd33515qd0e2aa2a3d79625c@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd2950cd899190466969141
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd2950cd899190466969141
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Michael:
    Thanks for looking into this.

    Approach 2 has a dependency on how fast the delete set performs a check
on a given id, approach one doesn't. After replacing my delete set with a
simple bitset, approach 2 gets a 25-30% improvement.

   I understand if the delete set is small, approach 1 would be faster,
while approach two has a more constant/deterministic performance. I would
also save from indexing the UID term into the index if going with approach
two.

   I don't however see how column-stride fields would help here, isn't it a
generalization of what I am doing?

  BTW, can you shine some light on why would IndexWriter move docids around
when it is opened and no docs has been added to it?

Thanks

-John

On Thu, Apr 2, 2009 at 2:20 AM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> On Wed, Apr 1, 2009 at 6:37 PM, John Wang <john.wang@gmail.com> wrote:
> > a code snippet is worth 1000 words :)
>
> Here here!
>
> OK, now I understand the difference.
>
> With approach 1, for each of N UIDs you use a TermDocs to find the
> postings for that UID, and retrieve the one docID corresponding to
> that UID.  You retrieve UID -> docID.
>
> With approach 2, you iterate through all docs in the index, using a
> single full walk through the single TermPositions instance for your
> special UID_TERM, and retrieve the UID stored in the 4-byte payload.
> You retrieve docID -> UID.
>
> Approach 1 is expected to be more costly, per UID - Lucene must
> consult the terms dict (binary search on the terms index, followed by
> scan on disk within the 128 term block) to find the posting, then seek
> to the posting and read that.
>
> Approach 2 is an efficient "bulk" walk, but it loads all docID -> UIDs
> into RAM (ie, you cannot be selective about which UIDs you load).
>
> So if the number of UIDs you need to process is small, approach 1
> should win; but after that number crosses X (apparently X < 10000 for
> you), approach 2's "bulk walk" will win.
>
> Approach 1 will get faster with the "pulsing" approach for inlining
> low-frequency postings directly into the terms dict (discussed on
> java-dev and implemented as a codec in the experimental flexible
> indexing patch on LUCENE-1458), because we save the second seek.
>
> Approach 2 will get much faster with column-stride fields
> (LUCENE-1231).
>
> Though we may want to take this even further and allow inversion for
> special fields ("primary key int" field, ie your UID) to be stored as
> a column-stride field.  Probably this could simply be another codec in
> LUCENE-1458.  Then, delete-by-Term would be exceptionally fast for
> such fields.
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd2950cd899190466969141--

From java-user-return-39479-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 19:31:04 2009
Return-Path: <java-user-return-39479-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24237 invoked from network); 2 Apr 2009 19:31:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 19:31:04 -0000
Received: (qmail 55905 invoked by uid 500); 2 Apr 2009 19:31:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55816 invoked by uid 500); 2 Apr 2009 19:31:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55806 invoked by uid 99); 2 Apr 2009 19:31:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 19:31:01 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of MSchraeder@btsb.com designates 216.8.91.5 as permitted sender)
Received: from [216.8.91.5] (HELO mail.btsb.com) (216.8.91.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 19:30:55 +0000
X-IronPort-AV: E=Sophos;i="4.39,315,1235973600"; 
   d="scan'208,217";a="471505"
Received: from unknown (HELO mail.btsb.com) ([10.1.1.2])
  by mail.btsb.com with ESMTP; 02 Apr 2009 14:32:21 -0500
Received: from GWDOMAIN-MTA by mail.btsb.com
	with Novell_GroupWise; Thu, 02 Apr 2009 14:32:43 -0600
Message-Id: <s9d4cc8b.084@mail.btsb.com>
X-Mailer: Novell GroupWise Internet Agent 6.5.5 
Date: Thu, 02 Apr 2009 14:32:01 -0600
From: "Matt Schraeder" <MSchraeder@btsb.com>
To: <java-user@lucene.apache.org>
Subject: Re: Speed of fuzzy searches
Mime-Version: 1.0
Content-Type: multipart/alternative; boundary="=__Part052D94D1.0__="
X-Virus-Checked: Checked by ClamAV on apache.org

--=__Part052D94D1.0__=
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

 
>>> erickerickson@gmail.com 4/2/2009 10:24:42 AM >>>
>This seems really odd, especially with an index that size. The
>first question is usually "Do you open an IndexReader for
>each query?" 
 
I'm using the Zend_Search_Lucene implementation so I'm really not sure
how it handles the IndexReader.  At the top of the script I open the
index and do searches on it.  Unless Zend is doing something special in
the background I'm assuming I'm using the IndexReader on a per-page
basis.  I haven't been able to find any information on this yet, but
from all the examples I've been reading none of them say to keep the
index in a session to improve speed.  I'll have to get on the zend
mailing lists to find out more about best practices.
 
>>> markrmiller@gmail.com 4/2/2009 10:40:59 AM >>>
>You might try setting a longer prefix. Fuzzy queries don't scale by
the 
>way. By default they enumerate every unique term. How many unique
terms 
>do you have in the index?
 
I'll look at a longer prefix setting, as the reply above mentioned the
improving search speed article.  Currently my index has 104076 terms in
it.


--=__Part052D94D1.0__=--

From java-user-return-39480-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 19:36:05 2009
Return-Path: <java-user-return-39480-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26389 invoked from network); 2 Apr 2009 19:36:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 19:36:05 -0000
Received: (qmail 69550 invoked by uid 500); 2 Apr 2009 19:36:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69511 invoked by uid 500); 2 Apr 2009 19:36:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69501 invoked by uid 99); 2 Apr 2009 19:36:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 19:36:02 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.172] (HELO wf-out-1314.google.com) (209.85.200.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 19:35:54 +0000
Received: by wf-out-1314.google.com with SMTP id 29so791112wff.20
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 12:35:33 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.134.17 with SMTP id h17mr75702wfd.253.1238700932886; Thu, 
	02 Apr 2009 12:35:32 -0700 (PDT)
In-Reply-To: <8837fb770904021126q4cd33515qd0e2aa2a3d79625c@mail.gmail.com>
References: <8837fb770903311241p45483892jf58b4779b1e6f14c@mail.gmail.com>
	 <8837fb770904010913p4de0d885n22ee8da565bf2d40@mail.gmail.com>
	 <9ac0c6aa0904011017m3bbe46a3xa8279c0c58a7a443@mail.gmail.com>
	 <8837fb770904011104lb86eaccr7809239f7467d709@mail.gmail.com>
	 <9ac0c6aa0904011127n35373d62h6ede92d30e4369d2@mail.gmail.com>
	 <8837fb770904011422p17e93c3cu6891c4b5693516d4@mail.gmail.com>
	 <9ac0c6aa0904011429j37fb2064y72afeef26620b12@mail.gmail.com>
	 <8837fb770904011537k4164c5c8l7fbd954cc8fa09da@mail.gmail.com>
	 <9ac0c6aa0904020220l44fe8f93h17c7cc39c042a54e@mail.gmail.com>
	 <8837fb770904021126q4cd33515qd0e2aa2a3d79625c@mail.gmail.com>
Date: Thu, 2 Apr 2009 15:35:32 -0400
Message-ID: <9ac0c6aa0904021235l4c548a36p1f5f1a0e4e6af68c@mail.gmail.com>
Subject: Re: IndexWriter.deleteDocuments(Query query)
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Apr 2, 2009 at 2:26 PM, John Wang <john.wang@gmail.com> wrote:
> Hi Michael:
> =A0 =A0Thanks for looking into this.
>
> =A0 =A0Approach 2 has a dependency on how fast the delete set performs a =
check
> on a given id, approach one doesn't. After replacing my delete set with a
> simple bitset, approach 2 gets a 25-30% improvement.

Excellent.

> =A0 I understand if the delete set is small, approach 1 would be faster,
> while approach two has a more constant/deterministic performance. I would
> also save from indexing the UID term into the index if going with approac=
h
> two.

True.

> =A0 I don't however see how column-stride fields would help here, isn't i=
t a
> generalization of what I am doing?

Sorry, yes, and I shouldn't have said "much faster".  What I'm
picturing with column stride fields is that you'd be able to load an
int[] per segment, mapping docID -> UID.  That load may be faster than
the decode process you do now, though probably not that much faster.
If we do the inverted column stride field, then you'd have an array
mapping UID -> docID and then should be faster (load time'd be the
same, but you could then visit only the deleted UIDs instead of
sweeping all docs).

> =A0BTW, can you shine some light on why would IndexWriter move docids aro=
und
> when it is opened and no docs has been added to it?

Actually, sorry, I'm wrong about this: in IndexWriter.init, we don't
actually kick off merges.

Though I don't think it's safe to rely on that (Lucene could someday,
eg if index was closed with close(false) then it may need merging on
reopening).

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39481-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 02 20:15:04 2009
Return-Path: <java-user-return-39481-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40205 invoked from network); 2 Apr 2009 20:15:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Apr 2009 20:15:03 -0000
Received: (qmail 42098 invoked by uid 500); 2 Apr 2009 20:15:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41949 invoked by uid 500); 2 Apr 2009 20:15:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41911 invoked by uid 99); 2 Apr 2009 20:14:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 20:14:45 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.170] (HELO wf-out-1314.google.com) (209.85.200.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 02 Apr 2009 20:14:38 +0000
Received: by wf-out-1314.google.com with SMTP id 29so805746wff.20
        for <java-user@lucene.apache.org>; Thu, 02 Apr 2009 13:14:16 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.31.11 with SMTP id i11mr82726wfj.289.1238703256817; Thu, 
	02 Apr 2009 13:14:16 -0700 (PDT)
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02B1C509@mail02.tveyes.com>
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02B1C509@mail02.tveyes.com>
Date: Thu, 2 Apr 2009 16:14:16 -0400
Message-ID: <9ac0c6aa0904021314g2bf3d3d8q182e94f47d394fb2@mail.gmail.com>
Subject: Re: Retrieving TokenStream from Tokenized Non-Stored Field
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Actually you have to mark the field as Field.Store.YES in order to see
that field when you retrieve the doc at search time.

You'll then be able to retrieve the string value.

Mike

On Thu, Apr 2, 2009 at 10:45 AM, David Seltzer <dseltzer@tveyes.com> wrote:
> Hi All,
> I have a document with a field called "TextTranscript". Its created
> using the following command:
>
> myDoc.add(new Field("TextTranscript", sTranscriptBody, Field.Store.NO,
> Field.Index.TOKENIZED));
>
> I'm then trying to retrieve the TokenStream by pulling the field.
>
> Field fTextTranscript =3D lucDoc.getField("TextTranscript");
>
> But fTextTranscript seems always to be NULL. =A0My understanding is that =
I
> should be able to retrieve the TokenString, even if it's not "Stored".
> Am I incorrect? Is there a better way of doing this?
>
> Thanks!
>
> -Dave
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39482-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 11:14:25 2009
Return-Path: <java-user-return-39482-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8698 invoked from network); 3 Apr 2009 11:14:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 11:14:25 -0000
Received: (qmail 45117 invoked by uid 500); 3 Apr 2009 11:14:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45040 invoked by uid 500); 3 Apr 2009 11:14:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45030 invoked by uid 99); 3 Apr 2009 11:14:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 11:14:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.125.145.37] (HELO mercury.propylon.com) (194.125.145.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 11:14:15 +0000
Received: from [213.94.211.166] (helo=[192.168.213.119])
	by mercury.propylon.com with esmtp (Exim 4.50)
	id 1LphKb-0007IO-3N
	for java-user@lucene.apache.org; Fri, 03 Apr 2009 12:13:05 +0100
Message-ID: <49D5EF6C.6080805@propylon.com>
Date: Fri, 03 Apr 2009 12:13:48 +0100
From: John Byrne <john.byrne@propylon.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-SA-Exim-Connect-IP: 213.94.211.166
X-SA-Exim-Mail-From: john.byrne@propylon.com
Subject: HeapedScorerDoc using all my memory
X-Spam-Checker-Version: SpamAssassin 3.0.3 (2005-04-27) on 
	mercury.propylon.com
X-Spam-Level: 
X-SA-Exim-Version: 4.2 (built Thu, 03 Mar 2005 10:44:12 +0100)
X-SA-Exim-Scanned: Yes (on mercury.propylon.com)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-5.7 required=3.0 tests=ALL_TRUSTED,AWL,BAYES_00 
	autolearn=ham version=3.0.3

Hi, I'm having a problem where the JVM runs out of memory while indexing 
a large number of files. An analysis of the heapdump shows that most of 
the memory was taken up with 
"org/apache/lucene/util/ScorerDocQueue$HeapedScorerDoc".

I can't find any leaks in my code so far, and I was wondering, are there 
any known problems with this class that could leak memory?

I'm using version 2.3.1.

Thanks!

-John

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39483-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 12:14:49 2009
Return-Path: <java-user-return-39483-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37710 invoked from network); 3 Apr 2009 12:14:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 12:14:48 -0000
Received: (qmail 24008 invoked by uid 500); 3 Apr 2009 12:14:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23941 invoked by uid 500); 3 Apr 2009 12:14:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23931 invoked by uid 99); 3 Apr 2009 12:14:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 12:14:46 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 12:14:39 +0000
Received: by qw-out-2122.google.com with SMTP id 8so774370qwh.53
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 05:14:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=dkjfjQBMEPoBAKUNd6Pnr4UZqUU1T5opxk+dvzzrziM=;
        b=uq6kn9bKnwhOzWD5yoCND4dG4Qt9Nedqo/EJRADxvf7EL1Jdeo3OB3N9PZLXAwTSua
         gYw3YynhIsnNWxMB1p+BXC6PhUN2rM/n5luOY51FN/gsb2VcslkC2y4uzcECt2dXo7WE
         Vihw0lGiWlbR1wASXlBcemvQlWjDHjjexzMY4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ZU0i0CPI/GzU/eteAU21EohFBAlYz1MDJD816OqVloyhYndg/9iG2vZE28OyEjTKue
         57dHKbVVDtMZzSAUHjXVSSpcsRBSzE+gmumU9ascfg80T4B16yiGF39W2WtCSYQv9euR
         A+RTf3UH7Z4+msfUXXm4TGUZ4VPb0G2UKuhjI=
MIME-Version: 1.0
Received: by 10.220.74.3 with SMTP id s3mr1490864vcj.54.1238760858699; Fri, 03 
	Apr 2009 05:14:18 -0700 (PDT)
In-Reply-To: <49D5EF6C.6080805@propylon.com>
References: <49D5EF6C.6080805@propylon.com>
Date: Fri, 3 Apr 2009 08:14:18 -0400
Message-ID: <359a92830904030514j3a46cdbbvb251bc3ad1d33075@mail.gmail.com>
Subject: Re: HeapedScorerDoc using all my memory
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016362850fef1cc9b0466a57c3b
X-Virus-Checked: Checked by ClamAV on apache.org

--0016362850fef1cc9b0466a57c3b
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

How much memory are you allocating for the JVM? And what are your
various indexwriter settings (e.g. MaxBufferedDocs, MaxMergeDocs, etc).

Have you tried different settings in setRamBufferSizeMB?

Best
Erick

On Fri, Apr 3, 2009 at 7:13 AM, John Byrne <john.byrne@propylon.com> wrote:

> Hi, I'm having a problem where the JVM runs out of memory while indexing a
> large number of files. An analysis of the heapdump shows that most of the
> memory was taken up with
> "org/apache/lucene/util/ScorerDocQueue$HeapedScorerDoc".
>
> I can't find any leaks in my code so far, and I was wondering, are there
> any known problems with this class that could leak memory?
>
> I'm using version 2.3.1.
>
> Thanks!
>
> -John
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016362850fef1cc9b0466a57c3b--

From java-user-return-39484-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 12:41:57 2009
Return-Path: <java-user-return-39484-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55735 invoked from network); 3 Apr 2009 12:41:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 12:41:57 -0000
Received: (qmail 56661 invoked by uid 500); 3 Apr 2009 12:41:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56637 invoked by uid 500); 3 Apr 2009 12:41:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56627 invoked by uid 99); 3 Apr 2009 12:41:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 12:41:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.125.145.37] (HELO mercury.propylon.com) (194.125.145.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 12:41:44 +0000
Received: from [213.94.211.166] (helo=[192.168.213.119])
	by mercury.propylon.com with esmtp (Exim 4.50)
	id 1LpihE-0001FB-8S
	for java-user@lucene.apache.org; Fri, 03 Apr 2009 13:40:36 +0100
Message-ID: <49D603EA.9000609@propylon.com>
Date: Fri, 03 Apr 2009 13:41:14 +0100
From: John Byrne <john.byrne@propylon.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
References: <49D5EF6C.6080805@propylon.com> <359a92830904030514j3a46cdbbvb251bc3ad1d33075@mail.gmail.com>
In-Reply-To: <359a92830904030514j3a46cdbbvb251bc3ad1d33075@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-SA-Exim-Connect-IP: 213.94.211.166
X-SA-Exim-Mail-From: john.byrne@propylon.com
Subject: Re: HeapedScorerDoc using all my memory
X-Spam-Checker-Version: SpamAssassin 3.0.3 (2005-04-27) on 
	mercury.propylon.com
X-Spam-Level: 
X-SA-Exim-Version: 4.2 (built Thu, 03 Mar 2005 10:44:12 +0100)
X-SA-Exim-Scanned: Yes (on mercury.propylon.com)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-5.7 required=3.0 tests=ALL_TRUSTED,AWL,BAYES_00 
	autolearn=ham version=3.0.3

The maximum JVM memory is 2GB. Apparently 1.2GB is being used up by this 
class.

All IndexWriter settings are left as default.

I haven't tried any changes yet, because the problem so far has on ly 
happened in a production environment that I can't mess with. I am 
planning to try reproducing it locally soon, but it takes quite a while 
before it happens.

-John

Erick Erickson wrote:
> How much memory are you allocating for the JVM? And what are your
> various indexwriter settings (e.g. MaxBufferedDocs, MaxMergeDocs, etc).
>
> Have you tried different settings in setRamBufferSizeMB?
>
> Best
> Erick
>
> On Fri, Apr 3, 2009 at 7:13 AM, John Byrne <john.byrne@propylon.com> wrote:
>
>   
>> Hi, I'm having a problem where the JVM runs out of memory while indexing a
>> large number of files. An analysis of the heapdump shows that most of the
>> memory was taken up with
>> "org/apache/lucene/util/ScorerDocQueue$HeapedScorerDoc".
>>
>> I can't find any leaks in my code so far, and I was wondering, are there
>> any known problems with this class that could leak memory?
>>
>> I'm using version 2.3.1.
>>
>> Thanks!
>>
>> -John
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
>   
> ------------------------------------------------------------------------
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com 
> Version: 8.0.238 / Virus Database: 270.11.39/2038 - Release Date: 04/02/09 19:07:00
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39485-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 13:06:29 2009
Return-Path: <java-user-return-39485-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68600 invoked from network); 3 Apr 2009 13:06:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 13:06:29 -0000
Received: (qmail 87499 invoked by uid 500); 3 Apr 2009 13:06:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87406 invoked by uid 500); 3 Apr 2009 13:06:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87396 invoked by uid 99); 3 Apr 2009 13:06:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 13:06:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 13:06:18 +0000
Subject: RE: Retrieving TokenStream from Tokenized Non-Stored Field
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Date: Fri, 3 Apr 2009 09:05:54 -0400
Content-class: urn:content-classes:message
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02B1C5E7@mail02.tveyes.com>
X-MimeOLE: Produced By Microsoft Exchange V6.5
In-Reply-To: <9ac0c6aa0904021314g2bf3d3d8q182e94f47d394fb2@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Retrieving TokenStream from Tokenized Non-Stored Field
thread-index: Acmzz7ShAaUzlMCvTKay1N9TlHi6kQAjNq7g
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02B1C509@mail02.tveyes.com> <9ac0c6aa0904021314g2bf3d3d8q182e94f47d394fb2@mail.gmail.com>
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Ah, ok. Well that explains the behavior then. Thanks!

-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: Thursday, April 02, 2009 4:14 PM
To: java-user@lucene.apache.org
Subject: Re: Retrieving TokenStream from Tokenized Non-Stored Field

Actually you have to mark the field as Field.Store.YES in order to see
that field when you retrieve the doc at search time.

You'll then be able to retrieve the string value.

Mike

On Thu, Apr 2, 2009 at 10:45 AM, David Seltzer <dseltzer@tveyes.com> =
wrote:
> Hi All,
> I have a document with a field called "TextTranscript". Its created
> using the following command:
>
> myDoc.add(new Field("TextTranscript", sTranscriptBody, Field.Store.NO,
> Field.Index.TOKENIZED));
>
> I'm then trying to retrieve the TokenStream by pulling the field.
>
> Field fTextTranscript =3D lucDoc.getField("TextTranscript");
>
> But fTextTranscript seems always to be NULL. =A0My understanding is =
that I
> should be able to retrieve the TokenString, even if it's not "Stored".
> Am I incorrect? Is there a better way of doing this?
>
> Thanks!
>
> -Dave
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39486-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 13:07:33 2009
Return-Path: <java-user-return-39486-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69046 invoked from network); 3 Apr 2009 13:07:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 13:07:32 -0000
Received: (qmail 91586 invoked by uid 500); 3 Apr 2009 13:07:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91531 invoked by uid 500); 3 Apr 2009 13:07:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91521 invoked by uid 99); 3 Apr 2009 13:07:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 13:07:30 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.221.130 as permitted sender)
Received: from [209.85.221.130] (HELO mail-qy0-f130.google.com) (209.85.221.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 13:07:19 +0000
Received: by qyk36 with SMTP id 36so1838673qyk.29
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 06:06:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=AZ6XXNOiOZigjwJi/sks/7GixQ27NyVhEgEmPv3B5eU=;
        b=twatkkNnsJ7KiboauCEqqx1zik+PMnMIDJrzMwC9izZeqnt4nGpO9QdNJRZz0Vtfsy
         gzis9Bxun1QUU1WM3H/mhugTmzKFVGkND2JI6jC9MlG/z7tVkHdsGIdjm1adnePwQaTG
         0O4ffGG7B3/hwRz8lItkhdmlvaGZkHd0lR2LQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=fJEspE2teLwMN9hEMrE9nHrg4I7at8w4DyAd+kAaqUjSQCvDe/FKBvRtaAGyqHTJaH
         lHXpCHf9zKPY0BKW/pa3YU3Q4XxCIlESU4wxUMjVPb4+qkeUnBTpN6vEUqcczV1Ztufo
         awDoq/TJ4TUdHhfXiFDlJMuEZbLkpnEvq9/Lw=
MIME-Version: 1.0
Received: by 10.220.73.6 with SMTP id o6mr1587295vcj.49.1238764015064; Fri, 03 
	Apr 2009 06:06:55 -0700 (PDT)
In-Reply-To: <49D603EA.9000609@propylon.com>
References: <49D5EF6C.6080805@propylon.com>
	 <359a92830904030514j3a46cdbbvb251bc3ad1d33075@mail.gmail.com>
	 <49D603EA.9000609@propylon.com>
Date: Fri, 3 Apr 2009 09:06:55 -0400
Message-ID: <359a92830904030606j736e3f6bx4a2b4e1eed30bdce@mail.gmail.com>
Subject: Re: HeapedScorerDoc using all my memory
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364edc541419be0466a639d9
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364edc541419be0466a639d9
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hmmmm, that's odd. how many is "a large number of documents"? And
what is your index size when things to wonky? (approximately)

I can say that other people create very large indexes without this
happening,
but the only thing that says is that this isn't a *known* problem.

Is there any chance you're re-opening the indexwriter without
closing the old one (not that you should, you should reuse the writer,
but I've put a new in the wrong place by mistake a time or two)....

But I confess that I have no idea what happens under the covers when
indexing,
so I'll have to leave any real insights to the folks who know.

Erick

On Fri, Apr 3, 2009 at 8:41 AM, John Byrne <john.byrne@propylon.com> wrote:

> The maximum JVM memory is 2GB. Apparently 1.2GB is being used up by this
> class.
>
> All IndexWriter settings are left as default.
>
> I haven't tried any changes yet, because the problem so far has on ly
> happened in a production environment that I can't mess with. I am planning
> to try reproducing it locally soon, but it takes quite a while before it
> happens.
>
> -John
>
> Erick Erickson wrote:
>
>> How much memory are you allocating for the JVM? And what are your
>> various indexwriter settings (e.g. MaxBufferedDocs, MaxMergeDocs, etc).
>>
>> Have you tried different settings in setRamBufferSizeMB?
>>
>> Best
>> Erick
>>
>> On Fri, Apr 3, 2009 at 7:13 AM, John Byrne <john.byrne@propylon.com>
>> wrote:
>>
>>
>>
>>> Hi, I'm having a problem where the JVM runs out of memory while indexing
>>> a
>>> large number of files. An analysis of the heapdump shows that most of the
>>> memory was taken up with
>>> "org/apache/lucene/util/ScorerDocQueue$HeapedScorerDoc".
>>>
>>> I can't find any leaks in my code so far, and I was wondering, are there
>>> any known problems with this class that could leak memory?
>>>
>>> I'm using version 2.3.1.
>>>
>>> Thanks!
>>>
>>> -John
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>>
>>
>>  ------------------------------------------------------------------------
>>
>>
>> No virus found in this incoming message.
>> Checked by AVG - www.avg.com Version: 8.0.238 / Virus Database:
>> 270.11.39/2038 - Release Date: 04/02/09 19:07:00
>>
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016364edc541419be0466a639d9--

From java-user-return-39487-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 13:22:10 2009
Return-Path: <java-user-return-39487-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74693 invoked from network); 3 Apr 2009 13:22:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 13:22:10 -0000
Received: (qmail 14396 invoked by uid 500); 3 Apr 2009 13:22:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14314 invoked by uid 500); 3 Apr 2009 13:22:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14304 invoked by uid 99); 3 Apr 2009 13:22:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 13:22:07 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.125.145.37] (HELO mercury.propylon.com) (194.125.145.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 13:21:56 +0000
Received: from [213.94.211.166] (helo=[192.168.213.119])
	by mercury.propylon.com with esmtp (Exim 4.50)
	id 1LpjKB-0002Sn-QW
	for java-user@lucene.apache.org; Fri, 03 Apr 2009 14:20:48 +0100
Message-ID: <49D60D5B.70601@propylon.com>
Date: Fri, 03 Apr 2009 14:21:31 +0100
From: John Byrne <john.byrne@propylon.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
References: <49D5EF6C.6080805@propylon.com>	 <359a92830904030514j3a46cdbbvb251bc3ad1d33075@mail.gmail.com>	 <49D603EA.9000609@propylon.com> <359a92830904030606j736e3f6bx4a2b4e1eed30bdce@mail.gmail.com>
In-Reply-To: <359a92830904030606j736e3f6bx4a2b4e1eed30bdce@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-SA-Exim-Connect-IP: 213.94.211.166
X-SA-Exim-Mail-From: john.byrne@propylon.com
Subject: Re: HeapedScorerDoc using all my memory
X-Spam-Checker-Version: SpamAssassin 3.0.3 (2005-04-27) on 
	mercury.propylon.com
X-Spam-Level: 
X-SA-Exim-Version: 4.2 (built Thu, 03 Mar 2005 10:44:12 +0100)
X-SA-Exim-Scanned: Yes (on mercury.propylon.com)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-5.7 required=3.0 tests=ALL_TRUSTED,AWL,BAYES_00 
	autolearn=ham version=3.0.3

Unfortunately I'm not sure of the exact number. It happened on a machine 
I have no access to, and I was just e-mailed a few details of the 
problem! We have a JMS queue, where each message is a file to be 
indexed. There was somewhere between 2000 and 10,000 messages processed 
when it happened.

Because we don't make a distinction between batch and incremental 
indexing,  I am closing and re-opening the writer for each document. 
What you've suggested there could well be the problem, that's certainly 
where I'll look next.

Thanks for the ideas anyway - I know I really need to come up with some 
more info on the problem, so I think the next thing I'll do it try to 
reproduce it locally.

-John

Erick Erickson wrote:
> Hmmmm, that's odd. how many is "a large number of documents"? And
> what is your index size when things to wonky? (approximately)
>
> I can say that other people create very large indexes without this
> happening,
> but the only thing that says is that this isn't a *known* problem.
>
> Is there any chance you're re-opening the indexwriter without
> closing the old one (not that you should, you should reuse the writer,
> but I've put a new in the wrong place by mistake a time or two)....
>
> But I confess that I have no idea what happens under the covers when
> indexing,
> so I'll have to leave any real insights to the folks who know.
>
> Erick
>
> On Fri, Apr 3, 2009 at 8:41 AM, John Byrne <john.byrne@propylon.com> wrote:
>
>   
>> The maximum JVM memory is 2GB. Apparently 1.2GB is being used up by this
>> class.
>>
>> All IndexWriter settings are left as default.
>>
>> I haven't tried any changes yet, because the problem so far has on ly
>> happened in a production environment that I can't mess with. I am planning
>> to try reproducing it locally soon, but it takes quite a while before it
>> happens.
>>
>> -John
>>
>> Erick Erickson wrote:
>>
>>     
>>> How much memory are you allocating for the JVM? And what are your
>>> various indexwriter settings (e.g. MaxBufferedDocs, MaxMergeDocs, etc).
>>>
>>> Have you tried different settings in setRamBufferSizeMB?
>>>
>>> Best
>>> Erick
>>>
>>> On Fri, Apr 3, 2009 at 7:13 AM, John Byrne <john.byrne@propylon.com>
>>> wrote:
>>>
>>>
>>>
>>>       
>>>> Hi, I'm having a problem where the JVM runs out of memory while indexing
>>>> a
>>>> large number of files. An analysis of the heapdump shows that most of the
>>>> memory was taken up with
>>>> "org/apache/lucene/util/ScorerDocQueue$HeapedScorerDoc".
>>>>
>>>> I can't find any leaks in my code so far, and I was wondering, are there
>>>> any known problems with this class that could leak memory?
>>>>
>>>> I'm using version 2.3.1.
>>>>
>>>> Thanks!
>>>>
>>>> -John
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>
>>>>
>>>>         
>>>  ------------------------------------------------------------------------
>>>
>>>
>>> No virus found in this incoming message.
>>> Checked by AVG - www.avg.com Version: 8.0.238 / Virus Database:
>>> 270.11.39/2038 - Release Date: 04/02/09 19:07:00
>>>
>>>
>>>
>>>       
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
>   
> ------------------------------------------------------------------------
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com 
> Version: 8.0.238 / Virus Database: 270.11.40/2039 - Release Date: 04/03/09 06:19:00
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39488-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 13:37:48 2009
Return-Path: <java-user-return-39488-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88635 invoked from network); 3 Apr 2009 13:37:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 13:37:48 -0000
Received: (qmail 49080 invoked by uid 500); 3 Apr 2009 13:37:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49015 invoked by uid 500); 3 Apr 2009 13:37:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49005 invoked by uid 99); 3 Apr 2009 13:37:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 13:37:45 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.221.130 as permitted sender)
Received: from [209.85.221.130] (HELO mail-qy0-f130.google.com) (209.85.221.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 13:37:33 +0000
Received: by qyk36 with SMTP id 36so1861528qyk.29
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 06:37:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=RySNeXr29K8jlPs8Z8Js3SWkgXQQysgMX8XWR8aHDxk=;
        b=DJ9IJtNaGy2nAhpLQBOzEbawtSRcps1RzZjzv4ZnyJGvsQtOcAMXo3vqFW069Xqeie
         yFUu+LndWVFrVD0D33g2uVHtPlXxiQrNToqQpDZxnZyoWk3KKJ2UnEWC17iy5WlI7wEU
         CrwbV62zl4ZpW3w4v6olwRxDKEeTMO1Lehq9Y=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=vJ7SWpNw/hBU6A4VcUUhBjcMgfJeK2Lb9M0Is/Jg9Eahr/v2mIDgxuQJ+6CX1Tgs0O
         EQuqTT76NbNq9M5g3JGytmR0JuGvfZ0vGYPWijP3/ezZ2274FR2RJuKcFykWNZtubotQ
         9ExPqQp2oqZuZOi/CcqT/HP4RIalUIFsfpa4c=
MIME-Version: 1.0
Received: by 10.220.76.68 with SMTP id b4mr1673999vck.14.1238765832079; Fri, 
	03 Apr 2009 06:37:12 -0700 (PDT)
In-Reply-To: <49D60D5B.70601@propylon.com>
References: <49D5EF6C.6080805@propylon.com>
	 <359a92830904030514j3a46cdbbvb251bc3ad1d33075@mail.gmail.com>
	 <49D603EA.9000609@propylon.com>
	 <359a92830904030606j736e3f6bx4a2b4e1eed30bdce@mail.gmail.com>
	 <49D60D5B.70601@propylon.com>
Date: Fri, 3 Apr 2009 09:37:12 -0400
Message-ID: <359a92830904030637x63170a9ct3277cc4680eb5198@mail.gmail.com>
Subject: Re: HeapedScorerDoc using all my memory
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6469820618f7a0466a6a593
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6469820618f7a0466a6a593
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Good Luck! I love (a little sarcasm there) being presented with
problem statements like "it doesn't work. You can't do anything
on the machine where the problem is. We can't give you any
information about what's happening. How long will it take you
to fix it?" <G>

Best
Erick@InFullSympathy.com

On Fri, Apr 3, 2009 at 9:21 AM, John Byrne <john.byrne@propylon.com> wrote:

> Unfortunately I'm not sure of the exact number. It happened on a machine I
> have no access to, and I was just e-mailed a few details of the problem! We
> have a JMS queue, where each message is a file to be indexed. There was
> somewhere between 2000 and 10,000 messages processed when it happened.
>
> Because we don't make a distinction between batch and incremental indexing,
>  I am closing and re-opening the writer for each document. What you've
> suggested there could well be the problem, that's certainly where I'll look
> next.
>
> Thanks for the ideas anyway - I know I really need to come up with some
> more info on the problem, so I think the next thing I'll do it try to
> reproduce it locally.
>
> -John
>
> Erick Erickson wrote:
>
>> Hmmmm, that's odd. how many is "a large number of documents"? And
>> what is your index size when things to wonky? (approximately)
>>
>> I can say that other people create very large indexes without this
>> happening,
>> but the only thing that says is that this isn't a *known* problem.
>>
>> Is there any chance you're re-opening the indexwriter without
>> closing the old one (not that you should, you should reuse the writer,
>> but I've put a new in the wrong place by mistake a time or two)....
>>
>> But I confess that I have no idea what happens under the covers when
>> indexing,
>> so I'll have to leave any real insights to the folks who know.
>>
>> Erick
>>
>> On Fri, Apr 3, 2009 at 8:41 AM, John Byrne <john.byrne@propylon.com>
>> wrote:
>>
>>
>>
>>> The maximum JVM memory is 2GB. Apparently 1.2GB is being used up by this
>>> class.
>>>
>>> All IndexWriter settings are left as default.
>>>
>>> I haven't tried any changes yet, because the problem so far has on ly
>>> happened in a production environment that I can't mess with. I am
>>> planning
>>> to try reproducing it locally soon, but it takes quite a while before it
>>> happens.
>>>
>>> -John
>>>
>>> Erick Erickson wrote:
>>>
>>>
>>>
>>>> How much memory are you allocating for the JVM? And what are your
>>>> various indexwriter settings (e.g. MaxBufferedDocs, MaxMergeDocs, etc).
>>>>
>>>> Have you tried different settings in setRamBufferSizeMB?
>>>>
>>>> Best
>>>> Erick
>>>>
>>>> On Fri, Apr 3, 2009 at 7:13 AM, John Byrne <john.byrne@propylon.com>
>>>> wrote:
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>> Hi, I'm having a problem where the JVM runs out of memory while
>>>>> indexing
>>>>> a
>>>>> large number of files. An analysis of the heapdump shows that most of
>>>>> the
>>>>> memory was taken up with
>>>>> "org/apache/lucene/util/ScorerDocQueue$HeapedScorerDoc".
>>>>>
>>>>> I can't find any leaks in my code so far, and I was wondering, are
>>>>> there
>>>>> any known problems with this class that could leak memory?
>>>>>
>>>>> I'm using version 2.3.1.
>>>>>
>>>>> Thanks!
>>>>>
>>>>> -John
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>>  ------------------------------------------------------------------------
>>>>
>>>>
>>>> No virus found in this incoming message.
>>>> Checked by AVG - www.avg.com Version: 8.0.238 / Virus Database:
>>>> 270.11.39/2038 - Release Date: 04/02/09 19:07:00
>>>>
>>>>
>>>>
>>>>
>>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>>
>>
>>  ------------------------------------------------------------------------
>>
>>
>> No virus found in this incoming message.
>> Checked by AVG - www.avg.com Version: 8.0.238 / Virus Database:
>> 270.11.40/2039 - Release Date: 04/03/09 06:19:00
>>
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6469820618f7a0466a6a593--

From java-user-return-39489-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 13:56:13 2009
Return-Path: <java-user-return-39489-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1602 invoked from network); 3 Apr 2009 13:56:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 13:56:13 -0000
Received: (qmail 87410 invoked by uid 500); 3 Apr 2009 13:56:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87362 invoked by uid 500); 3 Apr 2009 13:56:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87352 invoked by uid 99); 3 Apr 2009 13:56:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 13:56:10 +0000
X-ASF-Spam-Status: No, hits=4.0 required=10.0
	tests=DNS_FROM_OPENWHOIS,FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 13:56:02 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lpjrx-0003K0-AQ
	for java-user@lucene.apache.org; Fri, 03 Apr 2009 06:55:41 -0700
Message-ID: <22868930.post@talk.nabble.com>
Date: Fri, 3 Apr 2009 06:55:41 -0700 (PDT)
From: addman <addiekong@yahoo.com>
To: java-user@lucene.apache.org
Subject: Lucene Filtering
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: addiekong@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


How do you create a Lucene Filter to check if a field has a value?  It is
part for a ChainedFilter that I am creating.
-- 
View this message in context: http://www.nabble.com/Lucene-Filtering-tp22868930p22868930.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39490-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 14:25:40 2009
Return-Path: <java-user-return-39490-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24550 invoked from network); 3 Apr 2009 14:25:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 14:25:40 -0000
Received: (qmail 56118 invoked by uid 500); 3 Apr 2009 14:25:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56041 invoked by uid 500); 3 Apr 2009 14:25:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56031 invoked by uid 99); 3 Apr 2009 14:25:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 14:25:38 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of MSchraeder@btsb.com designates 216.8.91.5 as permitted sender)
Received: from [216.8.91.5] (HELO mail.btsb.com) (216.8.91.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 14:25:31 +0000
X-IronPort-AV: E=Sophos;i="4.39,319,1235973600"; 
   d="scan'208,217";a="472299"
Received: from unknown (HELO mail.btsb.com) ([10.1.1.2])
  by mail.btsb.com with ESMTP; 03 Apr 2009 09:26:51 -0500
Received: from GWDOMAIN-MTA by mail.btsb.com
	with Novell_GroupWise; Fri, 03 Apr 2009 09:27:16 -0600
Message-Id: <s9d5d674.073@mail.btsb.com>
X-Mailer: Novell GroupWise Internet Agent 6.5.5 
Date: Fri, 03 Apr 2009 09:26:39 -0600
From: "Matt Schraeder" <MSchraeder@btsb.com>
To: <java-user@lucene.apache.org>
Subject: Re: Speed of fuzzy searches
Mime-Version: 1.0
Content-Type: multipart/alternative; boundary="=__Part624AF0BF.0__="
X-Virus-Checked: Checked by ClamAV on apache.org

--=__Part624AF0BF.0__=
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

After doing some research I broke down and just updated my Zend
Framework.  I just installed it not long ago so I didn't think much of
it, but then I realized I'm running version 1.6.1 and that Zend is
currently on 1.7.8.  Upon upgrading the complex fuzzy search that was
taking 30 seconds now takes 0.067 seconds.  I have no idea what changed
in the past few months, and see no mention of performance issues on
their issue tracker  but all seems well now.  Figured I'd post here to
give others a heads up if they run into similar issues like I did.

>>> MSchraeder@btsb.com 4/2/2009 3:32:01 PM >>>

>>> erickerickson@gmail.com 4/2/2009 10:24:42 AM >>>
>This seems really odd, especially with an index that size. The
>first question is usually "Do you open an IndexReader for
>each query?" 

I'm using the Zend_Search_Lucene implementation so I'm really not sure
how it handles the IndexReader.  At the top of the script I open the
index and do searches on it.  Unless Zend is doing something special
in
the background I'm assuming I'm using the IndexReader on a per-page
basis.  I haven't been able to find any information on this yet, but
from all the examples I've been reading none of them say to keep the
index in a session to improve speed.  I'll have to get on the zend
mailing lists to find out more about best practices.

>>> markrmiller@gmail.com 4/2/2009 10:40:59 AM >>>
>You might try setting a longer prefix. Fuzzy queries don't scale by
the 
>way. By default they enumerate every unique term. How many unique
terms 
>do you have in the index?

I'll look at a longer prefix setting, as the reply above mentioned the
improving search speed article.  Currently my index has 104076 terms
in
it.



--=__Part624AF0BF.0__=--

From java-user-return-39491-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 14:34:17 2009
Return-Path: <java-user-return-39491-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30905 invoked from network); 3 Apr 2009 14:34:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 14:34:16 -0000
Received: (qmail 71498 invoked by uid 500); 3 Apr 2009 14:34:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71389 invoked by uid 500); 3 Apr 2009 14:34:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71320 invoked by uid 99); 3 Apr 2009 14:34:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 14:34:07 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.169] (HELO wf-out-1314.google.com) (209.85.200.169)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 14:33:56 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1184914wff.20
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 07:33:33 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.156.2 with SMTP id d2mr355098wfe.64.1238769212729; Fri, 03 
	Apr 2009 07:33:32 -0700 (PDT)
In-Reply-To: <49D60D5B.70601@propylon.com>
References: <49D5EF6C.6080805@propylon.com>
	 <359a92830904030514j3a46cdbbvb251bc3ad1d33075@mail.gmail.com>
	 <49D603EA.9000609@propylon.com>
	 <359a92830904030606j736e3f6bx4a2b4e1eed30bdce@mail.gmail.com>
	 <49D60D5B.70601@propylon.com>
Date: Fri, 3 Apr 2009 10:33:32 -0400
Message-ID: <9ac0c6aa0904030733g11c618e3n34ba267fc3b9928e@mail.gmail.com>
Subject: Re: HeapedScorerDoc using all my memory
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I'm also confused, because ScorerDocQueue should not be used during indexin=
g.

It's used only when scoring boolean "OR" queries.

Are you doing searching in the same JVM as indexing?

Mike

On Fri, Apr 3, 2009 at 9:21 AM, John Byrne <john.byrne@propylon.com> wrote:
> Unfortunately I'm not sure of the exact number. It happened on a machine =
I
> have no access to, and I was just e-mailed a few details of the problem! =
We
> have a JMS queue, where each message is a file to be indexed. There was
> somewhere between 2000 and 10,000 messages processed when it happened.
>
> Because we don't make a distinction between batch and incremental indexin=
g,
> =A0I am closing and re-opening the writer for each document. What you've
> suggested there could well be the problem, that's certainly where I'll lo=
ok
> next.
>
> Thanks for the ideas anyway - I know I really need to come up with some m=
ore
> info on the problem, so I think the next thing I'll do it try to reproduc=
e
> it locally.
>
> -John
>
> Erick Erickson wrote:
>>
>> Hmmmm, that's odd. how many is "a large number of documents"? And
>> what is your index size when things to wonky? (approximately)
>>
>> I can say that other people create very large indexes without this
>> happening,
>> but the only thing that says is that this isn't a *known* problem.
>>
>> Is there any chance you're re-opening the indexwriter without
>> closing the old one (not that you should, you should reuse the writer,
>> but I've put a new in the wrong place by mistake a time or two)....
>>
>> But I confess that I have no idea what happens under the covers when
>> indexing,
>> so I'll have to leave any real insights to the folks who know.
>>
>> Erick
>>
>> On Fri, Apr 3, 2009 at 8:41 AM, John Byrne <john.byrne@propylon.com>
>> wrote:
>>
>>
>>>
>>> The maximum JVM memory is 2GB. Apparently 1.2GB is being used up by thi=
s
>>> class.
>>>
>>> All IndexWriter settings are left as default.
>>>
>>> I haven't tried any changes yet, because the problem so far has on ly
>>> happened in a production environment that I can't mess with. I am
>>> planning
>>> to try reproducing it locally soon, but it takes quite a while before i=
t
>>> happens.
>>>
>>> -John
>>>
>>> Erick Erickson wrote:
>>>
>>>
>>>>
>>>> How much memory are you allocating for the JVM? And what are your
>>>> various indexwriter settings (e.g. MaxBufferedDocs, MaxMergeDocs, etc)=
.
>>>>
>>>> Have you tried different settings in setRamBufferSizeMB?
>>>>
>>>> Best
>>>> Erick
>>>>
>>>> On Fri, Apr 3, 2009 at 7:13 AM, John Byrne <john.byrne@propylon.com>
>>>> wrote:
>>>>
>>>>
>>>>
>>>>
>>>>>
>>>>> Hi, I'm having a problem where the JVM runs out of memory while
>>>>> indexing
>>>>> a
>>>>> large number of files. An analysis of the heapdump shows that most of
>>>>> the
>>>>> memory was taken up with
>>>>> "org/apache/lucene/util/ScorerDocQueue$HeapedScorerDoc".
>>>>>
>>>>> I can't find any leaks in my code so far, and I was wondering, are
>>>>> there
>>>>> any known problems with this class that could leak memory?
>>>>>
>>>>> I'm using version 2.3.1.
>>>>>
>>>>> Thanks!
>>>>>
>>>>> -John
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>> =A0-------------------------------------------------------------------=
-----
>>>>
>>>>
>>>> No virus found in this incoming message.
>>>> Checked by AVG - www.avg.com Version: 8.0.238 / Virus Database:
>>>> 270.11.39/2038 - Release Date: 04/02/09 19:07:00
>>>>
>>>>
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> =A0---------------------------------------------------------------------=
---
>>
>>
>> No virus found in this incoming message.
>> Checked by AVG - www.avg.com Version: 8.0.238 / Virus Database:
>> 270.11.40/2039 - Release Date: 04/03/09 06:19:00
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39492-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 14:59:32 2009
Return-Path: <java-user-return-39492-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40854 invoked from network); 3 Apr 2009 14:59:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 14:59:32 -0000
Received: (qmail 17904 invoked by uid 500); 3 Apr 2009 14:59:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17791 invoked by uid 500); 3 Apr 2009 14:59:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17568 invoked by uid 99); 3 Apr 2009 14:59:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 14:59:29 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a10.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 14:59:20 +0000
Received: from [192.168.0.103] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a10.g.dreamhost.com (Postfix) with ESMTP id 5D81A161567
	for <java-user@lucene.apache.org>; Fri,  3 Apr 2009 07:58:59 -0700 (PDT)
Message-Id: <D8804533-011E-428C-8C14-42A029D252D3@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <s9d5d674.073@mail.btsb.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Speed of fuzzy searches
Date: Fri, 3 Apr 2009 10:58:56 -0400
References: <s9d5d674.073@mail.btsb.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

In a really weird "what is old, is new again" sort of thing, I am  
researching spellchecking, and came across: http://www.lucidimagination.com/search/document/cc46ac41bd4ee661/ngramspeller_contribution_re_combining_open_office_spellchecker_with_lucene#4f731c4209e3d7d0 
  which suggests speeding up FuzzyQuery using JaroWinkler, but I don't  
think it was ever done.

Now, we have an implementation of JaroWinkler in the spell checker (in  
fact, we have pluggable distance measures there), perhaps it makes  
sense to think about how FuzzyQuery could leverage this pluggability?

Also, Matt, perhaps as an alternative to Fuzzy (which still can be  
slow even w/ your upgrade), you may look at doing spell checking  
instead.

-Grant

On Apr 3, 2009, at 11:26 AM, Matt Schraeder wrote:

> After doing some research I broke down and just updated my Zend
> Framework.  I just installed it not long ago so I didn't think much of
> it, but then I realized I'm running version 1.6.1 and that Zend is
> currently on 1.7.8.  Upon upgrading the complex fuzzy search that was
> taking 30 seconds now takes 0.067 seconds.  I have no idea what  
> changed
> in the past few months, and see no mention of performance issues on
> their issue tracker  but all seems well now.  Figured I'd post here to
> give others a heads up if they run into similar issues like I did.
>
>>>> MSchraeder@btsb.com 4/2/2009 3:32:01 PM >>>
>
>>>> erickerickson@gmail.com 4/2/2009 10:24:42 AM >>>
>> This seems really odd, especially with an index that size. The
>> first question is usually "Do you open an IndexReader for
>> each query?"
>
> I'm using the Zend_Search_Lucene implementation so I'm really not sure
> how it handles the IndexReader.  At the top of the script I open the
> index and do searches on it.  Unless Zend is doing something special
> in
> the background I'm assuming I'm using the IndexReader on a per-page
> basis.  I haven't been able to find any information on this yet, but
> from all the examples I've been reading none of them say to keep the
> index in a session to improve speed.  I'll have to get on the zend
> mailing lists to find out more about best practices.
>
>>>> markrmiller@gmail.com 4/2/2009 10:40:59 AM >>>
>> You might try setting a longer prefix. Fuzzy queries don't scale by
> the
>> way. By default they enumerate every unique term. How many unique
> terms
>> do you have in the index?
>
> I'll look at a longer prefix setting, as the reply above mentioned the
> improving search speed article.  Currently my index has 104076 terms
> in
> it.
>
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39493-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 15:31:54 2009
Return-Path: <java-user-return-39493-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54912 invoked from network); 3 Apr 2009 15:31:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 15:31:54 -0000
Received: (qmail 89735 invoked by uid 500); 3 Apr 2009 15:31:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89654 invoked by uid 500); 3 Apr 2009 15:31:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89644 invoked by uid 99); 3 Apr 2009 15:31:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 15:31:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [69.55.225.129] (HELO ehatchersolutions.com) (69.55.225.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 15:31:42 +0000
Received: by ehatchersolutions.com (Postfix, from userid 504)
	id 7A3E330EFC14; Fri,  3 Apr 2009 09:31:20 -0600 (MDT)
X-Spam-Checker-Version: SpamAssassin 3.1.1 (2006-03-10) on javelina
X-Spam-Level: *
Received: from d-172-27-137-39.bootp.Virginia.EDU (unknown [137.54.26.50])
	by ehatchersolutions.com (Postfix) with ESMTP id AE75A30EFC12
	for <java-user@lucene.apache.org>; Fri,  3 Apr 2009 09:31:17 -0600 (MDT)
Message-Id: <24F7B461-CF5A-4E8F-BC13-89E86CDA2D68@ehatchersolutions.com>
From: Erik Hatcher <erik@ehatchersolutions.com>
To: java-user@lucene.apache.org
In-Reply-To: <D8804533-011E-428C-8C14-42A029D252D3@apache.org>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Speed of fuzzy searches
Date: Fri, 3 Apr 2009 11:31:16 -0400
References: <s9d5d674.073@mail.btsb.com> <D8804533-011E-428C-8C14-42A029D252D3@apache.org>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=1.6 required=5.0 tests=BAYES_00,HELO_DYNAMIC_IPADDR 
	autolearn=no version=3.1.1


On Apr 3, 2009, at 10:58 AM, Grant Ingersoll wrote:
> Now, we have an implementation of JaroWinkler in the spell checker  
> (in fact, we have pluggable distance measures there), perhaps it  
> makes sense to think about how FuzzyQuery could leverage this  
> pluggability?

My suggestion is to make it pluggable like the RegexQuery makes the  
regular expression engine pluggable.  *cough* interfaces ;)  ala  
RegexCapabilities and RegexQueryCapable

	Erik




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39494-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 15:56:34 2009
Return-Path: <java-user-return-39494-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62322 invoked from network); 3 Apr 2009 15:56:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 15:56:34 -0000
Received: (qmail 47445 invoked by uid 500); 3 Apr 2009 15:56:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47409 invoked by uid 500); 3 Apr 2009 15:56:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47399 invoked by uid 99); 3 Apr 2009 15:56:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 15:56:31 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lukas.vlcek@gmail.com designates 209.85.218.166 as permitted sender)
Received: from [209.85.218.166] (HELO mail-bw0-f166.google.com) (209.85.218.166)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 15:56:22 +0000
Received: by bwz10 with SMTP id 10so1158355bwz.5
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 08:56:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=7AmLrDMG09GqYFaKy7jWYpIFp1N7QHXnUuXh1T6Ebak=;
        b=UWaGQiD3HvY2ufmoroUrO489KD9xrd7dlov1oaFgQXZJTr74TK9rJ0jqcfDw3jYqw2
         q8+cerpOtbe2kqcl17N42DQ9YoLgg8EYHyEZjrsmnhHvFjEfGpP9EBrb+6LRdG7pG8+P
         GUGsEy1mXeMXwWmlVf/4nyCiMYa7YElSAxG8U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=vmfS/vxzb722ytoQ4jNZmoKIOl378bAXS9KSJ6grvjzcbx5uhLDROwHNbhhbyTFGcO
         cibQa9i4K6jFhjrvzH+lqsMNw4N1UDxWDW3jIrh0JbhzDomigHEOZXQils5ct2d28X6c
         QB/G5HQ4jk0hVIWAtJNFcutQvfZgdQRGdiVnY=
MIME-Version: 1.0
Received: by 10.103.229.12 with SMTP id g12mr664890mur.16.1238774161041; Fri, 
	03 Apr 2009 08:56:01 -0700 (PDT)
Date: Fri, 3 Apr 2009 17:56:00 +0200
Message-ID: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com>
Subject: Autonomy search technology
From: =?UTF-8?B?THVrw6HFoSBWbMSNZWs=?= <lukas.vlcek@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00504502de84d367ab0466a8951d
X-Virus-Checked: Checked by ClamAV on apache.org

--00504502de84d367ab0466a8951d
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

Hi,
anybody has experience with Automony search technology (
http://en.wikipedia.org/wiki/Autonomy_Corporation)? Speaking about their
text searching technology is there anything which can not be achieved using
Lucene?

Regards,
Lukas

--00504502de84d367ab0466a8951d--

From java-user-return-39495-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 17:08:43 2009
Return-Path: <java-user-return-39495-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91454 invoked from network); 3 Apr 2009 17:08:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 17:08:43 -0000
Received: (qmail 75803 invoked by uid 500); 3 Apr 2009 17:08:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75731 invoked by uid 500); 3 Apr 2009 17:08:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75721 invoked by uid 99); 3 Apr 2009 17:08:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 17:08:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.198.227 as permitted sender)
Received: from [209.85.198.227] (HELO rv-out-0506.google.com) (209.85.198.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 17:08:32 +0000
Received: by rv-out-0506.google.com with SMTP id g9so1126707rvb.5
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 10:08:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Ypwwdj2Jo7fDjuvWYwTmY3gpuUzauLe0S9ZV9AePmU8=;
        b=rEaKZhwww51KkafPgyWvRJjuhU/08wyf9on/E14pBYpoYeXa6pJBp3+PkWte4NwIP4
         zXnerpM+qW/Uot3DDJWtXQxk3oeKmrWAWk76XmviAnw+z/zqvVR1oS6yrTTp8yV5rdgO
         +FIsOPeL8djA2hio7cdCCgO4cPSYpZ8HVPiHg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=uLoRPUmdUmvxl/0AUiIpj7TzLJLI1uVVsXevpodiyJGVOc1PKKW2ff2dFOGTGXBrAN
         87nBzRIV2fvZ1caYYrhXopJ2aWp3Yi7WRWlx6u6jon+w2DlfUCoBTljvVuPbdw6s3Znl
         ewxUZxkvfXTJzsn5NhjCGgmsxa7Hf9+Wz5ZJQ=
MIME-Version: 1.0
Received: by 10.140.201.8 with SMTP id y8mr642732rvf.129.1238778491960; Fri, 
	03 Apr 2009 10:08:11 -0700 (PDT)
In-Reply-To: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com>
References: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com>
Date: Fri, 3 Apr 2009 10:08:11 -0700
Message-ID: <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com>
Subject: Re: Autonomy search technology
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd2bd52f7ff7b0466a9978a
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd2bd52f7ff7b0466a9978a
Content-Type: text/plain; charset=ISO-8859-2
Content-Transfer-Encoding: quoted-printable

Verity VDK, which was bought by autonomy, has zone search. Something lucene
currently does not support.

We have implemented it ontop of lucene and thinking about contributing.

-John

On Fri, Apr 3, 2009 at 8:56 AM, Luk=E1=B9 Vl=E8ek <lukas.vlcek@gmail.com> w=
rote:

> Hi,
> anybody has experience with Automony search technology (
> http://en.wikipedia.org/wiki/Autonomy_Corporation)? Speaking about their
> text searching technology is there anything which can not be achieved usi=
ng
> Lucene?
>
> Regards,
> Lukas
>

--000e0cd2bd52f7ff7b0466a9978a--

From java-user-return-39496-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 17:55:01 2009
Return-Path: <java-user-return-39496-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18255 invoked from network); 3 Apr 2009 17:54:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 17:54:58 -0000
Received: (qmail 27666 invoked by uid 500); 3 Apr 2009 17:44:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27566 invoked by uid 500); 3 Apr 2009 17:44:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27556 invoked by uid 99); 3 Apr 2009 17:44:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 17:44:29 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lukas.vlcek@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 17:44:21 +0000
Received: by fxm2 with SMTP id 2so1204815fxm.5
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 10:43:59 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=fqE2MlpGfCsd5OdsnjHdQJgmP6lW8L/ho+dqWT3yIbc=;
        b=mhuTT70x6pHtaaqI/dXQQsl4US+nfE5lLMCYe0iYs08Y4HvQrFc+DoSusY4jwuwdpb
         cAzm+NyVRopGTy5xqiuQ/6Ne8AYhXb6pKut1oTZxzrvWzWE2p2XkcriE9nS4N/DW56Ft
         rMurBTL81Em9VROkf/g+aLg8QaNiLfleR681M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=G/7ER2ZOJUb9VGv8LXBR7Nj5NMNJ6f7U4sOo9lR9nWRa88qwbSTkY0kZzfavGxO26W
         KMNaHGaY/V/WtoE1FU4wauaVgpSAlPg/NgvlVjeoUx5OGnLK1duILyef6zknBL7I8Wsq
         5gl0J5jRO91fQKmKSnJdhc+7v76uTy082D1Po=
MIME-Version: 1.0
Received: by 10.103.176.20 with SMTP id d20mr711454mup.27.1238780639780; Fri, 
	03 Apr 2009 10:43:59 -0700 (PDT)
In-Reply-To: <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com>
References: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com>
	 <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com>
Date: Fri, 3 Apr 2009 19:43:59 +0200
Message-ID: <52c3ddca0904031043p65e52449s922022457ddf723f@mail.gmail.com>
Subject: Re: Autonomy search technology
From: =?UTF-8?B?THVrw6HFoSBWbMSNZWs=?= <lukas.vlcek@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163641759bfd20de0466aa1710
X-Virus-Checked: Checked by ClamAV on apache.org

--00163641759bfd20de0466aa1710
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

So it means that autonomy search solution is doing better out of the box
then any solution based on Lucene right now? And bringing Lucene based
solution at the same level would require additional investments and
non-trivial development (probably not small). In other words if client is
using autonomy then it makes no sense to migrate to Lucene...Hmmm... great
pity.

Thanks,
Lukas

2009/4/3 John Wang <john.wang@gmail.com>

> Verity VDK, which was bought by autonomy, has zone search. Something luce=
ne
> currently does not support.
>
> We have implemented it ontop of lucene and thinking about contributing.
>
> -John
>
> On Fri, Apr 3, 2009 at 8:56 AM, Luk=C3=A1=C5=A1 Vl=C4=8Dek <lukas.vlcek@g=
mail.com> wrote:
>
> > Hi,
> > anybody has experience with Automony search technology (
> > http://en.wikipedia.org/wiki/Autonomy_Corporation)? Speaking about thei=
r
> > text searching technology is there anything which can not be achieved
> using
> > Lucene?
> >
> > Regards,
> > Lukas
> >
>



--=20
http://blog.lukas-vlcek.com/

--00163641759bfd20de0466aa1710--

From java-user-return-39497-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 18:08:28 2009
Return-Path: <java-user-return-39497-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26371 invoked from network); 3 Apr 2009 18:08:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 18:08:28 -0000
Received: (qmail 55823 invoked by uid 500); 3 Apr 2009 18:08:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55771 invoked by uid 500); 3 Apr 2009 18:08:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55761 invoked by uid 99); 3 Apr 2009 18:08:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 18:08:25 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mruno@zappos.com designates 66.209.92.160 as permitted sender)
Received: from [66.209.92.160] (HELO mailer2.zappos.com) (66.209.92.160)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 03 Apr 2009 18:08:15 +0000
Received: (qmail 83822 invoked from network); 3 Apr 2009 18:07:55 -0000
Received: from unknown (HELO mail.zappos.com) (10.206.173.4)
  by 10.66.209.20 with SMTP; 3 Apr 2009 18:07:55 -0000
Received: from mail.zappos.com (localhost [127.0.0.1])
	by mail.zappos.com (Postfix) with ESMTP id 08F697DA33F
	for <java-user@lucene.apache.org>; Fri,  3 Apr 2009 11:07:55 -0700 (PDT)
Received: from [10.206.183.176] (firewall [10.206.172.1])
	(using TLSv1 with cipher AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.zappos.com (Postfix) with ESMTPS id EEF8D7DA33D
	for <java-user@lucene.apache.org>; Fri,  3 Apr 2009 11:07:54 -0700 (PDT)
Message-Id: <1B69876F-6C87-4A1A-8A02-55A4808221B5@zappos.com>
From: Matthew Runo <mruno@zappos.com>
To: java-user@lucene.apache.org
In-Reply-To: <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-2; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Autonomy search technology
Date: Fri, 3 Apr 2009 11:07:54 -0700
References: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com> <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Scanned: ClamAV using ClamSMTP
X-Virus-Checked: Checked by ClamAV on apache.org

Would you be willing to explain what "zone search" is? I did a quick =20
google search, but came up empty handed.

Thanks for your time!

Matthew Runo
Software Engineer, Zappos.com
mruno@zappos.com - 702-943-7833

On Apr 3, 2009, at 10:08 AM, John Wang wrote:

> Verity VDK, which was bought by autonomy, has zone search. Something =20=

> lucene
> currently does not support.
>
> We have implemented it ontop of lucene and thinking about =20
> contributing.
>
> -John
>
> On Fri, Apr 3, 2009 at 8:56 AM, Luk=E1=B9 Vl=E8ek =
<lukas.vlcek@gmail.com> =20
> wrote:
>
>> Hi,
>> anybody has experience with Automony search technology (
>> http://en.wikipedia.org/wiki/Autonomy_Corporation)? Speaking about =20=

>> their
>> text searching technology is there anything which can not be =20
>> achieved using
>> Lucene?
>>
>> Regards,
>> Lukas
>>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39498-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 19:09:49 2009
Return-Path: <java-user-return-39498-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58447 invoked from network); 3 Apr 2009 19:09:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 19:09:49 -0000
Received: (qmail 36683 invoked by uid 500); 3 Apr 2009 19:09:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36629 invoked by uid 500); 3 Apr 2009 19:09:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36619 invoked by uid 99); 3 Apr 2009 19:09:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 19:09:47 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.198.224 as permitted sender)
Received: from [209.85.198.224] (HELO rv-out-0506.google.com) (209.85.198.224)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 19:09:37 +0000
Received: by rv-out-0506.google.com with SMTP id g9so1167622rvb.5
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 12:09:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=psnuJGcHbLjwQ4gRalEbbP6zbCgQlz/HE9B4VoOEiig=;
        b=I7za8xa/ZNbywjqsdduCzY6p3lE52WlIZ53pdcpE1e12ltnVEodk1hl8+/JOpnT+yn
         mUCWf+HB0EwABC7Y4X6CqpZS166i8yvo1NZvhPCjRYAweBZgijookYRclg5+IPujVyvb
         8/VV/8aaM1RAvE8Pate6c3DuRWqv50mfBoJJ4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=pWStc0rakpCDrNtMBTQMHuI1yCEVUf+PnuTdzMAnNUg6gu+YNarS/egen2rXGF8dGy
         bRDHLPIEvdQg0awEN2Fcvj1oc1n+Ujn+Smiaj8gexhBwWHqZrePyHYbBChWiG96dJXyr
         9jfXZMSoTJ8HjEjt0oL79X5Sk4MFzrAouRtT8=
MIME-Version: 1.0
Received: by 10.141.162.5 with SMTP id p5mr676982rvo.193.1238785757160; Fri, 
	03 Apr 2009 12:09:17 -0700 (PDT)
In-Reply-To: <1B69876F-6C87-4A1A-8A02-55A4808221B5@zappos.com>
References: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com>
	 <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com>
	 <1B69876F-6C87-4A1A-8A02-55A4808221B5@zappos.com>
Date: Fri, 3 Apr 2009 12:09:17 -0700
Message-ID: <8837fb770904031209x24e3ec2cwd3d108316e180ad2@mail.gmail.com>
Subject: Re: Autonomy search technology
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd209620226650466ab491a
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd209620226650466ab491a
Content-Type: text/plain; charset=ISO-8859-2
Content-Transfer-Encoding: quoted-printable

Maybe it is a Verity specific term :)

zone search =3D searching only a part of a document. e.g. 1000 docs in the
corpus, query only second paragraph of all docs.

@Lukas: That is not what I am saying at all. Lucene's feature set is not a
superset of those of autonomy/verity/endeca ..., neither is the reverse
true. Which package you choose highly depends on your usecase, requirement
and of course size of your wallet.

-John

2009/4/3 Matthew Runo <mruno@zappos.com>

> Would you be willing to explain what "zone search" is? I did a quick goog=
le
> search, but came up empty handed.
>
> Thanks for your time!
>
> Matthew Runo
> Software Engineer, Zappos.com
> mruno@zappos.com - 702-943-7833
>
>
> On Apr 3, 2009, at 10:08 AM, John Wang wrote:
>
>  Verity VDK, which was bought by autonomy, has zone search. Something
>> lucene
>> currently does not support.
>>
>> We have implemented it ontop of lucene and thinking about contributing.
>>
>> -John
>>
>> On Fri, Apr 3, 2009 at 8:56 AM, Luk=E1=B9 Vl=E8ek <lukas.vlcek@gmail.com=
>
>> wrote:
>>
>>  Hi,
>>> anybody has experience with Automony search technology (
>>> http://en.wikipedia.org/wiki/Autonomy_Corporation)? Speaking about thei=
r
>>> text searching technology is there anything which can not be achieved
>>> using
>>> Lucene?
>>>
>>> Regards,
>>> Lukas
>>>
>>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd209620226650466ab491a--

From java-user-return-39499-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 19:12:01 2009
Return-Path: <java-user-return-39499-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58693 invoked from network); 3 Apr 2009 19:12:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 19:12:01 -0000
Received: (qmail 38829 invoked by uid 500); 3 Apr 2009 19:11:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38742 invoked by uid 500); 3 Apr 2009 19:11:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38732 invoked by uid 99); 3 Apr 2009 19:11:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 19:11:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of digydigy@gmail.com designates 209.85.218.166 as permitted sender)
Received: from [209.85.218.166] (HELO mail-bw0-f166.google.com) (209.85.218.166)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 19:11:49 +0000
Received: by bwz10 with SMTP id 10so1233409bwz.5
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 12:11:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:from:to:references
         :in-reply-to:subject:date:message-id:mime-version:content-type
         :content-transfer-encoding:x-mailer:thread-index:content-language;
        bh=dZTOrGakVHUB4P08O8dTizFtp6lJFy9+6FzYM3/gS0o=;
        b=LKaM//CSpTormg1erV0oVnpBq6FjTHin2k5r6VRHODKaO+sfKrqXCrR1arjKIJR5h4
         cEZQHTCgMDC2YJ3+u8MckpiyygWDBWIQGMviTtNOezyBc7SlFGwEdJ2pvKCtJBvnxae6
         M/G2dD0WZ6DFD6vxciUdccRA8kd1J4ovOqIdk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:x-mailer:thread-index
         :content-language;
        b=BiniDMNpcidF5KaUmErHeqEuD6qQ16R9a+jp+vG3xGMNcwHvnbX7cRqNDn/4ELGz+R
         2mpc9ubGLnWltvrGMC2OXBFY48sLyAQ+p0XzSl06506OA8ox/ESw5zPHOrvuE7be8WMX
         9iWRl67YhzFr26RFbxRffehZWX6gkax37ctWA=
Received: by 10.223.126.145 with SMTP id c17mr1345358fas.102.1238785887684;
        Fri, 03 Apr 2009 12:11:27 -0700 (PDT)
Received: from NEWPC ([81.213.206.230])
        by mx.google.com with ESMTPS id d13sm401422fka.0.2009.04.03.12.11.26
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 03 Apr 2009 12:11:27 -0700 (PDT)
From: "Digy" <digydigy@gmail.com>
To: <java-user@lucene.apache.org>
References: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com> <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com> <1B69876F-6C87-4A1A-8A02-55A4808221B5@zappos.com>
In-Reply-To: <1B69876F-6C87-4A1A-8A02-55A4808221B5@zappos.com>
Subject: RE: Autonomy search technology
Date: Fri, 3 Apr 2009 22:11:17 +0300
Message-ID: <003e01c9b48f$f9990d50$eccb27f0$@com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="ISO-8859-2"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: Acm0hzBCPOvAa1wETXyROaGQL6IlHAACGDng
Content-Language: tr
X-Virus-Checked: Checked by ClamAV on apache.org

As far as I can remember, "Zone" in Verity is similar to "field" in =
Lucene
and verity performs searches on all "zones" by default.

DIGY

-----Original Message-----
From: Matthew Runo [mailto:mruno@zappos.com]=20
Sent: Friday, April 03, 2009 9:08 PM
To: java-user@lucene.apache.org
Subject: Re: Autonomy search technology

Would you be willing to explain what "zone search" is? I did a quick =20
google search, but came up empty handed.

Thanks for your time!

Matthew Runo
Software Engineer, Zappos.com
mruno@zappos.com - 702-943-7833

On Apr 3, 2009, at 10:08 AM, John Wang wrote:

> Verity VDK, which was bought by autonomy, has zone search. Something =20
> lucene
> currently does not support.
>
> We have implemented it ontop of lucene and thinking about =20
> contributing.
>
> -John
>
> On Fri, Apr 3, 2009 at 8:56 AM, Luk=E1=B9 Vl=E8ek =
<lukas.vlcek@gmail.com> =20
> wrote:
>
>> Hi,
>> anybody has experience with Automony search technology (
>> http://en.wikipedia.org/wiki/Autonomy_Corporation)? Speaking about =20
>> their
>> text searching technology is there anything which can not be =20
>> achieved using
>> Lucene?
>>
>> Regards,
>> Lukas
>>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39500-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 21:37:06 2009
Return-Path: <java-user-return-39500-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11673 invoked from network); 3 Apr 2009 21:37:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 21:37:06 -0000
Received: (qmail 17832 invoked by uid 500); 3 Apr 2009 21:37:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17761 invoked by uid 500); 3 Apr 2009 21:37:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17751 invoked by uid 99); 3 Apr 2009 21:37:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 21:37:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 21:36:57 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id A053671C29B; Fri,  3 Apr 2009 14:36:36 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 96D2371C27E
	for <java-user@lucene.apache.org>; Fri,  3 Apr 2009 14:36:36 -0700 (PDT)
Date: Fri, 3 Apr 2009 14:36:36 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: sloppyFreq question
In-Reply-To: <e994873a0903200545l35cfa719pd797f8bf7ae759b5@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0904031433280.9800@radix.cryptio.net>
References: <e994873a0903031142n3436a966w95520a06b23c5e1f@mail.gmail.com> 
 <e994873a0903090705r1a9aa3bfoe04308dd319cb9ef@mail.gmail.com> 
 <Pine.LNX.4.64.0903111212160.9487@radix.cryptio.net> 
 <e994873a0903111333k32b67d69h896dadfa31227a15@mail.gmail.com> 
 <Pine.LNX.4.64.0903171606180.28118@radix.cryptio.net>
 <e994873a0903200545l35cfa719pd797f8bf7ae759b5@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Sorry, here's the example I meant to show. Doc 1 and doc 2 both contain the
: terms "hey look, the quick brown fox jumped very high", but in Doc 1 all the
: terms are indexed at the same position. In doc 2, the terms are indexed in
: adjacent positions (normal way). For the query "the quick brown fox", doc 1
: will score higher than doc 2 because the sloppyFreq = 1/2 for doc 1 and 1/5
: for doc 2. So, the term frequency factor for the score takes into account
: both the number of matching terms and the distance between them.
: 
: This is fine for most span queries with more than 1 term (i guess), but  I'd
: still suggest that a simple SpanTermQuery should behave more like TermQuery

I don't disagree with you ... that's why i said...

>> I suppose SpanTermQuery could override the weight/scorer methods so 
>> that it behaved more like a TermQuery if it was executed directly ... 

...especially since BoostingTermQuery subclasses SpanTermQuery.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39501-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 03 23:25:09 2009
Return-Path: <java-user-return-39501-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49685 invoked from network); 3 Apr 2009 23:25:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Apr 2009 23:25:09 -0000
Received: (qmail 30560 invoked by uid 500); 3 Apr 2009 23:25:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30526 invoked by uid 500); 3 Apr 2009 23:25:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30494 invoked by uid 99); 3 Apr 2009 23:25:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 23:25:05 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.198.232 as permitted sender)
Received: from [209.85.198.232] (HELO rv-out-0506.google.com) (209.85.198.232)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 03 Apr 2009 23:24:56 +0000
Received: by rv-out-0506.google.com with SMTP id g9so1235984rvb.5
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 16:24:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=X4k2/UXYQYqlLMLWetVp5bkxcnMKnlQW06IRNNlI3UU=;
        b=UFVzdQtj7055U7tKgnzmL5xngDQ9+pcB7vTxEUXBpIOvsgVQzhco0GHO0M41nStlgJ
         jtktsPH31onb+f7GsrZ/ik52CkPLKebvDvAAVnnSdKLoXSa23i9sNHuJ0uVqLXwirNXA
         uaoBqorHwt8j8k88F06quboHEpekwN+WSTNfM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=DdXN2Occir8F74/lM//UnF3glaDvc+KyfgvgAMfwJjHZRPDzdpv2fO/Ms6Ki+pSM/q
         oGTYc7l+0q37KaABBg/rCEXH228Rgyj7x3b3AMn5ytf5mlbI7wBaMI21QIcsULIrSeo7
         l5BIJBLFjxp0QrMHBjk41WDZL/qkzJ/AP2YNM=
MIME-Version: 1.0
Received: by 10.141.177.12 with SMTP id e12mr5236rvp.246.1238801075664; Fri, 
	03 Apr 2009 16:24:35 -0700 (PDT)
In-Reply-To: <003e01c9b48f$f9990d50$eccb27f0$@com>
References: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com>
	 <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com>
	 <1B69876F-6C87-4A1A-8A02-55A4808221B5@zappos.com>
	 <003e01c9b48f$f9990d50$eccb27f0$@com>
Date: Fri, 3 Apr 2009 16:24:35 -0700
Message-ID: <8837fb770904031624m227c17bek62db1f3a0d7e809e@mail.gmail.com>
Subject: Re: Autonomy search technology
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1d09c0ff66a0466aedaa6
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1d09c0ff66a0466aedaa6
Content-Type: text/plain; charset=ISO-8859-2
Content-Transfer-Encoding: quoted-printable

Not quite.For example,  # of fields is static thru out the corpus. # zones
is per document. E.g. let's say you have 1 million docs, some docs have 2
paragraphs, some 1, and some 10000. You want to limit your search two
paragraph 13. How many fields do you create? What if you add a document wit=
h
500000 paragraphs, do you create 500000 fields just for that document?

-John

2009/4/3 Digy <digydigy@gmail.com>

> As far as I can remember, "Zone" in Verity is similar to "field" in Lucen=
e
> and verity performs searches on all "zones" by default.
>
> DIGY
>
> -----Original Message-----
> From: Matthew Runo [mailto:mruno@zappos.com]
> Sent: Friday, April 03, 2009 9:08 PM
> To: java-user@lucene.apache.org
> Subject: Re: Autonomy search technology
>
> Would you be willing to explain what "zone search" is? I did a quick
> google search, but came up empty handed.
>
> Thanks for your time!
>
> Matthew Runo
> Software Engineer, Zappos.com
> mruno@zappos.com - 702-943-7833
>
> On Apr 3, 2009, at 10:08 AM, John Wang wrote:
>
> > Verity VDK, which was bought by autonomy, has zone search. Something
> > lucene
> > currently does not support.
> >
> > We have implemented it ontop of lucene and thinking about
> > contributing.
> >
> > -John
> >
> > On Fri, Apr 3, 2009 at 8:56 AM, Luk=E1=B9 Vl=E8ek <lukas.vlcek@gmail.co=
m>
> > wrote:
> >
> >> Hi,
> >> anybody has experience with Automony search technology (
> >> http://en.wikipedia.org/wiki/Autonomy_Corporation)? Speaking about
> >> their
> >> text searching technology is there anything which can not be
> >> achieved using
> >> Lucene?
> >>
> >> Regards,
> >> Lukas
> >>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd1d09c0ff66a0466aedaa6--

From java-user-return-39502-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 02:22:11 2009
Return-Path: <java-user-return-39502-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4800 invoked from network); 4 Apr 2009 02:22:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 02:22:11 -0000
Received: (qmail 27003 invoked by uid 500); 4 Apr 2009 02:22:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26944 invoked by uid 500); 4 Apr 2009 02:22:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26931 invoked by uid 99); 4 Apr 2009 02:22:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 02:22:08 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.123.65.155] (HELO mail2.acquiremedia.com) (209.123.65.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 02:21:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail2.acquiremedia.com (Postfix) with ESMTP id 80A255AC0A3
	for <java-user@lucene.apache.org>; Fri,  3 Apr 2009 22:21:38 -0400 (EDT)
X-Virus-Scanned: amavisd-new at mmu.acquiremedia.com
Received: from mail2.acquiremedia.com ([127.0.0.1])
	by localhost (mail.mmu.acquiremedia.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id dgfToLmuKUIp for <java-user@lucene.apache.org>;
	Fri,  3 Apr 2009 22:21:38 -0400 (EDT)
Received: from exchange.mmu.acquiremedia.com (unknown [10.10.40.251])
	by mail2.acquiremedia.com (Postfix) with ESMTP
	for <java-user@lucene.apache.org>; Fri,  3 Apr 2009 22:21:38 -0400 (EDT)
Received: from exchange.windows.mmu.acquiremedia.com ([10.10.40.251]) by
 exchange.windows.mmu.acquiremedia.com ([10.10.40.251]) with mapi; Fri, 3 Apr
 2009 22:21:38 -0400
From: Dan OConnor <doconnor@acquiremedia.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 3 Apr 2009 22:21:35 -0400
Subject: simultaneous indexing and searching causing intermitently long
 searches.
Thread-Topic: simultaneous indexing and searching causing intermitently long
 searches.
Thread-Index: Acm0zBOAwiFes8odTNGwU8qjEQMBJg==
Message-ID: <24098ED350C76D46A4FDBD81B51BE0E903548EC203@exchange.windows.mmu.acquiremedia.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_000_24098ED350C76D46A4FDBD81B51BE0E903548EC203exchangewindo_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_24098ED350C76D46A4FDBD81B51BE0E903548EC203exchangewindo_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

All,

I have a several questions regarding query response time and I would apprec=
iate any help that can be provided.

We have a system that indexes approximately 200,000 documents per day at a =
fairly constant rate and holds them in a cfs-style file system directory in=
dex for 8 days. The index is approximately 50 GBs when optimized - which we=
 do semi-monthly.

We are running lucene 2.3.2 with jre 1.6. 0_10 on Centos5 on 64-bit Dell 29=
50s - 3GHz dual/quad core processors with local ext3 Raid-5 15k disks (appr=
oximately 1.7TBs) The box has 16GB and the JVM is allocated 11G (both Xms a=
nd Xmx)

Every 15 minutes, we flush the IndexWriter and create a new IndexSearcher t=
o expose the newly indexed content.

Every hour, approximately 1 hours worth of content (approximately 8,000 doc=
uments) is deleted, we flush the IndexWriter, and create a new IndexSearche=
r.

Q1: Given these settings, are there general rules of thumb for setting the =
MergeFactor, MaxMergeDocs, MaxBufferedDocs, and RAMBufferSizeMB?

We do a series of warm up searches every time we create a new IndexSearcher=
. Right now we are directly calling the IndexSearcher.search() method with =
a query, null filter, and 10 documents to return. We run searches against a=
ll of the index fields.

Q1: Are there any rules of thumb for the number or complexity of warm up se=
arches?
Q2: Is it important to "warmup" the query parser, analyzer, etc or the rang=
es we use in queries or the sorting?

When the system is receiving regular queries, between 1 and 5 per second fo=
r example, the search response times are extremely fast (sub 500ms) and mos=
tly independent of query complexity. We see slower query responses (on the =
order of 2-4 seconds) for the first few queries  when using a newly created=
 IndexSearcher. However, the extremely fast response times return quickly a=
nd continue.

When the system has not received any search requests for a period of time, =
as little as 5 seconds, the query response time for even a simple query sta=
rts climbing (5 -8 seconds) and the longer the idle period between queries,=
 the longer the query response time (growing to 15-30 seconds if the idle t=
ime is 30seconds to a minute). NOTE: the system is still indexing new conte=
nt and removing old content when there are no incoming queries.

Q3: Is there a known issue where the IndexSearcher cache empties over time?

Finally, there are times when the query response times completely go off th=
e charts - to 100s of seconds.

Q4: Is it possible that this is due to segments being merged together? If s=
o, besides the MergeFactor, etc. settings are there ways to mitigate this?

Thanks in advance for any help you can provide.

Regards,
Dan

Dan O'Connor
SVP, Engineering
Acquire Media<http://www.acquiremedia.com/>
77 South Bedford Street, Suite 350<http://maps.google.com/maps?f=3Dq&hl=3De=
n&geocode=3D&q=3D77+S+Bedford+St,+Burlington,+MA+01803&sll=3D37.0625,-95.67=
7068&sspn=3D32.472848,80.859375&ie=3DUTF8&ll=3D42.485517,-71.197935&spn=3D0=
.002287,0.005193&t=3Dh&z=3D18>
Burlington, MA 01803<http://maps.google.com/maps?f=3Dq&hl=3Den&geocode=3D&q=
=3D77+S+Bedford+St,+Burlington,+MA+01803&sll=3D37.0625,-95.677068&sspn=3D32=
.472848,80.859375&ie=3DUTF8&ll=3D42.485517,-71.197935&spn=3D0.002287,0.0051=
93&t=3Dh&z=3D18>
e: doconnor@acquiremedia.com<mailto:doconnor@acquiremedia.com>
o: 781-250-0565
f: 877-861-7724



--_000_24098ED350C76D46A4FDBD81B51BE0E903548EC203exchangewindo_--

From java-user-return-39503-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 03:05:16 2009
Return-Path: <java-user-return-39503-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10768 invoked from network); 4 Apr 2009 03:05:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 03:05:16 -0000
Received: (qmail 42528 invoked by uid 500); 4 Apr 2009 03:05:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42440 invoked by uid 500); 4 Apr 2009 03:05:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42430 invoked by uid 99); 4 Apr 2009 03:05:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 03:05:12 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of pjaol@pjaol.com)
Received: from [74.125.44.28] (HELO yx-out-2324.google.com) (74.125.44.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 03:05:02 +0000
Received: by yx-out-2324.google.com with SMTP id 8so815271yxb.5
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 20:04:39 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.92.10 with SMTP id p10mr2113385ybb.196.1238814279141; Fri, 
	03 Apr 2009 20:04:39 -0700 (PDT)
In-Reply-To: <52c3ddca0904031043p65e52449s922022457ddf723f@mail.gmail.com>
References: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com>
	 <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com>
	 <52c3ddca0904031043p65e52449s922022457ddf723f@mail.gmail.com>
Date: Fri, 3 Apr 2009 23:04:39 -0400
Message-ID: <1e33aedb0904032004k3806b760pa5d832e69caf1191@mail.gmail.com>
Subject: Re: Autonomy search technology
From: "patrick o'leary" <pjaol@pjaol.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd402dc0d096f0466b1ed36
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd402dc0d096f0466b1ed36
Content-Type: text/plain; charset=ISO-8859-2
Content-Transfer-Encoding: quoted-printable

I think you need to ask the question what do you want?

A person asked me one, which is better, a gold pen fountain pen or a plasti=
c
bic pen?
The answer - depends
If you want the most fluid writing instrument, which gives you a certain
level of accomplishment as you use it, and looks superb then the gold pen i=
s
the answer.

If however, you want a pen to use in the office, that just takes notes, you
don't have to
worry about chewing the top off, and aren't overly concerned about loosing
it going from meeting to meeting then the plastic pen is what you want.

Autonomy has a significant amount of predefined indexing, predictive search=
,
and matching capabilities.
Lucene is open source and capable of providing basic to complex search
systems, but requires elbow grease to make it happen.

Autonomy comes with commercial support
Lucene has folks who will provide the same, but if you are will to do the
work you can get some support for free from an established community.

Autonomy looks like a superb product, but seems to have a significant price
tag
Lucene is free...

Autonomy locks you into a proprietary product, with limited pool of
experienced employees to hire from...
Lucene probably has x100 times the amount of people you can hire to work on
your projects, and as it's open source, it requires little to no training t=
o
bring java skilled engineers up to speed on it.

The real question is, what are you looking for, and what best suits the
commitment level of your group?



On Fri, Apr 3, 2009 at 1:43 PM, Luk=E1=B9 Vl=E8ek <lukas.vlcek@gmail.com> w=
rote:

> So it means that autonomy search solution is doing better out of the box
> then any solution based on Lucene right now? And bringing Lucene based
> solution at the same level would require additional investments and
> non-trivial development (probably not small). In other words if client is
> using autonomy then it makes no sense to migrate to Lucene...Hmmm... grea=
t
> pity.
>
> Thanks,
> Lukas
>
> 2009/4/3 John Wang <john.wang@gmail.com>
>
> > Verity VDK, which was bought by autonomy, has zone search. Something
> lucene
> > currently does not support.
> >
> > We have implemented it ontop of lucene and thinking about contributing.
> >
> > -John
> >
> > On Fri, Apr 3, 2009 at 8:56 AM, Luk=E1=B9 Vl=E8ek <lukas.vlcek@gmail.co=
m>
> wrote:
> >
> > > Hi,
> > > anybody has experience with Automony search technology (
> > > http://en.wikipedia.org/wiki/Autonomy_Corporation)? Speaking about
> their
> > > text searching technology is there anything which can not be achieved
> > using
> > > Lucene?
> > >
> > > Regards,
> > > Lukas
> > >
> >
>
>
>
> --
> http://blog.lukas-vlcek.com/
>

--000e0cd402dc0d096f0466b1ed36--

From java-user-return-39504-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 04:04:40 2009
Return-Path: <java-user-return-39504-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20627 invoked from network); 4 Apr 2009 04:04:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 04:04:40 -0000
Received: (qmail 64355 invoked by uid 500); 4 Apr 2009 04:04:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64275 invoked by uid 500); 4 Apr 2009 04:04:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64265 invoked by uid 99); 4 Apr 2009 04:04:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 04:04:37 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of shashi.mit@gmail.com designates 209.85.217.164 as permitted sender)
Received: from [209.85.217.164] (HELO mail-gx0-f164.google.com) (209.85.217.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 04:04:27 +0000
Received: by gxk8 with SMTP id 8so3076460gxk.5
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 21:04:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=lsSia2wX2LObY9kqA0Wgx3J82S5d7rjUy/U2XFzUi7o=;
        b=maUe/qN+ecJUrYVNBqeVdkU3UNQqtYsjmO5os/IunP0h8xIsPlEr6TQBNPUXRexd9p
         3MDzLS7GMKNs9qRpJrxJmpwnZ8cnz9oVnV1clVHmo1FCaFoBC5ChAWGSD1t+ElPbLYWS
         umpA8X/xX/Tw1tWBEopb3ehj9XUfrWQlgcGTY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=iPbsJ97jQyupKQRyaangRZt+9sZ+yM/oDiFVYH6IIMCbRiTkbgybBQmU8C+07X6S46
         yXHdK18RgYKA+GAjPKUkIzOQ49j/bcxO1f0D5tlECQcXURLkyC0KLhVitBP2is9bUsvC
         NPLb5j8NOFs7o7S/OTYEN9KgqmpBtTGuKpPjY=
MIME-Version: 1.0
Received: by 10.150.211.4 with SMTP id j4mr77218ybg.42.1238817846440; Fri, 03 
	Apr 2009 21:04:06 -0700 (PDT)
In-Reply-To: <1e33aedb0904032004k3806b760pa5d832e69caf1191@mail.gmail.com>
References: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com>
	 <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com>
	 <52c3ddca0904031043p65e52449s922022457ddf723f@mail.gmail.com>
	 <1e33aedb0904032004k3806b760pa5d832e69caf1191@mail.gmail.com>
Date: Sat, 4 Apr 2009 00:04:06 -0400
Message-ID: <4d19a3630904032104v2434cbe8lcb9c50be329db382@mail.gmail.com>
Subject: Re: Autonomy search technology
From: Shashi Kant <shashi.mit@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd48650adc71f0466b2c139
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd48650adc71f0466b2c139
Content-Type: text/plain; charset=ISO-8859-2
Content-Transfer-Encoding: quoted-printable

Hmm..not sure I would call Autonomy a "superb product". IMHO It is anything
but. In fact, it is what one calls bloat-ware.I have had some experience
with Autonomy and it is hardly something you should consider using unless
you are eager to shoot yourself in the foot. I fundamentally disagree with
Patrick's characterization as a "superb product".  My experiences are far
from it. Overall, I would apply that experience to most of the COTS such as
FAST (MS), Endeca et al.

I would much rather work with a tool that I can tweak and customize freely
without being asked to pay through my nose for every tiny thing.

Hope that helps,
Shashi



2009/4/3 patrick o'leary <pjaol@pjaol.com>

> I think you need to ask the question what do you want?
>
> A person asked me one, which is better, a gold pen fountain pen or a
> plastic
> bic pen?
> The answer - depends
> If you want the most fluid writing instrument, which gives you a certain
> level of accomplishment as you use it, and looks superb then the gold pen
> is
> the answer.
>
> If however, you want a pen to use in the office, that just takes notes, y=
ou
> don't have to
> worry about chewing the top off, and aren't overly concerned about loosin=
g
> it going from meeting to meeting then the plastic pen is what you want.
>
> Autonomy has a significant amount of predefined indexing, predictive
> search,
> and matching capabilities.
> Lucene is open source and capable of providing basic to complex search
> systems, but requires elbow grease to make it happen.
>
> Autonomy comes with commercial support
> Lucene has folks who will provide the same, but if you are will to do the
> work you can get some support for free from an established community.
>
> Autonomy looks like a superb product, but seems to have a significant pri=
ce
> tag
> Lucene is free...
>
> Autonomy locks you into a proprietary product, with limited pool of
> experienced employees to hire from...
> Lucene probably has x100 times the amount of people you can hire to work =
on
> your projects, and as it's open source, it requires little to no training
> to
> bring java skilled engineers up to speed on it.
>
> The real question is, what are you looking for, and what best suits the
> commitment level of your group?
>
>
>
> On Fri, Apr 3, 2009 at 1:43 PM, Luk=E1=B9 Vl=E8ek <lukas.vlcek@gmail.com>=
 wrote:
>
> > So it means that autonomy search solution is doing better out of the bo=
x
> > then any solution based on Lucene right now? And bringing Lucene based
> > solution at the same level would require additional investments and
> > non-trivial development (probably not small). In other words if client =
is
> > using autonomy then it makes no sense to migrate to Lucene...Hmmm...
> great
> > pity.
> >
> > Thanks,
> > Lukas
> >
> > 2009/4/3 John Wang <john.wang@gmail.com>
> >
> > > Verity VDK, which was bought by autonomy, has zone search. Something
> > lucene
> > > currently does not support.
> > >
> > > We have implemented it ontop of lucene and thinking about contributin=
g.
> > >
> > > -John
> > >
> > > On Fri, Apr 3, 2009 at 8:56 AM, Luk=E1=B9 Vl=E8ek <lukas.vlcek@gmail.=
com>
> > wrote:
> > >
> > > > Hi,
> > > > anybody has experience with Automony search technology (
> > > > http://en.wikipedia.org/wiki/Autonomy_Corporation)? Speaking about
> > their
> > > > text searching technology is there anything which can not be achiev=
ed
> > > using
> > > > Lucene?
> > > >
> > > > Regards,
> > > > Lukas
> > > >
> > >
> >
> >
> >
> > --
> > http://blog.lukas-vlcek.com/
> >
>

--000e0cd48650adc71f0466b2c139--

From java-user-return-39505-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 06:15:58 2009
Return-Path: <java-user-return-39505-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60937 invoked from network); 4 Apr 2009 06:15:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 06:15:58 -0000
Received: (qmail 98465 invoked by uid 500); 4 Apr 2009 06:15:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98383 invoked by uid 500); 4 Apr 2009 06:15:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98373 invoked by uid 99); 4 Apr 2009 06:15:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 06:15:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of kmisoft@gmail.com designates 209.85.218.166 as permitted sender)
Received: from [209.85.218.166] (HELO mail-bw0-f166.google.com) (209.85.218.166)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 06:15:44 +0000
Received: by bwz10 with SMTP id 10so1365811bwz.5
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 23:15:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=H12aqFo9CWnFSGHPMIgR0aUml/UeZXXOLGTtx5SEuIg=;
        b=dEn+4tJuiz3MKeqL5ZpTIXwXHlE48h+6RsPaYmNf15GFVfZV788fLLHF061mJE6h5n
         JFE9nPawpMUj9ILYvbl+BZt1ssktdXQB2ciBL3YP0QFSs0+ByWSaXDD8P+DfcDaxt8/8
         WzPTG+VZqoqAZTs7ytrprEtN6fKlnyQX6vYwU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=ivWzRQ65VMup1K4ZAKOlHwgKNgtlhmpdsD1ehg0j+p2JFcsYu/IXex7s1puyxVttQ5
         lYG+DwVwt4IX+A9/tWHdiMXJwmggsUYHUCdicFTV8gZyKe2rIoZgVbMXZuSXzhQBmXGk
         qAKS+6no1y0mX+WCeNTLYpt3xB1cMjkWPkeDw=
MIME-Version: 1.0
Received: by 10.204.116.9 with SMTP id k9mr698615bkq.159.1238825723011; Fri, 
	03 Apr 2009 23:15:23 -0700 (PDT)
In-Reply-To: <4d19a3630904032104v2434cbe8lcb9c50be329db382@mail.gmail.com>
References: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com>
	 <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com>
	 <52c3ddca0904031043p65e52449s922022457ddf723f@mail.gmail.com>
	 <1e33aedb0904032004k3806b760pa5d832e69caf1191@mail.gmail.com>
	 <4d19a3630904032104v2434cbe8lcb9c50be329db382@mail.gmail.com>
Date: Sat, 4 Apr 2009 10:15:22 +0400
Message-ID: <c02acca20904032315x323ea54ahcc7bb7322a5722e3@mail.gmail.com>
Subject: Re: Autonomy search technology
From: Vladimir Ignatov <kmisoft@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Here is at yellopages/rus (yell.ru) we switch from FAST to Lucene. I
am HAPPY about it. Sometimes FAST was a nightmare to work with.
Non-working features, obscure bugs, thousands of non-documented
settings, slow, lazy and dumb techsupport... Not mention it's
ridiculous price and very limiting license (you are limited with a
fixed number of queries/sec).  And yes, if you want to do something
not completely trivial, you have to cont(r)act FAST solution
department and buy the solution.

Vladimir Ignatov


2009/4/4 Shashi Kant <shashi.mit@gmail.com>:
> Hmm..not sure I would call Autonomy a "superb product". IMHO It is anythi=
ng
> but. In fact, it is what one calls bloat-ware.I have had some experience
> with Autonomy and it is hardly something you should consider using unless
> you are eager to shoot yourself in the foot. I fundamentally disagree wit=
h
> Patrick's characterization as a "superb product". =A0My experiences are f=
ar
> from it. Overall, I would apply that experience to most of the COTS such =
as
> FAST (MS), Endeca et al.
>
> I would much rather work with a tool that I can tweak and customize freel=
y
> without being asked to pay through my nose for every tiny thing.
>
> Hope that helps,
> Shashi

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39506-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 06:57:16 2009
Return-Path: <java-user-return-39506-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83393 invoked from network); 4 Apr 2009 06:57:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 06:57:16 -0000
Received: (qmail 14106 invoked by uid 500); 4 Apr 2009 06:57:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14018 invoked by uid 500); 4 Apr 2009 06:57:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14008 invoked by uid 99); 4 Apr 2009 06:57:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 06:57:12 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of deminix@gmail.com designates 74.125.92.27 as permitted sender)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 06:57:04 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1066569qwh.53
        for <java-user@lucene.apache.org>; Fri, 03 Apr 2009 23:56:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=wK+CBn4T1cFnSLCA9yK/K17u9V7MEIoek9+FWEBTJLA=;
        b=gjWxU6kViA11Q+Ruqw/z6VS372cSDzaAexXJ9sn7IyGk+cc3N3Dj7ic708jlYc6UjX
         xzPCNbYFunnbXL8mNmEBHGS1T1F4qEDQD/d1irJiryl/9oPG5zjdblHSGDy5LvSOcQmZ
         LlgiU9hBMPrv/wcdbhGgnk2ILm6AKQ81Lw9VE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=mzNV3Jq+hxvx/6OKtaZ1ECdml+TGAKp5ntwCGAxi7U67l6oQl2/XIWdRv1pDo1JBfI
         psYim0uch1dW9YQhdKGpBDXktBOD7xHWFzlgDcHfkJpCiuht1SalC4kHL2RuY5JYf+t2
         B88r0cnYcDppE2tN1LyDB2+SJA94+/BhPAo8U=
MIME-Version: 1.0
Received: by 10.229.89.146 with SMTP id e18mr585506qcm.23.1238828203859; Fri, 
	03 Apr 2009 23:56:43 -0700 (PDT)
Date: Fri, 3 Apr 2009 23:56:43 -0700
Message-ID: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
Subject: Term Limit?
From: deminix <deminix@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364ee4e60761f20466b52b7e
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364ee4e60761f20466b52b7e
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

http://lucene.apache.org/java/2_4_1/fileformats.html

The file format page at the bottom cites that there is a 32 bit limit to
term numbers.  I fail to see where in the file formats documentation that is
actually true.  Is the bottom of the page simply out of date?  I'm also
wondering whether the code may be a limiting factor even if the file formats
are ok.

Thanks.

--0016364ee4e60761f20466b52b7e--

From java-user-return-39507-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 10:04:25 2009
Return-Path: <java-user-return-39507-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46185 invoked from network); 4 Apr 2009 10:04:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 10:04:25 -0000
Received: (qmail 69388 invoked by uid 500); 4 Apr 2009 10:04:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69291 invoked by uid 500); 4 Apr 2009 10:04:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69281 invoked by uid 99); 4 Apr 2009 10:04:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 10:04:22 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.198.234] (HELO rv-out-0506.google.com) (209.85.198.234)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 10:04:14 +0000
Received: by rv-out-0506.google.com with SMTP id g9so1358128rvb.5
        for <java-user@lucene.apache.org>; Sat, 04 Apr 2009 03:03:52 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.177.13 with SMTP id z13mr603532wfe.331.1238839432582; Sat, 
	04 Apr 2009 03:03:52 -0700 (PDT)
In-Reply-To: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
References: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
Date: Sat, 4 Apr 2009 06:03:52 -0400
Message-ID: <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
Subject: Re: Term Limit?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I tentatively think you are correct: the file format itself does not
impose this limitation.

But in a least a couple places internally, Lucene uses a java int to
hold the term number, which is actually a limit of 2,147,483,648
terms.  I'll update fileformats.html for 2.9.

Mike

On Sat, Apr 4, 2009 at 2:56 AM, deminix <deminix@gmail.com> wrote:
> http://lucene.apache.org/java/2_4_1/fileformats.html
>
> The file format page at the bottom cites that there is a 32 bit limit to
> term numbers. =A0I fail to see where in the file formats documentation th=
at is
> actually true. =A0Is the bottom of the page simply out of date? =A0I'm al=
so
> wondering whether the code may be a limiting factor even if the file form=
ats
> are ok.
>
> Thanks.
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39508-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 10:38:56 2009
Return-Path: <java-user-return-39508-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56217 invoked from network); 4 Apr 2009 10:38:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 10:38:55 -0000
Received: (qmail 82259 invoked by uid 500); 4 Apr 2009 10:38:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82176 invoked by uid 500); 4 Apr 2009 10:38:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82166 invoked by uid 99); 4 Apr 2009 10:38:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 10:38:53 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.170] (HELO wf-out-1314.google.com) (209.85.200.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 10:38:46 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1488386wff.20
        for <java-user@lucene.apache.org>; Sat, 04 Apr 2009 03:38:24 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.218.4 with SMTP id q4mr615593wfg.225.1238841504809; Sat, 
	04 Apr 2009 03:38:24 -0700 (PDT)
In-Reply-To: <24098ED350C76D46A4FDBD81B51BE0E903548EC203@exchange.windows.mmu.acquiremedia.com>
References: <24098ED350C76D46A4FDBD81B51BE0E903548EC203@exchange.windows.mmu.acquiremedia.com>
Date: Sat, 4 Apr 2009 06:38:24 -0400
Message-ID: <9ac0c6aa0904040338x53f46415l6c7ab8000f2c84c6@mail.gmail.com>
Subject: Re: simultaneous indexing and searching causing intermitently long 
	searches.
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 3, 2009 at 10:21 PM, Dan OConnor <doconnor@acquiremedia.com> wr=
ote:
> All,
>
> I have a several questions regarding query response time and I would appr=
eciate any help that can be provided.
>
> We have a system that indexes approximately 200,000 documents per day at =
a fairly constant rate and holds them in a cfs-style file system directory =
index for 8 days. The index is approximately 50 GBs when optimized - which =
we do semi-monthly.
>
> We are running lucene 2.3.2 with jre 1.6. 0_10 on Centos5 on 64-bit Dell =
2950s - 3GHz dual/quad core processors with local ext3 Raid-5 15k disks (ap=
proximately 1.7TBs) The box has 16GB and the JVM is allocated 11G (both Xms=
 and Xmx)

With such a large heap, I would watch the GC times closely.  Turn on
verbose GC and see what's happening, when.  There have been threads
recently around how to tune the JRE's GC when using such a large heap.

> Every 15 minutes, we flush the IndexWriter and create a new IndexSearcher=
 to expose the newly indexed content.

Are you using reopen() to open the new reader?

> Every hour, approximately 1 hours worth of content (approximately 8,000 d=
ocuments) is deleted, we flush the IndexWriter, and create a new IndexSearc=
her.
>
> Q1: Given these settings, are there general rules of thumb for setting th=
e MergeFactor, MaxMergeDocs, MaxBufferedDocs, and RAMBufferSizeMB?

Large maxRamBufferSizeMB.  I would keep mergeFactor smallish (<=3D
10)... it means more frequent merges, but possibly less IO saturation.
 You should experiment...

The lack of IO prioritization from Java (and really from the OS) is a
big problem.  We have no way to tell the OS that the IO being done for
a merge is very low priority.

> We do a series of warm up searches every time we create a new IndexSearch=
er. Right now we are directly calling the IndexSearcher.search() method wit=
h a query, null filter, and 10 documents to return. We run searches against=
 all of the index fields.
>
> Q1: Are there any rules of thumb for the number or complexity of warm up =
searches?

The goal is to warm Lucene's internal caches (norms & field cache).
So run one search per field that's searchable (loads the norms), and
one search per sorted field (loads field cache).

A secondary goal may be to warm the OS's IO cache, though that's
trickier because you'd need to track the common and large terms that
need to be queried.  I believe Solr does this (carries over its query
cache to the warmed reader), but I'm not certain.

Note that by far the biggest bang for you bug is to switch to a solid
state device to hold your index. EG Fusion IO's devices are insanely
fast.

Note that 2.9 has some performance improvements on the warm
performance after reopen, if you use field sort.

> Q2: Is it important to "warmup" the query parser, analyzer, etc or the ra=
nges we use in queries or the sorting?

Not important -- only the IndexReader needs warming.

> When the system is receiving regular queries, between 1 and 5 per second =
for example, the search response times are extremely fast (sub 500ms) and m=
ostly independent of query complexity. We see slower query responses (on th=
e order of 2-4 seconds) for the first few queries =A0when using a newly cre=
ated IndexSearcher. However, the extremely fast response times return quick=
ly and continue.
>
> When the system has not received any search requests for a period of time=
, as little as 5 seconds, the query response time for even a simple query s=
tarts climbing (5 -8 seconds) and the longer the idle period between querie=
s, the longer the query response time (growing to 15-30 seconds if the idle=
 time is 30seconds to a minute). NOTE: the system is still indexing new con=
tent and removing old content when there are no incoming queries.

You should try to watch your process, eg with top, to see if the OS is
moving pages out in favor of populating the system's IO cache.  Watch
for page faults when you see a slow query happening. If so, there's a
linux kernel parameter called "swapiness" that you should tune to
prevent swapout (though I'm not certain if CentOS exposes it; I would
assume so).

It's also possible the slowness comes from the OS swapping out the IO
cache for those queries' posting lists, in which case an SSD device
should solve it.

> Q3: Is there a known issue where the IndexSearcher cache empties over tim=
e?

IndexSearcher doesn't free its caches, but the OS may.

> Finally, there are times when the query response times completely go off =
the charts - to 100s of seconds.

Gotta watch with top to see what's happening then.

> Q4: Is it possible that this is due to segments being merged together? If=
 so, besides the MergeFactor, etc. settings are there ways to mitigate this=
?

Yes this is possible.  Turn on IndexWriter.setInfoStream to see if you
can correlate massively slow queries with ongoing merging.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39509-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 11:55:45 2009
Return-Path: <java-user-return-39509-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83973 invoked from network); 4 Apr 2009 11:55:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 11:55:45 -0000
Received: (qmail 16726 invoked by uid 500); 4 Apr 2009 11:55:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16673 invoked by uid 500); 4 Apr 2009 11:55:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16663 invoked by uid 99); 4 Apr 2009 11:55:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 11:55:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Murat.Yakici@cis.strath.ac.uk designates 130.159.196.96 as permitted sender)
Received: from [130.159.196.96] (HELO smtphost.cis.strath.ac.uk) (130.159.196.96)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 11:55:35 +0000
Received: from webmail.cis.strath.ac.uk (www-data@ramsay.cis.strath.ac.uk [130.159.196.85])
	by arnott.cis.strath.ac.uk (8.14.2/8.14.2/Debian-2build1) with ESMTP id n34Bt7X2020689
	for <java-user@lucene.apache.org>; Sat, 4 Apr 2009 12:55:07 +0100
Received: from 93.97.155.28
        (SquirrelMail authenticated user murat)
        by webmail.cis.strath.ac.uk with HTTP;
        Sat, 4 Apr 2009 12:55:10 +0100 (BST)
Message-ID: <52193.93.97.155.28.1238846110.squirrel@webmail.cis.strath.ac.uk>
In-Reply-To: <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
References: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
    <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
Date: Sat, 4 Apr 2009 12:55:10 +0100 (BST)
Subject: Re: Term Limit?
From: "Murat Yakici" <Murat.Yakici@cis.strath.ac.uk>
To: java-user@lucene.apache.org
User-Agent: SquirrelMail/1.4.13
MIME-Version: 1.0
Content-Type: text/plain;charset=iso-8859-15
Content-Transfer-Encoding: 8bit
X-Priority: 3 (Normal)
Importance: Normal
X-CIS-MailScanner-SpamCheck: SpamAssassin score=-1.44, ALL_TRUSTED
X-Scanned-By: MIMEDefang on 130.159.196.96
X-Virus-Checked: Checked by ClamAV on apache.org


I assume the total number of documents that you can index is also limited
by Java max int. Is this correct? Is there any way to index documents
beyond this number in a single index?

Murat


> I tentatively think you are correct: the file format itself does not
> impose this limitation.
>
> But in a least a couple places internally, Lucene uses a java int to
> hold the term number, which is actually a limit of 2,147,483,648
> terms.  I'll update fileformats.html for 2.9.


>
> Mike
>
> On Sat, Apr 4, 2009 at 2:56 AM, deminix <deminix@gmail.com> wrote:
>> http://lucene.apache.org/java/2_4_1/fileformats.html
>>
>> The file format page at the bottom cites that there is a 32 bit limit to
>> term numbers. I fail to see where in the file formats documentation
>> that is
>> actually true. Is the bottom of the page simply out of date? I'm also
>> wondering whether the code may be a limiting factor even if the file
>> formats
>> are ok.
>>
>> Thanks.
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


Murat Yakici
Department of Computer & Information Sciences
University of Strathclyde
Glasgow, UK
-------------------------------------------
The University of Strathclyde is a charitable body, registered in Scotland,
with registration number SC015263.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39510-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 12:23:11 2009
Return-Path: <java-user-return-39510-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2689 invoked from network); 4 Apr 2009 12:23:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 12:23:10 -0000
Received: (qmail 28025 invoked by uid 500); 4 Apr 2009 12:23:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27939 invoked by uid 500); 4 Apr 2009 12:23:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27929 invoked by uid 99); 4 Apr 2009 12:23:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 12:23:08 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.168] (HELO wf-out-1314.google.com) (209.85.200.168)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 12:23:01 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1505526wff.20
        for <java-user@lucene.apache.org>; Sat, 04 Apr 2009 05:22:40 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.7.5 with SMTP id k5mr642890wfi.176.1238847760158; Sat, 04 
	Apr 2009 05:22:40 -0700 (PDT)
In-Reply-To: <52193.93.97.155.28.1238846110.squirrel@webmail.cis.strath.ac.uk>
References: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
	 <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
	 <52193.93.97.155.28.1238846110.squirrel@webmail.cis.strath.ac.uk>
Date: Sat, 4 Apr 2009 08:22:40 -0400
Message-ID: <9ac0c6aa0904040522w53ddee63m25220b301bc0204e@mail.gmail.com>
Subject: Re: Term Limit?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Correct, and, not that I know of.

Mike

On Sat, Apr 4, 2009 at 7:55 AM, Murat Yakici
<Murat.Yakici@cis.strath.ac.uk> wrote:
>
> I assume the total number of documents that you can index is also limited
> by Java max int. Is this correct? Is there any way to index documents
> beyond this number in a single index?
>
> Murat
>
>
>> I tentatively think you are correct: the file format itself does not
>> impose this limitation.
>>
>> But in a least a couple places internally, Lucene uses a java int to
>> hold the term number, which is actually a limit of 2,147,483,648
>> terms. =A0I'll update fileformats.html for 2.9.
>
>
>>
>> Mike
>>
>> On Sat, Apr 4, 2009 at 2:56 AM, deminix <deminix@gmail.com> wrote:
>>> http://lucene.apache.org/java/2_4_1/fileformats.html
>>>
>>> The file format page at the bottom cites that there is a 32 bit limit t=
o
>>> term numbers. =A0I fail to see where in the file formats documentation
>>> that is
>>> actually true. =A0Is the bottom of the page simply out of date? =A0I'm =
also
>>> wondering whether the code may be a limiting factor even if the file
>>> formats
>>> are ok.
>>>
>>> Thanks.
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> Murat Yakici
> Department of Computer & Information Sciences
> University of Strathclyde
> Glasgow, UK
> -------------------------------------------
> The University of Strathclyde is a charitable body, registered in Scotlan=
d,
> with registration number SC015263.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39511-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 14:26:27 2009
Return-Path: <java-user-return-39511-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65752 invoked from network); 4 Apr 2009 14:26:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 14:26:27 -0000
Received: (qmail 88250 invoked by uid 500); 4 Apr 2009 14:26:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88152 invoked by uid 500); 4 Apr 2009 14:26:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88142 invoked by uid 99); 4 Apr 2009 14:26:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 14:26:25 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of deminix@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 14:26:16 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1113625qwh.53
        for <java-user@lucene.apache.org>; Sat, 04 Apr 2009 07:25:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=gz/PGBggW4K+eWWZutjYGxSgSEeuLvfksGWNz2hF7ys=;
        b=Q1nIgIEN3dgphy4fOjkkMlOlYm4wDKfbnT+GFsMgUWjN+HFDHQCvGifdqSz0/nAGWR
         m26nVxo4ZVUwDW895LOaD+NWgnOEJP2ZMmQAJaHJVZyZqcbOfc8YwRlR0Md/hoywLx8i
         RQ0mEMLX58SXUSzHm8DvNq0Z41ZydQ+ZX83VM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=x1gpqJssvJNLMBOJ9hMilpmopitSKfwy/XFFF0pDJbu3YxWEBtx8pKaujzZ5qwDikA
         vnVA3pVNUtt+7sRsBUaKie9oITQBf8f+r2TniTvn1pvge+ec9LxbhoowWEKl1s3NZQFj
         i5FyAkzmSKJ9KHOCt3UMdALU5txQCs5Zg8nuk=
MIME-Version: 1.0
Received: by 10.229.84.5 with SMTP id h5mr636347qcl.25.1238855155672; Sat, 04 
	Apr 2009 07:25:55 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904040522w53ddee63m25220b301bc0204e@mail.gmail.com>
References: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
	 <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
	 <52193.93.97.155.28.1238846110.squirrel@webmail.cis.strath.ac.uk>
	 <9ac0c6aa0904040522w53ddee63m25220b301bc0204e@mail.gmail.com>
Date: Sat, 4 Apr 2009 07:25:55 -0700
Message-ID: <8fdf49110904040725u493d83dby574149d2ab1f90f8@mail.gmail.com>
Subject: Re: Term Limit?
From: deminix <deminix@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364ee5a27b66450466bb713e
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364ee5a27b66450466bb713e
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks for the clarification.

I'm partitioning the document space, so I'm not really concerned about the
fact documents are ints.  Some fields have very unique value spaces though
(and many values per document), and they don't align to the same way the
documents are partitioned so may have a very high number of terms in a
single partition.  I could partition smaller as needed to keep the term
count below 4 billion if I must, but more importantly I'd like to be able to
monitor it.

AFAIK there isn't an api that returns the current number of terms, correct?



On Sat, Apr 4, 2009 at 5:22 AM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> Correct, and, not that I know of.
>
> Mike
>
> On Sat, Apr 4, 2009 at 7:55 AM, Murat Yakici
> <Murat.Yakici@cis.strath.ac.uk> wrote:
> >
> > I assume the total number of documents that you can index is also limited
> > by Java max int. Is this correct? Is there any way to index documents
> > beyond this number in a single index?
> >
> > Murat
> >
> >
> >> I tentatively think you are correct: the file format itself does not
> >> impose this limitation.
> >>
> >> But in a least a couple places internally, Lucene uses a java int to
> >> hold the term number, which is actually a limit of 2,147,483,648
> >> terms.  I'll update fileformats.html for 2.9.
> >
> >
> >>
> >> Mike
> >>
> >> On Sat, Apr 4, 2009 at 2:56 AM, deminix <deminix@gmail.com> wrote:
> >>> http://lucene.apache.org/java/2_4_1/fileformats.html
> >>>
> >>> The file format page at the bottom cites that there is a 32 bit limit
> to
> >>> term numbers.  I fail to see where in the file formats documentation
> >>> that is
> >>> actually true.  Is the bottom of the page simply out of date?  I'm also
> >>> wondering whether the code may be a limiting factor even if the file
> >>> formats
> >>> are ok.
> >>>
> >>> Thanks.
> >>>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> >
> > Murat Yakici
> > Department of Computer & Information Sciences
> > University of Strathclyde
> > Glasgow, UK
> > -------------------------------------------
> > The University of Strathclyde is a charitable body, registered in
> Scotland,
> > with registration number SC015263.
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016364ee5a27b66450466bb713e--

From java-user-return-39512-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 15:45:30 2009
Return-Path: <java-user-return-39512-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88853 invoked from network); 4 Apr 2009 15:45:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 15:45:30 -0000
Received: (qmail 29792 invoked by uid 500); 4 Apr 2009 15:45:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29686 invoked by uid 500); 4 Apr 2009 15:45:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29676 invoked by uid 99); 4 Apr 2009 15:45:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 15:45:28 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.172] (HELO wf-out-1314.google.com) (209.85.200.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 15:45:21 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1540159wff.20
        for <java-user@lucene.apache.org>; Sat, 04 Apr 2009 08:44:59 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.134.20 with SMTP id h20mr680543wfd.342.1238859899735; Sat, 
	04 Apr 2009 08:44:59 -0700 (PDT)
In-Reply-To: <8fdf49110904040725u493d83dby574149d2ab1f90f8@mail.gmail.com>
References: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
	 <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
	 <52193.93.97.155.28.1238846110.squirrel@webmail.cis.strath.ac.uk>
	 <9ac0c6aa0904040522w53ddee63m25220b301bc0204e@mail.gmail.com>
	 <8fdf49110904040725u493d83dby574149d2ab1f90f8@mail.gmail.com>
Date: Sat, 4 Apr 2009 11:44:59 -0400
Message-ID: <9ac0c6aa0904040844m7ffce6f6uc7177e71d86d610b@mail.gmail.com>
Subject: Re: Term Limit?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Sat, Apr 4, 2009 at 10:25 AM, deminix <deminix@gmail.com> wrote:

> AFAIK there isn't an api that returns the current number of terms, correct?

Alas, no.  This limitation has been talked about before... maybe we
should add it.

But: it's not actually simple to compute, at the MultiSegmentReader
level.  Each SegmentReader knows the unique term count, though.

I wonder if we could expose the API, but if you call it on a
MultiSegmentReader, it will throw UnsupportedOperationException.
Instead, you could call getSequentialSubReaders (added in 2.9), and
ask those readers for the unique term count.  Would something like
that work?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39513-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 15:53:08 2009
Return-Path: <java-user-return-39513-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91557 invoked from network); 4 Apr 2009 15:53:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 15:53:07 -0000
Received: (qmail 34474 invoked by uid 500); 4 Apr 2009 15:53:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34386 invoked by uid 500); 4 Apr 2009 15:53:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34376 invoked by uid 99); 4 Apr 2009 15:53:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 15:53:05 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of deminix@gmail.com designates 209.85.221.109 as permitted sender)
Received: from [209.85.221.109] (HELO mail-qy0-f109.google.com) (209.85.221.109)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 15:52:57 +0000
Received: by qyk7 with SMTP id 7so70917qyk.29
        for <java-user@lucene.apache.org>; Sat, 04 Apr 2009 08:52:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=GR8tD29cJi5rqp7SXyvR1iSrSIjZDZTS0dFJy/GVlKw=;
        b=ZyMZET7gK2q2PLkjLp4g7a9wjnKu3GnDqS0BKvV/j17CgrI9I5Um4Aj/skfjpwyLRC
         4NcjkW9E0lWTZw5DVBmPSUB9qoVl+cf2ff7aslEXQWe7IsVIyFABvfMBT33qnXRNtSzm
         iVA6pKcXMj4uhVjIds+zb8L4sHjuTqwYIIU8M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Jtbmt/S6gVS0k05cEKO+l+1wcOX6Pshl0qiXWPWnGH/k4Jg4LA7QNMOeV1GGgZ2TFU
         qtcnXzWlDqiFemGt68hAacY2NMmdFJJZcdWEcHgNPKXfu9pnSbQ3eHjkF5uYXg1wNs2L
         WNk9GcCeErDYaeC/1Y5Ap2IKrMXmSs1yDkyq4=
MIME-Version: 1.0
Received: by 10.229.98.202 with SMTP id r10mr630456qcn.68.1238860356192; Sat, 
	04 Apr 2009 08:52:36 -0700 (PDT)
In-Reply-To: <8fdf49110904040725u493d83dby574149d2ab1f90f8@mail.gmail.com>
References: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
	 <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
	 <52193.93.97.155.28.1238846110.squirrel@webmail.cis.strath.ac.uk>
	 <9ac0c6aa0904040522w53ddee63m25220b301bc0204e@mail.gmail.com>
	 <8fdf49110904040725u493d83dby574149d2ab1f90f8@mail.gmail.com>
Date: Sat, 4 Apr 2009 08:52:36 -0700
Message-ID: <8fdf49110904040852r61f5a963q699c75fd3006fa94@mail.gmail.com>
Subject: Re: Term Limit?
From: deminix <deminix@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364ef07c750c4f0466bca7be
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364ef07c750c4f0466bca7be
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

My crude regex'ing of the code has me thinking it is only term vectors that
are limited to 32 bits, since they allocate arrays.  Otherwise it seems
good.  Does that sound right?


On Sat, Apr 4, 2009 at 7:25 AM, deminix <deminix@gmail.com> wrote:

> Thanks for the clarification.
>
> I'm partitioning the document space, so I'm not really concerned about the
> fact documents are ints.  Some fields have very unique value spaces though
> (and many values per document), and they don't align to the same way the
> documents are partitioned so may have a very high number of terms in a
> single partition.  I could partition smaller as needed to keep the term
> count below 4 billion if I must, but more importantly I'd like to be able to
> monitor it.
>
> AFAIK there isn't an api that returns the current number of terms, correct?
>
>
>
>
> On Sat, Apr 4, 2009 at 5:22 AM, Michael McCandless <
> lucene@mikemccandless.com> wrote:
>
>> Correct, and, not that I know of.
>>
>> Mike
>>
>> On Sat, Apr 4, 2009 at 7:55 AM, Murat Yakici
>> <Murat.Yakici@cis.strath.ac.uk> wrote:
>> >
>> > I assume the total number of documents that you can index is also
>> limited
>> > by Java max int. Is this correct? Is there any way to index documents
>> > beyond this number in a single index?
>> >
>> > Murat
>> >
>> >
>> >> I tentatively think you are correct: the file format itself does not
>> >> impose this limitation.
>> >>
>> >> But in a least a couple places internally, Lucene uses a java int to
>> >> hold the term number, which is actually a limit of 2,147,483,648
>> >> terms.  I'll update fileformats.html for 2.9.
>> >
>> >
>> >>
>> >> Mike
>> >>
>> >> On Sat, Apr 4, 2009 at 2:56 AM, deminix <deminix@gmail.com> wrote:
>> >>> http://lucene.apache.org/java/2_4_1/fileformats.html
>> >>>
>> >>> The file format page at the bottom cites that there is a 32 bit limit
>> to
>> >>> term numbers.  I fail to see where in the file formats documentation
>> >>> that is
>> >>> actually true.  Is the bottom of the page simply out of date?  I'm
>> also
>> >>> wondering whether the code may be a limiting factor even if the file
>> >>> formats
>> >>> are ok.
>> >>>
>> >>> Thanks.
>> >>>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >
>> >
>> > Murat Yakici
>> > Department of Computer & Information Sciences
>> > University of Strathclyde
>> > Glasgow, UK
>> > -------------------------------------------
>> > The University of Strathclyde is a charitable body, registered in
>> Scotland,
>> > with registration number SC015263.
>> >
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

--0016364ef07c750c4f0466bca7be--

From java-user-return-39514-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 15:58:28 2009
Return-Path: <java-user-return-39514-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92323 invoked from network); 4 Apr 2009 15:58:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 15:58:28 -0000
Received: (qmail 39374 invoked by uid 500); 4 Apr 2009 15:58:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39278 invoked by uid 500); 4 Apr 2009 15:58:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39268 invoked by uid 99); 4 Apr 2009 15:58:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 15:58:26 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of deminix@gmail.com designates 209.85.221.109 as permitted sender)
Received: from [209.85.221.109] (HELO mail-qy0-f109.google.com) (209.85.221.109)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 15:58:19 +0000
Received: by qyk7 with SMTP id 7so72939qyk.29
        for <java-user@lucene.apache.org>; Sat, 04 Apr 2009 08:57:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ueMI1T/CCLwDxYf44w0JTEjm6FZD8S7gnd9w8Os+CwQ=;
        b=mV6zpdKmFCDB4Ei/eYCZnE2FNiumABDK0pPUvF91gAiySjnA71CB8uO/rXIKL0y+cj
         Ed2oe1ZVNnBZqGrgJWaQH7XknZZMyDn33x9YGLLXTrbtDeZNeFtUJvZNJJv4dvLSjS2s
         4WS9t3GuJQwWe357FgjVTVpriOEP7cxQL5z1g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=XZNcGneLW0b7S+rCjiM8J6OJP7XwBEBRRQbMGTgsa+TJdoRd6FsieEDBMkJ0lhUof1
         ooFECeVgrRk94C+j5NCebbEOTAAOvBkcVpO8BnJbTihL10EEHhzg8HusecnUDmRH65vl
         QVFREgwIpp/gtAFr9gVr1VaOXmPMKg1gmCD8I=
MIME-Version: 1.0
Received: by 10.229.96.16 with SMTP id f16mr625241qcn.85.1238860678047; Sat, 
	04 Apr 2009 08:57:58 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904040844m7ffce6f6uc7177e71d86d610b@mail.gmail.com>
References: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
	 <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
	 <52193.93.97.155.28.1238846110.squirrel@webmail.cis.strath.ac.uk>
	 <9ac0c6aa0904040522w53ddee63m25220b301bc0204e@mail.gmail.com>
	 <8fdf49110904040725u493d83dby574149d2ab1f90f8@mail.gmail.com>
	 <9ac0c6aa0904040844m7ffce6f6uc7177e71d86d610b@mail.gmail.com>
Date: Sat, 4 Apr 2009 08:57:57 -0700
Message-ID: <8fdf49110904040857x6eccd5fbqf90e61504f677e1c@mail.gmail.com>
Subject: Re: Term Limit?
From: deminix <deminix@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364ee316a428b40466bcbae1
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364ee316a428b40466bcbae1
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Yea.  That is all that matters anyway right, is the limit at the segment
level?


On Sat, Apr 4, 2009 at 8:44 AM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> On Sat, Apr 4, 2009 at 10:25 AM, deminix <deminix@gmail.com> wrote:
>
> > AFAIK there isn't an api that returns the current number of terms,
> correct?
>
> Alas, no.  This limitation has been talked about before... maybe we
> should add it.
>
> But: it's not actually simple to compute, at the MultiSegmentReader
> level.  Each SegmentReader knows the unique term count, though.
>
> I wonder if we could expose the API, but if you call it on a
> MultiSegmentReader, it will throw UnsupportedOperationException.
> Instead, you could call getSequentialSubReaders (added in 2.9), and
> ask those readers for the unique term count.  Would something like
> that work?
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016364ee316a428b40466bcbae1--

From java-user-return-39515-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 16:04:09 2009
Return-Path: <java-user-return-39515-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93516 invoked from network); 4 Apr 2009 16:04:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 16:04:08 -0000
Received: (qmail 47920 invoked by uid 500); 4 Apr 2009 16:04:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47863 invoked by uid 500); 4 Apr 2009 16:04:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47853 invoked by uid 99); 4 Apr 2009 16:04:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 16:04:05 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.171] (HELO wf-out-1314.google.com) (209.85.200.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 16:03:56 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1543377wff.20
        for <java-user@lucene.apache.org>; Sat, 04 Apr 2009 09:03:34 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.133.19 with SMTP id g19mr692403wfd.116.1238861014475; Sat, 
	04 Apr 2009 09:03:34 -0700 (PDT)
In-Reply-To: <8fdf49110904040852r61f5a963q699c75fd3006fa94@mail.gmail.com>
References: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
	 <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
	 <52193.93.97.155.28.1238846110.squirrel@webmail.cis.strath.ac.uk>
	 <9ac0c6aa0904040522w53ddee63m25220b301bc0204e@mail.gmail.com>
	 <8fdf49110904040725u493d83dby574149d2ab1f90f8@mail.gmail.com>
	 <8fdf49110904040852r61f5a963q699c75fd3006fa94@mail.gmail.com>
Date: Sat, 4 Apr 2009 12:03:34 -0400
Message-ID: <9ac0c6aa0904040903g3b88f8er2a01c23dc58d125a@mail.gmail.com>
Subject: Re: Term Limit?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Sat, Apr 4, 2009 at 11:52 AM, deminix <deminix@gmail.com> wrote:
> My crude regex'ing of the code has me thinking it is only term vectors th=
at
> are limited to 32 bits, since they allocate arrays. =A0Otherwise it seems
> good. =A0Does that sound right?

Not quite... SegmentTermEnum.seek takes "int p".  TermInfosReader.get
takes int position, though I think (not certain) that method is not
currently used anywhere.  I thought I had found one more place, but I
can't find it again, now.  I guess one could make a stress test and
find out what breaks first ;)

It certainly seems like (so far) relaxing this limitation is far
easier than relaxing the int doc limitation.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39516-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 16:06:56 2009
Return-Path: <java-user-return-39516-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94940 invoked from network); 4 Apr 2009 16:06:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 16:06:56 -0000
Received: (qmail 52905 invoked by uid 500); 4 Apr 2009 16:06:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52813 invoked by uid 500); 4 Apr 2009 16:06:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52803 invoked by uid 99); 4 Apr 2009 16:06:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 16:06:54 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.170] (HELO wf-out-1314.google.com) (209.85.200.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 16:06:47 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1543844wff.20
        for <java-user@lucene.apache.org>; Sat, 04 Apr 2009 09:06:25 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.218.4 with SMTP id q4mr688106wfg.225.1238861185497; Sat, 
	04 Apr 2009 09:06:25 -0700 (PDT)
In-Reply-To: <8fdf49110904040857x6eccd5fbqf90e61504f677e1c@mail.gmail.com>
References: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
	 <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
	 <52193.93.97.155.28.1238846110.squirrel@webmail.cis.strath.ac.uk>
	 <9ac0c6aa0904040522w53ddee63m25220b301bc0204e@mail.gmail.com>
	 <8fdf49110904040725u493d83dby574149d2ab1f90f8@mail.gmail.com>
	 <9ac0c6aa0904040844m7ffce6f6uc7177e71d86d610b@mail.gmail.com>
	 <8fdf49110904040857x6eccd5fbqf90e61504f677e1c@mail.gmail.com>
Date: Sat, 4 Apr 2009 12:06:25 -0400
Message-ID: <9ac0c6aa0904040906q6eebb35bpe9538e72e8df2a5b@mail.gmail.com>
Subject: Re: Term Limit?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Sat, Apr 4, 2009 at 11:57 AM, deminix <deminix@gmail.com> wrote:
> Yea. =A0That is all that matters anyway right, is the limit at the segmen=
t
> level?

Well... the problem is when merges kick off.

You could have N segments that each are below the limit, but when a
merge runs the merged segment would try to exceed the limit, because
you can't easily predict how many unique terms the merged segment will
have.

I guess you could guarantee safety by never allowing the sum of the
unique term count across all segments to exceed 2^31-1, but that may
be a too-restrictive safety margin.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39517-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 16:29:57 2009
Return-Path: <java-user-return-39517-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99379 invoked from network); 4 Apr 2009 16:29:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 16:29:57 -0000
Received: (qmail 78919 invoked by uid 500); 4 Apr 2009 16:29:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78862 invoked by uid 500); 4 Apr 2009 16:29:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78852 invoked by uid 99); 4 Apr 2009 16:29:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 16:29:54 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of deminix@gmail.com designates 74.125.92.24 as permitted sender)
Received: from [74.125.92.24] (HELO qw-out-2122.google.com) (74.125.92.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 16:29:46 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1133460qwh.53
        for <java-user@lucene.apache.org>; Sat, 04 Apr 2009 09:29:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=uAS3SAeGaTWKIoz565UxACOup0zyASDulgglTx6YoVE=;
        b=lRc9Y8uodBWEjUNaCYhxYH72qNW/dLklhiLWoTuP7xR4ZoTz+Hj1Wtz0m5SN6xsE7t
         IIHNDIyoFCLwzWvuNxT9NHVONdqIbQGyuiVKQazB7O5tKd1YyuT/zr6M6w0dU3ZGPlbG
         gCIe2RLzstGpzWbuE0NOw4UBr3Lqbms1wmy7Y=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=HQ6ffc/QLjDfxP5d4B1lJm1l4/mMNZTICs9xDc4RAxQQHNv401foDWb35ttTkv64Qd
         XSILpjPwvfUvC4+6ld0CFaEX2fLZQwpPPb4/xSpNmOnlMXFV+6/4o2heicCzbd/xjLt4
         cQhvCUvcvlXjHD0BbQW+c+Zao6cltyxQ01sUY=
MIME-Version: 1.0
Received: by 10.229.96.13 with SMTP id f13mr635229qcn.36.1238862565792; Sat, 
	04 Apr 2009 09:29:25 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904040906q6eebb35bpe9538e72e8df2a5b@mail.gmail.com>
References: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
	 <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
	 <52193.93.97.155.28.1238846110.squirrel@webmail.cis.strath.ac.uk>
	 <9ac0c6aa0904040522w53ddee63m25220b301bc0204e@mail.gmail.com>
	 <8fdf49110904040725u493d83dby574149d2ab1f90f8@mail.gmail.com>
	 <9ac0c6aa0904040844m7ffce6f6uc7177e71d86d610b@mail.gmail.com>
	 <8fdf49110904040857x6eccd5fbqf90e61504f677e1c@mail.gmail.com>
	 <9ac0c6aa0904040906q6eebb35bpe9538e72e8df2a5b@mail.gmail.com>
Date: Sat, 4 Apr 2009 09:29:25 -0700
Message-ID: <8fdf49110904040929x687d0ee7r18ee2e34aaa7647f@mail.gmail.com>
Subject: Re: Term Limit?
From: deminix <deminix@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163683248228dc790466bd2bcd
X-Virus-Checked: Checked by ClamAV on apache.org

--00163683248228dc790466bd2bcd
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Ah yes.  I'd be happy with the ability to monitor it for now.  Assuming it
is too involved to remove the limitation.

For all practical purposes we should only be using, worst case, 10% of the
term space today.  That happens to make it risky enough that it needs an eye
kept on it, as this will be our authoritative store and the data isn't
within our control.

I'll see what I can do about trying to break it during perf testing ;)


On Sat, Apr 4, 2009 at 9:06 AM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> On Sat, Apr 4, 2009 at 11:57 AM, deminix <deminix@gmail.com> wrote:
> > Yea.  That is all that matters anyway right, is the limit at the segment
> > level?
>
> Well... the problem is when merges kick off.
>
> You could have N segments that each are below the limit, but when a
> merge runs the merged segment would try to exceed the limit, because
> you can't easily predict how many unique terms the merged segment will
> have.
>
> I guess you could guarantee safety by never allowing the sum of the
> unique term count across all segments to exceed 2^31-1, but that may
> be a too-restrictive safety margin.
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00163683248228dc790466bd2bcd--

From java-user-return-39518-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 17:01:57 2009
Return-Path: <java-user-return-39518-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5524 invoked from network); 4 Apr 2009 17:01:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 17:01:57 -0000
Received: (qmail 95838 invoked by uid 500); 4 Apr 2009 17:01:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95766 invoked by uid 500); 4 Apr 2009 17:01:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95756 invoked by uid 99); 4 Apr 2009 17:01:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 17:01:54 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.198.237] (HELO rv-out-0506.google.com) (209.85.198.237)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 17:01:48 +0000
Received: by rv-out-0506.google.com with SMTP id g9so1429503rvb.5
        for <java-user@lucene.apache.org>; Sat, 04 Apr 2009 10:01:26 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.166.7 with SMTP id o7mr700085wfe.198.1238864486641; Sat, 
	04 Apr 2009 10:01:26 -0700 (PDT)
In-Reply-To: <8fdf49110904040929x687d0ee7r18ee2e34aaa7647f@mail.gmail.com>
References: <8fdf49110904032356s2cf88d02hedef29300af2af2c@mail.gmail.com>
	 <9ac0c6aa0904040303m2bde366bof91a60a92cc6a198@mail.gmail.com>
	 <52193.93.97.155.28.1238846110.squirrel@webmail.cis.strath.ac.uk>
	 <9ac0c6aa0904040522w53ddee63m25220b301bc0204e@mail.gmail.com>
	 <8fdf49110904040725u493d83dby574149d2ab1f90f8@mail.gmail.com>
	 <9ac0c6aa0904040844m7ffce6f6uc7177e71d86d610b@mail.gmail.com>
	 <8fdf49110904040857x6eccd5fbqf90e61504f677e1c@mail.gmail.com>
	 <9ac0c6aa0904040906q6eebb35bpe9538e72e8df2a5b@mail.gmail.com>
	 <8fdf49110904040929x687d0ee7r18ee2e34aaa7647f@mail.gmail.com>
Date: Sat, 4 Apr 2009 13:01:26 -0400
Message-ID: <9ac0c6aa0904041001w3cef5b7g920b0a867def5a9f@mail.gmail.com>
Subject: Re: Term Limit?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

OK I opened https://issues.apache.org/jira/browse/LUCENE-1586 to track
this.  Thanks deminix!

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39519-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 21:04:13 2009
Return-Path: <java-user-return-39519-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91160 invoked from network); 4 Apr 2009 21:04:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 21:04:13 -0000
Received: (qmail 25724 invoked by uid 500); 4 Apr 2009 21:04:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25637 invoked by uid 500); 4 Apr 2009 21:04:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25627 invoked by uid 99); 4 Apr 2009 21:04:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 21:04:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.123.65.155] (HELO mail2.acquiremedia.com) (209.123.65.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 21:04:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail2.acquiremedia.com (Postfix) with ESMTP id 6D0E15AC098
	for <java-user@lucene.apache.org>; Sat,  4 Apr 2009 17:03:43 -0400 (EDT)
X-Virus-Scanned: amavisd-new at mmu.acquiremedia.com
Received: from mail2.acquiremedia.com ([127.0.0.1])
	by localhost (mail.mmu.acquiremedia.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id iIJ5h9-Gis0W for <java-user@lucene.apache.org>;
	Sat,  4 Apr 2009 17:03:43 -0400 (EDT)
Received: from exchange.mmu.acquiremedia.com (unknown [10.10.40.251])
	by mail2.acquiremedia.com (Postfix) with ESMTP
	for <java-user@lucene.apache.org>; Sat,  4 Apr 2009 17:03:43 -0400 (EDT)
Received: from exchange.windows.mmu.acquiremedia.com ([10.10.40.251]) by
 exchange.windows.mmu.acquiremedia.com ([10.10.40.251]) with mapi; Sat, 4 Apr
 2009 17:03:43 -0400
From: Dan OConnor <doconnor@acquiremedia.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Sat, 4 Apr 2009 17:03:41 -0400
Subject: RE: simultaneous indexing and searching causing intermitently long
 searches.
Thread-Topic: simultaneous indexing and searching causing intermitently long
 searches.
Thread-Index: Acm1EY5dhwq0UMcYQ2CN9r4BtQFDHAAVM2QQ
Message-ID: <24098ED350C76D46A4FDBD81B51BE0E903548EC2C5@exchange.windows.mmu.acquiremedia.com>
References: <24098ED350C76D46A4FDBD81B51BE0E903548EC203@exchange.windows.mmu.acquiremedia.com>
 <9ac0c6aa0904040338x53f46415l6c7ab8000f2c84c6@mail.gmail.com>
In-Reply-To: <9ac0c6aa0904040338x53f46415l6c7ab8000f2c84c6@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Mike,
Thanks for the response -- we've already jumped on a couple of your suggest=
ions.

Here is some feedback and follow ups:

We have watched GC times closely in the past. Most of the results of us try=
ing various settings was to make GC worse instead of better.

We didn't know about reopen() until recently so we still create a new Index=
Searcher in the background and warm it up before we put it into service. We=
 are going to switch to ping-ponging between to IndexSearchers. When we cal=
l reopen(), do we have to warm it up again if reopen returns a new IndexRea=
der?

After I sent this email, I found that the ConcurrentMergeScheduler has both=
 a setMaxThreadCount and a setMergeThreadPriority. Does this allow our code=
 to tell the JVM to run merge at a lower priority (and perhaps with more th=
reads) than our IndexWriter and IndexSearcher threads (which are created wi=
th normal priority)?

For warm-ups, since we sort on a couple of date fields within the document =
(in addition to the straight relevance sort), I'm reading your suggestion t=
hat it is important to issue warm up queries that date sort as well?

Thanks again for your time and effort.

Regards,
Dan


-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: Saturday, April 04, 2009 6:38 AM
To: java-user@lucene.apache.org
Subject: Re: simultaneous indexing and searching causing intermitently long=
 searches.

On Fri, Apr 3, 2009 at 10:21 PM, Dan OConnor <doconnor@acquiremedia.com> wr=
ote:
> All,
>
> I have a several questions regarding query response time and I would appr=
eciate any help that can be provided.
>
> We have a system that indexes approximately 200,000 documents per day at =
a fairly constant rate and holds them in a cfs-style file system directory =
index for 8 days. The index is approximately 50 GBs when optimized - which =
we do semi-monthly.
>
> We are running lucene 2.3.2 with jre 1.6. 0_10 on Centos5 on 64-bit Dell =
2950s - 3GHz dual/quad core processors with local ext3 Raid-5 15k disks (ap=
proximately 1.7TBs) The box has 16GB and the JVM is allocated 11G (both Xms=
 and Xmx)

With such a large heap, I would watch the GC times closely.  Turn on
verbose GC and see what's happening, when.  There have been threads
recently around how to tune the JRE's GC when using such a large heap.

> Every 15 minutes, we flush the IndexWriter and create a new IndexSearcher=
 to expose the newly indexed content.

Are you using reopen() to open the new reader?

> Every hour, approximately 1 hours worth of content (approximately 8,000 d=
ocuments) is deleted, we flush the IndexWriter, and create a new IndexSearc=
her.
>
> Q1: Given these settings, are there general rules of thumb for setting th=
e MergeFactor, MaxMergeDocs, MaxBufferedDocs, and RAMBufferSizeMB?

Large maxRamBufferSizeMB.  I would keep mergeFactor smallish (<=3D
10)... it means more frequent merges, but possibly less IO saturation.
 You should experiment...

The lack of IO prioritization from Java (and really from the OS) is a
big problem.  We have no way to tell the OS that the IO being done for
a merge is very low priority.

> We do a series of warm up searches every time we create a new IndexSearch=
er. Right now we are directly calling the IndexSearcher.search() method wit=
h a query, null filter, and 10 documents to return. We run searches against=
 all of the index fields.
>
> Q1: Are there any rules of thumb for the number or complexity of warm up =
searches?

The goal is to warm Lucene's internal caches (norms & field cache).
So run one search per field that's searchable (loads the norms), and
one search per sorted field (loads field cache).

A secondary goal may be to warm the OS's IO cache, though that's
trickier because you'd need to track the common and large terms that
need to be queried.  I believe Solr does this (carries over its query
cache to the warmed reader), but I'm not certain.

Note that by far the biggest bang for you bug is to switch to a solid
state device to hold your index. EG Fusion IO's devices are insanely
fast.

Note that 2.9 has some performance improvements on the warm
performance after reopen, if you use field sort.

> Q2: Is it important to "warmup" the query parser, analyzer, etc or the ra=
nges we use in queries or the sorting?

Not important -- only the IndexReader needs warming.

> When the system is receiving regular queries, between 1 and 5 per second =
for example, the search response times are extremely fast (sub 500ms) and m=
ostly independent of query complexity. We see slower query responses (on th=
e order of 2-4 seconds) for the first few queries =A0when using a newly cre=
ated IndexSearcher. However, the extremely fast response times return quick=
ly and continue.
>
> When the system has not received any search requests for a period of time=
, as little as 5 seconds, the query response time for even a simple query s=
tarts climbing (5 -8 seconds) and the longer the idle period between querie=
s, the longer the query response time (growing to 15-30 seconds if the idle=
 time is 30seconds to a minute). NOTE: the system is still indexing new con=
tent and removing old content when there are no incoming queries.

You should try to watch your process, eg with top, to see if the OS is
moving pages out in favor of populating the system's IO cache.  Watch
for page faults when you see a slow query happening. If so, there's a
linux kernel parameter called "swapiness" that you should tune to
prevent swapout (though I'm not certain if CentOS exposes it; I would
assume so).

It's also possible the slowness comes from the OS swapping out the IO
cache for those queries' posting lists, in which case an SSD device
should solve it.

> Q3: Is there a known issue where the IndexSearcher cache empties over tim=
e?

IndexSearcher doesn't free its caches, but the OS may.

> Finally, there are times when the query response times completely go off =
the charts - to 100s of seconds.

Gotta watch with top to see what's happening then.

> Q4: Is it possible that this is due to segments being merged together? If=
 so, besides the MergeFactor, etc. settings are there ways to mitigate this=
?

Yes this is possible.  Turn on IndexWriter.setInfoStream to see if you
can correlate massively slow queries with ongoing merging.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39520-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 04 22:01:30 2009
Return-Path: <java-user-return-39520-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11636 invoked from network); 4 Apr 2009 22:01:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Apr 2009 22:01:30 -0000
Received: (qmail 55244 invoked by uid 500); 4 Apr 2009 22:01:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55156 invoked by uid 500); 4 Apr 2009 22:01:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55146 invoked by uid 99); 4 Apr 2009 22:01:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 22:01:27 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.74] (HELO spunkymail-a7.g.dreamhost.com) (208.97.132.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 04 Apr 2009 22:01:19 +0000
Received: from [10.0.129.189] (unknown [24.106.210.234])
	by spunkymail-a7.g.dreamhost.com (Postfix) with ESMTP id F00575B67D
	for <java-user@lucene.apache.org>; Sat,  4 Apr 2009 15:00:57 -0700 (PDT)
Message-Id: <29434212-18A4-4ADB-9C54-FC102C345406@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <8837fb770904031624m227c17bek62db1f3a0d7e809e@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Autonomy search technology
Date: Sat, 4 Apr 2009 18:00:57 -0400
References: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com> <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com> <1B69876F-6C87-4A1A-8A02-55A4808221B5@zappos.com> <003e01c9b48f$f9990d50$eccb27f0$@com> <8837fb770904031624m227c17bek62db1f3a0d7e809e@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Note that I believe with some work (marking the "zones" during =20
analysis), one can accomplish this with Spans without the field =20
creation problem that John mentions.

-Grant

On Apr 3, 2009, at 7:24 PM, John Wang wrote:

> Not quite.For example,  # of fields is static thru out the corpus. # =20=

> zones
> is per document. E.g. let's say you have 1 million docs, some docs =20
> have 2
> paragraphs, some 1, and some 10000. You want to limit your search two
> paragraph 13. How many fields do you create? What if you add a =20
> document with
> 500000 paragraphs, do you create 500000 fields just for that document?
>
> -John
>
> 2009/4/3 Digy <digydigy@gmail.com>
>
>> As far as I can remember, "Zone" in Verity is similar to "field" in =20=

>> Lucene
>> and verity performs searches on all "zones" by default.
>>
>> DIGY
>>
>> -----Original Message-----
>> From: Matthew Runo [mailto:mruno@zappos.com]
>> Sent: Friday, April 03, 2009 9:08 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: Autonomy search technology
>>
>> Would you be willing to explain what "zone search" is? I did a quick
>> google search, but came up empty handed.
>>
>> Thanks for your time!
>>
>> Matthew Runo
>> Software Engineer, Zappos.com
>> mruno@zappos.com - 702-943-7833
>>
>> On Apr 3, 2009, at 10:08 AM, John Wang wrote:
>>
>>> Verity VDK, which was bought by autonomy, has zone search. Something
>>> lucene
>>> currently does not support.
>>>
>>> We have implemented it ontop of lucene and thinking about
>>> contributing.
>>>
>>> -John
>>>
>>> On Fri, Apr 3, 2009 at 8:56 AM, Luk=C3=A1=C5=A1 Vl=C4=8Dek =20
>>> <lukas.vlcek@gmail.com>
>>> wrote:
>>>
>>>> Hi,
>>>> anybody has experience with Automony search technology (
>>>> http://en.wikipedia.org/wiki/Autonomy_Corporation)? Speaking about
>>>> their
>>>> text searching technology is there anything which can not be
>>>> achieved using
>>>> Lucene?
>>>>
>>>> Regards,
>>>> Lukas
>>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) =20
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39521-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 05 12:23:30 2009
Return-Path: <java-user-return-39521-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61747 invoked from network); 5 Apr 2009 12:23:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Apr 2009 12:23:30 -0000
Received: (qmail 42039 invoked by uid 500); 5 Apr 2009 12:23:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41952 invoked by uid 500); 5 Apr 2009 12:23:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41942 invoked by uid 99); 5 Apr 2009 12:23:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 05 Apr 2009 12:23:27 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.198.239] (HELO rv-out-0506.google.com) (209.85.198.239)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 05 Apr 2009 12:23:20 +0000
Received: by rv-out-0506.google.com with SMTP id g9so1589133rvb.5
        for <java-user@lucene.apache.org>; Sun, 05 Apr 2009 05:22:59 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.166.10 with SMTP id t10mr950264wfo.210.1238934179300; Sun, 
	05 Apr 2009 05:22:59 -0700 (PDT)
In-Reply-To: <24098ED350C76D46A4FDBD81B51BE0E903548EC2C5@exchange.windows.mmu.acquiremedia.com>
References: <24098ED350C76D46A4FDBD81B51BE0E903548EC203@exchange.windows.mmu.acquiremedia.com>
	 <9ac0c6aa0904040338x53f46415l6c7ab8000f2c84c6@mail.gmail.com>
	 <24098ED350C76D46A4FDBD81B51BE0E903548EC2C5@exchange.windows.mmu.acquiremedia.com>
Date: Sun, 5 Apr 2009 08:22:59 -0400
Message-ID: <9ac0c6aa0904050522j50561b23j7f65f61350cb987a@mail.gmail.com>
Subject: Re: simultaneous indexing and searching causing intermitently long 
	searches.
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Sat, Apr 4, 2009 at 5:03 PM, Dan OConnor <doconnor@acquiremedia.com> wro=
te:

> We have watched GC times closely in the past. Most of the results of us t=
rying various settings was to make GC worse instead of better.

OK, but is a slow "stop the world" GC event to blame for the queries
that unexpectedly long to come back?  (vs, "a big merge was running",
vs "the OS had swapped pages out").

> We didn't know about reopen() until recently so we still create a new Ind=
exSearcher in the background and warm it up before we put it into service. =
We are going to switch to ping-ponging between to IndexSearchers. When we c=
all reopen(), do we have to warm it up again if reopen returns a new IndexR=
eader?

Yes you still need to fully warm after using reopen.  Unfortunately,
in 2.4 reopen() doesn't save all that much on the warming time, but in
2.9 it saves quite a bit when sorting by fields.  Still, it does save
some (eg loading norms) so you should switch to reopen right away.

> After I sent this email, I found that the ConcurrentMergeScheduler has bo=
th a setMaxThreadCount and a setMergeThreadPriority. Does this allow our co=
de to tell the JVM to run merge at a lower priority (and perhaps with more =
threads) than our IndexWriter and IndexSearcher threads (which are created =
with normal priority)?

Yes, you can set the merge thread priority.  By default it's one tick
higher than your indexer threads, the reasoning being to prevent
starvation of the merge thread when you are doing intense indexing.
Since you are indexing & searching on the same box, you should try
dropping merge thread priority to one tick lower and see if that helps
things.  If it does, please report back because this is a good
tunable.

You can also set the max number of merge threads.  It defaults to 3,
which may be too high (even a single merge thread may saturate your IO
system); you might want to try setting it to 1... if that helps, I'd
love to hear back as well.

> For warm-ups, since we sort on a couple of date fields within the documen=
t (in addition to the straight relevance sort), I'm reading your suggestion=
 that it is important to issue warm up queries that date sort as well?

Definitely.  Sorting by field must load the FieldCache entry (under
the hood), which is a costly operation.  With 2.9, after reopen,
loading this field cache will be much less costly because only the new
segments will need to be loaded.  But 2.4 is not as efficient after a
reopen, and will reload the entire FieldCache (ie, for all docs).

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39522-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 11:03:10 2009
Return-Path: <java-user-return-39522-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32899 invoked from network); 6 Apr 2009 11:03:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 11:03:10 -0000
Received: (qmail 20337 invoked by uid 500); 6 Apr 2009 11:03:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20252 invoked by uid 500); 6 Apr 2009 11:03:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20242 invoked by uid 99); 6 Apr 2009 11:03:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 11:03:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of hayato_1980@yahoo.co.jp designates 124.83.168.24 as permitted sender)
Received: from [124.83.168.24] (HELO web3310.mail.ogk.yahoo.co.jp) (124.83.168.24)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 06 Apr 2009 11:02:55 +0000
Received: (qmail 65704 invoked by uid 60001); 6 Apr 2009 11:02:32 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=yj20050223; d=yahoo.co.jp;
  h=Message-ID:Received:Date:From:Subject:To:MIME-Version:Content-Type;
  b=NUdQpON2yZ5tR1RxIDRXGfWcjWL/j1J6k1NyC08iRd8e2/xFAoIIRDlkjHqi3Ymh6psVQyspGExyszvpNFWqTSwIHJpcmX4VQPzwCbyUhGj8KDHW1b9ITYS1KUa5XM95  ;
Message-ID: <20090406110232.65702.qmail@web3310.mail.ogk.yahoo.co.jp>
Received: from [222.13.11.186] by web3310.mail.ogk.yahoo.co.jp via HTTP; Mon, 06 Apr 2009 20:02:32 JST
Date: Mon, 6 Apr 2009 20:02:32 +0900 (JST)
From: ito hayato <hayato_1980@yahoo.co.jp>
Subject: Unexpected highlighted text
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-2022-jp
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All, 
My name is Hayato.

I have a question for Highlighter.

I indexed following text and use Tokenizer.

text     : abracadabra
Tokenizer: NGramAnalyzer

and requested following query 

query    : ab

expected result and actual result is following

expect   : <B>ab</B>racad<B>ab</B>ra
actual   : <B>abracadab</B>ra


To be more specific, i try this testcase, but failed.

is this behavior valid?
if valid, please teach me why this result...

-----------------
    public static class NGramAnalyzer extends Analyzer {
        int minGram;

        int maxGram;

        public NGramAnalyzer(int minGram, int maxGram) {
            super();
            this.maxGram = maxGram;
            this.minGram = minGram;
        }

        public TokenStream tokenStream(String fieldName,
java.io.Reader reader) {
            return new NGramTokenizer(reader, minGram,
maxGram);
        }
    }

    @Test
    public void testGetBestTextFragments2() throws
IOException, ParseException {
        String CONTENT = "abracadabra";
        String QUERY_STRING = "ab";
        String F = "f";
        Analyzer analyzer = new NGramAnalyzer(2,2);
        TokenStream tokenStream =
analyzer.tokenStream("f", new StringReader(CONTENT));

        QueryParser qp = new QueryParser(F, analyzer);
        Query query = null;
        query = qp.parse(QUERY_STRING);

        Scorer scorer = new QueryScorer(query, F);
        Highlighter h = new Highlighter(scorer);

        Assert.assertEquals("<B>ab</B>racad<B>ab</B>ra",
h.getBestTextFragments(tokenStream, CONTENT, true,
10)[0].markedUpText
            .toString());

    }


--------------------------------------
Power up the Internet with Yahoo! Toolbar.
http://pr.mail.yahoo.co.jp/toolbar/

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39523-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 13:00:04 2009
Return-Path: <java-user-return-39523-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91903 invoked from network); 6 Apr 2009 13:00:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 13:00:04 -0000
Received: (qmail 51227 invoked by uid 500); 6 Apr 2009 13:00:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51155 invoked by uid 500); 6 Apr 2009 13:00:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51144 invoked by uid 99); 6 Apr 2009 13:00:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 13:00:01 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 12:59:54 +0000
Received: by fxm2 with SMTP id 2so2085078fxm.5
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 05:59:33 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.204.64.136 with SMTP id e8mr1639037bki.46.1239022772883; Mon, 
	06 Apr 2009 05:59:32 -0700 (PDT)
Date: Mon, 6 Apr 2009 13:59:32 +0100
Message-ID: <9d172ab60904060559p751336a0h89a07fdaec7a557e@mail.gmail.com>
Subject: Lucene and Phrase Correction
From: Glyn Darkin <glyn@darkinsystems.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Guys,

We are using Lucene for our search and have implemented "Did you
mean?" with the built in Spell Checker. However what we really need is
to be able to spell check phrases

E.g

"Harry Poter" is converted to "Harry Potter"

We have a fixed dataset so can build indexes/ dictionaries from our
own data. Has anybody tried this or is this feature the kind million
dollar feature?

Thanks for your help in advance.

Glyn Darkin

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39524-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 13:42:09 2009
Return-Path: <java-user-return-39524-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17993 invoked from network); 6 Apr 2009 13:42:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 13:42:09 -0000
Received: (qmail 543 invoked by uid 500); 6 Apr 2009 13:42:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 451 invoked by uid 500); 6 Apr 2009 13:42:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 441 invoked by uid 99); 6 Apr 2009 13:42:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 13:42:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of koji@r.email.ne.jp designates 202.224.39.198 as permitted sender)
Received: from [202.224.39.198] (HELO mail2.asahi-net.or.jp) (202.224.39.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 13:41:56 +0000
Received: from koji-sekiguchi-no-macbook.local (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	by mail2.asahi-net.or.jp (Postfix) with ESMTP id CAD456FDF8
	for <java-user@lucene.apache.org>; Mon,  6 Apr 2009 22:41:33 +0900 (JST)
Message-ID: <49DA068D.7040202@r.email.ne.jp>
Date: Mon, 06 Apr 2009 22:41:33 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.21 (Macintosh/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Unexpected highlighted text
References: <20090406110232.65702.qmail@web3310.mail.ogk.yahoo.co.jp>
In-Reply-To: <20090406110232.65702.qmail@web3310.mail.ogk.yahoo.co.jp>
Content-Type: text/plain; charset=ISO-2022-JP
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

This problem is filed at:

https://issues.apache.org/jira/browse/LUCENE-1489

You may want to take a look at LUCENE-1522 for highlighting N-gram tokens:

https://issues.apache.org/jira/browse/LUCENE-1522

Koji


ito hayato wrote:
> Hi All, 
> My name is Hayato.
>
> I have a question for Highlighter.
>
> I indexed following text and use Tokenizer.
>
> text     : abracadabra
> Tokenizer: NGramAnalyzer
>
> and requested following query 
>
> query    : ab
>
> expected result and actual result is following
>
> expect   : <B>ab</B>racad<B>ab</B>ra
> actual   : <B>abracadab</B>ra
>
>
> To be more specific, i try this testcase, but failed.
>
> is this behavior valid?
> if valid, please teach me why this result...
>
> -----------------
>     public static class NGramAnalyzer extends Analyzer {
>         int minGram;
>
>         int maxGram;
>
>         public NGramAnalyzer(int minGram, int maxGram) {
>             super();
>             this.maxGram = maxGram;
>             this.minGram = minGram;
>         }
>
>         public TokenStream tokenStream(String fieldName,
> java.io.Reader reader) {
>             return new NGramTokenizer(reader, minGram,
> maxGram);
>         }
>     }
>
>     @Test
>     public void testGetBestTextFragments2() throws
> IOException, ParseException {
>         String CONTENT = "abracadabra";
>         String QUERY_STRING = "ab";
>         String F = "f";
>         Analyzer analyzer = new NGramAnalyzer(2,2);
>         TokenStream tokenStream =
> analyzer.tokenStream("f", new StringReader(CONTENT));
>
>         QueryParser qp = new QueryParser(F, analyzer);
>         Query query = null;
>         query = qp.parse(QUERY_STRING);
>
>         Scorer scorer = new QueryScorer(query, F);
>         Highlighter h = new Highlighter(scorer);
>
>         Assert.assertEquals("<B>ab</B>racad<B>ab</B>ra",
> h.getBestTextFragments(tokenStream, CONTENT, true,
> 10)[0].markedUpText
>             .toString());
>
>     }
>
>
> --------------------------------------
> Power up the Internet with Yahoo! Toolbar.
> http://pr.mail.yahoo.co.jp/toolbar/
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39525-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 13:48:03 2009
Return-Path: <java-user-return-39525-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22789 invoked from network); 6 Apr 2009 13:48:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 13:48:03 -0000
Received: (qmail 9863 invoked by uid 500); 6 Apr 2009 13:48:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9789 invoked by uid 500); 6 Apr 2009 13:48:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9779 invoked by uid 99); 6 Apr 2009 13:48:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 13:48:00 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [98.136.44.50] (HELO n66.bullet.mail.sp1.yahoo.com) (98.136.44.50)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 06 Apr 2009 13:47:50 +0000
Received: from [216.252.122.216] by n66.bullet.mail.sp1.yahoo.com with NNFMP; 06 Apr 2009 13:47:29 -0000
Received: from [67.195.9.82] by t1.bullet.sp1.yahoo.com with NNFMP; 06 Apr 2009 13:47:29 -0000
Received: from [67.195.9.100] by t2.bullet.mail.gq1.yahoo.com with NNFMP; 06 Apr 2009 13:47:29 -0000
Received: from [127.0.0.1] by omp104.mail.gq1.yahoo.com with NNFMP; 06 Apr 2009 13:47:20 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 51054.63432.bm@omp104.mail.gq1.yahoo.com
Received: (qmail 65683 invoked by uid 60001); 6 Apr 2009 13:47:28 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ymail.com; s=s1024; t=1239025648; bh=A4rNE+9PApkqWSmuvQ1gatU/KRpPTSaqMWg9b5UeJPs=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=A3c6Va+f+UViaqJ1Jeuma9qchVx7VWgWBKDCUoQshmwRLmWotMfg9tkobQJsD0d+uYeNWTuCDgLVHyRFrLE63Oqw5xL6JbC8eQawQxQQHMse8YnQf5hhUiHU+DXWMp6PWJFe2pjT57lpsP2qvSbXqNnIfSVsEGANJAAjcDRg7YM=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=ymail.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=gXWj2ZA9BrTp/yeLcZDrYK8oax6ccQUtcncWS8r4YsHAC+f7G1NEK3Jq0RrsnJEb3nDyHctdhWUR1wu1wYzpMZZhUNoDYrnYWPjPcP0gs2belLKK4Om46YBkQWhIlijsPH8qfw5YTuDsudStxVcuDEs5UH0ZUY+t9NkSncSom0E=;
Message-ID: <700036.58122.qm@web112213.mail.gq1.yahoo.com>
X-YMail-OSG: qggk8xkVM1mNKZ_9SLHzxcWLPUIG.wiz33Jk_NVVcXOqNvx3BMis8fhWGoqPrk85X5qmhiG_jw93Sq8.LbA2u3koZ4MV0TpifoHC0dub85iks6.xDMPyA9aPUgu8UM1orG1pAXMCUZq7Vma0VI_xMK5y2zuk20_iF_PMZ8sU4QyEGO6Kh40ZwqZh2MEveQmCHjSZvtnoAZDkPWbtKH9tbSjQbyQ3WfTb_cdNG.C9VD7x4dTr9ZjJVJ3M8x0H07zukDJFoVkQl.8DlKrShQ--
Received: from [94.194.201.108] by web112213.mail.gq1.yahoo.com via HTTP; Mon, 06 Apr 2009 06:47:25 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
Date: Mon, 6 Apr 2009 06:47:25 -0700 (PDT)
From: Lebiram <lebiram@ymail.com>
Subject: Filters, what's going on under the hood?
To: Lucene Mailing-List <java-user@lucene.apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-604013443-1239025645=:58122"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-604013443-1239025645=:58122
Content-Type: text/plain; charset=us-ascii

Hi All, 

I am thinking of adding search filters to my application thinking that they would more efficient.

Can anyone explain what lucene does with search filters?

Like, what generally happens when calling search()


      
--0-604013443-1239025645=:58122--


From java-user-return-39526-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 14:53:16 2009
Return-Path: <java-user-return-39526-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64385 invoked from network); 6 Apr 2009 14:53:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 14:53:16 -0000
Received: (qmail 16510 invoked by uid 500); 6 Apr 2009 14:53:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16428 invoked by uid 500); 6 Apr 2009 14:53:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16418 invoked by uid 99); 6 Apr 2009 14:53:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 14:53:13 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [122.98.10.33] (HELO KECGATE08.infosys.com) (122.98.10.33)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 14:53:05 +0000
X-TM-IMSS-Message-ID:<5ead0abd000a1e17@KECGATE08.infosys.com>
Received: from blrkechub01.ad.infosys.com ([10.66.236.41]) by KECGATE08.infosys.com ([122.98.10.33]) with ESMTP (TREND IMSS SMTP Service 7.0; TLS: TLSv1/SSLv3,128bits,RC4-MD5) id 5ead0abd000a1e17 ; Mon, 6 Apr 2009 20:25:01 +0530
Received: from BLRKECMBX06.ad.infosys.com ([10.66.236.32]) by
 blrkechub01.ad.infosys.com ([10.66.236.41]) with mapi; Mon, 6 Apr 2009
 20:22:41 +0530
From: Allahbaksh Mohammedali Asadullah <Allahbaksh_Asadullah@infosys.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 6 Apr 2009 20:22:39 +0530
Subject: Multiple Analyzer on Single field
Thread-Topic: Multiple Analyzer on Single field
Thread-Index: Acm2x1T5OJ6KYR6BSNqSC8dAovXBfQ==
Message-ID: <68959F25CDEBCB4F917D5A253291D73E0D99721AEC@BLRKECMBX06.ad.infosys.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_000_68959F25CDEBCB4F917D5A253291D73E0D99721AECBLRKECMBX06ad_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_68959F25CDEBCB4F917D5A253291D73E0D99721AECBLRKECMBX06ad_
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi,
I=20want=20to=20add=20multiple=20Analyzer=20on=20single=20field.=20I=20wa=
nt=20properties=20of=20KeywordAnalyzer,=20SimpleAnalyzer,=20StandardAnaly=
zer,=20WhiteSpaceAnalyzer.=20Is=20there=20any=20easy=20way=20to=20have=20=
all=20analyzer=20bundled=20on=20single=20field.
Regards,
Allahbaksh







****************=20CAUTION=20-=20Disclaimer=20*****************
This=20e-mail=20contains=20PRIVILEGED=20AND=20CONFIDENTIAL=20INFORMATION=
=20intended=20solely=20
for=20the=20use=20of=20the=20addressee(s).=20If=20you=20are=20not=20the=
=20intended=20recipient,=20please=20
notify=20the=20sender=20by=20e-mail=20and=20delete=20the=20original=20mes=
sage.=20Further,=20you=20are=20not=20
to=20copy,=20disclose,=20or=20distribute=20this=20e-mail=20or=20its=20con=
tents=20to=20any=20other=20person=20and=20
any=20such=20actions=20are=20unlawful.=20This=20e-mail=20may=20contain=20=
viruses.=20Infosys=20has=20taken=20
every=20reasonable=20precaution=20to=20minimize=20this=20risk,=20but=20is=
=20not=20liable=20for=20any=20damage=20
you=20may=20sustain=20as=20a=20result=20of=20any=20virus=20in=20this=20e-=
mail.=20You=20should=20carry=20out=20your=20
own=20virus=20checks=20before=20opening=20the=20e-mail=20or=20attachment.=
=20Infosys=20reserves=20the=20
right=20to=20monitor=20and=20review=20the=20content=20of=20all=20messages=
=20sent=20to=20or=20from=20this=20e-mail=20
address.=20Messages=20sent=20to=20or=20from=20this=20e-mail=20address=20m=
ay=20be=20stored=20on=20the=20
Infosys=20e-mail=20system.
***INFOSYS********=20End=20of=20Disclaimer=20********INFOSYS***

--_000_68959F25CDEBCB4F917D5A253291D73E0D99721AECBLRKECMBX06ad_--

From java-user-return-39527-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 16:01:24 2009
Return-Path: <java-user-return-39527-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97010 invoked from network); 6 Apr 2009 16:01:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 16:01:24 -0000
Received: (qmail 34227 invoked by uid 500); 6 Apr 2009 16:01:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34126 invoked by uid 500); 6 Apr 2009 16:01:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34116 invoked by uid 99); 6 Apr 2009 16:01:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 16:01:21 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.221.130 as permitted sender)
Received: from [209.85.221.130] (HELO mail-qy0-f130.google.com) (209.85.221.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 16:01:13 +0000
Received: by qyk36 with SMTP id 36so633373qyk.29
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 09:00:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=6yBwbGyaDME8gHjDiHWUgzTAvD/njUi+Vdyb2f7Pm6g=;
        b=wC7bAbg5Vz5mpbxEnukJ1MrRBJR9EzzX/HEZ4lp6KF+f1+ZNtaZtch+LLERT2WrJxM
         VT2PIlwyk1AfyfWkqmTXRP1MvfwmbghqMrnusIwce1FSd/+ei6Z213n2k+u0bipNdaWg
         fMvJba1y91zcXTGpDBRd/z3sVYskc2P2wXyd8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=qlx+vS1s3BvnkT/H5thebPm69x1L211LR0oW7YqG9hU6UGK5KJjDZkB2oAN7GGHP7l
         uKDnXfvbx39JEjAOYJBjuZWEVlSCBJ37Htc+KPWTYjWPCpiZwK3CdomkefK3KIf8a65+
         cXX78JAaNvGMmb9doLXkly1cHefZ4cZElgEKU=
MIME-Version: 1.0
Received: by 10.220.97.147 with SMTP id l19mr3990733vcn.8.1239033651884; Mon, 
	06 Apr 2009 09:00:51 -0700 (PDT)
In-Reply-To: <68959F25CDEBCB4F917D5A253291D73E0D99721AEC@BLRKECMBX06.ad.infosys.com>
References: <68959F25CDEBCB4F917D5A253291D73E0D99721AEC@BLRKECMBX06.ad.infosys.com>
Date: Mon, 6 Apr 2009 12:00:51 -0400
Message-ID: <359a92830904060900m2c7cf884p4182ec9ac87e1bbf@mail.gmail.com>
Subject: Re: Multiple Analyzer on Single field
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64617c4afa67c0466e50018
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64617c4afa67c0466e50018
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

This really doesn't make sense. KeywordAnalyzer will NOT
tokenize the input stream. StandardAnalyzer WILL tokenize
the input stream. I can't imagine what it means to do both at
the same time.

Perhaps you could give us some examples of what your desired
inputs and outputs are we could steer you in the right direction.

I suspect you're thinking more in terms of TokenFilters and/or
Tokenizers...

Best
Erick

On Mon, Apr 6, 2009 at 10:52 AM, Allahbaksh Mohammedali Asadullah <
Allahbaksh_Asadullah@infosys.com> wrote:

> Hi,
> I want to add multiple Analyzer on single field. I want properties of
> KeywordAnalyzer, SimpleAnalyzer, StandardAnalyzer, WhiteSpaceAnalyzer. Is
> there any easy way to have all analyzer bundled on single field.
> Regards,
> Allahbaksh
>
>
>
>
>
>
>
> **************** CAUTION - Disclaimer *****************
> This e-mail contains PRIVILEGED AND CONFIDENTIAL INFORMATION intended
> solely
> for the use of the addressee(s). If you are not the intended recipient,
> please
> notify the sender by e-mail and delete the original message. Further, you
> are not
> to copy, disclose, or distribute this e-mail or its contents to any other
> person and
> any such actions are unlawful. This e-mail may contain viruses. Infosys has
> taken
> every reasonable precaution to minimize this risk, but is not liable for
> any damage
> you may sustain as a result of any virus in this e-mail. You should carry
> out your
> own virus checks before opening the e-mail or attachment. Infosys reserves
> the
> right to monitor and review the content of all messages sent to or from
> this e-mail
> address. Messages sent to or from this e-mail address may be stored on the
> Infosys e-mail system.
> ***INFOSYS******** End of Disclaimer ********INFOSYS***
>

--0016e64617c4afa67c0466e50018--

From java-user-return-39528-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 16:11:15 2009
Return-Path: <java-user-return-39528-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 136 invoked from network); 6 Apr 2009 16:11:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 16:11:15 -0000
Received: (qmail 52255 invoked by uid 500); 6 Apr 2009 16:11:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52165 invoked by uid 500); 6 Apr 2009 16:11:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52146 invoked by uid 99); 6 Apr 2009 16:11:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 16:11:12 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.173] (HELO wf-out-1314.google.com) (209.85.200.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 16:11:03 +0000
Received: by wf-out-1314.google.com with SMTP id 29so2093244wff.20
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 09:10:41 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.135.13 with SMTP id i13mr1339749wfd.8.1239034241596; Mon, 
	06 Apr 2009 09:10:41 -0700 (PDT)
In-Reply-To: <68959F25CDEBCB4F917D5A253291D73E0D99721AEC@BLRKECMBX06.ad.infosys.com>
References: <68959F25CDEBCB4F917D5A253291D73E0D99721AEC@BLRKECMBX06.ad.infosys.com>
Date: Mon, 6 Apr 2009 13:10:41 -0300
Message-ID: <ed88cb980904060910y31b50cebmb3f2ed892486937e@mail.gmail.com>
Subject: Re: Multiple Analyzer on Single field
From: Douglas Campos <douglas@theros.info>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd22a14d5bcae0466e523d6
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd22a14d5bcae0466e523d6
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

What I've done is to put copies of the same field, built with different
analyzers, and later use a MultiFieldQueryParser matching all fields.

eg: "name", "name_phonetic", "name_keyword", ad nauseum

To define which analyzer will go to which field, use PerFieldAnalyzerWrapper

On Mon, Apr 6, 2009 at 11:52 AM, Allahbaksh Mohammedali Asadullah <
Allahbaksh_Asadullah@infosys.com> wrote:

> Hi,
> I want to add multiple Analyzer on single field. I want properties of
> KeywordAnalyzer, SimpleAnalyzer, StandardAnalyzer, WhiteSpaceAnalyzer. Is
> there any easy way to have all analyzer bundled on single field.
> Regards,
> Allahbaksh
>
>
>
>
>
>
>
> **************** CAUTION - Disclaimer *****************
> This e-mail contains PRIVILEGED AND CONFIDENTIAL INFORMATION intended
> solely
> for the use of the addressee(s). If you are not the intended recipient,
> please
> notify the sender by e-mail and delete the original message. Further, you
> are not
> to copy, disclose, or distribute this e-mail or its contents to any other
> person and
> any such actions are unlawful. This e-mail may contain viruses. Infosys has
> taken
> every reasonable precaution to minimize this risk, but is not liable for
> any damage
> you may sustain as a result of any virus in this e-mail. You should carry
> out your
> own virus checks before opening the e-mail or attachment. Infosys reserves
> the
> right to monitor and review the content of all messages sent to or from
> this e-mail
> address. Messages sent to or from this e-mail address may be stored on the
> Infosys e-mail system.
> ***INFOSYS******** End of Disclaimer ********INFOSYS***
>



-- 
Douglas Campos
Theros Consulting
+55 11 9267 4540
+55 11 3020 8168

--000e0cd22a14d5bcae0466e523d6--

From java-user-return-39529-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 16:42:02 2009
Return-Path: <java-user-return-39529-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11415 invoked from network); 6 Apr 2009 16:42:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 16:42:02 -0000
Received: (qmail 5892 invoked by uid 500); 6 Apr 2009 16:41:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5817 invoked by uid 500); 6 Apr 2009 16:41:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5807 invoked by uid 99); 6 Apr 2009 16:41:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 16:41:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 16:41:51 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n36GfRMF015269
	for <java-user@lucene.apache.org>; Mon, 6 Apr 2009 12:41:28 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <49DA30B7.1050508@informatics.jax.org>
Date: Mon, 06 Apr 2009 12:41:27 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Multiple Analyzer on Single field
References: <68959F25CDEBCB4F917D5A253291D73E0D99721AEC@BLRKECMBX06.ad.infosys.com> <ed88cb980904060910y31b50cebmb3f2ed892486937e@mail.gmail.com>
In-Reply-To: <ed88cb980904060910y31b50cebmb3f2ed892486937e@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.5.1.360522, Antispam-Engine: 2.6.1.350677, Antispam-Data: 2009.4.6.163130
X-PerlMx-Spam: Gauge=IIIIIII, Probability=8%, Report='BODY_SIZE_3000_3999 0, BODY_SIZE_5000_LESS 0, BODY_SIZE_7000_LESS 0, TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __HAS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __SANE_MSGID 0, __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

... erm.. I'm still not quite sure what you are talking about.

But what you are trying to do, really isn't that hard.  Here's some 
sample code that should get you to where you want to be:

During document creation time do something like this:

        doc.add(new Field("data",
                /data/,
                Field.Store.YES, Field.Index.TOKENIZED));
        doc.add(new Field("sdata",
                 /data/,
                Field.Store.YES, Field.Index.TOKENIZED));

Repeat for as many times you want the same data to be searchable via a 
different analyzer.



Then at indexWriter time do something like this:

                PerFieldAnalyzerWrapper aWrapper = new 
PerFieldAnalyzerWrapper(
                        new StandardAnalyzer());
                aWrapper.addAnalyzer("data", new /AnalyzerForDataField/);
                aWrapper.addAnalyzer("sdata", new /AnalyzerForsdataField/);
                writer = new IndexWriter(INDEX_DIR, aWrapper, true);

Again repeating for each field you want searchable via a different analyzer.

At search time, make sure your query parser uses this same 
PerFieldAnalyzerWrapper, and you will be all set.

Well.. unless I really didn't understand what you were trying to do here...

There's always that possibility.

Matt

Douglas Campos wrote:
> What I've done is to put copies of the same field, built with different
> analyzers, and later use a MultiFieldQueryParser matching all fields.
>
> eg: "name", "name_phonetic", "name_keyword", ad nauseum
>
> To define which analyzer will go to which field, use PerFieldAnalyzerWrapper
>
> On Mon, Apr 6, 2009 at 11:52 AM, Allahbaksh Mohammedali Asadullah <
> Allahbaksh_Asadullah@infosys.com> wrote:
>
>   
>> Hi,
>> I want to add multiple Analyzer on single field. I want properties of
>> KeywordAnalyzer, SimpleAnalyzer, StandardAnalyzer, WhiteSpaceAnalyzer. Is
>> there any easy way to have all analyzer bundled on single field.
>> Regards,
>> Allahbaksh
>>
>>
>>
>>
>>
>>
>>
>> **************** CAUTION - Disclaimer *****************
>> This e-mail contains PRIVILEGED AND CONFIDENTIAL INFORMATION intended
>> solely
>> for the use of the addressee(s). If you are not the intended recipient,
>> please
>> notify the sender by e-mail and delete the original message. Further, you
>> are not
>> to copy, disclose, or distribute this e-mail or its contents to any other
>> person and
>> any such actions are unlawful. This e-mail may contain viruses. Infosys has
>> taken
>> every reasonable precaution to minimize this risk, but is not liable for
>> any damage
>> you may sustain as a result of any virus in this e-mail. You should carry
>> out your
>> own virus checks before opening the e-mail or attachment. Infosys reserves
>> the
>> right to monitor and review the content of all messages sent to or from
>> this e-mail
>> address. Messages sent to or from this e-mail address may be stored on the
>> Infosys e-mail system.
>> ***INFOSYS******** End of Disclaimer ********INFOSYS***
>>
>>     
>
>
>
>   



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39530-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 17:43:33 2009
Return-Path: <java-user-return-39530-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47017 invoked from network); 6 Apr 2009 17:43:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 17:43:33 -0000
Received: (qmail 94739 invoked by uid 500); 6 Apr 2009 17:43:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94649 invoked by uid 500); 6 Apr 2009 17:43:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94630 invoked by uid 99); 6 Apr 2009 17:43:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 17:43:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of richard.marr@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 17:43:20 +0000
Received: by fxm2 with SMTP id 2so2218427fxm.5
        for <multiple recipients>; Mon, 06 Apr 2009 10:42:59 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=vKL7HxHKC6QHUqRdlAwV4xVvHVzPx1Ff2XYNx9zxNAg=;
        b=TRszBbzNsMKwsx+y6eHy21at6I9fmMekKQIykYOUYJV6S/WDTB45UPVNX+M7ueeiGw
         G2zQoISXhxh1IISY/gFWsoTrjt0LDjkI6MyiHFQFqDrcvQ0SY+VSuQJI6IYDwZ85ZsR4
         +HHLjWyXhg3LS2iUt3eHfcs3lS/Mc+ZRl9fEc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=ts3M9YITDzdW2PunFQr9/TdEUZU0sRgFrt5urZl0zBmoSQ7x30N6aCTiat22905CTH
         HHSY0NTo/Med2EGNwZZYTZdINor1gg72K2wsXLaYudO3E/4MxD7UZGkhRch8p7iUj4uG
         wjzYFKYi0ZerM5D0kwq6Ywblz27Xdb9S5cc9w=
MIME-Version: 1.0
Received: by 10.86.87.13 with SMTP id k13mr1992542fgb.16.1239039779127; Mon, 
	06 Apr 2009 10:42:59 -0700 (PDT)
Date: Mon, 6 Apr 2009 18:42:59 +0100
Message-ID: <dba8f29c0904061042t2f842ae1p750ea0fa5605137d@mail.gmail.com>
Subject: London meet-up - 27th April
From: Richard Marr <richard.marr@gmail.com>
To: general@lucene.apache.org, java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,

Just to let everyone know... I'm organising (if you can call it that)
an informal London meet-up in the presence of alcohol to talk about
Lucene, and search in general. We're not planning on having any formal
talks or presentations.

We've just finished a big-ish search project that uses Lucene so feel
the need to share war stories and generally relax and talk geek stuff
with like-minded people. Please come if you're at all inclined. All I
ask is that you sign up via the Yahoo event page so that I know what
numbers to expect. Links are below.

Rich

--

Public notice:
http://richmarr.wordpress.com/2009/04/06/search-lucene-social-meet-up/

Yahoo event page:
http://upcoming.yahoo.com/event/2374281/

--


-- 
Richard Marr
richard.marr@gmail.com
07976 910 515

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39531-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 19:46:49 2009
Return-Path: <java-user-return-39531-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96666 invoked from network); 6 Apr 2009 19:46:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 19:46:49 -0000
Received: (qmail 75052 invoked by uid 500); 6 Apr 2009 19:46:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74971 invoked by uid 500); 6 Apr 2009 19:46:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74961 invoked by uid 99); 6 Apr 2009 19:46:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 19:46:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of karl.wettin@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 19:46:37 +0000
Received: by fxm2 with SMTP id 2so2268471fxm.5
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 12:46:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=plNJEb39j0nsKfY+GGjo5p0dmOY77ly6Z/8qTxRGowc=;
        b=Pq0Pejfe0rgA86IYnmbyspbmY4WaLZTGLM+dkuSe/sxXRUuE0U1ihwzGTkAnq54VsL
         5he+UddMMM5Jywujs7+xsWj23rc8DfLsA9aJqKkpgI3O8RZmlSN4YBFZalWzc2a2sw8g
         eWUwESlh3VKWJakzd/bn3kCikSu3uU8aWY5tM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=jH+1IzJ7OJUi15Jx8DAW1MoFcuJrnPi0PvClU2oCWxGfulcjgWmnJYRb7rkjKED8qi
         m2rwAkyvNnzq3JxwAwTSig5fuyec36DlmKWN8FzljzfrtElSm6v2IO5AuKuuH99ilNcN
         +eYOVWurYF4HYaUjRW3Ashc7PB4TYghs4Ws4Q=
Received: by 10.86.78.13 with SMTP id a13mr3495002fgb.10.1239047177205;
        Mon, 06 Apr 2009 12:46:17 -0700 (PDT)
Received: from ?192.168.1.201? (c-c98770d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.135.201])
        by mx.google.com with ESMTPS id 4sm12650637fgg.25.2009.04.06.12.46.16
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 06 Apr 2009 12:46:16 -0700 (PDT)
Message-Id: <170D50E2-6C26-469A-91EE-9A8603FAF731@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <9d172ab60904060559p751336a0h89a07fdaec7a557e@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Lucene and Phrase Correction
Date: Mon, 6 Apr 2009 21:46:15 +0200
References: <9d172ab60904060559p751336a0h89a07fdaec7a557e@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

6 apr 2009 kl. 14.59 skrev Glyn Darkin:

Hi Glyn,

> to be able to spell check phrases
>
> E.g
>
> "Harry Poter" is converted to "Harry Potter"
>
> We have a fixed dataset so can build indexes/ dictionaries from our
> own data.

the most obvious solution is index your contrib/spell checker with  
shingles. This will however probably only help out with exact phrases.  
Perhaps that is enough for you.

If your example is a real one that you came up with by analyzing query  
logs then you might want consider creating an index "stemmed" to  
handle various problems associated with reading and writing disorders.  
Dyslectic people often miss out on vowels, they who suffer from  
dysgraphia have problems with q/p/d/b, other have problems with  
reoccuring characters, et c. A combination of these problems could end  
up in a secondary "fuzzy" index that contains weighted shingles like  
this for the document that points at "harry potter":

"hary poter"^0.9
"harry #otter"^0.8
"hary #oter"^0.7
"hrry pttr"^0.7
"hry ptr"^0.5

In order to get a good precision/recall your query to such an index  
would have to produce a boolean query containing all of the "stems"  
above if the input was spelled correct.


One alternative to the contrib/spell checker is Spelt: http://groups.google.com/group/spelt/ 
  and I believe it is supposed to handle phrases.


Note the difference between spell checking and suggestion schemes.  
Something can be wrong even though the spelling is correct. Consider  
the game "Heroes of might and magic", people might have fogotten what  
it was called and search for "Heroes of light and magic" instead.  
Hopefully your query would still yield a fairly good result for the  
correct document if the latter was entered, but if you require all  
terms or something similar then it might return no hits.


More advanced strategies for contextual spell checking of phrases  
usually involve statistical models such as neural networs, hidden  
markov models, et c. LingPipe contains such an implementation.


You can also take a look at reinforcement learning, learning from the  
misstakes and corrections made by your users. It requires a lot of  
data (user query logs) in order to work but will yeild very cool  
results such as acronyms.

LUCENE-626 is a multi layered spell checker with reinforcement  
learning in the top, backed by an a priori corpus (that can be  
compiled from old user queries) used to find context. It also use a  
refactored version of the contrib/spell checker as second level  
suggestion when there is nothing to pick up from previous user  
behaviour. I never deployed this in a real system, it does however  
seem to work great when trained with a few hundred thousand query  
sessions.


Finally I recommend that you take some time to analyze user query  
sessions to find what the most common problems your users have and try  
to find a solution that best fit those problems. Too often features  
are implemented because they are listed in a specification and not  
because the users need them.


I hope this helps.

      karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39532-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 19:54:31 2009
Return-Path: <java-user-return-39532-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99924 invoked from network); 6 Apr 2009 19:54:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 19:54:31 -0000
Received: (qmail 88262 invoked by uid 500); 6 Apr 2009 19:54:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88182 invoked by uid 500); 6 Apr 2009 19:54:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88172 invoked by uid 99); 6 Apr 2009 19:54:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 19:54:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of karl.wettin@gmail.com designates 209.85.128.187 as permitted sender)
Received: from [209.85.128.187] (HELO fk-out-0910.google.com) (209.85.128.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 19:54:19 +0000
Received: by fk-out-0910.google.com with SMTP id 18so929005fkq.5
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 12:53:59 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=cfL6sdC+kQPuGu4Zzlj/e2hXk1TX68gQcUDVGMP07EI=;
        b=kXfa+zQGJS/2AGb6yBsO3xalntpDPJx5WPWVnlaXVEY/BTRRuzXxw/6Djae5H58iep
         LUYLCxnpUiBasQtEwkyBVUHoUdahJ1vrwuU6UdnwxqtYa4i+eS18jnKyei5x53HTD4Pk
         aAbSw/tRWzLZG9pLcf8huU/BCOc3/3BmYAVBU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=tbAZOrBFRZ6s5APm+aPQm7xZv/I+Ez9QJe4p4GD511TdILEE0+zTVuoCp2VSoUfPPb
         f4NVe6NyuOgqCPkt/SdU8ipnc1fhw5ue4qFEppNiJxNnHhu5d0OsFs/T8m2EtAcohPMl
         K4ZB4Ue7tiK3y1bhYPNyPfZX8cja2JUr3ds0E=
Received: by 10.86.72.15 with SMTP id u15mr3520093fga.13.1239047639235;
        Mon, 06 Apr 2009 12:53:59 -0700 (PDT)
Received: from ?192.168.1.201? (c-c98770d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.135.201])
        by mx.google.com with ESMTPS id d6sm7530227fga.12.2009.04.06.12.53.57
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 06 Apr 2009 12:53:58 -0700 (PDT)
Message-Id: <6B101FB9-0484-4244-8C11-499F0E8D3184@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <700036.58122.qm@web112213.mail.gq1.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Filters, what's going on under the hood?
Date: Mon, 6 Apr 2009 21:53:56 +0200
References: <700036.58122.qm@web112213.mail.gq1.yahoo.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org


6 apr 2009 kl. 15.47 skrev Lebiram:

> I am thinking of adding search filters to my application thinking  
> that they would more efficient.
>
> Can anyone explain what lucene does with search filters?
>
> Like, what generally happens when calling search()

A filter is a bitset, one bit per document in the index, used to tell  
Lucene to exclude these documents when processing the query. Generally  
it will only speed up your query if you can reuse the filter as it  
probably was created using the query it replaced.

This is what http://wiki.apache.org/jakarta-lucene/ 
ImproveSearchingSpeed says about filters:
	
Consider using filters.
It can be much more efficient to restrict results to a part of the  
index using a cached bit set filter rather than using a query clause.  
This is especially true for restrictions that match a great number of  
documents of a large index. Filters are typically used to restrict the  
results to a category but could in many cases be used to replace any  
query clause. One difference between using a Query and a Filter is  
that the Query has an impact on the score while a Filter does not.


       karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39533-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 20:02:04 2009
Return-Path: <java-user-return-39533-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2590 invoked from network); 6 Apr 2009 20:02:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 20:02:04 -0000
Received: (qmail 3787 invoked by uid 500); 6 Apr 2009 20:02:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3721 invoked by uid 500); 6 Apr 2009 20:02:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3704 invoked by uid 99); 6 Apr 2009 20:02:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 20:02:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 20:01:53 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lqv0e-0000GA-4R
	for java-user@lucene.apache.org; Mon, 06 Apr 2009 13:01:32 -0700
Message-ID: <22916108.post@talk.nabble.com>
Date: Mon, 6 Apr 2009 13:01:32 -0700 (PDT)
From: Marc Sturlese <marc.sturlese@gmail.com>
To: java-user@lucene.apache.org
Subject: boost and score doubt
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: marc.sturlese@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hey there,
Does de function doc.setBoost(x.y) accept negative values or values minor
than 1?? I mean... it compile and doesn't give errors but the behabiour is
not exactly what I was expecting.
In my use case I have the field title... I want to give very very low
relevance to the documents witch title has less that 40 characters. I have
tried setting boost to negatives values or to 0.1
Wich is the best way to do that?
Is there any range of values for setting boost?

And another thing that confuses me...  if I omit norms is the score
function... how does it affect to the boosting I am setting? does it loose
the effect?

Thanks in advance!
-- 
View this message in context: http://www.nabble.com/boost-and-score-doubt-tp22916108p22916108.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39534-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 20:33:19 2009
Return-Path: <java-user-return-39534-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10979 invoked from network); 6 Apr 2009 20:33:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 20:33:17 -0000
Received: (qmail 46667 invoked by uid 500); 6 Apr 2009 20:33:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46614 invoked by uid 500); 6 Apr 2009 20:33:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46604 invoked by uid 99); 6 Apr 2009 20:33:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 20:33:15 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of isaacrc82@gmail.com designates 209.85.132.249 as permitted sender)
Received: from [209.85.132.249] (HELO an-out-0708.google.com) (209.85.132.249)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 20:33:07 +0000
Received: by an-out-0708.google.com with SMTP id b2so1365403ana.5
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 13:32:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=kkeRCvTZH/B4YjI2xyfp6wocse7dxpgONjIUFiZh0aU=;
        b=IXr++fq+ODuxwZ8DTMuzkyPQEdUJRfnpaoh8gUdD3Uus5gNiylaq8CaBARl0rym+ie
         6OHe3M2JIJI7+fBIb0DSX48pFelrK3Xmi3PgIf3FXjN68Auq8oDWusI4FoqRowgeKDnc
         RI3NKzsFo+fu5nVwjYw2sKsXcC/ZhPmSWL2eY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=XrwF4DYPOt8eGmuE218+2oAqeSBJKyLnRZ6VQGv9ztKKStw8jFWkDeg0JreuPngjnz
         8KTxeQ4RfhS2fsA4H2QwK2+F5beReZgAQqXc9vnS52uTaohc/Xbx2ABmzfVkvVJ2Zv7d
         kkKI512/VPr3wR5NVQCOw1/HX1FVY1F7mwEh4=
MIME-Version: 1.0
Received: by 10.100.132.4 with SMTP id f4mr7821398and.127.1239049963350; Mon, 
	06 Apr 2009 13:32:43 -0700 (PDT)
Date: Mon, 6 Apr 2009 16:32:43 -0400
Message-ID: <bf1404350904061332l53580cdfvebe3963200d28ebf@mail.gmail.com>
Subject: How to search a phrase using quotes in a query ???
From: Ariel <isaacrc82@gmail.com>
To: lucene user <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=0016e6434bcaed5a360466e8cc22
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6434bcaed5a360466e8cc22
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi every body:

Why when I make a query with this search  query : "the fool of the hill"
doesn't appear documents in the search results that contains the entire
phrase "the fool of the hill" and it does exist documents that contain that
phrase, I am using snowball analyzer for English ???
Could you help with this please ???
Regards
Ariel

--0016e6434bcaed5a360466e8cc22--

From java-user-return-39535-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 20:38:09 2009
Return-Path: <java-user-return-39535-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12147 invoked from network); 6 Apr 2009 20:38:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 20:38:08 -0000
Received: (qmail 51786 invoked by uid 500); 6 Apr 2009 20:38:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51715 invoked by uid 500); 6 Apr 2009 20:38:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51705 invoked by uid 99); 6 Apr 2009 20:38:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 20:38:05 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 20:37:58 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1673664qwh.53
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 13:37:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=vLmoMduc8YGSEm7O/8DUg++YweSJDxONyqdLHqxIVcI=;
        b=CqXYlTL2NDtjRLXs0yCKmNXmMk3Q1XcFLU81txQUmgIW+Mqk0lpctdj3oBpztQfgtv
         exgt8Lj3nQ+cBNUfMEK+Fi0MdiszJcmPhr2z2klwWFsl1AAGDcN7BNFahEQK03zqXF8f
         GpZuZgvWBDoFTu5+TjHy5b2RnIBy59EXfUEKo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=n/YqOmzr8qP69Ml9RNcoqmJC1Mpg29llXag7Vuv0Aod4ghYn2jNcPqMMmatU4UoQ/2
         QgqcaBuel438jcys4hLnivVZG1vYrh+17zOYpQlxEUPdTC2whunJqtLgTBjJ9Q0lXwqs
         rCYiGLOD7QPKGdZNft8QDLaBSsM3bC+E+rrbQ=
MIME-Version: 1.0
Received: by 10.220.71.130 with SMTP id h2mr4355243vcj.118.1239050257642; Mon, 
	06 Apr 2009 13:37:37 -0700 (PDT)
In-Reply-To: <bf1404350904061332l53580cdfvebe3963200d28ebf@mail.gmail.com>
References: <bf1404350904061332l53580cdfvebe3963200d28ebf@mail.gmail.com>
Date: Mon, 6 Apr 2009 16:37:36 -0400
Message-ID: <359a92830904061337qf6057d6y29f3d8e7579071f5@mail.gmail.com>
Subject: Re: How to search a phrase using quotes in a query ???
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e646033c77342a0466e8de01
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e646033c77342a0466e8de01
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

We really need some more data. First, I *strongly* recommend you
get a copy of Luke and examine your index to see what is
*actually* there. Google "lucene luke". That often answers
many questions.

Second, query.toString is your friend. For instance, if the query
you provided below is all that you're submitting, it's going against
the default field you might have specified when you instantiated
your query parser.

Third, what analyzers are you using at index and query time?

Code snippets would also help.

Best
Erick

On Mon, Apr 6, 2009 at 4:32 PM, Ariel <isaacrc82@gmail.com> wrote:

> Hi every body:
>
> Why when I make a query with this search  query : "the fool of the hill"
> doesn't appear documents in the search results that contains the entire
> phrase "the fool of the hill" and it does exist documents that contain that
> phrase, I am using snowball analyzer for English ???
> Could you help with this please ???
> Regards
> Ariel
>

--0016e646033c77342a0466e8de01--

From java-user-return-39536-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 20:45:39 2009
Return-Path: <java-user-return-39536-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13660 invoked from network); 6 Apr 2009 20:45:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 20:45:39 -0000
Received: (qmail 63138 invoked by uid 500); 6 Apr 2009 20:45:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63077 invoked by uid 500); 6 Apr 2009 20:45:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63067 invoked by uid 99); 6 Apr 2009 20:45:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 20:45:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of richard.marr@gmail.com designates 72.14.220.157 as permitted sender)
Received: from [72.14.220.157] (HELO fg-out-1718.google.com) (72.14.220.157)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 20:45:29 +0000
Received: by fg-out-1718.google.com with SMTP id 19so817640fgg.4
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 13:45:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=gT1nLeLJxj6V3oW9cXPrYgoffo1n97Gb8nbssTjn5LI=;
        b=Yo6kr9Ltw/bhfbSyXo+TqrVRo5WDXCkqPP6PWk24X37gUxA+76Sx3s7AYBQk7td+Pt
         WoAcfFab2wLv/7QG5qcWcDg8+MhXpH8GJKnk5o/VOeodocvuiaqZCH5AIFBC60N0ypun
         TSUovbfZ0NbmaeB4ORAiExY7zpo6cd59PbsmU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=dFVta4Fvk1FX9z1IQEX3r8SUFOAJkrBKg4M9TMhHE4HIUPw+db89El8VpaqQPUTpjN
         azePDsF7rjoVr+Lb9FhC8Tx2Qo0TUpgWjSY9zILMORcNWHDuwEXHp2aZVtacTAH7VgwS
         w+FXLDCfuzQKNCb+5FCXBWgE1i0i3n8Mz0ldI=
MIME-Version: 1.0
Received: by 10.86.27.19 with SMTP id a19mr3489277fga.29.1239050708661; Mon, 
	06 Apr 2009 13:45:08 -0700 (PDT)
In-Reply-To: <7284f6e20903312217v7f56eb45u4b3475c8a0330632@mail.gmail.com>
References: <7284f6e20903312217v7f56eb45u4b3475c8a0330632@mail.gmail.com>
Date: Mon, 6 Apr 2009 21:45:08 +0100
Message-ID: <dba8f29c0904061345i43a9b506s857076823e37b7cf@mail.gmail.com>
Subject: Re: semantic vectors
From: Richard Marr <richard.marr@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Nitin,

I'm assuming you're asking about Latent Semantic Indexing and similar.
This may not be the best place to ask about this. Not sure where else
to suggest though.

If I understand your quesion correctly, the basic idea is that you
take a document (usually text but it could also be an image, video,
whatever) and create a meaningful vector from it. With a text document
you could create the vector by specifying each word in your vocabulary
as a dimension and defining the position in that dimension as the
number of occurences of that word. You can then treat the Euclidian
distance between documents as a measure of similarity. Similar
documents are clustered together.

With images you need different techniques to create the vectors.
Different vector creation algorithms create different measures of
similarity (colour, shape, etc).

I wouldn't say that semantic indexing methods are "different" from the
semantic web, because I see them as overlapping concepts. From my
perspective the semantic web comprises of many approaches, both
top-down (centralised interpretation of meaning like LSI) and
bottom-up (manual meta-tagging of data through mark-up, linking,
microformats, etc.)

Does that help at all? If anyone has corrections, or more to add,
please pile in... I'm wearing my flame-retardant underpants  :)


Rich



2009/4/1 nitin gopi <nitdaiict8@gmail.com>:
> hi all,
> =A0 =A0 =A0 =A0I want to know everything about semantic vectors. I want t=
o know how
> does it indexes the documents such that the results produced are
> semantically better than normal search. I also want to know how it is
> different from semantic web, which uses the concept of ontologies and
> metadata. It would be very helpful if somebody mail me all the study
> material related to it?
>
> Thanking You
> Nitin
>



--=20
Richard Marr
richard.marr@gmail.com
07976 910 515

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39537-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 21:07:44 2009
Return-Path: <java-user-return-39537-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21979 invoked from network); 6 Apr 2009 21:07:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 21:07:44 -0000
Received: (qmail 93052 invoked by uid 500); 6 Apr 2009 21:07:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92955 invoked by uid 500); 6 Apr 2009 21:07:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92945 invoked by uid 99); 6 Apr 2009 21:07:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 21:07:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [134.96.191.147] (HELO smtp.dfki.de) (134.96.191.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 21:07:31 +0000
Received: from smtp.dfki.de (localhost [127.0.0.1])
	by imss.7 (Postfix) with ESMTP id 8470F314A2
	for <java-user@lucene.apache.org>; Mon,  6 Apr 2009 23:07:11 +0200 (CEST)
Received: from mail.dfki.de (lnv-104.sb.dfki.de [134.96.191.146])
	by smtp.dfki.de (Postfix) with ESMTP id 773FA31436
	for <java-user@lucene.apache.org>; Mon,  6 Apr 2009 23:07:11 +0200 (CEST)
Received: from [192.168.178.47] (BAH3bcf.bah.pppool.de [77.135.59.207])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.dfki.de (Postfix) with ESMTPSA id 3CBED3111F
	for <java-user@lucene.apache.org>; Mon,  6 Apr 2009 23:07:11 +0200 (CEST)
Message-Id: <C5563286-6287-4638-95C5-40782F84ED7E@activemath.org>
From: Paul Libbrecht <paul@activemath.org>
To: java-user@lucene.apache.org
In-Reply-To: <dba8f29c0904061345i43a9b506s857076823e37b7cf@mail.gmail.com>
Content-Type: multipart/signed; boundary=Apple-Mail-42-899308612; micalg=sha1; protocol="application/pkcs7-signature"
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: semantic vectors
Date: Mon, 6 Apr 2009 23:07:09 +0200
References: <7284f6e20903312217v7f56eb45u4b3475c8a0330632@mail.gmail.com> <dba8f29c0904061345i43a9b506s857076823e37b7cf@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail-42-899308612
Content-Type: text/plain;
	charset=ISO-8859-1;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: quoted-printable

I am sorry Nittin, I may have injected you the doubt about this... =20
semantic-vectors is a project based on Lucene:
     http://code.google.com/p/semanticvectors/
you probably want to look there and ask questions on the forum there.

paul


Le 06-avr.-09 =E0 22:45, Richard Marr a =E9crit :

> Hi Nitin,
>
> I'm assuming you're asking about Latent Semantic Indexing and similar.
> This may not be the best place to ask about this. Not sure where else
> to suggest though.
>
> If I understand your quesion correctly, the basic idea is that you
> take a document (usually text but it could also be an image, video,
> whatever) and create a meaningful vector from it. With a text document
> you could create the vector by specifying each word in your vocabulary
> as a dimension and defining the position in that dimension as the
> number of occurences of that word. You can then treat the Euclidian
> distance between documents as a measure of similarity. Similar
> documents are clustered together.
>
> With images you need different techniques to create the vectors.
> Different vector creation algorithms create different measures of
> similarity (colour, shape, etc).
>
> I wouldn't say that semantic indexing methods are "different" from the
> semantic web, because I see them as overlapping concepts. =46rom my
> perspective the semantic web comprises of many approaches, both
> top-down (centralised interpretation of meaning like LSI) and
> bottom-up (manual meta-tagging of data through mark-up, linking,
> microformats, etc.)
>
> Does that help at all? If anyone has corrections, or more to add,
> please pile in... I'm wearing my flame-retardant underpants  :)
>
>
> Rich
>
>
>
> 2009/4/1 nitin gopi <nitdaiict8@gmail.com>:
>> hi all,
>>        I want to know everything about semantic vectors. I want to =20=

>> know how
>> does it indexes the documents such that the results produced are
>> semantically better than normal search. I also want to know how it is
>> different from semantic web, which uses the concept of ontologies and
>> metadata. It would be very helpful if somebody mail me all the study
>> material related to it?
>>
>> Thanking You
>> Nitin
>>
>
>
>
> --=20
> Richard Marr
> richard.marr@gmail.com
> 07976 910 515
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


--Apple-Mail-42-899308612
Content-Disposition: attachment;
	filename=smime.p7s
Content-Type: application/pkcs7-signature;
	name=smime.p7s
Content-Transfer-Encoding: base64

MIAGCSqGSIb3DQEHAqCAMIACAQExCzAJBgUrDgMCGgUAMIAGCSqGSIb3DQEHAQAAoIIFzjCCAocw
ggHwoAMCAQICEFwkG9LgbGf8Fuu/5kCXRScwDQYJKoZIhvcNAQEFBQAwYjELMAkGA1UEBhMCWkEx
JTAjBgNVBAoTHFRoYXd0ZSBDb25zdWx0aW5nIChQdHkpIEx0ZC4xLDAqBgNVBAMTI1RoYXd0ZSBQ
ZXJzb25hbCBGcmVlbWFpbCBJc3N1aW5nIENBMB4XDTA4MDYwMzE1MTgyOVoXDTA5MDYwMzE1MTgy
OVowcDEaMBgGA1UEBBMRTGliYnJlY2h0IEdvdXJkZXQxDTALBgNVBCoTBFBhdWwxHzAdBgNVBAMT
FlBhdWwgTGliYnJlY2h0IEdvdXJkZXQxIjAgBgkqhkiG9w0BCQEWE3BhdWxAYWN0aXZlbWF0aC5v
cmcwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMAHqTEgekG5Iyctn3tSRSfsPoZL+vkFavzl
w/xbbiQ4vWuoCZFVNHvLcFO2rfWoFLaRbcueLsmagsJwA1uxAj4tj/neoawadD+jZ3a98BkqBhIu
4hsC1poLDyvcbUOdKga9DXQ/pk/CorFvR7OOC1INrBtbDi7ycUYaUL7ZkpBFAgMBAAGjMDAuMB4G
A1UdEQQXMBWBE3BhdWxAYWN0aXZlbWF0aC5vcmcwDAYDVR0TAQH/BAIwADANBgkqhkiG9w0BAQUF
AAOBgQAt7uUnq0yd+jIo9/zYyj+NPyCh3v8CX8MW2qalj37t1YUR82o5/1O5z0sXj7+hQmSEWH7N
BgptwNvhNoKWTYo5c8HBsAMvvv1ruSXYKlsRvPBfewHEEo2KgH73SImj2w7a8owq3t0KLVCPP7d4
RXnrXJf6nuXlsvfFFEd6aIN7VjCCAz8wggKooAMCAQICAQ0wDQYJKoZIhvcNAQEFBQAwgdExCzAJ
BgNVBAYTAlpBMRUwEwYDVQQIEwxXZXN0ZXJuIENhcGUxEjAQBgNVBAcTCUNhcGUgVG93bjEaMBgG
A1UEChMRVGhhd3RlIENvbnN1bHRpbmcxKDAmBgNVBAsTH0NlcnRpZmljYXRpb24gU2VydmljZXMg
RGl2aXNpb24xJDAiBgNVBAMTG1RoYXd0ZSBQZXJzb25hbCBGcmVlbWFpbCBDQTErMCkGCSqGSIb3
DQEJARYccGVyc29uYWwtZnJlZW1haWxAdGhhd3RlLmNvbTAeFw0wMzA3MTcwMDAwMDBaFw0xMzA3
MTYyMzU5NTlaMGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQKExxUaGF3dGUgQ29uc3VsdGluZyAoUHR5
KSBMdGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwgRnJlZW1haWwgSXNzdWluZyBDQTCBnzAN
BgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAxKY8VXNV+065yplaHmjAdQRwnd/p/6Me7L3N9VvyGna9
fww6YfK/Uc4B1OVQCjDXAmNaLIkVcI7dyfArhVqqP3FWy688Cwfn8R+RNiQqE88r1fOCdz0Dviv+
uxg+B79AgAJk16emu59l0cUqVIUPSAR/p7bRPGEEQB5kGXJgt/sCAwEAAaOBlDCBkTASBgNVHRMB
Af8ECDAGAQH/AgEAMEMGA1UdHwQ8MDowOKA2oDSGMmh0dHA6Ly9jcmwudGhhd3RlLmNvbS9UaGF3
dGVQZXJzb25hbEZyZWVtYWlsQ0EuY3JsMAsGA1UdDwQEAwIBBjApBgNVHREEIjAgpB4wHDEaMBgG
A1UEAxMRUHJpdmF0ZUxhYmVsMi0xMzgwDQYJKoZIhvcNAQEFBQADgYEASIzRUIPqCy7MDaNmrGcP
f6+svsIXoUOWlJ1/TCG4+DYfqi2fNi/A9BxQIJNwPP2t4WFiw9k6GX6EsZkbAMUaC4J0niVQlGLH
2ydxVyWN3amcOY6MIE9lX5Xa9/eH1sYITq726jTlEBpbNU1341YheILcIRk13iSx0x1G/11fZU8x
ggKPMIICiwIBATB2MGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQKExxUaGF3dGUgQ29uc3VsdGluZyAo
UHR5KSBMdGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwgRnJlZW1haWwgSXNzdWluZyBDQQIQ
XCQb0uBsZ/wW67/mQJdFJzAJBgUrDgMCGgUAoIIBbzAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcB
MBwGCSqGSIb3DQEJBTEPFw0wOTA0MDYyMTA3MTBaMCMGCSqGSIb3DQEJBDEWBBTL5lDeIpF9xZ1w
lxrRVpcdVVXLvjCBhQYJKwYBBAGCNxAEMXgwdjBiMQswCQYDVQQGEwJaQTElMCMGA1UEChMcVGhh
d3RlIENvbnN1bHRpbmcgKFB0eSkgTHRkLjEsMCoGA1UEAxMjVGhhd3RlIFBlcnNvbmFsIEZyZWVt
YWlsIElzc3VpbmcgQ0ECEFwkG9LgbGf8Fuu/5kCXRScwgYcGCyqGSIb3DQEJEAILMXigdjBiMQsw
CQYDVQQGEwJaQTElMCMGA1UEChMcVGhhd3RlIENvbnN1bHRpbmcgKFB0eSkgTHRkLjEsMCoGA1UE
AxMjVGhhd3RlIFBlcnNvbmFsIEZyZWVtYWlsIElzc3VpbmcgQ0ECEFwkG9LgbGf8Fuu/5kCXRScw
DQYJKoZIhvcNAQEBBQAEgYAzt7LGyt3yHFQQYAeuMCvlKMXW2k9q+LiqbOj/jRBw6p3lpdfkOIJM
fmGzGK9+bF6y4PUTDYPuNyxZpfDQ3r3cpRw2429uTvOL+gIEnjzlp5l/vaZYbTfqZIBoyYwnLC2o
HHZh04XNBG1wEt3r/lCdw8fzMU5W4J5xe/YpIFgYEgAAAAAAAA==

--Apple-Mail-42-899308612--

From java-user-return-39538-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 21:25:15 2009
Return-Path: <java-user-return-39538-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31161 invoked from network); 6 Apr 2009 21:25:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 21:25:14 -0000
Received: (qmail 15632 invoked by uid 500); 6 Apr 2009 21:25:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15551 invoked by uid 500); 6 Apr 2009 21:25:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15541 invoked by uid 99); 6 Apr 2009 21:25:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 21:25:12 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of isaacrc82@gmail.com designates 209.85.132.242 as permitted sender)
Received: from [209.85.132.242] (HELO an-out-0708.google.com) (209.85.132.242)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 21:25:04 +0000
Received: by an-out-0708.google.com with SMTP id b2so1380298ana.5
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 14:24:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Eym9MIg9n72V107BWqVk50smx02ONkqvu4pyqjgHZb0=;
        b=axtXGfCHWUQdxz6nw64X0AZvBDy8GH1+JxWL8RIoXe/JVKb453XTeI/tZTD8yGziNR
         WMQ5WQ+Gj4NI9A5KXazG8UWnI8SJEnCu9vwRs8RCj7ivNaQxgyuGAKcCi3WJfJoKN2rv
         z/oYQddDnQsFKmXKSG0gVh6naHeB/Vt7IXh9U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=MX9jSLCmCu8KqUcN5jnAB3fVRMmCPA0YgsAbidGwqVLhavuBdIpjPISVnk1sBYvwgm
         dFj8+B+aFlbTb8yoCLHoqFE/RR7bF7tsski4sgqGA7/CT1KVSsIO0fs4B/LLk/5SYsQm
         1rtsicR1lXdKwupuJD7ZPl9kgluPw9VRxAx1w=
MIME-Version: 1.0
Received: by 10.100.8.4 with SMTP id 4mr6472792anh.146.1239053069541; Mon, 06 
	Apr 2009 14:24:29 -0700 (PDT)
In-Reply-To: <359a92830904061337qf6057d6y29f3d8e7579071f5@mail.gmail.com>
References: <bf1404350904061332l53580cdfvebe3963200d28ebf@mail.gmail.com>
	 <359a92830904061337qf6057d6y29f3d8e7579071f5@mail.gmail.com>
Date: Mon, 6 Apr 2009 17:24:29 -0400
Message-ID: <bf1404350904061424r6f4c07dfif06c982ea1727ea1@mail.gmail.com>
Subject: Re: How to search a phrase using quotes in a query ???
From: Ariel <isaacrc82@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6407ed013b5bf0466e98663
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6407ed013b5bf0466e98663
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Well I have luke lucene, the index has been build fine.
The field where I am searching is the content field.

I am using the same analyzer in query and indexing time: SnowBall English
Analyzer.

I am going to submit later the snippet code.

Regards
Ariel


On Mon, Apr 6, 2009 at 4:37 PM, Erick Erickson <erickerickson@gmail.com>wrote:

> We really need some more data. First, I *strongly* recommend you
> get a copy of Luke and examine your index to see what is
> *actually* there. Google "lucene luke". That often answers
> many questions.
>
> Second, query.toString is your friend. For instance, if the query
> you provided below is all that you're submitting, it's going against
> the default field you might have specified when you instantiated
> your query parser.
>
> Third, what analyzers are you using at index and query time?
>
> Code snippets would also help.
>
> Best
> Erick
>
> On Mon, Apr 6, 2009 at 4:32 PM, Ariel <isaacrc82@gmail.com> wrote:
>
> > Hi every body:
> >
> > Why when I make a query with this search  query : "the fool of the hill"
> > doesn't appear documents in the search results that contains the entire
> > phrase "the fool of the hill" and it does exist documents that contain
> that
> > phrase, I am using snowball analyzer for English ???
> > Could you help with this please ???
> > Regards
> > Ariel
> >
>

--0016e6407ed013b5bf0466e98663--

From java-user-return-39539-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 21:27:42 2009
Return-Path: <java-user-return-39539-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32887 invoked from network); 6 Apr 2009 21:27:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 21:27:42 -0000
Received: (qmail 23004 invoked by uid 500); 6 Apr 2009 21:27:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22932 invoked by uid 500); 6 Apr 2009 21:27:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22922 invoked by uid 99); 6 Apr 2009 21:27:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 21:27:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 21:27:33 +0000
Received: by qyk8 with SMTP id 8so157112qyk.29
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 14:27:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=JxLp8fRKQU/k9gtNsLseL5twCXkWHoCPi+6bDtZzn3Y=;
        b=mvpgRTBOonTYAVUgRE+GNVc2KVzXiqMpl247bRWybA5Acy/+XnTDtcBxYM9fVwMCrd
         ADYX1Tu29hssmEnlCChA39FhoSo2fBUoXHN9m5gf1Kw1FUEPffktqjV5n5sMmfKhfQrU
         rO5KSI8bS2Ygm6OvzqXl7bZzIWi9ebpJ9qNr4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=MbALD/y8cyNvW5auGxZ+aLPLn+EeTEuPFu3OHt3cky4P9wi0mOjXOeRTC9OWF7ohYm
         dD4c/fOSGM2BOGojusdZxxhtf0eI+N8GoBnG51XcxBerk7rYsuZ2IDMEPw5VPtI3nyJs
         iYAGZtBXFIN3AM1lypkDHVMMKQbm29aqtkotc=
MIME-Version: 1.0
Received: by 10.220.87.4 with SMTP id u4mr4575962vcl.28.1239053232732; Mon, 06 
	Apr 2009 14:27:12 -0700 (PDT)
In-Reply-To: <bf1404350904061424r6f4c07dfif06c982ea1727ea1@mail.gmail.com>
References: <bf1404350904061332l53580cdfvebe3963200d28ebf@mail.gmail.com>
	 <359a92830904061337qf6057d6y29f3d8e7579071f5@mail.gmail.com>
	 <bf1404350904061424r6f4c07dfif06c982ea1727ea1@mail.gmail.com>
Date: Mon, 6 Apr 2009 17:26:42 -0400
Message-ID: <359a92830904061426q976cbb5ua0957bdb2e911d45@mail.gmail.com>
Subject: Re: How to search a phrase using quotes in a query ???
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6475f1acb7d490466e98fef
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6475f1acb7d490466e98fef
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

If you have luke, you should be able to submit your query and use
the explain functionality to gain some insights into what the query
actually looks like as well....

Best
Erick

On Mon, Apr 6, 2009 at 5:24 PM, Ariel <isaacrc82@gmail.com> wrote:

> Well I have luke lucene, the index has been build fine.
> The field where I am searching is the content field.
>
> I am using the same analyzer in query and indexing time: SnowBall English
> Analyzer.
>
> I am going to submit later the snippet code.
>
> Regards
> Ariel
>
>
> On Mon, Apr 6, 2009 at 4:37 PM, Erick Erickson <erickerickson@gmail.com
> >wrote:
>
> > We really need some more data. First, I *strongly* recommend you
> > get a copy of Luke and examine your index to see what is
> > *actually* there. Google "lucene luke". That often answers
> > many questions.
> >
> > Second, query.toString is your friend. For instance, if the query
> > you provided below is all that you're submitting, it's going against
> > the default field you might have specified when you instantiated
> > your query parser.
> >
> > Third, what analyzers are you using at index and query time?
> >
> > Code snippets would also help.
> >
> > Best
> > Erick
> >
> > On Mon, Apr 6, 2009 at 4:32 PM, Ariel <isaacrc82@gmail.com> wrote:
> >
> > > Hi every body:
> > >
> > > Why when I make a query with this search  query : "the fool of the
> hill"
> > > doesn't appear documents in the search results that contains the entire
> > > phrase "the fool of the hill" and it does exist documents that contain
> > that
> > > phrase, I am using snowball analyzer for English ???
> > > Could you help with this please ???
> > > Regards
> > > Ariel
> > >
> >
>

--0016e6475f1acb7d490466e98fef--

From java-user-return-39540-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 06 21:27:51 2009
Return-Path: <java-user-return-39540-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32979 invoked from network); 6 Apr 2009 21:27:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Apr 2009 21:27:51 -0000
Received: (qmail 24642 invoked by uid 500); 6 Apr 2009 21:27:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24582 invoked by uid 500); 6 Apr 2009 21:27:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24572 invoked by uid 99); 6 Apr 2009 21:27:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 21:27:48 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 74.125.92.24 as permitted sender)
Received: from [74.125.92.24] (HELO qw-out-2122.google.com) (74.125.92.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 06 Apr 2009 21:27:40 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1692473qwh.53
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 14:27:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=mbjbXmxi6riGzRrrIgTT+FlPHCpIKSfsJXNfaYXjqL4=;
        b=GIJe4Ab6l7Nu/nGTdjmlWOKYzSHXBE1XjZQC4ZCSBoVQXCY1FpuFEYbk/mIVBnsp0d
         2uv9z1l0PraAxpMbga8a/yK3hxz4zAGizwZ0uNjlD2hs0sXgJDJCHSNFuABYKhZNKMty
         +UkVRmkVxlQP4TUCjPCIJxMOJ1MJuRh368OSg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ffQNv0Q6cwAxgZpitY56TnCIbycwRh3o16plPdZDxnvJTN+PrEoqCbyaNox7s8/eSC
         1OEY+2WR2DiuiVJ1jxnTqKCzIoScba/MZsLumKR3sUmISN2TkTlBr049Dqja7g5tYMjN
         GrFuDvDhxLH2OqunZVA/Nl1Vz32xjyeEQ5QWA=
MIME-Version: 1.0
Received: by 10.220.91.205 with SMTP id o13mr4495017vcm.92.1239053203062; Mon, 
	06 Apr 2009 14:26:43 -0700 (PDT)
In-Reply-To: <bf1404350904061424r6f4c07dfif06c982ea1727ea1@mail.gmail.com>
References: <bf1404350904061332l53580cdfvebe3963200d28ebf@mail.gmail.com>
	 <359a92830904061337qf6057d6y29f3d8e7579071f5@mail.gmail.com>
	 <bf1404350904061424r6f4c07dfif06c982ea1727ea1@mail.gmail.com>
Date: Mon, 6 Apr 2009 17:26:42 -0400
Message-ID: <359a92830904061426q976cbb5ua0957bdb2e911d45@mail.gmail.com>
Subject: Re: How to search a phrase using quotes in a query ???
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f9213e0b107c0466e98e31
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f9213e0b107c0466e98e31
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

If you have luke, you should be able to submit your query and use
the explain functionality to gain some insights into what the query
actually looks like as well....

Best
Erick

On Mon, Apr 6, 2009 at 5:24 PM, Ariel <isaacrc82@gmail.com> wrote:

> Well I have luke lucene, the index has been build fine.
> The field where I am searching is the content field.
>
> I am using the same analyzer in query and indexing time: SnowBall English
> Analyzer.
>
> I am going to submit later the snippet code.
>
> Regards
> Ariel
>
>
> On Mon, Apr 6, 2009 at 4:37 PM, Erick Erickson <erickerickson@gmail.com
> >wrote:
>
> > We really need some more data. First, I *strongly* recommend you
> > get a copy of Luke and examine your index to see what is
> > *actually* there. Google "lucene luke". That often answers
> > many questions.
> >
> > Second, query.toString is your friend. For instance, if the query
> > you provided below is all that you're submitting, it's going against
> > the default field you might have specified when you instantiated
> > your query parser.
> >
> > Third, what analyzers are you using at index and query time?
> >
> > Code snippets would also help.
> >
> > Best
> > Erick
> >
> > On Mon, Apr 6, 2009 at 4:32 PM, Ariel <isaacrc82@gmail.com> wrote:
> >
> > > Hi every body:
> > >
> > > Why when I make a query with this search  query : "the fool of the
> hill"
> > > doesn't appear documents in the search results that contains the entire
> > > phrase "the fool of the hill" and it does exist documents that contain
> > that
> > > phrase, I am using snowball analyzer for English ???
> > > Could you help with this please ???
> > > Regards
> > > Ariel
> > >
> >
>

--001485f9213e0b107c0466e98e31--

From java-user-return-39541-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 01:40:50 2009
Return-Path: <java-user-return-39541-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32916 invoked from network); 7 Apr 2009 01:40:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 01:40:50 -0000
Received: (qmail 6184 invoked by uid 500); 7 Apr 2009 01:40:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6106 invoked by uid 500); 7 Apr 2009 01:40:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6096 invoked by uid 99); 7 Apr 2009 01:40:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 01:40:47 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.198.225 as permitted sender)
Received: from [209.85.198.225] (HELO rv-out-0506.google.com) (209.85.198.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 01:40:38 +0000
Received: by rv-out-0506.google.com with SMTP id f6so47227rvb.5
        for <java-user@lucene.apache.org>; Mon, 06 Apr 2009 18:40:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Zh9ks9dBOsPPZh2cFKSVX/1mrCXOY0GKTSW/dy8o+28=;
        b=hxkUTR6we09HeS8mtF8JwqzxL98RFQ/IfM8UXAA/HoDT5IWHxe1dipd/o+DLSR3U3u
         /6Qy2MuEvm363dhaDc5AP6hXaHYsgCrDpC/dHdXS283Kxr20Vq9MP+y1nYGqym6GHUW3
         G1KS0Z2djrszaeWo5XzYXggB/M5ZcYl8bDtSo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=efHAgGpshtwQB8a25gaHEa6aOxL2b4o6cWtKHcAk0Q8OwTZS4btCgR38YmRmq5JK/3
         IcMVKszGgXm8Dc+zJX+Z0otas8SNAiVLdCMSEhWesTyNE8ergQZO8X3d7rG/ULpniqkU
         tsFyc90bnGImwyuEm3M5juxMpCg6rhJcCDgVk=
MIME-Version: 1.0
Received: by 10.140.170.12 with SMTP id s12mr1652135rve.53.1239068418369; Mon, 
	06 Apr 2009 18:40:18 -0700 (PDT)
In-Reply-To: <29434212-18A4-4ADB-9C54-FC102C345406@apache.org>
References: <52c3ddca0904030856m4d5378a7nfbb686baedf8689@mail.gmail.com>
	 <8837fb770904031008y1f7c9841s4a9d969c19b90e41@mail.gmail.com>
	 <1B69876F-6C87-4A1A-8A02-55A4808221B5@zappos.com>
	 <003e01c9b48f$f9990d50$eccb27f0$@com>
	 <8837fb770904031624m227c17bek62db1f3a0d7e809e@mail.gmail.com>
	 <29434212-18A4-4ADB-9C54-FC102C345406@apache.org>
Date: Mon, 6 Apr 2009 18:40:18 -0700
Message-ID: <8837fb770904061840i38c6ada0sd4681d25a6a40697@mail.gmail.com>
Subject: Re: Autonomy search technology
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd2c14aede9a00466ed1850
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd2c14aede9a00466ed1850
Content-Type: text/plain; charset=ISO-8859-2
Content-Transfer-Encoding: quoted-printable

We actually have that implementation thinking of contributing.
-John

On Sat, Apr 4, 2009 at 3:00 PM, Grant Ingersoll <gsingers@apache.org> wrote=
:

> Note that I believe with some work (marking the "zones" during analysis),
> one can accomplish this with Spans without the field creation problem tha=
t
> John mentions.
>
> -Grant
>
>
> On Apr 3, 2009, at 7:24 PM, John Wang wrote:
>
>  Not quite.For example,  # of fields is static thru out the corpus. # zon=
es
>> is per document. E.g. let's say you have 1 million docs, some docs have =
2
>> paragraphs, some 1, and some 10000. You want to limit your search two
>> paragraph 13. How many fields do you create? What if you add a document
>> with
>> 500000 paragraphs, do you create 500000 fields just for that document?
>>
>> -John
>>
>> 2009/4/3 Digy <digydigy@gmail.com>
>>
>>  As far as I can remember, "Zone" in Verity is similar to "field" in
>>> Lucene
>>> and verity performs searches on all "zones" by default.
>>>
>>> DIGY
>>>
>>> -----Original Message-----
>>> From: Matthew Runo [mailto:mruno@zappos.com]
>>> Sent: Friday, April 03, 2009 9:08 PM
>>> To: java-user@lucene.apache.org
>>> Subject: Re: Autonomy search technology
>>>
>>> Would you be willing to explain what "zone search" is? I did a quick
>>> google search, but came up empty handed.
>>>
>>> Thanks for your time!
>>>
>>> Matthew Runo
>>> Software Engineer, Zappos.com
>>> mruno@zappos.com - 702-943-7833
>>>
>>> On Apr 3, 2009, at 10:08 AM, John Wang wrote:
>>>
>>>  Verity VDK, which was bought by autonomy, has zone search. Something
>>>> lucene
>>>> currently does not support.
>>>>
>>>> We have implemented it ontop of lucene and thinking about
>>>> contributing.
>>>>
>>>> -John
>>>>
>>>> On Fri, Apr 3, 2009 at 8:56 AM, Luk=E1=B9 Vl=E8ek <lukas.vlcek@gmail.c=
om>
>>>> wrote:
>>>>
>>>>  Hi,
>>>>> anybody has experience with Automony search technology (
>>>>> http://en.wikipedia.org/wiki/Autonomy_Corporation)? Speaking about
>>>>> their
>>>>> text searching technology is there anything which can not be
>>>>> achieved using
>>>>> Lucene?
>>>>>
>>>>> Regards,
>>>>> Lukas
>>>>>
>>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) using
> Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd2c14aede9a00466ed1850--

From java-user-return-39542-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 03:04:46 2009
Return-Path: <java-user-return-39542-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57411 invoked from network); 7 Apr 2009 03:04:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 03:04:46 -0000
Received: (qmail 63802 invoked by uid 500); 7 Apr 2009 03:04:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63750 invoked by uid 500); 7 Apr 2009 03:04:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63672 invoked by uid 99); 7 Apr 2009 03:04:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 03:04:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [203.217.22.128] (HELO file1.syd.nuix.com) (203.217.22.128)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 03:04:35 +0000
Received: from [192.168.222.60] (monolith.syd.nuix.com [192.168.222.60])
	by file1.syd.nuix.com (Postfix) with ESMTP id 848424A816A
	for <java-user@lucene.apache.org>; Tue,  7 Apr 2009 13:04:12 +1000 (EST)
Message-ID: <49DAC2CC.10806@nuix.com>
Date: Tue, 07 Apr 2009 13:04:44 +1000
From: Daniel Noll <daniel@nuix.com>
Organization: Nuix Pty Ltd
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: Lucene Mailing List <java-user@lucene.apache.org>
Subject: Internals question: BooleanQuery with many TermQuery children
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all.

This is something I have been wondering for a while but can't find a 
good answer by reading the code myself.

If you have a query like this:

   ( field:Value1 OR
     field:Value2 OR
     field:Value3 OR
      ... )

How many TermEnum / TermDocs scans should this execute?

(a) One per clause, or
(b) One for the entire boolean query?

I wonder because we do use a lot of queries of this nature, and I can't 
find any direct evidence that they get logically merged, leading me to 
believe that it's one per clause at present (and thus this becomes a 
potential optimisation.)

Daniel


-- 
Daniel Noll                            Forensic and eDiscovery Software
Senior Developer                              The world's most advanced
Nuix                                                email data analysis
http://nuix.com/                                and eDiscovery software

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39543-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 07:20:46 2009
Return-Path: <java-user-return-39543-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47489 invoked from network); 7 Apr 2009 07:20:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 07:20:45 -0000
Received: (qmail 25198 invoked by uid 500); 7 Apr 2009 07:20:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25111 invoked by uid 500); 7 Apr 2009 07:20:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25101 invoked by uid 99); 7 Apr 2009 07:20:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 07:20:42 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.27] (HELO smtp-vbr7.xs4all.nl) (194.109.24.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 07:20:33 +0000
Received: from k8u.localnet (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr7.xs4all.nl (8.13.8/8.13.8) with ESMTP id n377KDIK014336
	for <java-user@lucene.apache.org>; Tue, 7 Apr 2009 09:20:13 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Internals question: BooleanQuery with many TermQuery children
Date: Tue, 7 Apr 2009 09:20:11 +0200
User-Agent: KMail/1.10.4 (Linux/2.6.27-11-generic; KDE/4.1.4; i686; ; )
References: <49DAC2CC.10806@nuix.com>
In-Reply-To: <49DAC2CC.10806@nuix.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
  boundary="Boundary-00=_s6v2JNRIuxOUeCc"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200904070920.12671.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

--Boundary-00=_s6v2JNRIuxOUeCc
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit

On Tuesday 07 April 2009 05:04:44 Daniel Noll wrote:
> Hi all.
> 
> This is something I have been wondering for a while but can't find a 
> good answer by reading the code myself.
> 
> If you have a query like this:
> 
>    ( field:Value1 OR
>      field:Value2 OR
>      field:Value3 OR
>       ... )
> 
> How many TermEnum / TermDocs scans should this execute?
> 
> (a) One per clause, or
> (b) One for the entire boolean query?

One per clause.

> 
> I wonder because we do use a lot of queries of this nature, and I can't 
> find any direct evidence that they get logically merged, leading me to 
> believe that it's one per clause at present (and thus this becomes a 
> potential optimisation.)

The problem is not only in the scanning of the TermDocs, but also in
the merging by docId (on a heap) that has to take place when more of them
are used at the same time during the query search.

Some optimisations are already in place:
- By allowing docs scored out of order, most top level OR queries
  can be merged with a faster algorithm (distributive sort over docId ranges)
  using the term frequencies (see BooleanQuery.setAllowDocsOutOfOrder())
- Various Filters that merge into a bitset, using a single TermDocs
  and ignoring term frequencies, (see MultiTermQuery.getFilter()).
- The new TrieRangeFilter that premerges ranges at indexing time,
  also ignoring term frequencies.

Using the TermDocs one by one has another advantage in that it
reduces disk seek distances in the index. This is noticeable when
disks have heads that take more time to move longer distances.
SSD's don't have moving heads, so they have smaller performance
differences between merging into a bitset, by distributive sort,
and by a heap.

For the time being, Lucene does not have a low level facility for key values
that occur at most once per document field, so for these it normally helps
to use a Filter.

Regards,
Paul Elschot

--Boundary-00=_s6v2JNRIuxOUeCc--

From java-user-return-39544-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 09:03:28 2009
Return-Path: <java-user-return-39544-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91519 invoked from network); 7 Apr 2009 09:03:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 09:03:28 -0000
Received: (qmail 22143 invoked by uid 500); 7 Apr 2009 09:03:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22072 invoked by uid 500); 7 Apr 2009 09:03:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22062 invoked by uid 99); 7 Apr 2009 09:03:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 09:03:25 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.170] (HELO wf-out-1314.google.com) (209.85.200.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 09:03:17 +0000
Received: by wf-out-1314.google.com with SMTP id 29so2422364wff.20
        for <java-user@lucene.apache.org>; Tue, 07 Apr 2009 02:02:56 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.4.11 with SMTP id g11mr1561938wfi.340.1239094976542; Tue, 
	07 Apr 2009 02:02:56 -0700 (PDT)
In-Reply-To: <22916108.post@talk.nabble.com>
References: <22916108.post@talk.nabble.com>
Date: Tue, 7 Apr 2009 05:02:56 -0400
Message-ID: <9ac0c6aa0904070202m3bcec845qa6d4791c12065275@mail.gmail.com>
Subject: Re: boost and score doubt
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Negative boosts are accepted, though rather "unusual".  Also note that
Lucene by default filters out any hits with scores <=3D 0.0.

Normally you'd set boost to something > 0.0 (0.1 should work).

What unexpected effect are you seeing?

If you omit norms, then indeed your per-doc boost (and per-field
boost, if used) are discarded (have no effect).

Mike

On Mon, Apr 6, 2009 at 4:01 PM, Marc Sturlese <marc.sturlese@gmail.com> wro=
te:
>
> Hey there,
> Does de function doc.setBoost(x.y) accept negative values or values minor
> than 1?? I mean... it compile and doesn't give errors but the behabiour i=
s
> not exactly what I was expecting.
> In my use case I have the field title... I want to give very very low
> relevance to the documents witch title has less that 40 characters. I hav=
e
> tried setting boost to negatives values or to 0.1
> Wich is the best way to do that?
> Is there any range of values for setting boost?
>
> And another thing that confuses me... =A0if I omit norms is the score
> function... how does it affect to the boosting I am setting? does it loos=
e
> the effect?
>
> Thanks in advance!
> --
> View this message in context: http://www.nabble.com/boost-and-score-doubt=
-tp22916108p22916108.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39545-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 09:48:37 2009
Return-Path: <java-user-return-39545-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19692 invoked from network); 7 Apr 2009 09:48:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 09:48:37 -0000
Received: (qmail 67122 invoked by uid 500); 7 Apr 2009 09:48:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67031 invoked by uid 500); 7 Apr 2009 09:48:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67020 invoked by uid 99); 7 Apr 2009 09:48:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 09:48:33 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 09:48:24 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lr7uV-0007B6-Ee
	for java-user@lucene.apache.org; Tue, 07 Apr 2009 02:48:03 -0700
Message-ID: <22925764.post@talk.nabble.com>
Date: Tue, 7 Apr 2009 02:48:03 -0700 (PDT)
From: Marc Sturlese <marc.sturlese@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: boost and score doubt
In-Reply-To: <9ac0c6aa0904070202m3bcec845qa6d4791c12065275@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: marc.sturlese@gmail.com
References: <22916108.post@talk.nabble.com> <9ac0c6aa0904070202m3bcec845qa6d4791c12065275@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


That was my problem... I was ommiting norms, so the boost I gave at the
document at index time was not taking effect.
Since I stop omitting them results have changed completely.
Thanks!


Michael McCandless-2 wrote:
>=20
> Negative boosts are accepted, though rather "unusual".  Also note that
> Lucene by default filters out any hits with scores <=3D 0.0.
>=20
> Normally you'd set boost to something > 0.0 (0.1 should work).
>=20
> What unexpected effect are you seeing?
>=20
> If you omit norms, then indeed your per-doc boost (and per-field
> boost, if used) are discarded (have no effect).
>=20
> Mike
>=20
> On Mon, Apr 6, 2009 at 4:01 PM, Marc Sturlese <marc.sturlese@gmail.com>
> wrote:
>>
>> Hey there,
>> Does de function doc.setBoost(x.y) accept negative values or values mino=
r
>> than 1?? I mean... it compile and doesn't give errors but the behabiour
>> is
>> not exactly what I was expecting.
>> In my use case I have the field title... I want to give very very low
>> relevance to the documents witch title has less that 40 characters. I
>> have
>> tried setting boost to negatives values or to 0.1
>> Wich is the best way to do that?
>> Is there any range of values for setting boost?
>>
>> And another thing that confuses me... =C2=A0if I omit norms is the score
>> function... how does it affect to the boosting I am setting? does it
>> loose
>> the effect?
>>
>> Thanks in advance!
>> --
>> View this message in context:
>> http://www.nabble.com/boost-and-score-doubt-tp22916108p22916108.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/boost-and-score-doubt-t=
p22916108p22925764.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39546-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 10:24:03 2009
Return-Path: <java-user-return-39546-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33252 invoked from network); 7 Apr 2009 10:24:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 10:24:03 -0000
Received: (qmail 1968 invoked by uid 500); 7 Apr 2009 10:24:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1897 invoked by uid 500); 7 Apr 2009 10:24:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 11652 invoked by uid 99); 7 Apr 2009 07:08:45 -0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of spee.zhang@gmail.com designates 74.125.44.29 as permitted sender)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=gWQ3fsuO+eC8Wzh2adyhPpGedg5I4Qph8W1n1adFf1U=;
        b=xHxqb1gcr38gURX7Y/CYCnPEAAU5GGeiz1Ip+okSCKmX12MgX7G+Jp1Lsu4wh93zB4
         BCHIWU4UZ6ZFb2fzlHQYlWm8hMZLAAfTHhwrQNSZMb7HFUZQu7g9dd8qNnZRIW2DjSt2
         pPB2eZegyB9mvgU518GKaFSCwoQJxeB6vhgpo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=LOsWwTyrCwCPQEvg8P5UCXWDuHEf4RIX1FeBHnnc/EurmeyJYcxwYqRN6g7bnqdq3O
         mGqWqxep+L8hmBWMuyoNtqzgf08wHfSWuqs90RtbHA7RVsHaI9QHWjbicwlsY2MFhBkF
         okrSDWAu4pl2gNF1aoxwJA5je3inkJao6IPYc=
MIME-Version: 1.0
In-Reply-To: <d4e666ac0904070005j355175e9qc59546fe0ba3f54a@mail.gmail.com>
References: <d4e666ac0904070005j355175e9qc59546fe0ba3f54a@mail.gmail.com>
Date: Tue, 7 Apr 2009 15:08:18 +0800
Message-ID: <d4e666ac0904070008o50d5e74eh530a621d8974f201@mail.gmail.com>
Subject: How to customize score according to field value?
From: Jinming Zhang <spee.zhang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0003255762caf0e6ea0466f1ad7d
X-Virus-Checked: Checked by ClamAV on apache.org

--0003255762caf0e6ea0466f1ad7d
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

Hi,

I have the following situation which needs to customize the final score
according to field value.

Suppose there are two docs in my query result, and they are ordered by
default score sort:

doc1(field1:bookA, field2:2000-01-01) -- score:0.80
doc2(field1:bookB, filed2:2009-01-01) -- score:0.70

I want "doc2" to have a higher score since it's publishing date is more
recent, while "doc1" to have a lower score:

doc2(field1:bookB, filed2:2009-01-01) -- score:0.77
doc1(field1:bookA, field2:2000-01-01) -- score:0.73

I found this scenario is different from doc.setBoost() and field.setBoost().
Is there any way to impact the score calculated for "doc1" & "doc2"
according to the value of "field2"?

Thank you in advance!

--0003255762caf0e6ea0466f1ad7d--

From java-user-return-39547-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 12:48:36 2009
Return-Path: <java-user-return-39547-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17031 invoked from network); 7 Apr 2009 12:48:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 12:48:35 -0000
Received: (qmail 82556 invoked by uid 500); 7 Apr 2009 12:48:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82473 invoked by uid 500); 7 Apr 2009 12:48:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82463 invoked by uid 99); 7 Apr 2009 12:48:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 12:48:33 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 12:48:25 +0000
Received: by qyk8 with SMTP id 8so593105qyk.29
        for <java-user@lucene.apache.org>; Tue, 07 Apr 2009 05:48:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=/GkVE3leXVub8tzdme87R5JV+Q70Dyip/8ucaJCoaxU=;
        b=onOhwneNOaHUUK2OfNzBrwMruv3jZYxrVYG/RPBaqh7HQe7BKb3QjpbLReWobfAQPM
         Jhrx1pLUH4X8ctMrIbMO/IadVLLLxNlhnbDf7cWRHCJZIwB0aIWoHsuno56nrcELtRGr
         xlxsegRdQmO/rw/jsbDr2tjCtJKtD+CBQ0VKM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=LL/MizHgCw9HYfrcYYquqwScrdhLhx8ooVW8WcBKl/xapVIpY2rRqBCkBJgftjsNam
         E63qwJ6nGCI9XTwDYCAaTLFSin3y6CxJVaninSFJmHDCYVJEBdBhMktEyNF8tFIWkQ8H
         2WS5+d0m8k9V/ylZO8+SVMMuoXwr0S6ab+DBQ=
MIME-Version: 1.0
Received: by 10.220.72.80 with SMTP id l16mr136286vcj.99.1239108484144; Tue, 
	07 Apr 2009 05:48:04 -0700 (PDT)
In-Reply-To: <d4e666ac0904070008o50d5e74eh530a621d8974f201@mail.gmail.com>
References: <d4e666ac0904070005j355175e9qc59546fe0ba3f54a@mail.gmail.com>
	 <d4e666ac0904070008o50d5e74eh530a621d8974f201@mail.gmail.com>
Date: Tue, 7 Apr 2009 08:48:04 -0400
Message-ID: <359a92830904070548i1dbfd7a0v4ada6c669f65955@mail.gmail.com>
Subject: Re: How to customize score according to field value?
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e645f8f20921df0466f66d94
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e645f8f20921df0466f66d94
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Do you want the dates to *influence* or *determine* the order? I
don't have much help if what you're after is something like "docs
that are more recent tend to rank higher", although I vaguely
remember this question coming up on the user list, maybe a
search of the archive would turn something helpful up...

But if you want the date to completely determine order you can
always sort by date, see some of the IndexSearcher.search(...sort...)
methods.


Best
Erick


On Tue, Apr 7, 2009 at 3:08 AM, Jinming Zhang <spee.zhang@gmail.com> wrote:

> Hi,
>
> I have the following situation which needs to customize the final score
> according to field value.
>
> Suppose there are two docs in my query result, and they are ordered by
> default score sort:
>
> doc1(field1:bookA, field2:2000-01-01) -- score:0.80
> doc2(field1:bookB, filed2:2009-01-01) -- score:0.70
>
> I want "doc2" to have a higher score since it's publishing date is more
> recent, while "doc1" to have a lower score:
>
> doc2(field1:bookB, filed2:2009-01-01) -- score:0.77
> doc1(field1:bookA, field2:2000-01-01) -- score:0.73
>
> I found this scenario is different from doc.setBoost() and
> field.setBoost().
> Is there any way to impact the score calculated for "doc1" & "doc2"
> according to the value of "field2"?
>
> Thank you in advance!
>

--0016e645f8f20921df0466f66d94--

From java-user-return-39548-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 12:58:13 2009
Return-Path: <java-user-return-39548-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21861 invoked from network); 7 Apr 2009 12:58:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 12:58:12 -0000
Received: (qmail 93144 invoked by uid 500); 7 Apr 2009 12:58:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93055 invoked by uid 500); 7 Apr 2009 12:58:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93044 invoked by uid 99); 7 Apr 2009 12:58:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 12:58:10 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [61.95.162.82] (HELO kecgate06.infosys.com) (61.95.162.82)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 12:58:03 +0000
X-TM-IMSS-Message-ID:<632b20eb000067b7@kecgate06.infosys.com>
Received: from blrkechub04.ad.infosys.com ([10.66.236.44]) by kecgate06.infosys.com ([61.95.162.82]) with ESMTP (TREND IMSS SMTP Service 7.0; TLS: TLSv1/SSLv3,128bits,RC4-MD5) id 632b20eb000067b7 ; Tue, 7 Apr 2009 18:28:11 +0530
Received: from BLRKECMBX06.ad.infosys.com ([10.66.236.32]) by
 blrkechub04.ad.infosys.com ([10.66.236.44]) with mapi; Tue, 7 Apr 2009
 18:27:39 +0530
From: Allahbaksh Mohammedali Asadullah <Allahbaksh_Asadullah@infosys.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Tue, 7 Apr 2009 18:27:38 +0530
Subject: RE: Multiple Analyzer on Single field
Thread-Topic: Multiple Analyzer on Single field
Thread-Index: Acm20PE8sx69QxviRb6OFKnZv53vsQArxOqA
Message-ID: <68959F25CDEBCB4F917D5A253291D73E0D99721F54@BLRKECMBX06.ad.infosys.com>
References: <68959F25CDEBCB4F917D5A253291D73E0D99721AEC@BLRKECMBX06.ad.infosys.com>
 <359a92830904060900m2c7cf884p4182ec9ac87e1bbf@mail.gmail.com>
In-Reply-To: <359a92830904060900m2c7cf884p4182ec9ac87e1bbf@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,
Sorry for the confused email.

Suppose I have a field text with content below

KeyWordAnalyzer is a class. this keyword is used in java.

Here the KeyWordAnalyzer into Key Word Analyzer and class should be a Key w=
ord. So if some one search. Apart from this I want Key Word Analzer to toke=
nized properly so that search become better.
Regards,
Allahbaksh
=20
=20
=20
-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]=20
Sent: Monday, April 06, 2009 9:31 PM
To: java-user@lucene.apache.org
Subject: Re: Multiple Analyzer on Single field

This really doesn't make sense. KeywordAnalyzer will NOT
tokenize the input stream. StandardAnalyzer WILL tokenize
the input stream. I can't imagine what it means to do both at
the same time.

Perhaps you could give us some examples of what your desired
inputs and outputs are we could steer you in the right direction.

I suspect you're thinking more in terms of TokenFilters and/or
Tokenizers...

Best
Erick

On Mon, Apr 6, 2009 at 10:52 AM, Allahbaksh Mohammedali Asadullah <
Allahbaksh_Asadullah@infosys.com> wrote:

> Hi,
> I want to add multiple Analyzer on single field. I want properties of
> KeywordAnalyzer, SimpleAnalyzer, StandardAnalyzer, WhiteSpaceAnalyzer. Is
> there any easy way to have all analyzer bundled on single field.
> Regards,
> Allahbaksh
>
>
>
>
>
>
>
> **************** CAUTION - Disclaimer *****************
> This e-mail contains PRIVILEGED AND CONFIDENTIAL INFORMATION intended
> solely
> for the use of the addressee(s). If you are not the intended recipient,
> please
> notify the sender by e-mail and delete the original message. Further, you
> are not
> to copy, disclose, or distribute this e-mail or its contents to any other
> person and
> any such actions are unlawful. This e-mail may contain viruses. Infosys h=
as
> taken
> every reasonable precaution to minimize this risk, but is not liable for
> any damage
> you may sustain as a result of any virus in this e-mail. You should carry
> out your
> own virus checks before opening the e-mail or attachment. Infosys reserve=
s
> the
> right to monitor and review the content of all messages sent to or from
> this e-mail
> address. Messages sent to or from this e-mail address may be stored on th=
e
> Infosys e-mail system.
> ***INFOSYS******** End of Disclaimer ********INFOSYS***
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39549-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 13:01:53 2009
Return-Path: <java-user-return-39549-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24151 invoked from network); 7 Apr 2009 13:01:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 13:01:51 -0000
Received: (qmail 99549 invoked by uid 500); 7 Apr 2009 13:01:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99519 invoked by uid 500); 7 Apr 2009 13:01:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99509 invoked by uid 99); 7 Apr 2009 13:01:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 13:01:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of williamstw@gmail.com designates 74.125.46.28 as permitted sender)
Received: from [74.125.46.28] (HELO yw-out-2324.google.com) (74.125.46.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 13:01:38 +0000
Received: by yw-out-2324.google.com with SMTP id 9so1510171ywe.5
        for <java-user@lucene.apache.org>; Tue, 07 Apr 2009 06:01:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=rW5uiV2Avq4Tmb1Ju2gtZigPQdEym5CMJUgRBYQOMKc=;
        b=VWvuiwMWduu40PgiGCLkIdC4TbuEdNpnY1qQ6hdSQnp9npW/2NB29KqqZYuEyYVEbz
         7Ihpa4BzroSAO7kmuIQX+ae1bkx6bFh9oWfYSfVaynI4k+jZD+LeQvN8VVt/rhoNEd3M
         d50VUxzIN1JSoTqFI+zDUh1TgrS43uOdx/TF8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=oQXYpaW93FifaeT7T7ourJg+U1VBB0NQQygIw1JKuxhfPH/NbzsN5hsXLnKbym4XY7
         8mLKMml0Y0xqFF/XGzbRRCj62pMKrFlspO0qZMU0lXlYAVSDSdiccP9Gfhzak9qUNOyr
         gs/YjriSltFaydSltQ8yhNG8TZYCweOVhvvXA=
MIME-Version: 1.0
Received: by 10.151.27.9 with SMTP id e9mr363584ybj.18.1239109278326; Tue, 07 
	Apr 2009 06:01:18 -0700 (PDT)
In-Reply-To: <d4e666ac0904070008o50d5e74eh530a621d8974f201@mail.gmail.com>
References: <d4e666ac0904070005j355175e9qc59546fe0ba3f54a@mail.gmail.com>
	 <d4e666ac0904070008o50d5e74eh530a621d8974f201@mail.gmail.com>
Date: Tue, 7 Apr 2009 09:01:18 -0400
Message-ID: <499888440904070601h4ce0f894ve2b35d6ae5f81826@mail.gmail.com>
Subject: Re: How to customize score according to field value?
From: Tim Williams <williamstw@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, Apr 7, 2009 at 3:08 AM, Jinming Zhang <spee.zhang@gmail.com> wrote:
> Hi,
>
> I have the following situation which needs to customize the final score
> according to field value.
>
> Suppose there are two docs in my query result, and they are ordered by
> default score sort:
>
> doc1(field1:bookA, field2:2000-01-01) -- score:0.80
> doc2(field1:bookB, filed2:2009-01-01) -- score:0.70
>
> I want "doc2" to have a higher score since it's publishing date is more
> recent, while "doc1" to have a lower score:
>
> doc2(field1:bookB, filed2:2009-01-01) -- score:0.77
> doc1(field1:bookA, field2:2000-01-01) -- score:0.73
>
> I found this scenario is different from doc.setBoost() and field.setBoost().
> Is there any way to impact the score calculated for "doc1" & "doc2"
> according to the value of "field2"?
>
> Thank you in advance!

If you have access to the MEAP for Lucine In Action 2nd Edition, it
demonstrates using a CustomScoreQuery[1] for to boost a docs score
based on recency.

--tim

[1] - http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/search/function/CustomScoreQuery.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39550-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 13:20:29 2009
Return-Path: <java-user-return-39550-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39142 invoked from network); 7 Apr 2009 13:20:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 13:20:25 -0000
Received: (qmail 18861 invoked by uid 500); 7 Apr 2009 13:20:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18768 invoked by uid 500); 7 Apr 2009 13:20:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18758 invoked by uid 99); 7 Apr 2009 13:20:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 13:20:23 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 74.125.92.24 as permitted sender)
Received: from [74.125.92.24] (HELO qw-out-2122.google.com) (74.125.92.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 13:20:14 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1895508qwh.53
        for <java-user@lucene.apache.org>; Tue, 07 Apr 2009 06:19:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=htgnUkMPDzDcQ/nFOsRap1ieT6x37y1aoNKQlhXGey8=;
        b=TloQCGxF7JFV5Az9yM84cXFdQ9WTK6kPjX57k1KiCitlnare5Xzm1uaMuuWCUFydow
         uWt7dCzAw46EGd70wx53bAf2aQpXyHAoVEYRydC49dNEAgzvJ9t40RZvnSuE3yxAIKn6
         xDL9l0P15kp6hx0rlC5xflS8BuINcJimpIBIg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=fl6RifLQ7G7rQ5IqGSlQoROBt0rUkh0lk+49bcoA46vWuQGj6bIMuzc24U0DUXqS+L
         CgCZeleGRh13hPCKkmo8pS2AnLSqZnKfG+r+MOVGOElez2oCU1BpmQbxMFwuC8JEVpOu
         2bpQII9C2BmGpwHGvd0LZQ6B+NKI9NX5yQB+U=
MIME-Version: 1.0
Received: by 10.220.96.135 with SMTP id h7mr207964vcn.87.1239110393616; Tue, 
	07 Apr 2009 06:19:53 -0700 (PDT)
In-Reply-To: <68959F25CDEBCB4F917D5A253291D73E0D99721F54@BLRKECMBX06.ad.infosys.com>
References: <68959F25CDEBCB4F917D5A253291D73E0D99721AEC@BLRKECMBX06.ad.infosys.com>
	 <359a92830904060900m2c7cf884p4182ec9ac87e1bbf@mail.gmail.com>
	 <68959F25CDEBCB4F917D5A253291D73E0D99721F54@BLRKECMBX06.ad.infosys.com>
Date: Tue, 7 Apr 2009 09:19:53 -0400
Message-ID: <359a92830904070619q53347d18u2a0838bf1848ab72@mail.gmail.com>
Subject: Re: Multiple Analyzer on Single field
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64718aad959ba0466f6decc
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64718aad959ba0466f6decc
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hmmmm. There's nothing in Lucene that I know of that will do what you
want, you'll have to do one of two things:

In general, you'll have to break up your token stream yourself, either
through pre-processing or building your own analyzers. There's
nothing already built that I know of that will break up, for instance,
KeyWordAnalyzer into three tokens.

Part of the confusion is the use of the phrase "keyword" as in
"and class should be a Key word". If I'm reading this right, you'll
want "class" to be in a separate field since it's special (in your
context). Again, to accomplish this you either need to pre-process
the input stream, extract "class", and put it in a separate field or
create your own analyzer that extracts only "class" from the
input stream. Then you'd feed the entire contents into *both* fields (say
"content" and "key"). The analyzer attached to the "content" field
(see PerFieldAnalyzerWrapper) would take care of breaking up
things like KeyWordAnalyzer, and the analyzer attached to the
"key" field would throw away everything except "class"..

Hope this helps
Erick

On Tue, Apr 7, 2009 at 8:57 AM, Allahbaksh Mohammedali Asadullah <
Allahbaksh_Asadullah@infosys.com> wrote:

> Hi All,
> Sorry for the confused email.
>
> Suppose I have a field text with content below
>
> KeyWordAnalyzer is a class. this keyword is used in java.
>
> Here the KeyWordAnalyzer into Key Word Analyzer and class should be a Key
> word. So if some one search. Apart from this I want Key Word Analzer to
> tokenized properly so that search become better.
> Regards,
> Allahbaksh
>
>
>
> -----Original Message-----
> From: Erick Erickson [mailto:erickerickson@gmail.com]
> Sent: Monday, April 06, 2009 9:31 PM
> To: java-user@lucene.apache.org
> Subject: Re: Multiple Analyzer on Single field
>
> This really doesn't make sense. KeywordAnalyzer will NOT
> tokenize the input stream. StandardAnalyzer WILL tokenize
> the input stream. I can't imagine what it means to do both at
> the same time.
>
> Perhaps you could give us some examples of what your desired
> inputs and outputs are we could steer you in the right direction.
>
> I suspect you're thinking more in terms of TokenFilters and/or
> Tokenizers...
>
> Best
> Erick
>
> On Mon, Apr 6, 2009 at 10:52 AM, Allahbaksh Mohammedali Asadullah <
> Allahbaksh_Asadullah@infosys.com> wrote:
>
> > Hi,
> > I want to add multiple Analyzer on single field. I want properties of
> > KeywordAnalyzer, SimpleAnalyzer, StandardAnalyzer, WhiteSpaceAnalyzer. Is
> > there any easy way to have all analyzer bundled on single field.
> > Regards,
> > Allahbaksh
> >
> >
> >
> >
> >
> >
> >
> > **************** CAUTION - Disclaimer *****************
> > This e-mail contains PRIVILEGED AND CONFIDENTIAL INFORMATION intended
> > solely
> > for the use of the addressee(s). If you are not the intended recipient,
> > please
> > notify the sender by e-mail and delete the original message. Further, you
> > are not
> > to copy, disclose, or distribute this e-mail or its contents to any other
> > person and
> > any such actions are unlawful. This e-mail may contain viruses. Infosys
> has
> > taken
> > every reasonable precaution to minimize this risk, but is not liable for
> > any damage
> > you may sustain as a result of any virus in this e-mail. You should carry
> > out your
> > own virus checks before opening the e-mail or attachment. Infosys
> reserves
> > the
> > right to monitor and review the content of all messages sent to or from
> > this e-mail
> > address. Messages sent to or from this e-mail address may be stored on
> the
> > Infosys e-mail system.
> > ***INFOSYS******** End of Disclaimer ********INFOSYS***
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64718aad959ba0466f6decc--

From java-user-return-39551-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 13:32:32 2009
Return-Path: <java-user-return-39551-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51058 invoked from network); 7 Apr 2009 13:32:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 13:32:32 -0000
Received: (qmail 43728 invoked by uid 500); 7 Apr 2009 13:32:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43655 invoked by uid 500); 7 Apr 2009 13:32:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43645 invoked by uid 99); 7 Apr 2009 13:32:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 13:32:29 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 13:32:20 +0000
Received: by fxm2 with SMTP id 2so2595565fxm.5
        for <java-user@lucene.apache.org>; Tue, 07 Apr 2009 06:31:58 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.204.54.143 with SMTP id q15mr111121bkg.148.1239111117755; Tue, 
	07 Apr 2009 06:31:57 -0700 (PDT)
In-Reply-To: <170D50E2-6C26-469A-91EE-9A8603FAF731@gmail.com>
References: <9d172ab60904060559p751336a0h89a07fdaec7a557e@mail.gmail.com>
	 <170D50E2-6C26-469A-91EE-9A8603FAF731@gmail.com>
Date: Tue, 7 Apr 2009 14:31:57 +0100
Message-ID: <9d172ab60904070631na1446b9l8cba145f7c48cd74@mail.gmail.com>
Subject: Re: Lucene and Phrase Correction
From: Glyn Darkin <glyn@darkinsystems.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Karl,

Thankyou for your in-depth reply. This has given me good grounds to go on.

Regards

Glyn


2009/4/6 Karl Wettin <karl.wettin@gmail.com>:
> 6 apr 2009 kl. 14.59 skrev Glyn Darkin:
>
> Hi Glyn,
>
>> to be able to spell check phrases
>>
>> E.g
>>
>> "Harry Poter" is converted to "Harry Potter"
>>
>> We have a fixed dataset so can build indexes/ dictionaries from our
>> own data.
>
> the most obvious solution is index your contrib/spell checker with shingl=
es.
> This will however probably only help out with exact phrases. Perhaps that=
 is
> enough for you.
>
> If your example is a real one that you came up with by analyzing query lo=
gs
> then you might want consider creating an index "stemmed" to handle variou=
s
> problems associated with reading and writing disorders. Dyslectic people
> often miss out on vowels, they who suffer from dysgraphia have problems w=
ith
> q/p/d/b, other have problems with reoccuring characters, et c. A combinat=
ion
> of these problems could end up in a secondary "fuzzy" index that contains
> weighted shingles like this for the document that points at "harry potter=
":
>
> "hary poter"^0.9
> "harry #otter"^0.8
> "hary #oter"^0.7
> "hrry pttr"^0.7
> "hry ptr"^0.5
>
> In order to get a good precision/recall your query to such an index would
> have to produce a boolean query containing all of the "stems" above if th=
e
> input was spelled correct.
>
>
> One alternative to the contrib/spell checker is Spelt:
> http://groups.google.com/group/spelt/=A0and I believe it is supposed to h=
andle
> phrases.
>
>
> Note the difference between spell checking and suggestion schemes. Someth=
ing
> can be wrong even though the spelling is correct. Consider the game "Hero=
es
> of might and magic", people might have fogotten what it was called and
> search for "Heroes of light and magic" instead. Hopefully your query woul=
d
> still yield a fairly good result for the correct document if the latter w=
as
> entered, but if you require all terms or something similar then it might
> return no hits.
>
>
> More advanced strategies for contextual spell checking of phrases usually
> involve statistical models such as neural networs, hidden markov models, =
et
> c. LingPipe contains such an implementation.
>
>
> You can also take a look at reinforcement learning, learning from the
> misstakes and corrections made by your users. It requires a lot of data
> (user query logs) in order to work but will yeild very cool results such =
as
> acronyms.
>
> LUCENE-626 is a multi layered spell checker with reinforcement learning i=
n
> the top, backed by an a priori corpus (that can be compiled from old user
> queries) used to find context. It also use a refactored version of the
> contrib/spell checker as second level suggestion when there is nothing to
> pick up from previous user behaviour. I never deployed this in a real
> system, it does however seem to work great when trained with a few hundre=
d
> thousand query sessions.
>
>
> Finally I recommend that you take some time to analyze user query session=
s
> to find what the most common problems your users have and try to find a
> solution that best fit those problems. Too often features are implemented
> because they are listed in a specification and not because the users need
> them.
>
>
> I hope this helps.
>
> =A0 =A0 karl
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Glyn Darkin

Darkin Systems Ltd
Mob: 07961815649
Fax: 08717145065
Web: www.darkinsystems.com

Company No: 6173001
VAT No: 906350835

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39552-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 17:48:00 2009
Return-Path: <java-user-return-39552-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7286 invoked from network); 7 Apr 2009 17:48:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 17:48:00 -0000
Received: (qmail 34264 invoked by uid 500); 7 Apr 2009 17:47:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34205 invoked by uid 500); 7 Apr 2009 17:47:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34195 invoked by uid 99); 7 Apr 2009 17:47:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 17:47:58 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of pjaol@pjaol.com)
Received: from [74.125.46.29] (HELO yw-out-2324.google.com) (74.125.46.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 17:47:50 +0000
Received: by yw-out-2324.google.com with SMTP id 9so1592497ywe.5
        for <java-user@lucene.apache.org>; Tue, 07 Apr 2009 10:47:27 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.148.1 with SMTP id v1mr766370ybd.78.1239126447676; Tue, 07 
	Apr 2009 10:47:27 -0700 (PDT)
In-Reply-To: <499888440904070601h4ce0f894ve2b35d6ae5f81826@mail.gmail.com>
References: <d4e666ac0904070005j355175e9qc59546fe0ba3f54a@mail.gmail.com>
	 <d4e666ac0904070008o50d5e74eh530a621d8974f201@mail.gmail.com>
	 <499888440904070601h4ce0f894ve2b35d6ae5f81826@mail.gmail.com>
Date: Tue, 7 Apr 2009 13:47:27 -0400
Message-ID: <1e33aedb0904071047u5fd0815dyc8d8cb95da8b6f27@mail.gmail.com>
Subject: Re: How to customize score according to field value?
From: "patrick o'leary" <pjaol@pjaol.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd4d7a0bede6c0466fa9b78
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd4d7a0bede6c0466fa9b78
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

You might want to play with both boosting and multiple sorting.
You might want to look at something like Solr's boost queries or boost
functions
http://wiki.apache.org/solr/DisMaxRequestHandler#head-6862070cf279d9a09bdab971309135c7aea22fb3

Or if you want to go down the path of a custom score, most folks
override the customScore method of CustomScoreQuery

*//create a term query to search against all documents*
Query tq = *new* TermQuery(*new* Term(*"metafile"*, *"doc"*));
	
FieldScoreQuery fsQuery = *new* FieldScoreQuery(*"geo_distance"*, Type.FLOAT);
CustomScoreQuery customScore = *new* CustomScoreQuery(tq,fsQuery){
   @Override
   *public* *float* customScore(*int* doc, *float* subQueryScore,
*float* valSrcScore){
     .....
     return myFunkyScore;
   }
}


You can see a quick version in
http://svn.apache.org/viewvc/lucene/java/trunk/contrib/spatial/src/test/org/apache/lucene/spatial/tier/TestCartesian.java?revision=762801&view=markup

HTH
P

On Tue, Apr 7, 2009 at 9:01 AM, Tim Williams <williamstw@gmail.com> wrote:

> On Tue, Apr 7, 2009 at 3:08 AM, Jinming Zhang <spee.zhang@gmail.com>
> wrote:
> > Hi,
> >
> > I have the following situation which needs to customize the final score
> > according to field value.
> >
> > Suppose there are two docs in my query result, and they are ordered by
> > default score sort:
> >
> > doc1(field1:bookA, field2:2000-01-01) -- score:0.80
> > doc2(field1:bookB, filed2:2009-01-01) -- score:0.70
> >
> > I want "doc2" to have a higher score since it's publishing date is more
> > recent, while "doc1" to have a lower score:
> >
> > doc2(field1:bookB, filed2:2009-01-01) -- score:0.77
> > doc1(field1:bookA, field2:2000-01-01) -- score:0.73
> >
> > I found this scenario is different from doc.setBoost() and
> field.setBoost().
> > Is there any way to impact the score calculated for "doc1" & "doc2"
> > according to the value of "field2"?
> >
> > Thank you in advance!
>
> If you have access to the MEAP for Lucine In Action 2nd Edition, it
> demonstrates using a CustomScoreQuery[1] for to boost a docs score
> based on recency.
>
> --tim
>
> [1] -
> http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/search/function/CustomScoreQuery.html
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd4d7a0bede6c0466fa9b78--

From java-user-return-39553-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 21:26:29 2009
Return-Path: <java-user-return-39553-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91311 invoked from network); 7 Apr 2009 21:26:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 21:26:29 -0000
Received: (qmail 13074 invoked by uid 500); 7 Apr 2009 21:13:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13054 invoked by uid 500); 7 Apr 2009 21:13:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13044 invoked by uid 99); 7 Apr 2009 21:13:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 21:13:14 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of isaacrc82@gmail.com designates 209.85.132.246 as permitted sender)
Received: from [209.85.132.246] (HELO an-out-0708.google.com) (209.85.132.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 21:13:06 +0000
Received: by an-out-0708.google.com with SMTP id b2so1676758ana.5
        for <java-user@lucene.apache.org>; Tue, 07 Apr 2009 14:12:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=8mfNy6+sA5K+X6Spj31VauWSOD5IsxKA9mhEB1OVSuQ=;
        b=feOeXw7n4xlDKGTopzGpVqJVum3IAGeb5/kjSBPBHI7EYVIHcU+t/8h9pXHlFIiMV+
         0uORNJKSjq6H5WHioD+xMltaIVpnHiiX3bwVDXuD6UEqvc0IrOFyJjKH2qHzTsisil9Q
         FR8XybmCbvwEazzY4g7nqwZht+B96HWottjLM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=d6yWJ3txNbFzWpUGWkRF+z6rZofNdKoo/BD5iugUa7PBiJnzjn1ug3PXTJW9vyIXfD
         uhDR5WUqIzOf8uW+YCqzc7kxl7JHCDOHbuuwul77On+K/0DpQQkL+60ro4TQXRLkBBM/
         OD6U1hMlF4ryLvpbb3grdfx5LApoMrxG1hEmo=
MIME-Version: 1.0
Received: by 10.100.214.15 with SMTP id m15mr1180121ang.66.1239138764726; Tue, 
	07 Apr 2009 14:12:44 -0700 (PDT)
In-Reply-To: <359a92830904061426q976cbb5ua0957bdb2e911d45@mail.gmail.com>
References: <bf1404350904061332l53580cdfvebe3963200d28ebf@mail.gmail.com>
	 <359a92830904061337qf6057d6y29f3d8e7579071f5@mail.gmail.com>
	 <bf1404350904061424r6f4c07dfif06c982ea1727ea1@mail.gmail.com>
	 <359a92830904061426q976cbb5ua0957bdb2e911d45@mail.gmail.com>
Date: Tue, 7 Apr 2009 17:12:43 -0400
Message-ID: <bf1404350904071412q486e4cb9j1e152f36656d4fc7@mail.gmail.com>
Subject: Re: How to search a phrase using quotes in a query ???
From: Ariel <isaacrc82@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016368e2056e624e70466fd790a
X-Virus-Checked: Checked by ClamAV on apache.org

--0016368e2056e624e70466fd790a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Here is my code for indexing:
[code]
    public static void main(String[] args) throws IOException {

        if(args.length=3D=3D2){
            String docsDirectory =3Dargs[0];
            String indexFilepath =3D args[1];
            int numIndexed =3D 0;
            IndexWriter writer;
            ArrayList<String> arrayList =3D new ArrayList<String>();
            try {
                Analyzer Analyzer =3D new EnglishAnalyzer();
                writer =3D new IndexWriter(indexFilepath,   Analyzer , true=
);
                writer.setUseCompoundFile(true);
                File directory =3D new File(docsDirectory);
                String[] list =3D directory.list();
                for (int i =3D 0; i < list.length; i++) {
                    File doc =3D new File(docsDirectory, list[i]);
                    BufferedReader reader;
                    try {
                        reader =3D new BufferedReader(new FileReader(doc));
                        String linea =3D reader.readLine();
                        StringBuffer texto =3D new StringBuffer();
                        while (linea !=3D null){
                            // Aqu=ED lo que tengamos que hacer con la l=ED=
nea
puede ser esto
                            texto.append(linea);
                            linea =3D reader.readLine();
                        }
                        System.out.println(i);
                        indexFile(writer,
texto.toString(),doc.getAbsolutePath() );
                        arrayList.add(new String(new byte[1000]));
                        reader.close();
                    } catch (FileNotFoundException e) {
                        e.printStackTrace();
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                }
                numIndexed =3D writer.docCount();
                writer.optimize();
                writer.close();
            } catch (CorruptIndexException e1) {
                e1.printStackTrace();
            } catch (LockObtainFailedException e1) {
                e1.printStackTrace();
            } catch (IOException e1) {
                e1.printStackTrace();
            }

        } else {
            System.err.println("You need to provide arguments ");
        }
    }

    // method to actually index a file using Lucene
    private static void indexFile(IndexWriter writer, String content, Strin=
g
title)  throws IOException {
        long init =3D System.currentTimeMillis();
        Document doc =3D new Document();
        doc.add(new Field("content", content, Field.Store.YES ,
Field.Index.TOKENIZED, Field.TermVector.YES));
        doc.add(new Field("title", title, Field.Store.YES ,
Field.Index.TOKENIZED, Field.TermVector.YES));
        writer.addDocument(doc);
        long end =3D System.currentTimeMillis();
        System.out.println("ms " + (end - init));
    }t
[/code]

And for searching:
[code]
    public static void main(String[] args) {
        String path =3D "C:\\index";
        try {
            IndexSearcher indexSearcher =3D new IndexSearcher(path );
            String[] fields =3D new String[]{"title","content"};
            Analyzer analyzer =3D new EnglishAnalyzer();
            String[] textFields =3D new String[]{"\"The Bank of
America\"","\"The Bank of America\""};;
            Query query =3D MultiFieldQueryParser.parse(textFields, fields,
analyzer);
            Hits hits =3D indexSearcher.search(query );
            System.out.println("Founded: " + hits.length());

            QueryScorer scorer =3D new QueryScorer(query);
            Highlighter highlighter =3D new Highlighter(scorer);
            Fragmenter fragmenter =3D new SimpleFragmenter(100);
            highlighter.setTextFragmenter(fragmenter);

            for (int i =3D 0; i < hits.length(); i++) {
                Document document =3D hits.doc(i);
                String body =3D hits.doc(i).get("content");
                System.out.println((i+1)+ " " + body.substring(0, 20));
                System.out.println(document.get("path"));
                if (body=3D=3Dnull) body =3D"";
                TokenStream stream =3D  analyzer.tokenStream("content",new
StringReader(body));
                //System.out.println(highlighter.getBestFragment(stream,
body));
                String[] fragment =3D highlighter.getBestFragments(stream,
body, 3);
                if (fragment.length =3D=3D 0){
                    fragment =3D new String[1];
                    fragment[0] =3D "";
                }
                StringBuilder buffer =3D new StringBuilder();
                for (int I =3D 0; I < fragment.length; I++){
                    buffer.append(fragment[I] + "...\n");
                }
                String stringFragment =3D buffer.toString();
                System.out.println(stringFragment);
            }
        } catch (CorruptIndexException e) {
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (ParseException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }
[/code]


English Analyzer is a custom analyzer that have all these
filters:SynonymFilter, SnowballFilter, StopFilter, LowerCaseFilter,
StandardFilter and StandardTokenizer.

So, I don't know why when I do a search like "the bank of america" the
search results doesn't return the documents that have the exact phrase "the
bank of america".
Could you help me please ???
Regards
Ariel


On Mon, Apr 6, 2009 at 5:26 PM, Erick Erickson <erickerickson@gmail.com>wro=
te:

> If you have luke, you should be able to submit your query and use
> the explain functionality to gain some insights into what the query
> actually looks like as well....
>
> Best
> Erick
>
> On Mon, Apr 6, 2009 at 5:24 PM, Ariel <isaacrc82@gmail.com> wrote:
>
> > Well I have luke lucene, the index has been build fine.
> > The field where I am searching is the content field.
> >
> > I am using the same analyzer in query and indexing time: SnowBall Engli=
sh
> > Analyzer.
> >
> > I am going to submit later the snippet code.
> >
> > Regards
> > Ariel
> >
> >
> > On Mon, Apr 6, 2009 at 4:37 PM, Erick Erickson <erickerickson@gmail.com
> > >wrote:
> >
> > > We really need some more data. First, I *strongly* recommend you
> > > get a copy of Luke and examine your index to see what is
> > > *actually* there. Google "lucene luke". That often answers
> > > many questions.
> > >
> > > Second, query.toString is your friend. For instance, if the query
> > > you provided below is all that you're submitting, it's going against
> > > the default field you might have specified when you instantiated
> > > your query parser.
> > >
> > > Third, what analyzers are you using at index and query time?
> > >
> > > Code snippets would also help.
> > >
> > > Best
> > > Erick
> > >
> > > On Mon, Apr 6, 2009 at 4:32 PM, Ariel <isaacrc82@gmail.com> wrote:
> > >
> > > > Hi every body:
> > > >
> > > > Why when I make a query with this search  query : "the fool of the
> > hill"
> > > > doesn't appear documents in the search results that contains the
> entire
> > > > phrase "the fool of the hill" and it does exist documents that
> contain
> > > that
> > > > phrase, I am using snowball analyzer for English ???
> > > > Could you help with this please ???
> > > > Regards
> > > > Ariel
> > > >
> > >
> >
>

--0016368e2056e624e70466fd790a--

From java-user-return-39554-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 07 21:58:18 2009
Return-Path: <java-user-return-39554-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18512 invoked from network); 7 Apr 2009 21:58:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Apr 2009 21:58:17 -0000
Received: (qmail 98060 invoked by uid 500); 7 Apr 2009 21:58:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97992 invoked by uid 500); 7 Apr 2009 21:58:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97982 invoked by uid 99); 7 Apr 2009 21:58:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 21:58:15 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 07 Apr 2009 21:58:06 +0000
Received: by qyk8 with SMTP id 8so1130562qyk.29
        for <java-user@lucene.apache.org>; Tue, 07 Apr 2009 14:57:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=JZmGR0rRpcid1r3wG38FZ7+8KbeKLIcv9uVGxMOy9bs=;
        b=Tzu5jhGiYhUdEs0XGQiJKBmEvocZVzJefaPGmrDiQb18uPqYnzUkEvrugWdiiG9NVl
         zid93ZjMKPUTvL543dyG3bbtV+GN4PoRPaMZN5MmHwNLOGnrAiHbST/VWMdoOOoMGxke
         qIJHH0FqMUR+QAXCoSrSxtzN43LyszN3EIp/4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=UWCHC59i8zKX8VjAkBBQraOGLGL94aWZN+yrnxSaDc3lKdGWBslgiLF4XIdS9qkMb9
         lNlfUW8kl7vx0pdNUP+sx4tT+4Uac5pmpTJzqmXZOOfb2S1QJ1wys3aRuTZwp6LivLrJ
         TbjBtOImAEsMqH/lO3J4hvWIoaGLIcpJdaw8w=
MIME-Version: 1.0
Received: by 10.220.45.205 with SMTP id g13mr1162512vcf.64.1239141464760; Tue, 
	07 Apr 2009 14:57:44 -0700 (PDT)
In-Reply-To: <bf1404350904071412q486e4cb9j1e152f36656d4fc7@mail.gmail.com>
References: <bf1404350904061332l53580cdfvebe3963200d28ebf@mail.gmail.com>
	 <359a92830904061337qf6057d6y29f3d8e7579071f5@mail.gmail.com>
	 <bf1404350904061424r6f4c07dfif06c982ea1727ea1@mail.gmail.com>
	 <359a92830904061426q976cbb5ua0957bdb2e911d45@mail.gmail.com>
	 <bf1404350904071412q486e4cb9j1e152f36656d4fc7@mail.gmail.com>
Date: Tue, 7 Apr 2009 17:57:44 -0400
Message-ID: <359a92830904071457r6893685enac0afc2e841f413a@mail.gmail.com>
Subject: Re: How to search a phrase using quotes in a query ???
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364ec868d599f60466fe1a4c
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364ec868d599f60466fe1a4c
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Well, nothing jumps out at me, although I confess that I've not
used MultiFieldQueryParser. So here's what I'd do.

1> drop back to a simpler way of doing things. Forget about
MultiFieldQueryParser for instance. Get the really simple case
working then build back up. I'd also drop back to a very
basic analyzer (perhaps SimpleAnalyzer). Get that very simple
case to work. Then substitute your EnglishAnalyzer back in. etc.

I'm guessing that one of these steps will suddenly fail and you'll have
a good place to start.

2> Print out query.toString() and paste the results into Luke and
see what it gives you. The Explain (in Luke) should help.

Sorry I can't be more help, but I've often found that getting the easy
way of doing things to work then adding my complications back in
produces one of those "I didn't think *that* could possibly fail" moments
<G>.

Best
Erick

On Tue, Apr 7, 2009 at 5:12 PM, Ariel <isaacrc82@gmail.com> wrote:

> Here is my code for indexing:
> [code]
>    public static void main(String[] args) throws IOException {
>
>        if(args.length=3D=3D2){
>            String docsDirectory =3Dargs[0];
>            String indexFilepath =3D args[1];
>            int numIndexed =3D 0;
>            IndexWriter writer;
>            ArrayList<String> arrayList =3D new ArrayList<String>();
>            try {
>                Analyzer Analyzer =3D new EnglishAnalyzer();
>                writer =3D new IndexWriter(indexFilepath,   Analyzer , tru=
e);
>                writer.setUseCompoundFile(true);
>                File directory =3D new File(docsDirectory);
>                String[] list =3D directory.list();
>                for (int i =3D 0; i < list.length; i++) {
>                    File doc =3D new File(docsDirectory, list[i]);
>                    BufferedReader reader;
>                    try {
>                        reader =3D new BufferedReader(new FileReader(doc))=
;
>                        String linea =3D reader.readLine();
>                        StringBuffer texto =3D new StringBuffer();
>                        while (linea !=3D null){
>                            // Aqu=ED lo que tengamos que hacer con la l=
=EDnea
> puede ser esto
>                            texto.append(linea);
>                            linea =3D reader.readLine();
>                        }
>                        System.out.println(i);
>                        indexFile(writer,
> texto.toString(),doc.getAbsolutePath() );
>                        arrayList.add(new String(new byte[1000]));
>                        reader.close();
>                    } catch (FileNotFoundException e) {
>                        e.printStackTrace();
>                    } catch (IOException e) {
>                        e.printStackTrace();
>                    }
>                }
>                numIndexed =3D writer.docCount();
>                writer.optimize();
>                writer.close();
>            } catch (CorruptIndexException e1) {
>                e1.printStackTrace();
>            } catch (LockObtainFailedException e1) {
>                e1.printStackTrace();
>            } catch (IOException e1) {
>                e1.printStackTrace();
>            }
>
>        } else {
>            System.err.println("You need to provide arguments ");
>        }
>    }
>
>    // method to actually index a file using Lucene
>    private static void indexFile(IndexWriter writer, String content, Stri=
ng
> title)  throws IOException {
>        long init =3D System.currentTimeMillis();
>        Document doc =3D new Document();
>        doc.add(new Field("content", content, Field.Store.YES ,
> Field.Index.TOKENIZED, Field.TermVector.YES));
>        doc.add(new Field("title", title, Field.Store.YES ,
> Field.Index.TOKENIZED, Field.TermVector.YES));
>        writer.addDocument(doc);
>        long end =3D System.currentTimeMillis();
>        System.out.println("ms " + (end - init));
>    }t
> [/code]
>
> And for searching:
> [code]
>    public static void main(String[] args) {
>        String path =3D "C:\\index";
>        try {
>            IndexSearcher indexSearcher =3D new IndexSearcher(path );
>            String[] fields =3D new String[]{"title","content"};
>            Analyzer analyzer =3D new EnglishAnalyzer();
>            String[] textFields =3D new String[]{"\"The Bank of
> America\"","\"The Bank of America\""};;
>            Query query =3D MultiFieldQueryParser.parse(textFields, fields=
,
> analyzer);
>            Hits hits =3D indexSearcher.search(query );
>            System.out.println("Founded: " + hits.length());
>
>            QueryScorer scorer =3D new QueryScorer(query);
>            Highlighter highlighter =3D new Highlighter(scorer);
>            Fragmenter fragmenter =3D new SimpleFragmenter(100);
>            highlighter.setTextFragmenter(fragmenter);
>
>            for (int i =3D 0; i < hits.length(); i++) {
>                Document document =3D hits.doc(i);
>                String body =3D hits.doc(i).get("content");
>                System.out.println((i+1)+ " " + body.substring(0, 20));
>                System.out.println(document.get("path"));
>                if (body=3D=3Dnull) body =3D"";
>                TokenStream stream =3D  analyzer.tokenStream("content",new
> StringReader(body));
>                //System.out.println(highlighter.getBestFragment(stream,
> body));
>                String[] fragment =3D highlighter.getBestFragments(stream,
> body, 3);
>                if (fragment.length =3D=3D 0){
>                    fragment =3D new String[1];
>                    fragment[0] =3D "";
>                }
>                StringBuilder buffer =3D new StringBuilder();
>                for (int I =3D 0; I < fragment.length; I++){
>                    buffer.append(fragment[I] + "...\n");
>                }
>                String stringFragment =3D buffer.toString();
>                System.out.println(stringFragment);
>            }
>        } catch (CorruptIndexException e) {
>            e.printStackTrace();
>        } catch (IOException e) {
>            // TODO Auto-generated catch block
>            e.printStackTrace();
>        } catch (ParseException e) {
>            // TODO Auto-generated catch block
>            e.printStackTrace();
>        }
>
>    }
> [/code]
>
>
> English Analyzer is a custom analyzer that have all these
> filters:SynonymFilter, SnowballFilter, StopFilter, LowerCaseFilter,
> StandardFilter and StandardTokenizer.
>
> So, I don't know why when I do a search like "the bank of america" the
> search results doesn't return the documents that have the exact phrase "t=
he
> bank of america".
> Could you help me please ???
> Regards
> Ariel
>
>
> On Mon, Apr 6, 2009 at 5:26 PM, Erick Erickson <erickerickson@gmail.com
> >wrote:
>
> > If you have luke, you should be able to submit your query and use
> > the explain functionality to gain some insights into what the query
> > actually looks like as well....
> >
> > Best
> > Erick
> >
> > On Mon, Apr 6, 2009 at 5:24 PM, Ariel <isaacrc82@gmail.com> wrote:
> >
> > > Well I have luke lucene, the index has been build fine.
> > > The field where I am searching is the content field.
> > >
> > > I am using the same analyzer in query and indexing time: SnowBall
> English
> > > Analyzer.
> > >
> > > I am going to submit later the snippet code.
> > >
> > > Regards
> > > Ariel
> > >
> > >
> > > On Mon, Apr 6, 2009 at 4:37 PM, Erick Erickson <
> erickerickson@gmail.com
> > > >wrote:
> > >
> > > > We really need some more data. First, I *strongly* recommend you
> > > > get a copy of Luke and examine your index to see what is
> > > > *actually* there. Google "lucene luke". That often answers
> > > > many questions.
> > > >
> > > > Second, query.toString is your friend. For instance, if the query
> > > > you provided below is all that you're submitting, it's going agains=
t
> > > > the default field you might have specified when you instantiated
> > > > your query parser.
> > > >
> > > > Third, what analyzers are you using at index and query time?
> > > >
> > > > Code snippets would also help.
> > > >
> > > > Best
> > > > Erick
> > > >
> > > > On Mon, Apr 6, 2009 at 4:32 PM, Ariel <isaacrc82@gmail.com> wrote:
> > > >
> > > > > Hi every body:
> > > > >
> > > > > Why when I make a query with this search  query : "the fool of th=
e
> > > hill"
> > > > > doesn't appear documents in the search results that contains the
> > entire
> > > > > phrase "the fool of the hill" and it does exist documents that
> > contain
> > > > that
> > > > > phrase, I am using snowball analyzer for English ???
> > > > > Could you help with this please ???
> > > > > Regards
> > > > > Ariel
> > > > >
> > > >
> > >
> >
>

--0016364ec868d599f60466fe1a4c--

From java-user-return-39555-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 03:47:00 2009
Return-Path: <java-user-return-39555-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35091 invoked from network); 8 Apr 2009 03:47:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 03:47:00 -0000
Received: (qmail 74720 invoked by uid 500); 8 Apr 2009 03:46:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74677 invoked by uid 500); 8 Apr 2009 03:46:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74667 invoked by uid 99); 8 Apr 2009 03:46:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 03:46:56 +0000
X-ASF-Spam-Status: No, hits=2.1 required=10.0
	tests=RCVD_BAD_ID,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of goalwisk@snu.ac.kr designates 147.46.10.149 as permitted sender)
Received: from [147.46.10.149] (HELO nabi1.snu.ac.kr) (147.46.10.149)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 03:46:47 +0000
Received: from [147.46.10.145] ([147.46.10.145]) 
          by nabi1.snu.ac.kr ([147.46.10.149]) 
          with ESMTP id 2009040812:46:24:148882.25111.109018016
          for <java-user@lucene.apache.org>; 
          Wed, 08 Apr 2009 12:46:24 +0900 (KST) 
Received: from [147.46.178.146] ([147.46.178.146]) 
          by auk1.snu.ac.kr ([147.46.10.145]) 
          with ESMTP id 2009040812:46:21:545800.15970.13708208
          for <java-user@lucene.apache.org>; 
          Wed, 08 Apr 2009 12:46:21 +0900 (KST) 
Message-ID: <49DC1E08.8000903@snu.ac.kr>
Date: Wed, 08 Apr 2009 12:46:16 +0900
From: =?UTF-8?B?6rmA6rSA7Zi4?= <goalwisk@snu.ac.kr>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: How to customize score according to field value?
References: <d4e666ac0904070005j355175e9qc59546fe0ba3f54a@mail.gmail.com> <d4e666ac0904070008o50d5e74eh530a621d8974f201@mail.gmail.com>
In-Reply-To: <d4e666ac0904070008o50d5e74eh530a621d8974f201@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-TERRACE-SPAMMARK: NO       (SR:17.41)                     
  (by Terrace)                                                  
X-Virus-Checked: Checked by ClamAV on apache.org

Jinming Zhang wrote:
> Hi,
>
> I have the following situation which needs to customize the final score
> according to field value.
>
> Suppose there are two docs in my query result, and they are ordered by
> default score sort:
>
> doc1(field1:bookA, field2:2000-01-01) -- score:0.80
> doc2(field1:bookB, filed2:2009-01-01) -- score:0.70
>
> I want "doc2" to have a higher score since it's publishing date is more
> recent, while "doc1" to have a lower score:
>
> doc2(field1:bookB, filed2:2009-01-01) -- score:0.77
> doc1(field1:bookA, field2:2000-01-01) -- score:0.73
>
> I found this scenario is different from doc.setBoost() and field.setBoost().
> Is there any way to impact the score calculated for "doc1" & "doc2"
> according to the value of "field2"?
>
> Thank you in advance!
>
>   
hi,

If I were you, I would store the date information as a long type
(as i know, lucene stores any date information as a long type 
automatically, so it should be a natural way. you can change date type 
to long type and vice versa very easily by using lucene's provided date 
apis.) and make a linear function about the date information.

The input of the function is a date information and the output is a 
simple float value which indicates how recent a book is. As more recent 
books have larger function values linearly, you can finely adjust your 
score by weighting the output of function according to your ranking policy.

After then, simply, modify your docs' score on the fly by using the 
function's output at customScore() which are mentioned at one of replies 
for your question by patrick o'leary.

bye.





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39556-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 05:23:00 2009
Return-Path: <java-user-return-39556-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68988 invoked from network); 8 Apr 2009 05:23:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 05:23:00 -0000
Received: (qmail 81138 invoked by uid 500); 8 Apr 2009 05:22:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81059 invoked by uid 500); 8 Apr 2009 05:22:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81049 invoked by uid 99); 8 Apr 2009 05:22:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 05:22:57 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of antony@digitalglue.in designates 69.59.169.92 as permitted sender)
Received: from [69.59.169.92] (HELO relay3.mailserve.net) (69.59.169.92)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 05:22:47 +0000
Received: from relay21.mailserve.net (relay21.mailserve.net [121.241.242.35])
	by relay3.mailserve.net (Postfix) with ESMTP id 074158CA9CF
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 10:52:25 +0530 (IST)
Received: from relay21.mailserve.net (relay [121.241.242.35])
	by relay21.mailserve.net (Postfix) with ESMTP id 9B9BB3C6DD
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 10:52:24 +0530 (IST)
Received: from relay21.mailserve.net (relay [121.241.242.35])
	by relay21.mailserve.net (Postfix) with ESMTP id 8B322A803D
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 10:52:24 +0530 (IST)
Received: from digitalglue.in (unknown [124.125.128.62])
	by relay21.mailserve.net (Postfix) with ESMTP id 133564C0A5
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 10:52:22 +0530 (IST)
Received: from antony@digitalglue.in([10.1.1.18]) 	by IQ Mail
MIME-Version: 1.0
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: Acm4CfvmAK2Toun/T42P5Spx0M0Cmw==
Subject: test
Date: Wed, 8 Apr 2009 10:52:18 +0530
Message-ID: <000c01c9b809$fd582ac0$f8088040$@in>
X-MailServer: IQuinox v6.0.31 on [10.1.1.1] Linux (2.6.18-4-686)
From: Antony Joseph <antony@digitalglue.in>
To: <java-user@lucene.apache.org>
content-type: multipart/alternative; boundary="----=_NextPart_000_000D_01C9B838.171066C0"
content-language: en-us
X-vamsi: scanned
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_000D_01C9B838.171066C0
content-transfer-encoding: 7bit
content-type: text/plain; charset=us-ascii

hi



------------------
DigitalGlue, India


------=_NextPart_000_000D_01C9B838.171066C0--


From java-user-return-39557-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 06:41:02 2009
Return-Path: <java-user-return-39557-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16433 invoked from network); 8 Apr 2009 06:41:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 06:41:02 -0000
Received: (qmail 41700 invoked by uid 500); 8 Apr 2009 06:41:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41614 invoked by uid 500); 8 Apr 2009 06:41:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41604 invoked by uid 99); 8 Apr 2009 06:41:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 06:41:00 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of antony@digitalglue.in designates 69.59.169.92 as permitted sender)
Received: from [69.59.169.92] (HELO relay3.mailserve.net) (69.59.169.92)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 06:40:51 +0000
Received: from relay21.mailserve.net (relay21.mailserve.net [121.241.242.35])
	by relay3.mailserve.net (Postfix) with ESMTP id 22532581C3
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 12:10:29 +0530 (IST)
Received: from relay21.mailserve.net (relay [121.241.242.35])
	by relay21.mailserve.net (Postfix) with ESMTP id B408B3C6D3
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 12:10:28 +0530 (IST)
Received: from relay21.mailserve.net (relay [121.241.242.35])
	by relay21.mailserve.net (Postfix) with ESMTP id A1D5EA8040
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 12:10:28 +0530 (IST)
Received: from digitalglue.in (unknown [124.125.128.62])
	by relay21.mailserve.net (Postfix) with ESMTP id 5248C4C07B
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 12:10:27 +0530 (IST)
Received: from antony@digitalglue.in([10.1.1.18]) 	by IQ Mail
References: <000c01c9b809$fd582ac0$f8088040$@in>
In-Reply-To: <000c01c9b809$fd582ac0$f8088040$@in>
MIME-Version: 1.0
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: Acm4CfvmAK2Toun/T42P5Spx0M0CmwACs/OQ
Subject: RE: test
Date: Wed, 8 Apr 2009 12:10:17 +0530
Message-ID: <001a01c9b814$e12a6b00$a37f4100$@in>
X-MailServer: IQuinox v6.0.31 on [10.1.1.1] Linux (2.6.18-4-686)
From: Antony Joseph <antony@digitalglue.in>
To: <java-user@lucene.apache.org>
content-transfer-encoding: 7bit
content-type: text/plain; charset=us-ascii
content-language: en-us
X-vamsi: scanned
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

In a long running process Lucene get crashed in my application, Is there any
way to diagnose or how can I  turn on debug logging / trace logging for
Lucene?


Thanks
Antony


------------------
DigitalGlue, India




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39558-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 09:44:23 2009
Return-Path: <java-user-return-39558-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3214 invoked from network); 8 Apr 2009 09:44:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 09:44:22 -0000
Received: (qmail 85637 invoked by uid 500); 8 Apr 2009 09:44:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85579 invoked by uid 500); 8 Apr 2009 09:44:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85569 invoked by uid 99); 8 Apr 2009 09:44:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 09:44:19 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.171] (HELO wf-out-1314.google.com) (209.85.200.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 09:44:12 +0000
Received: by wf-out-1314.google.com with SMTP id 29so31704wff.20
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 02:43:51 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.185.21 with SMTP id i21mr389692wff.220.1239183831427; Wed, 
	08 Apr 2009 02:43:51 -0700 (PDT)
In-Reply-To: <001a01c9b814$e12a6b00$a37f4100$@in>
References: <000c01c9b809$fd582ac0$f8088040$@in>
	 <001a01c9b814$e12a6b00$a37f4100$@in>
Date: Wed, 8 Apr 2009 05:43:51 -0400
Message-ID: <9ac0c6aa0904080243s4f583606t57d196d0e98e6d67@mail.gmail.com>
Subject: Re: test
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Can you provide more details?  EG a full exception?  What was the app
doing (indexing, searching, both)?

Mike

On Wed, Apr 8, 2009 at 2:40 AM, Antony Joseph <antony@digitalglue.in> wrote=
:
> Hi,
>
> In a long running process Lucene get crashed in my application, Is there =
any
> way to diagnose or how can I =A0turn on debug logging / trace logging for
> Lucene?
>
>
> Thanks
> Antony
>
>
> ------------------
> DigitalGlue, India
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39559-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 13:25:41 2009
Return-Path: <java-user-return-39559-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30519 invoked from network); 8 Apr 2009 13:25:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 13:25:41 -0000
Received: (qmail 75209 invoked by uid 500); 8 Apr 2009 13:25:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75137 invoked by uid 500); 8 Apr 2009 13:25:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75127 invoked by uid 99); 8 Apr 2009 13:25:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 13:25:38 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of MSchraeder@btsb.com designates 216.8.91.5 as permitted sender)
Received: from [216.8.91.5] (HELO mail.btsb.com) (216.8.91.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 13:25:30 +0000
X-IronPort-AV: E=Sophos;i="4.39,344,1235973600"; 
   d="scan'208,217";a="477243"
Received: from unknown (HELO mail.btsb.com) ([10.1.1.2])
  by mail.btsb.com with ESMTP; 08 Apr 2009 08:28:17 -0500
Received: from GWDOMAIN-MTA by mail.btsb.com
	with Novell_GroupWise; Wed, 08 Apr 2009 08:27:20 -0500
Message-Id: <s9dc5fe8.027@mail.btsb.com>
X-Mailer: Novell GroupWise Internet Agent 6.5.5 
Date: Wed, 08 Apr 2009 08:26:48 -0500
From: "Matt Schraeder" <MSchraeder@btsb.com>
To: <java-user@lucene.apache.org>
Subject: Suggestive Search
Mime-Version: 1.0
Content-Type: multipart/alternative; boundary="=__Part537BCB08.0__="
X-Virus-Checked: Checked by ClamAV on apache.org

--=__Part537BCB08.0__=
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

I want to add a suggestive search similar to google's to autocomplete
search phrases as the user types.  It doesn't have to be very elaborate
and for the most part will just involve searching single fields.  How
can I perform a search  to be able to fill in autocomplete text?
 
For instance, if I start typing "Harr" it should bring up "Harry
Potter" "Harry Houdini" and "Harry S. Truman"
 
I have tried doing search queries for "Harr*" but it's still doing
term-based searching rather than searching a full field.  To make a
field both searchable as the full field as well as tokenized, would I
have to duplicate the field and make one a keyword field? Is there a
more convenient way to do this? I have also considered making a second
index for suggestive search, which would only have the fields that I
want to enable suggestive search on, but this seems like it would be
unneccesary duplication of data as well, though it would probably make
suggestive search faster due to a smaller index.
 
Ideally it would also be nice to be able to rank these terms based on
the number of times they have been searched for so that the results are
tailored more to our users rather than simply just the score that Lucene
chooses.

--=__Part537BCB08.0__=--

From java-user-return-39560-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 13:33:59 2009
Return-Path: <java-user-return-39560-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38833 invoked from network); 8 Apr 2009 13:33:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 13:33:59 -0000
Received: (qmail 96684 invoked by uid 500); 8 Apr 2009 13:33:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96625 invoked by uid 500); 8 Apr 2009 13:33:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96615 invoked by uid 99); 8 Apr 2009 13:33:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 13:33:56 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of dscrima@verilogue.com designates 72.32.253.81 as permitted sender)
Received: from [72.32.253.81] (HELO server515.appriver.com) (72.32.253.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 13:33:47 +0000
Received: by server515.appriver.com (CommuniGate Pro PIPE 5.2.7)
  with PIPE id 146000682; Wed, 08 Apr 2009 08:33:28 -0500
Received: from [72.32.49.36] (HELO FE3.exchange.rackspace.com)
  by server515.appriver.com (CommuniGate Pro SMTP 5.2.7)
  with ESMTP id 146000621 for java-user@lucene.apache.org; Wed, 08 Apr 2009 08:33:25 -0500
Received: from 34093-C5-EVS1.exchange.rackspace.com ([192.168.1.96]) by FE3.exchange.rackspace.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 8 Apr 2009 08:33:19 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C9B84E.94A780EE"
Subject: Lucene searching across documents
Date: Wed, 8 Apr 2009 08:32:35 -0500
Message-ID: <1B145DAA6B4D4643B8D9709100FE080601799759@34093-C5-EVS1.exchange.rackspace.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene searching across documents
Thread-Index: Acm4TnpYsHwrJas2SvmmF8DZy0PJ4A==
From: "Dan Scrima" <dscrima@verilogue.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 08 Apr 2009 13:33:19.0367 (UTC) FILETIME=[94697970:01C9B84E]
X-Policy: GLOBAL - verilogue.com
X-Primary: dscrima@verilogue.com
X-Note: This Email was scanned by AppRiver SecureTide
X-ALLOW: dscrima@verilogue.com ALLOWED
X-Virus-Scan: V-
X-Note: Spam Tests Failed: 
X-Country-Path: PRIVATE->UNITED STATES->UNITED STATES
X-Note-Sending-IP: 72.32.49.36
X-Note-Reverse-DNS: 
X-Note-WHTLIST: dscrima@verilogue.com
X-Note: User Rule Hits: 
X-Note: Global Rule Hits: 101 102 103 104 108 109 177 
X-Note: Mail Class: ALLOWEDSENDER
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C9B84E.94A780EE
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

So I have a requirement where I have a directory filled with xml files.
I wrote a parser to parse these files, and index all of the xml
attributes and properties into documents. An example of one of these
documents is below. I'm parsing sentences into words, and tagging the
sentences based on certain criteria.

My issue is trying to find out if lucene can handle cross-document
searching. So below is indexed as a single document... and there will be
multiple sentences before, after, and throughout an entire transcript.
Is it possible somehow to say, "I want a result where one line marked as
Symptom is 5 lines away from another line marked as Brand." So in
essence, I'm trying to search across multiple lucene documents.

=20

Any thoughts or literature out there?

=20

<transcript>

                <line id=3D"1">

                                <tag id=3D"10" type=3D"Symptom" />

<tag id=3D"12" type=3D"Brand" />

                                <word>

                                                <token>Coughing</token>

=20
<part-of-speech>SBJ</part-of-speech>

</word>

<word>

                                                <token>is</token>

=20
<part-of-speech>VB</part-of-speech>

</word>

<word>

                                                <token>caused</token>

=20
<part-of-speech>NP</part-of-speech>

</word>

<word>

                                                <token>by</token>

=20
<part-of-speech>PP</part-of-speech>

</word>

<word>

                                                <token>Mucinex</token>

=20
<part-of-speech>PDC</part-of-speech>

</word>

                </line>

</transcript>

=20

=20

Thanks so much!


------_=_NextPart_001_01C9B84E.94A780EE--

From java-user-return-39561-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 14:46:16 2009
Return-Path: <java-user-return-39561-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82188 invoked from network); 8 Apr 2009 14:46:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 14:46:15 -0000
Received: (qmail 73869 invoked by uid 500); 8 Apr 2009 14:46:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73806 invoked by uid 500); 8 Apr 2009 14:46:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73795 invoked by uid 99); 8 Apr 2009 14:46:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 14:46:13 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of isaacrc82@gmail.com designates 209.85.132.251 as permitted sender)
Received: from [209.85.132.251] (HELO an-out-0708.google.com) (209.85.132.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 14:46:05 +0000
Received: by an-out-0708.google.com with SMTP id b2so74301ana.5
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 07:45:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=jum48gGeKmCDctCVvmiDssMCoBP2UFFGoRpbMef0Lws=;
        b=KhGNbH4GTgYgE0upotqN2A032ew8QLQylEbel3HBWFqvosW5i6Pe4ndK9tkgggbbcR
         Q1PqT6kZrMEwQKmHzTklStYWIr7f4d1d/HkkxcAJos2YljRevrWRb17dCnwC0c1L/bgm
         GG48uSPyiIsDTFCKPgL9qJsE183CScbyEYb6w=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=cnoazQ9jGxhRI36QVMqJHPiJ1aMZVgMAefORVDeJJmf11shy4sCBO4Is596IngTRTW
         tlq1QVe3eqXBwPJKC+/pzrZcUsOIBxpwUibimkWq90oxtJ7tM9xjwSyumNA6L5YxDLc7
         s4/kO23F+z1kPqve7aygWOt6/UMb/YqVNomQk=
MIME-Version: 1.0
Received: by 10.100.96.9 with SMTP id t9mr3117073anb.100.1239201944524; Wed, 
	08 Apr 2009 07:45:44 -0700 (PDT)
Date: Wed, 8 Apr 2009 10:45:44 -0400
Message-ID: <bf1404350904080745s43b59486n6054963f839326c@mail.gmail.com>
Subject: How can I change that lucene use by default the AND operator between 
	terms ???
From: Ariel <isaacrc82@gmail.com>
To: lucene user <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=0016e644cdd6b55cb804670c2f35
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e644cdd6b55cb804670c2f35
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

When I do a search using lucene internally lucene use by default the OR
operator between terms, How can I change that lucene use by default the AND
operator between terms ???

Regards
Ariel

--0016e644cdd6b55cb804670c2f35--

From java-user-return-39562-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 14:53:58 2009
Return-Path: <java-user-return-39562-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84980 invoked from network); 8 Apr 2009 14:53:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 14:53:58 -0000
Received: (qmail 95672 invoked by uid 500); 8 Apr 2009 14:53:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95594 invoked by uid 500); 8 Apr 2009 14:53:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95584 invoked by uid 99); 8 Apr 2009 14:53:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 14:53:55 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 14:53:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id ABB46515C5
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 16:53:22 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 30955-01 for <java-user@lucene.apache.org>;
 Wed,  8 Apr 2009 16:53:21 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 5C8B7513A9
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 16:53:21 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <bf1404350904080745s43b59486n6054963f839326c@mail.gmail.com>
Subject: RE: How can I change that lucene use by default the AND operator between terms ???
Date: Wed, 8 Apr 2009 16:53:21 +0200
Message-ID: <141AD2A60FEA4EBDA3F942B4FD7AAAD6@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: Acm4WMnbKlBazL2MSTSL8NNcB2wqgwAANw5A
In-Reply-To: <bf1404350904080745s43b59486n6054963f839326c@mail.gmail.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

The query parser has a option to change that. After creating the query
parser, just set the corresponding option before parsing the query.

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Ariel [mailto:isaacrc82@gmail.com]
> Sent: Wednesday, April 08, 2009 4:46 PM
> To: lucene user
> Subject: How can I change that lucene use by default the AND operator
> between terms ???
> 
> When I do a search using lucene internally lucene use by default the OR
> operator between terms, How can I change that lucene use by default the
> AND
> operator between terms ???
> 
> Regards
> Ariel


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39563-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 15:02:02 2009
Return-Path: <java-user-return-39563-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90190 invoked from network); 8 Apr 2009 15:02:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 15:02:02 -0000
Received: (qmail 19743 invoked by uid 500); 8 Apr 2009 15:01:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19691 invoked by uid 500); 8 Apr 2009 15:01:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19681 invoked by uid 99); 8 Apr 2009 15:01:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 15:01:59 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of spee.zhang@gmail.com designates 74.125.92.27 as permitted sender)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 15:01:52 +0000
Received: by qw-out-2122.google.com with SMTP id 8so92659qwh.53
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 08:01:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=MiKtPPI1IWZJLp5XRQbQ8Hvw4vtroLTHnpC8Pzd4Dos=;
        b=b0/6EhfOqDfiqmqUdRGJpp63s6boj/K5d9NLi253V+JSIYvL7+rFhg4SvFdZMX1rxZ
         XRW/FHNrU29LSiLxB3bOpAJtKRo8iF5WXwiiciNpKFIKIaYq2Row+ZrdayPbGaaonUzx
         TpVc507iGh//AsqFQSxDBxtuDendvq8uTUsrE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=lmWvGtmftU9+/FAOlA5Im4emeAPLwOUGbTfyYlnd0GScf6H5E2pW+22R/cCy7V8Gzw
         a/O+Ji/IxqZp/ebpbsTnCx4pXYphlo4anzDFMoPG2KNOMMLAZMUfHHNVJtUoVQ/vIFUj
         6F8DHeQkfJMLKcDG96DYUJuyzM+PgwB6PMt3E=
MIME-Version: 1.0
Received: by 10.231.14.196 with SMTP id h4mr378060iba.36.1239202891700; Wed, 
	08 Apr 2009 08:01:31 -0700 (PDT)
In-Reply-To: <499888440904070601h4ce0f894ve2b35d6ae5f81826@mail.gmail.com>
References: <d4e666ac0904070005j355175e9qc59546fe0ba3f54a@mail.gmail.com> 
	<d4e666ac0904070008o50d5e74eh530a621d8974f201@mail.gmail.com> 
	<499888440904070601h4ce0f894ve2b35d6ae5f81826@mail.gmail.com>
From: Jinming Zhang <spee.zhang@gmail.com>
Date: Wed, 8 Apr 2009 23:01:16 +0800
Message-ID: <d4e666ac0904080801i267ade1bjd62a7394b3e04860@mail.gmail.com>
Subject: Re: How to customize score according to field value?
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0003255762ca2a1c8c04670c68cd
X-Virus-Checked: Checked by ClamAV on apache.org

--0003255762ca2a1c8c04670c68cd
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

Hi,

Yes, the CustomScoreQuery.customScore() can meet the requirement I
described.

Thank you all!

On Tue, Apr 7, 2009 at 9:01 PM, Tim Williams <williamstw@gmail.com> wrote:

> On Tue, Apr 7, 2009 at 3:08 AM, Jinming Zhang <spee.zhang@gmail.com>
> wrote:
> > Hi,
> >
> > I have the following situation which needs to customize the final score
> > according to field value.
> >
> > Suppose there are two docs in my query result, and they are ordered by
> > default score sort:
> >
> > doc1(field1:bookA, field2:2000-01-01) -- score:0.80
> > doc2(field1:bookB, filed2:2009-01-01) -- score:0.70
> >
> > I want "doc2" to have a higher score since it's publishing date is more
> > recent, while "doc1" to have a lower score:
> >
> > doc2(field1:bookB, filed2:2009-01-01) -- score:0.77
> > doc1(field1:bookA, field2:2000-01-01) -- score:0.73
> >
> > I found this scenario is different from doc.setBoost() and
> field.setBoost().
> > Is there any way to impact the score calculated for "doc1" & "doc2"
> > according to the value of "field2"?
> >
> > Thank you in advance!
>
> If you have access to the MEAP for Lucine In Action 2nd Edition, it
> demonstrates using a CustomScoreQuery[1] for to boost a docs score
> based on recency.
>
> --tim
>
> [1] -
> http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/search/function/CustomScoreQuery.html
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0003255762ca2a1c8c04670c68cd--

From java-user-return-39564-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 15:45:57 2009
Return-Path: <java-user-return-39564-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28271 invoked from network); 8 Apr 2009 15:45:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 15:45:57 -0000
Received: (qmail 17005 invoked by uid 500); 8 Apr 2009 15:45:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16946 invoked by uid 500); 8 Apr 2009 15:45:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16936 invoked by uid 99); 8 Apr 2009 15:45:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 15:45:54 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 15:45:46 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LrZxu-0006fl-2C
	for java-user@lucene.apache.org; Wed, 08 Apr 2009 08:45:26 -0700
Message-ID: <22953431.post@talk.nabble.com>
Date: Wed, 8 Apr 2009 08:45:26 -0700 (PDT)
From: addman <addiekong@yahoo.com>
To: java-user@lucene.apache.org
Subject: Query any data
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: addiekong@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,
   Is it possible to create a query to search a field for any value?  I just
need to know if the optional field contain any data at all.
-- 
View this message in context: http://www.nabble.com/Query-any-data-tp22953431p22953431.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39565-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 16:03:35 2009
Return-Path: <java-user-return-39565-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32995 invoked from network); 8 Apr 2009 16:03:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 16:03:35 -0000
Received: (qmail 49475 invoked by uid 500); 8 Apr 2009 16:03:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49406 invoked by uid 500); 8 Apr 2009 16:03:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49396 invoked by uid 99); 8 Apr 2009 16:03:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 16:03:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of williamstw@gmail.com designates 209.85.217.164 as permitted sender)
Received: from [209.85.217.164] (HELO mail-gx0-f164.google.com) (209.85.217.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 16:03:23 +0000
Received: by gxk8 with SMTP id 8so378828gxk.5
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 09:03:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=yIoCFjoTzNU72mUMA8SouHVgxSuRilz02k9fuZqufQk=;
        b=v2LQWShUKs0KyUM3JpkWoaDTNOwcA/oMhPuTHP2aqJ9pNXuDCo6pKSY/494OFxpeH6
         CWnWnY0Z+6eMKd+J3IDV2qioo4ADiI8KdLjGlsAZsMBMtciajkJK6pe3O4+bpIt82mAZ
         6jNufKzHLg5sxPBz/6qZwn3KJvOQJAgz2/3ek=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=J7y0SvetlcE54Fcdrjj3Ep7+D6ToQj8W17cOr0rW4WApvtCJR3OSPv3wFWR+UljDsK
         3+cAbgNW5CTxBTMKIfEmWkh3xuh3LQz8+A92CWzZQrGHNIpw7bsbPiG4uOt12m6akKOe
         6f0FsoVNvXRPtyjZ64xECi5w3tZS8bFo/2v6M=
MIME-Version: 1.0
Received: by 10.150.225.14 with SMTP id x14mr2725139ybg.115.1239206582204; 
	Wed, 08 Apr 2009 09:03:02 -0700 (PDT)
In-Reply-To: <22953431.post@talk.nabble.com>
References: <22953431.post@talk.nabble.com>
Date: Wed, 8 Apr 2009 12:03:02 -0400
Message-ID: <499888440904080903y47f8d828j92dd419cde53ce99@mail.gmail.com>
Subject: Re: Query any data
From: Tim Williams <williamstw@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Apr 8, 2009 at 11:45 AM, addman <addiekong@yahoo.com> wrote:
>
> Hi,
>   Is it possible to create a query to search a field for any value?  I just
> need to know if the optional field contain any data at all.

google for:  lucene field existence

There's no way built in, one strategy[1] is to have a 'meta field'
that contains the names of the fields the document contains.

--tim

[1] - http://www.mail-archive.com/lucene-user@jakarta.apache.org/msg07703.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39566-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 16:08:11 2009
Return-Path: <java-user-return-39566-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34430 invoked from network); 8 Apr 2009 16:08:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 16:08:11 -0000
Received: (qmail 63164 invoked by uid 500); 8 Apr 2009 16:08:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63113 invoked by uid 500); 8 Apr 2009 16:08:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63072 invoked by uid 99); 8 Apr 2009 16:08:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 16:08:08 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [139.56.8.26] (HELO mail-fw.broadvision.com) (139.56.8.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 16:08:01 +0000
X-ASG-Debug-ID: 1239206856-672f022e0000-H1Y1KX
X-Barracuda-URL: http://mail-fw.broadvision.com:8000/cgi-bin/mark.cgi
Received: from RW-EX2003.BROADVISION.COM (localhost [127.0.0.1])
	by mail-fw.broadvision.com (Spam Firewall) with ESMTP id 13AD51ED2C
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 09:07:36 -0700 (PDT)
Received: from RW-EX2003.BROADVISION.COM (rw-ex2003.broadvision.com [10.10.160.33]) by mail-fw.broadvision.com with ESMTP id X3G0WF3LEJCkPVeS for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 09:07:36 -0700 (PDT)
X-ASG-Whitelist: Client
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-ASG-Orig-Subj: Lucene 1.4.3: Error when creating Searcher
Subject: Lucene 1.4.3: Error when creating Searcher
Date: Wed, 8 Apr 2009 09:07:35 -0700
Message-ID: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F949@rw-ex2003.BROADVISION.COM>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene 1.4.3: Error when creating Searcher
Thread-Index: Acm4ZB490Z7Vtv9NQLSfGgTuz1NIEQ==
From: "Zhang, Lisheng" <Lisheng.Zhang@BroadVision.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: rw-ex2003.broadvision.com[10.10.160.33]
X-Barracuda-Start-Time: 1239206856
X-Barracuda-Virus-Scanned: by Barracuda Spam Firewall at broadvision.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

We are using lucene 1.4.3, sometimes when two threads try to search,
one thread got error when creating MultiSearcher:

Lock obtain timed out: =
Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63c-commit.lock

I read lucene FAQ and searched previous discussions, it seems that this
error should be related to indexing, but we are only creating Searcher?=20

Thanks very much for helps, Lisheng


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39567-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 16:58:42 2009
Return-Path: <java-user-return-39567-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49246 invoked from network); 8 Apr 2009 16:58:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 16:58:42 -0000
Received: (qmail 60640 invoked by uid 500); 8 Apr 2009 16:58:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60598 invoked by uid 500); 8 Apr 2009 16:58:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60588 invoked by uid 99); 8 Apr 2009 16:58:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 16:58:39 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.1.71] (HELO mx1.syr.edu) (128.230.1.71)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 16:58:29 +0000
Received: from suex07-hub-01.ad.syr.edu (suex07-hub-01.ad.syr.edu [128.230.108.195])
	by mx1.syr.edu (8.14.3/8.14.3) with ESMTP id n38Gw7A8001245
	for <java-user@lucene.apache.org>; Wed, 8 Apr 2009 12:58:08 -0400
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-01.ad.syr.edu ([2002:80e6:6cc3::80e6:6cc3]) with mapi; Wed, 8 Apr
 2009 12:58:08 -0400
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Wed, 8 Apr 2009 12:58:06 -0400
Subject: RE: Lucene searching across documents
Thread-Topic: Lucene searching across documents
Thread-Index: Acm4TnpYsHwrJas2SvmmF8DZy0PJ4AAF3Pfw
Message-ID: <2D127F11DC79714E9B6A43AC9458147F13FCA372@suex07-mbx-03.ad.syr.edu>
References: <1B145DAA6B4D4643B8D9709100FE080601799759@34093-C5-EVS1.exchange.rackspace.com>
In-Reply-To: <1B145DAA6B4D4643B8D9709100FE080601799759@34093-C5-EVS1.exchange.rackspace.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.7400:2.4.4,1.2.40,4.0.166 definitions=2009-04-08_06:2009-04-02,2009-04-08,2009-04-08 signatures=0
X-Proofpoint-Spam-Reason: safe
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Dan,

My guess, though you didn't directly say so, is that you're representing ea=
ch sentence/"line" as a separate Lucene document.  To directly answer your =
question about whether inter-document relations (like database joins) are q=
ueryable in Lucene, I don't think so, other than performing multiple search=
es, where you feed the results of one query into another one (e.g.: first q=
uery for all lines with tag X, retrieve the line-ID and transcript-ID field=
 values, then query for tag Y, requiring the same transcript-ID field value=
, and any one of the line-ID values that are within the window you want).

If instead (or perhaps in addition, depending on your other needs), each fu=
ll transcript is a Lucene document, you can perform the kinds of searches y=
ou're talking about with tools available in Lucene.

I'm thinking of a lucene document with a "line-tags" field, populated with =
the tags you've associated with each line, and with the position of each li=
ne tag adjusted so that two tags assigned to the same line are given the sa=
me position (sometimes Lucene users call terms with the same position "syno=
nyms", because that's the most common thing this capability is used for).

Then you can run a SpanNearQuery over the line-tags field, to return matche=
s where tag X is within N lines of tag Y.

(See <http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/span=
s/package-summary.html> for info on the Lucene Span Query family.)

Steve

On 4/8/2009 at 9:33 AM, Dan Scrima wrote:
> So I have a requirement where I have a directory filled with xml files.
> I wrote a parser to parse these files, and index all of the xml
> attributes and properties into documents. An example of one of these
> documents is below. I'm parsing sentences into words, and tagging the
> sentences based on certain criteria.
>=20
> My issue is trying to find out if lucene can handle cross-document
> searching. So below is indexed as a single document... and there will
> be multiple sentences before, after, and throughout an entire
> transcript. Is it possible somehow to say, "I want a result where one
> line marked as Symptom is 5 lines away from another line marked as
> Brand." So in essence, I'm trying to search across multiple lucene
> documents.
>=20
> Any thoughts or literature out there?
>=20
> <transcript>
>   <line id=3D"1">
>     <tag id=3D"10" type=3D"Symptom" />
>     <tag id=3D"12" type=3D"Brand" />
>     <word>
>       <token>Coughing</token>
>       <part-of-speech>SBJ</part-of-speech>
>     </word>
>     <word>
>       <token>is</token>
>       <part-of-speech>VB</part-of-speech>
>     </word>
>     <word>
>       <token>caused</token>
>       <part-of-speech>NP</part-of-speech>
>     </word>
>     <word>
>       <token>by</token>
>       <part-of-speech>PP</part-of-speech>
>     </word>
>     <word>
>       <token>Mucinex</token>
>       <part-of-speech>PDC</part-of-speech>
>     </word>
>   </line>
> </transcript>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39568-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 17:43:35 2009
Return-Path: <java-user-return-39568-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78450 invoked from network); 8 Apr 2009 17:43:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 17:43:35 -0000
Received: (qmail 35323 invoked by uid 500); 8 Apr 2009 17:43:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35286 invoked by uid 500); 8 Apr 2009 17:43:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35276 invoked by uid 99); 8 Apr 2009 17:43:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 17:43:32 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of isaacrc82@gmail.com designates 74.125.46.28 as permitted sender)
Received: from [74.125.46.28] (HELO yw-out-2324.google.com) (74.125.46.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 17:43:25 +0000
Received: by yw-out-2324.google.com with SMTP id 9so125847ywe.5
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 10:43:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=EfHjqnQcOZJzwRHzzVH6AtWkWiUFC7HRogRliAZNnaM=;
        b=JAQ7UqY+dq/soS6PY/uBktxC1O8eETCb93kwX+bb1b0BP0hpxxL3X//LUBXwlcsH3S
         V0T8aW9y6tRy+ThYW6FgHAjD5mkBN44DJuvI8f5zjA4eEFPi5BCYbgAGdRHeBbrz9ekM
         7cZaAA6aIvsYd6EiC/3w634uMHphukM6AF3oA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=u9ULlguj8iulTbZKbNTYE+LHhW8muV/ZDEJXRHhEqjjrtV4lIPMRdYI1DN0QAWlyo0
         n1HO9yxRBYLoCXtCWXkaUKoagZC9KA36Cad/yAOIV6TLKnNSaQZl0QPqD83/Y7y7txJz
         Me5ytWhk6zZAXI3RGyw9wj6FpQkBbMZ9p7KQA=
MIME-Version: 1.0
Received: by 10.100.208.8 with SMTP id f8mr3578900ang.42.1239212584736; Wed, 
	08 Apr 2009 10:43:04 -0700 (PDT)
Date: Wed, 8 Apr 2009 13:43:04 -0400
Message-ID: <bf1404350904081043n30b82a66t7fc83b41e396060@mail.gmail.com>
Subject: How Can I make an analyzer that ignore the numbers o the texts ???
From: Ariel <isaacrc82@gmail.com>
To: lucene user <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=001636af022eea186104670ea9c8
X-Virus-Checked: Checked by ClamAV on apache.org

--001636af022eea186104670ea9c8
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi everybody:

I would want to know how Can I make an analyzer that ignore the numbers o
the texts like the stop words are ignored ??? For example that the terms :
3.8, 100, 4.15, 4,33 don't be added to the index.
How can I do that ???

Regards
Ariel

--001636af022eea186104670ea9c8--

From java-user-return-39569-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 17:50:22 2009
Return-Path: <java-user-return-39569-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82525 invoked from network); 8 Apr 2009 17:50:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 17:50:22 -0000
Received: (qmail 43805 invoked by uid 500); 8 Apr 2009 17:50:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43742 invoked by uid 500); 8 Apr 2009 17:50:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43732 invoked by uid 99); 8 Apr 2009 17:50:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 17:50:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of karl.wettin@gmail.com designates 72.14.220.159 as permitted sender)
Received: from [72.14.220.159] (HELO fg-out-1718.google.com) (72.14.220.159)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 17:50:12 +0000
Received: by fg-out-1718.google.com with SMTP id l27so547794fgb.4
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 10:49:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=T9odhaictHN5nPBxHUrysWZ3dc2E+vGMoiGpTOjCJfc=;
        b=MGxshPflzozxpl+qNMK8T/vakGHtRz5Nod8hy50hQVQwtUflzKnip8OKnDxJbPIg6Z
         rGGE0/Un24107pP9tTeJa63VioxFfI2ja9pOnn4KEFxVqTOWe89A87C4hwlw4oAgC5cx
         4Xclj7i2GqRa4AJYGYZR+lgsnkICEHZnpo0hg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=BkhZ5uNGERLeC03GuCsWLNKjj2lpaIHFiv1hICfca9QGCGgWLJgpsTtJ7QVHxhzmZ5
         pCwps2JbTcHhaKJw8iIXe8RdOoK/o2mhYHNzyyYsWvJzzFTJpvSXQj3tYMamExeMi7OX
         L12HCjVX6kjeTZKVgVmKixP91jvwwcN5xj528=
Received: by 10.86.49.13 with SMTP id w13mr1284287fgw.10.1239212990615;
        Wed, 08 Apr 2009 10:49:50 -0700 (PDT)
Received: from Elf-Ulfving.midzone ([84.243.3.2])
        by mx.google.com with ESMTPS id l19sm2769144fgb.16.2009.04.08.10.49.49
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 08 Apr 2009 10:49:50 -0700 (PDT)
Message-Id: <790B06BE-9161-4BF8-B037-28D59743C76E@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <s9dc5fe8.027@mail.btsb.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Suggestive Search
Date: Wed, 8 Apr 2009 19:49:45 +0200
References: <s9dc5fe8.027@mail.btsb.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

For this you probably want to use ngrams. Wether or not this is  
something that fits in your current index is hard to say. My guess is  
that you want to create a new index with one document per unique  
phrase. You might also want to try to load this index in an  
InstantiatedIndex, that could speed things up quite a bit if the  
corpus is not too large.

If your suggestion text corpus is really large and you only want  
forward-only suggestions then you might want to consider a trie- 
pattern solution instead. These can be rather resource efficient, even  
when loaded to memory.

If you have a lot of user load on your search eninge then it might be  
interesting to use old user queries as the base of your suggestions  
and perhaps boost a bit on trends, i.e. the more people search for  
something the more it get boosted in the suggestions list.


      karl

8 apr 2009 kl. 15.26 skrev Matt Schraeder:

> I want to add a suggestive search similar to google's to autocomplete
> search phrases as the user types.  It doesn't have to be very  
> elaborate
> and for the most part will just involve searching single fields.  How
> can I perform a search  to be able to fill in autocomplete text?
>
> For instance, if I start typing "Harr" it should bring up "Harry
> Potter" "Harry Houdini" and "Harry S. Truman"
>
> I have tried doing search queries for "Harr*" but it's still doing
> term-based searching rather than searching a full field.  To make a
> field both searchable as the full field as well as tokenized, would I
> have to duplicate the field and make one a keyword field? Is there a
> more convenient way to do this? I have also considered making a second
> index for suggestive search, which would only have the fields that I
> want to enable suggestive search on, but this seems like it would be
> unneccesary duplication of data as well, though it would probably make
> suggestive search faster due to a smaller index.
>
> Ideally it would also be nice to be able to rank these terms based on
> the number of times they have been searched for so that the results  
> are
> tailored more to our users rather than simply just the score that  
> Lucene
> chooses.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39570-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 17:53:05 2009
Return-Path: <java-user-return-39570-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84471 invoked from network); 8 Apr 2009 17:53:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 17:53:04 -0000
Received: (qmail 52606 invoked by uid 500); 8 Apr 2009 17:53:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52547 invoked by uid 500); 8 Apr 2009 17:53:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52537 invoked by uid 99); 8 Apr 2009 17:53:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 17:53:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 17:52:53 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n38HqU2Z025714
	for <java-user@lucene.apache.org>; Wed, 8 Apr 2009 13:52:31 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <49DCE45D.1080606@informatics.jax.org>
Date: Wed, 08 Apr 2009 13:52:29 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: How Can I make an analyzer that ignore the numbers o the texts
 ???
References: <bf1404350904081043n30b82a66t7fc83b41e396060@mail.gmail.com>
In-Reply-To: <bf1404350904081043n30b82a66t7fc83b41e396060@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.5.1.360522, Antispam-Engine: 2.6.1.350677, Antispam-Data: 2009.4.8.173725
X-PerlMx-Spam: Gauge=IIIIIII, Probability=8%, Report='BODY_SIZE_1000_LESS 0, BODY_SIZE_2000_LESS 0, BODY_SIZE_5000_LESS 0, BODY_SIZE_7000_LESS 0, BODY_SIZE_900_999 0, TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __C230066_P5 0, __CP_URI_IN_BODY 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __HAS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __MOZILLA_MSGID 0, __SANE_MSGID 0, __TO_MALFORMED_2 0, __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

You can define your own STOP_LIST and pass it in as a constructor to 
most analyzers.

For example from the Lucene Javadocs:


      StandardAnalyzer

public *StandardAnalyzer*(String <http://java.sun.com/j2se/1.4/docs/api/java/lang/String.html>[] stopWords)

Builds an analyzer with the given stop words.

The only thing that you need to be careful of is to make sure that the 
analyzer isn't doing some sort of conversion of the tokens before the 
stoplist is checked, but otherwise that should work out just fine.

Matt

Ariel wrote:
> Hi everybody:
>
> I would want to know how Can I make an analyzer that ignore the numbers o
> the texts like the stop words are ignored ??? For example that the terms :
> 3.8, 100, 4.15, 4,33 don't be added to the index.
> How can I do that ???
>
> Regards
> Ariel
>
>   


-- 
Matthew Hall
Software Engineer
Mouse Genome Informatics
mhall@informatics.jax.org
(207) 288-6012



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39571-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 17:55:30 2009
Return-Path: <java-user-return-39571-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86055 invoked from network); 8 Apr 2009 17:55:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 17:55:28 -0000
Received: (qmail 57263 invoked by uid 500); 8 Apr 2009 17:55:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57188 invoked by uid 500); 8 Apr 2009 17:55:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57178 invoked by uid 99); 8 Apr 2009 17:55:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 17:55:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of koji@r.email.ne.jp designates 202.224.39.197 as permitted sender)
Received: from [202.224.39.197] (HELO mail1.asahi-net.or.jp) (202.224.39.197)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 17:55:16 +0000
Received: from koji-sekiguchi-no-macbook.local (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	by mail1.asahi-net.or.jp (Postfix) with ESMTP id 32BBD68CBD
	for <java-user@lucene.apache.org>; Thu,  9 Apr 2009 02:54:55 +0900 (JST)
Message-ID: <49DCE4EE.7020407@r.email.ne.jp>
Date: Thu, 09 Apr 2009 02:54:54 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.21 (Macintosh/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: How Can I make an analyzer that ignore the numbers o the texts
 ???
References: <bf1404350904081043n30b82a66t7fc83b41e396060@mail.gmail.com>
In-Reply-To: <bf1404350904081043n30b82a66t7fc83b41e396060@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Ariel wrote:
> Hi everybody:
>
> I would want to know how Can I make an analyzer that ignore the numbers o
> the texts like the stop words are ignored ??? For example that the terms :
> 3.8, 100, 4.15, 4,33 don't be added to the index.
> How can I do that ???
>
> Regards
> Ariel
>
>   

There is a patch for filtering out number tokens:

https://issues.apache.org/jira/browse/SOLR-448

Koji


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39572-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 18:11:45 2009
Return-Path: <java-user-return-39572-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96515 invoked from network); 8 Apr 2009 18:11:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 18:11:44 -0000
Received: (qmail 81474 invoked by uid 500); 8 Apr 2009 18:11:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81271 invoked by uid 500); 8 Apr 2009 18:11:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81053 invoked by uid 99); 8 Apr 2009 18:05:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 18:05:47 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.18.82] (HELO smtp1.syr.edu) (128.230.18.82)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 18:05:38 +0000
Received: from suex07-hub-01.ad.syr.edu (suex07-hub-01.ad.syr.edu [128.230.108.195])
	by smtp1.syr.edu (8.14.3/8.14.3) with ESMTP id n38I5G36023270
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=FAIL)
	for <java-user@lucene.apache.org>; Wed, 8 Apr 2009 14:05:17 -0400
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-01.ad.syr.edu ([2002:80e6:6cc3::80e6:6cc3]) with mapi; Wed, 8 Apr
 2009 14:05:16 -0400
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Wed, 8 Apr 2009 14:05:16 -0400
Subject: RE: How Can I make an analyzer that ignore the numbers o the texts
 ???
Thread-Topic: How Can I make an analyzer that ignore the numbers o the texts
 ???
Thread-Index: Acm4cY5ZG5RVewEdQ1KIdkQJP0gOQgAAW2+A
Message-ID: <2D127F11DC79714E9B6A43AC9458147F13FCA373@suex07-mbx-03.ad.syr.edu>
References: <bf1404350904081043n30b82a66t7fc83b41e396060@mail.gmail.com>
In-Reply-To: <bf1404350904081043n30b82a66t7fc83b41e396060@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.7400:2.4.4,1.2.40,4.0.166 definitions=2009-04-08_06:2009-04-02,2009-04-08,2009-04-08 signatures=0
X-Proofpoint-Spam-Reason: safe
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Ariel,

As Koji mentioned, https://issues.apache.org/jira/browse/SOLR-448 contains =
a NumberFilter.  It filters out tokens that successfully parse as Doubles. =
 I'm not sure, since the examples you gave seem to use "," as the decimal c=
haracter, how this interacts with the Locale.  (Koji, I don't see any ","-a=
s-decimal tests in your patch.)

There is another one here that filters out tokens that have an initial digi=
t character:

<http://mail-archives.apache.org/mod_mbox/lucene-java-dev/200405.mbox/%3CPi=
ne.LNX.4.58.0405011916170.23501@eros.its.deakin.edu.au%3E>

Steve

On 4/8/2009 at 1:43 PM, Ariel wrote:
> I would want to know how Can I make an analyzer that ignore the numbers
> o the texts like the stop words are ignored ??? For example that the
> terms : 3.8, 100, 4.15, 4,33 don't be added to the index.
> How can I do that ???
>=20
> Regards
> Ariel


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39573-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 18:48:33 2009
Return-Path: <java-user-return-39573-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21462 invoked from network); 8 Apr 2009 18:48:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 18:48:32 -0000
Received: (qmail 41502 invoked by uid 500); 8 Apr 2009 18:48:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41409 invoked by uid 500); 8 Apr 2009 18:48:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41399 invoked by uid 99); 8 Apr 2009 18:48:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 18:48:30 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of MSchraeder@btsb.com designates 216.8.91.5 as permitted sender)
Received: from [216.8.91.5] (HELO mail.btsb.com) (216.8.91.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 18:48:22 +0000
X-IronPort-AV: E=Sophos;i="4.39,345,1235973600"; 
   d="scan'208,217";a="477921"
Received: from unknown (HELO mail.btsb.com) ([10.1.1.2])
  by mail.btsb.com with ESMTP; 08 Apr 2009 13:51:08 -0500
Received: from GWDOMAIN-MTA by mail.btsb.com
	with Novell_GroupWise; Wed, 08 Apr 2009 13:50:12 -0500
Message-Id: <s9dcab94.070@mail.btsb.com>
X-Mailer: Novell GroupWise Internet Agent 6.5.5 
Date: Wed, 08 Apr 2009 13:50:00 -0500
From: "Matt Schraeder" <MSchraeder@btsb.com>
To: <java-user@lucene.apache.org>
Subject: Re: Suggestive Search
Mime-Version: 1.0
Content-Type: multipart/alternative; boundary="=__PartC4EC5CC8.0__="
X-Virus-Checked: Checked by ClamAV on apache.org

--=__PartC4EC5CC8.0__=
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Corerct me if I'm wrong, but I don't think n-grams is really what I'm
looking for here.  I'm not looking for a spellchecker or phrase checker
style suggestive search, but only based on the exact phrases the user is
currently typing.  Since Lucene uses term-based searching, I'm not sure
how to have it search on portions of a full phrase.  Using a standard
lucene search typing in "harr" will result in searching for "harr" as a
term, which will not find "Harry Potter".  Using ngrams it would find
"Harry" as a term, but not at the beginning of an entire phrase.  This
would bring back "My Dog Harry" as a result, which isn't what I'm
looking for. I just want phrases from fields beginning with "Harr"
only.
 
I could easily do this all with our database server by simply doing a
query for "where searchqueries like 'harr%'" but we're trying to limit
our hits to the database to keep speed up on the site.

>>> karl.wettin@gmail.com 4/8/2009 12:49:45 PM >>>

For this you probably want to use ngrams. Wether or not this is  
something that fits in your current index is hard to say. My guess is 

that you want to create a new index with one document per unique  
phrase. You might also want to try to load this index in an  
InstantiatedIndex, that could speed things up quite a bit if the  
corpus is not too large.

If your suggestion text corpus is really large and you only want  
forward-only suggestions then you might want to consider a trie- 
pattern solution instead. These can be rather resource efficient, even 

when loaded to memory.

If you have a lot of user load on your search eninge then it might be 

interesting to use old user queries as the base of your suggestions  
and perhaps boost a bit on trends, i.e. the more people search for  
something the more it get boosted in the suggestions list.


      karl

8 apr 2009 kl. 15.26 skrev Matt Schraeder:

> I want to add a suggestive search similar to google's to
autocomplete
> search phrases as the user types.  It doesn't have to be very  
> elaborate
> and for the most part will just involve searching single fields. 
How
> can I perform a search  to be able to fill in autocomplete text?
>
> For instance, if I start typing "Harr" it should bring up "Harry
> Potter" "Harry Houdini" and "Harry S. Truman"
>
> I have tried doing search queries for "Harr*" but it's still doing
> term-based searching rather than searching a full field.  To make a
> field both searchable as the full field as well as tokenized, would
I
> have to duplicate the field and make one a keyword field? Is there a
> more convenient way to do this? I have also considered making a
second
> index for suggestive search, which would only have the fields that I
> want to enable suggestive search on, but this seems like it would be
> unneccesary duplication of data as well, though it would probably
make
> suggestive search faster due to a smaller index.
>
> Ideally it would also be nice to be able to rank these terms based
on
> the number of times they have been searched for so that the results 

> are
> tailored more to our users rather than simply just the score that  
> Lucene
> chooses.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



--=__PartC4EC5CC8.0__=--

From java-user-return-39574-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 19:06:26 2009
Return-Path: <java-user-return-39574-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27063 invoked from network); 8 Apr 2009 19:06:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 19:06:26 -0000
Received: (qmail 61168 invoked by uid 500); 8 Apr 2009 19:06:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61080 invoked by uid 500); 8 Apr 2009 19:06:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61070 invoked by uid 99); 8 Apr 2009 19:06:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 19:06:24 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [74.86.124.115] (HELO rpdz2.dailyrazor.com) (74.86.124.115)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 19:06:16 +0000
Received: from c-76-100-31-215.hsd1.md.comcast.net ([76.100.31.215]:37833 helo=[192.168.169.1])
	by rpdz2.dailyrazor.com with esmtpa (Exim 4.69)
	(envelope-from <gary@littlebunch.com>)
	id 1Lrd5n-0001rF-O3
	for java-user@lucene.apache.org; Wed, 08 Apr 2009 14:05:47 -0500
Message-ID: <49DCF585.2020608@littlebunch.com>
Date: Wed, 08 Apr 2009 15:05:41 -0400
From: Gary Moore <gary@littlebunch.com>
User-Agent: Thunderbird 2.0.0.21 (X11/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Suggestive Search
References: <s9dcab94.070@mail.btsb.com>
In-Reply-To: <s9dcab94.070@mail.btsb.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - rpdz2.dailyrazor.com
X-AntiAbuse: Original Domain - lucene.apache.org
X-AntiAbuse: Originator/Caller UID/GID - [47 12] / [47 12]
X-AntiAbuse: Sender Address Domain - littlebunch.com
X-Virus-Checked: Checked by ClamAV on apache.org

I use TermEnum for this sort of  "browsing" on untokenized, unstored 
fields e.g. TermEnum terms=reader.terms(new Term("mybrowsefld","harr")).
-Gary
Matt Schraeder wrote:
> Corerct me if I'm wrong, but I don't think n-grams is really what I'm
> looking for here.  I'm not looking for a spellchecker or phrase checker
> style suggestive search, but only based on the exact phrases the user is
> currently typing.  Since Lucene uses term-based searching, I'm not sure
> how to have it search on portions of a full phrase.  Using a standard
> lucene search typing in "harr" will result in searching for "harr" as a
> term, which will not find "Harry Potter".  Using ngrams it would find
> "Harry" as a term, but not at the beginning of an entire phrase.  This
> would bring back "My Dog Harry" as a result, which isn't what I'm
> looking for. I just want phrases from fields beginning with "Harr"
> only.
>  
> I could easily do this all with our database server by simply doing a
> query for "where searchqueries like 'harr%'" but we're trying to limit
> our hits to the database to keep speed up on the site.
>
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39575-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 19:41:25 2009
Return-Path: <java-user-return-39575-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38174 invoked from network); 8 Apr 2009 19:41:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 19:41:25 -0000
Received: (qmail 91672 invoked by uid 500); 8 Apr 2009 19:41:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91585 invoked by uid 500); 8 Apr 2009 19:41:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91575 invoked by uid 99); 8 Apr 2009 19:41:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 19:41:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [139.56.8.26] (HELO mail-fw.broadvision.com) (139.56.8.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 19:41:14 +0000
X-ASG-Debug-ID: 1239219649-574101470000-H1Y1KX
X-Barracuda-URL: http://mail-fw.broadvision.com:8000/cgi-bin/mark.cgi
Received: from RW-EX2003.BROADVISION.COM (localhost [127.0.0.1])
	by mail-fw.broadvision.com (Spam Firewall) with ESMTP id 67DFC1F6F3
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 12:40:49 -0700 (PDT)
Received: from RW-EX2003.BROADVISION.COM (rw-ex2003.broadvision.com [10.10.160.33]) by mail-fw.broadvision.com with ESMTP id eazgVCtiwmyWCksW for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 12:40:49 -0700 (PDT)
X-ASG-Whitelist: Client
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-ASG-Orig-Subj: RE: Lucene 1.4.3: Error when creating Searcher
Subject: RE: Lucene 1.4.3: Error when creating Searcher
Date: Wed, 8 Apr 2009 12:40:49 -0700
Message-ID: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F94B@rw-ex2003.BROADVISION.COM>
In-Reply-To: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F949@rw-ex2003.BROADVISION.COM>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene 1.4.3: Error when creating Searcher
Thread-Index: Acm4ZB490Z7Vtv9NQLSfGgTuz1NIEQAG1JUQ
From: "Zhang, Lisheng" <Lisheng.Zhang@BroadVision.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: rw-ex2003.broadvision.com[10.10.160.33]
X-Barracuda-Start-Time: 1239219649
X-Barracuda-Virus-Scanned: by Barracuda Spam Firewall at broadvision.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Sorry that my initial message is not clear, I read lucene source code =
(both 1.4.3=20
and 2.4.0), and understood more.

The problem is that when using lucene 1.4.3 sometimes when searching, we =
got
the error:

Lock obtain timed out: =
Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63c-commit.lock

It seems that in 2.4.0 we will never have this issue because this error =
can only=20
happen when concurrent writing.

Is this true?

Thanks very much for helps, Lisheng


>  -----Original Message-----
> From: 	Zhang, Lisheng =20
> Sent:	Wednesday, April 08, 2009 9:08 AM
> To:	'java-user@lucene.apache.org'
> Subject:	Lucene 1.4.3: Error when creating Searcher
>=20
> Hi,
>=20
> We are using lucene 1.4.3, sometimes when two threads try to search,
> one thread got error when creating MultiSearcher:
>=20
> Lock obtain timed out: =
Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63c-commit.lock
>=20
> I read lucene FAQ and searched previous discussions, it seems that =
this
> error should be related to indexing, but we are only creating =
Searcher?=20
>=20
> Thanks very much for helps, Lisheng
>=20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39576-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 20:00:36 2009
Return-Path: <java-user-return-39576-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42361 invoked from network); 8 Apr 2009 20:00:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 20:00:34 -0000
Received: (qmail 15892 invoked by uid 500); 8 Apr 2009 20:00:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15809 invoked by uid 500); 8 Apr 2009 20:00:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15799 invoked by uid 99); 8 Apr 2009 20:00:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 20:00:32 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.168] (HELO wf-out-1314.google.com) (209.85.200.168)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 20:00:23 +0000
Received: by wf-out-1314.google.com with SMTP id 29so300929wff.20
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 12:59:58 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.89.13 with SMTP id m13mr571539wfb.50.1239220798149; Wed, 
	08 Apr 2009 12:59:58 -0700 (PDT)
In-Reply-To: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F94B@rw-ex2003.BROADVISION.COM>
References: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F949@rw-ex2003.BROADVISION.COM>
	 <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F94B@rw-ex2003.BROADVISION.COM>
Date: Wed, 8 Apr 2009 15:59:58 -0400
Message-ID: <9ac0c6aa0904081259q2557fc00t62ed8443db6a5458@mail.gmail.com>
Subject: Re: Lucene 1.4.3: Error when creating Searcher
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Likely your exception happened because a reader was trying to open
just as a writer was committing, twice in a row.

Do you commit (flush or close) frequently from your writer?

As of 2.1, Lucene no longer uses a commit locks -- commits are now
lockless, so you won't hit this on upgrading to 2.4.

Mike

On Wed, Apr 8, 2009 at 3:40 PM, Zhang, Lisheng
<Lisheng.Zhang@broadvision.com> wrote:
> Hi,
>
> Sorry that my initial message is not clear, I read lucene source code (bo=
th 1.4.3
> and 2.4.0), and understood more.
>
> The problem is that when using lucene 1.4.3 sometimes when searching, we =
got
> the error:
>
> Lock obtain timed out: Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63c-=
commit.lock
>
> It seems that in 2.4.0 we will never have this issue because this error c=
an only
> happen when concurrent writing.
>
> Is this true?
>
> Thanks very much for helps, Lisheng
>
>
>> =A0-----Original Message-----
>> From: =A0 =A0 =A0 =A0 Zhang, Lisheng
>> Sent: Wednesday, April 08, 2009 9:08 AM
>> To: =A0 'java-user@lucene.apache.org'
>> Subject: =A0 =A0 =A0Lucene 1.4.3: Error when creating Searcher
>>
>> Hi,
>>
>> We are using lucene 1.4.3, sometimes when two threads try to search,
>> one thread got error when creating MultiSearcher:
>>
>> Lock obtain timed out: Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63c=
-commit.lock
>>
>> I read lucene FAQ and searched previous discussions, it seems that this
>> error should be related to indexing, but we are only creating Searcher?
>>
>> Thanks very much for helps, Lisheng
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39577-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 20:47:33 2009
Return-Path: <java-user-return-39577-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58905 invoked from network); 8 Apr 2009 20:47:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 20:47:33 -0000
Received: (qmail 75500 invoked by uid 500); 8 Apr 2009 20:47:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75426 invoked by uid 500); 8 Apr 2009 20:47:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75416 invoked by uid 99); 8 Apr 2009 20:47:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 20:47:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [139.56.8.26] (HELO mail-fw.broadvision.com) (139.56.8.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 20:47:23 +0000
X-ASG-Debug-ID: 1239223622-574101d90000-H1Y1KX
X-Barracuda-URL: http://mail-fw.broadvision.com:8000/cgi-bin/mark.cgi
Received: from RW-EX2003.BROADVISION.COM (localhost [127.0.0.1])
	by mail-fw.broadvision.com (Spam Firewall) with ESMTP id A4DBB1F729
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 13:47:02 -0700 (PDT)
Received: from RW-EX2003.BROADVISION.COM (rw-ex2003.broadvision.com [10.10.160.33]) by mail-fw.broadvision.com with ESMTP id X6b0u8nnhEJQOYFs for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 13:47:02 -0700 (PDT)
X-ASG-Whitelist: Client
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-ASG-Orig-Subj: RE: Lucene 1.4.3: Error when creating Searcher
Subject: RE: Lucene 1.4.3: Error when creating Searcher
Date: Wed, 8 Apr 2009 13:47:02 -0700
Message-ID: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F94D@rw-ex2003.BROADVISION.COM>
In-Reply-To: <9ac0c6aa0904081259q2557fc00t62ed8443db6a5458@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene 1.4.3: Error when creating Searcher
Thread-Index: Acm4hLFng1f827n4TDitIP6X0lmf8AABKAFQ
From: "Zhang, Lisheng" <Lisheng.Zhang@BroadVision.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: rw-ex2003.broadvision.com[10.10.160.33]
X-Barracuda-Start-Time: 1239223622
X-Barracuda-Virus-Scanned: by Barracuda Spam Firewall at broadvision.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Client said they did not index, all they do is searching (create
Searcher objects), I looked at 1.4.3 and think this issue can
happen in:

private static IndexReader open(final Directory directory, final boolean =
closeDirectory)=20
  syncronized(directory) {...}

if calls are coming from different Java processes (in our case=20
a few AppServer clusters)?

Thanks very much for helps, Lisheng

-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]
Sent: Wednesday, April 08, 2009 1:00 PM
To: java-user@lucene.apache.org
Subject: Re: Lucene 1.4.3: Error when creating Searcher


Likely your exception happened because a reader was trying to open
just as a writer was committing, twice in a row.

Do you commit (flush or close) frequently from your writer?

As of 2.1, Lucene no longer uses a commit locks -- commits are now
lockless, so you won't hit this on upgrading to 2.4.

Mike

On Wed, Apr 8, 2009 at 3:40 PM, Zhang, Lisheng
<Lisheng.Zhang@broadvision.com> wrote:
> Hi,
>
> Sorry that my initial message is not clear, I read lucene source code =
(both 1.4.3
> and 2.4.0), and understood more.
>
> The problem is that when using lucene 1.4.3 sometimes when searching, =
we got
> the error:
>
> Lock obtain timed out: =
Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63c-commit.lock
>
> It seems that in 2.4.0 we will never have this issue because this =
error can only
> happen when concurrent writing.
>
> Is this true?
>
> Thanks very much for helps, Lisheng
>
>
>> =A0-----Original Message-----
>> From: =A0 =A0 =A0 =A0 Zhang, Lisheng
>> Sent: Wednesday, April 08, 2009 9:08 AM
>> To: =A0 'java-user@lucene.apache.org'
>> Subject: =A0 =A0 =A0Lucene 1.4.3: Error when creating Searcher
>>
>> Hi,
>>
>> We are using lucene 1.4.3, sometimes when two threads try to search,
>> one thread got error when creating MultiSearcher:
>>
>> Lock obtain timed out: =
Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63c-commit.lock
>>
>> I read lucene FAQ and searched previous discussions, it seems that =
this
>> error should be related to indexing, but we are only creating =
Searcher?
>>
>> Thanks very much for helps, Lisheng
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39578-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 20:59:03 2009
Return-Path: <java-user-return-39578-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63018 invoked from network); 8 Apr 2009 20:59:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 20:59:03 -0000
Received: (qmail 93420 invoked by uid 500); 8 Apr 2009 20:59:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93340 invoked by uid 500); 8 Apr 2009 20:59:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93330 invoked by uid 99); 8 Apr 2009 20:59:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 20:59:01 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 20:58:54 +0000
Received: by qyk8 with SMTP id 8so533528qyk.29
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 13:58:33 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.229.99.211 with SMTP id v19mr696543qcn.97.1239224312889; Wed, 
	08 Apr 2009 13:58:32 -0700 (PDT)
In-Reply-To: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F94D@rw-ex2003.BROADVISION.COM>
References: <9ac0c6aa0904081259q2557fc00t62ed8443db6a5458@mail.gmail.com>
	 <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F94D@rw-ex2003.BROADVISION.COM>
Date: Wed, 8 Apr 2009 16:58:32 -0400
Message-ID: <9ac0c6aa0904081358g4bedf187sd64aa97798f1764c@mail.gmail.com>
Subject: Re: Lucene 1.4.3: Error when creating Searcher
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Ahh yes right.  If multiple IndexSearchers are trying to open at once,
they each try to acquire the commit lock and can thus starve one
another.

The simplest workaround is to just keep retrying opening the IndexSearcher.

Though if you accidentally get an orphan'd commit lock in the
directory (eg if the JRE was killed while IndexSearcher was trying to
open) then you'll have to remove that file.

Or upgrade to Lucene >=3D 2.1 with lockless commits.

Mike

On Wed, Apr 8, 2009 at 4:47 PM, Zhang, Lisheng
<Lisheng.Zhang@broadvision.com> wrote:
> Hi,
>
> Client said they did not index, all they do is searching (create
> Searcher objects), I looked at 1.4.3 and think this issue can
> happen in:
>
> private static IndexReader open(final Directory directory, final boolean =
closeDirectory)
> =A0syncronized(directory) {...}
>
> if calls are coming from different Java processes (in our case
> a few AppServer clusters)?
>
> Thanks very much for helps, Lisheng
>
> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: Wednesday, April 08, 2009 1:00 PM
> To: java-user@lucene.apache.org
> Subject: Re: Lucene 1.4.3: Error when creating Searcher
>
>
> Likely your exception happened because a reader was trying to open
> just as a writer was committing, twice in a row.
>
> Do you commit (flush or close) frequently from your writer?
>
> As of 2.1, Lucene no longer uses a commit locks -- commits are now
> lockless, so you won't hit this on upgrading to 2.4.
>
> Mike
>
> On Wed, Apr 8, 2009 at 3:40 PM, Zhang, Lisheng
> <Lisheng.Zhang@broadvision.com> wrote:
>> Hi,
>>
>> Sorry that my initial message is not clear, I read lucene source code (b=
oth 1.4.3
>> and 2.4.0), and understood more.
>>
>> The problem is that when using lucene 1.4.3 sometimes when searching, we=
 got
>> the error:
>>
>> Lock obtain timed out: Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63c=
-commit.lock
>>
>> It seems that in 2.4.0 we will never have this issue because this error =
can only
>> happen when concurrent writing.
>>
>> Is this true?
>>
>> Thanks very much for helps, Lisheng
>>
>>
>>> =A0-----Original Message-----
>>> From: =A0 =A0 =A0 =A0 Zhang, Lisheng
>>> Sent: Wednesday, April 08, 2009 9:08 AM
>>> To: =A0 'java-user@lucene.apache.org'
>>> Subject: =A0 =A0 =A0Lucene 1.4.3: Error when creating Searcher
>>>
>>> Hi,
>>>
>>> We are using lucene 1.4.3, sometimes when two threads try to search,
>>> one thread got error when creating MultiSearcher:
>>>
>>> Lock obtain timed out: Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63=
c-commit.lock
>>>
>>> I read lucene FAQ and searched previous discussions, it seems that this
>>> error should be related to indexing, but we are only creating Searcher?
>>>
>>> Thanks very much for helps, Lisheng
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39579-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 21:03:07 2009
Return-Path: <java-user-return-39579-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64236 invoked from network); 8 Apr 2009 21:03:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 21:03:07 -0000
Received: (qmail 2701 invoked by uid 500); 8 Apr 2009 21:03:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2634 invoked by uid 500); 8 Apr 2009 21:03:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2624 invoked by uid 99); 8 Apr 2009 21:03:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 21:03:05 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 21:02:56 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lreup-00059x-BK
	for java-user@lucene.apache.org; Wed, 08 Apr 2009 14:02:35 -0700
Message-ID: <22959498.post@talk.nabble.com>
Date: Wed, 8 Apr 2009 14:02:35 -0700 (PDT)
From: The Seer <pulsphoto@yahoo.com>
To: java-user@lucene.apache.org
Subject: Lucene help with query
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: pulsphoto@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,

I have 5 lucene documents 

name: Apple
name: Apple martini
name: Apple drink
name: Apple sweet drink

I am using lucene default similarity and standard analyzer .

When I am searching for apple I am getting all 4 documents with the same
score back. If I use hits the score is 1.0 if I use hit collator is some
number

Can someone explain why? 


I am generating my query using query parser
The field is ANALYZED 


Thanks

-- 
View this message in context: http://www.nabble.com/Lucene-help-with-query-tp22959498p22959498.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39580-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 21:14:38 2009
Return-Path: <java-user-return-39580-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68206 invoked from network); 8 Apr 2009 21:14:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 21:14:38 -0000
Received: (qmail 21080 invoked by uid 500); 8 Apr 2009 21:14:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20988 invoked by uid 500); 8 Apr 2009 21:14:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20976 invoked by uid 99); 8 Apr 2009 21:14:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 21:14:35 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [139.56.8.26] (HELO mail-fw.broadvision.com) (139.56.8.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 21:14:28 +0000
X-ASG-Debug-ID: 1239225247-79ba000a0000-H1Y1KX
X-Barracuda-URL: http://mail-fw.broadvision.com:8000/cgi-bin/mark.cgi
Received: from RW-EX2003.BROADVISION.COM (localhost [127.0.0.1])
	by mail-fw.broadvision.com (Spam Firewall) with ESMTP id 340F09691
	for <java-user@lucene.apache.org>; Wed,  8 Apr 2009 14:14:07 -0700 (PDT)
Received: from RW-EX2003.BROADVISION.COM (rw-ex2003.broadvision.com [10.10.160.33]) by mail-fw.broadvision.com with ESMTP id qTn5MVUqdqOb3Br9 for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 14:14:07 -0700 (PDT)
X-ASG-Whitelist: Client
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-ASG-Orig-Subj: RE: Lucene 1.4.3: Error when creating Searcher
Subject: RE: Lucene 1.4.3: Error when creating Searcher
Date: Wed, 8 Apr 2009 14:14:07 -0700
Message-ID: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F94F@rw-ex2003.BROADVISION.COM>
In-Reply-To: <9ac0c6aa0904081358g4bedf187sd64aa97798f1764c@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene 1.4.3: Error when creating Searcher
Thread-Index: Acm4jNxbLXKKLKAzRO2+xujeyXQkNAAAZYzA
From: "Zhang, Lisheng" <Lisheng.Zhang@BroadVision.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: rw-ex2003.broadvision.com[10.10.160.33]
X-Barracuda-Start-Time: 1239225247
X-Barracuda-Virus-Scanned: by Barracuda Spam Firewall at broadvision.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

So it is always OK in 2.4 when multiple java processes=20
try to create IndexerSearcher at the same time? Just=20
want to make sure.

I think upgrading should be the best option.

Thanks very much for helps, Lisheng

-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]
Sent: Wednesday, April 08, 2009 1:59 PM
To: java-user@lucene.apache.org
Subject: Re: Lucene 1.4.3: Error when creating Searcher


Ahh yes right.  If multiple IndexSearchers are trying to open at once,
they each try to acquire the commit lock and can thus starve one
another.

The simplest workaround is to just keep retrying opening the =
IndexSearcher.

Though if you accidentally get an orphan'd commit lock in the
directory (eg if the JRE was killed while IndexSearcher was trying to
open) then you'll have to remove that file.

Or upgrade to Lucene >=3D 2.1 with lockless commits.

Mike

On Wed, Apr 8, 2009 at 4:47 PM, Zhang, Lisheng
<Lisheng.Zhang@broadvision.com> wrote:
> Hi,
>
> Client said they did not index, all they do is searching (create
> Searcher objects), I looked at 1.4.3 and think this issue can
> happen in:
>
> private static IndexReader open(final Directory directory, final =
boolean closeDirectory)
> =A0syncronized(directory) {...}
>
> if calls are coming from different Java processes (in our case
> a few AppServer clusters)?
>
> Thanks very much for helps, Lisheng
>
> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: Wednesday, April 08, 2009 1:00 PM
> To: java-user@lucene.apache.org
> Subject: Re: Lucene 1.4.3: Error when creating Searcher
>
>
> Likely your exception happened because a reader was trying to open
> just as a writer was committing, twice in a row.
>
> Do you commit (flush or close) frequently from your writer?
>
> As of 2.1, Lucene no longer uses a commit locks -- commits are now
> lockless, so you won't hit this on upgrading to 2.4.
>
> Mike
>
> On Wed, Apr 8, 2009 at 3:40 PM, Zhang, Lisheng
> <Lisheng.Zhang@broadvision.com> wrote:
>> Hi,
>>
>> Sorry that my initial message is not clear, I read lucene source code =
(both 1.4.3
>> and 2.4.0), and understood more.
>>
>> The problem is that when using lucene 1.4.3 sometimes when searching, =
we got
>> the error:
>>
>> Lock obtain timed out: =
Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63c-commit.lock
>>
>> It seems that in 2.4.0 we will never have this issue because this =
error can only
>> happen when concurrent writing.
>>
>> Is this true?
>>
>> Thanks very much for helps, Lisheng
>>
>>
>>> =A0-----Original Message-----
>>> From: =A0 =A0 =A0 =A0 Zhang, Lisheng
>>> Sent: Wednesday, April 08, 2009 9:08 AM
>>> To: =A0 'java-user@lucene.apache.org'
>>> Subject: =A0 =A0 =A0Lucene 1.4.3: Error when creating Searcher
>>>
>>> Hi,
>>>
>>> We are using lucene 1.4.3, sometimes when two threads try to search,
>>> one thread got error when creating MultiSearcher:
>>>
>>> Lock obtain timed out: =
Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63c-commit.lock
>>>
>>> I read lucene FAQ and searched previous discussions, it seems that =
this
>>> error should be related to indexing, but we are only creating =
Searcher?
>>>
>>> Thanks very much for helps, Lisheng
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39581-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 21:26:44 2009
Return-Path: <java-user-return-39581-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72919 invoked from network); 8 Apr 2009 21:26:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 21:26:44 -0000
Received: (qmail 42448 invoked by uid 500); 8 Apr 2009 21:26:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42389 invoked by uid 500); 8 Apr 2009 21:26:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42379 invoked by uid 99); 8 Apr 2009 21:26:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 21:26:41 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 21:26:35 +0000
Received: by qyk8 with SMTP id 8so552829qyk.29
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 14:26:12 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.229.82.10 with SMTP id z10mr745467qck.83.1239225972691; Wed, 
	08 Apr 2009 14:26:12 -0700 (PDT)
In-Reply-To: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F94F@rw-ex2003.BROADVISION.COM>
References: <9ac0c6aa0904081358g4bedf187sd64aa97798f1764c@mail.gmail.com>
	 <ED081AC9AEEE0248BBCCDE9989AAE3FC0151F94F@rw-ex2003.BROADVISION.COM>
Date: Wed, 8 Apr 2009 17:26:12 -0400
Message-ID: <9ac0c6aa0904081426r5b0fcf12g671587e86efbb151@mail.gmail.com>
Subject: Re: Lucene 1.4.3: Error when creating Searcher
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Yes, no locking is done anymore (as of 2.1) when opening
IndexSearchers.  So, it's fine.

Though... if they are within a single JRE, it's best to open a single
IndexSearcher and share.

Mike

On Wed, Apr 8, 2009 at 5:14 PM, Zhang, Lisheng
<Lisheng.Zhang@broadvision.com> wrote:
> Hi,
>
> So it is always OK in 2.4 when multiple java processes
> try to create IndexerSearcher at the same time? Just
> want to make sure.
>
> I think upgrading should be the best option.
>
> Thanks very much for helps, Lisheng
>
> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: Wednesday, April 08, 2009 1:59 PM
> To: java-user@lucene.apache.org
> Subject: Re: Lucene 1.4.3: Error when creating Searcher
>
>
> Ahh yes right. =A0If multiple IndexSearchers are trying to open at once,
> they each try to acquire the commit lock and can thus starve one
> another.
>
> The simplest workaround is to just keep retrying opening the IndexSearche=
r.
>
> Though if you accidentally get an orphan'd commit lock in the
> directory (eg if the JRE was killed while IndexSearcher was trying to
> open) then you'll have to remove that file.
>
> Or upgrade to Lucene >=3D 2.1 with lockless commits.
>
> Mike
>
> On Wed, Apr 8, 2009 at 4:47 PM, Zhang, Lisheng
> <Lisheng.Zhang@broadvision.com> wrote:
>> Hi,
>>
>> Client said they did not index, all they do is searching (create
>> Searcher objects), I looked at 1.4.3 and think this issue can
>> happen in:
>>
>> private static IndexReader open(final Directory directory, final boolean=
 closeDirectory)
>> =A0syncronized(directory) {...}
>>
>> if calls are coming from different Java processes (in our case
>> a few AppServer clusters)?
>>
>> Thanks very much for helps, Lisheng
>>
>> -----Original Message-----
>> From: Michael McCandless [mailto:lucene@mikemccandless.com]
>> Sent: Wednesday, April 08, 2009 1:00 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: Lucene 1.4.3: Error when creating Searcher
>>
>>
>> Likely your exception happened because a reader was trying to open
>> just as a writer was committing, twice in a row.
>>
>> Do you commit (flush or close) frequently from your writer?
>>
>> As of 2.1, Lucene no longer uses a commit locks -- commits are now
>> lockless, so you won't hit this on upgrading to 2.4.
>>
>> Mike
>>
>> On Wed, Apr 8, 2009 at 3:40 PM, Zhang, Lisheng
>> <Lisheng.Zhang@broadvision.com> wrote:
>>> Hi,
>>>
>>> Sorry that my initial message is not clear, I read lucene source code (=
both 1.4.3
>>> and 2.4.0), and understood more.
>>>
>>> The problem is that when using lucene 1.4.3 sometimes when searching, w=
e got
>>> the error:
>>>
>>> Lock obtain timed out: Lock@/tmp/lucene-ba94511756a2670adeac03a50532c63=
c-commit.lock
>>>
>>> It seems that in 2.4.0 we will never have this issue because this error=
 can only
>>> happen when concurrent writing.
>>>
>>> Is this true?
>>>
>>> Thanks very much for helps, Lisheng
>>>
>>>
>>>> =A0-----Original Message-----
>>>> From: =A0 =A0 =A0 =A0 Zhang, Lisheng
>>>> Sent: Wednesday, April 08, 2009 9:08 AM
>>>> To: =A0 'java-user@lucene.apache.org'
>>>> Subject: =A0 =A0 =A0Lucene 1.4.3: Error when creating Searcher
>>>>
>>>> Hi,
>>>>
>>>> We are using lucene 1.4.3, sometimes when two threads try to search,
>>>> one thread got error when creating MultiSearcher:
>>>>
>>>> Lock obtain timed out: Lock@/tmp/lucene-ba94511756a2670adeac03a50532c6=
3c-commit.lock
>>>>
>>>> I read lucene FAQ and searched previous discussions, it seems that thi=
s
>>>> error should be related to indexing, but we are only creating Searcher=
?
>>>>
>>>> Thanks very much for helps, Lisheng
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39582-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 21:55:57 2009
Return-Path: <java-user-return-39582-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85456 invoked from network); 8 Apr 2009 21:55:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 21:55:56 -0000
Received: (qmail 7534 invoked by uid 500); 8 Apr 2009 21:55:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7480 invoked by uid 500); 8 Apr 2009 21:55:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7470 invoked by uid 99); 8 Apr 2009 21:55:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 21:55:54 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 21:55:45 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lrfjv-0007dK-TJ
	for java-user@lucene.apache.org; Wed, 08 Apr 2009 14:55:23 -0700
Message-ID: <22960441.post@talk.nabble.com>
Date: Wed, 8 Apr 2009 14:55:23 -0700 (PDT)
From: John Seer <pulsphoto@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene help with query
In-Reply-To: <22959498.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: pulsphoto@yahoo.com
References: <22959498.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Any  ideas?



John Seer wrote:
> 
> Hello,
> 
> I have 5 lucene documents 
> 
> name: Apple
> name: Apple martini
> name: Apple drink
> name: Apple sweet drink
> 
> I am using lucene default similarity and standard analyzer .
> 
> When I am searching for apple I am getting all 4 documents with the same
> score back. If I use hits the score is 1.0 if I use hit collator is some
> number
> 
> Can someone explain why? 
> 
> 
> I am generating my query using query parser
> The field is ANALYZED 
> 
> 
> Thanks
> 
> 

-- 
View this message in context: http://www.nabble.com/Lucene-help-with-query-tp22959498p22960441.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39583-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 22:34:52 2009
Return-Path: <java-user-return-39583-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97877 invoked from network); 8 Apr 2009 22:34:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 22:34:52 -0000
Received: (qmail 83002 invoked by uid 500); 8 Apr 2009 22:34:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82962 invoked by uid 500); 8 Apr 2009 22:34:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82952 invoked by uid 99); 8 Apr 2009 22:34:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 22:34:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of karl.wettin@gmail.com designates 209.85.218.166 as permitted sender)
Received: from [209.85.218.166] (HELO mail-bw0-f166.google.com) (209.85.218.166)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 22:34:39 +0000
Received: by bwz10 with SMTP id 10so399082bwz.5
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 15:34:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=aCGjYffhYbiyg3uLHKFPYpJA3Tk3Fomm1V4id4nd/uc=;
        b=bwG1EUjIO8QcczLW2mZwdni71kKLLKAhY5aYHZgrUa/iKo/QDiOZKNwJtOq3xEKIKR
         vWXzLJotuYdnhU6ZDfsedpFOkPgzWJo6zDx+PZgeAEuJncX/C/IJxLMZGFoL23dvw5Hc
         PNDplEpTlh2szbPTAqs1TZ9ovqepTb/gdd1lo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=nmMN7HtaZp8sQixf6s/QN7DAkcDJFh0eNvUndQ72rsdnoTqWCEakBRMM6aAPR3HsUR
         D2raAQbX/d3wTCFUjSLtZ9e/i9KBjDlSEvfdV8Q1xvsC+WpAiDQf4cI6hvn6hdR9pB2O
         Uywqtffy5G+8BhKlpBW7fKOatgIynW5w48m6o=
Received: by 10.103.49.12 with SMTP id b12mr874095muk.81.1239230059436;
        Wed, 08 Apr 2009 15:34:19 -0700 (PDT)
Received: from ?192.168.1.201? (c-c98770d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.135.201])
        by mx.google.com with ESMTPS id y6sm16594908mug.27.2009.04.08.15.34.18
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 08 Apr 2009 15:34:18 -0700 (PDT)
Message-Id: <5CED0A21-A0D8-42F6-9CF8-0CAC1335C83D@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <s9dcab94.070@mail.btsb.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Suggestive Search
Date: Thu, 9 Apr 2009 00:34:17 +0200
References: <s9dcab94.070@mail.btsb.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

If you use prefix grams only then you'll get a forward-only suggestion  
scheme. I've seen several implementation that use that and it works  
quite well.

harry potter: ^ha, ^har, ^harr, ^harry, ^harry p, ^harry po..
harry houdini: ^ha, ^har, ^harr, ^harry, ^harry h, ^harry ho..

I prefere the trie-pattern though. Just rememberd there is an old one  
in LUCENE-625.

      karl

8 apr 2009 kl. 20.50 skrev Matt Schraeder:

> Corerct me if I'm wrong, but I don't think n-grams is really what I'm
> looking for here.  I'm not looking for a spellchecker or phrase  
> checker
> style suggestive search, but only based on the exact phrases the  
> user is
> currently typing.  Since Lucene uses term-based searching, I'm not  
> sure
> how to have it search on portions of a full phrase.  Using a standard
> lucene search typing in "harr" will result in searching for "harr"  
> as a
> term, which will not find "Harry Potter".  Using ngrams it would find
> "Harry" as a term, but not at the beginning of an entire phrase.  This
> would bring back "My Dog Harry" as a result, which isn't what I'm
> looking for. I just want phrases from fields beginning with "Harr"
> only.
>
> I could easily do this all with our database server by simply doing a
> query for "where searchqueries like 'harr%'" but we're trying to limit
> our hits to the database to keep speed up on the site.
>
>>>> karl.wettin@gmail.com 4/8/2009 12:49:45 PM >>>
>
> For this you probably want to use ngrams. Wether or not this is
> something that fits in your current index is hard to say. My guess is
>
> that you want to create a new index with one document per unique
> phrase. You might also want to try to load this index in an
> InstantiatedIndex, that could speed things up quite a bit if the
> corpus is not too large.
>
> If your suggestion text corpus is really large and you only want
> forward-only suggestions then you might want to consider a trie-
> pattern solution instead. These can be rather resource efficient, even
>
> when loaded to memory.
>
> If you have a lot of user load on your search eninge then it might be
>
> interesting to use old user queries as the base of your suggestions
> and perhaps boost a bit on trends, i.e. the more people search for
> something the more it get boosted in the suggestions list.
>
>
>      karl
>
> 8 apr 2009 kl. 15.26 skrev Matt Schraeder:
>
>> I want to add a suggestive search similar to google's to
> autocomplete
>> search phrases as the user types.  It doesn't have to be very
>> elaborate
>> and for the most part will just involve searching single fields.
> How
>> can I perform a search  to be able to fill in autocomplete text?
>>
>> For instance, if I start typing "Harr" it should bring up "Harry
>> Potter" "Harry Houdini" and "Harry S. Truman"
>>
>> I have tried doing search queries for "Harr*" but it's still doing
>> term-based searching rather than searching a full field.  To make a
>> field both searchable as the full field as well as tokenized, would
> I
>> have to duplicate the field and make one a keyword field? Is there a
>> more convenient way to do this? I have also considered making a
> second
>> index for suggestive search, which would only have the fields that I
>> want to enable suggestive search on, but this seems like it would be
>> unneccesary duplication of data as well, though it would probably
> make
>> suggestive search faster due to a smaller index.
>>
>> Ideally it would also be nice to be able to rank these terms based
> on
>> the number of times they have been searched for so that the results
>
>> are
>> tailored more to our users rather than simply just the score that
>> Lucene
>> chooses.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39584-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 08 23:01:49 2009
Return-Path: <java-user-return-39584-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8307 invoked from network); 8 Apr 2009 23:01:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Apr 2009 23:01:49 -0000
Received: (qmail 14618 invoked by uid 500); 8 Apr 2009 23:01:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14543 invoked by uid 500); 8 Apr 2009 23:01:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14533 invoked by uid 99); 8 Apr 2009 23:01:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 23:01:46 +0000
X-ASF-Spam-Status: No, hits=-0.6 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [150.148.0.65] (HELO ironport4.fda.gov) (150.148.0.65)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 08 Apr 2009 23:01:39 +0000
X-SBRS: None
X-MID: 129132670
Received: from fmd3tj001.fda.gov ([10.160.10.76])
  by ironport4.fda.gov with ESMTP; 08 Apr 2009 19:01:17 -0400
Received: from FMD3VS012.fda.gov ([10.160.10.63]) by FMD3TJ001.fda.gov with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 8 Apr 2009 19:01:16 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C9B89D.EBEE9532"
Subject: Wordnet indexing error
Date: Wed, 8 Apr 2009 19:01:16 -0400
Message-ID: <F8A04958BB57B64096F9BE6B9572564304C73BB9@FMD3VS012.fda.gov>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Wordnet indexing error
Thread-Index: Acm4newcsx8S1aY8SMy6sxu+t20U0Q==
From: "Sudarsan, Sithu D." <Sithu.Sudarsan@fda.hhs.gov>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 08 Apr 2009 23:01:16.0940 (UTC) FILETIME=[EC3A74C0:01C9B89D]
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C9B89D.EBEE9532
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi All,

We're using Lucene 2.3.2 on Windows. When we try to generate index for
WordNet2.0 using Syns2Index class, while indexing, the following error
is thrown:

Java.lang.NoSuchMethodError:
org.apache.lucene.document.Field.UnIndexed(Ljava/lang/String;Ljava/lang/
String;)Lorg/apache/lucene/document/Field;

Our code is looks like this:

String[] filelocations =3D {"path/to/prolog/file", "path/to/index"};
try{
     Syns2Index.main(filelocations);
} catch ....


The error typically happens at about line number 130000 in the wn_s.pl
file.

No luck with WordNet3.0 as well. We get the same error.

Any fix or solutions?=20

Thanks in advance,
Sithu D Sudarsan

sithu.sudarsan@fda.hhs.gov
sdsudarsan@ualr.edu


------_=_NextPart_001_01C9B89D.EBEE9532--

From java-user-return-39585-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 00:17:39 2009
Return-Path: <java-user-return-39585-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35704 invoked from network); 9 Apr 2009 00:17:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 00:17:39 -0000
Received: (qmail 92232 invoked by uid 500); 9 Apr 2009 00:17:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92149 invoked by uid 500); 9 Apr 2009 00:17:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92139 invoked by uid 99); 9 Apr 2009 00:17:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 00:17:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of koji@r.email.ne.jp designates 202.224.39.198 as permitted sender)
Received: from [202.224.39.198] (HELO mail2.asahi-net.or.jp) (202.224.39.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 00:17:29 +0000
Received: from koji-sekiguchi-no-macbook.local (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	by mail2.asahi-net.or.jp (Postfix) with ESMTP id D2E9D71971
	for <java-user@lucene.apache.org>; Thu,  9 Apr 2009 09:17:07 +0900 (JST)
Message-ID: <49DD3E83.6090008@r.email.ne.jp>
Date: Thu, 09 Apr 2009 09:17:07 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.21 (Macintosh/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene help with query
References: <22959498.post@talk.nabble.com>
In-Reply-To: <22959498.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

If you omit norms when indexing the name field, you'll get same score back.

Koji

The Seer wrote:
> Hello,
>
> I have 5 lucene documents 
>
> name: Apple
> name: Apple martini
> name: Apple drink
> name: Apple sweet drink
>
> I am using lucene default similarity and standard analyzer .
>
> When I am searching for apple I am getting all 4 documents with the same
> score back. If I use hits the score is 1.0 if I use hit collator is some
> number
>
> Can someone explain why? 
>
>
> I am generating my query using query parser
> The field is ANALYZED 
>
>
> Thanks
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39586-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 00:27:41 2009
Return-Path: <java-user-return-39586-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44293 invoked from network); 9 Apr 2009 00:27:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 00:27:41 -0000
Received: (qmail 7737 invoked by uid 500); 9 Apr 2009 00:27:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7676 invoked by uid 500); 9 Apr 2009 00:27:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7666 invoked by uid 99); 9 Apr 2009 00:27:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 00:27:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of koji@r.email.ne.jp designates 202.224.39.198 as permitted sender)
Received: from [202.224.39.198] (HELO mail2.asahi-net.or.jp) (202.224.39.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 00:27:30 +0000
Received: from koji-sekiguchi-no-macbook.local (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	by mail2.asahi-net.or.jp (Postfix) with ESMTP id 731DF6D0BD
	for <java-user@lucene.apache.org>; Thu,  9 Apr 2009 09:27:09 +0900 (JST)
Message-ID: <49DD40DD.9010203@r.email.ne.jp>
Date: Thu, 09 Apr 2009 09:27:09 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.21 (Macintosh/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: How Can I make an analyzer that ignore the numbers o the texts
 ???
References: <bf1404350904081043n30b82a66t7fc83b41e396060@mail.gmail.com> <2D127F11DC79714E9B6A43AC9458147F13FCA373@suex07-mbx-03.ad.syr.edu>
In-Reply-To: <2D127F11DC79714E9B6A43AC9458147F13FCA373@suex07-mbx-03.ad.syr.edu>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Steven A Rowe wrote:
> Hi Ariel,
>
> As Koji mentioned, https://issues.apache.org/jira/browse/SOLR-448 contains a NumberFilter.  It filters out tokens that successfully parse as Doubles.  I'm not sure, since the examples you gave seem to use "," as the decimal character, how this interacts with the Locale.  (Koji, I don't see any ","-as-decimal tests in your patch.)
>
>   
Right. It should be. Thanks!

Koji


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39587-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 01:07:18 2009
Return-Path: <java-user-return-39587-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51693 invoked from network); 9 Apr 2009 01:07:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 01:07:17 -0000
Received: (qmail 25748 invoked by uid 500); 9 Apr 2009 01:07:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25660 invoked by uid 500); 9 Apr 2009 01:07:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25650 invoked by uid 99); 9 Apr 2009 01:07:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 01:07:15 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ww.wang.cs@gmail.com designates 74.125.46.29 as permitted sender)
Received: from [74.125.46.29] (HELO yw-out-2324.google.com) (74.125.46.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 01:07:05 +0000
Received: by yw-out-2324.google.com with SMTP id 9so235598ywe.5
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 18:06:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=KbZ/HdwQvm4lEm//PEREXLOK9jfugq6hzglkvG2oZ5o=;
        b=ZZBJYDAp81GDJjETwd7hBKft9e7Gi7Ad6b7TuwbUECSCGXi67YQw7sb62MCTXRHQj4
         jEfV1p15N3NG8E3bzo2RaEBZhDNCGMg4fMVM2vcTzD0cM/oP1h1aamVldRrBUWN/4re3
         rNjCg/7mADpdSNYyopp3M/phwbtE+U/SImwtU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=q9M7pKqUGPJzz6FpZsZS9nMylRFlnZKoQ5gYVc9FO+tEGLQL6BJPxpMEKQ2Np5IU96
         OJzzIxPr+T/EUiOIhJpHblT9uEChD0p7zozfOVBeT4cEMxGoSJkKOiix/8i2ue7youAp
         8PnSTGqIAfm9Ozgb9NPMEHJNhzRyPEaXC57vA=
MIME-Version: 1.0
Received: by 10.90.98.13 with SMTP id v13mr2313629agb.30.1239239204062; Wed, 
	08 Apr 2009 18:06:44 -0700 (PDT)
In-Reply-To: <141AD2A60FEA4EBDA3F942B4FD7AAAD6@VEGA>
References: <bf1404350904080745s43b59486n6054963f839326c@mail.gmail.com>
	 <141AD2A60FEA4EBDA3F942B4FD7AAAD6@VEGA>
Date: Thu, 9 Apr 2009 09:06:44 +0800
Message-ID: <7d94dcde0904081806l6da378ddif1c8f8f24fc46c65@mail.gmail.com>
Subject: Re: How can I change that lucene use by default the AND operator 
	between terms ???
From: =?GB2312?B?zfXOoc6h?= <ww.wang.cs@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364ed6508cc757046714dcfc
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364ed6508cc757046714dcfc
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: quoted-printable

call method of QueryParser
setDefaultOperator

2009/4/8 Uwe Schindler <uwe@thetaphi.de>

> The query parser has a option to change that. After creating the query
> parser, just set the corresponding option before parsing the query.
>
> Uwe
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
> > -----Original Message-----
> > From: Ariel [mailto:isaacrc82@gmail.com]
> > Sent: Wednesday, April 08, 2009 4:46 PM
> > To: lucene user
> > Subject: How can I change that lucene use by default the AND operator
> > between terms ???
> >
> > When I do a search using lucene internally lucene use by default the OR
> > operator between terms, How can I change that lucene use by default the
> > AND
> > operator between terms ???
> >
> > Regards
> > Ariel
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


--=20
=CD=F5=CE=A1=CE=A1(Weiwei Wang)
Department of Computer Science
Gulou Campus of Nanjing University
Nanjing, P.R.China, 210093

Mobile: 86-13913310569
MSN: ww.wang.cs@gmail.com
Homepage: http://cs.nju.edu.cn/rl/weiweiwang

--0016364ed6508cc757046714dcfc--

From java-user-return-39588-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 01:10:30 2009
Return-Path: <java-user-return-39588-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52272 invoked from network); 9 Apr 2009 01:10:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 01:10:30 -0000
Received: (qmail 27860 invoked by uid 500); 9 Apr 2009 01:10:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27785 invoked by uid 500); 9 Apr 2009 01:10:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27775 invoked by uid 99); 9 Apr 2009 01:10:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 01:10:28 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ww.wang.cs@gmail.com designates 74.125.44.30 as permitted sender)
Received: from [74.125.44.30] (HELO yx-out-2324.google.com) (74.125.44.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 01:10:17 +0000
Received: by yx-out-2324.google.com with SMTP id 8so236428yxb.5
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 18:09:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=opXJIXOqgZECmZ7SPiBAjHbt1U5AUBmvkUSnq6QA5c8=;
        b=x8bEJddGr9pLdI5gsazPxYnilOdYl+zV7yDZiWcv12WPNyOohXUXKuvQUEAorvCHRN
         hDbkqIX9Aas3tymRd+GlNLwJa9DlX1dV6o1HKJwKDc9+vF/5//XTP0PMt6Ja71grf+2V
         kJV1RhjFJmYyfXJPQNnytHCC17WEjZykITDcQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=uY8Rq4sSuATEguKJUriWOX7HpWwTtgzfTRTCrFajWdOjhyIvznMhA6F572+Ivm/KRh
         OjhadMJO3es9bW9jPo9Zd5b24AZkHeaxvfPV/PqYbHU75OZSo966CViMyYykNrKao+rt
         uVy/I1YX5ihq9dCmexp8lv60k6kX5GvKJe+kc=
MIME-Version: 1.0
Received: by 10.90.49.3 with SMTP id w3mr2318961agw.44.1239239396460; Wed, 08 
	Apr 2009 18:09:56 -0700 (PDT)
In-Reply-To: <499888440904080903y47f8d828j92dd419cde53ce99@mail.gmail.com>
References: <22953431.post@talk.nabble.com>
	 <499888440904080903y47f8d828j92dd419cde53ce99@mail.gmail.com>
Date: Thu, 9 Apr 2009 09:09:56 +0800
Message-ID: <7d94dcde0904081809n9b0c790q4ca66c116b2431ff@mail.gmail.com>
Subject: Re: Query any data
From: =?GB2312?B?zfXOoc6h?= <ww.wang.cs@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163630f62b048966046714e83a
X-Virus-Checked: Checked by ClamAV on apache.org

--00163630f62b048966046714e83a
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: quoted-printable

first you should change your querypaser to accept wildcard query by calling
method of QueryParser
          setAllowLeadingWildcard
then you can query like this:  fieldname:*

2009/4/9 Tim Williams <williamstw@gmail.com>

> On Wed, Apr 8, 2009 at 11:45 AM, addman <addiekong@yahoo.com> wrote:
> >
> > Hi,
> >   Is it possible to create a query to search a field for any value?  I
> just
> > need to know if the optional field contain any data at all.
>
> google for:  lucene field existence
>
> There's no way built in, one strategy[1] is to have a 'meta field'
> that contains the names of the fields the document contains.
>
> --tim
>
> [1] -
> http://www.mail-archive.com/lucene-user@jakarta.apache.org/msg07703.html
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


--=20
=CD=F5=CE=A1=CE=A1(Weiwei Wang)
Department of Computer Science
Gulou Campus of Nanjing University
Nanjing, P.R.China, 210093

Mobile: 86-13913310569
MSN: ww.wang.cs@gmail.com
Homepage: http://cs.nju.edu.cn/rl/weiweiwang

--00163630f62b048966046714e83a--

From java-user-return-39589-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 02:40:07 2009
Return-Path: <java-user-return-39589-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90719 invoked from network); 9 Apr 2009 02:40:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 02:40:07 -0000
Received: (qmail 89573 invoked by uid 500); 9 Apr 2009 02:40:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89491 invoked by uid 500); 9 Apr 2009 02:40:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89481 invoked by uid 99); 9 Apr 2009 02:40:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 02:40:04 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ww.wang.cs@gmail.com designates 209.85.217.164 as permitted sender)
Received: from [209.85.217.164] (HELO mail-gx0-f164.google.com) (209.85.217.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 02:39:54 +0000
Received: by gxk8 with SMTP id 8so975420gxk.5
        for <java-user@lucene.apache.org>; Wed, 08 Apr 2009 19:39:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=BT+uSnHbv3RP+IeNr1xVg3UtnsQ2xs/nyttVj6cmkJE=;
        b=g31gUsn+vJhGNhisNsbtMeuB4PvMcU7V4QQHAqWi1siL/Z3YNMf2ydmurxLkkT8XQq
         eq24d0d/kH2Jj0E/OJsCC2C00+AIkgPYXhOc8dhBhHzkEVux0D26Z5eqA/8xOfRvra3C
         NBhIhk75EvmcK2E5eNCvOASPLo3wKdXkTpS9Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=cSDW4kAZwcXUk3gzbftBf6mCLfC9Kw3qmpcYDfeKfIjqnLm4neLWShY26VPuG/dG74
         WRwDoNuKpwS3xdDa3GhhxIZYbizIlgpnobbtb4YWGOD5FIn2ijQ5fM3IRVPfLZdw5c0Z
         2v3lD17nx0ivgW7IbJ1x4dioZEOJ8rwZu0Bqo=
MIME-Version: 1.0
Received: by 10.90.71.16 with SMTP id t16mr2370260aga.103.1239244773479; Wed, 
	08 Apr 2009 19:39:33 -0700 (PDT)
In-Reply-To: <5CED0A21-A0D8-42F6-9CF8-0CAC1335C83D@gmail.com>
References: <s9dcab94.070@mail.btsb.com>
	 <5CED0A21-A0D8-42F6-9CF8-0CAC1335C83D@gmail.com>
Date: Thu, 9 Apr 2009 10:39:33 +0800
Message-ID: <7d94dcde0904081939m13be52aaofa9c40b6ec033be9@mail.gmail.com>
Subject: Re: Suggestive Search
From: =?GB2312?B?zfXOoc6h?= <ww.wang.cs@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163630f33d835bad04671628ba
X-Virus-Checked: Checked by ClamAV on apache.org

--00163630f33d835bad04671628ba
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: quoted-printable

I test the lucene spellchecker and it doesn't support chinese spell checker=
,
how can i achieve this goal as google does?

2009/4/9 Karl Wettin <karl.wettin@gmail.com>

> If you use prefix grams only then you'll get a forward-only suggestion
> scheme. I've seen several implementation that use that and it works quite
> well.
>
> harry potter: ^ha, ^har, ^harr, ^harry, ^harry p, ^harry po..
> harry houdini: ^ha, ^har, ^harr, ^harry, ^harry h, ^harry ho..
>
> I prefere the trie-pattern though. Just rememberd there is an old one in
> LUCENE-625.
>
>     karl
>
> 8 apr 2009 kl. 20.50 skrev Matt Schraeder:
>
>
>  Corerct me if I'm wrong, but I don't think n-grams is really what I'm
>> looking for here.  I'm not looking for a spellchecker or phrase checker
>> style suggestive search, but only based on the exact phrases the user is
>> currently typing.  Since Lucene uses term-based searching, I'm not sure
>> how to have it search on portions of a full phrase.  Using a standard
>> lucene search typing in "harr" will result in searching for "harr" as a
>> term, which will not find "Harry Potter".  Using ngrams it would find
>> "Harry" as a term, but not at the beginning of an entire phrase.  This
>> would bring back "My Dog Harry" as a result, which isn't what I'm
>> looking for. I just want phrases from fields beginning with "Harr"
>> only.
>>
>> I could easily do this all with our database server by simply doing a
>> query for "where searchqueries like 'harr%'" but we're trying to limit
>> our hits to the database to keep speed up on the site.
>>
>>  karl.wettin@gmail.com 4/8/2009 12:49:45 PM >>>
>>>>>
>>>>
>> For this you probably want to use ngrams. Wether or not this is
>> something that fits in your current index is hard to say. My guess is
>>
>> that you want to create a new index with one document per unique
>> phrase. You might also want to try to load this index in an
>> InstantiatedIndex, that could speed things up quite a bit if the
>> corpus is not too large.
>>
>> If your suggestion text corpus is really large and you only want
>> forward-only suggestions then you might want to consider a trie-
>> pattern solution instead. These can be rather resource efficient, even
>>
>> when loaded to memory.
>>
>> If you have a lot of user load on your search eninge then it might be
>>
>> interesting to use old user queries as the base of your suggestions
>> and perhaps boost a bit on trends, i.e. the more people search for
>> something the more it get boosted in the suggestions list.
>>
>>
>>     karl
>>
>> 8 apr 2009 kl. 15.26 skrev Matt Schraeder:
>>
>>  I want to add a suggestive search similar to google's to
>>>
>> autocomplete
>>
>>> search phrases as the user types.  It doesn't have to be very
>>> elaborate
>>> and for the most part will just involve searching single fields.
>>>
>> How
>>
>>> can I perform a search  to be able to fill in autocomplete text?
>>>
>>> For instance, if I start typing "Harr" it should bring up "Harry
>>> Potter" "Harry Houdini" and "Harry S. Truman"
>>>
>>> I have tried doing search queries for "Harr*" but it's still doing
>>> term-based searching rather than searching a full field.  To make a
>>> field both searchable as the full field as well as tokenized, would
>>>
>> I
>>
>>> have to duplicate the field and make one a keyword field? Is there a
>>> more convenient way to do this? I have also considered making a
>>>
>> second
>>
>>> index for suggestive search, which would only have the fields that I
>>> want to enable suggestive search on, but this seems like it would be
>>> unneccesary duplication of data as well, though it would probably
>>>
>> make
>>
>>> suggestive search faster due to a smaller index.
>>>
>>> Ideally it would also be nice to be able to rank these terms based
>>>
>> on
>>
>>> the number of times they have been searched for so that the results
>>>
>>
>>  are
>>> tailored more to our users rather than simply just the score that
>>> Lucene
>>> chooses.
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


--=20
=CD=F5=CE=A1=CE=A1(Weiwei Wang)
Department of Computer Science
Gulou Campus of Nanjing University
Nanjing, P.R.China, 210093

Mobile: 86-13913310569
MSN: ww.wang.cs@gmail.com
Homepage: http://cs.nju.edu.cn/rl/weiweiwang

--00163630f33d835bad04671628ba--

From java-user-return-39590-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 05:06:17 2009
Return-Path: <java-user-return-39590-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14735 invoked from network); 9 Apr 2009 05:06:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 05:06:17 -0000
Received: (qmail 83311 invoked by uid 500); 9 Apr 2009 05:06:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83228 invoked by uid 500); 9 Apr 2009 05:06:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83218 invoked by uid 99); 9 Apr 2009 05:06:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 05:06:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.243] (HELO web50310.mail.re2.yahoo.com) (206.190.38.243)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 09 Apr 2009 05:06:05 +0000
Received: (qmail 74163 invoked by uid 60001); 9 Apr 2009 05:05:44 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1239253544; bh=IEYBcq+g0SiGxowRl81T+UbccxHgqzpE7Ui6wscr7Es=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=H0dMvkd30L0AxkqnvWAnb4AuESnzFsJGBp5qBM/h1Aq9rPChIvkg9apk07IprUJM2d/uD/cQtUH8P8LAVn9X8fbzIiylSiATwI4rzVRW+WFN7Ui9FeSjW4d9vaE5/YDSjHnoD4pl4gm4BppM1EMs1IDqxIeua736GcNN4oU9xxw=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=1UBN1zQaPMk8ZKJjU/eB00GRJZpQnUXjQO4CoZvSdwfsWtJ3dqDR5zkGBCOEhHw97Ep1FKBnk6Y/HM3zA2nIN9zLYB2AP75jzjAMYfefTeYpqxD2UDRL/Go/rjNJuyFeofcRJEAdRx/5e9i8hI7s96xykjP1m+mG2O1wT11C7r4=;
Message-ID: <273311.72887.qm@web50310.mail.re2.yahoo.com>
X-YMail-OSG: a08_4fQVM1lFwT57GpKrshCAvR32gvKDaO17zCZVGEJVWHzf_UQejfjZR1uiSNVjqZIrV4uy2ZNhWdRV3_S8mNzDfpVo.1Cu5yqqox_8g39aY2fVotzkOMEBsLTE_GETynbN6iRje9NBbmCzMqGYSKgpWlLOh9RjQLie5PjjJdgXaYboYIdRzAKQ7yEG6w7jdJ.tEzSrZp7EC.wGed5gQa0Dq1d5ZJbCJDw8U5TX3K.P4w9lH96QaCxthi0Rdz4OtH0Ch.Jic_a9K4QtHzPMNfeNYTJHUHNsSr8_yV7dEEJdW.MzQW9M5fFmYmiDJdhFdG32wqMpyorcG9Gr1A2d
Received: from [74.73.31.128] by web50310.mail.re2.yahoo.com via HTTP; Wed, 08 Apr 2009 22:05:44 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <F8A04958BB57B64096F9BE6B9572564304C73BB9@FMD3VS012.fda.gov>
Date: Wed, 8 Apr 2009 22:05:44 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Wordnet indexing error
To: java-user@lucene.apache.org
In-Reply-To: <F8A04958BB57B64096F9BE6B9572564304C73BB9@FMD3VS012.fda.gov>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

The simplest thing to do is to grab the latest Lucene and the latest jar for that Wordnet (syns2index) code.  That should work for you (that UnIndexed method is an old method that doesn't exist any more).


Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch



----- Original Message ----
> From: "Sudarsan, Sithu D." <Sithu.Sudarsan@fda.hhs.gov>
> To: java-user@lucene.apache.org
> Sent: Wednesday, April 8, 2009 7:01:16 PM
> Subject: Wordnet indexing error
> 
> Hi All,
> 
> We're using Lucene 2.3.2 on Windows. When we try to generate index for
> WordNet2.0 using Syns2Index class, while indexing, the following error
> is thrown:
> 
> Java.lang.NoSuchMethodError:
> org.apache.lucene.document.Field.UnIndexed(Ljava/lang/String;Ljava/lang/
> String;)Lorg/apache/lucene/document/Field;
> 
> Our code is looks like this:
> 
> String[] filelocations = {"path/to/prolog/file", "path/to/index"};
> try{
>      Syns2Index.main(filelocations);
> } catch ....
> 
> 
> The error typically happens at about line number 130000 in the wn_s.pl
> file.
> 
> No luck with WordNet3.0 as well. We get the same error.
> 
> Any fix or solutions? 
> 
> Thanks in advance,
> Sithu D Sudarsan
> 
> sithu.sudarsan@fda.hhs.gov
> sdsudarsan@ualr.edu


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39591-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 06:24:09 2009
Return-Path: <java-user-return-39591-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72549 invoked from network); 9 Apr 2009 06:24:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 06:24:09 -0000
Received: (qmail 33495 invoked by uid 500); 9 Apr 2009 06:24:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33428 invoked by uid 500); 9 Apr 2009 06:24:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33418 invoked by uid 99); 9 Apr 2009 06:24:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 06:24:06 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [67.195.8.186] (HELO web110210.mail.gq1.yahoo.com) (67.195.8.186)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 09 Apr 2009 06:23:58 +0000
Received: (qmail 86617 invoked by uid 60001); 9 Apr 2009 06:23:37 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1239258217; bh=Rwuty4EC1ctuiASYy/6KcEtBgJDAXhDVe5oPhg+trUg=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=ZvcV5lHCGSb6ILWxhzcoJgWPPHQxNGk0Z5NhnoamIVzTTkHtoXqPFyn7BQZ+hJgsxSIIstd26d5QZntkJoiBDL8bs/UsUZ92deuLh9ChtNQFeRfow0MLLrJcbjrcYvjlGqgHbS0fatgTgl4Tt2lSBMfH19ngi5e7ErGUMI0B5q8=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=3EMbbhI769UcF9iZxJg8zR2xuAvUTD7uTIiWYi3VB0jNSZIi+fw/3kmYZl4eDWe+6cleS1ywbQT4DGOMqCUNKX/zZQ39iQsJIfgr/CKOPPE0R1Bmv9291fYyi0b6r08/3veBe5cczgOV9G8I0HcO5uVb+Edb/xwJS+hzXtwhimc=;
Message-ID: <332506.17389.qm@web110210.mail.gq1.yahoo.com>
X-YMail-OSG: 3qs.F7UVM1kJG32ZkpkHHvgQrAs4PTwVxj.bmz0oMg.LRB5PsHFSF08KJsp7iLdLiF__ORgHcrJgbnCS6ELj3MXodtbWQiQ3CssnKcaspthH9ZUwaVApZ59j3yGpLda_7hI1XI_kD9.hB0KKxCqlynyZyQWFLgdC.OqwwBKQsrbTBVfA0DGFUVPtQOFbbj9b8yLsdcyFZhaneG._67KAjzkxUNTQREBBSu07jzT_dYEH.dB7O8AnVpSj70V.fxIEu.mkXjB1QMwkz_6foda5Mb6IcpAQlomXRpRvfpKlnF.FMP0tCZqYkAOZLgBZs8.jOPJ9E87gu1YFSgxBNU7Q
Received: from [78.135.23.204] by web110210.mail.gq1.yahoo.com via HTTP; Wed, 08 Apr 2009 23:23:36 PDT
X-Mailer: YahooMailClassic/5.2.15 YahooMailWebService/0.7.289.1
Date: Wed, 8 Apr 2009 23:23:36 -0700 (PDT)
From: Andy <andykan1984@yahoo.com>
Subject: Re: Lucene searching across documents
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-749719047-1239258216=:17389"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-749719047-1239258216=:17389
Content-Type: text/plain; charset=us-ascii

Hello all,



I'm trying to implement a vector space model using lucene. I need to
have a file (or on memory) with TF/IDF weight of each term in each
document. (in fact that is a matrix with documents presented as
vectors, in which the elements of each vector is the TF weight ...) 



Please Please help me on this

contac me if you need any further info via andykan1984@yahoo.com

Many Many thanks


      
--0-749719047-1239258216=:17389--

From java-user-return-39592-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 06:33:45 2009
Return-Path: <java-user-return-39592-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77553 invoked from network); 9 Apr 2009 06:33:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 06:33:45 -0000
Received: (qmail 47647 invoked by uid 500); 9 Apr 2009 06:33:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47580 invoked by uid 500); 9 Apr 2009 06:33:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47570 invoked by uid 99); 9 Apr 2009 06:33:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 06:33:43 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [67.195.8.181] (HELO web110205.mail.gq1.yahoo.com) (67.195.8.181)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 09 Apr 2009 06:33:33 +0000
Received: (qmail 14301 invoked by uid 60001); 9 Apr 2009 06:33:12 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1239258792; bh=ZC84cNG8IxiMfzHGZCyoe6lF8Zb/3Hpz30MRFQzYaIg=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=BQliD9LtKFOE3SGvgUiHPJ7eCXOQuZeukdv+E5U9LGGDZugN1nF22yJoss73RewiWN7z2cHZOa5KQSaHcP4OQQT2WOi5Sd+Z5AFhYiJ10w2RtZGYycfDcgBRhuIRNu4Kg6SwJstGCqaMOj4SXPAQScexj4f1sAGMWtpwe38V4fA=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=PYAU7rySPwheK+jgVAQhH/BYCUc08vCtpWo2nYTte7xFXh0xlMqjcvKmC/1ulJIDlfeKV2CVfBTekGUbHZC6dTromWZTQVnuUomImyMTBNrb+LaV/FusVgub8xlWbwrOiyceU+Z6jVCkFzaIXiNA/GY2R3FNm5/fDbGvhRBVp/Y=;
Message-ID: <982656.13244.qm@web110205.mail.gq1.yahoo.com>
X-YMail-OSG: 0vXOJ6QVM1n44Sgmh_qZPOeGSTcrNrWfXXZY_qACZk7A64ANGCokM.czL5fjjoyWvPrzvAtZjzlpiWGqB9r2Y9D.F9ClDLqTIy3EvAZeMFtdloyUYf_9zOdUCD3f3IIsGwBgiSQoRjfXhp5dDUHkcXqj9DswfzPjISAyCXNmrqCukw6HAk.OQSYrXJKhi3Lr68Q0eKXVkgc3XEKorx3VIT2cNbbvijmc5j2m8NWL_ziyeBvhUL.x.rVkpLJsJuMDeQPgF67mCjnvkXN01OeazFNBAWu5TMmEhR5JIAhyo9Hua7SZw5wzskuct_3vySS7XWaMEkmxl0va1WS9o7fT
Received: from [78.135.23.204] by web110205.mail.gq1.yahoo.com via HTTP; Wed, 08 Apr 2009 23:33:11 PDT
X-Mailer: YahooMailClassic/5.2.15 YahooMailWebService/0.7.289.1
Date: Wed, 8 Apr 2009 23:33:11 -0700 (PDT)
From: Andy <andykan1984@yahoo.com>
Subject: Vector space implemantion
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-967706487-1239258791=:13244"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-967706487-1239258791=:13244
Content-Type: text/plain; charset=us-ascii

Hello all,

I'm trying to implement a vector space model using lucene. I need to have a file (or on memory) with TF/IDF weight of each term in each document. (in fact that is a matrix with documents presented as vectors, in which the elements of each vector is the TF weight ...)

Please Please help me on this
contact me if you need any further info via andykan1984@yahoo.com
Many Many thanks




      
--0-967706487-1239258791=:13244--

From java-user-return-39593-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 07:15:46 2009
Return-Path: <java-user-return-39593-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94485 invoked from network); 9 Apr 2009 07:15:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 07:15:46 -0000
Received: (qmail 95484 invoked by uid 500); 9 Apr 2009 07:15:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95392 invoked by uid 500); 9 Apr 2009 07:15:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95382 invoked by uid 99); 9 Apr 2009 07:15:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 07:15:43 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ww.wang.cs@gmail.com designates 74.125.46.29 as permitted sender)
Received: from [74.125.46.29] (HELO yw-out-2324.google.com) (74.125.46.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 07:15:35 +0000
Received: by yw-out-2324.google.com with SMTP id 9so290877ywe.5
        for <java-user@lucene.apache.org>; Thu, 09 Apr 2009 00:15:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=2aH/KKhsw4WaDf6Mz9eA5PJANX8DKBTEk4heIyvIP/4=;
        b=ppPrz28GstyGFcDkH7vncl/1yY036qYw6tJStlJJ2Nh7h2duFfs6tjii8X6hZVdmkU
         aJnWkPTg97qyygNaMijOdce2pHhWtCJZBYJ5Gy1Ggin5IkX3SOffHfN+I226oKseGVWZ
         XAWbm315qBiGQWFOkY9sWl0m596PWl+KPniXE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=G2KFPOkvU/hFQWTzl67x03AYsHXDW9LdhFvS02Vye7D4EMRCu5AIo3kM5FUJGw9JY/
         YfEexFhMsWDtVzrCQz4dV0BY+f9t8V+OP8+3u43E8L+idLpmQ16M7ZrooUCt/Ua/0m7y
         uAbb/O5CIv0vFhqGi5C3lpfu91IrdA6QOGaAE=
MIME-Version: 1.0
Received: by 10.90.69.7 with SMTP id r7mr2682333aga.47.1239261314555; Thu, 09 
	Apr 2009 00:15:14 -0700 (PDT)
Date: Thu, 9 Apr 2009 15:15:14 +0800
Message-ID: <7d94dcde0904090015q5bd8a0e4j2ed88090580fae8e@mail.gmail.com>
Subject: query c++
From: =?GB2312?B?zfXOoc6h?= <ww.wang.cs@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016363b922270215e04671a0267
X-Virus-Checked: Checked by ClamAV on apache.org

--0016363b922270215e04671a0267
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: quoted-printable

I want to make my lucene can search word like c++, c#,  how can i modify my
analyzer to achieve this goal?

--=20
=CD=F5=CE=A1=CE=A1(Weiwei Wang)
Department of Computer Science
Gulou Campus of Nanjing University
Nanjing, P.R.China, 210093

Mobile: 86-13913310569
MSN: ww.wang.cs@gmail.com
Homepage: http://cs.nju.edu.cn/rl/weiweiwang

--0016363b922270215e04671a0267--

From java-user-return-39594-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 07:57:58 2009
Return-Path: <java-user-return-39594-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9674 invoked from network); 9 Apr 2009 07:57:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 07:57:58 -0000
Received: (qmail 38706 invoked by uid 500); 9 Apr 2009 07:57:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38637 invoked by uid 500); 9 Apr 2009 07:57:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38627 invoked by uid 99); 9 Apr 2009 07:57:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 07:57:56 +0000
X-ASF-Spam-Status: No, hits=2.8 required=10.0
	tests=MIME_BASE64_BLANKS,MIME_BASE64_TEXT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of hongyinjie@163.com designates 220.181.12.11 as permitted sender)
Received: from [220.181.12.11] (HELO m12-11.163.com) (220.181.12.11)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 09 Apr 2009 07:57:47 +0000
Received: from zju-hanbo (unknown [60.191.86.3])
	by smtp7 (Coremail) with SMTP id C8CowLC7nRJeqt1JGHn8QQ--.20759S2;
	Thu, 09 Apr 2009 15:57:21 +0800 (CST)
Date: Thu, 9 Apr 2009 15:57:22 +0800
From: "hyj" <hongyinjie@163.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Subject: Re: query c++
X-mailer: Foxmail 5.0 [cn]
Mime-Version: 1.0
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: base64
X-CM-TRANSID: C8CowLC7nRJeqt1JGHn8QQ--.20759S2
X-Coremail-Antispam: 1Uf129KBjDUn29KB7ZKAUJUUUUUYxn0WfASr-VFAUDa7-sFnT
	9fnUUIcSsGvfJTRUUUb-AYjxAI64sEg-sGvwAYjxAI6xAIw28IcVW8ZrWlb7IF0VCF04k2
	0xvEw2I207IF0wAYjxAI6xCIbckI1I0E57IF64kEYxAxM7k042IEIxkG67AtM7k0a2IF6r
	1UM7kC6x804xWl14x267AKxVWUJVW8JwAFxVCF77xC6IxKo4kEV4yl1I0EscIYIxCEI4kl
	w4CSwwAFIxvE14AKwVWUJVWUGwA2z4x0Y4vE2Ix0cI8IcVAFwI0_tr0E3s1l84ACjcxK6x
	IIjxv20xvEc7CjxVAFwI0_GcCE3s1l84ACjcxK6I8E87Iv67AKxVW0oVCq3wA2z4x0Y4vE
	x4A2jsIEc7CjxVAFwI0_GcCE3s1ln4vEF7Iv6F18KVAqrcv_GVWUtr1rJF1lnx0Ec2IEnI
	CE548m6r1DJrWUZwAqjxCE34x0Y48IcwAqx4xG64xvF2IEw4CE5I8CrVC2j2WlYx0E2Ix0
	cI8IcVAFwI0_JrI_JrylYx0Ex4A2jsIE14v26r4j6F4UM4x0Y48IcxkI7VAKI48JM4xvF2
	IEb7IF0Fy264kE64k0F24lFcxC0VAYjxAxZF0Ex2IqxwAC62BYpTIE1TZKA3svLVAKvSnI
	qfZI6r4lw4CEF2IF47xS0VAv8wCjxxvEw4Wlc2xSY4AK67AK6r4xMxkI7II2jI8vz4v_Cr
	0_Zr1l42xK82IYc2Ij64vIr41l4x8a6c8ajcxJMI8E67x28xkI4xCE0xIEc2x0rwC2zVAF
	1VAY17CE14v26r1j6r15MIIYrxkI7VAKI48JMs8CjcxG0xvEn4CqF7xvrwCE64xvF2IEb7
	IF0Fy7YxBIdaVFxhVjvjDU0xZFpf9x07UrhL8UUUUU=
Message-Id: <49DDAA63.1ED775.19848@m12-11.163.com>
X-CM-SenderInfo: 5krqw55lqmxvi6rwjhhfrp/
X-Virus-Checked: Checked by ClamAV on apache.org

zfXOoc6hLMT6usOjoQ0KDQoJV2hpdGVzcGFjZUFuYWx5emVyIGNhbiB3b3JrLg0KDQo9PT09PT09
IDIwMDktMDQtMDkgMTU6MTU6MTQgxPrU2sC00MXW0NC0tcCjuj09PT09PT0NCg0KPkkgd2FudCB0
byBtYWtlIG15IGx1Y2VuZSBjYW4gc2VhcmNoIHdvcmQgbGlrZSBjKyssIGMjLCAgaG93IGNhbiBp
IG1vZGlmeSBteQ0KPmFuYWx5emVyIHRvIGFjaGlldmUgdGhpcyBnb2FsPw0KPg0KPi0tIA0KPs31
zqHOoShXZWl3ZWkgV2FuZykNCj5EZXBhcnRtZW50IG9mIENvbXB1dGVyIFNjaWVuY2UNCj5HdWxv
dSBDYW1wdXMgb2YgTmFuamluZyBVbml2ZXJzaXR5DQo+TmFuamluZywgUC5SLkNoaW5hLCAyMTAw
OTMNCj4NCj5Nb2JpbGU6IDg2LTEzOTEzMzEwNTY5DQo+TVNOOiB3dy53YW5nLmNzQGdtYWlsLmNv
bQ0KPkhvbWVwYWdlOiBodHRwOi8vY3Mubmp1LmVkdS5jbi9ybC93ZWl3ZWl3YW5nDQoNCj0gPSA9
ID0gPSA9ID0gPSA9ID0gPSA9ID0gPSA9ID0gPSA9ID0gPQ0KCQkJDQoNCqGhoaGhoaGhoaGhoaGh
oaHWwg0KwPGjoQ0KIA0KCQkJCSANCqGhoaGhoaGhoaGhoaGhoaFoeWoNCqGhoaGhoaGhoaGhoaGh
oaFob25neWluamllQDE2My5jb20NCqGhoaGhoaGhoaGhoaGhoaGhoaGhMjAwOS0wNC0wOQ0KDQo=




From java-user-return-39595-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 08:10:47 2009
Return-Path: <java-user-return-39595-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13133 invoked from network); 9 Apr 2009 08:10:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 08:10:47 -0000
Received: (qmail 51458 invoked by uid 500); 9 Apr 2009 08:10:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51380 invoked by uid 500); 9 Apr 2009 08:10:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51370 invoked by uid 99); 9 Apr 2009 08:10:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 08:10:44 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ww.wang.cs@gmail.com designates 209.85.217.164 as permitted sender)
Received: from [209.85.217.164] (HELO mail-gx0-f164.google.com) (209.85.217.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 08:10:35 +0000
Received: by gxk8 with SMTP id 8so1141681gxk.5
        for <java-user@lucene.apache.org>; Thu, 09 Apr 2009 01:10:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ujN/gV8bmLXyFqwL3zs51B8dLEOcfq/hhyoSewlY3uY=;
        b=bJU8F6TS+RfyR1DiyvICWf4S9haHeTfE9RwdDGz89AezGbRjGUqoGjgTcw+LkSzUFi
         e6gz+hm4u0hAoKNpeNKBawHhBpSlW/wAhe3WZEYEHconVf+1rKD+wSdx5UlDA28K94na
         ZcVYrMlNBOQUsKHoVJxX5iYhguGyJLHFdhwko=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Rw9407TzKcn+AYyIDkWYUDrKHzSVdemof8jzshIWE13otuoNDrWNnl110+nXWU3w3h
         3wSC9vHQb/RfzWqBE6H1vnAa9jdPjeIIZ137Tn7/9Thih4QsPRh7mPnAk3gDsyAb0dmz
         yVxFp+WtMrenS3ezhYhliDv/67k4vsefa6qPE=
MIME-Version: 1.0
Received: by 10.90.99.3 with SMTP id w3mr2756887agb.4.1239264614659; Thu, 09 
	Apr 2009 01:10:14 -0700 (PDT)
In-Reply-To: <49DDAA63.1ED775.19848@m12-11.163.com>
References: <49DDAA63.1ED775.19848@m12-11.163.com>
Date: Thu, 9 Apr 2009 16:10:14 +0800
Message-ID: <7d94dcde0904090110m25c0efc4ic1201f1ad5ff1b33@mail.gmail.com>
Subject: Re: query c++
From: =?GB2312?B?zfXOoc6h?= <ww.wang.cs@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016362836d623b51204671ac77b
X-Virus-Checked: Checked by ClamAV on apache.org

--0016362836d623b51204671ac77b
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: quoted-printable

to be detailed, I implemented a ftp search engine for campus students. I
have handle many different words including chinese words, as a result I
can't only use whitespaceanalyzer. My analyzer is now like this:

    StandardTokenizer tokenStream =3D new StandardTokenizer(reader,
replaceInvalidAcronym);
    tokenStream.setMaxTokenLength(maxTokenLength);
    TokenStream result =3D new StandardFilter(tokenStream);
    result =3D new LowerCaseFilter(result);
    result =3D new StopFilter(result, stopSet);
    result =3D new SnowballFilter(result,STEMMER);

StandardTokenizer is modified by me to split words like season09(like searc=
h
for friends season 09) to =A1=B0season" and "09"=A1=A3
word "c++" is analyzed as "c".

I know i can modify the standardtokenizer to achieve my goal. But are there
any other neat methods?

2009/4/9 hyj <hongyinjie@163.com>

> =CD=F5=CE=A1=CE=A1,=C4=FA=BA=C3=A3=A1
>
>        WhitespaceAnalyzer can work.
>
> =3D=3D=3D=3D=3D=3D=3D 2009-04-09 15:15:14 =C4=FA=D4=DA=C0=B4=D0=C5=D6=D0=
=D0=B4=B5=C0=A3=BA=3D=3D=3D=3D=3D=3D=3D
>
> >I want to make my lucene can search word like c++, c#,  how can i modify
> my
> >analyzer to achieve this goal?
> >
> >--
> >=CD=F5=CE=A1=CE=A1(Weiwei Wang)
> >Department of Computer Science
> >Gulou Campus of Nanjing University
> >Nanjing, P.R.China, 210093
> >
> >Mobile: 86-13913310569
> >MSN: ww.wang.cs@gmail.com
> >Homepage: http://cs.nju.edu.cn/rl/weiweiwang
>
> =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =
=3D =3D
>
>
> =D6=C2
> =C0=F1=A3=A1
>
>
> hyj
> hongyinjie@163.com
> 2009-04-09
>
>


--=20
=CD=F5=CE=A1=CE=A1(Weiwei Wang)
Department of Computer Science
Gulou Campus of Nanjing University
Nanjing, P.R.China, 210093

Mobile: 86-13913310569
MSN: ww.wang.cs@gmail.com
Homepage: http://cs.nju.edu.cn/rl/weiweiwang

--0016362836d623b51204671ac77b--

From java-user-return-39596-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 08:27:52 2009
Return-Path: <java-user-return-39596-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20022 invoked from network); 9 Apr 2009 08:27:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 08:27:51 -0000
Received: (qmail 72835 invoked by uid 500); 9 Apr 2009 08:27:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72747 invoked by uid 500); 9 Apr 2009 08:27:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72737 invoked by uid 99); 9 Apr 2009 08:27:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 08:27:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.125.145.37] (HELO mercury.propylon.com) (194.125.145.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 08:27:38 +0000
Received: from [213.94.211.166] (helo=[192.168.213.119])
	by mercury.propylon.com with esmtp (Exim 4.50)
	id 1Lrpaa-0006ZS-QP
	for java-user@lucene.apache.org; Thu, 09 Apr 2009 09:26:28 +0100
Message-ID: <49DDB15F.2050100@propylon.com>
Date: Thu, 09 Apr 2009 09:27:11 +0100
From: John Byrne <john.byrne@propylon.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
References: <49DDAA63.1ED775.19848@m12-11.163.com> <7d94dcde0904090110m25c0efc4ic1201f1ad5ff1b33@mail.gmail.com>
In-Reply-To: <7d94dcde0904090110m25c0efc4ic1201f1ad5ff1b33@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 8bit
X-SA-Exim-Connect-IP: 213.94.211.166
X-SA-Exim-Mail-From: john.byrne@propylon.com
Subject: Re: query c++
X-Spam-Checker-Version: SpamAssassin 3.0.3 (2005-04-27) on 
	mercury.propylon.com
X-Spam-Level: 
X-SA-Exim-Version: 4.2 (built Thu, 03 Mar 2005 10:44:12 +0100)
X-SA-Exim-Scanned: Yes (on mercury.propylon.com)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-5.7 required=3.0 tests=ALL_TRUSTED,AWL,BAYES_00 
	autolearn=ham version=3.0.3

Hi,

This came up before, a while ago: 
http://www.nabble.com/searching-for-C%2B%2B-to18093942.html#a18093942

I don't think there is an easier way than modifying the standard 
analyzer. As I suggested in that earlier thread, I would make the 
analyzer recognize token patterns that consist of words with prefixed or 
postfixed symbols[1] Then you will receive tokens like "c++" or 
"~/.file" in your token filter. You can then choose to pass them as 
single tokens, or split them down further into two or more tokens.

-John

[1] If you decide to try matching words with symbols in the middle, be 
aware that the StandardAnalyzer already handles some examples of this, 
such as e-mail addresses, so you may make something redundant.

??? wrote:
> to be detailed, I implemented a ftp search engine for campus students. I
> have handle many different words including chinese words, as a result I
> can't only use whitespaceanalyzer. My analyzer is now like this:
>
>     StandardTokenizer tokenStream = new StandardTokenizer(reader,
> replaceInvalidAcronym);
>     tokenStream.setMaxTokenLength(maxTokenLength);
>     TokenStream result = new StandardFilter(tokenStream);
>     result = new LowerCaseFilter(result);
>     result = new StopFilter(result, stopSet);
>     result = new SnowballFilter(result,STEMMER);
>
> StandardTokenizer is modified by me to split words like season09(like search
> for friends season 09) to season" and "09"?
> word "c++" is analyzed as "c".
>
> I know i can modify the standardtokenizer to achieve my goal. But are there
> any other neat methods?
>
> 2009/4/9 hyj <hongyinjie@163.com>
>
>   
>> ???,??!
>>
>>        WhitespaceAnalyzer can work.
>>
>> ======= 2009-04-09 15:15:14 ???????:=======
>>
>>     
>>> I want to make my lucene can search word like c++, c#,  how can i modify
>>>       
>> my
>>     
>>> analyzer to achieve this goal?
>>>
>>> --
>>> ???(Weiwei Wang)
>>> Department of Computer Science
>>> Gulou Campus of Nanjing University
>>> Nanjing, P.R.China, 210093
>>>
>>> Mobile: 86-13913310569
>>> MSN: ww.wang.cs@gmail.com
>>> Homepage: http://cs.nju.edu.cn/rl/weiweiwang
>>>       
>> = = = = = = = = = = = = = = = = = = = =
>>
>>
>> ?
>> ?!
>>
>>
>> hyj
>> hongyinjie@163.com
>> 2009-04-09
>>
>>
>>     
>
>
>   
> ------------------------------------------------------------------------
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com 
> Version: 8.0.238 / Virus Database: 270.11.48/2048 - Release Date: 04/08/09 19:02:00
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39597-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 08:44:17 2009
Return-Path: <java-user-return-39597-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27366 invoked from network); 9 Apr 2009 08:44:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 08:44:17 -0000
Received: (qmail 93348 invoked by uid 500); 9 Apr 2009 08:44:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93294 invoked by uid 500); 9 Apr 2009 08:44:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93284 invoked by uid 99); 9 Apr 2009 08:44:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 08:44:15 +0000
X-ASF-Spam-Status: No, hits=4.0 required=10.0
	tests=HTML_MESSAGE,MIME_QP_LONG_LINE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.125.145.37] (HELO mercury.propylon.com) (194.125.145.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 08:44:05 +0000
Received: from [213.94.211.166] (helo=[192.168.213.119])
	by mercury.propylon.com with esmtp (Exim 4.50)
	id 1LrpqU-00072q-Mu; Thu, 09 Apr 2009 09:42:53 +0100
Message-ID: <49DDB539.1030908@propylon.com>
Date: Thu, 09 Apr 2009 09:43:37 +0100
From: John Byrne <john.byrne@propylon.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
CC: andykan1984@yahoo.com
Content-Type: multipart/mixed;
 boundary="------------070803020206050407070704"
X-SA-Exim-Connect-IP: 213.94.211.166
X-SA-Exim-Mail-From: john.byrne@propylon.com
Subject: [Fwd: Vector space implemantion]
X-Spam-Checker-Version: SpamAssassin 3.0.3 (2005-04-27) on 
	mercury.propylon.com
X-Spam-Level: 
X-SA-Exim-Version: 4.2 (built Thu, 03 Mar 2005 10:44:12 +0100)
X-SA-Exim-Scanned: Yes (on mercury.propylon.com)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-5.1 required=3.0 tests=ALL_TRUSTED,AWL,BAYES_00,
	HTML_30_40,HTML_MESSAGE,MIME_HTML_MOSTLY,MIME_QP_LONG_LINE 
	autolearn=ham version=3.0.3

--------------070803020206050407070704
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hi - wrong address!

Forwarding this to the mailing list...

--------------070803020206050407070704
Content-Type: message/rfc822;
 name="Vector space implemantion.eml"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="Vector space implemantion.eml"

X-Account-Key: account2
X-Mozilla-Keys:                                                                                 
Return-path: <andykan1984@yahoo.com>
Envelope-to: john.byrne@propylon.com
Delivery-date: Thu, 09 Apr 2009 09:39:34 +0100
Received: from web110215.mail.gq1.yahoo.com ([67.195.8.191])
	by mercury.propylon.com with smtp (Exim 4.50)
	id 1LrpnC-0006vt-0X
	for john.byrne@propylon.com; Thu, 09 Apr 2009 09:39:34 +0100
Received: (qmail 26088 invoked by uid 60001); 9 Apr 2009 08:40:13 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1239266413; bh=PDGjQ6E24gQXNBNnVZs4FRCr17/uJVuSKDbSUfVkuxI=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=fpNXxHaZD+TwCK0S1fBOHkH+FU5yAR7VrctG8mCR+d4EzLsJRbIzVV6e72dJCuVxnu/ZmXfdmzZB0dDK3yALjfQja6WVd6ZlGTLQZsjfULTyfyH6eQGZE5VSP4XqrhKzxalRQaYKoc6RxM3IxignyLm/sSfA7+jlY8U9S/EmJaU=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=kYuUamvh12jGcTudzKad1CjDERNaJyRnUN7xpdODHH8O/ttSyl4uVyWMGVSusRq6cilLI20EXqjSCH7GvsFY9PPewGBRJlgICgpZWm+fOMlsV2DksuH6FBTK/UmjzsaxB0PKnftxcyiB/JtqWPc8AdJHwGa8jBu7+T6YfDh91q0=;
Message-ID: <781059.25215.qm@web110215.mail.gq1.yahoo.com>
X-YMail-OSG: UyKgE.kVM1lb20yOovIrOsXj7B27PAXBsEs9N12f9dGhDLK2WOMF4HKwsb512jRcG.PzktFV2ZtnwdMWmaUOOoWzTIH9nfWr9gXjz49SNYuq_vvKA3tqnuokNyzHF4Rr4tqlJ9_ffQ55iErADWRhNZHSECbGtdTLrDGd2eVSovjFpNJQ0ucNB9MEAwiXDCYkYegLQYrTF8NuvkM5j2QiZrTy7W6L6lmsJFQhJeQiI7fL0HR6y7Nl_BNmUngWoAbDU.oCLmQDddwba4TdyWKYDOd8OKyWiZfxnwB.gPVNsxHrvrgHaWZWc2oponsImhtB5nRUIo9hT5b7kBLy
Received: from [78.135.23.204] by web110215.mail.gq1.yahoo.com via HTTP; Thu, 09 Apr 2009 01:40:13 PDT
X-Mailer: YahooMailClassic/5.2.15 YahooMailWebService/0.7.289.1
Date: Thu, 9 Apr 2009 01:40:13 -0700 (PDT)
From: Andy <andykan1984@yahoo.com>
To: john.byrne@propylon.com
MIME-Version: 1.0
X-SA-Exim-Connect-IP: 67.195.8.191
X-SA-Exim-Mail-From: andykan1984@yahoo.com
Subject: Vector space implemantion
X-Spam-Checker-Version: SpamAssassin 3.0.3 (2005-04-27) on 
	mercury.propylon.com
X-Spam-Level: 
X-Spam-Status: No, score=0.1 required=3.0 tests=BAYES_00,FORGED_YAHOO_RCVD,
	HTML_30_40,HTML_MESSAGE autolearn=no version=3.0.3
X-SA-Exim-Version: 4.2 (built Thu, 03 Mar 2005 10:44:12 +0100)
X-SA-Exim-Scanned: Yes (on mercury.propylon.com)
X-Antivirus: AVG for E-mail 8.0.238 [270.11.48/2048]
Content-Type: multipart/mixed; boundary="=======AVGMAIL-49DDB49E0000======="


--=======AVGMAIL-49DDB49E0000=======
Content-Type: multipart/alternative; boundary="0-594771411-1239266413=:25215"



--0-594771411-1239266413=:25215
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable


Hello all,

I'm new to lucene and trying to implement a vector space model using lucene=
. I need to have a file (or on memory) with TF/IDF weight of each term in e=
ach document. (in fact that is a matrix with documents presented as vectors=
, in which the elements of each vector is the TF weight ...)

Please Please help me on this
contact me if you need any further info via andykan1984@yahoo.com
Many Many thanks

--- On Thu, 4/9/09, John Byrne <john.byrne@propylon.com> wrote:

From: John Byrne <john.byrne@propylon.com>
Subject: Re: query c++
To: java-user@lucene.apache.org
Date: Thursday, April 9, 2009, 12:57 PM

Hi,

This came up before, a while ago:=20
http://www.nabble.com/searching-for-C%2B%2B-to18093942.html#a18093942

I don't think there is an easier way than modifying the standard=20
analyzer. As I suggested in that earlier thread, I would make the=20
analyzer recognize token patterns that consist of words with prefixed or=20
postfixed symbols[1] Then you will receive tokens like "c++" or=20
"~/.file" in your token filter. You can then choose to pass them as=20
single tokens, or split them down further into two or more tokens.

-John

[1] If you decide to try matching words with symbols in the middle, be=20
aware that the StandardAnalyzer already handles some examples of this,=20
such as e-mail addresses, so you may make something redundant.

??? wrote:
> to be detailed, I implemented a ftp search engine for campus students. I
> have handle many different words including chinese words, as a result I
> can't only use whitespaceanalyzer. My analyzer is now like this:
>
>=C2=A0 =C2=A0=C2=A0=C2=A0StandardTokenizer tokenStream =3D new StandardTok=
enizer(reader,
> replaceInvalidAcronym);
>=C2=A0 =C2=A0=C2=A0=C2=A0tokenStream.setMaxTokenLength(maxTokenLength);
>=C2=A0 =C2=A0=C2=A0=C2=A0TokenStream result =3D new StandardFilter(tokenSt=
ream);
>=C2=A0 =C2=A0=C2=A0=C2=A0result =3D new LowerCaseFilter(result);
>=C2=A0 =C2=A0=C2=A0=C2=A0result =3D new StopFilter(result, stopSet);
>=C2=A0 =C2=A0=C2=A0=C2=A0result =3D new SnowballFilter(result,STEMMER);
>
> StandardTokenizer is modified by me to split words like season09(like sea=
rch
> for friends season 09) to =E2=80=9Cseason" and "09"?
> word "c++" is analyzed as "c".
>
> I know i can modify the standardtokenizer to achieve my goal. But are the=
re
> any other neat methods?
>
> 2009/4/9 hyj <hongyinjie@163.com>
>
>=C2=A0=C2=A0=C2=A0
>> ???,??!
>>
>>=C2=A0 =C2=A0 =C2=A0 =C2=A0 WhitespaceAnalyzer can work.
>>
>> =3D=3D=3D=3D=3D=3D=3D 2009-04-09 15:15:14 ???????:=3D=3D=3D=3D=3D=3D=3D
>>
>>=C2=A0 =C2=A0=C2=A0=C2=A0
>>> I want to make my lucene can search word like c++, c#,=C2=A0 how can i =
modify
>>>=C2=A0 =C2=A0 =C2=A0=C2=A0=C2=A0
>> my
>>=C2=A0 =C2=A0=C2=A0=C2=A0
>>> analyzer to achieve this goal?
>>>
>>> --
>>> ???(Weiwei Wang)
>>> Department of Computer Science
>>> Gulou Campus of Nanjing University
>>> Nanjing, P.R.China, 210093
>>>
>>> Mobile: 86-13913310569
>>> MSN: ww.wang.cs@gmail.com
>>> Homepage: http://cs.nju.edu.cn/rl/weiweiwang
>>>=C2=A0 =C2=A0 =C2=A0=C2=A0=C2=A0
>> =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =
=3D =3D
>>
>>
>> ?
>> ?!
>>
>>
>> hyj
>> hongyinjie@163.com
>> 2009-04-09
>>
>>
>>=C2=A0 =C2=A0=C2=A0=C2=A0
>
>
>=C2=A0=C2=A0=C2=A0
> ------------------------------------------------------------------------
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com=20
> Version: 8.0.238 / Virus Database: 270.11.48/2048 - Release Date: 04/08/0=
9 19:02:00
>
>=C2=A0=C2=A0=C2=A0


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      
--0-594771411-1239266413=:25215
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: quoted-printable

<table cellspacing=3D"0" cellpadding=3D"0" border=3D"0" ><tr><td valign=3D"=
top" style=3D"font: inherit;"><br>Hello all,<br><br>I'm new to lucene and t=
rying to implement a vector space model using lucene. I need to have a file=
 (or on memory) with TF/IDF weight of each term in each document. (in fact =
that is a matrix with documents presented as vectors, in which the elements=
 of each vector is the TF weight ...)<br><br>Please Please help me on this<=
br>contact me if you need any further info via andykan1984@yahoo.com<br>Man=
y Many thanks<br><br>--- On <b>Thu, 4/9/09, John Byrne <i>&lt;john.byrne@pr=
opylon.com&gt;</i></b> wrote:<br><blockquote style=3D"border-left: 2px soli=
d rgb(16, 16, 255); margin-left: 5px; padding-left: 5px;"><br>From: John By=
rne &lt;john.byrne@propylon.com&gt;<br>Subject: Re: query c++<br>To: java-u=
ser@lucene.apache.org<br>Date: Thursday, April 9, 2009, 12:57 PM<br><br><di=
v class=3D"plainMail">Hi,<br><br>This came up before, a while ago: <br><a
 href=3D"http://www.nabble.com/searching-for-C%2B%2B-to18093942.html#a18093=
942" target=3D"_blank">http://www.nabble.com/searching-for-C%2B%2B-to180939=
42.html#a18093942</a><br><br>I don't think there is an easier way than modi=
fying the standard <br>analyzer. As I suggested in that earlier thread, I w=
ould make the <br>analyzer recognize token patterns that consist of words w=
ith prefixed or <br>postfixed symbols[1] Then you will receive tokens like =
"c++" or <br>"~/.file" in your token filter. You can then choose to pass th=
em as <br>single tokens, or split them down further into two or more tokens=
.<br><br>-John<br><br>[1] If you decide to try matching words with symbols =
in the middle, be <br>aware that the StandardAnalyzer already handles some =
examples of this, <br>such as e-mail addresses, so you may make something r=
edundant.<br><br>??? wrote:<br>&gt; to be detailed, I implemented a ftp sea=
rch engine for campus students. I<br>&gt; have handle many different
 words including chinese words, as a result I<br>&gt; can't only use whites=
paceanalyzer. My analyzer is now like this:<br>&gt;<br>&gt;&nbsp; &nbsp;&nb=
sp;&nbsp;StandardTokenizer tokenStream =3D new StandardTokenizer(reader,<br=
>&gt; replaceInvalidAcronym);<br>&gt;&nbsp; &nbsp;&nbsp;&nbsp;tokenStream.s=
etMaxTokenLength(maxTokenLength);<br>&gt;&nbsp; &nbsp;&nbsp;&nbsp;TokenStre=
am result =3D new StandardFilter(tokenStream);<br>&gt;&nbsp; &nbsp;&nbsp;&n=
bsp;result =3D new LowerCaseFilter(result);<br>&gt;&nbsp; &nbsp;&nbsp;&nbsp=
;result =3D new StopFilter(result, stopSet);<br>&gt;&nbsp; &nbsp;&nbsp;&nbs=
p;result =3D new SnowballFilter(result,STEMMER);<br>&gt;<br>&gt; StandardTo=
kenizer is modified by me to split words like season09(like search<br>&gt; =
for friends season 09) to =E2=80=9Cseason" and "09"?<br>&gt; word "c++" is =
analyzed as "c".<br>&gt;<br>&gt; I know i can modify the standardtokenizer =
to achieve my goal. But are there<br>&gt; any other neat methods?<br>&gt;<b=
r>&gt;
 2009/4/9 hyj &lt;<a ymailto=3D"mailto:hongyinjie@163.com" href=3D"/mc/comp=
ose?to=3Dhongyinjie@163.com">hongyinjie@163.com</a>&gt;<br>&gt;<br>&gt;&nbs=
p;&nbsp;&nbsp;<br>&gt;&gt; ???,??!<br>&gt;&gt;<br>&gt;&gt;&nbsp; &nbsp; &nb=
sp; &nbsp; WhitespaceAnalyzer can work.<br>&gt;&gt;<br>&gt;&gt; =3D=3D=3D=
=3D=3D=3D=3D 2009-04-09 15:15:14 ???????:=3D=3D=3D=3D=3D=3D=3D<br>&gt;&gt;<=
br>&gt;&gt;&nbsp; &nbsp;&nbsp;&nbsp;<br>&gt;&gt;&gt; I want to make my luce=
ne can search word like c++, c#,&nbsp; how can i modify<br>&gt;&gt;&gt;&nbs=
p; &nbsp; &nbsp;&nbsp;&nbsp;<br>&gt;&gt; my<br>&gt;&gt;&nbsp; &nbsp;&nbsp;&=
nbsp;<br>&gt;&gt;&gt; analyzer to achieve this goal?<br>&gt;&gt;&gt;<br>&gt=
;&gt;&gt; --<br>&gt;&gt;&gt; ???(Weiwei Wang)<br>&gt;&gt;&gt; Department of=
 Computer Science<br>&gt;&gt;&gt; Gulou Campus of Nanjing University<br>&gt=
;&gt;&gt; Nanjing, P.R.China, 210093<br>&gt;&gt;&gt;<br>&gt;&gt;&gt; Mobile=
: 86-13913310569<br>&gt;&gt;&gt; MSN: <a ymailto=3D"mailto:ww.wang.cs@gmail=
.com"
 href=3D"/mc/compose?to=3Dww.wang.cs@gmail.com">ww.wang.cs@gmail.com</a><br=
>&gt;&gt;&gt; Homepage: <a href=3D"http://cs.nju.edu.cn/rl/weiweiwang" targ=
et=3D"_blank">http://cs.nju.edu.cn/rl/weiweiwang</a><br>&gt;&gt;&gt;&nbsp; =
&nbsp; &nbsp;&nbsp;&nbsp;<br>&gt;&gt; =3D =3D =3D =3D =3D =3D =3D =3D =3D =
=3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D<br>&gt;&gt;<br>&gt;&gt;<br>&gt;=
&gt; ?<br>&gt;&gt; ?!<br>&gt;&gt;<br>&gt;&gt;<br>&gt;&gt; hyj<br>&gt;&gt; <=
a ymailto=3D"mailto:hongyinjie@163.com" href=3D"/mc/compose?to=3Dhongyinjie=
@163.com">hongyinjie@163.com</a><br>&gt;&gt; 2009-04-09<br>&gt;&gt;<br>&gt;=
&gt;<br>&gt;&gt;&nbsp; &nbsp;&nbsp;&nbsp;<br>&gt;<br>&gt;<br>&gt;&nbsp;&nbs=
p;&nbsp;<br>&gt; ----------------------------------------------------------=
--------------<br>&gt;<br>&gt;<br>&gt; No virus found in this incoming mess=
age.<br>&gt; Checked by AVG - www.avg.com <br>&gt; Version: 8.0.238 / Virus=
 Database: 270.11.48/2048 - Release Date: 04/08/09
 19:02:00<br>&gt;<br>&gt;&nbsp;&nbsp;&nbsp;<br><br><br>--------------------=
-------------------------------------------------<br>To unsubscribe, e-mail=
: <a ymailto=3D"mailto:java-user-unsubscribe@lucene.apache.org" href=3D"/mc=
/compose?to=3Djava-user-unsubscribe@lucene.apache.org">java-user-unsubscrib=
e@lucene.apache.org</a><br>For additional commands, e-mail: <a ymailto=3D"m=
ailto:java-user-help@lucene.apache.org" href=3D"/mc/compose?to=3Djava-user-=
help@lucene.apache.org">java-user-help@lucene.apache.org</a><br><br></div><=
/blockquote></td></tr></table><br>=0A=0A      
--0-594771411-1239266413=:25215--

--=======AVGMAIL-49DDB49E0000=======
Content-Type: multipart/alternative; 
	boundary="=======AVGMAIL-49DDB49E0000======="

--=======AVGMAIL-49DDB49E0000=======
Content-Type: text/plain; x-avg=cert; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
Content-Description: "AVG certification"


No virus found in this incoming message.
Checked by AVG - www.avg.com 
Version: 8.0.238 / Virus Database: 270.11.48/2048 - Release Date: 04/08/09 1=
9:02:00

--=======AVGMAIL-49DDB49E0000=======--
--=======AVGMAIL-49DDB49E0000=======--



--------------070803020206050407070704
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--------------070803020206050407070704--

From java-user-return-39598-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 08:51:18 2009
Return-Path: <java-user-return-39598-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30990 invoked from network); 9 Apr 2009 08:51:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 08:51:18 -0000
Received: (qmail 8428 invoked by uid 500); 9 Apr 2009 08:51:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8345 invoked by uid 500); 9 Apr 2009 08:51:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8334 invoked by uid 99); 9 Apr 2009 08:51:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 08:51:16 +0000
X-ASF-Spam-Status: No, hits=4.0 required=10.0
	tests=HTML_MESSAGE,MIME_QP_LONG_LINE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [67.195.8.187] (HELO web110211.mail.gq1.yahoo.com) (67.195.8.187)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 09 Apr 2009 08:51:04 +0000
Received: (qmail 10820 invoked by uid 60001); 9 Apr 2009 08:50:41 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1239267041; bh=KIVbWF6/b/eMxUu/C8IxtAVOGAR+dzSyuhGkSyWPH9g=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=dBje4ZS99HkMgo3PvCHte2HHHjDeyFAt/5gNkxFShrhNq5dbzraj9OCoTrp/Tyyx0WJHeS21680OM9ngpcv1t9MNoHXazf5eI4I4+HvggZqWzBS9JEA03I75fXgXSQqvs2/FKFRVUtPf1o8cLrDqX6nTLV+vp7FnJ0HNWmTCK0A=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=wcQZpOUL64h8inpQIVAlpsF4WKCzfN8bU8dr7sQEUCuSj5QQnHVGo71qcX2e76qhpeQrUKDhBFgHEdWpHuRP3hlEOMBg6gDLRzXxiRLNh1V9aLkLzhbD0zCFmxOaMQsHBGNPCE3Acf2KcYwJfELchywp0rPuMxGhtn/mY4z1iZ4=;
Message-ID: <710601.9594.qm@web110211.mail.gq1.yahoo.com>
X-YMail-OSG: Suzy.msVM1kaTmo2b_tt8tRjNX.ps5yUuCOhRMfKqW6uU61ywL_SgR2wUgkzk398jMzzVZH_GFJsmFp7gZHX4RdBaLlVEZtlEVQcty5W3tYGgTvV2W8etH_APAqs_WAcqbv2DtgPMdeqeeBobiDVSU316Q6ZFX.EpMhE8MkHfN40aj1lMz6Nm5wyAE013AkMy2vEs7E_n5e2OfifxDToPRK7RV1j8mDXybZeGZ456K2715P0MDdDeKzSboP_cDmFtb6BPfsimCsHhL_MsIFNfIWjowYefgvisUaAY2UbOAqBdGffyj4wvSawAEwJm5nwoscah6_wgG1FCrl8
Received: from [78.135.23.204] by web110211.mail.gq1.yahoo.com via HTTP; Thu, 09 Apr 2009 01:50:41 PDT
X-Mailer: YahooMailClassic/5.2.15 YahooMailWebService/0.7.289.1
Date: Thu, 9 Apr 2009 01:50:41 -0700 (PDT)
From: Andy <andykan1984@yahoo.com>
Subject: Vector space implemantion
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="0-320972479-1239267041=:9594"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-320972479-1239267041=:9594
Content-Type: multipart/alternative; boundary="0-1887653029-1239267041=:9594"

--0-1887653029-1239267041=:9594
Content-Type: text/plain; charset=us-ascii

Hello all,

I'm new to lucene and trying to implement a vector space model using lucene. I need to have a file (or on memory) with TF/IDF weight of each term in each document. (in fact that is a matrix with documents presented as vectors, in which the elements of each vector is the TF weight ...)

Please Please help me on this
contact me if you need any further info via andykan1984@yahoo.com
Many Many thanks




      
--0-1887653029-1239267041=:9594
Content-Type: text/html; charset=us-ascii

<table cellspacing="0" cellpadding="0" border="0" ><tr><td valign="top" style="font: inherit;">Hello all,<br><br>I'm new to lucene and trying to implement a vector space model using lucene. I need to have a file (or on memory) with TF/IDF weight of each term in each document. (in fact that is a matrix with documents presented as vectors, in which the elements of each vector is the TF weight ...)<br><br>Please Please help me on this<br>contact me if you need any further info via andykan1984@yahoo.com<br>Many Many thanks<br><br></td></tr></table><br>

      
--0-1887653029-1239267041=:9594--
--0-320972479-1239267041=:9594
Content-Type: message/rfc822; name=Vector
Content-Disposition: inline; filename="Vector space implemantion.eml"

X-Account-Key: account2
X-Mozilla-Keys:                                                                                 
Return-path: <andykan1984@yahoo.com>
Envelope-to: john.byrne@propylon.com
Delivery-date: Thu, 09 Apr 2009 09:39:34 +0100
Received: from web110215.mail.gq1.yahoo.com ([67.195.8.191])
	by mercury.propylon.com with smtp (Exim 4.50)
	id 1LrpnC-0006vt-0X
	for john.byrne@propylon.com; Thu, 09 Apr 2009 09:39:34 +0100
Received: (qmail 26088 invoked by uid 60001); 9 Apr 2009 08:40:13 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1239266413; bh=PDGjQ6E24gQXNBNnVZs4FRCr17/uJVuSKDbSUfVkuxI=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=fpNXxHaZD+TwCK0S1fBOHkH+FU5yAR7VrctG8mCR+d4EzLsJRbIzVV6e72dJCuVxnu/ZmXfdmzZB0dDK3yALjfQja6WVd6ZlGTLQZsjfULTyfyH6eQGZE5VSP4XqrhKzxalRQaYKoc6RxM3IxignyLm/sSfA7+jlY8U9S/EmJaU=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=kYuUamvh12jGcTudzKad1CjDERNaJyRnUN7xpdODHH8O/ttSyl4uVyWMGVSusRq6cilLI20EXqjSCH7GvsFY9PPewGBRJlgICgpZWm+fOMlsV2DksuH6FBTK/UmjzsaxB0PKnftxcyiB/JtqWPc8AdJHwGa8jBu7+T6YfDh91q0=;
Message-ID: <781059.25215.qm@web110215.mail.gq1.yahoo.com>
X-YMail-OSG: UyKgE.kVM1lb20yOovIrOsXj7B27PAXBsEs9N12f9dGhDLK2WOMF4HKwsb512jRcG.PzktFV2ZtnwdMWmaUOOoWzTIH9nfWr9gXjz49SNYuq_vvKA3tqnuokNyzHF4Rr4tqlJ9_ffQ55iErADWRhNZHSECbGtdTLrDGd2eVSovjFpNJQ0ucNB9MEAwiXDCYkYegLQYrTF8NuvkM5j2QiZrTy7W6L6lmsJFQhJeQiI7fL0HR6y7Nl_BNmUngWoAbDU.oCLmQDddwba4TdyWKYDOd8OKyWiZfxnwB.gPVNsxHrvrgHaWZWc2oponsImhtB5nRUIo9hT5b7kBLy
Received: from [78.135.23.204] by web110215.mail.gq1.yahoo.com via HTTP; Thu, 09 Apr 2009 01:40:13 PDT
X-Mailer: YahooMailClassic/5.2.15 YahooMailWebService/0.7.289.1
Date: Thu, 9 Apr 2009 01:40:13 -0700 (PDT)
From: Andy <andykan1984@yahoo.com>
To: john.byrne@propylon.com
MIME-Version: 1.0
X-SA-Exim-Connect-IP: 67.195.8.191
X-SA-Exim-Mail-From: andykan1984@yahoo.com
Subject: Vector space implemantion
X-Spam-Checker-Version: SpamAssassin 3.0.3 (2005-04-27) on 
	mercury.propylon.com
X-Spam-Level: 
X-Spam-Status: No, score=0.1 required=3.0 tests=BAYES_00,FORGED_YAHOO_RCVD,
	HTML_30_40,HTML_MESSAGE autolearn=no version=3.0.3
X-SA-Exim-Version: 4.2 (built Thu, 03 Mar 2005 10:44:12 +0100)
X-SA-Exim-Scanned: Yes (on mercury.propylon.com)
X-Antivirus: AVG for E-mail 8.0.238 [270.11.48/2048]
Content-Type: multipart/mixed; boundary="=======AVGMAIL-49DDB49E0000======="


--=======AVGMAIL-49DDB49E0000=======
Content-Type: multipart/alternative; boundary="0-594771411-1239266413=:25215"



--0-594771411-1239266413=:25215
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable


Hello all,

I'm new to lucene and trying to implement a vector space model using lucene=
. I need to have a file (or on memory) with TF/IDF weight of each term in e=
ach document. (in fact that is a matrix with documents presented as vectors=
, in which the elements of each vector is the TF weight ...)

Please Please help me on this
contact me if you need any further info via andykan1984@yahoo.com
Many Many thanks

--- On Thu, 4/9/09, John Byrne <john.byrne@propylon.com> wrote:

From: John Byrne <john.byrne@propylon.com>
Subject: Re: query c++
To: java-user@lucene.apache.org
Date: Thursday, April 9, 2009, 12:57 PM

Hi,

This came up before, a while ago:=20
http://www.nabble.com/searching-for-C%2B%2B-to18093942.html#a18093942

I don't think there is an easier way than modifying the standard=20
analyzer. As I suggested in that earlier thread, I would make the=20
analyzer recognize token patterns that consist of words with prefixed or=20
postfixed symbols[1] Then you will receive tokens like "c++" or=20
"~/.file" in your token filter. You can then choose to pass them as=20
single tokens, or split them down further into two or more tokens.

-John

[1] If you decide to try matching words with symbols in the middle, be=20
aware that the StandardAnalyzer already handles some examples of this,=20
such as e-mail addresses, so you may make something redundant.

??? wrote:
> to be detailed, I implemented a ftp search engine for campus students. I
> have handle many different words including chinese words, as a result I
> can't only use whitespaceanalyzer. My analyzer is now like this:
>
>=C2=A0 =C2=A0=C2=A0=C2=A0StandardTokenizer tokenStream =3D new StandardTok=
enizer(reader,
> replaceInvalidAcronym);
>=C2=A0 =C2=A0=C2=A0=C2=A0tokenStream.setMaxTokenLength(maxTokenLength);
>=C2=A0 =C2=A0=C2=A0=C2=A0TokenStream result =3D new StandardFilter(tokenSt=
ream);
>=C2=A0 =C2=A0=C2=A0=C2=A0result =3D new LowerCaseFilter(result);
>=C2=A0 =C2=A0=C2=A0=C2=A0result =3D new StopFilter(result, stopSet);
>=C2=A0 =C2=A0=C2=A0=C2=A0result =3D new SnowballFilter(result,STEMMER);
>
> StandardTokenizer is modified by me to split words like season09(like sea=
rch
> for friends season 09) to =E2=80=9Cseason" and "09"?
> word "c++" is analyzed as "c".
>
> I know i can modify the standardtokenizer to achieve my goal. But are the=
re
> any other neat methods?
>
> 2009/4/9 hyj <hongyinjie@163.com>
>
>=C2=A0=C2=A0=C2=A0
>> ???,??!
>>
>>=C2=A0 =C2=A0 =C2=A0 =C2=A0 WhitespaceAnalyzer can work.
>>
>> =3D=3D=3D=3D=3D=3D=3D 2009-04-09 15:15:14 ???????:=3D=3D=3D=3D=3D=3D=3D
>>
>>=C2=A0 =C2=A0=C2=A0=C2=A0
>>> I want to make my lucene can search word like c++, c#,=C2=A0 how can i =
modify
>>>=C2=A0 =C2=A0 =C2=A0=C2=A0=C2=A0
>> my
>>=C2=A0 =C2=A0=C2=A0=C2=A0
>>> analyzer to achieve this goal?
>>>
>>> --
>>> ???(Weiwei Wang)
>>> Department of Computer Science
>>> Gulou Campus of Nanjing University
>>> Nanjing, P.R.China, 210093
>>>
>>> Mobile: 86-13913310569
>>> MSN: ww.wang.cs@gmail.com
>>> Homepage: http://cs.nju.edu.cn/rl/weiweiwang
>>>=C2=A0 =C2=A0 =C2=A0=C2=A0=C2=A0
>> =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =
=3D =3D
>>
>>
>> ?
>> ?!
>>
>>
>> hyj
>> hongyinjie@163.com
>> 2009-04-09
>>
>>
>>=C2=A0 =C2=A0=C2=A0=C2=A0
>
>
>=C2=A0=C2=A0=C2=A0
> ------------------------------------------------------------------------
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com=20
> Version: 8.0.238 / Virus Database: 270.11.48/2048 - Release Date: 04/08/0=
9 19:02:00
>
>=C2=A0=C2=A0=C2=A0


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      
--0-594771411-1239266413=:25215
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: quoted-printable

<table cellspacing=3D"0" cellpadding=3D"0" border=3D"0" ><tr><td valign=3D"=
top" style=3D"font: inherit;"><br>Hello all,<br><br>I'm new to lucene and t=
rying to implement a vector space model using lucene. I need to have a file=
 (or on memory) with TF/IDF weight of each term in each document. (in fact =
that is a matrix with documents presented as vectors, in which the elements=
 of each vector is the TF weight ...)<br><br>Please Please help me on this<=
br>contact me if you need any further info via andykan1984@yahoo.com<br>Man=
y Many thanks<br><br>--- On <b>Thu, 4/9/09, John Byrne <i>&lt;john.byrne@pr=
opylon.com&gt;</i></b> wrote:<br><blockquote style=3D"border-left: 2px soli=
d rgb(16, 16, 255); margin-left: 5px; padding-left: 5px;"><br>From: John By=
rne &lt;john.byrne@propylon.com&gt;<br>Subject: Re: query c++<br>To: java-u=
ser@lucene.apache.org<br>Date: Thursday, April 9, 2009, 12:57 PM<br><br><di=
v class=3D"plainMail">Hi,<br><br>This came up before, a while ago: <br><a
 href=3D"http://www.nabble.com/searching-for-C%2B%2B-to18093942.html#a18093=
942" target=3D"_blank">http://www.nabble.com/searching-for-C%2B%2B-to180939=
42.html#a18093942</a><br><br>I don't think there is an easier way than modi=
fying the standard <br>analyzer. As I suggested in that earlier thread, I w=
ould make the <br>analyzer recognize token patterns that consist of words w=
ith prefixed or <br>postfixed symbols[1] Then you will receive tokens like =
"c++" or <br>"~/.file" in your token filter. You can then choose to pass th=
em as <br>single tokens, or split them down further into two or more tokens=
.<br><br>-John<br><br>[1] If you decide to try matching words with symbols =
in the middle, be <br>aware that the StandardAnalyzer already handles some =
examples of this, <br>such as e-mail addresses, so you may make something r=
edundant.<br><br>??? wrote:<br>&gt; to be detailed, I implemented a ftp sea=
rch engine for campus students. I<br>&gt; have handle many different
 words including chinese words, as a result I<br>&gt; can't only use whites=
paceanalyzer. My analyzer is now like this:<br>&gt;<br>&gt;&nbsp; &nbsp;&nb=
sp;&nbsp;StandardTokenizer tokenStream =3D new StandardTokenizer(reader,<br=
>&gt; replaceInvalidAcronym);<br>&gt;&nbsp; &nbsp;&nbsp;&nbsp;tokenStream.s=
etMaxTokenLength(maxTokenLength);<br>&gt;&nbsp; &nbsp;&nbsp;&nbsp;TokenStre=
am result =3D new StandardFilter(tokenStream);<br>&gt;&nbsp; &nbsp;&nbsp;&n=
bsp;result =3D new LowerCaseFilter(result);<br>&gt;&nbsp; &nbsp;&nbsp;&nbsp=
;result =3D new StopFilter(result, stopSet);<br>&gt;&nbsp; &nbsp;&nbsp;&nbs=
p;result =3D new SnowballFilter(result,STEMMER);<br>&gt;<br>&gt; StandardTo=
kenizer is modified by me to split words like season09(like search<br>&gt; =
for friends season 09) to =E2=80=9Cseason" and "09"?<br>&gt; word "c++" is =
analyzed as "c".<br>&gt;<br>&gt; I know i can modify the standardtokenizer =
to achieve my goal. But are there<br>&gt; any other neat methods?<br>&gt;<b=
r>&gt;
 2009/4/9 hyj &lt;<a ymailto=3D"mailto:hongyinjie@163.com" href=3D"/mc/comp=
ose?to=3Dhongyinjie@163.com">hongyinjie@163.com</a>&gt;<br>&gt;<br>&gt;&nbs=
p;&nbsp;&nbsp;<br>&gt;&gt; ???,??!<br>&gt;&gt;<br>&gt;&gt;&nbsp; &nbsp; &nb=
sp; &nbsp; WhitespaceAnalyzer can work.<br>&gt;&gt;<br>&gt;&gt; =3D=3D=3D=
=3D=3D=3D=3D 2009-04-09 15:15:14 ???????:=3D=3D=3D=3D=3D=3D=3D<br>&gt;&gt;<=
br>&gt;&gt;&nbsp; &nbsp;&nbsp;&nbsp;<br>&gt;&gt;&gt; I want to make my luce=
ne can search word like c++, c#,&nbsp; how can i modify<br>&gt;&gt;&gt;&nbs=
p; &nbsp; &nbsp;&nbsp;&nbsp;<br>&gt;&gt; my<br>&gt;&gt;&nbsp; &nbsp;&nbsp;&=
nbsp;<br>&gt;&gt;&gt; analyzer to achieve this goal?<br>&gt;&gt;&gt;<br>&gt=
;&gt;&gt; --<br>&gt;&gt;&gt; ???(Weiwei Wang)<br>&gt;&gt;&gt; Department of=
 Computer Science<br>&gt;&gt;&gt; Gulou Campus of Nanjing University<br>&gt=
;&gt;&gt; Nanjing, P.R.China, 210093<br>&gt;&gt;&gt;<br>&gt;&gt;&gt; Mobile=
: 86-13913310569<br>&gt;&gt;&gt; MSN: <a ymailto=3D"mailto:ww.wang.cs@gmail=
.com"
 href=3D"/mc/compose?to=3Dww.wang.cs@gmail.com">ww.wang.cs@gmail.com</a><br=
>&gt;&gt;&gt; Homepage: <a href=3D"http://cs.nju.edu.cn/rl/weiweiwang" targ=
et=3D"_blank">http://cs.nju.edu.cn/rl/weiweiwang</a><br>&gt;&gt;&gt;&nbsp; =
&nbsp; &nbsp;&nbsp;&nbsp;<br>&gt;&gt; =3D =3D =3D =3D =3D =3D =3D =3D =3D =
=3D =3D =3D =3D =3D =3D =3D =3D =3D =3D =3D<br>&gt;&gt;<br>&gt;&gt;<br>&gt;=
&gt; ?<br>&gt;&gt; ?!<br>&gt;&gt;<br>&gt;&gt;<br>&gt;&gt; hyj<br>&gt;&gt; <=
a ymailto=3D"mailto:hongyinjie@163.com" href=3D"/mc/compose?to=3Dhongyinjie=
@163.com">hongyinjie@163.com</a><br>&gt;&gt; 2009-04-09<br>&gt;&gt;<br>&gt;=
&gt;<br>&gt;&gt;&nbsp; &nbsp;&nbsp;&nbsp;<br>&gt;<br>&gt;<br>&gt;&nbsp;&nbs=
p;&nbsp;<br>&gt; ----------------------------------------------------------=
--------------<br>&gt;<br>&gt;<br>&gt; No virus found in this incoming mess=
age.<br>&gt; Checked by AVG - www.avg.com <br>&gt; Version: 8.0.238 / Virus=
 Database: 270.11.48/2048 - Release Date: 04/08/09
 19:02:00<br>&gt;<br>&gt;&nbsp;&nbsp;&nbsp;<br><br><br>--------------------=
-------------------------------------------------<br>To unsubscribe, e-mail=
: <a ymailto=3D"mailto:java-user-unsubscribe@lucene.apache.org" href=3D"/mc=
/compose?to=3Djava-user-unsubscribe@lucene.apache.org">java-user-unsubscrib=
e@lucene.apache.org</a><br>For additional commands, e-mail: <a ymailto=3D"m=
ailto:java-user-help@lucene.apache.org" href=3D"/mc/compose?to=3Djava-user-=
help@lucene.apache.org">java-user-help@lucene.apache.org</a><br><br></div><=
/blockquote></td></tr></table><br>=0A=0A      
--0-594771411-1239266413=:25215--

--=======AVGMAIL-49DDB49E0000=======
Content-Type: multipart/alternative; 
	boundary="=======AVGMAIL-49DDB49E0000======="

--=======AVGMAIL-49DDB49E0000=======
Content-Type: text/plain; x-avg=cert; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
Content-Description: "AVG certification"


No virus found in this incoming message.
Checked by AVG - www.avg.com 
Version: 8.0.238 / Virus Database: 270.11.48/2048 - Release Date: 04/08/09 1=
9:02:00

--=======AVGMAIL-49DDB49E0000=======--
--=======AVGMAIL-49DDB49E0000=======--



--0-320972479-1239267041=:9594
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--0-320972479-1239267041=:9594--

From java-user-return-39599-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 12:00:16 2009
Return-Path: <java-user-return-39599-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34210 invoked from network); 9 Apr 2009 12:00:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 12:00:16 -0000
Received: (qmail 48019 invoked by uid 500); 9 Apr 2009 12:00:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47983 invoked by uid 500); 9 Apr 2009 12:00:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47973 invoked by uid 99); 9 Apr 2009 12:00:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 12:00:13 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ww.wang.cs@gmail.com designates 209.85.217.164 as permitted sender)
Received: from [209.85.217.164] (HELO mail-gx0-f164.google.com) (209.85.217.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 12:00:02 +0000
Received: by gxk8 with SMTP id 8so1250846gxk.5
        for <java-user@lucene.apache.org>; Thu, 09 Apr 2009 04:59:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=hcbGhlO30Q0/UdDe13DG4taSoS8TfN4d8hRtYhc3O14=;
        b=ow3/1y4GYRYAxDmcW7z9m6gEkB4oDsr1uetxM0vEAGYg9+wjhe3JW6LoTD5s7OCvT2
         SORFQjjeIF0hXDwbJGQdSFAx68zpHkmeko08g/xkMbji2AXPcu1DqRDO2lr0Df88eLUZ
         E3/L1jNs3K0aDqFLbSwjriuUGCJdZ5MVrsUxo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=LmaxAO8CPlKaoxkj2LZeJn65xVnxPbWMpAubE6AU46m0xsXktPWdu00Fqa8empuXoF
         OLTTsRi/09Sx3iGTAjTRkA277reLpj2xltIcpZFbAoKabhkJqqFKSjRCSs0ovqxqpnbw
         KOfwzxRbsFKgpY6c2OWoADrrpZX/krEE3qzJQ=
MIME-Version: 1.0
Received: by 10.90.113.17 with SMTP id l17mr2952945agc.76.1239278380391; Thu, 
	09 Apr 2009 04:59:40 -0700 (PDT)
In-Reply-To: <7d94dcde0904081939m13be52aaofa9c40b6ec033be9@mail.gmail.com>
References: <s9dcab94.070@mail.btsb.com>
	 <5CED0A21-A0D8-42F6-9CF8-0CAC1335C83D@gmail.com>
	 <7d94dcde0904081939m13be52aaofa9c40b6ec033be9@mail.gmail.com>
Date: Thu, 9 Apr 2009 19:59:40 +0800
Message-ID: <7d94dcde0904090459x5b4398f9j927de92f1182e3a5@mail.gmail.com>
Subject: Re: Suggestive Search
From: =?GB2312?B?zfXOoc6h?= <ww.wang.cs@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/mixed; boundary=0016362835a6a41fcf04671dfb05
X-Virus-Checked: Checked by ClamAV on apache.org

--0016362835a6a41fcf04671dfb05
Content-Type: multipart/alternative; boundary=0016362835a6a41fc404671dfb03

--0016362835a6a41fc404671dfb03
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: quoted-printable

In my project, i stored the user input keyword in the database, as a result=
,
I build a index from the database and use it to do suggestive search. The
code example is googled and I changed the analyzer and query function. I
attach the code but you have to modify the code to make it run.

For chinese words, if you build your dictionary index from the index you
build for your web search or ftp search, make sure that your analyzer can
correctly segmented, otherwise the dictionary index will not be able to wor=
k
correctly.

2009/4/9 =CD=F5=CE=A1=CE=A1 <ww.wang.cs@gmail.com>

> I test the lucene spellchecker and it doesn't support chinese spell
> checker, how can i achieve this goal as google does?
>
> 2009/4/9 Karl Wettin <karl.wettin@gmail.com>
>
> If you use prefix grams only then you'll get a forward-only suggestion
>> scheme. I've seen several implementation that use that and it works quit=
e
>> well.
>>
>> harry potter: ^ha, ^har, ^harr, ^harry, ^harry p, ^harry po..
>> harry houdini: ^ha, ^har, ^harr, ^harry, ^harry h, ^harry ho..
>>
>> I prefere the trie-pattern though. Just rememberd there is an old one in
>> LUCENE-625.
>>
>>     karl
>>
>> 8 apr 2009 kl. 20.50 skrev Matt Schraeder:
>>
>>
>>  Corerct me if I'm wrong, but I don't think n-grams is really what I'm
>>> looking for here.  I'm not looking for a spellchecker or phrase checker
>>> style suggestive search, but only based on the exact phrases the user i=
s
>>> currently typing.  Since Lucene uses term-based searching, I'm not sure
>>> how to have it search on portions of a full phrase.  Using a standard
>>> lucene search typing in "harr" will result in searching for "harr" as a
>>> term, which will not find "Harry Potter".  Using ngrams it would find
>>> "Harry" as a term, but not at the beginning of an entire phrase.  This
>>> would bring back "My Dog Harry" as a result, which isn't what I'm
>>> looking for. I just want phrases from fields beginning with "Harr"
>>> only.
>>>
>>> I could easily do this all with our database server by simply doing a
>>> query for "where searchqueries like 'harr%'" but we're trying to limit
>>> our hits to the database to keep speed up on the site.
>>>
>>>  karl.wettin@gmail.com 4/8/2009 12:49:45 PM >>>
>>>>>>
>>>>>
>>> For this you probably want to use ngrams. Wether or not this is
>>> something that fits in your current index is hard to say. My guess is
>>>
>>> that you want to create a new index with one document per unique
>>> phrase. You might also want to try to load this index in an
>>> InstantiatedIndex, that could speed things up quite a bit if the
>>> corpus is not too large.
>>>
>>> If your suggestion text corpus is really large and you only want
>>> forward-only suggestions then you might want to consider a trie-
>>> pattern solution instead. These can be rather resource efficient, even
>>>
>>> when loaded to memory.
>>>
>>> If you have a lot of user load on your search eninge then it might be
>>>
>>> interesting to use old user queries as the base of your suggestions
>>> and perhaps boost a bit on trends, i.e. the more people search for
>>> something the more it get boosted in the suggestions list.
>>>
>>>
>>>     karl
>>>
>>> 8 apr 2009 kl. 15.26 skrev Matt Schraeder:
>>>
>>>  I want to add a suggestive search similar to google's to
>>>>
>>> autocomplete
>>>
>>>> search phrases as the user types.  It doesn't have to be very
>>>> elaborate
>>>> and for the most part will just involve searching single fields.
>>>>
>>> How
>>>
>>>> can I perform a search  to be able to fill in autocomplete text?
>>>>
>>>> For instance, if I start typing "Harr" it should bring up "Harry
>>>> Potter" "Harry Houdini" and "Harry S. Truman"
>>>>
>>>> I have tried doing search queries for "Harr*" but it's still doing
>>>> term-based searching rather than searching a full field.  To make a
>>>> field both searchable as the full field as well as tokenized, would
>>>>
>>> I
>>>
>>>> have to duplicate the field and make one a keyword field? Is there a
>>>> more convenient way to do this? I have also considered making a
>>>>
>>> second
>>>
>>>> index for suggestive search, which would only have the fields that I
>>>> want to enable suggestive search on, but this seems like it would be
>>>> unneccesary duplication of data as well, though it would probably
>>>>
>>> make
>>>
>>>> suggestive search faster due to a smaller index.
>>>>
>>>> Ideally it would also be nice to be able to rank these terms based
>>>>
>>> on
>>>
>>>> the number of times they have been searched for so that the results
>>>>
>>>
>>>  are
>>>> tailored more to our users rather than simply just the score that
>>>> Lucene
>>>> chooses.
>>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> --
> =CD=F5=CE=A1=CE=A1(Weiwei Wang)
> Department of Computer Science
> Gulou Campus of Nanjing University
> Nanjing, P.R.China, 210093
>
> Mobile: 86-13913310569
> MSN: ww.wang.cs@gmail.com
> Homepage: http://cs.nju.edu.cn/rl/weiweiwang
>



--=20
=CD=F5=CE=A1=CE=A1(Weiwei Wang)
Department of Computer Science
Gulou Campus of Nanjing University
Nanjing, P.R.China, 210093

Mobile: 86-13913310569
MSN: ww.wang.cs@gmail.com
Homepage: http://cs.nju.edu.cn/rl/weiweiwang

--0016362835a6a41fc404671dfb03
Content-Type: text/html; charset=GB2312
Content-Transfer-Encoding: quoted-printable

In my project, i stored the user input keyword in the database, as a result=
, I build a index from the database and use it to do suggestive search. The=
 code example is googled and I changed the analyzer and query function. I a=
ttach the code but you have to modify the code to make it run.<br>
<br>For chinese words, if you build your dictionary index from the index yo=
u build for your web search or ftp search, make sure that your analyzer can=
 correctly segmented, otherwise the dictionary index will not be able to wo=
rk correctly.<br>
<br><div class=3D"gmail_quote">2009/4/9 =CD=F5=CE=A1=CE=A1 <span dir=3D"ltr=
">&lt;<a href=3D"mailto:ww.wang.cs@gmail.com">ww.wang.cs@gmail.com</a>&gt;<=
/span><br><blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid=
 rgb(204, 204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
I test the lucene spellchecker and it doesn&#39;t support chinese spell che=
cker, how can i achieve this goal as google does?<br><br><div class=3D"gmai=
l_quote">2009/4/9 Karl Wettin <span dir=3D"ltr">&lt;<a href=3D"mailto:karl.=
wettin@gmail.com" target=3D"_blank">karl.wettin@gmail.com</a>&gt;</span><di=
v>
<div></div><div class=3D"h5"><br>
<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">If you use prefix=
 grams only then you&#39;ll get a forward-only suggestion scheme. I&#39;ve =
seen several implementation that use that and it works quite well.<br>


<br>
harry potter: ^ha, ^har, ^harr, ^harry, ^harry p, ^harry po..<br>
harry houdini: ^ha, ^har, ^harr, ^harry, ^harry h, ^harry ho..<br>
<br>
I prefere the trie-pattern though. Just rememberd there is an old one in LU=
CENE-625.<br>
<br>
 &nbsp; &nbsp; karl<br>
<br>
8 apr 2009 kl. 20.50 skrev Matt Schraeder:<div><div></div><div><br>
<br>
<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
Corerct me if I&#39;m wrong, but I don&#39;t think n-grams is really what I=
&#39;m<br>
looking for here. &nbsp;I&#39;m not looking for a spellchecker or phrase ch=
ecker<br>
style suggestive search, but only based on the exact phrases the user is<br=
>
currently typing. &nbsp;Since Lucene uses term-based searching, I&#39;m not=
 sure<br>
how to have it search on portions of a full phrase. &nbsp;Using a standard<=
br>
lucene search typing in &quot;harr&quot; will result in searching for &quot=
;harr&quot; as a<br>
term, which will not find &quot;Harry Potter&quot;. &nbsp;Using ngrams it w=
ould find<br>
&quot;Harry&quot; as a term, but not at the beginning of an entire phrase. =
&nbsp;This<br>
would bring back &quot;My Dog Harry&quot; as a result, which isn&#39;t what=
 I&#39;m<br>
looking for. I just want phrases from fields beginning with &quot;Harr&quot=
;<br>
only.<br>
<br>
I could easily do this all with our database server by simply doing a<br>
query for &quot;where searchqueries like &#39;harr%&#39;&quot; but we&#39;r=
e trying to limit<br>
our hits to the database to keep speed up on the site.<br>
<br>
<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;"><blockquote class=
=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, 204, 204); margin=
: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">

<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
<a href=3D"mailto:karl.wettin@gmail.com" target=3D"_blank">karl.wettin@gmai=
l.com</a> 4/8/2009 12:49:45 PM &gt;&gt;&gt;<br>
</blockquote></blockquote></blockquote>
<br>
For this you probably want to use ngrams. Wether or not this is<br>
something that fits in your current index is hard to say. My guess is<br>
<br>
that you want to create a new index with one document per unique<br>
phrase. You might also want to try to load this index in an<br>
InstantiatedIndex, that could speed things up quite a bit if the<br>
corpus is not too large.<br>
<br>
If your suggestion text corpus is really large and you only want<br>
forward-only suggestions then you might want to consider a trie-<br>
pattern solution instead. These can be rather resource efficient, even<br>
<br>
when loaded to memory.<br>
<br>
If you have a lot of user load on your search eninge then it might be<br>
<br>
interesting to use old user queries as the base of your suggestions<br>
and perhaps boost a bit on trends, i.e. the more people search for<br>
something the more it get boosted in the suggestions list.<br>
<br>
<br>
 &nbsp; &nbsp; karl<br>
<br>
8 apr 2009 kl. 15.26 skrev Matt Schraeder:<br>
<br>
<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
I want to add a suggestive search similar to google&#39;s to<br>
</blockquote>
autocomplete<br>
<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
search phrases as the user types. &nbsp;It doesn&#39;t have to be very<br>
elaborate<br>
and for the most part will just involve searching single fields.<br>
</blockquote>
How<br>
<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
can I perform a search &nbsp;to be able to fill in autocomplete text?<br>
<br>
For instance, if I start typing &quot;Harr&quot; it should bring up &quot;H=
arry<br>
Potter&quot; &quot;Harry Houdini&quot; and &quot;Harry S. Truman&quot;<br>
<br>
I have tried doing search queries for &quot;Harr*&quot; but it&#39;s still =
doing<br>
term-based searching rather than searching a full field. &nbsp;To make a<br=
>
field both searchable as the full field as well as tokenized, would<br>
</blockquote>
I<br>
<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
have to duplicate the field and make one a keyword field? Is there a<br>
more convenient way to do this? I have also considered making a<br>
</blockquote>
second<br>
<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
index for suggestive search, which would only have the fields that I<br>
want to enable suggestive search on, but this seems like it would be<br>
unneccesary duplication of data as well, though it would probably<br>
</blockquote>
make<br>
<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
suggestive search faster due to a smaller index.<br>
<br>
Ideally it would also be nice to be able to rank these terms based<br>
</blockquote>
on<br>
<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
the number of times they have been searched for so that the results<br>
</blockquote>
<br>
<blockquote class=3D"gmail_quote" style=3D"border-left: 1px solid rgb(204, =
204, 204); margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex;">
are<br>
tailored more to our users rather than simply just the score that<br>
Lucene<br>
chooses.<br>
</blockquote>
<br>
<br>
---------------------------------------------------------------------<br>
To unsubscribe, e-mail: <a href=3D"mailto:java-user-unsubscribe@lucene.apac=
he.org" target=3D"_blank">java-user-unsubscribe@lucene.apache.org</a><br>
For additional commands, e-mail: <a href=3D"mailto:java-user-help@lucene.ap=
ache.org" target=3D"_blank">java-user-help@lucene.apache.org</a><br>
<br>
<br>
</blockquote>
<br>
<br>
---------------------------------------------------------------------<br>
To unsubscribe, e-mail: <a href=3D"mailto:java-user-unsubscribe@lucene.apac=
he.org" target=3D"_blank">java-user-unsubscribe@lucene.apache.org</a><br>
For additional commands, e-mail: <a href=3D"mailto:java-user-help@lucene.ap=
ache.org" target=3D"_blank">java-user-help@lucene.apache.org</a><br>
<br>
</div></div></blockquote></div></div></div><br><br clear=3D"all"><br>-- <br=
>=CD=F5=CE=A1=CE=A1(Weiwei Wang)<br>Department of Computer Science<br>Gulou=
 Campus of Nanjing University<br>Nanjing, P.R.China, 210093<br><br>Mobile: =
86-13913310569<br>
MSN: <a href=3D"mailto:ww.wang.cs@gmail.com" target=3D"_blank">ww.wang.cs@g=
mail.com</a><br>
Homepage: <a href=3D"http://cs.nju.edu.cn/rl/weiweiwang" target=3D"_blank">=
http://cs.nju.edu.cn/rl/weiweiwang</a><br>
</blockquote></div><br><br clear=3D"all"><br>-- <br>=CD=F5=CE=A1=CE=A1(Weiw=
ei Wang)<br>Department of Computer Science<br>Gulou Campus of Nanjing Unive=
rsity<br>Nanjing, P.R.China, 210093<br><br>Mobile: 86-13913310569<br>MSN: <=
a href=3D"mailto:ww.wang.cs@gmail.com">ww.wang.cs@gmail.com</a><br>
Homepage: <a href=3D"http://cs.nju.edu.cn/rl/weiweiwang">http://cs.nju.edu.=
cn/rl/weiweiwang</a><br>

--0016362835a6a41fc404671dfb03--
--0016362835a6a41fcf04671dfb05
Content-Type: text/java; name="AutoCompleter.java"
Content-Disposition: attachment; filename="AutoCompleter.java"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_ftbe8gel0

cGFja2FnZSBzcGVsbGNoZWNrZXI7DQoNCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOw0KaW1w
b3J0IGphdmEuaW8uUmVhZGVyOw0KaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7DQppbXBvcnQg
amF2YS51dGlsLkhhc2hNYXA7DQppbXBvcnQgamF2YS51dGlsLkxpc3Q7DQppbXBvcnQgamF2YS51
dGlsLk1hcDsNCg0KaW1wb3J0IGxvZy5DcmF3bGVyTG9nZ2VyOw0KDQppbXBvcnQgb3JnLmFwYWNo
ZS5sdWNlbmUuYW5hbHlzaXMuQW5hbHl6ZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5sdWNlbmUuYW5h
bHlzaXMuSVNPTGF0aW4xQWNjZW50RmlsdGVyOw0KaW1wb3J0IG9yZy5hcGFjaGUubHVjZW5lLmFu
YWx5c2lzLkxvd2VyQ2FzZUZpbHRlcjsNCmltcG9ydCBvcmcuYXBhY2hlLmx1Y2VuZS5hbmFseXNp
cy5TdG9wQW5hbHl6ZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5sdWNlbmUuYW5hbHlzaXMuU3RvcEZp
bHRlcjsNCmltcG9ydCBvcmcuYXBhY2hlLmx1Y2VuZS5hbmFseXNpcy5Ub2tlblN0cmVhbTsNCmlt
cG9ydCBvcmcuYXBhY2hlLmx1Y2VuZS5hbmFseXNpcy5uZ3JhbS5FZGdlTkdyYW1Ub2tlbkZpbHRl
cjsNCmltcG9ydCBvcmcuYXBhY2hlLmx1Y2VuZS5hbmFseXNpcy5uZ3JhbS5FZGdlTkdyYW1Ub2tl
bkZpbHRlci5TaWRlOw0KaW1wb3J0IG9yZy5hcGFjaGUubHVjZW5lLmFuYWx5c2lzLnNub3diYWxs
LlNub3diYWxsRmlsdGVyOw0KaW1wb3J0IG9yZy5hcGFjaGUubHVjZW5lLmFuYWx5c2lzLnN0YW5k
YXJkLlN0YW5kYXJkRmlsdGVyOw0KaW1wb3J0IG9yZy5hcGFjaGUubHVjZW5lLmFuYWx5c2lzLnN0
YW5kYXJkLlN0YW5kYXJkVG9rZW5pemVyOw0KaW1wb3J0IG9yZy5hcGFjaGUubHVjZW5lLmRvY3Vt
ZW50LkRvY3VtZW50Ow0KaW1wb3J0IG9yZy5hcGFjaGUubHVjZW5lLmRvY3VtZW50LkZpZWxkOw0K
aW1wb3J0IG9yZy5hcGFjaGUubHVjZW5lLmluZGV4LkNvcnJ1cHRJbmRleEV4Y2VwdGlvbjsNCmlt
cG9ydCBvcmcuYXBhY2hlLmx1Y2VuZS5pbmRleC5JbmRleFJlYWRlcjsNCmltcG9ydCBvcmcuYXBh
Y2hlLmx1Y2VuZS5pbmRleC5JbmRleFdyaXRlcjsNCmltcG9ydCBvcmcuYXBhY2hlLmx1Y2VuZS5x
dWVyeVBhcnNlci5QYXJzZUV4Y2VwdGlvbjsNCmltcG9ydCBvcmcuYXBhY2hlLmx1Y2VuZS5xdWVy
eVBhcnNlci5RdWVyeVBhcnNlcjsNCmltcG9ydCBvcmcuYXBhY2hlLmx1Y2VuZS5zZWFyY2guSW5k
ZXhTZWFyY2hlcjsNCmltcG9ydCBvcmcuYXBhY2hlLmx1Y2VuZS5zZWFyY2guU2NvcmVEb2M7DQpp
bXBvcnQgb3JnLmFwYWNoZS5sdWNlbmUuc2VhcmNoLlNvcnQ7DQppbXBvcnQgb3JnLmFwYWNoZS5s
dWNlbmUuc2VhcmNoLlRvcERvY3M7DQppbXBvcnQgb3JnLmFwYWNoZS5sdWNlbmUuc3RvcmUuRGly
ZWN0b3J5Ow0KaW1wb3J0IG9yZy5hcGFjaGUubHVjZW5lLnN0b3JlLkZTRGlyZWN0b3J5Ow0KDQpp
bXBvcnQgZGF0YWJhc2UuQ3JpdGVyaWE7DQppbXBvcnQgZGF0YWJhc2UuUXVlcnlTdGF0aXN0aWNz
Ow0KaW1wb3J0IGRhdGFiYXNlLlF1ZXJ5U3RhdGlzdGljc1BlZXI7DQppbXBvcnQgZGF0YWJhc2Uu
U2Nyb2xsZXI7DQoNCi8qKg0KICogU2VhcmNoIHRlcm0gYXV0by1jb21wbGV0ZXIsIHdvcmtzIGZv
ciBzaW5nbGUgdGVybXMgKHNvIHVzZSBvbiB0aGUgbGFzdCB0ZXJtDQogKiBvZiB0aGUgcXVlcnkp
Lg0KICogPHA+DQogKiBSZXR1cm5zIG1vcmUgcG9wdWxhciB0ZXJtcyBmaXJzdC4NCiAqIA0KICog
QGF1dGhvciBNYXQgTWFubmlvbiwgTS5NYW5uaW9uQHdhcndpY2suYWMudWsNCiAqLw0KcHVibGlj
IGZpbmFsIGNsYXNzIEF1dG9Db21wbGV0ZXINCnsNCg0KICAgIHByaXZhdGUgc3RhdGljIGZpbmFs
IFN0cmluZyBHUkFNTUVEX1dPUkRTX0ZJRUxEID0gIndvcmRzIjsNCg0KICAgIHByaXZhdGUgc3Rh
dGljIGZpbmFsIFN0cmluZyBTT1VSQ0VfV09SRF9GSUVMRCA9ICJzb3VyY2VXb3JkIjsNCg0KICAg
IHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBDT1VOVF9GSUVMRCA9ICJjb3VudCI7DQoNCiAg
ICBwcml2YXRlIGZpbmFsIERpcmVjdG9yeSBhdXRvQ29tcGxldGVEaXJlY3Rvcnk7DQoNCiAgICBw
cml2YXRlIEluZGV4UmVhZGVyIGF1dG9Db21wbGV0ZVJlYWRlcjsNCg0KICAgIHByaXZhdGUgSW5k
ZXhTZWFyY2hlciBhdXRvQ29tcGxldGVTZWFyY2hlcjsNCg0KICAgIHB1YmxpYyBBdXRvQ29tcGxl
dGVyKFN0cmluZyBhdXRvQ29tcGxldGVEaXIpIHRocm93cyBFeGNlcHRpb24NCiAgICB7DQoJdGhp
cy5hdXRvQ29tcGxldGVEaXJlY3RvcnkgPSBGU0RpcmVjdG9yeS5nZXREaXJlY3RvcnkoYXV0b0Nv
bXBsZXRlRGlyKTsNCg0KCXJlT3BlblJlYWRlcigpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBMaXN0
PFN0cmluZz4gc3VnZ2VzdFRlcm1zRm9yKFN0cmluZyB0ZXJtKSB0aHJvd3MgSU9FeGNlcHRpb24s
IFBhcnNlRXhjZXB0aW9uDQogICAgew0KCVF1ZXJ5UGFyc2VyIHFwID0gbmV3IFF1ZXJ5UGFyc2Vy
KEdSQU1NRURfV09SRFNfRklFTEQsDQoJCSAgICBnZXRBbmFseXplcigpKTsNCgkgICAgcXAuc2V0
RGVmYXVsdE9wZXJhdG9yKFF1ZXJ5UGFyc2VyLk9SX09QRVJBVE9SKTsNCgkgICAgcXAuc2V0QWxs
b3dMZWFkaW5nV2lsZGNhcmQodHJ1ZSk7DQoJU29ydCBzb3J0ID0gbmV3IFNvcnQoQ09VTlRfRklF
TEQsIHRydWUpOw0KDQoJVG9wRG9jcyBkb2NzID0gYXV0b0NvbXBsZXRlU2VhcmNoZXIuc2VhcmNo
KHFwLnBhcnNlKHRlcm0pLCBudWxsLCAxMCwgc29ydCk7DQoJTGlzdDxTdHJpbmc+IHN1Z2dlc3Rp
b25zID0gbmV3IEFycmF5TGlzdDxTdHJpbmc+KCk7DQoJZm9yIChTY29yZURvYyBkb2MgOiBkb2Nz
LnNjb3JlRG9jcykNCgl7DQoJICAgIHN1Z2dlc3Rpb25zLmFkZChhdXRvQ29tcGxldGVSZWFkZXIu
ZG9jdW1lbnQoZG9jLmRvYykuZ2V0KFNPVVJDRV9XT1JEX0ZJRUxEKSk7DQoJfQ0KDQoJcmV0dXJu
IHN1Z2dlc3Rpb25zOw0KICAgIH0NCg0KICAgIHB1YmxpYyBBbmFseXplciBnZXRBbmFseXplcigp
DQogICAgew0KCXJldHVybiBuZXcgQW5hbHl6ZXIoKQ0KCXsNCgkgICAgcHVibGljIFRva2VuU3Ry
ZWFtIHRva2VuU3RyZWFtKFN0cmluZyBmaWVsZE5hbWUsIFJlYWRlciByZWFkZXIpDQoJICAgIHsN
CgkJVG9rZW5TdHJlYW0gcmVzdWx0ID0gbmV3IFN0YW5kYXJkVG9rZW5pemVyKHJlYWRlcik7DQoJ
CXJlc3VsdCA9IG5ldyBTdGFuZGFyZEZpbHRlcihyZXN1bHQpOw0KCQlyZXN1bHQgPSBuZXcgTG93
ZXJDYXNlRmlsdGVyKHJlc3VsdCk7DQoJCXJlc3VsdCA9IG5ldyBJU09MYXRpbjFBY2NlbnRGaWx0
ZXIocmVzdWx0KTsNCgkJcmVzdWx0ID0gbmV3IFN0b3BGaWx0ZXIocmVzdWx0LCBTdG9wQW5hbHl6
ZXIuRU5HTElTSF9TVE9QX1dPUkRTKTsNCgkJcmVzdWx0ID0gbmV3IFNub3diYWxsRmlsdGVyKHJl
c3VsdCwgIkVuZ2xpc2giKTsNCgkJcmVzdWx0ID0gbmV3IEVkZ2VOR3JhbVRva2VuRmlsdGVyKHJl
c3VsdCwgU2lkZS5GUk9OVCwgMSwgMjApOw0KCQlyZXR1cm4gcmVzdWx0Ow0KCSAgICB9DQoJfTsN
CiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCByZUluZGV4KCkgdGhyb3dzIEV4Y2VwdGlvbg0KICAg
IHsNCgkvLyBidWlsZCBhIGRpY3Rpb25hcnkgKGZyb20gdGhlIHNwZWxsIHBhY2thZ2UpDQoJQ3Jp
dGVyaWEgYyA9IG5ldyBDcml0ZXJpYSgpOw0KCVNjcm9sbGVyPFF1ZXJ5U3RhdGlzdGljcz4gc2Ny
byA9IFF1ZXJ5U3RhdGlzdGljc1BlZXIuZG9TZWxlY3QoYyk7DQoNCgkvLyB1c2UgYSBjdXN0b20g
YW5hbHl6ZXIgc28gd2UgY2FuIGRvIEVkZ2VOR3JhbUZpbHRlcmluZw0KCUluZGV4V3JpdGVyIHdy
aXRlciA9IG5ldyBJbmRleFdyaXRlcihhdXRvQ29tcGxldGVEaXJlY3RvcnksIGdldEFuYWx5emVy
KCksIHRydWUsDQoJCUluZGV4V3JpdGVyLk1heEZpZWxkTGVuZ3RoLlVOTElNSVRFRCk7DQoNCgl3
cml0ZXIuc2V0TWVyZ2VGYWN0b3IoMzAwKTsNCgl3cml0ZXIuc2V0TWF4QnVmZmVyZWREb2NzKDE1
MCk7DQoNCgkvLyBnbyB0aHJvdWdoIGV2ZXJ5IHdvcmQsIHN0b3JpbmcgdGhlIG9yaWdpbmFsIHdv
cmQgKGluY2wuIG4tZ3JhbXMpDQoJLy8gYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgaXQgb2NjdXJz
DQoNCglNYXA8U3RyaW5nLCBJbnRlZ2VyPiB3b3Jkc01hcCA9IG5ldyBIYXNoTWFwPFN0cmluZywg
SW50ZWdlcj4oKTsNCg0KCXdoaWxlIChzY3JvLmhhc05leHQoKSkNCgl7DQoJICAgIFF1ZXJ5U3Rh
dGlzdGljcyBxcyA9IHNjcm8ubmV4dCgpOw0KCSAgICBTdHJpbmcgd29yZCA9IHFzLmdldEtleXdv
cmQoKTsNCgkgICAgaW50IGxlbiA9IHdvcmQubGVuZ3RoKCk7DQoJICAgIGlmIChsZW4gPCAyKQ0K
CSAgICB7DQoJCWNvbnRpbnVlOw0KCSAgICB9DQoNCgkgICAgaWYgKHdvcmRzTWFwLmNvbnRhaW5z
S2V5KHdvcmQpKQ0KCQl3b3Jkc01hcC5wdXQod29yZCwgd29yZHNNYXAuZ2V0KHdvcmQpICsgMSk7
DQoJICAgIGVsc2UNCgkJd29yZHNNYXAucHV0KHdvcmQsIDEpOw0KCX0NCglmb3IgKFN0cmluZyB3
b3JkIDogd29yZHNNYXAua2V5U2V0KCkpDQoJew0KCSAgICAvLyBvayBpbmRleCB0aGUgd29yZA0K
CSAgICBEb2N1bWVudCBkb2MgPSBuZXcgRG9jdW1lbnQoKTsNCgkgICAgZG9jLmFkZChuZXcgRmll
bGQoU09VUkNFX1dPUkRfRklFTEQsIHdvcmQsIEZpZWxkLlN0b3JlLllFUywgRmllbGQuSW5kZXgu
Tk9UX0FOQUxZWkVEKSk7IC8vIG9yaWcNCgkgICAgLy8gdGVybQ0KCSAgICBkb2MuYWRkKG5ldyBG
aWVsZChHUkFNTUVEX1dPUkRTX0ZJRUxELCB3b3JkLCBGaWVsZC5TdG9yZS5ZRVMsIEZpZWxkLklu
ZGV4LkFOQUxZWkVEKSk7IC8vIGdyYW1tZWQNCgkgICAgZG9jLmFkZChuZXcgRmllbGQoQ09VTlRf
RklFTEQsIEludGVnZXIudG9TdHJpbmcod29yZHNNYXAuZ2V0KHdvcmQpKSwgRmllbGQuU3RvcmUu
WUVTLA0KCQkgICAgRmllbGQuSW5kZXguTk9UX0FOQUxZWkVEKSk7IC8vIGNvdW50DQoNCgkgICAg
d3JpdGVyLmFkZERvY3VtZW50KGRvYyk7DQoJfQ0KDQoJLy8gY2xvc2Ugd3JpdGVyDQoJd3JpdGVy
Lm9wdGltaXplKCk7DQoJd3JpdGVyLmNsb3NlKCk7DQoNCgkvLyByZS1vcGVuIG91ciByZWFkZXIN
CglyZU9wZW5SZWFkZXIoKTsNCiAgICB9DQoNCiAgICBwcml2YXRlIHZvaWQgcmVPcGVuUmVhZGVy
KCkgdGhyb3dzIENvcnJ1cHRJbmRleEV4Y2VwdGlvbiwgRXhjZXB0aW9uDQogICAgew0KCWlmIChh
dXRvQ29tcGxldGVSZWFkZXIgPT0gbnVsbCkNCgl7DQoJICAgIGlmICghSW5kZXhSZWFkZXIuaW5k
ZXhFeGlzdHMoYXV0b0NvbXBsZXRlRGlyZWN0b3J5KSkNCgkgICAgew0KCQlDcmF3bGVyTG9nZ2Vy
LmxvZ2dlci5pbmZvKCJEaWN0aW9uYXJ5IGluZGV4IG5vdCBleGlzdHMsIGluZGV4IG5vdyIpOw0K
CQlyZUluZGV4KCk7DQoJICAgIH0NCgkgICAgYXV0b0NvbXBsZXRlUmVhZGVyID0gSW5kZXhSZWFk
ZXIub3BlbihhdXRvQ29tcGxldGVEaXJlY3RvcnkpOw0KCX0NCgllbHNlDQoJew0KCSAgICBhdXRv
Q29tcGxldGVSZWFkZXIucmVvcGVuKCk7DQoJfQ0KDQoJYXV0b0NvbXBsZXRlU2VhcmNoZXIgPSBu
ZXcgSW5kZXhTZWFyY2hlcihhdXRvQ29tcGxldGVSZWFkZXIpOw0KICAgIH0NCg0KICAgIHB1Ymxp
YyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBFeGNlcHRpb24NCiAgICB7
DQoJQXV0b0NvbXBsZXRlciBhdXRvY29tcGxldGUgPSBuZXcgQXV0b0NvbXBsZXRlcigid3JhcHBl
ci9pbmRleC9kaWN0aW9uYXJ5Iik7DQoJU3RyaW5nIHRlcm0gPSAi55S16KeGIjsNCglTeXN0ZW0u
b3V0LnByaW50bG4oYXV0b2NvbXBsZXRlLnN1Z2dlc3RUZXJtc0Zvcih0ZXJtKSk7DQogICAgfQ0K
fQ0K

--0016362835a6a41fcf04671dfb05
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--0016362835a6a41fcf04671dfb05--

From java-user-return-39600-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 13:13:33 2009
Return-Path: <java-user-return-39600-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72377 invoked from network); 9 Apr 2009 13:13:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 13:13:32 -0000
Received: (qmail 40193 invoked by uid 500); 9 Apr 2009 13:13:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40108 invoked by uid 500); 9 Apr 2009 13:13:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40098 invoked by uid 99); 9 Apr 2009 13:13:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 13:13:29 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of isaacrc82@gmail.com designates 209.85.132.242 as permitted sender)
Received: from [209.85.132.242] (HELO an-out-0708.google.com) (209.85.132.242)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 13:13:23 +0000
Received: by an-out-0708.google.com with SMTP id b2so347044ana.5
        for <java-user@lucene.apache.org>; Thu, 09 Apr 2009 06:13:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=fnvi06e9RA304v3qhWgv3RRHRTwj/4Wx8+58FJjk2zE=;
        b=K6e8334cJzEntPp+x//yhcNhXxk9FwkClOuHnAl7BiWlZaZamxp2+M9s/bnCqaTt7Z
         FNhs/D47rImMqzPGC/518mp/RYbPfmbNdS1I1pm4pzO2/r0jfeOGwF1C9HRd6/c7Pb9k
         e+87KBVIAqufh2aaUW6aTSiSwrcvFDt95e9ts=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=KtJ/nWjSytSYSb3nRHhptBExOt46vurirRfoRSGrT5YKajdEYFDtqTVJk6Id8CGoQr
         lk2o9S/6S4GXlfYn8mXiOlUUKZSWCHFMOmyxchEDDl08V/9ABk3kCKQ85YrM4BuXiyK9
         fdT03pdYvvA3q3A7HXPR/O8PXahpmwA8VJ0V4=
MIME-Version: 1.0
Received: by 10.100.231.16 with SMTP id d16mr83077anh.93.1239282781205; Thu, 
	09 Apr 2009 06:13:01 -0700 (PDT)
Date: Thu, 9 Apr 2009 09:13:01 -0400
Message-ID: <bf1404350904090613g52e73064rfa3bdd0eed4ad20f@mail.gmail.com>
Subject: Problem with ranking in lucene
From: Ariel <isaacrc82@gmail.com>
To: lucene user <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=0016368e1f5ef33bff04671f015a
X-Virus-Checked: Checked by ClamAV on apache.org

--0016368e1f5ef33bff04671f015a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi everybody:

I have a question about the ranking of lucene. Here I have the problem: when
I do a search in my index like this: bank OR transference I get 10 results,
the first two documents that are returned have the both terms in the content
field but then the 3th, 4th and 5th only has the word bank and then the 6th
is a document that have both terms.
Why is this happening ?
It is not supposed that when I do a search with the OR operator it returned
first the documents that have the terms together and then the document that
only have one of the two terms ???
I am indexing by two fields and I am searching with MultifieldQuery in both
fields two: title and content, I am using the same analyzer for indexing and
searching.

I hope you can help me.
Thanks in advance
Regards
Ariel

--0016368e1f5ef33bff04671f015a--

From java-user-return-39601-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 14:00:20 2009
Return-Path: <java-user-return-39601-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98786 invoked from network); 9 Apr 2009 14:00:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 14:00:19 -0000
Received: (qmail 6179 invoked by uid 500); 9 Apr 2009 14:00:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6112 invoked by uid 500); 9 Apr 2009 14:00:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6102 invoked by uid 99); 9 Apr 2009 14:00:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 14:00:17 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a4.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 14:00:06 +0000
Received: from [192.168.0.102] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a4.g.dreamhost.com (Postfix) with ESMTP id 993D53B9E3
	for <java-user@lucene.apache.org>; Thu,  9 Apr 2009 06:59:42 -0700 (PDT)
Message-Id: <E4E1FCAA-247A-4FD1-BDAE-80413F4E5205@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <982656.13244.qm@web110205.mail.gq1.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Vector space implemantion
Date: Thu, 9 Apr 2009 09:59:41 -0400
References: <982656.13244.qm@web110205.mail.gq1.yahoo.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Assuming you want to handle the vectors yourself, as opposed to  
relying on the fact that Lucene itself implements the VSM, you should  
index your documents with TermVector.YES.  That will give you the term  
freq on a per doc basis, but you will have to use the TermEnum to get  
the Doc Freq.  All and all, this is not going to be very efficient for  
you, but you should be able to build up a matrix from it.

What is the problem you are trying to solve?



On Apr 9, 2009, at 2:33 AM, Andy wrote:

> Hello all,
>
> I'm trying to implement a vector space model using lucene. I need to  
> have a file (or on memory) with TF/IDF weight of each term in each  
> document. (in fact that is a matrix with documents presented as  
> vectors, in which the elements of each vector is the TF weight ...)
>
> Please Please help me on this
> contact me if you need any further info via andykan1984@yahoo.com
> Many Many thanks
>
>
>
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39602-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 14:24:51 2009
Return-Path: <java-user-return-39602-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14463 invoked from network); 9 Apr 2009 14:24:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 14:24:50 -0000
Received: (qmail 47614 invoked by uid 500); 9 Apr 2009 14:24:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47554 invoked by uid 500); 9 Apr 2009 14:24:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47544 invoked by uid 99); 9 Apr 2009 14:24:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 14:24:47 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 14:24:38 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LrvAu-0005uc-VA
	for java-user@lucene.apache.org; Thu, 09 Apr 2009 07:24:16 -0700
Message-ID: <22972033.post@talk.nabble.com>
Date: Thu, 9 Apr 2009 07:24:16 -0700 (PDT)
From: Konstantyn Smirnov <injecteer@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Suggestive Search
In-Reply-To: <s9dc5fe8.027@mail.btsb.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: injecteer@yahoo.com
References: <s9dc5fe8.027@mail.btsb.com>
X-Virus-Checked: Checked by ClamAV on apache.org


I implemented the suggestions-feature for a couple of web-sites.

an example can be seen on 
http://www.genios.de/r_firmen/webcgi?START=016&SEITE=firmenk_d.ein&DBN=&WID=01852-8850939-00904_3
genios.de .

type smth in in the Firma and Person fields.

The Firma-index has 3++ mio records, Person ~ 1.6 mio

-----
Project Lead
http://www.poiradar.ru www.poiradar.ru 
http://www.poiradar.com.ua www.poiradar.com.ua 
http://www.poiradar.com www.poiradar.com 
http://www.poiradar.de www.poiradar.de 
-- 
View this message in context: http://www.nabble.com/Suggestive-Search-tp22950433p22972033.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39603-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 16:58:06 2009
Return-Path: <java-user-return-39603-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92079 invoked from network); 9 Apr 2009 16:58:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 16:58:06 -0000
Received: (qmail 28835 invoked by uid 500); 9 Apr 2009 16:58:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28754 invoked by uid 500); 9 Apr 2009 16:58:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28744 invoked by uid 99); 9 Apr 2009 16:58:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 16:58:04 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a7.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 16:57:54 +0000
Received: from [192.168.0.102] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a7.g.dreamhost.com (Postfix) with ESMTP id 0A4055B674
	for <java-user@lucene.apache.org>; Thu,  9 Apr 2009 09:57:29 -0700 (PDT)
Message-Id: <FD39CB94-9B4A-4F40-A18F-25B1C9AA6780@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <bf1404350904090613g52e73064rfa3bdd0eed4ad20f@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Problem with ranking in lucene
Date: Thu, 9 Apr 2009 12:57:29 -0400
References: <bf1404350904090613g52e73064rfa3bdd0eed4ad20f@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Your best bet is to look into the explanations of each of these  
documents in the context of your query via the explain() method on the  
Searcher (IndexSearcher).  If I had to venture a guess, the docs w/  
only one term have a higher TF/IDF value (I would even venture to  
guess that they contain the word "transference" and not "bank").  It  
is also entirely possible that those docs are shorter or have a boost  
value.  The explain method should tell you why.

For a broader view of how to debug ranking issues, you might find http://www.lucidimagination.com/Community/Hear-from-the-Experts/Articles/Debugging-Relevance-Issues-Search 
  to be helpful.

HTH,
Grant

On Apr 9, 2009, at 9:13 AM, Ariel wrote:

> Hi everybody:
>
> I have a question about the ranking of lucene. Here I have the  
> problem: when
> I do a search in my index like this: bank OR transference I get 10  
> results,
> the first two documents that are returned have the both terms in the  
> content
> field but then the 3th, 4th and 5th only has the word bank and then  
> the 6th
> is a document that have both terms.
> Why is this happening ?
> It is not supposed that when I do a search with the OR operator it  
> returned
> first the documents that have the terms together and then the  
> document that
> only have one of the two terms ???
> I am indexing by two fields and I am searching with MultifieldQuery  
> in both
> fields two: title and content, I am using the same analyzer for  
> indexing and
> searching.
>
> I hope you can help me.
> Thanks in advance
> Regards
> Ariel

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39604-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 17:02:01 2009
Return-Path: <java-user-return-39604-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93657 invoked from network); 9 Apr 2009 17:02:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 17:02:01 -0000
Received: (qmail 33888 invoked by uid 500); 9 Apr 2009 17:01:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33811 invoked by uid 500); 9 Apr 2009 17:01:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33801 invoked by uid 99); 9 Apr 2009 17:01:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 17:01:58 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [67.195.8.181] (HELO web110205.mail.gq1.yahoo.com) (67.195.8.181)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 09 Apr 2009 17:01:50 +0000
Received: (qmail 67809 invoked by uid 60001); 9 Apr 2009 17:01:28 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1239296488; bh=iM8elOPQi3IW4kFtL8gTlMpxn2NJOnWFRRI2cGARzOc=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:Cc:MIME-Version:Content-Type; b=go15ybqKcWT8c/M3gXnnS9jlNAZIEw0AQmozWAcQp7AhT0KRsmNSkuGhlv15T59zVaBdCim2jvkhBKnOCWv781F0fWqxjrobHX925PrULqq94U+gl+aqEX6xlI/OZ+mRJd0epjUQn9EVDnmMdQNKf8lOTS7zKUe+OySJKHr89EE=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:Cc:MIME-Version:Content-Type;
  b=nMKOw+2SWBsNz5KKp/Zmch8FXYTUKZ/gri0YYUCghGzQqIFIctDNFKSjkWHNbt+mOCy//0Et6IUZ1x0v8+DxwzpxC26uJzwhZ2fK6wR+qV6CrrpD5Ch5brLZvgfTKwixi1rq5xXHp/n0+IVSyH4rRfVvOuJ7CM/v7h+P27/wQeA=;
Message-ID: <886472.67789.qm@web110205.mail.gq1.yahoo.com>
X-YMail-OSG: cZP9YgQVM1mw3hAQTtHFP.0sBdKAPqO.gvvM7CJFMt3KvpVNgy0v6UhIHymKZl3ePY4HnNibVS_lbUmcMiOVyAp1C60gTQlSlTycKUHlmE1.t9StSwTima29nsSmEMgcU7u6hwqtkrVN1nNKhbTJ6RrbN4tA9_GUQ9pLdzW6_FJTmhfdipyhansCBt4ModIfFrS.DVaj0N_nYF29BrEcmYL.i.GTETBItV_mjDBu5OUMkXZI55BZ0PVyZpxUdOT4ZhhsrkjamXl8PFkkkxkAFRabHg02yGsb78wKHY1nZGngMO5SgxnCvsplu9CuPra.Q2uEbHkBnVUQqNdXb1W0yXeubzfZvuQfRg--
Received: from [78.135.23.204] by web110205.mail.gq1.yahoo.com via HTTP; Thu, 09 Apr 2009 10:01:27 PDT
X-Mailer: YahooMailClassic/5.2.15 YahooMailWebService/0.7.289.1
Date: Thu, 9 Apr 2009 10:01:27 -0700 (PDT)
From: Andy <andykan1984@yahoo.com>
Subject: Re: Vector space implemantion
To: java-user@lucene.apache.org
Cc: gsingers@apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-590914010-1239296487=:67789"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-590914010-1239296487=:67789
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable


Well, I'm planning to have the term weights (assume in a matrix) and then u=
sing an adaptive learning system transform them into a new weights in such =
a way that index formed of these be optimized. Its just a test to see if th=
is hypothesis is working or not.


--- On Thu, 4/9/09, Grant Ingersoll <gsingers@apache.org> wrote:

From: Grant Ingersoll <gsingers@apache.org>
Subject: Re: Vector space implemantion
To: java-user@lucene.apache.org
Date: Thursday, April 9, 2009, 6:29 PM

Assuming you want to handle the vectors yourself, as opposed to relying on =
the fact that Lucene itself implements the VSM, you should index your docum=
ents with TermVector.YES.=A0 That will give you the term freq on a per doc =
basis, but you will have to use the TermEnum to get the Doc Freq.=A0 All an=
d all, this is not going to be very efficient for you, but you should be ab=
le to build up a matrix from it.

What is the problem you are trying to solve?



On Apr 9, 2009, at 2:33 AM, Andy wrote:

> Hello all,
>=20
> I'm trying to implement a vector space model using lucene. I need to have=
 a file (or on memory) with TF/IDF weight of each term in each document. (i=
n fact that is a matrix with documents presented as vectors, in which the e=
lements of each vector is the TF weight ...)
>=20
> Please Please help me on this
> contact me if you need any further info via andykan1984@yahoo.com
> Many Many thanks
>=20
>=20
>=20
>=20

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) using So=
lr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      
--0-590914010-1239296487=:67789--

From java-user-return-39605-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 17:10:15 2009
Return-Path: <java-user-return-39605-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97058 invoked from network); 9 Apr 2009 17:10:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 17:10:15 -0000
Received: (qmail 47878 invoked by uid 500); 9 Apr 2009 17:10:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47794 invoked by uid 500); 9 Apr 2009 17:10:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47784 invoked by uid 99); 9 Apr 2009 17:10:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 17:10:12 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 17:10:02 +0000
Received: by qyk8 with SMTP id 8so1178128qyk.29
        for <java-user@lucene.apache.org>; Thu, 09 Apr 2009 10:09:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=awMRSYzVi0iYVUI0B0Gpl+zW1QFQWqNwoIoVsnMUS/U=;
        b=fvisnTFCNGGNjs30BN6NXhjiiP24ru582BHUkf9MLG1YhzBxQJVY81QTwTGZ65Ly2P
         kT0mgqRjygf0TylGFM9CzEoFYJOqWz/QNIgrtZj0JxeWnxPyBxJ7Gh6AHxhgCSAnwiiO
         wG1z5+E0lee6bHBlP3Qsrcd5QFAL9QCo2jSLY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=QTZotX/pRzckxMfKHLfi6k3FRKcmSe4dY6tMLXX2d9b3TKNlpmvE4HzTrLn2t95sjY
         zO7ORkYy30GUjWXqBYLDBDDDXZrKnQHyQx58EwePa99oHNAn341zsbP1jvvNRsocRfEN
         e6ZOYEMwV9pjQ1HQM0Rb+nOXINq+a19qdHgQk=
MIME-Version: 1.0
Received: by 10.220.75.199 with SMTP id z7mr3630474vcj.112.1239296981805; Thu, 
	09 Apr 2009 10:09:41 -0700 (PDT)
In-Reply-To: <7d94dcde0904081809n9b0c790q4ca66c116b2431ff@mail.gmail.com>
References: <22953431.post@talk.nabble.com>
	 <499888440904080903y47f8d828j92dd419cde53ce99@mail.gmail.com>
	 <7d94dcde0904081809n9b0c790q4ca66c116b2431ff@mail.gmail.com>
Date: Thu, 9 Apr 2009 10:09:41 -0700
Message-ID: <359a92830904091009r230c24c8qea899d974118306c@mail.gmail.com>
Subject: Re: Query any data
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6476e725f2d97046722502a
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6476e725f2d97046722502a
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: quoted-printable

searching for fieldname:* will be *extremely* expensive as it will, by
default,
build a giant OR clause consisting of every term in the field. You'll throw
MaxClauses exceptions right and left. I'd follow Tim's thread lead first...=
.

Best
Erick

2009/4/8 =CD=F5=CE=A1=CE=A1 <ww.wang.cs@gmail.com>

> first you should change your querypaser to accept wildcard query by calli=
ng
> method of QueryParser
>          setAllowLeadingWildcard
> then you can query like this:  fieldname:*
>
> 2009/4/9 Tim Williams <williamstw@gmail.com>
>
> > On Wed, Apr 8, 2009 at 11:45 AM, addman <addiekong@yahoo.com> wrote:
> > >
> > > Hi,
> > >   Is it possible to create a query to search a field for any value?  =
I
> > just
> > > need to know if the optional field contain any data at all.
> >
> > google for:  lucene field existence
> >
> > There's no way built in, one strategy[1] is to have a 'meta field'
> > that contains the names of the fields the document contains.
> >
> > --tim
> >
> > [1] -
> > http://www.mail-archive.com/lucene-user@jakarta.apache.org/msg07703.htm=
l
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
> --
> =CD=F5=CE=A1=CE=A1(Weiwei Wang)
> Department of Computer Science
> Gulou Campus of Nanjing University
> Nanjing, P.R.China, 210093
>
> Mobile: 86-13913310569
> MSN: ww.wang.cs@gmail.com
> Homepage: http://cs.nju.edu.cn/rl/weiweiwang
>

--0016e6476e725f2d97046722502a--

From java-user-return-39606-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 17:23:32 2009
Return-Path: <java-user-return-39606-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4660 invoked from network); 9 Apr 2009 17:23:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 17:23:32 -0000
Received: (qmail 64313 invoked by uid 500); 9 Apr 2009 17:23:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64242 invoked by uid 500); 9 Apr 2009 17:23:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64232 invoked by uid 99); 9 Apr 2009 17:23:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 17:23:29 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 17:23:21 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lrxxs-0006tF-Gi
	for java-user@lucene.apache.org; Thu, 09 Apr 2009 10:23:00 -0700
Message-ID: <22975652.post@talk.nabble.com>
Date: Thu, 9 Apr 2009 10:23:00 -0700 (PDT)
From: John Seer <pulsphoto@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene help with query
In-Reply-To: <49DD3E83.6090008@r.email.ne.jp>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: pulsphoto@yahoo.com
References: <22959498.post@talk.nabble.com> <49DD3E83.6090008@r.email.ne.jp>
X-Virus-Checked: Checked by ClamAV on apache.org




Koji Sekiguchi-2 wrote:
> 
> If you omit norms when indexing the name field, you'll get same score
> back.
> 
> Koji
> 

During building I set omit norms, but result doesn't change at all. I am
still getting the same score



-- 
View this message in context: http://www.nabble.com/Lucene-help-with-query-tp22959498p22975652.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39607-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 18:09:06 2009
Return-Path: <java-user-return-39607-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39348 invoked from network); 9 Apr 2009 18:09:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 18:09:06 -0000
Received: (qmail 30924 invoked by uid 500); 9 Apr 2009 18:09:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30863 invoked by uid 500); 9 Apr 2009 18:09:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30853 invoked by uid 99); 9 Apr 2009 18:09:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 18:09:03 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.66] (HELO spunkymail-a14.g.dreamhost.com) (208.97.132.66)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 18:08:53 +0000
Received: from [192.168.0.102] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a14.g.dreamhost.com (Postfix) with ESMTP id BD4A7190E2C
	for <java-user@lucene.apache.org>; Thu,  9 Apr 2009 11:08:29 -0700 (PDT)
Message-Id: <16F71F9D-83EA-475D-806B-A13770C2815E@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <886472.67789.qm@web110205.mail.gq1.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Vector space implemantion
Date: Thu, 9 Apr 2009 14:08:28 -0400
References: <886472.67789.qm@web110205.mail.gq1.yahoo.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Sounds quite interesting.  You might be interested in http://wiki.apache.org/solr/TermVectorComponent 
.  If anything, the Solr code will show you how to do get the  
information out of the Lucene index.


On Apr 9, 2009, at 1:01 PM, Andy wrote:

>
> Well, I'm planning to have the term weights (assume in a matrix) and  
> then using an adaptive learning system transform them into a new  
> weights in such a way that index formed of these be optimized. Its  
> just a test to see if this hypothesis is working or not.
>
>
> --- On Thu, 4/9/09, Grant Ingersoll <gsingers@apache.org> wrote:
>
> From: Grant Ingersoll <gsingers@apache.org>
> Subject: Re: Vector space implemantion
> To: java-user@lucene.apache.org
> Date: Thursday, April 9, 2009, 6:29 PM
>
> Assuming you want to handle the vectors yourself, as opposed to  
> relying on the fact that Lucene itself implements the VSM, you  
> should index your documents with TermVector.YES.  That will give you  
> the term freq on a per doc basis, but you will have to use the  
> TermEnum to get the Doc Freq.  All and all, this is not going to be  
> very efficient for you, but you should be able to build up a matrix  
> from it.
>
> What is the problem you are trying to solve?
>
>
>
> On Apr 9, 2009, at 2:33 AM, Andy wrote:
>
>> Hello all,
>>
>> I'm trying to implement a vector space model using lucene. I need  
>> to have a file (or on memory) with TF/IDF weight of each term in  
>> each document. (in fact that is a matrix with documents presented  
>> as vectors, in which the elements of each vector is the TF  
>> weight ...)
>>
>> Please Please help me on this
>> contact me if you need any further info via andykan1984@yahoo.com
>> Many Many thanks
>>
>>
>>
>>
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
> using Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39608-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 19:57:17 2009
Return-Path: <java-user-return-39608-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79501 invoked from network); 9 Apr 2009 19:57:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 19:57:17 -0000
Received: (qmail 58505 invoked by uid 500); 9 Apr 2009 19:57:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58430 invoked by uid 500); 9 Apr 2009 19:57:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58420 invoked by uid 99); 9 Apr 2009 19:57:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 19:57:14 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [67.195.8.187] (HELO web110211.mail.gq1.yahoo.com) (67.195.8.187)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 09 Apr 2009 19:57:06 +0000
Received: (qmail 75696 invoked by uid 60001); 9 Apr 2009 19:56:44 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1239307004; bh=6F+6uFNFebynPnyjjPkkGITxIqLDzooOI/6THSmyDFY=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=iQSWFfRS0BlhJK7hN258NLSFlCMCuoz8FSElFMrmGsDG3bIY2qAb8dbVKOBTVKZmYCpa3K6uVluM0aSnzpFrRWSQQiKa6r0NlwFm0vT1X5PNVNpmAE4Wr6ioK/izWFf+V6/C7G49NPK+TfjvDIk4zoCqVMi6CjXX+1v1JaAE8lo=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=twK5NHO6WJZDePuhOomJ9E8CA6sQNh/GD6sJvMKig5uTnpHvDN62XxrdTFs3/irLDwblSYLJalPSQois6trdY4+PZEPNBcsg1cNJCzxnX/g9ERZm3kojY9Z2LhPjHJPkQopmiY7hLJCwICbirHuw8mE6k4DVMNEp3bjl22cJmIA=;
Message-ID: <531416.74512.qm@web110211.mail.gq1.yahoo.com>
X-YMail-OSG: OTiXpsUVM1lbiMhqk.ietaLDxxkqwGGfqHFyhY19L.piK8rHK3b.75hJJd4h6ii3SSWLrdjiY6.0L3N6Z.vRcD7XUJ9fyv2Zn07JgXJg9WQ2e3f2hsPpRyGW4ifugdXotbqRNPPPNBE0ZaIcnPG6pMMrgdOXcWmPmA0Eivj0zEtXaRzFi4z08Y3dUW40a15JhTOxxKH_8.GzDq9.ObVmU0y4AFT.sig8VUVib_73JSfl6GaS4r83KDviCxNnLKyZUBjla42GTZlf6UKXbmEN44A6rn28ahDnUo8tZkTZ_vkJHBNgTflV7iQ-
Received: from [78.135.23.204] by web110211.mail.gq1.yahoo.com via HTTP; Thu, 09 Apr 2009 12:56:44 PDT
X-Mailer: YahooMailClassic/5.2.15 YahooMailWebService/0.7.289.1
Date: Thu, 9 Apr 2009 12:56:44 -0700 (PDT)
From: Andy <andykan1984@yahoo.com>
Subject: Index in text format
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-147913564-1239307004=:74512"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-147913564-1239307004=:74512
Content-Type: text/plain; charset=us-ascii

Is there a way to have lucene to write index in a txt file?



      
--0-147913564-1239307004=:74512--

From java-user-return-39609-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 20:50:21 2009
Return-Path: <java-user-return-39609-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97822 invoked from network); 9 Apr 2009 20:50:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 20:50:21 -0000
Received: (qmail 25730 invoked by uid 500); 9 Apr 2009 20:50:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25642 invoked by uid 500); 9 Apr 2009 20:50:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25631 invoked by uid 99); 9 Apr 2009 20:50:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 20:50:18 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.27] (HELO smtp-vbr7.xs4all.nl) (194.109.24.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 20:50:08 +0000
Received: from k8u.localnet (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr7.xs4all.nl (8.13.8/8.13.8) with ESMTP id n39KnmDN018706
	for <java-user@lucene.apache.org>; Thu, 9 Apr 2009 22:49:48 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Index in text format
Date: Thu, 9 Apr 2009 22:49:50 +0200
User-Agent: KMail/1.10.4 (Linux/2.6.27-11-generic; KDE/4.1.4; i686; ; )
References: <531416.74512.qm@web110211.mail.gq1.yahoo.com>
In-Reply-To: <531416.74512.qm@web110211.mail.gq1.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
  boundary="Boundary-00=_u9l3JcsoJxEbYCR"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200904092249.50775.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

--Boundary-00=_u9l3JcsoJxEbYCR
Content-Type: text/plain;
  charset="iso-8859-15"
Content-Transfer-Encoding: 7bit

On Thursday 09 April 2009 21:56:44 Andy wrote:

> Is there a way to have lucene to write index in a txt file?

No. You could try a hexdump of the index file(s), but that isn't 
really human readable. Instead of that you may want to try Luke:
http://www.getopt.org/luke/

Regards,
Paul Elschot

--Boundary-00=_u9l3JcsoJxEbYCR--

From java-user-return-39610-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 22:46:47 2009
Return-Path: <java-user-return-39610-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5362 invoked from network); 9 Apr 2009 22:46:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 22:46:47 -0000
Received: (qmail 36148 invoked by uid 500); 9 Apr 2009 22:46:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36082 invoked by uid 500); 9 Apr 2009 22:46:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36063 invoked by uid 99); 9 Apr 2009 22:46:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 22:46:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 22:46:36 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 60E0071C2B6; Thu,  9 Apr 2009 15:46:15 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 5F17571C2B1
	for <java-user@lucene.apache.org>; Thu,  9 Apr 2009 15:46:15 -0700 (PDT)
Date: Thu, 9 Apr 2009 15:46:15 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Subject: Re: Help to determine why an optimized index is proportionaly too
 big.
In-Reply-To: <24098ED350C76D46A4FDBD81B51BE0E9034CB5E91B@exchange.windows.mmu.acquiremedia.com>
Message-ID: <Pine.LNX.4.64.0904091542330.31507@radix.cryptio.net>
References: <24098ED350C76D46A4FDBD81B51BE0E9034CB5E91B@exchange.windows.mmu.acquiremedia.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: The second stage index failed an optimization with a disk full exception 
: (I had to move it to another lucene machine with a larger disk partition 
: to complete the optimization. Is there a reason why a 22 day index would 
: be 10x the size of an 8 day index when the document indexing rate is 
: fairly constant? Also, is there a way to shrink the index without 
: regenerating it?

did you run CheckIndex after it failed to optimize the first time?  the 
failure may have left old temp files arround that aren't actually part of 
the index but are taking up space. 

(Actually: does CheckIndex warn about unused files in the index directory 
so people can clean them up? i'm not sure)

If all else fails: try using the IndexMerge tool to merge you existing 
index into an empty index, and see how big that new index is -- that tool 
will definitely only merge data in that's actually part of the index.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39611-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 23:16:51 2009
Return-Path: <java-user-return-39611-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10472 invoked from network); 9 Apr 2009 23:16:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 23:16:51 -0000
Received: (qmail 57718 invoked by uid 500); 9 Apr 2009 23:16:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57639 invoked by uid 500); 9 Apr 2009 23:16:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57629 invoked by uid 99); 9 Apr 2009 23:16:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 23:16:48 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 23:16:42 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id B610071C28A; Thu,  9 Apr 2009 16:16:21 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id B3D7871C268
	for <java-user@lucene.apache.org>; Thu,  9 Apr 2009 16:16:21 -0700 (PDT)
Date: Thu, 9 Apr 2009 16:16:21 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: SpellChecker AlreadyClosedException issue
In-Reply-To: <49D498F7.4090708@eworx.gr>
Message-ID: <Pine.LNX.4.64.0904091612370.31507@radix.cryptio.net>
References: <49D498F7.4090708@eworx.gr>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: My code looks like this:
: 
: Directory dir = null;
: try {
:    dir = FSDirectory.getDirectory("/path/to/dictionary");
:    SpellChecker spell = new SpellChecker(dir); // exception thrown here
:    // ...
:    dir.close();

: This code works, but in a highly concurrent situation AlreadyClosedException
: is being thrown when I try to instantiate the SpellChecker:
: org.apache.lucene.store.AlreadyClosedException: this Directory is closed

if an error only happens under high concurrent load, it suggests that 
perhaps you have multiple threads attempting to close the directory.  you 
haven't clarified whether "dir" is a local variable inside a method, or an 
instnace variable in an object which is getting reused by multiple 
threads -- so it's hard to guess.

: I use lucene-core-2.4.1.jar and lucene-spellchecker-2.4.1.jar and I can
: reproduce the error in both windows and linux.

if you have a fully exeuctable test case (instead of just an incomplete 
partial snippet) that you can share, people may be able to spot the 
problem, or at the very least run the test themselves to reproduce.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39612-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 23:28:14 2009
Return-Path: <java-user-return-39612-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13974 invoked from network); 9 Apr 2009 23:28:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 23:28:14 -0000
Received: (qmail 70756 invoked by uid 500); 9 Apr 2009 23:28:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70684 invoked by uid 500); 9 Apr 2009 23:28:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70674 invoked by uid 99); 9 Apr 2009 23:28:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 23:28:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 23:28:05 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 18B9C71C2D8; Thu,  9 Apr 2009 16:27:45 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 16A1E71C2C4
	for <java-user@lucene.apache.org>; Thu,  9 Apr 2009 16:27:45 -0700 (PDT)
Date: Thu, 9 Apr 2009 16:27:45 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Lucene Filtering
In-Reply-To: <22868930.post@talk.nabble.com>
Message-ID: <Pine.LNX.4.64.0904091626450.31507@radix.cryptio.net>
References: <22868930.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: How do you create a Lucene Filter to check if a field has a value?  It is
: part for a ChainedFilter that I am creating.


take a look at RangeFilter ... you want a RangeFilter on your field 
name where the upper and lower bounds are both null.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39613-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 23:33:31 2009
Return-Path: <java-user-return-39613-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14670 invoked from network); 9 Apr 2009 23:33:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 23:33:31 -0000
Received: (qmail 74579 invoked by uid 500); 9 Apr 2009 23:33:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74511 invoked by uid 500); 9 Apr 2009 23:33:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74501 invoked by uid 99); 9 Apr 2009 23:33:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 23:33:29 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.198.228] (HELO rv-out-0506.google.com) (209.85.198.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 23:33:22 +0000
Received: by rv-out-0506.google.com with SMTP id f6so705597rvb.5
        for <java-user@lucene.apache.org>; Thu, 09 Apr 2009 16:33:01 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.58.20 with SMTP id g20mr1050846wfa.191.1239319981540; Thu, 
	09 Apr 2009 16:33:01 -0700 (PDT)
In-Reply-To: <Pine.LNX.4.64.0904091542330.31507@radix.cryptio.net>
References: <24098ED350C76D46A4FDBD81B51BE0E9034CB5E91B@exchange.windows.mmu.acquiremedia.com>
	 <Pine.LNX.4.64.0904091542330.31507@radix.cryptio.net>
Date: Thu, 9 Apr 2009 19:33:01 -0400
Message-ID: <9ac0c6aa0904091633m3f0863fcqa50ddbf7db4da3f8@mail.gmail.com>
Subject: Re: Help to determine why an optimized index is proportionaly too 
	big.
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Apr 9, 2009 at 6:46 PM, Chris Hostetter
<hossman_lucene@fucit.org> wrote:
>
> : The second stage index failed an optimization with a disk full exceptio=
n
> : (I had to move it to another lucene machine with a larger disk partitio=
n
> : to complete the optimization. Is there a reason why a 22 day index woul=
d
> : be 10x the size of an 8 day index when the document indexing rate is
> : fairly constant? Also, is there a way to shrink the index without
> : regenerating it?
>
> did you run CheckIndex after it failed to optimize the first time? =A0the
> failure may have left old temp files arround that aren't actually part of
> the index but are taking up space.
>
> (Actually: does CheckIndex warn about unused files in the index directory
> so people can clean them up? i'm not sure)

Actually, it doesn't (it only checks the "live" index files).

But: IndexWriter will remove unreferenced files as soon as it's instantiate=
d.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39614-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 23:47:22 2009
Return-Path: <java-user-return-39614-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16894 invoked from network); 9 Apr 2009 23:47:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 23:47:22 -0000
Received: (qmail 83394 invoked by uid 500); 9 Apr 2009 23:47:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83333 invoked by uid 500); 9 Apr 2009 23:47:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83323 invoked by uid 99); 9 Apr 2009 23:47:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 23:47:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of koji@r.email.ne.jp designates 202.224.39.197 as permitted sender)
Received: from [202.224.39.197] (HELO mail1.asahi-net.or.jp) (202.224.39.197)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 23:47:10 +0000
Received: from koji-sekiguchi-no-macbook.local (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	by mail1.asahi-net.or.jp (Postfix) with ESMTP id 668E26FAAF
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 08:46:49 +0900 (JST)
Message-ID: <49DE88E8.9030204@r.email.ne.jp>
Date: Fri, 10 Apr 2009 08:46:48 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.21 (Macintosh/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene help with query
References: <22959498.post@talk.nabble.com> <49DD3E83.6090008@r.email.ne.jp> <22975652.post@talk.nabble.com>
In-Reply-To: <22975652.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

John Seer wrote:
>
> Koji Sekiguchi-2 wrote:
>   
>> If you omit norms when indexing the name field, you'll get same score
>> back.
>>
>> Koji
>>
>>     
>
> During building I set omit norms, but result doesn't change at all. I am
> still getting the same score
>   
I meant if you set nameField.setOmitNorms( true ), you'll get same score.
If you want different scores back, set that false (or do nothing 
regarding norms since default is false).
How does your code look like?


Koji


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39615-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 09 23:59:59 2009
Return-Path: <java-user-return-39615-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18953 invoked from network); 9 Apr 2009 23:59:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Apr 2009 23:59:59 -0000
Received: (qmail 94374 invoked by uid 500); 9 Apr 2009 23:59:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94286 invoked by uid 500); 9 Apr 2009 23:59:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94276 invoked by uid 99); 9 Apr 2009 23:59:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 23:59:56 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ksshams@gmail.com designates 209.85.146.179 as permitted sender)
Received: from [209.85.146.179] (HELO wa-out-1112.google.com) (209.85.146.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 09 Apr 2009 23:59:48 +0000
Received: by wa-out-1112.google.com with SMTP id l35so420162waf.5
        for <java-user@lucene.apache.org>; Thu, 09 Apr 2009 16:59:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=9yu1+rxiQOcanClWKPmM65RezY1sA1mmJmZhjxsox4Y=;
        b=IrNkQrPaxnQxsif0WIIS9aHUZwjMDXY//okP0cHeL/4+JwnUOajfR2fL14P01L6DD1
         vmscqIXQy/tGpLBdMAN6UTI3aLRYZXK8VxNU8RHv1sKvp/S1aqkmqVhC/QKnfyKVI74/
         ZKiWesIq7mJ+yVpnDOSXtmtQl3vFibXj3sd7s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=WhE31wIqmtU8NsPLj7EPBZGd1ClAy0BVC36qnzGHgTMhn2ch6s3BsBMIPWy/NxlZLY
         dNoG8pbQHfsSriE3SzNXL7lJX7PbsidUFyisgER8Tyj/lG3hKGwSZXxUG+srJHZtV3De
         KAvAXlXXDNsgaLuXhoWrgh4x9TT1QcwqdtcGo=
MIME-Version: 1.0
Received: by 10.114.36.4 with SMTP id j4mr1654322waj.119.1239321566868; Thu, 
	09 Apr 2009 16:59:26 -0700 (PDT)
Date: Thu, 9 Apr 2009 16:59:26 -0700
Message-ID: <6d6cf45b0904091659se193b03l9c5344e59fa05dc4@mail.gmail.com>
Subject: Exceptions in merge thread (while optimizing) causing problems with 
	subsequent reopens
From: Khawaja Shams <ksshams@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364585fcc1743f046728097c
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364585fcc1743f046728097c
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hello,
  I am having a problem with reopening the IndexReader with Lucene 2.4 ( I
updated to 2.4.1, but still no luck). The exception is preceded by an
exception in optimizing the index. I am not reopening the reader while the
commit or optimization is going on in the writer (optimizing happens in the
same thread, but much less often). The issues go away once I turn off
optimizations. I was also getting this problem before I turned off the use
of compound files. I would appreciate any guidance.

Thanks!

Regards,
Khawaja


2009-04-09 15:57:47,033 (941820) [Index Maint Thread] ERROR
gov.nasa.ensemble.core.indexer.Indexer  - java.io.IOException: background
merge hit exception: _8:C41258 _9:C11382 into _a [optimize]
java.io.IOException: background merge hit exception: _8:C41258 _9:C11382
into _a [optimize]
    at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
    at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
    at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
    at
gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java:102)
Caused by: org.apache.lucene.index.CorruptIndexException: doc counts differ
for segment _8: fieldsReader shows 30074 but segmentInfo shows 41258
    at
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:362)
    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
    at
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
    at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
    at
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
    at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
Exception in thread "Lucene Merge Thread #0"
org.apache.lucene.index.MergePolicy$MergeException:
org.apache.lucene.index.CorruptIndexException: doc counts differ for segment
_8: fieldsReader shows 30074 but segmentInfo shows 41258
    at
org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
    at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
Caused by: org.apache.lucene.index.CorruptIndexException: doc counts differ
for segment _8: fieldsReader shows 30074 but segmentInfo shows 41258
    at
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:362)
    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
    at
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
    at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
    at
org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
    at
org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
2009-04-09 15:57:52,814 (947601) [Index Maint Thread] ERROR
gov.nasa.ensemble.core.indexer.Indexer  - java.io.FileNotFoundException:
/opt/users/merops/index/_a.fnm (No such file or directory)
java.io.FileNotFoundException: /opt/users/merops/index/_a.fnm (No such file
or directory)
    at java.io.RandomAccessFile.open(Native Method)
    at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
    at
org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
    at
org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
    at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
    at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:482)
    at org.apache.lucene.index.FieldInfos.<init>(FieldInfos.java:58)
    at
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:341)
    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:269)
    at
org.apache.lucene.index.MultiSegmentReader.doReopen(MultiSegmentReader.java:201)
    at
org.apache.lucene.index.DirectoryIndexReader$2.doBody(DirectoryIndexReader.java:157)
    at
org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:653)
    at
org.apache.lucene.index.DirectoryIndexReader.reopen(DirectoryIndexReader.java:179)
    at
gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java:106)

--0016364585fcc1743f046728097c--

From java-user-return-39616-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 00:03:24 2009
Return-Path: <java-user-return-39616-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20964 invoked from network); 10 Apr 2009 00:03:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 00:03:24 -0000
Received: (qmail 98339 invoked by uid 500); 10 Apr 2009 00:03:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98266 invoked by uid 500); 10 Apr 2009 00:03:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98256 invoked by uid 99); 10 Apr 2009 00:03:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 00:03:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.123.65.155] (HELO mail2.acquiremedia.com) (209.123.65.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 00:03:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail2.acquiremedia.com (Postfix) with ESMTP id 817575AC00F
	for <java-user@lucene.apache.org>; Thu,  9 Apr 2009 20:02:54 -0400 (EDT)
X-Virus-Scanned: amavisd-new at mmu.acquiremedia.com
Received: from mail2.acquiremedia.com ([127.0.0.1])
	by localhost (mail.mmu.acquiremedia.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id ClWbv7nqEWwF for <java-user@lucene.apache.org>;
	Thu,  9 Apr 2009 20:02:54 -0400 (EDT)
Received: from exchange.mmu.acquiremedia.com (unknown [10.10.40.251])
	by mail2.acquiremedia.com (Postfix) with ESMTP
	for <java-user@lucene.apache.org>; Thu,  9 Apr 2009 20:02:54 -0400 (EDT)
Received: from exchange.windows.mmu.acquiremedia.com ([10.10.40.251]) by
 exchange.windows.mmu.acquiremedia.com ([10.10.40.251]) with mapi; Thu, 9 Apr
 2009 20:02:54 -0400
From: Dan OConnor <doconnor@acquiremedia.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Thu, 9 Apr 2009 20:02:52 -0400
Subject: RE: Help to determine why an optimized index is proportionaly too
 big.
Thread-Topic: Help to determine why an optimized index is proportionaly too
 big.
Thread-Index: Acm5ZRC92qVhdhFHRhWu4Gf2AztA2wACoAPw
Message-ID: <24098ED350C76D46A4FDBD81B51BE0E90354B42FBA@exchange.windows.mmu.acquiremedia.com>
References: <24098ED350C76D46A4FDBD81B51BE0E9034CB5E91B@exchange.windows.mmu.acquiremedia.com>
 <Pine.LNX.4.64.0904091542330.31507@radix.cryptio.net>
In-Reply-To: <Pine.LNX.4.64.0904091542330.31507@radix.cryptio.net>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks for the feed back Chris.

Can you (or someone else on the list) tell me about the IndexMerge tool?

Thanks
Dan


-----Original Message-----
From: Chris Hostetter [mailto:hossman_lucene@fucit.org]=20
Sent: Thursday, April 09, 2009 6:46 PM
To: java-user@lucene.apache.org
Subject: Re: Help to determine why an optimized index is proportionaly too =
big.


: The second stage index failed an optimization with a disk full exception=
=20
: (I had to move it to another lucene machine with a larger disk partition=
=20
: to complete the optimization. Is there a reason why a 22 day index would=
=20
: be 10x the size of an 8 day index when the document indexing rate is=20
: fairly constant? Also, is there a way to shrink the index without=20
: regenerating it?

did you run CheckIndex after it failed to optimize the first time?  the=20
failure may have left old temp files arround that aren't actually part of=20
the index but are taking up space.=20

(Actually: does CheckIndex warn about unused files in the index directory=20
so people can clean them up? i'm not sure)

If all else fails: try using the IndexMerge tool to merge you existing=20
index into an empty index, and see how big that new index is -- that tool=20
will definitely only merge data in that's actually part of the index.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39617-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 00:06:24 2009
Return-Path: <java-user-return-39617-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21317 invoked from network); 10 Apr 2009 00:06:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 00:06:24 -0000
Received: (qmail 1745 invoked by uid 500); 10 Apr 2009 00:06:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1647 invoked by uid 500); 10 Apr 2009 00:06:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1637 invoked by uid 99); 10 Apr 2009 00:06:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 00:06:21 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.198.233] (HELO rv-out-0506.google.com) (209.85.198.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 00:06:14 +0000
Received: by rv-out-0506.google.com with SMTP id f6so712839rvb.5
        for <java-user@lucene.apache.org>; Thu, 09 Apr 2009 17:05:53 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.58.20 with SMTP id g20mr1067913wfa.1.1239321953626; Thu, 
	09 Apr 2009 17:05:53 -0700 (PDT)
In-Reply-To: <6d6cf45b0904091659se193b03l9c5344e59fa05dc4@mail.gmail.com>
References: <6d6cf45b0904091659se193b03l9c5344e59fa05dc4@mail.gmail.com>
Date: Thu, 9 Apr 2009 20:05:53 -0400
Message-ID: <9ac0c6aa0904091705v17e53cdfv8a93be9a55843850@mail.gmail.com>
Subject: Re: Exceptions in merge thread (while optimizing) causing problems 
	with subsequent reopens
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

These are serious corruption exceptions.

Is it at all possible two writers are accessing the index at the same time?

Can you describe more about how you're using Lucene?

Mike

On Thu, Apr 9, 2009 at 7:59 PM, Khawaja Shams <ksshams@gmail.com> wrote:
> Hello,
> =A0I am having a problem with reopening the IndexReader with Lucene 2.4 (=
 I
> updated to 2.4.1, but still no luck). The exception is preceded by an
> exception in optimizing the index. I am not reopening the reader while th=
e
> commit or optimization is going on in the writer (optimizing happens in t=
he
> same thread, but much less often). The issues go away once I turn off
> optimizations. I was also getting this problem before I turned off the us=
e
> of compound files. I would appreciate any guidance.
>
> Thanks!
>
> Regards,
> Khawaja
>
>
> 2009-04-09 15:57:47,033 (941820) [Index Maint Thread] ERROR
> gov.nasa.ensemble.core.indexer.Indexer =A0- java.io.IOException: backgrou=
nd
> merge hit exception: _8:C41258 _9:C11382 into _a [optimize]
> java.io.IOException: background merge hit exception: _8:C41258 _9:C11382
> into _a [optimize]
> =A0 =A0at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2=
273)
> =A0 =A0at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2=
218)
> =A0 =A0at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2=
198)
> =A0 =A0at
> gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java:=
102)
> Caused by: org.apache.lucene.index.CorruptIndexException: doc counts diff=
er
> for segment _8: fieldsReader shows 30074 but segmentInfo shows 41258
> =A0 =A0at
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:362)
> =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:30=
6)
> =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:26=
0)
> =A0 =A0at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884=
)
> =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
cheduler.java:205)
> =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntMergeScheduler.java:260)
> Exception in thread "Lucene Merge Thread #0"
> org.apache.lucene.index.MergePolicy$MergeException:
> org.apache.lucene.index.CorruptIndexException: doc counts differ for segm=
ent
> _8: fieldsReader shows 30074 but segmentInfo shows 41258
> =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Con=
currentMergeScheduler.java:309)
> =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntMergeScheduler.java:286)
> Caused by: org.apache.lucene.index.CorruptIndexException: doc counts diff=
er
> for segment _8: fieldsReader shows 30074 but segmentInfo shows 41258
> =A0 =A0at
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:362)
> =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:30=
6)
> =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:26=
0)
> =A0 =A0at
> org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884=
)
> =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeS=
cheduler.java:205)
> =A0 =A0at
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurre=
ntMergeScheduler.java:260)
> 2009-04-09 15:57:52,814 (947601) [Index Maint Thread] ERROR
> gov.nasa.ensemble.core.indexer.Indexer =A0- java.io.FileNotFoundException=
:
> /opt/users/merops/index/_a.fnm (No such file or directory)
> java.io.FileNotFoundException: /opt/users/merops/index/_a.fnm (No such fi=
le
> or directory)
> =A0 =A0at java.io.RandomAccessFile.open(Native Method)
> =A0 =A0at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
> =A0 =A0at
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDire=
ctory.java:552)
> =A0 =A0at
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:=
582)
> =A0 =A0at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:=
488)
> =A0 =A0at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:=
482)
> =A0 =A0at org.apache.lucene.index.FieldInfos.<init>(FieldInfos.java:58)
> =A0 =A0at
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:341)
> =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:30=
6)
> =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:26=
9)
> =A0 =A0at
> org.apache.lucene.index.MultiSegmentReader.doReopen(MultiSegmentReader.ja=
va:201)
> =A0 =A0at
> org.apache.lucene.index.DirectoryIndexReader$2.doBody(DirectoryIndexReade=
r.java:157)
> =A0 =A0at
> org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.ja=
va:653)
> =A0 =A0at
> org.apache.lucene.index.DirectoryIndexReader.reopen(DirectoryIndexReader.=
java:179)
> =A0 =A0at
> gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java:=
106)
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39618-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 00:17:28 2009
Return-Path: <java-user-return-39618-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23683 invoked from network); 10 Apr 2009 00:17:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 00:17:27 -0000
Received: (qmail 9724 invoked by uid 500); 10 Apr 2009 00:17:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9640 invoked by uid 500); 10 Apr 2009 00:17:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9630 invoked by uid 99); 10 Apr 2009 00:17:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 00:17:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of koji@r.email.ne.jp designates 202.224.39.198 as permitted sender)
Received: from [202.224.39.198] (HELO mail2.asahi-net.or.jp) (202.224.39.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 00:17:17 +0000
Received: from koji-sekiguchi-no-macbook.local (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	by mail2.asahi-net.or.jp (Postfix) with ESMTP id 912E672724
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 09:16:56 +0900 (JST)
Message-ID: <49DE8FF8.4040409@r.email.ne.jp>
Date: Fri, 10 Apr 2009 09:16:56 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.21 (Macintosh/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Help to determine why an optimized index is proportionaly too
 big.
References: <24098ED350C76D46A4FDBD81B51BE0E9034CB5E91B@exchange.windows.mmu.acquiremedia.com> <Pine.LNX.4.64.0904091542330.31507@radix.cryptio.net> <24098ED350C76D46A4FDBD81B51BE0E90354B42FBA@exchange.windows.mmu.acquiremedia.com>
In-Reply-To: <24098ED350C76D46A4FDBD81B51BE0E90354B42FBA@exchange.windows.mmu.acquiremedia.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Dan OConnor wrote:
> Thanks for the feed back Chris.
>
> Can you (or someone else on the list) tell me about the IndexMerge tool?
>
>   
Please see:
http://hudson.zones.apache.org/hudson/job/Lucene-trunk/javadoc/org/apache/lucene/misc/IndexMergeTool.html

Koji


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39619-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 00:33:51 2009
Return-Path: <java-user-return-39619-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33182 invoked from network); 10 Apr 2009 00:33:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 00:33:50 -0000
Received: (qmail 17994 invoked by uid 500); 10 Apr 2009 00:33:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17915 invoked by uid 500); 10 Apr 2009 00:33:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17905 invoked by uid 99); 10 Apr 2009 00:33:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 00:33:48 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ksshams@gmail.com designates 209.85.146.180 as permitted sender)
Received: from [209.85.146.180] (HELO wa-out-1112.google.com) (209.85.146.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 00:33:40 +0000
Received: by wa-out-1112.google.com with SMTP id l35so424821waf.5
        for <java-user@lucene.apache.org>; Thu, 09 Apr 2009 17:33:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=olsibSV0z+2mTQkd3X04NCSH6NbtqnrCizImmtZbUVI=;
        b=MBYj9c6ShKpb90FlPVHn68KOxMm96OoY9IXjASKVoKcsJV23YlIcWW/IgELUno4yfj
         gvBhMLeKJ7dnEvQtwRMKZh3uX2P/a/yVnFs5FV8GXdZZkSITzVZpD3SRd9dfBHI5vbkr
         pKfGCdQspJjDpUPkr2DcTN3BTcdV9wZgppLD8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=daztFuHJUiGgZrTXqh2wLDBj8fdCFbYY9KvBnIcOmEzP/NTl1VSPB2WZ7mODNEZx6R
         8HcmH2StOhLJhSFfP8UwfK4YSdvvkbUP53ovIsHH15bkjy9XnEJGI1O1qfX54eknVESt
         JAHGx9D9vnNKF4HeXjOx7JxVmwd4+ngLzq/nA=
MIME-Version: 1.0
Received: by 10.114.125.15 with SMTP id x15mr1651241wac.217.1239323598521; 
	Thu, 09 Apr 2009 17:33:18 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904091705v17e53cdfv8a93be9a55843850@mail.gmail.com>
References: <6d6cf45b0904091659se193b03l9c5344e59fa05dc4@mail.gmail.com>
	 <9ac0c6aa0904091705v17e53cdfv8a93be9a55843850@mail.gmail.com>
Date: Thu, 9 Apr 2009 17:33:18 -0700
Message-ID: <6d6cf45b0904091733n569bf2e6l98b31d3d8c071745@mail.gmail.com>
Subject: Re: Exceptions in merge thread (while optimizing) causing problems 
	with subsequent reopens
From: Khawaja Shams <ksshams@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636457d9eda046c0467288247
X-Virus-Checked: Checked by ClamAV on apache.org

--001636457d9eda046c0467288247
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Michael,
  Thanks for the quick response. I only have one IndexWriter, and there are
no other processes accessing this particular index. I have tried deleting
the entire index and reconstructing it, but the index corruption is
repeatable. Incidentally, there are no new writes since the last commit when
the merge happens. I have over-padded my code with ReadWrite locks to make
sure that no writes/read are happening between the commits, optimizations,
and reopening of the index.


Here is a snippet of the thread I use to maintain the Index ( I hope that I
am not doing something terribly wrong):
            while (true) {
                try {
                    getWriteLock();
                    indexWriter.commit();
                   if (shouldOptimize()) {
                       indexWriter.optimize();
                    }

                    IndexReader oldIR = indexSearcher.getIndexReader();
                    IndexReader ir = oldIR.reopen();
                    if (ir != oldIR) {
                        IndexSearcher oldIS = indexSearcher;
                        indexSearcher = new IndexSearcher(ir);
                        oldIS.close();
                        oldIR.close();
                } catch (Throwable t) {
                    trace.error(t, t);
                } finally {
                    releaseWriteLock();
                }


Regards,
Khawaja

On Thu, Apr 9, 2009 at 5:05 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> These are serious corruption exceptions.
>
> Is it at all possible two writers are accessing the index at the same time?
>
> Can you describe more about how you're using Lucene?
>
> Mike
>
> On Thu, Apr 9, 2009 at 7:59 PM, Khawaja Shams <ksshams@gmail.com> wrote:
> > Hello,
> >  I am having a problem with reopening the IndexReader with Lucene 2.4 ( I
> > updated to 2.4.1, but still no luck). The exception is preceded by an
> > exception in optimizing the index. I am not reopening the reader while
> the
> > commit or optimization is going on in the writer (optimizing happens in
> the
> > same thread, but much less often). The issues go away once I turn off
> > optimizations. I was also getting this problem before I turned off the
> use
> > of compound files. I would appreciate any guidance.
> >
> > Thanks!
> >
> > Regards,
> > Khawaja
> >
> >
> > 2009-04-09 15:57:47,033 (941820) [Index Maint Thread] ERROR
> > gov.nasa.ensemble.core.indexer.Indexer  - java.io.IOException: background
> > merge hit exception: _8:C41258 _9:C11382 into _a [optimize]
> > java.io.IOException: background merge hit exception: _8:C41258 _9:C11382
> > into _a [optimize]
> >    at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
> >    at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
> >    at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
> >    at
> >
> gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java:102)
> > Caused by: org.apache.lucene.index.CorruptIndexException: doc counts
> differ
> > for segment _8: fieldsReader shows 30074 but segmentInfo shows 41258
> >    at
> > org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:362)
> >    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> >    at
> > org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> >    at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> >    at
> >
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
> >    at
> >
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
> > Exception in thread "Lucene Merge Thread #0"
> > org.apache.lucene.index.MergePolicy$MergeException:
> > org.apache.lucene.index.CorruptIndexException: doc counts differ for
> segment
> > _8: fieldsReader shows 30074 but segmentInfo shows 41258
> >    at
> >
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
> >    at
> >
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
> > Caused by: org.apache.lucene.index.CorruptIndexException: doc counts
> differ
> > for segment _8: fieldsReader shows 30074 but segmentInfo shows 41258
> >    at
> > org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:362)
> >    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> >    at
> > org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> >    at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> >    at
> >
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
> >    at
> >
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
> > 2009-04-09 15:57:52,814 (947601) [Index Maint Thread] ERROR
> > gov.nasa.ensemble.core.indexer.Indexer  - java.io.FileNotFoundException:
> > /opt/users/merops/index/_a.fnm (No such file or directory)
> > java.io.FileNotFoundException: /opt/users/merops/index/_a.fnm (No such
> file
> > or directory)
> >    at java.io.RandomAccessFile.open(Native Method)
> >    at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
> >    at
> >
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
> >    at
> >
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
> >    at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> >    at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:482)
> >    at org.apache.lucene.index.FieldInfos.<init>(FieldInfos.java:58)
> >    at
> > org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:341)
> >    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:269)
> >    at
> >
> org.apache.lucene.index.MultiSegmentReader.doReopen(MultiSegmentReader.java:201)
> >    at
> >
> org.apache.lucene.index.DirectoryIndexReader$2.doBody(DirectoryIndexReader.java:157)
> >    at
> >
> org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:653)
> >    at
> >
> org.apache.lucene.index.DirectoryIndexReader.reopen(DirectoryIndexReader.java:179)
> >    at
> >
> gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java:106)
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636457d9eda046c0467288247--

From java-user-return-39620-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 00:44:55 2009
Return-Path: <java-user-return-39620-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34534 invoked from network); 10 Apr 2009 00:44:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 00:44:54 -0000
Received: (qmail 28428 invoked by uid 500); 10 Apr 2009 00:44:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28354 invoked by uid 500); 10 Apr 2009 00:44:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28341 invoked by uid 99); 10 Apr 2009 00:44:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 00:44:52 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.175] (HELO wf-out-1314.google.com) (209.85.200.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 00:44:42 +0000
Received: by wf-out-1314.google.com with SMTP id 29so911677wff.20
        for <java-user@lucene.apache.org>; Thu, 09 Apr 2009 17:44:21 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.135.16 with SMTP id i16mr1071432wfd.192.1239324260952; 
	Thu, 09 Apr 2009 17:44:20 -0700 (PDT)
In-Reply-To: <6d6cf45b0904091733n569bf2e6l98b31d3d8c071745@mail.gmail.com>
References: <6d6cf45b0904091659se193b03l9c5344e59fa05dc4@mail.gmail.com>
	 <9ac0c6aa0904091705v17e53cdfv8a93be9a55843850@mail.gmail.com>
	 <6d6cf45b0904091733n569bf2e6l98b31d3d8c071745@mail.gmail.com>
Date: Thu, 9 Apr 2009 20:44:20 -0400
Message-ID: <9ac0c6aa0904091744x185f3737g707490068ba56057@mail.gmail.com>
Subject: Re: Exceptions in merge thread (while optimizing) causing problems 
	with subsequent reopens
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

That code looks right.  Are there multiple threads that may enter it?

Can you show the code where you create the IndexWriter, add docs, etc?

Can you call IndexWriter.setInfoStream for the entire life of the
index, up until when the optimize error happens, and post back?

Mike

On Thu, Apr 9, 2009 at 8:33 PM, Khawaja Shams <ksshams@gmail.com> wrote:
> Hi Michael,
> =A0Thanks for the quick response. I only have one IndexWriter, and there =
are
> no other processes accessing this particular index. I have tried deleting
> the entire index and reconstructing it, but the index corruption is
> repeatable. Incidentally, there are no new writes since the last commit w=
hen
> the merge happens. I have over-padded my code with ReadWrite locks to mak=
e
> sure that no writes/read are happening between the commits, optimizations=
,
> and reopening of the index.
>
>
> Here is a snippet of the thread I use to maintain the Index ( I hope that=
 I
> am not doing something terribly wrong):
> =A0 =A0 =A0 =A0 =A0 =A0while (true) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0getWriteLock();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0indexWriter.commit();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 if (shouldOptimize()) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 indexWriter.optimize();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexReader oldIR =3D indexSearche=
r.getIndexReader();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexReader ir =3D oldIR.reopen();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (ir !=3D oldIR) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexSearcher oldIS =3D in=
dexSearcher;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0indexSearcher =3D new Inde=
xSearcher(ir);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0oldIS.close();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0oldIR.close();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Throwable t) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0trace.error(t, t);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} finally {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0releaseWriteLock();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>
>
> Regards,
> Khawaja
>
> On Thu, Apr 9, 2009 at 5:05 PM, Michael McCandless <
> lucene@mikemccandless.com> wrote:
>
>> These are serious corruption exceptions.
>>
>> Is it at all possible two writers are accessing the index at the same ti=
me?
>>
>> Can you describe more about how you're using Lucene?
>>
>> Mike
>>
>> On Thu, Apr 9, 2009 at 7:59 PM, Khawaja Shams <ksshams@gmail.com> wrote:
>> > Hello,
>> > =A0I am having a problem with reopening the IndexReader with Lucene 2.=
4 ( I
>> > updated to 2.4.1, but still no luck). The exception is preceded by an
>> > exception in optimizing the index. I am not reopening the reader while
>> the
>> > commit or optimization is going on in the writer (optimizing happens i=
n
>> the
>> > same thread, but much less often). The issues go away once I turn off
>> > optimizations. I was also getting this problem before I turned off the
>> use
>> > of compound files. I would appreciate any guidance.
>> >
>> > Thanks!
>> >
>> > Regards,
>> > Khawaja
>> >
>> >
>> > 2009-04-09 15:57:47,033 (941820) [Index Maint Thread] ERROR
>> > gov.nasa.ensemble.core.indexer.Indexer =A0- java.io.IOException: backg=
round
>> > merge hit exception: _8:C41258 _9:C11382 into _a [optimize]
>> > java.io.IOException: background merge hit exception: _8:C41258 _9:C113=
82
>> > into _a [optimize]
>> > =A0 =A0at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.jav=
a:2273)
>> > =A0 =A0at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.jav=
a:2218)
>> > =A0 =A0at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.jav=
a:2198)
>> > =A0 =A0at
>> >
>> gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java=
:102)
>> > Caused by: org.apache.lucene.index.CorruptIndexException: doc counts
>> differ
>> > for segment _8: fieldsReader shows 30074 but segmentInfo shows 41258
>> > =A0 =A0at
>> > org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:36=
2)
>> > =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java=
:306)
>> > =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java=
:260)
>> > =A0 =A0at
>> > org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>> > =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3=
884)
>> > =A0 =A0at
>> >
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerge=
Scheduler.java:205)
>> > =A0 =A0at
>> >
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr=
entMergeScheduler.java:260)
>> > Exception in thread "Lucene Merge Thread #0"
>> > org.apache.lucene.index.MergePolicy$MergeException:
>> > org.apache.lucene.index.CorruptIndexException: doc counts differ for
>> segment
>> > _8: fieldsReader shows 30074 but segmentInfo shows 41258
>> > =A0 =A0at
>> >
>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Co=
ncurrentMergeScheduler.java:309)
>> > =A0 =A0at
>> >
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr=
entMergeScheduler.java:286)
>> > Caused by: org.apache.lucene.index.CorruptIndexException: doc counts
>> differ
>> > for segment _8: fieldsReader shows 30074 but segmentInfo shows 41258
>> > =A0 =A0at
>> > org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:36=
2)
>> > =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java=
:306)
>> > =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java=
:260)
>> > =A0 =A0at
>> > org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
>> > =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3=
884)
>> > =A0 =A0at
>> >
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerge=
Scheduler.java:205)
>> > =A0 =A0at
>> >
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr=
entMergeScheduler.java:260)
>> > 2009-04-09 15:57:52,814 (947601) [Index Maint Thread] ERROR
>> > gov.nasa.ensemble.core.indexer.Indexer =A0- java.io.FileNotFoundExcept=
ion:
>> > /opt/users/merops/index/_a.fnm (No such file or directory)
>> > java.io.FileNotFoundException: /opt/users/merops/index/_a.fnm (No such
>> file
>> > or directory)
>> > =A0 =A0at java.io.RandomAccessFile.open(Native Method)
>> > =A0 =A0at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
>> > =A0 =A0at
>> >
>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDir=
ectory.java:552)
>> > =A0 =A0at
>> >
>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java=
:582)
>> > =A0 =A0at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.ja=
va:488)
>> > =A0 =A0at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.ja=
va:482)
>> > =A0 =A0at org.apache.lucene.index.FieldInfos.<init>(FieldInfos.java:58=
)
>> > =A0 =A0at
>> > org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:34=
1)
>> > =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java=
:306)
>> > =A0 =A0at org.apache.lucene.index.SegmentReader.get(SegmentReader.java=
:269)
>> > =A0 =A0at
>> >
>> org.apache.lucene.index.MultiSegmentReader.doReopen(MultiSegmentReader.j=
ava:201)
>> > =A0 =A0at
>> >
>> org.apache.lucene.index.DirectoryIndexReader$2.doBody(DirectoryIndexRead=
er.java:157)
>> > =A0 =A0at
>> >
>> org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.j=
ava:653)
>> > =A0 =A0at
>> >
>> org.apache.lucene.index.DirectoryIndexReader.reopen(DirectoryIndexReader=
.java:179)
>> > =A0 =A0at
>> >
>> gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java=
:106)
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39621-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 04:43:10 2009
Return-Path: <java-user-return-39621-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90299 invoked from network); 10 Apr 2009 04:43:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 04:43:10 -0000
Received: (qmail 42917 invoked by uid 500); 10 Apr 2009 04:43:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42823 invoked by uid 500); 10 Apr 2009 04:43:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42812 invoked by uid 99); 10 Apr 2009 04:43:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 04:43:07 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ksshams@gmail.com designates 209.85.146.180 as permitted sender)
Received: from [209.85.146.180] (HELO wa-out-1112.google.com) (209.85.146.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 04:42:58 +0000
Received: by wa-out-1112.google.com with SMTP id l35so461434waf.5
        for <java-user@lucene.apache.org>; Thu, 09 Apr 2009 21:42:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=N+rIrUr1xYxs7o45XxiSgZoqHs8H5CSofGGf6OR38hk=;
        b=uNPfUi+8OP0ILKTQnREACwPnCWBlPhELo+Qz+XsREHHIjiRKlBWO9smQdM7HnzuOB5
         /8pAjbwte/ebYimZZps13koKN7mhZVI3SoJxpkUacvdvaHP+NtTSAF2hLtN4DReMAljm
         GTWOziQ+WDzDdDJ2u9evAcOgAICVIu9c3nYDk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=nOC+do99ifLMVI0QOIAz6M+J54oHLaDCzoDoKpOKN8MGpD2XpOG/cBuhE3tgZ/NQty
         ITaRHqLrt8P0CIEdOdAQWf/F5lx3yiXk1htGGTeBbQUJv+rhzq3iiY3BloUedwA0Y8nr
         xRLLEx/NMmFiib5Scq9at3AtNId0fb/7Nsd7o=
MIME-Version: 1.0
Received: by 10.114.52.13 with SMTP id z13mr1737762waz.150.1239338556760; Thu, 
	09 Apr 2009 21:42:36 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904091744x185f3737g707490068ba56057@mail.gmail.com>
References: <6d6cf45b0904091659se193b03l9c5344e59fa05dc4@mail.gmail.com>
	 <9ac0c6aa0904091705v17e53cdfv8a93be9a55843850@mail.gmail.com>
	 <6d6cf45b0904091733n569bf2e6l98b31d3d8c071745@mail.gmail.com>
	 <9ac0c6aa0904091744x185f3737g707490068ba56057@mail.gmail.com>
Date: Thu, 9 Apr 2009 21:42:36 -0700
Message-ID: <6d6cf45b0904092142q51ef79pa9808578b47a9436@mail.gmail.com>
Subject: Re: Exceptions in merge thread (while optimizing) causing problems 
	with subsequent reopens
From: Khawaja Shams <ksshams@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364582b66ea37004672bfe88
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364582b66ea37004672bfe88
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Mike,
  I am sorry for wasting your time :). There were indeed two threads that
were performing this operation. Out of curiosity, which part of this is not
thread safe? An indexreader reopening while a commit is going on? Thanks
again for your help.

Regards,
Khawaja



On Thu, Apr 9, 2009 at 5:44 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> That code looks right.  Are there multiple threads that may enter it?
>
> Can you show the code where you create the IndexWriter, add docs, etc?
>
> Can you call IndexWriter.setInfoStream for the entire life of the
> index, up until when the optimize error happens, and post back?
>
> Mike
>
> On Thu, Apr 9, 2009 at 8:33 PM, Khawaja Shams <ksshams@gmail.com> wrote:
> > Hi Michael,
> >  Thanks for the quick response. I only have one IndexWriter, and there
> are
> > no other processes accessing this particular index. I have tried deleting
> > the entire index and reconstructing it, but the index corruption is
> > repeatable. Incidentally, there are no new writes since the last commit
> when
> > the merge happens. I have over-padded my code with ReadWrite locks to
> make
> > sure that no writes/read are happening between the commits,
> optimizations,
> > and reopening of the index.
> >
> >
> > Here is a snippet of the thread I use to maintain the Index ( I hope that
> I
> > am not doing something terribly wrong):
> >            while (true) {
> >                try {
> >                    getWriteLock();
> >                    indexWriter.commit();
> >                   if (shouldOptimize()) {
> >                       indexWriter.optimize();
> >                    }
> >
> >                    IndexReader oldIR = indexSearcher.getIndexReader();
> >                    IndexReader ir = oldIR.reopen();
> >                    if (ir != oldIR) {
> >                        IndexSearcher oldIS = indexSearcher;
> >                        indexSearcher = new IndexSearcher(ir);
> >                        oldIS.close();
> >                        oldIR.close();
> >                } catch (Throwable t) {
> >                    trace.error(t, t);
> >                } finally {
> >                    releaseWriteLock();
> >                }
> >
> >
> > Regards,
> > Khawaja
> >
> > On Thu, Apr 9, 2009 at 5:05 PM, Michael McCandless <
> > lucene@mikemccandless.com> wrote:
> >
> >> These are serious corruption exceptions.
> >>
> >> Is it at all possible two writers are accessing the index at the same
> time?
> >>
> >> Can you describe more about how you're using Lucene?
> >>
> >> Mike
> >>
> >> On Thu, Apr 9, 2009 at 7:59 PM, Khawaja Shams <ksshams@gmail.com>
> wrote:
> >> > Hello,
> >> >  I am having a problem with reopening the IndexReader with Lucene 2.4
> ( I
> >> > updated to 2.4.1, but still no luck). The exception is preceded by an
> >> > exception in optimizing the index. I am not reopening the reader while
> >> the
> >> > commit or optimization is going on in the writer (optimizing happens
> in
> >> the
> >> > same thread, but much less often). The issues go away once I turn off
> >> > optimizations. I was also getting this problem before I turned off the
> >> use
> >> > of compound files. I would appreciate any guidance.
> >> >
> >> > Thanks!
> >> >
> >> > Regards,
> >> > Khawaja
> >> >
> >> >
> >> > 2009-04-09 15:57:47,033 (941820) [Index Maint Thread] ERROR
> >> > gov.nasa.ensemble.core.indexer.Indexer  - java.io.IOException:
> background
> >> > merge hit exception: _8:C41258 _9:C11382 into _a [optimize]
> >> > java.io.IOException: background merge hit exception: _8:C41258
> _9:C11382
> >> > into _a [optimize]
> >> >    at
> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
> >> >    at
> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
> >> >    at
> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
> >> >    at
> >> >
> >>
> gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java:102)
> >> > Caused by: org.apache.lucene.index.CorruptIndexException: doc counts
> >> differ
> >> > for segment _8: fieldsReader shows 30074 but segmentInfo shows 41258
> >> >    at
> >> >
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:362)
> >> >    at
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >> >    at
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> >> >    at
> >> > org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> >> >    at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> >> >    at
> >> >
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
> >> >    at
> >> >
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
> >> > Exception in thread "Lucene Merge Thread #0"
> >> > org.apache.lucene.index.MergePolicy$MergeException:
> >> > org.apache.lucene.index.CorruptIndexException: doc counts differ for
> >> segment
> >> > _8: fieldsReader shows 30074 but segmentInfo shows 41258
> >> >    at
> >> >
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
> >> >    at
> >> >
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
> >> > Caused by: org.apache.lucene.index.CorruptIndexException: doc counts
> >> differ
> >> > for segment _8: fieldsReader shows 30074 but segmentInfo shows 41258
> >> >    at
> >> >
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:362)
> >> >    at
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >> >    at
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
> >> >    at
> >> > org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4220)
> >> >    at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> >> >    at
> >> >
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
> >> >    at
> >> >
> >>
> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
> >> > 2009-04-09 15:57:52,814 (947601) [Index Maint Thread] ERROR
> >> > gov.nasa.ensemble.core.indexer.Indexer  -
> java.io.FileNotFoundException:
> >> > /opt/users/merops/index/_a.fnm (No such file or directory)
> >> > java.io.FileNotFoundException: /opt/users/merops/index/_a.fnm (No such
> >> file
> >> > or directory)
> >> >    at java.io.RandomAccessFile.open(Native Method)
> >> >    at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
> >> >    at
> >> >
> >>
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
> >> >    at
> >> >
> >>
> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
> >> >    at
> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> >> >    at
> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:482)
> >> >    at org.apache.lucene.index.FieldInfos.<init>(FieldInfos.java:58)
> >> >    at
> >> >
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:341)
> >> >    at
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> >> >    at
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:269)
> >> >    at
> >> >
> >>
> org.apache.lucene.index.MultiSegmentReader.doReopen(MultiSegmentReader.java:201)
> >> >    at
> >> >
> >>
> org.apache.lucene.index.DirectoryIndexReader$2.doBody(DirectoryIndexReader.java:157)
> >> >    at
> >> >
> >>
> org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:653)
> >> >    at
> >> >
> >>
> org.apache.lucene.index.DirectoryIndexReader.reopen(DirectoryIndexReader.java:179)
> >> >    at
> >> >
> >>
> gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java:106)
> >> >
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016364582b66ea37004672bfe88--

From java-user-return-39622-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 07:44:12 2009
Return-Path: <java-user-return-39622-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79163 invoked from network); 10 Apr 2009 07:44:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 07:44:12 -0000
Received: (qmail 73221 invoked by uid 500); 10 Apr 2009 07:44:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73124 invoked by uid 500); 10 Apr 2009 07:44:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73114 invoked by uid 99); 10 Apr 2009 07:44:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 07:44:09 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of preetham@cisco.com designates 171.71.176.117 as permitted sender)
Received: from [171.71.176.117] (HELO sj-iport-6.cisco.com) (171.71.176.117)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 07:43:59 +0000
X-IronPort-AV: E=Sophos;i="4.40,165,1238976000"; 
   d="scan'208";a="283725809"
Received: from sj-dkim-4.cisco.com ([171.71.179.196])
  by sj-iport-6.cisco.com with ESMTP; 10 Apr 2009 07:43:38 +0000
Received: from sj-core-5.cisco.com (sj-core-5.cisco.com [171.71.177.238])
	by sj-dkim-4.cisco.com (8.12.11/8.12.11) with ESMTP id n3A7hcC7025499
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 00:43:38 -0700
Received: from xbh-sjc-231.amer.cisco.com (xbh-sjc-231.cisco.com [128.107.191.100])
	by sj-core-5.cisco.com (8.13.8/8.13.8) with ESMTP id n3A7hcnv003233
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 07:43:38 GMT
Received: from xfe-sjc-212.amer.cisco.com ([171.70.151.187]) by xbh-sjc-231.amer.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Fri, 10 Apr 2009 00:43:38 -0700
Received: from [10.19.231.19] ([10.19.231.19]) by xfe-sjc-212.amer.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Fri, 10 Apr 2009 00:43:38 -0700
Message-ID: <49DEF89C.2020604@cisco.com>
Date: Fri, 10 Apr 2009 00:43:24 -0700
From: Preetham Kajekar <preetham@cisco.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: MultiSearcher query with Sort option
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 10 Apr 2009 07:43:38.0151 (UTC) FILETIME=[0F757B70:01C9B9B0]
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; l=337; t=1239349418; x=1240213418;
	c=relaxed/simple; s=sjdkim4002;
	h=Content-Type:From:Subject:Content-Transfer-Encoding:MIME-Version;
	d=cisco.com; i=preetham@cisco.com;
	z=From:=20Preetham=20Kajekar=20<preetham@cisco.com>
	|Subject:=20MultiSearcher=20query=20with=20Sort=20option
	|Sender:=20;
	bh=rAs49reKAMm38Eae+FRf9xd+oXfcG1jgv7VGxdDEfTw=;
	b=C/PwUhZDYdXtbqEXWp9NbEPzV352JoNi92eM6BAv6JMI81ViPZtZSo46M8
	otih/7FW/mDhsFThNGuVbPb73omQA9yQs9leMMlRPYgK7VlDYmwUHXhYvfw2
	H/qTonTgBK;
Authentication-Results: sj-dkim-4; header.From=preetham@cisco.com; dkim=pass (
	sig from cisco.com/sjdkim4002 verified; ); 
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,
 I am using a MultiSearcher to search 2 indexes. As part of my query, I 
am sorting the results based on a field (which in NOT_ANALYSED). 
However, i seem to be getting hits only from one of the indexes. If I 
change to Sort.INDEX_ORDER, I seem to be getting results from both. Is 
this a know problem ?

Thanks,
 ~preetham

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39623-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 08:24:35 2009
Return-Path: <java-user-return-39623-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89467 invoked from network); 10 Apr 2009 08:24:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 08:24:35 -0000
Received: (qmail 97756 invoked by uid 500); 10 Apr 2009 08:24:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97669 invoked by uid 500); 10 Apr 2009 08:24:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97659 invoked by uid 99); 10 Apr 2009 08:24:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 08:24:33 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 08:24:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id B66CC51861
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 10:23:57 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 22225-05 for <java-user@lucene.apache.org>;
 Fri, 10 Apr 2009 10:23:56 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 054C8517AA
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 10:23:55 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <49DEF89C.2020604@cisco.com>
Subject: RE: MultiSearcher query with Sort option
Date: Fri, 10 Apr 2009 10:23:57 +0200
Message-ID: <A8219AC3495543F4A295610F37FCBFDF@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: Acm5sCVsAD6TR9euQW6UFros9FDtdwABPjUg
In-Reply-To: <49DEF89C.2020604@cisco.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Hallo Preetham,

never heard of this. What Lucene version do you use?
To check out, try the search in andifferent way:
Combine the two indexes not into a MultiSearcher, instead open an
IndexReader for both indexes and combine both readers to a MultiReader. This
MultiReader can be used like a conventional single index and searched with
IndexSearcher. If the error then disappears, there may be a bug. If not,
something with your indexes is wrong.

I always recommend to only use MultiSearcher in distributed or parallel
search scenarios, never for just combining two indexes.

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Preetham Kajekar [mailto:preetham@cisco.com]
> Sent: Friday, April 10, 2009 9:43 AM
> To: java-user@lucene.apache.org
> Subject: MultiSearcher query with Sort option
> 
> Hi,
>  I am using a MultiSearcher to search 2 indexes. As part of my query, I
> am sorting the results based on a field (which in NOT_ANALYSED).
> However, i seem to be getting hits only from one of the indexes. If I
> change to Sort.INDEX_ORDER, I seem to be getting results from both. Is
> this a know problem ?
> 
> Thanks,
>  ~preetham
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39624-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 08:54:40 2009
Return-Path: <java-user-return-39624-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99427 invoked from network); 10 Apr 2009 08:54:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 08:54:40 -0000
Received: (qmail 13598 invoked by uid 500); 10 Apr 2009 08:54:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13520 invoked by uid 500); 10 Apr 2009 08:54:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13510 invoked by uid 99); 10 Apr 2009 08:54:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 08:54:37 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.76.38.80] (HELO outmail02.vivodinet.gr) (80.76.38.80)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 08:54:28 +0000
Received: from [192.168.0.71] (dsl-83-171-245-188.customers.vivodi.gr [83.171.245.188])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by outmail02.vivodinet.gr (Postfix) with ESMTP id EE47A27B0223
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 11:54:01 +0300 (EEST)
Message-ID: <49DF092C.4000702@eworx.gr>
Date: Fri, 10 Apr 2009 11:54:04 +0300
From: John Cherouvim <jc@eworx.gr>
User-Agent: Thunderbird 1.5.0.14 (Windows/20071210)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: SpellChecker AlreadyClosedException issue
References: <49D498F7.4090708@eworx.gr> <Pine.LNX.4.64.0904091612370.31507@radix.cryptio.net>
In-Reply-To: <Pine.LNX.4.64.0904091612370.31507@radix.cryptio.net>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: clamav-milter 0.95 at multi-der
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

dir is a local variable inside a method, so it's not getting reused.
Should I synchronise the whole method? I think that would slow things 
down in a concurrent environment.

Thanks for your response.


Chris Hostetter wrote:
> : My code looks like this:
> : 
> : Directory dir = null;
> : try {
> :    dir = FSDirectory.getDirectory("/path/to/dictionary");
> :    SpellChecker spell = new SpellChecker(dir); // exception thrown here
> :    // ...
> :    dir.close();
>
> : This code works, but in a highly concurrent situation AlreadyClosedException
> : is being thrown when I try to instantiate the SpellChecker:
> : org.apache.lucene.store.AlreadyClosedException: this Directory is closed
>
> if an error only happens under high concurrent load, it suggests that 
> perhaps you have multiple threads attempting to close the directory.  you 
> haven't clarified whether "dir" is a local variable inside a method, or an 
> instnace variable in an object which is getting reused by multiple 
> threads -- so it's hard to guess.
>
> : I use lucene-core-2.4.1.jar and lucene-spellchecker-2.4.1.jar and I can
> : reproduce the error in both windows and linux.
>
> if you have a fully exeuctable test case (instead of just an incomplete 
> partial snippet) that you can share, people may be able to spot the 
> problem, or at the very least run the test themselves to reproduce.
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   

-- 
Ioannis Cherouvim
Software Engineer
mail: jc@eworx.gr
web: www.eworx.gr


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39625-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 09:27:56 2009
Return-Path: <java-user-return-39625-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16630 invoked from network); 10 Apr 2009 09:27:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 09:27:56 -0000
Received: (qmail 33379 invoked by uid 500); 10 Apr 2009 09:27:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33310 invoked by uid 500); 10 Apr 2009 09:27:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33152 invoked by uid 99); 10 Apr 2009 09:27:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:27:52 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of preetham@cisco.com designates 171.71.176.117 as permitted sender)
Received: from [171.71.176.117] (HELO sj-iport-6.cisco.com) (171.71.176.117)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:27:41 +0000
X-IronPort-AV: E=Sophos;i="4.40,165,1238976000"; 
   d="scan'208";a="283772764"
Received: from sj-dkim-3.cisco.com ([171.71.179.195])
  by sj-iport-6.cisco.com with ESMTP; 10 Apr 2009 09:27:08 +0000
Received: from sj-core-5.cisco.com (sj-core-5.cisco.com [171.71.177.238])
	by sj-dkim-3.cisco.com (8.12.11/8.12.11) with ESMTP id n3A9R7U2010471
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 02:27:07 -0700
Received: from xbh-sjc-221.amer.cisco.com (xbh-sjc-221.cisco.com [128.107.191.63])
	by sj-core-5.cisco.com (8.13.8/8.13.8) with ESMTP id n3A9R71g025878
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 09:27:07 GMT
Received: from xfe-sjc-212.amer.cisco.com ([171.70.151.187]) by xbh-sjc-221.amer.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Fri, 10 Apr 2009 02:27:07 -0700
Received: from [10.19.231.19] ([10.19.231.19]) by xfe-sjc-212.amer.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Fri, 10 Apr 2009 02:27:07 -0700
Message-ID: <49DF10DD.1050300@cisco.com>
Date: Fri, 10 Apr 2009 02:26:53 -0700
From: Preetham Kajekar <preetham@cisco.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: MultiSearcher query with Sort option
References: <49DEF89C.2020604@cisco.com> <A8219AC3495543F4A295610F37FCBFDF@VEGA>
In-Reply-To: <A8219AC3495543F4A295610F37FCBFDF@VEGA>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 10 Apr 2009 09:27:07.0251 (UTC) FILETIME=[845EF430:01C9B9BE]
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; l=1952; t=1239355627; x=1240219627;
	c=relaxed/simple; s=sjdkim3002;
	h=Content-Type:From:Subject:Content-Transfer-Encoding:MIME-Version;
	d=cisco.com; i=preetham@cisco.com;
	z=From:=20Preetham=20Kajekar=20<preetham@cisco.com>
	|Subject:=20Re=3A=20MultiSearcher=20query=20with=20Sort=20o
	ption
	|Sender:=20;
	bh=8Z+2dNiea1ZRUOv5HtdVEozwEnKtIcH5mAX2JPAgpt4=;
	b=CvxPVYSODb+2tbmHU80hwlc5z6TuiJ1MUYa/u0FOXXn1pJlFCMISjq4eZP
	B7m4qy+MPogg4SdApvtytLGHYMnqOpGOIm+ds2L7KHgdYm3YeNmDnhA3fqRB
	y/RmNf74vP;
Authentication-Results: sj-dkim-3; header.From=preetham@cisco.com; dkim=pass (
	sig from cisco.com/sjdkim3002 verified; ); 
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,
 I just realized it was a bug in my code.
 On a related note, is it possible to Sort based on reverse index order ?

Thanks,
 ~preetham

Uwe Schindler wrote:
> Hallo Preetham,
>
> never heard of this. What Lucene version do you use?
> To check out, try the search in andifferent way:
> Combine the two indexes not into a MultiSearcher, instead open an
> IndexReader for both indexes and combine both readers to a MultiReader. This
> MultiReader can be used like a conventional single index and searched with
> IndexSearcher. If the error then disappears, there may be a bug. If not,
> something with your indexes is wrong.
>
> I always recommend to only use MultiSearcher in distributed or parallel
> search scenarios, never for just combining two indexes.
>
> Uwe
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>   
>> -----Original Message-----
>> From: Preetham Kajekar [mailto:preetham@cisco.com]
>> Sent: Friday, April 10, 2009 9:43 AM
>> To: java-user@lucene.apache.org
>> Subject: MultiSearcher query with Sort option
>>
>> Hi,
>>  I am using a MultiSearcher to search 2 indexes. As part of my query, I
>> am sorting the results based on a field (which in NOT_ANALYSED).
>> However, i seem to be getting hits only from one of the indexes. If I
>> change to Sort.INDEX_ORDER, I seem to be getting results from both. Is
>> this a know problem ?
>>
>> Thanks,
>>  ~preetham
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39626-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 09:32:25 2009
Return-Path: <java-user-return-39626-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21677 invoked from network); 10 Apr 2009 09:32:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 09:32:25 -0000
Received: (qmail 37604 invoked by uid 500); 10 Apr 2009 09:32:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37518 invoked by uid 500); 10 Apr 2009 09:32:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37508 invoked by uid 99); 10 Apr 2009 09:32:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:32:21 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:32:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id C324A517C5
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 11:31:50 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 22225-10 for <java-user@lucene.apache.org>;
 Fri, 10 Apr 2009 11:31:49 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id EF51B50438
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 11:31:48 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <49DEF89C.2020604@cisco.com> <A8219AC3495543F4A295610F37FCBFDF@VEGA> <49DF10DD.1050300@cisco.com>
Subject: RE: MultiSearcher query with Sort option
Date: Fri, 10 Apr 2009 11:31:50 +0200
Message-ID: <052B733F5696422C8976F15F0A4A035D@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: Acm5vqdjuh/+qcl9SJq5Wrbw+b/RngAAFwsQ
In-Reply-To: <49DF10DD.1050300@cisco.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

It should, do not use Sort.INDEX_ORDER, create a SortField with indexorder
and the reverse parameter, the SortField can be warpped inside a Sort
instance and voila. I am not sure, if it works, but it should. Same with
score.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Preetham Kajekar [mailto:preetham@cisco.com]
> Sent: Friday, April 10, 2009 11:27 AM
> To: java-user@lucene.apache.org
> Subject: Re: MultiSearcher query with Sort option
> 
> Hi,
>  I just realized it was a bug in my code.
>  On a related note, is it possible to Sort based on reverse index order ?
> 
> Thanks,
>  ~preetham
> 
> Uwe Schindler wrote:
> > Hallo Preetham,
> >
> > never heard of this. What Lucene version do you use?
> > To check out, try the search in andifferent way:
> > Combine the two indexes not into a MultiSearcher, instead open an
> > IndexReader for both indexes and combine both readers to a MultiReader.
> This
> > MultiReader can be used like a conventional single index and searched
> with
> > IndexSearcher. If the error then disappears, there may be a bug. If not,
> > something with your indexes is wrong.
> >
> > I always recommend to only use MultiSearcher in distributed or parallel
> > search scenarios, never for just combining two indexes.
> >
> > Uwe
> >
> > -----
> > Uwe Schindler
> > H.-H.-Meier-Allee 63, D-28213 Bremen
> > http://www.thetaphi.de
> > eMail: uwe@thetaphi.de
> >
> >
> >> -----Original Message-----
> >> From: Preetham Kajekar [mailto:preetham@cisco.com]
> >> Sent: Friday, April 10, 2009 9:43 AM
> >> To: java-user@lucene.apache.org
> >> Subject: MultiSearcher query with Sort option
> >>
> >> Hi,
> >>  I am using a MultiSearcher to search 2 indexes. As part of my query, I
> >> am sorting the results based on a field (which in NOT_ANALYSED).
> >> However, i seem to be getting hits only from one of the indexes. If I
> >> change to Sort.INDEX_ORDER, I seem to be getting results from both. Is
> >> this a know problem ?
> >>
> >> Thanks,
> >>  ~preetham
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39627-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 09:37:51 2009
Return-Path: <java-user-return-39627-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24461 invoked from network); 10 Apr 2009 09:37:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 09:37:51 -0000
Received: (qmail 44708 invoked by uid 500); 10 Apr 2009 09:37:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44629 invoked by uid 500); 10 Apr 2009 09:37:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44619 invoked by uid 99); 10 Apr 2009 09:37:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:37:48 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.173] (HELO wf-out-1314.google.com) (209.85.200.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:37:40 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1045608wff.20
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 02:37:19 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.15.11 with SMTP id s11mr1247061wfi.283.1239356239165; Fri, 
	10 Apr 2009 02:37:19 -0700 (PDT)
In-Reply-To: <6d6cf45b0904092142q51ef79pa9808578b47a9436@mail.gmail.com>
References: <6d6cf45b0904091659se193b03l9c5344e59fa05dc4@mail.gmail.com>
	 <9ac0c6aa0904091705v17e53cdfv8a93be9a55843850@mail.gmail.com>
	 <6d6cf45b0904091733n569bf2e6l98b31d3d8c071745@mail.gmail.com>
	 <9ac0c6aa0904091744x185f3737g707490068ba56057@mail.gmail.com>
	 <6d6cf45b0904092142q51ef79pa9808578b47a9436@mail.gmail.com>
Date: Fri, 10 Apr 2009 05:37:19 -0400
Message-ID: <9ac0c6aa0904100237m276ef1d7yc312828074536a52@mail.gmail.com>
Subject: Re: Exceptions in merge thread (while optimizing) causing problems 
	with subsequent reopens
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Actually it's perfectly fine for two threads to enter that code
fragment (you obtain a write lock to protect the code so that "there
can be only one").

Second off, even if you didn't have your write lock, the code should
still be safe in that no index corruption is possible.  Multiple
threads may call optimize(), commit() etc. on an IndexWriter without
harm.

The reopen code is also "safe" (will not cause corruption), but you
may accidentally have readers that you fail to close, or close readers
that are in-use by in-flight searches).  I'd recommend using the
"lia.admin.SearcherManager" class from the upcoming Lucene in Action
revision (it's in the book's source code, which you can download from
http://www.manning.com/hatcher3/LIAsourcecode.zip) to manage/reopen
the searcher.

But one surefire way to cause index corruption is if two separate
IndexWriters are open on the same index.  This is normally not easy to
do, since Lucene protects itself with the write lock in the index
directory.  So if you 1) turn off this locking (eg use NoLockFactory),
and 2) accidentally allow two writers on once on the same index,
you'll get corruption.

So.... I'm not sure that we've actually explained your corruption?

Mike

On Fri, Apr 10, 2009 at 12:42 AM, Khawaja Shams <ksshams@gmail.com> wrote:
> Mike,
> =A0I am sorry for wasting your time :). There were indeed two threads tha=
t
> were performing this operation. Out of curiosity, which part of this is n=
ot
> thread safe? An indexreader reopening while a commit is going on? Thanks
> again for your help.
>
> Regards,
> Khawaja
>
>
>
> On Thu, Apr 9, 2009 at 5:44 PM, Michael McCandless <
> lucene@mikemccandless.com> wrote:
>
>> That code looks right. =A0Are there multiple threads that may enter it?
>>
>> Can you show the code where you create the IndexWriter, add docs, etc?
>>
>> Can you call IndexWriter.setInfoStream for the entire life of the
>> index, up until when the optimize error happens, and post back?
>>
>> Mike
>>
>> On Thu, Apr 9, 2009 at 8:33 PM, Khawaja Shams <ksshams@gmail.com> wrote:
>> > Hi Michael,
>> > =A0Thanks for the quick response. I only have one IndexWriter, and the=
re
>> are
>> > no other processes accessing this particular index. I have tried delet=
ing
>> > the entire index and reconstructing it, but the index corruption is
>> > repeatable. Incidentally, there are no new writes since the last commi=
t
>> when
>> > the merge happens. I have over-padded my code with ReadWrite locks to
>> make
>> > sure that no writes/read are happening between the commits,
>> optimizations,
>> > and reopening of the index.
>> >
>> >
>> > Here is a snippet of the thread I use to maintain the Index ( I hope t=
hat
>> I
>> > am not doing something terribly wrong):
>> > =A0 =A0 =A0 =A0 =A0 =A0while (true) {
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0getWriteLock();
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0indexWriter.commit();
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 if (shouldOptimize()) {
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 indexWriter.optimize();
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> >
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexReader oldIR =3D indexSear=
cher.getIndexReader();
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexReader ir =3D oldIR.reopen=
();
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (ir !=3D oldIR) {
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0IndexSearcher oldIS =3D=
 indexSearcher;
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0indexSearcher =3D new I=
ndexSearcher(ir);
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0oldIS.close();
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0oldIR.close();
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (Throwable t) {
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0trace.error(t, t);
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} finally {
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0releaseWriteLock();
>> > =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>> >
>> >
>> > Regards,
>> > Khawaja
>> >
>> > On Thu, Apr 9, 2009 at 5:05 PM, Michael McCandless <
>> > lucene@mikemccandless.com> wrote:
>> >
>> >> These are serious corruption exceptions.
>> >>
>> >> Is it at all possible two writers are accessing the index at the same
>> time?
>> >>
>> >> Can you describe more about how you're using Lucene?
>> >>
>> >> Mike
>> >>
>> >> On Thu, Apr 9, 2009 at 7:59 PM, Khawaja Shams <ksshams@gmail.com>
>> wrote:
>> >> > Hello,
>> >> > =A0I am having a problem with reopening the IndexReader with Lucene=
 2.4
>> ( I
>> >> > updated to 2.4.1, but still no luck). The exception is preceded by =
an
>> >> > exception in optimizing the index. I am not reopening the reader wh=
ile
>> >> the
>> >> > commit or optimization is going on in the writer (optimizing happen=
s
>> in
>> >> the
>> >> > same thread, but much less often). The issues go away once I turn o=
ff
>> >> > optimizations. I was also getting this problem before I turned off =
the
>> >> use
>> >> > of compound files. I would appreciate any guidance.
>> >> >
>> >> > Thanks!
>> >> >
>> >> > Regards,
>> >> > Khawaja
>> >> >
>> >> >
>> >> > 2009-04-09 15:57:47,033 (941820) [Index Maint Thread] ERROR
>> >> > gov.nasa.ensemble.core.indexer.Indexer =A0- java.io.IOException:
>> background
>> >> > merge hit exception: _8:C41258 _9:C11382 into _a [optimize]
>> >> > java.io.IOException: background merge hit exception: _8:C41258
>> _9:C11382
>> >> > into _a [optimize]
>> >> > =A0 =A0at
>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2273)
>> >> > =A0 =A0at
>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2218)
>> >> > =A0 =A0at
>> org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:2198)
>> >> > =A0 =A0at
>> >> >
>> >>
>> gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java=
:102)
>> >> > Caused by: org.apache.lucene.index.CorruptIndexException: doc count=
s
>> >> differ
>> >> > for segment _8: fieldsReader shows 30074 but segmentInfo shows 4125=
8
>> >> > =A0 =A0at
>> >> >
>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:362)
>> >> > =A0 =A0at
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>> >> > =A0 =A0at
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>> >> > =A0 =A0at
>> >> > org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:42=
20)
>> >> > =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.jav=
a:3884)
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerge=
Scheduler.java:205)
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr=
entMergeScheduler.java:260)
>> >> > Exception in thread "Lucene Merge Thread #0"
>> >> > org.apache.lucene.index.MergePolicy$MergeException:
>> >> > org.apache.lucene.index.CorruptIndexException: doc counts differ fo=
r
>> >> segment
>> >> > _8: fieldsReader shows 30074 but segmentInfo shows 41258
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(Co=
ncurrentMergeScheduler.java:309)
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr=
entMergeScheduler.java:286)
>> >> > Caused by: org.apache.lucene.index.CorruptIndexException: doc count=
s
>> >> differ
>> >> > for segment _8: fieldsReader shows 30074 but segmentInfo shows 4125=
8
>> >> > =A0 =A0at
>> >> >
>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:362)
>> >> > =A0 =A0at
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>> >> > =A0 =A0at
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:260)
>> >> > =A0 =A0at
>> >> > org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:42=
20)
>> >> > =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.jav=
a:3884)
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMerge=
Scheduler.java:205)
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(Concurr=
entMergeScheduler.java:260)
>> >> > 2009-04-09 15:57:52,814 (947601) [Index Maint Thread] ERROR
>> >> > gov.nasa.ensemble.core.indexer.Indexer =A0-
>> java.io.FileNotFoundException:
>> >> > /opt/users/merops/index/_a.fnm (No such file or directory)
>> >> > java.io.FileNotFoundException: /opt/users/merops/index/_a.fnm (No s=
uch
>> >> file
>> >> > or directory)
>> >> > =A0 =A0at java.io.RandomAccessFile.open(Native Method)
>> >> > =A0 =A0at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212=
)
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDir=
ectory.java:552)
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java=
:582)
>> >> > =A0 =A0at
>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
>> >> > =A0 =A0at
>> org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:482)
>> >> > =A0 =A0at org.apache.lucene.index.FieldInfos.<init>(FieldInfos.java=
:58)
>> >> > =A0 =A0at
>> >> >
>> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:341)
>> >> > =A0 =A0at
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
>> >> > =A0 =A0at
>> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:269)
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.index.MultiSegmentReader.doReopen(MultiSegmentReader.j=
ava:201)
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.index.DirectoryIndexReader$2.doBody(DirectoryIndexRead=
er.java:157)
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.j=
ava:653)
>> >> > =A0 =A0at
>> >> >
>> >>
>> org.apache.lucene.index.DirectoryIndexReader.reopen(DirectoryIndexReader=
.java:179)
>> >> > =A0 =A0at
>> >> >
>> >>
>> gov.nasa.ensemble.core.indexer.Indexer$IndexMaintThread.run(Indexer.java=
:106)
>> >> >
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39628-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 09:44:35 2009
Return-Path: <java-user-return-39628-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27416 invoked from network); 10 Apr 2009 09:44:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 09:44:34 -0000
Received: (qmail 49531 invoked by uid 500); 10 Apr 2009 09:44:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49469 invoked by uid 500); 10 Apr 2009 09:44:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49459 invoked by uid 99); 10 Apr 2009 09:44:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:44:32 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.173] (HELO wf-out-1314.google.com) (209.85.200.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:44:23 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1047227wff.20
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 02:44:02 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.15.11 with SMTP id s11mr1249059wfi.283.1239356642392; Fri, 
	10 Apr 2009 02:44:02 -0700 (PDT)
In-Reply-To: <052B733F5696422C8976F15F0A4A035D@VEGA>
References: <49DEF89C.2020604@cisco.com>
	 <A8219AC3495543F4A295610F37FCBFDF@VEGA> <49DF10DD.1050300@cisco.com>
	 <052B733F5696422C8976F15F0A4A035D@VEGA>
Date: Fri, 10 Apr 2009 05:44:02 -0400
Message-ID: <9ac0c6aa0904100244r120fbc49v4e234b8d3356edc6@mail.gmail.com>
Subject: Re: MultiSearcher query with Sort option
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

This (reversing a SortField.FIELD_DOC) should work... if it doesn't it's a =
bug.

SortField.FIELD_DOC and SortField.FIELD_SCORE are "first class"
SortField objects.

Mike

On Fri, Apr 10, 2009 at 5:31 AM, Uwe Schindler <uwe@thetaphi.de> wrote:
> It should, do not use Sort.INDEX_ORDER, create a SortField with indexorde=
r
> and the reverse parameter, the SortField can be warpped inside a Sort
> instance and voila. I am not sure, if it works, but it should. Same with
> score.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>> -----Original Message-----
>> From: Preetham Kajekar [mailto:preetham@cisco.com]
>> Sent: Friday, April 10, 2009 11:27 AM
>> To: java-user@lucene.apache.org
>> Subject: Re: MultiSearcher query with Sort option
>>
>> Hi,
>> =A0I just realized it was a bug in my code.
>> =A0On a related note, is it possible to Sort based on reverse index orde=
r ?
>>
>> Thanks,
>> =A0~preetham
>>
>> Uwe Schindler wrote:
>> > Hallo Preetham,
>> >
>> > never heard of this. What Lucene version do you use?
>> > To check out, try the search in andifferent way:
>> > Combine the two indexes not into a MultiSearcher, instead open an
>> > IndexReader for both indexes and combine both readers to a MultiReader=
.
>> This
>> > MultiReader can be used like a conventional single index and searched
>> with
>> > IndexSearcher. If the error then disappears, there may be a bug. If no=
t,
>> > something with your indexes is wrong.
>> >
>> > I always recommend to only use MultiSearcher in distributed or paralle=
l
>> > search scenarios, never for just combining two indexes.
>> >
>> > Uwe
>> >
>> > -----
>> > Uwe Schindler
>> > H.-H.-Meier-Allee 63, D-28213 Bremen
>> > http://www.thetaphi.de
>> > eMail: uwe@thetaphi.de
>> >
>> >
>> >> -----Original Message-----
>> >> From: Preetham Kajekar [mailto:preetham@cisco.com]
>> >> Sent: Friday, April 10, 2009 9:43 AM
>> >> To: java-user@lucene.apache.org
>> >> Subject: MultiSearcher query with Sort option
>> >>
>> >> Hi,
>> >> =A0I am using a MultiSearcher to search 2 indexes. As part of my quer=
y, I
>> >> am sorting the results based on a field (which in NOT_ANALYSED).
>> >> However, i seem to be getting hits only from one of the indexes. If I
>> >> change to Sort.INDEX_ORDER, I seem to be getting results from both. I=
s
>> >> this a know problem ?
>> >>
>> >> Thanks,
>> >> =A0~preetham
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >
>> >
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39629-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 09:48:12 2009
Return-Path: <java-user-return-39629-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29062 invoked from network); 10 Apr 2009 09:48:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 09:48:12 -0000
Received: (qmail 53328 invoked by uid 500); 10 Apr 2009 09:48:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53257 invoked by uid 500); 10 Apr 2009 09:48:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53247 invoked by uid 99); 10 Apr 2009 09:48:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:48:09 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of preetham@cisco.com designates 171.71.176.72 as permitted sender)
Received: from [171.71.176.72] (HELO sj-iport-3.cisco.com) (171.71.176.72)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:47:58 +0000
X-IronPort-AV: E=Sophos;i="4.40,165,1238976000"; 
   d="scan'208";a="152245714"
Received: from sj-dkim-2.cisco.com ([171.71.179.186])
  by sj-iport-3.cisco.com with ESMTP; 10 Apr 2009 09:47:37 +0000
Received: from sj-core-2.cisco.com (sj-core-2.cisco.com [171.71.177.254])
	by sj-dkim-2.cisco.com (8.12.11/8.12.11) with ESMTP id n3A9lZ28017277
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 02:47:35 -0700
Received: from xbh-sjc-231.amer.cisco.com (xbh-sjc-231.cisco.com [128.107.191.100])
	by sj-core-2.cisco.com (8.13.8/8.13.8) with ESMTP id n3A9lZaI023684
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 09:47:35 GMT
Received: from xfe-sjc-211.amer.cisco.com ([171.70.151.174]) by xbh-sjc-231.amer.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Fri, 10 Apr 2009 02:47:34 -0700
Received: from [10.19.231.19] ([10.19.231.19]) by xfe-sjc-211.amer.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Fri, 10 Apr 2009 02:47:34 -0700
Message-ID: <49DF15A8.4050507@cisco.com>
Date: Fri, 10 Apr 2009 02:47:20 -0700
From: Preetham Kajekar <preetham@cisco.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: MultiSearcher query with Sort option
References: <49DEF89C.2020604@cisco.com> <A8219AC3495543F4A295610F37FCBFDF@VEGA> <49DF10DD.1050300@cisco.com> <052B733F5696422C8976F15F0A4A035D@VEGA>
In-Reply-To: <052B733F5696422C8976F15F0A4A035D@VEGA>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 10 Apr 2009 09:47:34.0765 (UTC) FILETIME=[6006B9D0:01C9B9C1]
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; l=3439; t=1239356855; x=1240220855;
	c=relaxed/simple; s=sjdkim2002;
	h=Content-Type:From:Subject:Content-Transfer-Encoding:MIME-Version;
	d=cisco.com; i=preetham@cisco.com;
	z=From:=20Preetham=20Kajekar=20<preetham@cisco.com>
	|Subject:=20Re=3A=20MultiSearcher=20query=20with=20Sort=20o
	ption
	|Sender:=20;
	bh=HKRJdYV2+WTGQdZ19n++I5DTFF6OoFxzivD0JGeJh90=;
	b=Ns8y1+PiNKGsh9NKvAHzoF8DoGdWi8sFVFqb05HDB8V5IklVyTYoD/SdAx
	cbgy7wZULhBn3st5UhECfvRyH1AJdv6HgqguyMVu5Fuwvc9f3ZRdFz8QhopQ
	MqsF3Jc/eb;
Authentication-Results: sj-dkim-2; header.From=preetham@cisco.com; dkim=pass (
	sig from cisco.com/sjdkim2002 verified; ); 
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Uwe,
 Thanks for your response. However, I could not find the API in 
SortField and Sort to achieve this. SortField can be wrapped inside a 
Sort, but you cannot specify to reverse the order .

Thx,
 ~preetham


Uwe Schindler wrote:
> It should, do not use Sort.INDEX_ORDER, create a SortField with indexorder
> and the reverse parameter, the SortField can be warpped inside a Sort
> instance and voila. I am not sure, if it works, but it should. Same with
> score.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>   
>> -----Original Message-----
>> From: Preetham Kajekar [mailto:preetham@cisco.com]
>> Sent: Friday, April 10, 2009 11:27 AM
>> To: java-user@lucene.apache.org
>> Subject: Re: MultiSearcher query with Sort option
>>
>> Hi,
>>  I just realized it was a bug in my code.
>>  On a related note, is it possible to Sort based on reverse index order ?
>>
>> Thanks,
>>  ~preetham
>>
>> Uwe Schindler wrote:
>>     
>>> Hallo Preetham,
>>>
>>> never heard of this. What Lucene version do you use?
>>> To check out, try the search in andifferent way:
>>> Combine the two indexes not into a MultiSearcher, instead open an
>>> IndexReader for both indexes and combine both readers to a MultiReader.
>>>       
>> This
>>     
>>> MultiReader can be used like a conventional single index and searched
>>>       
>> with
>>     
>>> IndexSearcher. If the error then disappears, there may be a bug. If not,
>>> something with your indexes is wrong.
>>>
>>> I always recommend to only use MultiSearcher in distributed or parallel
>>> search scenarios, never for just combining two indexes.
>>>
>>> Uwe
>>>
>>> -----
>>> Uwe Schindler
>>> H.-H.-Meier-Allee 63, D-28213 Bremen
>>> http://www.thetaphi.de
>>> eMail: uwe@thetaphi.de
>>>
>>>
>>>       
>>>> -----Original Message-----
>>>> From: Preetham Kajekar [mailto:preetham@cisco.com]
>>>> Sent: Friday, April 10, 2009 9:43 AM
>>>> To: java-user@lucene.apache.org
>>>> Subject: MultiSearcher query with Sort option
>>>>
>>>> Hi,
>>>>  I am using a MultiSearcher to search 2 indexes. As part of my query, I
>>>> am sorting the results based on a field (which in NOT_ANALYSED).
>>>> However, i seem to be getting hits only from one of the indexes. If I
>>>> change to Sort.INDEX_ORDER, I seem to be getting results from both. Is
>>>> this a know problem ?
>>>>
>>>> Thanks,
>>>>  ~preetham
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>         
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>>       
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39630-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 09:59:08 2009
Return-Path: <java-user-return-39630-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36584 invoked from network); 10 Apr 2009 09:59:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 09:59:08 -0000
Received: (qmail 64468 invoked by uid 500); 10 Apr 2009 09:59:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64438 invoked by uid 500); 10 Apr 2009 09:59:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64428 invoked by uid 99); 10 Apr 2009 09:59:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:59:05 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of preetham@cisco.com designates 171.71.176.117 as permitted sender)
Received: from [171.71.176.117] (HELO sj-iport-6.cisco.com) (171.71.176.117)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 09:58:55 +0000
X-IronPort-AV: E=Sophos;i="4.40,165,1238976000"; 
   d="scan'208";a="283786309"
Received: from sj-dkim-2.cisco.com ([171.71.179.186])
  by sj-iport-6.cisco.com with ESMTP; 10 Apr 2009 09:58:34 +0000
Received: from sj-core-2.cisco.com (sj-core-2.cisco.com [171.71.177.254])
	by sj-dkim-2.cisco.com (8.12.11/8.12.11) with ESMTP id n3A9wYdc030119
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 02:58:34 -0700
Received: from xbh-sjc-221.amer.cisco.com (xbh-sjc-221.cisco.com [128.107.191.63])
	by sj-core-2.cisco.com (8.13.8/8.13.8) with ESMTP id n3A9wY2D000643
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 09:58:34 GMT
Received: from xfe-sjc-212.amer.cisco.com ([171.70.151.187]) by xbh-sjc-221.amer.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Fri, 10 Apr 2009 02:58:34 -0700
Received: from [10.19.231.19] ([10.19.231.19]) by xfe-sjc-212.amer.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Fri, 10 Apr 2009 02:58:34 -0700
Message-ID: <49DF183C.3060709@cisco.com>
Date: Fri, 10 Apr 2009 02:58:20 -0700
From: Preetham Kajekar <preetham@cisco.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: MultiSearcher query with Sort option
References: <49DEF89C.2020604@cisco.com> <A8219AC3495543F4A295610F37FCBFDF@VEGA> <49DF10DD.1050300@cisco.com> <052B733F5696422C8976F15F0A4A035D@VEGA> <49DF15A8.4050507@cisco.com>
In-Reply-To: <49DF15A8.4050507@cisco.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 10 Apr 2009 09:58:34.0177 (UTC) FILETIME=[E9110310:01C9B9C2]
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; l=4013; t=1239357514; x=1240221514;
	c=relaxed/simple; s=sjdkim2002;
	h=Content-Type:From:Subject:Content-Transfer-Encoding:MIME-Version;
	d=cisco.com; i=preetham@cisco.com;
	z=From:=20Preetham=20Kajekar=20<preetham@cisco.com>
	|Subject:=20Re=3A=20MultiSearcher=20query=20with=20Sort=20o
	ption
	|Sender:=20;
	bh=V22dcgqrpeiXz/jOkuqE0w/OO+S2aFdawNP6gHEA3PY=;
	b=oK/C7+FryNb+9B4l2sbH3BlS4EyI3Lz9x/kTnZlg6qd7210hKTfqCQLlTf
	enj4VgbOTHV6TmghEWt8E7ugautK4hZpD5mycjwcUrI49sfIYw4lfWdutdPs
	v+VyRrBFd9;
Authentication-Results: sj-dkim-2; header.From=preetham@cisco.com; dkim=pass (
	sig from cisco.com/sjdkim2002 verified; ); 
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,
 I found the API in another post on the net.

new *Sort*(new SortField(null, SortField.DOC, true))

The trick is to set the field to null.

Thanks for the help.

Preetham Kajekar wrote:
> Hi Uwe,
> Thanks for your response. However, I could not find the API in 
> SortField and Sort to achieve this. SortField can be wrapped inside a 
> Sort, but you cannot specify to reverse the order .
>
> Thx,
> ~preetham
>
>
> Uwe Schindler wrote:
>> It should, do not use Sort.INDEX_ORDER, create a SortField with 
>> indexorder
>> and the reverse parameter, the SortField can be warpped inside a Sort
>> instance and voila. I am not sure, if it works, but it should. Same with
>> score.
>>
>> -----
>> Uwe Schindler
>> H.-H.-Meier-Allee 63, D-28213 Bremen
>> http://www.thetaphi.de
>> eMail: uwe@thetaphi.de
>>
>>  
>>> -----Original Message-----
>>> From: Preetham Kajekar [mailto:preetham@cisco.com]
>>> Sent: Friday, April 10, 2009 11:27 AM
>>> To: java-user@lucene.apache.org
>>> Subject: Re: MultiSearcher query with Sort option
>>>
>>> Hi,
>>>  I just realized it was a bug in my code.
>>>  On a related note, is it possible to Sort based on reverse index 
>>> order ?
>>>
>>> Thanks,
>>>  ~preetham
>>>
>>> Uwe Schindler wrote:
>>>    
>>>> Hallo Preetham,
>>>>
>>>> never heard of this. What Lucene version do you use?
>>>> To check out, try the search in andifferent way:
>>>> Combine the two indexes not into a MultiSearcher, instead open an
>>>> IndexReader for both indexes and combine both readers to a 
>>>> MultiReader.
>>>>       
>>> This
>>>    
>>>> MultiReader can be used like a conventional single index and searched
>>>>       
>>> with
>>>    
>>>> IndexSearcher. If the error then disappears, there may be a bug. If 
>>>> not,
>>>> something with your indexes is wrong.
>>>>
>>>> I always recommend to only use MultiSearcher in distributed or 
>>>> parallel
>>>> search scenarios, never for just combining two indexes.
>>>>
>>>> Uwe
>>>>
>>>> -----
>>>> Uwe Schindler
>>>> H.-H.-Meier-Allee 63, D-28213 Bremen
>>>> http://www.thetaphi.de
>>>> eMail: uwe@thetaphi.de
>>>>
>>>>
>>>>      
>>>>> -----Original Message-----
>>>>> From: Preetham Kajekar [mailto:preetham@cisco.com]
>>>>> Sent: Friday, April 10, 2009 9:43 AM
>>>>> To: java-user@lucene.apache.org
>>>>> Subject: MultiSearcher query with Sort option
>>>>>
>>>>> Hi,
>>>>>  I am using a MultiSearcher to search 2 indexes. As part of my 
>>>>> query, I
>>>>> am sorting the results based on a field (which in NOT_ANALYSED).
>>>>> However, i seem to be getting hits only from one of the indexes. If I
>>>>> change to Sort.INDEX_ORDER, I seem to be getting results from 
>>>>> both. Is
>>>>> this a know problem ?
>>>>>
>>>>> Thanks,
>>>>>  ~preetham
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>         
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>
>>>>       
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>     
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>   
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39631-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 13:26:01 2009
Return-Path: <java-user-return-39631-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30024 invoked from network); 10 Apr 2009 13:26:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 13:26:01 -0000
Received: (qmail 16740 invoked by uid 500); 10 Apr 2009 13:25:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16644 invoked by uid 500); 10 Apr 2009 13:25:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16338 invoked by uid 99); 10 Apr 2009 13:25:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 13:25:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 13:25:44 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n3ADPKEp004370
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 09:25:22 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <49DF48C0.5060009@informatics.jax.org>
Date: Fri, 10 Apr 2009 09:25:20 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Query any data
References: <22953431.post@talk.nabble.com>	 <499888440904080903y47f8d828j92dd419cde53ce99@mail.gmail.com>	 <7d94dcde0904081809n9b0c790q4ca66c116b2431ff@mail.gmail.com> <359a92830904091009r230c24c8qea899d974118306c@mail.gmail.com>
In-Reply-To: <359a92830904091009r230c24c8qea899d974118306c@mail.gmail.com>
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: 8bit
X-PMX-Version: 5.5.1.360522, Antispam-Engine: 2.6.1.350677, Antispam-Data: 2009.4.10.131034
X-PerlMx-Spam: Gauge=XI, Probability=11%, Report='CN_TLD 0.5, MIME_CHARSET_FARAWAY 0.409, BODY_SIZE_2000_2999 0, BODY_SIZE_5000_LESS 0, BODY_SIZE_7000_LESS 0, ECARD_KNOWN_DOMAINS 0, LOCALE_CHINESE 0, TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __C230066_P5 0, __CANPHARM_UNSUB_LINK 0, __CHAR_CHINESE_CT 0, __CP_URI_IN_BODY 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __FRAUD_419_BODY_WEBMAIL 0, __FRAUD_419_WEBMAIL 0, __HAS_MSGID 0, __HIGHBITS 0, __MIME_CHARSET_FARAWAY 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __MOZILLA_MSGID 0, __SANE_MSGID 0, __TO_MALFORMED_2 0, __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

I think I would tackle this in a slightly different manner.

When you are creating this index, make sure that that field has a
default value. Make sure this value is something that could never appear
in the index otherwise. Then, when you goto place this field into the
index, either write out your actual value, or the default one.

Then when you get the document back, you can look at that field, and
solve your question. You can also craft queries that specifically avoid
entries that don't have a value in this field with a not clause.

Hope this helps,

Matt

Erick Erickson wrote:
> searching for fieldname:* will be *extremely* expensive as it will, by
> default,
> build a giant OR clause consisting of every term in the field. You'll throw
> MaxClauses exceptions right and left. I'd follow Tim's thread lead first....
>
> Best
> Erick
>
> 2009/4/8  <ww.wang.cs@gmail.com>
>
>   
>> first you should change your querypaser to accept wildcard query by calling
>> method of QueryParser
>>          setAllowLeadingWildcard
>> then you can query like this:  fieldname:*
>>
>> 2009/4/9 Tim Williams <williamstw@gmail.com>
>>
>>     
>>> On Wed, Apr 8, 2009 at 11:45 AM, addman <addiekong@yahoo.com> wrote:
>>>       
>>>> Hi,
>>>>   Is it possible to create a query to search a field for any value?  I
>>>>         
>>> just
>>>       
>>>> need to know if the optional field contain any data at all.
>>>>         
>>> google for:  lucene field existence
>>>
>>> There's no way built in, one strategy[1] is to have a 'meta field'
>>> that contains the names of the fields the document contains.
>>>
>>> --tim
>>>
>>> [1] -
>>> http://www.mail-archive.com/lucene-user@jakarta.apache.org/msg07703.html
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>       
>> --
>> (Weiwei Wang)
>> Department of Computer Science
>> Gulou Campus of Nanjing University
>> Nanjing, P.R.China, 210093
>>
>> Mobile: 86-13913310569
>> MSN: ww.wang.cs@gmail.com
>> Homepage: http://cs.nju.edu.cn/rl/weiweiwang
>>
>>     
>
>   


-- 
Matthew Hall
Software Engineer
Mouse Genome Informatics
mhall@informatics.jax.org
(207) 288-6012



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39632-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 13:28:41 2009
Return-Path: <java-user-return-39632-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31890 invoked from network); 10 Apr 2009 13:28:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 13:28:41 -0000
Received: (qmail 22758 invoked by uid 500); 10 Apr 2009 13:28:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22699 invoked by uid 500); 10 Apr 2009 13:28:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22517 invoked by uid 99); 10 Apr 2009 13:28:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 13:28:38 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of aminmc@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 13:28:30 +0000
Received: by fxm2 with SMTP id 2so1213190fxm.5
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 06:28:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=QVl5poqaJsSgDV6MjYWNOZVFooQZ/csWYSme8zXgJNM=;
        b=cyNhe+px1KX3o93fUUfTcz/UiF1dGLzOTM6JyFD/dEBqCCD/URadiQO/xwQ/shcykd
         +BanCAPTjugSmnFKHTAbWwly0P5nr7ygjcdLbtdXZfrvfHSm0Drf1MBNa1zISNjdDOx5
         zhboe73GFMhSyOsnRtiAtVRiHXXgWmY7kdtDo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=pvTiGK6K0ECUkFeZ1/y0TrP9K6eh1Zuu4bIG0PGSB4vPPRWWuFMJMKtynEXl3Ue2Ck
         FoFvweH4d2fV2NN9c4/+eRvj1jcMaMz66RAFtO+3UciXxG/S2UKArf+DMicatDe3nBjk
         t05/wVaAF0FH2jDJW5pDpqynhY56BXHFl8SAU=
MIME-Version: 1.0
Received: by 10.204.117.17 with SMTP id o17mr3286954bkq.145.1239370090353; 
	Fri, 10 Apr 2009 06:28:10 -0700 (PDT)
Date: Fri, 10 Apr 2009 14:28:10 +0100
Message-ID: <6f4104d80904100628q79150b4oa3e5436cfb66c581@mail.gmail.com>
Subject: SpellChecker in use with composite query
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=001636c5a26efb14f60467335577
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5a26efb14f60467335577
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi
I have been playing around with the SpellChecker class and so far it looks
really good.  While developing a testcase to show it working I came across a
couple of issues which I have resolved but I'm not certain if this is the
correct approach.  I would therefore be grateful if anyone could tell me
whether it is correct or I should try something else.

1) Multple Indexes:
I have multiple indexes which store different documents based on certain
subject matter.  So inorder to perform the spellchecking against all indexes
I did something like this:

IndexReader spellReader = IndexReader.open(fsDirectory1);

IndexReader spellReader2 = IndexReader.open(fsDirectory2);

MultiReader multiReader = new MultiReader(new IndexReader[]
{spellReader,spellReader2});

LuceneDictionary luceneDictionary = new LuceneDictionary(multiReader,
"content");

Directory spellDirectory = FSDirectory.getDirectory(<single index for
spellcheck);

SpellChecker spellChecker = new SpellChecker(spellDirectory);

spellChecker.indexDictionary(luceneDictionary);


Is this an acceptable approach or should there be a spellcheck index for
each seperate document index?



2) Composite query e.g. Luciene OR doqument

Inorder to handle the above i did the following:


QueryParser queryParser = new AnalyzingQueryParser("content",analyzer);

String input = "luciene OR doqument";

Query query = queryParser.parse(input);

String input2 = query.toString("content");

String[] splitString = input2.split(" ");


For each of the string in the array i performed the suggestSimilar(..).


Is this the most appropriate way of doing this?



Any help would be appreciated.


Cheers

Amin

--001636c5a26efb14f60467335577--

From java-user-return-39633-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 13:43:44 2009
Return-Path: <java-user-return-39633-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39955 invoked from network); 10 Apr 2009 13:43:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 13:43:43 -0000
Received: (qmail 35380 invoked by uid 500); 10 Apr 2009 13:43:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35296 invoked by uid 500); 10 Apr 2009 13:43:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35286 invoked by uid 99); 10 Apr 2009 13:43:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 13:43:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of williamstw@gmail.com designates 74.125.46.29 as permitted sender)
Received: from [74.125.46.29] (HELO yw-out-2324.google.com) (74.125.46.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 13:43:34 +0000
Received: by yw-out-2324.google.com with SMTP id 9so612675ywe.5
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 06:43:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=KiCqsEc2PVyPeu2YXYq6w71kDbhAeHReO43PH0E8Dxo=;
        b=JPc1N9rCUMMSrwic2KA5ECOE8P9SaLeNNkFfpMsguhRDL1iIwRPAcYO5VAbXDZ4DO3
         ZoJhS2OTKnr5AZM5scV5sMf6rtrcyoWsO8mLh8uq0Scsk9dUaPVmWSCFtCxuMsoHoHoN
         F2MBX79Xv87oi1XKUn6rdEgYt+TgpIZpYYPjw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=B+KWVZAxASjmmDob6/UmpMPT2XLHqeQVtSQTcq01sjGiXSlpipR8s/UBkSgh3N0acF
         YBFWwqUurGD3gB8269Nd64yZcHCw3jXmbNOaN6C8lIgglPKuLz1wVaGfomLWEv88lBTR
         VuN2xDHB4IIkwAa+Vn27gB9BS1WXkOuG5potg=
MIME-Version: 1.0
Received: by 10.150.196.20 with SMTP id t20mr6747918ybf.122.1239370994009; 
	Fri, 10 Apr 2009 06:43:14 -0700 (PDT)
In-Reply-To: <49DF48C0.5060009@informatics.jax.org>
References: <22953431.post@talk.nabble.com>
	 <499888440904080903y47f8d828j92dd419cde53ce99@mail.gmail.com>
	 <7d94dcde0904081809n9b0c790q4ca66c116b2431ff@mail.gmail.com>
	 <359a92830904091009r230c24c8qea899d974118306c@mail.gmail.com>
	 <49DF48C0.5060009@informatics.jax.org>
Date: Fri, 10 Apr 2009 09:43:13 -0400
Message-ID: <499888440904100643q17caec2akb24ad97d9b69e4a6@mail.gmail.com>
Subject: Re: Query any data
From: Tim Williams <williamstw@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

2009/4/10 Matthew Hall <mhall@informatics.jax.org>:
> I think I would tackle this in a slightly different manner.
>
> When you are creating this index, make sure that that field has a
> default value. Make sure this value is something that could never appear
> in the index otherwise. Then, when you goto place this field into the
> index, either write out your actual value, or the default one.
>
> Then when you get the document back, you can look at that field, and
> solve your question. You can also craft queries that specifically avoid
> entries that don't have a value in this field with a not clause.

I think this is limited by...

... not being able to [easily] add new fields over time... you'd have
to reindex all documents (to insert the new magic token) just to add a
new field.

... requiring additional manipulation for appendable, updateable
fields... when you append new data to a field, you'd have to go in and
remove the special token.

--tim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39634-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 13:52:14 2009
Return-Path: <java-user-return-39634-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44664 invoked from network); 10 Apr 2009 13:52:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 13:52:14 -0000
Received: (qmail 44287 invoked by uid 500); 10 Apr 2009 13:52:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44218 invoked by uid 500); 10 Apr 2009 13:52:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44186 invoked by uid 99); 10 Apr 2009 13:52:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 13:52:08 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [150.148.0.65] (HELO ironport4.fda.gov) (150.148.0.65)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 13:52:01 +0000
X-SBRS: None
X-MID: 129318345
Received: from fmd3tj002.fda.gov ([10.160.10.77])
  by ironport4.fda.gov with ESMTP; 10 Apr 2009 09:51:40 -0400
Received: from FMD3VS012.fda.gov ([10.160.10.61]) by FMD3TJ002.fda.gov with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 10 Apr 2009 09:51:40 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Wordnet indexing error
Date: Fri, 10 Apr 2009 09:51:39 -0400
Message-ID: <F8A04958BB57B64096F9BE6B9572564304C73BBA@FMD3VS012.fda.gov>
In-Reply-To: <273311.72887.qm@web50310.mail.re2.yahoo.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Wordnet indexing error
Thread-Index: Acm40Oo6qNKBCJNqSTuXBT7GAb3gvABEdUQg
References: <F8A04958BB57B64096F9BE6B9572564304C73BB9@FMD3VS012.fda.gov> <273311.72887.qm@web50310.mail.re2.yahoo.com>
From: "Sudarsan, Sithu D." <Sithu.Sudarsan@fda.hhs.gov>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 10 Apr 2009 13:51:40.0011 (UTC) FILETIME=[7945EBB0:01C9B9E3]
X-Virus-Checked: Checked by ClamAV on apache.org

=20
Thanks Otis,

Yes, we figured that out! Since, we do not intend to migrate to 2.4 yet,
we used the syns2index source code from svn. The problem is now taken
care.

This part is for all:=20

This brings us to the next question:=20

1. Is there some contrib code available for using hypernyms and such, in
addition to synonyms from Wordnet?
2. Is there some code to add user defined dictionary/ontology, as an
additional layer to Wordnet (some sort of multi-level)?

Thank you all in advance,

Sincerely,
Sithu=20

-----Original Message-----
From: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com]=20
Sent: Thursday, April 09, 2009 1:06 AM
To: java-user@lucene.apache.org
Subject: Re: Wordnet indexing error


Hi,

The simplest thing to do is to grab the latest Lucene and the latest jar
for that Wordnet (syns2index) code.  That should work for you (that
UnIndexed method is an old method that doesn't exist any more).


Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch



----- Original Message ----
> From: "Sudarsan, Sithu D." <Sithu.Sudarsan@fda.hhs.gov>
> To: java-user@lucene.apache.org
> Sent: Wednesday, April 8, 2009 7:01:16 PM
> Subject: Wordnet indexing error
>=20
> Hi All,
>=20
> We're using Lucene 2.3.2 on Windows. When we try to generate index for
> WordNet2.0 using Syns2Index class, while indexing, the following error
> is thrown:
>=20
> Java.lang.NoSuchMethodError:
>
org.apache.lucene.document.Field.UnIndexed(Ljava/lang/String;Ljava/lang/
> String;)Lorg/apache/lucene/document/Field;
>=20
> Our code is looks like this:
>=20
> String[] filelocations =3D {"path/to/prolog/file", "path/to/index"};
> try{
>      Syns2Index.main(filelocations);
> } catch ....
>=20
>=20
> The error typically happens at about line number 130000 in the wn_s.pl
> file.
>=20
> No luck with WordNet3.0 as well. We get the same error.
>=20
> Any fix or solutions?=20
>=20
> Thanks in advance,
> Sithu D Sudarsan
>=20
> sithu.sudarsan@fda.hhs.gov
> sdsudarsan@ualr.edu


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39635-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 14:38:43 2009
Return-Path: <java-user-return-39635-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99679 invoked from network); 10 Apr 2009 14:38:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 14:38:43 -0000
Received: (qmail 99310 invoked by uid 500); 10 Apr 2009 14:38:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99242 invoked by uid 500); 10 Apr 2009 14:38:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99232 invoked by uid 99); 10 Apr 2009 14:38:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 14:38:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of r.ventaglio@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 14:38:34 +0000
Received: by fxm2 with SMTP id 2so1246271fxm.5
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 07:38:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=vFaXFlcQ19blovxLCOFhCQM+ooAttbkKxuJAmudJo4U=;
        b=NMKQKO/6/4lQKcnAq2IBA6Qls0uVXCNxCMAhadsNxrWffSDyuzdjUN4HQB1oZJzNWJ
         PqnWq3QZPXGh/+q6rpCq0OjIoZ3Mb/RN+/ts5tv7ultD5XVoTEmgK6QeCV5z+tesCuu1
         rWBh0J+BQzC3Wmzu5YVcInNwFIk9DJtvHUe8E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=BwSwNjzejD9BdypVFJjTU4seQvzR99duWCzb/ITFck4JG0RH4nzmJc1Aov648yzzH3
         scCPWywkNvDcM0OJmq1BOXMQ5PF2RSbMvVoruU6Ltg/DtbWfOX+Z8VFJPAM+Bzzu9D8k
         SUlvhVb1XCVWMTDW4ZYI9d3dkb6FXNXNHi+p4=
MIME-Version: 1.0
Received: by 10.103.241.15 with SMTP id t15mr1878897mur.85.1239374292770; Fri, 
	10 Apr 2009 07:38:12 -0700 (PDT)
Date: Fri, 10 Apr 2009 16:38:12 +0200
Message-ID: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
Subject: RangeFilter performance problem using MultiReader
From: Raf <r.ventaglio@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636b430c876de2804673450a5
X-Virus-Checked: Checked by ClamAV on apache.org

--001636b430c876de2804673450a5
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,
we are experiencing some problems using RangeFilters and we think there are
some performance issues caused by MultiReader.

We have more or less 3M documents in 24 indexes and we read all of them
using a MultiReader.
If we do a search using only terms, there are no problems, but it if we add
to the same search terms a RangeFilter that extracts a large subset of the
documents (e.g. 500K), it takes a lot of time to execute (about 15s).

In order to identify the problem, we have tried to consolidate the index: so
now we have the same 3M docs in a single 10GB index.
If we repeat the same search using this index, it takes only a small
fraction of the previous time (about 2s).

Is there something we can do to improve search performance using
RangeFilters with MultiReader or the only solution is to have only a single
big index?

Thanks,
Raf

--001636b430c876de2804673450a5--

From java-user-return-39636-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 14:49:05 2009
Return-Path: <java-user-return-39636-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2882 invoked from network); 10 Apr 2009 14:49:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 14:49:05 -0000
Received: (qmail 12578 invoked by uid 500); 10 Apr 2009 14:49:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12473 invoked by uid 500); 10 Apr 2009 14:49:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12463 invoked by uid 99); 10 Apr 2009 14:49:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 14:49:02 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.168] (HELO wf-out-1314.google.com) (209.85.200.168)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 14:48:54 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1113423wff.20
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 07:48:32 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.178.9 with SMTP id a9mr1336322wff.73.1239374912363; Fri, 
	10 Apr 2009 07:48:32 -0700 (PDT)
In-Reply-To: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
Date: Fri, 10 Apr 2009 10:48:32 -0400
Message-ID: <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Unfortunately, in Lucene 2.4, any query that needs to enumerate Terms
(Prefix, Wildcard, Range, etc.) has poor performance on Multi*Readers.
 I think the only workaround is to merge your indexes down to a single
index.

But, Lucene trunk (not yet released) has fixed this, so that searching
through your MultiReader should give you the same performance as
searching on a single consolidated index -- if you test this (which
would be awesome!) please report back and let us know how it went.

Mike

On Fri, Apr 10, 2009 at 10:38 AM, Raf <r.ventaglio@gmail.com> wrote:
> Hi,
> we are experiencing some problems using RangeFilters and we think there are
> some performance issues caused by MultiReader.
>
> We have more or less 3M documents in 24 indexes and we read all of them
> using a MultiReader.
> If we do a search using only terms, there are no problems, but it if we add
> to the same search terms a RangeFilter that extracts a large subset of the
> documents (e.g. 500K), it takes a lot of time to execute (about 15s).
>
> In order to identify the problem, we have tried to consolidate the index: so
> now we have the same 3M docs in a single 10GB index.
> If we repeat the same search using this index, it takes only a small
> fraction of the previous time (about 2s).
>
> Is there something we can do to improve search performance using
> RangeFilters with MultiReader or the only solution is to have only a single
> big index?
>
> Thanks,
> Raf
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39637-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 15:04:04 2009
Return-Path: <java-user-return-39637-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14447 invoked from network); 10 Apr 2009 15:04:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 15:04:04 -0000
Received: (qmail 28758 invoked by uid 500); 10 Apr 2009 15:04:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28700 invoked by uid 500); 10 Apr 2009 15:04:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28690 invoked by uid 99); 10 Apr 2009 15:04:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 15:04:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 74.125.92.24 as permitted sender)
Received: from [74.125.92.24] (HELO qw-out-2122.google.com) (74.125.92.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 15:03:52 +0000
Received: by qw-out-2122.google.com with SMTP id 8so790560qwh.53
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 08:03:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=s/2xRdvv5OiDgGY8Glof01pRIAAA82cpzETc4ZszMTo=;
        b=a/hUYzXQmsmwk1mqe4ieklnPCEcuSfAK6D1naoOTzIkjlGylO2/JEcEoDX9fh8ZMF0
         AdabxL8CWg+l1/ujHeR/iFZHzR+RzR55sorvOOpY9pAcMUuvQJtAe8KOf2WrEJ2+V5Qc
         uFt6VDMOb3oyqv2HeGECqYnIZPH4Qi1hZJtmM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=kKYsZJT0l36WySs5weooSc580upYOs6vIR99DpUOa+o1KywfqXFib7c17/vLGZysVY
         oai3Xepf3hzS4NY104iTcNdsUcGLwArRNVD4NB6T635L7CBxX+C8RLywH7LuGP3wqNuU
         qP5j/5A/WHwigIXG7x2Kfo0Iv+KkJaDU0ctYo=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.229.81.136 with SMTP id x8mr1173247qck.49.1239375810836; Fri, 
	10 Apr 2009 08:03:30 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
Date: Fri, 10 Apr 2009 11:03:30 -0400
X-Google-Sender-Auth: 5e0a5b165201bdf3
Message-ID: <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 10, 2009 at 10:48 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> Unfortunately, in Lucene 2.4, any query that needs to enumerate Terms
> (Prefix, Wildcard, Range, etc.) has poor performance on Multi*Readers.

Do we know why this is, and if it's fixable (the MultiTermEnum, not
the higher level query objects)?  Is it simply the maintenance of the
priority queue, or something else?

-Yonik
http://www.lucidimagination.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39638-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 15:54:41 2009
Return-Path: <java-user-return-39638-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33699 invoked from network); 10 Apr 2009 15:54:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 15:54:41 -0000
Received: (qmail 88480 invoked by uid 500); 10 Apr 2009 15:54:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88400 invoked by uid 500); 10 Apr 2009 15:54:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88390 invoked by uid 99); 10 Apr 2009 15:54:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 15:54:37 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.202.165.33] (HELO smtpauth11.prod.mesa1.secureserver.net) (64.202.165.33)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 10 Apr 2009 15:54:29 +0000
Received: (qmail 8774 invoked from network); 10 Apr 2009 15:53:58 -0000
Received: from unknown (64.202.165.33)
  by smtpauth11.prod.mesa1.secureserver.net (64.202.165.33) with ESMTP; 10 Apr 2009 15:53:57 -0000
Message-ID: <49DF6B91.1090504@getopt.org>
Date: Fri, 10 Apr 2009 17:53:53 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Help to determine why an optimized index is proportionaly too
 big.
References: <24098ED350C76D46A4FDBD81B51BE0E9034CB5E91B@exchange.windows.mmu.acquiremedia.com> <Pine.LNX.4.64.0904091542330.31507@radix.cryptio.net>
In-Reply-To: <Pine.LNX.4.64.0904091542330.31507@radix.cryptio.net>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Chris Hostetter wrote:
> : The second stage index failed an optimization with a disk full exception 
> : (I had to move it to another lucene machine with a larger disk partition 
> : to complete the optimization. Is there a reason why a 22 day index would 
> : be 10x the size of an 8 day index when the document indexing rate is 
> : fairly constant? Also, is there a way to shrink the index without 
> : regenerating it?
> 
> did you run CheckIndex after it failed to optimize the first time?  the 
> failure may have left old temp files arround that aren't actually part of 
> the index but are taking up space. 
> 
> (Actually: does CheckIndex warn about unused files in the index directory 
> so people can clean them up? i'm not sure)

It doesn't. But Luke has a function to do this.


-- 
Best regards,
Andrzej Bialecki     <><
  ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39639-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 17:20:41 2009
Return-Path: <java-user-return-39639-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54350 invoked from network); 10 Apr 2009 17:20:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 17:20:41 -0000
Received: (qmail 27476 invoked by uid 500); 10 Apr 2009 17:20:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27395 invoked by uid 500); 10 Apr 2009 17:20:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27385 invoked by uid 99); 10 Apr 2009 17:20:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 17:20:38 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of r.ventaglio@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 17:20:31 +0000
Received: by fxm2 with SMTP id 2so1321378fxm.5
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 10:20:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Cold/TwHWwReV/kyvbpKlsz/nbdReQkxz214q9fxO60=;
        b=kbw0Yrp52/6V0QcOuesfZxqnBmdYZpXlKBPR0ZVqbyd9DBj8VlkDpvT2NW/9WZhUG5
         A8FgIodQE/IBuT0otb5DSeoI/CpfhvZ79WmZiDYWpycgimdB7kvDyXhzXn+0kOoiBLUp
         Y4lg2XV8eygl6dnRYoxnLMgfUNHFRqcRcILgA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=sNN2dXL2Zv5R/GTWoagJf0El2k8AiMJOkxo3/aJfdFo5u1kygP2SkJabKhE/YYYgu7
         qGW5R3BktbdyMsPNs+x/GFhICStaXQ93wTRuZ5QNiq+jY430jbJ6i4uYOr+vpXE445vF
         WQ5KNNSHEORWpxudVtljnnH2yGz2oVhAO4UZU=
MIME-Version: 1.0
Received: by 10.103.252.17 with SMTP id e17mr1957623mus.14.1239384010106; Fri, 
	10 Apr 2009 10:20:10 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
Date: Fri, 10 Apr 2009 19:20:10 +0200
Message-ID: <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Raf <r.ventaglio@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636417ed5a9accf0467369302
X-Virus-Checked: Checked by ClamAV on apache.org

--001636417ed5a9accf0467369302
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Mike,
thank you for your answer.

I have downloaded lucene-core-2.9-dev and I have executed my tests (both on
multireader and on consolidated index) using this new version, but the
performance are very similar to the previous ones.
The big index is 7/8 times faster than multireader version.

Raf

On Fri, Apr 10, 2009 at 4:48 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> Unfortunately, in Lucene 2.4, any query that needs to enumerate Terms
> (Prefix, Wildcard, Range, etc.) has poor performance on Multi*Readers.
>  I think the only workaround is to merge your indexes down to a single
> index.
>
> But, Lucene trunk (not yet released) has fixed this, so that searching
> through your MultiReader should give you the same performance as
> searching on a single consolidated index -- if you test this (which
> would be awesome!) please report back and let us know how it went.
>
> Mike
>
> On Fri, Apr 10, 2009 at 10:38 AM, Raf <r.ventaglio@gmail.com> wrote:
> > Hi,
> > we are experiencing some problems using RangeFilters and we think there
> are
> > some performance issues caused by MultiReader.
> >
> > We have more or less 3M documents in 24 indexes and we read all of them
> > using a MultiReader.
> > If we do a search using only terms, there are no problems, but it if we
> add
> > to the same search terms a RangeFilter that extracts a large subset of
> the
> > documents (e.g. 500K), it takes a lot of time to execute (about 15s).
> >
> > In order to identify the problem, we have tried to consolidate the index:
> so
> > now we have the same 3M docs in a single 10GB index.
> > If we repeat the same search using this index, it takes only a small
> > fraction of the previous time (about 2s).
> >
> > Is there something we can do to improve search performance using
> > RangeFilters with MultiReader or the only solution is to have only a
> single
> > big index?
> >
> > Thanks,
> > Raf
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636417ed5a9accf0467369302--

From java-user-return-39640-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 17:30:59 2009
Return-Path: <java-user-return-39640-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63778 invoked from network); 10 Apr 2009 17:30:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 17:30:59 -0000
Received: (qmail 45712 invoked by uid 500); 10 Apr 2009 17:30:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45642 invoked by uid 500); 10 Apr 2009 17:30:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45632 invoked by uid 99); 10 Apr 2009 17:30:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 17:30:56 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 17:30:47 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LsKYc-0006Ft-SB
	for java-user@lucene.apache.org; Fri, 10 Apr 2009 10:30:26 -0700
Message-ID: <22991689.post@talk.nabble.com>
Date: Fri, 10 Apr 2009 10:30:26 -0700 (PDT)
From: AlexElba <ramalex1@yahoo.com>
To: java-user@lucene.apache.org
Subject: Lucene SnowBall unexpected behavior for some terms
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ramalex1@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,
I was working with lucene snowball 2.3.2 and I switch to 2.4.0. 
After switch I came by to some case where lucene doesn't do lemmatization
correctly. So far I found only one case spa - spas. spas are not getting
lemmatize at all...
BTW I saw the same behavior on solr 1.3


Anybody have any idea why?
-- 
View this message in context: http://www.nabble.com/Lucene-SnowBall-unexpected-behavior-for-some-terms-tp22991689p22991689.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39641-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 17:47:56 2009
Return-Path: <java-user-return-39641-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75170 invoked from network); 10 Apr 2009 17:47:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 17:47:56 -0000
Received: (qmail 74859 invoked by uid 500); 10 Apr 2009 17:47:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74806 invoked by uid 500); 10 Apr 2009 17:47:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74796 invoked by uid 99); 10 Apr 2009 17:47:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 17:47:54 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.171] (HELO wf-out-1314.google.com) (209.85.200.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 17:47:45 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1163308wff.20
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 10:47:24 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.18.21 with SMTP id v21mr1373665wfi.336.1239385644790; Fri, 
	10 Apr 2009 10:47:24 -0700 (PDT)
In-Reply-To: <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>
Date: Fri, 10 Apr 2009 13:47:24 -0400
Message-ID: <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org, yonik@lucidimagination.com
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 10, 2009 at 11:03 AM, Yonik Seeley
<yonik@lucidimagination.com> wrote:
> On Fri, Apr 10, 2009 at 10:48 AM, Michael McCandless
> <lucene@mikemccandless.com> wrote:
>> Unfortunately, in Lucene 2.4, any query that needs to enumerate Terms
>> (Prefix, Wildcard, Range, etc.) has poor performance on Multi*Readers.
>
> Do we know why this is, and if it's fixable (the MultiTermEnum, not
> the higher level query objects)? =A0Is it simply the maintenance of the
> priority queue, or something else?

We never fully explained it, but we have some ideas...

It's only if you iterate each term, and do a TermDocs.seek for each,
that Multi*Reader seems to show the problem.  Just iterating the terms
seems OK (I have a 51 segment index, and I can iterate ~ 10M unique
terms in ~8 seconds).

But loading FieldCache, or doing eg RangeQuery, also does a
MultiTermDocs.seek on each term, which in turn calls
SegmentTermDocs.seek for each of the sub-readers in sequence.  I
*think* maybe for highly unique terms, where typically all segments
but one actually have the term, the cost of invoking seek on those
segments without the term is high.  Really, somehow, we want to only
call seek on those segments that have the term, which we know from the
pqueue...

Mike

> -Yonik
> http://www.lucidimagination.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39642-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 17:54:59 2009
Return-Path: <java-user-return-39642-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79163 invoked from network); 10 Apr 2009 17:54:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 17:54:59 -0000
Received: (qmail 94938 invoked by uid 500); 10 Apr 2009 17:54:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94891 invoked by uid 500); 10 Apr 2009 17:54:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94881 invoked by uid 99); 10 Apr 2009 17:54:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 17:54:57 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.174] (HELO wf-out-1314.google.com) (209.85.200.174)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 17:54:50 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1165101wff.20
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 10:54:28 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.241.15 with SMTP id o15mr1385865wfh.104.1239386068315; 
	Fri, 10 Apr 2009 10:54:28 -0700 (PDT)
In-Reply-To: <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com>
Date: Fri, 10 Apr 2009 13:54:28 -0400
Message-ID: <9ac0c6aa0904101054o6cbfe83dhe0f2956151580f53@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 10, 2009 at 1:20 PM, Raf <r.ventaglio@gmail.com> wrote:
> Hi Mike,
> thank you for your answer.
>
> I have downloaded lucene-core-2.9-dev and I have executed my tests (both on
> multireader and on consolidated index) using this new version, but the
> performance are very similar to the previous ones.
> The big index is 7/8 times faster than multireader version.

Hmmm, interesting!

Can you provide more details about your tests?  EG the code fragment
showing your query, the creation of the MultiReader, how you run the
search, etc.?

Is the field that you're applying the RangeFilter on highly unique or
rather redundant?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39643-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 18:33:29 2009
Return-Path: <java-user-return-39643-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6091 invoked from network); 10 Apr 2009 18:33:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 18:33:29 -0000
Received: (qmail 72461 invoked by uid 500); 10 Apr 2009 18:33:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72411 invoked by uid 500); 10 Apr 2009 18:33:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72401 invoked by uid 99); 10 Apr 2009 18:33:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 18:33:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 74.125.92.24 as permitted sender)
Received: from [74.125.92.24] (HELO qw-out-2122.google.com) (74.125.92.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 18:33:18 +0000
Received: by qw-out-2122.google.com with SMTP id 8so845251qwh.53
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 11:32:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :organization:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        bh=WQ+uk0PwLc7ug6t2PoAMTk9GGxUGYO8/BhItvXkTUfs=;
        b=LdXGpIgtQ1kARdVaFhMzOWvT3AECgkDgDOu9pLvJz4ISRBd/RXWQntjggGBV24uWum
         dKPxOOZonMXNE4ctmcCln4q3r3V8b++iWifwjc5eXoCRSvrcEI+SwZuaUGttrXYK4OwH
         tTymeMWGz+hOy7v3TmdzuS3qcICQD79TxPsYo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:organization:user-agent:mime-version:to
         :subject:references:in-reply-to:content-type
         :content-transfer-encoding;
        b=ZcQIir0d0J/iU/tRz2iMn2J5ZJysYJDR44ARgTP7hP5pbbgx7KvjTYFx6vMRgJugxM
         m+HSuWxY/E/XdZ+5lrRrqxxbjN8z/LjhMU4HKZadRDWzNhFr7MZSIcgwvPlZs/cdqlmj
         n5yX847UxqIhdMU1xWkCpOtgkYdRZokqumocg=
Received: by 10.224.37.5 with SMTP id v5mr4321678qad.84.1239388377641;
        Fri, 10 Apr 2009 11:32:57 -0700 (PDT)
Received: from ?192.168.1.120? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 7sm2709861qwb.11.2009.04.10.11.32.56
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 10 Apr 2009 11:32:56 -0700 (PDT)
Message-ID: <49DF90D7.6020304@lucidimagination.com>
Date: Fri, 10 Apr 2009 14:32:55 -0400
From: Mark Miller <markrmiller@gmail.com>
Organization: Lucid Imagination
User-Agent: Thunderbird 2.0.0.21 (X11/20090409)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: RangeFilter performance problem using MultiReader
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>	 <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com> <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>
In-Reply-To: <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

When I did some profiling I saw that the slow down came from tons of 
extra seeks (single segment vs multisegment). What was happening was, 
the first couple segments would have thousands of terms for the field, 
but as the segments logarithmically shrank in size, the number of terms 
for the segment would drop dramatically - you basically end up with a 
long tail eg 5000 4000 200 200 5 5 2. Because loading the field cache 
would enumerate every term it would end up calling seek 5000 times 
against each segment - that appeared to be the slowdown for me.

We fixed this with 1483 because we load the fieldcache per segment and 
so instead of calling seek 5000 times for each segment, you call 5000 
for the fist, 4000 for the next, then 200, 200, 5 and 5. Can add up to 
huge savings do the long tail of low term segments.

I had thought we would also see the advantage with multi-term queries - 
you rewrite against each segment and avoid extra seeks (though not 
nearly as many as when enumerating every term). As Mike pointed out to 
me back when though : we still rewrite against the multi-reader and so 
see no real savings here. Unfortunately.

- Mark


>> Do we know why this is, and if it's fixable (the MultiTermEnum, not
>> the higher level query objects)?  Is it simply the maintenance of the
>> priority queue, or something else?
>>     
>
> We never fully explained it, but we have some ideas...
>
> It's only if you iterate each term, and do a TermDocs.seek for each,
> that Multi*Reader seems to show the problem.  Just iterating the terms
> seems OK (I have a 51 segment index, and I can iterate ~ 10M unique
> terms in ~8 seconds).
>
> But loading FieldCache, or doing eg RangeQuery, also does a
> MultiTermDocs.seek on each term, which in turn calls
> SegmentTermDocs.seek for each of the sub-readers in sequence.  I
> *think* maybe for highly unique terms, where typically all segments
> but one actually have the term, the cost of invoking seek on those
> segments without the term is high.  Really, somehow, we want to only
> call seek on those segments that have the term, which we know from the
> pqueue...
>
> Mike
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39644-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 18:51:30 2009
Return-Path: <java-user-return-39644-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10944 invoked from network); 10 Apr 2009 18:51:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 18:51:30 -0000
Received: (qmail 99296 invoked by uid 500); 10 Apr 2009 18:51:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99225 invoked by uid 500); 10 Apr 2009 18:51:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99215 invoked by uid 99); 10 Apr 2009 18:51:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 18:51:27 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.170] (HELO wf-out-1314.google.com) (209.85.200.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 18:51:19 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1179866wff.20
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 11:50:57 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.4.11 with SMTP id g11mr1391428wfi.340.1239389457671; Fri, 
	10 Apr 2009 11:50:57 -0700 (PDT)
In-Reply-To: <49DF90D7.6020304@lucidimagination.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>
	 <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>
	 <49DF90D7.6020304@lucidimagination.com>
Date: Fri, 10 Apr 2009 14:50:57 -0400
Message-ID: <9ac0c6aa0904101150n12578f4al3bc4a8632d54fe1c@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 10, 2009 at 2:32 PM, Mark Miller <markrmiller@gmail.com> wrote:

> I had thought we would also see the advantage with multi-term queries - you
> rewrite against each segment and avoid extra seeks (though not nearly as
> many as when enumerating every term). As Mike pointed out to me back when
> though : we still rewrite against the multi-reader and so see no real
> savings here. Unfortunately.

But, RangeQuery.rewrite is simply enumerating terms, which I think is
working "OK".

It's enumerting terms, then seeking a sister TermDocs to each term,
that tickles the over-seeking problem.  FieldCache does that, and
RangeFilter on 2.4 does that, but RangeFilter (or RangeQuery with
constant score mode) on 2.9 should not (they should do it per
segment), which is why I'm baffled that Raf didn't see a speedup on
upgrading.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39645-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 19:00:55 2009
Return-Path: <java-user-return-39645-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14184 invoked from network); 10 Apr 2009 19:00:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 19:00:54 -0000
Received: (qmail 19833 invoked by uid 500); 10 Apr 2009 19:00:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19758 invoked by uid 500); 10 Apr 2009 19:00:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19748 invoked by uid 99); 10 Apr 2009 19:00:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:00:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:00:41 +0000
Received: by qw-out-2122.google.com with SMTP id 8so852007qwh.53
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 12:00:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=uP41YzcnclkJ1bk08hGJATSEfsAXUG+uVkNdMsIf3mU=;
        b=Dm1AYFtXRfQM1E+LJMBUqzQNFBdJ5YTyknZjjMcMu7W/+bgFV8oXLluiGgdiQ5onBL
         +/0nrx4eMLWKh2kIoDTb8wxtNy86lU5iXeNvKfSvOXVYJIUZVJRjJKRsQ0G9VR+zjb83
         5zm8mDA5rNqh5yocQqwuBecqLi2Ai500pdF2o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=DNOZO7byKQ5Ot7ijANZBmeWmBbljyg46r4nPrlLUNIOlK5AYdpUc/mCxul26uh3McW
         SRvYn6PX7NGjXuEdKPdhBfFtaj7USaeTvO8QGg1veX2jJbByAvsOxHpvmmSuJNkd5oFx
         Ecclh5PgPQJBPpwplIUfykqVL9ufY0l5OoiT0=
Received: by 10.224.45.72 with SMTP id d8mr4353711qaf.155.1239390020787;
        Fri, 10 Apr 2009 12:00:20 -0700 (PDT)
Received: from ?192.168.1.120? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 5sm2765201qwg.24.2009.04.10.12.00.20
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 10 Apr 2009 12:00:20 -0700 (PDT)
Message-ID: <49DF9743.9050801@gmail.com>
Date: Fri, 10 Apr 2009 15:00:19 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.21 (X11/20090409)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: RangeFilter performance problem using MultiReader
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>	 <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>	 <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>	 <49DF90D7.6020304@lucidimagination.com> <9ac0c6aa0904101150n12578f4al3bc4a8632d54fe1c@mail.gmail.com>
In-Reply-To: <9ac0c6aa0904101150n12578f4al3bc4a8632d54fe1c@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Michael McCandless wrote:
> On Fri, Apr 10, 2009 at 2:32 PM, Mark Miller <markrmiller@gmail.com> wrote:
>
>   
>> I had thought we would also see the advantage with multi-term queries - you
>> rewrite against each segment and avoid extra seeks (though not nearly as
>> many as when enumerating every term). As Mike pointed out to me back when
>> though : we still rewrite against the multi-reader and so see no real
>> savings here. Unfortunately.
>>     
>
> But, RangeQuery.rewrite is simply enumerating terms, which I think is
> working "OK".
>
> It's enumerting terms, then seeking a sister TermDocs to each term,
> that tickles the over-seeking problem.  FieldCache does that, and
> RangeFilter on 2.4 does that, but RangeFilter (or RangeQuery with
> constant score mode) on 2.9 should not (they should do it per
> segment), which is why I'm baffled that Raf didn't see a speedup on
> upgrading.
>
> Mike
Ah, right - anything utilizing a filter will see the gain. It wouldn't 
be such a big gain unless there were a *lot* of matching terms though 
right? Fieldcache is so bad because its every term. A smaller percentage 
of terms for a field won't be nearly the problem.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39646-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 19:06:46 2009
Return-Path: <java-user-return-39646-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16022 invoked from network); 10 Apr 2009 19:06:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 19:06:46 -0000
Received: (qmail 31256 invoked by uid 500); 10 Apr 2009 19:06:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31182 invoked by uid 500); 10 Apr 2009 19:06:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31165 invoked by uid 99); 10 Apr 2009 19:06:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:06:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:06:33 +0000
Received: by qyk8 with SMTP id 8so1944818qyk.29
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 12:06:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=bm5JAWL/ptAXYxqUp59EQ/1m7jcV5R1m893ZdA26miw=;
        b=xPa38qkZccv7CbSapVohHVqczoSwDqX57uqJ/KBbS1tFJ7aGnmqz0MRzqWMvQ5rvFG
         oTRvOQ4Oae7iNL1VF2GASYGSZhIa5JF0nP3cOEutAslSu3NkvztZ7ju6J0AilMaa2K1j
         41x+1yYMRF3YhrqACIbY4v3sAYNguHNnUjMsA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=A2n8d0Xa+oe8NVyHQM4xqH7xmLRyujGngE2JYKlmmAMaK2puiFp4sh+LCRJlw3jK+0
         kGSZDUb14NOrfkmg1Wd/vn0fX27cHooNtIF8Y60gFMbNz1Tw+faQWkV2OevhWuC3j87A
         GuzlU/DByXCpyNtPHxhdZ5pQxcTlthDTPRey0=
Received: by 10.224.60.202 with SMTP id q10mr4360572qah.243.1239390372351;
        Fri, 10 Apr 2009 12:06:12 -0700 (PDT)
Received: from ?192.168.1.120? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 6sm2624056qwk.47.2009.04.10.12.06.11
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 10 Apr 2009 12:06:11 -0700 (PDT)
Message-ID: <49DF98A2.7090609@gmail.com>
Date: Fri, 10 Apr 2009 15:06:10 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.21 (X11/20090409)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: RangeFilter performance problem using MultiReader
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>	 <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>	 <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>	 <49DF90D7.6020304@lucidimagination.com> <9ac0c6aa0904101150n12578f4al3bc4a8632d54fe1c@mail.gmail.com>
In-Reply-To: <9ac0c6aa0904101150n12578f4al3bc4a8632d54fe1c@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Michael McCandless wrote:
>
> which is why I'm baffled that Raf didn't see a speedup on
> upgrading.
>
> Mike
>   
Another point is that he may not have such a nasty set of segments - Raf 
says he has 24 indexes, which sounds like he may not have the 
logarithmic sizing you normally see. If you have somewhat normal term 
distribution for all 24 segments, the problem is not exasperated nearly 
as much (along with not being so bad as its not using all of the terms 
for the field).

24 segments is bound to be quite a bit slower than an optimized index 
for most things - also 24 segments of similar size may also be worse 
than the normal 24 segments with log dropping size.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39647-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 19:12:26 2009
Return-Path: <java-user-return-39647-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16910 invoked from network); 10 Apr 2009 19:12:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 19:12:24 -0000
Received: (qmail 40246 invoked by uid 500); 10 Apr 2009 19:12:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40165 invoked by uid 500); 10 Apr 2009 19:12:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40155 invoked by uid 99); 10 Apr 2009 19:12:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:12:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:12:13 +0000
Received: by qyk8 with SMTP id 8so1948029qyk.29
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 12:11:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=QPB23X3sQV4FTbUnGmBQ/QV33J5cm/S6wDtSg9s2Gz0=;
        b=bnHg3+cErSKyXaBj8TuvAxULqVi9ebJZPSK+BTHE4IbFm1AMJDLkzScNu1U/6yUVEZ
         EDcL5R7EYRfWi/VFVjp8MdrtM1h7hnE3KtIKJGFARNXWjzJo2Ab6Uu7UUIVOmubsHgyF
         K25PZ7iYa7lSqggcDHkk3dE3FcvnfVplaV6xY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=NKraI9NH6D7tPcdqzVEwdeNYi/+nnrPrmDGKRCDKI4o9AA0SvG4Y+5zH6/cjl9Wk8u
         JNaXOdQIzDxoZvEz82futhcWovGDrETVHRHw1M4kTNv8d+G4hjf/mMSpjIOQ8wMMlVpO
         52Ck55c3i6tLmT6l3u0B/ytWFm/iOS4/HyOLs=
Received: by 10.224.45.134 with SMTP id e6mr4385086qaf.41.1239390712533;
        Fri, 10 Apr 2009 12:11:52 -0700 (PDT)
Received: from ?192.168.1.120? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 5sm2802428qwh.28.2009.04.10.12.11.51
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 10 Apr 2009 12:11:52 -0700 (PDT)
Message-ID: <49DF99F7.4000601@gmail.com>
Date: Fri, 10 Apr 2009 15:11:51 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.21 (X11/20090409)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: RangeFilter performance problem using MultiReader
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>	 <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>	 <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>	 <49DF90D7.6020304@lucidimagination.com> <9ac0c6aa0904101150n12578f4al3bc4a8632d54fe1c@mail.gmail.com> <49DF98A2.7090609@gmail.com>
In-Reply-To: <49DF98A2.7090609@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Mark Miller wrote:
> Michael McCandless wrote:
>>
>> which is why I'm baffled that Raf didn't see a speedup on
>> upgrading.
>>
>> Mike
>>   
> Another point is that he may not have such a nasty set of segments - 
> Raf says he has 24 indexes, which sounds like he may not have the 
> logarithmic sizing you normally see. If you have somewhat normal term 
> distribution for all 24 segments, the problem is not exasperated 
> nearly as much (along with not being so bad as its not using all of 
> the terms for the field).
Better clarify this: it will still be a problem - you still have all the 
extra seeks - but they are not as many wasted seeks that we can avoid 
like the problem with the tailed logarithmic segments.
>
> 24 segments is bound to be quite a bit slower than an optimized index 
> for most things - also 24 segments of similar size may also be worse 
> than the normal 24 segments with log dropping size.
>


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39648-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 19:15:16 2009
Return-Path: <java-user-return-39648-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17594 invoked from network); 10 Apr 2009 19:15:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 19:15:16 -0000
Received: (qmail 45588 invoked by uid 500); 10 Apr 2009 19:15:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45504 invoked by uid 500); 10 Apr 2009 19:15:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45494 invoked by uid 99); 10 Apr 2009 19:15:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:15:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:15:05 +0000
Received: by qyk8 with SMTP id 8so1949635qyk.29
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 12:14:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=5ysiVRlwapLJ5HKzTG+s3aGNGAsW9oAUxwd2xv6/+nE=;
        b=L8EyFYBSTQqb1j3uTYptfh7/Vba+5Xc9wSojRBN+kSGr4kAKRF+xDEOn5j5HKmeenn
         4appidqEMCU5DOVlBKa+EbeIzLEZP8EQ9zxRLMdo4VFL+Ral5TEFLqqTpkMcf4HWd+ug
         rzus9v2eT1ROf+JWIRFelXcUAlx9pYC2JCiKs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=LrY9P/I8f8fQkCwVKK0A35YN0gQZBTsKWjQboijPrkEsmrkC8R8NwNiLgzdHowhwJZ
         wuqJzAm2j0owX+PHyaHDYa9/DsF4lRE7EZBpgMIohzshikOAcvULyAiJ2nZVV2tn1rFY
         nAeYtPQLvvwAM+1SJ37t0PJK3TIJs0wLLfJ94=
Received: by 10.224.54.138 with SMTP id q10mr4372855qag.113.1239390884877;
        Fri, 10 Apr 2009 12:14:44 -0700 (PDT)
Received: from ?192.168.1.120? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 7sm2790782qwf.10.2009.04.10.12.14.44
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 10 Apr 2009 12:14:44 -0700 (PDT)
Message-ID: <49DF9AA3.9070708@gmail.com>
Date: Fri, 10 Apr 2009 15:14:43 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.21 (X11/20090409)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: RangeFilter performance problem using MultiReader
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
In-Reply-To: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Raf wrote:
>
> We have more or less 3M documents in 24 indexes and we read all of them
> using a MultiReader.
>   

Is this a multireader containing multireaders?

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39649-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 19:20:28 2009
Return-Path: <java-user-return-39649-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18934 invoked from network); 10 Apr 2009 19:20:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 19:20:28 -0000
Received: (qmail 53558 invoked by uid 500); 10 Apr 2009 19:20:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53480 invoked by uid 500); 10 Apr 2009 19:20:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53470 invoked by uid 99); 10 Apr 2009 19:20:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:20:25 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.168] (HELO wf-out-1314.google.com) (209.85.200.168)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:20:19 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1187369wff.20
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 12:19:57 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.43.7 with SMTP id q7mr1405469wfq.118.1239391197613; Fri, 
	10 Apr 2009 12:19:57 -0700 (PDT)
In-Reply-To: <49DF9AA3.9070708@gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <49DF9AA3.9070708@gmail.com>
Date: Fri, 10 Apr 2009 15:19:57 -0400
Message-ID: <9ac0c6aa0904101219w1bfa750dxb591ca154ca5e42f@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 10, 2009 at 3:14 PM, Mark Miller <markrmiller@gmail.com> wrote:
> Raf wrote:
>>
>> We have more or less 3M documents in 24 indexes and we read all of them
>> using a MultiReader.
>>
>
> Is this a multireader containing multireaders?

Let's hear Raf's answer, but I think likely "yes".  But this shouldn't
be a problem because we recursively expand down to the segment readers
in IndexSearcher.gatherSubReaders.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39650-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 19:22:36 2009
Return-Path: <java-user-return-39650-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19406 invoked from network); 10 Apr 2009 19:22:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 19:22:36 -0000
Received: (qmail 58144 invoked by uid 500); 10 Apr 2009 19:22:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58068 invoked by uid 500); 10 Apr 2009 19:22:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58058 invoked by uid 99); 10 Apr 2009 19:22:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:22:34 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.172] (HELO wf-out-1314.google.com) (209.85.200.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:22:27 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1187856wff.20
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 12:22:06 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.193.10 with SMTP id q10mr1405797wff.205.1239391326202; 
	Fri, 10 Apr 2009 12:22:06 -0700 (PDT)
In-Reply-To: <49DF99F7.4000601@gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>
	 <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>
	 <49DF90D7.6020304@lucidimagination.com>
	 <9ac0c6aa0904101150n12578f4al3bc4a8632d54fe1c@mail.gmail.com>
	 <49DF98A2.7090609@gmail.com> <49DF99F7.4000601@gmail.com>
Date: Fri, 10 Apr 2009 15:22:06 -0400
Message-ID: <9ac0c6aa0904101222i5efeb734ic5b94d1f2e676ff0@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 10, 2009 at 3:11 PM, Mark Miller <markrmiller@gmail.com> wrote:
> Mark Miller wrote:
>>
>> Michael McCandless wrote:
>>>
>>> which is why I'm baffled that Raf didn't see a speedup on
>>> upgrading.
>>>
>>> Mike
>>>
>>
>> Another point is that he may not have such a nasty set of segments - Raf
>> says he has 24 indexes, which sounds like he may not have the logarithmic
>> sizing you normally see. If you have somewhat normal term distribution for
>> all 24 segments, the problem is not exasperated nearly as much (along with
>> not being so bad as its not using all of the terms for the field).
>
> Better clarify this: it will still be a problem - you still have all the
> extra seeks - but they are not as many wasted seeks that we can avoid like
> the problem with the tailed logarithmic segments.

Right, I think "uniqueness" of terms may be the driving factor.  So,
if segment sizes are all the same (no logarithmic tail), but terms are
very unique, you'll still have N-1 SegmentTermEnums trying to seek to
a term that they don't have.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39651-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 19:30:40 2009
Return-Path: <java-user-return-39651-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21494 invoked from network); 10 Apr 2009 19:30:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 19:30:40 -0000
Received: (qmail 71781 invoked by uid 500); 10 Apr 2009 19:30:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71700 invoked by uid 500); 10 Apr 2009 19:30:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71690 invoked by uid 99); 10 Apr 2009 19:30:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:30:37 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.169] (HELO wf-out-1314.google.com) (209.85.200.169)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:30:29 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1189705wff.20
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 12:30:06 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.147.15 with SMTP id u15mr1408338wfd.152.1239391806042; 
	Fri, 10 Apr 2009 12:30:06 -0700 (PDT)
In-Reply-To: <49DF98A2.7090609@gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>
	 <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>
	 <49DF90D7.6020304@lucidimagination.com>
	 <9ac0c6aa0904101150n12578f4al3bc4a8632d54fe1c@mail.gmail.com>
	 <49DF98A2.7090609@gmail.com>
Date: Fri, 10 Apr 2009 15:30:06 -0400
Message-ID: <9ac0c6aa0904101230g37f17b3bteb960aeb2625c63a@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 10, 2009 at 3:06 PM, Mark Miller <markrmiller@gmail.com> wrote:

> 24 segments is bound to be quite a bit slower than an optimized index for
> most things

I'd be curious just how true this really is (in general)... my guess
is the "long tail of tiny segments" gets into the OS's IO cache (as
long as the system stays hot) and doesn't actually hurt things much.

Has anyone tested this (performance of unoptimized vs optimized
indexes, in general) recently?  To be a fair comparison, there should
be no deletions in the index.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39652-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 19:57:33 2009
Return-Path: <java-user-return-39652-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29810 invoked from network); 10 Apr 2009 19:57:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 19:57:32 -0000
Received: (qmail 1417 invoked by uid 500); 10 Apr 2009 19:57:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1313 invoked by uid 500); 10 Apr 2009 19:57:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1302 invoked by uid 99); 10 Apr 2009 19:57:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:57:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [171.67.219.88] (HELO smtp-roam.stanford.edu) (171.67.219.88)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 19:57:22 +0000
Received: from smtp-roam.stanford.edu (localhost.localdomain [127.0.0.1])
	by localhost (Postfix) with SMTP id 3DD6A37DB5
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 12:57:02 -0700 (PDT)
Received: from [192.168.1.100] (adsl-76-202-117-24.dsl.pltn13.sbcglobal.net [76.202.117.24])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: bethard)
	by smtp-roam.stanford.edu (Postfix) with ESMTPSA id BBDAF37DB0
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 12:57:01 -0700 (PDT)
Message-ID: <49DFA47C.3010906@stanford.edu>
Date: Fri, 10 Apr 2009 12:56:44 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: exponential boosts
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I need to have a scoring model of the form:

    s1(d, q)^a1 * s2(d, q)^a2 * ... * sN(d, q)^aN

where "d" is a document, "q" is a query, "sK" is a scoring function, and
"aK" is the exponential boost factor for that scoring function. As a
simple example, I might have:

    s1 = TF-IDF score matching "text" field (e.g. a TermQuery)
    a1 = 1.0

    s2 = TF-IDF score matching "author" field (e.g. a TermQuery)
    a2 = 0.1

    s3 = PageRank score (e.g. a FieldScoreQuery)
    a3 = 0.5

It's important that the "aK" parameters are exponents in the scoring
function and not just multipliers because it allows me to do a
particular kind of optimized search for the best parameter values.

How can I achieve this? My first thought was just that I should set the
boost factor for each query, but the boost factor is just a multiplier,
right?

My second thought was to subclass CustomScoreQuery and override
customScore, but as far as I can tell, CustomScoreQuery can only combine
a Query with a ValueSourceQuery, while I need to combine a Query with
another Query (e.g. the example above with two TermQuery scores).

How should I go about this?

Thanks in advance,

Steve

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39653-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 20:09:01 2009
Return-Path: <java-user-return-39653-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34084 invoked from network); 10 Apr 2009 20:09:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 20:09:01 -0000
Received: (qmail 16376 invoked by uid 500); 10 Apr 2009 20:08:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16288 invoked by uid 500); 10 Apr 2009 20:08:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16278 invoked by uid 99); 10 Apr 2009 20:08:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 20:08:58 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jack@yelp.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 20:08:50 +0000
Received: by qyk8 with SMTP id 8so1978204qyk.29
        for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 13:08:29 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.229.96.1 with SMTP id f1mr1187052qcn.103.1239394109353; Fri, 
	10 Apr 2009 13:08:29 -0700 (PDT)
In-Reply-To: <49DFA47C.3010906@stanford.edu>
References: <49DFA47C.3010906@stanford.edu>
Date: Fri, 10 Apr 2009 13:08:29 -0700
Message-ID: <239f2f640904101308i3aae9599v49ae72c2e39d5ff0@mail.gmail.com>
Subject: Re: exponential boosts
From: Jack Stahl <jack@yelp.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364270d29fee0a046738eda1
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364270d29fee0a046738eda1
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Perhaps you'd find it easier to implement the equivalent:

log(s1(d, q))*a1 + ... + log(sN(d, q))*aN

On Fri, Apr 10, 2009 at 12:56 PM, Steven Bethard <bethard@stanford.edu>wrote:

> I need to have a scoring model of the form:
>
>    s1(d, q)^a1 * s2(d, q)^a2 * ... * sN(d, q)^aN
>
> where "d" is a document, "q" is a query, "sK" is a scoring function, and
> "aK" is the exponential boost factor for that scoring function. As a
> simple example, I might have:
>
>    s1 = TF-IDF score matching "text" field (e.g. a TermQuery)
>    a1 = 1.0
>
>    s2 = TF-IDF score matching "author" field (e.g. a TermQuery)
>    a2 = 0.1
>
>    s3 = PageRank score (e.g. a FieldScoreQuery)
>    a3 = 0.5
>
> It's important that the "aK" parameters are exponents in the scoring
> function and not just multipliers because it allows me to do a
> particular kind of optimized search for the best parameter values.
>
> How can I achieve this? My first thought was just that I should set the
> boost factor for each query, but the boost factor is just a multiplier,
> right?
>
> My second thought was to subclass CustomScoreQuery and override
> customScore, but as far as I can tell, CustomScoreQuery can only combine
> a Query with a ValueSourceQuery, while I need to combine a Query with
> another Query (e.g. the example above with two TermQuery scores).
>
> How should I go about this?
>
> Thanks in advance,
>
> Steve
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016364270d29fee0a046738eda1--

From java-user-return-39654-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 20:13:42 2009
Return-Path: <java-user-return-39654-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34825 invoked from network); 10 Apr 2009 20:13:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 20:13:42 -0000
Received: (qmail 21542 invoked by uid 500); 10 Apr 2009 20:13:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21449 invoked by uid 500); 10 Apr 2009 20:13:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21439 invoked by uid 99); 10 Apr 2009 20:13:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 20:13:39 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 20:13:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 0205B513B0
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 22:13:06 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 24611-06 for <java-user@lucene.apache.org>;
 Fri, 10 Apr 2009 22:13:05 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 44E24510B4
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 22:13:05 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
Subject: RE: RangeFilter performance problem using MultiReader
Date: Fri, 10 Apr 2009 22:13:05 +0200
Message-ID: <38779BC2BAAF4935A22EC88F30B98814@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
X-MIMEOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
Thread-Index: Acm56g2xHyRch59/SmWrUzmlhjOQ5QALe7MA
X-Virus-Checked: Checked by ClamAV on apache.org

You got a lot of answers and questions about your index structure. Now
another idea, maybe this helps you to speed up your RangeFilter:

What type of range do you want to query? From your index statistics, it
looks like a numeric/date field from which you filter very large ranges. If
the values are very fine-grained and so you hit a lot of terms for the
range, you might consider using TrieRangeFilter, which is a new contrib
module in the yet unreleased Lucene 2.9:
http://hudson.zones.apache.org/hudson/job/Lucene-trunk/javadoc/all/org/apach
e/lucene/search/trie/package-summary.html

The name and API may change before release (if it moves to core), but you
can try it out, it is working stable and currently runs in productive
websites! It works for int, long, double, float and Date values (if encoded
using Date.getTime() as long).

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Raf [mailto:r.ventaglio@gmail.com]
> Sent: Friday, April 10, 2009 4:38 PM
> To: java-user@lucene.apache.org
> Subject: RangeFilter performance problem using MultiReader
> 
> Hi,
> we are experiencing some problems using RangeFilters and we think there
> are
> some performance issues caused by MultiReader.
> 
> We have more or less 3M documents in 24 indexes and we read all of them
> using a MultiReader.
> If we do a search using only terms, there are no problems, but it if we
> add
> to the same search terms a RangeFilter that extracts a large subset of the
> documents (e.g. 500K), it takes a lot of time to execute (about 15s).
> 
> In order to identify the problem, we have tried to consolidate the index:
> so
> now we have the same 3M docs in a single 10GB index.
> If we repeat the same search using this index, it takes only a small
> fraction of the previous time (about 2s).
> 
> Is there something we can do to improve search performance using
> RangeFilters with MultiReader or the only solution is to have only a
> single
> big index?
> 
> Thanks,
> Raf


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39655-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 20:13:48 2009
Return-Path: <java-user-return-39655-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34873 invoked from network); 10 Apr 2009 20:13:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 20:13:48 -0000
Received: (qmail 23168 invoked by uid 500); 10 Apr 2009 20:13:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23095 invoked by uid 500); 10 Apr 2009 20:13:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23085 invoked by uid 99); 10 Apr 2009 20:13:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 20:13:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [171.67.219.89] (HELO smtp-roam.stanford.edu) (171.67.219.89)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 20:13:36 +0000
Received: from smtp-roam.stanford.edu (localhost.localdomain [127.0.0.1])
	by localhost (Postfix) with SMTP id 2EB9877993
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 13:13:15 -0700 (PDT)
Received: from [192.168.1.100] (adsl-76-202-117-24.dsl.pltn13.sbcglobal.net [76.202.117.24])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: bethard)
	by smtp-roam.stanford.edu (Postfix) with ESMTPSA id CF1E477DD4
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 13:13:14 -0700 (PDT)
Message-ID: <49DFA849.6080207@stanford.edu>
Date: Fri, 10 Apr 2009 13:12:57 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: exponential boosts
References: <49DFA47C.3010906@stanford.edu> <239f2f640904101308i3aae9599v49ae72c2e39d5ff0@mail.gmail.com>
In-Reply-To: <239f2f640904101308i3aae9599v49ae72c2e39d5ff0@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On 4/10/2009 1:08 PM, Jack Stahl wrote:
> Perhaps you'd find it easier to implement the equivalent:
> 
> log(s1(d, q))*a1 + ... + log(sN(d, q))*aN

Yes, that's fine too - that's actually what I'd be optimizing anyway.

But how would I do that? If I took the query boost route, how do I get a
TermQuery to produce a score in log-space, while keeping the boost in
regular space? Or if I took the CustomScoreQuery route, how do I combine
two Query scores (not a Query score and a ValueSourceQuery score)?

Steve

> 
> On Fri, Apr 10, 2009 at 12:56 PM, Steven Bethard <bethard@stanford.edu>wrote:
> 
>> I need to have a scoring model of the form:
>>
>>    s1(d, q)^a1 * s2(d, q)^a2 * ... * sN(d, q)^aN
>>
>> where "d" is a document, "q" is a query, "sK" is a scoring function, and
>> "aK" is the exponential boost factor for that scoring function. As a
>> simple example, I might have:
>>
>>    s1 = TF-IDF score matching "text" field (e.g. a TermQuery)
>>    a1 = 1.0
>>
>>    s2 = TF-IDF score matching "author" field (e.g. a TermQuery)
>>    a2 = 0.1
>>
>>    s3 = PageRank score (e.g. a FieldScoreQuery)
>>    a3 = 0.5
>>
>> It's important that the "aK" parameters are exponents in the scoring
>> function and not just multipliers because it allows me to do a
>> particular kind of optimized search for the best parameter values.
>>
>> How can I achieve this? My first thought was just that I should set the
>> boost factor for each query, but the boost factor is just a multiplier,
>> right?
>>
>> My second thought was to subclass CustomScoreQuery and override
>> customScore, but as far as I can tell, CustomScoreQuery can only combine
>> a Query with a ValueSourceQuery, while I need to combine a Query with
>> another Query (e.g. the example above with two TermQuery scores).
>>
>> How should I go about this?
>>
>> Thanks in advance,
>>
>> Steve
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39656-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 21:56:59 2009
Return-Path: <java-user-return-39656-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75376 invoked from network); 10 Apr 2009 21:56:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 21:56:58 -0000
Received: (qmail 25567 invoked by uid 500); 10 Apr 2009 21:56:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25484 invoked by uid 500); 10 Apr 2009 21:56:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25474 invoked by uid 99); 10 Apr 2009 21:56:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 21:56:56 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 21:56:48 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LsOi4-0007jV-5Z
	for java-user@lucene.apache.org; Fri, 10 Apr 2009 14:56:28 -0700
Message-ID: <22995240.post@talk.nabble.com>
Date: Fri, 10 Apr 2009 14:56:28 -0700 (PDT)
From: John Seer <pulsphoto@yahoo.com>
To: java-user@lucene.apache.org
Subject: Sequential match query
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: pulsphoto@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,
I have 3 terms and I want to much them in order I tried to use wildcard
query I am not getting any results back

Terms: A C F

Doc: name:A B C D E F

query: name:A*C*F

I am not getting any results back, 
Please any suggestions? 

Thanks for help in advance 
-- 
View this message in context: http://www.nabble.com/Sequential-match-query-tp22995240p22995240.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39657-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 22:10:30 2009
Return-Path: <java-user-return-39657-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84292 invoked from network); 10 Apr 2009 22:10:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 22:10:30 -0000
Received: (qmail 43410 invoked by uid 500); 10 Apr 2009 22:10:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43317 invoked by uid 500); 10 Apr 2009 22:10:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43307 invoked by uid 99); 10 Apr 2009 22:10:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 22:10:27 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 22:10:18 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LsOv8-0008OC-6r
	for java-user@lucene.apache.org; Fri, 10 Apr 2009 15:09:58 -0700
Message-ID: <22995442.post@talk.nabble.com>
Date: Fri, 10 Apr 2009 15:09:58 -0700 (PDT)
From: John Seer <pulsphoto@yahoo.com>
To: java-user@lucene.apache.org
Subject: Different Analyzer for different fields in the same document
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: pulsphoto@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,
There is any way that a single document fields can have different analyzers
for different fields?

I think one way of doing it to create custom analyzer which will do field
spastic analyzes..

Any other suggestions?    
-- 
View this message in context: http://www.nabble.com/Different-Analyzer-for-different-fields-in-the-same-document-tp22995442p22995442.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39658-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 10 23:54:49 2009
Return-Path: <java-user-return-39658-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12328 invoked from network); 10 Apr 2009 23:54:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Apr 2009 23:54:48 -0000
Received: (qmail 42266 invoked by uid 500); 10 Apr 2009 23:54:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42187 invoked by uid 500); 10 Apr 2009 23:54:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42177 invoked by uid 99); 10 Apr 2009 23:54:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 23:54:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of koji@r.email.ne.jp designates 202.224.39.198 as permitted sender)
Received: from [202.224.39.198] (HELO mail2.asahi-net.or.jp) (202.224.39.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 10 Apr 2009 23:54:37 +0000
Received: from koji-sekiguchi-no-macbook.local (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	by mail2.asahi-net.or.jp (Postfix) with ESMTP id 686636D15C
	for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 08:54:15 +0900 (JST)
Message-ID: <49DFDC27.1080704@r.email.ne.jp>
Date: Sat, 11 Apr 2009 08:54:15 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.21 (Macintosh/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Different Analyzer for different fields in the same document
References: <22995442.post@talk.nabble.com>
In-Reply-To: <22995442.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

John Seer wrote:
> Hello,
> There is any way that a single document fields can have different analyzers
> for different fields?
>
> I think one way of doing it to create custom analyzer which will do field
> spastic analyzes..
>
> Any other suggestions?    
>   

There is PerFieldAnalyzerWrapper
http://hudson.zones.apache.org/hudson/job/Lucene-trunk/javadoc/org/apache/lucene/analysis/PerFieldAnalyzerWrapper.html

Koji


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39659-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 00:14:39 2009
Return-Path: <java-user-return-39659-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17756 invoked from network); 11 Apr 2009 00:14:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 00:14:39 -0000
Received: (qmail 50454 invoked by uid 500); 11 Apr 2009 00:14:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50370 invoked by uid 500); 11 Apr 2009 00:14:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50359 invoked by uid 99); 11 Apr 2009 00:14:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 00:14:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [171.67.219.89] (HELO smtp-roam.stanford.edu) (171.67.219.89)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 00:14:27 +0000
Received: from smtp-roam.stanford.edu (localhost.localdomain [127.0.0.1])
	by localhost (Postfix) with SMTP id 66DB677A01
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 17:14:03 -0700 (PDT)
Received: from [192.168.1.100] (adsl-76-202-117-24.dsl.pltn13.sbcglobal.net [76.202.117.24])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: bethard)
	by smtp-roam.stanford.edu (Postfix) with ESMTPSA id 18EC777989
	for <java-user@lucene.apache.org>; Fri, 10 Apr 2009 17:14:03 -0700 (PDT)
Message-ID: <49DFE0B8.4080208@stanford.edu>
Date: Fri, 10 Apr 2009 17:13:44 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: exponential boosts
References: <49DFA47C.3010906@stanford.edu>
In-Reply-To: <49DFA47C.3010906@stanford.edu>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On 4/10/2009 12:56 PM, Steven Bethard wrote:
> I need to have a scoring model of the form:
> 
>     s1(d, q)^a1 * s2(d, q)^a2 * ... * sN(d, q)^aN
> 
> where "d" is a document, "q" is a query, "sK" is a scoring function, and
> "aK" is the exponential boost factor for that scoring function. As a
> simple example, I might have:
> 
>     s1 = TF-IDF score matching "text" field (e.g. a TermQuery)
>     a1 = 1.0
> 
>     s2 = TF-IDF score matching "author" field (e.g. a TermQuery)
>     a2 = 0.1
> 
>     s3 = PageRank score (e.g. a FieldScoreQuery)
>     a3 = 0.5
> 
> It's important that the "aK" parameters are exponents in the scoring
> function and not just multipliers because it allows me to do a
> particular kind of optimized search for the best parameter values.
> 
> How can I achieve this? My first thought was just that I should set the
> boost factor for each query, but the boost factor is just a multiplier,
> right?
> 
> My second thought was to subclass CustomScoreQuery and override
> customScore, but as far as I can tell, CustomScoreQuery can only combine
> a Query with a ValueSourceQuery, while I need to combine a Query with
> another Query (e.g. the example above with two TermQuery scores).

My third thought was to create a wrapper class that takes a Query and an
exponential boost factor. The wrapper class would delegate to the Query
for all methods except .weight(). For .weight(), it would return a
Weight wrapper that delegated to the Weight for all methods except
.getValue(). For .getValue(), it would return the original value, raised
to the appropriate exponent. But will that really work, or am I going to
mess up the normalization or something else?

Steve

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39660-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 00:19:10 2009
Return-Path: <java-user-return-39660-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24683 invoked from network); 11 Apr 2009 00:19:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 00:19:10 -0000
Received: (qmail 53517 invoked by uid 500); 11 Apr 2009 00:19:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53434 invoked by uid 500); 11 Apr 2009 00:19:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53424 invoked by uid 99); 11 Apr 2009 00:19:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 00:19:07 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 00:18:58 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LsQvd-0004Kj-9o
	for java-user@lucene.apache.org; Fri, 10 Apr 2009 17:18:37 -0700
Message-ID: <22996572.post@talk.nabble.com>
Date: Fri, 10 Apr 2009 17:18:37 -0700 (PDT)
From: John Seer <pulsphoto@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Different Analyzer for different fields in the same document
In-Reply-To: <49DFDC27.1080704@r.email.ne.jp>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: pulsphoto@yahoo.com
References: <22995442.post@talk.nabble.com> <49DFDC27.1080704@r.email.ne.jp>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks this is useful class for future...

Koji Sekiguchi-2 wrote:
> 
> John Seer wrote:
>> Hello,
>> There is any way that a single document fields can have different
>> analyzers
>> for different fields?
>>
>> I think one way of doing it to create custom analyzer which will do field
>> spastic analyzes..
>>
>> Any other suggestions?    
>>   
> 
> There is PerFieldAnalyzerWrapper
> http://hudson.zones.apache.org/hudson/job/Lucene-trunk/javadoc/org/apache/lucene/analysis/PerFieldAnalyzerWrapper.html
> 
> Koji
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Different-Analyzer-for-different-fields-in-the-same-document-tp22995442p22996572.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39661-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 07:07:08 2009
Return-Path: <java-user-return-39661-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56271 invoked from network); 11 Apr 2009 07:07:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 07:07:08 -0000
Received: (qmail 95371 invoked by uid 500); 11 Apr 2009 07:07:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95282 invoked by uid 500); 11 Apr 2009 07:07:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95272 invoked by uid 99); 11 Apr 2009 07:07:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 07:07:05 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of r.ventaglio@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 07:06:54 +0000
Received: by fxm2 with SMTP id 2so1530094fxm.5
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 00:06:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=lOpX8fWck8fHdRVxEeveUL40rlPZGy1ulJfP2O2tjU4=;
        b=R0aRqgnkL8Jb7QpBncMQCEJP4DZgh3bS+IGWy0kImSA1bks8h/gb8trx95MC0UN8GP
         V34FZIMMhAMYyP4gHwUyN28r0QrB7FTKkFsqs2e525jt+LSR+MMGGXWB7UDx0O6crfr/
         QJdh4d+o4Xm+oslaimjqhUwxfeWb1aCN+3bB4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=exmp54+aFmfJDbXTqejs8Nkpp+TxyvMLx6mU1pfz/dFgxOAcpsu3S+AO0a0LdsROxK
         WP+N4hX1Zj+9h3ou1z64halIJ4l+DO72utmlsFteGGCafMVtx3UO2JtMwmEbEKRx0qVj
         61PzpIpXcASB9Lv5FXxiG6l1zjLQsWcvBkgpI=
MIME-Version: 1.0
Received: by 10.103.171.6 with SMTP id y6mr2240599muo.110.1239433593805; Sat, 
	11 Apr 2009 00:06:33 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904101054o6cbfe83dhe0f2956151580f53@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com>
	 <9ac0c6aa0904101054o6cbfe83dhe0f2956151580f53@mail.gmail.com>
Date: Sat, 11 Apr 2009 09:06:33 +0200
Message-ID: <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Raf <r.ventaglio@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64987c014de430467421faf
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64987c014de430467421faf
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Ok, here you can find some details about my tests:

*MultiReader creation*

IndexReader subReader;
List<IndexReader> subReaders = new ArrayList<IndexReader>();
for (Directory dir : this.directories) {
     try {
          subReader = IndexReader.open(dir, true);
          subReaders.add(subReader);
         } catch (...) {
           ... ... ...
         }
     }
    this.reader = new MultiReader(subReaders.toArray(new IndexReader[] {}));

(where *this.directories* is a List<Directory> containing all my index
directories).

*RangeFilter test*

@Test
    public void testRangeFilter() throws IOException, ParseException {

        IndexManager im = SearchObjectsFactory.getIndexManager();
        IndexReader reader = im.getReader();
        long timer;
        DocIdSet docIdSet;
        Filter filter;
        logger.info("Num docs: " + reader.numDocs());

        logger.info("Before creating filter...");
        timer = System.currentTimeMillis();
        filter = new RangeFilter("date_doc", "20081001000000",
"20090131235959", true, true);
        logger.info("After creating filter..." + (System.currentTimeMillis()
- timer));

        logger.info("Before reading idSet...");
        timer = System.currentTimeMillis();
        docIdSet = filter.getDocIdSet(reader);
        logger.info("After reading idSet..." + ((OpenBitSet)
docIdSet).cardinality() + " " + (System.currentTimeMillis() - timer));

        logger.info("Before reading idSet...");
        timer = System.currentTimeMillis();
        docIdSet = filter.getDocIdSet(reader);
        logger.info("After reading idSet..." + ((OpenBitSet)
docIdSet).cardinality() + " " + (System.currentTimeMillis() - timer));

        logger.info("Before reading idSet...");
        timer = System.currentTimeMillis();
        docIdSet = filter.getDocIdSet(reader);
        logger.info("After reading idSet..." + ((OpenBitSet)
docIdSet).cardinality() + " " + (System.currentTimeMillis() - timer));
    }

*
Test *results*   (Num docs = 2,940,738)

1 Original index (12 collections * 6 months = 72 indexes)*

1a Range [20090101000000 - 20090131235959] --> 379,560 docs
     2,274 ms     1,477 ms     1,283 ms

1b Range [20081201000000 - 20090131235959] --> 974,754 docs
     4,489 ms     3,333 ms     3,390 ms

1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     8,482 ms     7,471 ms     7,424 ms


***2Consolidated index (1 index)*

2a Range [20090101000000 - 20090131235959] --> 379,560 docs
     492 ms     116 ms     83 ms

2b Range [20081201000000 - 20090131235959] --> 974,754 docs
     640 ms     159 ms     138 ms

2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     817 ms     322 ms    295 ms


The field on which I am applying the RangeFilter is a date field and it has
299,622 unique terms.

Thanks,
Raf


On Fri, Apr 10, 2009 at 7:54 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> <cut>
> Hmmm, interesting!
>
> Can you provide more details about your tests?  EG the code fragment
> showing your query, the creation of the MultiReader, how you run the
> search, etc.?
>
> Is the field that you're applying the RangeFilter on highly unique or
> rather redundant?
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64987c014de430467421faf--

From java-user-return-39662-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 07:09:43 2009
Return-Path: <java-user-return-39662-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57462 invoked from network); 11 Apr 2009 07:09:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 07:09:43 -0000
Received: (qmail 98290 invoked by uid 500); 11 Apr 2009 07:09:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98207 invoked by uid 500); 11 Apr 2009 07:09:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98197 invoked by uid 99); 11 Apr 2009 07:09:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 07:09:41 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of r.ventaglio@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 07:09:31 +0000
Received: by fxm2 with SMTP id 2so1530680fxm.5
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 00:09:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=i3+ooDUI/WJlpe/vPb8+d8/HBJvg73KHoRAtslBZ4jw=;
        b=R4KNg+66CV1Ke/sjDQ+BXC0Ol5c5ICnUsK3qOaJOWqPH7aJ2I+A0IXjpp+6ysssvrS
         Y10UspC+eITt3WJ2kEKfbrqJJvDOZQxtliqGvAIO5vYXRRkWszInlL+IGCkj5t2tG9gQ
         Unxyi0jdaEzAmBln/Ox1lW+3uenrq+j3Plfs0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=KmqCQFKj0kgWjpRPfJL2z5K/D9WR7GGvNcG8RlOksLru8jRLYf2jOj9HwHh1yKl+hG
         d7bGG6mfduN50EkvGTLZWjbsAl8IMjcCY/DWKqg8ktbYnGvkUmg0TLyTE1ljaG63cmJ/
         7vMkC/GNf1X1u406h9Txpqeoy1/sFcjZBpbLA=
MIME-Version: 1.0
Received: by 10.103.249.19 with SMTP id b19mr2239391mus.86.1239433751246; Sat, 
	11 Apr 2009 00:09:11 -0700 (PDT)
In-Reply-To: <49DF9AA3.9070708@gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <49DF9AA3.9070708@gmail.com>
Date: Sat, 11 Apr 2009 09:09:11 +0200
Message-ID: <70422ecc0904110009j5daec56cj5e47ac3c4d4253f1@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Raf <r.ventaglio@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636b431b57739be046742280e
X-Virus-Checked: Checked by ClamAV on apache.org

--001636b431b57739be046742280e
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

No, it is a MultiReader that contains 72 (I am sorry, I wrote a wrong number
last time) "single" readers.
Raf

On Fri, Apr 10, 2009 at 9:14 PM, Mark Miller <markrmiller@gmail.com> wrote:

> Raf wrote:
>
>>
>> We have more or less 3M documents in 24 indexes and we read all of them
>> using a MultiReader.
>>
>>
>
> Is this a multireader containing multireaders?
>
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636b431b57739be046742280e--

From java-user-return-39663-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 07:22:31 2009
Return-Path: <java-user-return-39663-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60869 invoked from network); 11 Apr 2009 07:22:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 07:22:31 -0000
Received: (qmail 1893 invoked by uid 500); 11 Apr 2009 07:22:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1799 invoked by uid 500); 11 Apr 2009 07:22:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1789 invoked by uid 99); 11 Apr 2009 07:22:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 07:22:28 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of r.ventaglio@gmail.com designates 209.85.218.166 as permitted sender)
Received: from [209.85.218.166] (HELO mail-bw0-f166.google.com) (209.85.218.166)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 07:22:19 +0000
Received: by bwz10 with SMTP id 10so1549816bwz.5
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 00:21:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=uyDCvSoFCg6r50ilEnUkXD6qDj4P/4N509MG1qfNgOs=;
        b=khV1NtktKi0JCTAhguJTjoSMRgJYCWR8m7wQHMHz5OfNsa/mEikDXBbcFR7Cvuc1E5
         by8Yb7m70iWoPXZ3oljXyJ7HnyAPm6Y8bAVq58re/yfk2aDEXgdmS6Q46TfLACcKZ531
         y1D1VSjpH9AXBnPbl8IIcbI++YKrvESaAN7sQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ZQA4vmNepfaK/maGn9gWud/pHLK6FX6TbuxU4kBlbAS6lze6VrChT5Xl2lIgw2WAGQ
         rUmWhA0/rb0WhSDy9METxE36HDcP0rcIst3na79BCSBfa5qhvsGL4H5sNBr/Csxf0Mux
         Z68ogsOh7qstIC6sAIZgREGuL9sHH+kcpAYBw=
MIME-Version: 1.0
Received: by 10.103.247.14 with SMTP id z14mr2246270mur.70.1239434517795; Sat, 
	11 Apr 2009 00:21:57 -0700 (PDT)
In-Reply-To: <38779BC2BAAF4935A22EC88F30B98814@VEGA>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <38779BC2BAAF4935A22EC88F30B98814@VEGA>
Date: Sat, 11 Apr 2009 09:21:57 +0200
Message-ID: <70422ecc0904110021n47274bdapfed6f47cdd21f43d@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Raf <r.ventaglio@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636765bbd27d2d70467425699
X-Virus-Checked: Checked by ClamAV on apache.org

--001636765bbd27d2d70467425699
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks Uwe,
I had already read about TrieRangeFilter on this mailing list and I thought
it could be useful to solve my problem.
I think I will trie it for test purposes.

Unfortunately, I have now to solve the problem in a production system and I
would like to avoid using a yet unreleased version. So I think that my best
choice, at the moment, is to consolidate my indexes and waiting until this
interesting new feature will be available in the official release.

Thanks a lot to all of you,
Raf


On Fri, Apr 10, 2009 at 10:13 PM, Uwe Schindler <uwe@thetaphi.de> wrote:

> You got a lot of answers and questions about your index structure. Now
> another idea, maybe this helps you to speed up your RangeFilter:
>
> What type of range do you want to query? From your index statistics, it
> looks like a numeric/date field from which you filter very large ranges. If
> the values are very fine-grained and so you hit a lot of terms for the
> range, you might consider using TrieRangeFilter, which is a new contrib
> module in the yet unreleased Lucene 2.9:
>
> http://hudson.zones.apache.org/hudson/job/Lucene-trunk/javadoc/all/org/apach
> e/lucene/search/trie/package-summary.html<http://hudson.zones.apache.org/hudson/job/Lucene-trunk/javadoc/all/org/apach%0Ae/lucene/search/trie/package-summary.html>
>
> The name and API may change before release (if it moves to core), but you
> can try it out, it is working stable and currently runs in productive
> websites! It works for int, long, double, float and Date values (if encoded
> using Date.getTime() as long).
>
> Uwe
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
> > -----Original Message-----
> > From: Raf [mailto:r.ventaglio@gmail.com]
> > Sent: Friday, April 10, 2009 4:38 PM
> > To: java-user@lucene.apache.org
> > Subject: RangeFilter performance problem using MultiReader
> >
> > Hi,
> > we are experiencing some problems using RangeFilters and we think there
> > are
> > some performance issues caused by MultiReader.
> >
> > We have more or less 3M documents in 24 indexes and we read all of them
> > using a MultiReader.
> > If we do a search using only terms, there are no problems, but it if we
> > add
> > to the same search terms a RangeFilter that extracts a large subset of
> the
> > documents (e.g. 500K), it takes a lot of time to execute (about 15s).
> >
> > In order to identify the problem, we have tried to consolidate the index:
> > so
> > now we have the same 3M docs in a single 10GB index.
> > If we repeat the same search using this index, it takes only a small
> > fraction of the previous time (about 2s).
> >
> > Is there something we can do to improve search performance using
> > RangeFilters with MultiReader or the only solution is to have only a
> > single
> > big index?
> >
> > Thanks,
> > Raf
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636765bbd27d2d70467425699--

From java-user-return-39664-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 08:32:19 2009
Return-Path: <java-user-return-39664-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82737 invoked from network); 11 Apr 2009 08:32:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 08:32:19 -0000
Received: (qmail 24226 invoked by uid 500); 11 Apr 2009 08:32:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24130 invoked by uid 500); 11 Apr 2009 08:32:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24119 invoked by uid 99); 11 Apr 2009 08:32:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 08:32:16 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 08:32:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id A5D4051577
	for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 10:31:42 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 21865-08 for <java-user@lucene.apache.org>;
 Sat, 11 Apr 2009 10:31:40 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id CE9885143B
	for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 10:31:40 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com> <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com> <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com> <9ac0c6aa0904101054o6cbfe83dhe0f2956151580f53@mail.gmail.com> <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com>
Subject: RE: RangeFilter performance problem using MultiReader
Date: Sat, 11 Apr 2009 10:31:42 +0200
Message-ID: <85719C3168944A0DA8698E10398B86FE@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MIMEOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
In-Reply-To: <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com>
Thread-Index: Acm6dCI64keHLusjSZeOFF5ulTC0pgACzIRg
X-Virus-Checked: Checked by ClamAV on apache.org

Ah,

Your test code shows why you do not see a speed improve with 2.9:
The speed improve in 2.9 is only visible for executing real searches and not
getDocIdSet alone on the big MultiReader. The 2.9 search algorithm
internally executes getDocIdSet not on the complete index (like you), it
executes it for each sub-index and each segment of these subindexes
separate. You code executes the filter on the whole index. This is not
faster in 2.9.

To compare speed, please use real search code (Searcher.search())!

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Raf [mailto:r.ventaglio@gmail.com]
> Sent: Saturday, April 11, 2009 9:07 AM
> To: java-user@lucene.apache.org
> Subject: Re: RangeFilter performance problem using MultiReader
> 
> Ok, here you can find some details about my tests:
> 
> *MultiReader creation*
> 
> IndexReader subReader;
> List<IndexReader> subReaders = new ArrayList<IndexReader>();
> for (Directory dir : this.directories) {
>      try {
>           subReader = IndexReader.open(dir, true);
>           subReaders.add(subReader);
>          } catch (...) {
>            ... ... ...
>          }
>      }
>     this.reader = new MultiReader(subReaders.toArray(new IndexReader[]
> {}));
> 
> (where *this.directories* is a List<Directory> containing all my index
> directories).
> 
> *RangeFilter test*
> 
> @Test
>     public void testRangeFilter() throws IOException, ParseException {
> 
>         IndexManager im = SearchObjectsFactory.getIndexManager();
>         IndexReader reader = im.getReader();
>         long timer;
>         DocIdSet docIdSet;
>         Filter filter;
>         logger.info("Num docs: " + reader.numDocs());
> 
>         logger.info("Before creating filter...");
>         timer = System.currentTimeMillis();
>         filter = new RangeFilter("date_doc", "20081001000000",
> "20090131235959", true, true);
>         logger.info("After creating filter..." +
> (System.currentTimeMillis()
> - timer));
> 
>         logger.info("Before reading idSet...");
>         timer = System.currentTimeMillis();
>         docIdSet = filter.getDocIdSet(reader);
>         logger.info("After reading idSet..." + ((OpenBitSet)
> docIdSet).cardinality() + " " + (System.currentTimeMillis() - timer));
> 
>         logger.info("Before reading idSet...");
>         timer = System.currentTimeMillis();
>         docIdSet = filter.getDocIdSet(reader);
>         logger.info("After reading idSet..." + ((OpenBitSet)
> docIdSet).cardinality() + " " + (System.currentTimeMillis() - timer));
> 
>         logger.info("Before reading idSet...");
>         timer = System.currentTimeMillis();
>         docIdSet = filter.getDocIdSet(reader);
>         logger.info("After reading idSet..." + ((OpenBitSet)
> docIdSet).cardinality() + " " + (System.currentTimeMillis() - timer));
>     }
> 
> *
> Test *results*   (Num docs = 2,940,738)
> 
> 1 Original index (12 collections * 6 months = 72 indexes)*
> 
> 1a Range [20090101000000 - 20090131235959] --> 379,560 docs
>      2,274 ms     1,477 ms     1,283 ms
> 
> 1b Range [20081201000000 - 20090131235959] --> 974,754 docs
>      4,489 ms     3,333 ms     3,390 ms
> 
> 1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
>      8,482 ms     7,471 ms     7,424 ms
> 
> 
> ***2Consolidated index (1 index)*
> 
> 2a Range [20090101000000 - 20090131235959] --> 379,560 docs
>      492 ms     116 ms     83 ms
> 
> 2b Range [20081201000000 - 20090131235959] --> 974,754 docs
>      640 ms     159 ms     138 ms
> 
> 2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
>      817 ms     322 ms    295 ms
> 
> 
> The field on which I am applying the RangeFilter is a date field and it
> has
> 299,622 unique terms.
> 
> Thanks,
> Raf
> 
> 
> On Fri, Apr 10, 2009 at 7:54 PM, Michael McCandless <
> lucene@mikemccandless.com> wrote:
> 
> > <cut>
> > Hmmm, interesting!
> >
> > Can you provide more details about your tests?  EG the code fragment
> > showing your query, the creation of the MultiReader, how you run the
> > search, etc.?
> >
> > Is the field that you're applying the RangeFilter on highly unique or
> > rather redundant?
> >
> > Mike
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39665-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 08:32:47 2009
Return-Path: <java-user-return-39665-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82923 invoked from network); 11 Apr 2009 08:32:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 08:32:47 -0000
Received: (qmail 25854 invoked by uid 500); 11 Apr 2009 08:32:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25782 invoked by uid 500); 11 Apr 2009 08:32:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25772 invoked by uid 99); 11 Apr 2009 08:32:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 08:32:45 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 08:32:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 0884B516DB
	for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 10:32:15 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 23055-06 for <java-user@lucene.apache.org>;
 Sat, 11 Apr 2009 10:32:13 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 4F58F5143B
	for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 10:32:13 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com> <38779BC2BAAF4935A22EC88F30B98814@VEGA> <70422ecc0904110021n47274bdapfed6f47cdd21f43d@mail.gmail.com>
Subject: RE: RangeFilter performance problem using MultiReader
Date: Sat, 11 Apr 2009 10:32:14 +0200
Message-ID: <F4EC102BE94C47C19A0FC3ED45A57149@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MIMEOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
In-Reply-To: <70422ecc0904110021n47274bdapfed6f47cdd21f43d@mail.gmail.com>
Thread-Index: Acm6dkhhsVsMIw1vS2SaX/c3t/9q8AACaxvw
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Raf,

it would be nice to hear how it works for you!

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Raf [mailto:r.ventaglio@gmail.com]
> Sent: Saturday, April 11, 2009 9:22 AM
> To: java-user@lucene.apache.org
> Subject: Re: RangeFilter performance problem using MultiReader
> 
> Thanks Uwe,
> I had already read about TrieRangeFilter on this mailing list and I
> thought
> it could be useful to solve my problem.
> I think I will trie it for test purposes.
> 
> Unfortunately, I have now to solve the problem in a production system and
> I
> would like to avoid using a yet unreleased version. So I think that my
> best
> choice, at the moment, is to consolidate my indexes and waiting until this
> interesting new feature will be available in the official release.
> 
> Thanks a lot to all of you,
> Raf
> 
> 
> On Fri, Apr 10, 2009 at 10:13 PM, Uwe Schindler <uwe@thetaphi.de> wrote:
> 
> > You got a lot of answers and questions about your index structure. Now
> > another idea, maybe this helps you to speed up your RangeFilter:
> >
> > What type of range do you want to query? From your index statistics, it
> > looks like a numeric/date field from which you filter very large ranges.
> If
> > the values are very fine-grained and so you hit a lot of terms for the
> > range, you might consider using TrieRangeFilter, which is a new contrib
> > module in the yet unreleased Lucene 2.9:
> >
> > http://hudson.zones.apache.org/hudson/job/Lucene-
> trunk/javadoc/all/org/apach
> > e/lucene/search/trie/package-
> summary.html<http://hudson.zones.apache.org/hudson/job/Lucene-
> trunk/javadoc/all/org/apach%0Ae/lucene/search/trie/package-summary.html>
> >
> > The name and API may change before release (if it moves to core), but
> you
> > can try it out, it is working stable and currently runs in productive
> > websites! It works for int, long, double, float and Date values (if
> encoded
> > using Date.getTime() as long).
> >
> > Uwe
> >
> > -----
> > Uwe Schindler
> > H.-H.-Meier-Allee 63, D-28213 Bremen
> > http://www.thetaphi.de
> > eMail: uwe@thetaphi.de
> >
> > > -----Original Message-----
> > > From: Raf [mailto:r.ventaglio@gmail.com]
> > > Sent: Friday, April 10, 2009 4:38 PM
> > > To: java-user@lucene.apache.org
> > > Subject: RangeFilter performance problem using MultiReader
> > >
> > > Hi,
> > > we are experiencing some problems using RangeFilters and we think
> there
> > > are
> > > some performance issues caused by MultiReader.
> > >
> > > We have more or less 3M documents in 24 indexes and we read all of
> them
> > > using a MultiReader.
> > > If we do a search using only terms, there are no problems, but it if
> we
> > > add
> > > to the same search terms a RangeFilter that extracts a large subset of
> > the
> > > documents (e.g. 500K), it takes a lot of time to execute (about 15s).
> > >
> > > In order to identify the problem, we have tried to consolidate the
> index:
> > > so
> > > now we have the same 3M docs in a single 10GB index.
> > > If we repeat the same search using this index, it takes only a small
> > > fraction of the previous time (about 2s).
> > >
> > > Is there something we can do to improve search performance using
> > > RangeFilters with MultiReader or the only solution is to have only a
> > > single
> > > big index?
> > >
> > > Thanks,
> > > Raf
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39666-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 09:27:59 2009
Return-Path: <java-user-return-39666-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99474 invoked from network); 11 Apr 2009 09:27:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 09:27:59 -0000
Received: (qmail 52186 invoked by uid 500); 11 Apr 2009 09:27:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52103 invoked by uid 500); 11 Apr 2009 09:27:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52093 invoked by uid 99); 11 Apr 2009 09:27:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 09:27:56 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of r.ventaglio@gmail.com designates 209.85.218.166 as permitted sender)
Received: from [209.85.218.166] (HELO mail-bw0-f166.google.com) (209.85.218.166)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 09:27:45 +0000
Received: by bwz10 with SMTP id 10so1579029bwz.5
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 02:27:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=0vXrz0jXg6AkFcg5M2zeTWXHEiuv4jK+fqR/JHzbAo8=;
        b=J/SJJo6vF3kByGdOGnceeAhIxCNYLewcJHtjJft+nK1emhHjSlvYqmo1EaeENthRsT
         4/QoBGv8g/cXdQqHxjn2FRv2LnCpEAv/b0tSgtNYJZS626nX2OTfQvF6kM28vdyAQkhR
         QEPkyZSuVhPXetvji03iKAidzPxh8Hqs7zjho=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=cJ/x3kpb/829CpCNQ43dnmCX3yvpMsB+aWBjLPhhVN0VBL5PMh1K0Vf76ZWzPg3Gcv
         lvKdlGd/4yRHUZbQyIEcJJZuplNVPNQf1n2jmf7A1bnXCafAIhX3R+3rXn+yjqH2ktZA
         Ahlu7UsD6J3Uqc+rm8fVCn+bjKzQ3s6kIuO5o=
MIME-Version: 1.0
Received: by 10.103.240.15 with SMTP id s15mr2284465mur.93.1239442045074; Sat, 
	11 Apr 2009 02:27:25 -0700 (PDT)
In-Reply-To: <85719C3168944A0DA8698E10398B86FE@VEGA>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com>
	 <9ac0c6aa0904101054o6cbfe83dhe0f2956151580f53@mail.gmail.com>
	 <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com>
	 <85719C3168944A0DA8698E10398B86FE@VEGA>
Date: Sat, 11 Apr 2009 11:27:25 +0200
Message-ID: <70422ecc0904110227u7870fb51wc20b9fc6501f35a6@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Raf <r.ventaglio@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016367ed4e1d0fcf2046744169a
X-Virus-Checked: Checked by ClamAV on apache.org

--0016367ed4e1d0fcf2046744169a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Uwe,
thanks for the clarification.
I have repeated my tests using a searcher and now the performance on 2.9 are
very better than those on 2.4.1, especially when the filter extracts a lot
of docs.

However the same search on the consolidated index is even faster so I have
now to verify if it is better for us to spend more time in creating indexes
(i.e. to add the overhead of consolidation) and to have very fast range
filter searches or to keep our small indexes and to have less fast range
filter searches.

In any case, I must wait until lucene 2.9 will be officially released,
before put it on the production environment, so I think I will have to
consolidate indexes for now.

Thanks a lot for your help,
Raf

If you are interested, here you can find the new test code and a result
comparison between 2.4.1 and 2.9:

*RangeFilter searcher test*

@Test
    public void testRangeFilterSearch() throws IOException, ParseException {

        IndexManager im = SearchObjectsFactory.getIndexManager();
        IndexReader reader = im.getReader();
        Searcher searcher = im.getSearcher();
        Query query = new MatchAllDocsQuery();
        long timer;
        Filter filter;
        TopDocs topDocs;
        logger.info("Num docs: " + reader.numDocs());

        logger.info("Before creating filter...");
        timer = System.currentTimeMillis();
        filter = new RangeFilter("date_doc", "20081001000000",
"20090131235959", true, true);
        logger.info("After creating filter..." + (System.currentTimeMillis()
- timer));

        logger.info("Before search...");
        timer = System.currentTimeMillis();
        topDocs = searcher.search(query, filter, 10);
        logger.info("After search..." + topDocs.totalHits + " " +
(System.currentTimeMillis() - timer));

        logger.info("Before reading idSet...");
        timer = System.currentTimeMillis();
        topDocs = searcher.search(query, filter, 10);
        logger.info("After search..." + topDocs.totalHits + " " +
(System.currentTimeMillis() - timer));

        logger.info("Before reading idSet...");
        timer = System.currentTimeMillis();
        topDocs = searcher.search(query, filter, 10);
        logger.info("After search..." + topDocs.totalHits + " " +
(System.currentTimeMillis() - timer));
    }

*Test *results*   (Num docs = 2,940,738)  using lucene-core-2.4.1

1 Original index (12 collections * 6 months = 72 indexes)*

1a Range [20090101000000 - 20090131235959] --> 379,560 docs
     2,179 ms     1,376 ms     1,424 ms

1b Range [20081201000000 - 20090131235959] --> 974,754 docs
     4,480 ms     3,361 ms     3,316 ms

1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     8,668 ms     7,621 ms     7,430 ms


*2Consolidated index (1 index)*

2a Range [20090101000000 - 20090131235959] --> 379,560 docs
     512 ms     84 ms     77 ms

2b Range [20081201000000 - 20090131235959] --> 974,754 docs
     750 ms     186 ms     208 ms

2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     968 ms     372 ms    345 ms


*Test *results*   (Num docs = 2,940,738)  using lucene-core-2.9-dev

1 Original index (12 collections * 6 months = 72 indexes)*

1a Range [20090101000000 - 20090131235959] --> 379,560 docs
     1,187 ms     273 ms     416 ms

1b Range [20081201000000 - 20090131235959] --> 974,754 docs
     1,539 ms     764 ms     571 ms

1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     2,235 ms     1,503 ms     1,260 ms


*2 Consolidated index (1 index)*

2a Range [20090101000000 - 20090131235959] --> 379,560 docs
     385 ms     85 ms     73 ms

2b Range [20081201000000 - 20090131235959] --> 974,754 docs
     490 ms     208 ms     196 ms

2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     707 ms     361 ms    317 ms



On Sat, Apr 11, 2009 at 10:31 AM, Uwe Schindler <uwe@thetaphi.de> wrote:

> Ah,
>
> Your test code shows why you do not see a speed improve with 2.9:
> The speed improve in 2.9 is only visible for executing real searches and
> not
> getDocIdSet alone on the big MultiReader. The 2.9 search algorithm
> internally executes getDocIdSet not on the complete index (like you), it
> executes it for each sub-index and each segment of these subindexes
> separate. You code executes the filter on the whole index. This is not
> faster in 2.9.
>
> To compare speed, please use real search code (Searcher.search())!
>
> Uwe
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
> > -----Original Message-----
> > From: Raf [mailto:r.ventaglio@gmail.com]
> > Sent: Saturday, April 11, 2009 9:07 AM
> > To: java-user@lucene.apache.org
> > Subject: Re: RangeFilter performance problem using MultiReader
> >
>

--0016367ed4e1d0fcf2046744169a--

From java-user-return-39667-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 09:49:32 2009
Return-Path: <java-user-return-39667-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13903 invoked from network); 11 Apr 2009 09:49:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 09:49:31 -0000
Received: (qmail 60015 invoked by uid 500); 11 Apr 2009 09:49:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59919 invoked by uid 500); 11 Apr 2009 09:49:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59909 invoked by uid 99); 11 Apr 2009 09:49:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 09:49:29 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.175] (HELO wf-out-1314.google.com) (209.85.200.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 09:49:21 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1360670wff.20
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 02:48:59 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.222.19 with SMTP id u19mr1744456wfg.58.1239443339459; Sat, 
	11 Apr 2009 02:48:59 -0700 (PDT)
In-Reply-To: <70422ecc0904110227u7870fb51wc20b9fc6501f35a6@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com>
	 <9ac0c6aa0904101054o6cbfe83dhe0f2956151580f53@mail.gmail.com>
	 <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com>
	 <85719C3168944A0DA8698E10398B86FE@VEGA>
	 <70422ecc0904110227u7870fb51wc20b9fc6501f35a6@mail.gmail.com>
Date: Sat, 11 Apr 2009 05:48:59 -0400
Message-ID: <9ac0c6aa0904110248s4fbf83b6nafd28cc9b16b0c46@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Sat, Apr 11, 2009 at 5:27 AM, Raf <r.ventaglio@gmail.com> wrote:

> I have repeated my tests using a searcher and now the performance on 2.9 are
> very better than those on 2.4.1, especially when the filter extracts a lot
> of docs.

OK, phew!

> However the same search on the consolidated index is even faster

This is very interesting... I think it must be because your field's
terms have some redundancy (299,622 unique terms vs ~3M docs), so
consolidation does improve performance substantially.

You have readers from 72 different directories, but is each directory
an optimized or unoptimized index?

> now to verify if it is better for us to spend more time in creating indexes
> (i.e. to add the overhead of consolidation) and to have very fast range
> filter searches or to keep our small indexes and to have less fast range
> filter searches.

On 2.9, I would first try LongTrieRangeFilter... it's simple to use
and may give you sizable performance gains on the MultiReader case
(and, on the consolidated index case).

> In any case, I must wait until lucene 2.9 will be officially released,
> before put it on the production environment, so I think I will have to
> consolidate indexes for now.

OK... there're alot of good changes coming up in 2.9 so hopefully we
can get a release out soon.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39668-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 10:05:17 2009
Return-Path: <java-user-return-39668-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24609 invoked from network); 11 Apr 2009 10:05:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 10:05:16 -0000
Received: (qmail 64216 invoked by uid 500); 11 Apr 2009 10:05:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64129 invoked by uid 500); 11 Apr 2009 10:05:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64117 invoked by uid 99); 11 Apr 2009 10:05:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 10:05:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ro.franchini@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 10:05:05 +0000
Received: by fxm2 with SMTP id 2so1572910fxm.5
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 03:04:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=PPnTqJUZRnecJgBwAoQkt6JRCzGWrQ9/v1d5qmTtjeA=;
        b=vmNDoB/jcEjGlHJWFq8K7tuNAs/J6Xeq/wQOEU5P4P8J8/UiFSbGWrNZEewf0Osbaz
         f6hPJIAIx5IbnI3+9Ym/nUCuVt1kSWVnBKbnnNAaIRGG25xUsZyi7kn3LJ+sxZQdI4YH
         92R3IRE3BLOaWH6xRsxMKefJHCY6Q4wSEHt0s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=aGPnH7rTOrX0PFA3BxBO7LE8TkFC2GdU8/eybCTNr6mxTonlu9pPKKQ4zWQXhWN/Mr
         dNiCyIuTDnDQ+pD2DVx+bArTMo612ykyPtZnYT+mazVkWwreEtsbB9IN6UnM2WWIpl/A
         5hOC7GEBdN6Sh2x4q51Hw7XhoFxQr6EFKEC0k=
MIME-Version: 1.0
Received: by 10.223.113.136 with SMTP id a8mr1256851faq.76.1239444284533; Sat, 
	11 Apr 2009 03:04:44 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904110248s4fbf83b6nafd28cc9b16b0c46@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com>
	 <9ac0c6aa0904101054o6cbfe83dhe0f2956151580f53@mail.gmail.com>
	 <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com>
	 <85719C3168944A0DA8698E10398B86FE@VEGA>
	 <70422ecc0904110227u7870fb51wc20b9fc6501f35a6@mail.gmail.com>
	 <9ac0c6aa0904110248s4fbf83b6nafd28cc9b16b0c46@mail.gmail.com>
Date: Sat, 11 Apr 2009 12:04:44 +0200
Message-ID: <63e2e4460904110304n51de11f9m1f0daaa1e84db680@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Roberto Franchini <ro.franchini@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Sat, Apr 11, 2009 at 11:48 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> On Sat, Apr 11, 2009 at 5:27 AM, Raf <r.ventaglio@gmail.com> wrote:
>
[cut]
>
> You have readers from 72 different directories, but is each directory
> an optimized or unoptimized index?

Hi,
I'm Raffaella's collegue, and I'm the "indexer" while she is the "searcher" :)

All indexes are optimized, we don't use compound files and we use the
NIO FSDirectory, since we are on linux-64.
We build indexes by month and then we aggregate them using the
multireader. On every month we can have more than one index, e.g:
200901-->index1, index2
200902-->index3
200903-->index4,index5,index6

Single indexes can be very little or very big, it depends on the source.
I think we can try to merge on moth basis so we can obtain only one
index for every month.
200901-->index12
200902-->index3
200903-->index456

Doing so, each month's index will be quite the same in size. I tihink
this could help to improve performance on 2.9.

[cut]

Thanks a lot to everybody.
R.

-- 
Roberto Franchini
http://www.celi.it
http://www.blogmeter.it
http://www.memesphere.it
Tel +39-011-6600814
jabber:ro.franchini@gmail.com skype:ro.franchini

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39669-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 11:50:45 2009
Return-Path: <java-user-return-39669-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57635 invoked from network); 11 Apr 2009 11:50:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 11:50:45 -0000
Received: (qmail 97641 invoked by uid 500); 11 Apr 2009 11:50:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97607 invoked by uid 500); 11 Apr 2009 11:50:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97597 invoked by uid 99); 11 Apr 2009 11:50:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 11:50:42 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.198.234] (HELO rv-out-0506.google.com) (209.85.198.234)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 11:50:34 +0000
Received: by rv-out-0506.google.com with SMTP id f6so1175301rvb.5
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 04:50:12 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.246.20 with SMTP id t20mr1783239wfh.143.1239450612757; 
	Sat, 11 Apr 2009 04:50:12 -0700 (PDT)
In-Reply-To: <63e2e4460904110304n51de11f9m1f0daaa1e84db680@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com>
	 <9ac0c6aa0904101054o6cbfe83dhe0f2956151580f53@mail.gmail.com>
	 <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com>
	 <85719C3168944A0DA8698E10398B86FE@VEGA>
	 <70422ecc0904110227u7870fb51wc20b9fc6501f35a6@mail.gmail.com>
	 <9ac0c6aa0904110248s4fbf83b6nafd28cc9b16b0c46@mail.gmail.com>
	 <63e2e4460904110304n51de11f9m1f0daaa1e84db680@mail.gmail.com>
Date: Sat, 11 Apr 2009 07:50:12 -0400
Message-ID: <9ac0c6aa0904110450h4d69905aw1f6d093698bb2528@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hmm then I'm a bit baffled again.

Because, each of your "by month" indexes presumably has a unique
subset of terms for the "date_doc" field?  Meaning, a given "by month"
index will have all date_doc corresponding to that month, and a
different "by month" index would presumably have no overlap in the
terms for the date_doc field.

I'm baffled because I'd expect in such a case for the performance an
optimized index vs 72-sub-index MultiReader to be closer, on 2.9.
Hmm.

Mike

On Sat, Apr 11, 2009 at 6:04 AM, Roberto Franchini
<ro.franchini@gmail.com> wrote:
> On Sat, Apr 11, 2009 at 11:48 AM, Michael McCandless
> <lucene@mikemccandless.com> wrote:
>> On Sat, Apr 11, 2009 at 5:27 AM, Raf <r.ventaglio@gmail.com> wrote:
>>
> [cut]
>>
>> You have readers from 72 different directories, but is each directory
>> an optimized or unoptimized index?
>
> Hi,
> I'm Raffaella's collegue, and I'm the "indexer" while she is the "searcher" :)
>
> All indexes are optimized, we don't use compound files and we use the
> NIO FSDirectory, since we are on linux-64.
> We build indexes by month and then we aggregate them using the
> multireader. On every month we can have more than one index, e.g:
> 200901-->index1, index2
> 200902-->index3
> 200903-->index4,index5,index6
>
> Single indexes can be very little or very big, it depends on the source.
> I think we can try to merge on moth basis so we can obtain only one
> index for every month.
> 200901-->index12
> 200902-->index3
> 200903-->index456
>
> Doing so, each month's index will be quite the same in size. I tihink
> this could help to improve performance on 2.9.
>
> [cut]
>
> Thanks a lot to everybody.
> R.
>
> --
> Roberto Franchini
> http://www.celi.it
> http://www.blogmeter.it
> http://www.memesphere.it
> Tel +39-011-6600814
> jabber:ro.franchini@gmail.com skype:ro.franchini
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39670-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 13:22:14 2009
Return-Path: <java-user-return-39670-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90531 invoked from network); 11 Apr 2009 13:22:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 13:22:14 -0000
Received: (qmail 39761 invoked by uid 500); 11 Apr 2009 13:22:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39685 invoked by uid 500); 11 Apr 2009 13:22:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39675 invoked by uid 99); 11 Apr 2009 13:22:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 13:22:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ro.franchini@gmail.com designates 209.85.218.166 as permitted sender)
Received: from [209.85.218.166] (HELO mail-bw0-f166.google.com) (209.85.218.166)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 13:22:04 +0000
Received: by bwz10 with SMTP id 10so1665885bwz.5
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 06:21:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=1WOFjxYHepmJQDut6Spoel0CqsQLIa52Aofg7cN1ft0=;
        b=gQzg4n3PgjlmnfclAViInRre+yWNHCWezRvTQ2j3rktqJm0D5osbKW85RfLhwqEhIn
         PvfMqq4yBshBhLg0Tjxm+WwvAnAZ97ReGJiKsK1mW1WLo0T26csZV6Rq5/Hh6haQ8XdC
         pqcTNKrN3zM09AnHmSctao3ryNOueJNJ8orZo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=kFUt0O1T0efVRm0uC7BQsHh0dEpCvJMFJc0fu9FXL1eB00nXe/fvaso1XepubJ+ktz
         Za9by+4cl2ptgwQaQIYdyotCy9L9KphCj1ZOZlWV3D6AQrGruTq7yGHyZlNplhWWHeQx
         qSydQnjFuOk6UvBkmJWnZA9BniPJWAJ1Rz+N8=
MIME-Version: 1.0
Received: by 10.223.113.132 with SMTP id a4mr655718faq.75.1239456102474; Sat, 
	11 Apr 2009 06:21:42 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904110450h4d69905aw1f6d093698bb2528@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com>
	 <9ac0c6aa0904101054o6cbfe83dhe0f2956151580f53@mail.gmail.com>
	 <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com>
	 <85719C3168944A0DA8698E10398B86FE@VEGA>
	 <70422ecc0904110227u7870fb51wc20b9fc6501f35a6@mail.gmail.com>
	 <9ac0c6aa0904110248s4fbf83b6nafd28cc9b16b0c46@mail.gmail.com>
	 <63e2e4460904110304n51de11f9m1f0daaa1e84db680@mail.gmail.com>
	 <9ac0c6aa0904110450h4d69905aw1f6d093698bb2528@mail.gmail.com>
Date: Sat, 11 Apr 2009 15:21:42 +0200
Message-ID: <63e2e4460904110621s78163340pbf88a99831678ec3@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Roberto Franchini <ro.franchini@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Sat, Apr 11, 2009 at 1:50 PM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> Hmm then I'm a bit baffled again.
>
> Because, each of your "by month" indexes presumably has a unique
> subset of terms for the "date_doc" field? =A0Meaning, a given "by month"
> index will have all date_doc corresponding to that month, and a
> different "by month" index would presumably have no overlap in the
> terms for the date_doc field.

Yes and no :) In this situation:

>> 200901-->index1, index2
>> 200902-->index3
>> 200903-->index4,index5,index6

each month does not overlap with each other, but index1 and index2
overlap, and so index4 with 5 and 6. So there's overlapping inside a
single month.
So I want to trie, next week, this one:
>> 200901-->index12 (merge of 1 and 2)
>> 200902-->index3
>> 200903-->index456 (merge of 4,5,6)

This way we avoid overlapping inside a single month. Maybe this can
help: stay tuned :)
R.


--=20
Roberto Franchini
http://www.celi.it
http://www.blogmeter.it
http://www.memesphere.it
Tel +39-011-6600814
jabber:ro.franchini@gmail.com skype:ro.franchini

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39671-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 14:03:07 2009
Return-Path: <java-user-return-39671-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9452 invoked from network); 11 Apr 2009 14:03:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 14:03:06 -0000
Received: (qmail 56230 invoked by uid 500); 11 Apr 2009 14:03:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56155 invoked by uid 500); 11 Apr 2009 14:03:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56143 invoked by uid 99); 11 Apr 2009 14:03:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 14:03:03 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.172] (HELO wf-out-1314.google.com) (209.85.200.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 14:02:55 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1400762wff.20
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 07:02:34 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.14.18 with SMTP id 18mr1815933wfn.304.1239458554220; Sat, 
	11 Apr 2009 07:02:34 -0700 (PDT)
In-Reply-To: <63e2e4460904110621s78163340pbf88a99831678ec3@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com>
	 <9ac0c6aa0904101054o6cbfe83dhe0f2956151580f53@mail.gmail.com>
	 <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com>
	 <85719C3168944A0DA8698E10398B86FE@VEGA>
	 <70422ecc0904110227u7870fb51wc20b9fc6501f35a6@mail.gmail.com>
	 <9ac0c6aa0904110248s4fbf83b6nafd28cc9b16b0c46@mail.gmail.com>
	 <63e2e4460904110304n51de11f9m1f0daaa1e84db680@mail.gmail.com>
	 <9ac0c6aa0904110450h4d69905aw1f6d093698bb2528@mail.gmail.com>
	 <63e2e4460904110621s78163340pbf88a99831678ec3@mail.gmail.com>
Date: Sat, 11 Apr 2009 10:02:34 -0400
Message-ID: <9ac0c6aa0904110702s5619926bpaab0c950c6d617d5@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Ahhh, OK, perhaps that explains the sizable perf difference you're
seeing w/ optimized vs not.  I'm curious to see the results of your
"merge each month into 1 index" test...

Mike

On Sat, Apr 11, 2009 at 9:21 AM, Roberto Franchini
<ro.franchini@gmail.com> wrote:
> On Sat, Apr 11, 2009 at 1:50 PM, Michael McCandless
> <lucene@mikemccandless.com> wrote:
>> Hmm then I'm a bit baffled again.
>>
>> Because, each of your "by month" indexes presumably has a unique
>> subset of terms for the "date_doc" field? =A0Meaning, a given "by month"
>> index will have all date_doc corresponding to that month, and a
>> different "by month" index would presumably have no overlap in the
>> terms for the date_doc field.
>
> Yes and no :) In this situation:
>
>>> 200901-->index1, index2
>>> 200902-->index3
>>> 200903-->index4,index5,index6
>
> each month does not overlap with each other, but index1 and index2
> overlap, and so index4 with 5 and 6. So there's overlapping inside a
> single month.
> So I want to trie, next week, this one:
>>> 200901-->index12 (merge of 1 and 2)
>>> 200902-->index3
>>> 200903-->index456 (merge of 4,5,6)
>
> This way we avoid overlapping inside a single month. Maybe this can
> help: stay tuned :)
> R.
>
>
> --
> Roberto Franchini
> http://www.celi.it
> http://www.blogmeter.it
> http://www.memesphere.it
> Tel +39-011-6600814
> jabber:ro.franchini@gmail.com skype:ro.franchini
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39672-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 14:36:52 2009
Return-Path: <java-user-return-39672-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17994 invoked from network); 11 Apr 2009 14:36:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 14:36:51 -0000
Received: (qmail 73703 invoked by uid 500); 11 Apr 2009 14:36:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73604 invoked by uid 500); 11 Apr 2009 14:36:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73594 invoked by uid 99); 11 Apr 2009 14:36:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 14:36:49 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 14:36:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 838CC51847
	for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 16:36:17 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 07394-10 for <java-user@lucene.apache.org>;
 Sat, 11 Apr 2009 16:36:15 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 47B6F51707
	for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 16:36:15 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com> <70422ecc0904101020k17cab6a8xe2365c1f2b5156b3@mail.gmail.com> <9ac0c6aa0904101054o6cbfe83dhe0f2956151580f53@mail.gmail.com> <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com> <85719C3168944A0DA8698E10398B86FE@VEGA> <70422ecc0904110227u7870fb51wc20b9fc6501f35a6@mail.gmail.com> <9ac0c6aa0904110248s4fbf83b6nafd28cc9b16b0c46@mail.gmail.com> <63e2e4460904110304n51de11f9m1f0daaa1e84db680@mail.gmail.com> <9ac0c6aa0904110450h4d69905aw1f6d093698bb2528@mail.gmail.com> <63e2e4460904110621s78163340pbf88a99831678ec3@mail.gmail.com> <9ac0c6aa0904110702s5619926bpaab0c950c6d617d5@mail.gmail.com>
Subject: RE: RangeFilter performance problem using MultiReader
Date: Sat, 11 Apr 2009 16:36:16 +0200
Message-ID: <A13FDAFA93354EC893F1C09307FE9356@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <9ac0c6aa0904110702s5619926bpaab0c950c6d617d5@mail.gmail.com>
Thread-Index: Acm6rkHuK1OKrG93SWieKarAslxR4gABBeLg
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

In addition to merging each month into one index instead of all in one
index, you could also do some additional optimization when using the =
Range
filter:
Just combine only those indexes needed to fulfil the range spec during
search. So if somebody want to filter Jan 15 to Feb 15, only create a
MultiReader of the indexes for Jan and Feb, this would speed up the =
whole
search (also for terms), as the filter would simply remove all documents
from the wrong months.

But the best would be to use TrieRange :)

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Michael McCandless [mailto:lucene@mikemccandless.com]
> Sent: Saturday, April 11, 2009 4:03 PM
> To: java-user@lucene.apache.org
> Subject: Re: RangeFilter performance problem using MultiReader
>=20
> Ahhh, OK, perhaps that explains the sizable perf difference you're
> seeing w/ optimized vs not.  I'm curious to see the results of your
> "merge each month into 1 index" test...
>=20
> Mike
>=20
> On Sat, Apr 11, 2009 at 9:21 AM, Roberto Franchini
> <ro.franchini@gmail.com> wrote:
> > On Sat, Apr 11, 2009 at 1:50 PM, Michael McCandless
> > <lucene@mikemccandless.com> wrote:
> >> Hmm then I'm a bit baffled again.
> >>
> >> Because, each of your "by month" indexes presumably has a unique
> >> subset of terms for the "date_doc" field? =A0Meaning, a given "by =
month"
> >> index will have all date_doc corresponding to that month, and a
> >> different "by month" index would presumably have no overlap in the
> >> terms for the date_doc field.
> >
> > Yes and no :) In this situation:
> >
> >>> 200901-->index1, index2
> >>> 200902-->index3
> >>> 200903-->index4,index5,index6
> >
> > each month does not overlap with each other, but index1 and index2
> > overlap, and so index4 with 5 and 6. So there's overlapping inside a
> > single month.
> > So I want to trie, next week, this one:
> >>> 200901-->index12 (merge of 1 and 2)
> >>> 200902-->index3
> >>> 200903-->index456 (merge of 4,5,6)
> >
> > This way we avoid overlapping inside a single month. Maybe this can
> > help: stay tuned :)
> > R.
> >
> >
> > --
> > Roberto Franchini
> > http://www.celi.it
> > http://www.blogmeter.it
> > http://www.memesphere.it
> > Tel +39-011-6600814
> > jabber:ro.franchini@gmail.com skype:ro.franchini
> >
> > =
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39673-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 16:12:07 2009
Return-Path: <java-user-return-39673-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45642 invoked from network); 11 Apr 2009 16:12:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 16:12:07 -0000
Received: (qmail 38719 invoked by uid 500); 11 Apr 2009 16:12:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38637 invoked by uid 500); 11 Apr 2009 16:12:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38627 invoked by uid 99); 11 Apr 2009 16:12:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 16:12:04 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 74.125.92.24 as permitted sender)
Received: from [74.125.92.24] (HELO qw-out-2122.google.com) (74.125.92.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 16:11:54 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1031451qwh.53
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 09:11:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=CGVQDtzCf12Z6RaruvZt4KydS0Bw9ERkLtlT2H9owHc=;
        b=Dvw7gXR0VZ1v4lWBe6+5Uo3WH+WZzLo6s0WY0tH81DhePFlSnocJ9MmedgLfjA2xeK
         2Fk13W1dRrzOyMU8Ji8TljIuOhCJfwN80+NRfNPgxBulHxWsRG5s6nDpXeta61kJogOQ
         gpDHMH4kQjhCRjL6dvuc8OBa2RiCMVDcoeRV0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Nz57FUeTMforDKmeZwt+QTeeSk8dsISS0qG+TLt+KlB4CFvvh2cZJmavaNlRHwR3Ch
         iWQdrTyf1wjDB5eM4vAdkg74YlRU2uEfy96vjVWdF3c1i6yXKiRb6Z0eM5i2m7kjAAwA
         i5V0Kr8IoXCem2cVaDAXiY8KaJv6LyKcIZixU=
MIME-Version: 1.0
Received: by 10.220.95.202 with SMTP id e10mr5557373vcn.12.1239466293452; Sat, 
	11 Apr 2009 09:11:33 -0700 (PDT)
In-Reply-To: <332506.17389.qm@web110210.mail.gq1.yahoo.com>
References: <332506.17389.qm@web110210.mail.gq1.yahoo.com>
Date: Sat, 11 Apr 2009 09:11:33 -0700
Message-ID: <359a92830904110911w229e7693h6393e6ca3afa8fa4@mail.gmail.com>
Subject: Re: Lucene searching across documents
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64eacb421de9b046749bccd
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64eacb421de9b046749bccd
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

http://people.apache.org/~hossman/#threadhijack<http://people.apache.org/%7Ehossman/#threadhijack>
Thread Hijacking on Mailing Lists

When starting a new discussion on a mailing list, please do not reply to
an existing message, instead start a fresh email.  Even if you change the
subject line of your email, other mail headers still track which thread
you replied to and your question is "hidden" in that thread and gets less
attention.   It makes following discussions in the mailing list archives
particularly difficult.
See Also:  http://en.wikipedia.org/wiki/Thread_hijacking

Best
Erick

On Wed, Apr 8, 2009 at 11:23 PM, Andy <andykan1984@yahoo.com> wrote:

> Hello all,
>
>
>
> I'm trying to implement a vector space model using lucene. I need to
> have a file (or on memory) with TF/IDF weight of each term in each
> document. (in fact that is a matrix with documents presented as
> vectors, in which the elements of each vector is the TF weight ...)
>
>
>
> Please Please help me on this
>
> contac me if you need any further info via andykan1984@yahoo.com
>
> Many Many thanks
>
>
>

--0016e64eacb421de9b046749bccd--

From java-user-return-39674-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 16:22:52 2009
Return-Path: <java-user-return-39674-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47492 invoked from network); 11 Apr 2009 16:22:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 16:22:49 -0000
Received: (qmail 49250 invoked by uid 500); 11 Apr 2009 16:22:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49160 invoked by uid 500); 11 Apr 2009 16:22:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49150 invoked by uid 99); 11 Apr 2009 16:22:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 16:22:47 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 16:22:38 +0000
Received: by qyk8 with SMTP id 8so2338670qyk.29
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 09:22:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=mvChu0D3Oqla6MV0KuD9fHvhFKCAG0OHAR7Szp9Lv0o=;
        b=v1m5PLL6fOftF9Y+x3cwZshBnpFuW6e2oyof0oG5Eu/nasH6irGgD0KxA7TYrttO3k
         N1KTiIqmDzC0fZzsBbuAfPDbTUvBDjvuci3n21Ptz/hdVrSjP3EgN4P35jRgLfGA3T9W
         gUYpQXO4Rx4o23ZGm5s/FNhUvPYcHTGdSuVOo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=AOuE++Py39layL4869rFMEkt/vTgxhoQSpkD0JfYE8K/5NUIDaL29ky+C11q638hiI
         JkwqFgcsS7IpH/uPHkp9F+m+cnq8ljhR/Hpyd5CEUFEkgqmMWe4vNczaZj1Kd/mk/31U
         zYeWxqfwa3/RTvYwnsoeq0ucaIN/JFY9hw7Hc=
MIME-Version: 1.0
Received: by 10.220.98.202 with SMTP id r10mr5527342vcn.67.1239466938009; Sat, 
	11 Apr 2009 09:22:18 -0700 (PDT)
In-Reply-To: <22995240.post@talk.nabble.com>
References: <22995240.post@talk.nabble.com>
Date: Sat, 11 Apr 2009 09:22:17 -0700
Message-ID: <359a92830904110922q68c7d16eladb4d62c4466a594@mail.gmail.com>
Subject: Re: Sequential match query
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e645fad08d0902046749e2d5
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e645fad08d0902046749e2d5
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Wildcard queries are not lowercased, so depending upon
how you're indexing, that may be tripping you up.

See
http://wiki.apache.org/lucene-java/LuceneFAQ#head-133cf44dd3dff3680c96c1316a663e881eeac35a

Best
Erick

On Fri, Apr 10, 2009 at 2:56 PM, John Seer <pulsphoto@yahoo.com> wrote:

>
> Hello,
> I have 3 terms and I want to much them in order I tried to use wildcard
> query I am not getting any results back
>
> Terms: A C F
>
> Doc: name:A B C D E F
>
> query: name:A*C*F
>
> I am not getting any results back,
> Please any suggestions?
>
> Thanks for help in advance
> --
> View this message in context:
> http://www.nabble.com/Sequential-match-query-tp22995240p22995240.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e645fad08d0902046749e2d5--

From java-user-return-39675-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 16:26:32 2009
Return-Path: <java-user-return-39675-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48339 invoked from network); 11 Apr 2009 16:26:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 16:26:32 -0000
Received: (qmail 52089 invoked by uid 500); 11 Apr 2009 16:26:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52002 invoked by uid 500); 11 Apr 2009 16:26:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51992 invoked by uid 99); 11 Apr 2009 16:26:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 16:26:29 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 16:26:20 +0000
Received: by qyk8 with SMTP id 8so2339874qyk.29
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 09:25:59 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=mM5mWY3A08L9MynnDtKpZpgIACSljwpTqnhSsAWjzeE=;
        b=yE6vN4kX9y94bpAS/y0mloynGzusLeoKmU06hKXAsTGJpCmsFpS5qEPX+DU1rGWERy
         l4boVfMTr4H0Cvft4/jhRfFhse0U+dkpIvetAtCwLEV2+uBnXinc8B2illexh2BK7d1f
         afP6HMRlbYWjKNQdzV15H3ZkJ6rBDlXi63vcI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ad/cANEUFYowv4HQoBKQ7T4pDBm/+8k12UZKo1S5UIR5BDDJUR+0tEjiJj9u8jPMYn
         W8OMpkjedxOrnW29K4DeywULaXhluMzRfdWItXvMwhnx7Gyjng7GIuDiR+ElFp2BdXdb
         QqbSMEgIFvagoCf17yxwNyqfb0U083ckc/FKo=
MIME-Version: 1.0
Received: by 10.220.99.149 with SMTP id u21mr5463422vcn.94.1239467158893; Sat, 
	11 Apr 2009 09:25:58 -0700 (PDT)
In-Reply-To: <22995240.post@talk.nabble.com>
References: <22995240.post@talk.nabble.com>
Date: Sat, 11 Apr 2009 09:25:58 -0700
Message-ID: <359a92830904110925m24dda294l343ad947acb3ea43@mail.gmail.com>
Subject: Re: Sequential match query
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64650a0b774c8046749efda
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64650a0b774c8046749efda
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

That'll teach me to scan a post. The link I sent you
is still relevant, but wildcards are NOT intended to be used to
concatenate terms. You want a phrase query or a span query
for that. i.e. "A C F"~# where # is the "slop", that is, the number
of other terms allowed to appear between your desired terms.

SpanQueries are constructed programmatically, and PhraseQueries
are produced by the parser.

Best
Erick@IReadItThisTimeIThink.

On Fri, Apr 10, 2009 at 2:56 PM, John Seer <pulsphoto@yahoo.com> wrote:

>
> Hello,
> I have 3 terms and I want to much them in order I tried to use wildcard
> query I am not getting any results back
>
> Terms: A C F
>
> Doc: name:A B C D E F
>
> query: name:A*C*F
>
> I am not getting any results back,
> Please any suggestions?
>
> Thanks for help in advance
> --
> View this message in context:
> http://www.nabble.com/Sequential-match-query-tp22995240p22995240.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64650a0b774c8046749efda--

From java-user-return-39676-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 16:42:28 2009
Return-Path: <java-user-return-39676-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50140 invoked from network); 11 Apr 2009 16:42:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 16:42:28 -0000
Received: (qmail 60405 invoked by uid 500); 11 Apr 2009 16:42:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60312 invoked by uid 500); 11 Apr 2009 16:42:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60301 invoked by uid 99); 11 Apr 2009 16:42:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 16:42:25 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 16:42:15 +0000
Received: by qyk8 with SMTP id 8so2345242qyk.29
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 09:41:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=yd4wx4x4RP/uIOfCd1RX3kUvndtLI1TDRa5qWQVZq1Q=;
        b=E/Gh0k61QxNhRVLMsBfSgE38nPR05mOAk2b8ZqJlxLN51klwldxupTln4a2oja03X+
         uMPwokC7PjEWIZq+IDvJdNIw3F2W/3KqA+o1dTcYy8A8yU1piHHWICzdjNOTStql7myq
         AQ/sE3vvZsLa7ssvmeVD2PX9odW8ang2fnwno=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=UNhZmAZhql9Xc/oMLCkhUB9Ym/HkfFQq19T+pEeRjOvV0ua/F3z5ccGZ/mrHCKf/1q
         B7Ww5R4s95LYxR4A204pagPFfRhIvTtbxqX3juOtvjpRjkrYmfZv27TZqLKdc/uvXX1I
         HfG4aY5CKXYBQZxztyKcfPGeIC2aujziKVURM=
MIME-Version: 1.0
Received: by 10.220.85.199 with SMTP id p7mr5470758vcl.104.1239468114244; Sat, 
	11 Apr 2009 09:41:54 -0700 (PDT)
In-Reply-To: <A13FDAFA93354EC893F1C09307FE9356@VEGA>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com>
	 <85719C3168944A0DA8698E10398B86FE@VEGA>
	 <70422ecc0904110227u7870fb51wc20b9fc6501f35a6@mail.gmail.com>
	 <9ac0c6aa0904110248s4fbf83b6nafd28cc9b16b0c46@mail.gmail.com>
	 <63e2e4460904110304n51de11f9m1f0daaa1e84db680@mail.gmail.com>
	 <9ac0c6aa0904110450h4d69905aw1f6d093698bb2528@mail.gmail.com>
	 <63e2e4460904110621s78163340pbf88a99831678ec3@mail.gmail.com>
	 <9ac0c6aa0904110702s5619926bpaab0c950c6d617d5@mail.gmail.com>
	 <A13FDAFA93354EC893F1C09307FE9356@VEGA>
Date: Sat, 11 Apr 2009 09:41:53 -0700
Message-ID: <359a92830904110941g1973c016ie09d393478e537f5@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64718e0a8f35604674a2870
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64718e0a8f35604674a2870
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

OK, I scanned all the e-mails in this thread so I may be way off base, but
has anyone yet asked the basic question of whether the granularity of the
dates is really necessary <G>?

Raf and Roberto:

It appears you're indexing your dates down to second resolution, which
is why your number of unique terms is so high. Will it serve your use-case
to only index down to day? or perhaps hour? That will reduce your number
of terms substantially. There is also the possibility of breaking up your
dates into two or more fields if you really require the granularity. You
could
probably run a quick test of this approach just to see how it would change
your search times before investing too muchtime in the process....

But I'm entirely ignorant of the multireader nuances, so this may be
completely
irrelevant....

Best
Erick


On Sat, Apr 11, 2009 at 7:36 AM, Uwe Schindler <uwe@thetaphi.de> wrote:

> In addition to merging each month into one index instead of all in one
> index, you could also do some additional optimization when using the Range
> filter:
> Just combine only those indexes needed to fulfil the range spec during
> search. So if somebody want to filter Jan 15 to Feb 15, only create a
> MultiReader of the indexes for Jan and Feb, this would speed up the whole
> search (also for terms), as the filter would simply remove all documents
> from the wrong months.
>
> But the best would be to use TrieRange :)
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
> > -----Original Message-----
> > From: Michael McCandless [mailto:lucene@mikemccandless.com]
> > Sent: Saturday, April 11, 2009 4:03 PM
> > To: java-user@lucene.apache.org
> > Subject: Re: RangeFilter performance problem using MultiReader
> >
> > Ahhh, OK, perhaps that explains the sizable perf difference you're
> > seeing w/ optimized vs not.  I'm curious to see the results of your
> > "merge each month into 1 index" test...
> >
> > Mike
> >
> > On Sat, Apr 11, 2009 at 9:21 AM, Roberto Franchini
> > <ro.franchini@gmail.com> wrote:
> > > On Sat, Apr 11, 2009 at 1:50 PM, Michael McCandless
> > > <lucene@mikemccandless.com> wrote:
> > >> Hmm then I'm a bit baffled again.
> > >>
> > >> Because, each of your "by month" indexes presumably has a unique
> > >> subset of terms for the "date_doc" field?  Meaning, a given "by month"
> > >> index will have all date_doc corresponding to that month, and a
> > >> different "by month" index would presumably have no overlap in the
> > >> terms for the date_doc field.
> > >
> > > Yes and no :) In this situation:
> > >
> > >>> 200901-->index1, index2
> > >>> 200902-->index3
> > >>> 200903-->index4,index5,index6
> > >
> > > each month does not overlap with each other, but index1 and index2
> > > overlap, and so index4 with 5 and 6. So there's overlapping inside a
> > > single month.
> > > So I want to trie, next week, this one:
> > >>> 200901-->index12 (merge of 1 and 2)
> > >>> 200902-->index3
> > >>> 200903-->index456 (merge of 4,5,6)
> > >
> > > This way we avoid overlapping inside a single month. Maybe this can
> > > help: stay tuned :)
> > > R.
> > >
> > >
> > > --
> > > Roberto Franchini
> > > http://www.celi.it
> > > http://www.blogmeter.it
> > > http://www.memesphere.it
> > > Tel +39-011-6600814
> > > jabber:ro.franchini@gmail.com <jabber%3Aro.franchini@gmail.com>skype:ro.franchini
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64718e0a8f35604674a2870--

From java-user-return-39677-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 18:24:07 2009
Return-Path: <java-user-return-39677-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94105 invoked from network); 11 Apr 2009 18:24:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 18:24:07 -0000
Received: (qmail 3453 invoked by uid 500); 11 Apr 2009 18:24:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3372 invoked by uid 500); 11 Apr 2009 18:24:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3362 invoked by uid 99); 11 Apr 2009 18:24:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 18:24:04 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 18:23:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 57DAD51900
	for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 20:23:33 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 20939-05 for <java-user@lucene.apache.org>;
 Sat, 11 Apr 2009 20:23:31 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 33D2251876
	for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 20:23:31 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com> <70422ecc0904110006v35fdc65q77b939f849606b98@mail.gmail.com> <85719C3168944A0DA8698E10398B86FE@VEGA> <70422ecc0904110227u7870fb51wc20b9fc6501f35a6@mail.gmail.com> <9ac0c6aa0904110248s4fbf83b6nafd28cc9b16b0c46@mail.gmail.com> <63e2e4460904110304n51de11f9m1f0daaa1e84db680@mail.gmail.com> <9ac0c6aa0904110450h4d69905aw1f6d093698bb2528@mail.gmail.com> <63e2e4460904110621s78163340pbf88a99831678ec3@mail.gmail.com> <9ac0c6aa0904110702s5619926bpaab0c950c6d617d5@mail.gmail.com> <A13FDAFA93354EC893F1C09307FE9356@VEGA> <359a92830904110941g1973c016ie09d393478e537f5@mail.gmail.com>
Subject: RE: RangeFilter performance problem using MultiReader
Date: Sat, 11 Apr 2009 20:23:32 +0200
Message-ID: <7BBDF4D75D3C4E9BBE69580F0E00CFBA@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: Acm6xIHAHtwb3L8yTEKnLEm99MviWgADY3Hg
In-Reply-To: <359a92830904110941g1973c016ie09d393478e537f5@mail.gmail.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

This is why I invented TrieRange: Full precision dates but less terms during
filtering/searching. With TrieRange on the longs returned bay Date.getTime()
you even have precision of milliseconds without any speed decrease (only
bigger index size). Or double values with full precision, everything is
possible :-)

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Erick Erickson [mailto:erickerickson@gmail.com]
> Sent: Saturday, April 11, 2009 6:42 PM
> To: java-user@lucene.apache.org
> Subject: Re: RangeFilter performance problem using MultiReader
> 
> OK, I scanned all the e-mails in this thread so I may be way off base, but
> has anyone yet asked the basic question of whether the granularity of the
> dates is really necessary <G>?
> 
> Raf and Roberto:
> 
> It appears you're indexing your dates down to second resolution, which
> is why your number of unique terms is so high. Will it serve your use-case
> to only index down to day? or perhaps hour? That will reduce your number
> of terms substantially. There is also the possibility of breaking up your
> dates into two or more fields if you really require the granularity. You
> could
> probably run a quick test of this approach just to see how it would change
> your search times before investing too muchtime in the process....
> 
> But I'm entirely ignorant of the multireader nuances, so this may be
> completely
> irrelevant....
> 
> Best
> Erick
> 
> 
> On Sat, Apr 11, 2009 at 7:36 AM, Uwe Schindler <uwe@thetaphi.de> wrote:
> 
> > In addition to merging each month into one index instead of all in one
> > index, you could also do some additional optimization when using the
> Range
> > filter:
> > Just combine only those indexes needed to fulfil the range spec during
> > search. So if somebody want to filter Jan 15 to Feb 15, only create a
> > MultiReader of the indexes for Jan and Feb, this would speed up the
> whole
> > search (also for terms), as the filter would simply remove all documents
> > from the wrong months.
> >
> > But the best would be to use TrieRange :)
> >
> > -----
> > Uwe Schindler
> > H.-H.-Meier-Allee 63, D-28213 Bremen
> > http://www.thetaphi.de
> > eMail: uwe@thetaphi.de
> >
> > > -----Original Message-----
> > > From: Michael McCandless [mailto:lucene@mikemccandless.com]
> > > Sent: Saturday, April 11, 2009 4:03 PM
> > > To: java-user@lucene.apache.org
> > > Subject: Re: RangeFilter performance problem using MultiReader
> > >
> > > Ahhh, OK, perhaps that explains the sizable perf difference you're
> > > seeing w/ optimized vs not.  I'm curious to see the results of your
> > > "merge each month into 1 index" test...
> > >
> > > Mike
> > >
> > > On Sat, Apr 11, 2009 at 9:21 AM, Roberto Franchini
> > > <ro.franchini@gmail.com> wrote:
> > > > On Sat, Apr 11, 2009 at 1:50 PM, Michael McCandless
> > > > <lucene@mikemccandless.com> wrote:
> > > >> Hmm then I'm a bit baffled again.
> > > >>
> > > >> Because, each of your "by month" indexes presumably has a unique
> > > >> subset of terms for the "date_doc" field?  Meaning, a given "by
> month"
> > > >> index will have all date_doc corresponding to that month, and a
> > > >> different "by month" index would presumably have no overlap in the
> > > >> terms for the date_doc field.
> > > >
> > > > Yes and no :) In this situation:
> > > >
> > > >>> 200901-->index1, index2
> > > >>> 200902-->index3
> > > >>> 200903-->index4,index5,index6
> > > >
> > > > each month does not overlap with each other, but index1 and index2
> > > > overlap, and so index4 with 5 and 6. So there's overlapping inside a
> > > > single month.
> > > > So I want to trie, next week, this one:
> > > >>> 200901-->index12 (merge of 1 and 2)
> > > >>> 200902-->index3
> > > >>> 200903-->index456 (merge of 4,5,6)
> > > >
> > > > This way we avoid overlapping inside a single month. Maybe this can
> > > > help: stay tuned :)
> > > > R.
> > > >
> > > >
> > > > --
> > > > Roberto Franchini
> > > > http://www.celi.it
> > > > http://www.blogmeter.it
> > > > http://www.memesphere.it
> > > > Tel +39-011-6600814
> > > > jabber:ro.franchini@gmail.com
> <jabber%3Aro.franchini@gmail.com>skype:ro.franchini
> > > >
> > > > --------------------------------------------------------------------
> -
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39678-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 18:41:23 2009
Return-Path: <java-user-return-39678-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98575 invoked from network); 11 Apr 2009 18:41:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 18:41:23 -0000
Received: (qmail 18595 invoked by uid 500); 11 Apr 2009 18:41:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18514 invoked by uid 500); 11 Apr 2009 18:41:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18503 invoked by uid 99); 11 Apr 2009 18:41:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 18:41:21 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 18:41:12 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1054713qwh.53
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 11:40:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=MxNZfU5dzr9H49KA+iPhbMFeuIoCWnGL1DvqKN+zX7A=;
        b=R5o0XsruezspTkQTNUHi44Hx4n03t94aEZW38P6/XpW1mP8zVkFwuEQggmvWnGt4aO
         SAFR7BC1+gxmA4cnwEh/BIr8EA/16Ijw5VAsg3PPcktriyzZaVLUAjn3cYrXlClkul6V
         zxx8eLtpCvRLSqFtc30LmiBcjKrmL1yaRbD8g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=LVu2AkmV+T7cgEPSLGzcJs/XuLwgmf/d5k4Xl8nPM0L5WuJO05ny9K+np4KYhQ88Rt
         TInchPHVORwkiDNchJCwEZjeATOWECH8T5n5VYlYrpSYFMrD3sfAAvOSbJyU4+8RmBMZ
         6CD+jR3muoD64Jrbda86gg2adZuBjEujgzZLo=
MIME-Version: 1.0
Received: by 10.220.91.205 with SMTP id o13mr5559742vcm.92.1239475251773; Sat, 
	11 Apr 2009 11:40:51 -0700 (PDT)
In-Reply-To: <7BBDF4D75D3C4E9BBE69580F0E00CFBA@VEGA>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <70422ecc0904110227u7870fb51wc20b9fc6501f35a6@mail.gmail.com>
	 <9ac0c6aa0904110248s4fbf83b6nafd28cc9b16b0c46@mail.gmail.com>
	 <63e2e4460904110304n51de11f9m1f0daaa1e84db680@mail.gmail.com>
	 <9ac0c6aa0904110450h4d69905aw1f6d093698bb2528@mail.gmail.com>
	 <63e2e4460904110621s78163340pbf88a99831678ec3@mail.gmail.com>
	 <9ac0c6aa0904110702s5619926bpaab0c950c6d617d5@mail.gmail.com>
	 <A13FDAFA93354EC893F1C09307FE9356@VEGA>
	 <359a92830904110941g1973c016ie09d393478e537f5@mail.gmail.com>
	 <7BBDF4D75D3C4E9BBE69580F0E00CFBA@VEGA>
Date: Sat, 11 Apr 2009 11:40:51 -0700
Message-ID: <359a92830904111140o128b887cp387b4e70e8afc72d@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f9213e1703e604674bd2b6
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f9213e1703e604674bd2b6
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Siiiggghhh. So that means I'll have to really look at TrieRange before I
can appear competent<G>..

Thanks
Erick

On Sat, Apr 11, 2009 at 11:23 AM, Uwe Schindler <uwe@thetaphi.de> wrote:

> This is why I invented TrieRange: Full precision dates but less terms
> during
> filtering/searching. With TrieRange on the longs returned bay
> Date.getTime()
> you even have precision of milliseconds without any speed decrease (only
> bigger index size). Or double values with full precision, everything is
> possible :-)
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
> > -----Original Message-----
> > From: Erick Erickson [mailto:erickerickson@gmail.com]
> > Sent: Saturday, April 11, 2009 6:42 PM
> > To: java-user@lucene.apache.org
> > Subject: Re: RangeFilter performance problem using MultiReader
> >
> > OK, I scanned all the e-mails in this thread so I may be way off base,
> but
> > has anyone yet asked the basic question of whether the granularity of the
> > dates is really necessary <G>?
> >
> > Raf and Roberto:
> >
> > It appears you're indexing your dates down to second resolution, which
> > is why your number of unique terms is so high. Will it serve your
> use-case
> > to only index down to day? or perhaps hour? That will reduce your number
> > of terms substantially. There is also the possibility of breaking up your
> > dates into two or more fields if you really require the granularity. You
> > could
> > probably run a quick test of this approach just to see how it would
> change
> > your search times before investing too muchtime in the process....
> >
> > But I'm entirely ignorant of the multireader nuances, so this may be
> > completely
> > irrelevant....
> >
> > Best
> > Erick
> >
> >
> > On Sat, Apr 11, 2009 at 7:36 AM, Uwe Schindler <uwe@thetaphi.de> wrote:
> >
> > > In addition to merging each month into one index instead of all in one
> > > index, you could also do some additional optimization when using the
> > Range
> > > filter:
> > > Just combine only those indexes needed to fulfil the range spec during
> > > search. So if somebody want to filter Jan 15 to Feb 15, only create a
> > > MultiReader of the indexes for Jan and Feb, this would speed up the
> > whole
> > > search (also for terms), as the filter would simply remove all
> documents
> > > from the wrong months.
> > >
> > > But the best would be to use TrieRange :)
> > >
> > > -----
> > > Uwe Schindler
> > > H.-H.-Meier-Allee 63, D-28213 Bremen
> > > http://www.thetaphi.de
> > > eMail: uwe@thetaphi.de
> > >
> > > > -----Original Message-----
> > > > From: Michael McCandless [mailto:lucene@mikemccandless.com]
> > > > Sent: Saturday, April 11, 2009 4:03 PM
> > > > To: java-user@lucene.apache.org
> > > > Subject: Re: RangeFilter performance problem using MultiReader
> > > >
> > > > Ahhh, OK, perhaps that explains the sizable perf difference you're
> > > > seeing w/ optimized vs not.  I'm curious to see the results of your
> > > > "merge each month into 1 index" test...
> > > >
> > > > Mike
> > > >
> > > > On Sat, Apr 11, 2009 at 9:21 AM, Roberto Franchini
> > > > <ro.franchini@gmail.com> wrote:
> > > > > On Sat, Apr 11, 2009 at 1:50 PM, Michael McCandless
> > > > > <lucene@mikemccandless.com> wrote:
> > > > >> Hmm then I'm a bit baffled again.
> > > > >>
> > > > >> Because, each of your "by month" indexes presumably has a unique
> > > > >> subset of terms for the "date_doc" field?  Meaning, a given "by
> > month"
> > > > >> index will have all date_doc corresponding to that month, and a
> > > > >> different "by month" index would presumably have no overlap in the
> > > > >> terms for the date_doc field.
> > > > >
> > > > > Yes and no :) In this situation:
> > > > >
> > > > >>> 200901-->index1, index2
> > > > >>> 200902-->index3
> > > > >>> 200903-->index4,index5,index6
> > > > >
> > > > > each month does not overlap with each other, but index1 and index2
> > > > > overlap, and so index4 with 5 and 6. So there's overlapping inside
> a
> > > > > single month.
> > > > > So I want to trie, next week, this one:
> > > > >>> 200901-->index12 (merge of 1 and 2)
> > > > >>> 200902-->index3
> > > > >>> 200903-->index456 (merge of 4,5,6)
> > > > >
> > > > > This way we avoid overlapping inside a single month. Maybe this can
> > > > > help: stay tuned :)
> > > > > R.
> > > > >
> > > > >
> > > > > --
> > > > > Roberto Franchini
> > > > > http://www.celi.it
> > > > > http://www.blogmeter.it
> > > > > http://www.memesphere.it
> > > > > Tel +39-011-6600814
> > > > > jabber:ro.franchini@gmail.com <jabber%3Aro.franchini@gmail.com>
> > <jabber%3Aro.franchini@gmail.com <jabber%253Aro.franchini@gmail.com>
> >skype:ro.franchini
> > > > >
> > > > >
> --------------------------------------------------------------------
> > -
> > > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > > >
> > > > >
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001485f9213e1703e604674bd2b6--

From java-user-return-39679-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 21:00:29 2009
Return-Path: <java-user-return-39679-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20348 invoked from network); 11 Apr 2009 21:00:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 21:00:29 -0000
Received: (qmail 79630 invoked by uid 500); 11 Apr 2009 21:00:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79535 invoked by uid 500); 11 Apr 2009 21:00:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79525 invoked by uid 99); 11 Apr 2009 21:00:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 21:00:27 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of aminmc@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 21:00:18 +0000
Received: by fxm2 with SMTP id 2so1800806fxm.5
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 13:59:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=CRVgvIsCnLwlYcxnqZn+7Eze5zt2yKKRfIolY5sfD/Q=;
        b=doSDcxJkR0gst4TN/1PYzA3KAmbQdI/WETPvLdKrYvpZXLCALbLg/zvoA6aAUqINHx
         l7vkhkhqDsJlyPgSGlpcPtR7IP3+oNpjj7h7AKV3ShnGRi1X90cToWJsgBEvLnk6dQfk
         WEPjQfH07mHtXRoxDn8eka/rLMCmSLuMn5eOo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Q+xAQkQxCZ9mtOQuRLebxSFqWJJGKIFdUlPigrx7VDkug2W/N2eVc4yHH/HwmpKXcp
         vStKaCTONE2yHmf1PN3/vPnCOY7a8RfjPm5SQ+j1nr6qlmc+KAMrlpuI9AbK+jk5yItk
         sWxk7ddFzLYMcvm8Tb4SaX+hwdafK73PJTfFw=
MIME-Version: 1.0
Received: by 10.204.53.143 with SMTP id m15mr4492429bkg.112.1239483597526; 
	Sat, 11 Apr 2009 13:59:57 -0700 (PDT)
In-Reply-To: <6f4104d80904100628q79150b4oa3e5436cfb66c581@mail.gmail.com>
References: <6f4104d80904100628q79150b4oa3e5436cfb66c581@mail.gmail.com>
Date: Sat, 11 Apr 2009 21:59:57 +0100
Message-ID: <6f4104d80904111359p5621561bw2939160db9ba862b@mail.gmail.com>
Subject: Re: SpellChecker in use with composite query
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=001636c5ba6789197a04674dc324
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5ba6789197a04674dc324
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi
Another thing that I was wondering is how to apply the construction of the
spell index.  Where is the most appropriate place to create the spell index?


For example:

IndexReader spellReader = IndexReader.open(fsDirectory1);

IndexReader spellReader2 = IndexReader.open(fsDirectory2);

MultiReader multiReader = new MultiReader(new IndexReader[]
{spellReader,spellReader2});

LuceneDictionary luceneDictionary = new LuceneDictionary(multiReader,
"content");

Directory spellDirectory = FSDirectory.getDirectory(<single index for
spellcheck);

SpellChecker spellChecker = new SpellChecker(spellDirectory);

spellChecker.indexDictionary(luceneDictionary);


should this be applied when doing a search or when a document is indexed?
Should I clear the spellIndex when the main index changes?


I also noticed that when running some tests I found that the spell index
contained numbers from the text extracted from a document.  Is there a way
to only include a*lphabetic characters in the indexDictionary process?*



Any help would be appreciated.


Cheers

On Fri, Apr 10, 2009 at 2:28 PM, Amin Mohammed-Coleman <aminmc@gmail.com>wrote:

> Hi
> I have been playing around with the SpellChecker class and so far it looks
> really good.  While developing a testcase to show it working I came across a
> couple of issues which I have resolved but I'm not certain if this is the
> correct approach.  I would therefore be grateful if anyone could tell me
> whether it is correct or I should try something else.
>
> 1) Multple Indexes:
> I have multiple indexes which store different documents based on certain
> subject matter.  So inorder to perform the spellchecking against all indexes
> I did something like this:
>
> IndexReader spellReader = IndexReader.open(fsDirectory1);
>
> IndexReader spellReader2 = IndexReader.open(fsDirectory2);
>
> MultiReader multiReader = new MultiReader(new IndexReader[]
> {spellReader,spellReader2});
>
> LuceneDictionary luceneDictionary = new LuceneDictionary(multiReader,
> "content");
>
>  Directory spellDirectory = FSDirectory.getDirectory(<single index for
> spellcheck);
>
> SpellChecker spellChecker = new SpellChecker(spellDirectory);
>
> spellChecker.indexDictionary(luceneDictionary);
>
>
> Is this an acceptable approach or should there be a spellcheck index for
> each seperate document index?
>
>
>
> 2) Composite query e.g. Luciene OR doqument
>
> Inorder to handle the above i did the following:
>
>
> QueryParser queryParser = new AnalyzingQueryParser("content",analyzer);
>
> String input = "luciene OR doqument";
>
> Query query = queryParser.parse(input);
>
> String input2 = query.toString("content");
>
> String[] splitString = input2.split(" ");
>
>
> For each of the string in the array i performed the suggestSimilar(..).
>
>
> Is this the most appropriate way of doing this?
>
>
>
> Any help would be appreciated.
>
>
> Cheers
>
> Amin
>
>

--001636c5ba6789197a04674dc324--

From java-user-return-39680-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 11 21:22:27 2009
Return-Path: <java-user-return-39680-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23915 invoked from network); 11 Apr 2009 21:22:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Apr 2009 21:22:27 -0000
Received: (qmail 86826 invoked by uid 500); 11 Apr 2009 21:22:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86735 invoked by uid 500); 11 Apr 2009 21:22:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86725 invoked by uid 99); 11 Apr 2009 21:22:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 21:22:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.198.226 as permitted sender)
Received: from [209.85.198.226] (HELO rv-out-0506.google.com) (209.85.198.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 11 Apr 2009 21:22:15 +0000
Received: by rv-out-0506.google.com with SMTP id f6so1263270rvb.5
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 14:21:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=f+I7BKmony73QaFctBIMperrkUAwKTRqRLzgq+sjFRQ=;
        b=uURnS+Qe/7x6uFAsKoj77r9Ot2zt+XkArdL1SK0xXtgQtAu1mM2qlSZSVbgepZ8nkK
         cBfdsUXVxNlfLbErsd31RXCmmygOfpJil1Ci53egwM9RLbVo8GHoXtF22iAfK/a0MN0M
         7u1v1OBC+lkUw9FZS/N6aJplbEAA/5AWgSkbg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=Xd3BgFHlXpIqxbaNHSfAhYdwiwifAHb5OR2aGpi2NJHv4CqQYhDKwaRV1EKhleMH7B
         WUFeC0EjyVIj73m78wTOuLRFBMIF2oEzkUnWQm32tL1IHcmPI7mKXGp51C8bveasiWpA
         NRxvTpi0fHkgaBFFCQsDmSK+Nf4tjnw77nkbc=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.114.161.11 with SMTP id j11mr2467513wae.65.1239484914469; Sat, 
	11 Apr 2009 14:21:54 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>
	 <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>
Date: Sat, 11 Apr 2009 17:21:54 -0400
X-Google-Sender-Auth: 1e60aa2e82b78ee5
Message-ID: <c68e39170904111421t7ba79e75wad586c9c2ea89e4a@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

OK, I think this will improve the situation:
https://issues.apache.org/jira/browse/LUCENE-1596

-Yonik
http://www.lucidimagination.com


On Fri, Apr 10, 2009 at 1:47 PM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> We never fully explained it, but we have some ideas...
>
> It's only if you iterate each term, and do a TermDocs.seek for each,
> that Multi*Reader seems to show the problem. =A0Just iterating the terms
> seems OK (I have a 51 segment index, and I can iterate ~ 10M unique
> terms in ~8 seconds).
>
> But loading FieldCache, or doing eg RangeQuery, also does a
> MultiTermDocs.seek on each term, which in turn calls
> SegmentTermDocs.seek for each of the sub-readers in sequence. =A0I
> *think* maybe for highly unique terms, where typically all segments
> but one actually have the term, the cost of invoking seek on those
> segments without the term is high. =A0Really, somehow, we want to only
> call seek on those segments that have the term, which we know from the
> pqueue...
>
> Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39681-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 12 01:11:52 2009
Return-Path: <java-user-return-39681-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82148 invoked from network); 12 Apr 2009 01:11:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Apr 2009 01:11:52 -0000
Received: (qmail 65006 invoked by uid 500); 12 Apr 2009 01:11:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64919 invoked by uid 500); 12 Apr 2009 01:11:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64909 invoked by uid 99); 12 Apr 2009 01:11:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 01:11:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of williamstw@gmail.com designates 74.125.44.30 as permitted sender)
Received: from [74.125.44.30] (HELO yx-out-2324.google.com) (74.125.44.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 01:11:43 +0000
Received: by yx-out-2324.google.com with SMTP id 8so890404yxb.5
        for <java-user@lucene.apache.org>; Sat, 11 Apr 2009 18:11:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=2v/jdMDLcQe7G4fP1GaImruNW+AIgATuBuMJpjc3VkQ=;
        b=CYCD9q7pgSJ1TTGAfQmv8JmAir1rY/+bWlnN6IdSwN/exF84uLP9rnMQ+iv55M6iLn
         AKlC7DSuv8vD4+T/IgVxUf0e7AUZYlSgsYtavpIUrMlGd5Z4shtCEdd+EDaJzDDvV6m0
         5lGnZLlKkOudlBgkiw6om+XSLxTQRMF46dRlk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=nLUKCTweTW8QTYQQhzvRL+26+CE/jI+yjpYoCOXp76HoJSy1G58ffbkORCw4K0Zt1E
         MrrePjkEVdA1R+i2xtizsNPJZTMUMjPGE7KbGoaUY5wbIQZLtXkB6Z2y4rIIvKbv4WNk
         9cijQOqtmm+7AVIh+UVZxHH2BbEuH1R74M2j0=
MIME-Version: 1.0
Received: by 10.151.108.3 with SMTP id k3mr9825635ybm.103.1239498682226; Sat, 
	11 Apr 2009 18:11:22 -0700 (PDT)
In-Reply-To: <359a92830904110925m24dda294l343ad947acb3ea43@mail.gmail.com>
References: <22995240.post@talk.nabble.com>
	 <359a92830904110925m24dda294l343ad947acb3ea43@mail.gmail.com>
Date: Sat, 11 Apr 2009 21:11:22 -0400
Message-ID: <499888440904111811j34e4bf3clab0de3a176215363@mail.gmail.com>
Subject: Re: Sequential match query
From: Tim Williams <williamstw@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Sat, Apr 11, 2009 at 12:25 PM, Erick Erickson
<erickerickson@gmail.com> wrote:
> That'll teach me to scan a post. The link I sent you
> is still relevant, but wildcards are NOT intended to be used to
> concatenate terms. You want a phrase query or a span query
> for that. i.e. "A C F"~# where # is the "slop", that is, the number
> of other terms allowed to appear between your desired terms.
>
> SpanQueries are constructed programmatically, and PhraseQueries
> are produced by the parser.

As I understand it though, there's no way to use the queryparser to
construct an *ordered* phrase query with slop (which is what I think
he's after), right?  I gather that'd have to be done manually with a
SpanNearQuery.  I'd love to hear that the query parser has syntax for
this though...

--tim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39682-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 12 08:03:17 2009
Return-Path: <java-user-return-39682-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28648 invoked from network); 12 Apr 2009 08:03:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Apr 2009 08:03:17 -0000
Received: (qmail 78120 invoked by uid 500); 12 Apr 2009 08:03:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78029 invoked by uid 500); 12 Apr 2009 08:03:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78019 invoked by uid 99); 12 Apr 2009 08:03:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 08:03:14 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of r.ventaglio@gmail.com designates 209.85.218.166 as permitted sender)
Received: from [209.85.218.166] (HELO mail-bw0-f166.google.com) (209.85.218.166)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 08:03:06 +0000
Received: by bwz10 with SMTP id 10so1918700bwz.5
        for <java-user@lucene.apache.org>; Sun, 12 Apr 2009 01:02:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=iZE20cI+NgTjRbgxotMCp9yv0TaCYD9VLzz4kKlZwf4=;
        b=A5Z735XKPtyS+e2SiIkvZVqSGZzGpNuNsTJfwqW6VDb/8327LBpavWCMun3auhuNjb
         FqLiip+nvYVn8XLXfeWjpnx8KpugyNSzUNU+VFojuDv/n2m3F3zk5bPmNpB5HCo+MKh1
         RN4jEoGqk/ZOaZYY6R/90BfDKaMpq0MdJmauk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=IY1tIV8WAdd7vHFTM1ccngA7jsqhRdyQrObq3TxQJ+sjHzDXD1YiD22CXvNvkjSo6K
         JBGIL6sQPK0rzdkjXugbGlEALHI5xGCRr46YM1UP9IU5jhtpQi8qkmlbrzuXN6LndR5Q
         +nKU5Jk1ekXsgXSu/XEcCxCtGLNhEWjtFj5AQ=
MIME-Version: 1.0
Received: by 10.103.137.12 with SMTP id p12mr2700120mun.94.1239523364574; Sun, 
	12 Apr 2009 01:02:44 -0700 (PDT)
In-Reply-To: <c68e39170904111421t7ba79e75wad586c9c2ea89e4a@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>
	 <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>
	 <c68e39170904111421t7ba79e75wad586c9c2ea89e4a@mail.gmail.com>
Date: Sun, 12 Apr 2009 10:02:44 +0200
Message-ID: <70422ecc0904120102t335a9902kd1e6bc723097d98f@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Raf <r.ventaglio@gmail.com>
To: java-user@lucene.apache.org, yonik@lucidimagination.com
Content-Type: multipart/alternative; boundary=00163642661bd6173c04675705fc
X-Virus-Checked: Checked by ClamAV on apache.org

--00163642661bd6173c04675705fc
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I am sorry,
but after applying this patch, the performance on my tests are worse than
those on lucene-2.9-dev trunk.


TEST1: using *filter.getDocIdSet(reader)*;

*Test *results*   (Num docs = 2,940,738)  using lucene-core-2.9-dev trunk**

1 Original index (12 collections * 6 months = 72 indexes)*

1a Range [20090101000000 - 20090131235959] --> 379,560 docs
     2,274 ms     1,477 ms     1,283 ms

1b Range [20081201000000 - 20090131235959] --> 974,754 docs
     4,489 ms     3,333 ms     3,390 ms

1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     8,482 ms     7,471 ms     7,424 ms


*2Consolidated index (1 index)*

2a Range [20090101000000 - 20090131235959] --> 379,560 docs
     492 ms     116 ms     83 ms

2b Range [20081201000000 - 20090131235959] --> 974,754 docs
     640 ms     159 ms     138 ms

2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     817 ms     322 ms    295 ms


*Test *results*   (Num docs = 2,940,738)  using lucene-core-2.9-dev
trunk**+ patch 1596

1 Original index (12 collections * 6 months = 72 indexes)*

1a Range [20090101000000 - 20090131235959] --> 379,560 docs
     3,699 ms     3,347 ms     1,368 ms

1b Range [20081201000000 - 20090131235959] --> 974,754 docs
     6,508 ms     4,540 ms     6,151 ms

1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     15,941 ms     10,440 ms     13,622 ms


*2Consolidated index (1 index)*

2a Range [20090101000000 - 20090131235959] --> 379,560 docs
     514 ms     70 ms     63 ms

2b Range [20081201000000 - 20090131235959] --> 974,754 docs
     708 ms     165 ms     137 ms

2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     782 ms     430 ms    602 ms



TEST2: using *searcher.search(query, filter, 10);*

*Test *results*   (Num docs = 2,940,738)  using lucene-core-2.9-dev trunk

1 Original index (12 collections * 6 months = 72 indexes)
*
1a Range [20090101000000 - 20090131235959] --> 379,560 docs
     1,187 ms     273 ms     416 ms
1b Range [20081201000000 - 20090131235959] --> 974,754 docs
     1,539 ms     764 ms     571 ms
1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     2,235 ms     1,503 ms     1,260 ms


*2 Consolidated index (1 index)*
2a Range [20090101000000 - 20090131235959] --> 379,560 docs
     385 ms     85 ms     73 ms
2b Range [20081201000000 - 20090131235959] --> 974,754 docs
     490 ms     208 ms     196 ms
2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     707 ms     361 ms    317 ms


*Test *results*   (Num docs = 2,940,738)  using lucene-core-2.9-dev
trunk**+ patch 1596
**
1 Original index (12 collections * 6 months = 72 indexes)
*
1a Range [20090101000000 - 20090131235959] --> 379,560 docs
     1,181 ms     375 ms     237 ms
1b Range [20081201000000 - 20090131235959] --> 974,754 docs
     1,670 ms     749 ms     550 ms
1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     3,379 ms     2,409 ms     2,470 ms


*2 Consolidated index (1 index)*
2a Range [20090101000000 - 20090131235959] --> 379,560 docs
     444 ms     72 ms     72 ms
2b Range [20081201000000 - 20090131235959] --> 974,754 docs
     576 ms     208 ms     140 ms
2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
     907 ms     484 ms    373 ms


Raf

On Sat, Apr 11, 2009 at 11:21 PM, Yonik Seeley
<yonik@lucidimagination.com>wrote:

> OK, I think this will improve the situation:
> https://issues.apache.org/jira/browse/LUCENE-1596
>
> -Yonik
> http://www.lucidimagination.com
>
>
> On Fri, Apr 10, 2009 at 1:47 PM, Michael McCandless
> <lucene@mikemccandless.com> wrote:
> > We never fully explained it, but we have some ideas...
> >
> > It's only if you iterate each term, and do a TermDocs.seek for each,
> > that Multi*Reader seems to show the problem.  Just iterating the terms
> > seems OK (I have a 51 segment index, and I can iterate ~ 10M unique
> > terms in ~8 seconds).
> >
> > But loading FieldCache, or doing eg RangeQuery, also does a
> > MultiTermDocs.seek on each term, which in turn calls
> > SegmentTermDocs.seek for each of the sub-readers in sequence.  I
> > *think* maybe for highly unique terms, where typically all segments
> > but one actually have the term, the cost of invoking seek on those
> > segments without the term is high.  Really, somehow, we want to only
> > call seek on those segments that have the term, which we know from the
> > pqueue...
> >
> > Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00163642661bd6173c04675705fc--

From java-user-return-39683-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 12 09:57:21 2009
Return-Path: <java-user-return-39683-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70974 invoked from network); 12 Apr 2009 09:57:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Apr 2009 09:57:21 -0000
Received: (qmail 16200 invoked by uid 500); 12 Apr 2009 09:57:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16128 invoked by uid 500); 12 Apr 2009 09:57:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16118 invoked by uid 99); 12 Apr 2009 09:57:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 09:57:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [69.55.225.129] (HELO ehatchersolutions.com) (69.55.225.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 09:57:09 +0000
Received: by ehatchersolutions.com (Postfix, from userid 504)
	id C5C3C30EFC14; Sun, 12 Apr 2009 03:56:47 -0600 (MDT)
X-Spam-Checker-Version: SpamAssassin 3.1.1 (2006-03-10) on javelina
X-Spam-Level: 
Received: from [10.0.1.193] (unknown [138.210.8.79])
	by ehatchersolutions.com (Postfix) with ESMTP id 85AE730EFC12
	for <java-user@lucene.apache.org>; Sun, 12 Apr 2009 03:56:44 -0600 (MDT)
Message-Id: <07E17CDF-6BA8-4919-BD23-AA81351ABC01@ehatchersolutions.com>
From: Erik Hatcher <erik@ehatchersolutions.com>
To: java-user@lucene.apache.org
In-Reply-To: <499888440904111811j34e4bf3clab0de3a176215363@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Sequential match query
Date: Sun, 12 Apr 2009 05:56:43 -0400
References: <22995240.post@talk.nabble.com> <359a92830904110925m24dda294l343ad947acb3ea43@mail.gmail.com> <499888440904111811j34e4bf3clab0de3a176215363@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham 
	version=3.1.1


On Apr 11, 2009, at 9:11 PM, Tim Williams wrote:

> On Sat, Apr 11, 2009 at 12:25 PM, Erick Erickson
> <erickerickson@gmail.com> wrote:
>> That'll teach me to scan a post. The link I sent you
>> is still relevant, but wildcards are NOT intended to be used to
>> concatenate terms. You want a phrase query or a span query
>> for that. i.e. "A C F"~# where # is the "slop", that is, the number
>> of other terms allowed to appear between your desired terms.
>>
>> SpanQueries are constructed programmatically, and PhraseQueries
>> are produced by the parser.
>
> As I understand it though, there's no way to use the queryparser to
> construct an *ordered* phrase query with slop (which is what I think
> he's after), right?  I gather that'd have to be done manually with a
> SpanNearQuery.  I'd love to hear that the query parser has syntax for
> this though...

QueryParser does not create any SpanQuery's, but one can subclass  
QueryParser and override getFieldQuery() to put in a SpanQuery instead  
of a PhraseQuery.

	Erik


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39684-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 12 12:15:50 2009
Return-Path: <java-user-return-39684-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17014 invoked from network); 12 Apr 2009 12:15:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Apr 2009 12:15:50 -0000
Received: (qmail 72651 invoked by uid 500); 12 Apr 2009 12:15:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72574 invoked by uid 500); 12 Apr 2009 12:15:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72564 invoked by uid 99); 12 Apr 2009 12:15:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 12:15:48 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of williamstw@gmail.com designates 209.85.217.164 as permitted sender)
Received: from [209.85.217.164] (HELO mail-gx0-f164.google.com) (209.85.217.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 12:15:41 +0000
Received: by gxk8 with SMTP id 8so3618370gxk.5
        for <java-user@lucene.apache.org>; Sun, 12 Apr 2009 05:15:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=DANKxqW87Wuktp8OPqbn1c/3eTUKPfoMC1nYy6b/Fgo=;
        b=DVMJMYAbT0VQy6k7sLMmrfDGa1HrennW2Vj05f6OinCL7//XBq42+8tz+ClODHgP1e
         g2aX910f2vv9gE/ciB/28BJySozZ+ugYoGX/0jnLwIJd6HXm6o1dq3kjxDV0ynCGT4nX
         SRnWwqYWxWsmcm1lGNtbtSqNYEqc9qqcgOPu4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=lNvvF7T6qamY9MG1t2NK0i290K63lmDO1foSy2zUKeRBTdeWzLfb4BgmnQILtig6Nh
         GKVCQJE4EdeNxH34UmEuLJhMEXeO4O3MppgIk/ylRZbZ5Wsm2iPgTaNZtKLajXHBq2Q1
         1J2SHZ5zOV2OuOCUMgamzq4b5LLBKzLyrCqB0=
MIME-Version: 1.0
Received: by 10.151.108.5 with SMTP id k5mr10729888ybm.137.1239538520739; Sun, 
	12 Apr 2009 05:15:20 -0700 (PDT)
In-Reply-To: <07E17CDF-6BA8-4919-BD23-AA81351ABC01@ehatchersolutions.com>
References: <22995240.post@talk.nabble.com>
	 <359a92830904110925m24dda294l343ad947acb3ea43@mail.gmail.com>
	 <499888440904111811j34e4bf3clab0de3a176215363@mail.gmail.com>
	 <07E17CDF-6BA8-4919-BD23-AA81351ABC01@ehatchersolutions.com>
Date: Sun, 12 Apr 2009 08:15:20 -0400
Message-ID: <499888440904120515t7f7516a1m81615f4b56db3c29@mail.gmail.com>
Subject: Re: Sequential match query
From: Tim Williams <williamstw@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Sun, Apr 12, 2009 at 5:56 AM, Erik Hatcher
<erik@ehatchersolutions.com> wrote:
>
> On Apr 11, 2009, at 9:11 PM, Tim Williams wrote:
>
>> On Sat, Apr 11, 2009 at 12:25 PM, Erick Erickson
>> <erickerickson@gmail.com> wrote:
>>>
>>> That'll teach me to scan a post. The link I sent you
>>> is still relevant, but wildcards are NOT intended to be used to
>>> concatenate terms. You want a phrase query or a span query
>>> for that. i.e. "A C F"~# where # is the "slop", that is, the number
>>> of other terms allowed to appear between your desired terms.
>>>
>>> SpanQueries are constructed programmatically, and PhraseQueries
>>> are produced by the parser.
>>
>> As I understand it though, there's no way to use the queryparser to
>> construct an *ordered* phrase query with slop (which is what I think
>> he's after), right? =A0I gather that'd have to be done manually with a
>> SpanNearQuery. =A0I'd love to hear that the query parser has syntax for
>> this though...
>
> QueryParser does not create any SpanQuery's, but one can subclass
> QueryParser and override getFieldQuery() to put in a SpanQuery instead of=
 a
> PhraseQuery.

Thanks Erik, wouldn't this be an all-or-nothing replacement though?
In other words, by creating ordered SpanNearQuery's as the override,
wouldn't he loose the current unordered PhraseQuery+slop
functionality?  I haven't seen a way to subclass the QueryParser to
support both (e.g. extend the syntax)?

Thanks,
--tim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39685-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 12 13:31:18 2009
Return-Path: <java-user-return-39685-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45325 invoked from network); 12 Apr 2009 13:31:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Apr 2009 13:31:18 -0000
Received: (qmail 1234 invoked by uid 500); 12 Apr 2009 13:31:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1151 invoked by uid 500); 12 Apr 2009 13:31:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1140 invoked by uid 99); 12 Apr 2009 13:31:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 13:31:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [69.55.225.129] (HELO ehatchersolutions.com) (69.55.225.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 13:31:07 +0000
Received: by ehatchersolutions.com (Postfix, from userid 504)
	id A06B130EFC14; Sun, 12 Apr 2009 07:30:46 -0600 (MDT)
X-Spam-Checker-Version: SpamAssassin 3.1.1 (2006-03-10) on javelina
X-Spam-Level: 
Received: from [10.0.1.193] (unknown [138.210.8.79])
	by ehatchersolutions.com (Postfix) with ESMTP id 0C20730EFC12
	for <java-user@lucene.apache.org>; Sun, 12 Apr 2009 07:30:43 -0600 (MDT)
Message-Id: <B11F01AC-AFD7-4D87-9CCF-E59CB9373D70@ehatchersolutions.com>
From: Erik Hatcher <erik@ehatchersolutions.com>
To: java-user@lucene.apache.org
In-Reply-To: <499888440904120515t7f7516a1m81615f4b56db3c29@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Sequential match query
Date: Sun, 12 Apr 2009 09:30:43 -0400
References: <22995240.post@talk.nabble.com> <359a92830904110925m24dda294l343ad947acb3ea43@mail.gmail.com> <499888440904111811j34e4bf3clab0de3a176215363@mail.gmail.com> <07E17CDF-6BA8-4919-BD23-AA81351ABC01@ehatchersolutions.com> <499888440904120515t7f7516a1m81615f4b56db3c29@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham 
	version=3.1.1


On Apr 12, 2009, at 8:15 AM, Tim Williams wrote:

> On Sun, Apr 12, 2009 at 5:56 AM, Erik Hatcher
> <erik@ehatchersolutions.com> wrote:
>>
>> On Apr 11, 2009, at 9:11 PM, Tim Williams wrote:
>>
>>> On Sat, Apr 11, 2009 at 12:25 PM, Erick Erickson
>>> <erickerickson@gmail.com> wrote:
>>>>
>>>> That'll teach me to scan a post. The link I sent you
>>>> is still relevant, but wildcards are NOT intended to be used to
>>>> concatenate terms. You want a phrase query or a span query
>>>> for that. i.e. "A C F"~# where # is the "slop", that is, the number
>>>> of other terms allowed to appear between your desired terms.
>>>>
>>>> SpanQueries are constructed programmatically, and PhraseQueries
>>>> are produced by the parser.
>>>
>>> As I understand it though, there's no way to use the queryparser to
>>> construct an *ordered* phrase query with slop (which is what I think
>>> he's after), right?  I gather that'd have to be done manually with a
>>> SpanNearQuery.  I'd love to hear that the query parser has syntax  
>>> for
>>> this though...
>>
>> QueryParser does not create any SpanQuery's, but one can subclass
>> QueryParser and override getFieldQuery() to put in a SpanQuery  
>> instead of a
>> PhraseQuery.
>
> Thanks Erik, wouldn't this be an all-or-nothing replacement though?
> In other words, by creating ordered SpanNearQuery's as the override,
> wouldn't he loose the current unordered PhraseQuery+slop
> functionality?  I haven't seen a way to subclass the QueryParser to
> support both (e.g. extend the syntax)?

As always, it depends.  If the QueryParser subclass has a switch to  
toggle between SpanNearQuery and PhraseQuery it could controlled by  
the code which way to go.  But yeah, it's not currently possible to  
extend the syntax of QueryParser with a subclass.  There is a nice new  
open issue with a new query parser implementation that is vastly more  
flexible - we'll see that come in to Lucene in the near future.

	Erik


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39686-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 12 13:35:42 2009
Return-Path: <java-user-return-39686-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47335 invoked from network); 12 Apr 2009 13:35:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Apr 2009 13:35:41 -0000
Received: (qmail 3242 invoked by uid 500); 12 Apr 2009 13:35:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3170 invoked by uid 500); 12 Apr 2009 13:35:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3160 invoked by uid 99); 12 Apr 2009 13:35:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 13:35:39 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 13:35:31 +0000
Received: by qyk8 with SMTP id 8so2652119qyk.29
        for <java-user@lucene.apache.org>; Sun, 12 Apr 2009 06:35:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=eObKa2LLJSY7nlR9aBlX24z2gBr3hh9a+Fe+4frus+Y=;
        b=KnoItPLyDD6DoiFi61taylREgf5WbKxpCSdbDmmEc1NGjH9wr7VU0jQ2nhrCpdc/qh
         fu9JL2EyqMGyyOgA0wRy4kZcHx/T0FDFaRufKSPkroYkPKAwIRhmKVqP1L59SjMoFMdJ
         8p/v755fnBJ9DqMT2nxoO3MthclkdacJrFG+4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=dWw7RLlmeIUIPmblTMl4MxzaAuUXXlmRItmpUaLukq5CwtSc2434AhbhctvSHk/idz
         K3HTh46WCogIFBeYheHfxqunMW1tRso5Hy6TgrNtQiMusBKOu4PuxlADuxeYhwyx+mGI
         ZLvy0HgMwfCyauYr1yyAEFKkBme2nevAwrcoA=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.229.83.138 with SMTP id f10mr1447237qcl.17.1239543304885; Sun, 
	12 Apr 2009 06:35:04 -0700 (PDT)
In-Reply-To: <70422ecc0904120102t335a9902kd1e6bc723097d98f@mail.gmail.com>
References: <70422ecc0904100738v23806a91gba4fca747ba3748f@mail.gmail.com>
	 <9ac0c6aa0904100748i65219c81k39274e15785ac082@mail.gmail.com>
	 <c68e39170904100803ye326795u773fc9c03e324aa3@mail.gmail.com>
	 <9ac0c6aa0904101047v159294f6wf743feee844ee38c@mail.gmail.com>
	 <c68e39170904111421t7ba79e75wad586c9c2ea89e4a@mail.gmail.com>
	 <70422ecc0904120102t335a9902kd1e6bc723097d98f@mail.gmail.com>
Date: Sun, 12 Apr 2009 09:35:04 -0400
X-Google-Sender-Auth: 710d0bd7a99e73e1
Message-ID: <c68e39170904120635p421968c9ncba58e7fba3dbd7e@mail.gmail.com>
Subject: Re: RangeFilter performance problem using MultiReader
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hmmm, something is wrong.... range queries over many terms should
definitely be faster.
There are some other oddities in your results...
- the "consolidated index" shows to be slower 295ms vs 602ms... but
patch 1596 doesn't touch that code path (a single segment index).
- TEST2 (using searcher.search) should not be affected by this patch
at all, set some of the results are shown to be twice as slow.  Seems
like there may be a lot of measurement noise in these tests.

Although looking at RangeFilter quickly, I do see an issue that would
prevent the optimizations in 1596 from kicking in.  I'll put up a
revised patch shortly.

-Yonik
http://www.lucidimagination.com


On Sun, Apr 12, 2009 at 4:02 AM, Raf <r.ventaglio@gmail.com> wrote:
> I am sorry,
> but after applying this patch, the performance on my tests are worse than
> those on lucene-2.9-dev trunk.
>
>
> TEST1: using *filter.getDocIdSet(reader)*;
>
> *Test *results* =A0 (Num docs =3D 2,940,738) =A0using lucene-core-2.9-dev=
 trunk**
>
> 1 Original index (12 collections * 6 months =3D 72 indexes)*
>
> 1a Range [20090101000000 - 20090131235959] --> 379,560 docs
> =A0 =A0 2,274 ms =A0 =A0 1,477 ms =A0 =A0 1,283 ms
>
> 1b Range [20081201000000 - 20090131235959] --> 974,754 docs
> =A0 =A0 4,489 ms =A0 =A0 3,333 ms =A0 =A0 3,390 ms
>
> 1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
> =A0 =A0 8,482 ms =A0 =A0 7,471 ms =A0 =A0 7,424 ms
>
>
> *2Consolidated index (1 index)*
>
> 2a Range [20090101000000 - 20090131235959] --> 379,560 docs
> =A0 =A0 492 ms =A0 =A0 116 ms =A0 =A0 83 ms
>
> 2b Range [20081201000000 - 20090131235959] --> 974,754 docs
> =A0 =A0 640 ms =A0 =A0 159 ms =A0 =A0 138 ms
>
> 2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
> =A0 =A0 817 ms =A0 =A0 322 ms =A0 =A0295 ms
>
>
> *Test *results* =A0 (Num docs =3D 2,940,738) =A0using lucene-core-2.9-dev
> trunk**+ patch 1596
>
> 1 Original index (12 collections * 6 months =3D 72 indexes)*
>
> 1a Range [20090101000000 - 20090131235959] --> 379,560 docs
> =A0 =A0 3,699 ms =A0 =A0 3,347 ms =A0 =A0 1,368 ms
>
> 1b Range [20081201000000 - 20090131235959] --> 974,754 docs
> =A0 =A0 6,508 ms =A0 =A0 4,540 ms =A0 =A0 6,151 ms
>
> 1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
> =A0 =A0 15,941 ms =A0 =A0 10,440 ms =A0 =A0 13,622 ms
>
>
> *2Consolidated index (1 index)*
>
> 2a Range [20090101000000 - 20090131235959] --> 379,560 docs
> =A0 =A0 514 ms =A0 =A0 70 ms =A0 =A0 63 ms
>
> 2b Range [20081201000000 - 20090131235959] --> 974,754 docs
> =A0 =A0 708 ms =A0 =A0 165 ms =A0 =A0 137 ms
>
> 2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
> =A0 =A0 782 ms =A0 =A0 430 ms =A0 =A0602 ms
>
>
>
> TEST2: using *searcher.search(query, filter, 10);*
>
> *Test *results* =A0 (Num docs =3D 2,940,738) =A0using lucene-core-2.9-dev=
 trunk
>
> 1 Original index (12 collections * 6 months =3D 72 indexes)
> *
> 1a Range [20090101000000 - 20090131235959] --> 379,560 docs
> =A0 =A0 1,187 ms =A0 =A0 273 ms =A0 =A0 416 ms
> 1b Range [20081201000000 - 20090131235959] --> 974,754 docs
> =A0 =A0 1,539 ms =A0 =A0 764 ms =A0 =A0 571 ms
> 1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
> =A0 =A0 2,235 ms =A0 =A0 1,503 ms =A0 =A0 1,260 ms
>
>
> *2 Consolidated index (1 index)*
> 2a Range [20090101000000 - 20090131235959] --> 379,560 docs
> =A0 =A0 385 ms =A0 =A0 85 ms =A0 =A0 73 ms
> 2b Range [20081201000000 - 20090131235959] --> 974,754 docs
> =A0 =A0 490 ms =A0 =A0 208 ms =A0 =A0 196 ms
> 2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
> =A0 =A0 707 ms =A0 =A0 361 ms =A0 =A0317 ms
>
>
> *Test *results* =A0 (Num docs =3D 2,940,738) =A0using lucene-core-2.9-dev
> trunk**+ patch 1596
> **
> 1 Original index (12 collections * 6 months =3D 72 indexes)
> *
> 1a Range [20090101000000 - 20090131235959] --> 379,560 docs
> =A0 =A0 1,181 ms =A0 =A0 375 ms =A0 =A0 237 ms
> 1b Range [20081201000000 - 20090131235959] --> 974,754 docs
> =A0 =A0 1,670 ms =A0 =A0 749 ms =A0 =A0 550 ms
> 1c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
> =A0 =A0 3,379 ms =A0 =A0 2,409 ms =A0 =A0 2,470 ms
>
>
> *2 Consolidated index (1 index)*
> 2a Range [20090101000000 - 20090131235959] --> 379,560 docs
> =A0 =A0 444 ms =A0 =A0 72 ms =A0 =A0 72 ms
> 2b Range [20081201000000 - 20090131235959] --> 974,754 docs
> =A0 =A0 576 ms =A0 =A0 208 ms =A0 =A0 140 ms
> 2c Range [20081001000000 - 20090131235959] --> 2,197,590 docs
> =A0 =A0 907 ms =A0 =A0 484 ms =A0 =A0373 ms
>
>
> Raf
>
> On Sat, Apr 11, 2009 at 11:21 PM, Yonik Seeley
> <yonik@lucidimagination.com>wrote:
>
>> OK, I think this will improve the situation:
>> https://issues.apache.org/jira/browse/LUCENE-1596
>>
>> -Yonik
>> http://www.lucidimagination.com
>>
>>
>> On Fri, Apr 10, 2009 at 1:47 PM, Michael McCandless
>> <lucene@mikemccandless.com> wrote:
>> > We never fully explained it, but we have some ideas...
>> >
>> > It's only if you iterate each term, and do a TermDocs.seek for each,
>> > that Multi*Reader seems to show the problem. =A0Just iterating the ter=
ms
>> > seems OK (I have a 51 segment index, and I can iterate ~ 10M unique
>> > terms in ~8 seconds).
>> >
>> > But loading FieldCache, or doing eg RangeQuery, also does a
>> > MultiTermDocs.seek on each term, which in turn calls
>> > SegmentTermDocs.seek for each of the sub-readers in sequence. =A0I
>> > *think* maybe for highly unique terms, where typically all segments
>> > but one actually have the term, the cost of invoking seek on those
>> > segments without the term is high. =A0Really, somehow, we want to only
>> > call seek on those segments that have the term, which we know from the
>> > pqueue...
>> >
>> > Mike
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39687-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 12 17:51:46 2009
Return-Path: <java-user-return-39687-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28008 invoked from network); 12 Apr 2009 17:51:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Apr 2009 17:51:46 -0000
Received: (qmail 56077 invoked by uid 500); 12 Apr 2009 17:51:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55991 invoked by uid 500); 12 Apr 2009 17:51:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55981 invoked by uid 99); 12 Apr 2009 17:51:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 17:51:43 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of dayzman@gmail.com designates 209.85.220.229 as permitted sender)
Received: from [209.85.220.229] (HELO mail-fx0-f229.google.com) (209.85.220.229)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 17:51:36 +0000
Received: by fxm13 with SMTP id 13so942907fxm.5
        for <java-user@lucene.apache.org>; Sun, 12 Apr 2009 10:51:15 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.223.113.9 with SMTP id y9mr63616fap.2.1239558675141; Sun, 12 
	Apr 2009 10:51:15 -0700 (PDT)
Message-ID: <001636c923d782972004675f3e78@google.com>
Date: Sun, 12 Apr 2009 17:51:15 +0000
Subject: Searching a single file
From: dayzman@gmail.com
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c923d782970c04675f3e75
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c923d782970c04675f3e75
Content-Type: text/plain; charset=ISO-8859-1; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit

Hi,

Can Lucene be used to return all matches of a query (perhaps using regex)  
in a single document? If so, is it just as efficient if it was to match  
multiple documents? How can that be done?

Thanks

Michael

--001636c923d782970c04675f3e75--

From java-user-return-39688-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 12 17:54:28 2009
Return-Path: <java-user-return-39688-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29603 invoked from network); 12 Apr 2009 17:54:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Apr 2009 17:54:28 -0000
Received: (qmail 60964 invoked by uid 500); 12 Apr 2009 17:54:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60895 invoked by uid 500); 12 Apr 2009 17:54:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60885 invoked by uid 99); 12 Apr 2009 17:54:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 17:54:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of shashi.mit@gmail.com designates 209.85.221.110 as permitted sender)
Received: from [209.85.221.110] (HELO mail-qy0-f110.google.com) (209.85.221.110)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 17:54:17 +0000
Received: by qyk8 with SMTP id 8so2730378qyk.29
        for <java-user@lucene.apache.org>; Sun, 12 Apr 2009 10:53:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=ECNFNR9WIzCRJVm5TzjRzstrU+3q1AxOWV1Pnppzac0=;
        b=wcR3z9WaEs+v0/Za/3VmzrLyM9p9yIFnwh3a40Ta7DwF9HNK0D7LJQEqvDp72gxRFg
         ak0NjtY+cE7iQESsNFWf8A5wxNy4flDpU041PGi5CEEx3QE6ph8NUNrgVYrimdQ6wJvp
         ikE9MNEnGh14Yx5UBgD+TOuXniqvB/yxqV6hE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=hvlJyAe3laTSHO7I2Bo0QAGMV3XnEjpgoeox1LidiLYARL0Amed8udeiN84IytQq18
         GkXZ1La7q5W0N/bOXXC3r13rPuU/zY/ez4mVuSH55Z/LYUbHRGLDh7Ul9JMf7TeQQ7kD
         /KZruhtpVvJNRRdQ90vSbSkLP98tLcab9muMM=
MIME-Version: 1.0
Received: by 10.229.82.9 with SMTP id z9mr1426647qck.79.1239558836957; Sun, 12 
	Apr 2009 10:53:56 -0700 (PDT)
In-Reply-To: <001636c923d782972004675f3e78@google.com>
References: <001636c923d782972004675f3e78@google.com>
Date: Sun, 12 Apr 2009 13:53:56 -0400
Message-ID: <4d19a3630904121053p685e1fa7o25f39928b7a81a61@mail.gmail.com>
Subject: Re: Searching a single file
From: Shashi Kant <shashi.mit@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Not sure what the business-case for this is and why you cannot use
RegEx for this. But you could consider chopping up the document into
(sub) documents and adding them to the Lucene index. For example, chop
by paragraph or line-break.

HTH,
Shashi

On Sun, Apr 12, 2009 at 1:51 PM,  <dayzman@gmail.com> wrote:
> Hi,
>
> Can Lucene be used to return all matches of a query (perhaps using regex) in
> a single document? If so, is it just as efficient if it was to match
> multiple documents? How can that be done?
>
> Thanks
>
> Michael
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39689-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 12 18:09:30 2009
Return-Path: <java-user-return-39689-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37790 invoked from network); 12 Apr 2009 18:09:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Apr 2009 18:09:30 -0000
Received: (qmail 71484 invoked by uid 500); 12 Apr 2009 18:09:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71387 invoked by uid 500); 12 Apr 2009 18:09:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71377 invoked by uid 99); 12 Apr 2009 18:09:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 18:09:27 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of dayzman@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 18:09:20 +0000
Received: by ewy27 with SMTP id 27so1942332ewy.5
        for <java-user@lucene.apache.org>; Sun, 12 Apr 2009 11:08:59 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=r+aJdCnGJNt5LJ3nd5p3Hfz15Dc4l4vgkrmc5sJ6c/Y=;
        b=FKCM5r7Dq3k7FeibZVYlU/sFZ+a90k/S9PI6UVW7QBVVkGGbMv8Pu8cYFftOS/QILx
         7SwNT1zopdhHANs84a/ltkqhoq21JfzUuIdeM/E+fXUal839omV38TUfFo0YUzr0SYbP
         LmNR3AxJnhI/T4dNSpHk1wnlunckE9CGjba04=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=l9Nb/uSmBXZzXGfg5bQ7h5doAN0m4a3kI5RKcDhK17hirj4ztX3VJfvXtt3tiosNBm
         GCNT8I3J0Sx2fZ827uufJUZJoOpQt5t90uy4K5bKr52+RaOUBKhzHX6V6uFcgclx3pLR
         1I8VL8mFVYLbjbhtji07mWwQ/6NzPHXXZLoXg=
MIME-Version: 1.0
Received: by 10.210.71.13 with SMTP id t13mr1323202eba.38.1239559739361; Sun, 
	12 Apr 2009 11:08:59 -0700 (PDT)
In-Reply-To: <4d19a3630904121053p685e1fa7o25f39928b7a81a61@mail.gmail.com>
References: <001636c923d782972004675f3e78@google.com>
	 <4d19a3630904121053p685e1fa7o25f39928b7a81a61@mail.gmail.com>
Date: Sun, 12 Apr 2009 20:08:59 +0200
Message-ID: <429c032d0904121108q7cd27859udc1c0b3e9b43a0ea@mail.gmail.com>
Subject: Re: Searching a single file
From: Michael Chan <dayzman@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1fc10f149b404675f7d52
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1fc10f149b404675f7d52
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I have been trying to use grep, but my file is way too big (~300gb). Could
Lucene search through it more efficiently than grep?

Thanks,

Michael

On Sun, Apr 12, 2009 at 7:53 PM, Shashi Kant <shashi.mit@gmail.com> wrote:

> Not sure what the business-case for this is and why you cannot use
> RegEx for this. But you could consider chopping up the document into
> (sub) documents and adding them to the Lucene index. For example, chop
> by paragraph or line-break.
>
> HTH,
> Shashi
>
> On Sun, Apr 12, 2009 at 1:51 PM,  <dayzman@gmail.com> wrote:
> > Hi,
> >
> > Can Lucene be used to return all matches of a query (perhaps using regex)
> in
> > a single document? If so, is it just as efficient if it was to match
> > multiple documents? How can that be done?
> >
> > Thanks
> >
> > Michael
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd1fc10f149b404675f7d52--

From java-user-return-39690-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 12 18:26:16 2009
Return-Path: <java-user-return-39690-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48504 invoked from network); 12 Apr 2009 18:26:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Apr 2009 18:26:16 -0000
Received: (qmail 84305 invoked by uid 500); 12 Apr 2009 18:26:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84197 invoked by uid 500); 12 Apr 2009 18:26:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84187 invoked by uid 99); 12 Apr 2009 18:26:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 18:26:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [171.67.219.88] (HELO smtp-roam.stanford.edu) (171.67.219.88)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 12 Apr 2009 18:26:03 +0000
Received: from smtp-roam.stanford.edu (localhost.localdomain [127.0.0.1])
	by localhost (Postfix) with SMTP id EF71E37D5F
	for <java-user@lucene.apache.org>; Sun, 12 Apr 2009 11:25:40 -0700 (PDT)
Received: from [192.168.1.100] (adsl-76-202-117-24.dsl.pltn13.sbcglobal.net [76.202.117.24])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: bethard)
	by smtp-roam.stanford.edu (Postfix) with ESMTPSA id 73D0837D5D
	for <java-user@lucene.apache.org>; Sun, 12 Apr 2009 11:25:40 -0700 (PDT)
Message-ID: <49E23210.5000209@stanford.edu>
Date: Sun, 12 Apr 2009 11:25:20 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: exponential boosts
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>
In-Reply-To: <49DFE0B8.4080208@stanford.edu>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On 4/10/2009 5:13 PM, Steven Bethard wrote:
> On 4/10/2009 12:56 PM, Steven Bethard wrote:
>> I need to have a scoring model of the form:
>>
>>     s1(d, q)^a1 * s2(d, q)^a2 * ... * sN(d, q)^aN
>>
>> where "d" is a document, "q" is a query, "sK" is a scoring function, and
>> "aK" is the exponential boost factor for that scoring function.
[snip]
> My third thought was to create a wrapper class that takes a Query and an
> exponential boost factor. The wrapper class would delegate to the Query
> for all methods except .weight(). For .weight(), it would return a
> Weight wrapper that delegated to the Weight for all methods except
> .getValue(). For .getValue(), it would return the original value, raised
> to the appropriate exponent. But will that really work, or am I going to
> mess up the normalization or something else?

I've started playing around with this route. I'm not 100% sure I've
implemented all the Query and Weight methods correctly (the
documentation for these is pretty terse), but assuming I have it right,
that should give me the ability to create the "s(d, q)^a" terms, by just
coming up with a Query for each term, and then wrapping it in my wrapper
class to add the exponential boost.

So to finish up the scoring, I want to create a Query that takes all the
sub-queries and just multiplies their scores together. This seems like
something Lucene must already be doing somewhere. I looked at
BooleanQuery hoping maybe that was already doing something like this,
but BooleanWeight.getValue() just seems to return the boost factor, so I
guess not.

So does anyone know of an existing Query class that will simply multiply
its sub-queries together?

More generally, is there any other documentation about Lucene's scoring
mechanisms than the following? There isn't quite enough detail (or I
don't know how to read it) to answer my questions here.

http://lucene.apache.org/java/2_4_1/scoring.html
http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/package-summary.html

Also, I seem to have gotten very little response to my questions here,
perhaps because they are asking about the expert interfaces? Is there a
better place to ask such questions?

Thanks,

Steve

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39691-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 04:21:59 2009
Return-Path: <java-user-return-39691-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91655 invoked from network); 13 Apr 2009 04:21:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 04:21:59 -0000
Received: (qmail 27308 invoked by uid 500); 13 Apr 2009 04:21:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27033 invoked by uid 500); 13 Apr 2009 04:21:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27023 invoked by uid 99); 13 Apr 2009 04:21:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 04:21:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of noble.paul@gmail.com designates 74.125.46.31 as permitted sender)
Received: from [74.125.46.31] (HELO yw-out-2324.google.com) (74.125.46.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 04:21:46 +0000
Received: by yw-out-2324.google.com with SMTP id 9so1051205ywe.5
        for <java-user@lucene.apache.org>; Sun, 12 Apr 2009 21:21:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:from:date:message-id
         :subject:to:content-type:content-transfer-encoding;
        bh=1+Vvo+owz3MZBDP/Z4wETh8LeAKA/Efc2D9N5EMQnl0=;
        b=HlriTfIcoCywZgTCr66RAJumKM8OtTsMUvPHoytNRI5rkCyvTnYAqObqz/0TqLk7Y4
         D2a/z53IOQ47g5U9wXv56G8y14zEvLnoTU4PfmksGqq9y0TZ2lDCr0kcMTSY+MshnhVi
         8yMc1vkSPJzRyTMSL0P8AUOW0w5XmZCriDxFs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        b=mVKttU+lhhQC/qV8hmW1jJldmvITyUbyM2u6RfgmhdHiB1HAuBh/o2NlhV/p3BB7no
         5nbU++WP2Z3WGFaR7gcR7rfwvZuTOHy+iNUht7Fueeb1/B6mrzCtjwxiSlCy0Zto4+/d
         D5QD+okZGhD4tb5bEyHAEkvMx8RY/yV+lfuoE=
MIME-Version: 1.0
Received: by 10.231.35.75 with SMTP id o11mr608160ibd.45.1239596485745; Sun, 
	12 Apr 2009 21:21:25 -0700 (PDT)
From: =?UTF-8?B?Tm9ibGUgUGF1bCDgtKjgtYvgtKzgtL/gtLPgtY3igI0gIOCkqOCli+CkrOCljeCks+CljQ==?= <noble.paul@gmail.com>
Date: Mon, 13 Apr 2009 09:51:10 +0530
Message-ID: <5e76b0ad0904122121le52a338q74d97224fe0356a2@mail.gmail.com>
Subject: Can I run Lucene in google app engine?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Is it possible to run Lucene in google app engine? has anyone tried it?



-- 
--Noble Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39692-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 07:41:05 2009
Return-Path: <java-user-return-39692-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86108 invoked from network); 13 Apr 2009 07:41:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 07:41:04 -0000
Received: (qmail 31323 invoked by uid 500); 13 Apr 2009 07:41:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31233 invoked by uid 500); 13 Apr 2009 07:41:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31223 invoked by uid 99); 13 Apr 2009 07:41:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 07:41:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of chris.lu@gmail.com designates 209.85.200.173 as permitted sender)
Received: from [209.85.200.173] (HELO wf-out-1314.google.com) (209.85.200.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 07:40:53 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1806949wff.20
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 00:40:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=RhP+opCyYmqaRA+9DunACmhhmqBgilapcct7nYUqM28=;
        b=h1Z6n44TQCSMBbNbv8hoV+pD5HEX98+QAKDw74R2uOL2/UOBd1OhgE69Y4sQ2acVEN
         24DWKUxvnJmRcofkiTeDPu76vEJ2mlXDOLXwOssA/BAg1XnMFnNePuxw8erz4isFfQlB
         ZMNGbra1JdSWLDEl+Q/XiLwfYHU+f49W8yyLg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=uIFaQyzi/8Wa7piro3n6JheEYeTLXNCz/0y5C87vhwq1kDJsi1dOm3msoMZrRZUhQI
         LxNJUBONPIst3ivf8g7Wb5OI+L5KThTzLBi1nOjzanK+roW5maII3qFOKX8zjc+PEKxc
         YM2U2ARIDUJ8uroeJE8ZgnykQhMcH9IKfcRhA=
Received: by 10.142.214.5 with SMTP id m5mr2522665wfg.37.1239608431202;
        Mon, 13 Apr 2009 00:40:31 -0700 (PDT)
Received: from ?192.168.1.101? (c-71-198-38-96.hsd1.ca.comcast.net [71.198.38.96])
        by mx.google.com with ESMTPS id 30sm16226735wfg.34.2009.04.13.00.40.29
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 13 Apr 2009 00:40:30 -0700 (PDT)
Message-ID: <49E2EC68.7060104@gmail.com>
Date: Mon, 13 Apr 2009 00:40:24 -0700
From: Chris Lu <chris.lu@gmail.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Can I run Lucene in google app engine?
References: <5e76b0ad0904122121le52a338q74d97224fe0356a2@mail.gmail.com>
In-Reply-To: <5e76b0ad0904122121le52a338q74d97224fe0356a2@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Surely it's possible, but it has too much limitations to prevent a 
scalable Luceen usage. However, it depends on your requirement.

1) You can not write index on disk, but you can read files. So 
theoretically if the index is read-only and small, you can package it 
with the war file.

2) If you need to update the index, you will have to store the index 
with Google's data store, just like store an index into databases. Sure 
it'll work. But performance would suffer because of transferring the 
whole index into memory, then really start searching. On the other hand, 
this could be a good solution for small index with per-user data.

3) For large changing indexes, you need to find other solutions to 
maintain lucene index.

My personal opinion is, finding a $20/month VPS hosting is far easier 
than changing the way to code.

--
Chris Lu
-------------------------
Instant Scalable Full-Text Search On Any Database/Application
site: http://www.dbsight.net
demo: http://search.dbsight.com
Lucene Database Search in 3 minutes: http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
DBSight customer, a shopping comparison site, (anonymous per request) got 2.6 Million Euro funding!


Noble Paul ??????? ?????? wrote:
> Is it possible to run Lucene in google app engine? has anyone tried it?
>
>
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39693-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 07:58:19 2009
Return-Path: <java-user-return-39693-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91309 invoked from network); 13 Apr 2009 07:58:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 07:58:19 -0000
Received: (qmail 40817 invoked by uid 500); 13 Apr 2009 07:58:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40713 invoked by uid 500); 13 Apr 2009 07:58:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40703 invoked by uid 99); 13 Apr 2009 07:58:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 07:58:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of shashi.mit@gmail.com designates 209.85.146.176 as permitted sender)
Received: from [209.85.146.176] (HELO wa-out-1112.google.com) (209.85.146.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 07:58:09 +0000
Received: by wa-out-1112.google.com with SMTP id l35so970719waf.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 00:57:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=g28Z+KDfAebCELPHqOn2A813GLPieU/c2ey6EgdnQeM=;
        b=dA/+HZ/Bk5/agKWRziR37eCQplC+bTF0qTNm9swa7BwMkRNwcl26Nlnt/atzFXehhx
         cap+jWBvOasC2WNTB3wFHMDCmuSMqHGIOjkyVmBkGCeS+uIiZx4GUDc2VeX9VauOkgix
         /7JZDTySd2n9tfjn3lnmDdkrclHtMArcrnT5c=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=aRJpBqzAi1DcOUu1pgNwLuziowr+RQovp45fG42PgDU7iT3ZicZAnnHWB/d5EqYBts
         GFqQOLwgAei4yeigJi49/x+KnehoPY8Y1nyvvUjK53dDQly3smru3geOfw3dtMdgBG0G
         fsS66OMSlNn9bfgSCEwRpjOv9EDXRE7w29q2s=
MIME-Version: 1.0
Received: by 10.114.174.2 with SMTP id w2mr3068517wae.195.1239609469259; Mon, 
	13 Apr 2009 00:57:49 -0700 (PDT)
In-Reply-To: <429c032d0904121108q7cd27859udc1c0b3e9b43a0ea@mail.gmail.com>
References: <001636c923d782972004675f3e78@google.com>
	 <4d19a3630904121053p685e1fa7o25f39928b7a81a61@mail.gmail.com>
	 <429c032d0904121108q7cd27859udc1c0b3e9b43a0ea@mail.gmail.com>
Date: Mon, 13 Apr 2009 03:57:49 -0400
Message-ID: <4d19a3630904130057o2c3d6265q4e7e067a7a9cabb1@mail.gmail.com>
Subject: Re: Searching a single file
From: Shashi Kant <shashi.mit@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

qv, above. Chop up your document into sub-documents (i.e. Lucene
documents) in your favorite way, shape or form and it should work..
hth


On Sun, Apr 12, 2009 at 2:08 PM, Michael Chan <dayzman@gmail.com> wrote:
> I have been trying to use grep, but my file is way too big (~300gb). Coul=
d
> Lucene search through it more efficiently than grep?
>
> Thanks,
>
> Michael
>
> On Sun, Apr 12, 2009 at 7:53 PM, Shashi Kant <shashi.mit@gmail.com> wrote=
:
>
>> Not sure what the business-case for this is and why you cannot use
>> RegEx for this. But you could consider chopping up the document into
>> (sub) documents and adding them to the Lucene index. For example, chop
>> by paragraph or line-break.
>>
>> HTH,
>> Shashi
>>
>> On Sun, Apr 12, 2009 at 1:51 PM, =A0<dayzman@gmail.com> wrote:
>> > Hi,
>> >
>> > Can Lucene be used to return all matches of a query (perhaps using reg=
ex)
>> in
>> > a single document? If so, is it just as efficient if it was to match
>> > multiple documents? How can that be done?
>> >
>> > Thanks
>> >
>> > Michael
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39694-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 08:16:49 2009
Return-Path: <java-user-return-39694-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97977 invoked from network); 13 Apr 2009 08:16:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 08:16:49 -0000
Received: (qmail 49559 invoked by uid 500); 13 Apr 2009 08:16:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49477 invoked by uid 500); 13 Apr 2009 08:16:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49467 invoked by uid 99); 13 Apr 2009 08:16:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 08:16:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of noble.paul@gmail.com designates 209.85.132.243 as permitted sender)
Received: from [209.85.132.243] (HELO an-out-0708.google.com) (209.85.132.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 08:16:39 +0000
Received: by an-out-0708.google.com with SMTP id b2so1086369ana.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 01:16:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=TYfFZPyaUwDm7G0AC1xAy3MEUDSPzuIe9+BdIUX/zQY=;
        b=gRBf5CE8H0b7IIiIYRVmHGE/6P5pSgFipTCAj6xT6Ufxhom75nmxCg+MBV6hsQImU4
         Our0dMUTUJUfWnKiM9xBn6qSEWZ1kSDvuG4lA/LH5kelxtk1BV/1V8Vu0w+SLdHrX+Cz
         Tqw0i6N1e4aArQtPGpax0ph2u/7Rf1NKmwSkc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=vxRcib3C7lOlCf+d/y7rucYNKlZqhpRtmYSrZK9s/q20WA0vqoBx3fXgV/f6PgXcAE
         h4PsrvPQvAzj18eaeWy3qojo4NggmEN+qTK/SBA7HugSRYuTUNsA68syU+6WAw4URpHV
         trLFaHv8HsF+QhOTWbZ0kC5vc/LVU1uHbFLVI=
MIME-Version: 1.0
Received: by 10.231.35.66 with SMTP id o2mr711069ibd.30.1239610578216; Mon, 13 
	Apr 2009 01:16:18 -0700 (PDT)
In-Reply-To: <49E2EC68.7060104@gmail.com>
References: <5e76b0ad0904122121le52a338q74d97224fe0356a2@mail.gmail.com> 
	<49E2EC68.7060104@gmail.com>
From: =?UTF-8?B?Tm9ibGUgUGF1bCDgtKjgtYvgtKzgtL/gtLPgtY3igI0gIOCkqOCli+CkrOCljeCks+CljQ==?= <noble.paul@gmail.com>
Date: Mon, 13 Apr 2009 13:46:03 +0530
Message-ID: <5e76b0ad0904130116j4c3e356oe16ad234d6948a26@mail.gmail.com>
Subject: Re: Can I run Lucene in google app engine?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Mon, Apr 13, 2009 at 1:10 PM, Chris Lu <chris.lu@gmail.com> wrote:
> Surely it's possible, but it has too much limitations to prevent a scalable
> Luceen usage. However, it depends on your requirement.
>
> 1) You can not write index on disk, but you can read files. So theoretically
> if the index is read-only and small, you can package it with the war file.
I can probably write the whole index as  Blob and read it and serve
the index from RAM. This index can be loaded once in the start time
and i can setup a cron task to see if it got updated
>
> 2) If you need to update the index, you will have to store the index with
> Google's data store, just like store an index into databases. Sure it'll
> work. But performance would suffer because of transferring the whole index
> into memory, then really start searching. On the other hand, this could be a
> good solution for small index with per-user data.
as you said this is a solution if the index size is small

>
> 3) For large changing indexes, you need to find other solutions to maintain
> lucene index.
>
> My personal opinion is, finding a $20/month VPS hosting is far easier than
> changing the way to code.

The point is ,does Lucens use threads internally which the sandbox disallows

>
> --
> Chris Lu
> -------------------------
> Instant Scalable Full-Text Search On Any Database/Application
> site: http://www.dbsight.net
> demo: http://search.dbsight.com
> Lucene Database Search in 3 minutes:
> http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
> DBSight customer, a shopping comparison site, (anonymous per request) got
> 2.6 Million Euro funding!
>
>
> Noble Paul ??????? ?????? wrote:
>>
>> Is it possible to run Lucene in google app engine? has anyone tried it?
>>
>>
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 
--Noble Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39695-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 09:21:11 2009
Return-Path: <java-user-return-39695-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16118 invoked from network); 13 Apr 2009 09:21:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 09:21:11 -0000
Received: (qmail 91836 invoked by uid 500); 13 Apr 2009 09:21:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91744 invoked by uid 500); 13 Apr 2009 09:21:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91734 invoked by uid 99); 13 Apr 2009 09:21:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 09:21:08 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erdincyilmazel@gmail.com designates 209.85.128.191 as permitted sender)
Received: from [209.85.128.191] (HELO fk-out-0910.google.com) (209.85.128.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 09:21:00 +0000
Received: by fk-out-0910.google.com with SMTP id 18so893137fkq.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 02:20:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=Np4bOTD/L86pXzR5t+uORXqjvqZu3A1AJQH+ITxZ1U4=;
        b=Ru0zP0m4k/LNMgZyTuFbnonawfWgikmQDQkewe8SZoedAmTcTMtwDx8VGhZV7Z9f3e
         MJL7kPevQtpsYveEcU7FoR3Lqv0Z17sZ6NIMBeV/7kHP10eojO+hbuZ1W3AsNZBbsCxe
         B6OL6oObUi1bbKqVq7OyB636iv6cAa6epHDok=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=FOw2NprFdx9dZTfhw0ARL37Dwa9b0J2HW8AVU7cNyrM4P0kQXXCJE2riORgJKLEt4m
         w0t+GJO//YB87XCCESFq06Gd4O1hRn/rHnLDzUTSdIZ506BbzP+sWnOcO7i284KYxK0V
         A9HUcY5jvCZ3YyPJeYkc/s0sZwAFyc3GgQUF4=
MIME-Version: 1.0
Received: by 10.223.115.146 with SMTP id i18mr1689474faq.6.1239614439584; Mon, 
	13 Apr 2009 02:20:39 -0700 (PDT)
In-Reply-To: <5e76b0ad0904130116j4c3e356oe16ad234d6948a26@mail.gmail.com>
References: <5e76b0ad0904122121le52a338q74d97224fe0356a2@mail.gmail.com>
	 <49E2EC68.7060104@gmail.com>
	 <5e76b0ad0904130116j4c3e356oe16ad234d6948a26@mail.gmail.com>
Date: Mon, 13 Apr 2009 10:20:39 +0100
Message-ID: <7af3bac90904130220m29b0a6c9w466d4ff8bdf4bec4@mail.gmail.com>
Subject: Re: Can I run Lucene in google app engine?
From: Erdinc Yilmazel <erdincyilmazel@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I looked at the lucene source code out of curiosity to see if it
spawns threads in indexing/searching and saw that it does. Are you
sure it is going to work even if the index is read only?

Erdinc

2009/4/13 Noble Paul =E0=B4=A8=E0=B5=8B=E0=B4=AC=E0=B4=BF=E0=B4=B3=E0=B5=8D=
=E2=80=8D  =E0=A4=A8=E0=A5=8B=E0=A4=AC=E0=A5=8D=E0=A4=B3=E0=A5=8D <noble.pa=
ul@gmail.com>:
> On Mon, Apr 13, 2009 at 1:10 PM, Chris Lu <chris.lu@gmail.com> wrote:
>> Surely it's possible, but it has too much limitations to prevent a scala=
ble
>> Luceen usage. However, it depends on your requirement.
>>
>> 1) You can not write index on disk, but you can read files. So theoretic=
ally
>> if the index is read-only and small, you can package it with the war fil=
e.
> I can probably write the whole index as =C2=A0Blob and read it and serve
> the index from RAM. This index can be loaded once in the start time
> and i can setup a cron task to see if it got updated
>>
>> 2) If you need to update the index, you will have to store the index wit=
h
>> Google's data store, just like store an index into databases. Sure it'll
>> work. But performance would suffer because of transferring the whole ind=
ex
>> into memory, then really start searching. On the other hand, this could =
be a
>> good solution for small index with per-user data.
> as you said this is a solution if the index size is small
>
>>
>> 3) For large changing indexes, you need to find other solutions to maint=
ain
>> lucene index.
>>
>> My personal opinion is, finding a $20/month VPS hosting is far easier th=
an
>> changing the way to code.
>
> The point is ,does Lucens use threads internally which the sandbox disall=
ows
>
>>
>> --
>> Chris Lu
>> -------------------------
>> Instant Scalable Full-Text Search On Any Database/Application
>> site: http://www.dbsight.net
>> demo: http://search.dbsight.com
>> Lucene Database Search in 3 minutes:
>> http://wiki.dbsight.com/index.php?title=3DCreate_Lucene_Database_Search_=
in_3_minutes
>> DBSight customer, a shopping comparison site, (anonymous per request) go=
t
>> 2.6 Million Euro funding!
>>
>>
>> Noble Paul ??????? ?????? wrote:
>>>
>>> Is it possible to run Lucene in google app engine? has anyone tried it?
>>>
>>>
>>>
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> --
> --Noble Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39696-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 09:41:39 2009
Return-Path: <java-user-return-39696-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30390 invoked from network); 13 Apr 2009 09:41:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 09:41:39 -0000
Received: (qmail 4562 invoked by uid 500); 13 Apr 2009 09:41:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4491 invoked by uid 500); 13 Apr 2009 09:41:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4481 invoked by uid 99); 13 Apr 2009 09:41:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 09:41:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of seidymam@gmail.com designates 72.14.220.155 as permitted sender)
Received: from [72.14.220.155] (HELO fg-out-1718.google.com) (72.14.220.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 09:41:28 +0000
Received: by fg-out-1718.google.com with SMTP id l27so314396fgb.4
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 02:41:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=FKalr6TuAQY9P/l0LuDn8Q0nxRZBQqgn7GU2/xQi8Ps=;
        b=aQU9rrdLOCr417d0SUeMG9GwuyhzSg6IBeocYd2Xz1CYh2NNwvFa1N1oBf4tGwuMMj
         pqScSrQeYQtDbYG2+1s6EwDhB5LXg4btwvuh/b/PrIa/vl0xYR4ajEWrEwyfNx1XeouR
         hjdZc51c6ClCMeCd1xpffYP8hreP3BVoAM28w=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=xDlpKnTSWX1KOZpYtMWIk9CfeV4nEmA9GnJNnbbMeLoasr/m1HQmt/LQFBHmOAmAbm
         QkOFyXJUghFhnPKRd+hglo9LWY3y2NQSdFhExGcFgUz/7JdoTivcr9bCjoamficMUG0y
         wT1G1lJrgMqo0HSj5LC+QhpEyjbzEtw2lxKiI=
MIME-Version: 1.0
Received: by 10.86.23.20 with SMTP id 20mr1160089fgw.62.1239615668398; Mon, 13 
	Apr 2009 02:41:08 -0700 (PDT)
Date: Mon, 13 Apr 2009 12:41:08 +0300
Message-ID: <179b305e0904130241q387ce86bm8fe7ecd424c32a21@mail.gmail.com>
Subject: Rexex Search
From: Seid Mohammed <seidymam@gmail.com>
To: java-user <java-user@lucene.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I want to include Regular Expresion based searching to my lucene appplication
Anyone who can help?

thanks a lot

Seid M.

-- 
"RABI ZIDNI ILMA"

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39697-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 09:47:17 2009
Return-Path: <java-user-return-39697-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33855 invoked from network); 13 Apr 2009 09:47:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 09:47:17 -0000
Received: (qmail 10899 invoked by uid 500); 13 Apr 2009 09:47:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10818 invoked by uid 500); 13 Apr 2009 09:47:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10808 invoked by uid 99); 13 Apr 2009 09:47:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 09:47:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [69.55.225.129] (HELO ehatchersolutions.com) (69.55.225.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 09:47:06 +0000
Received: by ehatchersolutions.com (Postfix, from userid 504)
	id E267730EFC14; Mon, 13 Apr 2009 03:46:45 -0600 (MDT)
X-Spam-Checker-Version: SpamAssassin 3.1.1 (2006-03-10) on javelina
X-Spam-Level: 
Received: from [10.0.1.193] (unknown [138.210.8.79])
	by ehatchersolutions.com (Postfix) with ESMTP id E8C0030EFC12
	for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 03:46:42 -0600 (MDT)
Message-Id: <B043585E-1F95-4FFD-BF0B-85B0576E7F0F@ehatchersolutions.com>
From: Erik Hatcher <erik@ehatchersolutions.com>
To: java-user@lucene.apache.org
In-Reply-To: <179b305e0904130241q387ce86bm8fe7ecd424c32a21@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Rexex Search
Date: Mon, 13 Apr 2009 05:46:06 -0400
References: <179b305e0904130241q387ce86bm8fe7ecd424c32a21@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham 
	version=3.1.1


On Apr 13, 2009, at 5:41 AM, Seid Mohammed wrote:

> I want to include Regular Expresion based searching to my lucene  
> appplication
> Anyone who can help?

There is a RegexQuery and a SpanRegexQuery available in Lucene's regex  
contrib:

<http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/regex/package-summary.html 
 >

The test cases show some example usages:
<http://svn.apache.org/repos/asf/lucene/java/trunk/contrib/regex/src/test/org/apache/lucene/search/regex/TestRegexQuery.java 
 >

	Erik


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39698-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 09:59:51 2009
Return-Path: <java-user-return-39698-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43715 invoked from network); 13 Apr 2009 09:59:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 09:59:51 -0000
Received: (qmail 23716 invoked by uid 500); 13 Apr 2009 09:59:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23619 invoked by uid 500); 13 Apr 2009 09:59:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23609 invoked by uid 99); 13 Apr 2009 09:59:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 09:59:49 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.171] (HELO wf-out-1314.google.com) (209.85.200.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 09:59:41 +0000
Received: by wf-out-1314.google.com with SMTP id 29so1841331wff.20
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 02:59:19 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.68.2 with SMTP id q2mr2562163wfa.274.1239616758381; Mon, 
	13 Apr 2009 02:59:18 -0700 (PDT)
In-Reply-To: <7af3bac90904130220m29b0a6c9w466d4ff8bdf4bec4@mail.gmail.com>
References: <5e76b0ad0904122121le52a338q74d97224fe0356a2@mail.gmail.com>
	 <49E2EC68.7060104@gmail.com>
	 <5e76b0ad0904130116j4c3e356oe16ad234d6948a26@mail.gmail.com>
	 <7af3bac90904130220m29b0a6c9w466d4ff8bdf4bec4@mail.gmail.com>
Date: Mon, 13 Apr 2009 05:59:18 -0400
Message-ID: <9ac0c6aa0904130259g131c1a71k5dc55fd7179d67c2@mail.gmail.com>
Subject: Re: Can I run Lucene in google app engine?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Lucene's ConcurrentMergeScheduler spawns threads, but you can switch
that to SerialMergeScheduler which does not use threads.

Some optional classes (FilterManager, ParallelMultiSearcher,
TimeLimitedCollector) spawn threads, but presumably you could avoid
them.

Otherwise Lucene doesn't create its own threads.

Mike

On Mon, Apr 13, 2009 at 5:20 AM, Erdinc Yilmazel
<erdincyilmazel@gmail.com> wrote:
> I looked at the lucene source code out of curiosity to see if it
> spawns threads in indexing/searching and saw that it does. Are you
> sure it is going to work even if the index is read only?
>
> Erdinc
>
> 2009/4/13 Noble Paul =E0=B4=A8=E0=B5=8B=E0=B4=AC=E0=B4=BF=E0=B4=B3=E0=B5=
=8D=E2=80=8D =C2=A0=E0=A4=A8=E0=A5=8B=E0=A4=AC=E0=A5=8D=E0=A4=B3=E0=A5=8D <=
noble.paul@gmail.com>:
>> On Mon, Apr 13, 2009 at 1:10 PM, Chris Lu <chris.lu@gmail.com> wrote:
>>> Surely it's possible, but it has too much limitations to prevent a scal=
able
>>> Luceen usage. However, it depends on your requirement.
>>>
>>> 1) You can not write index on disk, but you can read files. So theoreti=
cally
>>> if the index is read-only and small, you can package it with the war fi=
le.
>> I can probably write the whole index as =C2=A0Blob and read it and serve
>> the index from RAM. This index can be loaded once in the start time
>> and i can setup a cron task to see if it got updated
>>>
>>> 2) If you need to update the index, you will have to store the index wi=
th
>>> Google's data store, just like store an index into databases. Sure it'l=
l
>>> work. But performance would suffer because of transferring the whole in=
dex
>>> into memory, then really start searching. On the other hand, this could=
 be a
>>> good solution for small index with per-user data.
>> as you said this is a solution if the index size is small
>>
>>>
>>> 3) For large changing indexes, you need to find other solutions to main=
tain
>>> lucene index.
>>>
>>> My personal opinion is, finding a $20/month VPS hosting is far easier t=
han
>>> changing the way to code.
>>
>> The point is ,does Lucens use threads internally which the sandbox disal=
lows
>>
>>>
>>> --
>>> Chris Lu
>>> -------------------------
>>> Instant Scalable Full-Text Search On Any Database/Application
>>> site: http://www.dbsight.net
>>> demo: http://search.dbsight.com
>>> Lucene Database Search in 3 minutes:
>>> http://wiki.dbsight.com/index.php?title=3DCreate_Lucene_Database_Search=
_in_3_minutes
>>> DBSight customer, a shopping comparison site, (anonymous per request) g=
ot
>>> 2.6 Million Euro funding!
>>>
>>>
>>> Noble Paul ??????? ?????? wrote:
>>>>
>>>> Is it possible to run Lucene in google app engine? has anyone tried it=
?
>>>>
>>>>
>>>>
>>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>>
>> --
>> --Noble Paul
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39699-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 10:02:35 2009
Return-Path: <java-user-return-39699-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47308 invoked from network); 13 Apr 2009 10:02:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 10:02:34 -0000
Received: (qmail 25698 invoked by uid 500); 13 Apr 2009 10:02:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25615 invoked by uid 500); 13 Apr 2009 10:02:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25605 invoked by uid 99); 13 Apr 2009 10:02:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 10:02:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of noble.paul@gmail.com designates 209.85.132.250 as permitted sender)
Received: from [209.85.132.250] (HELO an-out-0708.google.com) (209.85.132.250)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 10:02:23 +0000
Received: by an-out-0708.google.com with SMTP id b2so1094884ana.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 03:02:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=UvZxqqUkArog+kznGxnNBHAeaaXwf3yIpmeNua6Wjek=;
        b=Yxg1qoN/N/65bEYO4oNeBEomyg3mexPrL3rOzO/9d0Ccb3zCu1764I3EFXzQ7rnTIu
         jeKxVoLxylddiVlmvagc0mHgOaXT70bRW7kXvghEgwUr8FpBPz7fnywBfhcFnxAX5e1V
         UkxXN6x+J6W8XyzUPgtfUOeJftvXAfX7qjGgI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=N9o2jyB0d/Bz735oJu+bpolM5nqGq8m3OllHRQlBsgWovzUKEAO6yeslWXsjy3YK69
         M8p7UTY0tqjt+gaPxLIBVfAoj+PzrYrG2rE7+3fy/iifm7FfffyivC84X4Jn2SIRnL8Y
         ccr6qNaTZ45HPh50+V/BQr7LtscWXK42KH7q0=
MIME-Version: 1.0
Received: by 10.231.19.204 with SMTP id c12mr1475333ibb.55.1239616921559; Mon, 
	13 Apr 2009 03:02:01 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904130259g131c1a71k5dc55fd7179d67c2@mail.gmail.com>
References: <5e76b0ad0904122121le52a338q74d97224fe0356a2@mail.gmail.com> 
	<49E2EC68.7060104@gmail.com> <5e76b0ad0904130116j4c3e356oe16ad234d6948a26@mail.gmail.com> 
	<7af3bac90904130220m29b0a6c9w466d4ff8bdf4bec4@mail.gmail.com> 
	<9ac0c6aa0904130259g131c1a71k5dc55fd7179d67c2@mail.gmail.com>
From: =?UTF-8?B?Tm9ibGUgUGF1bCDgtKjgtYvgtKzgtL/gtLPgtY3igI0gIOCkqOCli+CkrOCljeCks+CljQ==?= <noble.paul@gmail.com>
Date: Mon, 13 Apr 2009 15:31:46 +0530
Message-ID: <5e76b0ad0904130301v2365f9ffn7277f45f47ff3ff0@mail.gmail.com>
Subject: Re: Can I run Lucene in google app engine?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

that is great.

Is it possible to serialize and deserialize a RAMDirectory?

--Noble




On Mon, Apr 13, 2009 at 3:29 PM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> Lucene's ConcurrentMergeScheduler spawns threads, but you can switch
> that to SerialMergeScheduler which does not use threads.
>
> Some optional classes (FilterManager, ParallelMultiSearcher,
> TimeLimitedCollector) spawn threads, but presumably you could avoid
> them.
>
> Otherwise Lucene doesn't create its own threads.
>
> Mike
>
> On Mon, Apr 13, 2009 at 5:20 AM, Erdinc Yilmazel
> <erdincyilmazel@gmail.com> wrote:
>> I looked at the lucene source code out of curiosity to see if it
>> spawns threads in indexing/searching and saw that it does. Are you
>> sure it is going to work even if the index is read only?
>>
>> Erdinc
>>
>> 2009/4/13 Noble Paul =E0=B4=A8=E0=B5=8B=E0=B4=AC=E0=B4=BF=E0=B4=B3=E0=B5=
=8D=E2=80=8D =C2=A0=E0=A4=A8=E0=A5=8B=E0=A4=AC=E0=A5=8D=E0=A4=B3=E0=A5=8D <=
noble.paul@gmail.com>:
>>> On Mon, Apr 13, 2009 at 1:10 PM, Chris Lu <chris.lu@gmail.com> wrote:
>>>> Surely it's possible, but it has too much limitations to prevent a sca=
lable
>>>> Luceen usage. However, it depends on your requirement.
>>>>
>>>> 1) You can not write index on disk, but you can read files. So theoret=
ically
>>>> if the index is read-only and small, you can package it with the war f=
ile.
>>> I can probably write the whole index as =C2=A0Blob and read it and serv=
e
>>> the index from RAM. This index can be loaded once in the start time
>>> and i can setup a cron task to see if it got updated
>>>>
>>>> 2) If you need to update the index, you will have to store the index w=
ith
>>>> Google's data store, just like store an index into databases. Sure it'=
ll
>>>> work. But performance would suffer because of transferring the whole i=
ndex
>>>> into memory, then really start searching. On the other hand, this coul=
d be a
>>>> good solution for small index with per-user data.
>>> as you said this is a solution if the index size is small
>>>
>>>>
>>>> 3) For large changing indexes, you need to find other solutions to mai=
ntain
>>>> lucene index.
>>>>
>>>> My personal opinion is, finding a $20/month VPS hosting is far easier =
than
>>>> changing the way to code.
>>>
>>> The point is ,does Lucens use threads internally which the sandbox disa=
llows
>>>
>>>>
>>>> --
>>>> Chris Lu
>>>> -------------------------
>>>> Instant Scalable Full-Text Search On Any Database/Application
>>>> site: http://www.dbsight.net
>>>> demo: http://search.dbsight.com
>>>> Lucene Database Search in 3 minutes:
>>>> http://wiki.dbsight.com/index.php?title=3DCreate_Lucene_Database_Searc=
h_in_3_minutes
>>>> DBSight customer, a shopping comparison site, (anonymous per request) =
got
>>>> 2.6 Million Euro funding!
>>>>
>>>>
>>>> Noble Paul ??????? ?????? wrote:
>>>>>
>>>>> Is it possible to run Lucene in google app engine? has anyone tried i=
t?
>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>>
>>>
>>> --
>>> --Noble Paul
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
--Noble Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39700-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 10:11:34 2009
Return-Path: <java-user-return-39700-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84287 invoked from network); 13 Apr 2009 10:11:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 10:11:34 -0000
Received: (qmail 31382 invoked by uid 500); 13 Apr 2009 10:11:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31306 invoked by uid 500); 13 Apr 2009 10:11:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31296 invoked by uid 99); 13 Apr 2009 10:11:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 10:11:32 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.198.233] (HELO rv-out-0506.google.com) (209.85.198.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 10:11:23 +0000
Received: by rv-out-0506.google.com with SMTP id b25so1551673rvf.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 03:11:01 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.194.1 with SMTP id r1mr2570802wff.122.1239617460662; Mon, 
	13 Apr 2009 03:11:00 -0700 (PDT)
In-Reply-To: <5e76b0ad0904130301v2365f9ffn7277f45f47ff3ff0@mail.gmail.com>
References: <5e76b0ad0904122121le52a338q74d97224fe0356a2@mail.gmail.com>
	 <49E2EC68.7060104@gmail.com>
	 <5e76b0ad0904130116j4c3e356oe16ad234d6948a26@mail.gmail.com>
	 <7af3bac90904130220m29b0a6c9w466d4ff8bdf4bec4@mail.gmail.com>
	 <9ac0c6aa0904130259g131c1a71k5dc55fd7179d67c2@mail.gmail.com>
	 <5e76b0ad0904130301v2365f9ffn7277f45f47ff3ff0@mail.gmail.com>
Date: Mon, 13 Apr 2009 06:11:00 -0400
Message-ID: <9ac0c6aa0904130311t29f42f28qd225e71055b48352@mail.gmail.com>
Subject: Re: Can I run Lucene in google app engine?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Yes, I believe so (we have a unit test asserting this).

But, there's no guarantee of cross-version compatibility of the serialized =
form.

Mike

2009/4/13 Noble Paul =E0=B4=A8=E0=B5=8B=E0=B4=AC=E0=B4=BF=E0=B4=B3=E0=B5=8D=
=E2=80=8D  =E0=A4=A8=E0=A5=8B=E0=A4=AC=E0=A5=8D=E0=A4=B3=E0=A5=8D <noble.pa=
ul@gmail.com>:
> that is great.
>
> Is it possible to serialize and deserialize a RAMDirectory?
>
> --Noble
>
>
>
>
> On Mon, Apr 13, 2009 at 3:29 PM, Michael McCandless
> <lucene@mikemccandless.com> wrote:
>> Lucene's ConcurrentMergeScheduler spawns threads, but you can switch
>> that to SerialMergeScheduler which does not use threads.
>>
>> Some optional classes (FilterManager, ParallelMultiSearcher,
>> TimeLimitedCollector) spawn threads, but presumably you could avoid
>> them.
>>
>> Otherwise Lucene doesn't create its own threads.
>>
>> Mike
>>
>> On Mon, Apr 13, 2009 at 5:20 AM, Erdinc Yilmazel
>> <erdincyilmazel@gmail.com> wrote:
>>> I looked at the lucene source code out of curiosity to see if it
>>> spawns threads in indexing/searching and saw that it does. Are you
>>> sure it is going to work even if the index is read only?
>>>
>>> Erdinc
>>>
>>> 2009/4/13 Noble Paul =E0=B4=A8=E0=B5=8B=E0=B4=AC=E0=B4=BF=E0=B4=B3=E0=
=B5=8D=E2=80=8D =C2=A0=E0=A4=A8=E0=A5=8B=E0=A4=AC=E0=A5=8D=E0=A4=B3=E0=A5=
=8D <noble.paul@gmail.com>:
>>>> On Mon, Apr 13, 2009 at 1:10 PM, Chris Lu <chris.lu@gmail.com> wrote:
>>>>> Surely it's possible, but it has too much limitations to prevent a sc=
alable
>>>>> Luceen usage. However, it depends on your requirement.
>>>>>
>>>>> 1) You can not write index on disk, but you can read files. So theore=
tically
>>>>> if the index is read-only and small, you can package it with the war =
file.
>>>> I can probably write the whole index as =C2=A0Blob and read it and ser=
ve
>>>> the index from RAM. This index can be loaded once in the start time
>>>> and i can setup a cron task to see if it got updated
>>>>>
>>>>> 2) If you need to update the index, you will have to store the index =
with
>>>>> Google's data store, just like store an index into databases. Sure it=
'll
>>>>> work. But performance would suffer because of transferring the whole =
index
>>>>> into memory, then really start searching. On the other hand, this cou=
ld be a
>>>>> good solution for small index with per-user data.
>>>> as you said this is a solution if the index size is small
>>>>
>>>>>
>>>>> 3) For large changing indexes, you need to find other solutions to ma=
intain
>>>>> lucene index.
>>>>>
>>>>> My personal opinion is, finding a $20/month VPS hosting is far easier=
 than
>>>>> changing the way to code.
>>>>
>>>> The point is ,does Lucens use threads internally which the sandbox dis=
allows
>>>>
>>>>>
>>>>> --
>>>>> Chris Lu
>>>>> -------------------------
>>>>> Instant Scalable Full-Text Search On Any Database/Application
>>>>> site: http://www.dbsight.net
>>>>> demo: http://search.dbsight.com
>>>>> Lucene Database Search in 3 minutes:
>>>>> http://wiki.dbsight.com/index.php?title=3DCreate_Lucene_Database_Sear=
ch_in_3_minutes
>>>>> DBSight customer, a shopping comparison site, (anonymous per request)=
 got
>>>>> 2.6 Million Euro funding!
>>>>>
>>>>>
>>>>> Noble Paul ??????? ?????? wrote:
>>>>>>
>>>>>> Is it possible to run Lucene in google app engine? has anyone tried =
it?
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> --Noble Paul
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> --
> --Noble Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39701-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 10:26:23 2009
Return-Path: <java-user-return-39701-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94654 invoked from network); 13 Apr 2009 10:26:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 10:26:22 -0000
Received: (qmail 44581 invoked by uid 500); 13 Apr 2009 10:26:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44514 invoked by uid 500); 13 Apr 2009 10:26:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44504 invoked by uid 99); 13 Apr 2009 10:26:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 10:26:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erdincyilmazel@gmail.com designates 209.85.128.187 as permitted sender)
Received: from [209.85.128.187] (HELO fk-out-0910.google.com) (209.85.128.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 10:26:12 +0000
Received: by fk-out-0910.google.com with SMTP id 18so901501fkq.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 03:25:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=kl+sgmvz0fmi5mjqBtqOTZxbZZtc0Ah/83T5gYC0K9M=;
        b=WAWHJnI3IQ7hiIVHJkHdVP028eBIRbHDvMrRQx47LBxfh2ix5h7LBj5M+V3fR40x9B
         vMMrgGFIM8DlZHWV8ywy3tFogd8nQQeJJscDSebNblEV7kXG9Vk57X7NBLGtDtUKZ3Ls
         RVGpN3VlUZlz7u6O4qSywQvSzJ/r+F/ptGBlc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=D+9SoD5dkXTlkW6zsW3zC+dmE0BbaGEl950iyNRTfcp6Sq7zePEF3zSyyBZYKXGF/X
         XDpqsOqbSuCeiXANgcpG78myFl6xfmpYrC6KltRPKPHPTRYEuhlWAipPhTxIjjyLB8GC
         YW/xYJi0qLgQEnjiIHPhxzn7SViY00rgj64o8=
MIME-Version: 1.0
Received: by 10.223.117.1 with SMTP id o1mr1665869faq.96.1239618350774; Mon, 
	13 Apr 2009 03:25:50 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904130311t29f42f28qd225e71055b48352@mail.gmail.com>
References: <5e76b0ad0904122121le52a338q74d97224fe0356a2@mail.gmail.com>
	 <49E2EC68.7060104@gmail.com>
	 <5e76b0ad0904130116j4c3e356oe16ad234d6948a26@mail.gmail.com>
	 <7af3bac90904130220m29b0a6c9w466d4ff8bdf4bec4@mail.gmail.com>
	 <9ac0c6aa0904130259g131c1a71k5dc55fd7179d67c2@mail.gmail.com>
	 <5e76b0ad0904130301v2365f9ffn7277f45f47ff3ff0@mail.gmail.com>
	 <9ac0c6aa0904130311t29f42f28qd225e71055b48352@mail.gmail.com>
Date: Mon, 13 Apr 2009 11:25:50 +0100
Message-ID: <7af3bac90904130325k488725a9we32a60fe43c08a22@mail.gmail.com>
Subject: Re: Can I run Lucene in google app engine?
From: Erdinc Yilmazel <erdincyilmazel@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Do you think writing a Directory based on google datastore is going to
be useful? Indexing may be done using the cron jobs. I am not sure how
the RAMDirectory will fit because the requests can be scattered to
very different jvm instances in app engine environment.

Erdinc

On Mon, Apr 13, 2009 at 11:11 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> Yes, I believe so (we have a unit test asserting this).
>
> But, there's no guarantee of cross-version compatibility of the serialize=
d form.
>
> Mike
>
> 2009/4/13 Noble Paul =E0=B4=A8=E0=B5=8B=E0=B4=AC=E0=B4=BF=E0=B4=B3=E0=B5=
=8D=E2=80=8D =C2=A0=E0=A4=A8=E0=A5=8B=E0=A4=AC=E0=A5=8D=E0=A4=B3=E0=A5=8D <=
noble.paul@gmail.com>:
>> that is great.
>>
>> Is it possible to serialize and deserialize a RAMDirectory?
>>
>> --Noble
>>
>>
>>
>>
>> On Mon, Apr 13, 2009 at 3:29 PM, Michael McCandless
>> <lucene@mikemccandless.com> wrote:
>>> Lucene's ConcurrentMergeScheduler spawns threads, but you can switch
>>> that to SerialMergeScheduler which does not use threads.
>>>
>>> Some optional classes (FilterManager, ParallelMultiSearcher,
>>> TimeLimitedCollector) spawn threads, but presumably you could avoid
>>> them.
>>>
>>> Otherwise Lucene doesn't create its own threads.
>>>
>>> Mike
>>>
>>> On Mon, Apr 13, 2009 at 5:20 AM, Erdinc Yilmazel
>>> <erdincyilmazel@gmail.com> wrote:
>>>> I looked at the lucene source code out of curiosity to see if it
>>>> spawns threads in indexing/searching and saw that it does. Are you
>>>> sure it is going to work even if the index is read only?
>>>>
>>>> Erdinc
>>>>
>>>> 2009/4/13 Noble Paul =E0=B4=A8=E0=B5=8B=E0=B4=AC=E0=B4=BF=E0=B4=B3=E0=
=B5=8D=E2=80=8D =C2=A0=E0=A4=A8=E0=A5=8B=E0=A4=AC=E0=A5=8D=E0=A4=B3=E0=A5=
=8D <noble.paul@gmail.com>:
>>>>> On Mon, Apr 13, 2009 at 1:10 PM, Chris Lu <chris.lu@gmail.com> wrote:
>>>>>> Surely it's possible, but it has too much limitations to prevent a s=
calable
>>>>>> Luceen usage. However, it depends on your requirement.
>>>>>>
>>>>>> 1) You can not write index on disk, but you can read files. So theor=
etically
>>>>>> if the index is read-only and small, you can package it with the war=
 file.
>>>>> I can probably write the whole index as =C2=A0Blob and read it and se=
rve
>>>>> the index from RAM. This index can be loaded once in the start time
>>>>> and i can setup a cron task to see if it got updated
>>>>>>
>>>>>> 2) If you need to update the index, you will have to store the index=
 with
>>>>>> Google's data store, just like store an index into databases. Sure i=
t'll
>>>>>> work. But performance would suffer because of transferring the whole=
 index
>>>>>> into memory, then really start searching. On the other hand, this co=
uld be a
>>>>>> good solution for small index with per-user data.
>>>>> as you said this is a solution if the index size is small
>>>>>
>>>>>>
>>>>>> 3) For large changing indexes, you need to find other solutions to m=
aintain
>>>>>> lucene index.
>>>>>>
>>>>>> My personal opinion is, finding a $20/month VPS hosting is far easie=
r than
>>>>>> changing the way to code.
>>>>>
>>>>> The point is ,does Lucens use threads internally which the sandbox di=
sallows
>>>>>
>>>>>>
>>>>>> --
>>>>>> Chris Lu
>>>>>> -------------------------
>>>>>> Instant Scalable Full-Text Search On Any Database/Application
>>>>>> site: http://www.dbsight.net
>>>>>> demo: http://search.dbsight.com
>>>>>> Lucene Database Search in 3 minutes:
>>>>>> http://wiki.dbsight.com/index.php?title=3DCreate_Lucene_Database_Sea=
rch_in_3_minutes
>>>>>> DBSight customer, a shopping comparison site, (anonymous per request=
) got
>>>>>> 2.6 Million Euro funding!
>>>>>>
>>>>>>
>>>>>> Noble Paul ??????? ?????? wrote:
>>>>>>>
>>>>>>> Is it possible to run Lucene in google app engine? has anyone tried=
 it?
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>> --------------------------------------------------------------------=
-
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>>
>>>>> --
>>>>> --Noble Paul
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>>
>> --
>> --Noble Paul
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39702-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 11:40:16 2009
Return-Path: <java-user-return-39702-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23832 invoked from network); 13 Apr 2009 11:40:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 11:40:16 -0000
Received: (qmail 97156 invoked by uid 500); 13 Apr 2009 11:40:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97062 invoked by uid 500); 13 Apr 2009 11:40:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97051 invoked by uid 99); 13 Apr 2009 11:40:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 11:40:13 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of seidymam@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 11:40:05 +0000
Received: by fxm2 with SMTP id 2so2260783fxm.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 04:39:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=/HJZ6Ievx3/add3lDaLgWKaewkTGrSfdOoZ9tytfU48=;
        b=eU8JpT2FhtKKupKO93F1ltVloJjQaIuxCwjVcuJGt4Hqv4ibpKSOaZ50lBlqxmbzPT
         7wMQJ8u872/XxYo6NRw9YQt3Qqnemg/isd7Z7pLyh4SDpxjymgNZppHAybuudLZGVKKb
         xl9Iqa8496mEuVL5Y/pbGbbyVLYtuoCeUjtuE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=F3LtMIDoeg09paDyPafNk7SczOSdOjYAnT9dHY1Lx0J+KYHYjxR16pxW+71yKpLQil
         r5om38LFVQagJxLL4dtss2wl8/YSQGjbAAq1BdWEb58NhIhQW9r3UC2bW+Q6DYBKxau5
         1D5qVChMEGIaDCsO8J8IFlM9oH3X6peqHW57s=
MIME-Version: 1.0
Received: by 10.86.90.2 with SMTP id n2mr3178378fgb.61.1239622784747; Mon, 13 
	Apr 2009 04:39:44 -0700 (PDT)
In-Reply-To: <B043585E-1F95-4FFD-BF0B-85B0576E7F0F@ehatchersolutions.com>
References: <179b305e0904130241q387ce86bm8fe7ecd424c32a21@mail.gmail.com>
	 <B043585E-1F95-4FFD-BF0B-85B0576E7F0F@ehatchersolutions.com>
Date: Mon, 13 Apr 2009 15:39:44 +0400
Message-ID: <179b305e0904130439g1299fd58weaf3517626092f08@mail.gmail.com>
Subject: Re: Rexex Search
From: Seid Mohammed <seidymam@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd25048bd8ae504676e2bbd
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd25048bd8ae504676e2bbd
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks Erik
it helps

Seid M.

On Mon, Apr 13, 2009 at 1:46 PM, Erik Hatcher <erik@ehatchersolutions.com>wrote:

>
> On Apr 13, 2009, at 5:41 AM, Seid Mohammed wrote:
>
>  I want to include Regular Expresion based searching to my lucene
>> appplication
>> Anyone who can help?
>>
>
> There is a RegexQuery and a SpanRegexQuery available in Lucene's regex
> contrib:
>
> <
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/regex/package-summary.html
> >
>
> The test cases show some example usages:
> <
> http://svn.apache.org/repos/asf/lucene/java/trunk/contrib/regex/src/test/org/apache/lucene/search/regex/TestRegexQuery.java
> >
>
>        Erik
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
"RABI ZIDNI ILMA"

--000e0cd25048bd8ae504676e2bbd--

From java-user-return-39703-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 12:58:21 2009
Return-Path: <java-user-return-39703-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56087 invoked from network); 13 Apr 2009 12:58:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 12:58:21 -0000
Received: (qmail 39663 invoked by uid 500); 13 Apr 2009 12:58:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39588 invoked by uid 500); 13 Apr 2009 12:58:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39578 invoked by uid 99); 13 Apr 2009 12:58:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 12:58:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of glen.newton@gmail.com designates 209.85.217.164 as permitted sender)
Received: from [209.85.217.164] (HELO mail-gx0-f164.google.com) (209.85.217.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 12:58:10 +0000
Received: by gxk8 with SMTP id 8so4228309gxk.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 05:57:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=Q29wEixq9Pnqm7RpeMJqfML7YVKc8L1TDDIfMrmhULw=;
        b=czVuAxeiQxL2l4/4CYltlaJh1BNMLZCKZbePHCTW4NhEVn/NP3XHPqcmpFnTCGrpHy
         NFi+YWV96Pi0DBQYXwid1eVbve1DMlCPI3sTFkhA2APivgw9vrChllS6C+hoqzh0KNb+
         9MRVf+l/70ewBZg1UDz2Irrsz0VJA8WN9yOIs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=tbCmT2LnbCEYF5N2FrR/SziRTD/9B7DrKYk6W2rf4vV6SVg70FBFgFQbAnn2bjV7/Q
         ki9EOwDWZqlv9tjjdSHxO6koHtL1W5GiB1RG/VIjBnmmZ80/VYjmeenggiwFMLm644pr
         LOkPvLfYVPkT2+xo1anggTSr7Q0UN2RMdgwnk=
MIME-Version: 1.0
Received: by 10.100.189.8 with SMTP id m8mr7084655anf.90.1239627468456; Mon, 
	13 Apr 2009 05:57:48 -0700 (PDT)
In-Reply-To: <49E2EC68.7060104@gmail.com>
References: <5e76b0ad0904122121le52a338q74d97224fe0356a2@mail.gmail.com>
	 <49E2EC68.7060104@gmail.com>
Date: Mon, 13 Apr 2009 08:57:48 -0400
Message-ID: <5e76f3840904130557w41fc59a9m1dd422dfb11a4cb9@mail.gmail.com>
Subject: Re: Can I run Lucene in google app engine?
From: Glen Newton <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Another solution is to have your application on the AppEngine, but the
index is on another machine. Then the application 'proxies' the
requests to the machine that has the index, which is using Solr
[http://lucene.apache.org/solr/] or some other way to expose to the
index to the web.

Yes, this means you still need hosting for the index + Solr.

-glen
http://zzzoot.blogspot.com/

2009/4/13 Chris Lu <chris.lu@gmail.com>:
> Surely it's possible, but it has too much limitations to prevent a scalable
> Luceen usage. However, it depends on your requirement.
>
> 1) You can not write index on disk, but you can read files. So theoretically
> if the index is read-only and small, you can package it with the war file.
>
> 2) If you need to update the index, you will have to store the index with
> Google's data store, just like store an index into databases. Sure it'll
> work. But performance would suffer because of transferring the whole index
> into memory, then really start searching. On the other hand, this could be a
> good solution for small index with per-user data.
>
> 3) For large changing indexes, you need to find other solutions to maintain
> lucene index.
>
> My personal opinion is, finding a $20/month VPS hosting is far easier than
> changing the way to code.
>
> --
> Chris Lu
> -------------------------
> Instant Scalable Full-Text Search On Any Database/Application
> site: http://www.dbsight.net
> demo: http://search.dbsight.com
> Lucene Database Search in 3 minutes:
> http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
> DBSight customer, a shopping comparison site, (anonymous per request) got
> 2.6 Million Euro funding!
>
>
> Noble Paul ??????? ?????? wrote:
>>
>> Is it possible to run Lucene in google app engine? has anyone tried it?
>>
>>
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39704-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 14:12:39 2009
Return-Path: <java-user-return-39704-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91020 invoked from network); 13 Apr 2009 14:12:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 14:12:39 -0000
Received: (qmail 11627 invoked by uid 500); 13 Apr 2009 14:12:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11539 invoked by uid 500); 13 Apr 2009 14:12:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11529 invoked by uid 99); 13 Apr 2009 14:12:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 14:12:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of noble.paul@gmail.com designates 209.85.198.227 as permitted sender)
Received: from [209.85.198.227] (HELO rv-out-0506.google.com) (209.85.198.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 14:12:27 +0000
Received: by rv-out-0506.google.com with SMTP id f6so1729086rvb.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 07:12:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=bprbZCSdLWyHd4RT2UMDNiXgtZhxbdI4gSNnKm67K44=;
        b=diPA0P3Ic9pt8PlzZ/VJxeC9ind3wmhHxw1r+DfNEbHfxhvIo1OYhQJ8oeJS01O6HF
         E8I1QknmrV18R4ei8q95oxOoSpldTqUNktAcnt+gnOYCiYyYjJTQF8SOHQv1IIP/q2vJ
         mBqkgo55CSKO1qW0woTEezUmF7fAG2l23bpbk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=b/s4DPV/0e8risRSHQSVjtA7Lo638bQc/7+J4UEu2mgxAEkzewqYrWZgZ2tjaTU+9J
         oOnDxaz56qCZ/nzH3egkPM37SDIGYwbb7mTlsX99KO/QdV0YLvBgcuspH6oGUHgHw5ft
         XcS05xHNz0YT3/cYwTucH8QyArFbmQwwPJiM8=
MIME-Version: 1.0
Received: by 10.140.139.3 with SMTP id m3mr2776676rvd.77.1239631925527; Mon, 
	13 Apr 2009 07:12:05 -0700 (PDT)
In-Reply-To: <7af3bac90904130325k488725a9we32a60fe43c08a22@mail.gmail.com>
References: <5e76b0ad0904122121le52a338q74d97224fe0356a2@mail.gmail.com> 
	<49E2EC68.7060104@gmail.com> <5e76b0ad0904130116j4c3e356oe16ad234d6948a26@mail.gmail.com> 
	<7af3bac90904130220m29b0a6c9w466d4ff8bdf4bec4@mail.gmail.com> 
	<9ac0c6aa0904130259g131c1a71k5dc55fd7179d67c2@mail.gmail.com> 
	<5e76b0ad0904130301v2365f9ffn7277f45f47ff3ff0@mail.gmail.com> 
	<9ac0c6aa0904130311t29f42f28qd225e71055b48352@mail.gmail.com> 
	<7af3bac90904130325k488725a9we32a60fe43c08a22@mail.gmail.com>
From: =?UTF-8?B?Tm9ibGUgUGF1bCDgtKjgtYvgtKzgtL/gtLPgtY3igI0gIOCkqOCli+CkrOCljeCks+CljQ==?= <noble.paul@gmail.com>
Date: Mon, 13 Apr 2009 19:41:50 +0530
Message-ID: <5e76b0ad0904130711m25bb26bdgb7ca72fe4b3383ba@mail.gmail.com>
Subject: Re: Can I run Lucene in google app engine?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

yeah we never know which jvm has the latest data

you can have a separate app for writes

say solr_master.appspot.com

instead of POSTing data to the master it may be able to pull data (say
using DataImportHandler) and index it and when it has to commit it can
serialize the data into a Blob and save it. This ensures that all the
writes happen on 1 single host

The slaves can have a cron job which polls for the latest data and
fetch the index and update itself

The catch here is that we must have a small index were everything can
be done in 30 secs (that is the longest a task can run).

--Noble



On Mon, Apr 13, 2009 at 3:55 PM, Erdinc Yilmazel
<erdincyilmazel@gmail.com> wrote:
> Do you think writing a Directory based on google datastore is going to
> be useful? Indexing may be done using the cron jobs. I am not sure how
> the RAMDirectory will fit because the requests can be scattered to
> very different jvm instances in app engine environment.
>
> Erdinc
>
> On Mon, Apr 13, 2009 at 11:11 AM, Michael McCandless
> <lucene@mikemccandless.com> wrote:
>> Yes, I believe so (we have a unit test asserting this).
>>
>> But, there's no guarantee of cross-version compatibility of the serializ=
ed form.
>>
>> Mike
>>
>> 2009/4/13 Noble Paul =E0=B4=A8=E0=B5=8B=E0=B4=AC=E0=B4=BF=E0=B4=B3=E0=B5=
=8D=E2=80=8D =C2=A0=E0=A4=A8=E0=A5=8B=E0=A4=AC=E0=A5=8D=E0=A4=B3=E0=A5=8D <=
noble.paul@gmail.com>:
>>> that is great.
>>>
>>> Is it possible to serialize and deserialize a RAMDirectory?
>>>
>>> --Noble
>>>
>>>
>>>
>>>
>>> On Mon, Apr 13, 2009 at 3:29 PM, Michael McCandless
>>> <lucene@mikemccandless.com> wrote:
>>>> Lucene's ConcurrentMergeScheduler spawns threads, but you can switch
>>>> that to SerialMergeScheduler which does not use threads.
>>>>
>>>> Some optional classes (FilterManager, ParallelMultiSearcher,
>>>> TimeLimitedCollector) spawn threads, but presumably you could avoid
>>>> them.
>>>>
>>>> Otherwise Lucene doesn't create its own threads.
>>>>
>>>> Mike
>>>>
>>>> On Mon, Apr 13, 2009 at 5:20 AM, Erdinc Yilmazel
>>>> <erdincyilmazel@gmail.com> wrote:
>>>>> I looked at the lucene source code out of curiosity to see if it
>>>>> spawns threads in indexing/searching and saw that it does. Are you
>>>>> sure it is going to work even if the index is read only?
>>>>>
>>>>> Erdinc
>>>>>
>>>>> 2009/4/13 Noble Paul =E0=B4=A8=E0=B5=8B=E0=B4=AC=E0=B4=BF=E0=B4=B3=E0=
=B5=8D=E2=80=8D =C2=A0=E0=A4=A8=E0=A5=8B=E0=A4=AC=E0=A5=8D=E0=A4=B3=E0=A5=
=8D <noble.paul@gmail.com>:
>>>>>> On Mon, Apr 13, 2009 at 1:10 PM, Chris Lu <chris.lu@gmail.com> wrote=
:
>>>>>>> Surely it's possible, but it has too much limitations to prevent a =
scalable
>>>>>>> Luceen usage. However, it depends on your requirement.
>>>>>>>
>>>>>>> 1) You can not write index on disk, but you can read files. So theo=
retically
>>>>>>> if the index is read-only and small, you can package it with the wa=
r file.
>>>>>> I can probably write the whole index as =C2=A0Blob and read it and s=
erve
>>>>>> the index from RAM. This index can be loaded once in the start time
>>>>>> and i can setup a cron task to see if it got updated
>>>>>>>
>>>>>>> 2) If you need to update the index, you will have to store the inde=
x with
>>>>>>> Google's data store, just like store an index into databases. Sure =
it'll
>>>>>>> work. But performance would suffer because of transferring the whol=
e index
>>>>>>> into memory, then really start searching. On the other hand, this c=
ould be a
>>>>>>> good solution for small index with per-user data.
>>>>>> as you said this is a solution if the index size is small
>>>>>>
>>>>>>>
>>>>>>> 3) For large changing indexes, you need to find other solutions to =
maintain
>>>>>>> lucene index.
>>>>>>>
>>>>>>> My personal opinion is, finding a $20/month VPS hosting is far easi=
er than
>>>>>>> changing the way to code.
>>>>>>
>>>>>> The point is ,does Lucens use threads internally which the sandbox d=
isallows
>>>>>>
>>>>>>>
>>>>>>> --
>>>>>>> Chris Lu
>>>>>>> -------------------------
>>>>>>> Instant Scalable Full-Text Search On Any Database/Application
>>>>>>> site: http://www.dbsight.net
>>>>>>> demo: http://search.dbsight.com
>>>>>>> Lucene Database Search in 3 minutes:
>>>>>>> http://wiki.dbsight.com/index.php?title=3DCreate_Lucene_Database_Se=
arch_in_3_minutes
>>>>>>> DBSight customer, a shopping comparison site, (anonymous per reques=
t) got
>>>>>>> 2.6 Million Euro funding!
>>>>>>>
>>>>>>>
>>>>>>> Noble Paul ??????? ?????? wrote:
>>>>>>>>
>>>>>>>> Is it possible to run Lucene in google app engine? has anyone trie=
d it?
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> -------------------------------------------------------------------=
--
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> --
>>>>>> --Noble Paul
>>>>>>
>>>>>> --------------------------------------------------------------------=
-
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>>
>>>
>>> --
>>> --Noble Paul
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
--Noble Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39705-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 18:19:12 2009
Return-Path: <java-user-return-39705-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4584 invoked from network); 13 Apr 2009 18:19:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 18:19:12 -0000
Received: (qmail 26001 invoked by uid 500); 13 Apr 2009 18:19:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25932 invoked by uid 500); 13 Apr 2009 18:19:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25922 invoked by uid 99); 13 Apr 2009 18:19:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 18:19:09 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 18:19:00 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LtQjv-0003Wc-OB
	for java-user@lucene.apache.org; Mon, 13 Apr 2009 11:18:39 -0700
Message-ID: <23026389.post@talk.nabble.com>
Date: Mon, 13 Apr 2009 11:18:39 -0700 (PDT)
From: John Seer <pulsphoto@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Sequential match query
In-Reply-To: <B11F01AC-AFD7-4D87-9CCF-E59CB9373D70@ehatchersolutions.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: pulsphoto@yahoo.com
References: <22995240.post@talk.nabble.com> <359a92830904110925m24dda294l343ad947acb3ea43@mail.gmail.com> <499888440904111811j34e4bf3clab0de3a176215363@mail.gmail.com> <07E17CDF-6BA8-4919-BD23-AA81351ABC01@ehatchersolutions.com> <499888440904120515t7f7516a1m81615f4b56db3c29@mail.gmail.com> <B11F01AC-AFD7-4D87-9CCF-E59CB9373D70@ehatchersolutions.com>
X-Virus-Checked: Checked by ClamAV on apache.org


If I understand you guys correct
If I have term which has n tokens I will need to create n SpanTermQuery put
them in array and pass it to SpanNearQuery?



Erik Hatcher wrote:
> 
> 
> On Apr 12, 2009, at 8:15 AM, Tim Williams wrote:
> 
>> On Sun, Apr 12, 2009 at 5:56 AM, Erik Hatcher
>> <erik@ehatchersolutions.com> wrote:
>>>
>>> On Apr 11, 2009, at 9:11 PM, Tim Williams wrote:
>>>
>>>> On Sat, Apr 11, 2009 at 12:25 PM, Erick Erickson
>>>> <erickerickson@gmail.com> wrote:
>>>>>
>>>>> That'll teach me to scan a post. The link I sent you
>>>>> is still relevant, but wildcards are NOT intended to be used to
>>>>> concatenate terms. You want a phrase query or a span query
>>>>> for that. i.e. "A C F"~# where # is the "slop", that is, the number
>>>>> of other terms allowed to appear between your desired terms.
>>>>>
>>>>> SpanQueries are constructed programmatically, and PhraseQueries
>>>>> are produced by the parser.
>>>>
>>>> As I understand it though, there's no way to use the queryparser to
>>>> construct an *ordered* phrase query with slop (which is what I think
>>>> he's after), right?  I gather that'd have to be done manually with a
>>>> SpanNearQuery.  I'd love to hear that the query parser has syntax  
>>>> for
>>>> this though...
>>>
>>> QueryParser does not create any SpanQuery's, but one can subclass
>>> QueryParser and override getFieldQuery() to put in a SpanQuery  
>>> instead of a
>>> PhraseQuery.
>>
>> Thanks Erik, wouldn't this be an all-or-nothing replacement though?
>> In other words, by creating ordered SpanNearQuery's as the override,
>> wouldn't he loose the current unordered PhraseQuery+slop
>> functionality?  I haven't seen a way to subclass the QueryParser to
>> support both (e.g. extend the syntax)?
> 
> As always, it depends.  If the QueryParser subclass has a switch to  
> toggle between SpanNearQuery and PhraseQuery it could controlled by  
> the code which way to go.  But yeah, it's not currently possible to  
> extend the syntax of QueryParser with a subclass.  There is a nice new  
> open issue with a new query parser implementation that is vastly more  
> flexible - we'll see that come in to Lucene in the near future.
> 
> 	Erik
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Sequential-match-query-tp22995240p23026389.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39706-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 18:28:05 2009
Return-Path: <java-user-return-39706-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12211 invoked from network); 13 Apr 2009 18:28:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 18:28:05 -0000
Received: (qmail 36315 invoked by uid 500); 13 Apr 2009 18:28:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36243 invoked by uid 500); 13 Apr 2009 18:28:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36233 invoked by uid 99); 13 Apr 2009 18:28:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 18:28:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jonathan.espo@gmail.com designates 209.85.218.166 as permitted sender)
Received: from [209.85.218.166] (HELO mail-bw0-f166.google.com) (209.85.218.166)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 18:27:55 +0000
Received: by bwz10 with SMTP id 10so2427346bwz.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 11:27:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=00GQ2P07z+rx5AOyi58dWYuAMOFmogstp2bWFOyLJ1U=;
        b=QOXcpiEMS46jN4u4NXtlf+bNtU8PAxb3YmtvpYzXAZzobzBtI+J/4VQDDU+WM5wAmS
         B/WsC5SftyktGjwwsboF6AwA/ojF+6zUhx/Jv8smofFoxzM1zUmt/iRsewK+aEclZK2b
         DU1aHr57l3UPrWwYPRMomGBlYhD4y+Sthcb5A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=ss6jkq6lAY5uAA6hpluaiT4iNtUo0oB8qMarGTYHE9AdRXK1kF1fBI9GjIjy2bK0Ot
         mkJjWZUOUqeMPFlfHOdjw50MlhvUx4jmSF3ExbcS0eMvOhI2WVI1HrKvAMdacG4D3Zdw
         obFWj0dICbovMn7Aa7DBN/02j9f//giM5Wyws=
MIME-Version: 1.0
Received: by 10.223.107.68 with SMTP id a4mr1755325fap.104.1239647253820; Mon, 
	13 Apr 2009 11:27:33 -0700 (PDT)
Date: Mon, 13 Apr 2009 14:27:33 -0400
Message-ID: <d0f5cc130904131127y53d65b75k2d629f8b24ae131d@mail.gmail.com>
Subject: New tool: LSql
From: jonathan esposito <jonathan.espo@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I created a command-line tool in Java that allows the user to execute
sql-like commands against a lucene index.  This is useful for
automating Lucene index migrations without writing any code.
Essentially, you can treat a Lucene index the same as you would a
database.  For example, you can write:

UPDATE field1=newvalue WHERE +field1:oldvalue

Or you can simply view data by using the SELECT command:

SELECT field1,field2 WHERE +field1:value

You are welcome to visit the project here:
http://code.google.com/p/lucene-sql/.  Any contributions or
suggestions would be greatly appreciated.  I will make an effort to
provide more documentation shortly.

Thanks,
Jonathan Esposito

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39707-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 18:36:26 2009
Return-Path: <java-user-return-39707-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15701 invoked from network); 13 Apr 2009 18:36:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 18:36:25 -0000
Received: (qmail 47615 invoked by uid 500); 13 Apr 2009 18:36:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47546 invoked by uid 500); 13 Apr 2009 18:36:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47536 invoked by uid 99); 13 Apr 2009 18:36:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 18:36:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jonathan.espo@gmail.com designates 209.85.218.166 as permitted sender)
Received: from [209.85.218.166] (HELO mail-bw0-f166.google.com) (209.85.218.166)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 18:36:16 +0000
Received: by bwz10 with SMTP id 10so2430677bwz.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 11:35:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=00GQ2P07z+rx5AOyi58dWYuAMOFmogstp2bWFOyLJ1U=;
        b=AUF9fvbLxT3qSwO4kASxxEy0KArbC8M6BAvZVWeseVABYLPpX3Em1q2EFiAfdk/V9V
         JqHsDvh2y+9t8f8qAuNri3NYW5bTTnvayWiqUZPsqytCPaEB1I4D9Rd5zPperRbCuquY
         1Th8NnLxU2dRuVQ3TuCVbJ/29MIInQ08NdYH8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=UYMyc78VRAQARc64FHhAtR4kU20HlJM3XWDhIeayx2aV14iVVlbWTekVbMzfPLuHyd
         XJaHUpzRR6PqciGYWB9WHPtj7DEcKzteumobW5lvfxkKwiSFWEJFygxx05B0RXKhENZ2
         Pbmm29MOO0+HkD8m7mypAQNBbygz8iEJHTrFc=
MIME-Version: 1.0
Received: by 10.223.126.66 with SMTP id b2mr1798048fas.3.1239647754877; Mon, 
	13 Apr 2009 11:35:54 -0700 (PDT)
Date: Mon, 13 Apr 2009 14:35:54 -0400
Message-ID: <d0f5cc130904131135w6e1f0dd2y5264d473cb0f045d@mail.gmail.com>
Subject: New tool: LSql
From: jonathan esposito <jonathan.espo@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I created a command-line tool in Java that allows the user to execute
sql-like commands against a lucene index.  This is useful for
automating Lucene index migrations without writing any code.
Essentially, you can treat a Lucene index the same as you would a
database.  For example, you can write:

UPDATE field1=newvalue WHERE +field1:oldvalue

Or you can simply view data by using the SELECT command:

SELECT field1,field2 WHERE +field1:value

You are welcome to visit the project here:
http://code.google.com/p/lucene-sql/.  Any contributions or
suggestions would be greatly appreciated.  I will make an effort to
provide more documentation shortly.

Thanks,
Jonathan Esposito

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39708-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 18:45:17 2009
Return-Path: <java-user-return-39708-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19375 invoked from network); 13 Apr 2009 18:45:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 18:45:17 -0000
Received: (qmail 65447 invoked by uid 500); 13 Apr 2009 18:45:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65413 invoked by uid 500); 13 Apr 2009 18:45:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65403 invoked by uid 99); 13 Apr 2009 18:45:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 18:45:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of williamstw@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 18:45:03 +0000
Received: by ewy27 with SMTP id 27so2383665ewy.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 11:44:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=SRS4q+0AoeUheaqJJZ7CMimMGEzGWRlHQO4XpxsDURI=;
        b=Y7WBBIYyeS8cl1sb6jsGg15v2DJu1kT+JMM0kRkTq14nzHSikyMTGRODhix2Us+toh
         +gD+Gp7MzwKCTimByMi+Iq+fqNq88ofhz+ipI0WdcF/RkqskNSeq3Yf554MJ6WxVgY3q
         2ISYmBxfR0ux+QDkpsPslhm2MBODoRzBB8WmE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=DfH1b0ovPCk2TYNA8zuCYT4V2FG2TcwbSqagZx8WMQbuNOXZCevxURMa9IUFEPbzaQ
         DHml5H9yMF1vqS7mb6sy8D1iEgyk0RXnQcwSYH7eU/EGiUTb6GaRF49T+24H0AxJ8jAq
         Ref7z4XccM9ztgpdR/AiJb3cbe7ZROvN/gMhw=
MIME-Version: 1.0
Received: by 10.210.144.3 with SMTP id r3mr2193663ebd.67.1239648283272; Mon, 
	13 Apr 2009 11:44:43 -0700 (PDT)
In-Reply-To: <23026389.post@talk.nabble.com>
References: <22995240.post@talk.nabble.com>
	 <359a92830904110925m24dda294l343ad947acb3ea43@mail.gmail.com>
	 <499888440904111811j34e4bf3clab0de3a176215363@mail.gmail.com>
	 <07E17CDF-6BA8-4919-BD23-AA81351ABC01@ehatchersolutions.com>
	 <499888440904120515t7f7516a1m81615f4b56db3c29@mail.gmail.com>
	 <B11F01AC-AFD7-4D87-9CCF-E59CB9373D70@ehatchersolutions.com>
	 <23026389.post@talk.nabble.com>
Date: Mon, 13 Apr 2009 14:44:43 -0400
Message-ID: <499888440904131144t47db5771u5f68534af0d73a91@mail.gmail.com>
Subject: Re: Sequential match query
From: Tim Williams <williamstw@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Mon, Apr 13, 2009 at 2:18 PM, John Seer <pulsphoto@yahoo.com> wrote:
>
> If I understand you guys correct
> If I have term which has n tokens I will need to create n SpanTermQuery put
> them in array and pass it to SpanNearQuery?

Can you post inline instead of top-posting?

What you have is essentially my suggestion, which, with your original
question looks like (with slop 2):

new SpanNearQuery
      (new SpanQuery[] {
        new SpanTermQuery(new Term("name", "A")),
        new SpanTermQuery(new Term("name", "C")),
        new SpanTermQuery(new Term("name", "F")) },
       2,
       true);

If you wanted to still use the QueryParser, Erik was suggesting you
could extend it and override "getFieldQuery" (there's a good example
of this in LIA I think) to, essentially, generate the query above.

--tim

> Erik Hatcher wrote:
>>
>>
>> On Apr 12, 2009, at 8:15 AM, Tim Williams wrote:
>>
>>> On Sun, Apr 12, 2009 at 5:56 AM, Erik Hatcher
>>> <erik@ehatchersolutions.com> wrote:
>>>>
>>>> On Apr 11, 2009, at 9:11 PM, Tim Williams wrote:
>>>>
>>>>> On Sat, Apr 11, 2009 at 12:25 PM, Erick Erickson
>>>>> <erickerickson@gmail.com> wrote:
>>>>>>
>>>>>> That'll teach me to scan a post. The link I sent you
>>>>>> is still relevant, but wildcards are NOT intended to be used to
>>>>>> concatenate terms. You want a phrase query or a span query
>>>>>> for that. i.e. "A C F"~# where # is the "slop", that is, the number
>>>>>> of other terms allowed to appear between your desired terms.
>>>>>>
>>>>>> SpanQueries are constructed programmatically, and PhraseQueries
>>>>>> are produced by the parser.
>>>>>
>>>>> As I understand it though, there's no way to use the queryparser to
>>>>> construct an *ordered* phrase query with slop (which is what I think
>>>>> he's after), right?  I gather that'd have to be done manually with a
>>>>> SpanNearQuery.  I'd love to hear that the query parser has syntax
>>>>> for
>>>>> this though...
>>>>
>>>> QueryParser does not create any SpanQuery's, but one can subclass
>>>> QueryParser and override getFieldQuery() to put in a SpanQuery
>>>> instead of a
>>>> PhraseQuery.
>>>
>>> Thanks Erik, wouldn't this be an all-or-nothing replacement though?
>>> In other words, by creating ordered SpanNearQuery's as the override,
>>> wouldn't he loose the current unordered PhraseQuery+slop
>>> functionality?  I haven't seen a way to subclass the QueryParser to
>>> support both (e.g. extend the syntax)?
>>
>> As always, it depends.  If the QueryParser subclass has a switch to
>> toggle between SpanNearQuery and PhraseQuery it could controlled by
>> the code which way to go.  But yeah, it's not currently possible to
>> extend the syntax of QueryParser with a subclass.  There is a nice new
>> open issue with a new query parser implementation that is vastly more
>> flexible - we'll see that come in to Lucene in the near future.
>>
>>       Erik
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> --
> View this message in context: http://www.nabble.com/Sequential-match-query-tp22995240p23026389.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39709-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 13 22:49:59 2009
Return-Path: <java-user-return-39709-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36288 invoked from network); 13 Apr 2009 22:49:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Apr 2009 22:49:59 -0000
Received: (qmail 45230 invoked by uid 500); 13 Apr 2009 22:49:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45154 invoked by uid 500); 13 Apr 2009 22:49:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45144 invoked by uid 99); 13 Apr 2009 22:49:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 22:49:56 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of glen.newton@gmail.com designates 209.85.132.245 as permitted sender)
Received: from [209.85.132.245] (HELO an-out-0708.google.com) (209.85.132.245)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 13 Apr 2009 22:49:47 +0000
Received: by an-out-0708.google.com with SMTP id b2so1250327ana.5
        for <java-user@lucene.apache.org>; Mon, 13 Apr 2009 15:49:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=vCjvbbHHnzHr4wN3QyYfxHYZo+DLP6GeTt9psPofrf8=;
        b=SoAh+bxumiQha7sG758DKiOXXeaqjX9zjad7ntVe93gwi8PQqEmP4QKfwf912Jou3D
         3h0GKkWfa4C6ImaJk9wVtpbar1ZRJnccXjJUQW0gyZMfT0GX5O/8gFMBQ+uSpXrB3AZY
         Qv4z80O6m73RhGDaQC5EG0i1ykEjJqDr2USEc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=sp+0OzqumgXxnH7L2RABREQhBq5HvBZbzH+xCg8Fjin4GVUD04oYCv4ne2Mo+322pv
         mldZvE8z6SwvKBjvcMG9bbS7ql4estdUFeD1kEuuIno+iXHA7b6BHdUXq4AekQd+d70a
         RlW+73I3x1neVmIyCYx3v09mrbRPm12w0LuyI=
MIME-Version: 1.0
Received: by 10.100.232.15 with SMTP id e15mr1478450anh.18.1239662966085; Mon, 
	13 Apr 2009 15:49:26 -0700 (PDT)
In-Reply-To: <d0f5cc130904131127y53d65b75k2d629f8b24ae131d@mail.gmail.com>
References: <d0f5cc130904131127y53d65b75k2d629f8b24ae131d@mail.gmail.com>
Date: Mon, 13 Apr 2009 18:49:26 -0400
Message-ID: <5e76f3840904131549t694b1aaay51f83ead5bf979a0@mail.gmail.com>
Subject: Re: New tool: LSql
From: Glen Newton <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

As the creator of LuSql
[http://lab.cisti-icist.nrc-cnrc.gc.ca/cistilabswiki/index.php/LuSql]
I would have hoped for a more creative (and more different) name.
:-)

-glen

2009/4/13 jonathan esposito <jonathan.espo@gmail.com>:
> I created a command-line tool in Java that allows the user to execute
> sql-like commands against a lucene index. =C2=A0This is useful for
> automating Lucene index migrations without writing any code.
> Essentially, you can treat a Lucene index the same as you would a
> database. =C2=A0For example, you can write:
>
> UPDATE field1=3Dnewvalue WHERE +field1:oldvalue
>
> Or you can simply view data by using the SELECT command:
>
> SELECT field1,field2 WHERE +field1:value
>
> You are welcome to visit the project here:
> http://code.google.com/p/lucene-sql/. =C2=A0Any contributions or
> suggestions would be greatly appreciated. =C2=A0I will make an effort to
> provide more documentation shortly.
>
> Thanks,
> Jonathan Esposito
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39710-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 07:39:07 2009
Return-Path: <java-user-return-39710-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30073 invoked from network); 14 Apr 2009 07:39:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 07:39:07 -0000
Received: (qmail 17967 invoked by uid 500); 14 Apr 2009 07:39:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17892 invoked by uid 500); 14 Apr 2009 07:39:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17882 invoked by uid 99); 14 Apr 2009 07:39:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 07:39:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of seidymam@gmail.com designates 72.14.220.155 as permitted sender)
Received: from [72.14.220.155] (HELO fg-out-1718.google.com) (72.14.220.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 07:38:57 +0000
Received: by fg-out-1718.google.com with SMTP id 19so720182fgg.4
        for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 00:38:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=EBAaKvMvAJq/b88rSeNDskiaXM4kLZjj8sW4JQ2+XOU=;
        b=vGC+X30tBKLhe3K/pmlqKzyjYrpCAIS4SfCJWgOy452mAkI3mX3fP1LHXrfXJUtaRa
         NxdUK9HeX4DoxxpxT8G6IVw7PLy4740ZBtEj0moobR+g0BtQPcdeakj7vEzH2Vzcm7kM
         rSrBeYm8KyxpsTArWIS6Wis1IUpnSlLujsKAY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=QWQ+boeXv2DMcjHAcZtS1pN6ckHPh5jDDGPDZtj+m+pqJz9F1F74FH0tPuQ8Q4WlOv
         jPMZfgDhgGVmSdrg8WhmzXg44jSsaesgYSIMHFyeS+1s4A0EBGVz9Zi/MFPHlEU65b74
         3cU83JpvCa5VM+EbugwnpaHjwUlzNgNz9RM04=
MIME-Version: 1.0
Received: by 10.86.98.10 with SMTP id v10mr3699295fgb.76.1239694716131; Tue, 
	14 Apr 2009 00:38:36 -0700 (PDT)
Date: Tue, 14 Apr 2009 10:38:35 +0300
Message-ID: <179b305e0904140038v2ac10bb8i738cf63ff91b5f30@mail.gmail.com>
Subject: Lucene Java doc.
From: Seid Mohammed <seidymam@gmail.com>
To: java-user <java-user@lucene.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Sorry for my little java knowledge and disturbing you.
how can I attach the java doc of lucene in my eclipse application.
it gives a message
=========================================
org.apache.lucene.search.TopDocs
Note: This element neither has attached source nor attached Javadoc
and hence no Javadoc could be found.
==========================================
thanks a lot

Seid M

-- 
"RABI ZIDNI ILMA"

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39711-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 08:10:55 2009
Return-Path: <java-user-return-39711-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40199 invoked from network); 14 Apr 2009 08:10:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 08:10:55 -0000
Received: (qmail 42371 invoked by uid 500); 14 Apr 2009 08:10:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42284 invoked by uid 500); 14 Apr 2009 08:10:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42274 invoked by uid 99); 14 Apr 2009 08:10:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 08:10:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 08:10:42 +0000
Received: by ewy27 with SMTP id 27so2632614ewy.5
        for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 01:10:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=Mkfg7J3TdbNQxORDv6hNuO/gnQFhKeluh+sgXxe+1Qg=;
        b=AIbh2AYG5MzxExv5GPqOSgdvPV37YAAzhPxEIUmF92coVQSZPrCenIoXD2SM6oMlXu
         otXPTs1UzH+XfcJrLp0VdZdNat2AwRcccM8mFK1RZ/CaJHGRfkRsSN6hxvMSTxdPI1TU
         wBU+04v94uTIUBM2UNpX6wN9Wj/RUgn695pgU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=qH8wIFlQoE4kGLSOVGJ2Dq0kbt36liy1TQfguJLMFahV8MxOBXn9gg0KXhHKgmN4Zc
         fZ8Ng7Fdksy3ebZsWISBHllLch/Ywz/AjCoV9WLdRYE2WtWIZGLT71WtnVpEvUPiE4JD
         tWPQYMw3an4D45ZH/axbTtJ1bni6ocC1P46Rc=
MIME-Version: 1.0
Received: by 10.210.127.13 with SMTP id z13mr2672522ebc.35.1239696622218; Tue, 
	14 Apr 2009 01:10:22 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <179b305e0904140038v2ac10bb8i738cf63ff91b5f30@mail.gmail.com>
References: <179b305e0904140038v2ac10bb8i738cf63ff91b5f30@mail.gmail.com>
Date: Tue, 14 Apr 2009 10:10:22 +0200
Message-ID: <f18c9dde0904140110m7f456e9bre72cf15dad4b2f1f@mail.gmail.com>
Subject: Re: Lucene Java doc.
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Quite off-topic but anyway:

1. Right click on the JAR  (must be in build path)
2. Click on Properties
3. Click on JavaDoc Location
4. Add the location


simon

On Tue, Apr 14, 2009 at 9:38 AM, Seid Mohammed <seidymam@gmail.com> wrote:
> Sorry for my little java knowledge and disturbing you.
> how can I attach the java doc of lucene in my eclipse application.
> it gives a message
> =========================================
> org.apache.lucene.search.TopDocs
> Note: This element neither has attached source nor attached Javadoc
> and hence no Javadoc could be found.
> ==========================================
> thanks a lot
>
> Seid M
>
> --
> "RABI ZIDNI ILMA"
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39712-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 08:42:28 2009
Return-Path: <java-user-return-39712-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52115 invoked from network); 14 Apr 2009 08:42:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 08:42:28 -0000
Received: (qmail 69820 invoked by uid 500); 14 Apr 2009 08:38:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69685 invoked by uid 500); 14 Apr 2009 08:37:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69635 invoked by uid 99); 14 Apr 2009 08:37:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 08:37:11 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of seidymam@gmail.com designates 72.14.220.156 as permitted sender)
Received: from [72.14.220.156] (HELO fg-out-1718.google.com) (72.14.220.156)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 08:37:03 +0000
Received: by fg-out-1718.google.com with SMTP id 19so727188fgg.4
        for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 01:36:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=KgpzW8QfTnGdOkrXUZ+VFcEGukpzmMv5+KUD8LktmSk=;
        b=XJX6oVM9jmJF4GhVhHmuPpyEcPzVVSa901NGAV/wJRermXH4oCisQ/Nrynm5AcvQDs
         gP66FYX4gA4PCmuoadWTTOyGNC4D0ZmCMVsDrDPayHlWllYxuUfFv5xGMTNwt7FGYckq
         /C9RbmqTIF3SJWBXrYWoYcIYk7UFoU2TDQ3eU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=t/+Z9NUOQR3WmIVGG/o+BfmbyZbJqZJ855dmBKt80D6A0X1ZMi8Qc9/XXgx5IkuXaH
         bQmZbd3or765zMc+CYccd5mvNArZIpfRvqm8o7sWfUoQiEo8bb+UYGUh8+i+5w5XA8ab
         F55EqjOZQwRbKliUQAVa40dxcxWRBzETLB5WA=
MIME-Version: 1.0
Received: by 10.86.3.4 with SMTP id 4mr5402685fgc.54.1239698202946; Tue, 14 
	Apr 2009 01:36:42 -0700 (PDT)
In-Reply-To: <f18c9dde0904140110m7f456e9bre72cf15dad4b2f1f@mail.gmail.com>
References: <179b305e0904140038v2ac10bb8i738cf63ff91b5f30@mail.gmail.com>
	 <f18c9dde0904140110m7f456e9bre72cf15dad4b2f1f@mail.gmail.com>
Date: Tue, 14 Apr 2009 11:36:42 +0300
Message-ID: <179b305e0904140136h3c28661ekb4e54ab969d77d1@mail.gmail.com>
Subject: Re: Lucene Java doc.
From: Seid Mohammed <seidymam@gmail.com>
To: java-user@lucene.apache.org, simon.willnauer@gmail.com
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

thanks simon

seid M

On 4/14/09, Simon Willnauer <simon.willnauer@googlemail.com> wrote:
> Quite off-topic but anyway:
>
> 1. Right click on the JAR  (must be in build path)
> 2. Click on Properties
> 3. Click on JavaDoc Location
> 4. Add the location
>
>
> simon
>
> On Tue, Apr 14, 2009 at 9:38 AM, Seid Mohammed <seidymam@gmail.com> wrote:
>> Sorry for my little java knowledge and disturbing you.
>> how can I attach the java doc of lucene in my eclipse application.
>> it gives a message
>> =========================================
>> org.apache.lucene.search.TopDocs
>> Note: This element neither has attached source nor attached Javadoc
>> and hence no Javadoc could be found.
>> ==========================================
>> thanks a lot
>>
>> Seid M
>>
>> --
>> "RABI ZIDNI ILMA"
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
"RABI ZIDNI ILMA"

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39713-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 09:29:08 2009
Return-Path: <java-user-return-39713-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78637 invoked from network); 14 Apr 2009 09:29:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 09:29:08 -0000
Received: (qmail 41065 invoked by uid 500); 14 Apr 2009 09:29:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41010 invoked by uid 500); 14 Apr 2009 09:29:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41000 invoked by uid 99); 14 Apr 2009 09:29:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 09:29:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [87.233.177.133] (HELO core.aduna-software.com) (87.233.177.133)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 09:28:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by core.aduna-software.com (Postfix) with ESMTP id 69E62128001
	for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 11:27:41 +0200 (CEST)
X-Virus-Scanned: amavisd-new at 
X-Spam-Score: -2.573
X-Spam-Level: 
Received: from core.aduna-software.com ([127.0.0.1])
	by localhost (core.aduna-software.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id aWAxUtWSNhQE for <java-user@lucene.apache.org>;
	Tue, 14 Apr 2009 11:27:36 +0200 (CEST)
Received: from [10.1.0.11] (5350580E.static.ziggozakelijk.nl [83.80.88.14])
	by core.aduna-software.com (Postfix) with ESMTP id B9401AA037A
	for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 11:27:36 +0200 (CEST)
Message-ID: <49E4573E.7070208@aduna-software.com>
Date: Tue, 14 Apr 2009 11:28:30 +0200
From: Christiaan Fluit <christiaan.fluit@aduna-software.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: semi-infinite loop during merging
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Flag: NO
X-Old-Spam-Status: No, score=-2.573 tagged_above=-10 required=4 tests=[AWL=0.026,
	BAYES_00=-2.599]

Hello all,

I have a very peculiar problem that is driving me crazy: on some of our 
datasets and at some point in time during indexing, the merge operation 
runs into a (semi-)infinite loop and keeps adding files to the index 
until it runs out of free disk space.

The situation: I have an indexing application that uses Lucene 2.4.1. 
Only one IndexWriter is involved, operating on a FSDirectory and using 
the compound file format. The index is created from scratch. No 
IndexReaders or IndexSearchers are open during indexing (double-checked 
by adding explicit log statements where they are created).

For reasons unrelated to Lucene, the application is compiled with JET, a 
commercial Java Windows compiler. A regular Java build has produced the 
problem only once. The JET build does it every time - unless I keep 
pressing F5 continuously in Windows Explorer on the index dir.

Here is what I see happening in the index dir:

- At first, it builds _0.cfs to _9.cfs without problems. The files vary 
in size between 12 MB and 49 MB and add up to about 250 MB.

- Then, .del files are generated for some of these .cfs files. The 
number of .del files and the .cfs files they correspond with differs 
from time to time. I don't understand why these are created, as no 
IndexReaders exist at this time.

- Then, it generates files called _a.fdt, _a.fdx, _a.fnm, _a.frq, 
_a.nrm, _a.prx, _a.tii, _a.tis, _a.tvd, _a.tvf, _a.tvx. Together these 
files add up to 219 MB. I assume this is the start of the merge of the 
10 .cfs files and this is all still correct.

- Then, it generates _b files with those same extensions, then _c, _d, 
etc. It only keeps generating new files, I never see files disappear. 
The original .cfs files are still there.

- This continues until my hard drive is out of free space. At one test I 
was at _8n and the index had grown from 250MB to 64 GB. Then the 
application just hangs.

Interestingly, after killing the application in this test, there were 
_8k.cfs and _8m.cfs files of 20 MB and 27 MB respectively. No other .cfs 
files existed.

In some older threads on this list (e.g. 
http://marc.info/?l=lucene-user&m=108300530413241&w=2) I read that 
"Win32 seems to sometimes not permit one to delete a file immediately 
after it has been closed". Could this explain the problem? Perhaps the 
JET-compiled app gets to delete the file quicker than when the code is 
running inside a Java VM and therefore runs into this issue? This would 
also explain why pressing F5 during indexing lets the application 
continue: external activity causing some manual delay.

At the end of this mail I have added the output of the InfoStream 
installed on the IndexWriter, showing everything from the start to the 
first few problematic merges. Lines starting with "===" are println's in 
my own code to make sure that indeed only IndexWriters are generated and 
no IndexSearchers/-Readers. The fun starts almost at the bottom, at the 
first line containing "LMP: findMerges: 10 segments". The next lines 
then get repeated over and over again, with different segment names. I 
cannot explain why it mentions "1 deleted docIDs" a couple of lines 
below the first "findMerges: 10" as no IndexWriter.deleteDocuments takes 
place.

As you can see in this output, I am setting a SerialMergeScheduler to 
rule out concurrency issues and making debugging easier. Both 
SerialMergeScheduler and ConcurrentMergeScheduler give this problem though.

I would be grateful if anyone could pose some light on this or can 
advise me on what I can try next. I even considered hacking the 
FSDirectory code and adding some delay in the deleteFile operation to 
see if the above-mentioned win32 issue is the problem, but unless you 
know what you're doing, such hacks can even cause such problems in the 
first place.


Kind regards,

Chris
--

=== Creating new FSDirectory
=== Opening indexWriter (create=true)
IFD [AWT-EventQueue-0]: setInfoStream 
deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@9fb0688
IW 0 [AWT-EventQueue-0]: setInfoStream: 
dir=org.apache.lucene.store.FSDirectory@D:\index autoCommit=false 
mergePolicy=org.apache.lucene.index.LogByteSizeMergePolicy@a11d0d8 
mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@a3fa9d8 
ramBufferSizeMB=16.0 maxBufferedDocs=-1 maxBuffereDeleteTerms=-1 
maxFieldLength=2147483647 index=
IW 0 [AWT-EventQueue-0]: setMergeScheduler 
org.apache.lucene.index.SerialMergeScheduler@a3d1fe8
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=46.015 vs 
trigger=16 allocMB=46.015 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=46.015 
allocMB=46.015
IW 0 [CrawlThread]:   flush: segment=_0 docStoreSegment=_0 
docStoreOffset=0 flushDocs=true flushDeletes=false flushDocStores=false 
numDocs=2193 numBufDelTerms=0
IW 0 [CrawlThread]:   index before flush
IW 0 [CrawlThread]: DW: flush postings as segment _0 numDocs=2193
IW 0 [CrawlThread]: DW:   oldRAMSize=48249856 newFlushedSize=13379990 
docs/MB=171.863 new/old=27.731%
IFD [CrawlThread]: now checkpoint "segments_1" [1 segments ; isCommit = 
false]
IFD [CrawlThread]: now checkpoint "segments_1" [1 segments ; isCommit = 
false]
IFD [CrawlThread]: delete "_0.fnm"
IFD [CrawlThread]: delete "_0.frq"
IFD [CrawlThread]: delete "_0.prx"
IFD [CrawlThread]: delete "_0.tis"
IFD [CrawlThread]: delete "_0.tii"
IFD [CrawlThread]: delete "_0.nrm"
IW 0 [CrawlThread]: LMP: findMerges: 1 segments
IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 1 segments
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs 
trigger=16 allocMB=46.015 vs trigger=16.8 byteBlockFree=12.438 
charBlockFree=8.969
IW 0 [CrawlThread]: DW:     after free: freedMB=30.841 usedMB=0.044 
allocMB=15.173
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=6.806 vs 
trigger=16 allocMB=16.829 vs trigger=16.8 byteBlockFree=0.812 
charBlockFree=0
IW 0 [CrawlThread]: DW:     after free: freedMB=1.656 usedMB=6.806 
allocMB=15.173
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=9.242 vs 
trigger=16 allocMB=16.861 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     after free: freedMB=1.687 usedMB=9.242 
allocMB=15.174
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=43.339 vs 
trigger=16 allocMB=43.401 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=43.339 
allocMB=43.401
IW 0 [CrawlThread]:   flush: segment=_1 docStoreSegment=_0 
docStoreOffset=2193 flushDocs=true flushDeletes=false 
flushDocStores=false numDocs=1799 numBufDelTerms=0
IW 0 [CrawlThread]:   index before flush _0:c2193->_0
IW 0 [CrawlThread]: DW: flush postings as segment _1 numDocs=1799
IW 0 [CrawlThread]: DW:   oldRAMSize=45444096 newFlushedSize=12691373 
docs/MB=148.635 new/old=27.927%
IFD [CrawlThread]: now checkpoint "segments_1" [2 segments ; isCommit = 
false]
IFD [CrawlThread]: now checkpoint "segments_1" [2 segments ; isCommit = 
false]
IFD [CrawlThread]: delete "_1.fnm"
IFD [CrawlThread]: delete "_1.frq"
IFD [CrawlThread]: delete "_1.prx"
IFD [CrawlThread]: delete "_1.tis"
IFD [CrawlThread]: delete "_1.tii"
IFD [CrawlThread]: delete "_1.nrm"
IW 0 [CrawlThread]: LMP: findMerges: 2 segments
IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 2 segments
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs 
trigger=16 allocMB=43.401 vs trigger=16.8 byteBlockFree=11.781 
charBlockFree=8.469
IW 0 [CrawlThread]: DW:     after free: freedMB=28.217 usedMB=0.044 
allocMB=15.185
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=40.889 vs 
trigger=16 allocMB=40.951 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=40.889 
allocMB=40.951
IW 0 [CrawlThread]:   flush: segment=_2 docStoreSegment=_0 
docStoreOffset=3992 flushDocs=true flushDeletes=false 
flushDocStores=false numDocs=1013 numBufDelTerms=0
IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0
IW 0 [CrawlThread]: DW: flush postings as segment _2 numDocs=1013
IW 0 [CrawlThread]: DW:   oldRAMSize=42874880 newFlushedSize=11684845 
docs/MB=90.905 new/old=27.253%
IFD [CrawlThread]: now checkpoint "segments_1" [3 segments ; isCommit = 
false]
IFD [CrawlThread]: now checkpoint "segments_1" [3 segments ; isCommit = 
false]
IFD [CrawlThread]: delete "_2.fnm"
IFD [CrawlThread]: delete "_2.frq"
IFD [CrawlThread]: delete "_2.prx"
IFD [CrawlThread]: delete "_2.tis"
IFD [CrawlThread]: delete "_2.tii"
IFD [CrawlThread]: delete "_2.nrm"
IW 0 [CrawlThread]: LMP: findMerges: 3 segments
IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 3 segments
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs 
trigger=16 allocMB=40.951 vs trigger=16.8 byteBlockFree=10.688 
charBlockFree=8.062
IW 0 [CrawlThread]: DW:     after free: freedMB=25.779 usedMB=0.044 
allocMB=15.172
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=38.82 vs 
trigger=16 allocMB=38.883 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=38.82 
allocMB=38.883
IW 0 [CrawlThread]:   flush: segment=_3 docStoreSegment=_0 
docStoreOffset=5005 flushDocs=true flushDeletes=false 
flushDocStores=false numDocs=427 numBufDelTerms=0
IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0 
_2:c1013->_0
IW 0 [CrawlThread]: DW: flush postings as segment _3 numDocs=427
IW 0 [CrawlThread]: DW:   oldRAMSize=40706048 newFlushedSize=10574425 
docs/MB=42.342 new/old=25.978%
IFD [CrawlThread]: now checkpoint "segments_1" [4 segments ; isCommit = 
false]
IFD [CrawlThread]: now checkpoint "segments_1" [4 segments ; isCommit = 
false]
IFD [CrawlThread]: delete "_3.fnm"
IFD [CrawlThread]: delete "_3.frq"
IFD [CrawlThread]: delete "_3.prx"
IFD [CrawlThread]: delete "_3.tis"
IFD [CrawlThread]: delete "_3.tii"
IFD [CrawlThread]: delete "_3.nrm"
IW 0 [CrawlThread]: LMP: findMerges: 4 segments
IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 4 segments
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs 
trigger=16 allocMB=38.883 vs trigger=16.8 byteBlockFree=9.312 
charBlockFree=7.812
IW 0 [CrawlThread]: DW:     after free: freedMB=23.686 usedMB=0.044 
allocMB=15.197
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=8.588 vs 
trigger=16 allocMB=16.822 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     after free: freedMB=1.625 usedMB=8.588 
allocMB=15.197
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=16.15 vs 
trigger=16 allocMB=19.51 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
IW 0 [CrawlThread]: DW:     after free: freedMB=3.297 usedMB=16.15 
allocMB=16.213
IW 0 [CrawlThread]:   flush: segment=_4 docStoreSegment=_0 
docStoreOffset=5432 flushDocs=true flushDeletes=false 
flushDocStores=false numDocs=1145 numBufDelTerms=0
IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0 
_2:c1013->_0 _3:c427->_0
IW 0 [CrawlThread]: DW: flush postings as segment _4 numDocs=1145
IW 0 [CrawlThread]: DW:   oldRAMSize=16934912 newFlushedSize=5040651 
docs/MB=238.187 new/old=29.765%
IFD [CrawlThread]: now checkpoint "segments_1" [5 segments ; isCommit = 
false]
IFD [CrawlThread]: now checkpoint "segments_1" [5 segments ; isCommit = 
false]
IFD [CrawlThread]: delete "_4.fnm"
IFD [CrawlThread]: delete "_4.frq"
IFD [CrawlThread]: delete "_4.prx"
IFD [CrawlThread]: delete "_4.tis"
IFD [CrawlThread]: delete "_4.tii"
IFD [CrawlThread]: delete "_4.nrm"
IW 0 [CrawlThread]: LMP: findMerges: 5 segments
IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 5 segments
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=45.533 vs 
trigger=16 allocMB=45.596 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=45.533 
allocMB=45.596
IW 0 [CrawlThread]:   flush: segment=_5 docStoreSegment=_0 
docStoreOffset=6577 flushDocs=true flushDeletes=false 
flushDocStores=false numDocs=808 numBufDelTerms=0
IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0 
_2:c1013->_0 _3:c427->_0 _4:c1145->_0
IW 0 [CrawlThread]: DW: flush postings as segment _5 numDocs=808
IW 0 [CrawlThread]: DW:   oldRAMSize=47745024 newFlushedSize=12761396 
docs/MB=66.392 new/old=26.728%
IFD [CrawlThread]: now checkpoint "segments_1" [6 segments ; isCommit = 
false]
IFD [CrawlThread]: now checkpoint "segments_1" [6 segments ; isCommit = 
false]
IFD [CrawlThread]: delete "_5.fnm"
IFD [CrawlThread]: delete "_5.frq"
IFD [CrawlThread]: delete "_5.prx"
IFD [CrawlThread]: delete "_5.tis"
IFD [CrawlThread]: delete "_5.tii"
IFD [CrawlThread]: delete "_5.nrm"
IW 0 [CrawlThread]: LMP: findMerges: 6 segments
IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 6 segments
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs 
trigger=16 allocMB=45.596 vs trigger=16.8 byteBlockFree=11.5 
charBlockFree=9.031
IW 0 [CrawlThread]: DW:     after free: freedMB=30.404 usedMB=0.044 
allocMB=15.192
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=7.051 vs 
trigger=16 allocMB=16.848 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     after free: freedMB=1.656 usedMB=7.051 
allocMB=15.192
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=9.829 vs 
trigger=16 allocMB=16.942 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     after free: freedMB=1.75 usedMB=9.829 
allocMB=15.192
IW 0 [CrawlThread]: hit exception adding document
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=48.622 vs 
trigger=16 allocMB=48.685 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=48.622 
allocMB=48.685
IW 0 [CrawlThread]:   flush: segment=_6 docStoreSegment=_0 
docStoreOffset=7385 flushDocs=true flushDeletes=false 
flushDocStores=false numDocs=1689 numBufDelTerms=0
IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0 
_2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0
IW 0 [CrawlThread]: DW: flush postings as segment _6 numDocs=1689
IW 0 [CrawlThread]: DW:   oldRAMSize=50983936 newFlushedSize=14095657 
docs/MB=125.645 new/old=27.647%
IFD [CrawlThread]: now checkpoint "segments_1" [7 segments ; isCommit = 
false]
IFD [CrawlThread]: now checkpoint "segments_1" [7 segments ; isCommit = 
false]
IFD [CrawlThread]: delete "_6.fnm"
IFD [CrawlThread]: delete "_6.frq"
IFD [CrawlThread]: delete "_6.prx"
IFD [CrawlThread]: delete "_6.tis"
IFD [CrawlThread]: delete "_6.tii"
IFD [CrawlThread]: delete "_6.nrm"
IW 0 [CrawlThread]: LMP: findMerges: 7 segments
IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 7 segments
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs 
trigger=16 allocMB=48.685 vs trigger=16.8 byteBlockFree=12.969 
charBlockFree=9.594
IW 0 [CrawlThread]: DW:     after free: freedMB=33.498 usedMB=0.044 
allocMB=15.187
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=7.007 vs 
trigger=16 allocMB=16.812 vs trigger=16.8 byteBlockFree=0.281 
charBlockFree=0
IW 0 [CrawlThread]: DW:     after free: freedMB=1.625 usedMB=7.007 
allocMB=15.187
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=9.254 vs 
trigger=16 allocMB=16.812 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     after free: freedMB=1.625 usedMB=9.254 
allocMB=15.188
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=11.913 vs 
trigger=16 allocMB=16.844 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     after free: freedMB=1.656 usedMB=11.913 
allocMB=15.188
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=14.566 vs 
trigger=16 allocMB=16.813 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
IW 0 [CrawlThread]: DW:     after free: freedMB=1.625 usedMB=14.566 
allocMB=15.189
IW 0 [CrawlThread]: DW:   RAM: now flush @ usedMB=16.151 allocMB=16.214 
triggerMB=16
IW 0 [CrawlThread]:   flush: segment=_7 docStoreSegment=_0 
docStoreOffset=9074 flushDocs=true flushDeletes=false 
flushDocStores=false numDocs=2941 numBufDelTerms=0
IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0 
_2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0
IW 0 [CrawlThread]: DW: flush postings as segment _7 numDocs=2941
IW 0 [CrawlThread]: DW:   oldRAMSize=16935936 newFlushedSize=5920901 
docs/MB=520.843 new/old=34.961%
IFD [CrawlThread]: now checkpoint "segments_1" [8 segments ; isCommit = 
false]
IFD [CrawlThread]: now checkpoint "segments_1" [8 segments ; isCommit = 
false]
IFD [CrawlThread]: delete "_7.fnm"
IFD [CrawlThread]: delete "_7.frq"
IFD [CrawlThread]: delete "_7.prx"
IFD [CrawlThread]: delete "_7.tis"
IFD [CrawlThread]: delete "_7.tii"
IFD [CrawlThread]: delete "_7.nrm"
IW 0 [CrawlThread]: LMP: findMerges: 8 segments
IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 8 segments
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=14.513 vs 
trigger=16 allocMB=16.808 vs trigger=16.8 byteBlockFree=0 charBlockFree=0.75
IW 0 [CrawlThread]: DW:     after free: freedMB=1.625 usedMB=14.513 
allocMB=15.183
IW 0 [CrawlThread]: DW:   RAM: now flush @ usedMB=16.057 allocMB=16.277 
triggerMB=16
IW 0 [CrawlThread]:   flush: segment=_8 docStoreSegment=_0 
docStoreOffset=12015 flushDocs=true flushDeletes=false 
flushDocStores=false numDocs=3171 numBufDelTerms=0
IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0 
_2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0
IW 0 [CrawlThread]: DW: flush postings as segment _8 numDocs=3171
IW 0 [CrawlThread]: DW:   oldRAMSize=16836608 newFlushedSize=7011110 
docs/MB=474.252 new/old=41.642%
IFD [CrawlThread]: now checkpoint "segments_1" [9 segments ; isCommit = 
false]
IFD [CrawlThread]: now checkpoint "segments_1" [9 segments ; isCommit = 
false]
IFD [CrawlThread]: delete "_8.fnm"
IFD [CrawlThread]: delete "_8.frq"
IFD [CrawlThread]: delete "_8.prx"
IFD [CrawlThread]: delete "_8.tis"
IFD [CrawlThread]: delete "_8.tii"
IFD [CrawlThread]: delete "_8.nrm"
IW 0 [CrawlThread]: LMP: findMerges: 9 segments
IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 9 segments
IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=15.678 vs 
trigger=16 allocMB=17.178 vs trigger=16.8 byteBlockFree=1.438 
charBlockFree=0
IW 0 [CrawlThread]: DW:     nothing to free
IW 0 [CrawlThread]: DW:     after free: freedMB=1.438 usedMB=15.678 
allocMB=15.74
IW 0 [CrawlThread]: DW:   RAM: now flush @ usedMB=16.067 allocMB=16.13 
triggerMB=16
IW 0 [CrawlThread]:   flush: segment=_9 docStoreSegment=_0 
docStoreOffset=15186 flushDocs=true flushDeletes=false 
flushDocStores=false numDocs=3401 numBufDelTerms=0
IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0 
_2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 
_7:c2941->_0 _8:c3171->_0
IW 0 [CrawlThread]: DW: flush postings as segment _9 numDocs=3401
IW 0 [CrawlThread]: DW:   oldRAMSize=16847872 newFlushedSize=6184635 
docs/MB=576.624 new/old=36.709%
IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit = 
false]
IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit = 
false]
IFD [CrawlThread]: delete "_9.fnm"
IFD [CrawlThread]: delete "_9.frq"
IFD [CrawlThread]: delete "_9.prx"
IFD [CrawlThread]: delete "_9.tis"
IFD [CrawlThread]: delete "_9.tii"
IFD [CrawlThread]: delete "_9.nrm"
IW 0 [CrawlThread]: LMP: findMerges: 10 segments
IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 10 segments
IW 0 [CrawlThread]: LMP:     0 to 10: add this merge
IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 
_1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 
_6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 [total 1 pending]
IW 0 [CrawlThread]: DW: apply 0 buffered deleted terms and 1 deleted 
docIDs and 0 deleted queries on 10 segments.
IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit = 
false]
IW 0 [CrawlThread]: now flush at merge
IW 0 [CrawlThread]:   flush: segment=null docStoreSegment=_0 
docStoreOffset=18587 flushDocs=false flushDeletes=false 
flushDocStores=true numDocs=0 numBufDelTerms=0
IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0 
_2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 
_7:c2941->_0 _8:c3171->_0 _9:c3401->_0
IW 0 [CrawlThread]:   flush shared docStore segment _0
IW 0 [CrawlThread]: DW: closeDocStore: 2 files to flush to segment _0 
numDocs=18587
IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit = 
false]
IFD [CrawlThread]: delete "_0.fdt"
IFD [CrawlThread]: delete "_0.fdx"
IFD [CrawlThread]: delete "_0.fdt"
IFD [CrawlThread]: delete "_0.fdx"
IW 0 [CrawlThread]: now merge
   merge=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 
_5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _a
   merge=org.apache.lucene.index.MergePolicy$OneMerge@b590b98
   index=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 
_5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0 
_3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 
_8:c3171->_0 _9:c3401->_0 into _a
IW 0 [CrawlThread]: merge: total 18586 docs
IW 0 [CrawlThread]: LMP: findMerges: 10 segments
IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 10 segments
IW 0 [CrawlThread]: LMP:     0 to 10: add this merge
IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 
_1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 
_6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 [total 1 pending]
IW 0 [CrawlThread]: now merge
   merge=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 
_5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _b
   merge=org.apache.lucene.index.MergePolicy$OneMerge@b590658
   index=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 
_5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0 
_3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 
_8:c3171->_0 _9:c3401->_0 into _b
IW 0 [CrawlThread]: merge: total 18586 docs
IW 0 [CrawlThread]: LMP: findMerges: 10 segments
IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 10 segments
IW 0 [CrawlThread]: LMP:     0 to 10: add this merge
IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 
_1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 
_6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 [total 1 pending]
IW 0 [CrawlThread]: now merge
   merge=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 
_5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _c
   merge=org.apache.lucene.index.MergePolicy$OneMerge@b5906b8
   index=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 
_5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0 
_3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 
_8:c3171->_0 _9:c3401->_0 into _c
IW 0 [CrawlThread]: merge: total 18586 docs
IW 0 [CrawlThread]: LMP: findMerges: 10 segments
IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 10 segments
IW 0 [CrawlThread]: LMP:     0 to 10: add this merge
IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 
_1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 
_6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 [total 1 pending]
IW 0 [CrawlThread]: now merge
   merge=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 
_5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _d
   merge=org.apache.lucene.index.MergePolicy$OneMerge@b5906e8
   index=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 
_5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0 
_3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 
_8:c3171->_0 _9:c3401->_0 into _d
IW 0 [CrawlThread]: merge: total 18586 docs
IW 0 [CrawlThread]: LMP: findMerges: 10 segments
IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 10 segments
IW 0 [CrawlThread]: LMP:     0 to 10: add this merge
IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 
_1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 
_6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 [total 1 pending]
IW 0 [CrawlThread]: now merge
   merge=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 
_5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _e
   merge=org.apache.lucene.index.MergePolicy$OneMerge@b590688
   index=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0 
_5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
.......



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39714-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 09:40:55 2009
Return-Path: <java-user-return-39714-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88410 invoked from network); 14 Apr 2009 09:40:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 09:40:55 -0000
Received: (qmail 63954 invoked by uid 500); 14 Apr 2009 09:40:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63880 invoked by uid 500); 14 Apr 2009 09:40:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63870 invoked by uid 99); 14 Apr 2009 09:40:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 09:40:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of seidymam@gmail.com designates 72.14.220.158 as permitted sender)
Received: from [72.14.220.158] (HELO fg-out-1718.google.com) (72.14.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 09:40:44 +0000
Received: by fg-out-1718.google.com with SMTP id l27so445690fgb.4
        for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 02:40:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=MJ+U3BWyZlqXWoLOKAY5Irb/63/8ymRwMnijXFxIFt4=;
        b=NiTvh+RQYuI6QZomAZKgrsjOUQkiehtbVloupPFhirlO09r4C9fRDxAcB+CxPYxpJm
         VfDkXXqPUI3XAajTwpIkIytO8DjDsByCJadLiL18GB7OEovcdVzDS5ke3+cBLH69SwVv
         ddnQCxlIjoTjH9w7XehPnHkiyL+j+r0mvlyLk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=PascmuOI66FSdXC/K4NYk1x3hCYrcNQu2nL9FxsSgh0MTm6XH2dlwB9GtDpqUQoujV
         SZnovZdejIgnoiUCPTPjxXaAg8lvXi+eIXENgQbvXNlNRt4ppw/WIuvfhollJjOzx4kD
         Ph4QMygh4X1TwaVO9i5gUp2Ny6SPR9DfffjXw=
MIME-Version: 1.0
Received: by 10.86.90.2 with SMTP id n2mr3904614fgb.61.1239702024096; Tue, 14 
	Apr 2009 02:40:24 -0700 (PDT)
In-Reply-To: <179b305e0904140136h3c28661ekb4e54ab969d77d1@mail.gmail.com>
References: <179b305e0904140038v2ac10bb8i738cf63ff91b5f30@mail.gmail.com>
	 <f18c9dde0904140110m7f456e9bre72cf15dad4b2f1f@mail.gmail.com>
	 <179b305e0904140136h3c28661ekb4e54ab969d77d1@mail.gmail.com>
Date: Tue, 14 Apr 2009 12:40:24 +0300
Message-ID: <179b305e0904140240v461c7801j87c648ce7f82b950@mail.gmail.com>
Subject: Re: Lucene Java doc.
From: Seid Mohammed <seidymam@gmail.com>
To: java-user@lucene.apache.org, simon.willnauer@gmail.com
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

but the javadoc is not yet working locally (in the eclipse editor)
==============================

org.apache.lucene.store.RAMDirectory
Note: An exception occurred while getting the Javadoc. See log for details.
==============================
but it works on the browser (SHIFT +F2)

Thanks

Seid M.

On 4/14/09, Seid Mohammed <seidymam@gmail.com> wrote:
> thanks simon
>
> seid M
>
> On 4/14/09, Simon Willnauer <simon.willnauer@googlemail.com> wrote:
>> Quite off-topic but anyway:
>>
>> 1. Right click on the JAR  (must be in build path)
>> 2. Click on Properties
>> 3. Click on JavaDoc Location
>> 4. Add the location
>>
>>
>> simon
>>
>> On Tue, Apr 14, 2009 at 9:38 AM, Seid Mohammed <seidymam@gmail.com>
>> wrote:
>>> Sorry for my little java knowledge and disturbing you.
>>> how can I attach the java doc of lucene in my eclipse application.
>>> it gives a message
>>> =========================================
>>> org.apache.lucene.search.TopDocs
>>> Note: This element neither has attached source nor attached Javadoc
>>> and hence no Javadoc could be found.
>>> ==========================================
>>> thanks a lot
>>>
>>> Seid M
>>>
>>> --
>>> "RABI ZIDNI ILMA"
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> --
> "RABI ZIDNI ILMA"
>


-- 
"RABI ZIDNI ILMA"

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39715-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 10:07:26 2009
Return-Path: <java-user-return-39715-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5201 invoked from network); 14 Apr 2009 10:07:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 10:07:25 -0000
Received: (qmail 92529 invoked by uid 500); 14 Apr 2009 10:07:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92444 invoked by uid 500); 14 Apr 2009 10:07:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92434 invoked by uid 99); 14 Apr 2009 10:07:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 10:07:23 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.168] (HELO wf-out-1314.google.com) (209.85.200.168)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 10:07:14 +0000
Received: by wf-out-1314.google.com with SMTP id 29so2316818wff.20
        for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 03:06:52 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.135.13 with SMTP id i13mr3041515wfd.8.1239703612887; Tue, 
	14 Apr 2009 03:06:52 -0700 (PDT)
In-Reply-To: <49E4573E.7070208@aduna-software.com>
References: <49E4573E.7070208@aduna-software.com>
Date: Tue, 14 Apr 2009 06:06:52 -0400
Message-ID: <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>
Subject: Re: semi-infinite loop during merging
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hmmm, very very odd.

First off, your "1 deleted docID" is because one document hit an
exception during indexing, likely in enumerating tokens from the
TokenStream; I see this line:

  IW 0 [CrawlThread]: hit exception adding document

But I think that's fine (certainly should not cause what you are
seeing).

Indeed, it looks like IndexWriter decides it's time to merge the first
10 segments, and it starts that merge, but for some reason before that
merge completes it seems to "recurse" and re-start the merge, to a
different destination segment (_a then _b then _c, etc.).

Ie the first merge never completes (we don't see lines with
"commitMerge: merge=3D... index=3D...").

I don't think "not being able to immediately delete on windows" should
cause this; IW simply retries the delete periodically.  I think
something more sinister is at play...

On Unix, one can "kill -SIGQUIT" to get a thread stack trace dump for
all threads; do you know how to do this on Windows?  If so, can you do
that at the end when IW starts doing this infinite merging?  That
would be very helpful towards understanding why this recursion is
happening (though it is spooky that this is all happening under
JET...)

Mike

On Tue, Apr 14, 2009 at 5:28 AM, Christiaan Fluit
<christiaan.fluit@aduna-software.com> wrote:
> Hello all,
>
> I have a very peculiar problem that is driving me crazy: on some of our
> datasets and at some point in time during indexing, the merge operation r=
uns
> into a (semi-)infinite loop and keeps adding files to the index until it
> runs out of free disk space.
>
> The situation: I have an indexing application that uses Lucene 2.4.1. Onl=
y
> one IndexWriter is involved, operating on a FSDirectory and using the
> compound file format. The index is created from scratch. No IndexReaders =
or
> IndexSearchers are open during indexing (double-checked by adding explici=
t
> log statements where they are created).
>
> For reasons unrelated to Lucene, the application is compiled with JET, a
> commercial Java Windows compiler. A regular Java build has produced the
> problem only once. The JET build does it every time - unless I keep press=
ing
> F5 continuously in Windows Explorer on the index dir.
>
> Here is what I see happening in the index dir:
>
> - At first, it builds _0.cfs to _9.cfs without problems. The files vary i=
n
> size between 12 MB and 49 MB and add up to about 250 MB.
>
> - Then, .del files are generated for some of these .cfs files. The number=
 of
> .del files and the .cfs files they correspond with differs from time to
> time. I don't understand why these are created, as no IndexReaders exist =
at
> this time.
>
> - Then, it generates files called _a.fdt, _a.fdx, _a.fnm, _a.frq, _a.nrm,
> _a.prx, _a.tii, _a.tis, _a.tvd, _a.tvf, _a.tvx. Together these files add =
up
> to 219 MB. I assume this is the start of the merge of the 10 .cfs files a=
nd
> this is all still correct.
>
> - Then, it generates _b files with those same extensions, then _c, _d, et=
c.
> It only keeps generating new files, I never see files disappear. The
> original .cfs files are still there.
>
> - This continues until my hard drive is out of free space. At one test I =
was
> at _8n and the index had grown from 250MB to 64 GB. Then the application
> just hangs.
>
> Interestingly, after killing the application in this test, there were
> _8k.cfs and _8m.cfs files of 20 MB and 27 MB respectively. No other .cfs
> files existed.
>
> In some older threads on this list (e.g.
> http://marc.info/?l=3Dlucene-user&m=3D108300530413241&w=3D2) I read that =
"Win32
> seems to sometimes not permit one to delete a file immediately after it h=
as
> been closed". Could this explain the problem? Perhaps the JET-compiled ap=
p
> gets to delete the file quicker than when the code is running inside a Ja=
va
> VM and therefore runs into this issue? This would also explain why pressi=
ng
> F5 during indexing lets the application continue: external activity causi=
ng
> some manual delay.
>
> At the end of this mail I have added the output of the InfoStream install=
ed
> on the IndexWriter, showing everything from the start to the first few
> problematic merges. Lines starting with "=3D=3D=3D" are println's in my o=
wn code
> to make sure that indeed only IndexWriters are generated and no
> IndexSearchers/-Readers. The fun starts almost at the bottom, at the firs=
t
> line containing "LMP: findMerges: 10 segments". The next lines then get
> repeated over and over again, with different segment names. I cannot expl=
ain
> why it mentions "1 deleted docIDs" a couple of lines below the first
> "findMerges: 10" as no IndexWriter.deleteDocuments takes place.
>
> As you can see in this output, I am setting a SerialMergeScheduler to rul=
e
> out concurrency issues and making debugging easier. Both
> SerialMergeScheduler and ConcurrentMergeScheduler give this problem thoug=
h.
>
> I would be grateful if anyone could pose some light on this or can advise=
 me
> on what I can try next. I even considered hacking the FSDirectory code an=
d
> adding some delay in the deleteFile operation to see if the above-mention=
ed
> win32 issue is the problem, but unless you know what you're doing, such
> hacks can even cause such problems in the first place.
>
>
> Kind regards,
>
> Chris
> --
>
> =3D=3D=3D Creating new FSDirectory
> =3D=3D=3D Opening indexWriter (create=3Dtrue)
> IFD [AWT-EventQueue-0]: setInfoStream
> deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy=
@9fb0688
> IW 0 [AWT-EventQueue-0]: setInfoStream:
> dir=3Dorg.apache.lucene.store.FSDirectory@D:\index autoCommit=3Dfalse
> mergePolicy=3Dorg.apache.lucene.index.LogByteSizeMergePolicy@a11d0d8
> mergeScheduler=3Dorg.apache.lucene.index.ConcurrentMergeScheduler@a3fa9d8
> ramBufferSizeMB=3D16.0 maxBufferedDocs=3D-1 maxBuffereDeleteTerms=3D-1
> maxFieldLength=3D2147483647 index=3D
> IW 0 [AWT-EventQueue-0]: setMergeScheduler
> org.apache.lucene.index.SerialMergeScheduler@a3d1fe8
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D46.015=
 vs
> trigger=3D16 allocMB=3D46.015 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set bufferIsFull
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 usedMB=3D46.015
> allocMB=3D46.015
> IW 0 [CrawlThread]: =A0 flush: segment=3D_0 docStoreSegment=3D_0 docStore=
Offset=3D0
> flushDocs=3Dtrue flushDeletes=3Dfalse flushDocStores=3Dfalse numDocs=3D21=
93
> numBufDelTerms=3D0
> IW 0 [CrawlThread]: =A0 index before flush
> IW 0 [CrawlThread]: DW: flush postings as segment _0 numDocs=3D2193
> IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D48249856 newFlushedSize=3D133799=
90
> docs/MB=3D171.863 new/old=3D27.731%
> IFD [CrawlThread]: now checkpoint "segments_1" [1 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: now checkpoint "segments_1" [1 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: delete "_0.fnm"
> IFD [CrawlThread]: delete "_0.frq"
> IFD [CrawlThread]: delete "_0.prx"
> IFD [CrawlThread]: delete "_0.tis"
> IFD [CrawlThread]: delete "_0.tii"
> IFD [CrawlThread]: delete "_0.nrm"
> IW 0 [CrawlThread]: LMP: findMerges: 1 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 1 segments
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D0.044 =
vs
> trigger=3D16 allocMB=3D46.015 vs trigger=3D16.8 byteBlockFree=3D12.438
> charBlockFree=3D8.969
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D30.841 usedMB=3D0.0=
44
> allocMB=3D15.173
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D6.806 =
vs
> trigger=3D16 allocMB=3D16.829 vs trigger=3D16.8 byteBlockFree=3D0.812
> charBlockFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.656 usedMB=3D6.80=
6
> allocMB=3D15.173
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D9.242 =
vs
> trigger=3D16 allocMB=3D16.861 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.687 usedMB=3D9.24=
2
> allocMB=3D15.174
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D43.339=
 vs
> trigger=3D16 allocMB=3D43.401 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set bufferIsFull
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 usedMB=3D43.339
> allocMB=3D43.401
> IW 0 [CrawlThread]: =A0 flush: segment=3D_1 docStoreSegment=3D_0
> docStoreOffset=3D2193 flushDocs=3Dtrue flushDeletes=3Dfalse flushDocStore=
s=3Dfalse
> numDocs=3D1799 numBufDelTerms=3D0
> IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0
> IW 0 [CrawlThread]: DW: flush postings as segment _1 numDocs=3D1799
> IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D45444096 newFlushedSize=3D126913=
73
> docs/MB=3D148.635 new/old=3D27.927%
> IFD [CrawlThread]: now checkpoint "segments_1" [2 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: now checkpoint "segments_1" [2 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: delete "_1.fnm"
> IFD [CrawlThread]: delete "_1.frq"
> IFD [CrawlThread]: delete "_1.prx"
> IFD [CrawlThread]: delete "_1.tis"
> IFD [CrawlThread]: delete "_1.tii"
> IFD [CrawlThread]: delete "_1.nrm"
> IW 0 [CrawlThread]: LMP: findMerges: 2 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 2 segments
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D0.044 =
vs
> trigger=3D16 allocMB=3D43.401 vs trigger=3D16.8 byteBlockFree=3D11.781
> charBlockFree=3D8.469
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D28.217 usedMB=3D0.0=
44
> allocMB=3D15.185
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D40.889=
 vs
> trigger=3D16 allocMB=3D40.951 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set bufferIsFull
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 usedMB=3D40.889
> allocMB=3D40.951
> IW 0 [CrawlThread]: =A0 flush: segment=3D_2 docStoreSegment=3D_0
> docStoreOffset=3D3992 flushDocs=3Dtrue flushDeletes=3Dfalse flushDocStore=
s=3Dfalse
> numDocs=3D1013 numBufDelTerms=3D0
> IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> IW 0 [CrawlThread]: DW: flush postings as segment _2 numDocs=3D1013
> IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D42874880 newFlushedSize=3D116848=
45
> docs/MB=3D90.905 new/old=3D27.253%
> IFD [CrawlThread]: now checkpoint "segments_1" [3 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: now checkpoint "segments_1" [3 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: delete "_2.fnm"
> IFD [CrawlThread]: delete "_2.frq"
> IFD [CrawlThread]: delete "_2.prx"
> IFD [CrawlThread]: delete "_2.tis"
> IFD [CrawlThread]: delete "_2.tii"
> IFD [CrawlThread]: delete "_2.nrm"
> IW 0 [CrawlThread]: LMP: findMerges: 3 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 3 segments
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D0.044 =
vs
> trigger=3D16 allocMB=3D40.951 vs trigger=3D16.8 byteBlockFree=3D10.688
> charBlockFree=3D8.062
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D25.779 usedMB=3D0.0=
44
> allocMB=3D15.172
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D38.82 =
vs
> trigger=3D16 allocMB=3D38.883 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set bufferIsFull
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 usedMB=3D38.82
> allocMB=3D38.883
> IW 0 [CrawlThread]: =A0 flush: segment=3D_3 docStoreSegment=3D_0
> docStoreOffset=3D5005 flushDocs=3Dtrue flushDeletes=3Dfalse flushDocStore=
s=3Dfalse
> numDocs=3D427 numBufDelTerms=3D0
> IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0
> IW 0 [CrawlThread]: DW: flush postings as segment _3 numDocs=3D427
> IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D40706048 newFlushedSize=3D105744=
25
> docs/MB=3D42.342 new/old=3D25.978%
> IFD [CrawlThread]: now checkpoint "segments_1" [4 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: now checkpoint "segments_1" [4 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: delete "_3.fnm"
> IFD [CrawlThread]: delete "_3.frq"
> IFD [CrawlThread]: delete "_3.prx"
> IFD [CrawlThread]: delete "_3.tis"
> IFD [CrawlThread]: delete "_3.tii"
> IFD [CrawlThread]: delete "_3.nrm"
> IW 0 [CrawlThread]: LMP: findMerges: 4 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 4 segments
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D0.044 =
vs
> trigger=3D16 allocMB=3D38.883 vs trigger=3D16.8 byteBlockFree=3D9.312
> charBlockFree=3D7.812
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D23.686 usedMB=3D0.0=
44
> allocMB=3D15.197
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D8.588 =
vs
> trigger=3D16 allocMB=3D16.822 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.625 usedMB=3D8.58=
8
> allocMB=3D15.197
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D16.15 =
vs
> trigger=3D16 allocMB=3D19.51 vs trigger=3D16.8 byteBlockFree=3D0 charBloc=
kFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set bufferIsFull
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D3.297 usedMB=3D16.1=
5
> allocMB=3D16.213
> IW 0 [CrawlThread]: =A0 flush: segment=3D_4 docStoreSegment=3D_0
> docStoreOffset=3D5432 flushDocs=3Dtrue flushDeletes=3Dfalse flushDocStore=
s=3Dfalse
> numDocs=3D1145 numBufDelTerms=3D0
> IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0
> IW 0 [CrawlThread]: DW: flush postings as segment _4 numDocs=3D1145
> IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D16934912 newFlushedSize=3D504065=
1
> docs/MB=3D238.187 new/old=3D29.765%
> IFD [CrawlThread]: now checkpoint "segments_1" [5 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: now checkpoint "segments_1" [5 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: delete "_4.fnm"
> IFD [CrawlThread]: delete "_4.frq"
> IFD [CrawlThread]: delete "_4.prx"
> IFD [CrawlThread]: delete "_4.tis"
> IFD [CrawlThread]: delete "_4.tii"
> IFD [CrawlThread]: delete "_4.nrm"
> IW 0 [CrawlThread]: LMP: findMerges: 5 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 5 segments
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D45.533=
 vs
> trigger=3D16 allocMB=3D45.596 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set bufferIsFull
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 usedMB=3D45.533
> allocMB=3D45.596
> IW 0 [CrawlThread]: =A0 flush: segment=3D_5 docStoreSegment=3D_0
> docStoreOffset=3D6577 flushDocs=3Dtrue flushDeletes=3Dfalse flushDocStore=
s=3Dfalse
> numDocs=3D808 numBufDelTerms=3D0
> IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0 _4:c1145->_0
> IW 0 [CrawlThread]: DW: flush postings as segment _5 numDocs=3D808
> IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D47745024 newFlushedSize=3D127613=
96
> docs/MB=3D66.392 new/old=3D26.728%
> IFD [CrawlThread]: now checkpoint "segments_1" [6 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: now checkpoint "segments_1" [6 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: delete "_5.fnm"
> IFD [CrawlThread]: delete "_5.frq"
> IFD [CrawlThread]: delete "_5.prx"
> IFD [CrawlThread]: delete "_5.tis"
> IFD [CrawlThread]: delete "_5.tii"
> IFD [CrawlThread]: delete "_5.nrm"
> IW 0 [CrawlThread]: LMP: findMerges: 6 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 6 segments
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D0.044 =
vs
> trigger=3D16 allocMB=3D45.596 vs trigger=3D16.8 byteBlockFree=3D11.5
> charBlockFree=3D9.031
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D30.404 usedMB=3D0.0=
44
> allocMB=3D15.192
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D7.051 =
vs
> trigger=3D16 allocMB=3D16.848 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.656 usedMB=3D7.05=
1
> allocMB=3D15.192
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D9.829 =
vs
> trigger=3D16 allocMB=3D16.942 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.75 usedMB=3D9.829
> allocMB=3D15.192
> IW 0 [CrawlThread]: hit exception adding document
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D48.622=
 vs
> trigger=3D16 allocMB=3D48.685 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set bufferIsFull
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 usedMB=3D48.622
> allocMB=3D48.685
> IW 0 [CrawlThread]: =A0 flush: segment=3D_6 docStoreSegment=3D_0
> docStoreOffset=3D7385 flushDocs=3Dtrue flushDeletes=3Dfalse flushDocStore=
s=3Dfalse
> numDocs=3D1689 numBufDelTerms=3D0
> IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0
> IW 0 [CrawlThread]: DW: flush postings as segment _6 numDocs=3D1689
> IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D50983936 newFlushedSize=3D140956=
57
> docs/MB=3D125.645 new/old=3D27.647%
> IFD [CrawlThread]: now checkpoint "segments_1" [7 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: now checkpoint "segments_1" [7 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: delete "_6.fnm"
> IFD [CrawlThread]: delete "_6.frq"
> IFD [CrawlThread]: delete "_6.prx"
> IFD [CrawlThread]: delete "_6.tis"
> IFD [CrawlThread]: delete "_6.tii"
> IFD [CrawlThread]: delete "_6.nrm"
> IW 0 [CrawlThread]: LMP: findMerges: 7 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 7 segments
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D0.044 =
vs
> trigger=3D16 allocMB=3D48.685 vs trigger=3D16.8 byteBlockFree=3D12.969
> charBlockFree=3D9.594
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D33.498 usedMB=3D0.0=
44
> allocMB=3D15.187
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D7.007 =
vs
> trigger=3D16 allocMB=3D16.812 vs trigger=3D16.8 byteBlockFree=3D0.281
> charBlockFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.625 usedMB=3D7.00=
7
> allocMB=3D15.187
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D9.254 =
vs
> trigger=3D16 allocMB=3D16.812 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.625 usedMB=3D9.25=
4
> allocMB=3D15.188
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D11.913=
 vs
> trigger=3D16 allocMB=3D16.844 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.656 usedMB=3D11.9=
13
> allocMB=3D15.188
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D14.566=
 vs
> trigger=3D16 allocMB=3D16.813 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.625 usedMB=3D14.5=
66
> allocMB=3D15.189
> IW 0 [CrawlThread]: DW: =A0 RAM: now flush @ usedMB=3D16.151 allocMB=3D16=
.214
> triggerMB=3D16
> IW 0 [CrawlThread]: =A0 flush: segment=3D_7 docStoreSegment=3D_0
> docStoreOffset=3D9074 flushDocs=3Dtrue flushDeletes=3Dfalse flushDocStore=
s=3Dfalse
> numDocs=3D2941 numBufDelTerms=3D0
> IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0
> IW 0 [CrawlThread]: DW: flush postings as segment _7 numDocs=3D2941
> IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D16935936 newFlushedSize=3D592090=
1
> docs/MB=3D520.843 new/old=3D34.961%
> IFD [CrawlThread]: now checkpoint "segments_1" [8 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: now checkpoint "segments_1" [8 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: delete "_7.fnm"
> IFD [CrawlThread]: delete "_7.frq"
> IFD [CrawlThread]: delete "_7.prx"
> IFD [CrawlThread]: delete "_7.tis"
> IFD [CrawlThread]: delete "_7.tii"
> IFD [CrawlThread]: delete "_7.nrm"
> IW 0 [CrawlThread]: LMP: findMerges: 8 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 8 segments
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D14.513=
 vs
> trigger=3D16 allocMB=3D16.808 vs trigger=3D16.8 byteBlockFree=3D0 charBlo=
ckFree=3D0.75
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.625 usedMB=3D14.5=
13
> allocMB=3D15.183
> IW 0 [CrawlThread]: DW: =A0 RAM: now flush @ usedMB=3D16.057 allocMB=3D16=
.277
> triggerMB=3D16
> IW 0 [CrawlThread]: =A0 flush: segment=3D_8 docStoreSegment=3D_0
> docStoreOffset=3D12015 flushDocs=3Dtrue flushDeletes=3Dfalse flushDocStor=
es=3Dfalse
> numDocs=3D3171 numBufDelTerms=3D0
> IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->=
_0
> IW 0 [CrawlThread]: DW: flush postings as segment _8 numDocs=3D3171
> IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D16836608 newFlushedSize=3D701111=
0
> docs/MB=3D474.252 new/old=3D41.642%
> IFD [CrawlThread]: now checkpoint "segments_1" [9 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: now checkpoint "segments_1" [9 segments ; isCommit =3D
> false]
> IFD [CrawlThread]: delete "_8.fnm"
> IFD [CrawlThread]: delete "_8.frq"
> IFD [CrawlThread]: delete "_8.prx"
> IFD [CrawlThread]: delete "_8.tis"
> IFD [CrawlThread]: delete "_8.tii"
> IFD [CrawlThread]: delete "_8.nrm"
> IW 0 [CrawlThread]: LMP: findMerges: 9 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 9 segments
> IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: usedMB=3D15.678=
 vs
> trigger=3D16 allocMB=3D17.178 vs trigger=3D16.8 byteBlockFree=3D1.438
> charBlockFree=3D0
> IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free
> IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.438 usedMB=3D15.6=
78
> allocMB=3D15.74
> IW 0 [CrawlThread]: DW: =A0 RAM: now flush @ usedMB=3D16.067 allocMB=3D16=
.13
> triggerMB=3D16
> IW 0 [CrawlThread]: =A0 flush: segment=3D_9 docStoreSegment=3D_0
> docStoreOffset=3D15186 flushDocs=3Dtrue flushDeletes=3Dfalse flushDocStor=
es=3Dfalse
> numDocs=3D3401 numBufDelTerms=3D0
> IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->=
_0
> _8:c3171->_0
> IW 0 [CrawlThread]: DW: flush postings as segment _9 numDocs=3D3401
> IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D16847872 newFlushedSize=3D618463=
5
> docs/MB=3D576.624 new/old=3D36.709%
> IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit =
=3D
> false]
> IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit =
=3D
> false]
> IFD [CrawlThread]: delete "_9.fnm"
> IFD [CrawlThread]: delete "_9.frq"
> IFD [CrawlThread]: delete "_9.prx"
> IFD [CrawlThread]: delete "_9.tis"
> IFD [CrawlThread]: delete "_9.tii"
> IFD [CrawlThread]: delete "_9.nrm"
> IW 0 [CrawlThread]: LMP: findMerges: 10 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 10 segments
> IW 0 [CrawlThread]: LMP: =A0 =A0 0 to 10: add this merge
> IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->=
_0
> _8:c3171->_0 _9:c3401->_0 [total 1 pending]
> IW 0 [CrawlThread]: DW: apply 0 buffered deleted terms and 1 deleted docI=
Ds
> and 0 deleted queries on 10 segments.
> IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit =
=3D
> false]
> IW 0 [CrawlThread]: now flush at merge
> IW 0 [CrawlThread]: =A0 flush: segment=3Dnull docStoreSegment=3D_0
> docStoreOffset=3D18587 flushDocs=3Dfalse flushDeletes=3Dfalse flushDocSto=
res=3Dtrue
> numDocs=3D0 numBufDelTerms=3D0
> IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->=
_0
> _8:c3171->_0 _9:c3401->_0
> IW 0 [CrawlThread]: =A0 flush shared docStore segment _0
> IW 0 [CrawlThread]: DW: closeDocStore: 2 files to flush to segment _0
> numDocs=3D18587
> IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit =
=3D
> false]
> IFD [CrawlThread]: delete "_0.fdt"
> IFD [CrawlThread]: delete "_0.fdx"
> IFD [CrawlThread]: delete "_0.fdt"
> IFD [CrawlThread]: delete "_0.fdx"
> IW 0 [CrawlThread]: now merge
> =A0merge=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_=
0
> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _a
> =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@b590b98
> =A0index=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_=
0
> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
> IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
> _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->=
_0
> _9:c3401->_0 into _a
> IW 0 [CrawlThread]: merge: total 18586 docs
> IW 0 [CrawlThread]: LMP: findMerges: 10 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 10 segments
> IW 0 [CrawlThread]: LMP: =A0 =A0 0 to 10: add this merge
> IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->=
_0
> _8:c3171->_0 _9:c3401->_0 [total 1 pending]
> IW 0 [CrawlThread]: now merge
> =A0merge=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_=
0
> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _b
> =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@b590658
> =A0index=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_=
0
> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
> IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
> _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->=
_0
> _9:c3401->_0 into _b
> IW 0 [CrawlThread]: merge: total 18586 docs
> IW 0 [CrawlThread]: LMP: findMerges: 10 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 10 segments
> IW 0 [CrawlThread]: LMP: =A0 =A0 0 to 10: add this merge
> IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->=
_0
> _8:c3171->_0 _9:c3401->_0 [total 1 pending]
> IW 0 [CrawlThread]: now merge
> =A0merge=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_=
0
> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _c
> =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@b5906b8
> =A0index=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_=
0
> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
> IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
> _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->=
_0
> _9:c3401->_0 into _c
> IW 0 [CrawlThread]: merge: total 18586 docs
> IW 0 [CrawlThread]: LMP: findMerges: 10 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 10 segments
> IW 0 [CrawlThread]: LMP: =A0 =A0 0 to 10: add this merge
> IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->=
_0
> _8:c3171->_0 _9:c3401->_0 [total 1 pending]
> IW 0 [CrawlThread]: now merge
> =A0merge=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_=
0
> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _d
> =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@b5906e8
> =A0index=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_=
0
> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
> IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
> _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->=
_0
> _9:c3401->_0 into _d
> IW 0 [CrawlThread]: merge: total 18586 docs
> IW 0 [CrawlThread]: LMP: findMerges: 10 segments
> IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 10 segments
> IW 0 [CrawlThread]: LMP: =A0 =A0 0 to 10: add this merge
> IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 _1:c1799->_0
> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->=
_0
> _8:c3171->_0 _9:c3401->_0 [total 1 pending]
> IW 0 [CrawlThread]: now merge
> =A0merge=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_=
0
> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _e
> =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@b590688
> =A0index=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_=
0
> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
> .......
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39716-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 10:36:26 2009
Return-Path: <java-user-return-39716-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19306 invoked from network); 14 Apr 2009 10:36:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 10:36:26 -0000
Received: (qmail 23361 invoked by uid 500); 14 Apr 2009 10:36:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23275 invoked by uid 500); 14 Apr 2009 10:36:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23265 invoked by uid 99); 14 Apr 2009 10:36:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 10:36:23 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 10:36:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 3386951A90
	for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 12:35:51 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 16744-05 for <java-user@lucene.apache.org>;
 Tue, 14 Apr 2009 12:35:47 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id A224D51A64
	for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 12:35:47 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <49E4573E.7070208@aduna-software.com> <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>
Subject: RE: semi-infinite loop during merging
Date: Tue, 14 Apr 2009 12:35:48 +0200
Message-ID: <C155ED47F5604175A51EB5B3DE909515@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>
Thread-Index: Acm86NIYDF4b/3JIQ8u3THxv2I73+wAA5hfw
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

> On Unix, one can "kill -SIGQUIT" to get a thread stack trace dump for
> all threads; do you know how to do this on Windows?  If so, can you do
> that at the end when IW starts doing this infinite merging?  That
> would be very helpful towards understanding why this recursion is
> happening (though it is spooky that this is all happening under
> JET...)

On Windows, press Ctrl-Break in the console, this sends SIGBREAK to JVM,
which does the same on Windows (the stack traces will appear in =
console).
Ctrl-Break is *not* Ctrl-C (which kills the process). Break is the =
seldom
used key also known as "Pause" key somewhere right top on the keyboard.

Uwe

> On Tue, Apr 14, 2009 at 5:28 AM, Christiaan Fluit
> <christiaan.fluit@aduna-software.com> wrote:
> > Hello all,
> >
> > I have a very peculiar problem that is driving me crazy: on some of =
our
> > datasets and at some point in time during indexing, the merge =
operation
> runs
> > into a (semi-)infinite loop and keeps adding files to the index =
until it
> > runs out of free disk space.
> >
> > The situation: I have an indexing application that uses Lucene =
2.4.1.
> Only
> > one IndexWriter is involved, operating on a FSDirectory and using =
the
> > compound file format. The index is created from scratch. No =
IndexReaders
> or
> > IndexSearchers are open during indexing (double-checked by adding
> explicit
> > log statements where they are created).
> >
> > For reasons unrelated to Lucene, the application is compiled with =
JET, a
> > commercial Java Windows compiler. A regular Java build has produced =
the
> > problem only once. The JET build does it every time - unless I keep
> pressing
> > F5 continuously in Windows Explorer on the index dir.
> >
> > Here is what I see happening in the index dir:
> >
> > - At first, it builds _0.cfs to _9.cfs without problems. The files =
vary
> in
> > size between 12 MB and 49 MB and add up to about 250 MB.
> >
> > - Then, .del files are generated for some of these .cfs files. The
> number of
> > .del files and the .cfs files they correspond with differs from time =
to
> > time. I don't understand why these are created, as no IndexReaders =
exist
> at
> > this time.
> >
> > - Then, it generates files called _a.fdt, _a.fdx, _a.fnm, _a.frq,
> _a.nrm,
> > _a.prx, _a.tii, _a.tis, _a.tvd, _a.tvf, _a.tvx. Together these files =
add
> up
> > to 219 MB. I assume this is the start of the merge of the 10 .cfs =
files
> and
> > this is all still correct.
> >
> > - Then, it generates _b files with those same extensions, then _c, =
_d,
> etc.
> > It only keeps generating new files, I never see files disappear. The
> > original .cfs files are still there.
> >
> > - This continues until my hard drive is out of free space. At one =
test I
> was
> > at _8n and the index had grown from 250MB to 64 GB. Then the =
application
> > just hangs.
> >
> > Interestingly, after killing the application in this test, there =
were
> > _8k.cfs and _8m.cfs files of 20 MB and 27 MB respectively. No other =
.cfs
> > files existed.
> >
> > In some older threads on this list (e.g.
> > http://marc.info/?l=3Dlucene-user&m=3D108300530413241&w=3D2) I read =
that
> "Win32
> > seems to sometimes not permit one to delete a file immediately after =
it
> has
> > been closed". Could this explain the problem? Perhaps the =
JET-compiled
> app
> > gets to delete the file quicker than when the code is running inside =
a
> Java
> > VM and therefore runs into this issue? This would also explain why
> pressing
> > F5 during indexing lets the application continue: external activity
> causing
> > some manual delay.
> >
> > At the end of this mail I have added the output of the InfoStream
> installed
> > on the IndexWriter, showing everything from the start to the first =
few
> > problematic merges. Lines starting with "=3D=3D=3D" are println's in =
my own
> code
> > to make sure that indeed only IndexWriters are generated and no
> > IndexSearchers/-Readers. The fun starts almost at the bottom, at the
> first
> > line containing "LMP: findMerges: 10 segments". The next lines then =
get
> > repeated over and over again, with different segment names. I cannot
> explain
> > why it mentions "1 deleted docIDs" a couple of lines below the first
> > "findMerges: 10" as no IndexWriter.deleteDocuments takes place.
> >
> > As you can see in this output, I am setting a SerialMergeScheduler =
to
> rule
> > out concurrency issues and making debugging easier. Both
> > SerialMergeScheduler and ConcurrentMergeScheduler give this problem
> though.
> >
> > I would be grateful if anyone could pose some light on this or can
> advise me
> > on what I can try next. I even considered hacking the FSDirectory =
code
> and
> > adding some delay in the deleteFile operation to see if the above-
> mentioned
> > win32 issue is the problem, but unless you know what you're doing, =
such
> > hacks can even cause such problems in the first place.
> >
> >
> > Kind regards,
> >
> > Chris
> > --
> >
> > =3D=3D=3D Creating new FSDirectory
> > =3D=3D=3D Opening indexWriter (create=3Dtrue)
> > IFD [AWT-EventQueue-0]: setInfoStream
> >
> =
deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy=
@9f
> b0688
> > IW 0 [AWT-EventQueue-0]: setInfoStream:
> > dir=3Dorg.apache.lucene.store.FSDirectory@D:\index =
autoCommit=3Dfalse
> > mergePolicy=3Dorg.apache.lucene.index.LogByteSizeMergePolicy@a11d0d8
> > =
mergeScheduler=3Dorg.apache.lucene.index.ConcurrentMergeScheduler@a3fa9d8=

> > ramBufferSizeMB=3D16.0 maxBufferedDocs=3D-1 =
maxBuffereDeleteTerms=3D-1
> > maxFieldLength=3D2147483647 index=3D
> > IW 0 [AWT-EventQueue-0]: setMergeScheduler
> > org.apache.lucene.index.SerialMergeScheduler@a3d1fe8
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D46.015 vs
> > trigger=3D16 allocMB=3D46.015 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set =
bufferIsFull
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 =
usedMB=3D46.015
> > allocMB=3D46.015
> > IW 0 [CrawlThread]: =A0 flush: segment=3D_0 docStoreSegment=3D_0
> docStoreOffset=3D0
> > flushDocs=3Dtrue flushDeletes=3Dfalse flushDocStores=3Dfalse =
numDocs=3D2193
> > numBufDelTerms=3D0
> > IW 0 [CrawlThread]: =A0 index before flush
> > IW 0 [CrawlThread]: DW: flush postings as segment _0 numDocs=3D2193
> > IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D48249856 =
newFlushedSize=3D13379990
> > docs/MB=3D171.863 new/old=3D27.731%
> > IFD [CrawlThread]: now checkpoint "segments_1" [1 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: now checkpoint "segments_1" [1 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: delete "_0.fnm"
> > IFD [CrawlThread]: delete "_0.frq"
> > IFD [CrawlThread]: delete "_0.prx"
> > IFD [CrawlThread]: delete "_0.tis"
> > IFD [CrawlThread]: delete "_0.tii"
> > IFD [CrawlThread]: delete "_0.nrm"
> > IW 0 [CrawlThread]: LMP: findMerges: 1 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 1 segments
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D0.044 vs
> > trigger=3D16 allocMB=3D46.015 vs trigger=3D16.8 =
byteBlockFree=3D12.438
> > charBlockFree=3D8.969
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D30.841 =
usedMB=3D0.044
> > allocMB=3D15.173
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D6.806 vs
> > trigger=3D16 allocMB=3D16.829 vs trigger=3D16.8 =
byteBlockFree=3D0.812
> > charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.656 =
usedMB=3D6.806
> > allocMB=3D15.173
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D9.242 vs
> > trigger=3D16 allocMB=3D16.861 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.687 =
usedMB=3D9.242
> > allocMB=3D15.174
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D43.339 vs
> > trigger=3D16 allocMB=3D43.401 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set =
bufferIsFull
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 =
usedMB=3D43.339
> > allocMB=3D43.401
> > IW 0 [CrawlThread]: =A0 flush: segment=3D_1 docStoreSegment=3D_0
> > docStoreOffset=3D2193 flushDocs=3Dtrue flushDeletes=3Dfalse
> flushDocStores=3Dfalse
> > numDocs=3D1799 numBufDelTerms=3D0
> > IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0
> > IW 0 [CrawlThread]: DW: flush postings as segment _1 numDocs=3D1799
> > IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D45444096 =
newFlushedSize=3D12691373
> > docs/MB=3D148.635 new/old=3D27.927%
> > IFD [CrawlThread]: now checkpoint "segments_1" [2 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: now checkpoint "segments_1" [2 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: delete "_1.fnm"
> > IFD [CrawlThread]: delete "_1.frq"
> > IFD [CrawlThread]: delete "_1.prx"
> > IFD [CrawlThread]: delete "_1.tis"
> > IFD [CrawlThread]: delete "_1.tii"
> > IFD [CrawlThread]: delete "_1.nrm"
> > IW 0 [CrawlThread]: LMP: findMerges: 2 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 2 segments
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D0.044 vs
> > trigger=3D16 allocMB=3D43.401 vs trigger=3D16.8 =
byteBlockFree=3D11.781
> > charBlockFree=3D8.469
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D28.217 =
usedMB=3D0.044
> > allocMB=3D15.185
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D40.889 vs
> > trigger=3D16 allocMB=3D40.951 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set =
bufferIsFull
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 =
usedMB=3D40.889
> > allocMB=3D40.951
> > IW 0 [CrawlThread]: =A0 flush: segment=3D_2 docStoreSegment=3D_0
> > docStoreOffset=3D3992 flushDocs=3Dtrue flushDeletes=3Dfalse
> flushDocStores=3Dfalse
> > numDocs=3D1013 numBufDelTerms=3D0
> > IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> > IW 0 [CrawlThread]: DW: flush postings as segment _2 numDocs=3D1013
> > IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D42874880 =
newFlushedSize=3D11684845
> > docs/MB=3D90.905 new/old=3D27.253%
> > IFD [CrawlThread]: now checkpoint "segments_1" [3 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: now checkpoint "segments_1" [3 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: delete "_2.fnm"
> > IFD [CrawlThread]: delete "_2.frq"
> > IFD [CrawlThread]: delete "_2.prx"
> > IFD [CrawlThread]: delete "_2.tis"
> > IFD [CrawlThread]: delete "_2.tii"
> > IFD [CrawlThread]: delete "_2.nrm"
> > IW 0 [CrawlThread]: LMP: findMerges: 3 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 3 segments
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D0.044 vs
> > trigger=3D16 allocMB=3D40.951 vs trigger=3D16.8 =
byteBlockFree=3D10.688
> > charBlockFree=3D8.062
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D25.779 =
usedMB=3D0.044
> > allocMB=3D15.172
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D38.82 vs
> > trigger=3D16 allocMB=3D38.883 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set =
bufferIsFull
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 =
usedMB=3D38.82
> > allocMB=3D38.883
> > IW 0 [CrawlThread]: =A0 flush: segment=3D_3 docStoreSegment=3D_0
> > docStoreOffset=3D5005 flushDocs=3Dtrue flushDeletes=3Dfalse
> flushDocStores=3Dfalse
> > numDocs=3D427 numBufDelTerms=3D0
> > IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> > _2:c1013->_0
> > IW 0 [CrawlThread]: DW: flush postings as segment _3 numDocs=3D427
> > IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D40706048 =
newFlushedSize=3D10574425
> > docs/MB=3D42.342 new/old=3D25.978%
> > IFD [CrawlThread]: now checkpoint "segments_1" [4 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: now checkpoint "segments_1" [4 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: delete "_3.fnm"
> > IFD [CrawlThread]: delete "_3.frq"
> > IFD [CrawlThread]: delete "_3.prx"
> > IFD [CrawlThread]: delete "_3.tis"
> > IFD [CrawlThread]: delete "_3.tii"
> > IFD [CrawlThread]: delete "_3.nrm"
> > IW 0 [CrawlThread]: LMP: findMerges: 4 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 4 segments
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D0.044 vs
> > trigger=3D16 allocMB=3D38.883 vs trigger=3D16.8 =
byteBlockFree=3D9.312
> > charBlockFree=3D7.812
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D23.686 =
usedMB=3D0.044
> > allocMB=3D15.197
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D8.588 vs
> > trigger=3D16 allocMB=3D16.822 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.625 =
usedMB=3D8.588
> > allocMB=3D15.197
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D16.15 vs
> > trigger=3D16 allocMB=3D19.51 vs trigger=3D16.8 byteBlockFree=3D0 =
charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set =
bufferIsFull
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D3.297 =
usedMB=3D16.15
> > allocMB=3D16.213
> > IW 0 [CrawlThread]: =A0 flush: segment=3D_4 docStoreSegment=3D_0
> > docStoreOffset=3D5432 flushDocs=3Dtrue flushDeletes=3Dfalse
> flushDocStores=3Dfalse
> > numDocs=3D1145 numBufDelTerms=3D0
> > IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> > _2:c1013->_0 _3:c427->_0
> > IW 0 [CrawlThread]: DW: flush postings as segment _4 numDocs=3D1145
> > IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D16934912 =
newFlushedSize=3D5040651
> > docs/MB=3D238.187 new/old=3D29.765%
> > IFD [CrawlThread]: now checkpoint "segments_1" [5 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: now checkpoint "segments_1" [5 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: delete "_4.fnm"
> > IFD [CrawlThread]: delete "_4.frq"
> > IFD [CrawlThread]: delete "_4.prx"
> > IFD [CrawlThread]: delete "_4.tis"
> > IFD [CrawlThread]: delete "_4.tii"
> > IFD [CrawlThread]: delete "_4.nrm"
> > IW 0 [CrawlThread]: LMP: findMerges: 5 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 5 segments
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D45.533 vs
> > trigger=3D16 allocMB=3D45.596 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set =
bufferIsFull
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 =
usedMB=3D45.533
> > allocMB=3D45.596
> > IW 0 [CrawlThread]: =A0 flush: segment=3D_5 docStoreSegment=3D_0
> > docStoreOffset=3D6577 flushDocs=3Dtrue flushDeletes=3Dfalse
> flushDocStores=3Dfalse
> > numDocs=3D808 numBufDelTerms=3D0
> > IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> > _2:c1013->_0 _3:c427->_0 _4:c1145->_0
> > IW 0 [CrawlThread]: DW: flush postings as segment _5 numDocs=3D808
> > IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D47745024 =
newFlushedSize=3D12761396
> > docs/MB=3D66.392 new/old=3D26.728%
> > IFD [CrawlThread]: now checkpoint "segments_1" [6 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: now checkpoint "segments_1" [6 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: delete "_5.fnm"
> > IFD [CrawlThread]: delete "_5.frq"
> > IFD [CrawlThread]: delete "_5.prx"
> > IFD [CrawlThread]: delete "_5.tis"
> > IFD [CrawlThread]: delete "_5.tii"
> > IFD [CrawlThread]: delete "_5.nrm"
> > IW 0 [CrawlThread]: LMP: findMerges: 6 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.37646 to 7.12646: 6 segments
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D0.044 vs
> > trigger=3D16 allocMB=3D45.596 vs trigger=3D16.8 byteBlockFree=3D11.5
> > charBlockFree=3D9.031
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D30.404 =
usedMB=3D0.044
> > allocMB=3D15.192
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D7.051 vs
> > trigger=3D16 allocMB=3D16.848 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.656 =
usedMB=3D7.051
> > allocMB=3D15.192
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D9.829 vs
> > trigger=3D16 allocMB=3D16.942 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.75 =
usedMB=3D9.829
> > allocMB=3D15.192
> > IW 0 [CrawlThread]: hit exception adding document
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D48.622 vs
> > trigger=3D16 allocMB=3D48.685 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free; now set =
bufferIsFull
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D0 =
usedMB=3D48.622
> > allocMB=3D48.685
> > IW 0 [CrawlThread]: =A0 flush: segment=3D_6 docStoreSegment=3D_0
> > docStoreOffset=3D7385 flushDocs=3Dtrue flushDeletes=3Dfalse
> flushDocStores=3Dfalse
> > numDocs=3D1689 numBufDelTerms=3D0
> > IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> > _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0
> > IW 0 [CrawlThread]: DW: flush postings as segment _6 numDocs=3D1689
> > IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D50983936 =
newFlushedSize=3D14095657
> > docs/MB=3D125.645 new/old=3D27.647%
> > IFD [CrawlThread]: now checkpoint "segments_1" [7 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: now checkpoint "segments_1" [7 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: delete "_6.fnm"
> > IFD [CrawlThread]: delete "_6.frq"
> > IFD [CrawlThread]: delete "_6.prx"
> > IFD [CrawlThread]: delete "_6.tis"
> > IFD [CrawlThread]: delete "_6.tii"
> > IFD [CrawlThread]: delete "_6.nrm"
> > IW 0 [CrawlThread]: LMP: findMerges: 7 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 7 segments
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D0.044 vs
> > trigger=3D16 allocMB=3D48.685 vs trigger=3D16.8 =
byteBlockFree=3D12.969
> > charBlockFree=3D9.594
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D33.498 =
usedMB=3D0.044
> > allocMB=3D15.187
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D7.007 vs
> > trigger=3D16 allocMB=3D16.812 vs trigger=3D16.8 =
byteBlockFree=3D0.281
> > charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.625 =
usedMB=3D7.007
> > allocMB=3D15.187
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D9.254 vs
> > trigger=3D16 allocMB=3D16.812 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.625 =
usedMB=3D9.254
> > allocMB=3D15.188
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D11.913 vs
> > trigger=3D16 allocMB=3D16.844 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.656 =
usedMB=3D11.913
> > allocMB=3D15.188
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D14.566 vs
> > trigger=3D16 allocMB=3D16.813 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.625 =
usedMB=3D14.566
> > allocMB=3D15.189
> > IW 0 [CrawlThread]: DW: =A0 RAM: now flush @ usedMB=3D16.151 =
allocMB=3D16.214
> > triggerMB=3D16
> > IW 0 [CrawlThread]: =A0 flush: segment=3D_7 docStoreSegment=3D_0
> > docStoreOffset=3D9074 flushDocs=3Dtrue flushDeletes=3Dfalse
> flushDocStores=3Dfalse
> > numDocs=3D2941 numBufDelTerms=3D0
> > IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> > _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0
> > IW 0 [CrawlThread]: DW: flush postings as segment _7 numDocs=3D2941
> > IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D16935936 =
newFlushedSize=3D5920901
> > docs/MB=3D520.843 new/old=3D34.961%
> > IFD [CrawlThread]: now checkpoint "segments_1" [8 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: now checkpoint "segments_1" [8 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: delete "_7.fnm"
> > IFD [CrawlThread]: delete "_7.frq"
> > IFD [CrawlThread]: delete "_7.prx"
> > IFD [CrawlThread]: delete "_7.tis"
> > IFD [CrawlThread]: delete "_7.tii"
> > IFD [CrawlThread]: delete "_7.nrm"
> > IW 0 [CrawlThread]: LMP: findMerges: 8 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 8 segments
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D14.513 vs
> > trigger=3D16 allocMB=3D16.808 vs trigger=3D16.8 byteBlockFree=3D0
> charBlockFree=3D0.75
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.625 =
usedMB=3D14.513
> > allocMB=3D15.183
> > IW 0 [CrawlThread]: DW: =A0 RAM: now flush @ usedMB=3D16.057 =
allocMB=3D16.277
> > triggerMB=3D16
> > IW 0 [CrawlThread]: =A0 flush: segment=3D_8 docStoreSegment=3D_0
> > docStoreOffset=3D12015 flushDocs=3Dtrue flushDeletes=3Dfalse
> flushDocStores=3Dfalse
> > numDocs=3D3171 numBufDelTerms=3D0
> > IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> > _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 =
_7:c2941-
> >_0
> > IW 0 [CrawlThread]: DW: flush postings as segment _8 numDocs=3D3171
> > IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D16836608 =
newFlushedSize=3D7011110
> > docs/MB=3D474.252 new/old=3D41.642%
> > IFD [CrawlThread]: now checkpoint "segments_1" [9 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: now checkpoint "segments_1" [9 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: delete "_8.fnm"
> > IFD [CrawlThread]: delete "_8.frq"
> > IFD [CrawlThread]: delete "_8.prx"
> > IFD [CrawlThread]: delete "_8.tis"
> > IFD [CrawlThread]: delete "_8.tii"
> > IFD [CrawlThread]: delete "_8.nrm"
> > IW 0 [CrawlThread]: LMP: findMerges: 9 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 9 segments
> > IW 0 [CrawlThread]: DW: =A0 RAM: now balance allocations: =
usedMB=3D15.678 vs
> > trigger=3D16 allocMB=3D17.178 vs trigger=3D16.8 =
byteBlockFree=3D1.438
> > charBlockFree=3D0
> > IW 0 [CrawlThread]: DW: =A0 =A0 nothing to free
> > IW 0 [CrawlThread]: DW: =A0 =A0 after free: freedMB=3D1.438 =
usedMB=3D15.678
> > allocMB=3D15.74
> > IW 0 [CrawlThread]: DW: =A0 RAM: now flush @ usedMB=3D16.067 =
allocMB=3D16.13
> > triggerMB=3D16
> > IW 0 [CrawlThread]: =A0 flush: segment=3D_9 docStoreSegment=3D_0
> > docStoreOffset=3D15186 flushDocs=3Dtrue flushDeletes=3Dfalse
> flushDocStores=3Dfalse
> > numDocs=3D3401 numBufDelTerms=3D0
> > IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> > _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 =
_7:c2941-
> >_0
> > _8:c3171->_0
> > IW 0 [CrawlThread]: DW: flush postings as segment _9 numDocs=3D3401
> > IW 0 [CrawlThread]: DW: =A0 oldRAMSize=3D16847872 =
newFlushedSize=3D6184635
> > docs/MB=3D576.624 new/old=3D36.709%
> > IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: delete "_9.fnm"
> > IFD [CrawlThread]: delete "_9.frq"
> > IFD [CrawlThread]: delete "_9.prx"
> > IFD [CrawlThread]: delete "_9.tis"
> > IFD [CrawlThread]: delete "_9.tii"
> > IFD [CrawlThread]: delete "_9.nrm"
> > IW 0 [CrawlThread]: LMP: findMerges: 10 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 10 segments
> > IW 0 [CrawlThread]: LMP: =A0 =A0 0 to 10: add this merge
> > IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 =
_1:c1799-
> >_0
> > _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 =
_7:c2941-
> >_0
> > _8:c3171->_0 _9:c3401->_0 [total 1 pending]
> > IW 0 [CrawlThread]: DW: apply 0 buffered deleted terms and 1 deleted
> docIDs
> > and 0 deleted queries on 10 segments.
> > IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; =
isCommit =3D
> > false]
> > IW 0 [CrawlThread]: now flush at merge
> > IW 0 [CrawlThread]: =A0 flush: segment=3Dnull docStoreSegment=3D_0
> > docStoreOffset=3D18587 flushDocs=3Dfalse flushDeletes=3Dfalse
> flushDocStores=3Dtrue
> > numDocs=3D0 numBufDelTerms=3D0
> > IW 0 [CrawlThread]: =A0 index before flush _0:c2193->_0 _1:c1799->_0
> > _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 =
_7:c2941-
> >_0
> > _8:c3171->_0 _9:c3401->_0
> > IW 0 [CrawlThread]: =A0 flush shared docStore segment _0
> > IW 0 [CrawlThread]: DW: closeDocStore: 2 files to flush to segment =
_0
> > numDocs=3D18587
> > IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; =
isCommit =3D
> > false]
> > IFD [CrawlThread]: delete "_0.fdt"
> > IFD [CrawlThread]: delete "_0.fdx"
> > IFD [CrawlThread]: delete "_0.fdt"
> > IFD [CrawlThread]: delete "_0.fdx"
> > IW 0 [CrawlThread]: now merge
> > =A0merge=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 =
_4:c1145->_0
> > _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into =
_a
> > =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@b590b98
> > =A0index=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 =
_4:c1145->_0
> > _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
> > IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
> > _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 =
_8:c3171-
> >_0
> > _9:c3401->_0 into _a
> > IW 0 [CrawlThread]: merge: total 18586 docs
> > IW 0 [CrawlThread]: LMP: findMerges: 10 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 10 segments
> > IW 0 [CrawlThread]: LMP: =A0 =A0 0 to 10: add this merge
> > IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 =
_1:c1799-
> >_0
> > _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 =
_7:c2941-
> >_0
> > _8:c3171->_0 _9:c3401->_0 [total 1 pending]
> > IW 0 [CrawlThread]: now merge
> > =A0merge=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 =
_4:c1145->_0
> > _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into =
_b
> > =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@b590658
> > =A0index=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 =
_4:c1145->_0
> > _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
> > IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
> > _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 =
_8:c3171-
> >_0
> > _9:c3401->_0 into _b
> > IW 0 [CrawlThread]: merge: total 18586 docs
> > IW 0 [CrawlThread]: LMP: findMerges: 10 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 10 segments
> > IW 0 [CrawlThread]: LMP: =A0 =A0 0 to 10: add this merge
> > IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 =
_1:c1799-
> >_0
> > _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 =
_7:c2941-
> >_0
> > _8:c3171->_0 _9:c3401->_0 [total 1 pending]
> > IW 0 [CrawlThread]: now merge
> > =A0merge=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 =
_4:c1145->_0
> > _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into =
_c
> > =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@b5906b8
> > =A0index=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 =
_4:c1145->_0
> > _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
> > IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
> > _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 =
_8:c3171-
> >_0
> > _9:c3401->_0 into _c
> > IW 0 [CrawlThread]: merge: total 18586 docs
> > IW 0 [CrawlThread]: LMP: findMerges: 10 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 10 segments
> > IW 0 [CrawlThread]: LMP: =A0 =A0 0 to 10: add this merge
> > IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 =
_1:c1799-
> >_0
> > _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 =
_7:c2941-
> >_0
> > _8:c3171->_0 _9:c3401->_0 [total 1 pending]
> > IW 0 [CrawlThread]: now merge
> > =A0merge=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 =
_4:c1145->_0
> > _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into =
_d
> > =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@b5906e8
> > =A0index=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 =
_4:c1145->_0
> > _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
> > IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
> > _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 =
_8:c3171-
> >_0
> > _9:c3401->_0 into _d
> > IW 0 [CrawlThread]: merge: total 18586 docs
> > IW 0 [CrawlThread]: LMP: findMerges: 10 segments
> > IW 0 [CrawlThread]: LMP: =A0 level 6.39909 to 7.14909: 10 segments
> > IW 0 [CrawlThread]: LMP: =A0 =A0 0 to 10: add this merge
> > IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 =
_1:c1799-
> >_0
> > _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 =
_7:c2941-
> >_0
> > _8:c3171->_0 _9:c3401->_0 [total 1 pending]
> > IW 0 [CrawlThread]: now merge
> > =A0merge=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 =
_4:c1145->_0
> > _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into =
_e
> > =A0merge=3Dorg.apache.lucene.index.MergePolicy$OneMerge@b590688
> > =A0index=3D_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 =
_4:c1145->_0
> > _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
> > .......
> >
> >
> >
> > =
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39717-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 14:09:24 2009
Return-Path: <java-user-return-39717-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50340 invoked from network); 14 Apr 2009 14:09:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 14:09:24 -0000
Received: (qmail 27320 invoked by uid 500); 14 Apr 2009 14:09:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27274 invoked by uid 500); 14 Apr 2009 14:09:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27264 invoked by uid 99); 14 Apr 2009 14:09:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 14:09:21 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of gshackles@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 14:09:12 +0000
Received: by ewy27 with SMTP id 27so2818390ewy.5
        for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 07:08:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=twiLWR2KJ8qFi2I3Kve2ufO6XXHMfxTNyUqGSkyaCX0=;
        b=hrglh834GnoKaU/LyyIxiDqacGUlrIxewyatPlf292yrO6Uj6ZxY/LufXJd889TLWx
         DhVezuuj8mYHGtWG9SDB5gX2WsHqoCuDvL4TuKWlTnmjVHA3Pete1qMLmwDcusL3nwRp
         rWVeROS0GvvEgk0QFgJ0g36ZKfaaHUDSspPLs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=i9sT5vnr0DNsD23yI4Xbn8KVPeAOkSsufKVsX1lwzWg9iz3o/lS6bh+LBbpMyi92Oq
         AE607c38pi2uGIgJGfAFsY0u0XSof15jhQgwFnWPy9nXyNZCIZttQqADOM4h0zTBE9st
         n9RLMxEC3gdVbNC5kyfXiWOvE1udPgtEe9rBQ=
MIME-Version: 1.0
Received: by 10.210.10.8 with SMTP id 8mr2979584ebj.7.1239718131019; Tue, 14 
	Apr 2009 07:08:51 -0700 (PDT)
In-Reply-To: <5e76f3840904131549t694b1aaay51f83ead5bf979a0@mail.gmail.com>
References: <d0f5cc130904131127y53d65b75k2d629f8b24ae131d@mail.gmail.com>
	 <5e76f3840904131549t694b1aaay51f83ead5bf979a0@mail.gmail.com>
Date: Tue, 14 Apr 2009 10:08:50 -0400
Message-ID: <b63a7e9e0904140708l132fdcabk9114a713ac80e1fc@mail.gmail.com>
Subject: Re: New tool: LSql
From: Greg Shackles <gshackles@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174bde46d2302f0467845ef3
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174bde46d2302f0467845ef3
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

This could be very useful.  I see you include Lucene v2.3 in your
code...does it work correctly with indexes created on v2.4 as well?
- Greg


On Mon, Apr 13, 2009 at 6:49 PM, Glen Newton <glen.newton@gmail.com> wrote:

> As the creator of LuSql
> [http://lab.cisti-icist.nrc-cnrc.gc.ca/cistilabswiki/index.php/LuSql]
> I would have hoped for a more creative (and more different) name.
> :-)
>
> -glen
>
> 2009/4/13 jonathan esposito <jonathan.espo@gmail.com>:
> > I created a command-line tool in Java that allows the user to execute
> > sql-like commands against a lucene index.  This is useful for
> > automating Lucene index migrations without writing any code.
> > Essentially, you can treat a Lucene index the same as you would a
> > database.  For example, you can write:
> >
> > UPDATE field1=newvalue WHERE +field1:oldvalue
> >
> > Or you can simply view data by using the SELECT command:
> >
> > SELECT field1,field2 WHERE +field1:value
> >
> > You are welcome to visit the project here:
> > http://code.google.com/p/lucene-sql/.  Any contributions or
> > suggestions would be greatly appreciated.  I will make an effort to
> > provide more documentation shortly.
> >
> > Thanks,
> > Jonathan Esposito
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
>
> --
>
> -
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174bde46d2302f0467845ef3--

From java-user-return-39718-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 14:22:58 2009
Return-Path: <java-user-return-39718-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67147 invoked from network); 14 Apr 2009 14:22:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 14:22:55 -0000
Received: (qmail 49381 invoked by uid 500); 14 Apr 2009 14:22:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49325 invoked by uid 500); 14 Apr 2009 14:22:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49315 invoked by uid 99); 14 Apr 2009 14:22:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 14:22:52 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nitdaiict8@gmail.com designates 209.85.221.134 as permitted sender)
Received: from [209.85.221.134] (HELO mail-qy0-f134.google.com) (209.85.221.134)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 14:22:46 +0000
Received: by qyk40 with SMTP id 40so1107806qyk.29
        for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 07:22:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=2qpDvlG59NEqOB1lsnewjo7aJv74tE9kQdA7rCh4k1c=;
        b=T6dIbDvL93q9evgYJgUzJz/HyHw2tOQdPsiqeoM7FIIjI6fNdG0dO9DEh3heZWRgyZ
         b2I1KRSWfCpTcBf67mdIwLz1oDBO+YQBaKvI0y3vQXnqU9NjUxzftRRjKG2a5aeLSa+X
         wmFv5O6H+n2F7UWXbLDIA1TToyt3G6dIypEn0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=YvKPns3cV5QGcYCcGUEgSpQgnhKh1TaYB3jZAqGo+ltmDtpSWx8rfjBvZh4OfrqxEW
         Y+ixRAjxrS5/yC1n/0xDH+KAxUusi6qqbrqmvZ9iD8NWNUUnDPs1Ctam/UOjV2gA2tHv
         cMXmC9o9aE823bP8aV2ZtmkZ03T4QLqjoET5Q=
MIME-Version: 1.0
Received: by 10.220.77.18 with SMTP id e18mr7956984vck.85.1239718942896; Tue, 
	14 Apr 2009 07:22:22 -0700 (PDT)
Date: Tue, 14 Apr 2009 19:52:22 +0530
Message-ID: <7284f6e20904140722o5e9d44cdhc4a695dfd9bbce37@mail.gmail.com>
Subject: lsa on term document vector matrix
From: nitin gopi <nitdaiict8@gmail.com>
To: java-user <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=0016e64ec0ca36d6540467848f4f
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64ec0ca36d6540467848f4f
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

hi all,
Can somebody help me to figure out how can I use  "jama svd package" to
apply LSA to the "term document vector" produced by lucene?

Yours Sincerely,
Nitin

--0016e64ec0ca36d6540467848f4f--

From java-user-return-39719-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 14:53:16 2009
Return-Path: <java-user-return-39719-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94897 invoked from network); 14 Apr 2009 14:53:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 14:53:16 -0000
Received: (qmail 1276 invoked by uid 500); 14 Apr 2009 14:53:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1195 invoked by uid 500); 14 Apr 2009 14:53:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1177 invoked by uid 99); 14 Apr 2009 14:53:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 14:53:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of glen.newton@gmail.com designates 74.125.46.31 as permitted sender)
Received: from [74.125.46.31] (HELO yw-out-2324.google.com) (74.125.46.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 14:53:02 +0000
Received: by yw-out-2324.google.com with SMTP id 9so1392541ywe.5
        for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 07:52:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=B3T8DLwbILKpioUIuULE+AaQqQDa1KwvikIWFklERes=;
        b=FmW1OyXwWDi98+TXKOKk9dugKkBhIcqAu9fNVhDf8rbLpYm1IX1KV5kZgOaTvomsuT
         DXXMFK10/giBUNhO0i1of/nWpPKSamb+50KxTCMJs7Jx62ntEZVVSRW3YyJDurw7bu4A
         chECyS6sDLihEEDfXspRGbJPzpkMEeVJlRTao=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=M1g6/XrcN1IoXGFNdR0+mxEZ8HKecTnTmKwIffKu1wIVb8HnggnklwjeNEGcypEv+7
         PeR2AwvanBqaCSzuUTJoGWYXt5KcNHLlK+knN2JCJO464KJNjFks1LU/TzWu6AggVOJK
         yYo0Te3FZIgbZsZ06Clx3WShWFRwLs+uHJHPw=
MIME-Version: 1.0
Received: by 10.100.8.17 with SMTP id 17mr10621801anh.7.1239720761883; Tue, 14 
	Apr 2009 07:52:41 -0700 (PDT)
In-Reply-To: <b63a7e9e0904140708l132fdcabk9114a713ac80e1fc@mail.gmail.com>
References: <d0f5cc130904131127y53d65b75k2d629f8b24ae131d@mail.gmail.com>
	 <5e76f3840904131549t694b1aaay51f83ead5bf979a0@mail.gmail.com>
	 <b63a7e9e0904140708l132fdcabk9114a713ac80e1fc@mail.gmail.com>
Date: Tue, 14 Apr 2009 10:52:41 -0400
Message-ID: <5e76f3840904140752o66b3d93cr86e4508729dfc999@mail.gmail.com>
Subject: Re: New tool: LSql
From: Glen Newton <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

LuSql 0.9 comes with Lucene 2.3.1 bundled in the jar (along with
commons-cli-1.1, commons-dbcp-1.2.2, commons-pool-1.4,
mysql-connector-java-5.0.7).

It can run with Lucene 2.4:
If you want to run using Lucene 2.4, put all the above jars in your
classpath, along with the 2.4 jar, run LuSql not using "-jar" but
using the full classpath of: ca.nrc.cisti.lusql.core.LuSqlMain

Let me know if you have any problems.

The next version of LuSql will include the latest stable Lucene
release, in a month or so.

thanks,

Glen

2009/4/14 Greg Shackles <gshackles@gmail.com>:
> This could be very useful.  I see you include Lucene v2.3 in your
> code...does it work correctly with indexes created on v2.4 as well?
> - Greg
>
>
> On Mon, Apr 13, 2009 at 6:49 PM, Glen Newton <glen.newton@gmail.com> wrote:
>
>> As the creator of LuSql
>> [http://lab.cisti-icist.nrc-cnrc.gc.ca/cistilabswiki/index.php/LuSql]
>> I would have hoped for a more creative (and more different) name.
>> :-)
>>
>> -glen
>>
>> 2009/4/13 jonathan esposito <jonathan.espo@gmail.com>:
>> > I created a command-line tool in Java that allows the user to execute
>> > sql-like commands against a lucene index.  This is useful for
>> > automating Lucene index migrations without writing any code.
>> > Essentially, you can treat a Lucene index the same as you would a
>> > database.  For example, you can write:
>> >
>> > UPDATE field1=newvalue WHERE +field1:oldvalue
>> >
>> > Or you can simply view data by using the SELECT command:
>> >
>> > SELECT field1,field2 WHERE +field1:value
>> >
>> > You are welcome to visit the project here:
>> > http://code.google.com/p/lucene-sql/.  Any contributions or
>> > suggestions would be greatly appreciated.  I will make an effort to
>> > provide more documentation shortly.
>> >
>> > Thanks,
>> > Jonathan Esposito
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>>
>>
>> --
>>
>> -
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>



-- 

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39720-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 16:13:36 2009
Return-Path: <java-user-return-39720-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34676 invoked from network); 14 Apr 2009 16:13:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 16:13:35 -0000
Received: (qmail 21884 invoked by uid 500); 14 Apr 2009 16:13:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21800 invoked by uid 500); 14 Apr 2009 16:13:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21790 invoked by uid 99); 14 Apr 2009 16:13:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 16:13:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 16:13:24 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LtlFv-0003Yf-Ox
	for java-user@lucene.apache.org; Tue, 14 Apr 2009 09:13:03 -0700
Message-ID: <23042596.post@talk.nabble.com>
Date: Tue, 14 Apr 2009 09:13:03 -0700 (PDT)
From: Sam Hough <sam@redspr.com>
To: java-user@lucene.apache.org
Subject: Re: Self Join Query
In-Reply-To: <359a92830801080704l403ad5dfhc884c92288009093@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sam@redspr.com
References: <1199794981.3156.79.camel@localhost.localdomain> <359a92830801080704l403ad5dfhc884c92288009093@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Bit late joining in but since this is the first Google hit for
"site:www.nabble.com joins lucene" thought it was reasonable place to add
this note:

In my application "joins" also start to seem appealing. Almost all my use
cases fit very nicely within what Lucene does apart from a "nice to have" ad
hoc query tool. Here it becomes difficult to "join" the result of queries.

I think the source of this difficulty is that while you can very efficiently
get the two lists of document numbers for matching As and Bs (to use the
original posters example) there is no, obvious, quick way to join the two.
Since document numbers change it would be painful to maintain an external
index.

I started my application years ago before any real full text searching in
postgres etc. Now I'm a bit addicted to how light and fast Lucene on its own
is.


Erick Erickson wrote:
> 
> It's often a mistake to try to force Lucene to act like a database. Is it
> possible to just use the database for the join portion and Lucene
> for the text search?
> 
> Otherwise I agree with Developer Developer. You need to provide
> a higher level idea of *what* it is you're trying to accomplish to get
> good suggestions.
> 
> Best
> Erick
> 
> On Jan 8, 2008 7:23 AM, sachin <sachin.singhal@naukri.com> wrote:
> 
>>
>> I need to write lucene query something similar to SQL self joins.
>>
>> My current implementation is very primitive. I fire first query, get the
>> results, based on the result of first query I fire second query and then
>> merge the results from both the queries. The whole processing is very
>> expensive. Doing this is very easy with SQL query as we need to just
>> write self join query and database do the rest for you.
>>
>> What is the best way of implementing the above functionality in lucene?
>>
>> Regards
>> Sachin
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Self-Join-Query-tp14688526p23042596.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39721-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 18:19:24 2009
Return-Path: <java-user-return-39721-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4794 invoked from network); 14 Apr 2009 18:19:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 18:19:24 -0000
Received: (qmail 34620 invoked by uid 500); 14 Apr 2009 18:19:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34538 invoked by uid 500); 14 Apr 2009 18:19:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 26580 invoked by uid 99); 14 Apr 2009 18:13:03 -0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: Binary indexing / query efficiency
Date: Tue, 14 Apr 2009 11:12:34 -0700
Message-ID: <1CFD7891521AAB4E8201FB7A78C9D36FCE30AD@mail-001.corp.automotive.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Binary indexing / query efficiency
Thread-Index: Acm9LJY14wmQ1/opRbWwjUVYv4/Eaw==
From: "Eger, Patrick" <peger@automotive.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi, was recently looking to incorporate Lucene for a simple
"parametric"/"faceted" type search.  The documents are very small,
roughly 15 fields of short length (5-15 characters, generally strings
and padded integers). When profiling query performance of our
application, which inserts 1 million documents then
 1) filters on 1-3 fields with simple boolean/term matches
 2) stores these docids in a BitSet
 3) calls IndexSearcher.doc() to retrieve all matching documents (all
fields, 100 - 1,000,000 results per call)

It turns out that 98% of the query time was spent not actually doing the
query, but within the IndexSearcher.doc() call.

My first question is, is there any way to more efficiently get
(all/most) of the fields for a set of documents, other than iterating
and calling doc()?

Additionally, is there any way (or planned feature) to index *binary*
data? Using a profiler, I have determined that String decoding is a
significant performance limiter for my use-case:

90% of the application time is spent in this method:
---------------------------------------
org.apache.lucene.index.FieldsReader.addField(Document, FieldInfo,
boolean, boolean, boolean)


46% of the application time is spent decoding strings (half of the above
addField() time):
---------------------------------------org.apache.lucene.store.IndexInpu
t.readString()
	java.lang.String.<init>(byte[], int, int, String)
		java.lang.StringCoding.decode(String, byte[], int, int)
=09
java.lang.StringCoding$StringDecoder.decode(byte[], int, int)

(YJP profiler output available if needed)

String.intern() was my top hot spot, but my patch was accepted and fixed
this: https://issues.apache.org/jira/browse/LUCENE-1600. I'm not
familiar enough with the lucene codebase to figure out the above though,
so thought I would ask.



//ideally i'd be able to do add a binary field as such:
doc.add(new Field("f1",new
byte[]{1,2,3,4},Field.Store.YES,Field.Index.NOT_ANALYZED_NO_NORMS));

//then query like:
Query q =3D new TermQuery(new Term("f1",byte[]{1,2,3,4}))
searcher.search(q,...);

Which would allow me to avoid the Integer -> String -> Padded String ->
String -> Integer coding/decoding to index an integer, and avoid Object
-> String -> Object conversion (which per above is quite expensive).=20


Thanks for any help!


Regards,=20

Patrick

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39722-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 22:40:48 2009
Return-Path: <java-user-return-39722-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18465 invoked from network); 14 Apr 2009 22:40:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 22:40:48 -0000
Received: (qmail 21953 invoked by uid 500); 14 Apr 2009 22:40:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21900 invoked by uid 500); 14 Apr 2009 22:40:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21890 invoked by uid 99); 14 Apr 2009 22:40:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 22:40:45 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ksshams@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 22:40:38 +0000
Received: by qw-out-2122.google.com with SMTP id 8so2032406qwh.53
        for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 15:40:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=aaN7Hq8qY/DTPwjesHKny9StcQoOuwa8iKkwiTvxkeo=;
        b=oBUKIwBWa9ElkLT20rcyD/MZrGMpChU61kFCm2Tg2jOJw6fhzFmICq9GxG0NFoumL1
         e8/c0R1UiZ2aMzs1cv/uPiz+lRtQNgiPKAv+Qa0IQl/t51+jX4csnA8LlpEzWjmFkFiS
         QXUI9IGC+4Tl1hhoJgynFrvtBvvYZaKMjJGXA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=dYaNjMzuv1rDjXGgdTWkxX+pNjgoGhX8Cx41dyhLM888DDjxjlixf25zNrX2gQyb4Z
         Mnhhn14oF9mDiRu3cDTV8gfP3nGiyKYrEEaDIbltS9jOVc1mNdDLMPv0fK5SaX2Jwj3g
         XfRUcH3pwyoiwrBs5huOaT2BJU7c+HwHxeQnw=
MIME-Version: 1.0
Received: by 10.229.97.194 with SMTP id m2mr2251722qcn.21.1239748817702; Tue, 
	14 Apr 2009 15:40:17 -0700 (PDT)
In-Reply-To: <1CFD7891521AAB4E8201FB7A78C9D36FCE30AD@mail-001.corp.automotive.com>
References: <1CFD7891521AAB4E8201FB7A78C9D36FCE30AD@mail-001.corp.automotive.com>
Date: Tue, 14 Apr 2009 15:40:17 -0700
Message-ID: <6d6cf45b0904141540y5a0a6324me3411ecaddefb7bc@mail.gmail.com>
Subject: Re: Binary indexing / query efficiency
From: Khawaja Shams <ksshams@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016368324eae3d20304678b830f
X-Virus-Checked: Checked by ClamAV on apache.org

--0016368324eae3d20304678b830f
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,
  It is not a good idea to extract each document. You can be more efficient
by only looking at the fields you are interested in. Depending on the size
of your index, you can try:

String[] codes = FieldCache.DEFAULT.getStrings(indexReader, fieldName);


This returns a string [] with the length being the number of documents in
your index. If you are doing faceted searching, you may want to try:

StringIndex stringIndex = FieldCache.DEFAULT.getStringIndex(indexReader,
fieldName);

The StringIndex class has a lookup array and an order array. The order array
contains a value for each document id, and you can use this value to extract
the string from the lookup array once you are done counting.


Perhaps the Lucene experts can shed light on a better approach.

You may also want to look at SOLR for faceted searching support :). HTH.


Regards,
Khawaja Shams

On Tue, Apr 14, 2009 at 11:12 AM, Eger, Patrick <peger@automotive.com>wrote:

> Hi, was recently looking to incorporate Lucene for a simple
> "parametric"/"faceted" type search.  The documents are very small,
> roughly 15 fields of short length (5-15 characters, generally strings
> and padded integers). When profiling query performance of our
> application, which inserts 1 million documents then
>  1) filters on 1-3 fields with simple boolean/term matches
>  2) stores these docids in a BitSet
>  3) calls IndexSearcher.doc() to retrieve all matching documents (all
> fields, 100 - 1,000,000 results per call)
>
> It turns out that 98% of the query time was spent not actually doing the
> query, but within the IndexSearcher.doc() call.
>
> My first question is, is there any way to more efficiently get
> (all/most) of the fields for a set of documents, other than iterating
> and calling doc()?
>
> Additionally, is there any way (or planned feature) to index *binary*
> data? Using a profiler, I have determined that String decoding is a
> significant performance limiter for my use-case:
>
> 90% of the application time is spent in this method:
> ---------------------------------------
> org.apache.lucene.index.FieldsReader.addField(Document, FieldInfo,
> boolean, boolean, boolean)
>
>
> 46% of the application time is spent decoding strings (half of the above
> addField() time):
> ---------------------------------------org.apache.lucene.store.IndexInpu
> t.readString()
>        java.lang.String.<init>(byte[], int, int, String)
>                java.lang.StringCoding.decode(String, byte[], int, int)
>
> java.lang.StringCoding$StringDecoder.decode(byte[], int, int)
>
> (YJP profiler output available if needed)
>
> String.intern() was my top hot spot, but my patch was accepted and fixed
> this: https://issues.apache.org/jira/browse/LUCENE-1600. I'm not
> familiar enough with the lucene codebase to figure out the above though,
> so thought I would ask.
>
>
>
> //ideally i'd be able to do add a binary field as such:
> doc.add(new Field("f1",new
> byte[]{1,2,3,4},Field.Store.YES,Field.Index.NOT_ANALYZED_NO_NORMS));
>
> //then query like:
> Query q = new TermQuery(new Term("f1",byte[]{1,2,3,4}))
> searcher.search(q,...);
>
> Which would allow me to avoid the Integer -> String -> Padded String ->
> String -> Integer coding/decoding to index an integer, and avoid Object
> -> String -> Object conversion (which per above is quite expensive).
>
>
> Thanks for any help!
>
>
> Regards,
>
> Patrick
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016368324eae3d20304678b830f--

From java-user-return-39723-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 23:02:31 2009
Return-Path: <java-user-return-39723-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37945 invoked from network); 14 Apr 2009 23:02:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 23:02:30 -0000
Received: (qmail 41559 invoked by uid 500); 14 Apr 2009 23:02:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41463 invoked by uid 500); 14 Apr 2009 23:02:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41442 invoked by uid 99); 14 Apr 2009 23:02:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 23:02:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 23:02:21 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 3BEF471C396; Tue, 14 Apr 2009 16:02:01 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 3A5FB71C377
	for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 16:02:01 -0700 (PDT)
Date: Tue, 14 Apr 2009 16:02:01 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: SpellChecker AlreadyClosedException issue
In-Reply-To: <49DF092C.4000702@eworx.gr>
Message-ID: <Pine.LNX.4.64.0904141600550.25014@radix.cryptio.net>
References: <49D498F7.4090708@eworx.gr> <Pine.LNX.4.64.0904091612370.31507@radix.cryptio.net>
 <49DF092C.4000702@eworx.gr>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: dir is a local variable inside a method, so it's not getting reused.
: Should I synchronise the whole method? I think that would slow things down in
: a concurrent environment.

i don't really have any new advice beyond my previous comment...

: > if you have a fully exeuctable test case (instead of just an incomplete
: > partial snippet) that you can share, people may be able to spot the problem,
: > or at the very least run the test themselves to reproduce.

...it's hard to speculate what might be going wrong without having code 
that can reproduce it.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39724-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 23:19:10 2009
Return-Path: <java-user-return-39724-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51946 invoked from network); 14 Apr 2009 23:19:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 23:19:09 -0000
Received: (qmail 53468 invoked by uid 500); 14 Apr 2009 23:19:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53378 invoked by uid 500); 14 Apr 2009 23:19:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53368 invoked by uid 99); 14 Apr 2009 23:19:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 23:19:07 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [217.146.182.36] (HELO web27104.mail.ukl.yahoo.com) (217.146.182.36)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 14 Apr 2009 23:18:58 +0000
Received: (qmail 64397 invoked by uid 60001); 14 Apr 2009 23:18:36 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1239751116; bh=UVxXPYYttk55yjDFclmqZi1/dXIRql5mI93IDEbrPfQ=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=kXQyFwQ5kXNZXMw/hzZAGReIdIXyL2DdG4f94U+jcts1y0rU2IXrX51WWt5lxLPcQqTMxthlTKXcN5J9sqq7eheHzP5wAHfiaAFiH4KUUHQMEQyfkAeN4Y1ZKPe9o8fTZj6oUOMMuRGrOJiQrWTvekMc/Xu2fSXzSF1JnO3bqRg=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=JGDxL5CoaYtG1iOp4WUh7N1CtxqAfSQ8Oc9xm+X5VCajcHOKKZkMGIUSdv0hvZHhjrQ7nlxNCFr4e2DaW91eOqgocOHjQiwjD/XlY7Z8jdFS0m7uTh7mmmmDe+flV8YgOXFSRFWcMItaz/W4rQzzxnjdAshUkSw4XpVYAwtao8k=;
Message-ID: <802492.63679.qm@web27104.mail.ukl.yahoo.com>
X-YMail-OSG: t7EkkRoVM1lO.YASrpdAORiaF8mD71LE617wqkldO1AA0fmQuIlAORkDVljWlSGkrEuA3TsyVriRSVaCHiKYDr86ULS6XcD2e8VLLr1D7VrnohKDazlCVW_wQPDbspDlNyn.tIliFcPEzOoXTpEjij86gLqYrAMvsz_iMHrO4tml3pCNCN6FlbsCXXnGFW.X.h6sGuBUnj_tdP_nm2pu18C.WXYTNZwzF7T_RIhQ22ll6LBiJLENuSRzprvlmbclBfLzpv3dk4tCcihzGKD3WyIIkZYZKwQh4_VWb_JjrMDevovxNvEqod2soYZZKkVZsTB8S9oeFk8tRaKsLwn7xd_Qbtrx
Received: from [79.199.119.207] by web27104.mail.ukl.yahoo.com via HTTP; Tue, 14 Apr 2009 23:18:36 GMT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <1CFD7891521AAB4E8201FB7A78C9D36FCE30AD@mail-001.corp.automotive.com>
Date: Tue, 14 Apr 2009 23:18:36 +0000 (GMT)
From: eks dev <eksdev@yahoo.co.uk>
Subject: Re: Binary indexing / query efficiency
To: java-user@lucene.apache.org
In-Reply-To: <1CFD7891521AAB4E8201FB7A78C9D36FCE30AD@mail-001.corp.automotive.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org


you can store binary value?=0Ae.g. with: =0AField(String name, byte[] value=
, Field.Store store)=0A=0AYou could store all your fields as byte[], so you=
 get them back as byte[]. How you index them is just another problem, but y=
ou are having no problems with speed in your case, leave it as it is.=0A=0A=
try simply to create pairs of fields for each  field you now have, one Stor=
ed and not indexed and another  Indexed and not stored. Or Fields you use f=
or searching as only indexed, and one big byte[]  field where you encode al=
l your documents (Blob)... if complex, you could try protobuf, thrift...   =
  =0A=0AAnyhow, your idea with byte[] as indexed unit that can be searched =
unit is maybe not all that bad, but it does not look like you need it and i=
s not an easy one to change (I guess).  =0A=0A=0A----- Original Message ---=
-=0A> From: "Eger, Patrick" <peger@automotive.com>=0A> To: java-user@lucene=
.apache.org=0A> Sent: Tuesday, 14 April, 2009 20:12:34=0A> Subject: Binary =
indexing / query efficiency=0A> =0A> Hi, was recently looking to incorporat=
e Lucene for a simple=0A> "parametric"/"faceted" type search.  The document=
s are very small,=0A> roughly 15 fields of short length (5-15 characters, g=
enerally strings=0A> and padded integers). When profiling query performance=
 of our=0A> application, which inserts 1 million documents then=0A> 1) filt=
ers on 1-3 fields with simple boolean/term matches=0A> 2) stores these doci=
ds in a BitSet=0A> 3) calls IndexSearcher.doc() to retrieve all matching do=
cuments (all=0A> fields, 100 - 1,000,000 results per call)=0A> =0A> It turn=
s out that 98% of the query time was spent not actually doing the=0A> query=
, but within the IndexSearcher.doc() call.=0A> =0A> My first question is, i=
s there any way to more efficiently get=0A> (all/most) of the fields for a =
set of documents, other than iterating=0A> and calling doc()?=0A> =0A> Addi=
tionally, is there any way (or planned feature) to index *binary*=0A> data?=
 Using a profiler, I have determined that String decoding is a=0A> signific=
ant performance limiter for my use-case:=0A> =0A> 90% of the application ti=
me is spent in this method:=0A> ---------------------------------------=0A>=
 org.apache.lucene.index.FieldsReader.addField(Document, FieldInfo,=0A> boo=
lean, boolean, boolean)=0A> =0A> =0A> 46% of the application time is spent =
decoding strings (half of the above=0A> addField() time):=0A> -------------=
--------------------------org.apache.lucene.store.IndexInpu=0A> t.readStrin=
g()=0A>     java.lang.String.(byte[], int, int, String)=0A>         java.la=
ng.StringCoding.decode(String, byte[], int, int)=0A>     =0A> java.lang.Str=
ingCoding$StringDecoder.decode(byte[], int, int)=0A> =0A> (YJP profiler out=
put available if needed)=0A> =0A> String.intern() was my top hot spot, but =
my patch was accepted and fixed=0A> this: https://issues.apache.org/jira/br=
owse/LUCENE-1600. I'm not=0A> familiar enough with the lucene codebase to f=
igure out the above though,=0A> so thought I would ask.=0A> =0A> =0A> =0A> =
//ideally i'd be able to do add a binary field as such:=0A> doc.add(new Fie=
ld("f1",new=0A> byte[]{1,2,3,4},Field.Store.YES,Field.Index.NOT_ANALYZED_NO=
_NORMS));=0A> =0A> //then query like:=0A> Query q =3D new TermQuery(new Ter=
m("f1",byte[]{1,2,3,4}))=0A> searcher.search(q,...);=0A> =0A> Which would a=
llow me to avoid the Integer -> String -> Padded String ->=0A> String -> In=
teger coding/decoding to index an integer, and avoid Object=0A> -> String -=
> Object conversion (which per above is quite expensive). =0A> =0A> =0A> Th=
anks for any help!=0A> =0A> =0A> Regards, =0A> =0A> Patrick=0A> =0A> ------=
---------------------------------------------------------------=0A> To unsu=
bscribe, e-mail: java-user-unsubscribe@lucene.apache.org=0A> For additional=
 commands, e-mail: java-user-help@lucene.apache.org=0A=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39725-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 14 23:27:12 2009
Return-Path: <java-user-return-39725-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58073 invoked from network); 14 Apr 2009 23:27:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Apr 2009 23:27:12 -0000
Received: (qmail 60995 invoked by uid 500); 14 Apr 2009 23:27:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60907 invoked by uid 500); 14 Apr 2009 23:27:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60897 invoked by uid 99); 14 Apr 2009 23:27:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 23:27:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 14 Apr 2009 23:27:01 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lts1Z-0005hD-AN
	for java-user@lucene.apache.org; Tue, 14 Apr 2009 16:26:41 -0700
Message-ID: <23049935.post@talk.nabble.com>
Date: Tue, 14 Apr 2009 16:26:41 -0700 (PDT)
From: oleg_gnatovskiy <oleg_gnatovskiy@citysearch.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene SnowBall unexpected behavior for some terms
In-Reply-To: <22991689.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: oleg_gnatovskiy@citysearch.com
References: <22991689.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


I am also noticing the same behavior. Does anyone know any solutions?

AlexElba wrote:
> 
> Hello,
> I was working with lucene snowball 2.3.2 and I switch to 2.4.0. 
> After switch I came by to some case where lucene doesn't do lemmatization
> correctly. So far I found only one case spa - spas. spas are not getting
> lemmatize at all...
> BTW I saw the same behavior on solr 1.3
> 
> 
> Anybody have any idea why?
> 

-- 
View this message in context: http://www.nabble.com/Lucene-SnowBall-unexpected-behavior-for-some-terms-tp22991689p23049935.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39726-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 15 06:58:57 2009
Return-Path: <java-user-return-39726-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81290 invoked from network); 15 Apr 2009 06:58:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Apr 2009 06:58:57 -0000
Received: (qmail 72213 invoked by uid 500); 15 Apr 2009 06:58:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72120 invoked by uid 500); 15 Apr 2009 06:58:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72110 invoked by uid 99); 15 Apr 2009 06:58:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 06:58:53 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aminmc@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 06:58:46 +0000
Received: by fxm2 with SMTP id 2so3129441fxm.5
        for <java-user@lucene.apache.org>; Tue, 14 Apr 2009 23:58:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=9/k1QapxgU80sobqgFwrNBnRA2EdgL6wYJgdGH/Rjyk=;
        b=fGw6cFXRM9+SPxXHLhbBjNWAazqROZfm7Ny944MsRuE8SU3zfS6LncmptNVBrEC4Mf
         zvwBS//6/mCNtq8vGseEJJdTNoLzsNFKjiWIxDeC/juwpDBjFxyJqDLSt7crl1IuAzRa
         BAFL4EdfaZ4c2SzTYplMfxVvKBRG69nWmN+wE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=oWysYJZ8gVMkctmAri4nh/e3T7s2mFzOEbiUSEwkOhw6Tt8FYWz88KwmIk/wk1EODJ
         unkpSajqUgQFL6zTOt4eVDccDdwmU1KLJQTflKtS3F6SSGstVfqgdq8h8ecKzlPYv2SV
         gC4/4oI2D8SA4rwWlb/+NwYkFBpEIZqc3LCcU=
MIME-Version: 1.0
Received: by 10.204.61.130 with SMTP id t2mr7758003bkh.27.1239778704792; Tue, 
	14 Apr 2009 23:58:24 -0700 (PDT)
In-Reply-To: <6f4104d80904111359p5621561bw2939160db9ba862b@mail.gmail.com>
References: <6f4104d80904100628q79150b4oa3e5436cfb66c581@mail.gmail.com>
	 <6f4104d80904111359p5621561bw2939160db9ba862b@mail.gmail.com>
Date: Wed, 15 Apr 2009 07:58:24 +0100
Message-ID: <6f4104d80904142358v7854b805l985abe131bf765c2@mail.gmail.com>
Subject: Re: SpellChecker in use with composite query
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Content-Type: multipart/alternative; boundary=0016e6dee7444c9dd90467927912
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6dee7444c9dd90467927912
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi

Apologies for bringing this mail up again. But I have resolved some of the
issues that I originally started with including composite queries.  However
I just have 1 remaining question which I would be grateful if someone could
assist me with.

I have a class whcih performs the creation of the spell index but I'm not
sure where to apply this class.   Do I apply this process whenever a user
uploads a new file (kicking off the indexing process).  It seems as though
this may not be the most appropriate place as I have one spell index and 4
document indexes.  I'm wondering what the general approach is.  Also
whenever the indexes change should I clear the spell index and start again?


Once again apologies for bringing this up.


Cheers
Amin

On Sat, Apr 11, 2009 at 9:59 PM, Amin Mohammed-Coleman <aminmc@gmail.com>wrote:

> Hi
> Another thing that I was wondering is how to apply the construction of the
> spell index.  Where is the most appropriate place to create the spell index?
>
>
> For example:
>
> IndexReader spellReader = IndexReader.open(fsDirectory1);
>
> IndexReader spellReader2 = IndexReader.open(fsDirectory2);
>
> MultiReader multiReader = new MultiReader(new IndexReader[]
> {spellReader,spellReader2});
>
> LuceneDictionary luceneDictionary = new LuceneDictionary(multiReader,
> "content");
>
>  Directory spellDirectory = FSDirectory.getDirectory(<single index for
> spellcheck);
>
> SpellChecker spellChecker = new SpellChecker(spellDirectory);
>
> spellChecker.indexDictionary(luceneDictionary);
>
>
> should this be applied when doing a search or when a document is indexed?
> Should I clear the spellIndex when the main index changes?
>
>
> I also noticed that when running some tests I found that the spell index
> contained numbers from the text extracted from a document.  Is there a way
> to only include a*lphabetic characters in the indexDictionary process?*
>
>
>
> Any help would be appreciated.
>
>
> Cheers
>
> On Fri, Apr 10, 2009 at 2:28 PM, Amin Mohammed-Coleman <aminmc@gmail.com>wrote:
>
>> Hi
>> I have been playing around with the SpellChecker class and so far it looks
>> really good.  While developing a testcase to show it working I came across a
>> couple of issues which I have resolved but I'm not certain if this is the
>> correct approach.  I would therefore be grateful if anyone could tell me
>> whether it is correct or I should try something else.
>>
>> 1) Multple Indexes:
>> I have multiple indexes which store different documents based on certain
>> subject matter.  So inorder to perform the spellchecking against all indexes
>> I did something like this:
>>
>> IndexReader spellReader = IndexReader.open(fsDirectory1);
>>
>> IndexReader spellReader2 = IndexReader.open(fsDirectory2);
>>
>> MultiReader multiReader = new MultiReader(new IndexReader[]
>> {spellReader,spellReader2});
>>
>> LuceneDictionary luceneDictionary = new LuceneDictionary(multiReader,
>> "content");
>>
>>  Directory spellDirectory = FSDirectory.getDirectory(<single index for
>> spellcheck);
>>
>> SpellChecker spellChecker = new SpellChecker(spellDirectory);
>>
>> spellChecker.indexDictionary(luceneDictionary);
>>
>>
>> Is this an acceptable approach or should there be a spellcheck index for
>> each seperate document index?
>>
>>
>>
>>  2) Composite query e.g. Luciene OR doqument
>>
>> Inorder to handle the above i did the following:
>>
>>
>> QueryParser queryParser = new AnalyzingQueryParser("content",analyzer);
>>
>> String input = "luciene OR doqument";
>>
>> Query query = queryParser.parse(input);
>>
>> String input2 = query.toString("content");
>>
>> String[] splitString = input2.split(" ");
>>
>>
>> For each of the string in the array i performed the suggestSimilar(..).
>>
>>
>> Is this the most appropriate way of doing this?
>>
>>
>>
>>  Any help would be appreciated.
>>
>>
>> Cheers
>>
>> Amin
>>
>>
>

--0016e6dee7444c9dd90467927912--

From java-user-return-39727-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 15 17:38:23 2009
Return-Path: <java-user-return-39727-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21732 invoked from network); 15 Apr 2009 17:38:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Apr 2009 17:38:23 -0000
Received: (qmail 81020 invoked by uid 500); 15 Apr 2009 17:38:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80929 invoked by uid 500); 15 Apr 2009 17:38:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80919 invoked by uid 99); 15 Apr 2009 17:38:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 17:38:20 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ryantxu@gmail.com designates 209.85.198.239 as permitted sender)
Received: from [209.85.198.239] (HELO rv-out-0506.google.com) (209.85.198.239)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 17:38:10 +0000
Received: by rv-out-0506.google.com with SMTP id f6so8763rvb.5
        for <java-user@lucene.apache.org>; Wed, 15 Apr 2009 10:37:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :content-type:mime-version:subject:date:x-mailer;
        bh=c+zUT1iuEKQbigGiRSLHnY+38eDb7T+La1uaj2vxK3A=;
        b=iAP2HmtJX4v9w0Ly4MnT0tSs6Zh30TBjzg489l92gocvB+wqRHVjRfNF0kMCgnWqfw
         4McVrS82uyRu6/xXKGUOM+Bv/eosefvNpeKgHjEdjvTCfDOSkSOrY6Sutf4DwDma9t7d
         AAbxM8VWiR3dtz5NuVPfa2uk6xjpFay81aeSw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:content-type:mime-version:subject:date:x-mailer;
        b=ViFcGjS7KzumAbtVkEYfj0NLhhlBfy3j9V/mrrD9MdP7st8Un+uTrwTxxAj4iYLEVG
         8qfkxHacPRZ7tORzNkvHGea7f0sN2TodjPVRdc4B84eKjrru1T9J0GDA8z3UhXwfOU7e
         CGG1JAiDTRdQVsKYX3RAULGJLu5a4t2KbDdAE=
Received: by 10.115.22.1 with SMTP id z1mr173629wai.202.1239817068992;
        Wed, 15 Apr 2009 10:37:48 -0700 (PDT)
Received: from ?192.168.1.5? ([66.92.161.165])
        by mx.google.com with ESMTPS id n22sm140116pof.19.2009.04.15.10.37.47
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 15 Apr 2009 10:37:48 -0700 (PDT)
Message-Id: <254EF120-C817-4087-97D3-3A33ABFACE06@gmail.com>
From: Ryan McKinley <ryantxu@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=Apple-Mail-23--483140519
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: BitSet Filter ArrayIndexOutOfBoundsException?
Date: Wed, 15 Apr 2009 13:37:44 -0400
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail-23--483140519
Content-Type: text/plain;
	charset=US-ASCII;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: 7bit

I am working on a Filter that uses an RTree to test for inclusion.   
This Filter works great *most* of the time -- if the index is  
optimized, it works all of the time.  I feel like I am missing  
something basic, but not sure what it could be.

Each time the reader opens (and the index has changed), I build an  
RTree from stored fields.  The RTree holds the lucene document ID and  
is later used in a Filter/Query.  This is how I build the RTree:

   FieldSelector selector = new MapFieldSelector( new String[]  
{ "extent" } );
   DocIterator iter = docs.iterator();
   while( iter.hasNext() ) {
     int id = iter.nextDoc();
     Document doc = searcher.doc( id, selector );
     Fieldable ff = doc.getFieldable( "extent" );
     if( ff != null && !reader.isDeleted( id ) ) {
       ... add the id to the RTree ...
     }
   }

In the Filter, I run query my RTree and add results to a BitSet

   public DocIdSet getDocIdSet(IndexReader reader) throws IOException
   {
     final BitSet bits = new BitSet();

     // ... query the RTree adding matching ids to the BitSet...
       bits.set( id );

     return new DocIdBitSet( bitset );
   }

When things go wrong, I get an error like this:

java.lang.ArrayIndexOutOfBoundsException: 67
      at org.apache.lucene.util.OpenBitSet.fastSet(OpenBitSet.java:242)
      at  
org 
.apache.solr.search.DocSetHitCollector.collect(DocSetHitCollector.java: 
63)
      at org.apache.lucene.search.IndexSearcher 
$MultiReaderCollectorWrapper.collect(IndexSearcher.java:313)
      at org.apache.lucene.search.Scorer.score(Scorer.java:58)
      at  
org.apache.lucene.search.IndexSearcher.doSearch(IndexSearcher.java:262)
      at  
org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:250)
      at org.apache.lucene.search.Searcher.search(Searcher.java:126)
      at  
org 
.apache 
.solr.search.SolrIndexSearcher.getDocSetNC(SolrIndexSearcher.java:691)
      at  
org 
.apache.solr.search.SolrIndexSearcher.getDocSet(SolrIndexSearcher.java: 
597)
      at  
org 
.apache.solr.search.SolrIndexSearcher.getDocSet(SolrIndexSearcher.java: 
633)
      at  
org 
.apache 
.solr 
.search.SolrIndexSearcher.getDocListAndSetNC(SolrIndexSearcher.java: 
1154)
      at  
org 
.apache 
.solr.search.SolrIndexSearcher.getDocListC(SolrIndexSearcher.java:924)
      at  
org.apache.solr.search.SolrIndexSearcher.search(SolrIndexSearcher.java: 
345)
      at  
org 
.apache 
.solr.handler.component.QueryComponent.process(QueryComponent.java:171)

I'm guessing it is referencing a deleted document or something like  
that, but I figured the:
  && !reader.isDeleted( id ) clause would take care of that.

Any pointers would be great!

Thanks
Ryan


--Apple-Mail-23--483140519--

From java-user-return-39728-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 15 19:58:24 2009
Return-Path: <java-user-return-39728-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29356 invoked from network); 15 Apr 2009 19:58:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Apr 2009 19:58:23 -0000
Received: (qmail 10442 invoked by uid 500); 15 Apr 2009 19:58:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10398 invoked by uid 500); 15 Apr 2009 19:58:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10388 invoked by uid 99); 15 Apr 2009 19:58:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 19:58:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.39.202] (HELO web50311.mail.re2.yahoo.com) (206.190.39.202)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 15 Apr 2009 19:58:12 +0000
Received: (qmail 33827 invoked by uid 60001); 15 Apr 2009 19:57:50 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1239825470; bh=UfMURd6zQsQWoFWsHIqJ/RwzGE7Sl5nb27Xj3oHanCc=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=FBoCAvCTxeY9dvy8//3uwZDFbFp5LnyPf1PVJDwydxeeGRJte1tasohcThtlGWURu8CNX3F87t2fak3JHEdhO95iqcuit85wCC3XIo3ydyNyn0KllFdZq6JAdJCV3WXVFaZYFGjR5kLxgalvNoQX90gLQclGART36OkJu+T5nNI=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=PWFyzbb9EN9e7DQMQH+guYei1xAIRJrhZVMXFU+ilMCZfYjDiUATEm1C66KBw3HAddSOztWRBeoPN6BxJ6DwIr7WtnKZmjpBkCpvfLSiv12D160cC9Ah2DLwgGLWIJ9QBwt+LjY6PsUTWTRHsmc9DINAzK8AITw76QKW5HiPRfQ=;
Message-ID: <569173.32992.qm@web50311.mail.re2.yahoo.com>
X-YMail-OSG: NTCECc4VM1lzI_5Urf.LUPKEj0IjCtdbboQa26ulMjY2IbPmoSNbXtwXNqpnDKrKKL0s5zNbkyEAxgjrnL.vix6NkSNWVP6GDmuKBlssEw0Ht.xbIeAU9zR_Smp6PoOgGtbC9.MQ3d50X2BRX9I33WELKVtsGTeEgdg0.HX0DyQZfVngBZOJZfwxX7iRED_MmXFRr1vXxS.PCpMdR6m5iBGpjDsRwxTWbstzwvOL9OKvn.lWsBNc2L3GYgeuUxZOHZjyBjBP2x_8s9OBsWtCFY6D.2csZAmqMsFQIPXaHP_fsBNTgXZfoFGkmPs9XXrEtX1DktRkM6w1u.TB4q5XWVjG
Received: from [167.206.188.3] by web50311.mail.re2.yahoo.com via HTTP; Wed, 15 Apr 2009 12:57:50 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <22991689.post@talk.nabble.com> <23049935.post@talk.nabble.com>
Date: Wed, 15 Apr 2009 12:57:50 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Lucene SnowBall unexpected behavior for some terms
To: java-user@lucene.apache.org
In-Reply-To: <23049935.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org


I seem to recall some Snowball-related incompatibilities around Lucene 2.4.0 release, but can't find the exact details at the moment... but this was documented somewhere (Wiki?)

 Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch



----- Original Message ----
> From: oleg_gnatovskiy <oleg_gnatovskiy@citysearch.com>
> To: java-user@lucene.apache.org
> Sent: Tuesday, April 14, 2009 7:26:41 PM
> Subject: Re: Lucene SnowBall unexpected behavior for some terms
> 
> 
> I am also noticing the same behavior. Does anyone know any solutions?
> 
> AlexElba wrote:
> > 
> > Hello,
> > I was working with lucene snowball 2.3.2 and I switch to 2.4.0. 
> > After switch I came by to some case where lucene doesn't do lemmatization
> > correctly. So far I found only one case spa - spas. spas are not getting
> > lemmatize at all...
> > BTW I saw the same behavior on solr 1.3
> > 
> > 
> > Anybody have any idea why?
> > 
> 
> -- 
> View this message in context: 
> http://www.nabble.com/Lucene-SnowBall-unexpected-behavior-for-some-terms-tp22991689p23049935.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39729-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 15 20:12:26 2009
Return-Path: <java-user-return-39729-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39622 invoked from network); 15 Apr 2009 20:12:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Apr 2009 20:12:26 -0000
Received: (qmail 33811 invoked by uid 500); 15 Apr 2009 20:12:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33727 invoked by uid 500); 15 Apr 2009 20:12:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33717 invoked by uid 99); 15 Apr 2009 20:12:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 20:12:23 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.202] (HELO spunkymail-a18.g.dreamhost.com) (208.97.132.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 20:12:14 +0000
Received: from [192.168.0.102] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a18.g.dreamhost.com (Postfix) with ESMTP id 7433C5B52D
	for <java-user@lucene.apache.org>; Wed, 15 Apr 2009 13:11:53 -0700 (PDT)
Message-Id: <565F3878-B14C-44E9-9DFF-DD7955EDA218@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <569173.32992.qm@web50311.mail.re2.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Lucene SnowBall unexpected behavior for some terms
Date: Wed, 15 Apr 2009 16:11:52 -0400
References: <22991689.post@talk.nabble.com> <23049935.post@talk.nabble.com> <569173.32992.qm@web50311.mail.re2.yahoo.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

A quick search (http://www.lucidimagination.com/search/?q=snowball+back+compatibility 
) yields that Snowball was updated in LUCENE-1142 (http://issues.apache.org/jira/browse/LUCENE-1142 
) and that we discussed a little bit about back compatibility with  
regards to contrib.

In all likelihood, the change is actually due to the Snowball project  
changing how it stems those particular words.  In which case, you  
could take it up w/ them, but it will come down to whether they view  
it as a bug (in which case it will be fixed) or whether they think it  
is the correct choice to make for most situations.


--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


On Apr 15, 2009, at 3:57 PM, Otis Gospodnetic wrote:

>
> I seem to recall some Snowball-related incompatibilities around  
> Lucene 2.4.0 release, but can't find the exact details at the  
> moment... but this was documented somewhere (Wiki?)
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>
>
>
> ----- Original Message ----
>> From: oleg_gnatovskiy <oleg_gnatovskiy@citysearch.com>
>> To: java-user@lucene.apache.org
>> Sent: Tuesday, April 14, 2009 7:26:41 PM
>> Subject: Re: Lucene SnowBall unexpected behavior for some terms
>>
>>
>> I am also noticing the same behavior. Does anyone know any solutions?
>>
>> AlexElba wrote:
>>>
>>> Hello,
>>> I was working with lucene snowball 2.3.2 and I switch to 2.4.0.
>>> After switch I came by to some case where lucene doesn't do  
>>> lemmatization
>>> correctly. So far I found only one case spa - spas. spas are not  
>>> getting
>>> lemmatize at all...
>>> BTW I saw the same behavior on solr 1.3
>>>
>>>
>>> Anybody have any idea why?
>>>
>>
>> -- 
>> View this message in context:
>> http://www.nabble.com/Lucene-SnowBall-unexpected-behavior-for-some-terms-tp22991689p23049935.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39730-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 15 21:41:35 2009
Return-Path: <java-user-return-39730-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78121 invoked from network); 15 Apr 2009 21:41:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Apr 2009 21:41:34 -0000
Received: (qmail 78537 invoked by uid 500); 15 Apr 2009 21:41:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78459 invoked by uid 500); 15 Apr 2009 21:41:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78449 invoked by uid 99); 15 Apr 2009 21:41:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 21:41:31 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.170] (HELO wf-out-1314.google.com) (209.85.200.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 21:41:24 +0000
Received: by wf-out-1314.google.com with SMTP id 29so82091wff.20
        for <java-user@lucene.apache.org>; Wed, 15 Apr 2009 14:41:03 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.162.9 with SMTP id k9mr1122014wfe.164.1239831663441; Wed, 
	15 Apr 2009 14:41:03 -0700 (PDT)
In-Reply-To: <254EF120-C817-4087-97D3-3A33ABFACE06@gmail.com>
References: <254EF120-C817-4087-97D3-3A33ABFACE06@gmail.com>
Date: Wed, 15 Apr 2009 17:41:03 -0400
Message-ID: <9ac0c6aa0904151441n7c74eba0y74d1aef57b4a0c92@mail.gmail.com>
Subject: Re: BitSet Filter ArrayIndexOutOfBoundsException?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Maybe it's because you're using the MultiReader docID space but
getDocIdSet(IndexReader) expects you to use the docID space for that
IndexReader (ie, a single segment)?

Mike

On Wed, Apr 15, 2009 at 1:37 PM, Ryan McKinley <ryantxu@gmail.com> wrote:
> I am working on a Filter that uses an RTree to test for inclusion. =A0Thi=
s
> Filter works great *most* of the time -- if the index is optimized, it wo=
rks
> all of the time. =A0I feel like I am missing something basic, but not sur=
e
> what it could be.
>
> Each time the reader opens (and the index has changed), I build an RTree
> from stored fields. =A0The RTree holds the lucene document ID and is late=
r
> used in a Filter/Query. =A0This is how I build the RTree:
>
> =A0FieldSelector selector =3D new MapFieldSelector( new String[] { "exten=
t" } );
> =A0DocIterator iter =3D docs.iterator();
> =A0while( iter.hasNext() ) {
> =A0 =A0int id =3D iter.nextDoc();
> =A0 =A0Document doc =3D searcher.doc( id, selector );
> =A0 =A0Fieldable ff =3D doc.getFieldable( "extent" );
> =A0 =A0if( ff !=3D null && !reader.isDeleted( id ) ) {
> =A0 =A0 =A0... add the id to the RTree ...
> =A0 =A0}
> =A0}
>
> In the Filter, I run query my RTree and add results to a BitSet
>
> =A0public DocIdSet getDocIdSet(IndexReader reader) throws IOException
> =A0{
> =A0 =A0final BitSet bits =3D new BitSet();
>
> =A0 =A0// ... query the RTree adding matching ids to the BitSet...
> =A0 =A0 =A0bits.set( id );
>
> =A0 =A0return new DocIdBitSet( bitset );
> =A0}
>
> When things go wrong, I get an error like this:
>
> java.lang.ArrayIndexOutOfBoundsException: 67
> =A0 =A0 at org.apache.lucene.util.OpenBitSet.fastSet(OpenBitSet.java:242)
> =A0 =A0 at
> org.apache.solr.search.DocSetHitCollector.collect(DocSetHitCollector.java=
:63)
> =A0 =A0 at
> org.apache.lucene.search.IndexSearcher$MultiReaderCollectorWrapper.collec=
t(IndexSearcher.java:313)
> =A0 =A0 at org.apache.lucene.search.Scorer.score(Scorer.java:58)
> =A0 =A0 at
> org.apache.lucene.search.IndexSearcher.doSearch(IndexSearcher.java:262)
> =A0 =A0 at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.ja=
va:250)
> =A0 =A0 at org.apache.lucene.search.Searcher.search(Searcher.java:126)
> =A0 =A0 at
> org.apache.solr.search.SolrIndexSearcher.getDocSetNC(SolrIndexSearcher.ja=
va:691)
> =A0 =A0 at
> org.apache.solr.search.SolrIndexSearcher.getDocSet(SolrIndexSearcher.java=
:597)
> =A0 =A0 at
> org.apache.solr.search.SolrIndexSearcher.getDocSet(SolrIndexSearcher.java=
:633)
> =A0 =A0 at
> org.apache.solr.search.SolrIndexSearcher.getDocListAndSetNC(SolrIndexSear=
cher.java:1154)
> =A0 =A0 at
> org.apache.solr.search.SolrIndexSearcher.getDocListC(SolrIndexSearcher.ja=
va:924)
> =A0 =A0 at
> org.apache.solr.search.SolrIndexSearcher.search(SolrIndexSearcher.java:34=
5)
> =A0 =A0 at
> org.apache.solr.handler.component.QueryComponent.process(QueryComponent.j=
ava:171)
>
> I'm guessing it is referencing a deleted document or something like that,
> but I figured the:
> =A0&& !reader.isDeleted( id ) clause would take care of that.
>
> Any pointers would be great!
>
> Thanks
> Ryan
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39731-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 15 23:34:55 2009
Return-Path: <java-user-return-39731-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15250 invoked from network); 15 Apr 2009 23:34:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Apr 2009 23:34:55 -0000
Received: (qmail 14370 invoked by uid 500); 15 Apr 2009 23:34:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14281 invoked by uid 500); 15 Apr 2009 23:34:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14271 invoked by uid 99); 15 Apr 2009 23:34:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 23:34:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ryantxu@gmail.com designates 74.125.44.28 as permitted sender)
Received: from [74.125.44.28] (HELO yx-out-2324.google.com) (74.125.44.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 23:34:43 +0000
Received: by yx-out-2324.google.com with SMTP id 8so105375yxb.5
        for <java-user@lucene.apache.org>; Wed, 15 Apr 2009 16:34:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=2YY8u37IH6rG1TRjg8V/JHciC2sySvCKjmrVlzyzTrE=;
        b=ag7EWQlx6tdIHmAwCVkWOmT8ls4MGKNr5bY8Mct5FsR7DKLauzwmiRqIZ0INICtiP7
         0u3a7CKwLX5YrW64SroAyZEWO9Rp+4y7rtirmKMMZNHBNNY0MD1o9PW8ouE7YZZMz0GQ
         pqiZv3VC54gDjyStVUV6i+JvbJbLWe0Nu/3H8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=Towwl89zPR1zLwDFQqO7+D4ga6Mlm4+rT3kvQDkXGnnaSQCtOMHXCbsGQgV75mx5Us
         ycPPt7nBHovv0slhpSaU+LXvF5IZXZ5Fl8IVlq5hy8wbUbgIBqW7IJW8TjZQoePtmaZ5
         lIdwPWhnRpr4DcKy8mEaBjj0fc+WOXT3xcS9I=
Received: by 10.100.47.10 with SMTP id u10mr1282952anu.17.1239838462372;
        Wed, 15 Apr 2009 16:34:22 -0700 (PDT)
Received: from ?192.168.1.5? ([66.92.161.165])
        by mx.google.com with ESMTPS id d38sm1359952and.9.2009.04.15.16.34.21
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 15 Apr 2009 16:34:21 -0700 (PDT)
Message-Id: <372710B0-FFDD-4B37-9CA5-474AAEB3D841@gmail.com>
From: Ryan McKinley <ryantxu@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <9ac0c6aa0904151441n7c74eba0y74d1aef57b4a0c92@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: BitSet Filter ArrayIndexOutOfBoundsException?
Date: Wed, 15 Apr 2009 19:34:19 -0400
References: <254EF120-C817-4087-97D3-3A33ABFACE06@gmail.com> <9ac0c6aa0904151441n7c74eba0y74d1aef57b4a0c92@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Are you saying there lucene document could have different ids in the  
MultiReader and the IndexReader?

I have assumed that the ids have not changed as long as the  
lastmodified time has not changed:
   long lastmodified = IndexReader.lastModified( reader.directory() );
Is this assumption correct?

I get the original ids using:

     SolrIndexSearcher searcher = ...
     DocList docs = searcher.getDocList( new MatchAllDocsQuery(),
         (DocSet)null, null, 0, Integer.MAX_VALUE );

and assume that nothing has changed as long as:
    IndexReader.lastModified( searcher.getReader().directory() );
has not changed.

Am I missing something?

If so, how would I get access to the docId expected by  
Filter#getDocIdSet()?

thanks!
ryan


On Apr 15, 2009, at 5:41 PM, Michael McCandless wrote:

> Maybe it's because you're using the MultiReader docID space but
> getDocIdSet(IndexReader) expects you to use the docID space for that
> IndexReader (ie, a single segment)?
>
> Mike
>
> On Wed, Apr 15, 2009 at 1:37 PM, Ryan McKinley <ryantxu@gmail.com>  
> wrote:
>> I am working on a Filter that uses an RTree to test for inclusion.   
>> This
>> Filter works great *most* of the time -- if the index is optimized,  
>> it works
>> all of the time.  I feel like I am missing something basic, but not  
>> sure
>> what it could be.
>>
>> Each time the reader opens (and the index has changed), I build an  
>> RTree
>> from stored fields.  The RTree holds the lucene document ID and is  
>> later
>> used in a Filter/Query.  This is how I build the RTree:
>>
>>  FieldSelector selector = new MapFieldSelector( new String[]  
>> { "extent" } );
>>  DocIterator iter = docs.iterator();
>>  while( iter.hasNext() ) {
>>    int id = iter.nextDoc();
>>    Document doc = searcher.doc( id, selector );
>>    Fieldable ff = doc.getFieldable( "extent" );
>>    if( ff != null && !reader.isDeleted( id ) ) {
>>      ... add the id to the RTree ...
>>    }
>>  }
>>
>> In the Filter, I run query my RTree and add results to a BitSet
>>
>>  public DocIdSet getDocIdSet(IndexReader reader) throws IOException
>>  {
>>    final BitSet bits = new BitSet();
>>
>>    // ... query the RTree adding matching ids to the BitSet...
>>      bits.set( id );
>>
>>    return new DocIdBitSet( bitset );
>>  }
>>
>> When things go wrong, I get an error like this:
>>
>> java.lang.ArrayIndexOutOfBoundsException: 67
>>     at org.apache.lucene.util.OpenBitSet.fastSet(OpenBitSet.java:242)
>>     at
>> org 
>> .apache 
>> .solr.search.DocSetHitCollector.collect(DocSetHitCollector.java:63)
>>     at
>> org.apache.lucene.search.IndexSearcher 
>> $MultiReaderCollectorWrapper.collect(IndexSearcher.java:313)
>>     at org.apache.lucene.search.Scorer.score(Scorer.java:58)
>>     at
>> org.apache.lucene.search.IndexSearcher.doSearch(IndexSearcher.java: 
>> 262)
>>     at  
>> org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:250)
>>     at org.apache.lucene.search.Searcher.search(Searcher.java:126)
>>     at
>> org 
>> .apache 
>> .solr.search.SolrIndexSearcher.getDocSetNC(SolrIndexSearcher.java: 
>> 691)
>>     at
>> org 
>> .apache 
>> .solr.search.SolrIndexSearcher.getDocSet(SolrIndexSearcher.java:597)
>>     at
>> org 
>> .apache 
>> .solr.search.SolrIndexSearcher.getDocSet(SolrIndexSearcher.java:633)
>>     at
>> org 
>> .apache 
>> .solr 
>> .search.SolrIndexSearcher.getDocListAndSetNC(SolrIndexSearcher.java: 
>> 1154)
>>     at
>> org 
>> .apache 
>> .solr.search.SolrIndexSearcher.getDocListC(SolrIndexSearcher.java: 
>> 924)
>>     at
>> org 
>> .apache.solr.search.SolrIndexSearcher.search(SolrIndexSearcher.java: 
>> 345)
>>     at
>> org 
>> .apache 
>> .solr.handler.component.QueryComponent.process(QueryComponent.java: 
>> 171)
>>
>> I'm guessing it is referencing a deleted document or something like  
>> that,
>> but I figured the:
>>  && !reader.isDeleted( id ) clause would take care of that.
>>
>> Any pointers would be great!
>>
>> Thanks
>> Ryan
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39732-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 15 23:41:58 2009
Return-Path: <java-user-return-39732-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16541 invoked from network); 15 Apr 2009 23:41:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Apr 2009 23:41:56 -0000
Received: (qmail 20747 invoked by uid 500); 15 Apr 2009 23:41:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20660 invoked by uid 500); 15 Apr 2009 23:41:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20650 invoked by uid 99); 15 Apr 2009 23:41:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 23:41:53 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 15 Apr 2009 23:41:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id DCF9851876
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 01:41:19 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 02639-03 for <java-user@lucene.apache.org>;
 Thu, 16 Apr 2009 01:41:18 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 08F1E51849
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 01:41:17 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <254EF120-C817-4087-97D3-3A33ABFACE06@gmail.com> <9ac0c6aa0904151441n7c74eba0y74d1aef57b4a0c92@mail.gmail.com> <372710B0-FFDD-4B37-9CA5-474AAEB3D841@gmail.com>
Subject: RE: BitSet Filter ArrayIndexOutOfBoundsException?
Date: Thu, 16 Apr 2009 01:41:18 +0200
Message-ID: <F4992669C9634BB4A354773564983A35@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <372710B0-FFDD-4B37-9CA5-474AAEB3D841@gmail.com>
Thread-Index: Acm+IsnDz40tVlRfRqmAKd/DGeG/KwAAJ5hg
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Use the index reader given to getDocIdSet. The Ids are only valid for that
index reader. This is new in Lucene 2.9: filters are executed against each
segment of an index separately, so the docids of the
MultiReader/DirectoryIndexReader are different to the local ones.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Ryan McKinley [mailto:ryantxu@gmail.com]
> Sent: Thursday, April 16, 2009 1:34 AM
> To: java-user@lucene.apache.org
> Subject: Re: BitSet Filter ArrayIndexOutOfBoundsException?
> 
> Are you saying there lucene document could have different ids in the
> MultiReader and the IndexReader?
> 
> I have assumed that the ids have not changed as long as the
> lastmodified time has not changed:
>    long lastmodified = IndexReader.lastModified( reader.directory() );
> Is this assumption correct?
> 
> I get the original ids using:
> 
>      SolrIndexSearcher searcher = ...
>      DocList docs = searcher.getDocList( new MatchAllDocsQuery(),
>          (DocSet)null, null, 0, Integer.MAX_VALUE );
> 
> and assume that nothing has changed as long as:
>     IndexReader.lastModified( searcher.getReader().directory() );
> has not changed.
> 
> Am I missing something?
> 
> If so, how would I get access to the docId expected by
> Filter#getDocIdSet()?
> 
> thanks!
> ryan
> 
> 
> On Apr 15, 2009, at 5:41 PM, Michael McCandless wrote:
> 
> > Maybe it's because you're using the MultiReader docID space but
> > getDocIdSet(IndexReader) expects you to use the docID space for that
> > IndexReader (ie, a single segment)?
> >
> > Mike
> >
> > On Wed, Apr 15, 2009 at 1:37 PM, Ryan McKinley <ryantxu@gmail.com>
> > wrote:
> >> I am working on a Filter that uses an RTree to test for inclusion.
> >> This
> >> Filter works great *most* of the time -- if the index is optimized,
> >> it works
> >> all of the time.  I feel like I am missing something basic, but not
> >> sure
> >> what it could be.
> >>
> >> Each time the reader opens (and the index has changed), I build an
> >> RTree
> >> from stored fields.  The RTree holds the lucene document ID and is
> >> later
> >> used in a Filter/Query.  This is how I build the RTree:
> >>
> >>  FieldSelector selector = new MapFieldSelector( new String[]
> >> { "extent" } );
> >>  DocIterator iter = docs.iterator();
> >>  while( iter.hasNext() ) {
> >>    int id = iter.nextDoc();
> >>    Document doc = searcher.doc( id, selector );
> >>    Fieldable ff = doc.getFieldable( "extent" );
> >>    if( ff != null && !reader.isDeleted( id ) ) {
> >>      ... add the id to the RTree ...
> >>    }
> >>  }
> >>
> >> In the Filter, I run query my RTree and add results to a BitSet
> >>
> >>  public DocIdSet getDocIdSet(IndexReader reader) throws IOException
> >>  {
> >>    final BitSet bits = new BitSet();
> >>
> >>    // ... query the RTree adding matching ids to the BitSet...
> >>      bits.set( id );
> >>
> >>    return new DocIdBitSet( bitset );
> >>  }
> >>
> >> When things go wrong, I get an error like this:
> >>
> >> java.lang.ArrayIndexOutOfBoundsException: 67
> >>     at org.apache.lucene.util.OpenBitSet.fastSet(OpenBitSet.java:242)
> >>     at
> >> org
> >> .apache
> >> .solr.search.DocSetHitCollector.collect(DocSetHitCollector.java:63)
> >>     at
> >> org.apache.lucene.search.IndexSearcher
> >> $MultiReaderCollectorWrapper.collect(IndexSearcher.java:313)
> >>     at org.apache.lucene.search.Scorer.score(Scorer.java:58)
> >>     at
> >> org.apache.lucene.search.IndexSearcher.doSearch(IndexSearcher.java:
> >> 262)
> >>     at
> >> org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:250)
> >>     at org.apache.lucene.search.Searcher.search(Searcher.java:126)
> >>     at
> >> org
> >> .apache
> >> .solr.search.SolrIndexSearcher.getDocSetNC(SolrIndexSearcher.java:
> >> 691)
> >>     at
> >> org
> >> .apache
> >> .solr.search.SolrIndexSearcher.getDocSet(SolrIndexSearcher.java:597)
> >>     at
> >> org
> >> .apache
> >> .solr.search.SolrIndexSearcher.getDocSet(SolrIndexSearcher.java:633)
> >>     at
> >> org
> >> .apache
> >> .solr
> >> .search.SolrIndexSearcher.getDocListAndSetNC(SolrIndexSearcher.java:
> >> 1154)
> >>     at
> >> org
> >> .apache
> >> .solr.search.SolrIndexSearcher.getDocListC(SolrIndexSearcher.java:
> >> 924)
> >>     at
> >> org
> >> .apache.solr.search.SolrIndexSearcher.search(SolrIndexSearcher.java:
> >> 345)
> >>     at
> >> org
> >> .apache
> >> .solr.handler.component.QueryComponent.process(QueryComponent.java:
> >> 171)
> >>
> >> I'm guessing it is referencing a deleted document or something like
> >> that,
> >> but I figured the:
> >>  && !reader.isDeleted( id ) clause would take care of that.
> >>
> >> Any pointers would be great!
> >>
> >> Thanks
> >> Ryan
> >>
> >>
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39733-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 00:35:46 2009
Return-Path: <java-user-return-39733-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35430 invoked from network); 16 Apr 2009 00:35:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 00:35:45 -0000
Received: (qmail 65310 invoked by uid 500); 16 Apr 2009 00:35:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65232 invoked by uid 500); 16 Apr 2009 00:35:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65222 invoked by uid 99); 16 Apr 2009 00:35:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 00:35:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ryantxu@gmail.com designates 74.125.46.31 as permitted sender)
Received: from [74.125.46.31] (HELO yw-out-2324.google.com) (74.125.46.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 00:35:31 +0000
Received: by yw-out-2324.google.com with SMTP id 9so119021ywe.5
        for <java-user@lucene.apache.org>; Wed, 15 Apr 2009 17:35:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=wRnuY+rV16IREVrgGdcwA8U5qA+GlLEik7Z8JceZLGI=;
        b=Qdpy4EWeEw1zCKDXbt9r0WhsE1uq5/9CKogLhHXYsGaLDI9XiHfwFSYSvKFPn0ytAD
         JNTUSQYuVq5mzVNIJ5gO41tFtvZ0W6JT5gpDxyzWbSBeytpcw7u/f3Q9KMV0JWrebhsB
         GJYUG6oY9EvS9EoFeJbWROhx+WVz6eI/SjVZQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=HJvSZQ3zQ6sJn0lYZzxQLgnnkgp6lWS6A7LDUEcFwLVJL2sT4EkW1+LcN+QHoslimI
         50NdwLkF/TXOcngkjg90PIa544r7hgKuHa4JeHk6wNN/cUYe+Dc0SraC1jUtUqSh8Zcy
         FH1wIX8mGJMbH/Px1YU15c8HGss4b6GWjnbDE=
Received: by 10.100.227.18 with SMTP id z18mr1222689ang.67.1239842110769;
        Wed, 15 Apr 2009 17:35:10 -0700 (PDT)
Received: from ?192.168.1.5? ([66.92.161.165])
        by mx.google.com with ESMTPS id c1sm1640046ana.0.2009.04.15.17.35.09
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 15 Apr 2009 17:35:10 -0700 (PDT)
Message-Id: <68E5FE9E-A08E-4760-BAAC-39036B27A4DB@gmail.com>
From: Ryan McKinley <ryantxu@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <F4992669C9634BB4A354773564983A35@VEGA>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: BitSet Filter ArrayIndexOutOfBoundsException?
Date: Wed, 15 Apr 2009 20:35:07 -0400
References: <254EF120-C817-4087-97D3-3A33ABFACE06@gmail.com> <9ac0c6aa0904151441n7c74eba0y74d1aef57b4a0c92@mail.gmail.com> <372710B0-FFDD-4B37-9CA5-474AAEB3D841@gmail.com> <F4992669C9634BB4A354773564983A35@VEGA>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

uggg.  So there is no longer a consistent docId I can use in a filter?

I have an operation that is quite expensive that I am hoping to run  
only once for each time the index changes.  Is the

How would I get all the doc ids with a given (stored) field from a  
Reader?  I am trying:

  TermDocs td = reader.termDocs();
   while( td.next() ) {
     int id = td.doc();
     Document doc = searcher.doc( id, selector );
     ...

but the termDocs() function is always empty (The index is not empty)

Thanks
ryan




On Apr 15, 2009, at 7:41 PM, Uwe Schindler wrote:

> Use the index reader given to getDocIdSet. The Ids are only valid  
> for that
> index reader. This is new in Lucene 2.9: filters are executed  
> against each
> segment of an index separately, so the docids of the
> MultiReader/DirectoryIndexReader are different to the local ones.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>> -----Original Message-----
>> From: Ryan McKinley [mailto:ryantxu@gmail.com]
>> Sent: Thursday, April 16, 2009 1:34 AM
>> To: java-user@lucene.apache.org
>> Subject: Re: BitSet Filter ArrayIndexOutOfBoundsException?
>>
>> Are you saying there lucene document could have different ids in the
>> MultiReader and the IndexReader?
>>
>> I have assumed that the ids have not changed as long as the
>> lastmodified time has not changed:
>>   long lastmodified = IndexReader.lastModified( reader.directory() );
>> Is this assumption correct?
>>
>> I get the original ids using:
>>
>>     SolrIndexSearcher searcher = ...
>>     DocList docs = searcher.getDocList( new MatchAllDocsQuery(),
>>         (DocSet)null, null, 0, Integer.MAX_VALUE );
>>
>> and assume that nothing has changed as long as:
>>    IndexReader.lastModified( searcher.getReader().directory() );
>> has not changed.
>>
>> Am I missing something?
>>
>> If so, how would I get access to the docId expected by
>> Filter#getDocIdSet()?
>>
>> thanks!
>> ryan
>>
>>
>> On Apr 15, 2009, at 5:41 PM, Michael McCandless wrote:
>>
>>> Maybe it's because you're using the MultiReader docID space but
>>> getDocIdSet(IndexReader) expects you to use the docID space for that
>>> IndexReader (ie, a single segment)?
>>>
>>> Mike
>>>
>>> On Wed, Apr 15, 2009 at 1:37 PM, Ryan McKinley <ryantxu@gmail.com>
>>> wrote:
>>>> I am working on a Filter that uses an RTree to test for inclusion.
>>>> This
>>>> Filter works great *most* of the time -- if the index is optimized,
>>>> it works
>>>> all of the time.  I feel like I am missing something basic, but not
>>>> sure
>>>> what it could be.
>>>>
>>>> Each time the reader opens (and the index has changed), I build an
>>>> RTree
>>>> from stored fields.  The RTree holds the lucene document ID and is
>>>> later
>>>> used in a Filter/Query.  This is how I build the RTree:
>>>>
>>>> FieldSelector selector = new MapFieldSelector( new String[]
>>>> { "extent" } );
>>>> DocIterator iter = docs.iterator();
>>>> while( iter.hasNext() ) {
>>>>   int id = iter.nextDoc();
>>>>   Document doc = searcher.doc( id, selector );
>>>>   Fieldable ff = doc.getFieldable( "extent" );
>>>>   if( ff != null && !reader.isDeleted( id ) ) {
>>>>     ... add the id to the RTree ...
>>>>   }
>>>> }
>>>>
>>>> In the Filter, I run query my RTree and add results to a BitSet
>>>>
>>>> public DocIdSet getDocIdSet(IndexReader reader) throws IOException
>>>> {
>>>>   final BitSet bits = new BitSet();
>>>>
>>>>   // ... query the RTree adding matching ids to the BitSet...
>>>>     bits.set( id );
>>>>
>>>>   return new DocIdBitSet( bitset );
>>>> }
>>>>
>>>> When things go wrong, I get an error like this:
>>>>
>>>> java.lang.ArrayIndexOutOfBoundsException: 67
>>>>    at org.apache.lucene.util.OpenBitSet.fastSet(OpenBitSet.java: 
>>>> 242)
>>>>    at
>>>> org
>>>> .apache
>>>> .solr.search.DocSetHitCollector.collect(DocSetHitCollector.java:63)
>>>>    at
>>>> org.apache.lucene.search.IndexSearcher
>>>> $MultiReaderCollectorWrapper.collect(IndexSearcher.java:313)
>>>>    at org.apache.lucene.search.Scorer.score(Scorer.java:58)
>>>>    at
>>>> org.apache.lucene.search.IndexSearcher.doSearch(IndexSearcher.java:
>>>> 262)
>>>>    at
>>>> org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java: 
>>>> 250)
>>>>    at org.apache.lucene.search.Searcher.search(Searcher.java:126)
>>>>    at
>>>> org
>>>> .apache
>>>> .solr.search.SolrIndexSearcher.getDocSetNC(SolrIndexSearcher.java:
>>>> 691)
>>>>    at
>>>> org
>>>> .apache
>>>> .solr.search.SolrIndexSearcher.getDocSet(SolrIndexSearcher.java: 
>>>> 597)
>>>>    at
>>>> org
>>>> .apache
>>>> .solr.search.SolrIndexSearcher.getDocSet(SolrIndexSearcher.java: 
>>>> 633)
>>>>    at
>>>> org
>>>> .apache
>>>> .solr
>>>> .search 
>>>> .SolrIndexSearcher.getDocListAndSetNC(SolrIndexSearcher.java:
>>>> 1154)
>>>>    at
>>>> org
>>>> .apache
>>>> .solr.search.SolrIndexSearcher.getDocListC(SolrIndexSearcher.java:
>>>> 924)
>>>>    at
>>>> org
>>>> .apache 
>>>> .solr.search.SolrIndexSearcher.search(SolrIndexSearcher.java:
>>>> 345)
>>>>    at
>>>> org
>>>> .apache
>>>> .solr.handler.component.QueryComponent.process(QueryComponent.java:
>>>> 171)
>>>>
>>>> I'm guessing it is referencing a deleted document or something like
>>>> that,
>>>> but I figured the:
>>>> && !reader.isDeleted( id ) clause would take care of that.
>>>>
>>>> Any pointers would be great!
>>>>
>>>> Thanks
>>>> Ryan
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39734-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 01:06:52 2009
Return-Path: <java-user-return-39734-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43741 invoked from network); 16 Apr 2009 01:06:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 01:06:52 -0000
Received: (qmail 91100 invoked by uid 500); 16 Apr 2009 01:06:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91018 invoked by uid 500); 16 Apr 2009 01:06:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91008 invoked by uid 99); 16 Apr 2009 01:06:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 01:06:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.221.121 as permitted sender)
Received: from [209.85.221.121] (HELO mail-qy0-f121.google.com) (209.85.221.121)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 01:06:42 +0000
Received: by qyk27 with SMTP id 27so340978qyk.29
        for <java-user@lucene.apache.org>; Wed, 15 Apr 2009 18:06:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=XqK1ANMacbageedZ5bZf+w/H9cudZezy6RnXLOqnta0=;
        b=tJQLlCI48mfDYnQPc/XU+PSR8CN940ciQTwLqMLA2eDbvJ27P0feX4ZEVsFMCs4XsQ
         FaQFE1vBA3djEYY6Owb+D8DZl9qgqLPAcP5Phu19mkKu6077GvTv3alRWeTqizVSzdJF
         lx43Nk7/itqWmrSty5+aurNNICgl4AFihjPic=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=l09oCmA7LA6HGgRO3Tal+0TeWM+8pSJqD11WcaVu7CYySvGJYkaQQguttcll3DRwHk
         tI3FikeFLIIRNCCHpg9u3A56lBvnPfvz/j/D1cTuQQQv+wl9BwZYZ3S4/oxVxHerRJzQ
         Gd79sAU3QT336u1iuaQz+KAfi7hD8XBhgJ6Q8=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.229.73.204 with SMTP id r12mr148403qcj.31.1239843982035; Wed, 
	15 Apr 2009 18:06:22 -0700 (PDT)
In-Reply-To: <68E5FE9E-A08E-4760-BAAC-39036B27A4DB@gmail.com>
References: <254EF120-C817-4087-97D3-3A33ABFACE06@gmail.com>
	 <9ac0c6aa0904151441n7c74eba0y74d1aef57b4a0c92@mail.gmail.com>
	 <372710B0-FFDD-4B37-9CA5-474AAEB3D841@gmail.com>
	 <F4992669C9634BB4A354773564983A35@VEGA>
	 <68E5FE9E-A08E-4760-BAAC-39036B27A4DB@gmail.com>
Date: Wed, 15 Apr 2009 21:06:22 -0400
X-Google-Sender-Auth: b79e0c72b15f613a
Message-ID: <c68e39170904151806v512c8997p30cce6cee0537249@mail.gmail.com>
Subject: Re: BitSet Filter ArrayIndexOutOfBoundsException?
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Apr 15, 2009 at 8:35 PM, Ryan McKinley <ryantxu@gmail.com> wrote:
> uggg. =A0So there is no longer a consistent docId I can use in a filter?

There are ways around this... I had to do something for Solr's
external file field to get it to work because of these changes.  We
can continue this part of the discussion in solr-land, but you could
either
- pop back to the top level from the sub-reader, if you really need a singl=
e set
- if a set-per-reader will work, then cache per segment (better for
incremental updates anyway)

> How would I get all the doc ids with a given (stored) field from a Reader=
?
> =A0I am trying:
>
> =A0TermDocs td =3D reader.termDocs();

Relatively new in 2.9, you can pass null to enumerate over all non-deleted =
docs:
TermDocs td =3D reader.termDocs(null);

It would probably be a lot faster to iterate over indexed values though.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39735-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 01:20:54 2009
Return-Path: <java-user-return-39735-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47500 invoked from network); 16 Apr 2009 01:20:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 01:20:54 -0000
Received: (qmail 1929 invoked by uid 500); 16 Apr 2009 01:20:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1851 invoked by uid 500); 16 Apr 2009 01:20:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1841 invoked by uid 99); 16 Apr 2009 01:20:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 01:20:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ryantxu@gmail.com designates 209.85.132.251 as permitted sender)
Received: from [209.85.132.251] (HELO an-out-0708.google.com) (209.85.132.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 01:20:42 +0000
Received: by an-out-0708.google.com with SMTP id b2so132850ana.5
        for <java-user@lucene.apache.org>; Wed, 15 Apr 2009 18:20:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=PoMaHGUrmf3fMmcupMv11myPVnqgiSBgyh9fNqzhRY4=;
        b=jKS2IhXDkuZhJuZtd6Iky1h45do2FcXRKmP0HW2lpvmB+ZLLDxvJip1u8mIH/o0PqE
         Qft438Fs48dQdcw3XqGIbRddegYr+EEAcangJihAluDqJXTJgy3jqiht6j9bUyaMGbU3
         OFi1MpMtTOzV9bFYkKMa9TZ0MvnpK1rAYz+0s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=npn5wLx0Qa/vEbDch2bU3alqabLGfCS+qLhwzL+N1IlVmHBwbrShXXCJpXNJ0iwwwB
         ZipMD5HNlYSf/BYGwD4z/C2mTv4zgxtkhoa6z9Y1XNWnb3VmNGGP07/aBDA/U5sfTmOh
         EwsiXWEmxJhHcaai+//esUlnCMO/OCu4D61Ko=
Received: by 10.100.189.8 with SMTP id m8mr1361166anf.87.1239844816615;
        Wed, 15 Apr 2009 18:20:16 -0700 (PDT)
Received: from ?192.168.1.5? ([66.92.161.165])
        by mx.google.com with ESMTPS id d12sm1803865and.4.2009.04.15.18.20.15
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 15 Apr 2009 18:20:16 -0700 (PDT)
Message-Id: <5B4307B7-457A-4687-B6EF-2D1CE045F2DC@gmail.com>
From: Ryan McKinley <ryantxu@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <c68e39170904151806v512c8997p30cce6cee0537249@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: BitSet Filter ArrayIndexOutOfBoundsException?
Date: Wed, 15 Apr 2009 21:20:14 -0400
References: <254EF120-C817-4087-97D3-3A33ABFACE06@gmail.com> <9ac0c6aa0904151441n7c74eba0y74d1aef57b4a0c92@mail.gmail.com> <372710B0-FFDD-4B37-9CA5-474AAEB3D841@gmail.com> <F4992669C9634BB4A354773564983A35@VEGA> <68E5FE9E-A08E-4760-BAAC-39036B27A4DB@gmail.com> <c68e39170904151806v512c8997p30cce6cee0537249@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

thanks -- I'll move this discussion to solr-user since I am now  
delving into SolrIndexReader...

On Apr 15, 2009, at 9:06 PM, Yonik Seeley wrote:

> On Wed, Apr 15, 2009 at 8:35 PM, Ryan McKinley <ryantxu@gmail.com>  
> wrote:
>> uggg.  So there is no longer a consistent docId I can use in a  
>> filter?
>
> There are ways around this... I had to do something for Solr's
> external file field to get it to work because of these changes.  We
> can continue this part of the discussion in solr-land, but you could
> either
> - pop back to the top level from the sub-reader, if you really need  
> a single set
> - if a set-per-reader will work, then cache per segment (better for
> incremental updates anyway)
>
>> How would I get all the doc ids with a given (stored) field from a  
>> Reader?
>>  I am trying:
>>
>>  TermDocs td = reader.termDocs();
>
> Relatively new in 2.9, you can pass null to enumerate over all non- 
> deleted docs:
> TermDocs td = reader.termDocs(null);
>
> It would probably be a lot faster to iterate over indexed values  
> though.
>
> -Yonik
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39736-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 06:40:29 2009
Return-Path: <java-user-return-39736-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89166 invoked from network); 16 Apr 2009 06:40:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 06:40:29 -0000
Received: (qmail 24386 invoked by uid 500); 16 Apr 2009 06:40:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24299 invoked by uid 500); 16 Apr 2009 06:40:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24289 invoked by uid 99); 16 Apr 2009 06:40:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 06:40:25 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 06:40:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 25B31518F5
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 08:39:53 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 22817-03 for <java-user@lucene.apache.org>;
 Thu, 16 Apr 2009 08:39:51 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 5F9005186D
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 08:39:51 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <254EF120-C817-4087-97D3-3A33ABFACE06@gmail.com> <9ac0c6aa0904151441n7c74eba0y74d1aef57b4a0c92@mail.gmail.com> <372710B0-FFDD-4B37-9CA5-474AAEB3D841@gmail.com> <F4992669C9634BB4A354773564983A35@VEGA> <68E5FE9E-A08E-4760-BAAC-39036B27A4DB@gmail.com> <c68e39170904151806v512c8997p30cce6cee0537249@mail.gmail.com> <5B4307B7-457A-4687-B6EF-2D1CE045F2DC@gmail.com>
Subject: RE: BitSet Filter ArrayIndexOutOfBoundsException?
Date: Thu, 16 Apr 2009 08:39:52 +0200
Message-ID: <56F5DF30C15448BB8A56ED58C1CB4A95@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <5B4307B7-457A-4687-B6EF-2D1CE045F2DC@gmail.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
Thread-Index: Acm+MZdtSetxlKvVQ1ydOg72wjcvKgALAKLA
X-Virus-Checked: Checked by ClamAV on apache.org

> >> How would I get all the doc ids with a given (stored) field from a
> >> Reader?
> >>  I am trying:
> >>
> >>  TermDocs td = reader.termDocs();
> >
> > Relatively new in 2.9, you can pass null to enumerate over all non-
> > deleted docs:
> > TermDocs td = reader.termDocs(null);

Or even faster: use a column stride field (not yet available), but as a
workaround (see Michael Busch's talk at ApacheCon:
https://www.box.net/file/273223052/encoded/26352752/9701662183cdd5f9c7ff68b9
e25a631c): Index a "dummy" term for each document, attach a payload
containing the value to it and then use TermPositions on this single term,
iterating over all documents and retrieve the payload.

Uwe



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39737-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 09:14:44 2009
Return-Path: <java-user-return-39737-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66661 invoked from network); 16 Apr 2009 09:14:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 09:14:44 -0000
Received: (qmail 2457 invoked by uid 500); 16 Apr 2009 09:14:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2383 invoked by uid 500); 16 Apr 2009 09:14:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2373 invoked by uid 99); 16 Apr 2009 09:14:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 09:14:41 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.198.227] (HELO rv-out-0506.google.com) (209.85.198.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 09:14:34 +0000
Received: by rv-out-0506.google.com with SMTP id f6so271602rvb.5
        for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 02:14:13 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.68.2 with SMTP id q2mr1855137wfa.274.1239873253096; Thu, 
	16 Apr 2009 02:14:13 -0700 (PDT)
In-Reply-To: <68E5FE9E-A08E-4760-BAAC-39036B27A4DB@gmail.com>
References: <254EF120-C817-4087-97D3-3A33ABFACE06@gmail.com>
	 <9ac0c6aa0904151441n7c74eba0y74d1aef57b4a0c92@mail.gmail.com>
	 <372710B0-FFDD-4B37-9CA5-474AAEB3D841@gmail.com>
	 <F4992669C9634BB4A354773564983A35@VEGA>
	 <68E5FE9E-A08E-4760-BAAC-39036B27A4DB@gmail.com>
Date: Thu, 16 Apr 2009 05:14:13 -0400
Message-ID: <9ac0c6aa0904160214r611bcab1q8d6a94671edcb81b@mail.gmail.com>
Subject: Re: BitSet Filter ArrayIndexOutOfBoundsException?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Apr 15, 2009 at 8:35 PM, Ryan McKinley <ryantxu@gmail.com> wrote:

> I have an operation that is quite expensive that I am hoping to run only
> once for each time the index changes. =A0Is the

Couldn't you simply run your expensive operation, on the IndexReader
passed into getDocIdSet?

Ie, just move your current loop into the getDocIdSet, using the reader
it passes you?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39738-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 09:43:38 2009
Return-Path: <java-user-return-39738-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85768 invoked from network); 16 Apr 2009 09:43:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 09:43:38 -0000
Received: (qmail 37113 invoked by uid 500); 16 Apr 2009 09:43:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37044 invoked by uid 500); 16 Apr 2009 09:43:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37025 invoked by uid 99); 16 Apr 2009 09:43:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 09:43:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [87.233.177.133] (HELO core.aduna-software.com) (87.233.177.133)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 09:43:26 +0000
Received: from localhost (localhost [127.0.0.1])
	by core.aduna-software.com (Postfix) with ESMTP id 25E48128001
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 11:43:03 +0200 (CEST)
X-Virus-Scanned: amavisd-new at 
X-Spam-Score: -2.585
X-Spam-Level: 
Received: from core.aduna-software.com ([127.0.0.1])
	by localhost (core.aduna-software.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id L5TFGP5DzyWM for <java-user@lucene.apache.org>;
	Thu, 16 Apr 2009 11:42:58 +0200 (CEST)
Received: from [10.1.0.11] (5350580E.static.ziggozakelijk.nl [83.80.88.14])
	by core.aduna-software.com (Postfix) with ESMTP id 7DD64AA037A
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 11:42:58 +0200 (CEST)
Message-ID: <49E6FD9F.5080104@aduna-software.com>
Date: Thu, 16 Apr 2009 11:42:55 +0200
From: Christiaan Fluit <christiaan.fluit@aduna-software.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: semi-infinite loop during merging
References: <49E4573E.7070208@aduna-software.com> <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>
In-Reply-To: <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Flag: NO
X-Old-Spam-Status: No, score=-2.585 tagged_above=-10 required=4 tests=[AWL=0.014,
	BAYES_00=-2.599]

I spent a lot of time on getting the stacktraces, but JET seems to make 
this impossible. Ctrl-Break, connecting with JConsole, even a "Dump 
Threads" button in my UI that uses Threads.getAllStacktraces were not 
able to produce a dump of all threads.

I just got an additional confirmation that the problem also occurs with 
the Java build, but unfortunately the client's data is too sensitive to 
share it with me.

One option is to hack the Lucene 2.4.1 code to print out some additional 
debug info. Do you known some println's that would help?

Also I suspect that JET-compiled code is able to do Thread.dumpStack 
(but not Thread.getAllStackTraces), so what are good locations for doing 
that? E.g. IndexWriter.merge, etc.


Regards,

Chris
--

Michael McCandless wrote:
> Hmmm, very very odd.
> 
> First off, your "1 deleted docID" is because one document hit an
> exception during indexing, likely in enumerating tokens from the
> TokenStream; I see this line:
> 
>   IW 0 [CrawlThread]: hit exception adding document
> 
> But I think that's fine (certainly should not cause what you are
> seeing).
> 
> Indeed, it looks like IndexWriter decides it's time to merge the first
> 10 segments, and it starts that merge, but for some reason before that
> merge completes it seems to "recurse" and re-start the merge, to a
> different destination segment (_a then _b then _c, etc.).
> 
> Ie the first merge never completes (we don't see lines with
> "commitMerge: merge=... index=...").
> 
> I don't think "not being able to immediately delete on windows" should
> cause this; IW simply retries the delete periodically.  I think
> something more sinister is at play...
> 
> On Unix, one can "kill -SIGQUIT" to get a thread stack trace dump for
> all threads; do you know how to do this on Windows?  If so, can you do
> that at the end when IW starts doing this infinite merging?  That
> would be very helpful towards understanding why this recursion is
> happening (though it is spooky that this is all happening under
> JET...)
> 
> Mike
> 
> On Tue, Apr 14, 2009 at 5:28 AM, Christiaan Fluit
> <christiaan.fluit@aduna-software.com> wrote:
>> Hello all,
>>
>> I have a very peculiar problem that is driving me crazy: on some of our
>> datasets and at some point in time during indexing, the merge operation runs
>> into a (semi-)infinite loop and keeps adding files to the index until it
>> runs out of free disk space.
>>
>> The situation: I have an indexing application that uses Lucene 2.4.1. Only
>> one IndexWriter is involved, operating on a FSDirectory and using the
>> compound file format. The index is created from scratch. No IndexReaders or
>> IndexSearchers are open during indexing (double-checked by adding explicit
>> log statements where they are created).
>>
>> For reasons unrelated to Lucene, the application is compiled with JET, a
>> commercial Java Windows compiler. A regular Java build has produced the
>> problem only once. The JET build does it every time - unless I keep pressing
>> F5 continuously in Windows Explorer on the index dir.
>>
>> Here is what I see happening in the index dir:
>>
>> - At first, it builds _0.cfs to _9.cfs without problems. The files vary in
>> size between 12 MB and 49 MB and add up to about 250 MB.
>>
>> - Then, .del files are generated for some of these .cfs files. The number of
>> .del files and the .cfs files they correspond with differs from time to
>> time. I don't understand why these are created, as no IndexReaders exist at
>> this time.
>>
>> - Then, it generates files called _a.fdt, _a.fdx, _a.fnm, _a.frq, _a.nrm,
>> _a.prx, _a.tii, _a.tis, _a.tvd, _a.tvf, _a.tvx. Together these files add up
>> to 219 MB. I assume this is the start of the merge of the 10 .cfs files and
>> this is all still correct.
>>
>> - Then, it generates _b files with those same extensions, then _c, _d, etc.
>> It only keeps generating new files, I never see files disappear. The
>> original .cfs files are still there.
>>
>> - This continues until my hard drive is out of free space. At one test I was
>> at _8n and the index had grown from 250MB to 64 GB. Then the application
>> just hangs.
>>
>> Interestingly, after killing the application in this test, there were
>> _8k.cfs and _8m.cfs files of 20 MB and 27 MB respectively. No other .cfs
>> files existed.
>>
>> In some older threads on this list (e.g.
>> http://marc.info/?l=lucene-user&m=108300530413241&w=2) I read that "Win32
>> seems to sometimes not permit one to delete a file immediately after it has
>> been closed". Could this explain the problem? Perhaps the JET-compiled app
>> gets to delete the file quicker than when the code is running inside a Java
>> VM and therefore runs into this issue? This would also explain why pressing
>> F5 during indexing lets the application continue: external activity causing
>> some manual delay.
>>
>> At the end of this mail I have added the output of the InfoStream installed
>> on the IndexWriter, showing everything from the start to the first few
>> problematic merges. Lines starting with "===" are println's in my own code
>> to make sure that indeed only IndexWriters are generated and no
>> IndexSearchers/-Readers. The fun starts almost at the bottom, at the first
>> line containing "LMP: findMerges: 10 segments". The next lines then get
>> repeated over and over again, with different segment names. I cannot explain
>> why it mentions "1 deleted docIDs" a couple of lines below the first
>> "findMerges: 10" as no IndexWriter.deleteDocuments takes place.
>>
>> As you can see in this output, I am setting a SerialMergeScheduler to rule
>> out concurrency issues and making debugging easier. Both
>> SerialMergeScheduler and ConcurrentMergeScheduler give this problem though.
>>
>> I would be grateful if anyone could pose some light on this or can advise me
>> on what I can try next. I even considered hacking the FSDirectory code and
>> adding some delay in the deleteFile operation to see if the above-mentioned
>> win32 issue is the problem, but unless you know what you're doing, such
>> hacks can even cause such problems in the first place.
>>
>>
>> Kind regards,
>>
>> Chris
>> --
>>
>> === Creating new FSDirectory
>> === Opening indexWriter (create=true)
>> IFD [AWT-EventQueue-0]: setInfoStream
>> deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@9fb0688
>> IW 0 [AWT-EventQueue-0]: setInfoStream:
>> dir=org.apache.lucene.store.FSDirectory@D:\index autoCommit=false
>> mergePolicy=org.apache.lucene.index.LogByteSizeMergePolicy@a11d0d8
>> mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@a3fa9d8
>> ramBufferSizeMB=16.0 maxBufferedDocs=-1 maxBuffereDeleteTerms=-1
>> maxFieldLength=2147483647 index=
>> IW 0 [AWT-EventQueue-0]: setMergeScheduler
>> org.apache.lucene.index.SerialMergeScheduler@a3d1fe8
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=46.015 vs
>> trigger=16 allocMB=46.015 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
>> IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=46.015
>> allocMB=46.015
>> IW 0 [CrawlThread]:   flush: segment=_0 docStoreSegment=_0 docStoreOffset=0
>> flushDocs=true flushDeletes=false flushDocStores=false numDocs=2193
>> numBufDelTerms=0
>> IW 0 [CrawlThread]:   index before flush
>> IW 0 [CrawlThread]: DW: flush postings as segment _0 numDocs=2193
>> IW 0 [CrawlThread]: DW:   oldRAMSize=48249856 newFlushedSize=13379990
>> docs/MB=171.863 new/old=27.731%
>> IFD [CrawlThread]: now checkpoint "segments_1" [1 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: now checkpoint "segments_1" [1 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: delete "_0.fnm"
>> IFD [CrawlThread]: delete "_0.frq"
>> IFD [CrawlThread]: delete "_0.prx"
>> IFD [CrawlThread]: delete "_0.tis"
>> IFD [CrawlThread]: delete "_0.tii"
>> IFD [CrawlThread]: delete "_0.nrm"
>> IW 0 [CrawlThread]: LMP: findMerges: 1 segments
>> IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 1 segments
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs
>> trigger=16 allocMB=46.015 vs trigger=16.8 byteBlockFree=12.438
>> charBlockFree=8.969
>> IW 0 [CrawlThread]: DW:     after free: freedMB=30.841 usedMB=0.044
>> allocMB=15.173
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=6.806 vs
>> trigger=16 allocMB=16.829 vs trigger=16.8 byteBlockFree=0.812
>> charBlockFree=0
>> IW 0 [CrawlThread]: DW:     after free: freedMB=1.656 usedMB=6.806
>> allocMB=15.173
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=9.242 vs
>> trigger=16 allocMB=16.861 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     after free: freedMB=1.687 usedMB=9.242
>> allocMB=15.174
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=43.339 vs
>> trigger=16 allocMB=43.401 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
>> IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=43.339
>> allocMB=43.401
>> IW 0 [CrawlThread]:   flush: segment=_1 docStoreSegment=_0
>> docStoreOffset=2193 flushDocs=true flushDeletes=false flushDocStores=false
>> numDocs=1799 numBufDelTerms=0
>> IW 0 [CrawlThread]:   index before flush _0:c2193->_0
>> IW 0 [CrawlThread]: DW: flush postings as segment _1 numDocs=1799
>> IW 0 [CrawlThread]: DW:   oldRAMSize=45444096 newFlushedSize=12691373
>> docs/MB=148.635 new/old=27.927%
>> IFD [CrawlThread]: now checkpoint "segments_1" [2 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: now checkpoint "segments_1" [2 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: delete "_1.fnm"
>> IFD [CrawlThread]: delete "_1.frq"
>> IFD [CrawlThread]: delete "_1.prx"
>> IFD [CrawlThread]: delete "_1.tis"
>> IFD [CrawlThread]: delete "_1.tii"
>> IFD [CrawlThread]: delete "_1.nrm"
>> IW 0 [CrawlThread]: LMP: findMerges: 2 segments
>> IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 2 segments
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs
>> trigger=16 allocMB=43.401 vs trigger=16.8 byteBlockFree=11.781
>> charBlockFree=8.469
>> IW 0 [CrawlThread]: DW:     after free: freedMB=28.217 usedMB=0.044
>> allocMB=15.185
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=40.889 vs
>> trigger=16 allocMB=40.951 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
>> IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=40.889
>> allocMB=40.951
>> IW 0 [CrawlThread]:   flush: segment=_2 docStoreSegment=_0
>> docStoreOffset=3992 flushDocs=true flushDeletes=false flushDocStores=false
>> numDocs=1013 numBufDelTerms=0
>> IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0
>> IW 0 [CrawlThread]: DW: flush postings as segment _2 numDocs=1013
>> IW 0 [CrawlThread]: DW:   oldRAMSize=42874880 newFlushedSize=11684845
>> docs/MB=90.905 new/old=27.253%
>> IFD [CrawlThread]: now checkpoint "segments_1" [3 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: now checkpoint "segments_1" [3 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: delete "_2.fnm"
>> IFD [CrawlThread]: delete "_2.frq"
>> IFD [CrawlThread]: delete "_2.prx"
>> IFD [CrawlThread]: delete "_2.tis"
>> IFD [CrawlThread]: delete "_2.tii"
>> IFD [CrawlThread]: delete "_2.nrm"
>> IW 0 [CrawlThread]: LMP: findMerges: 3 segments
>> IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 3 segments
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs
>> trigger=16 allocMB=40.951 vs trigger=16.8 byteBlockFree=10.688
>> charBlockFree=8.062
>> IW 0 [CrawlThread]: DW:     after free: freedMB=25.779 usedMB=0.044
>> allocMB=15.172
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=38.82 vs
>> trigger=16 allocMB=38.883 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
>> IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=38.82
>> allocMB=38.883
>> IW 0 [CrawlThread]:   flush: segment=_3 docStoreSegment=_0
>> docStoreOffset=5005 flushDocs=true flushDeletes=false flushDocStores=false
>> numDocs=427 numBufDelTerms=0
>> IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0
>> IW 0 [CrawlThread]: DW: flush postings as segment _3 numDocs=427
>> IW 0 [CrawlThread]: DW:   oldRAMSize=40706048 newFlushedSize=10574425
>> docs/MB=42.342 new/old=25.978%
>> IFD [CrawlThread]: now checkpoint "segments_1" [4 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: now checkpoint "segments_1" [4 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: delete "_3.fnm"
>> IFD [CrawlThread]: delete "_3.frq"
>> IFD [CrawlThread]: delete "_3.prx"
>> IFD [CrawlThread]: delete "_3.tis"
>> IFD [CrawlThread]: delete "_3.tii"
>> IFD [CrawlThread]: delete "_3.nrm"
>> IW 0 [CrawlThread]: LMP: findMerges: 4 segments
>> IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 4 segments
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs
>> trigger=16 allocMB=38.883 vs trigger=16.8 byteBlockFree=9.312
>> charBlockFree=7.812
>> IW 0 [CrawlThread]: DW:     after free: freedMB=23.686 usedMB=0.044
>> allocMB=15.197
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=8.588 vs
>> trigger=16 allocMB=16.822 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     after free: freedMB=1.625 usedMB=8.588
>> allocMB=15.197
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=16.15 vs
>> trigger=16 allocMB=19.51 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
>> IW 0 [CrawlThread]: DW:     after free: freedMB=3.297 usedMB=16.15
>> allocMB=16.213
>> IW 0 [CrawlThread]:   flush: segment=_4 docStoreSegment=_0
>> docStoreOffset=5432 flushDocs=true flushDeletes=false flushDocStores=false
>> numDocs=1145 numBufDelTerms=0
>> IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0
>> IW 0 [CrawlThread]: DW: flush postings as segment _4 numDocs=1145
>> IW 0 [CrawlThread]: DW:   oldRAMSize=16934912 newFlushedSize=5040651
>> docs/MB=238.187 new/old=29.765%
>> IFD [CrawlThread]: now checkpoint "segments_1" [5 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: now checkpoint "segments_1" [5 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: delete "_4.fnm"
>> IFD [CrawlThread]: delete "_4.frq"
>> IFD [CrawlThread]: delete "_4.prx"
>> IFD [CrawlThread]: delete "_4.tis"
>> IFD [CrawlThread]: delete "_4.tii"
>> IFD [CrawlThread]: delete "_4.nrm"
>> IW 0 [CrawlThread]: LMP: findMerges: 5 segments
>> IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 5 segments
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=45.533 vs
>> trigger=16 allocMB=45.596 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
>> IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=45.533
>> allocMB=45.596
>> IW 0 [CrawlThread]:   flush: segment=_5 docStoreSegment=_0
>> docStoreOffset=6577 flushDocs=true flushDeletes=false flushDocStores=false
>> numDocs=808 numBufDelTerms=0
>> IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0 _4:c1145->_0
>> IW 0 [CrawlThread]: DW: flush postings as segment _5 numDocs=808
>> IW 0 [CrawlThread]: DW:   oldRAMSize=47745024 newFlushedSize=12761396
>> docs/MB=66.392 new/old=26.728%
>> IFD [CrawlThread]: now checkpoint "segments_1" [6 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: now checkpoint "segments_1" [6 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: delete "_5.fnm"
>> IFD [CrawlThread]: delete "_5.frq"
>> IFD [CrawlThread]: delete "_5.prx"
>> IFD [CrawlThread]: delete "_5.tis"
>> IFD [CrawlThread]: delete "_5.tii"
>> IFD [CrawlThread]: delete "_5.nrm"
>> IW 0 [CrawlThread]: LMP: findMerges: 6 segments
>> IW 0 [CrawlThread]: LMP:   level 6.37646 to 7.12646: 6 segments
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs
>> trigger=16 allocMB=45.596 vs trigger=16.8 byteBlockFree=11.5
>> charBlockFree=9.031
>> IW 0 [CrawlThread]: DW:     after free: freedMB=30.404 usedMB=0.044
>> allocMB=15.192
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=7.051 vs
>> trigger=16 allocMB=16.848 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     after free: freedMB=1.656 usedMB=7.051
>> allocMB=15.192
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=9.829 vs
>> trigger=16 allocMB=16.942 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     after free: freedMB=1.75 usedMB=9.829
>> allocMB=15.192
>> IW 0 [CrawlThread]: hit exception adding document
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=48.622 vs
>> trigger=16 allocMB=48.685 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     nothing to free; now set bufferIsFull
>> IW 0 [CrawlThread]: DW:     after free: freedMB=0 usedMB=48.622
>> allocMB=48.685
>> IW 0 [CrawlThread]:   flush: segment=_6 docStoreSegment=_0
>> docStoreOffset=7385 flushDocs=true flushDeletes=false flushDocStores=false
>> numDocs=1689 numBufDelTerms=0
>> IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0
>> IW 0 [CrawlThread]: DW: flush postings as segment _6 numDocs=1689
>> IW 0 [CrawlThread]: DW:   oldRAMSize=50983936 newFlushedSize=14095657
>> docs/MB=125.645 new/old=27.647%
>> IFD [CrawlThread]: now checkpoint "segments_1" [7 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: now checkpoint "segments_1" [7 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: delete "_6.fnm"
>> IFD [CrawlThread]: delete "_6.frq"
>> IFD [CrawlThread]: delete "_6.prx"
>> IFD [CrawlThread]: delete "_6.tis"
>> IFD [CrawlThread]: delete "_6.tii"
>> IFD [CrawlThread]: delete "_6.nrm"
>> IW 0 [CrawlThread]: LMP: findMerges: 7 segments
>> IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 7 segments
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=0.044 vs
>> trigger=16 allocMB=48.685 vs trigger=16.8 byteBlockFree=12.969
>> charBlockFree=9.594
>> IW 0 [CrawlThread]: DW:     after free: freedMB=33.498 usedMB=0.044
>> allocMB=15.187
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=7.007 vs
>> trigger=16 allocMB=16.812 vs trigger=16.8 byteBlockFree=0.281
>> charBlockFree=0
>> IW 0 [CrawlThread]: DW:     after free: freedMB=1.625 usedMB=7.007
>> allocMB=15.187
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=9.254 vs
>> trigger=16 allocMB=16.812 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     after free: freedMB=1.625 usedMB=9.254
>> allocMB=15.188
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=11.913 vs
>> trigger=16 allocMB=16.844 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     after free: freedMB=1.656 usedMB=11.913
>> allocMB=15.188
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=14.566 vs
>> trigger=16 allocMB=16.813 vs trigger=16.8 byteBlockFree=0 charBlockFree=0
>> IW 0 [CrawlThread]: DW:     after free: freedMB=1.625 usedMB=14.566
>> allocMB=15.189
>> IW 0 [CrawlThread]: DW:   RAM: now flush @ usedMB=16.151 allocMB=16.214
>> triggerMB=16
>> IW 0 [CrawlThread]:   flush: segment=_7 docStoreSegment=_0
>> docStoreOffset=9074 flushDocs=true flushDeletes=false flushDocStores=false
>> numDocs=2941 numBufDelTerms=0
>> IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0
>> IW 0 [CrawlThread]: DW: flush postings as segment _7 numDocs=2941
>> IW 0 [CrawlThread]: DW:   oldRAMSize=16935936 newFlushedSize=5920901
>> docs/MB=520.843 new/old=34.961%
>> IFD [CrawlThread]: now checkpoint "segments_1" [8 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: now checkpoint "segments_1" [8 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: delete "_7.fnm"
>> IFD [CrawlThread]: delete "_7.frq"
>> IFD [CrawlThread]: delete "_7.prx"
>> IFD [CrawlThread]: delete "_7.tis"
>> IFD [CrawlThread]: delete "_7.tii"
>> IFD [CrawlThread]: delete "_7.nrm"
>> IW 0 [CrawlThread]: LMP: findMerges: 8 segments
>> IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 8 segments
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=14.513 vs
>> trigger=16 allocMB=16.808 vs trigger=16.8 byteBlockFree=0 charBlockFree=0.75
>> IW 0 [CrawlThread]: DW:     after free: freedMB=1.625 usedMB=14.513
>> allocMB=15.183
>> IW 0 [CrawlThread]: DW:   RAM: now flush @ usedMB=16.057 allocMB=16.277
>> triggerMB=16
>> IW 0 [CrawlThread]:   flush: segment=_8 docStoreSegment=_0
>> docStoreOffset=12015 flushDocs=true flushDeletes=false flushDocStores=false
>> numDocs=3171 numBufDelTerms=0
>> IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0
>> IW 0 [CrawlThread]: DW: flush postings as segment _8 numDocs=3171
>> IW 0 [CrawlThread]: DW:   oldRAMSize=16836608 newFlushedSize=7011110
>> docs/MB=474.252 new/old=41.642%
>> IFD [CrawlThread]: now checkpoint "segments_1" [9 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: now checkpoint "segments_1" [9 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: delete "_8.fnm"
>> IFD [CrawlThread]: delete "_8.frq"
>> IFD [CrawlThread]: delete "_8.prx"
>> IFD [CrawlThread]: delete "_8.tis"
>> IFD [CrawlThread]: delete "_8.tii"
>> IFD [CrawlThread]: delete "_8.nrm"
>> IW 0 [CrawlThread]: LMP: findMerges: 9 segments
>> IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 9 segments
>> IW 0 [CrawlThread]: DW:   RAM: now balance allocations: usedMB=15.678 vs
>> trigger=16 allocMB=17.178 vs trigger=16.8 byteBlockFree=1.438
>> charBlockFree=0
>> IW 0 [CrawlThread]: DW:     nothing to free
>> IW 0 [CrawlThread]: DW:     after free: freedMB=1.438 usedMB=15.678
>> allocMB=15.74
>> IW 0 [CrawlThread]: DW:   RAM: now flush @ usedMB=16.067 allocMB=16.13
>> triggerMB=16
>> IW 0 [CrawlThread]:   flush: segment=_9 docStoreSegment=_0
>> docStoreOffset=15186 flushDocs=true flushDeletes=false flushDocStores=false
>> numDocs=3401 numBufDelTerms=0
>> IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0
>> _8:c3171->_0
>> IW 0 [CrawlThread]: DW: flush postings as segment _9 numDocs=3401
>> IW 0 [CrawlThread]: DW:   oldRAMSize=16847872 newFlushedSize=6184635
>> docs/MB=576.624 new/old=36.709%
>> IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: delete "_9.fnm"
>> IFD [CrawlThread]: delete "_9.frq"
>> IFD [CrawlThread]: delete "_9.prx"
>> IFD [CrawlThread]: delete "_9.tis"
>> IFD [CrawlThread]: delete "_9.tii"
>> IFD [CrawlThread]: delete "_9.nrm"
>> IW 0 [CrawlThread]: LMP: findMerges: 10 segments
>> IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 10 segments
>> IW 0 [CrawlThread]: LMP:     0 to 10: add this merge
>> IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0
>> _8:c3171->_0 _9:c3401->_0 [total 1 pending]
>> IW 0 [CrawlThread]: DW: apply 0 buffered deleted terms and 1 deleted docIDs
>> and 0 deleted queries on 10 segments.
>> IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit =
>> false]
>> IW 0 [CrawlThread]: now flush at merge
>> IW 0 [CrawlThread]:   flush: segment=null docStoreSegment=_0
>> docStoreOffset=18587 flushDocs=false flushDeletes=false flushDocStores=true
>> numDocs=0 numBufDelTerms=0
>> IW 0 [CrawlThread]:   index before flush _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0
>> _8:c3171->_0 _9:c3401->_0
>> IW 0 [CrawlThread]:   flush shared docStore segment _0
>> IW 0 [CrawlThread]: DW: closeDocStore: 2 files to flush to segment _0
>> numDocs=18587
>> IFD [CrawlThread]: now checkpoint "segments_1" [10 segments ; isCommit =
>> false]
>> IFD [CrawlThread]: delete "_0.fdt"
>> IFD [CrawlThread]: delete "_0.fdx"
>> IFD [CrawlThread]: delete "_0.fdt"
>> IFD [CrawlThread]: delete "_0.fdx"
>> IW 0 [CrawlThread]: now merge
>>  merge=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0
>> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _a
>>  merge=org.apache.lucene.index.MergePolicy$OneMerge@b590b98
>>  index=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0
>> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
>> IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
>> _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0
>> _9:c3401->_0 into _a
>> IW 0 [CrawlThread]: merge: total 18586 docs
>> IW 0 [CrawlThread]: LMP: findMerges: 10 segments
>> IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 10 segments
>> IW 0 [CrawlThread]: LMP:     0 to 10: add this merge
>> IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0
>> _8:c3171->_0 _9:c3401->_0 [total 1 pending]
>> IW 0 [CrawlThread]: now merge
>>  merge=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0
>> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _b
>>  merge=org.apache.lucene.index.MergePolicy$OneMerge@b590658
>>  index=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0
>> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
>> IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
>> _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0
>> _9:c3401->_0 into _b
>> IW 0 [CrawlThread]: merge: total 18586 docs
>> IW 0 [CrawlThread]: LMP: findMerges: 10 segments
>> IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 10 segments
>> IW 0 [CrawlThread]: LMP:     0 to 10: add this merge
>> IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0
>> _8:c3171->_0 _9:c3401->_0 [total 1 pending]
>> IW 0 [CrawlThread]: now merge
>>  merge=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0
>> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _c
>>  merge=org.apache.lucene.index.MergePolicy$OneMerge@b5906b8
>>  index=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0
>> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
>> IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
>> _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0
>> _9:c3401->_0 into _c
>> IW 0 [CrawlThread]: merge: total 18586 docs
>> IW 0 [CrawlThread]: LMP: findMerges: 10 segments
>> IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 10 segments
>> IW 0 [CrawlThread]: LMP:     0 to 10: add this merge
>> IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0
>> _8:c3171->_0 _9:c3401->_0 [total 1 pending]
>> IW 0 [CrawlThread]: now merge
>>  merge=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0
>> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _d
>>  merge=org.apache.lucene.index.MergePolicy$OneMerge@b5906e8
>>  index=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0
>> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
>> IW 0 [CrawlThread]: merging _0:c2193->_0 _1:c1799->_0 _2:c1013->_0
>> _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0
>> _9:c3401->_0 into _d
>> IW 0 [CrawlThread]: merge: total 18586 docs
>> IW 0 [CrawlThread]: LMP: findMerges: 10 segments
>> IW 0 [CrawlThread]: LMP:   level 6.39909 to 7.14909: 10 segments
>> IW 0 [CrawlThread]: LMP:     0 to 10: add this merge
>> IW 0 [CrawlThread]: add merge to pendingMerges: _0:c2193->_0 _1:c1799->_0
>> _2:c1013->_0 _3:c427->_0 _4:c1145->_0 _5:c808->_0 _6:c1689->_0 _7:c2941->_0
>> _8:c3171->_0 _9:c3401->_0 [total 1 pending]
>> IW 0 [CrawlThread]: now merge
>>  merge=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0
>> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0 into _e
>>  merge=org.apache.lucene.index.MergePolicy$OneMerge@b590688
>>  index=_0:c2193->_0 _1:c1799->_0 _2:c1013->_0 _3:c427->_0 _4:c1145->_0
>> _5:c808->_0 _6:c1689->_0 _7:c2941->_0 _8:c3171->_0 _9:c3401->_0
>> .......
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39739-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 10:15:14 2009
Return-Path: <java-user-return-39739-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10158 invoked from network); 16 Apr 2009 10:15:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 10:15:14 -0000
Received: (qmail 79038 invoked by uid 500); 16 Apr 2009 10:15:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78957 invoked by uid 500); 16 Apr 2009 10:15:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 82635 invoked by uid 99); 15 Apr 2009 17:38:30 -0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: FW: Binary indexing / query efficiency
Date: Wed, 15 Apr 2009 10:37:59 -0700
Message-ID: <1CFD7891521AAB4E8201FB7A78C9D36FCE30B7@mail-001.corp.automotive.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Binary indexing / query efficiency
Thread-Index: Acm9LJY14wmQ1/opRbWwjUVYv4/EawAxCSmA
From: "Eger, Patrick" <peger@automotive.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Resending, I think this got dropped by the list for some reason

---------

Hi, was recently looking to incorporate Lucene for a simple
"parametric"/"faceted" type search.  The documents are very small,
roughly 15 fields of short length (5-15 characters, generally strings
and padded integers). When profiling query performance of our
application, which inserts 1 million documents then
 1) filters on 1-3 fields with simple boolean/term matches
 2) stores these docids in a BitSet
 3) calls IndexSearcher.doc() to retrieve all matching documents (all
fields, 100 - 1,000,000 results per call)

It turns out that 98% of the query time was spent not actually doing the
query, but within the IndexSearcher.doc() call.

My first question is, is there any way to more efficiently get
(all/most) of the fields for a set of documents, other than iterating
and calling doc()?

Additionally, is there any way (or planned feature) to index *binary*
data? Using a profiler, I have determined that String decoding is a
significant performance limiter for my use-case:

90% of the application time is spent in this method:
---------------------------------------
org.apache.lucene.index.FieldsReader.addField(Document, FieldInfo,
boolean, boolean, boolean)


46% of the application time is spent decoding strings (half of the above
addField() time):
---------------------------------------org.apache.lucene.store.IndexInpu
t.readString()
	java.lang.String.<init>(byte[], int, int, String)
		java.lang.StringCoding.decode(String, byte[], int, int)
=09
java.lang.StringCoding$StringDecoder.decode(byte[], int, int)

(YJP profiler output available if needed)

String.intern() was my top hot spot, but my patch was accepted and fixed
this: https://issues.apache.org/jira/browse/LUCENE-1600. I'm not
familiar enough with the lucene codebase to figure out the above though,
so thought I would ask.



//ideally i'd be able to do add a binary field as such:
doc.add(new Field("f1",new
byte[]{1,2,3,4},Field.Store.YES,Field.Index.NOT_ANALYZED_NO_NORMS));

//then query like:
Query q =3D new TermQuery(new Term("f1",byte[]{1,2,3,4}))
searcher.search(q,...);

Which would allow me to avoid the Integer -> String -> Padded String ->
String -> Integer coding/decoding to index an integer, and avoid Object
-> String -> Object conversion (which per above is quite expensive).=20


Thanks for any help!


Regards,=20

Patrick

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39740-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 10:27:56 2009
Return-Path: <java-user-return-39740-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23581 invoked from network); 16 Apr 2009 10:27:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 10:27:56 -0000
Received: (qmail 4088 invoked by uid 500); 16 Apr 2009 10:27:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4002 invoked by uid 500); 16 Apr 2009 10:27:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3992 invoked by uid 99); 16 Apr 2009 10:27:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 10:27:54 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 10:27:46 +0000
Received: by ewy27 with SMTP id 27so330615ewy.5
        for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 03:27:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=TXielot8LAmm2sch5EJKFMnUjRcG3jzTVpPSZTRH6qI=;
        b=a2ut6Tmn8cK9rp7JJmB/CQ/J9brtBiD7dpvDuEfbLO0wkUy/J/PnWzdITnS6FCX47s
         JQy2NUOPwhyebG3B47E9wUl7uo4JC2/vyI/B/HjlvWqIlNiV9zq5zIwde/eOxn6RwU+x
         XegGSwZcwpUCwZIwZ7zvayE31X8Uq7nt1+IJ4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=L0flWnDMdhsE8y1uwPxpuxGCLeDYJSFxdptFFzQmBxvB/k6QogOLgPa9uKCR8dHT8W
         aiVRt+YasR83wHzZxajitsxcxb8eaGGvCUiPS6Ocimhz+1IX+6EznIiQMZIvfPtuIBDY
         QF2zrFufUR4SHleGGZsGryXRwdf4r0AaDxTeM=
MIME-Version: 1.0
Received: by 10.210.22.16 with SMTP id 16mr1278782ebv.72.1239877646067; Thu, 
	16 Apr 2009 03:27:26 -0700 (PDT)
Date: Thu, 16 Apr 2009 13:27:26 +0300
Message-ID: <d36c28c30904160327y55642450v8bcd34faa309dbd1@mail.gmail.com>
Subject: Query scoring
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174be0d0a8a90e0467a982f8
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174be0d0a8a90e0467a982f8
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

I try to understand why the following query gives the scoring below:

document 1 : a b c document 2 : g k a h u c


0.0 = (NON-MATCH) product of:
  0.0 = (NON-MATCH) sum of:
  0.0 = coord(0/3)
0.06155877

The query code is:
   IndexSearcher searcher = new IndexSearcher(path);
   Analyzer analyzer = new StandardAnalyzer();
   QueryParser parser = new QueryParser("text", analyzer);
   Query query = parser.parse("g k a h u c");
   Hits hits = searcher.search(query);
I also tried the WhiteSpaceAnalyzer.

Why does it give me "no match"?
doesn't if have to do "or" on each of the letters "g k a h u c"?

Thanks,
Liat

--0015174be0d0a8a90e0467a982f8--

From java-user-return-39741-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 11:31:42 2009
Return-Path: <java-user-return-39741-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52304 invoked from network); 16 Apr 2009 11:31:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 11:31:42 -0000
Received: (qmail 85976 invoked by uid 500); 16 Apr 2009 11:31:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85897 invoked by uid 500); 16 Apr 2009 11:31:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85887 invoked by uid 99); 16 Apr 2009 11:31:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 11:31:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 11:31:32 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LuPoF-0000n2-Pt
	for java-user@lucene.apache.org; Thu, 16 Apr 2009 04:31:11 -0700
Message-ID: <23076035.post@talk.nabble.com>
Date: Thu, 16 Apr 2009 04:31:11 -0700 (PDT)
From: cbodeguilla <cbodeguilla@gmail.com>
To: java-user@lucene.apache.org
Subject: IndexReader and numDocs
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: cbodeguilla@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello!!! My problem is that when I see the number or documents through
IndexWriter I see the number is 1 document. If I open IndexReader, the
numDocs sais there are no Documents...why???May u help me,please????

               writerFS.addDocument(indexa.indexaFichero(archivo));
               System.out.println(writerFS.numDocs());//there es 1 document


               Directory dir=writerFS.getDirectory();
               IndexReader ir= IndexReader.open(dir);
               System.out.println(ir.numDocs());//there are 0 documents

Thanks a lot!!
-- 
View this message in context: http://www.nabble.com/IndexReader-and-numDocs-tp23076035p23076035.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39742-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 11:35:27 2009
Return-Path: <java-user-return-39742-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54804 invoked from network); 16 Apr 2009 11:35:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 11:35:26 -0000
Received: (qmail 92798 invoked by uid 500); 16 Apr 2009 11:35:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92730 invoked by uid 500); 16 Apr 2009 11:35:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92720 invoked by uid 99); 16 Apr 2009 11:35:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 11:35:24 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 11:35:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id D7EF1512EC
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 13:34:52 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 04421-07 for <java-user@lucene.apache.org>;
 Thu, 16 Apr 2009 13:34:51 +0200 (CEST)
Received: from VEGA (unknown [134.102.249.78])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id DE3FE862B
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 13:34:50 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <23076035.post@talk.nabble.com>
Subject: RE: IndexReader and numDocs
Date: Thu, 16 Apr 2009 13:34:51 +0200
Message-ID: <62EC1BB27BAE4CD6947FBDD11E06BF83@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <23076035.post@talk.nabble.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
Thread-Index: Acm+hu+CAbX1AXFmQguVilt0mf4pGAAAF6yw
X-Virus-Checked: Checked by ClamAV on apache.org

You must close or commit first in the IndexWriter.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: cbodeguilla [mailto:cbodeguilla@gmail.com]
> Sent: Thursday, April 16, 2009 1:31 PM
> To: java-user@lucene.apache.org
> Subject: IndexReader and numDocs
> 
> 
> Hello!!! My problem is that when I see the number or documents through
> IndexWriter I see the number is 1 document. If I open IndexReader, the
> numDocs sais there are no Documents...why???May u help me,please????
> 
>                writerFS.addDocument(indexa.indexaFichero(archivo));
>                System.out.println(writerFS.numDocs());//there es 1
> document
> 
> 
>                Directory dir=writerFS.getDirectory();
>                IndexReader ir= IndexReader.open(dir);
>                System.out.println(ir.numDocs());//there are 0 documents
> 
> Thanks a lot!!
> --
> View this message in context: http://www.nabble.com/IndexReader-and-
> numDocs-tp23076035p23076035.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39743-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 12:01:33 2009
Return-Path: <java-user-return-39743-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68416 invoked from network); 16 Apr 2009 12:01:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 12:01:33 -0000
Received: (qmail 38424 invoked by uid 500); 16 Apr 2009 12:01:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38341 invoked by uid 500); 16 Apr 2009 12:01:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38331 invoked by uid 99); 16 Apr 2009 12:01:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 12:01:30 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of oren.liat@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 12:01:22 +0000
Received: by ey-out-2122.google.com with SMTP id 9so79921eyd.53
        for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 05:01:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=LdoUCv8sJeLzmfc24ilbDOr0Cu9As5CVfCPIsnUvivc=;
        b=wUUSzJwzmugTOOyvGPB23CLcPmUDK2xt8gbBOPXXjVu8VnkbCUBCZh4LFea0FdN+NC
         JkW49aBFuZvo7MFGiolbTc0r0D+Rb9F2x7MlMSiFm7drx2jGBU1JTTkdPbm5aTIusiPL
         TAIkxVFGmtUgB5j520RfVX49/6Ka9tMP+MloQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=rz2UfqiscdefCzHLTtulB0S7RThnteq2EQSaQ30HSGqERgw31e/nq+OUx/0R3EQVA+
         FdIr2sBWECqCgTj8boisOnyg/HO+djswvTH/3F1Pg5X86b7yvIZ78wfjkRpmnzcuzOpE
         psh6q2fSkupWTWo8WjigCisI3hk1A2i21bFvU=
MIME-Version: 1.0
Received: by 10.210.76.19 with SMTP id y19mr1382103eba.46.1239883262124; Thu, 
	16 Apr 2009 05:01:02 -0700 (PDT)
In-Reply-To: <d36c28c30904160327y55642450v8bcd34faa309dbd1@mail.gmail.com>
References: <d36c28c30904160327y55642450v8bcd34faa309dbd1@mail.gmail.com>
Date: Thu, 16 Apr 2009 15:01:02 +0300
Message-ID: <d36c28c30904160501t33ca3057sd587655b15ece941@mail.gmail.com>
Subject: Re: Query scoring
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174be00266e3ef0467aad1e8
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174be00266e3ef0467aad1e8
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I wanted to add also that I index it tokenized and that when I use Luke to
do this search, it gives the correct results.

Should I run the query differntly than the way I do?

2009/4/16 liat oren <oren.liat@gmail.com>

>  Hi,
>
> I try to understand why the following query gives the scoring below:
>
> document 1 : a b c document 2 : g k a h u c
>
>
> 0.0 = (NON-MATCH) product of:
>   0.0 = (NON-MATCH) sum of:
>   0.0 = coord(0/3)
> 0.06155877
>
> The query code is:
>    IndexSearcher searcher = new IndexSearcher(path);
>    Analyzer analyzer = new StandardAnalyzer();
>    QueryParser parser = new QueryParser("text", analyzer);
>    Query query = parser.parse("g k a h u c");
>    Hits hits = searcher.search(query);
> I also tried the WhiteSpaceAnalyzer.
>
> Why does it give me "no match"?
> doesn't if have to do "or" on each of the letters "g k a h u c"?
>
> Thanks,
> Liat
>
>
>
>

--0015174be00266e3ef0467aad1e8--

From java-user-return-39744-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 12:11:29 2009
Return-Path: <java-user-return-39744-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74575 invoked from network); 16 Apr 2009 12:11:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 12:11:27 -0000
Received: (qmail 48386 invoked by uid 500); 16 Apr 2009 12:11:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48295 invoked by uid 500); 16 Apr 2009 12:11:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48285 invoked by uid 99); 16 Apr 2009 12:11:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 12:11:24 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.174] (HELO wf-out-1314.google.com) (209.85.200.174)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 12:11:18 +0000
Received: by wf-out-1314.google.com with SMTP id 29so309848wff.20
        for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 05:10:56 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.231.7 with SMTP id d7mr2049132wfh.318.1239883856417; Thu, 
	16 Apr 2009 05:10:56 -0700 (PDT)
In-Reply-To: <49E6FD9F.5080104@aduna-software.com>
References: <49E4573E.7070208@aduna-software.com>
	 <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>
	 <49E6FD9F.5080104@aduna-software.com>
Date: Thu, 16 Apr 2009 08:10:56 -0400
Message-ID: <9ac0c6aa0904160510l6cf559c6yfc6b0c1deadbf1de@mail.gmail.com>
Subject: Re: semi-infinite loop during merging
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

One question: are you using IndexWriter.close(false)?  I wonder if
there's some path whereby the merges fail to abort (and simply keep
retrying) if you do that...

More inlined below...

On Thu, Apr 16, 2009 at 5:42 AM, Christiaan Fluit
<christiaan.fluit@aduna-software.com> wrote:
> I spent a lot of time on getting the stacktraces, but JET seems to make this
> impossible. Ctrl-Break, connecting with JConsole, even a "Dump Threads"
> button in my UI that uses Threads.getAllStacktraces were not able to produce
> a dump of all threads.

Sigh.

> I just got an additional confirmation that the problem also occurs with the
> Java build, but unfortunately the client's data is too sensitive to share it
> with me.

Could they "kill -QUIT" or  Ctrl-Break when it's happening?

> One option is to hack the Lucene 2.4.1 code to print out some additional
> debug info. Do you known some println's that would help?

How about adding this at the top of IndexWriter.handleMergeException:

  if (infoStream != null) {
    message("handleMergeException: merge=" +
merge.segString(directory) + " exc=" + t);
  }

?

You could also sprinkle prints in between where message("merge:
total"...) occurs and the call to commitMerge, in
IndexWriter.mergeMiddle.  The mystery here is why you see these two
lines in a row:

  IW 0 [CrawlThread]: merge: total 18586 docs
  IW 0 [CrawlThread]: LMP: findMerges: 10 segments

That first line is supposed to be followed by a "commitMerge: ..."
line.  I suspect some exception (maybe a MergeAbortedException) is
being hit, leading to the commit not happening.

> Also I suspect that JET-compiled code is able to do Thread.dumpStack (but
> not Thread.getAllStackTraces), so what are good locations for doing that?
> E.g. IndexWriter.merge, etc.

This would be great -- I would add that in handleMergeException as well.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39745-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 12:52:19 2009
Return-Path: <java-user-return-39745-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10934 invoked from network); 16 Apr 2009 12:52:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 12:52:19 -0000
Received: (qmail 98461 invoked by uid 500); 16 Apr 2009 12:52:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98378 invoked by uid 500); 16 Apr 2009 12:52:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 74969 invoked by uid 99); 16 Apr 2009 12:35:13 -0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
X-TM-IMSS-Message-ID:<91836caf00000c05@kecgate02.infosys.com>
From: "Radhalakshmi  Sreedharan" <Radhalakshmi_S@infosys.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Thu, 16 Apr 2009 18:04:30 +0530
Subject: Need help : SpanNearQuery
Thread-Topic: Need help : SpanNearQuery
Thread-Index: Acm+iNF1pm27j7zFQguuTqAOr5YfMAABtBKw
Message-ID: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30@BLRKECMBX09.ad.infosys.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_000_5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30BLRKECMBX09ad_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30BLRKECMBX09ad_
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi=20,

I=20have=20a=20question=20related=20to=20SpanNearQuery.

As=20of=20now,=20the=20=20SpanNearQuery=20has=20the=20constraint=20that=
=20all=20the=20terms=20need=20to=20present=20in=20the=20document.
Eg=20:=20If=20my=20SpanNearQuery=20terms=20=20are=20(=20ab,bc,cd)=20all=
=20of=20them=20need=20to=20be=20found=20within=20a=20span=20of=20"n"=20an=
d=20unordered.

But=20my=20requirement=20is=20similar=20to=20=20<http://www.gossamer-thre=
ads.com/lists/lucene/java-user/67382#67382>

I=20need=20a=20hit=20even=20if=20there=20are=202/3=20terms=20found=20with=
=20the=20span=20being=20applied=20for=20those=202=20terms.

Is=20there=20any=20custom=20implementation=20in=20place=20for=20this?=20I=
=20checked=20SrndQuery=20but=20that=20also=20doesn't=20work.

This=20is=20my=20workaround=20currently:


1)=20=20=20=20=20=20For=20a=20list=20of=20terms=20(=20ab,bc,=20cd,ef)=20,=
=20make=20a=20set=20like=20(=20ab,bc)=20,=20(=20bc,cd)=20(=20ab,cd)=20(bc=
,ef)=20(=20ab,bc,cd)=20(=20ab,bc,cd,ef).....=20and=20so=20on.

2)=20=20=20=20=20=20Create=20a=20spanNearQuery=20for=20=20each=20of=20the=
se=20terms

3)=20=20=20=20=20=20Add=20it=20to=20the=20booleanQuery=20with=20a=20=20SH=
OULD=20clause.


However=20this=20approach=20gives=20me=20puzzling=20scores
=20eg=20If=20my=20document=20has=20=20only=20(=20ab,bc,cd)=20the=20penalt=
y=20for=20the=20missing=20ef=20is=20very=20high=20and=20my=20score=20come=
s=20down=20quite=20a=20bit.

<=20the=20score=20value=20is=20=20of=20importance=20as=20I=20am=20using=
=20it=20further=20down=20the=20line=20for=20other=20calculations>

It=20would=20be=20great=20if=20you=20can=20help=20me=20out=20with=20this.

Regards,
Radha

****************=20CAUTION=20-=20Disclaimer=20*****************
This=20e-mail=20contains=20PRIVILEGED=20AND=20CONFIDENTIAL=20INFORMATION=
=20intended=20solely=20
for=20the=20use=20of=20the=20addressee(s).=20If=20you=20are=20not=20the=
=20intended=20recipient,=20please=20
notify=20the=20sender=20by=20e-mail=20and=20delete=20the=20original=20mes=
sage.=20Further,=20you=20are=20not=20
to=20copy,=20disclose,=20or=20distribute=20this=20e-mail=20or=20its=20con=
tents=20to=20any=20other=20person=20and=20
any=20such=20actions=20are=20unlawful.=20This=20e-mail=20may=20contain=20=
viruses.=20Infosys=20has=20taken=20
every=20reasonable=20precaution=20to=20minimize=20this=20risk,=20but=20is=
=20not=20liable=20for=20any=20damage=20
you=20may=20sustain=20as=20a=20result=20of=20any=20virus=20in=20this=20e-=
mail.=20You=20should=20carry=20out=20your=20
own=20virus=20checks=20before=20opening=20the=20e-mail=20or=20attachment.=
=20Infosys=20reserves=20the=20
right=20to=20monitor=20and=20review=20the=20content=20of=20all=20messages=
=20sent=20to=20or=20from=20this=20e-mail=20
address.=20Messages=20sent=20to=20or=20from=20this=20e-mail=20address=20m=
ay=20be=20stored=20on=20the=20
Infosys=20e-mail=20system.
***INFOSYS********=20End=20of=20Disclaimer=20********INFOSYS***

--_000_5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30BLRKECMBX09ad_--

From java-user-return-39746-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 14:59:20 2009
Return-Path: <java-user-return-39746-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99920 invoked from network); 16 Apr 2009 14:59:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 14:59:20 -0000
Received: (qmail 1197 invoked by uid 500); 16 Apr 2009 14:59:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1117 invoked by uid 500); 16 Apr 2009 14:59:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1097 invoked by uid 99); 16 Apr 2009 14:59:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 14:59:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [62.213.161.134] (HELO pmx.sirma.bg) (62.213.161.134)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 14:59:10 +0000
X-Virus-Scanned: Sirma Antivirus System
Received: from [192.168.128.140] (ivasilev.sirma.int [192.168.128.140])
	by pmx.sirma.bg (Sirma mail system) with ESMTP id 6A243244B8E
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 17:58:48 +0300 (EEST)
Message-ID: <49E747A8.8040200@sirma.bg>
Date: Thu, 16 Apr 2009 17:58:48 +0300
From: Ivan Vasilev <ivasilev@sirma.bg>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: LUCENE MAIL LIST <java-user@lucene.apache.org>
Subject: Best way for paging with TopDocs class?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,

As Hits class was deprecated in current Lucene and is expected to be 
excluded from Lucene 3.0 we decided to change our code so that to use 
TopDocs class.
Our app provides paging and now we are uondering what is the bset way to 
do it with th TopDocs. I can see only this possibility:
1. User opens page 1 - we load by searcher.search(..., docNum, ... ) 
method as many docs as for page 1;
2. User opens page 2 - we load as many results as the amount for page 1 
and page 2 (note that docs for page 1 are loaded again);
...
N. User opens page n - we load as many docs as the amount of all pages 
from #1 to #N (note that page 1 docs were loaded N-1 times, page 2 docs 
N-2 times etc).

With Hits class this loading of documents of previous pages was avoided 
- they were loaded once and when needed docs for the next page Hits just 
loaded the next portion of docs without reloading the previous pages.

So my question is:
Is there better way for paging with the class TopDocs than the one that 
I describe here?

Thanks in Advance,
Ivan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39747-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 15:14:12 2009
Return-Path: <java-user-return-39747-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30382 invoked from network); 16 Apr 2009 15:14:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 15:14:12 -0000
Received: (qmail 24489 invoked by uid 500); 16 Apr 2009 15:14:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24449 invoked by uid 500); 16 Apr 2009 15:14:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24439 invoked by uid 99); 16 Apr 2009 15:14:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 15:14:09 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.221.121 as permitted sender)
Received: from [209.85.221.121] (HELO mail-qy0-f121.google.com) (209.85.221.121)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 15:14:02 +0000
Received: by qyk27 with SMTP id 27so761254qyk.29
        for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 08:13:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Jo2FSnOotn6hfd8xBvywxECDzz5eCERPCfj5vMBWPOk=;
        b=VSCkOlm4iZBcpcYVuPmb5oa2Xn0B/9/Fh0jfQZz1NA+XKpO4cfAVi2jzw0YLaLmjUz
         hmrhcz8VBzcmf3YAzxIcHzjE5G9PQvsH4pdNYLZBz2dC+W5j1pf403aLzpldhGAWywtv
         ///5EVXAJfrKh/7JmD5kNhYsesBvVvxFLl6MY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=jMTv0seDOkal6K/vCLW/1xgtrKYGKMhlYPIbOmJC1bduilYpkY6QcNVwgK39kZuoJA
         Qrk/Qjqbh3j5Hs2iMiGJsxxbRwONEqRH8D9Xuwi32+fFJM3FS97huoIKI7IFUzUA0KS3
         WMzDZnwjkFAwAtwUqVfoarEUiUuktl1LIwxH8=
MIME-Version: 1.0
Received: by 10.220.75.19 with SMTP id w19mr411370vcj.110.1239894821375; Thu, 
	16 Apr 2009 08:13:41 -0700 (PDT)
In-Reply-To: <d36c28c30904160501t33ca3057sd587655b15ece941@mail.gmail.com>
References: <d36c28c30904160327y55642450v8bcd34faa309dbd1@mail.gmail.com>
	 <d36c28c30904160501t33ca3057sd587655b15ece941@mail.gmail.com>
Date: Thu, 16 Apr 2009 11:13:41 -0400
Message-ID: <359a92830904160813m9c1ebe4w23d71d99422e66e0@mail.gmail.com>
Subject: Re: Query scoring
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e647ecfc630f760467ad823a
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e647ecfc630f760467ad823a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hmmm, try query.toString() and/or query.explain().

Also, try using Luke to see what is actually in the document.
BTW, what analyzer did you use in Luke? Luke also has an
explain (tab?) that will show you what Luke does, which may
be useful.

The default operator should be "OR", but looking at the actual
query should help you figure out whether that's happening.

Best
Erick


On Thu, Apr 16, 2009 at 8:01 AM, liat oren <oren.liat@gmail.com> wrote:

> I wanted to add also that I index it tokenized and that when I use Luke to
> do this search, it gives the correct results.
>
> Should I run the query differntly than the way I do?
>
> 2009/4/16 liat oren <oren.liat@gmail.com>
>
> >  Hi,
> >
> > I try to understand why the following query gives the scoring below:
> >
> > document 1 : a b c document 2 : g k a h u c
> >
> >
> > 0.0 = (NON-MATCH) product of:
> >   0.0 = (NON-MATCH) sum of:
> >   0.0 = coord(0/3)
> > 0.06155877
> >
> > The query code is:
> >    IndexSearcher searcher = new IndexSearcher(path);
> >    Analyzer analyzer = new StandardAnalyzer();
> >    QueryParser parser = new QueryParser("text", analyzer);
> >    Query query = parser.parse("g k a h u c");
> >    Hits hits = searcher.search(query);
> > I also tried the WhiteSpaceAnalyzer.
> >
> > Why does it give me "no match"?
> > doesn't if have to do "or" on each of the letters "g k a h u c"?
> >
> > Thanks,
> > Liat
> >
> >
> >
> >
>

--0016e647ecfc630f760467ad823a--

From java-user-return-39748-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 15:25:08 2009
Return-Path: <java-user-return-39748-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38288 invoked from network); 16 Apr 2009 15:25:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 15:25:07 -0000
Received: (qmail 48851 invoked by uid 500); 16 Apr 2009 15:25:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48760 invoked by uid 500); 16 Apr 2009 15:25:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48750 invoked by uid 99); 16 Apr 2009 15:25:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 15:25:04 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 15:24:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 95B195180A
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 17:24:33 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 19145-05 for <java-user@lucene.apache.org>;
 Thu, 16 Apr 2009 17:24:31 +0200 (CEST)
Received: from VEGA (unknown [134.102.249.78])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 558B751156
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 17:24:31 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <49E747A8.8040200@sirma.bg>
Subject: RE: Best way for paging with TopDocs class?
Date: Thu, 16 Apr 2009 17:24:44 +0200
Message-ID: <C605EFA20CA145A392D725C380039EED@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <49E747A8.8040200@sirma.bg>
X-MIMEOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
Thread-Index: Acm+o+17Bfjs+nEwTmidvKs8DwBGJwAA2Hjw
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Ivan,

We had this discussion some time ago on this list, too. I explained another
guy a possibility for TopDocs caching. Just search in the list archives!

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Ivan Vasilev [mailto:ivasilev@sirma.bg]
> Sent: Thursday, April 16, 2009 4:59 PM
> To: LUCENE MAIL LIST
> Subject: Best way for paging with TopDocs class?
> 
> Hi All,
> 
> As Hits class was deprecated in current Lucene and is expected to be
> excluded from Lucene 3.0 we decided to change our code so that to use
> TopDocs class.
> Our app provides paging and now we are uondering what is the bset way to
> do it with th TopDocs. I can see only this possibility:
> 1. User opens page 1 - we load by searcher.search(..., docNum, ... )
> method as many docs as for page 1;
> 2. User opens page 2 - we load as many results as the amount for page 1
> and page 2 (note that docs for page 1 are loaded again);
> ...
> N. User opens page n - we load as many docs as the amount of all pages
> from #1 to #N (note that page 1 docs were loaded N-1 times, page 2 docs
> N-2 times etc).
> 
> With Hits class this loading of documents of previous pages was avoided
> - they were loaded once and when needed docs for the next page Hits just
> loaded the next portion of docs without reloading the previous pages.
> 
> So my question is:
> Is there better way for paging with the class TopDocs than the one that
> I describe here?
> 
> Thanks in Advance,
> Ivan
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39749-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 15:32:21 2009
Return-Path: <java-user-return-39749-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43709 invoked from network); 16 Apr 2009 15:32:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 15:32:21 -0000
Received: (qmail 62292 invoked by uid 500); 16 Apr 2009 15:32:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62215 invoked by uid 500); 16 Apr 2009 15:32:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62193 invoked by uid 99); 16 Apr 2009 15:32:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 15:32:18 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.92.24 as permitted sender)
Received: from [74.125.92.24] (HELO qw-out-2122.google.com) (74.125.92.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 15:32:12 +0000
Received: by qw-out-2122.google.com with SMTP id 8so345338qwh.53
        for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 08:31:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=UPi+frv+64o5l7iKxtobLyJOdJdpwR4fvZ5Dxzwy5gg=;
        b=kRndT6qstyQuo12S8L6TEf49xgsNgxHk3lwsqpoGEL5NORgzWNREY+m4NSMbqER0iy
         Z4JkLZ/XFsAXT5giQtUNbsOpuclHLULHc+jQEx30FcD8H+4NbUbbv4RmYzXN6uRR2lLR
         zecf9awwRbPfzAhIvVq0uOvrzhMa+sx2ieW04=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=DH8QhGBwnqnD3qsifWXC5WuoWWZ6uK9sTh5b6743KlE9eOmjCMnAzEptyWkPwkXylm
         8MUEPAGZyrQRdEAo+D9S8WxwlZHXqb3fOzMtDAQr2pJmZUp3Vp3nTgtHra4SaZcRuyja
         8zUBJG0jKEqTRROSCp+W3GcSSBv0Lnzf73si8=
MIME-Version: 1.0
Received: by 10.220.46.146 with SMTP id j18mr443630vcf.45.1239895911015; Thu, 
	16 Apr 2009 08:31:51 -0700 (PDT)
In-Reply-To: <49E747A8.8040200@sirma.bg>
References: <49E747A8.8040200@sirma.bg>
Date: Thu, 16 Apr 2009 11:31:50 -0400
Message-ID: <359a92830904160831r48db1bffuf7729489bf90bceb@mail.gmail.com>
Subject: Re: Best way for paging with TopDocs class?
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636284f2255a91a0467adc3d5
X-Virus-Checked: Checked by ClamAV on apache.org

--001636284f2255a91a0467adc3d5
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Well, under the covers, the old Hits object *was* reloading the first N
pages to
get page N + 1, you just didn't see it. Hits also had other, undesirable
behaviors.

But "loading docs N-1 times" it's not as expensive as you perhaps fear.
To get a sorted list, you must sort the entire set of documents. Which
means to get, say, page 3 in some sort order, somewhere, sometime
you must keep track of the scores for documents 1-200 in order to
insure that docs 201-300 are really in the proper place. Since a
TopDocs is just an int/float pair we're not talking about much memory.

So I'd advise just going about it as you outlined. The *real* savings would
be in not re-executing the search every page, but I wouldn't think about
a caching scheme unless you demonstrate a problem. And if you were
making due with Hits before, I suspect this isn't really a problem....

Best
Erick


On Thu, Apr 16, 2009 at 10:58 AM, Ivan Vasilev <ivasilev@sirma.bg> wrote:

> Hi All,
>
> As Hits class was deprecated in current Lucene and is expected to be
> excluded from Lucene 3.0 we decided to change our code so that to use
> TopDocs class.
> Our app provides paging and now we are uondering what is the bset way to do
> it with th TopDocs. I can see only this possibility:
> 1. User opens page 1 - we load by searcher.search(..., docNum, ... ) method
> as many docs as for page 1;
> 2. User opens page 2 - we load as many results as the amount for page 1 and
> page 2 (note that docs for page 1 are loaded again);
> ...
> N. User opens page n - we load as many docs as the amount of all pages from
> #1 to #N (note that page 1 docs were loaded N-1 times, page 2 docs N-2 times
> etc).
>
> With Hits class this loading of documents of previous pages was avoided -
> they were loaded once and when needed docs for the next page Hits just
> loaded the next portion of docs without reloading the previous pages.
>
> So my question is:
> Is there better way for paging with the class TopDocs than the one that I
> describe here?
>
> Thanks in Advance,
> Ivan
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636284f2255a91a0467adc3d5--

From java-user-return-39750-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 17:05:10 2009
Return-Path: <java-user-return-39750-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89978 invoked from network); 16 Apr 2009 17:05:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 17:05:09 -0000
Received: (qmail 80079 invoked by uid 500); 16 Apr 2009 17:05:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80003 invoked by uid 500); 16 Apr 2009 17:05:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79972 invoked by uid 99); 16 Apr 2009 17:05:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 17:05:07 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.1.71] (HELO mx1.syr.edu) (128.230.1.71)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 17:04:57 +0000
Received: from suex07-hub-02.ad.syr.edu (suex07-hub-02.ad.syr.edu [128.230.108.196])
	by mx1.syr.edu (8.14.3/8.14.3) with ESMTP id n3GH4aAv029267
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 13:04:36 -0400
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-02.ad.syr.edu ([fe80::813b:49a2:a4d5:6367%10]) with mapi; Thu, 16
 Apr 2009 13:04:36 -0400
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Thu, 16 Apr 2009 13:04:35 -0400
Subject: RE: Need help : SpanNearQuery
Thread-Topic: Need help : SpanNearQuery
Thread-Index: Acm+iNF1pm27j7zFQguuTqAOr5YfMAABtBKwAAgjfKA=
Message-ID: <2D127F11DC79714E9B6A43AC9458147F13FCA3C7@suex07-mbx-03.ad.syr.edu>
References: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30@BLRKECMBX09.ad.infosys.com>
In-Reply-To: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30@BLRKECMBX09.ad.infosys.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.7400:2.4.4,1.2.40,4.0.166 definitions=2009-04-16_08:2009-04-15,2009-04-16,2009-04-16 signatures=0
X-Proofpoint-Spam-Reason: safe
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Radha,

On 4/16/2009 at 8:35 AM, Radhalakshmi Sredharan wrote:
> I have a question related to SpanNearQuery.
>=20
> I need a hit even if there are 2/3 terms found with the span being
> applied for those 2 terms.
>=20
> Is there any custom implementation in place for this? I checked
> SrndQuery but that also doesn't work.
>=20
> This is my workaround currently:
>=20
> 1)      For a list of terms ( ab,bc, cd,ef) , make a set like ( ab,bc)
> , ( bc,cd) ( ab,cd) (bc,ef) ( ab,bc,cd) ( ab,bc,cd,ef)..... and so on.
>=20
> 2)      Create a spanNearQuery for  each of these terms
>=20
> 3)      Add it to the booleanQuery with a  SHOULD clause.
>=20
> However this approach gives me puzzling scores
>  eg If my document has  only ( ab,bc,cd) the penalty for the missing ef
> is very high and my score comes down quite a bit.

Do you know about the scoring documentation on the Lucene site: <http://luc=
ene.apache.org/java/2_4_1/scoring.html> ?  In particular, see the link from=
 there to the Searcher.explain() javadocs - this functionality will help yo=
u understand what's happening with your queries.

I suspect that the penalty is due to fewer sub-queries matching; that is, n=
ot only does (ab,bc,cd,ef) fail to match, but (ab,bc,ef), (ab,cd,ef), (ab,e=
f) etc. also fail to match, and since all of these contribute to the final =
score, you will see a large drop off if you don't get a full match.

Instead of putting all of the alternatives together in a single large disju=
nction, if you package them such that the shorter alternatives don't influe=
nce the final score when larger ones match, you may get something more like=
 what you want.  I think DisjunctionMaxQuery <http://lucene.apache.org/java=
/2_4_1/api/org/apache/lucene/search/DisjunctionMaxQuery.html>, along with j=
udicious boosting, will do the trick, e.g.:

DMQ((ab,bc,cd,ef)^100,
    ((ab,bc,cd)^10 (ab,bc,ef)^10 (ab,cd,ef)^10 ...),
    ((ab,bc) (ab,cd) (ab,ef) ...))

Steve


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39751-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 17:22:47 2009
Return-Path: <java-user-return-39751-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98384 invoked from network); 16 Apr 2009 17:22:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 17:22:47 -0000
Received: (qmail 30232 invoked by uid 500); 16 Apr 2009 17:22:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30180 invoked by uid 500); 16 Apr 2009 17:22:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30170 invoked by uid 99); 16 Apr 2009 17:22:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 17:22:44 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of vcomandur@gmail.com designates 74.125.44.30 as permitted sender)
Received: from [74.125.44.30] (HELO yx-out-2324.google.com) (74.125.44.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 17:22:37 +0000
Received: by yx-out-2324.google.com with SMTP id 8so310437yxb.5
        for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 10:22:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=fCGqJxQZsuXYgut4hNMglbYZonDDeZR1n/ofRsqUGMg=;
        b=j1h9gkVcfTWJBfVbcaj/JA5eiAlm6Op61lIEh8r/D/H/nkShr8B7PPM5OCQU7P0ROK
         W6GhD4B1FA5YSk7nBFI/PZNhujRmu1NvHim2/21zaqidsFvzF24pybz8qDkMICAesaPe
         W+8Z50WQHnApshir2OJB7FhzWuHVylrhVRhD8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=sxl/pt+0SZRoKW5QHtyQoZ0Zg5RxNYCOgjbSFLJEYs78pZ+Pc79y44p6RNg5HXTrL2
         KpQNav16VhCXAE/g4v8FnXnW5vIy3E12ucp9zUXm1WFiyYknlqXhIuPkx72WxWFdia3B
         113J6xXtfLOQFBDU2SPofMkZqHJsbQVG/0Q2E=
MIME-Version: 1.0
Received: by 10.220.92.194 with SMTP id s2mr649581vcm.10.1239902536803; Thu, 
	16 Apr 2009 10:22:16 -0700 (PDT)
Date: Thu, 16 Apr 2009 22:52:16 +0530
Message-ID: <a59386fa0904161022r2172f36nd95a94662a017791@mail.gmail.com>
Subject: Google's search Appliance relevance ranking
From: Vasudevan Comandur <vcomandur@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163628360243268b0467af4e80
X-Virus-Checked: Checked by ClamAV on apache.org

--00163628360243268b0467af4e80
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

   The question that I am posting in this group may be inappropriate and I
want to apologize for that.

   My question is, what is the relevance ranking algorithm which is used in
Google Search Appliance (GSA) because the search
   is predominantly on documents rather than web pages.

   I appreciate if any of you can send me pointers to the algorithm used by
google.

Regards
 Vasu

--00163628360243268b0467af4e80--

From java-user-return-39752-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 17:37:35 2009
Return-Path: <java-user-return-39752-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9536 invoked from network); 16 Apr 2009 17:37:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 17:37:35 -0000
Received: (qmail 52262 invoked by uid 500); 16 Apr 2009 17:37:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52188 invoked by uid 500); 16 Apr 2009 17:37:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52178 invoked by uid 99); 16 Apr 2009 17:37:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 17:37:32 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stopman@gmail.com designates 74.125.44.30 as permitted sender)
Received: from [74.125.44.30] (HELO yx-out-2324.google.com) (74.125.44.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 17:37:21 +0000
Received: by yx-out-2324.google.com with SMTP id 8so314147yxb.5
        for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 10:37:00 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=jL7og2dNdicrYn/iPkUzh5tAy+T4yERZesnoWXAJjjY=;
        b=CVywMcVa4ZhgY4Ag9P7N2kPdL0RAQC8lgsd1Zrt7nzts9WcCjOhvArovrTT0rI+vqT
         c06Cxo/u7mwy2nriN2070VaOjRUlissgbuYTXWvWKncqD9cTb44NSAf7420IJxTh4ibv
         TZF8lpn6LxCUTu5PN1EP2HNFXqZs8xuwaCtNk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=FeABvRs0Pv58Lpl1cJeL3BVGvYfoGFHQw6pdKNmQiobB49RtbWIjQ3bWsuyj9jiPfX
         XCGhAuPXqzNrCeximLkxUChV6D68iqKyZgcHiVg5ZzqmA/vs1v9DoDSuZm116hQisxLW
         HXlsYnF3yqeowmc90O7BLVgyhN6vM74A15+PU=
MIME-Version: 1.0
Received: by 10.100.13.2 with SMTP id 2mr2307323anm.132.1239903420248; Thu, 16 
	Apr 2009 10:37:00 -0700 (PDT)
In-Reply-To: <6c33f9950707072019g24d5143ao6a53ed5794cc7b05@mail.gmail.com>
References: <6c33f9950707072019g24d5143ao6a53ed5794cc7b05@mail.gmail.com>
Date: Thu, 16 Apr 2009 10:37:00 -0700
Message-ID: <652776090904161037l456b5b58p10b6706d88652c10@mail.gmail.com>
Subject: Re: Lucene index sizes and performance
From: Michael Stoppelman <stopman@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e644c766eb74030467af821d
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e644c766eb74030467af821d
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

On Sat, Jul 7, 2007 at 8:19 PM, Chun Wei Ho <cwho.work@gmail.com> wrote:

> We are currently running a search service with a single Lucene index
> of about 10 GB. We would like to find out:
>
> (a) What is the usual index size of everyone else? How large have
> Lucene index gone in prodution environments, and is there a sort of a
> optimal size that Lucene indexes should be?
>

Same here. I'm interested in this answer too... If you're serving a lot of
traffic and need to highlight docs you need to keep
everything in memory. That's my lesson to share with the world.


>
> (b) With a index size of 10GB, how much memory would you recommend a
> dual 3GHz machine serving searches on it to have. We currently have
> 4GB RAM and are thinking of adding more for faster searches?
>
> Is there a ballpark figure or guide that we can adhere to - so we
> might add more RAM depending on the rate of index growth.
>
>
> (c) We're considered the possibility of splitting our large index into
> several smaller ones based on discussions in previous threads.
>
> Did anyone do so here and how did you manage it - splitting by logical
> category, or splitting by time (so perhaps a index that holds 2 months
> worth of documents might be split into 8 indexes of 1 week each). How
> would the searching application handle/merge results from different
> indexes?
>

Yes, this works. The most important thing if you're serving lots of traffic
is to have a master indexing box (that doesn't allow reading) and distribute
those copies to the slaves that are readonly. Also, when you copy your
indices out to slaves and the memory on them isn't twice as big as your
index you can use rsync w/ the fadvise patch (
http://insights.oetiker.ch/linux/fadvise.html) so the current index isn't
evicted from the disk cache (in linux).

I'm not sure about the combining of results, maybe this will help
http://sujitpal.blogspot.com/2007/08/remote-lucene-indexes.html


>
>
> Regards,
> CW
>
> Just a postscript here to thank mailing list folks who have been
> providing us with guidance on Lucene all this time :)
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e644c766eb74030467af821d--

From java-user-return-39753-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 18:37:10 2009
Return-Path: <java-user-return-39753-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52634 invoked from network); 16 Apr 2009 18:37:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 18:37:10 -0000
Received: (qmail 33795 invoked by uid 500); 16 Apr 2009 18:37:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33705 invoked by uid 500); 16 Apr 2009 18:37:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33685 invoked by uid 99); 16 Apr 2009 18:37:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 18:37:07 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [62.213.161.134] (HELO pmx.sirma.bg) (62.213.161.134)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 18:37:01 +0000
X-Virus-Scanned: Sirma Antivirus System
Received: from [192.168.128.140] (ivasilev.sirma.int [192.168.128.140])
	by pmx.sirma.bg (Sirma mail system) with ESMTP id 1ACF8244B91
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 21:36:39 +0300 (EEST)
Message-ID: <49E77AB7.80904@sirma.bg>
Date: Thu, 16 Apr 2009 21:36:39 +0300
From: Ivan Vasilev <ivasilev@sirma.bg>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Best way for paging with TopDocs class?
References: <49E747A8.8040200@sirma.bg>
In-Reply-To: <49E747A8.8040200@sirma.bg>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

OK Guys Thanks ,

Thanks for your help. I really think that paging without caching will be 
best for in case. I think in most cases users find results in the first 
page. When not, I think they would not not go through more than 2-3 more 
pages or just will narrow the search by adding more filter words.
As Erick says the performance will be with no practical difference. If 
not I can apply caching. But I think unnecessary caching results on most 
one-page queries will just make more usage of RAM and after that GC what 
is worse that avoiding cache at all.

Thanks Again,
Ivan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39754-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 20:11:23 2009
Return-Path: <java-user-return-39754-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85808 invoked from network); 16 Apr 2009 20:11:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 20:11:23 -0000
Received: (qmail 70752 invoked by uid 500); 16 Apr 2009 20:11:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70663 invoked by uid 500); 16 Apr 2009 20:11:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70653 invoked by uid 99); 16 Apr 2009 20:11:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 20:11:21 +0000
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=PLING_QUERY,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 20:11:12 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LuXv9-0005vb-D4
	for java-user@lucene.apache.org; Thu, 16 Apr 2009 13:10:51 -0700
Message-ID: <23085506.post@talk.nabble.com>
Date: Thu, 16 Apr 2009 13:10:51 -0700 (PDT)
From: rufus1 <aornstein@webmd.net>
To: java-user@lucene.apache.org
Subject: A Challenge!: Combining 2 searches into a single resultset?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: aornstein@webmd.net
X-Virus-Checked: Checked by ClamAV on apache.org


hi!

I am trying to do something a little unique...

I have a 90k text documents that I am trying to search
Search A: indexes and searches the documents using regular relevancy search
Search B: indexes and searches the documents using a smaller subset of "key"
words that I have chosen

This gives me 2 seperate scores: Score A, and Score B...

I am trying to show the top 10 results of the scores combined so....

FinalScoretextDoc = (scoreA_of_td1 * 0.5) * (scoreB_of_td1 * 0.5)

While it seems straightforward, I do not want to calculate the scores of all
the documents outside of lucene.  How can I integrate this better into the
lucene search engine?  Is this possible to do by any simple means?

Thanks guys + gals!

-- 
View this message in context: http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23085506.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39755-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 22:26:40 2009
Return-Path: <java-user-return-39755-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52674 invoked from network); 16 Apr 2009 22:26:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 22:26:40 -0000
Received: (qmail 54383 invoked by uid 500); 16 Apr 2009 22:26:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54287 invoked by uid 500); 16 Apr 2009 22:26:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54277 invoked by uid 99); 16 Apr 2009 22:26:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 22:26:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 22:26:29 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id EEF6E71C3A0; Thu, 16 Apr 2009 15:26:08 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id EAAF371C354
	for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 15:26:08 -0700 (PDT)
Date: Thu, 16 Apr 2009 15:26:08 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Lucene SnowBall unexpected behavior for some terms
In-Reply-To: <565F3878-B14C-44E9-9DFF-DD7955EDA218@apache.org>
Message-ID: <Pine.LNX.4.64.0904161525140.9661@radix.cryptio.net>
References: <22991689.post@talk.nabble.com> <23049935.post@talk.nabble.com>
 <569173.32992.qm@web50311.mail.re2.yahoo.com> <565F3878-B14C-44E9-9DFF-DD7955EDA218@apache.org>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: little bit about back compatibility with regards to contrib.

...which were noted in contrib/CHANGES.txt



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39756-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 22:40:20 2009
Return-Path: <java-user-return-39756-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53862 invoked from network); 16 Apr 2009 22:40:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 22:40:20 -0000
Received: (qmail 57184 invoked by uid 500); 16 Apr 2009 22:27:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57053 invoked by uid 500); 16 Apr 2009 22:27:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57027 invoked by uid 99); 16 Apr 2009 22:27:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 22:27:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bradfordstephens@gmail.com designates 209.85.198.225 as permitted sender)
Received: from [209.85.198.225] (HELO rv-out-0506.google.com) (209.85.198.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 22:27:38 +0000
Received: by rv-out-0506.google.com with SMTP id f6so530333rvb.5
        for <multiple recipients>; Thu, 16 Apr 2009 15:27:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=Nm7aiF0hwYB2vlU0l0WCeOm1VPuVFhBRvq3cHGtAwiI=;
        b=PcW/nW6fHu8Q7ZUHXFRhCpHiRbMK8FY72+0kRCsAFdA5natimKIdrU3KYJTELAKpDo
         KrA6OWqe44OIvF1YYY3EwtuDphQXDRnqpJiwCE/4zQHy7EwyOOC4itw9O/rKWDoU3THb
         SVobw9cuBbzp77W0KQa0P4P+e4ewjLAvxRAbI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=Xc2iIT//O3QBGfooRfB8pfK0qvb4dMxFUGggz+f1JmJOT3Vnpo6lCNOrft/Xmw4AFq
         ptAiqVZDwKuyNXHuxphuZtVmzGFpNIhufQ3+aGW3LJZQByAiNRI1OlGexbUqaL5X30t9
         Sq/bmGI2x+NUOpJYbRCdvI6hAldOyvGN8Pre8=
MIME-Version: 1.0
Received: by 10.140.177.13 with SMTP id z13mr929593rve.202.1239920838172; Thu, 
	16 Apr 2009 15:27:18 -0700 (PDT)
Date: Thu, 16 Apr 2009 15:27:18 -0700
Message-ID: <860544ed0904161527o4f1bb171x686682f23cb2cf88@mail.gmail.com>
Subject: Seattle / PNW Hadoop + Lucene User Group?
From: Bradford Stephens <bradfordstephens@gmail.com>
To: core-user@hadoop.apache.org, nutch-user@lucene.apache.org, 
	solr-user@lucene.apache.org, java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Greetings,

Would anybody be willing to join a PNW Hadoop and/or Lucene User Group
with me in the Seattle area? I can donate some facilities, etc. -- I
also always have topics to speak about :)

Cheers,
Bradford

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39757-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 23:08:58 2009
Return-Path: <java-user-return-39757-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63312 invoked from network); 16 Apr 2009 23:08:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 23:08:58 -0000
Received: (qmail 4453 invoked by uid 500); 16 Apr 2009 23:08:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4356 invoked by uid 500); 16 Apr 2009 23:08:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4346 invoked by uid 99); 16 Apr 2009 23:08:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 23:08:55 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 23:08:46 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Luagz-0004BC-1h
	for java-user@lucene.apache.org; Thu, 16 Apr 2009 16:08:25 -0700
Message-ID: <23088274.post@talk.nabble.com>
Date: Thu, 16 Apr 2009 16:08:25 -0700 (PDT)
From: AlexElba <ramalex1@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene SnowBall unexpected behavior for some terms
In-Reply-To: <Pine.LNX.4.64.0904161525140.9661@radix.cryptio.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ramalex1@yahoo.com
References: <22991689.post@talk.nabble.com> <23049935.post@talk.nabble.com> <569173.32992.qm@web50311.mail.re2.yahoo.com> <565F3878-B14C-44E9-9DFF-DD7955EDA218@apache.org> <Pine.LNX.4.64.0904161525140.9661@radix.cryptio.net>
X-Virus-Checked: Checked by ClamAV on apache.org


I look thru source code for snowball. I think this bug does exist in previous
version as well I asked in there mailing list no response so far. 
This is there demo page it has the same issue
http://snowball.tartarus.org/demo.php

I was trying to find there pattern for words which will not get lemmatized.
So far no success. 
-- 
View this message in context: http://www.nabble.com/Lucene-SnowBall-unexpected-behavior-for-some-terms-tp22991689p23088274.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39758-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 16 23:30:53 2009
Return-Path: <java-user-return-39758-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71447 invoked from network); 16 Apr 2009 23:30:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Apr 2009 23:30:52 -0000
Received: (qmail 24197 invoked by uid 500); 16 Apr 2009 23:30:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24114 invoked by uid 500); 16 Apr 2009 23:30:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24104 invoked by uid 99); 16 Apr 2009 23:30:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 23:30:50 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 16 Apr 2009 23:30:40 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lub2C-0004v8-6j
	for java-user@lucene.apache.org; Thu, 16 Apr 2009 16:30:20 -0700
Message-ID: <23088509.post@talk.nabble.com>
Date: Thu, 16 Apr 2009 16:30:20 -0700 (PDT)
From: AlexElba <ramalex1@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Best way for paging with TopDocs class?
In-Reply-To: <49E747A8.8040200@sirma.bg>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ramalex1@yahoo.com
References: <49E747A8.8040200@sirma.bg>
X-Virus-Checked: Checked by ClamAV on apache.org


Why you don't extend to HitCollector  and put all logic you need into it?




Ivan Vasilev-2 wrote:
> 
> Hi All,
> 
> As Hits class was deprecated in current Lucene and is expected to be 
> excluded from Lucene 3.0 we decided to change our code so that to use 
> TopDocs class.
> Our app provides paging and now we are uondering what is the bset way to 
> do it with th TopDocs. I can see only this possibility:
> 1. User opens page 1 - we load by searcher.search(..., docNum, ... ) 
> method as many docs as for page 1;
> 2. User opens page 2 - we load as many results as the amount for page 1 
> and page 2 (note that docs for page 1 are loaded again);
> ...
> N. User opens page n - we load as many docs as the amount of all pages 
> from #1 to #N (note that page 1 docs were loaded N-1 times, page 2 docs 
> N-2 times etc).
> 
> With Hits class this loading of documents of previous pages was avoided 
> - they were loaded once and when needed docs for the next page Hits just 
> loaded the next portion of docs without reloading the previous pages.
> 
> So my question is:
> Is there better way for paging with the class TopDocs than the one that 
> I describe here?
> 
> Thanks in Advance,
> Ivan
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Best-way-for-paging-with-TopDocs-class--tp23079735p23088509.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39759-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 02:06:21 2009
Return-Path: <java-user-return-39759-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33476 invoked from network); 17 Apr 2009 02:06:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 02:06:21 -0000
Received: (qmail 64803 invoked by uid 500); 17 Apr 2009 01:58:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64784 invoked by uid 500); 17 Apr 2009 01:58:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64774 invoked by uid 99); 17 Apr 2009 01:58:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 01:58:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 01:58:40 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LudLP-0000N4-Dc
	for java-user@lucene.apache.org; Thu, 16 Apr 2009 18:58:19 -0700
Message-ID: <23089805.post@talk.nabble.com>
Date: Thu, 16 Apr 2009 18:58:19 -0700 (PDT)
From: MakMak <powgri@gmail.com>
To: java-user@lucene.apache.org
Subject: readModifiedUTF8String stuck
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: powgri@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Please have a look at the following 2 stack traces:

--------------------------------------------------------------------------------------------------------
"[STUCK] ExecuteThread: '21' for queue: 'weblogic.kernel.Default
(self-tuning)'" daemon prio=1 tid=0x00000001018de580 nid=0x62 runnable
[0xfffffffdb48fd000..0xfffffffdb48ff928]
	at java.lang.String.<init>(String.java:208)
	at
org.apache.lucene.store.IndexInput.readModifiedUTF8String(IndexInput.java:133)
	at org.apache.lucene.store.IndexInput.readString(IndexInput.java:120)
	at org.apache.lucene.index.FieldsReader.addField(FieldsReader.java:357)
	at org.apache.lucene.index.FieldsReader.doc(FieldsReader.java:197)
	at org.apache.lucene.index.SegmentReader.document(SegmentReader.java:733)
	- locked <0xfffffffec3fcf1c0> (a org.apache.lucene.index.SegmentReader)
	at
org.apache.lucene.index.MultiSegmentReader.document(MultiSegmentReader.java:259)
	at org.apache.lucene.index.IndexReader.document(IndexReader.java:637)
	at org.apache.lucene.search.IndexSearcher.doc(IndexSearcher.java:91)
	at org.apache.lucene.search.Hits.doc(Hits.java:180)
--------------------------------------------------------------------------------------------------------

"[STUCK] ExecuteThread: '6' for queue: 'weblogic.kernel.Default
(self-tuning)'" daemon prio=1 tid=0x000000010127f2e0 nid=0x4d waiting for
monitor entry [0xfffffffdb68fd000..0xfffffffdb68ff8a8]
	at org.apache.lucene.index.SegmentReader.document(SegmentReader.java:729)
	- waiting to lock <0xfffffffec3fcf1c0> (a
org.apache.lucene.index.SegmentReader)
	at
org.apache.lucene.index.MultiSegmentReader.document(MultiSegmentReader.java:259)
	at org.apache.lucene.index.IndexReader.document(IndexReader.java:637)
	at org.apache.lucene.search.IndexSearcher.doc(IndexSearcher.java:91)
	at org.apache.lucene.search.Hits.doc(Hits.java:180)

--------------------------------------------------------------------------------------------------------------

What I dont understand is, how can the thread be stuck at at
java.lang.String.<init>(String.java:208) ???


-thanks a lot
-- 
View this message in context: http://www.nabble.com/readModifiedUTF8String-stuck-tp23089805p23089805.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39760-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 05:08:01 2009
Return-Path: <java-user-return-39760-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85466 invoked from network); 17 Apr 2009 05:08:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 05:08:01 -0000
Received: (qmail 77735 invoked by uid 500); 17 Apr 2009 05:07:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77652 invoked by uid 500); 17 Apr 2009 05:07:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77642 invoked by uid 99); 17 Apr 2009 05:07:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 05:07:58 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 05:07:51 +0000
Received: by ewy27 with SMTP id 27so777445ewy.5
        for <java-user@lucene.apache.org>; Thu, 16 Apr 2009 22:07:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=L1tcUkdnpES3qmvUVcLOX0+gikZ+i+kBEVn0cxWyQ+k=;
        b=N0WHdRNHswU1DQ86rsCrOH8aSoP9aNTa5ENhcKarnkTIimvwyYh3kwuEELTFFcUijV
         BVoGIPXWDdNiTXdwgnFv6WKf3GrF1/M0Dd4vI0tdYz1sts/ijs76O+L1yEbOPo9+LrVA
         wEeFdMUz5hHzDftGRNd5XkY7UzEqbWGhwGZn0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=NvXxxiqSmuz76D4Qb9Rs+Zb6ftnxi6YEo/R+zoFXz9CtThHlbiBquyHCZSJSP4hIq+
         GXQtMBSBeSyR9GqQhVD/zKkoPFfxuT/mMfgxmexZzMvhU72pX543K+cgMqtmJ+2DNoNn
         BfY1tzRmoRSTswFNzKU5ywRMtokhdFxRmCYv4=
MIME-Version: 1.0
Received: by 10.210.128.10 with SMTP id a10mr202120ebd.99.1239944850125; Thu, 
	16 Apr 2009 22:07:30 -0700 (PDT)
In-Reply-To: <359a92830904160813m9c1ebe4w23d71d99422e66e0@mail.gmail.com>
References: <d36c28c30904160327y55642450v8bcd34faa309dbd1@mail.gmail.com>
	 <d36c28c30904160501t33ca3057sd587655b15ece941@mail.gmail.com>
	 <359a92830904160813m9c1ebe4w23d71d99422e66e0@mail.gmail.com>
Date: Fri, 17 Apr 2009 01:07:30 -0400
Message-ID: <d36c28c30904162207x4489ce94l522f1c998c58a8d5@mail.gmail.com>
Subject: Re: Query scoring
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174789b45535460467b92854
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174789b45535460467b92854
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks for the answer.

In Luke, I used the WhiteSpaceAnalyzer as well. The scores AND the explain
method worked perfectly.

In my application, I checked for the query - it contains the numbers
splitted in different term queries so it prepares it well. Also the scoring
is good. However the explain shows NO MATCH so all the parts of the
calculations are 0. very strange...

Best,
Liat

2009/4/16 Erick Erickson <erickerickson@gmail.com>

> Hmmm, try query.toString() and/or query.explain().
>
> Also, try using Luke to see what is actually in the document.
> BTW, what analyzer did you use in Luke? Luke also has an
> explain (tab?) that will show you what Luke does, which may
> be useful.
>
> The default operator should be "OR", but looking at the actual
> query should help you figure out whether that's happening.
>
> Best
> Erick
>
>
> On Thu, Apr 16, 2009 at 8:01 AM, liat oren <oren.liat@gmail.com> wrote:
>
> > I wanted to add also that I index it tokenized and that when I use Luke
> to
> > do this search, it gives the correct results.
> >
> > Should I run the query differntly than the way I do?
> >
> > 2009/4/16 liat oren <oren.liat@gmail.com>
> >
> > >  Hi,
> > >
> > > I try to understand why the following query gives the scoring below:
> > >
> > > document 1 : a b c document 2 : g k a h u c
> > >
> > >
> > > 0.0 = (NON-MATCH) product of:
> > >   0.0 = (NON-MATCH) sum of:
> > >   0.0 = coord(0/3)
> > > 0.06155877
> > >
> > > The query code is:
> > >    IndexSearcher searcher = new IndexSearcher(path);
> > >    Analyzer analyzer = new StandardAnalyzer();
> > >    QueryParser parser = new QueryParser("text", analyzer);
> > >    Query query = parser.parse("g k a h u c");
> > >    Hits hits = searcher.search(query);
> > > I also tried the WhiteSpaceAnalyzer.
> > >
> > > Why does it give me "no match"?
> > > doesn't if have to do "or" on each of the letters "g k a h u c"?
> > >
> > > Thanks,
> > > Liat
> > >
> > >
> > >
> > >
> >
>

--0015174789b45535460467b92854--

From java-user-return-39761-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 07:03:49 2009
Return-Path: <java-user-return-39761-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69321 invoked from network); 17 Apr 2009 07:03:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 07:03:49 -0000
Received: (qmail 76084 invoked by uid 500); 17 Apr 2009 07:03:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76050 invoked by uid 500); 17 Apr 2009 07:03:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76040 invoked by uid 99); 17 Apr 2009 07:03:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 07:03:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 07:03:38 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lui6Y-0001AT-5x
	for java-user@lucene.apache.org; Fri, 17 Apr 2009 00:03:18 -0700
Message-ID: <23092183.post@talk.nabble.com>
Date: Fri, 17 Apr 2009 00:03:18 -0700 (PDT)
From: MakMak <powgri@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: readModifiedUTF8String stuck
In-Reply-To: <23089805.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: powgri@gmail.com
References: <23089805.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Please do not mind these more traces:

--------------------------------------------------------------------------------------------------
ExecuteThread: '30' for queue: 'weblogic.kernel.Default (self-tuning)' has
been busy for "647" seconds working on the request "Http Request:
/search_results.jsp", which is more than the configured time
(StuckThreadMaxTime) of "600" seconds. Stack trace:

org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirectory.java:588)

org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.java:136)

org.apache.lucene.index.CompoundFileReader$CSIndexInput.readInternal(CompoundFileReader.java:247)

org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java:157)

org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.java:38)
	org.apache.lucene.store.IndexInput.readChars(IndexInput.java:150)

org.apache.lucene.store.IndexInput.readModifiedUTF8String(IndexInput.java:132)
	org.apache.lucene.store.IndexInput.readString(IndexInput.java:120)
	org.apache.lucene.index.FieldsReader.addField(FieldsReader.java:357)
	org.apache.lucene.index.FieldsReader.doc(FieldsReader.java:197)
	org.apache.lucene.index.SegmentReader.document(SegmentReader.java:733)

org.apache.lucene.index.MultiSegmentReader.document(MultiSegmentReader.java:259)
	org.apache.lucene.index.IndexReader.document(IndexReader.java:637)
	org.apache.lucene.search.IndexSearcher.doc(IndexSearcher.java:91)
	org.apache.lucene.search.Hits.doc(Hits.java:180)

------------------------------------------------------------------------------------------------
"[STUCK] ExecuteThread: '77' for queue: 'weblogic.kernel.Default
(self-tuning)'" daemon prio=1 tid=0x0000000101817aa0 nid=0xe4 runnable
[0xfffffffdad5fd000..0xfffffffdad5ff828]	
	at java.io.RandomAccessFile.readBytes(Native Method)
	at java.io.RandomAccessFile.read(RandomAccessFile.java:315)
	at
org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirectory.java:596)
	- locked <0xfffffffec4fb6330> (a
org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor)
	at
org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.java:136)
	at
org.apache.lucene.index.CompoundFileReader$CSIndexInput.readInternal(CompoundFileReader.java:247)
	at
org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java:157)
	at
org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.java:38)
	at org.apache.lucene.store.IndexInput.readChars(IndexInput.java:150)
	at
org.apache.lucene.store.IndexInput.readModifiedUTF8String(IndexInput.java:132)
	at org.apache.lucene.store.IndexInput.readString(IndexInput.java:120)
	at org.apache.lucene.index.FieldsReader.addField(FieldsReader.java:357)
	at org.apache.lucene.index.FieldsReader.doc(FieldsReader.java:197)
	at org.apache.lucene.index.SegmentReader.document(SegmentReader.java:733)
	- locked <0xfffffffec3fcfa80> (a org.apache.lucene.index.SegmentReader)
	at
org.apache.lucene.index.MultiSegmentReader.document(MultiSegmentReader.java:259)
	at org.apache.lucene.index.IndexReader.document(IndexReader.java:637)
	at org.apache.lucene.search.IndexSearcher.doc(IndexSearcher.java:91)
	at org.apache.lucene.search.Hits.doc(Hits.java:180)

-----------------------------------------------------------------------------------------
"[STUCK] ExecuteThread: '21' for queue: 'weblogic.kernel.Default
(self-tuning)'" daemon prio=1 tid=0x00000001018de580 nid=0x62 runnable
[0xfffffffdb48fd000..0xfffffffdb48ff928]
	at java.lang.String.<init>(String.java:208)
	at
org.apache.lucene.store.IndexInput.readModifiedUTF8String(IndexInput.java:133)
	at org.apache.lucene.store.IndexInput.readString(IndexInput.java:120)
	at org.apache.lucene.index.FieldsReader.addField(FieldsReader.java:357)
	at org.apache.lucene.index.FieldsReader.doc(FieldsReader.java:197)
	at org.apache.lucene.index.SegmentReader.document(SegmentReader.java:733)
	- locked <0xfffffffec3fcf1c0> (a org.apache.lucene.index.SegmentReader)
	at
org.apache.lucene.index.MultiSegmentReader.document(MultiSegmentReader.java:259)
	at org.apache.lucene.index.IndexReader.document(IndexReader.java:637)
	at org.apache.lucene.search.IndexSearcher.doc(IndexSearcher.java:91)
-----------------------------------------------------------------------------------------

More info, We had an old index generated from lucene ver 2.3.2. Then we
upgraded to ver 2.4.1 but didnt rebuild the index. Also, the indices reside
on a SAN. Is the above possible due to some n/w issue that might have
happened between the SAN and the appserver? 
-- 
View this message in context: http://www.nabble.com/readModifiedUTF8String-stuck-tp23089805p23092183.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39762-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 07:07:49 2009
Return-Path: <java-user-return-39762-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71466 invoked from network); 17 Apr 2009 07:07:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 07:07:49 -0000
Received: (qmail 80742 invoked by uid 500); 17 Apr 2009 07:07:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80665 invoked by uid 500); 17 Apr 2009 07:07:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80655 invoked by uid 99); 17 Apr 2009 07:07:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 07:07:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [122.98.10.33] (HELO KECGATE08.infosys.com) (122.98.10.33)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 07:07:38 +0000
X-TM-IMSS-Message-ID:<2331042a0002029e@KECGATE08.infosys.com>
Received: from blrkechub04.ad.infosys.com ([10.66.236.44]) by KECGATE08.infosys.com ([122.98.10.33]) with ESMTP (TREND IMSS SMTP Service 7.0; TLS: TLSv1/SSLv3,128bits,RC4-MD5) id 2331042a0002029e ; Fri, 17 Apr 2009 12:37:41 +0530
Received: from BLRKECMBX09.ad.infosys.com ([10.66.236.82]) by
 blrkechub04.ad.infosys.com ([10.66.236.44]) with mapi; Fri, 17 Apr 2009
 12:37:15 +0530
From: "Radhalakshmi  Sreedharan" <Radhalakshmi_S@infosys.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 17 Apr 2009 12:37:10 +0530
Subject: RE: Need help : SpanNearQuery
Thread-Topic: Need help : SpanNearQuery
Thread-Index: Acm+iNF1pm27j7zFQguuTqAOr5YfMAABtBKwAAgjfKAAHoBJYA==
Message-ID: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9C012D@BLRKECMBX09.ad.infosys.com>
References: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30@BLRKECMBX09.ad.infosys.com>
 <2D127F11DC79714E9B6A43AC9458147F13FCA3C7@suex07-mbx-03.ad.syr.edu>
In-Reply-To: <2D127F11DC79714E9B6A43AC9458147F13FCA3C7@suex07-mbx-03.ad.syr.edu>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi=20Steven,
Thanks=20for=20your=20reply.

I=20tried=20out=20your=20approach=20and=20the=20problem=20got=20solved=20=
to=20an=20extent=20but=20still=20it=20remains.

The=20problem=20is=20the=20score=20reduces=20quite=20a=20bit=20even=20now=
=20as=20bc=20is=20not=20found=20in=20the=20combinations
=20(=20bc,cd)=20(=20bc,ef)=20and=20(=20ab,bc,cd,ef)=20etc.=20

The=20boosting=20infact=20has=20a=20negative=20impact=20and=20reduces=20t=
he=20score=20further=20:(

The=20factor=20which=20is=20affected=20by=20boosting=20is=20the=20queryNo=
rm=20.

With=20a=20boost=20of=206=20=20-=20

0.015559823=20=3D=20(MATCH)=20max=20of:
=20=200.015559823=20=3D=20(MATCH)=20weight(spanNear([SearchField:cd,=20Se=
archField:ef],=2010,=20false)^6.0=20in=200),=20product=20of:
=20=20=20=200.07606166=20=3D=20queryWeight(spanNear([SearchField:cd,=20Se=
archField:ef],=2010,=20false)^6.0),=20product=20of:
=20=20=20=20=20=206.0=20=3D=20boost
=20=20=20=20=20=200.61370564=20=3D=20idf(SearchField:=20cd=3D1=20ef=3D1)
=20=20=20=20=20=200.02065639=20=3D=20queryNorm
=20=20=20=200.20456855=20=3D=20(MATCH)=20fieldWeight(SearchField:spanNear=
([cd,=20ef],=2010,=20false)^6.0=20in=200),=20product=20of:
=20=20=20=20=20=200.33333334=20=3D=20tf(phraseFreq=3D0.33333334)
=20=20=20=20=20=200.61370564=20=3D=20idf(SearchField:=20cd=3D1=20ef=3D1)
=20=20=20=20=20=201.0=20=3D=20fieldNorm(field=3DSearchField,=20doc=3D0)

Without=20a=20boost=20=20-=20

0.07779912=20=3D=20(MATCH)=20max=20of:
=20=200.07779912=20=3D=20(MATCH)=20weight(spanNear([SearchField:cd,=20Sea=
rchField:ef],=2010,=20false)=20in=200),=20product=20of:
=20=20=20=200.3803083=20=3D=20queryWeight(spanNear([SearchField:cd,=20Sea=
rchField:ef],=2010,=20false)),=20product=20of:
=20=20=20=20=20=200.61370564=20=3D=20idf(SearchField:=20cd=3D1=20ef=3D1)
=20=20=20=20=20=200.6196917=20=3D=20queryNorm
=20=20=20=200.20456855=20=3D=20(MATCH)=20fieldWeight(SearchField:spanNear=
([cd,=20ef],=2010,=20false)=20in=200),=20product=20of:
=20=20=20=20=20=200.33333334=20=3D=20tf(phraseFreq=3D0.33333334)
=20=20=20=20=20=200.61370564=20=3D=20idf(SearchField:=20cd=3D1=20ef=3D1)
=20=20=20=20=20=201.0=20=3D=20fieldNorm(field=3DSearchField,=20doc=3D0)


Regards,
Radha
-----Original=20Message-----
From:=20Steven=20A=20Rowe=20[mailto:sarowe@syr.edu]=20
Sent:=20Thursday,=20April=2016,=202009=2010:35=20PM
To:=20java-user@lucene.apache.org
Subject:=20RE:=20Need=20help=20:=20SpanNearQuery

Hi=20Radha,

On=204/16/2009=20at=208:35=20AM,=20Radhalakshmi=20Sredharan=20wrote:
>=20I=20have=20a=20question=20related=20to=20SpanNearQuery.
>=20
>=20I=20need=20a=20hit=20even=20if=20there=20are=202/3=20terms=20found=20=
with=20the=20span=20being
>=20applied=20for=20those=202=20terms.
>=20
>=20Is=20there=20any=20custom=20implementation=20in=20place=20for=20this?=
=20I=20checked
>=20SrndQuery=20but=20that=20also=20doesn't=20work.
>=20
>=20This=20is=20my=20workaround=20currently:
>=20
>=201)=20=20=20=20=20=20For=20a=20list=20of=20terms=20(=20ab,bc,=20cd,ef)=
=20,=20make=20a=20set=20like=20(=20ab,bc)
>=20,=20(=20bc,cd)=20(=20ab,cd)=20(bc,ef)=20(=20ab,bc,cd)=20(=20ab,bc,cd,=
ef).....=20and=20so=20on.
>=20
>=202)=20=20=20=20=20=20Create=20a=20spanNearQuery=20for=20=20each=20of=
=20these=20terms
>=20
>=203)=20=20=20=20=20=20Add=20it=20to=20the=20booleanQuery=20with=20a=20=
=20SHOULD=20clause.
>=20
>=20However=20this=20approach=20gives=20me=20puzzling=20scores
>=20=20eg=20If=20my=20document=20has=20=20only=20(=20ab,bc,cd)=20the=20pe=
nalty=20for=20the=20missing=20ef
>=20is=20very=20high=20and=20my=20score=20comes=20down=20quite=20a=20bit.

Do=20you=20know=20about=20the=20scoring=20documentation=20on=20the=20Luce=
ne=20site:=20<http://lucene.apache.org/java/2_4_1/scoring.html>=20?=20=20=
In=20particular,=20see=20the=20link=20from=20there=20to=20the=20Searcher.=
explain()=20javadocs=20-=20this=20functionality=20will=20help=20you=20und=
erstand=20what's=20happening=20with=20your=20queries.

I=20suspect=20that=20the=20penalty=20is=20due=20to=20fewer=20sub-queries=
=20matching;=20that=20is,=20not=20only=20does=20(ab,bc,cd,ef)=20fail=20to=
=20match,=20but=20(ab,bc,ef),=20(ab,cd,ef),=20(ab,ef)=20etc.=20also=20fai=
l=20to=20match,=20and=20since=20all=20of=20these=20contribute=20to=20the=
=20final=20score,=20you=20will=20see=20a=20large=20drop=20off=20if=20you=
=20don't=20get=20a=20full=20match.

Instead=20of=20putting=20all=20of=20the=20alternatives=20together=20in=20=
a=20single=20large=20disjunction,=20if=20you=20package=20them=20such=20th=
at=20the=20shorter=20alternatives=20don't=20influence=20the=20final=20sco=
re=20when=20larger=20ones=20match,=20you=20may=20get=20something=20more=
=20like=20what=20you=20want.=20=20I=20think=20DisjunctionMaxQuery=20<http=
://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/DisjunctionM=
axQuery.html>,=20along=20with=20judicious=20boosting,=20will=20do=20the=
=20trick,=20e.g.:

DMQ((ab,bc,cd,ef)^100,
=20=20=20=20((ab,bc,cd)^10=20(ab,bc,ef)^10=20(ab,cd,ef)^10=20...),
=20=20=20=20((ab,bc)=20(ab,cd)=20(ab,ef)=20...))

Steve


---------------------------------------------------------------------
To=20unsubscribe,=20e-mail:=20java-user-unsubscribe@lucene.apache.org
For=20additional=20commands,=20e-mail:=20java-user-help@lucene.apache.org


****************=20CAUTION=20-=20Disclaimer=20*****************
This=20e-mail=20contains=20PRIVILEGED=20AND=20CONFIDENTIAL=20INFORMATION=
=20intended=20solely=20
for=20the=20use=20of=20the=20addressee(s).=20If=20you=20are=20not=20the=
=20intended=20recipient,=20please=20
notify=20the=20sender=20by=20e-mail=20and=20delete=20the=20original=20mes=
sage.=20Further,=20you=20are=20not=20
to=20copy,=20disclose,=20or=20distribute=20this=20e-mail=20or=20its=20con=
tents=20to=20any=20other=20person=20and=20
any=20such=20actions=20are=20unlawful.=20This=20e-mail=20may=20contain=20=
viruses.=20Infosys=20has=20taken=20
every=20reasonable=20precaution=20to=20minimize=20this=20risk,=20but=20is=
=20not=20liable=20for=20any=20damage=20
you=20may=20sustain=20as=20a=20result=20of=20any=20virus=20in=20this=20e-=
mail.=20You=20should=20carry=20out=20your=20
own=20virus=20checks=20before=20opening=20the=20e-mail=20or=20attachment.=
=20Infosys=20reserves=20the=20
right=20to=20monitor=20and=20review=20the=20content=20of=20all=20messages=
=20sent=20to=20or=20from=20this=20e-mail=20
address.=20Messages=20sent=20to=20or=20from=20this=20e-mail=20address=20m=
ay=20be=20stored=20on=20the=20
Infosys=20e-mail=20system.
***INFOSYS********=20End=20of=20Disclaimer=20********INFOSYS***

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39763-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 07:47:22 2009
Return-Path: <java-user-return-39763-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87660 invoked from network); 17 Apr 2009 07:47:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 07:47:21 -0000
Received: (qmail 33816 invoked by uid 500); 17 Apr 2009 07:47:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33762 invoked by uid 500); 17 Apr 2009 07:47:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33557 invoked by uid 99); 17 Apr 2009 07:47:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 07:47:18 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.170] (HELO wf-out-1314.google.com) (209.85.200.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 07:47:10 +0000
Received: by wf-out-1314.google.com with SMTP id 29so674163wff.20
        for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 00:46:49 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.52.7 with SMTP id z7mr3207903wfz.260.1239954409486; Fri, 
	17 Apr 2009 00:46:49 -0700 (PDT)
In-Reply-To: <23092183.post@talk.nabble.com>
References: <23089805.post@talk.nabble.com> <23092183.post@talk.nabble.com>
Date: Fri, 17 Apr 2009 03:46:49 -0400
Message-ID: <9ac0c6aa0904170046x68fa5ad1j23eb5ab6fe7c7cf9@mail.gmail.com>
Subject: Re: readModifiedUTF8String stuck
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Can you describe your app a bit?  How many documents are you
retrieving for each search?

It seems like Weblogic noticed a single HTTP request took more than
600 seconds and then dumped out all stack traces?  In which case,
maybe the threads were not actually "stuck", but were doing something
that was taking far too long, and so you caught the threads at a
certain point in their processing (loading a document).

Is this easily reproduced?  Do certain searches run quickly but others
consistently hit this 600 second timeout?  Is the JRE consuming way
too much RAM when this happens?

Mike

On Fri, Apr 17, 2009 at 3:03 AM, MakMak <powgri@gmail.com> wrote:
>
> Please do not mind these more traces:
>
> -------------------------------------------------------------------------=
-------------------------
> ExecuteThread: '30' for queue: 'weblogic.kernel.Default (self-tuning)' ha=
s
> been busy for "647" seconds working on the request "Http Request:
> /search_results.jsp", which is more than the configured time
> (StuckThreadMaxTime) of "600" seconds. Stack trace:
>
> org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirectory=
.java:588)
>
> org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.j=
ava:136)
>
> org.apache.lucene.index.CompoundFileReader$CSIndexInput.readInternal(Comp=
oundFileReader.java:247)
>
> org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java=
:157)
>
> org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.ja=
va:38)
> =A0 =A0 =A0 =A0org.apache.lucene.store.IndexInput.readChars(IndexInput.ja=
va:150)
>
> org.apache.lucene.store.IndexInput.readModifiedUTF8String(IndexInput.java=
:132)
> =A0 =A0 =A0 =A0org.apache.lucene.store.IndexInput.readString(IndexInput.j=
ava:120)
> =A0 =A0 =A0 =A0org.apache.lucene.index.FieldsReader.addField(FieldsReader=
.java:357)
> =A0 =A0 =A0 =A0org.apache.lucene.index.FieldsReader.doc(FieldsReader.java=
:197)
> =A0 =A0 =A0 =A0org.apache.lucene.index.SegmentReader.document(SegmentRead=
er.java:733)
>
> org.apache.lucene.index.MultiSegmentReader.document(MultiSegmentReader.ja=
va:259)
> =A0 =A0 =A0 =A0org.apache.lucene.index.IndexReader.document(IndexReader.j=
ava:637)
> =A0 =A0 =A0 =A0org.apache.lucene.search.IndexSearcher.doc(IndexSearcher.j=
ava:91)
> =A0 =A0 =A0 =A0org.apache.lucene.search.Hits.doc(Hits.java:180)
>
> -------------------------------------------------------------------------=
-----------------------
> "[STUCK] ExecuteThread: '77' for queue: 'weblogic.kernel.Default
> (self-tuning)'" daemon prio=3D1 tid=3D0x0000000101817aa0 nid=3D0xe4 runna=
ble
> [0xfffffffdad5fd000..0xfffffffdad5ff828]
> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.readBytes(Native Method)
> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.read(RandomAccessFile.java:315=
)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirectory=
.java:596)
> =A0 =A0 =A0 =A0- locked <0xfffffffec4fb6330> (a
> org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.BufferedIndexInput.readBytes(BufferedIndexInput.j=
ava:136)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.CompoundFileReader$CSIndexInput.readInternal(Comp=
oundFileReader.java:247)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java=
:157)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.ja=
va:38)
> =A0 =A0 =A0 =A0at org.apache.lucene.store.IndexInput.readChars(IndexInput=
.java:150)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.IndexInput.readModifiedUTF8String(IndexInput.java=
:132)
> =A0 =A0 =A0 =A0at org.apache.lucene.store.IndexInput.readString(IndexInpu=
t.java:120)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.FieldsReader.addField(FieldsRea=
der.java:357)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.FieldsReader.doc(FieldsReader.j=
ava:197)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.document(SegmentR=
eader.java:733)
> =A0 =A0 =A0 =A0- locked <0xfffffffec3fcfa80> (a org.apache.lucene.index.S=
egmentReader)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.MultiSegmentReader.document(MultiSegmentReader.ja=
va:259)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexReader.document(IndexReade=
r.java:637)
> =A0 =A0 =A0 =A0at org.apache.lucene.search.IndexSearcher.doc(IndexSearche=
r.java:91)
> =A0 =A0 =A0 =A0at org.apache.lucene.search.Hits.doc(Hits.java:180)
>
> -------------------------------------------------------------------------=
----------------
> "[STUCK] ExecuteThread: '21' for queue: 'weblogic.kernel.Default
> (self-tuning)'" daemon prio=3D1 tid=3D0x00000001018de580 nid=3D0x62 runna=
ble
> [0xfffffffdb48fd000..0xfffffffdb48ff928]
> =A0 =A0 =A0 =A0at java.lang.String.<init>(String.java:208)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.store.IndexInput.readModifiedUTF8String(IndexInput.java=
:133)
> =A0 =A0 =A0 =A0at org.apache.lucene.store.IndexInput.readString(IndexInpu=
t.java:120)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.FieldsReader.addField(FieldsRea=
der.java:357)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.FieldsReader.doc(FieldsReader.j=
ava:197)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.document(SegmentR=
eader.java:733)
> =A0 =A0 =A0 =A0- locked <0xfffffffec3fcf1c0> (a org.apache.lucene.index.S=
egmentReader)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.MultiSegmentReader.document(MultiSegmentReader.ja=
va:259)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexReader.document(IndexReade=
r.java:637)
> =A0 =A0 =A0 =A0at org.apache.lucene.search.IndexSearcher.doc(IndexSearche=
r.java:91)
> -------------------------------------------------------------------------=
----------------
>
> More info, We had an old index generated from lucene ver 2.3.2. Then we
> upgraded to ver 2.4.1 but didnt rebuild the index. Also, the indices resi=
de
> on a SAN. Is the above possible due to some n/w issue that might have
> happened between the SAN and the appserver?
> --
> View this message in context: http://www.nabble.com/readModifiedUTF8Strin=
g-stuck-tp23089805p23092183.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39764-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 08:49:35 2009
Return-Path: <java-user-return-39764-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5096 invoked from network); 17 Apr 2009 08:49:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 08:49:35 -0000
Received: (qmail 11775 invoked by uid 500); 17 Apr 2009 08:49:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11702 invoked by uid 500); 17 Apr 2009 08:49:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11692 invoked by uid 99); 17 Apr 2009 08:49:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 08:49:33 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [62.213.161.134] (HELO pmx.sirma.bg) (62.213.161.134)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 08:49:25 +0000
X-Virus-Scanned: Sirma Antivirus System
Received: from [192.168.128.140] (ivasilev.sirma.int [192.168.128.140])
	by pmx.sirma.bg (Sirma mail system) with ESMTP id 7D84A244B98
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 11:49:04 +0300 (EEST)
Message-ID: <49E84280.8070404@sirma.bg>
Date: Fri, 17 Apr 2009 11:49:04 +0300
From: Ivan Vasilev <ivasilev@sirma.bg>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Best way for paging with TopDocs class?
References: <49E747A8.8040200@sirma.bg> <23088509.post@talk.nabble.com>
In-Reply-To: <23088509.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Alex,

As I know HitColector is useful when you need to deal with some data of 
ALL the docs in the index, but when you need just top of them 
HitCollector is said to be a performance killer. Then is better to use 
Hits with the old API and TopDocs with current one.

Ivan

AlexElba wrote:
> Why you don't extend to HitCollector  and put all logic you need into it?
>
>
>
>
> Ivan Vasilev-2 wrote:
>   
>> Hi All,
>>
>> As Hits class was deprecated in current Lucene and is expected to be 
>> excluded from Lucene 3.0 we decided to change our code so that to use 
>> TopDocs class.
>> Our app provides paging and now we are uondering what is the bset way to 
>> do it with th TopDocs. I can see only this possibility:
>> 1. User opens page 1 - we load by searcher.search(..., docNum, ... ) 
>> method as many docs as for page 1;
>> 2. User opens page 2 - we load as many results as the amount for page 1 
>> and page 2 (note that docs for page 1 are loaded again);
>> ...
>> N. User opens page n - we load as many docs as the amount of all pages 
>> from #1 to #N (note that page 1 docs were loaded N-1 times, page 2 docs 
>> N-2 times etc).
>>
>> With Hits class this loading of documents of previous pages was avoided 
>> - they were loaded once and when needed docs for the next page Hits just 
>> loaded the next portion of docs without reloading the previous pages.
>>
>> So my question is:
>> Is there better way for paging with the class TopDocs than the one that 
>> I describe here?
>>
>> Thanks in Advance,
>> Ivan
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>>     
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39765-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 09:06:09 2009
Return-Path: <java-user-return-39765-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11721 invoked from network); 17 Apr 2009 09:06:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 09:06:09 -0000
Received: (qmail 26768 invoked by uid 500); 17 Apr 2009 09:06:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26684 invoked by uid 500); 17 Apr 2009 09:06:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26674 invoked by uid 99); 17 Apr 2009 09:06:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 09:06:07 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 09:05:59 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Luk0w-0005jG-QI
	for java-user@lucene.apache.org; Fri, 17 Apr 2009 02:05:38 -0700
Message-ID: <23093956.post@talk.nabble.com>
Date: Fri, 17 Apr 2009 02:05:38 -0700 (PDT)
From: MakMak <powgri@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: readModifiedUTF8String stuck
In-Reply-To: <9ac0c6aa0904170046x68fa5ad1j23eb5ab6fe7c7cf9@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: powgri@gmail.com
References: <23089805.post@talk.nabble.com> <23092183.post@talk.nabble.com> <9ac0c6aa0904170046x68fa5ad1j23eb5ab6fe7c7cf9@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org



I am not retrieving many docs, the problem is that the whole file is stored
in the doc. I need the file content for highlighter to work. But the files
are normal-sized text files which in any case should not exceed 10-15mb.
Retrieving 25 of them(page size), worst case scenario will take 250mb of
data transfer which should not take more than 600 secs.

This may not be easily reproduced, but is easy to describe, we bombard our
application with about 3-4 requests per second for 2 hours as a part of
stress tests. Previously when we were on 2.3.2, these used to run just fine.
We had to upgrade due to a memory leak issue for which CloseableThreadLocal
was implemented in 2.4.1. 

The testing team did not reindex with the new lucene version, but they dont
have to, right? thats when they saw these stuck threads. The tests ran fine
for an hour when responses were being returned timely. But after an hour,
the threads just started to accumulate. I am not sure amount of RAM consumed
during searches, will find that out.

Hope I have been clear, do you smell something fishy in this?

-thanks


Michael McCandless-2 wrote:
> 
> Can you describe your app a bit?  How many documents are you
> retrieving for each search?
> 
> It seems like Weblogic noticed a single HTTP request took more than
> 600 seconds and then dumped out all stack traces?  In which case,
> maybe the threads were not actually "stuck", but were doing something
> that was taking far too long, and so you caught the threads at a
> certain point in their processing (loading a document).
> 
> Is this easily reproduced?  Do certain searches run quickly but others
> consistently hit this 600 second timeout?  Is the JRE consuming way
> too much RAM when this happens?
> 
> Mike
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/readModifiedUTF8String-stuck-tp23089805p23093956.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39766-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 09:33:20 2009
Return-Path: <java-user-return-39766-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30829 invoked from network); 17 Apr 2009 09:33:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 09:33:20 -0000
Received: (qmail 56519 invoked by uid 500); 17 Apr 2009 09:33:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56428 invoked by uid 500); 17 Apr 2009 09:33:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56417 invoked by uid 99); 17 Apr 2009 09:33:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 09:33:18 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.198.230] (HELO rv-out-0506.google.com) (209.85.198.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 09:33:09 +0000
Received: by rv-out-0506.google.com with SMTP id f6so719429rvb.5
        for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 02:32:48 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.222.21 with SMTP id u21mr3293270wfg.7.1239960768022; Fri, 
	17 Apr 2009 02:32:48 -0700 (PDT)
In-Reply-To: <49E84280.8070404@sirma.bg>
References: <49E747A8.8040200@sirma.bg> <23088509.post@talk.nabble.com>
	 <49E84280.8070404@sirma.bg>
Date: Fri, 17 Apr 2009 05:32:47 -0400
Message-ID: <9ac0c6aa0904170232s89ebdedp7ce47da64006291b@mail.gmail.com>
Subject: Re: Best way for paging with TopDocs class?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Actually, HitCollector itself isn't a performance killer (eg, at the
end of the day, all searches inside Lucene are using some HitCollector
to gather results).

What is a performance killer is if you do something overly substantial
(eg, calling IndexReader.document(...)) with every hit passed to the
HitCollector.

So one must be very careful when implementing a custom HitCollector to
do as little as possible on each collect(...) call.

Mike

On Fri, Apr 17, 2009 at 4:49 AM, Ivan Vasilev <ivasilev@sirma.bg> wrote:
> Hi Alex,
>
> As I know HitColector is useful when you need to deal with some data of A=
LL
> the docs in the index, but when you need just top of them HitCollector is
> said to be a performance killer. Then is better to use Hits with the old =
API
> and TopDocs with current one.
>
> Ivan
>
> AlexElba wrote:
>>
>> Why you don't extend to HitCollector =A0and put all logic you need into =
it?
>>
>>
>>
>>
>> Ivan Vasilev-2 wrote:
>>
>>>
>>> Hi All,
>>>
>>> As Hits class was deprecated in current Lucene and is expected to be
>>> excluded from Lucene 3.0 we decided to change our code so that to use
>>> TopDocs class.
>>> Our app provides paging and now we are uondering what is the bset way t=
o
>>> do it with th TopDocs. I can see only this possibility:
>>> 1. User opens page 1 - we load by searcher.search(..., docNum, ... )
>>> method as many docs as for page 1;
>>> 2. User opens page 2 - we load as many results as the amount for page 1
>>> and page 2 (note that docs for page 1 are loaded again);
>>> ...
>>> N. User opens page n - we load as many docs as the amount of all pages
>>> from #1 to #N (note that page 1 docs were loaded N-1 times, page 2 docs=
 N-2
>>> times etc).
>>>
>>> With Hits class this loading of documents of previous pages was avoided=
 -
>>> they were loaded once and when needed docs for the next page Hits just
>>> loaded the next portion of docs without reloading the previous pages.
>>>
>>> So my question is:
>>> Is there better way for paging with the class TopDocs than the one that=
 I
>>> describe here?
>>>
>>> Thanks in Advance,
>>> Ivan
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>>
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39767-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 09:38:57 2009
Return-Path: <java-user-return-39767-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34495 invoked from network); 17 Apr 2009 09:38:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 09:38:57 -0000
Received: (qmail 67842 invoked by uid 500); 17 Apr 2009 09:38:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67765 invoked by uid 500); 17 Apr 2009 09:38:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67755 invoked by uid 99); 17 Apr 2009 09:38:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 09:38:54 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.198.234] (HELO rv-out-0506.google.com) (209.85.198.234)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 09:38:46 +0000
Received: by rv-out-0506.google.com with SMTP id f6so720823rvb.5
        for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 02:38:25 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.169.4 with SMTP id r4mr3240449wfe.262.1239961105317; Fri, 
	17 Apr 2009 02:38:25 -0700 (PDT)
In-Reply-To: <23093956.post@talk.nabble.com>
References: <23089805.post@talk.nabble.com> <23092183.post@talk.nabble.com>
	 <9ac0c6aa0904170046x68fa5ad1j23eb5ab6fe7c7cf9@mail.gmail.com>
	 <23093956.post@talk.nabble.com>
Date: Fri, 17 Apr 2009 05:38:25 -0400
Message-ID: <9ac0c6aa0904170238y7b2e52a3x368b95c3ea81fa71@mail.gmail.com>
Subject: Re: readModifiedUTF8String stuck
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 17, 2009 at 5:05 AM, MakMak <powgri@gmail.com> wrote:

> I am not retrieving many docs, the problem is that the whole file is stored
> in the doc. I need the file content for highlighter to work. But the files
> are normal-sized text files which in any case should not exceed 10-15mb.
> Retrieving 25 of them(page size), worst case scenario will take 250mb of
> data transfer which should not take more than 600 secs.

Maybe you can add some logging as to which docs each thread is
attempting to load.  Eg is it possible you accidentally have an
immense doc in the index?

You could also make a standalone tool that simply requests each doc
from the index and prints out its size.

Also, maybe run CheckIndex on your index just to make sure all is good.

> This may not be easily reproduced, but is easy to describe, we bombard our
> application with about 3-4 requests per second for 2 hours as a part of
> stress tests. Previously when we were on 2.3.2, these used to run just fine.
> We had to upgrade due to a memory leak issue for which CloseableThreadLocal
> was implemented in 2.4.1.

OK.

> The testing team did not reindex with the new lucene version, but they dont
> have to, right?

Right, it's fully back compatible, though you should get better
performance by reindexing.

> thats when they saw these stuck threads. The tests ran fine
> for an hour when responses were being returned timely. But after an hour,
> the threads just started to accumulate. I am not sure amount of RAM consumed
> during searches, will find that out.

Hmm, that's spooky.  Do the queries repeat at <= 1 hour during the
test?  Or is it possible in that 2nd hour of testing, a new query
appeared that hit a horribly immense document?

If they do repeat... maybe some sort of crazy GC is kicking in?
You're on a 64 bit JRE right?  How much heap do you give to it?

> Hope I have been clear, do you smell something fishy in this?

The fact that you only hit this new issue on upgrading to 2.4.1 is
certainly fishy.  Nothing else changed in the upgrade?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39768-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 10:08:05 2009
Return-Path: <java-user-return-39768-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52407 invoked from network); 17 Apr 2009 10:08:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 10:08:03 -0000
Received: (qmail 2421 invoked by uid 500); 17 Apr 2009 10:08:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2356 invoked by uid 500); 17 Apr 2009 10:08:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2344 invoked by uid 99); 17 Apr 2009 10:07:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 10:07:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of richard.marr@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 10:07:50 +0000
Received: by fxm2 with SMTP id 2so903493fxm.5
        for <multiple recipients>; Fri, 17 Apr 2009 03:07:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=VOwFQmS2jLYayZDMo3y7lC3rqOsj7HkL6wNtqZXz2Tg=;
        b=bsoFEVlkCKsOdQIRnRs+g2tYaPqipGcsJQvhWp3tzy11UoRzTl8jZAGSUpQmrkYjL5
         o/guyX9ql8aQt6clVp1FuHsdZb6onIZjQYXlOzT2FEXbNeQziPujVFT78Vi+PUWYIg0M
         ZZfOwiJ947yq3cTViLgEUeQbX9WkkB7jiNADo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=HbPGzmjWj0xANS7qokXTn9tMJZDTQdJPtBURjp8CeuqRSw4gZMfZP5VwM8buKjh+U5
         EKGKsg1rbGH37cQI8Wso8EuPyACDVIYZ11HvKlzmJQq0kD9l4DN5hF2XjIaT4g2qf0z4
         ZEcRJg2DkNtYDw61jueguZmO4vUoN30xqJT4k=
MIME-Version: 1.0
Received: by 10.86.70.20 with SMTP id s20mr1018188fga.1.1239962849962; Fri, 17 
	Apr 2009 03:07:29 -0700 (PDT)
In-Reply-To: <dba8f29c0904061042t2f842ae1p750ea0fa5605137d@mail.gmail.com>
References: <dba8f29c0904061042t2f842ae1p750ea0fa5605137d@mail.gmail.com>
Date: Fri, 17 Apr 2009 11:07:29 +0100
Message-ID: <dba8f29c0904170307y7a185c9cr82df2d7091589139@mail.gmail.com>
Subject: Re: London meet-up - 27th April
From: Richard Marr <richard.marr@gmail.com>
To: general@lucene.apache.org, java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Just a reminder that this London meet-up is on Monday the 27th. Please
sign up or otherwise let me know so I can make sure there's anough
space booked.

Rich


2009/4/6 Richard Marr <richard.marr@gmail.com>:
> Hi all,
>
> Just to let everyone know... I'm organising (if you can call it that)
> an informal London meet-up in the presence of alcohol to talk about
> Lucene, and search in general. We're not planning on having any formal
> talks or presentations.
>
> We've just finished a big-ish search project that uses Lucene so feel
> the need to share war stories and generally relax and talk geek stuff
> with like-minded people. Please come if you're at all inclined. All I
> ask is that you sign up via the Yahoo event page so that I know what
> numbers to expect. Links are below.
>
> Rich
>
> --
>
> Public notice:
> http://richmarr.wordpress.com/2009/04/06/search-lucene-social-meet-up/
>
> Yahoo event page:
> http://upcoming.yahoo.com/event/2374281/
>
> --
>
>
> --
> Richard Marr
> richard.marr@gmail.com
> 07976 910 515
>



-- 
Richard Marr
richard.marr@gmail.com
07976 910 515

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39769-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 10:19:23 2009
Return-Path: <java-user-return-39769-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61898 invoked from network); 17 Apr 2009 10:19:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 10:19:22 -0000
Received: (qmail 20503 invoked by uid 500); 17 Apr 2009 10:19:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20443 invoked by uid 500); 17 Apr 2009 10:19:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20433 invoked by uid 99); 17 Apr 2009 10:19:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 10:19:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [122.98.10.33] (HELO KECGATE08.infosys.com) (122.98.10.33)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 10:19:11 +0000
X-TM-IMSS-Message-ID:<23e0611c00022ae0@KECGATE08.infosys.com>
Received: from blrkechub04.ad.infosys.com ([10.66.236.44]) by KECGATE08.infosys.com ([122.98.10.33]) with ESMTP (TREND IMSS SMTP Service 7.0; TLS: TLSv1/SSLv3,128bits,RC4-MD5) id 23e0611c00022ae0 ; Fri, 17 Apr 2009 15:49:14 +0530
Received: from BLRKECMBX09.ad.infosys.com ([10.66.236.82]) by
 blrkechub04.ad.infosys.com ([10.66.236.44]) with mapi; Fri, 17 Apr 2009
 15:48:48 +0530
From: "Radhalakshmi  Sreedharan" <Radhalakshmi_S@infosys.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 17 Apr 2009 15:48:46 +0530
Subject: RE: Need help : SpanNearQuery
Thread-Topic: Need help : SpanNearQuery
Thread-Index: Acm+iNF1pm27j7zFQguuTqAOr5YfMAABtBKwAAgjfKAAHoBJYAAGfzKQ
Message-ID: <5CDA3DC1F80BBB42BD0B48FABC128B5114F30519B1@BLRKECMBX09.ad.infosys.com>
References: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30@BLRKECMBX09.ad.infosys.com>
 <2D127F11DC79714E9B6A43AC9458147F13FCA3C7@suex07-mbx-03.ad.syr.edu>
 <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9C012D@BLRKECMBX09.ad.infosys.com>
In-Reply-To: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9C012D@BLRKECMBX09.ad.infosys.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

To make the question simple,

What I need is  the following :
If my document field is ( ab,bc,cd,ef) and Search tokens are (ab,bc,cd).=20

Given the following :=20
 I should get a hit even if all of the search tokens aren't present
 If the tokens are found they should be found within a distance x of each o=
ther ( proximity search)

I need the percentage match of the search tokens with the document field.=20

Currently this is my query : =20
1) I form all possible permutation of the search tokens=20
2) do a spanNearQuery of each permutation
3)  Do a DisjunctionMaxQuery on the spannearqueries.=20

This is how I compute % match  :=20
% match =3D  ( Score by running the query on the document field ) /
		( score by running the query on a document field created out of search to=
kens )

The numerator gives me the actual score with the search tokens run on the f=
ield.
Denominator gives  me the  best possible or maximum possible score with the=
 current search tokens

For this example << If my document field is ( ab,bc,cd,ef) and Search token=
s are (ab,bc,cd).>> I expect a % match of around 90%.

However I get a match of only around 50% without a boost. Using a boost inf=
act reduces my percentage.=20

I even overrode the queryNorm method to return a one, still the percentage =
did not increase.

Any suggestions ?
-----Original Message-----
From: Radhalakshmi Sreedharan [mailto:Radhalakshmi_S@infosys.com]=20
Sent: Friday, April 17, 2009 12:37 PM
To: java-user@lucene.apache.org
Subject: RE: Need help : SpanNearQuery

Hi Steven,
Thanks for your reply.

I tried out your approach and the problem got solved to an extent but still=
 it remains.

The problem is the score reduces quite a bit even now as bc is not found in=
 the combinations
 ( bc,cd) ( bc,ef) and ( ab,bc,cd,ef) etc.=20

The boosting infact has a negative impact and reduces the score further :(

The factor which is affected by boosting is the queryNorm .

With a boost of 6  -=20

0.015559823 =3D (MATCH) max of:
  0.015559823 =3D (MATCH) weight(spanNear([SearchField:cd, SearchField:ef],=
 10, false)^6.0 in 0), product of:
    0.07606166 =3D queryWeight(spanNear([SearchField:cd, SearchField:ef], 1=
0, false)^6.0), product of:
      6.0 =3D boost
      0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
      0.02065639 =3D queryNorm
    0.20456855 =3D (MATCH) fieldWeight(SearchField:spanNear([cd, ef], 10, f=
alse)^6.0 in 0), product of:
      0.33333334 =3D tf(phraseFreq=3D0.33333334)
      0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
      1.0 =3D fieldNorm(field=3DSearchField, doc=3D0)

Without a boost  -=20

0.07779912 =3D (MATCH) max of:
  0.07779912 =3D (MATCH) weight(spanNear([SearchField:cd, SearchField:ef], =
10, false) in 0), product of:
    0.3803083 =3D queryWeight(spanNear([SearchField:cd, SearchField:ef], 10=
, false)), product of:
      0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
      0.6196917 =3D queryNorm
    0.20456855 =3D (MATCH) fieldWeight(SearchField:spanNear([cd, ef], 10, f=
alse) in 0), product of:
      0.33333334 =3D tf(phraseFreq=3D0.33333334)
      0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
      1.0 =3D fieldNorm(field=3DSearchField, doc=3D0)


Regards,
Radha
-----Original Message-----
From: Steven A Rowe [mailto:sarowe@syr.edu]=20
Sent: Thursday, April 16, 2009 10:35 PM
To: java-user@lucene.apache.org
Subject: RE: Need help : SpanNearQuery

Hi Radha,

On 4/16/2009 at 8:35 AM, Radhalakshmi Sredharan wrote:
> I have a question related to SpanNearQuery.
>=20
> I need a hit even if there are 2/3 terms found with the span being
> applied for those 2 terms.
>=20
> Is there any custom implementation in place for this? I checked
> SrndQuery but that also doesn't work.
>=20
> This is my workaround currently:
>=20
> 1)      For a list of terms ( ab,bc, cd,ef) , make a set like ( ab,bc)
> , ( bc,cd) ( ab,cd) (bc,ef) ( ab,bc,cd) ( ab,bc,cd,ef)..... and so on.
>=20
> 2)      Create a spanNearQuery for  each of these terms
>=20
> 3)      Add it to the booleanQuery with a  SHOULD clause.
>=20
> However this approach gives me puzzling scores
>  eg If my document has  only ( ab,bc,cd) the penalty for the missing ef
> is very high and my score comes down quite a bit.

Do you know about the scoring documentation on the Lucene site: <http://luc=
ene.apache.org/java/2_4_1/scoring.html> ?  In particular, see the link from=
 there to the Searcher.explain() javadocs - this functionality will help yo=
u understand what's happening with your queries.

I suspect that the penalty is due to fewer sub-queries matching; that is, n=
ot only does (ab,bc,cd,ef) fail to match, but (ab,bc,ef), (ab,cd,ef), (ab,e=
f) etc. also fail to match, and since all of these contribute to the final =
score, you will see a large drop off if you don't get a full match.

Instead of putting all of the alternatives together in a single large disju=
nction, if you package them such that the shorter alternatives don't influe=
nce the final score when larger ones match, you may get something more like=
 what you want.  I think DisjunctionMaxQuery <http://lucene.apache.org/java=
/2_4_1/api/org/apache/lucene/search/DisjunctionMaxQuery.html>, along with j=
udicious boosting, will do the trick, e.g.:

DMQ((ab,bc,cd,ef)^100,
    ((ab,bc,cd)^10 (ab,bc,ef)^10 (ab,cd,ef)^10 ...),
    ((ab,bc) (ab,cd) (ab,ef) ...))

Steve


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


**************** CAUTION - Disclaimer *****************
This e-mail contains PRIVILEGED AND CONFIDENTIAL INFORMATION intended solel=
y=20
for the use of the addressee(s). If you are not the intended recipient, ple=
ase=20
notify the sender by e-mail and delete the original message. Further, you a=
re not=20
to copy, disclose, or distribute this e-mail or its contents to any other p=
erson and=20
any such actions are unlawful. This e-mail may contain viruses. Infosys has=
 taken=20
every reasonable precaution to minimize this risk, but is not liable for an=
y damage=20
you may sustain as a result of any virus in this e-mail. You should carry o=
ut your=20
own virus checks before opening the e-mail or attachment. Infosys reserves =
the=20
right to monitor and review the content of all messages sent to or from thi=
s e-mail=20
address. Messages sent to or from this e-mail address may be stored on the=
=20
Infosys e-mail system.
***INFOSYS******** End of Disclaimer ********INFOSYS***

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39770-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 13:44:38 2009
Return-Path: <java-user-return-39770-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42417 invoked from network); 17 Apr 2009 13:44:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 13:44:37 -0000
Received: (qmail 78191 invoked by uid 500); 17 Apr 2009 13:44:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78153 invoked by uid 500); 17 Apr 2009 13:44:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78143 invoked by uid 99); 17 Apr 2009 13:44:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 13:44:35 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.221.136 as permitted sender)
Received: from [209.85.221.136] (HELO mail-qy0-f136.google.com) (209.85.221.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 13:44:28 +0000
Received: by qyk42 with SMTP id 42so737922qyk.29
        for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 06:44:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=v5n3a+9Rpk4P3QRtjn5VX/DuYrelNA8QUdWGs6SzdVE=;
        b=Ogf1suSYs4UbEvU5GChokfRU2tpTSLG4C8z6+1georopfplGCJl1ggKaQWJGYN16OY
         qnYudWHJTDMPnyvKiyrQjum2FgDNYWEqT+pEHWKhQZknpNRDs1Ic/qqhqWHw+eA4N5f5
         QmWzhAss4eVUy6LFUm6LLoAFFlWNjW/plvZqA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=vuPJ8J0r0+m2Ea+Hj5W4S6CFqQB4f2qsaDDq64/2OXWFYdsYsIPL/rzAJzCFNWjPu/
         fibZtAZcwfiHufg9pzdr4gQZASYkk/bh0gnLsqPl9PuSeOfi5A+9bMjqa3OL+tlW2dHr
         MIei1rVOaP3Dw8+Hke5/lcDdBWOwV+NivHZdA=
MIME-Version: 1.0
Received: by 10.220.87.4 with SMTP id u4mr2909904vcl.28.1239975847528; Fri, 17 
	Apr 2009 06:44:07 -0700 (PDT)
In-Reply-To: <d36c28c30904162207x4489ce94l522f1c998c58a8d5@mail.gmail.com>
References: <d36c28c30904160327y55642450v8bcd34faa309dbd1@mail.gmail.com>
	 <d36c28c30904160501t33ca3057sd587655b15ece941@mail.gmail.com>
	 <359a92830904160813m9c1ebe4w23d71d99422e66e0@mail.gmail.com>
	 <d36c28c30904162207x4489ce94l522f1c998c58a8d5@mail.gmail.com>
Date: Fri, 17 Apr 2009 09:44:07 -0400
Message-ID: <359a92830904170644l4aa3facbk2a4d6831d9b99ac8@mail.gmail.com>
Subject: Re: Query scoring
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6475f1aec0db50467c05f3f
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6475f1aec0db50467c05f3f
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Well, let's see the results of toString and/or Explain *from your code*.
Otherwise, you haven't given us much to go on.

Best
Erick

On Fri, Apr 17, 2009 at 1:07 AM, liat oren <oren.liat@gmail.com> wrote:

> Thanks for the answer.
>
> In Luke, I used the WhiteSpaceAnalyzer as well. The scores AND the explain
> method worked perfectly.
>
> In my application, I checked for the query - it contains the numbers
> splitted in different term queries so it prepares it well. Also the scoring
> is good. However the explain shows NO MATCH so all the parts of the
> calculations are 0. very strange...
>
> Best,
> Liat
>
> 2009/4/16 Erick Erickson <erickerickson@gmail.com>
>
> > Hmmm, try query.toString() and/or query.explain().
> >
> > Also, try using Luke to see what is actually in the document.
> > BTW, what analyzer did you use in Luke? Luke also has an
> > explain (tab?) that will show you what Luke does, which may
> > be useful.
> >
> > The default operator should be "OR", but looking at the actual
> > query should help you figure out whether that's happening.
> >
> > Best
> > Erick
> >
> >
> > On Thu, Apr 16, 2009 at 8:01 AM, liat oren <oren.liat@gmail.com> wrote:
> >
> > > I wanted to add also that I index it tokenized and that when I use Luke
> > to
> > > do this search, it gives the correct results.
> > >
> > > Should I run the query differntly than the way I do?
> > >
> > > 2009/4/16 liat oren <oren.liat@gmail.com>
> > >
> > > >  Hi,
> > > >
> > > > I try to understand why the following query gives the scoring below:
> > > >
> > > > document 1 : a b c document 2 : g k a h u c
> > > >
> > > >
> > > > 0.0 = (NON-MATCH) product of:
> > > >   0.0 = (NON-MATCH) sum of:
> > > >   0.0 = coord(0/3)
> > > > 0.06155877
> > > >
> > > > The query code is:
> > > >    IndexSearcher searcher = new IndexSearcher(path);
> > > >    Analyzer analyzer = new StandardAnalyzer();
> > > >    QueryParser parser = new QueryParser("text", analyzer);
> > > >    Query query = parser.parse("g k a h u c");
> > > >    Hits hits = searcher.search(query);
> > > > I also tried the WhiteSpaceAnalyzer.
> > > >
> > > > Why does it give me "no match"?
> > > > doesn't if have to do "or" on each of the letters "g k a h u c"?
> > > >
> > > > Thanks,
> > > > Liat
> > > >
> > > >
> > > >
> > > >
> > >
> >
>

--0016e6475f1aec0db50467c05f3f--

From java-user-return-39771-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 14:11:44 2009
Return-Path: <java-user-return-39771-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61095 invoked from network); 17 Apr 2009 14:11:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 14:11:44 -0000
Received: (qmail 24292 invoked by uid 500); 17 Apr 2009 14:11:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24232 invoked by uid 500); 17 Apr 2009 14:11:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24222 invoked by uid 99); 17 Apr 2009 14:11:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 14:11:41 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [203.188.202.89] (HELO n8.bullet.mail.tp2.yahoo.com) (203.188.202.89)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 17 Apr 2009 14:11:29 +0000
Received: from [203.188.202.76] by n8.bullet.mail.tp2.yahoo.com with NNFMP; 17 Apr 2009 14:11:04 -0000
Received: from [124.108.115.242] by t2.bullet.mail.tp2.yahoo.com with NNFMP; 17 Apr 2009 14:11:04 -0000
Received: from [124.108.114.82] by t1.bullet.mail.sg1.yahoo.com with NNFMP; 17 Apr 2009 14:10:54 -0000
Received: from [127.0.0.1] by omp102.mail.sg1.yahoo.com with NNFMP; 17 Apr 2009 14:11:04 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 675084.25617.bm@omp102.mail.sg1.yahoo.com
Received: (qmail 5151 invoked by uid 60001); 17 Apr 2009 14:11:04 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1239977464; bh=OYq1r9ICNO/LVmZJJXwhSeLw/QWsFHZxkEcZumxN73M=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=XEEvUHhu80WBRy+uah9w3zqxwxRiIwwOHbFCQ2DLWxv8oWxCNEd7szfa5XDlgcqNiKFhmlowBbF1zSOVgT/qT+E+W/zzkW9oxgkAew12BH2yuWG5hoZIfBg5emMrt9BoFTA1EN8qIdVV7aunibslTVN4ZLlVaaQOGr8nMIVEWGY=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=fF8+2gTHc2jxA8Picx/3A/pI2FCllOdsYDkxbi9UIhAoEjYqfPo/A5ftq2J8rTqeRXl3PpVOxbOWQSDjQjv2FfBIGk60TWHApQy+yMEhhiLioUAJ/99kCTtmmtQWJ3ckY+HkD4JqyaPq8JCqvy99PJgbo5AkpR2+sfsmciDT3H0=;
Message-ID: <572494.99931.qm@web76013.mail.sg1.yahoo.com>
X-YMail-OSG: 6sZWIdgVM1ndL5BsY.3ybW46cvoeUt2YQTz8D3KFVuPPfU2LoVr.o0IFyZY0T0x1o77LGxBGjNbb7I801t4jDPfQ8RiUE2CCQYxF2THUgyYQJZJRyvEzFBTJXrUdUMty5lnWoGVuj0vLpDMhHc4LBnIRM7A6CyStZAncAKd4DWaDaGdq0kfrv7nDD3EEUsoDklF3cDrYlJkM7abf_YTe90brEj3brqS05QIppa3izrLlrEM49P6ZsQ--
Received: from [114.59.109.167] by web76013.mail.sg1.yahoo.com via HTTP; Fri, 17 Apr 2009 22:11:04 SGT
X-Mailer: YahooMailClassic/5.2.18 YahooMailWebService/0.7.289.10
Date: Fri, 17 Apr 2009 22:11:04 +0800 (SGT)
From: daniel susanto <daniel_sus777@yahoo.com>
Subject: Is it possible to add new document into existing lucene index?
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-277653618-1239977464=:99931"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-277653618-1239977464=:99931
Content-Type: text/plain; charset=us-ascii

Hi all,

I'm NB in Lucene. 
Is it possible to add new document into existing document? I think it is important so that we don't need to re-index the all in file folder if just one or two file that need to be added into index. Thx.

Daniel Susanto
http://susantodaniel.wordpress.com


      
--0-277653618-1239977464=:99931--


From java-user-return-39772-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 14:19:24 2009
Return-Path: <java-user-return-39772-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67646 invoked from network); 17 Apr 2009 14:19:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 14:19:24 -0000
Received: (qmail 37375 invoked by uid 500); 17 Apr 2009 14:19:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37298 invoked by uid 500); 17 Apr 2009 14:19:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37288 invoked by uid 99); 17 Apr 2009 14:19:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 14:19:22 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 14:19:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 69F95518EB
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 16:18:51 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 25493-01 for <java-user@lucene.apache.org>;
 Fri, 17 Apr 2009 16:18:49 +0200 (CEST)
Received: from VEGA (port-83-236-62-13.dynamic.qsc.de [83.236.62.13])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 7EECF5184A
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 16:18:49 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <572494.99931.qm@web76013.mail.sg1.yahoo.com>
Subject: RE: Is it possible to add new document into existing lucene index?
Date: Fri, 17 Apr 2009 16:18:49 +0200
Message-ID: <06FB7D1216DB48F1AA3C86A7F91FB045@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: Acm/ZnGW9X+LIvNJQ++M/GLPBgyOYAAAOB8g
In-Reply-To: <572494.99931.qm@web76013.mail.sg1.yahoo.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Daniel,

Just open the IndexWriter on the same Lucene Directory and specify the
boolean ctor parameter "create" to false.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: daniel susanto [mailto:daniel_sus777@yahoo.com]
> Sent: Friday, April 17, 2009 4:11 PM
> To: java-user@lucene.apache.org
> Subject: Is it possible to add new document into existing lucene index?
> 
> Hi all,
> 
> I'm NB in Lucene.
> Is it possible to add new document into existing document? I think it is
> important so that we don't need to re-index the all in file folder if just
> one or two file that need to be added into index. Thx.
> 
> Daniel Susanto
> http://susantodaniel.wordpress.com
> 
> 
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39773-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 14:30:10 2009
Return-Path: <java-user-return-39773-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71739 invoked from network); 17 Apr 2009 14:30:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 14:30:10 -0000
Received: (qmail 52494 invoked by uid 500); 17 Apr 2009 14:30:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52422 invoked by uid 500); 17 Apr 2009 14:30:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52412 invoked by uid 99); 17 Apr 2009 14:30:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 14:30:07 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.36] (HELO smtp-vbr16.xs4all.nl) (194.109.24.36)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 14:29:59 +0000
Received: from k8u.localnet (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr16.xs4all.nl (8.13.8/8.13.8) with ESMTP id n3HETa4n024207
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 16:29:36 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Need help : SpanNearQuery
Date: Fri, 17 Apr 2009 16:29:34 +0200
User-Agent: KMail/1.10.4 (Linux/2.6.27-11-generic; KDE/4.1.4; i686; ; )
References: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30@BLRKECMBX09.ad.infosys.com> <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9C012D@BLRKECMBX09.ad.infosys.com> <5CDA3DC1F80BBB42BD0B48FABC128B5114F30519B1@BLRKECMBX09.ad.infosys.com>
In-Reply-To: <5CDA3DC1F80BBB42BD0B48FABC128B5114F30519B1@BLRKECMBX09.ad.infosys.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
  boundary="Boundary-00=_OJJ6JDaxZDfa4wb"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200904171629.34615.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

--Boundary-00=_OJJ6JDaxZDfa4wb
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit

To avoid passing all combinations to a NearSpansQuery
some non trivial changes would be needed in the spans package.

NearSpansUnOrdered (and maybe also NearSpansOrdered)
would have to be extended to provide matching Spans when
(the Spans of) not all terms/subqueries match.

Also, quite likely, it will be necessary add a float getWeight() method
to the Spans interface. This value could indicate how many
terms/subqueries actually matched, and then be used in SpanScorer
to provide a score for the matching document.
This weight value would also be useful in other cases, for
example to allow different weights in SpanTermQuery.

Regards,
Paul Elschot


On Friday 17 April 2009 12:18:46 Radhalakshmi Sreedharan wrote:
> To make the question simple,
> 
> What I need is  the following :
> If my document field is ( ab,bc,cd,ef) and Search tokens are (ab,bc,cd). 
> 
> Given the following : 
>  I should get a hit even if all of the search tokens aren't present
>  If the tokens are found they should be found within a distance x of each other ( proximity search)
> 
> I need the percentage match of the search tokens with the document field. 
> 
> Currently this is my query :  
> 1) I form all possible permutation of the search tokens 
> 2) do a spanNearQuery of each permutation
> 3)  Do a DisjunctionMaxQuery on the spannearqueries. 
> 
> This is how I compute % match  : 
> % match =  ( Score by running the query on the document field ) /
> 		( score by running the query on a document field created out of search tokens )
> 
> The numerator gives me the actual score with the search tokens run on the field.
> Denominator gives  me the  best possible or maximum possible score with the current search tokens
> 
> For this example << If my document field is ( ab,bc,cd,ef) and Search tokens are (ab,bc,cd).>> I expect a % match of around 90%.
> 
> However I get a match of only around 50% without a boost. Using a boost infact reduces my percentage. 
> 
> I even overrode the queryNorm method to return a one, still the percentage did not increase.
> 
> Any suggestions ?
> -----Original Message-----
> From: Radhalakshmi Sreedharan [mailto:Radhalakshmi_S@infosys.com] 
> Sent: Friday, April 17, 2009 12:37 PM
> To: java-user@lucene.apache.org
> Subject: RE: Need help : SpanNearQuery
> 
> Hi Steven,
> Thanks for your reply.
> 
> I tried out your approach and the problem got solved to an extent but still it remains.
> 
> The problem is the score reduces quite a bit even now as bc is not found in the combinations
>  ( bc,cd) ( bc,ef) and ( ab,bc,cd,ef) etc. 
> 
> The boosting infact has a negative impact and reduces the score further :(
> 
> The factor which is affected by boosting is the queryNorm .
> 
> With a boost of 6  - 
> 
> 0.015559823 = (MATCH) max of:
>   0.015559823 = (MATCH) weight(spanNear([SearchField:cd, SearchField:ef], 10, false)^6.0 in 0), product of:
>     0.07606166 = queryWeight(spanNear([SearchField:cd, SearchField:ef], 10, false)^6.0), product of:
>       6.0 = boost
>       0.61370564 = idf(SearchField: cd=1 ef=1)
>       0.02065639 = queryNorm
>     0.20456855 = (MATCH) fieldWeight(SearchField:spanNear([cd, ef], 10, false)^6.0 in 0), product of:
>       0.33333334 = tf(phraseFreq=0.33333334)
>       0.61370564 = idf(SearchField: cd=1 ef=1)
>       1.0 = fieldNorm(field=SearchField, doc=0)
> 
> Without a boost  - 
> 
> 0.07779912 = (MATCH) max of:
>   0.07779912 = (MATCH) weight(spanNear([SearchField:cd, SearchField:ef], 10, false) in 0), product of:
>     0.3803083 = queryWeight(spanNear([SearchField:cd, SearchField:ef], 10, false)), product of:
>       0.61370564 = idf(SearchField: cd=1 ef=1)
>       0.6196917 = queryNorm
>     0.20456855 = (MATCH) fieldWeight(SearchField:spanNear([cd, ef], 10, false) in 0), product of:
>       0.33333334 = tf(phraseFreq=0.33333334)
>       0.61370564 = idf(SearchField: cd=1 ef=1)
>       1.0 = fieldNorm(field=SearchField, doc=0)
> 
> 
> Regards,
> Radha
> -----Original Message-----
> From: Steven A Rowe [mailto:sarowe@syr.edu] 
> Sent: Thursday, April 16, 2009 10:35 PM
> To: java-user@lucene.apache.org
> Subject: RE: Need help : SpanNearQuery
> 
> Hi Radha,
> 
> On 4/16/2009 at 8:35 AM, Radhalakshmi Sredharan wrote:
> > I have a question related to SpanNearQuery.
> > 
> > I need a hit even if there are 2/3 terms found with the span being
> > applied for those 2 terms.
> > 
> > Is there any custom implementation in place for this? I checked
> > SrndQuery but that also doesn't work.
> > 
> > This is my workaround currently:
> > 
> > 1)      For a list of terms ( ab,bc, cd,ef) , make a set like ( ab,bc)
> > , ( bc,cd) ( ab,cd) (bc,ef) ( ab,bc,cd) ( ab,bc,cd,ef)..... and so on.
> > 
> > 2)      Create a spanNearQuery for  each of these terms
> > 
> > 3)      Add it to the booleanQuery with a  SHOULD clause.
> > 
> > However this approach gives me puzzling scores
> >  eg If my document has  only ( ab,bc,cd) the penalty for the missing ef
> > is very high and my score comes down quite a bit.
> 
> Do you know about the scoring documentation on the Lucene site: <http://lucene.apache.org/java/2_4_1/scoring.html> ?  In particular, see the link from there to the Searcher.explain() javadocs - this functionality will help you understand what's happening with your queries.
> 
> I suspect that the penalty is due to fewer sub-queries matching; that is, not only does (ab,bc,cd,ef) fail to match, but (ab,bc,ef), (ab,cd,ef), (ab,ef) etc. also fail to match, and since all of these contribute to the final score, you will see a large drop off if you don't get a full match.
> 
> Instead of putting all of the alternatives together in a single large disjunction, if you package them such that the shorter alternatives don't influence the final score when larger ones match, you may get something more like what you want.  I think DisjunctionMaxQuery <http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/DisjunctionMaxQuery.html>, along with judicious boosting, will do the trick, e.g.:
> 
> DMQ((ab,bc,cd,ef)^100,
>     ((ab,bc,cd)^10 (ab,bc,ef)^10 (ab,cd,ef)^10 ...),
>     ((ab,bc) (ab,cd) (ab,ef) ...))
> 
> Steve
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> **************** CAUTION - Disclaimer *****************
> This e-mail contains PRIVILEGED AND CONFIDENTIAL INFORMATION intended solely 
> for the use of the addressee(s). If you are not the intended recipient, please 
> notify the sender by e-mail and delete the original message. Further, you are not 
> to copy, disclose, or distribute this e-mail or its contents to any other person and 
> any such actions are unlawful. This e-mail may contain viruses. Infosys has taken 
> every reasonable precaution to minimize this risk, but is not liable for any damage 
> you may sustain as a result of any virus in this e-mail. You should carry out your 
> own virus checks before opening the e-mail or attachment. Infosys reserves the 
> right to monitor and review the content of all messages sent to or from this e-mail 
> address. Messages sent to or from this e-mail address may be stored on the 
> Infosys e-mail system.
> ***INFOSYS******** End of Disclaimer ********INFOSYS***
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
> 

--Boundary-00=_OJJ6JDaxZDfa4wb--

From java-user-return-39774-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 14:34:01 2009
Return-Path: <java-user-return-39774-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74283 invoked from network); 17 Apr 2009 14:34:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 14:34:01 -0000
Received: (qmail 58961 invoked by uid 500); 17 Apr 2009 14:33:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58889 invoked by uid 500); 17 Apr 2009 14:33:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58879 invoked by uid 99); 17 Apr 2009 14:33:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 14:33:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [122.98.10.31] (HELO KECGATE03.infosys.com) (122.98.10.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 14:33:52 +0000
X-TM-IMSS-Message-ID:<9741e4a000010b40@KECGATE03.infosys.com>
Received: from blrkechub03.ad.infosys.com ([10.66.236.43]) by KECGATE03.infosys.com ([122.98.10.31]) with ESMTP (TREND IMSS SMTP Service 7.0; TLS: TLSv1/SSLv3,128bits,RC4-MD5) id 9741e4a000010b40 ; Fri, 17 Apr 2009 20:01:02 +0530
Received: from BLRKECMBX09.ad.infosys.com ([10.66.236.82]) by
 blrkechub03.ad.infosys.com ([10.66.236.43]) with mapi; Fri, 17 Apr 2009
 20:03:28 +0530
From: "Radhalakshmi  Sreedharan" <Radhalakshmi_S@infosys.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 17 Apr 2009 20:03:27 +0530
Subject: RE: Need help : SpanNearQuery
Thread-Topic: Need help : SpanNearQuery
Thread-Index: Acm/aQZYRrAG6qCISwSDLlsRV2yKnwAAEIzA
Message-ID: <5CDA3DC1F80BBB42BD0B48FABC128B5114F3051ADA@BLRKECMBX09.ad.infosys.com>
References: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30@BLRKECMBX09.ad.infosys.com>
 <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9C012D@BLRKECMBX09.ad.infosys.com>
 <5CDA3DC1F80BBB42BD0B48FABC128B5114F30519B1@BLRKECMBX09.ad.infosys.com>
 <200904171629.34615.paul.elschot@xs4all.nl>
In-Reply-To: <200904171629.34615.paul.elschot@xs4all.nl>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Paul. Is there any alternative way of implementing this requirement?

As a side note, Will the Shingle Filter help me getting all possible combin=
ation of the input tokens?

-----Original Message-----
From: Paul Elschot [mailto:paul.elschot@xs4all.nl]=20
Sent: Friday, April 17, 2009 8:00 PM
To: java-user@lucene.apache.org
Subject: Re: Need help : SpanNearQuery

To avoid passing all combinations to a NearSpansQuery
some non trivial changes would be needed in the spans package.

NearSpansUnOrdered (and maybe also NearSpansOrdered)
would have to be extended to provide matching Spans when
(the Spans of) not all terms/subqueries match.

Also, quite likely, it will be necessary add a float getWeight() method
to the Spans interface. This value could indicate how many
terms/subqueries actually matched, and then be used in SpanScorer
to provide a score for the matching document.
This weight value would also be useful in other cases, for
example to allow different weights in SpanTermQuery.

Regards,
Paul Elschot


On Friday 17 April 2009 12:18:46 Radhalakshmi Sreedharan wrote:
> To make the question simple,
>=20
> What I need is  the following :
> If my document field is ( ab,bc,cd,ef) and Search tokens are (ab,bc,cd).=
=20
>=20
> Given the following :=20
>  I should get a hit even if all of the search tokens aren't present
>  If the tokens are found they should be found within a distance x of each=
 other ( proximity search)
>=20
> I need the percentage match of the search tokens with the document field.=
=20
>=20
> Currently this is my query : =20
> 1) I form all possible permutation of the search tokens=20
> 2) do a spanNearQuery of each permutation
> 3)  Do a DisjunctionMaxQuery on the spannearqueries.=20
>=20
> This is how I compute % match  :=20
> % match =3D  ( Score by running the query on the document field ) /
> 		( score by running the query on a document field created out of search =
tokens )
>=20
> The numerator gives me the actual score with the search tokens run on the=
 field.
> Denominator gives  me the  best possible or maximum possible score with t=
he current search tokens
>=20
> For this example << If my document field is ( ab,bc,cd,ef) and Search tok=
ens are (ab,bc,cd).>> I expect a % match of around 90%.
>=20
> However I get a match of only around 50% without a boost. Using a boost i=
nfact reduces my percentage.=20
>=20
> I even overrode the queryNorm method to return a one, still the percentag=
e did not increase.
>=20
> Any suggestions ?
> -----Original Message-----
> From: Radhalakshmi Sreedharan [mailto:Radhalakshmi_S@infosys.com]=20
> Sent: Friday, April 17, 2009 12:37 PM
> To: java-user@lucene.apache.org
> Subject: RE: Need help : SpanNearQuery
>=20
> Hi Steven,
> Thanks for your reply.
>=20
> I tried out your approach and the problem got solved to an extent but sti=
ll it remains.
>=20
> The problem is the score reduces quite a bit even now as bc is not found =
in the combinations
>  ( bc,cd) ( bc,ef) and ( ab,bc,cd,ef) etc.=20
>=20
> The boosting infact has a negative impact and reduces the score further :=
(
>=20
> The factor which is affected by boosting is the queryNorm .
>=20
> With a boost of 6  -=20
>=20
> 0.015559823 =3D (MATCH) max of:
>   0.015559823 =3D (MATCH) weight(spanNear([SearchField:cd, SearchField:ef=
], 10, false)^6.0 in 0), product of:
>     0.07606166 =3D queryWeight(spanNear([SearchField:cd, SearchField:ef],=
 10, false)^6.0), product of:
>       6.0 =3D boost
>       0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
>       0.02065639 =3D queryNorm
>     0.20456855 =3D (MATCH) fieldWeight(SearchField:spanNear([cd, ef], 10,=
 false)^6.0 in 0), product of:
>       0.33333334 =3D tf(phraseFreq=3D0.33333334)
>       0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
>       1.0 =3D fieldNorm(field=3DSearchField, doc=3D0)
>=20
> Without a boost  -=20
>=20
> 0.07779912 =3D (MATCH) max of:
>   0.07779912 =3D (MATCH) weight(spanNear([SearchField:cd, SearchField:ef]=
, 10, false) in 0), product of:
>     0.3803083 =3D queryWeight(spanNear([SearchField:cd, SearchField:ef], =
10, false)), product of:
>       0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
>       0.6196917 =3D queryNorm
>     0.20456855 =3D (MATCH) fieldWeight(SearchField:spanNear([cd, ef], 10,=
 false) in 0), product of:
>       0.33333334 =3D tf(phraseFreq=3D0.33333334)
>       0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
>       1.0 =3D fieldNorm(field=3DSearchField, doc=3D0)
>=20
>=20
> Regards,
> Radha
> -----Original Message-----
> From: Steven A Rowe [mailto:sarowe@syr.edu]=20
> Sent: Thursday, April 16, 2009 10:35 PM
> To: java-user@lucene.apache.org
> Subject: RE: Need help : SpanNearQuery
>=20
> Hi Radha,
>=20
> On 4/16/2009 at 8:35 AM, Radhalakshmi Sredharan wrote:
> > I have a question related to SpanNearQuery.
> >=20
> > I need a hit even if there are 2/3 terms found with the span being
> > applied for those 2 terms.
> >=20
> > Is there any custom implementation in place for this? I checked
> > SrndQuery but that also doesn't work.
> >=20
> > This is my workaround currently:
> >=20
> > 1)      For a list of terms ( ab,bc, cd,ef) , make a set like ( ab,bc)
> > , ( bc,cd) ( ab,cd) (bc,ef) ( ab,bc,cd) ( ab,bc,cd,ef)..... and so on.
> >=20
> > 2)      Create a spanNearQuery for  each of these terms
> >=20
> > 3)      Add it to the booleanQuery with a  SHOULD clause.
> >=20
> > However this approach gives me puzzling scores
> >  eg If my document has  only ( ab,bc,cd) the penalty for the missing ef
> > is very high and my score comes down quite a bit.
>=20
> Do you know about the scoring documentation on the Lucene site: <http://l=
ucene.apache.org/java/2_4_1/scoring.html> ?  In particular, see the link fr=
om there to the Searcher.explain() javadocs - this functionality will help =
you understand what's happening with your queries.
>=20
> I suspect that the penalty is due to fewer sub-queries matching; that is,=
 not only does (ab,bc,cd,ef) fail to match, but (ab,bc,ef), (ab,cd,ef), (ab=
,ef) etc. also fail to match, and since all of these contribute to the fina=
l score, you will see a large drop off if you don't get a full match.
>=20
> Instead of putting all of the alternatives together in a single large dis=
junction, if you package them such that the shorter alternatives don't infl=
uence the final score when larger ones match, you may get something more li=
ke what you want.  I think DisjunctionMaxQuery <http://lucene.apache.org/ja=
va/2_4_1/api/org/apache/lucene/search/DisjunctionMaxQuery.html>, along with=
 judicious boosting, will do the trick, e.g.:
>=20
> DMQ((ab,bc,cd,ef)^100,
>     ((ab,bc,cd)^10 (ab,bc,ef)^10 (ab,cd,ef)^10 ...),
>     ((ab,bc) (ab,cd) (ab,ef) ...))
>=20
> Steve
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> **************** CAUTION - Disclaimer *****************
> This e-mail contains PRIVILEGED AND CONFIDENTIAL INFORMATION intended sol=
ely=20
> for the use of the addressee(s). If you are not the intended recipient, p=
lease=20
> notify the sender by e-mail and delete the original message. Further, you=
 are not=20
> to copy, disclose, or distribute this e-mail or its contents to any other=
 person and=20
> any such actions are unlawful. This e-mail may contain viruses. Infosys h=
as taken=20
> every reasonable precaution to minimize this risk, but is not liable for =
any damage=20
> you may sustain as a result of any virus in this e-mail. You should carry=
 out your=20
> own virus checks before opening the e-mail or attachment. Infosys reserve=
s the=20
> right to monitor and review the content of all messages sent to or from t=
his e-mail=20
> address. Messages sent to or from this e-mail address may be stored on th=
e=20
> Infosys e-mail system.
> ***INFOSYS******** End of Disclaimer ********INFOSYS***
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20
>=20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39775-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 14:40:21 2009
Return-Path: <java-user-return-39775-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76316 invoked from network); 17 Apr 2009 14:40:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 14:40:21 -0000
Received: (qmail 68703 invoked by uid 500); 17 Apr 2009 14:40:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68655 invoked by uid 500); 17 Apr 2009 14:40:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68645 invoked by uid 99); 17 Apr 2009 14:40:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 14:40:18 +0000
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=PLING_QUERY,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 14:40:10 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LupEL-0005lZ-Fb
	for java-user@lucene.apache.org; Fri, 17 Apr 2009 07:39:49 -0700
Message-ID: <23098961.post@talk.nabble.com>
Date: Fri, 17 Apr 2009 07:39:49 -0700 (PDT)
From: theDude_2 <aornstein@webmd.net>
To: java-user@lucene.apache.org
Subject: Re: A Challenge!: Combining 2 searches into a single resultset?
In-Reply-To: <23085506.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: aornstein@webmd.net
References: <23085506.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


(bump) - any thoughts?
----



theDude_2 wrote:
> 
> hi!
> 
> I am trying to do something a little unique...
> 
> I have a 90k text documents that I am trying to search
> Search A: indexes and searches the documents using regular relevancy
> search
> Search B: indexes and searches the documents using a smaller subset of
> "key" words that I have chosen
> 
> This gives me 2 seperate scores: Score A, and Score B...
> 
> I am trying to show the top 10 results of the scores combined so....
> 
> FinalScoretextDoc = (scoreA_of_td1 * 0.5) * (scoreB_of_td1 * 0.5)
> 
> While it seems straightforward, I do not want to calculate the scores of
> all the documents outside of lucene.  How can I integrate this better into
> the lucene search engine?  Is this possible to do by any simple means?
> 
> Thanks guys + gals!
> 
> 

-- 
View this message in context: http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23098961.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39776-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 14:51:40 2009
Return-Path: <java-user-return-39776-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82420 invoked from network); 17 Apr 2009 14:51:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 14:51:39 -0000
Received: (qmail 3190 invoked by uid 500); 17 Apr 2009 14:51:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3138 invoked by uid 500); 17 Apr 2009 14:51:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3128 invoked by uid 99); 17 Apr 2009 14:51:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 14:51:37 +0000
X-ASF-Spam-Status: No, hits=3.5 required=10.0
	tests=HTML_MESSAGE,PLING_QUERY
X-Spam-Check-By: apache.org
Received-SPF: unknown (athena.apache.org: error in processing during lookup of pjaol@pjaol.com)
Received: from [74.125.44.29] (HELO yx-out-2324.google.com) (74.125.44.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 14:51:28 +0000
Received: by yx-out-2324.google.com with SMTP id 8so509980yxb.5
        for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 07:51:04 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.46.3 with SMTP id y3mr248111ybj.41.1239979864911; Fri, 17 
	Apr 2009 07:51:04 -0700 (PDT)
In-Reply-To: <23098961.post@talk.nabble.com>
References: <23085506.post@talk.nabble.com> <23098961.post@talk.nabble.com>
Date: Fri, 17 Apr 2009 10:51:04 -0400
Message-ID: <1e33aedb0904170751y4ead4a89v33a933991caa3a87@mail.gmail.com>
Subject: Re: A Challenge!: Combining 2 searches into a single resultset?
From: "patrick o'leary" <pjaol@pjaol.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151750e13a606e4e0467c14f88
X-Virus-Checked: Checked by ClamAV on apache.org

--00151750e13a606e4e0467c14f88
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I'd start by doing some research on the question rather than asking for a
solution..
What your asking for can be considered 'Federated Search'
http://en.wikipedia.org/wiki/Federated_search

And it can be conceived in as many ways as you have document types. Any
answer will probably end up
customized and weighted by your document silo value, usually companies
weight those by business rules
rather than head down the path of federated search, as it's just quicker and
cheaper, and you can accomplish more.
e.g
Medication = score *2  (as higher advertising incentives)
Diseases = score
Books = score * 0.75  ( thousands of books, which nobody buys etc..)

You might also want to try consolidating your data into 1 schema, and
consider layering or collapsing results
based on type.

P

On Fri, Apr 17, 2009 at 10:39 AM, theDude_2 <aornstein@webmd.net> wrote:

>
> (bump) - any thoughts?
> ----
>
>
>
> theDude_2 wrote:
> >
> > hi!
> >
> > I am trying to do something a little unique...
> >
> > I have a 90k text documents that I am trying to search
> > Search A: indexes and searches the documents using regular relevancy
> > search
> > Search B: indexes and searches the documents using a smaller subset of
> > "key" words that I have chosen
> >
> > This gives me 2 seperate scores: Score A, and Score B...
> >
> > I am trying to show the top 10 results of the scores combined so....
> >
> > FinalScoretextDoc = (scoreA_of_td1 * 0.5) * (scoreB_of_td1 * 0.5)
> >
> > While it seems straightforward, I do not want to calculate the scores of
> > all the documents outside of lucene.  How can I integrate this better
> into
> > the lucene search engine?  Is this possible to do by any simple means?
> >
> > Thanks guys + gals!
> >
> >
>
> --
> View this message in context:
> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23098961.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00151750e13a606e4e0467c14f88--

From java-user-return-39777-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 15:19:47 2009
Return-Path: <java-user-return-39777-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8465 invoked from network); 17 Apr 2009 15:19:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 15:19:46 -0000
Received: (qmail 59204 invoked by uid 500); 17 Apr 2009 15:19:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59145 invoked by uid 500); 17 Apr 2009 15:19:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59135 invoked by uid 99); 17 Apr 2009 15:19:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 15:19:43 +0000
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=PLING_QUERY,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 15:19:33 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LupqS-0007fX-ID
	for java-user@lucene.apache.org; Fri, 17 Apr 2009 08:19:12 -0700
Message-ID: <23099744.post@talk.nabble.com>
Date: Fri, 17 Apr 2009 08:19:12 -0700 (PDT)
From: theDude_2 <aornstein@webmd.net>
To: java-user@lucene.apache.org
Subject: Re: A Challenge!: Combining 2 searches into a single resultset?
In-Reply-To: <1e33aedb0904170751y4ead4a89v33a933991caa3a87@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: aornstein@webmd.net
References: <23085506.post@talk.nabble.com> <23098961.post@talk.nabble.com> <1e33aedb0904170751y4ead4a89v33a933991caa3a87@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


I appreciate your response, and read the wiki article concerning the
Federated search
and

I'm not sure that my project falls into the "Federated Search" bucket...

What I've done is created 2 indexes created with the same documents.
One index, contains the full documents - great for pure relevancy search
The second index: contains all of the same documents, but a small subset of
each documents contents - only allowing words to be indexed that we deem as
"good words" - 

(for example) if this was a football article database
Index 1: would index 100% of the article about the Redskins and the New York
Giants
Index 2: would index the same article by only the "good words" in the
document like Redskins, Giants, Quarterback, Linebacker, etc.

What I'm trying to do, if it's even possible! is run the search on both
indexes containing references to the same article, and multiple the scores
together to get a final score that would represent something like a
"relative AND good word" score....

Figuring that if a user searches on "Who is the Quarterback for the Giants"
this will get the user an article that is both related to the query, and
deemed "important" to the query...

I will look further into federated search and related items, but I think
that lucene probably wont be able to help me with this, am I right?








------------

pjaol wrote:
> 
> I'd start by doing some research on the question rather than asking for a
> solution..
> What your asking for can be considered 'Federated Search'
> http://en.wikipedia.org/wiki/Federated_search
> 
> And it can be conceived in as many ways as you have document types. Any
> answer will probably end up
> customized and weighted by your document silo value, usually companies
> weight those by business rules
> rather than head down the path of federated search, as it's just quicker
> and
> cheaper, and you can accomplish more.
> e.g
> Medication = score *2  (as higher advertising incentives)
> Diseases = score
> Books = score * 0.75  ( thousands of books, which nobody buys etc..)
> 
> You might also want to try consolidating your data into 1 schema, and
> consider layering or collapsing results
> based on type.
> 
> P
> 
> On Fri, Apr 17, 2009 at 10:39 AM, theDude_2 <aornstein@webmd.net> wrote:
> 
>>
>> (bump) - any thoughts?
>> ----
>>
>>
>>
>> theDude_2 wrote:
>> >
>> > hi!
>> >
>> > I am trying to do something a little unique...
>> >
>> > I have a 90k text documents that I am trying to search
>> > Search A: indexes and searches the documents using regular relevancy
>> > search
>> > Search B: indexes and searches the documents using a smaller subset of
>> > "key" words that I have chosen
>> >
>> > This gives me 2 seperate scores: Score A, and Score B...
>> >
>> > I am trying to show the top 10 results of the scores combined so....
>> >
>> > FinalScoretextDoc = (scoreA_of_td1 * 0.5) * (scoreB_of_td1 * 0.5)
>> >
>> > While it seems straightforward, I do not want to calculate the scores
>> of
>> > all the documents outside of lucene.  How can I integrate this better
>> into
>> > the lucene search engine?  Is this possible to do by any simple means?
>> >
>> > Thanks guys + gals!
>> >
>> >
>>
>> --
>> View this message in context:
>> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23098961.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23099744.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39778-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 15:24:11 2009
Return-Path: <java-user-return-39778-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9533 invoked from network); 17 Apr 2009 15:24:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 15:24:11 -0000
Received: (qmail 68417 invoked by uid 500); 17 Apr 2009 15:24:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68347 invoked by uid 500); 17 Apr 2009 15:24:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68337 invoked by uid 99); 17 Apr 2009 15:24:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 15:24:08 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 15:24:00 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: Faceting, Sort and DocIDSet
Date: Fri, 17 Apr 2009 11:23:37 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC266E@mail02.tveyes.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Faceting, Sort and DocIDSet
thread-index: Acm/cHsWmo03rJFhSu6KKX03/y6gBw==
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

I'm sorry If this question touches on too many things at once, but I'm
having problems putting some ideas together - hopefully someone can
help!
=20
I have a set of indexes, each index contains a month's worth of
Articles. I need to be able to search the index (sorting by date) and
then apply access-filters based on the Article Source. I'm also trying
to get result counts for each Article Source.

So to perform the search I can execute this:

TopFieldDocs results =3D myMultiSearcher.search(baseQuery, accessFilter,
100, new Sort("DateField"));

But I don't think that I can use TopDocs if I want to get Article Source
counts. I think I have to use a HitCollector and then create a result
BitSet that I can compare to my pre-cached Article Source BitSets. But
if I use a HitCollector I have no idea how to sort by a field.

So my questions:=20
1) How do I use a HitCollector and sort by a field?=20
2) Is using BitSets the wrong way to quickly generate facet counts? I've
read about DocIDSets, but I'm not sure how to use them in the same way.
(I'm basing my faceting technique on Sujit Pal's article
http://sujitpal.blogspot.com/2007/04/lucene-search-within-search-with.ht
ml)

Thanks!

-Dave

David Seltzer
Systems Architect
TVEyes
203.254.3600 x222
dseltzer@tveyes.com


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39779-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 15:41:10 2009
Return-Path: <java-user-return-39779-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11849 invoked from network); 17 Apr 2009 15:41:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 15:41:07 -0000
Received: (qmail 74192 invoked by uid 500); 17 Apr 2009 15:29:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74172 invoked by uid 500); 17 Apr 2009 15:29:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74162 invoked by uid 99); 17 Apr 2009 15:29:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 15:29:16 +0000
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=PLING_QUERY,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 15:29:04 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lupzf-00087U-DQ
	for java-user@lucene.apache.org; Fri, 17 Apr 2009 08:28:43 -0700
Message-ID: <23099924.post@talk.nabble.com>
Date: Fri, 17 Apr 2009 08:28:43 -0700 (PDT)
From: theDude_2 <aornstein@webmd.net>
To: java-user@lucene.apache.org
Subject: Re: A Challenge!: Combining 2 searches into a single resultset?
In-Reply-To: <23099744.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: aornstein@webmd.net
References: <23085506.post@talk.nabble.com> <23098961.post@talk.nabble.com> <1e33aedb0904170751y4ead4a89v33a933991caa3a87@mail.gmail.com> <23099744.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


*Edit: each indexed text document contains a related field for identification
purposes, so I would be able to identify the scores for both indexes through
this field*



theDude_2 wrote:
> 
> I appreciate your response, and read the wiki article concerning the
> Federated search
> and
> 
> I'm not sure that my project falls into the "Federated Search" bucket...
> 
> What I've done is created 2 indexes created with the same documents.
> One index, contains the full documents - great for pure relevancy search
> The second index: contains all of the same documents, but a small subset
> of each documents contents - only allowing words to be indexed that we
> deem as "good words" - 
> 
> (for example) if this was a football article database
> Index 1: would index 100% of the article about the Redskins and the New
> York Giants
> Index 2: would index the same article by only the "good words" in the
> document like Redskins, Giants, Quarterback, Linebacker, etc.
> 
> What I'm trying to do, if it's even possible! is run the search on both
> indexes containing references to the same article, and multiple the scores
> together to get a final score that would represent something like a
> "relative AND good word" score....
> 
> Figuring that if a user searches on "Who is the Quarterback for the
> Giants" this will get the user an article that is both related to the
> query, and deemed "important" to the query...
> 
> I will look further into federated search and related items, but I think
> that lucene probably wont be able to help me with this, am I right?
> 
> 
> 
> 
> 
> 
> 
> 
> ------------
> 
> pjaol wrote:
>> 
>> I'd start by doing some research on the question rather than asking for a
>> solution..
>> What your asking for can be considered 'Federated Search'
>> http://en.wikipedia.org/wiki/Federated_search
>> 
>> And it can be conceived in as many ways as you have document types. Any
>> answer will probably end up
>> customized and weighted by your document silo value, usually companies
>> weight those by business rules
>> rather than head down the path of federated search, as it's just quicker
>> and
>> cheaper, and you can accomplish more.
>> e.g
>> Medication = score *2  (as higher advertising incentives)
>> Diseases = score
>> Books = score * 0.75  ( thousands of books, which nobody buys etc..)
>> 
>> You might also want to try consolidating your data into 1 schema, and
>> consider layering or collapsing results
>> based on type.
>> 
>> P
>> 
>> On Fri, Apr 17, 2009 at 10:39 AM, theDude_2 <aornstein@webmd.net> wrote:
>> 
>>>
>>> (bump) - any thoughts?
>>> ----
>>>
>>>
>>>
>>> theDude_2 wrote:
>>> >
>>> > hi!
>>> >
>>> > I am trying to do something a little unique...
>>> >
>>> > I have a 90k text documents that I am trying to search
>>> > Search A: indexes and searches the documents using regular relevancy
>>> > search
>>> > Search B: indexes and searches the documents using a smaller subset of
>>> > "key" words that I have chosen
>>> >
>>> > This gives me 2 seperate scores: Score A, and Score B...
>>> >
>>> > I am trying to show the top 10 results of the scores combined so....
>>> >
>>> > FinalScoretextDoc = (scoreA_of_td1 * 0.5) * (scoreB_of_td1 * 0.5)
>>> >
>>> > While it seems straightforward, I do not want to calculate the scores
>>> of
>>> > all the documents outside of lucene.  How can I integrate this better
>>> into
>>> > the lucene search engine?  Is this possible to do by any simple means?
>>> >
>>> > Thanks guys + gals!
>>> >
>>> >
>>>
>>> --
>>> View this message in context:
>>> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23098961.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>> 
>> 
> 
> 

-- 
View this message in context: http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23099924.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39780-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 15:41:46 2009
Return-Path: <java-user-return-39780-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13819 invoked from network); 17 Apr 2009 15:41:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 15:41:45 -0000
Received: (qmail 76543 invoked by uid 500); 17 Apr 2009 15:40:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75920 invoked by uid 500); 17 Apr 2009 15:40:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74686 invoked by uid 99); 17 Apr 2009 15:32:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 15:32:52 +0000
X-ASF-Spam-Status: No, hits=3.5 required=10.0
	tests=HTML_MESSAGE,PLING_QUERY
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of pjaol@pjaol.com)
Received: from [74.125.44.30] (HELO yx-out-2324.google.com) (74.125.44.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 15:32:42 +0000
Received: by yx-out-2324.google.com with SMTP id 8so522177yxb.5
        for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 08:32:20 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.152.17 with SMTP id z17mr299509ybd.167.1239982340094; Fri, 
	17 Apr 2009 08:32:20 -0700 (PDT)
In-Reply-To: <23099744.post@talk.nabble.com>
References: <23085506.post@talk.nabble.com> <23098961.post@talk.nabble.com>
	 <1e33aedb0904170751y4ead4a89v33a933991caa3a87@mail.gmail.com>
	 <23099744.post@talk.nabble.com>
Date: Fri, 17 Apr 2009 11:32:19 -0400
Message-ID: <1e33aedb0904170832q2e35e7f2jd5ecb3409e04bc5c@mail.gmail.com>
Subject: Re: A Challenge!: Combining 2 searches into a single resultset?
From: "patrick o'leary" <pjaol@pjaol.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd47e1ee8bd590467c1e2cd
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd47e1ee8bd590467c1e2cd
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Why not put the keywords into the same document as another field? and search
both fields
at once, you can then use lucene syntax to give a boosting to the keyword
fields.
e.g.
body:A good game last night by the redskins
keyword: redskins

Query= body:(game OR redskins) keyword:(game OR redskins)^10

And adjust the boosting until you're happy.
Check out for querying multiple fields
http://wiki.apache.org/lucene-java/LuceneFAQ#head-300f0756fdaa71f522c96a868351f716573f2d77

You might even want to consider Solr and it's dismax search component
http://wiki.apache.org/solr/DisMaxRequestHandler
to make it easier




On Fri, Apr 17, 2009 at 11:19 AM, theDude_2 <aornstein@webmd.net> wrote:

>
> I appreciate your response, and read the wiki article concerning the
> Federated search
> and
>
> I'm not sure that my project falls into the "Federated Search" bucket...
>
> What I've done is created 2 indexes created with the same documents.
> One index, contains the full documents - great for pure relevancy search
> The second index: contains all of the same documents, but a small subset of
> each documents contents - only allowing words to be indexed that we deem as
> "good words" -
>
> (for example) if this was a football article database
> Index 1: would index 100% of the article about the Redskins and the New
> York
> Giants
> Index 2: would index the same article by only the "good words" in the
> document like Redskins, Giants, Quarterback, Linebacker, etc.
>
> What I'm trying to do, if it's even possible! is run the search on both
> indexes containing references to the same article, and multiple the scores
> together to get a final score that would represent something like a
> "relative AND good word" score....
>
> Figuring that if a user searches on "Who is the Quarterback for the Giants"
> this will get the user an article that is both related to the query, and
> deemed "important" to the query...
>
> I will look further into federated search and related items, but I think
> that lucene probably wont be able to help me with this, am I right?
>
>
>
>
>
>
>
>
> ------------
>
> pjaol wrote:
> >
> > I'd start by doing some research on the question rather than asking for a
> > solution..
> > What your asking for can be considered 'Federated Search'
> > http://en.wikipedia.org/wiki/Federated_search
> >
> > And it can be conceived in as many ways as you have document types. Any
> > answer will probably end up
> > customized and weighted by your document silo value, usually companies
> > weight those by business rules
> > rather than head down the path of federated search, as it's just quicker
> > and
> > cheaper, and you can accomplish more.
> > e.g
> > Medication = score *2  (as higher advertising incentives)
> > Diseases = score
> > Books = score * 0.75  ( thousands of books, which nobody buys etc..)
> >
> > You might also want to try consolidating your data into 1 schema, and
> > consider layering or collapsing results
> > based on type.
> >
> > P
> >
> > On Fri, Apr 17, 2009 at 10:39 AM, theDude_2 <aornstein@webmd.net> wrote:
> >
> >>
> >> (bump) - any thoughts?
> >> ----
> >>
> >>
> >>
> >> theDude_2 wrote:
> >> >
> >> > hi!
> >> >
> >> > I am trying to do something a little unique...
> >> >
> >> > I have a 90k text documents that I am trying to search
> >> > Search A: indexes and searches the documents using regular relevancy
> >> > search
> >> > Search B: indexes and searches the documents using a smaller subset of
> >> > "key" words that I have chosen
> >> >
> >> > This gives me 2 seperate scores: Score A, and Score B...
> >> >
> >> > I am trying to show the top 10 results of the scores combined so....
> >> >
> >> > FinalScoretextDoc = (scoreA_of_td1 * 0.5) * (scoreB_of_td1 * 0.5)
> >> >
> >> > While it seems straightforward, I do not want to calculate the scores
> >> of
> >> > all the documents outside of lucene.  How can I integrate this better
> >> into
> >> > the lucene search engine?  Is this possible to do by any simple means?
> >> >
> >> > Thanks guys + gals!
> >> >
> >> >
> >>
> >> --
> >> View this message in context:
> >>
> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23098961.html
> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> >
>
> --
> View this message in context:
> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23099744.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd47e1ee8bd590467c1e2cd--

From java-user-return-39781-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 15:41:56 2009
Return-Path: <java-user-return-39781-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14237 invoked from network); 17 Apr 2009 15:41:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 15:41:55 -0000
Received: (qmail 76845 invoked by uid 500); 17 Apr 2009 15:40:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76285 invoked by uid 500); 17 Apr 2009 15:40:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74911 invoked by uid 99); 17 Apr 2009 15:35:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 15:35:55 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [119.160.244.190] (HELO n3a.bullet.tw1.yahoo.com) (119.160.244.190)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 17 Apr 2009 15:35:44 +0000
Received: from [119.160.244.76] by n3.bullet.tw1.yahoo.com with NNFMP; 17 Apr 2009 15:35:20 -0000
Received: from [124.108.115.242] by t1.bullet.tw1.yahoo.com with NNFMP; 17 Apr 2009 15:35:20 -0000
Received: from [124.108.114.83] by t1.bullet.mail.sg1.yahoo.com with NNFMP; 17 Apr 2009 15:35:09 -0000
Received: from [127.0.0.1] by omp103.mail.sg1.yahoo.com with NNFMP; 17 Apr 2009 15:35:20 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 383803.5277.bm@omp103.mail.sg1.yahoo.com
Received: (qmail 6778 invoked by uid 60001); 17 Apr 2009 15:35:20 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1239982520; bh=BSGG5rsuK8pk4+Yd5zKrY4rShEO6+fkyfxCVXFeZTaQ=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=kNqCtRG8tKhrwTM3y+CVPncznyksZLWKb3HKn8n9JGk9+KVhIPsmOYDOu3PYx+db7mDS7kKnKb/kJINuEHBKUNmpfzoT67WEZ4hCjmbWuTbR/fg/xuT31YMiotLXaq1s0L9gALk7M6fH7XwBJw12z6yAGh6MM8CCJ1CWW5LbM5I=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=dpWJDgcZPX8bTDMgcqdbtWPZskJ9e9lmNy0VDaD5s4iNXKdvv3D4EfCnkfenfLWOna9hsAB4ePzTCQ+qxpR3nq9KVb4AWizH5NXc3ilXeqwGuaouPIP75WrGrmvjp4nU7jO/8xGVQixsBL5MLtGCit4028O/sW+k7D+T2ZP/Qmg=;
Message-ID: <177396.5932.qm@web76009.mail.sg1.yahoo.com>
X-YMail-OSG: y6vrUVkVM1laYoeD35Tw_SPg61nrUrvOhO_CjMCJIhcx8I2M8K9zaYqhjJggwhpSPp3isZzelCDlsTcaSFNjZCIYjvMV5aDb8vlXcu4VUw4YuoZ.AIAL1Ue8R4ABjNGfqfr4N9023tJ7XpcDyNLf2flDoIwsTyzhaUPb6sQKiod2Hwc6V.EFmXwnn2pEuQE92xFuIqin6WfDDcysK0L1m_2TIm22gX.Q.xjZj9Y6bjJ77RkwxJLpyebjFhAS_29pNonX0b8tM73tlXTK7SEGnMg-
Received: from [114.59.109.167] by web76009.mail.sg1.yahoo.com via HTTP; Fri, 17 Apr 2009 23:35:20 SGT
X-Mailer: YahooMailClassic/5.2.18 YahooMailWebService/0.7.289.10
Date: Fri, 17 Apr 2009 23:35:20 +0800 (SGT)
From: daniel susanto <daniel_sus777@yahoo.com>
Subject: RE: Is it possible to add new document into existing lucene index?
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-2127528359-1239982520=:5932"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-2127528359-1239982520=:5932
Content-Type: text/plain; charset=us-ascii

Thx, it works. :)

Daniel Susanto
http://susantodaniel.wordpress.com

--- On Fri, 4/17/09, Uwe Schindler <uwe@thetaphi.de> wrote:

From: Uwe Schindler <uwe@thetaphi.de>
Subject: RE: Is it possible to add new document into existing lucene index?
To: java-user@lucene.apache.org
Date: Friday, April 17, 2009, 9:18 PM

Hi Daniel,

Just open the IndexWriter on the same Lucene Directory and specify the
boolean ctor parameter "create" to false.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: daniel susanto [mailto:daniel_sus777@yahoo.com]
> Sent: Friday, April 17, 2009 4:11 PM
> To: java-user@lucene.apache.org
> Subject: Is it possible to add new document into existing lucene index?
> 
> Hi all,
> 
> I'm NB in Lucene.
> Is it possible to add new document into existing document? I think it is
> important so that we don't need to re-index the all in file folder if just
> one or two file that need to be added into index. Thx.
> 
> Daniel Susanto
> http://susantodaniel.wordpress.com
> 
> 
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org




      
--0-2127528359-1239982520=:5932--


From java-user-return-39782-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 15:54:57 2009
Return-Path: <java-user-return-39782-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18365 invoked from network); 17 Apr 2009 15:54:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 15:54:57 -0000
Received: (qmail 24361 invoked by uid 500); 17 Apr 2009 15:54:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24292 invoked by uid 500); 17 Apr 2009 15:54:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24282 invoked by uid 99); 17 Apr 2009 15:54:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 15:54:54 +0000
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=PLING_QUERY,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 15:54:45 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LuqOW-0000yf-RN
	for java-user@lucene.apache.org; Fri, 17 Apr 2009 08:54:24 -0700
Message-ID: <23100423.post@talk.nabble.com>
Date: Fri, 17 Apr 2009 08:54:24 -0700 (PDT)
From: theDude_2 <aornstein@webmd.net>
To: java-user@lucene.apache.org
Subject: Re: A Challenge!: Combining 2 searches into a single resultset?
In-Reply-To: <1e33aedb0904170832q2e35e7f2jd5ecb3409e04bc5c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: aornstein@webmd.net
References: <23085506.post@talk.nabble.com> <23098961.post@talk.nabble.com> <1e33aedb0904170751y4ead4a89v33a933991caa3a87@mail.gmail.com> <23099744.post@talk.nabble.com> <1e33aedb0904170832q2e35e7f2jd5ecb3409e04bc5c@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Ah, Interesting... I didnt think of that!  I will try it and report back


pjaol wrote:
> 
> Why not put the keywords into the same document as another field? and
> search
> both fields
> at once, you can then use lucene syntax to give a boosting to the keyword
> fields.
> e.g.
> body:A good game last night by the redskins
> keyword: redskins
> 
> Query= body:(game OR redskins) keyword:(game OR redskins)^10
> 
> And adjust the boosting until you're happy.
> Check out for querying multiple fields
> http://wiki.apache.org/lucene-java/LuceneFAQ#head-300f0756fdaa71f522c96a868351f716573f2d77
> 
> You might even want to consider Solr and it's dismax search component
> http://wiki.apache.org/solr/DisMaxRequestHandler
> to make it easier
> 
> 
> 
> 
> On Fri, Apr 17, 2009 at 11:19 AM, theDude_2 <aornstein@webmd.net> wrote:
> 
>>
>> I appreciate your response, and read the wiki article concerning the
>> Federated search
>> and
>>
>> I'm not sure that my project falls into the "Federated Search" bucket...
>>
>> What I've done is created 2 indexes created with the same documents.
>> One index, contains the full documents - great for pure relevancy search
>> The second index: contains all of the same documents, but a small subset
>> of
>> each documents contents - only allowing words to be indexed that we deem
>> as
>> "good words" -
>>
>> (for example) if this was a football article database
>> Index 1: would index 100% of the article about the Redskins and the New
>> York
>> Giants
>> Index 2: would index the same article by only the "good words" in the
>> document like Redskins, Giants, Quarterback, Linebacker, etc.
>>
>> What I'm trying to do, if it's even possible! is run the search on both
>> indexes containing references to the same article, and multiple the
>> scores
>> together to get a final score that would represent something like a
>> "relative AND good word" score....
>>
>> Figuring that if a user searches on "Who is the Quarterback for the
>> Giants"
>> this will get the user an article that is both related to the query, and
>> deemed "important" to the query...
>>
>> I will look further into federated search and related items, but I think
>> that lucene probably wont be able to help me with this, am I right?
>>
>>
>>
>>
>>
>>
>>
>>
>> ------------
>>
>> pjaol wrote:
>> >
>> > I'd start by doing some research on the question rather than asking for
>> a
>> > solution..
>> > What your asking for can be considered 'Federated Search'
>> > http://en.wikipedia.org/wiki/Federated_search
>> >
>> > And it can be conceived in as many ways as you have document types. Any
>> > answer will probably end up
>> > customized and weighted by your document silo value, usually companies
>> > weight those by business rules
>> > rather than head down the path of federated search, as it's just
>> quicker
>> > and
>> > cheaper, and you can accomplish more.
>> > e.g
>> > Medication = score *2  (as higher advertising incentives)
>> > Diseases = score
>> > Books = score * 0.75  ( thousands of books, which nobody buys etc..)
>> >
>> > You might also want to try consolidating your data into 1 schema, and
>> > consider layering or collapsing results
>> > based on type.
>> >
>> > P
>> >
>> > On Fri, Apr 17, 2009 at 10:39 AM, theDude_2 <aornstein@webmd.net>
>> wrote:
>> >
>> >>
>> >> (bump) - any thoughts?
>> >> ----
>> >>
>> >>
>> >>
>> >> theDude_2 wrote:
>> >> >
>> >> > hi!
>> >> >
>> >> > I am trying to do something a little unique...
>> >> >
>> >> > I have a 90k text documents that I am trying to search
>> >> > Search A: indexes and searches the documents using regular relevancy
>> >> > search
>> >> > Search B: indexes and searches the documents using a smaller subset
>> of
>> >> > "key" words that I have chosen
>> >> >
>> >> > This gives me 2 seperate scores: Score A, and Score B...
>> >> >
>> >> > I am trying to show the top 10 results of the scores combined so....
>> >> >
>> >> > FinalScoretextDoc = (scoreA_of_td1 * 0.5) * (scoreB_of_td1 * 0.5)
>> >> >
>> >> > While it seems straightforward, I do not want to calculate the
>> scores
>> >> of
>> >> > all the documents outside of lucene.  How can I integrate this
>> better
>> >> into
>> >> > the lucene search engine?  Is this possible to do by any simple
>> means?
>> >> >
>> >> > Thanks guys + gals!
>> >> >
>> >> >
>> >>
>> >> --
>> >> View this message in context:
>> >>
>> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23098961.html
>> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>> >
>>
>> --
>> View this message in context:
>> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23099744.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23100423.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39783-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 16:09:39 2009
Return-Path: <java-user-return-39783-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23659 invoked from network); 17 Apr 2009 16:09:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 16:09:39 -0000
Received: (qmail 55077 invoked by uid 500); 17 Apr 2009 16:09:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54998 invoked by uid 500); 17 Apr 2009 16:09:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54984 invoked by uid 99); 17 Apr 2009 16:09:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 16:09:35 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.177] (HELO spunkymail-a2.g.dreamhost.com) (208.97.132.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 16:09:25 +0000
Received: from [10.100.100.224] (unknown [207.179.4.183])
	by spunkymail-a2.g.dreamhost.com (Postfix) with ESMTP id 01482870C4
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 09:09:03 -0700 (PDT)
Message-Id: <FFC3F4B9-6DC1-4B65-A761-7A4D2CF5B5AC@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <a59386fa0904161022r2172f36nd95a94662a017791@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Google's search Appliance relevance ranking
Date: Fri, 17 Apr 2009 09:09:02 -0700
References: <a59386fa0904161022r2172f36nd95a94662a017791@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org


On Apr 16, 2009, at 10:22 AM, Vasudevan Comandur wrote:

> Hi,
>
>   The question that I am posting in this group may be inappropriate  
> and I
> want to apologize for that.

I wouldn't say it's inappropriate, but I don't know if anyone here  
could say with certainty b/c the last time I checked GSA was not an  
open platform...

>
>
>   My question is, what is the relevance ranking algorithm which is  
> used in
> Google Search Appliance (GSA) because the search
>   is predominantly on documents rather than web pages.

AFAIK, they use a Vector Space Model much as Lucene does, but you'd  
have to ask them as I don't have anything to point to other than I've  
heard others speculate it.


>
>
>   I appreciate if any of you can send me pointers to the algorithm  
> used by
> google.

Sorry, I don't have any.  I would look through their docs.  Or, just  
use Lucene/Solr and save yourself a bunch of money... ;-)

>
>
> Regards
> Vasu

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39784-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 16:38:49 2009
Return-Path: <java-user-return-39784-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30701 invoked from network); 17 Apr 2009 16:38:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 16:38:48 -0000
Received: (qmail 8818 invoked by uid 500); 17 Apr 2009 16:38:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8755 invoked by uid 500); 17 Apr 2009 16:38:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8745 invoked by uid 99); 17 Apr 2009 16:38:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 16:38:46 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.28] (HELO smtp-vbr8.xs4all.nl) (194.109.24.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 16:38:36 +0000
Received: from k8u.localnet (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr8.xs4all.nl (8.13.8/8.13.8) with ESMTP id n3HGcG9M014307
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 18:38:16 +0200 (CEST)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Need help : SpanNearQuery
Date: Fri, 17 Apr 2009 18:38:16 +0200
User-Agent: KMail/1.10.4 (Linux/2.6.27-11-generic; KDE/4.1.4; i686; ; )
References: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30@BLRKECMBX09.ad.infosys.com> <200904171629.34615.paul.elschot@xs4all.nl> <5CDA3DC1F80BBB42BD0B48FABC128B5114F3051ADA@BLRKECMBX09.ad.infosys.com>
In-Reply-To: <5CDA3DC1F80BBB42BD0B48FABC128B5114F3051ADA@BLRKECMBX09.ad.infosys.com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
  boundary="Boundary-00=_4BL6JEYkeXrPIey"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200904171838.16532.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

--Boundary-00=_4BL6JEYkeXrPIey
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit

On Friday 17 April 2009 16:33:27 Radhalakshmi Sreedharan wrote:
> Thanks Paul. Is there any alternative way of implementing this requirement?

Start from scratch perhaps? Anyway, spans can be really tricky, so in
case you're writing code for this, I have only four advices: test, test,
test and test.

> As a side note, Will the Shingle Filter help me getting all possible
> combination of the input tokens?

I don't know.

Regards,
Paul Elschot

--Boundary-00=_4BL6JEYkeXrPIey--

From java-user-return-39785-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 16:45:42 2009
Return-Path: <java-user-return-39785-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33636 invoked from network); 17 Apr 2009 16:45:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 16:45:42 -0000
Received: (qmail 28244 invoked by uid 500); 17 Apr 2009 16:45:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28209 invoked by uid 500); 17 Apr 2009 16:45:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28199 invoked by uid 99); 17 Apr 2009 16:45:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 16:45:39 +0000
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=PLING_QUERY,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 16:45:30 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n3HGj6ZV027633
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 12:45:07 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <49E8B212.6020408@informatics.jax.org>
Date: Fri, 17 Apr 2009 12:45:06 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: A Challenge!: Combining 2 searches into a single resultset?
References: <23085506.post@talk.nabble.com> <23098961.post@talk.nabble.com> <1e33aedb0904170751y4ead4a89v33a933991caa3a87@mail.gmail.com> <23099744.post@talk.nabble.com> <1e33aedb0904170832q2e35e7f2jd5ecb3409e04bc5c@mail.gmail.com> <23100423.post@talk.nabble.com>
In-Reply-To: <23100423.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.5.1.360522, Antispam-Engine: 2.6.1.350677, Antispam-Data: 2009.4.17.163431
X-PerlMx-Spam: Gauge=IIIIIII, Probability=8%, Report='BODY_SIZE_6000_6999 0, BODY_SIZE_7000_LESS 0, TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __C230066_P5 0, __CANPHARM_UNSUB_LINK 0, __CP_URI_IN_BODY 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __FRAUD_419_BADTHINGS 0, __HAS_MSGID 0, __MEDS_PLAIN 0, __MEDS_PLAIN_MEDICATION 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __MOZILLA_MSGID 0, __SANE_MSGID 0, __STOCK_PHRASE_7 0, __STOCK_SUBJ_9 0, __TO_MALFORMED_2 0, __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

If you can build an analyzer that tokenizes the second field so that it 
filters out the words you don't want, you can then take advantage of 
more intelligent queries as well.


So for the example that pjaol wrote, the query would become something 
like this:

Query= body:(game OR redskins) keyword:(redskins)^10

Depending on your corpus this may or may not be possible, the 
determining factor being whether or not the list of words being removed 
from each document to create the second field varies.

(more specifically I mean, in some documents you remove the word game, 
and in others you don't, if this is the case this technique won't work 
for you.)

Matt



theDude_2 wrote:
> Ah, Interesting... I didnt think of that!  I will try it and report back
>
>
> pjaol wrote:
>   
>> Why not put the keywords into the same document as another field? and
>> search
>> both fields
>> at once, you can then use lucene syntax to give a boosting to the keyword
>> fields.
>> e.g.
>> body:A good game last night by the redskins
>> keyword: redskins
>>
>> Query= body:(game OR redskins) keyword:(game OR redskins)^10
>>
>> And adjust the boosting until you're happy.
>> Check out for querying multiple fields
>> http://wiki.apache.org/lucene-java/LuceneFAQ#head-300f0756fdaa71f522c96a868351f716573f2d77
>>
>> You might even want to consider Solr and it's dismax search component
>> http://wiki.apache.org/solr/DisMaxRequestHandler
>> to make it easier
>>
>>
>>
>>
>> On Fri, Apr 17, 2009 at 11:19 AM, theDude_2 <aornstein@webmd.net> wrote:
>>
>>     
>>> I appreciate your response, and read the wiki article concerning the
>>> Federated search
>>> and
>>>
>>> I'm not sure that my project falls into the "Federated Search" bucket...
>>>
>>> What I've done is created 2 indexes created with the same documents.
>>> One index, contains the full documents - great for pure relevancy search
>>> The second index: contains all of the same documents, but a small subset
>>> of
>>> each documents contents - only allowing words to be indexed that we deem
>>> as
>>> "good words" -
>>>
>>> (for example) if this was a football article database
>>> Index 1: would index 100% of the article about the Redskins and the New
>>> York
>>> Giants
>>> Index 2: would index the same article by only the "good words" in the
>>> document like Redskins, Giants, Quarterback, Linebacker, etc.
>>>
>>> What I'm trying to do, if it's even possible! is run the search on both
>>> indexes containing references to the same article, and multiple the
>>> scores
>>> together to get a final score that would represent something like a
>>> "relative AND good word" score....
>>>
>>> Figuring that if a user searches on "Who is the Quarterback for the
>>> Giants"
>>> this will get the user an article that is both related to the query, and
>>> deemed "important" to the query...
>>>
>>> I will look further into federated search and related items, but I think
>>> that lucene probably wont be able to help me with this, am I right?
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> ------------
>>>
>>> pjaol wrote:
>>>       
>>>> I'd start by doing some research on the question rather than asking for
>>>>         
>>> a
>>>       
>>>> solution..
>>>> What your asking for can be considered 'Federated Search'
>>>> http://en.wikipedia.org/wiki/Federated_search
>>>>
>>>> And it can be conceived in as many ways as you have document types. Any
>>>> answer will probably end up
>>>> customized and weighted by your document silo value, usually companies
>>>> weight those by business rules
>>>> rather than head down the path of federated search, as it's just
>>>>         
>>> quicker
>>>       
>>>> and
>>>> cheaper, and you can accomplish more.
>>>> e.g
>>>> Medication = score *2  (as higher advertising incentives)
>>>> Diseases = score
>>>> Books = score * 0.75  ( thousands of books, which nobody buys etc..)
>>>>
>>>> You might also want to try consolidating your data into 1 schema, and
>>>> consider layering or collapsing results
>>>> based on type.
>>>>
>>>> P
>>>>
>>>> On Fri, Apr 17, 2009 at 10:39 AM, theDude_2 <aornstein@webmd.net>
>>>>         
>>> wrote:
>>>       
>>>>> (bump) - any thoughts?
>>>>> ----
>>>>>
>>>>>
>>>>>
>>>>> theDude_2 wrote:
>>>>>           
>>>>>> hi!
>>>>>>
>>>>>> I am trying to do something a little unique...
>>>>>>
>>>>>> I have a 90k text documents that I am trying to search
>>>>>> Search A: indexes and searches the documents using regular relevancy
>>>>>> search
>>>>>> Search B: indexes and searches the documents using a smaller subset
>>>>>>             
>>> of
>>>       
>>>>>> "key" words that I have chosen
>>>>>>
>>>>>> This gives me 2 seperate scores: Score A, and Score B...
>>>>>>
>>>>>> I am trying to show the top 10 results of the scores combined so....
>>>>>>
>>>>>> FinalScoretextDoc = (scoreA_of_td1 * 0.5) * (scoreB_of_td1 * 0.5)
>>>>>>
>>>>>> While it seems straightforward, I do not want to calculate the
>>>>>>             
>>> scores
>>>       
>>>>> of
>>>>>           
>>>>>> all the documents outside of lucene.  How can I integrate this
>>>>>>             
>>> better
>>>       
>>>>> into
>>>>>           
>>>>>> the lucene search engine?  Is this possible to do by any simple
>>>>>>             
>>> means?
>>>       
>>>>>> Thanks guys + gals!
>>>>>>
>>>>>>
>>>>>>             
>>>>> --
>>>>> View this message in context:
>>>>>
>>>>>           
>>> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23098961.html
>>>       
>>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>>           
>>>>         
>>> --
>>> View this message in context:
>>> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23099744.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>       
>>     
>
>   


-- 
Matthew Hall
Software Engineer
Mouse Genome Informatics
mhall@informatics.jax.org
(207) 288-6012



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39786-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 16:47:42 2009
Return-Path: <java-user-return-39786-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35021 invoked from network); 17 Apr 2009 16:47:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 16:47:42 -0000
Received: (qmail 35515 invoked by uid 500); 17 Apr 2009 16:47:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35443 invoked by uid 500); 17 Apr 2009 16:47:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35433 invoked by uid 99); 17 Apr 2009 16:47:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 16:47:39 +0000
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=PLING_QUERY,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 16:47:30 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n3HGl7TB027927
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 12:47:08 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <49E8B28B.3080402@informatics.jax.org>
Date: Fri, 17 Apr 2009 12:47:07 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: A Challenge!: Combining 2 searches into a single resultset?
References: <23085506.post@talk.nabble.com> <23098961.post@talk.nabble.com> <1e33aedb0904170751y4ead4a89v33a933991caa3a87@mail.gmail.com> <23099744.post@talk.nabble.com> <1e33aedb0904170832q2e35e7f2jd5ecb3409e04bc5c@mail.gmail.com> <23100423.post@talk.nabble.com> <21297_1239986742_n3HGje0X027688_49E8B212.6020408@informatics.jax.org>
In-Reply-To: <21297_1239986742_n3HGje0X027688_49E8B212.6020408@informatics.jax.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.5.1.360522, Antispam-Engine: 2.6.1.350677, Antispam-Data: 2009.4.17.163431
X-PerlMx-Spam: Gauge=IIIIIII, Probability=8%, Report='TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __CANPHARM_UNSUB_LINK 0, __CP_URI_IN_BODY 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __FRAUD_419_BADTHINGS 0, __HAS_MSGID 0, __MEDS_PLAIN 0, __MEDS_PLAIN_MEDICATION 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __MOZILLA_MSGID 0, __SANE_MSGID 0, __STOCK_PHRASE_7 0, __STOCK_SUBJ_9 0, __TO_MALFORMED_2 0, __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

Erm, I likely should have mentioned that this technique requires the use 
of a MultiFieldQueryParser.

Matt

Matthew Hall wrote:
> If you can build an analyzer that tokenizes the second field so that 
> it filters out the words you don't want, you can then take advantage 
> of more intelligent queries as well.
>
>
> So for the example that pjaol wrote, the query would become something 
> like this:
>
> Query= body:(game OR redskins) keyword:(redskins)^10
>
> Depending on your corpus this may or may not be possible, the 
> determining factor being whether or not the list of words being 
> removed from each document to create the second field varies.
>
> (more specifically I mean, in some documents you remove the word game, 
> and in others you don't, if this is the case this technique won't work 
> for you.)
>
> Matt
>
>
>
> theDude_2 wrote:
>> Ah, Interesting... I didnt think of that!  I will try it and report back
>>
>>
>> pjaol wrote:
>>  
>>> Why not put the keywords into the same document as another field? and
>>> search
>>> both fields
>>> at once, you can then use lucene syntax to give a boosting to the 
>>> keyword
>>> fields.
>>> e.g.
>>> body:A good game last night by the redskins
>>> keyword: redskins
>>>
>>> Query= body:(game OR redskins) keyword:(game OR redskins)^10
>>>
>>> And adjust the boosting until you're happy.
>>> Check out for querying multiple fields
>>> http://wiki.apache.org/lucene-java/LuceneFAQ#head-300f0756fdaa71f522c96a868351f716573f2d77 
>>>
>>>
>>> You might even want to consider Solr and it's dismax search component
>>> http://wiki.apache.org/solr/DisMaxRequestHandler
>>> to make it easier
>>>
>>>
>>>
>>>
>>> On Fri, Apr 17, 2009 at 11:19 AM, theDude_2 <aornstein@webmd.net> 
>>> wrote:
>>>
>>>    
>>>> I appreciate your response, and read the wiki article concerning the
>>>> Federated search
>>>> and
>>>>
>>>> I'm not sure that my project falls into the "Federated Search" 
>>>> bucket...
>>>>
>>>> What I've done is created 2 indexes created with the same documents.
>>>> One index, contains the full documents - great for pure relevancy 
>>>> search
>>>> The second index: contains all of the same documents, but a small 
>>>> subset
>>>> of
>>>> each documents contents - only allowing words to be indexed that we 
>>>> deem
>>>> as
>>>> "good words" -
>>>>
>>>> (for example) if this was a football article database
>>>> Index 1: would index 100% of the article about the Redskins and the 
>>>> New
>>>> York
>>>> Giants
>>>> Index 2: would index the same article by only the "good words" in the
>>>> document like Redskins, Giants, Quarterback, Linebacker, etc.
>>>>
>>>> What I'm trying to do, if it's even possible! is run the search on 
>>>> both
>>>> indexes containing references to the same article, and multiple the
>>>> scores
>>>> together to get a final score that would represent something like a
>>>> "relative AND good word" score....
>>>>
>>>> Figuring that if a user searches on "Who is the Quarterback for the
>>>> Giants"
>>>> this will get the user an article that is both related to the 
>>>> query, and
>>>> deemed "important" to the query...
>>>>
>>>> I will look further into federated search and related items, but I 
>>>> think
>>>> that lucene probably wont be able to help me with this, am I right?
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> ------------
>>>>
>>>> pjaol wrote:
>>>>      
>>>>> I'd start by doing some research on the question rather than 
>>>>> asking for
>>>>>         
>>>> a
>>>>      
>>>>> solution..
>>>>> What your asking for can be considered 'Federated Search'
>>>>> http://en.wikipedia.org/wiki/Federated_search
>>>>>
>>>>> And it can be conceived in as many ways as you have document 
>>>>> types. Any
>>>>> answer will probably end up
>>>>> customized and weighted by your document silo value, usually 
>>>>> companies
>>>>> weight those by business rules
>>>>> rather than head down the path of federated search, as it's just
>>>>>         
>>>> quicker
>>>>      
>>>>> and
>>>>> cheaper, and you can accomplish more.
>>>>> e.g
>>>>> Medication = score *2  (as higher advertising incentives)
>>>>> Diseases = score
>>>>> Books = score * 0.75  ( thousands of books, which nobody buys etc..)
>>>>>
>>>>> You might also want to try consolidating your data into 1 schema, and
>>>>> consider layering or collapsing results
>>>>> based on type.
>>>>>
>>>>> P
>>>>>
>>>>> On Fri, Apr 17, 2009 at 10:39 AM, theDude_2 <aornstein@webmd.net>
>>>>>         
>>>> wrote:
>>>>      
>>>>>> (bump) - any thoughts?
>>>>>> ----
>>>>>>
>>>>>>
>>>>>>
>>>>>> theDude_2 wrote:
>>>>>>          
>>>>>>> hi!
>>>>>>>
>>>>>>> I am trying to do something a little unique...
>>>>>>>
>>>>>>> I have a 90k text documents that I am trying to search
>>>>>>> Search A: indexes and searches the documents using regular 
>>>>>>> relevancy
>>>>>>> search
>>>>>>> Search B: indexes and searches the documents using a smaller subset
>>>>>>>             
>>>> of
>>>>      
>>>>>>> "key" words that I have chosen
>>>>>>>
>>>>>>> This gives me 2 seperate scores: Score A, and Score B...
>>>>>>>
>>>>>>> I am trying to show the top 10 results of the scores combined 
>>>>>>> so....
>>>>>>>
>>>>>>> FinalScoretextDoc = (scoreA_of_td1 * 0.5) * (scoreB_of_td1 * 0.5)
>>>>>>>
>>>>>>> While it seems straightforward, I do not want to calculate the
>>>>>>>             
>>>> scores
>>>>      
>>>>>> of
>>>>>>          
>>>>>>> all the documents outside of lucene.  How can I integrate this
>>>>>>>             
>>>> better
>>>>      
>>>>>> into
>>>>>>          
>>>>>>> the lucene search engine?  Is this possible to do by any simple
>>>>>>>             
>>>> means?
>>>>      
>>>>>>> Thanks guys + gals!
>>>>>>>
>>>>>>>
>>>>>>>             
>>>>>> -- 
>>>>>> View this message in context:
>>>>>>
>>>>>>           
>>>> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23098961.html 
>>>>
>>>>      
>>>>>> Sent from the Lucene - Java Users mailing list archive at 
>>>>>> Nabble.com.
>>>>>>
>>>>>>
>>>>>> --------------------------------------------------------------------- 
>>>>>>
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>>>           
>>>>>         
>>>> -- 
>>>> View this message in context:
>>>> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23099744.html 
>>>>
>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>       
>>>     
>>
>>   
>
>



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39787-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 19:28:16 2009
Return-Path: <java-user-return-39787-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29199 invoked from network); 17 Apr 2009 19:28:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 19:28:16 -0000
Received: (qmail 6771 invoked by uid 500); 17 Apr 2009 19:28:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6679 invoked by uid 500); 17 Apr 2009 19:28:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6669 invoked by uid 99); 17 Apr 2009 19:28:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 19:28:13 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.18.82] (HELO smtp1.syr.edu) (128.230.18.82)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 19:28:04 +0000
Received: from suex07-hub-02.ad.syr.edu (suex07-hub-02.ad.syr.edu [128.230.108.196])
	by smtp1.syr.edu (8.14.3/8.14.3) with ESMTP id n3HJRhqD014787
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=FAIL)
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 15:27:43 -0400
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-02.ad.syr.edu ([fe80::813b:49a2:a4d5:6367%10]) with mapi; Fri, 17
 Apr 2009 15:27:43 -0400
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 17 Apr 2009 15:27:41 -0400
Subject: RE: Need help : SpanNearQuery
Thread-Topic: Need help : SpanNearQuery
Thread-Index: Acm/aQZYRrAG6qCISwSDLlsRV2yKnwAAEIzAAAoAVYA=
Message-ID: <2D127F11DC79714E9B6A43AC9458147F13FCA3EC@suex07-mbx-03.ad.syr.edu>
References: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30@BLRKECMBX09.ad.infosys.com>
 <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9C012D@BLRKECMBX09.ad.infosys.com>
 <5CDA3DC1F80BBB42BD0B48FABC128B5114F30519B1@BLRKECMBX09.ad.infosys.com>
 <200904171629.34615.paul.elschot@xs4all.nl>
 <5CDA3DC1F80BBB42BD0B48FABC128B5114F3051ADA@BLRKECMBX09.ad.infosys.com>
In-Reply-To: <5CDA3DC1F80BBB42BD0B48FABC128B5114F3051ADA@BLRKECMBX09.ad.infosys.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.7400:2.4.4,1.2.40,4.0.166 definitions=2009-04-17_09:2009-04-15,2009-04-17,2009-04-17 signatures=0
X-Proofpoint-Spam-Reason: safe
X-Virus-Checked: Checked by ClamAV on apache.org

On 4/17/2009 at 10:33 AM, Radhalakshmi Sreedharan wrote:
> > > I have a question related to SpanNearQuery.
> > >
> > > As of now, the  SpanNearQuery has the constraint that all the
> > > terms need to present in the document.
[...]
> > > But [...] I need a hit even if there are 2/3 terms found with
> > > the span being applied for those 2 terms.
[...]
> > > 1) For a list of terms (ab,bc,cd,ef), make a set like=20
> > >    (ab,bc), ( bc,cd) ( ab,cd) (bc,ef) ( ab,bc,cd)=20
> > >    ( ab,bc,cd,ef)..... and so on.
>
> [...] Will the Shingle Filter help me getting all possible
> combination of the input tokens?

The ShingleFilter is designed to generate tokens from token *sequences* in =
an input token stream, but you want to match against cases where they are s=
eparated by other tokens, so even if you generated shingles at index and qu=
ery time, many of the documents you would want to match would not match, si=
nce the intervening tokens would block a match.  (But maybe you were thinki=
ng of some other scenario?)

Steve


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39788-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 20:02:10 2009
Return-Path: <java-user-return-39788-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39313 invoked from network); 17 Apr 2009 20:02:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 20:02:09 -0000
Received: (qmail 75847 invoked by uid 500); 17 Apr 2009 20:02:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75800 invoked by uid 500); 17 Apr 2009 20:02:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75790 invoked by uid 99); 17 Apr 2009 20:02:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 20:02:07 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.18.71] (HELO mx3.syr.edu) (128.230.18.71)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 20:01:57 +0000
Received: from suex07-hub-01.ad.syr.edu (suex07-hub-01.ad.syr.edu [128.230.108.195])
	by mx3.syr.edu (8.14.3/8.14.3) with ESMTP id n3HK1ZX4018953
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 16:01:36 -0400
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-01.ad.syr.edu ([2002:80e6:6cc3::80e6:6cc3]) with mapi; Fri, 17 Apr
 2009 16:01:36 -0400
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 17 Apr 2009 16:01:34 -0400
Subject: RE: Need help : SpanNearQuery
Thread-Topic: Need help : SpanNearQuery
Thread-Index: Acm+iNF1pm27j7zFQguuTqAOr5YfMAABtBKwAAgjfKAAHoBJYAAGfzKQABOco+A=
Message-ID: <2D127F11DC79714E9B6A43AC9458147F13FCA3ED@suex07-mbx-03.ad.syr.edu>
References: <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9BFE30@BLRKECMBX09.ad.infosys.com>
 <2D127F11DC79714E9B6A43AC9458147F13FCA3C7@suex07-mbx-03.ad.syr.edu>
 <5CDA3DC1F80BBB42BD0B48FABC128B5114EC9C012D@BLRKECMBX09.ad.infosys.com>
 <5CDA3DC1F80BBB42BD0B48FABC128B5114F30519B1@BLRKECMBX09.ad.infosys.com>
In-Reply-To: <5CDA3DC1F80BBB42BD0B48FABC128B5114F30519B1@BLRKECMBX09.ad.infosys.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.7400:2.4.4,1.2.40,4.0.166 definitions=2009-04-17_09:2009-04-15,2009-04-17,2009-04-17 signatures=0
X-Proofpoint-Spam-Reason: safe
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Radha,
=20
On 4/17/2009 at 6:19 AM, Radhalakshmi Sreedharan wrote:=20
> What I need is  the following :
> If my document field is ( ab,bc,cd,ef) and Search tokens are
> (ab,bc,cd).
>=20
> Given the following :
>  I should get a hit even if all of the search tokens aren't present
>  If the tokens are found they should be found within a distance x of
> each other ( proximity search)
>=20
> I need the percentage match of the search tokens with the document
> field.
>=20
> Currently this is my query :
> 1) I form all possible permutation of the search tokens
> 2) do a spanNearQuery of each permutation
> 3)  Do a DisjunctionMaxQuery on the spannearqueries.
>=20
> This is how I compute % match  :
> % match =3D  ( Score by running the query on the document field ) /
> 		( score by running the query on a document field created
> out of search tokens )
>=20
> The numerator gives me the actual score with the search tokens run on
> the field.
> Denominator gives  me the  best possible or maximum possible score with
> the current search tokens
>=20
> For this example << If my document field is ( ab,bc,cd,ef) and Search
> tokens are (ab,bc,cd).>> I expect a % match of around 90%.

I'm having trouble understanding what your "% match" function represents.  =
What scores do you want if a document field contains (ab,bc,cd,ef,gh)?  Or =
(ab,bc,cd,ef,gh,ij,jk,lm,no)?

Where does your "best possible" document reside?  I'm assuming that: either=
 the query set is fixed, and so you have a pre-indexed set of pseudo-docume=
nts corresponding to the queries; or you're creating new pseudo-documents f=
or the query just prior to launching it.  In either case, do your pseudo-do=
cuments reside in the same index as the one that contains the real document=
s?=20

> I tried out your approach and the problem got solved to an extent but
> still it remains.
>=20
> The problem is the score reduces quite a bit even now as bc is not
> found in the combinations ( bc,cd) ( bc,ef) and ( ab,bc,cd,ef) etc.
>=20
> The boosting infact has a negative impact and reduces the score further
> :(
>=20
> The factor which is affected by boosting is the queryNorm .
>=20
> With a boost of 6  -
>=20
> 0.015559823 =3D (MATCH) max of:
>   0.015559823 =3D (MATCH) weight(spanNear([SearchField:cd,
> SearchField:ef], 10, false)^6.0 in 0), product of:
>     0.07606166 =3D queryWeight(spanNear([SearchField:cd, SearchField:ef],
> 10, false)^6.0), product of:
>       6.0 =3D boost
>       0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
>       0.02065639 =3D queryNorm
>     0.20456855 =3D (MATCH) fieldWeight(SearchField:spanNear([cd, ef], 10,
> false)^6.0 in 0), product of:
>       0.33333334 =3D tf(phraseFreq=3D0.33333334)
>       0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
>       1.0 =3D fieldNorm(field=3DSearchField, doc=3D0)
>=20
> Without a boost  -
>=20
> 0.07779912 =3D (MATCH) max of:
>   0.07779912 =3D (MATCH) weight(spanNear([SearchField:cd,
> SearchField:ef], 10, false) in 0), product of:
>     0.3803083 =3D queryWeight(spanNear([SearchField:cd, SearchField:ef],
> 10, false)), product of:
>       0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
>       0.6196917 =3D queryNorm
>     0.20456855 =3D (MATCH) fieldWeight(SearchField:spanNear([cd, ef], 10,
> false) in 0), product of:
>       0.33333334 =3D tf(phraseFreq=3D0.33333334)
>       0.61370564 =3D idf(SearchField: cd=3D1 ef=3D1)
>       1.0 =3D fieldNorm(field=3DSearchField, doc=3D0)

The queryNorm for the boosted variant is 1/30th of the non-boosted query, b=
ut the boost is multiplied through, resulting in a score that is 1/5th of t=
he non-boosted query.  I would think that the queryNorm would be unaffected=
 by the boost.  Sorry, I don't know what's happening - maybe a bug?
=20
Steve


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39789-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 21:21:55 2009
Return-Path: <java-user-return-39789-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62632 invoked from network); 17 Apr 2009 21:21:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 21:21:54 -0000
Received: (qmail 80946 invoked by uid 500); 17 Apr 2009 21:21:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80860 invoked by uid 500); 17 Apr 2009 21:21:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80850 invoked by uid 99); 17 Apr 2009 21:21:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 21:21:52 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [128.138.128.141] (HELO smtp01.Colorado.EDU) (128.138.128.141)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 21:21:42 +0000
X-ASG-Debug-ID: 1240003272-74c102950004-H1Y1KX
X-Barracuda-URL: http://128.138.128.141:8000/cgi-bin/mark.cgi
Received: from omr-raz-2-priv.int.colorado.edu (omr-raz-2-pub.colorado.edu [128.138.123.155])
	by smtp01.Colorado.EDU (Spam Firewall) with ESMTP id 5E26EC06998
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 15:21:20 -0600 (MDT)
Received: from omr-raz-2-priv.int.colorado.edu (omr-raz-2-pub.colorado.edu [128.138.123.155]) by smtp01.Colorado.EDU with ESMTP id TcBdKImXIAUxzP0O for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 15:21:20 -0600 (MDT)
Received: from 171.66.81.235 (EHLO _10.32.10.147_) ([171.66.81.235])
	by omr-raz-2-priv.int.colorado.edu (MOS 3.10.4-GA FastPath queued)
	with ESMTP id AWE21543 (AUTH bethard);
	Fri, 17 Apr 2009 15:21:20 -0600 (MDT)
Message-ID: <49E8F2B2.3080401@stanford.edu>
Date: Fri, 17 Apr 2009 14:20:50 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
X-ASG-Orig-Subj: sub-scores for all clauses in a BooleanQuery
Subject: sub-scores for all clauses in a BooleanQuery
X-Enigmail-Version: 0.95.7
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Barracuda-Connect: omr-raz-2-pub.colorado.edu[128.138.123.155]
X-Barracuda-Start-Time: 1240003280
X-Barracuda-Virus-Scanned: by Barracuda Spam Firewall at Colorado.EDU
X-Barracuda-Spam-Score: 0.00
X-Barracuda-Spam-Status: No, SCORE=0.00 using global scores of TAG_LEVEL=1000.0 QUARANTINE_LEVEL=1000.0 KILL_LEVEL=8.0 tests=
X-Barracuda-Spam-Report: Code version 3.1, rules version 3.1.81719
	Rule breakdown below
	 pts rule name              description
	---- ---------------------- --------------------------------------------------
X-Virus-Checked: Checked by ClamAV on apache.org

I have a BooleanQuery with several clauses. After running a search, in
addition to seeing the overall score of each document, I need to see the
sub-score produced by each clause. When all clauses match, this is
relatively easy to get back by ".explain(...)", which gives me something
like this:

0.32073945 = sum of:
  0.31007314 = ...
  0.009919861 = ...
  7.4644934E-4 = ...

I can then get the sub-scores by and calling ".getValue()" on each of
the Explanation details.

However, when one or more clauses are not considered to be matches, they
are simply dropped from the explanation. So then I get something like:

0.17179786 = sum of:
  0.17119168 = ...
  6.0617714E-4 = ...

Since the clause that didn't match was simply dropped from the
Explanation, I can no longer use the ".explain(...)" + ".getValue()"
trick because I don't know which clause was dropped.

I've also tried getting the scores by walking the clauses of the
BooleanQuery, but that doesn't seem to work either, because the
queryNorm is off. For example, here's an original explanation for a
3-clause query, where one clause doesn't match:

0.17179786 = sum of:
  0.17119168 = product of:
    0.23752846 = sum of:
    0.7207207 = coord(80/111)
  6.0617714E-4 = float(citationCount)^0.01, product of:
    2.0 = float(citationCount)=2.0
    0.01 = boost
    0.030308858 = queryNorm

And here's what I get if I ask for an explanation from each clause
individually:

0.1711924 = product of:
  0.23752946 = sum of:
  0.7207207 = coord(80/111)

0.0 = product of:
  0.0 = sum of:
  0.0 = coord(0/2)

2.0 = float(citationCount)^0.01, product of:
  2.0 = float(citationCount)=2.0
  0.01 = boost
  100.0 = queryNorm

Notice that the last explanation gets a score of 2.0 instead of
6.0617714E-4.

So how can I get the correct sub-scores for *all* clauses of a
BooleanQuery, regardless of whether they matched or not?

Thanks,

Steve

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39790-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 23:28:31 2009
Return-Path: <java-user-return-39790-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11877 invoked from network); 17 Apr 2009 23:28:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 23:28:31 -0000
Received: (qmail 5552 invoked by uid 500); 17 Apr 2009 23:28:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5468 invoked by uid 500); 17 Apr 2009 23:28:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5458 invoked by uid 99); 17 Apr 2009 23:28:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 23:28:29 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [151.190.254.13] (HELO edge.itt.com) (151.190.254.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 23:28:22 +0000
Received: from fwexhub5.itt.net (10.32.76.115) by edge.itt.com (10.32.16.13)
 with Microsoft SMTP Server (TLS) id 8.1.340.0; Fri, 17 Apr 2009 19:28:15
 -0400
Received: from IIWCBO-EHUB1.iiw.de.ittind.com (10.244.2.24) by
 fwexhub5.itt.net (10.32.76.115) with Microsoft SMTP Server (TLS) id
 8.1.340.0; Fri, 17 Apr 2009 19:28:01 -0400
Received: from iiwcbo-emb1.iiw.de.ittind.com ([10.244.2.29]) by
 IIWCBO-Ehub1.iiw.de.ittind.com ([::1]) with mapi; Fri, 17 Apr 2009 19:27:59
 -0400
From: "Newman, Billy" <Billy.Newman@itt.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 17 Apr 2009 19:27:58 -0400
Subject: IndexWriter update method
Thread-Topic: IndexWriter update method
Thread-Index: AQHJv7QkvVDojLcyLkaz1z5tdeNP1Q==
Message-ID: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79B@IIWCBO-EMB1.iiw.de.ittind.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

I am looking for info on how to use the IndexWriter.update method.  A short=
 example of how to add a document and then later update would be very helpf=
ul.  I get lost because I can add a document with just the document, but I =
need a document and a Term.  I am not really sure what a Term is since I di=
d not use a Term to create the document nor do I see it in any of the examp=
les of searching/adding.

Thanks,
Billy

This e-mail and any files transmitted with it may be proprietary and are in=
tended solely for the use of the individual or entity to whom they are addr=
essed. If you have received this e-mail in error please notify the sender.
Please note that any views or opinions presented in this e-mail are solely =
those of the author and do not necessarily represent those of ITT Corporati=
on. The recipient should check this e-mail and any attachments for the pres=
ence of viruses. ITT accepts no liability for any damage caused by any viru=
s transmitted by this e-mail.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39791-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 23:29:30 2009
Return-Path: <java-user-return-39791-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12054 invoked from network); 17 Apr 2009 23:29:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 23:29:29 -0000
Received: (qmail 7840 invoked by uid 500); 17 Apr 2009 23:29:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7774 invoked by uid 500); 17 Apr 2009 23:29:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7764 invoked by uid 99); 17 Apr 2009 23:29:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 23:29:27 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of john.wang@gmail.com designates 74.125.44.28 as permitted sender)
Received: from [74.125.44.28] (HELO yx-out-2324.google.com) (74.125.44.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 23:29:17 +0000
Received: by yx-out-2324.google.com with SMTP id 8so1021yxm.5
        for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 16:28:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=swF994FQb2y0pZEWx/u62TywUO1YkIbsc/RYA8sc2ig=;
        b=I4X/Wsrv1C0oJAZTk9Gj9pn5yikB8sxFx7SmZ1XpoiTN38l7ShqndVLUxMPVakWt2d
         rfC9N+AAqftKgM0RjJBSrmyyHSi3CLOHHsa+yiTOrze5/w1Rlz3yR/+UEbscWz4lAqrN
         yKx3K/N2Jlofi4Uc/tAS22alAqVa4cv8oiunI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=VXRyyd8looE/255NIEqn6iMs+PtAlsdjtEW4Tdr+NJDFxpURo3PzBBoErsTAD/dz1v
         +mMmpylKJkBR3sboUGT3kF0ura9VX3lgd8YH79+B3M/4Wx2ngdQZyo7nUzg7YUuht+Ls
         EwN1vdnYNVtwfuOcFz25pZW59dzscVf45eH8Y=
MIME-Version: 1.0
Received: by 10.100.154.17 with SMTP id b17mr4429129ane.143.1240010936233; 
	Fri, 17 Apr 2009 16:28:56 -0700 (PDT)
In-Reply-To: <FFC3F4B9-6DC1-4B65-A761-7A4D2CF5B5AC@apache.org>
References: <a59386fa0904161022r2172f36nd95a94662a017791@mail.gmail.com>
	 <FFC3F4B9-6DC1-4B65-A761-7A4D2CF5B5AC@apache.org>
Date: Fri, 17 Apr 2009 16:28:56 -0700
Message-ID: <8837fb770904171628u7056a0e9ha3987999dc4528a2@mail.gmail.com>
Subject: Re: Google's search Appliance relevance ranking
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e642d3765f3b6c0467c88b5d
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e642d3765f3b6c0467c88b5d
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Little I know about GSA, there isn't a distributed solution (old
information, not sure if it is still the case), so it is not very easy to
scale your search system. Something you can achieve rather easily with a
Lucene/Solr implementation.
There are other benefits of using an open source solution such as you can
see/fix bugs/issues or even write your own extensions by looking at the
source code.

If you are worried about support with Lucene/Solr, the committers have
formed a company for that, it is probably more cost-effective to pay for
support/consulting than paying google for their box (you may have to pay
support on top of the "pizza box")

my two cents.

-John

On Fri, Apr 17, 2009 at 9:09 AM, Grant Ingersoll <gsingers@apache.org>wrote:

>
> On Apr 16, 2009, at 10:22 AM, Vasudevan Comandur wrote:
>
>  Hi,
>>
>>  The question that I am posting in this group may be inappropriate and I
>> want to apologize for that.
>>
>
> I wouldn't say it's inappropriate, but I don't know if anyone here could
> say with certainty b/c the last time I checked GSA was not an open
> platform...
>
>
>>
>>  My question is, what is the relevance ranking algorithm which is used in
>> Google Search Appliance (GSA) because the search
>>  is predominantly on documents rather than web pages.
>>
>
> AFAIK, they use a Vector Space Model much as Lucene does, but you'd have to
> ask them as I don't have anything to point to other than I've heard others
> speculate it.
>
>
>
>>
>>  I appreciate if any of you can send me pointers to the algorithm used by
>> google.
>>
>
> Sorry, I don't have any.  I would look through their docs.  Or, just use
> Lucene/Solr and save yourself a bunch of money... ;-)
>
>
>>
>> Regards
>> Vasu
>>
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) using
> Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e642d3765f3b6c0467c88b5d--

From java-user-return-39792-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 17 23:36:47 2009
Return-Path: <java-user-return-39792-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12932 invoked from network); 17 Apr 2009 23:36:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Apr 2009 23:36:47 -0000
Received: (qmail 13971 invoked by uid 500); 17 Apr 2009 23:36:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13925 invoked by uid 500); 17 Apr 2009 23:36:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13915 invoked by uid 99); 17 Apr 2009 23:36:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 23:36:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [171.67.219.88] (HELO smtp-roam.stanford.edu) (171.67.219.88)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 17 Apr 2009 23:36:37 +0000
Received: from smtp-roam.stanford.edu (localhost.localdomain [127.0.0.1])
	by localhost (Postfix) with SMTP id 26BC037E41
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 16:36:17 -0700 (PDT)
Received: from [10.32.10.147] (DN0a200a93.SUNet [10.32.10.147])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: bethard)
	by smtp-roam.stanford.edu (Postfix) with ESMTPSA id C971537D8A
	for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 16:36:16 -0700 (PDT)
Message-ID: <49E91253.4030506@stanford.edu>
Date: Fri, 17 Apr 2009 16:35:47 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Why is CustomScoreQuery limited to ValueSourceQuery type?
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

CustomScoreQuery only allows the secondary queries to be of type
ValueSourceQuery instead of allowing them to be any type of Query. Why
is that? Is there something that makes it hard to implement for
arbitrary queries?

Steve

P.S. I played around with this briefly, and simply replacing all
ValueSourceQuery references with Query references yields only one simple
compile error, where ValueSourceQuery.createWeight() is being used
instead of Query.weight() for some reason.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39793-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 00:06:05 2009
Return-Path: <java-user-return-39793-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21456 invoked from network); 18 Apr 2009 00:06:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 00:06:05 -0000
Received: (qmail 32619 invoked by uid 500); 18 Apr 2009 00:06:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32535 invoked by uid 500); 18 Apr 2009 00:06:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32525 invoked by uid 99); 18 Apr 2009 00:06:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 00:06:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of williamstw@gmail.com designates 74.125.46.28 as permitted sender)
Received: from [74.125.46.28] (HELO yw-out-2324.google.com) (74.125.46.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 00:05:54 +0000
Received: by yw-out-2324.google.com with SMTP id 9so651048ywe.5
        for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 17:05:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=KVmTlVdl1XsPRcZuQ0mEfLyXFeklYRnvA+mf5+hqeUA=;
        b=tEdYBHnbwjTt5lRQ6Im8HymkLmoIKiETR5FZ8S8EvXYnOSghXyiUwWTny0cpYI2Io4
         OaLdG9OQKTFhya0LabRTdyON3qRRsgJZdj/Ji32FETfmW+DCe4jEZHnuKMmiNDmndV5G
         0ZJtPqap2NyNujRLZS5xP4fkrYQgt9fa2OxGw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=q7AxJ6umRrsnCim+i36aW+IGSmS1h4J5Ka5VD+wIBx78/YAAVNJkReZsNBvE9ID5fz
         d6faPmrInqYUpsd0H7F8fAZoMUGu5ELiRf2uBg1zf8LnQqRKySVU7N9xLe4FukvvI6b9
         57G4CLtCGcW6Xq9esvSEFHArxmdhZoka+5huo=
MIME-Version: 1.0
Received: by 10.151.108.15 with SMTP id k15mr1066190ybm.172.1240013133799; 
	Fri, 17 Apr 2009 17:05:33 -0700 (PDT)
In-Reply-To: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79B@IIWCBO-EMB1.iiw.de.ittind.com>
References: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79B@IIWCBO-EMB1.iiw.de.ittind.com>
Date: Fri, 17 Apr 2009 20:05:33 -0400
Message-ID: <499888440904171705s467e3bap95598f3f870c20b3@mail.gmail.com>
Subject: Re: IndexWriter update method
From: Tim Williams <williamstw@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 17, 2009 at 7:27 PM, Newman, Billy <Billy.Newman@itt.com> wrote=
:
> I am looking for info on how to use the IndexWriter.update method. =A0A s=
hort example of how to add a document and then later update would
> be very helpful. =A0I get lost because I can add a document with just the=
 document, but I need a document and a Term. =A0I am not really sure
> what a Term is since I did not use a Term to create the document nor do I=
 see it in any of the examples of searching/adding.

When you index the document, add an ID field that is unique.  Then
when you go to update the document the "Term" will be the ID of the
document you wish to update.  For example, you might add a URL as the
unique ID, then to update it might look something like:

writer.update(new Term("id","http://apache.org/lucene/index.htm"), doc)


--tim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39794-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 00:08:55 2009
Return-Path: <java-user-return-39794-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22319 invoked from network); 18 Apr 2009 00:08:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 00:08:54 -0000
Received: (qmail 37932 invoked by uid 500); 18 Apr 2009 00:08:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37778 invoked by uid 500); 18 Apr 2009 00:08:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37451 invoked by uid 99); 18 Apr 2009 00:08:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 00:08:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bradfordstephens@gmail.com designates 209.85.198.227 as permitted sender)
Received: from [209.85.198.227] (HELO rv-out-0506.google.com) (209.85.198.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 00:08:38 +0000
Received: by rv-out-0506.google.com with SMTP id b25so493442rvf.5
        for <multiple recipients>; Fri, 17 Apr 2009 17:08:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=xNkSaXJn/49YDivnPha4Scnzh7fMN0nPjrWDDYa+QHQ=;
        b=KO5JWjI/xyessLrw7uBpnIb4O+gUIUdkN0xwAud9TYAEr7D7rFldrQVyeWAliztYBA
         s+ofcMBRGu7rz74kYPohhrSC+u1RO0wKYwZg9A9klbCZWa++AzGZWRMBnw87WRifJScp
         ZitLeWKM8IkSA2Zekt5MYXQrK+Vv/KVaggJ/I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=qCGU+nGlrrkW/9/G1VV387+7TDnJHQrci0kaTJBK5UUH1GiUpfEgfcwR1OO7IpRAwU
         9hT/NZHKEIxgpKRnHzYPykFYZOL2UhBjmKwIUQCexc8PI6ML5uU+zWiSvKavmbxAgZ35
         0In+9C2XpYpMkKv+sJXMCkeD00geTfXgoRZ1k=
MIME-Version: 1.0
Received: by 10.140.187.10 with SMTP id k10mr1399081rvf.29.1240013297756; Fri, 
	17 Apr 2009 17:08:17 -0700 (PDT)
In-Reply-To: <860544ed0904161527o4f1bb171x686682f23cb2cf88@mail.gmail.com>
References: <860544ed0904161527o4f1bb171x686682f23cb2cf88@mail.gmail.com>
Date: Fri, 17 Apr 2009 17:08:17 -0700
Message-ID: <860544ed0904171708v2212115fj4a64d4dbfd5b1ca2@mail.gmail.com>
Subject: Re: Seattle / PNW Hadoop + Lucene User Group?
From: Bradford Stephens <bradfordstephens@gmail.com>
To: core-user@hadoop.apache.org, nutch-user@lucene.apache.org, 
	solr-user@lucene.apache.org, java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

OK, we've got 3 people... that's enough for a party? :)

Surely there must be dozens more of you guys out there... c'mon,
accelerate your knowledge! Join us in Seattle!



On Thu, Apr 16, 2009 at 3:27 PM, Bradford Stephens
<bradfordstephens@gmail.com> wrote:
> Greetings,
>
> Would anybody be willing to join a PNW Hadoop and/or Lucene User Group
> with me in the Seattle area? I can donate some facilities, etc. -- I
> also always have topics to speak about :)
>
> Cheers,
> Bradford
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39795-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 01:29:20 2009
Return-Path: <java-user-return-39795-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48230 invoked from network); 18 Apr 2009 01:29:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 01:29:19 -0000
Received: (qmail 73671 invoked by uid 500); 18 Apr 2009 01:29:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73593 invoked by uid 500); 18 Apr 2009 01:29:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73583 invoked by uid 99); 18 Apr 2009 01:29:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 01:29:17 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [151.190.254.12] (HELO edge.itt.com) (151.190.254.12)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 01:29:10 +0000
Received: from fwexhub5.itt.net (10.32.76.115) by edge.itt.com (10.32.16.12)
 with Microsoft SMTP Server (TLS) id 8.1.340.0; Fri, 17 Apr 2009 21:13:44
 -0400
Received: from IIWCBO-EHUB1.iiw.de.ittind.com (10.244.2.24) by
 fwexhub5.itt.net (10.32.76.115) with Microsoft SMTP Server (TLS) id
 8.1.340.0; Fri, 17 Apr 2009 21:28:33 -0400
Received: from iiwcbo-emb1.iiw.de.ittind.com ([10.244.2.29]) by
 IIWCBO-Ehub1.iiw.de.ittind.com ([::1]) with mapi; Fri, 17 Apr 2009 21:28:32
 -0400
From: "Newman, Billy" <Billy.Newman@itt.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 17 Apr 2009 21:28:31 -0400
Subject: RE: IndexWriter update method
Thread-Topic: IndexWriter update method
Thread-Index: Acm/uXt1VHCn35ptRMCPu51g4D/gGwACRNkY
Message-ID: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79D@IIWCBO-EMB1.iiw.de.ittind.com>
References: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79B@IIWCBO-EMB1.iiw.de.ittind.com>,<499888440904171705s467e3bap95598f3f870c20b3@mail.gmail.com>
In-Reply-To: <499888440904171705s467e3bap95598f3f870c20b3@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Ok I am still confused.

Looking at the examples to index a document I would do something like the f=
ollowing:
        Document document =3D new Document();
        document.add(Field.UnStored("article", article));
        document.add(Field.Text("comments", comments));
        Analyzer analyzer  =3D new StandardAnalyzer();
        IndexWriter writer =3D new IndexWriter(indexDirectory, analyzer, fa=
lse);
        writer.addDocument(document);
        writer.optimize();
        writer.close();

Now lets say that the comments can change and when they do I want to update=
 that document to contain the newly updated comments.

So I would have to go back and check my index to see if that book already e=
xists.
Query q =3D new QueryParser("article", analyzer).parse(querystr);
int hitsPerPage =3D 10;
IndexSearcher searcher =3D new IndexSearcher(index);
TopDocCollector collector =3D new TopDocCollector(hitsPerPage);
searcher.search(q, collector);
ScoreDoc[] hits =3D collector.topDocs().scoreDocs;
if (hits!=3D null && hits.length > 0) {
  // ?
 // Then this already exists and I just want to update the comments section
}

Does that make sense?  Am I going about this wrong?

Billy


________________________________________
From: Tim Williams [williamstw@gmail.com]
Sent: Friday, April 17, 2009 6:05 PM
To: java-user@lucene.apache.org
Subject: Re: IndexWriter update method

On Fri, Apr 17, 2009 at 7:27 PM, Newman, Billy <Billy.Newman@itt.com> wrote=
:
> I am looking for info on how to use the IndexWriter.update method.  A sho=
rt example of how to add a document and then later update would
> be very helpful.  I get lost because I can add a document with just the d=
ocument, but I need a document and a Term.  I am not really sure
> what a Term is since I did not use a Term to create the document nor do I=
 see it in any of the examples of searching/adding.

When you index the document, add an ID field that is unique.  Then
when you go to update the document the "Term" will be the ID of the
document you wish to update.  For example, you might add a URL as the
unique ID, then to update it might look something like:

writer.update(new Term("id","http://apache.org/lucene/index.htm"), doc)


--tim

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


This e-mail and any files transmitted with it may be proprietary and are in=
tended solely for the use of the individual or entity to whom they are addr=
essed. If you have received this e-mail in error please notify the sender.
Please note that any views or opinions presented in this e-mail are solely =
those of the author and do not necessarily represent those of ITT Corporati=
on. The recipient should check this e-mail and any attachments for the pres=
ence of viruses. ITT accepts no liability for any damage caused by any viru=
s transmitted by this e-mail.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39796-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 02:08:24 2009
Return-Path: <java-user-return-39796-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68812 invoked from network); 18 Apr 2009 02:08:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 02:08:24 -0000
Received: (qmail 86352 invoked by uid 500); 18 Apr 2009 02:08:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86263 invoked by uid 500); 18 Apr 2009 02:08:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86253 invoked by uid 99); 18 Apr 2009 02:08:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 02:08:21 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.92.27 as permitted sender)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 02:08:14 +0000
Received: by qw-out-2122.google.com with SMTP id 5so307019qwd.53
        for <java-user@lucene.apache.org>; Fri, 17 Apr 2009 19:07:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=tXmbGDn1kBOV7UCZLmkkAiBQsv7nZCYiw/TzT2Ixmd0=;
        b=C5sNtaaHi4jEsjOyI0RZmyeRw9WPxp8okC++v7v4LnNOKRCLQWk7CRNOFXHzxkeISK
         j4uTUoaBqXHC4BEjVl6J6plcy+G5y9vsRZNDo/xhAuNejWPz2zh06kHvQRjprgtfSAjW
         aiXfXvxqjXdRf9DhOcZaVwxdF1KuXUUkBF/QE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=m0ReaVZv6xh7MHwCSMjtMKcyEpOYz6stNL+Km2GdfwxyXRkTl6mRFPtnm7vNXgYhYW
         xTORSmFw5GGCB3doERQznsMEr0Z+szCRaA84Br6qM1EJnF1vaPAJFZtJ6igtGw6aOIY9
         CCMznzoS55CTVrztGgChyaEThV0CqcmLfDhSo=
MIME-Version: 1.0
Received: by 10.220.81.19 with SMTP id v19mr3866636vck.100.1240020473720; Fri, 
	17 Apr 2009 19:07:53 -0700 (PDT)
In-Reply-To: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79D@IIWCBO-EMB1.iiw.de.ittind.com>
References: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79B@IIWCBO-EMB1.iiw.de.ittind.com>
	 <499888440904171705s467e3bap95598f3f870c20b3@mail.gmail.com>
	 <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79D@IIWCBO-EMB1.iiw.de.ittind.com>
Date: Fri, 17 Apr 2009 22:07:53 -0400
Message-ID: <359a92830904171907j2b8fdb91kbd762c905240b3df@mail.gmail.com>
Subject: Re: IndexWriter update method
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6481a70d9ae860467cac330
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6481a70d9ae860467cac330
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

What you're missing is that the example has no unique ID, it wasn't created
with update in mind.

There's no hidden magic for Lucene knowing *what* document you want
to have updated, you have to provide it yourself, and it should be unique.

Imagine a parts catalog, or an index of a directory tree. In the parts
catalog,
you could identify the document by its part number, so you'd probably index
it something like doc.add(new Field("partno", "123345",
Field.Store.whatever, Field.Index.UN_TOKENIZED);
Indexing a directory tree you could use the complete file path similarly.

Now, each document will have one (and only one) partno, and it'll be unique
(you really
don't want to tokenize this).

To update, you'd form your term on the field "partno" and value "123345",
thus uniquely
identifying the document you want replaced, and use that term in your update
statement.
Think of the Term as a unique key for the document that *you've*
deliberately put there.

I'm pretty sure (but not positive) that if you update a document where the
term doesn't
have any matches, you'll get a simple insert, but I won't guarantee it.

HTH
Erick


On Fri, Apr 17, 2009 at 9:28 PM, Newman, Billy <Billy.Newman@itt.com> wrote:

> Ok I am still confused.
>
> Looking at the examples to index a document I would do something like the
> following:
>        Document document = new Document();
>        document.add(Field.UnStored("article", article));
>        document.add(Field.Text("comments", comments));
>        Analyzer analyzer  = new StandardAnalyzer();
>        IndexWriter writer = new IndexWriter(indexDirectory, analyzer,
> false);
>        writer.addDocument(document);
>        writer.optimize();
>        writer.close();
>
> Now lets say that the comments can change and when they do I want to update
> that document to contain the newly updated comments.
>
> So I would have to go back and check my index to see if that book already
> exists.
> Query q = new QueryParser("article", analyzer).parse(querystr);
> int hitsPerPage = 10;
> IndexSearcher searcher = new IndexSearcher(index);
> TopDocCollector collector = new TopDocCollector(hitsPerPage);
> searcher.search(q, collector);
> ScoreDoc[] hits = collector.topDocs().scoreDocs;
> if (hits!= null && hits.length > 0) {
>  // ?
>  // Then this already exists and I just want to update the comments section
> }
>
> Does that make sense?  Am I going about this wrong?
>
> Billy
>
>
> ________________________________________
> From: Tim Williams [williamstw@gmail.com]
> Sent: Friday, April 17, 2009 6:05 PM
> To: java-user@lucene.apache.org
> Subject: Re: IndexWriter update method
>
> On Fri, Apr 17, 2009 at 7:27 PM, Newman, Billy <Billy.Newman@itt.com>
> wrote:
> > I am looking for info on how to use the IndexWriter.update method.  A
> short example of how to add a document and then later update would
> > be very helpful.  I get lost because I can add a document with just the
> document, but I need a document and a Term.  I am not really sure
> > what a Term is since I did not use a Term to create the document nor do I
> see it in any of the examples of searching/adding.
>
> When you index the document, add an ID field that is unique.  Then
> when you go to update the document the "Term" will be the ID of the
> document you wish to update.  For example, you might add a URL as the
> unique ID, then to update it might look something like:
>
> writer.update(new Term("id","http://apache.org/lucene/index.htm"), doc)
>
>
> --tim
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> This e-mail and any files transmitted with it may be proprietary and are
> intended solely for the use of the individual or entity to whom they are
> addressed. If you have received this e-mail in error please notify the
> sender.
> Please note that any views or opinions presented in this e-mail are solely
> those of the author and do not necessarily represent those of ITT
> Corporation. The recipient should check this e-mail and any attachments for
> the presence of viruses. ITT accepts no liability for any damage caused by
> any virus transmitted by this e-mail.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6481a70d9ae860467cac330--

From java-user-return-39797-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 03:42:59 2009
Return-Path: <java-user-return-39797-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89951 invoked from network); 18 Apr 2009 03:42:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 03:42:59 -0000
Received: (qmail 21328 invoked by uid 500); 18 Apr 2009 03:42:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21235 invoked by uid 500); 18 Apr 2009 03:42:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21225 invoked by uid 99); 18 Apr 2009 03:42:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 03:42:55 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [151.190.254.13] (HELO edge.itt.com) (151.190.254.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 03:42:47 +0000
Received: from fwexhub3.itt.net (10.32.76.113) by edge.itt.com (10.32.16.13)
 with Microsoft SMTP Server (TLS) id 8.1.340.0; Fri, 17 Apr 2009 23:42:40
 -0400
Received: from IIWCBO-EHUB1.iiw.de.ittind.com (10.244.2.24) by
 fwexhub3.itt.net (10.32.76.113) with Microsoft SMTP Server (TLS) id
 8.1.340.0; Fri, 17 Apr 2009 23:42:25 -0400
Received: from iiwcbo-emb1.iiw.de.ittind.com ([10.244.2.29]) by
 IIWCBO-Ehub1.iiw.de.ittind.com ([::1]) with mapi; Fri, 17 Apr 2009 23:42:24
 -0400
From: "Newman, Billy" <Billy.Newman@itt.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 17 Apr 2009 23:42:23 -0400
Subject: RE: IndexWriter update method
Thread-Topic: IndexWriter update method
Thread-Index: Acm/yo7+yZRUASqvTk+8hwfHBz+OtwADElDY
Message-ID: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79E@IIWCBO-EMB1.iiw.de.ittind.com>
References: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79B@IIWCBO-EMB1.iiw.de.ittind.com>
	 <499888440904171705s467e3bap95598f3f870c20b3@mail.gmail.com>
	 <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79D@IIWCBO-EMB1.iiw.de.ittind.com>,<359a92830904171907j2b8fdb91kbd762c905240b3df@mail.gmail.com>
In-Reply-To: <359a92830904171907j2b8fdb91kbd762c905240b3df@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Perfect explanation, I think I have the idea now.  Thanks so much!  I would=
 also like to test out the update with a term that does not have any matche=
s to see if it will do an insert as that would make the code much simpler a=
nd efficient.  From the documentation an update is a delete followed by  an=
 insert, so my guess is that you are correct.

Thanks again!

Billy
________________________________________
From: Erick Erickson [erickerickson@gmail.com]
Sent: Friday, April 17, 2009 8:07 PM
To: java-user@lucene.apache.org
Subject: Re: IndexWriter update method

What you're missing is that the example has no unique ID, it wasn't created
with update in mind.

There's no hidden magic for Lucene knowing *what* document you want
to have updated, you have to provide it yourself, and it should be unique.

Imagine a parts catalog, or an index of a directory tree. In the parts
catalog,
you could identify the document by its part number, so you'd probably index
it something like doc.add(new Field("partno", "123345",
Field.Store.whatever, Field.Index.UN_TOKENIZED);
Indexing a directory tree you could use the complete file path similarly.

Now, each document will have one (and only one) partno, and it'll be unique
(you really
don't want to tokenize this).

To update, you'd form your term on the field "partno" and value "123345",
thus uniquely
identifying the document you want replaced, and use that term in your updat=
e
statement.
Think of the Term as a unique key for the document that *you've*
deliberately put there.

I'm pretty sure (but not positive) that if you update a document where the
term doesn't
have any matches, you'll get a simple insert, but I won't guarantee it.

HTH
Erick


On Fri, Apr 17, 2009 at 9:28 PM, Newman, Billy <Billy.Newman@itt.com> wrote=
:

> Ok I am still confused.
>
> Looking at the examples to index a document I would do something like the
> following:
>        Document document =3D new Document();
>        document.add(Field.UnStored("article", article));
>        document.add(Field.Text("comments", comments));
>        Analyzer analyzer  =3D new StandardAnalyzer();
>        IndexWriter writer =3D new IndexWriter(indexDirectory, analyzer,
> false);
>        writer.addDocument(document);
>        writer.optimize();
>        writer.close();
>
> Now lets say that the comments can change and when they do I want to upda=
te
> that document to contain the newly updated comments.
>
> So I would have to go back and check my index to see if that book already
> exists.
> Query q =3D new QueryParser("article", analyzer).parse(querystr);
> int hitsPerPage =3D 10;
> IndexSearcher searcher =3D new IndexSearcher(index);
> TopDocCollector collector =3D new TopDocCollector(hitsPerPage);
> searcher.search(q, collector);
> ScoreDoc[] hits =3D collector.topDocs().scoreDocs;
> if (hits!=3D null && hits.length > 0) {
>  // ?
>  // Then this already exists and I just want to update the comments secti=
on
> }
>
> Does that make sense?  Am I going about this wrong?
>
> Billy
>
>
> ________________________________________
> From: Tim Williams [williamstw@gmail.com]
> Sent: Friday, April 17, 2009 6:05 PM
> To: java-user@lucene.apache.org
> Subject: Re: IndexWriter update method
>
> On Fri, Apr 17, 2009 at 7:27 PM, Newman, Billy <Billy.Newman@itt.com>
> wrote:
> > I am looking for info on how to use the IndexWriter.update method.  A
> short example of how to add a document and then later update would
> > be very helpful.  I get lost because I can add a document with just the
> document, but I need a document and a Term.  I am not really sure
> > what a Term is since I did not use a Term to create the document nor do=
 I
> see it in any of the examples of searching/adding.
>
> When you index the document, add an ID field that is unique.  Then
> when you go to update the document the "Term" will be the ID of the
> document you wish to update.  For example, you might add a URL as the
> unique ID, then to update it might look something like:
>
> writer.update(new Term("id","http://apache.org/lucene/index.htm"), doc)
>
>
> --tim
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> This e-mail and any files transmitted with it may be proprietary and are
> intended solely for the use of the individual or entity to whom they are
> addressed. If you have received this e-mail in error please notify the
> sender.
> Please note that any views or opinions presented in this e-mail are solel=
y
> those of the author and do not necessarily represent those of ITT
> Corporation. The recipient should check this e-mail and any attachments f=
or
> the presence of viruses. ITT accepts no liability for any damage caused b=
y
> any virus transmitted by this e-mail.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39798-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 06:57:22 2009
Return-Path: <java-user-return-39798-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43994 invoked from network); 18 Apr 2009 06:57:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 06:57:21 -0000
Received: (qmail 99247 invoked by uid 500); 18 Apr 2009 06:57:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99154 invoked by uid 500); 18 Apr 2009 06:57:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99128 invoked by uid 99); 18 Apr 2009 06:57:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 06:57:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of aminmc@gmail.com designates 74.125.92.24 as permitted sender)
Received: from [74.125.92.24] (HELO qw-out-2122.google.com) (74.125.92.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 06:57:10 +0000
Received: by qw-out-2122.google.com with SMTP id 5so350996qwd.53
        for <multiple recipients>; Fri, 17 Apr 2009 23:56:48 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:references:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:x-mailer
         :mime-version:subject:date:cc;
        bh=p8olqyQSqh2ukU9qpf5At6bs/AFw8wEWvuhgmHDNm7E=;
        b=XcHnDIcouq9GYE/J+ZXtd8pXLK8+pUwrlbIScXATYHlC4KHHTCmLRVCcA42G48Zau5
         8+ZP7pPvr+HtK14DtoH5gxViGqL28EwXa8i7jixWFmDlSgw4qAWMvtYAdfJkZ24FRc2c
         JnNuZJyp6CXrTR4fQW8t+TjJwbGFsipowW57U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=references:message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:x-mailer:mime-version:subject:date:cc;
        b=YPr/g0x+DoDVzQQ3P4M4fMX5YphQn0svpTFZFIcwmy/j8O8m4dFEm0zkaeCZqpjRCS
         Okdzzgh9572U+apgLN/Hjam4ot1ZwGMVj7FWW2fWWtDvbTjZRidmeWnDoJ8S9+Pc7Z0z
         mMll18/HJbVRhLg1BX1MlOP7Q0isUTKdkS8ls=
Received: by 10.224.54.142 with SMTP id q14mr4679962qag.217.1240037808932;
        Fri, 17 Apr 2009 23:56:48 -0700 (PDT)
Received: from ?192.168.1.74? (host86-133-176-127.range86-133.btcentralplus.com [86.133.176.127])
        by mx.google.com with ESMTPS id 5sm2868241qwh.0.2009.04.17.23.56.47
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 17 Apr 2009 23:56:48 -0700 (PDT)
References: <860544ed0904161527o4f1bb171x686682f23cb2cf88@mail.gmail.com> <860544ed0904171708v2212115fj4a64d4dbfd5b1ca2@mail.gmail.com>
Message-Id: <E8E96088-4555-4099-B28D-CE29FE72F73C@gmail.com>
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
In-Reply-To: <860544ed0904171708v2212115fj4a64d4dbfd5b1ca2@mail.gmail.com>
Content-Type: text/plain;
	charset=us-ascii;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: 7bit
X-Mailer: iPhone Mail (5H11)
Mime-Version: 1.0 (iPhone Mail 5H11)
Subject: Re: Seattle / PNW Hadoop + Lucene User Group?
Date: Sat, 18 Apr 2009 07:57:00 +0100
Cc: "core-user@hadoop.apache.org" <core-user@hadoop.apache.org>,
 "nutch-user@lucene.apache.org" <nutch-user@lucene.apache.org>,
 "solr-user@lucene.apache.org" <solr-user@lucene.apache.org>,
 "java-user@lucene.apache.org" <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

I would love to come but I'm afraid I'm stuck in rainy old England :(

Amin

On 18 Apr 2009, at 01:08, Bradford Stephens  
<bradfordstephens@gmail.com> wrote:

> OK, we've got 3 people... that's enough for a party? :)
>
> Surely there must be dozens more of you guys out there... c'mon,
> accelerate your knowledge! Join us in Seattle!
>
>
>
> On Thu, Apr 16, 2009 at 3:27 PM, Bradford Stephens
> <bradfordstephens@gmail.com> wrote:
>> Greetings,
>>
>> Would anybody be willing to join a PNW Hadoop and/or Lucene User  
>> Group
>> with me in the Seattle area? I can donate some facilities, etc. -- I
>> also always have topics to speak about :)
>>
>> Cheers,
>> Bradford
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39799-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 14:58:26 2009
Return-Path: <java-user-return-39799-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73162 invoked from network); 18 Apr 2009 14:58:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 14:58:26 -0000
Received: (qmail 37947 invoked by uid 500); 18 Apr 2009 14:58:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37875 invoked by uid 500); 18 Apr 2009 14:58:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37864 invoked by uid 99); 18 Apr 2009 14:58:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 14:58:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 14:58:15 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LvBzP-0003NC-7d
	for java-user@lucene.apache.org; Sat, 18 Apr 2009 07:57:55 -0700
Message-ID: <23113784.post@talk.nabble.com>
Date: Sat, 18 Apr 2009 07:57:55 -0700 (PDT)
From: "Karsten F." <karsten-lucene@fiz-technik.de>
To: java-user@lucene.apache.org
Subject: Re: Faceting, Sort and DocIDSet
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC266E@mail02.tveyes.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: karsten-lucene@fiz-technik.de
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC266E@mail02.tveyes.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Dave,

searching and sorting in lucene are two separate functions (if you not want
to sort by relevance).
You will not loss performance if you first search with BitSet as
HitCollector and then sort the result by DateField.
But more easy is to extend TopFieldDocCollector/TopFieldCollector to a
Collector with facet count.

Sujit Pal's implementation of facet count is a good idea if you have a small
amount of facets and a lot documents for each facet.

I know half a dozen of implementations of facet browsing.
To choose the best you have to know:
 - How many different values have the facet? Which kind of value (Integer,
small String, huge String)?
 - More then one value of the facet per document/how many in average?
 
Possible
http://www.nabble.com/Taxonomy-in-Lucene-td20929487.html
is also interesting for you.

Best regards
  Karsten


David Seltzer wrote:
> 
> I have a set of indexes, each index contains a month's worth of
> Articles. I need to be able to search the index (sorting by date) and
> then apply access-filters based on the Article Source. I'm also trying
> to get result counts for each Article Source.
> So my questions: 
> 1) How do I use a HitCollector and sort by a field? 
> 2) Is using BitSets the wrong way to quickly generate facet counts? I've
> read about DocIDSets, but I'm not sure how to use them in the same way.
> (I'm basing my faceting technique on Sujit Pal's article
> http://sujitpal.blogspot.com/2007/04/lucene-search-within-search-with.ht
> ml)
> 
> Thanks!
> 
> -Dave
> 

-- 
View this message in context: http://www.nabble.com/Faceting%2C-Sort-and-DocIDSet-tp23099854p23113784.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39800-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 15:19:43 2009
Return-Path: <java-user-return-39800-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90481 invoked from network); 18 Apr 2009 15:19:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 15:19:43 -0000
Received: (qmail 50271 invoked by uid 500); 18 Apr 2009 15:19:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50232 invoked by uid 500); 18 Apr 2009 15:19:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50222 invoked by uid 99); 18 Apr 2009 15:19:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 15:19:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [119.160.244.193] (HELO n6a.bullet.tw1.yahoo.com) (119.160.244.193)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 18 Apr 2009 15:19:29 +0000
Received: from [119.160.244.77] by n6.bullet.tw1.yahoo.com with NNFMP; 18 Apr 2009 15:19:05 -0000
Received: from [124.108.115.242] by t2.bullet.tw1.yahoo.com with NNFMP; 18 Apr 2009 15:19:05 -0000
Received: from [124.108.114.85] by t1.bullet.mail.sg1.yahoo.com with NNFMP; 18 Apr 2009 15:18:54 -0000
Received: from [127.0.0.1] by omp105.mail.sg1.yahoo.com with NNFMP; 18 Apr 2009 15:19:05 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 198348.95007.bm@omp105.mail.sg1.yahoo.com
Received: (qmail 86182 invoked by uid 60001); 18 Apr 2009 15:19:05 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1240067945; bh=/UOW5RYp90WTzg6WHU8ShIzuXvFQV474g44qri/rmls=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=maaBP+KiYeWeM+Qhmb+ft503koblr8cepKM8DTqCQqiaNBWKBoh+K9Mn9ebUNTSLw4PAg8qVAPZm/hW03XbOpiaOaiABQYrlaPUAVsKQW7LpHO7M985kdtZ77GQXQ2w12KHJANTq/KMJ4QM6J7vVrhNaYiDcbiDX2S74QD1giP4=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=pcPto8nsXFGnbb+gBLC76oiKxpAmTSRDOzSgGPepY36Y+jGMhEg0iJzohpXoGQ2YCwdhnHZNksqDoAu0z143ZUW2pVMOp06CQwxzYg4dMEFf4+DPyfU+LAECcxcYEjbWDQRYl7cjSn29RvmvknLxtg2JDsZFtiPEKS2keBDh5Pk=;
Message-ID: <73526.84423.qm@web76013.mail.sg1.yahoo.com>
X-YMail-OSG: pzsmxKYVM1mYwFAp5UCeOEIDhNfM_wSZTjvB6a58cNc8pMsIFWvOGjqqCyp3DTNzr2jQZQBwAp.D76fEEf_.AxumVnTUrVAzE5ckXsE5ex5L5gdKJ1Ol7d2zm060KhcTiOJQILrICuOHS9AHYr4PooXvFEd3lMDB1NSX7CLjxxCv1EjHL9RVBYYDTbKo6AeOzkhraBfCSqK8I.v8g7JLuL8ZZ6kZa4qPMxokdGiDllCQ.dkrYcbyVsaEx_rYYix3ysistQwojpohW8KriMrOwq9Jrm9XYeY-
Received: from [114.59.2.51] by web76013.mail.sg1.yahoo.com via HTTP; Sat, 18 Apr 2009 23:19:04 SGT
X-Mailer: YahooMailClassic/5.2.18 YahooMailWebService/0.7.289.10
Date: Sat, 18 Apr 2009 23:19:04 +0800 (SGT)
From: daniel susanto <daniel_sus777@yahoo.com>
Subject: Indexing Complex XML
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-2065586454-1240067944=:84423"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-2065586454-1240067944=:84423
Content-Type: text/plain; charset=us-ascii

Hi,

I need advise or example to index complex XML file, I mean the XML note just in one level node but more than one. for example indexing rss or atom. 

thx b4.
Daniel Susanto
http://susantodaniel.wordpress.com


      
--0-2065586454-1240067944=:84423--


From java-user-return-39801-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 15:45:32 2009
Return-Path: <java-user-return-39801-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96710 invoked from network); 18 Apr 2009 15:45:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 15:45:32 -0000
Received: (qmail 71915 invoked by uid 500); 18 Apr 2009 15:45:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71842 invoked by uid 500); 18 Apr 2009 15:45:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71832 invoked by uid 99); 18 Apr 2009 15:45:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 15:45:29 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [151.190.254.12] (HELO edge.itt.com) (151.190.254.12)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 15:45:21 +0000
Received: from fwexhub5.itt.net (10.32.76.115) by edge.itt.com (10.32.16.12)
 with Microsoft SMTP Server (TLS) id 8.1.340.0; Sat, 18 Apr 2009 11:30:07
 -0400
Received: from IIWCBO-EHUB1.iiw.de.ittind.com (10.244.2.24) by
 fwexhub5.itt.net (10.32.76.115) with Microsoft SMTP Server (TLS) id
 8.1.340.0; Sat, 18 Apr 2009 11:44:58 -0400
Received: from iiwcbo-emb1.iiw.de.ittind.com ([10.244.2.29]) by
 IIWCBO-Ehub1.iiw.de.ittind.com ([::1]) with mapi; Sat, 18 Apr 2009 11:44:56
 -0400
From: "Newman, Billy" <Billy.Newman@itt.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Sat, 18 Apr 2009 11:44:55 -0400
Subject: NativeFSLockFactory still leaving lock files around on abnormal
 termination
Thread-Topic: NativeFSLockFactory still leaving lock files around on
 abnormal termination
Thread-Index: AQHJwDyfZSf7bETt3Uei8xdrRkPZ/g==
Message-ID: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79F@IIWCBO-EMB1.iiw.de.ittind.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

So I have recently switched to using NativeFSLockFactory so that when my jb=
oss instance is shutdown or comes down abnormally it does not leave lock fi=
les around.  My problem is that it is not working.

I have put in debug to be sure that I am really using NativeFSLockFactory. =
 I have tested this on XP, Solaris 10, and RedHat 4 with the same results. =
 I have also just wrote a quick test program that obtains a lock then loops=
 forever.  I kill the program and once again the lock file is being left ar=
ound.  Anyone run into this before?  Am I doing something wrong?

I am using version 2.4.1.

Thanks,
Billy

This e-mail and any files transmitted with it may be proprietary and are in=
tended solely for the use of the individual or entity to whom they are addr=
essed. If you have received this e-mail in error please notify the sender.
Please note that any views or opinions presented in this e-mail are solely =
those of the author and do not necessarily represent those of ITT Corporati=
on. The recipient should check this e-mail and any attachments for the pres=
ence of viruses. ITT accepts no liability for any damage caused by any viru=
s transmitted by this e-mail.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39802-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 15:50:32 2009
Return-Path: <java-user-return-39802-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97328 invoked from network); 18 Apr 2009 15:50:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 15:50:32 -0000
Received: (qmail 75987 invoked by uid 500); 18 Apr 2009 15:50:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75892 invoked by uid 500); 18 Apr 2009 15:50:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75882 invoked by uid 99); 18 Apr 2009 15:50:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 15:50:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 15:50:18 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LvCnm-0005Ym-45
	for java-user@lucene.apache.org; Sat, 18 Apr 2009 08:49:58 -0700
Message-ID: <23114306.post@talk.nabble.com>
Date: Sat, 18 Apr 2009 08:49:58 -0700 (PDT)
From: "Karsten F." <karsten-lucene@fiz-technik.de>
To: java-user@lucene.apache.org
Subject: Re: Taxonomy in Lucene
In-Reply-To: <8837fb770812120736j1456a514n65549bb1d6a9679@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: karsten-lucene@fiz-technik.de
References: <7C7C72D1EFE973489F3AF325C7C1BABC01BB7ADB@BOMEX002.corp.capgemini.com> <20937717.post@talk.nabble.com> <5e76f3840812101055q676fbc0ciee37bff35fe4dd94@mail.gmail.com> <Pine.LNX.4.62.0812101553090.10261@radix.cryptio.net> <20952134.post@talk.nabble.com> <8837fb770812110920n7519423ex4bf5d89da9950417@mail.gmail.com> <20974217.post@talk.nabble.com> <8837fb770812120736j1456a514n65549bb1d6a9679@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi John,

I intended to compare xtf with hierarchical facet browsing in browseengine
(selection expansion).
I found PathFacetCountCollector/PathFacetHandler#getFacetsForPath, and I
think that the implementation in xtf has a lot of advantages. 
So I suggest you to reuse the xtf-source for that (GroupCounts.addDoc in
package org.cdlib.xtf.textEngine.facet).

Best regads
  Karsten


John Wang wrote:
> 
> HI Karsten:
>      I will check out xtf library.
>      there is no connection between solr and browseengien other than
> Lucene
> and java.
> 
> Thanks
> 
> -John
> 

-- 
View this message in context: http://www.nabble.com/Taxonomy-in-Lucene-tp20929487p23114306.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39803-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 17:02:10 2009
Return-Path: <java-user-return-39803-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23887 invoked from network); 18 Apr 2009 17:02:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 17:02:09 -0000
Received: (qmail 38933 invoked by uid 500); 18 Apr 2009 17:02:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38850 invoked by uid 500); 18 Apr 2009 17:02:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38840 invoked by uid 99); 18 Apr 2009 17:02:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 17:02:07 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 17:01:58 +0000
Received: by qw-out-2122.google.com with SMTP id 5so439953qwd.53
        for <java-user@lucene.apache.org>; Sat, 18 Apr 2009 10:01:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=yC6yg/PaDRpZSS4CiWLypYUDH7/KQiTlm2o1z8pr6No=;
        b=MVHcAKhRhfYzEh0tejaxVyK0573u7Uu8RtsKaBOFngA1VvNmpfsWvm+K4+zQW4mTn5
         PIK72ZiGsI1V9cWytyxOmhopihGr2JbRSwLuVXqAEEjNe+0NCPsDjZ+aytyM+DNt8xJj
         HCYmUN3OTtwrNT2LXPbECOi/6BSeWj8vPkgwY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=B0/+Ps5ZBjXgvRxJwP5lnWk0RN2b46RTeGeEl7sMScJ+NM7acyTeOyUfW717Qh17XI
         aq9b/CrEhoLt1New+KjTsnAnbed3WoKmBXAq1B7B0Uth9QGct8hnsn7D+UcNtPk2hY27
         sVNckOHxbucKO6NH6hrlcS3Fg8ItI9xY8laf8=
MIME-Version: 1.0
Received: by 10.220.92.21 with SMTP id p21mr4242529vcm.47.1240074096449; Sat, 
	18 Apr 2009 10:01:36 -0700 (PDT)
In-Reply-To: <73526.84423.qm@web76013.mail.sg1.yahoo.com>
References: <73526.84423.qm@web76013.mail.sg1.yahoo.com>
Date: Sat, 18 Apr 2009 13:01:36 -0400
Message-ID: <359a92830904181001l97da9a6gefbb9d741140786@mail.gmail.com>
Subject: Re: Indexing Complex XML
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6470ece03c78e0467d74071
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6470ece03c78e0467d74071
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Lucene is an *engine*, not an application. *You* have to process the
XML, decide what the structure of your index is and index the data. There
are many
XML parser options, this is just straight Java code. You'll decide
what's relevant, and add the contents of the relevant elements to a Lucene
document
then add that to your index.

Similarly for searching.

So, say you have the following simple XML doc
<root>
   <ele1>ele 1 text</ele1>
   <ele2>ele 2 text</ele2>
</root>

You'd have to parse that text, then, say, add (semi-pseudo-code)
Document doc = new Document()
doc.add(new Field("ele1field", "ele 1 text", StoreOPtion, IndexOption);
doc.add(new Field("ele2field", "ele 2 text", StoreOption, IndexOption);
writer.add(doc);

Then at search time you'd form your queries on "ele1field" and ele2field".

HTH
Erick

On Sat, Apr 18, 2009 at 11:19 AM, daniel susanto <daniel_sus777@yahoo.com>wrote:

> Hi,
>
> I need advise or example to index complex XML file, I mean the XML note
> just in one level node but more than one. for example indexing rss or atom.
>
> thx b4.
> Daniel Susanto
> http://susantodaniel.wordpress.com
>
>
>

--0016e6470ece03c78e0467d74071--

From java-user-return-39804-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 18:01:21 2009
Return-Path: <java-user-return-39804-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50009 invoked from network); 18 Apr 2009 18:01:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 18:01:20 -0000
Received: (qmail 77641 invoked by uid 500); 18 Apr 2009 18:01:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77555 invoked by uid 500); 18 Apr 2009 18:01:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77545 invoked by uid 99); 18 Apr 2009 18:01:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 18:01:18 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.198.236] (HELO rv-out-0506.google.com) (209.85.198.236)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 18:01:10 +0000
Received: by rv-out-0506.google.com with SMTP id l9so49738rvb.5
        for <java-user@lucene.apache.org>; Sat, 18 Apr 2009 11:00:47 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.76.15 with SMTP id y15mr3732412wfa.263.1240077647586; Sat, 
	18 Apr 2009 11:00:47 -0700 (PDT)
In-Reply-To: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79F@IIWCBO-EMB1.iiw.de.ittind.com>
References: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79F@IIWCBO-EMB1.iiw.de.ittind.com>
Date: Sat, 18 Apr 2009 14:00:47 -0400
Message-ID: <9ac0c6aa0904181100u1d870501recabf0c6ef9daf11@mail.gmail.com>
Subject: Re: NativeFSLockFactory still leaving lock files around on abnormal 
	termination
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

This is normal: the file will be left in the directory, but, the lock
will not be held (the OS releases it, but does not delete the file).
I think the javadocs state this somewhere.

Mike

On Sat, Apr 18, 2009 at 11:44 AM, Newman, Billy <Billy.Newman@itt.com> wrot=
e:
> So I have recently switched to using NativeFSLockFactory so that when my =
jboss instance is shutdown or comes down abnormally it does not leave lock =
files around. =A0My problem is that it is not working.
>
> I have put in debug to be sure that I am really using NativeFSLockFactory=
. =A0I have tested this on XP, Solaris 10, and RedHat 4 with the same resul=
ts. =A0I have also just wrote a quick test program that obtains a lock then=
 loops forever. =A0I kill the program and once again the lock file is being=
 left around. =A0Anyone run into this before? =A0Am I doing something wrong=
?
>
> I am using version 2.4.1.
>
> Thanks,
> Billy
>
> This e-mail and any files transmitted with it may be proprietary and are =
intended solely for the use of the individual or entity to whom they are ad=
dressed. If you have received this e-mail in error please notify the sender=
.
> Please note that any views or opinions presented in this e-mail are solel=
y those of the author and do not necessarily represent those of ITT Corpora=
tion. The recipient should check this e-mail and any attachments for the pr=
esence of viruses. ITT accepts no liability for any damage caused by any vi=
rus transmitted by this e-mail.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39805-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 18:10:01 2009
Return-Path: <java-user-return-39805-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53607 invoked from network); 18 Apr 2009 18:10:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 18:10:01 -0000
Received: (qmail 82899 invoked by uid 500); 18 Apr 2009 18:09:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82816 invoked by uid 500); 18 Apr 2009 18:09:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82806 invoked by uid 99); 18 Apr 2009 18:09:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 18:09:58 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [203.188.202.97] (HELO n3a.bullet.mail.tp2.yahoo.com) (203.188.202.97)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 18 Apr 2009 18:09:48 +0000
Received: from [203.188.202.70] by n3.bullet.mail.tp2.yahoo.com with NNFMP; 18 Apr 2009 18:09:25 -0000
Received: from [124.108.115.243] by t1.bullet.mail.tp2.yahoo.com with NNFMP; 18 Apr 2009 18:09:24 -0000
Received: from [124.108.114.85] by t2.bullet.mail.sg1.yahoo.com with NNFMP; 18 Apr 2009 18:09:24 -0000
Received: from [127.0.0.1] by omp105.mail.sg1.yahoo.com with NNFMP; 18 Apr 2009 18:09:24 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 498833.80081.bm@omp105.mail.sg1.yahoo.com
Received: (qmail 11115 invoked by uid 60001); 18 Apr 2009 18:09:24 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1240078164; bh=Tsu3WkBSN36qZ/8FuAT8m7tKNTXfhmmToxXsybxTKcg=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=EAOPMlZxodrxaw7moxu+5DFu1WtgOX/ITn98n1lFVAVE9mT/sPqrQpxQjHvMbt8sg47kDUmpd6GvMyXxaNmGhEj9/LrUULN4L+PPE8E0F5eo355YJ45VF/GeqAddUH01YFOW6QQZZ2N0UWW+CiCFpghBwPjSd1Qec5oBz51E5sU=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=5WyUc0t1CFRrvtMXvjOVJTzf4SKeHWg1Ba4qd8xMqUEO17nCauwpX3ADiL/YihL2d88kIrDvgkaNTruaDQ3qQzvB4ajl63np7JPPfJi60XY32YTWwDSn5awIbguIhNIJdcx9rwI4/OWQJs7g5cOOBlUjCoXgNp/R1ZCZ2QWm4XA=;
Message-ID: <407281.7693.qm@web76002.mail.sg1.yahoo.com>
X-YMail-OSG: VnlsLngVM1ncZz3w.a0MIfdsZDwUqPyjepyxJrKZVdenc7TqjhAFC_PM9AlcmEnF5y7drQ0H6OOTS7z8dTGrOFdqtNJWG5K1T4f8ZevPyAhyFK8F6FxK6t30qU12V6G9umTvcGYawLZC67mEHHfmS92NYG5wiQ9rVaqNMuBlZgGiMKGYOANc3MAzF1EroW9G.Yb8LXpaR5r04b_ZpQYYfJXO_tOgb7LMv3dFKAPMh.6AGFhaiIvHJd_AVpmnyxmQOisSp2hFqQhko4cOH_CLTHo-
Received: from [114.59.2.51] by web76002.mail.sg1.yahoo.com via HTTP; Sun, 19 Apr 2009 02:09:24 SGT
X-Mailer: YahooMailClassic/5.2.18 YahooMailWebService/0.7.289.10
Date: Sun, 19 Apr 2009 02:09:24 +0800 (SGT)
From: Daniel Susanto <daniel_sus777@yahoo.com>
Subject: Re: Indexing Complex XML
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1682039705-1240078164=:7693"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1682039705-1240078164=:7693
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Thanks Erick,

In more complex xml I mean, for example this xml:

<root>
<book>
<title>Lucene Book</title>
<authors>
<author>Book author 1</author>
<author>Book author 2</author>
</authors>
<summary>Book for Lucene</summary>
</book>
<book>
=0A<title>Lucene Book 2</title>
=0A<authors>
=0A<author>Book 2 author 1</author>
=0A<author>Book 2 author 2</author>
=0A=0A</authors>
=0A<summary>Book 2 for Lucene</summary>
=0A=0A</book>
</root>

for each 'book' node is handled by one Document rite? and now
how to handle the 'authors' node? should I put in new Document? or how?

thx. :)
Daniel
Daniel Susanto
http://susantodaniel.wordpress.com

--- On Sun, 4/19/09, Erick Erickson <erickerickson@gmail.com> wrote:

From: Erick Erickson <erickerickson@gmail.com>
Subject: Re: Indexing Complex XML
To: java-user@lucene.apache.org
Date: Sunday, April 19, 2009, 12:01 AM

Lucene is an *engine*, not an application. *You* have to process the
XML, decide what the structure of your index is and index the data. There
are many
XML parser options, this is just straight Java code. You'll decide
what's relevant, and add the contents of the relevant elements to a Lucene
document
then add that to your index.

Similarly for searching.

So, say you have the following simple XML doc
<root>
=A0=A0=A0<ele1>ele 1 text</ele1>
=A0=A0=A0<ele2>ele 2 text</ele2>
</root>

You'd have to parse that text, then, say, add (semi-pseudo-code)
Document doc =3D new Document()
doc.add(new Field("ele1field", "ele 1 text", StoreOPtion, IndexOption);
doc.add(new Field("ele2field", "ele 2 text", StoreOption, IndexOption);
writer.add(doc);

Then at search time you'd form your queries on "ele1field" and ele2field".

HTH
Erick

On Sat, Apr 18, 2009 at 11:19 AM, daniel susanto <daniel_sus777@yahoo.com>w=
rote:

> Hi,
>
> I need advise or example to index complex XML file, I mean the XML note
> just in one level node but more than one. for example indexing rss or ato=
m.
>
> thx b4.
> Daniel Susanto
> http://susantodaniel.wordpress.com
>
>
>
=0A=0A=0A      
--0-1682039705-1240078164=:7693--


From java-user-return-39806-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 19:25:10 2009
Return-Path: <java-user-return-39806-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77066 invoked from network); 18 Apr 2009 19:25:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 19:25:09 -0000
Received: (qmail 15161 invoked by uid 500); 18 Apr 2009 19:25:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15076 invoked by uid 500); 18 Apr 2009 19:25:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15066 invoked by uid 99); 18 Apr 2009 19:25:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 19:25:07 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of digydigy@gmail.com designates 72.14.220.157 as permitted sender)
Received: from [72.14.220.157] (HELO fg-out-1718.google.com) (72.14.220.157)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 19:24:57 +0000
Received: by fg-out-1718.google.com with SMTP id l27so249788fgb.4
        for <java-user@lucene.apache.org>; Sat, 18 Apr 2009 12:24:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:from:to:references
         :in-reply-to:subject:date:message-id:mime-version:content-type
         :content-transfer-encoding:x-mailer:thread-index:content-language;
        bh=ipZOxaW+8xHPIVm/Rf527yammtEBGTqvrRrzXLQoZzM=;
        b=RMe6uJab7PGTfbSPz5tYbrZz5LPQYGdhsPpuH+ITdWJt1rHIzpIkrYxW6w68F5u+l2
         3vFudXGDzFsy7WA08Ei1eV5+f55ZxDIBvAWcvFMqBIIbgmR0jJM1gM8HXSGQYQMnDV4T
         Gn/5s/peBMYJfs+Zm1ZepSGUznht3Vl+oex9M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:x-mailer:thread-index
         :content-language;
        b=hAjnyPmusbOXY5qpdv4NZmCFezx2Bo/DAKl/lTm3XQVpL8Pr0NzUk0iZo0Cs6zp0AL
         kp48Ibr1i5WBdeA0EfhNem/fot5hbElISAzRmZRcG/CV055TkMNY3Fu/BL7Yq/XDUide
         rqxYlYKZkmWoPoNCvatzCvMF6Bn5sllLIxDlQ=
Received: by 10.86.65.9 with SMTP id n9mr2883341fga.47.1240082675417;
        Sat, 18 Apr 2009 12:24:35 -0700 (PDT)
Received: from NEWPC ([81.213.206.230])
        by mx.google.com with ESMTPS id 3sm239918fge.5.2009.04.18.12.24.34
        (version=SSLv3 cipher=RC4-MD5);
        Sat, 18 Apr 2009 12:24:35 -0700 (PDT)
From: "Digy" <digydigy@gmail.com>
To: <java-user@lucene.apache.org>
References: <407281.7693.qm@web76002.mail.sg1.yahoo.com>
In-Reply-To: <407281.7693.qm@web76002.mail.sg1.yahoo.com>
Subject: RE: Indexing Complex XML
Date: Sat, 18 Apr 2009 22:25:21 +0300
Message-ID: <001f01c9c05b$6b0f94f0$412ebed0$@com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-9"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
thread-index: AcnAUOPjI5imlu4wRWig5aLGXJQ7fgACZYgw
Content-Language: tr
X-Virus-Checked: Checked by ClamAV on apache.org

doc.add(new Field("authors", "name1 surname1 name2 surmane2", =
StoreOption,
IndexOption);=20

So you can make a search like=20
	authors:"name1 surname1"

(Disadvantage: you will also get result with a search like =
authors:"surname1
name2" )
DIGY

-----Original Message-----
From: Daniel Susanto [mailto:daniel_sus777@yahoo.com]=20
Sent: Saturday, April 18, 2009 9:09 PM
To: java-user@lucene.apache.org
Subject: Re: Indexing Complex XML

Thanks Erick,

In more complex xml I mean, for example this xml:

<root>
<book>
<title>Lucene Book</title>
<authors>
<author>Book author 1</author>
<author>Book author 2</author>
</authors>
<summary>Book for Lucene</summary>
</book>
<book>

<title>Lucene Book 2</title>

<authors>

<author>Book 2 author 1</author>

<author>Book 2 author 2</author>


</authors>

<summary>Book 2 for Lucene</summary>


</book>
</root>

for each 'book' node is handled by one Document rite? and now
how to handle the 'authors' node? should I put in new Document? or how?

thx. :)
Daniel
Daniel Susanto
http://susantodaniel.wordpress.com

--- On Sun, 4/19/09, Erick Erickson <erickerickson@gmail.com> wrote:

From: Erick Erickson <erickerickson@gmail.com>
Subject: Re: Indexing Complex XML
To: java-user@lucene.apache.org
Date: Sunday, April 19, 2009, 12:01 AM

Lucene is an *engine*, not an application. *You* have to process the
XML, decide what the structure of your index is and index the data. =
There
are many
XML parser options, this is just straight Java code. You'll decide
what's relevant, and add the contents of the relevant elements to a =
Lucene
document
then add that to your index.

Similarly for searching.

So, say you have the following simple XML doc
<root>
=A0=A0=A0<ele1>ele 1 text</ele1>
=A0=A0=A0<ele2>ele 2 text</ele2>
</root>

You'd have to parse that text, then, say, add (semi-pseudo-code)
Document doc =3D new Document()
doc.add(new Field("ele1field", "ele 1 text", StoreOPtion, IndexOption);
doc.add(new Field("ele2field", "ele 2 text", StoreOption, IndexOption);
writer.add(doc);

Then at search time you'd form your queries on "ele1field" and =
ele2field".

HTH
Erick

On Sat, Apr 18, 2009 at 11:19 AM, daniel susanto
<daniel_sus777@yahoo.com>wrote:

> Hi,
>
> I need advise or example to index complex XML file, I mean the XML =
note
> just in one level node but more than one. for example indexing rss or
atom.
>
> thx b4.
> Daniel Susanto
> http://susantodaniel.wordpress.com
>
>
>



     =20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39807-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 18 19:38:40 2009
Return-Path: <java-user-return-39807-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79846 invoked from network); 18 Apr 2009 19:38:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Apr 2009 19:38:40 -0000
Received: (qmail 20914 invoked by uid 500); 18 Apr 2009 19:38:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20828 invoked by uid 500); 18 Apr 2009 19:38:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20818 invoked by uid 99); 18 Apr 2009 19:38:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 19:38:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [134.96.191.147] (HELO smtp.dfki.de) (134.96.191.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 18 Apr 2009 19:38:26 +0000
Received: from smtp.dfki.de (localhost [127.0.0.1])
	by imss.7 (Postfix) with ESMTP id 8CBEB312CD
	for <java-user@lucene.apache.org>; Sat, 18 Apr 2009 21:38:04 +0200 (CEST)
Received: from mail.dfki.de (lnv-104.sb.dfki.de [134.96.191.146])
	by smtp.dfki.de (Postfix) with ESMTP id 73DBB3111A
	for <java-user@lucene.apache.org>; Sat, 18 Apr 2009 21:38:04 +0200 (CEST)
Received: from [192.168.178.47] (BAH27d4.bah.pppool.de [77.135.39.212])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.dfki.de (Postfix) with ESMTPSA id 1D0A5310CB
	for <java-user@lucene.apache.org>; Sat, 18 Apr 2009 21:38:04 +0200 (CEST)
Message-Id: <7FD16028-B660-4A4A-BB56-FB3D60FC5B84@activemath.org>
From: Paul Libbrecht <paul@activemath.org>
To: java-user@lucene.apache.org
In-Reply-To: <73526.84423.qm@web76013.mail.sg1.yahoo.com>
Content-Type: multipart/signed; boundary=Apple-Mail-324--216721769; micalg=sha1; protocol="application/pkcs7-signature"
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Indexing Complex XML
Date: Sat, 18 Apr 2009 21:37:59 +0200
References: <73526.84423.qm@web76013.mail.sg1.yahoo.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail-324--216721769
Content-Type: text/plain;
	charset=ISO-8859-1;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: quoted-printable

daniel,

have a look at solr DIH, it has prebuilt tools to do just that.
   http://wiki.apache.org/solr/DataImportHandler
This bases on solr which is a web-application that bases on lucene.
It does not need imperatively to be run as a web application though, =20
it can be embedded.

paul


Le 18-avr.-09 =E0 17:19, daniel susanto a =E9crit :

> Hi,
>
> I need advise or example to index complex XML file, I mean the XML =20
> note just in one level node but more than one. for example indexing =20=

> rss or atom.
>
> thx b4.
> Daniel Susanto
> http://susantodaniel.wordpress.com
>
>


--Apple-Mail-324--216721769
Content-Disposition: attachment;
	filename=smime.p7s
Content-Type: application/pkcs7-signature;
	name=smime.p7s
Content-Transfer-Encoding: base64

MIAGCSqGSIb3DQEHAqCAMIACAQExCzAJBgUrDgMCGgUAMIAGCSqGSIb3DQEHAQAAoIIFzjCCAocw
ggHwoAMCAQICEFwkG9LgbGf8Fuu/5kCXRScwDQYJKoZIhvcNAQEFBQAwYjELMAkGA1UEBhMCWkEx
JTAjBgNVBAoTHFRoYXd0ZSBDb25zdWx0aW5nIChQdHkpIEx0ZC4xLDAqBgNVBAMTI1RoYXd0ZSBQ
ZXJzb25hbCBGcmVlbWFpbCBJc3N1aW5nIENBMB4XDTA4MDYwMzE1MTgyOVoXDTA5MDYwMzE1MTgy
OVowcDEaMBgGA1UEBBMRTGliYnJlY2h0IEdvdXJkZXQxDTALBgNVBCoTBFBhdWwxHzAdBgNVBAMT
FlBhdWwgTGliYnJlY2h0IEdvdXJkZXQxIjAgBgkqhkiG9w0BCQEWE3BhdWxAYWN0aXZlbWF0aC5v
cmcwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMAHqTEgekG5Iyctn3tSRSfsPoZL+vkFavzl
w/xbbiQ4vWuoCZFVNHvLcFO2rfWoFLaRbcueLsmagsJwA1uxAj4tj/neoawadD+jZ3a98BkqBhIu
4hsC1poLDyvcbUOdKga9DXQ/pk/CorFvR7OOC1INrBtbDi7ycUYaUL7ZkpBFAgMBAAGjMDAuMB4G
A1UdEQQXMBWBE3BhdWxAYWN0aXZlbWF0aC5vcmcwDAYDVR0TAQH/BAIwADANBgkqhkiG9w0BAQUF
AAOBgQAt7uUnq0yd+jIo9/zYyj+NPyCh3v8CX8MW2qalj37t1YUR82o5/1O5z0sXj7+hQmSEWH7N
BgptwNvhNoKWTYo5c8HBsAMvvv1ruSXYKlsRvPBfewHEEo2KgH73SImj2w7a8owq3t0KLVCPP7d4
RXnrXJf6nuXlsvfFFEd6aIN7VjCCAz8wggKooAMCAQICAQ0wDQYJKoZIhvcNAQEFBQAwgdExCzAJ
BgNVBAYTAlpBMRUwEwYDVQQIEwxXZXN0ZXJuIENhcGUxEjAQBgNVBAcTCUNhcGUgVG93bjEaMBgG
A1UEChMRVGhhd3RlIENvbnN1bHRpbmcxKDAmBgNVBAsTH0NlcnRpZmljYXRpb24gU2VydmljZXMg
RGl2aXNpb24xJDAiBgNVBAMTG1RoYXd0ZSBQZXJzb25hbCBGcmVlbWFpbCBDQTErMCkGCSqGSIb3
DQEJARYccGVyc29uYWwtZnJlZW1haWxAdGhhd3RlLmNvbTAeFw0wMzA3MTcwMDAwMDBaFw0xMzA3
MTYyMzU5NTlaMGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQKExxUaGF3dGUgQ29uc3VsdGluZyAoUHR5
KSBMdGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwgRnJlZW1haWwgSXNzdWluZyBDQTCBnzAN
BgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAxKY8VXNV+065yplaHmjAdQRwnd/p/6Me7L3N9VvyGna9
fww6YfK/Uc4B1OVQCjDXAmNaLIkVcI7dyfArhVqqP3FWy688Cwfn8R+RNiQqE88r1fOCdz0Dviv+
uxg+B79AgAJk16emu59l0cUqVIUPSAR/p7bRPGEEQB5kGXJgt/sCAwEAAaOBlDCBkTASBgNVHRMB
Af8ECDAGAQH/AgEAMEMGA1UdHwQ8MDowOKA2oDSGMmh0dHA6Ly9jcmwudGhhd3RlLmNvbS9UaGF3
dGVQZXJzb25hbEZyZWVtYWlsQ0EuY3JsMAsGA1UdDwQEAwIBBjApBgNVHREEIjAgpB4wHDEaMBgG
A1UEAxMRUHJpdmF0ZUxhYmVsMi0xMzgwDQYJKoZIhvcNAQEFBQADgYEASIzRUIPqCy7MDaNmrGcP
f6+svsIXoUOWlJ1/TCG4+DYfqi2fNi/A9BxQIJNwPP2t4WFiw9k6GX6EsZkbAMUaC4J0niVQlGLH
2ydxVyWN3amcOY6MIE9lX5Xa9/eH1sYITq726jTlEBpbNU1341YheILcIRk13iSx0x1G/11fZU8x
ggKPMIICiwIBATB2MGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQKExxUaGF3dGUgQ29uc3VsdGluZyAo
UHR5KSBMdGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwgRnJlZW1haWwgSXNzdWluZyBDQQIQ
XCQb0uBsZ/wW67/mQJdFJzAJBgUrDgMCGgUAoIIBbzAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcB
MBwGCSqGSIb3DQEJBTEPFw0wOTA0MTgxOTM3NjBaMCMGCSqGSIb3DQEJBDEWBBQdi6NS9ZDLXF1r
i3X4UQYrdiv5njCBhQYJKwYBBAGCNxAEMXgwdjBiMQswCQYDVQQGEwJaQTElMCMGA1UEChMcVGhh
d3RlIENvbnN1bHRpbmcgKFB0eSkgTHRkLjEsMCoGA1UEAxMjVGhhd3RlIFBlcnNvbmFsIEZyZWVt
YWlsIElzc3VpbmcgQ0ECEFwkG9LgbGf8Fuu/5kCXRScwgYcGCyqGSIb3DQEJEAILMXigdjBiMQsw
CQYDVQQGEwJaQTElMCMGA1UEChMcVGhhd3RlIENvbnN1bHRpbmcgKFB0eSkgTHRkLjEsMCoGA1UE
AxMjVGhhd3RlIFBlcnNvbmFsIEZyZWVtYWlsIElzc3VpbmcgQ0ECEFwkG9LgbGf8Fuu/5kCXRScw
DQYJKoZIhvcNAQEBBQAEgYB53oYCnLtj0bnnjYYnyFbjBFB3/Sqduh0M5WDg7IlD2HGXvQcEq086
Ay/XHxToqwJ/zjgKOOFfDt1otDzyOhw9fnGXEJq7S2N9SHIU4QaqrogZGYQs9fuUggGmExulqCV5
Zh+gdC+nKMBu/BftqzStoxdfjcO6yzoYGZl+5jX3tAAAAAAAAA==

--Apple-Mail-324--216721769--

From java-user-return-39808-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 19 06:44:41 2009
Return-Path: <java-user-return-39808-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52804 invoked from network); 19 Apr 2009 06:44:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Apr 2009 06:44:41 -0000
Received: (qmail 1672 invoked by uid 500); 19 Apr 2009 06:44:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1581 invoked by uid 500); 19 Apr 2009 06:44:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1571 invoked by uid 99); 19 Apr 2009 06:44:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 06:44:38 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 06:44:30 +0000
Received: by ewy27 with SMTP id 27so1535697ewy.5
        for <java-user@lucene.apache.org>; Sat, 18 Apr 2009 23:44:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=HNYLc3GD1u29vTBFOOl2Q2s4w0bfNKe7/JnyBhRcM1c=;
        b=L7kXFKGfAlQVpq/D+qKEAOEljCjKpfcAaKx1xyQWcKXMN9WyAFhmn5V010F8Ey8ydc
         opcWfS45RJDJl1HPALp/xEz4OXGwM1EvMkvua9ebLwdmnhwg/vNUNuw5iRWvk8RLYhdW
         UtGsmXRmn0YRU2DvyDTMeaqDoqB6BSWemRh7Y=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=BGkrtXsqDQ+XgipNHU7nhwPGOwrsx5/WGT2UIV8l95B+JtkCGSUtS424Z0DugsWrAJ
         5prunum4BZBoz/kB5RNoLLriOs8TDI7JSuSnKZKVHB5PlMHmVAqe0mmY8NTFmaj0Jt5d
         dfBHmg4KOjTXcpR2sB8/XtyacGefAL+o3qk0U=
MIME-Version: 1.0
Received: by 10.210.30.10 with SMTP id d10mr82135ebd.51.1240123449915; Sat, 18 
	Apr 2009 23:44:09 -0700 (PDT)
In-Reply-To: <359a92830904170644l4aa3facbk2a4d6831d9b99ac8@mail.gmail.com>
References: <d36c28c30904160327y55642450v8bcd34faa309dbd1@mail.gmail.com>
	 <d36c28c30904160501t33ca3057sd587655b15ece941@mail.gmail.com>
	 <359a92830904160813m9c1ebe4w23d71d99422e66e0@mail.gmail.com>
	 <d36c28c30904162207x4489ce94l522f1c998c58a8d5@mail.gmail.com>
	 <359a92830904170644l4aa3facbk2a4d6831d9b99ac8@mail.gmail.com>
Date: Sun, 19 Apr 2009 09:44:09 +0300
Message-ID: <d36c28c30904182344v1c45d307me569aaeb06e7c7f1@mail.gmail.com>
Subject: Re: Query scoring
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174bdc70b5bc1e0467e2bda4
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174bdc70b5bc1e0467e2bda4
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

You can see the output below:
**** 1.0 ***** (this is the score)
4817674 5664274 6361333 (query)
4817674 5664274 6361333  (doc 0)
0.0 = (NON-MATCH) product of:
  0.0 = (NON-MATCH) sum of:
  0.0 = coord(0/3)
********************************************************
**** 0.13811989 *****
4817674 5664274 6361333 (query)
5172812 6361333 (doc 1)
0.0 = (NON-MATCH) product of:
  0.0 = (NON-MATCH) sum of:
  0.0 = coord(0/3)
Thanks
2009/4/17 Erick Erickson <erickerickson@gmail.com>

> Well, let's see the results of toString and/or Explain *from your code*.
> Otherwise, you haven't given us much to go on.
>
> Best
> Erick
>
> On Fri, Apr 17, 2009 at 1:07 AM, liat oren <oren.liat@gmail.com> wrote:
>
> > Thanks for the answer.
> >
> > In Luke, I used the WhiteSpaceAnalyzer as well. The scores AND the
> explain
> > method worked perfectly.
> >
> > In my application, I checked for the query - it contains the numbers
> > splitted in different term queries so it prepares it well. Also the
> scoring
> > is good. However the explain shows NO MATCH so all the parts of the
> > calculations are 0. very strange...
> >
> > Best,
> > Liat
> >
> > 2009/4/16 Erick Erickson <erickerickson@gmail.com>
> >
> > > Hmmm, try query.toString() and/or query.explain().
> > >
> > > Also, try using Luke to see what is actually in the document.
> > > BTW, what analyzer did you use in Luke? Luke also has an
> > > explain (tab?) that will show you what Luke does, which may
> > > be useful.
> > >
> > > The default operator should be "OR", but looking at the actual
> > > query should help you figure out whether that's happening.
> > >
> > > Best
> > > Erick
> > >
> > >
> > > On Thu, Apr 16, 2009 at 8:01 AM, liat oren <oren.liat@gmail.com>
> wrote:
> > >
> > > > I wanted to add also that I index it tokenized and that when I use
> Luke
> > > to
> > > > do this search, it gives the correct results.
> > > >
> > > > Should I run the query differntly than the way I do?
> > > >
> > > > 2009/4/16 liat oren <oren.liat@gmail.com>
> > > >
> > > > >  Hi,
> > > > >
> > > > > I try to understand why the following query gives the scoring
> below:
> > > > >
> > > > > document 1 : a b c document 2 : g k a h u c
> > > > >
> > > > >
> > > > > 0.0 = (NON-MATCH) product of:
> > > > >   0.0 = (NON-MATCH) sum of:
> > > > >   0.0 = coord(0/3)
> > > > > 0.06155877
> > > > >
> > > > > The query code is:
> > > > >    IndexSearcher searcher = new IndexSearcher(path);
> > > > >    Analyzer analyzer = new StandardAnalyzer();
> > > > >    QueryParser parser = new QueryParser("text", analyzer);
> > > > >    Query query = parser.parse("g k a h u c");
> > > > >    Hits hits = searcher.search(query);
> > > > > I also tried the WhiteSpaceAnalyzer.
> > > > >
> > > > > Why does it give me "no match"?
> > > > > doesn't if have to do "or" on each of the letters "g k a h u c"?
> > > > >
> > > > > Thanks,
> > > > > Liat
> > > > >
> > > > >
> > > > >
> > > > >
> > > >
> > >
> >
>

--0015174bdc70b5bc1e0467e2bda4--

From java-user-return-39809-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 19 11:39:35 2009
Return-Path: <java-user-return-39809-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29141 invoked from network); 19 Apr 2009 11:39:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Apr 2009 11:39:35 -0000
Received: (qmail 88881 invoked by uid 500); 19 Apr 2009 11:39:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88791 invoked by uid 500); 19 Apr 2009 11:39:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88781 invoked by uid 99); 19 Apr 2009 11:39:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 11:39:32 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 11:39:25 +0000
Received: by ewy27 with SMTP id 27so1597441ewy.5
        for <java-user@lucene.apache.org>; Sun, 19 Apr 2009 04:39:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=ZsG/k92IjICw7mjGEf7y52+h5MZy9rHyW/pyNPIPYZ4=;
        b=p6tqIlSjZ6tNwTGO55OBIbdjIzt/Mi8pphfT6YeRO3PbpoQ1YcXIdO+WhpstkzoO+W
         Kgh02Kc4anF0/HX2fjofYLpOMXz4MKmgnOzkMFuFimzi+KeG4tnF3FllljAR5Le1epfq
         sEyoUPsuAV/DmPWy0R0iL0PmG8A2dITSNRsvo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=GwsySKAoex0uZhNIxcslzsr+GAMCjpPTNK/zCiwiaMwOEE4jiNPyMNLqZvLNRV1m66
         sAN+g9/YEKozo51rLym8Zwqz1k2FlNwpytWdM3LMeVmYiDMHSNwpkNhN08+Z+fxonQaz
         o/Q9RiqUmCG2ZY8otl3ECnCwHceQOGAdQQG14=
MIME-Version: 1.0
Received: by 10.210.90.20 with SMTP id n20mr4676004ebb.40.1240141143280; Sun, 
	19 Apr 2009 04:39:03 -0700 (PDT)
Date: Sun, 19 Apr 2009 14:39:02 +0300
Message-ID: <d36c28c30904190439g477f57e9s52c48ecffca5881e@mail.gmail.com>
Subject: changing term freq in indexing time
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c3f94510e090467e6dc6c
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c3f94510e090467e6dc6c
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

I would like to be able to set the term freq to differnt values at index
time, or at search time.

So if a document has the following text: 1 2, the freq of 1 will get 100 and
the freq of 2 will get 200. I want to avoid expanding it by writing 1 100
times.

I looked at Similarity class and wanted to override it, but the tf function
gets only freq, so I don't know for which term this freq relates to, thus I
can't change the value.

Thanks,
Liat

--0015174c3f94510e090467e6dc6c--

From java-user-return-39810-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 19 12:22:58 2009
Return-Path: <java-user-return-39810-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42912 invoked from network); 19 Apr 2009 12:22:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Apr 2009 12:22:58 -0000
Received: (qmail 13893 invoked by uid 500); 19 Apr 2009 12:22:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13797 invoked by uid 500); 19 Apr 2009 12:22:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13787 invoked by uid 99); 19 Apr 2009 12:22:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 12:22:55 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of radha84@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 12:22:48 +0000
Received: by qw-out-2122.google.com with SMTP id 5so587157qwd.53
        for <java-user@lucene.apache.org>; Sun, 19 Apr 2009 05:22:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=f6qQrHn5gMhebAI/4XfsmNsUBa8r/RiLjf8FjFmLP8I=;
        b=UosqJFuEFsolkRCNqs2EYqU2PjDOfsYiYP0Mq0HiEKcKpubrJ5Oizk5dUIko+R7YlJ
         BasfIWodCaLqG2Nc3EcyvXuLMxgRBxVhvgadOLXBq85qhphoWiRxQyyMxcpUrJfahczM
         KoPCl5Qud+Bca60r+lkJXyniepup6mSTG46/I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=njrARdLgKKjo53vzNQewPtm9BDEOwBQpEvwwVR8Uao07UEt02sGI2T7zstWT+p4E+t
         8Gqw4ZSc8jjUqo4tVNGvdMZsGdnXFYnEcqRSMDvMN0v5rpSjHnBpv8ERjCv+9R8A7OTB
         GEcPdJHXsSneKCWy5O+yNmNhfye8DngpUDOoI=
MIME-Version: 1.0
Received: by 10.220.85.9 with SMTP id m9mr4544023vcl.40.1240143747678; Sun, 19 
	Apr 2009 05:22:27 -0700 (PDT)
Date: Sun, 19 Apr 2009 17:52:27 +0530
Message-ID: <45e5f8bb0904190522v14beed5bx4c18d64c1a234f7f@mail.gmail.com>
Subject: Proximity and Percentage match search in Lucene
From: Radha Sreedharan <radha84@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64756208d01c60467e777ce
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64756208d01c60467e777ce
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

 What I need is  the following :
If my document field is ( ab,bc,cd,ef) and Search tokens are (ab,bc,cd).

 Given the following :
 I should get a hit even if all of the search tokens aren't present
 If the tokens are found they should be found within a distance x of
each other ( proximity
search)
>
> I need the percentage match of the search tokens with the document field.
>
> Currently this is my query :
> 1) I form all possible permutation of the search tokens
> 2) do a spanNearQuery of each permutation
> 3)  Do a DisjunctionMaxQuery on the spannearqueries.
>
> This is how I compute % match  :
> % match =  ( Score by running the query on the document field ) /
> 		( score by running the query on a document field created out of search tokens )
>
> The numerator gives me the actual score with the search tokens run on the field.
> Denominator gives  me the  best possible or maximum possible score with the current search
tokens
>
> For this example << If my document field is ( ab,bc,cd,ef) and Search tokens are
(ab,bc,cd).>> I expect a % match of around 90%.
>
> However I get a match of only around 50% without a boost. Using a boost infact reduces
my percentage.
>
> I even overrode the queryNorm method to return a one, still the percentage did not increase.
*
Is there any way of implementing this using the current set of
implementation classes in Lucene and not making complex changes to the
structure by itself.
( which is what i gather has to be done from the previous replies)

Can anyone suggest an alternative way of implementing this requirement
using the existing bunch of classes in Lucene and not necessarily
using the ones I have used*

--0016e64756208d01c60467e777ce--

From java-user-return-39811-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 19 12:31:13 2009
Return-Path: <java-user-return-39811-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44912 invoked from network); 19 Apr 2009 12:31:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Apr 2009 12:31:13 -0000
Received: (qmail 17386 invoked by uid 500); 19 Apr 2009 12:31:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17295 invoked by uid 500); 19 Apr 2009 12:31:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17285 invoked by uid 99); 19 Apr 2009 12:31:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 12:31:10 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of radha84@gmail.com designates 209.85.221.136 as permitted sender)
Received: from [209.85.221.136] (HELO mail-qy0-f136.google.com) (209.85.221.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 12:31:03 +0000
Received: by qyk42 with SMTP id 42so1796644qyk.29
        for <java-user@lucene.apache.org>; Sun, 19 Apr 2009 05:30:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=V5RrukrL1VY1kgcTS3hO1vcumlUj4lV8DR3kAkhNRvI=;
        b=uC6+rQSVZNjVA+bNtxA04tGfTfjPkIdzgRTqM3DYE2n8Hx6bAeO7NiJ8SWhf1rE8Eb
         miFAxul1ygfDllcQZ4OBRWjug1mJb4jO68KIy0+nNPlEjG8ZeqNsBypqiCyCHmjh9EMk
         /FZ0czQbbACIM9rsgXf6FNcjuun65pKaL9oWE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=xwmrMVIDQ+jP82xy39pxdFqkXs29DxfW30VKIJC8veyEVMi3HBA4AQcp2TWESPvdhe
         YIGyNqfRgyA6WDnQdr/uQ/fv43kD9U5myB6+LX+xzBHXzwfLssjqUThICoGEHuslvTUD
         CJPx8fnzdz7Q4lHYv/eV7io316bpY7H2ZA8Do=
MIME-Version: 1.0
Received: by 10.220.87.1 with SMTP id u1mr4523769vcl.2.1240144242788; Sun, 19 
	Apr 2009 05:30:42 -0700 (PDT)
In-Reply-To: <45e5f8bb0904190522v14beed5bx4c18d64c1a234f7f@mail.gmail.com>
References: <45e5f8bb0904190522v14beed5bx4c18d64c1a234f7f@mail.gmail.com>
Date: Sun, 19 Apr 2009 18:00:42 +0530
Message-ID: <45e5f8bb0904190530p2e5ee0fcu7460fd116a6f6963@mail.gmail.com>
Subject: Fwd: Proximity and Percentage match search in Lucene
From: Radha Sreedharan <radha84@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6469c040fca8b0467e79511
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6469c040fca8b0467e79511
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

 What I need is  the following :
If my document field is ( ab,bc,cd,ef) and Search tokens are (ab,bc,cd).

 Given the following :
 I should get a hit even if all of the search tokens aren't present

 If the tokens are found they should be found within a distance x of
each other ( proximity
search)
>
> I need the percentage match of the search tokens with the document field.
>
> Currently this is my query :

> 1) I form all possible permutation of the search tokens
> 2) do a spanNearQuery of each permutation
> 3)  Do a DisjunctionMaxQuery on the spannearqueries.
>
> This is how I compute % match  :

> % match =  ( Score by running the query on the document field ) /
> 		( score by running the query on a document field created out of search tokens )
>
> The numerator gives me the actual score with the search tokens run on the field.

> Denominator gives  me the  best possible or maximum possible score with the current search
tokens
>
> For this example << If my document field is ( ab,bc,cd,ef) and Search tokens are
(ab,bc,cd).>> I expect a % match of around 90%.

>
> However I get a match of only around 50% without a boost. Using a boost infact reduces
my percentage.
>
> I even overrode the queryNorm method to return a one, still the percentage did not increase.
*
Is there any way of implementing this using the current set of
implementation classes in Lucene and not making complex changes to the
structure by itself.
( which is what i gather has to be done from the previous replies)

Can anyone suggest an alternative way of implementing this requirement
using the existing bunch of classes in Lucene and not necessarily
using the ones I have used*

--0016e6469c040fca8b0467e79511--

From java-user-return-39812-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 19 14:51:09 2009
Return-Path: <java-user-return-39812-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94259 invoked from network); 19 Apr 2009 14:51:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Apr 2009 14:51:09 -0000
Received: (qmail 397 invoked by uid 500); 19 Apr 2009 14:51:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 204 invoked by uid 500); 19 Apr 2009 14:51:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 194 invoked by uid 99); 19 Apr 2009 14:51:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 14:51:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 14:50:56 +0000
Received: by qw-out-2122.google.com with SMTP id 5so607019qwd.53
        for <java-user@lucene.apache.org>; Sun, 19 Apr 2009 07:50:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:content-type
         :content-transfer-encoding;
        bh=+3eZ/EtixwT7ws3lRmIURpIjRtGat0jAbaO1STeLWJ0=;
        b=bdKYxeSKYIvUrsq5PtchkOUmQ/eFgEbRr44ZO5Txi+gf6h5VsbLkHfWP6W4CJeGxxH
         qy+3jMusXmaCxdXSWyQ1hWB2a7Ew2F1+oMcHpV5VKZEarq5/m1ssOLtgODUWK+6L0kmO
         uzdxtTraNDrwHc8oru2qGus4VkkgLuiyUsYXA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :content-type:content-transfer-encoding;
        b=eRurwpyIeqCtqO6QlsSGXw5LEDP7vLa2dLETu30u/XT2QiIdRnXls1W8Hls4TXcaLh
         JRhk6UMo3vY+LwTUoAYlw9ufS5v1KW+FRmWFwkW24mihmTNj11gItEXN79Tej7eOg1Lk
         3/Fk+VnCX8bWLFDooO6ZoUWE9htsMFGp5XGxg=
Received: by 10.224.2.138 with SMTP id 10mr5421431qaj.299.1240152635207;
        Sun, 19 Apr 2009 07:50:35 -0700 (PDT)
Received: from ?192.168.1.120? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 7sm2066961qwf.55.2009.04.19.07.50.34
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 19 Apr 2009 07:50:34 -0700 (PDT)
Message-ID: <49EB3A39.6080303@gmail.com>
Date: Sun, 19 Apr 2009 10:50:33 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.21 (X11/20090409)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Is anybody using setNorm in Production?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Just a curiosity poll. This is a question on the java-dev list that came 
up. Anyone taking advantage of setNorm out there? Care to share how/why?

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39813-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 19 19:06:28 2009
Return-Path: <java-user-return-39813-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70958 invoked from network); 19 Apr 2009 19:06:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Apr 2009 19:06:25 -0000
Received: (qmail 37712 invoked by uid 500); 19 Apr 2009 19:06:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37627 invoked by uid 500); 19 Apr 2009 19:06:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37617 invoked by uid 99); 19 Apr 2009 19:06:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 19:06:22 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of crackeur@comcast.net designates 76.96.27.227 as permitted sender)
Received: from [76.96.27.227] (HELO QMTA12.emeryville.ca.mail.comcast.net) (76.96.27.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 19 Apr 2009 19:06:12 +0000
Received: from OMTA13.emeryville.ca.mail.comcast.net ([76.96.30.52])
	by QMTA12.emeryville.ca.mail.comcast.net with comcast
	id hTAg1b00217UAYkACX5tg5; Sun, 19 Apr 2009 19:05:53 +0000
Received: from sz0167.ev.mail.comcast.net ([76.96.27.96])
	by OMTA13.emeryville.ca.mail.comcast.net with comcast
	id hX5t1b00A24Qqng8ZX5tib; Sun, 19 Apr 2009 19:05:53 +0000
Date: Sun, 19 Apr 2009 19:05:53 +0000 (UTC)
From: crackeur@comcast.net
To: java-user@lucene.apache.org
Message-ID: <931387269.1851971240167953289.JavaMail.root@sz0167a.emeryville.ca.mail.comcast.net>
In-Reply-To: <001f01c9c05b$6b0f94f0$412ebed0$@com>
Subject: Re: Indexing Complex XML
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_91520_259307176.1240167953288"
X-Originating-IP: [24.6.150.25]
X-Mailer: Zimbra 5.0.11_GA_2730.RHEL5_64 (ZimbraWebClient - FF2.0 (Win)/5.0.11_GA_2730.RHEL5_64)
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_91520_259307176.1240167953288
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

try vtd-xml 
http://vtd-xml.sf.net 
it works with any XML regardless of complexity 
----- Original Message ----- 
From: "Digy" <digydigy@gmail.com> 
To: java-user@lucene.apache.org 
Sent: Saturday, April 18, 2009 12:25:21 PM GMT -08:00 US/Canada Pacific 
Subject: RE: Indexing Complex XML 

doc.add(new Field("authors", "name1 surname1 name2 surmane2", StoreOption, 
IndexOption); 

So you can make a search like 
authors:"name1 surname1" 

(Disadvantage: you will also get result with a search like authors:"surname1 
name2" ) 
DIGY 

-----Original Message----- 
From: Daniel Susanto [mailto:daniel_sus777@yahoo.com] 
Sent: Saturday, April 18, 2009 9:09 PM 
To: java-user@lucene.apache.org 
Subject: Re: Indexing Complex XML 

Thanks Erick, 

In more complex xml I mean, for example this xml: 

<root> 
<book> 
<title>Lucene Book</title> 
<authors> 
<author>Book author 1</author> 
<author>Book author 2</author> 
</authors> 
<summary>Book for Lucene</summary> 
</book> 
<book> 

<title>Lucene Book 2</title> 

<authors> 

<author>Book 2 author 1</author> 

<author>Book 2 author 2</author> 


</authors> 

<summary>Book 2 for Lucene</summary> 


</book> 
</root> 

for each 'book' node is handled by one Document rite? and now 
how to handle the 'authors' node? should I put in new Document? or how? 

thx. :) 
Daniel 
Daniel Susanto 
http://susantodaniel.wordpress.com 

--- On Sun, 4/19/09, Erick Erickson <erickerickson@gmail.com> wrote: 

From: Erick Erickson <erickerickson@gmail.com> 
Subject: Re: Indexing Complex XML 
To: java-user@lucene.apache.org 
Date: Sunday, April 19, 2009, 12:01 AM 

Lucene is an *engine*, not an application. *You* have to process the 
XML, decide what the structure of your index is and index the data. There 
are many 
XML parser options, this is just straight Java code. You'll decide 
what's relevant, and add the contents of the relevant elements to a Lucene 
document 
then add that to your index. 

Similarly for searching. 

So, say you have the following simple XML doc 
<root> 
<ele1>ele 1 text</ele1> 
<ele2>ele 2 text</ele2> 
</root> 

You'd have to parse that text, then, say, add (semi-pseudo-code) 
Document doc = new Document() 
doc.add(new Field("ele1field", "ele 1 text", StoreOPtion, IndexOption); 
doc.add(new Field("ele2field", "ele 2 text", StoreOption, IndexOption); 
writer.add(doc); 

Then at search time you'd form your queries on "ele1field" and ele2field". 

HTH 
Erick 

On Sat, Apr 18, 2009 at 11:19 AM, daniel susanto 
<daniel_sus777@yahoo.com>wrote: 

> Hi, 
> 
> I need advise or example to index complex XML file, I mean the XML note 
> just in one level node but more than one. for example indexing rss or 
atom. 
> 
> thx b4. 
> Daniel Susanto 
> http://susantodaniel.wordpress.com 
> 
> 
> 






--------------------------------------------------------------------- 
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org 
For additional commands, e-mail: java-user-help@lucene.apache.org 


------=_Part_91520_259307176.1240167953288--

From java-user-return-39814-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 00:07:25 2009
Return-Path: <java-user-return-39814-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52445 invoked from network); 20 Apr 2009 00:07:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 00:07:25 -0000
Received: (qmail 93578 invoked by uid 500); 20 Apr 2009 00:07:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93492 invoked by uid 500); 20 Apr 2009 00:07:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93482 invoked by uid 99); 20 Apr 2009 00:07:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 00:07:22 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.132.241 as permitted sender)
Received: from [209.85.132.241] (HELO an-out-0708.google.com) (209.85.132.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 00:07:15 +0000
Received: by an-out-0708.google.com with SMTP id b6so125154ana.5
        for <java-user@lucene.apache.org>; Sun, 19 Apr 2009 17:06:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=2NgWz9itFYQrhjumpzU3g7GqZe77dZl+rLjyrYjccDQ=;
        b=LO+5VXkAZLlyNmiVmq7LhvHR33Q9wFIoAVW0ffmYyrKwVoCe+/7nzveHCgewswN5S0
         U+RsHZhc72dEpBzeN2qsXL1iHOGot9FV0JedFE0OwKVZaYpDC8cHIczLUJDU2LwRX5J0
         m6FV41BeK/8sj9aJ04irwMoc4lNZ0UuJOmoi8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=uIzW1EE/NVfvUHgaDrr0NPRPkMerD4fAG9qBb86gl+HYQAgLc34R/dMsHMADOTSF8D
         dzsYMgSg+bQkl8SwMHiYgOK8vyX21MCihSVFXaQOHB+Hs4u7pnRvHq9oOE+0zki2yTL5
         FZGTo5faro1+wP+oLTjBPZYF+RUIXXi2njcyU=
MIME-Version: 1.0
Received: by 10.100.229.12 with SMTP id b12mr1939291anh.26.1240186014709; Sun, 
	19 Apr 2009 17:06:54 -0700 (PDT)
In-Reply-To: <C22E52BD-FA5C-4811-A7E0-7638FB016390@apache.org>
References: <43b459c10903180905s9e5063fo2397cbcfaef5f744@mail.gmail.com>
	 <C22E52BD-FA5C-4811-A7E0-7638FB016390@apache.org>
Date: Sun, 19 Apr 2009 17:06:54 -0700
Message-ID: <8837fb770904191706j7b3190eald00cd10eeb6031c9@mail.gmail.com>
Subject: Re: LocalLucene/Lucene Spatial
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163691fe62dcb77d0467f14e4a
X-Virus-Checked: Checked by ClamAV on apache.org

--00163691fe62dcb77d0467f14e4a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Is there a reason the Query build is from a bitset via a ConstantScoreQuery
instead a RangeQuery? Seems we would be paying a penalty for loading the
bitset, esp the bitset would be rather sparse.

Furthermore, is TrieRangeQuery planning to be somehow used in the spatial
package?

Thanks

-John

On Wed, Mar 18, 2009 at 11:10 AM, Grant Ingersoll <gsingers@apache.org>wrote:

> In the trunk, see contrib/spatial.  I believe it is all committed and being
> worked on by interested contributors:
> http://svn.apache.org/repos/asf/lucene/java/trunk/contrib/spatial/
>
> -Grant
>
>
> On Mar 18, 2009, at 12:05 PM, Jamie Johnson wrote:
>
>  I am working on a project that is already using Lucene (through Hibernate
>> Search) to perform full text queries and have since come across several
>> sites with information about LocalLucene/Lucene Spatial.  I was wondering
>> if
>> there was a timeline for having this work implemented that anyone was
>> aware
>> of?
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00163691fe62dcb77d0467f14e4a--

From java-user-return-39815-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 01:33:48 2009
Return-Path: <java-user-return-39815-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90540 invoked from network); 20 Apr 2009 01:33:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 01:33:47 -0000
Received: (qmail 27656 invoked by uid 500); 20 Apr 2009 01:33:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27559 invoked by uid 500); 20 Apr 2009 01:33:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27549 invoked by uid 99); 20 Apr 2009 01:33:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 01:33:44 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of pjaol@pjaol.com)
Received: from [209.85.217.164] (HELO mail-gx0-f164.google.com) (209.85.217.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 01:33:36 +0000
Received: by gxk8 with SMTP id 8so3780170gxk.5
        for <java-user@lucene.apache.org>; Sun, 19 Apr 2009 18:33:14 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.10.7 with SMTP id n7mr7480458ybi.187.1240191194574; Sun, 
	19 Apr 2009 18:33:14 -0700 (PDT)
In-Reply-To: <8837fb770904191706j7b3190eald00cd10eeb6031c9@mail.gmail.com>
References: <43b459c10903180905s9e5063fo2397cbcfaef5f744@mail.gmail.com>
	 <C22E52BD-FA5C-4811-A7E0-7638FB016390@apache.org>
	 <8837fb770904191706j7b3190eald00cd10eeb6031c9@mail.gmail.com>
Date: Sun, 19 Apr 2009 21:33:14 -0400
Message-ID: <1e33aedb0904191833o6173f455g5be34e475e32ca98@mail.gmail.com>
Subject: Re: LocalLucene/Lucene Spatial
From: "patrick o'leary" <pjaol@pjaol.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd6aefa9b2e7c0467f283cd
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd6aefa9b2e7c0467f283cd
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

1) The only reason for ConstantScoreQuery is because it lets me convert the
LocalLucene filter to a query.

2) TierRangeQuery- not at the moment, we're not really doing a range search,
we're pulling predefined id's (e.g. a shape) from the index using the term
enumerator.

Average time take for a bounding box shape lookup is in the order of 3 to 4
ms, repeating that with a lat / long bounding box, and your looking at 100+
ms. Been there, done that.

As for bitsets, I'm looking at openbitset, but the getDocSetId is causing me
some problems with a QueryWrapperFilter, where I'm intersecting the text
search with the bounding shape
filter pre-distance filter..

The reality is the heaviest part is the DistanceFilter- not the bounding box
part.

On Sun, Apr 19, 2009 at 8:06 PM, John Wang <john.wang@gmail.com> wrote:

> Is there a reason the Query build is from a bitset via a ConstantScoreQuery
> instead a RangeQuery? Seems we would be paying a penalty for loading the
> bitset, esp the bitset would be rather sparse.
>
> Furthermore, is TrieRangeQuery planning to be somehow used in the spatial
> package?
>
> Thanks
>
> -John
>
> On Wed, Mar 18, 2009 at 11:10 AM, Grant Ingersoll <gsingers@apache.org
> >wrote:
>
> > In the trunk, see contrib/spatial.  I believe it is all committed and
> being
> > worked on by interested contributors:
> > http://svn.apache.org/repos/asf/lucene/java/trunk/contrib/spatial/
> >
> > -Grant
> >
> >
> > On Mar 18, 2009, at 12:05 PM, Jamie Johnson wrote:
> >
> >  I am working on a project that is already using Lucene (through
> Hibernate
> >> Search) to perform full text queries and have since come across several
> >> sites with information about LocalLucene/Lucene Spatial.  I was
> wondering
> >> if
> >> there was a timeline for having this work implemented that anyone was
> >> aware
> >> of?
> >>
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--000e0cd6aefa9b2e7c0467f283cd--

From java-user-return-39816-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 03:55:12 2009
Return-Path: <java-user-return-39816-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44789 invoked from network); 20 Apr 2009 03:55:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 03:55:12 -0000
Received: (qmail 18149 invoked by uid 500); 20 Apr 2009 03:55:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18052 invoked by uid 500); 20 Apr 2009 03:55:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18042 invoked by uid 99); 20 Apr 2009 03:55:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 03:55:08 +0000
X-ASF-Spam-Status: No, hits=2.1 required=10.0
	tests=RCVD_BAD_ID,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of goalwisk@snu.ac.kr designates 147.46.10.161 as permitted sender)
Received: from [147.46.10.161] (HELO nabi3.snu.ac.kr) (147.46.10.161)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 03:54:59 +0000
Received: from [147.46.10.146] ([147.46.10.146]) 
          by nabi3.snu.ac.kr ([147.46.10.161]) 
          with ESMTP id 2009042012:54:29:860418.4993.118709152
          for <java-user@lucene.apache.org>; 
          Mon, 20 Apr 2009 12:54:29 +0900 (KST) 
Received: from [147.46.178.146] ([147.46.178.146]) 
          by auk2.snu.ac.kr ([147.46.10.146]) 
          with ESMTP id 2009042012:54:36:556238.12804.2272320432
          for <java-user@lucene.apache.org>; 
          Mon, 20 Apr 2009 12:54:36 +0900 (KST) 
Message-Id: <BEB523EF-8CA7-40C6-B034-B6F94E1BD2A9@snu.ac.kr>
From: kenny kim <goalwisk@snu.ac.kr>
To: java-user@lucene.apache.org
In-Reply-To: <49EB3A39.6080303@gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Is anybody using setNorm in Production?
Date: Mon, 20 Apr 2009 12:54:34 +0900
References: <49EB3A39.6080303@gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-TERRACE-SPAMMARK: NO       (SR:11.31)                     
  (by Terrace)                                                  
X-Virus-Checked: Checked by ClamAV on apache.org

I have used it to adjust norm values of some fields using a custom =20
normalization function which is mixed up of L1 norm and L2 norm.
I traverse all documents again after finishing indexing and set each =20
document's norm value using setNorm.

On 2009. 04. 19, at =EC=98=A4=ED=9B=84 11:50, Mark Miller wrote:

> Just a curiosity poll. This is a question on the java-dev list that =20=

> came up. Anyone taking advantage of setNorm out there? Care to share =20=

> how/why?
>
> --=20
> - Mark
>
> http://www.lucidimagination.com
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>






---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39817-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 09:00:24 2009
Return-Path: <java-user-return-39817-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50815 invoked from network); 20 Apr 2009 09:00:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 09:00:18 -0000
Received: (qmail 68859 invoked by uid 500); 20 Apr 2009 09:00:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68809 invoked by uid 500); 20 Apr 2009 09:00:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68799 invoked by uid 99); 20 Apr 2009 09:00:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 09:00:15 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 09:00:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 6480E51B7C
	for <java-user@lucene.apache.org>; Mon, 20 Apr 2009 10:59:41 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 23527-07 for <java-user@lucene.apache.org>;
 Mon, 20 Apr 2009 10:59:39 +0200 (CEST)
Received: from VEGA (unknown [217.19.45.2])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 3C9D751A8E
	for <java-user@lucene.apache.org>; Mon, 20 Apr 2009 10:59:39 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <43b459c10903180905s9e5063fo2397cbcfaef5f744@mail.gmail.com> <C22E52BD-FA5C-4811-A7E0-7638FB016390@apache.org> <8837fb770904191706j7b3190eald00cd10eeb6031c9@mail.gmail.com> <1e33aedb0904191833o6173f455g5be34e475e32ca98@mail.gmail.com>
Subject: RE: LocalLucene/Lucene Spatial
Date: Mon, 20 Apr 2009 10:59:36 +0200
Message-ID: <38DDCF74B276479288B1774103020787@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
In-Reply-To: <1e33aedb0904191833o6173f455g5be34e475e32ca98@mail.gmail.com>
Thread-index: AcnBWBKXfQhKX4G8TtqQHC33zWE58AAPiNNg
X-Virus-Checked: Checked by ClamAV on apache.org

Have you thought about subclassing MultiTermQuery and provide a
FilteredTermEnum? When you do this, the query can be either BooleanQuery or
a Filter.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: patrick o'leary [mailto:pjaol@pjaol.com]
> Sent: Monday, April 20, 2009 3:33 AM
> To: java-user@lucene.apache.org
> Subject: Re: LocalLucene/Lucene Spatial
> 
> 1) The only reason for ConstantScoreQuery is because it lets me convert
> the
> LocalLucene filter to a query.
> 
> 2) TierRangeQuery- not at the moment, we're not really doing a range
> search,
> we're pulling predefined id's (e.g. a shape) from the index using the term
> enumerator.
> 
> Average time take for a bounding box shape lookup is in the order of 3 to
> 4
> ms, repeating that with a lat / long bounding box, and your looking at
> 100+
> ms. Been there, done that.
> 
> As for bitsets, I'm looking at openbitset, but the getDocSetId is causing
> me
> some problems with a QueryWrapperFilter, where I'm intersecting the text
> search with the bounding shape
> filter pre-distance filter..
> 
> The reality is the heaviest part is the DistanceFilter- not the bounding
> box
> part.
> 
> On Sun, Apr 19, 2009 at 8:06 PM, John Wang <john.wang@gmail.com> wrote:
> 
> > Is there a reason the Query build is from a bitset via a
> ConstantScoreQuery
> > instead a RangeQuery? Seems we would be paying a penalty for loading the
> > bitset, esp the bitset would be rather sparse.
> >
> > Furthermore, is TrieRangeQuery planning to be somehow used in the
> spatial
> > package?
> >
> > Thanks
> >
> > -John
> >
> > On Wed, Mar 18, 2009 at 11:10 AM, Grant Ingersoll <gsingers@apache.org
> > >wrote:
> >
> > > In the trunk, see contrib/spatial.  I believe it is all committed and
> > being
> > > worked on by interested contributors:
> > > http://svn.apache.org/repos/asf/lucene/java/trunk/contrib/spatial/
> > >
> > > -Grant
> > >
> > >
> > > On Mar 18, 2009, at 12:05 PM, Jamie Johnson wrote:
> > >
> > >  I am working on a project that is already using Lucene (through
> > Hibernate
> > >> Search) to perform full text queries and have since come across
> several
> > >> sites with information about LocalLucene/Lucene Spatial.  I was
> > wondering
> > >> if
> > >> there was a timeline for having this work implemented that anyone was
> > >> aware
> > >> of?
> > >>
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39818-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 13:28:01 2009
Return-Path: <java-user-return-39818-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67376 invoked from network); 20 Apr 2009 13:28:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 13:28:01 -0000
Received: (qmail 84303 invoked by uid 500); 20 Apr 2009 13:27:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84218 invoked by uid 500); 20 Apr 2009 13:27:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84205 invoked by uid 99); 20 Apr 2009 13:27:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 13:27:55 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 13:27:47 +0000
Received: by ewy27 with SMTP id 27so1991897ewy.5
        for <java-user@lucene.apache.org>; Mon, 20 Apr 2009 06:27:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=yfplZ0tnGdE+BXdJtQwMdX7wtBy5XMhtKxerE2ppdVY=;
        b=E6sjKSodnCM9GPJITGnZTsitckyUV0k/xgUzAtUA/mAs19eBsp0xRlqmJCT9Whx7kk
         O67Js+WHjWom5m+MP0UoHHJGalubrxerCtdY0h3bq+vPFw3UdwhMo3Cy/pvs7HdYWXYs
         e+NcM3X5ewYttGonnVsZpsqYwNtRegILp3D7U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=PQEwht7xPtdWAPs03F5fXNHSeztjwSMcIBbnTyxP2q+KeOXoOP5I3Hswc9Pv2l14SG
         Zd5DgLXhLngjx1d72raGopJcsHS3JY7Jbg9Ny8CN//TpuNOJrAorcRRj0I+Vs9d+6nmh
         w8PIJJuykOkdgTs8MDq3GUK0Ne1P4GHpsaMvs=
MIME-Version: 1.0
Received: by 10.210.22.16 with SMTP id 16mr3722923ebv.20.1240234046633; Mon, 
	20 Apr 2009 06:27:26 -0700 (PDT)
Date: Mon, 20 Apr 2009 16:27:26 +0300
Message-ID: <d36c28c30904200627m10e831a5n97c5a4e1caddd596@mail.gmail.com>
Subject: Reply to "Search for synonyms - implemenetation for review"
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174be0d0c9c8260467fc7d0d
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174be0d0c9c8260467fc7d0d
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

I saw a very old thread that suggests an implementation for Synonyms that
takes into account differnt weight to differnt synonyms and gives a penalty
factor to synonyms, to avoid getting documents with the synonyms prior to
documents with the original words.
http://mail-archives.apache.org/mod_mbox/lucene-java-user/200603.mbox/%3c39B0FB508E5D7540ACA5AD57225E150D39203D@xmail.me.corp.entopia.com%3e

These advantages touch probkems I try to face (synonyms that got too much
weight)

Is this code part of Lucene now?

Sorry about the 'stupid' question, but how do I use these classes?
There is no SynonymAnalyzer, but only SynonymQuery, where the parser returns
a query object.

Best,
Liat

--0015174be0d0c9c8260467fc7d0d--

From java-user-return-39819-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 13:58:19 2009
Return-Path: <java-user-return-39819-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96357 invoked from network); 20 Apr 2009 13:58:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 13:58:18 -0000
Received: (qmail 20813 invoked by uid 500); 20 Apr 2009 13:58:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20777 invoked by uid 500); 20 Apr 2009 13:58:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20767 invoked by uid 99); 20 Apr 2009 13:58:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 13:58:15 +0000
X-ASF-Spam-Status: No, hits=1.3 required=10.0
	tests=PLING_QUERY,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 13:58:07 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lvu0I-0002Sc-C4
	for java-user@lucene.apache.org; Mon, 20 Apr 2009 06:57:46 -0700
Message-ID: <23137164.post@talk.nabble.com>
Date: Mon, 20 Apr 2009 06:57:46 -0700 (PDT)
From: theDude_2 <aornstein@webmd.net>
To: java-user@lucene.apache.org
Subject: Re: A Challenge!: Combining 2 searches into a single resultset?
In-Reply-To: <49E8B28B.3080402@informatics.jax.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: aornstein@webmd.net
References: <23085506.post@talk.nabble.com> <23098961.post@talk.nabble.com> <1e33aedb0904170751y4ead4a89v33a933991caa3a87@mail.gmail.com> <23099744.post@talk.nabble.com> <1e33aedb0904170832q2e35e7f2jd5ecb3409e04bc5c@mail.gmail.com> <23100423.post@talk.nabble.com> <49E8B28B.3080402@informatics.jax.org>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks!

I wound up indexing both versions in the same index, and boosting the words
that appeared in the "good word" list!

Thanks again for your advice!


Matthew Hall-7 wrote:
> 
> Erm, I likely should have mentioned that this technique requires the use 
> of a MultiFieldQueryParser.
> 
> Matt
> 
> Matthew Hall wrote:
>> If you can build an analyzer that tokenizes the second field so that 
>> it filters out the words you don't want, you can then take advantage 
>> of more intelligent queries as well.
>>
>>
>> So for the example that pjaol wrote, the query would become something 
>> like this:
>>
>> Query= body:(game OR redskins) keyword:(redskins)^10
>>
>> Depending on your corpus this may or may not be possible, the 
>> determining factor being whether or not the list of words being 
>> removed from each document to create the second field varies.
>>
>> (more specifically I mean, in some documents you remove the word game, 
>> and in others you don't, if this is the case this technique won't work 
>> for you.)
>>
>> Matt
>>
>>
>>
>> theDude_2 wrote:
>>> Ah, Interesting... I didnt think of that!  I will try it and report back
>>>
>>>
>>> pjaol wrote:
>>>  
>>>> Why not put the keywords into the same document as another field? and
>>>> search
>>>> both fields
>>>> at once, you can then use lucene syntax to give a boosting to the 
>>>> keyword
>>>> fields.
>>>> e.g.
>>>> body:A good game last night by the redskins
>>>> keyword: redskins
>>>>
>>>> Query= body:(game OR redskins) keyword:(game OR redskins)^10
>>>>
>>>> And adjust the boosting until you're happy.
>>>> Check out for querying multiple fields
>>>> http://wiki.apache.org/lucene-java/LuceneFAQ#head-300f0756fdaa71f522c96a868351f716573f2d77 
>>>>
>>>>
>>>> You might even want to consider Solr and it's dismax search component
>>>> http://wiki.apache.org/solr/DisMaxRequestHandler
>>>> to make it easier
>>>>
>>>>
>>>>
>>>>
>>>> On Fri, Apr 17, 2009 at 11:19 AM, theDude_2 <aornstein@webmd.net> 
>>>> wrote:
>>>>
>>>>    
>>>>> I appreciate your response, and read the wiki article concerning the
>>>>> Federated search
>>>>> and
>>>>>
>>>>> I'm not sure that my project falls into the "Federated Search" 
>>>>> bucket...
>>>>>
>>>>> What I've done is created 2 indexes created with the same documents.
>>>>> One index, contains the full documents - great for pure relevancy 
>>>>> search
>>>>> The second index: contains all of the same documents, but a small 
>>>>> subset
>>>>> of
>>>>> each documents contents - only allowing words to be indexed that we 
>>>>> deem
>>>>> as
>>>>> "good words" -
>>>>>
>>>>> (for example) if this was a football article database
>>>>> Index 1: would index 100% of the article about the Redskins and the 
>>>>> New
>>>>> York
>>>>> Giants
>>>>> Index 2: would index the same article by only the "good words" in the
>>>>> document like Redskins, Giants, Quarterback, Linebacker, etc.
>>>>>
>>>>> What I'm trying to do, if it's even possible! is run the search on 
>>>>> both
>>>>> indexes containing references to the same article, and multiple the
>>>>> scores
>>>>> together to get a final score that would represent something like a
>>>>> "relative AND good word" score....
>>>>>
>>>>> Figuring that if a user searches on "Who is the Quarterback for the
>>>>> Giants"
>>>>> this will get the user an article that is both related to the 
>>>>> query, and
>>>>> deemed "important" to the query...
>>>>>
>>>>> I will look further into federated search and related items, but I 
>>>>> think
>>>>> that lucene probably wont be able to help me with this, am I right?
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> ------------
>>>>>
>>>>> pjaol wrote:
>>>>>      
>>>>>> I'd start by doing some research on the question rather than 
>>>>>> asking for
>>>>>>         
>>>>> a
>>>>>      
>>>>>> solution..
>>>>>> What your asking for can be considered 'Federated Search'
>>>>>> http://en.wikipedia.org/wiki/Federated_search
>>>>>>
>>>>>> And it can be conceived in as many ways as you have document 
>>>>>> types. Any
>>>>>> answer will probably end up
>>>>>> customized and weighted by your document silo value, usually 
>>>>>> companies
>>>>>> weight those by business rules
>>>>>> rather than head down the path of federated search, as it's just
>>>>>>         
>>>>> quicker
>>>>>      
>>>>>> and
>>>>>> cheaper, and you can accomplish more.
>>>>>> e.g
>>>>>> Medication = score *2  (as higher advertising incentives)
>>>>>> Diseases = score
>>>>>> Books = score * 0.75  ( thousands of books, which nobody buys etc..)
>>>>>>
>>>>>> You might also want to try consolidating your data into 1 schema, and
>>>>>> consider layering or collapsing results
>>>>>> based on type.
>>>>>>
>>>>>> P
>>>>>>
>>>>>> On Fri, Apr 17, 2009 at 10:39 AM, theDude_2 <aornstein@webmd.net>
>>>>>>         
>>>>> wrote:
>>>>>      
>>>>>>> (bump) - any thoughts?
>>>>>>> ----
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> theDude_2 wrote:
>>>>>>>          
>>>>>>>> hi!
>>>>>>>>
>>>>>>>> I am trying to do something a little unique...
>>>>>>>>
>>>>>>>> I have a 90k text documents that I am trying to search
>>>>>>>> Search A: indexes and searches the documents using regular 
>>>>>>>> relevancy
>>>>>>>> search
>>>>>>>> Search B: indexes and searches the documents using a smaller subset
>>>>>>>>             
>>>>> of
>>>>>      
>>>>>>>> "key" words that I have chosen
>>>>>>>>
>>>>>>>> This gives me 2 seperate scores: Score A, and Score B...
>>>>>>>>
>>>>>>>> I am trying to show the top 10 results of the scores combined 
>>>>>>>> so....
>>>>>>>>
>>>>>>>> FinalScoretextDoc = (scoreA_of_td1 * 0.5) * (scoreB_of_td1 * 0.5)
>>>>>>>>
>>>>>>>> While it seems straightforward, I do not want to calculate the
>>>>>>>>             
>>>>> scores
>>>>>      
>>>>>>> of
>>>>>>>          
>>>>>>>> all the documents outside of lucene.  How can I integrate this
>>>>>>>>             
>>>>> better
>>>>>      
>>>>>>> into
>>>>>>>          
>>>>>>>> the lucene search engine?  Is this possible to do by any simple
>>>>>>>>             
>>>>> means?
>>>>>      
>>>>>>>> Thanks guys + gals!
>>>>>>>>
>>>>>>>>
>>>>>>>>             
>>>>>>> -- 
>>>>>>> View this message in context:
>>>>>>>
>>>>>>>           
>>>>> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23098961.html 
>>>>>
>>>>>      
>>>>>>> Sent from the Lucene - Java Users mailing list archive at 
>>>>>>> Nabble.com.
>>>>>>>
>>>>>>>
>>>>>>> --------------------------------------------------------------------- 
>>>>>>>
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>
>>>>>>>
>>>>>>>           
>>>>>>         
>>>>> -- 
>>>>> View this message in context:
>>>>> http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23099744.html 
>>>>>
>>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>>       
>>>>     
>>>
>>>   
>>
>>
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/A-Challenge%21%3A-Combining-2-searches-into-a-single-resultset--tp23085506p23137164.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39820-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 14:13:02 2009
Return-Path: <java-user-return-39820-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7495 invoked from network); 20 Apr 2009 14:13:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 14:13:02 -0000
Received: (qmail 45901 invoked by uid 500); 20 Apr 2009 14:12:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45809 invoked by uid 500); 20 Apr 2009 14:12:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45799 invoked by uid 99); 20 Apr 2009 14:12:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:12:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:12:51 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: RE: Faceting, Sort and DocIDSet
Date: Mon, 20 Apr 2009 10:12:21 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2743@mail02.tveyes.com>
In-Reply-To: <23113784.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Faceting, Sort and DocIDSet
thread-index: AcnANiAmzLAQ2skHRxmvVysVhUnJuwBioygg
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC266E@mail02.tveyes.com> <23113784.post@talk.nabble.com>
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Karsten,

My index contains about 100M documents, and I'm trying to count results
on around 300 facets. At the moment I'm keeping a set of cached facet
bitsets and then comparing the query result against those bitsets.
Performance is pretty lousy. It takes more than 2s to calculate the
cardinality of the main query against those 300 facets.

I have two possible datasets to use for the facets. One is an integer
and the other is a short string (about 10 characters).

The taxonomy solution seems interesting but it might be overkill since
there is really no hierarchical relationship between these facets.

I could count the facets manually by implementing a hitcollector, but
the javadocs warn (pretty strenuously) about reading the content of a
document inside a hitcollector. Is this something I should be worried
about, or is it an inevitable part of the solution?

Thanks!

-Dave

-----Original Message-----
From: Karsten F. [mailto:karsten-lucene@fiz-technik.de]=20
Sent: Saturday, April 18, 2009 10:58 AM
To: java-user@lucene.apache.org
Subject: Re: Faceting, Sort and DocIDSet


Hi Dave,

searching and sorting in lucene are two separate functions (if you not
want
to sort by relevance).
You will not loss performance if you first search with BitSet as
HitCollector and then sort the result by DateField.
But more easy is to extend TopFieldDocCollector/TopFieldCollector to a
Collector with facet count.

Sujit Pal's implementation of facet count is a good idea if you have a
small
amount of facets and a lot documents for each facet.

I know half a dozen of implementations of facet browsing.
To choose the best you have to know:
 - How many different values have the facet? Which kind of value
(Integer,
small String, huge String)?
 - More then one value of the facet per document/how many in average?
=20
Possible
http://www.nabble.com/Taxonomy-in-Lucene-td20929487.html
is also interesting for you.

Best regards
  Karsten


David Seltzer wrote:
>=20
> I have a set of indexes, each index contains a month's worth of
> Articles. I need to be able to search the index (sorting by date) and
> then apply access-filters based on the Article Source. I'm also trying
> to get result counts for each Article Source.
> So my questions:=20
> 1) How do I use a HitCollector and sort by a field?=20
> 2) Is using BitSets the wrong way to quickly generate facet counts?
I've
> read about DocIDSets, but I'm not sure how to use them in the same
way.
> (I'm basing my faceting technique on Sujit Pal's article
>
http://sujitpal.blogspot.com/2007/04/lucene-search-within-search-with.ht
> ml)
>=20
> Thanks!
>=20
> -Dave
>=20

--=20
View this message in context:
http://www.nabble.com/Faceting%2C-Sort-and-DocIDSet-tp23099854p23113784.
html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39821-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 14:19:06 2009
Return-Path: <java-user-return-39821-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11819 invoked from network); 20 Apr 2009 14:19:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 14:19:05 -0000
Received: (qmail 60203 invoked by uid 500); 20 Apr 2009 14:19:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60127 invoked by uid 500); 20 Apr 2009 14:19:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60117 invoked by uid 99); 20 Apr 2009 14:19:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:19:03 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of pjaol@pjaol.com)
Received: from [209.85.217.164] (HELO mail-gx0-f164.google.com) (209.85.217.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:18:53 +0000
Received: by gxk8 with SMTP id 8so4220441gxk.5
        for <java-user@lucene.apache.org>; Mon, 20 Apr 2009 07:18:31 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.58.17 with SMTP id g17mr6509990yba.68.1240237111330; Mon, 
	20 Apr 2009 07:18:31 -0700 (PDT)
In-Reply-To: <38DDCF74B276479288B1774103020787@VEGA>
References: <43b459c10903180905s9e5063fo2397cbcfaef5f744@mail.gmail.com>
	 <C22E52BD-FA5C-4811-A7E0-7638FB016390@apache.org>
	 <8837fb770904191706j7b3190eald00cd10eeb6031c9@mail.gmail.com>
	 <1e33aedb0904191833o6173f455g5be34e475e32ca98@mail.gmail.com>
	 <38DDCF74B276479288B1774103020787@VEGA>
Date: Mon, 20 Apr 2009 10:18:31 -0400
Message-ID: <1e33aedb0904200718o777cd31am73f516569e7c18ce@mail.gmail.com>
Subject: Re: LocalLucene/Lucene Spatial
From: "patrick o'leary" <pjaol@pjaol.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd30b527548610467fd3413
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd30b527548610467fd3413
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Honestly I'm more focused on intelligent ways to do faster and more complex
GIS features.
As I said the most time consuming part is the DistainceFilter, which is
required to sort by distance.
I'm playing with several ideas on how to do those better, and get a win
there.

However if anyone wants to jump in and try other improvements feel free.

On Mon, Apr 20, 2009 at 4:59 AM, Uwe Schindler <uwe@thetaphi.de> wrote:

> Have you thought about subclassing MultiTermQuery and provide a
> FilteredTermEnum? When you do this, the query can be either BooleanQuery or
> a Filter.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
> > -----Original Message-----
> > From: patrick o'leary [mailto:pjaol@pjaol.com]
> > Sent: Monday, April 20, 2009 3:33 AM
> > To: java-user@lucene.apache.org
> > Subject: Re: LocalLucene/Lucene Spatial
> >
> > 1) The only reason for ConstantScoreQuery is because it lets me convert
> > the
> > LocalLucene filter to a query.
> >
> > 2) TierRangeQuery- not at the moment, we're not really doing a range
> > search,
> > we're pulling predefined id's (e.g. a shape) from the index using the
> term
> > enumerator.
> >
> > Average time take for a bounding box shape lookup is in the order of 3 to
> > 4
> > ms, repeating that with a lat / long bounding box, and your looking at
> > 100+
> > ms. Been there, done that.
> >
> > As for bitsets, I'm looking at openbitset, but the getDocSetId is causing
> > me
> > some problems with a QueryWrapperFilter, where I'm intersecting the text
> > search with the bounding shape
> > filter pre-distance filter..
> >
> > The reality is the heaviest part is the DistanceFilter- not the bounding
> > box
> > part.
> >
> > On Sun, Apr 19, 2009 at 8:06 PM, John Wang <john.wang@gmail.com> wrote:
> >
> > > Is there a reason the Query build is from a bitset via a
> > ConstantScoreQuery
> > > instead a RangeQuery? Seems we would be paying a penalty for loading
> the
> > > bitset, esp the bitset would be rather sparse.
> > >
> > > Furthermore, is TrieRangeQuery planning to be somehow used in the
> > spatial
> > > package?
> > >
> > > Thanks
> > >
> > > -John
> > >
> > > On Wed, Mar 18, 2009 at 11:10 AM, Grant Ingersoll <gsingers@apache.org
> > > >wrote:
> > >
> > > > In the trunk, see contrib/spatial.  I believe it is all committed and
> > > being
> > > > worked on by interested contributors:
> > > > http://svn.apache.org/repos/asf/lucene/java/trunk/contrib/spatial/
> > > >
> > > > -Grant
> > > >
> > > >
> > > > On Mar 18, 2009, at 12:05 PM, Jamie Johnson wrote:
> > > >
> > > >  I am working on a project that is already using Lucene (through
> > > Hibernate
> > > >> Search) to perform full text queries and have since come across
> > several
> > > >> sites with information about LocalLucene/Lucene Spatial.  I was
> > > wondering
> > > >> if
> > > >> there was a timeline for having this work implemented that anyone
> was
> > > >> aware
> > > >> of?
> > > >>
> > > >
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >
> > >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd30b527548610467fd3413--

From java-user-return-39822-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 14:23:37 2009
Return-Path: <java-user-return-39822-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17627 invoked from network); 20 Apr 2009 14:23:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 14:23:37 -0000
Received: (qmail 73465 invoked by uid 500); 20 Apr 2009 14:23:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73373 invoked by uid 500); 20 Apr 2009 14:23:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73337 invoked by uid 99); 20 Apr 2009 14:23:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:23:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:23:24 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n3KEMo2h014269;
	Mon, 20 Apr 2009 10:22:52 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <49EC853A.5020800@informatics.jax.org>
Date: Mon, 20 Apr 2009 10:22:50 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
CC: "core-user@hadoop.apache.org" <core-user@hadoop.apache.org>,
        "nutch-user@lucene.apache.org" <nutch-user@lucene.apache.org>,
        "solr-user@lucene.apache.org" <solr-user@lucene.apache.org>
Subject: Re: Seattle / PNW Hadoop + Lucene User Group?
References: <860544ed0904161527o4f1bb171x686682f23cb2cf88@mail.gmail.com> <860544ed0904171708v2212115fj4a64d4dbfd5b1ca2@mail.gmail.com> <E8E96088-4555-4099-B28D-CE29FE72F73C@gmail.com>
In-Reply-To: <E8E96088-4555-4099-B28D-CE29FE72F73C@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.5.1.360522, Antispam-Engine: 2.6.1.350677, Antispam-Data: 2009.4.20.141044
X-PerlMx-Spam: Gauge=IIIIIII, Probability=8%, Report='BODY_SIZE_1300_1399 0, BODY_SIZE_2000_LESS 0, BODY_SIZE_5000_LESS 0, BODY_SIZE_7000_LESS 0, TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __CANPHARM_UNSUB_LINK 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __FRAUD_419_BODY_WEBMAIL 0, __FRAUD_419_TINHORN 0, __FRAUD_419_WEBMAIL 0, __HAS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __MOZILLA_MSGID 0, __SANE_MSGID 0, __TO_MALFORMED_2 0, __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

Same here, sadly there isn't much call for Lucene user groups in Maine.  
It would be nice though ^^

Matt

Amin Mohammed-Coleman wrote:
> I would love to come but I'm afraid I'm stuck in rainy old England :(
>
> Amin
>
> On 18 Apr 2009, at 01:08, Bradford Stephens 
> <bradfordstephens@gmail.com> wrote:
>
>> OK, we've got 3 people... that's enough for a party? :)
>>
>> Surely there must be dozens more of you guys out there... c'mon,
>> accelerate your knowledge! Join us in Seattle!
>>
>>
>>
>> On Thu, Apr 16, 2009 at 3:27 PM, Bradford Stephens
>> <bradfordstephens@gmail.com> wrote:
>>> Greetings,
>>>
>>> Would anybody be willing to join a PNW Hadoop and/or Lucene User Group
>>> with me in the Seattle area? I can donate some facilities, etc. -- I
>>> also always have topics to speak about :)
>>>
>>> Cheers,
>>> Bradford
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39823-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 14:27:16 2009
Return-Path: <java-user-return-39823-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21305 invoked from network); 20 Apr 2009 14:27:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 14:27:15 -0000
Received: (qmail 82875 invoked by uid 500); 20 Apr 2009 14:27:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82803 invoked by uid 500); 20 Apr 2009 14:27:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82736 invoked by uid 99); 20 Apr 2009 14:27:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:27:12 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.221.136 as permitted sender)
Received: from [209.85.221.136] (HELO mail-qy0-f136.google.com) (209.85.221.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:27:03 +0000
Received: by qyk42 with SMTP id 42so2418969qyk.29
        for <java-user@lucene.apache.org>; Mon, 20 Apr 2009 07:26:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=FYl/OoHysgN7XZCLG44q3PJBpxOTRxTzyshwc97cYdY=;
        b=pRgHr9aJnJUHdTYqnv8TO/KUfwiWgxPPqLIHf1XKFGIE9Va/ZwzitTQlwTzHjZuYvn
         VvWVax8mEuh+v2mZW3MgsKgug7enkE+BmJrj9zivnVSdcUxQ+Z0r7Vs26dOqxm83d//Z
         jmQ69/n3uU2jKsEOFeTOfYU2JE0lJnK3nJ+4A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Eo7KQwN0zQ8SgiIUBhKnCkAXsWUIxE78wfIDcaaPnPc+zGdCqSKoUPIrIIfyi0ze69
         SizEBNX03ogV3uIt/wYWqccc8AJNbvaeZrtce4SRwEaaVGRk25y1D9J9ekhXap+Xcv7W
         tEFVLc7jo2vxi0bxT4aqr6OUrSfnfjhj/Y/3I=
MIME-Version: 1.0
Received: by 10.229.81.140 with SMTP id x12mr303573qck.35.1240237571791; Mon, 
	20 Apr 2009 07:26:11 -0700 (PDT)
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2743@mail02.tveyes.com>
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC266E@mail02.tveyes.com>
	 <23113784.post@talk.nabble.com>
	 <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2743@mail02.tveyes.com>
Date: Mon, 20 Apr 2009 10:26:11 -0400
Message-ID: <8f0ad1f30904200726n18b00ae7rcd52f629491a8e62@mail.gmail.com>
Subject: Re: Faceting, Sort and DocIDSet
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163631059dec07480467fd4fdd
X-Virus-Checked: Checked by ClamAV on apache.org

--00163631059dec07480467fd4fdd
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

David,

One suggestion I have for your large index. Is it possible to index these
documents ordered by Date? (and ingest new docs in Date order?)

This way index order = Date order, you can do this sort very quickly by
using Sort.INDEXORDER

with huge indexes I try to see if there's a way i can have the index sorted
in some meaningful way so I can use this trick for the most common sort
case.

hope this helps,
Robert

On Mon, Apr 20, 2009 at 10:12 AM, David Seltzer <dseltzer@tveyes.com> wrote:

> Hi Karsten,
>
> My index contains about 100M documents, and I'm trying to count results
> on around 300 facets. At the moment I'm keeping a set of cached facet
> bitsets and then comparing the query result against those bitsets.
> Performance is pretty lousy. It takes more than 2s to calculate the
> cardinality of the main query against those 300 facets.
>
> I have two possible datasets to use for the facets. One is an integer
> and the other is a short string (about 10 characters).
>
> The taxonomy solution seems interesting but it might be overkill since
> there is really no hierarchical relationship between these facets.
>
> I could count the facets manually by implementing a hitcollector, but
> the javadocs warn (pretty strenuously) about reading the content of a
> document inside a hitcollector. Is this something I should be worried
> about, or is it an inevitable part of the solution?
>
> Thanks!
>
> -Dave
>
> -----Original Message-----
> From: Karsten F. [mailto:karsten-lucene@fiz-technik.de]
> Sent: Saturday, April 18, 2009 10:58 AM
> To: java-user@lucene.apache.org
> Subject: Re: Faceting, Sort and DocIDSet
>
>
> Hi Dave,
>
> searching and sorting in lucene are two separate functions (if you not
> want
> to sort by relevance).
> You will not loss performance if you first search with BitSet as
> HitCollector and then sort the result by DateField.
> But more easy is to extend TopFieldDocCollector/TopFieldCollector to a
> Collector with facet count.
>
> Sujit Pal's implementation of facet count is a good idea if you have a
> small
> amount of facets and a lot documents for each facet.
>
> I know half a dozen of implementations of facet browsing.
> To choose the best you have to know:
>  - How many different values have the facet? Which kind of value
> (Integer,
> small String, huge String)?
>  - More then one value of the facet per document/how many in average?
>
> Possible
> http://www.nabble.com/Taxonomy-in-Lucene-td20929487.html
> is also interesting for you.
>
> Best regards
>  Karsten
>
>
> David Seltzer wrote:
> >
> > I have a set of indexes, each index contains a month's worth of
> > Articles. I need to be able to search the index (sorting by date) and
> > then apply access-filters based on the Article Source. I'm also trying
> > to get result counts for each Article Source.
> > So my questions:
> > 1) How do I use a HitCollector and sort by a field?
> > 2) Is using BitSets the wrong way to quickly generate facet counts?
> I've
> > read about DocIDSets, but I'm not sure how to use them in the same
> way.
> > (I'm basing my faceting technique on Sujit Pal's article
> >
> http://sujitpal.blogspot.com/2007/04/lucene-search-within-search-with.ht
> > ml)
> >
> > Thanks!
> >
> > -Dave
> >
>
> --
> View this message in context:
> http://www.nabble.com/Faceting%2C-Sort-and-DocIDSet-tp23099854p23113784.
> html<http://www.nabble.com/Faceting%2C-Sort-and-DocIDSet-tp23099854p23113784.%0Ahtml>
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Robert Muir
rcmuir@gmail.com

--00163631059dec07480467fd4fdd--

From java-user-return-39824-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 14:45:18 2009
Return-Path: <java-user-return-39824-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34861 invoked from network); 20 Apr 2009 14:45:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 14:45:18 -0000
Received: (qmail 23238 invoked by uid 500); 20 Apr 2009 14:45:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23128 invoked by uid 500); 20 Apr 2009 14:45:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23105 invoked by uid 99); 20 Apr 2009 14:45:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:45:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [69.55.225.129] (HELO ehatchersolutions.com) (69.55.225.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:45:03 +0000
Received: by ehatchersolutions.com (Postfix, from userid 504)
	id 6BF2830EFC11; Mon, 20 Apr 2009 08:44:42 -0600 (MDT)
X-Spam-Checker-Version: SpamAssassin 3.1.1 (2006-03-10) on javelina
X-Spam-Level: 
Received: from [10.0.1.193] (unknown [138.210.8.79])
	by ehatchersolutions.com (Postfix) with ESMTP id 03F6B30EFC11;
	Mon, 20 Apr 2009 08:44:39 -0600 (MDT)
Message-Id: <87267F7D-A8FA-4A29-B9CD-81F206A6D72B@ehatchersolutions.com>
From: Erik Hatcher <erik@ehatchersolutions.com>
To: solr-user@lucene.apache.org,
 general@lucene.apache.org,
 java-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Subject: Solr webinar
Mime-Version: 1.0 (Apple Message framework v930.3)
Date: Mon, 20 Apr 2009 10:44:38 -0400
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham 
	version=3.1.1

(excuse the cross-post)

I'm presenting a webinar on Solr.  Registration is limited, so sign up  
soon.  Looking forward to "seeing" some of you there!

Thanks,
	Erik


"Got data? You can build your own Solr-powered Search Engine!"

Erik Hatcher, Lucene/Solr Committer and author, will show you how you  
how to use Solr to build an Enterprise Search engine that indexes a  
variety data sources all in a matter of minutes!

Thursday, April 30, 2009
11:00AM - 12:00PM PDT / 2:00PM - 3:00PM EDT

Sign up for this free webinar today at
http://www2.eventsvc.com/lucidimagination/?trk=E1

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39825-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 14:54:25 2009
Return-Path: <java-user-return-39825-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41112 invoked from network); 20 Apr 2009 14:54:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 14:54:25 -0000
Received: (qmail 40595 invoked by uid 500); 20 Apr 2009 14:54:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40560 invoked by uid 500); 20 Apr 2009 14:54:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40550 invoked by uid 99); 20 Apr 2009 14:54:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:54:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 14:54:14 +0000
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
x-cr-puzzleid: {B4FC46CF-1DF4-432E-ABE6-A2241D7C2266}
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
Subject: RE: Faceting, Sort and DocIDSet
x-cr-hashedpuzzle: AN1g AR9F Au9M BWL9 BXDS CRe1 C1WE FdWs F/fL GW6b GolN I4Ka JTwl Jghu JwsS KCNE;1;agBhAHYAYQAtAHUAcwBlAHIAQABsAHUAYwBlAG4AZQAuAGEAcABhAGMAaABlAC4AbwByAGcA;Sosha1_v1;7;{B4FC46CF-1DF4-432E-ABE6-A2241D7C2266};ZABzAGUAbAB0AHoAZQByAEAAdAB2AGUAeQBlAHMALgBjAG8AbQA=;Mon, 20 Apr 2009 14:53:49 GMT;UgBFADoAIABGAGEAYwBlAHQAaQBuAGcALAAgAFMAbwByAHQAIABhAG4AZAAgAEQAbwBjAEkARABTAGUAdAA=
Date: Mon, 20 Apr 2009 10:53:49 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2762@mail02.tveyes.com>
In-Reply-To: <8f0ad1f30904200726n18b00ae7rcd52f629491a8e62@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Faceting, Sort and DocIDSet
thread-index: AcnBxBp0/o2/BGdjQM27moyMryGzsgAAwDlg
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC266E@mail02.tveyes.com> <23113784.post@talk.nabble.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2743@mail02.tveyes.com> <8f0ad1f30904200726n18b00ae7rcd52f629491a8e62@mail.gmail.com>
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Um9iZXJ0LA0KDQo5OSUgb2YgdGhlIGRvY3VtZW50cyBhcmUgaW5zZXJ0ZWQgYXMgc29vbiBhcyB3
ZSBkaXNjb3ZlciB0aGVtLCBzbyB0aGUgSU5ERVhPUkRFUiBpcyBsYXJnZWx5IGNvcnJlY3QuIEhv
d2V2ZXIsIHR3byBmYWN0b3JzIGtlZXAgbWUgZnJvbSB1c2luZyBJTkRFWE9SREVSLiBUaGUgZmly
c3QgaXMgdGhhdCBhIHNtYWxsIHBvcnRpb24gb2Ygb3VyIHJlY29yZHMgKDElKSBlbnRlciB0aGUg
aW5kZXggbGF0ZSAoc28gdGhleSBhcHBlYXIgb3V0IG9mIG9yZGVyIHdpdGggcmVzcGVjdCB0byB0
aGUgb3RoZXIgOTklIG9mIHRoZSBpbmRleCkuIFRoZSBvdGhlciBmYWN0b3IgaXMgdGhhdCB3ZSB1
c2UgYSBQYXJhbGxlbE11bHRpU2VhcmNoZXIgdG8gc2VhcmNoIHNldmVyYWwgbW9udGgtbG9uZyBp
bmRleGVzLiBJbiB0aGlzIHNjZW5hcmlvLCBJJ20gbm90IHN1cmUgd2hhdCBJTkRFWE9SREVSIG1l
YW5zLg0KDQpJcyBJTkRFWE9SREVSIGJhc2VkIG9uIHRoZSBEb2N1bWVudElEIHdpdGhpbiBlYWNo
IGluZGl2aWR1YWwgaW5kZXg/IElmIHNvIHRoZW4gdGhlIHJlc3VsdHMgY291bGQgYmUgaW50ZXJs
ZWF2ZWQuIEFueW9uZSBrbm93IGhvdyB0aGlzIGJlaGF2ZXM/DQoNClRoYW5rcywNCg0KLURhdmUN
Cg0KLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCkZyb206IFJvYmVydCBNdWlyIFttYWlsdG86
cmNtdWlyQGdtYWlsLmNvbV0gDQpTZW50OiBNb25kYXksIEFwcmlsIDIwLCAyMDA5IDEwOjI2IEFN
DQpUbzogamF2YS11c2VyQGx1Y2VuZS5hcGFjaGUub3JnDQpTdWJqZWN0OiBSZTogRmFjZXRpbmcs
IFNvcnQgYW5kIERvY0lEU2V0DQoNCkRhdmlkLA0KDQpPbmUgc3VnZ2VzdGlvbiBJIGhhdmUgZm9y
IHlvdXIgbGFyZ2UgaW5kZXguIElzIGl0IHBvc3NpYmxlIHRvIGluZGV4IHRoZXNlDQpkb2N1bWVu
dHMgb3JkZXJlZCBieSBEYXRlPyAoYW5kIGluZ2VzdCBuZXcgZG9jcyBpbiBEYXRlIG9yZGVyPykN
Cg0KVGhpcyB3YXkgaW5kZXggb3JkZXIgPSBEYXRlIG9yZGVyLCB5b3UgY2FuIGRvIHRoaXMgc29y
dCB2ZXJ5IHF1aWNrbHkgYnkNCnVzaW5nIFNvcnQuSU5ERVhPUkRFUg0KDQp3aXRoIGh1Z2UgaW5k
ZXhlcyBJIHRyeSB0byBzZWUgaWYgdGhlcmUncyBhIHdheSBpIGNhbiBoYXZlIHRoZSBpbmRleCBz
b3J0ZWQNCmluIHNvbWUgbWVhbmluZ2Z1bCB3YXkgc28gSSBjYW4gdXNlIHRoaXMgdHJpY2sgZm9y
IHRoZSBtb3N0IGNvbW1vbiBzb3J0DQpjYXNlLg0KDQpob3BlIHRoaXMgaGVscHMsDQpSb2JlcnQN
Cg0KT24gTW9uLCBBcHIgMjAsIDIwMDkgYXQgMTA6MTIgQU0sIERhdmlkIFNlbHR6ZXIgPGRzZWx0
emVyQHR2ZXllcy5jb20+IHdyb3RlOg0KDQo+IEhpIEthcnN0ZW4sDQo+DQo+IE15IGluZGV4IGNv
bnRhaW5zIGFib3V0IDEwME0gZG9jdW1lbnRzLCBhbmQgSSdtIHRyeWluZyB0byBjb3VudCByZXN1
bHRzDQo+IG9uIGFyb3VuZCAzMDAgZmFjZXRzLiBBdCB0aGUgbW9tZW50IEknbSBrZWVwaW5nIGEg
c2V0IG9mIGNhY2hlZCBmYWNldA0KPiBiaXRzZXRzIGFuZCB0aGVuIGNvbXBhcmluZyB0aGUgcXVl
cnkgcmVzdWx0IGFnYWluc3QgdGhvc2UgYml0c2V0cy4NCj4gUGVyZm9ybWFuY2UgaXMgcHJldHR5
IGxvdXN5LiBJdCB0YWtlcyBtb3JlIHRoYW4gMnMgdG8gY2FsY3VsYXRlIHRoZQ0KPiBjYXJkaW5h
bGl0eSBvZiB0aGUgbWFpbiBxdWVyeSBhZ2FpbnN0IHRob3NlIDMwMCBmYWNldHMuDQo+DQo+IEkg
aGF2ZSB0d28gcG9zc2libGUgZGF0YXNldHMgdG8gdXNlIGZvciB0aGUgZmFjZXRzLiBPbmUgaXMg
YW4gaW50ZWdlcg0KPiBhbmQgdGhlIG90aGVyIGlzIGEgc2hvcnQgc3RyaW5nIChhYm91dCAxMCBj
aGFyYWN0ZXJzKS4NCj4NCj4gVGhlIHRheG9ub215IHNvbHV0aW9uIHNlZW1zIGludGVyZXN0aW5n
IGJ1dCBpdCBtaWdodCBiZSBvdmVya2lsbCBzaW5jZQ0KPiB0aGVyZSBpcyByZWFsbHkgbm8gaGll
cmFyY2hpY2FsIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHRoZXNlIGZhY2V0cy4NCj4NCj4gSSBjb3Vs
ZCBjb3VudCB0aGUgZmFjZXRzIG1hbnVhbGx5IGJ5IGltcGxlbWVudGluZyBhIGhpdGNvbGxlY3Rv
ciwgYnV0DQo+IHRoZSBqYXZhZG9jcyB3YXJuIChwcmV0dHkgc3RyZW51b3VzbHkpIGFib3V0IHJl
YWRpbmcgdGhlIGNvbnRlbnQgb2YgYQ0KPiBkb2N1bWVudCBpbnNpZGUgYSBoaXRjb2xsZWN0b3Iu
IElzIHRoaXMgc29tZXRoaW5nIEkgc2hvdWxkIGJlIHdvcnJpZWQNCj4gYWJvdXQsIG9yIGlzIGl0
IGFuIGluZXZpdGFibGUgcGFydCBvZiB0aGUgc29sdXRpb24/DQo+DQo+IFRoYW5rcyENCj4NCj4g
LURhdmUNCj4NCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogS2Fyc3RlbiBG
LiBbbWFpbHRvOmthcnN0ZW4tbHVjZW5lQGZpei10ZWNobmlrLmRlXQ0KPiBTZW50OiBTYXR1cmRh
eSwgQXByaWwgMTgsIDIwMDkgMTA6NTggQU0NCj4gVG86IGphdmEtdXNlckBsdWNlbmUuYXBhY2hl
Lm9yZw0KPiBTdWJqZWN0OiBSZTogRmFjZXRpbmcsIFNvcnQgYW5kIERvY0lEU2V0DQo+DQo+DQo+
IEhpIERhdmUsDQo+DQo+IHNlYXJjaGluZyBhbmQgc29ydGluZyBpbiBsdWNlbmUgYXJlIHR3byBz
ZXBhcmF0ZSBmdW5jdGlvbnMgKGlmIHlvdSBub3QNCj4gd2FudA0KPiB0byBzb3J0IGJ5IHJlbGV2
YW5jZSkuDQo+IFlvdSB3aWxsIG5vdCBsb3NzIHBlcmZvcm1hbmNlIGlmIHlvdSBmaXJzdCBzZWFy
Y2ggd2l0aCBCaXRTZXQgYXMNCj4gSGl0Q29sbGVjdG9yIGFuZCB0aGVuIHNvcnQgdGhlIHJlc3Vs
dCBieSBEYXRlRmllbGQuDQo+IEJ1dCBtb3JlIGVhc3kgaXMgdG8gZXh0ZW5kIFRvcEZpZWxkRG9j
Q29sbGVjdG9yL1RvcEZpZWxkQ29sbGVjdG9yIHRvIGENCj4gQ29sbGVjdG9yIHdpdGggZmFjZXQg
Y291bnQuDQo+DQo+IFN1aml0IFBhbCdzIGltcGxlbWVudGF0aW9uIG9mIGZhY2V0IGNvdW50IGlz
IGEgZ29vZCBpZGVhIGlmIHlvdSBoYXZlIGENCj4gc21hbGwNCj4gYW1vdW50IG9mIGZhY2V0cyBh
bmQgYSBsb3QgZG9jdW1lbnRzIGZvciBlYWNoIGZhY2V0Lg0KPg0KPiBJIGtub3cgaGFsZiBhIGRv
emVuIG9mIGltcGxlbWVudGF0aW9ucyBvZiBmYWNldCBicm93c2luZy4NCj4gVG8gY2hvb3NlIHRo
ZSBiZXN0IHlvdSBoYXZlIHRvIGtub3c6DQo+ICAtIEhvdyBtYW55IGRpZmZlcmVudCB2YWx1ZXMg
aGF2ZSB0aGUgZmFjZXQ/IFdoaWNoIGtpbmQgb2YgdmFsdWUNCj4gKEludGVnZXIsDQo+IHNtYWxs
IFN0cmluZywgaHVnZSBTdHJpbmcpPw0KPiAgLSBNb3JlIHRoZW4gb25lIHZhbHVlIG9mIHRoZSBm
YWNldCBwZXIgZG9jdW1lbnQvaG93IG1hbnkgaW4gYXZlcmFnZT8NCj4NCj4gUG9zc2libGUNCj4g
aHR0cDovL3d3dy5uYWJibGUuY29tL1RheG9ub215LWluLUx1Y2VuZS10ZDIwOTI5NDg3Lmh0bWwN
Cj4gaXMgYWxzbyBpbnRlcmVzdGluZyBmb3IgeW91Lg0KPg0KPiBCZXN0IHJlZ2FyZHMNCj4gIEth
cnN0ZW4NCj4NCj4NCj4gRGF2aWQgU2VsdHplciB3cm90ZToNCj4gPg0KPiA+IEkgaGF2ZSBhIHNl
dCBvZiBpbmRleGVzLCBlYWNoIGluZGV4IGNvbnRhaW5zIGEgbW9udGgncyB3b3J0aCBvZg0KPiA+
IEFydGljbGVzLiBJIG5lZWQgdG8gYmUgYWJsZSB0byBzZWFyY2ggdGhlIGluZGV4IChzb3J0aW5n
IGJ5IGRhdGUpIGFuZA0KPiA+IHRoZW4gYXBwbHkgYWNjZXNzLWZpbHRlcnMgYmFzZWQgb24gdGhl
IEFydGljbGUgU291cmNlLiBJJ20gYWxzbyB0cnlpbmcNCj4gPiB0byBnZXQgcmVzdWx0IGNvdW50
cyBmb3IgZWFjaCBBcnRpY2xlIFNvdXJjZS4NCj4gPiBTbyBteSBxdWVzdGlvbnM6DQo+ID4gMSkg
SG93IGRvIEkgdXNlIGEgSGl0Q29sbGVjdG9yIGFuZCBzb3J0IGJ5IGEgZmllbGQ/DQo+ID4gMikg
SXMgdXNpbmcgQml0U2V0cyB0aGUgd3Jvbmcgd2F5IHRvIHF1aWNrbHkgZ2VuZXJhdGUgZmFjZXQg
Y291bnRzPw0KPiBJJ3ZlDQo+ID4gcmVhZCBhYm91dCBEb2NJRFNldHMsIGJ1dCBJJ20gbm90IHN1
cmUgaG93IHRvIHVzZSB0aGVtIGluIHRoZSBzYW1lDQo+IHdheS4NCj4gPiAoSSdtIGJhc2luZyBt
eSBmYWNldGluZyB0ZWNobmlxdWUgb24gU3VqaXQgUGFsJ3MgYXJ0aWNsZQ0KPiA+DQo+IGh0dHA6
Ly9zdWppdHBhbC5ibG9nc3BvdC5jb20vMjAwNy8wNC9sdWNlbmUtc2VhcmNoLXdpdGhpbi1zZWFy
Y2gtd2l0aC5odA0KPiA+IG1sKQ0KPiA+DQo+ID4gVGhhbmtzIQ0KPiA+DQo+ID4gLURhdmUNCj4g
Pg0KPg0KPiAtLQ0KPiBWaWV3IHRoaXMgbWVzc2FnZSBpbiBjb250ZXh0Og0KPiBodHRwOi8vd3d3
Lm5hYmJsZS5jb20vRmFjZXRpbmclMkMtU29ydC1hbmQtRG9jSURTZXQtdHAyMzA5OTg1NHAyMzEx
Mzc4NC4NCj4gaHRtbDxodHRwOi8vd3d3Lm5hYmJsZS5jb20vRmFjZXRpbmclMkMtU29ydC1hbmQt
RG9jSURTZXQtdHAyMzA5OTg1NHAyMzExMzc4NC4lMEFodG1sPg0KPiBTZW50IGZyb20gdGhlIEx1
Y2VuZSAtIEphdmEgVXNlcnMgbWFpbGluZyBsaXN0IGFyY2hpdmUgYXQgTmFiYmxlLmNvbS4NCj4N
Cj4NCj4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tDQo+IFRvIHVuc3Vic2NyaWJlLCBlLW1haWw6IGphdmEtdXNlci11
bnN1YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZw0KPiBGb3IgYWRkaXRpb25hbCBjb21tYW5kcywg
ZS1tYWlsOiBqYXZhLXVzZXItaGVscEBsdWNlbmUuYXBhY2hlLm9yZw0KPg0KPg0KPiAtLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0NCj4gVG8gdW5zdWJzY3JpYmUsIGUtbWFpbDogamF2YS11c2VyLXVuc3Vic2NyaWJlQGx1
Y2VuZS5hcGFjaGUub3JnDQo+IEZvciBhZGRpdGlvbmFsIGNvbW1hbmRzLCBlLW1haWw6IGphdmEt
dXNlci1oZWxwQGx1Y2VuZS5hcGFjaGUub3JnDQo+DQo+DQoNCg0KLS0gDQpSb2JlcnQgTXVpcg0K
cmNtdWlyQGdtYWlsLmNvbQ0K


From java-user-return-39826-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 15:40:55 2009
Return-Path: <java-user-return-39826-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59899 invoked from network); 20 Apr 2009 15:40:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 15:40:55 -0000
Received: (qmail 26650 invoked by uid 500); 20 Apr 2009 15:40:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26552 invoked by uid 500); 20 Apr 2009 15:40:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26542 invoked by uid 99); 20 Apr 2009 15:40:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 15:40:52 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [151.190.254.12] (HELO edge.itt.com) (151.190.254.12)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 15:40:44 +0000
Received: from fwexhub4.itt.net (10.32.76.114) by edge.itt.com (10.32.16.12)
 with Microsoft SMTP Server (TLS) id 8.1.340.0; Mon, 20 Apr 2009 11:25:28
 -0400
Received: from IIWCBO-EHUB1.iiw.de.ittind.com (10.244.2.24) by
 fwexhub4.itt.net (10.32.76.114) with Microsoft SMTP Server (TLS) id
 8.1.340.0; Mon, 20 Apr 2009 11:40:22 -0400
Received: from iiwcbo-emb1.iiw.de.ittind.com ([10.244.2.29]) by
 IIWCBO-Ehub1.iiw.de.ittind.com ([::1]) with mapi; Mon, 20 Apr 2009 11:40:21
 -0400
From: "Newman, Billy" <Billy.Newman@itt.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 20 Apr 2009 11:40:19 -0400
Subject: RE: IndexWriter update method
Thread-Topic: IndexWriter update method
Thread-Index: Acm/yo7+yZRUASqvTk+8hwfHBz+OtwB8ZHGw
Message-ID: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D368AB230@IIWCBO-EMB1.iiw.de.ittind.com>
References: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79B@IIWCBO-EMB1.iiw.de.ittind.com>
	 <499888440904171705s467e3bap95598f3f870c20b3@mail.gmail.com>
	 <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79D@IIWCBO-EMB1.iiw.de.ittind.com>
 <359a92830904171907j2b8fdb91kbd762c905240b3df@mail.gmail.com>
In-Reply-To: <359a92830904171907j2b8fdb91kbd762c905240b3df@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

What if you're unique id is a composite of two field when you create the do=
cument?

I.E.
doc.add(new Field("partno", "123345",
Field.Store.whatever, Field.Index.UN_TOKENIZED);
doc.add(new Field("storeLoc", "Springfield",
Field.Store.whatever, Field.Index.UN_TOKENIZED);

How do you create a Term for this?  Is this possible?  Is this the correct =
way to create a document that has two fields?  If so I am a little lost on =
how to create a term to correctly find this.

Thanks,
Billy

-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]=20
Sent: Friday, April 17, 2009 8:08 PM
To: java-user@lucene.apache.org
Subject: Re: IndexWriter update method

What you're missing is that the example has no unique ID, it wasn't created
with update in mind.

There's no hidden magic for Lucene knowing *what* document you want
to have updated, you have to provide it yourself, and it should be unique.

Imagine a parts catalog, or an index of a directory tree. In the parts
catalog,
you could identify the document by its part number, so you'd probably index
it something like doc.add(new Field("partno", "123345",
Field.Store.whatever, Field.Index.UN_TOKENIZED);
Indexing a directory tree you could use the complete file path similarly.

Now, each document will have one (and only one) partno, and it'll be unique
(you really
don't want to tokenize this).

To update, you'd form your term on the field "partno" and value "123345",
thus uniquely
identifying the document you want replaced, and use that term in your updat=
e
statement.
Think of the Term as a unique key for the document that *you've*
deliberately put there.

I'm pretty sure (but not positive) that if you update a document where the
term doesn't
have any matches, you'll get a simple insert, but I won't guarantee it.

HTH
Erick


On Fri, Apr 17, 2009 at 9:28 PM, Newman, Billy <Billy.Newman@itt.com> wrote=
:

> Ok I am still confused.
>
> Looking at the examples to index a document I would do something like the
> following:
>        Document document =3D new Document();
>        document.add(Field.UnStored("article", article));
>        document.add(Field.Text("comments", comments));
>        Analyzer analyzer  =3D new StandardAnalyzer();
>        IndexWriter writer =3D new IndexWriter(indexDirectory, analyzer,
> false);
>        writer.addDocument(document);
>        writer.optimize();
>        writer.close();
>
> Now lets say that the comments can change and when they do I want to upda=
te
> that document to contain the newly updated comments.
>
> So I would have to go back and check my index to see if that book already
> exists.
> Query q =3D new QueryParser("article", analyzer).parse(querystr);
> int hitsPerPage =3D 10;
> IndexSearcher searcher =3D new IndexSearcher(index);
> TopDocCollector collector =3D new TopDocCollector(hitsPerPage);
> searcher.search(q, collector);
> ScoreDoc[] hits =3D collector.topDocs().scoreDocs;
> if (hits!=3D null && hits.length > 0) {
>  // ?
>  // Then this already exists and I just want to update the comments secti=
on
> }
>
> Does that make sense?  Am I going about this wrong?
>
> Billy
>
>
> ________________________________________
> From: Tim Williams [williamstw@gmail.com]
> Sent: Friday, April 17, 2009 6:05 PM
> To: java-user@lucene.apache.org
> Subject: Re: IndexWriter update method
>
> On Fri, Apr 17, 2009 at 7:27 PM, Newman, Billy <Billy.Newman@itt.com>
> wrote:
> > I am looking for info on how to use the IndexWriter.update method.  A
> short example of how to add a document and then later update would
> > be very helpful.  I get lost because I can add a document with just the
> document, but I need a document and a Term.  I am not really sure
> > what a Term is since I did not use a Term to create the document nor do=
 I
> see it in any of the examples of searching/adding.
>
> When you index the document, add an ID field that is unique.  Then
> when you go to update the document the "Term" will be the ID of the
> document you wish to update.  For example, you might add a URL as the
> unique ID, then to update it might look something like:
>
> writer.update(new Term("id","http://apache.org/lucene/index.htm"), doc)
>
>
> --tim
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> This e-mail and any files transmitted with it may be proprietary and are
> intended solely for the use of the individual or entity to whom they are
> addressed. If you have received this e-mail in error please notify the
> sender.
> Please note that any views or opinions presented in this e-mail are solel=
y
> those of the author and do not necessarily represent those of ITT
> Corporation. The recipient should check this e-mail and any attachments f=
or
> the presence of viruses. ITT accepts no liability for any damage caused b=
y
> any virus transmitted by this e-mail.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39827-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 16:03:38 2009
Return-Path: <java-user-return-39827-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70054 invoked from network); 20 Apr 2009 16:03:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 16:03:38 -0000
Received: (qmail 76500 invoked by uid 500); 20 Apr 2009 16:03:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76411 invoked by uid 500); 20 Apr 2009 16:03:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76326 invoked by uid 99); 20 Apr 2009 16:03:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 16:03:30 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a17.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 16:03:20 +0000
Received: from [192.168.0.102] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a17.g.dreamhost.com (Postfix) with ESMTP id 3A0E573593;
	Mon, 20 Apr 2009 09:02:58 -0700 (PDT)
Cc: "java-user@lucene.apache.org" <java-user@lucene.apache.org>,
	"core-user@hadoop.apache.org" <core-user@hadoop.apache.org>,
	"solr-user@lucene.apache.org" <solr-user@lucene.apache.org>
Message-Id: <3B799B27-2BCA-4BAD-837A-FB9C6A99A3DF@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: nutch-user@lucene.apache.org
In-Reply-To: <fa33ab540904192058w292f3cc1n86331f4e7fc6593f@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: ebook resources - including lucene in action
Date: Mon, 20 Apr 2009 12:02:53 -0400
References: <fa33ab540904192058w292f3cc1n86331f4e7fc6593f@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Lest you think silence equals acceptance...

This is not appropriate use of these lists.

-Grant

On Apr 19, 2009, at 11:58 PM, wu fuheng wrote:

> welcome to download
> http://www.ultraie.com/admin/flist.php



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39828-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 16:17:05 2009
Return-Path: <java-user-return-39828-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73231 invoked from network); 20 Apr 2009 16:17:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 16:17:05 -0000
Received: (qmail 96838 invoked by uid 500); 20 Apr 2009 16:17:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96749 invoked by uid 500); 20 Apr 2009 16:17:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96739 invoked by uid 99); 20 Apr 2009 16:17:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 16:17:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.222.209.11] (HELO mirkwood.informatics.jax.org) (209.222.209.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 16:16:54 +0000
Received: from [127.0.0.1] (corona [209.222.209.245])
	by mirkwood.informatics.jax.org (8.14.2/8.14.2) with ESMTP id n3KGGUEt022721
	for <java-user@lucene.apache.org>; Mon, 20 Apr 2009 12:16:32 -0400 (EDT)
	(envelope-from mhall@informatics.jax.org)
Message-ID: <49EC9FDE.1020205@informatics.jax.org>
Date: Mon, 20 Apr 2009 12:16:30 -0400
From: Matthew Hall <mhall@informatics.jax.org>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: ebook resources - including lucene in action
References: <fa33ab540904192058w292f3cc1n86331f4e7fc6593f@mail.gmail.com> <3B799B27-2BCA-4BAD-837A-FB9C6A99A3DF@apache.org>
In-Reply-To: <3B799B27-2BCA-4BAD-837A-FB9C6A99A3DF@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-PMX-Version: 5.5.1.360522, Antispam-Engine: 2.6.1.350677, Antispam-Data: 2009.4.20.160429
X-PerlMx-Spam: Gauge=IIIIIII, Probability=8%, Report='BODY_SIZE_1000_LESS 0, BODY_SIZE_2000_LESS 0, BODY_SIZE_5000_LESS 0, BODY_SIZE_7000_LESS 0, BODY_SIZE_700_799 0, TO_NO_NAME 0, __BOUNCE_CHALLENGE_SUBJ 0, __C230066_P5 0, __CANPHARM_UNSUB_LINK 0, __CP_URI_IN_BODY 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __HAS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __MOZILLA_MSGID 0, __SANE_MSGID 0, __TO_MALFORMED_2 0, __USER_AGENT 0'
X-Virus-Checked: Checked by ClamAV on apache.org

Strange.. as far as I can tell I never even got this email at all, was 
it not originally sent to the lucene lists?

Matt

Grant Ingersoll wrote:
> Lest you think silence equals acceptance...
>
> This is not appropriate use of these lists.
>
> -Grant
>
> On Apr 19, 2009, at 11:58 PM, wu fuheng wrote:
>
>> welcome to download
>> http://www.ultraie.com/admin/flist.php
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


-- 
Matthew Hall
Software Engineer
Mouse Genome Informatics
mhall@informatics.jax.org
(207) 288-6012



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39829-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 20:00:33 2009
Return-Path: <java-user-return-39829-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74174 invoked from network); 20 Apr 2009 20:00:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 20:00:32 -0000
Received: (qmail 60370 invoked by uid 500); 20 Apr 2009 20:00:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60284 invoked by uid 500); 20 Apr 2009 20:00:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60274 invoked by uid 99); 20 Apr 2009 20:00:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 20:00:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 20:00:21 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lvzep-0002iP-WD
	for java-user@lucene.apache.org; Mon, 20 Apr 2009 13:00:00 -0700
Message-ID: <23143797.post@talk.nabble.com>
Date: Mon, 20 Apr 2009 12:59:59 -0700 (PDT)
From: "Karsten F." <karsten-lucene@fiz-technik.de>
To: java-user@lucene.apache.org
Subject: RE: Faceting, Sort and DocIDSet
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2762@mail02.tveyes.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: karsten-lucene@fiz-technik.de
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC266E@mail02.tveyes.com> <23113784.post@talk.nabble.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2743@mail02.tveyes.com> <8f0ad1f30904200726n18b00ae7rcd52f629491a8e62@mail.gmail.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2762@mail02.tveyes.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi David,

correct: you should avoid reading the content of a document inside a
hitcollector.
Normaly that means to cache all you need in main memory. Very simple and
fast is a facet with only 255 possible values and exactly one value per
document. In this case you need only an byte[IndexReader.maxDoc()] array in
cache and an int[256] array for collecting the results
(we have 5 GByte to run lucene with a couple of facets).

About "facet". For me a facet corresponds to a field in lucene. So 300
facets are quite a lot.
Or did you mean two facets with 150 values each?

To find a good solution for your 100M Document, I have three questions:
 - How many hits per search?
 - More then one value of the facet per document/how many in average?

INDEXORDER means document number. 
MultiSearcher works also fine:
If you have one index for each year and for each of this indices the
indexorder in order of date, also the MultiSearcher will have correct
INDEXORDER:
Take a look to the variable "int[] starts" in MultiSearcher.


David Seltzer wrote:
> 
> 
> Is INDEXORDER based on the DocumentID within each individual index? If so
> then the results could be interleaved. Anyone know how this behaves?
> 
> 

-- 
View this message in context: http://www.nabble.com/Faceting%2C-Sort-and-DocIDSet-tp23099854p23143797.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39830-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 21:25:33 2009
Return-Path: <java-user-return-39830-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19265 invoked from network); 20 Apr 2009 21:25:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 21:25:33 -0000
Received: (qmail 77258 invoked by uid 500); 20 Apr 2009 21:25:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77168 invoked by uid 500); 20 Apr 2009 21:25:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77158 invoked by uid 99); 20 Apr 2009 21:25:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 21:25:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 21:25:23 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 8466B71C447; Mon, 20 Apr 2009 14:25:02 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 819ED71C43C
	for <java-user@lucene.apache.org>; Mon, 20 Apr 2009 14:25:02 -0700 (PDT)
Date: Mon, 20 Apr 2009 14:25:02 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Query scoring
In-Reply-To: <d36c28c30904182344v1c45d307me569aaeb06e7c7f1@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0904201422470.11138@radix.cryptio.net>
References: <d36c28c30904160327y55642450v8bcd34faa309dbd1@mail.gmail.com> 
 <d36c28c30904160501t33ca3057sd587655b15ece941@mail.gmail.com> 
 <359a92830904160813m9c1ebe4w23d71d99422e66e0@mail.gmail.com> 
 <d36c28c30904162207x4489ce94l522f1c998c58a8d5@mail.gmail.com> 
 <359a92830904170644l4aa3facbk2a4d6831d9b99ac8@mail.gmail.com>
 <d36c28c30904182344v1c45d307me569aaeb06e7c7f1@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


Erick means we need to see *all* of your code (inlcuding how you get the 
score and the Explanation you are printing) to understand why they don't 
match.

All you've shown is the output of your program and the generation of a 
Hits object.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39831-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 22:07:53 2009
Return-Path: <java-user-return-39831-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46052 invoked from network); 20 Apr 2009 22:07:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 22:07:53 -0000
Received: (qmail 26679 invoked by uid 500); 20 Apr 2009 22:07:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26603 invoked by uid 500); 20 Apr 2009 22:07:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26593 invoked by uid 99); 20 Apr 2009 22:07:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 22:07:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 22:07:42 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lw1e5-0000Gp-Os
	for java-user@lucene.apache.org; Mon, 20 Apr 2009 15:07:21 -0700
Message-ID: <23145720.post@talk.nabble.com>
Date: Mon, 20 Apr 2009 15:07:21 -0700 (PDT)
From: MakMak <powgri@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: readModifiedUTF8String stuck
In-Reply-To: <9ac0c6aa0904170238y7b2e52a3x368b95c3ea81fa71@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: powgri@gmail.com
References: <23089805.post@talk.nabble.com> <23092183.post@talk.nabble.com> <9ac0c6aa0904170046x68fa5ad1j23eb5ab6fe7c7cf9@mail.gmail.com> <23093956.post@talk.nabble.com> <9ac0c6aa0904170238y7b2e52a3x368b95c3ea81fa71@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Mike,

   I made a standalone tool like you suggested which prints out the size of
each doc in the index, none of the docs are more than 1MB !!! The queries
are the same. They repeat throughout the test. We give about 6GB of heap to
the application and yes we are on 64 bit JVM. 

I hit upon another such issue here 
http://www.nabble.com/Lucene-2.2.0-in-64-bit-JVM:-IndexReader-is-hung-td22667471.html
http://www.nabble.com/Lucene-2.2.0-in-64-bit-JVM:-IndexReader-is-hung-td22667471.html  
Do you think this may be related? There was no resolution on this thread
though. We only upgraded lucene version and I am absolutely certain nothing
else changed.

One more thing, we tried to reproduce the customer environment here exactly
like they have it there. The only difference is, the index on the customer's
end resides in a SAN. 

Anything more you can suggest that I can do about it?

-thanks



Michael McCandless-2 wrote:
> 
> On Fri, Apr 17, 2009 at 5:05 AM, MakMak <powgri@gmail.com> wrote:
> 
>> I am not retrieving many docs, the problem is that the whole file is
>> stored
>> in the doc. I need the file content for highlighter to work. But the
>> files
>> are normal-sized text files which in any case should not exceed 10-15mb.
>> Retrieving 25 of them(page size), worst case scenario will take 250mb of
>> data transfer which should not take more than 600 secs.
> 
> Maybe you can add some logging as to which docs each thread is
> attempting to load.  Eg is it possible you accidentally have an
> immense doc in the index?
> 
> You could also make a standalone tool that simply requests each doc
> from the index and prints out its size.
> 
> Also, maybe run CheckIndex on your index just to make sure all is good.
> 
>> This may not be easily reproduced, but is easy to describe, we bombard
>> our
>> application with about 3-4 requests per second for 2 hours as a part of
>> stress tests. Previously when we were on 2.3.2, these used to run just
>> fine.
>> We had to upgrade due to a memory leak issue for which
>> CloseableThreadLocal
>> was implemented in 2.4.1.
> 
> OK.
> 
>> The testing team did not reindex with the new lucene version, but they
>> dont
>> have to, right?
> 
> Right, it's fully back compatible, though you should get better
> performance by reindexing.
> 
>> thats when they saw these stuck threads. The tests ran fine
>> for an hour when responses were being returned timely. But after an hour,
>> the threads just started to accumulate. I am not sure amount of RAM
>> consumed
>> during searches, will find that out.
> 
> Hmm, that's spooky.  Do the queries repeat at <= 1 hour during the
> test?  Or is it possible in that 2nd hour of testing, a new query
> appeared that hit a horribly immense document?
> 
> If they do repeat... maybe some sort of crazy GC is kicking in?
> You're on a 64 bit JRE right?  How much heap do you give to it?
> 
>> Hope I have been clear, do you smell something fishy in this?
> 
> The fact that you only hit this new issue on upgrading to 2.4.1 is
> certainly fishy.  Nothing else changed in the upgrade?
> 
> Mike
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/readModifiedUTF8String-stuck-tp23089805p23145720.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39832-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 22:50:55 2009
Return-Path: <java-user-return-39832-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63174 invoked from network); 20 Apr 2009 22:50:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 22:50:55 -0000
Received: (qmail 64365 invoked by uid 500); 20 Apr 2009 22:50:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64278 invoked by uid 500); 20 Apr 2009 22:50:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64259 invoked by uid 99); 20 Apr 2009 22:50:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 22:50:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [69.55.225.129] (HELO ehatchersolutions.com) (69.55.225.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 22:50:41 +0000
Received: by ehatchersolutions.com (Postfix, from userid 504)
	id 2D1EB30EFC11; Mon, 20 Apr 2009 16:50:19 -0600 (MDT)
X-Spam-Checker-Version: SpamAssassin 3.1.1 (2006-03-10) on javelina
X-Spam-Level: 
Received: from [10.0.1.193] (unknown [138.210.8.79])
	by ehatchersolutions.com (Postfix) with ESMTP id F088D30EFC11;
	Mon, 20 Apr 2009 16:50:14 -0600 (MDT)
Cc: "wu fuheng" <wufuheng@gmail.com>;"nutch-user" <nutch-user@lucene.apache.org>,
 "java-user@lucene.apache.org" <java-user@lucene.apache.org>; "core-user@hadoop.apache.org" <core-user@hadoop.apache.org>; "solr-user@lucene.apache.org" <solr-user@lucene.apache.org>
Message-Id: <383038D1-4F81-474C-9C81-F9E5986D1B48@ehatchersolutions.com>
From: Erik Hatcher <erik@ehatchersolutions.com>
To: solr-user@lucene.apache.org
In-Reply-To: <1240207086.d47619b92cebc6ebfa07969ab5370ae6@mail.in.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: ebook resources - including lucene in action
Date: Mon, 20 Apr 2009 18:50:11 -0400
References: <1240207086.d47619b92cebc6ebfa07969ab5370ae6@mail.in.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.6 required=5.0 tests=BAYES_00 autolearn=ham 
	version=3.1.1

It is not legal to share purchased e-books in this manner.  Please  
purchase copies of the books you read, otherwise authors have very  
little incentive to dedicate months (14 months in the case of Lucene  
in Action, first edition) of their lives to writing this content.

	Erik

On Apr 20, 2009, at 1:58 AM, Saurabh Bhutyani wrote:

> Check out this site: www.downloadsearchengine.comIt allows to search  
> and download pdf ebooks, ppts, doc, mp3, torrents, rapidshare links  
> etc. Original message From:wu fuheng< wufuheng@gmail.com >Date: 20  
> Apr 09 09:28:56Subject:ebook resources  including lucene in  
> actionTo: nutchuser@lucene.apache.orgwelcome to download ....


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39833-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 23:28:54 2009
Return-Path: <java-user-return-39833-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72747 invoked from network); 20 Apr 2009 23:28:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 23:28:54 -0000
Received: (qmail 3198 invoked by uid 500); 20 Apr 2009 23:28:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3122 invoked by uid 500); 20 Apr 2009 23:28:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3111 invoked by uid 99); 20 Apr 2009 23:28:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 23:28:51 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.221.125 as permitted sender)
Received: from [209.85.221.125] (HELO mail-qy0-f125.google.com) (209.85.221.125)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 23:28:44 +0000
Received: by qyk31 with SMTP id 31so4120463qyk.21
        for <java-user@lucene.apache.org>; Mon, 20 Apr 2009 16:28:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=FcSsHIhc1oSuMHTziybmeX6og4KeBESBlqdAc25ei/s=;
        b=tyoiLzvKZ/EsbKDDKENH7ju2YrijFvXjVKPPZIx0GH6PI6SHYGCobo1dhN2KPOmtjt
         cpttmHzyaEDOGwXhR05mUgXZLwRcmomdeCaBqQTa1CKaZ5lmDwvkarOEpGFb0cG/FFNG
         s7B4eMFa0+cPTDJfUW8y1X/EP1TH5UMVjpRWQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=x7HBmu7OEHPwseyACrb1FQKRdh1pdoi+isYYXzltwUBYPMsUldnFni+L0t7yNQSrU8
         d0UUcoK3c7jpDSiALrj5Bt15LLGB/aSoDrqGpUn2Wve6jjv/koJXjHq3M0oU0r0skVm2
         Q15avPJrn2wsSsTtttOU01j5a62sSchU5sGxw=
MIME-Version: 1.0
Received: by 10.220.86.68 with SMTP id r4mr7054502vcl.9.1240270102562; Mon, 20 
	Apr 2009 16:28:22 -0700 (PDT)
In-Reply-To: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D368AB230@IIWCBO-EMB1.iiw.de.ittind.com>
References: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79B@IIWCBO-EMB1.iiw.de.ittind.com>
	 <499888440904171705s467e3bap95598f3f870c20b3@mail.gmail.com>
	 <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79D@IIWCBO-EMB1.iiw.de.ittind.com>
	 <359a92830904171907j2b8fdb91kbd762c905240b3df@mail.gmail.com>
	 <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D368AB230@IIWCBO-EMB1.iiw.de.ittind.com>
Date: Mon, 20 Apr 2009 19:28:22 -0400
Message-ID: <359a92830904201628o2fa6684cr99561a97f0442002@mail.gmail.com>
Subject: Re: IndexWriter update method
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64ec474e420b9046804e25c
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64ec474e420b9046804e25c
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I don't think you *can* create a Term that spans two fields. Perhaps
you'd be better off just doing a search, getting the doc ID back then
adding a new version of the document.

You *could* think about reindexing your corpus and indexing an
additional field that was the concatenation of the two fields you
want to update by if that's a better solution.

Best
Erick

On Mon, Apr 20, 2009 at 11:40 AM, Newman, Billy <Billy.Newman@itt.com>wrote:

> What if you're unique id is a composite of two field when you create the
> document?
>
> I.E.
> doc.add(new Field("partno", "123345",
> Field.Store.whatever, Field.Index.UN_TOKENIZED);
> doc.add(new Field("storeLoc", "Springfield",
> Field.Store.whatever, Field.Index.UN_TOKENIZED);
>
> How do you create a Term for this?  Is this possible?  Is this the correct
> way to create a document that has two fields?  If so I am a little lost on
> how to create a term to correctly find this.
>
> Thanks,
> Billy
>
> -----Original Message-----
> From: Erick Erickson [mailto:erickerickson@gmail.com]
> Sent: Friday, April 17, 2009 8:08 PM
> To: java-user@lucene.apache.org
> Subject: Re: IndexWriter update method
>
> What you're missing is that the example has no unique ID, it wasn't created
> with update in mind.
>
> There's no hidden magic for Lucene knowing *what* document you want
> to have updated, you have to provide it yourself, and it should be unique.
>
> Imagine a parts catalog, or an index of a directory tree. In the parts
> catalog,
> you could identify the document by its part number, so you'd probably index
> it something like doc.add(new Field("partno", "123345",
> Field.Store.whatever, Field.Index.UN_TOKENIZED);
> Indexing a directory tree you could use the complete file path similarly.
>
> Now, each document will have one (and only one) partno, and it'll be unique
> (you really
> don't want to tokenize this).
>
> To update, you'd form your term on the field "partno" and value "123345",
> thus uniquely
> identifying the document you want replaced, and use that term in your
> update
> statement.
> Think of the Term as a unique key for the document that *you've*
> deliberately put there.
>
> I'm pretty sure (but not positive) that if you update a document where the
> term doesn't
> have any matches, you'll get a simple insert, but I won't guarantee it.
>
> HTH
> Erick
>
>
> On Fri, Apr 17, 2009 at 9:28 PM, Newman, Billy <Billy.Newman@itt.com>
> wrote:
>
> > Ok I am still confused.
> >
> > Looking at the examples to index a document I would do something like the
> > following:
> >        Document document = new Document();
> >        document.add(Field.UnStored("article", article));
> >        document.add(Field.Text("comments", comments));
> >        Analyzer analyzer  = new StandardAnalyzer();
> >        IndexWriter writer = new IndexWriter(indexDirectory, analyzer,
> > false);
> >        writer.addDocument(document);
> >        writer.optimize();
> >        writer.close();
> >
> > Now lets say that the comments can change and when they do I want to
> update
> > that document to contain the newly updated comments.
> >
> > So I would have to go back and check my index to see if that book already
> > exists.
> > Query q = new QueryParser("article", analyzer).parse(querystr);
> > int hitsPerPage = 10;
> > IndexSearcher searcher = new IndexSearcher(index);
> > TopDocCollector collector = new TopDocCollector(hitsPerPage);
> > searcher.search(q, collector);
> > ScoreDoc[] hits = collector.topDocs().scoreDocs;
> > if (hits!= null && hits.length > 0) {
> >  // ?
> >  // Then this already exists and I just want to update the comments
> section
> > }
> >
> > Does that make sense?  Am I going about this wrong?
> >
> > Billy
> >
> >
> > ________________________________________
> > From: Tim Williams [williamstw@gmail.com]
> > Sent: Friday, April 17, 2009 6:05 PM
> > To: java-user@lucene.apache.org
> > Subject: Re: IndexWriter update method
> >
> > On Fri, Apr 17, 2009 at 7:27 PM, Newman, Billy <Billy.Newman@itt.com>
> > wrote:
> > > I am looking for info on how to use the IndexWriter.update method.  A
> > short example of how to add a document and then later update would
> > > be very helpful.  I get lost because I can add a document with just the
> > document, but I need a document and a Term.  I am not really sure
> > > what a Term is since I did not use a Term to create the document nor do
> I
> > see it in any of the examples of searching/adding.
> >
> > When you index the document, add an ID field that is unique.  Then
> > when you go to update the document the "Term" will be the ID of the
> > document you wish to update.  For example, you might add a URL as the
> > unique ID, then to update it might look something like:
> >
> > writer.update(new Term("id","http://apache.org/lucene/index.htm"), doc)
> >
> >
> > --tim
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> > This e-mail and any files transmitted with it may be proprietary and are
> > intended solely for the use of the individual or entity to whom they are
> > addressed. If you have received this e-mail in error please notify the
> > sender.
> > Please note that any views or opinions presented in this e-mail are
> solely
> > those of the author and do not necessarily represent those of ITT
> > Corporation. The recipient should check this e-mail and any attachments
> for
> > the presence of viruses. ITT accepts no liability for any damage caused
> by
> > any virus transmitted by this e-mail.
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64ec474e420b9046804e25c--

From java-user-return-39834-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 20 23:29:28 2009
Return-Path: <java-user-return-39834-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72893 invoked from network); 20 Apr 2009 23:29:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Apr 2009 23:29:28 -0000
Received: (qmail 4991 invoked by uid 500); 20 Apr 2009 23:29:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4888 invoked by uid 500); 20 Apr 2009 23:29:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4861 invoked by uid 99); 20 Apr 2009 23:29:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 23:29:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bradfordstephens@gmail.com designates 74.125.46.29 as permitted sender)
Received: from [74.125.46.29] (HELO yw-out-2324.google.com) (74.125.46.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 20 Apr 2009 23:29:14 +0000
Received: by yw-out-2324.google.com with SMTP id 9so1260321ywe.5
        for <multiple recipients>; Mon, 20 Apr 2009 16:28:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:cc:content-type
         :content-transfer-encoding;
        bh=41OoxCW7gOkvibsnGrK9mwM8MnFfFr4C2LZmWMg3ASY=;
        b=X5b7MJlBsl2fwFMTms5YOXvJ3YkWhMeavtI9DgnbsxdDVsJOjhvVUQo1DZSVMuOfgc
         dFOe029PnW21RerSZw5/V27oygX98cULhf5Kh2TEVLmI2f2EEuoxuKP8qTb+SBPmaq3R
         mlc22Sjo6m4K8ltsioZH+s+v07HUVloAeRFss=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type:content-transfer-encoding;
        b=Kxc9An7zZBP7On3LND+j2mJ4b48n66Ip6BpckHyPaOCfOyBLQ4lBRNKvsozsBHOZmO
         dPQE6jx9rZULG+y0442c2bgjRxjnjSZaBR4JvtTEKgghgAuY4MJrENMU1weoFed3qmRh
         Tbljwsfo/+xuBhCRqt39R4KDmJQSWBZO+/1dk=
MIME-Version: 1.0
Received: by 10.90.106.4 with SMTP id e4mr4090110agc.88.1240270133297; Mon, 20 
	Apr 2009 16:28:53 -0700 (PDT)
In-Reply-To: <49EC853A.5020800@informatics.jax.org>
References: <860544ed0904161527o4f1bb171x686682f23cb2cf88@mail.gmail.com>
	 <860544ed0904171708v2212115fj4a64d4dbfd5b1ca2@mail.gmail.com>
	 <E8E96088-4555-4099-B28D-CE29FE72F73C@gmail.com>
	 <49EC853A.5020800@informatics.jax.org>
Date: Mon, 20 Apr 2009 16:28:53 -0700
Message-ID: <860544ed0904201628o329a910bv3fbf05e090ba04ea@mail.gmail.com>
Subject: Re: Seattle / PNW Hadoop + Lucene User Group?
From: Bradford Stephens <bradfordstephens@gmail.com>
To: java-user@lucene.apache.org
Cc: "core-user@hadoop.apache.org" <core-user@hadoop.apache.org>, 
	"nutch-user@lucene.apache.org" <nutch-user@lucene.apache.org>, 
	"solr-user@lucene.apache.org" <solr-user@lucene.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks for the responses, everyone. Where shall we host? My company
can offer space in  our building in Factoria, but it's not exactly a
'cool' or 'fun' place. I can also reserve a room at a local library. I
can bring some beer and light refreshments.

On Mon, Apr 20, 2009 at 7:22 AM, Matthew Hall <mhall@informatics.jax.org> w=
rote:
> Same here, sadly there isn't much call for Lucene user groups in Maine. =
=A0It
> would be nice though ^^
>
> Matt
>
> Amin Mohammed-Coleman wrote:
>>
>> I would love to come but I'm afraid I'm stuck in rainy old England :(
>>
>> Amin
>>
>> On 18 Apr 2009, at 01:08, Bradford Stephens <bradfordstephens@gmail.com>
>> wrote:
>>
>>> OK, we've got 3 people... that's enough for a party? :)
>>>
>>> Surely there must be dozens more of you guys out there... c'mon,
>>> accelerate your knowledge! Join us in Seattle!
>>>
>>>
>>>
>>> On Thu, Apr 16, 2009 at 3:27 PM, Bradford Stephens
>>> <bradfordstephens@gmail.com> wrote:
>>>>
>>>> Greetings,
>>>>
>>>> Would anybody be willing to join a PNW Hadoop and/or Lucene User Group
>>>> with me in the Seattle area? I can donate some facilities, etc. -- I
>>>> also always have topics to speak about :)
>>>>
>>>> Cheers,
>>>> Bradford
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39835-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 00:25:18 2009
Return-Path: <java-user-return-39835-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91223 invoked from network); 21 Apr 2009 00:25:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 00:25:18 -0000
Received: (qmail 46663 invoked by uid 500); 21 Apr 2009 00:25:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46625 invoked by uid 500); 21 Apr 2009 00:25:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46615 invoked by uid 99); 21 Apr 2009 00:25:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 00:25:15 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 74.125.44.30 as permitted sender)
Received: from [74.125.44.30] (HELO yx-out-2324.google.com) (74.125.44.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 00:25:07 +0000
Received: by yx-out-2324.google.com with SMTP id 8so636780yxm.5
        for <java-user@lucene.apache.org>; Mon, 20 Apr 2009 17:24:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=2EBX9fV2TaOQxEzRK/wJhSUz5m5PV56f1DrIB/eJ3To=;
        b=jm+PRO5UMlo80PeszmbCk8mPPLyM1n+DSGcYjLF3Gx6KHXeSMwIKZOZM+EK6rx5rfP
         CB1UWM715jIO0/UPxJXo1sUOdhelrczkT6M9NrhRfPRHVcs3sfV6RGXokPgkkUWhEwCn
         nUlNBPW74ruDblTr61J7dDauMQ1f3v7TJZ3AQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=alklRbMAs240KiccHQUFMhe7Vg+xPEujYe1gJ38drygAHFTtvJL6bo2JcPog7BORbw
         Q1nHAqrLn0EooSS6elewWO61I6TrC1q2kWBkV4hZ/UxbTpvHftZtK/hUIKHBWqxGkjLg
         LTyG7W/aRhAGubkTMnYkEylKuUL/CIoEUv0XM=
MIME-Version: 1.0
Received: by 10.100.96.10 with SMTP id t10mr3581198anb.131.1240273486402; Mon, 
	20 Apr 2009 17:24:46 -0700 (PDT)
In-Reply-To: <23143797.post@talk.nabble.com>
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC266E@mail02.tveyes.com>
	 <23113784.post@talk.nabble.com>
	 <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2743@mail02.tveyes.com>
	 <8f0ad1f30904200726n18b00ae7rcd52f629491a8e62@mail.gmail.com>
	 <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2762@mail02.tveyes.com>
	 <23143797.post@talk.nabble.com>
Date: Mon, 20 Apr 2009 17:24:46 -0700
Message-ID: <8837fb770904201724i8788afbs58b6c4b3aca2180e@mail.gmail.com>
Subject: Re: Faceting, Sort and DocIDSet
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e646167894da8b046805ac8c
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e646167894da8b046805ac8c
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi David:

     We built bobo-browse specifically for these types of usecases:
http://code.google.com/p/bobo-browse

     Let me know if you need any help getting it going.

-John

On Mon, Apr 20, 2009 at 12:59 PM, Karsten F.
<karsten-lucene@fiz-technik.de>wrote:

>
> Hi David,
>
> correct: you should avoid reading the content of a document inside a
> hitcollector.
> Normaly that means to cache all you need in main memory. Very simple and
> fast is a facet with only 255 possible values and exactly one value per
> document. In this case you need only an byte[IndexReader.maxDoc()] array in
> cache and an int[256] array for collecting the results
> (we have 5 GByte to run lucene with a couple of facets).
>
> About "facet". For me a facet corresponds to a field in lucene. So 300
> facets are quite a lot.
> Or did you mean two facets with 150 values each?
>
> To find a good solution for your 100M Document, I have three questions:
>  - How many hits per search?
>  - More then one value of the facet per document/how many in average?
>
> INDEXORDER means document number.
> MultiSearcher works also fine:
> If you have one index for each year and for each of this indices the
> indexorder in order of date, also the MultiSearcher will have correct
> INDEXORDER:
> Take a look to the variable "int[] starts" in MultiSearcher.
>
>
> David Seltzer wrote:
> >
> >
> > Is INDEXORDER based on the DocumentID within each individual index? If so
> > then the results could be interleaved. Anyone know how this behaves?
> >
> >
>
> --
> View this message in context:
> http://www.nabble.com/Faceting%2C-Sort-and-DocIDSet-tp23099854p23143797.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e646167894da8b046805ac8c--

From java-user-return-39836-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 06:41:20 2009
Return-Path: <java-user-return-39836-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23103 invoked from network); 21 Apr 2009 06:41:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 06:41:20 -0000
Received: (qmail 96078 invoked by uid 500); 21 Apr 2009 06:41:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95984 invoked by uid 500); 21 Apr 2009 06:41:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95974 invoked by uid 99); 21 Apr 2009 06:41:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 06:41:16 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [131.166.12.2] (HELO terry.dannet.dk) (131.166.12.2)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 06:41:07 +0000
Received: from mail1.machcorp.lan (mail1.machcorp.lan [172.30.107.173])
	by terry.dannet.dk (8.13.8/8.13.8) with ESMTP id n3L6ejn1626864
	for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 08:40:45 +0200
Received: from EXCHHYD.machcorp.lan ([10.91.40.35])
          by notesgw1.machcorp.lan (Lotus Domino Release 6.5.6FP2)
          with ESMTP id 2009042108404361-551 ;
          Tue, 21 Apr 2009 08:40:43 +0200 
X-MimeOLE: Produced By Microsoft Exchange V6.5
MIME-Version: 1.0
Subject: How to search special characters in LUcene
Date: Tue, 21 Apr 2009 12:10:42 +0530
Message-ID: <D262A1FB331DC344AA0B896F390D5569016E3E8C@exchhyd.machcorp.lan>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: How to search special characters in LUcene
Thread-Index: AcnCTBd6umn/6oDxRqez+qM8S9eQbw==
From: "Uday Kumar Maddigatla" <ukma@mach.com>
To: <java-user@lucene.apache.org>
X-MIMETrack: Itemize by SMTP Server on NotesGW1/MACH(Release 6.5.6FP2|October 17, 2007) at
 21/04/2009 08:40:43,
	Serialize by Router on Mail1/MACH(Release 7.0.2|September 26, 2006) at 21-04-2009
 08:40:45,
	Serialize complete at 21-04-2009 08:40:45
Content-class: urn:content-classes:message
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C9C24C.178DA17A"
X-Virus-Scanned: by amavisd-new
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C9C24C.178DA17A
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset="iso-8859-1"

HI,

=20

I'm new to the lucene. I downloaded lucene 2.4.1.=20

=20

I have one xml file which contains few special characters like '=E5', =
'=F8,' =B0' etc.(these are Danish language elements).

=20

How can I search these things.

=20

=20

Uday Kumar  Reddy Maddigatla

Software Engineer(Progrator|gatetrade)

MACH India(Operations)=20

Mobile: + 91-9963000377

Uday.Maddigatla@ness.com <mailto:Uday.Maddigatla@ness.com>  =20

ukma@mach.com <mailto:ukma@mach.com>=20

www.ness.com=20

=20

=20


------_=_NextPart_001_01C9C24C.178DA17A--

From java-user-return-39837-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 07:47:54 2009
Return-Path: <java-user-return-39837-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38013 invoked from network); 21 Apr 2009 07:47:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 07:47:50 -0000
Received: (qmail 51413 invoked by uid 500); 21 Apr 2009 07:47:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51324 invoked by uid 500); 21 Apr 2009 07:47:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51314 invoked by uid 99); 21 Apr 2009 07:47:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 07:47:47 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of cdoronc@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 07:47:39 +0000
Received: by ewy27 with SMTP id 27so2345366ewy.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 00:47:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=oBbMgyjG1iSoUXHMP3zqVw60Gp9kQN1yFElY7ONesMY=;
        b=kaNiHWfRCRfT+zMAx5F8+S2xOtfx8ouXbIwueTbYCSWN5ckaLj4VA9DoRebu+d9NvT
         PtM6afX8NHsbO1Awr3dekTdTc01Q193JX5DpvEIl9zUw6OLqZorZVWupzNTtbGI2zi/6
         Izn4DUDUA6oMo8ISFxriBaFrFjZJWV0meUcEc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=x4lurGf7nO38PqSZHVi4j9BzaUyt1mA7+uVDfE+kqakbz+X2rSLeqDw//jWqL9sdfD
         rbnl2lA8TqM7MSkZW551JbTGsXPqz7XFUeYpTaDL4iW5ok1IHrJLbrvWbjBMOBOUi2xS
         f3/7OMrnS94H4pZEw45p0HsxIggB7FhnJLsQw=
MIME-Version: 1.0
Received: by 10.210.87.14 with SMTP id k14mr4629813ebb.60.1240300039718; Tue, 
	21 Apr 2009 00:47:19 -0700 (PDT)
In-Reply-To: <49E91253.4030506@stanford.edu>
References: <49E91253.4030506@stanford.edu>
Date: Tue, 21 Apr 2009 10:47:19 +0300
Message-ID: <e05f0fd10904210047m218a0628wf57070729841e2a9@mail.gmail.com>
Subject: Re: Why is CustomScoreQuery limited to ValueSourceQuery type?
From: Doron Cohen <cdoronc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174feb5e4848a004680bdb3b
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174feb5e4848a004680bdb3b
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

CustomScoreQuery expects the VSQs to have a score for document matching the
(main) subQuery - this does not hold for arbitrary queries.

On Sat, Apr 18, 2009 at 2:35 AM, Steven Bethard <bethard@stanford.edu>wrote:

> CustomScoreQuery only allows the secondary queries to be of type
> ValueSourceQuery instead of allowing them to be any type of Query. Why
> is that? Is there something that makes it hard to implement for
> arbitrary queries?
>
> Steve
>
> P.S. I played around with this briefly, and simply replacing all
> ValueSourceQuery references with Query references yields only one simple
> compile error, where ValueSourceQuery.createWeight() is being used
> instead of Query.weight() for some reason.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174feb5e4848a004680bdb3b--

From java-user-return-39838-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 08:28:11 2009
Return-Path: <java-user-return-39838-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51107 invoked from network); 21 Apr 2009 08:28:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 08:28:11 -0000
Received: (qmail 193 invoked by uid 500); 21 Apr 2009 08:28:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 157 invoked by uid 500); 21 Apr 2009 08:28:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 147 invoked by uid 99); 21 Apr 2009 08:28:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 08:28:08 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of oren.liat@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 08:28:00 +0000
Received: by ey-out-2122.google.com with SMTP id 22so196777eye.53
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 01:27:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=qd+IKT3ZCiI8M87nw4Q7zGnJA20TcO1KIRB22834Mkw=;
        b=DQGNo2JN7PdA8pHdiK4f5hz5CoLwxuMGklTqLtxQQvsgWBCkijwM/0Ey5KRAQ559S1
         8VVoNGZDcx6C6tiy5yvxCECi+MeiqImEIzIOVu3KNhQx/9E3OHe+I+SN7HWvdDODirda
         ReN8JI+QNIvaDcKoTT48fk4LULEVJvTy3QVJk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=N1bNqmvLFexJBAK6+evzM5H7DoKWSoMQslqNn8qurLvntcMd3UaSlUL0SFcnZPCUs0
         Cr2DFoAgUG4gl+IE8cTBQDglqqKCIBwTBJMDFaKOcoZK/xVQvoCXaRP9DosINkGgkU47
         6FovBkdGuMFTMfut6qzXwBPiGF647kSpuNRIU=
MIME-Version: 1.0
Received: by 10.210.142.10 with SMTP id p10mr4653426ebd.85.1240302460275; Tue, 
	21 Apr 2009 01:27:40 -0700 (PDT)
In-Reply-To: <Pine.LNX.4.64.0904201422470.11138@radix.cryptio.net>
References: <d36c28c30904160327y55642450v8bcd34faa309dbd1@mail.gmail.com>
	 <d36c28c30904160501t33ca3057sd587655b15ece941@mail.gmail.com>
	 <359a92830904160813m9c1ebe4w23d71d99422e66e0@mail.gmail.com>
	 <d36c28c30904162207x4489ce94l522f1c998c58a8d5@mail.gmail.com>
	 <359a92830904170644l4aa3facbk2a4d6831d9b99ac8@mail.gmail.com>
	 <d36c28c30904182344v1c45d307me569aaeb06e7c7f1@mail.gmail.com>
	 <Pine.LNX.4.64.0904201422470.11138@radix.cryptio.net>
Date: Tue, 21 Apr 2009 11:27:40 +0300
Message-ID: <d36c28c30904210127l528a0d81g9a6acb8e2b699064@mail.gmail.com>
Subject: Re: Query scoring
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c1c468f0d8d04680c6baa
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c1c468f0d8d04680c6baa
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Sorry, you can see the script below:

Thanks


//******************** Index Method
******************************************/
 public void index(DoubleMap doubleMap, String dirPath, String originalPath)
throws IOException
 {
  File f = new File(dirPath);
  IndexWriter writer = null;
  if(f.exists())
  {
   writer = new IndexWriter(dirPath, new WhitespaceAnalyzer(), false);
  }
  else
  {
   writer = new IndexWriter(dirPath, new WhitespaceAnalyzer(), true);
  }
  writer.setSimilarity(new WordsSimilarity());
  Iterator it = doubleMap.getMap().entrySet().iterator();
  int count = 0;
  int size = doubleMap.getMap().size();
  while(it.hasNext())
  {
   count++;
   Map.Entry entry = (Map.Entry) it.next();
   String word = entry.getKey().toString();
   Word w = new Word();
   w.word = word;
   Date date = new Date();

   System.out.println(date.toString() + " : Updateing word " + word + " ( "
+ count + " out of " + size + ") " + " FROM " + originalPath);
   Map<Long, Double> innerMap = (Map<Long, Double>) entry.getValue();
   Document doc = WordIndex.getDoc(word, dirPath);
   if(doc != null)
   {
    doc = WordIndex.addToDoc(doc, innerMap);
    ///  delete the document and then add it
    writer.deleteDocuments(new Term(WordIndex.FIELD_WORD, word));
    writer.addDocument(doc);
   }
   else
   {
    w.worldsMap = innerMap;
    WordIndex wi = new WordIndex(w);
    wi.createDocument();
    writer.addDocument(wi.getDocument());
   }
  }
  System.out.println("Optimizing " + dirPath + " ...");
  writer.optimize();
  writer.close();
 }

//******************** WordIndex class
******************************************/
public class WordIndex extends Index
{
 protected Word w;
 public static String FIELD_WORD = "word";
 public static String FIELD_WORLDS = "worlds";
 public WordIndex(Word w)
 {
  this.w = w;
 }
 public void createDocument() throws java.io.FileNotFoundException
 {
  // make a new, empty document
  doc = new Document();
  // Add the id of the patent
  // indexed (i.e. searchable), but don't tokenize the field into words.
  doc.add(new Field(FIELD_WORD, w.word, Field.Store.YES,
Field.Index.UN_TOKENIZED));
  doc.add(new Field(FIELD_WORLDS, String.valueOf(w.getWorldIds()),
Field.Store.YES, Field.Index.TOKENIZED));
  //  Iterator iter = w.worldsMap.entrySet().iterator();
  //  while(iter.hasNext())
  //  {
  //   Map.Entry entry = (Map.Entry) iter.next();
  //   doc.add(new Field(entry.getKey().toString(),
String.valueOf(entry.getValue()), Field.Store.YES,
Field.Index.UN_TOKENIZED));
  //  }
 }

 public static Document addToDoc(Document doc, Map<Long, Double> map)
 {
  Iterator iter = map.entrySet().iterator();
  String worlds = doc.getField(WordIndex.FIELD_WORLDS).stringValue();
  doc.removeField(FIELD_WORLDS);
  while(iter.hasNext())
  {
   Map.Entry entry = (Map.Entry) iter.next();
   String worldId = entry.getKey().toString();
   if(doc.getField(worldId) == null)
   {
    //    doc.add(new Field(entry.getKey().toString(),
String.valueOf(entry.getValue()), Field.Store.YES,
Field.Index.UN_TOKENIZED));
    // also add to the field of worlds the current world
    worlds += entry.getKey().toString() + " ";
   }
  }
  System.out.println(worlds);
  doc.add(new Field(FIELD_WORLDS, String.valueOf(worlds), Field.Store.YES,
Field.Index.TOKENIZED));
  return doc;
 }

 public static Document getDoc(String word, String indexPath) throws
IOException
 {
  IndexSearcher mapSearcher = new IndexSearcher(indexPath);
  TermQuery mapQuery = new TermQuery(new Term(FIELD_WORD, word));
  Hits mapHits = mapSearcher.search(mapQuery);
  if(mapHits.length() != 0)
  {
   Document doc = mapHits.doc(0);
   return doc;
  }
  return null;
 }

}

2009/4/21 Chris Hostetter <hossman_lucene@fucit.org>

>
> Erick means we need to see *all* of your code (inlcuding how you get the
> score and the Explanation you are printing) to understand why they don't
> match.
>
> All you've shown is the output of your program and the generation of a
> Hits object.
>
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174c1c468f0d8d04680c6baa--

From java-user-return-39839-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 08:40:39 2009
Return-Path: <java-user-return-39839-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54126 invoked from network); 21 Apr 2009 08:40:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 08:40:39 -0000
Received: (qmail 15329 invoked by uid 500); 21 Apr 2009 08:40:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15245 invoked by uid 500); 21 Apr 2009 08:40:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15235 invoked by uid 99); 21 Apr 2009 08:40:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 08:40:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of murat.yakici@cis.strath.ac.uk designates 130.159.196.96 as permitted sender)
Received: from [130.159.196.96] (HELO smtphost.cis.strath.ac.uk) (130.159.196.96)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 08:40:25 +0000
Received: from [130.159.185.12] (pc-hotdesk.cis.strath.ac.uk [130.159.185.12])
	by arnott.cis.strath.ac.uk (8.14.2/8.14.2/Debian-2build1) with ESMTP id n3L8dYxx001001
	for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 09:39:34 +0100
Message-ID: <49ED8646.6040508@cis.strath.ac.uk>
Date: Tue, 21 Apr 2009 09:39:34 +0100
From: Murat Yakici <murat.yakici@cis.strath.ac.uk>
User-Agent: Thunderbird 2.0.0.12 (Windows/20080213)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Using Payloads
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-CIS-MailScanner-SpamCheck: SpamAssassin score=-1.44, ALL_TRUSTED
X-Scanned-By: MIMEDefang on 130.159.196.96
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,
I started playing with the experimental payload functionality. I have 
written an analyzer which adds a payload (some sort of a score/boost) 
for each term occurance. The payload/score for each term is dependent on 
the document that the term comes from (I guess this is the typoical use 
case). So say term t1 may have a payload of 5 in doc1 and 34 in doc5. 
The parameter for calculating the payload changes after each 
indexWriter.addDocument(..) method call in a while loop. I am assuming 
that the indexWriter.addDocument(..) methods are thread safe. Can I 
confirm this?

Cheers,

-- 
Murat Yakici
Department of Computer & Information Sciences
University of Strathclyde
Glasgow, UK
-------------------------------------------
The University of Strathclyde is a charitable body, registered in Scotland, 
with registration number SC015263.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39840-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 09:09:34 2009
Return-Path: <java-user-return-39840-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61371 invoked from network); 21 Apr 2009 09:09:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 09:09:34 -0000
Received: (qmail 42179 invoked by uid 500); 21 Apr 2009 09:09:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42093 invoked by uid 500); 21 Apr 2009 09:09:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42082 invoked by uid 99); 21 Apr 2009 09:09:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 09:09:30 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of cdoronc@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 09:09:21 +0000
Received: by ewy27 with SMTP id 27so2374247ewy.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 02:09:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=HSf5BxoR3Vj0XrBosu59QR9amb/1Kc0gsgiJSKuNs7c=;
        b=pwSoamuHVuMxwlXStT2zjJSszCWB9ZOEoh1OI6hgOmZ8L+0zzvdqu47AacVq7MWq8W
         pCuKqLWswhlJVJgAAts0zQ5N7Z8juCDlmcLOVBIzw8u38kTpq8G9qQ0g3nZouLrOTbVr
         kXambefNIPV1O+EMWL9AE7DiGrn5VR0j09HLI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=HlsqibM2Gs+B+OUdoL1CQNGCQDP9//SLa7zMh8YMpf05/BnA5ufi8UnzEiy5i8CH61
         thCZg9s/j07CjCos7y918Nah+VOZEYIy47dqo7X2md1utGXHYwUbW75pPnEYiLsQ4ME7
         pSmku6wbuG3siYOZmT8Y5qr3Nr0Ina01Gl8MA=
MIME-Version: 1.0
Received: by 10.210.53.5 with SMTP id b5mr2551899eba.6.1240304941420; Tue, 21 
	Apr 2009 02:09:01 -0700 (PDT)
In-Reply-To: <359a92830904201628o2fa6684cr99561a97f0442002@mail.gmail.com>
References: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79B@IIWCBO-EMB1.iiw.de.ittind.com>
	 <499888440904171705s467e3bap95598f3f870c20b3@mail.gmail.com>
	 <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79D@IIWCBO-EMB1.iiw.de.ittind.com>
	 <359a92830904171907j2b8fdb91kbd762c905240b3df@mail.gmail.com>
	 <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D368AB230@IIWCBO-EMB1.iiw.de.ittind.com>
	 <359a92830904201628o2fa6684cr99561a97f0442002@mail.gmail.com>
Date: Tue, 21 Apr 2009 12:09:01 +0300
Message-ID: <e05f0fd10904210209obecd8c1s56731755d90ba963@mail.gmail.com>
Subject: Re: IndexWriter update method
From: Doron Cohen <cdoronc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174be18a72523204680cff26
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174be18a72523204680cff26
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

*IndexWriter.deleteDocuments<http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/index/IndexWriter.html#deleteDocuments%28org.apache.lucene.search.Query%29>
*(Query<http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/search/Query.html>
 query) may be handy too
(but note that it will delete *all* docs that match the query).
Doron

On Tue, Apr 21, 2009 at 2:28 AM, Erick Erickson <erickerickson@gmail.com>wrote:

> I don't think you *can* create a Term that spans two fields. Perhaps
> you'd be better off just doing a search, getting the doc ID back then
> adding a new version of the document.
>
> You *could* think about reindexing your corpus and indexing an
> additional field that was the concatenation of the two fields you
> want to update by if that's a better solution.
>
> Best
> Erick
>
> On Mon, Apr 20, 2009 at 11:40 AM, Newman, Billy <Billy.Newman@itt.com
> >wrote:
>
> > What if you're unique id is a composite of two field when you create the
> > document?
> >
> > I.E.
> > doc.add(new Field("partno", "123345",
> > Field.Store.whatever, Field.Index.UN_TOKENIZED);
> > doc.add(new Field("storeLoc", "Springfield",
> > Field.Store.whatever, Field.Index.UN_TOKENIZED);
> >
> > How do you create a Term for this?  Is this possible?  Is this the
> correct
> > way to create a document that has two fields?  If so I am a little lost
> on
> > how to create a term to correctly find this.
> >
> > Thanks,
> > Billy
> >
> > -----Original Message-----
> > From: Erick Erickson [mailto:erickerickson@gmail.com]
> > Sent: Friday, April 17, 2009 8:08 PM
> > To: java-user@lucene.apache.org
> > Subject: Re: IndexWriter update method
> >
> > What you're missing is that the example has no unique ID, it wasn't
> created
> > with update in mind.
> >
> > There's no hidden magic for Lucene knowing *what* document you want
> > to have updated, you have to provide it yourself, and it should be
> unique.
> >
> > Imagine a parts catalog, or an index of a directory tree. In the parts
> > catalog,
> > you could identify the document by its part number, so you'd probably
> index
> > it something like doc.add(new Field("partno", "123345",
> > Field.Store.whatever, Field.Index.UN_TOKENIZED);
> > Indexing a directory tree you could use the complete file path similarly.
> >
> > Now, each document will have one (and only one) partno, and it'll be
> unique
> > (you really
> > don't want to tokenize this).
> >
> > To update, you'd form your term on the field "partno" and value "123345",
> > thus uniquely
> > identifying the document you want replaced, and use that term in your
> > update
> > statement.
> > Think of the Term as a unique key for the document that *you've*
> > deliberately put there.
> >
> > I'm pretty sure (but not positive) that if you update a document where
> the
> > term doesn't
> > have any matches, you'll get a simple insert, but I won't guarantee it.
> >
> > HTH
> > Erick
> >
> >
> > On Fri, Apr 17, 2009 at 9:28 PM, Newman, Billy <Billy.Newman@itt.com>
> > wrote:
> >
> > > Ok I am still confused.
> > >
> > > Looking at the examples to index a document I would do something like
> the
> > > following:
> > >        Document document = new Document();
> > >        document.add(Field.UnStored("article", article));
> > >        document.add(Field.Text("comments", comments));
> > >        Analyzer analyzer  = new StandardAnalyzer();
> > >        IndexWriter writer = new IndexWriter(indexDirectory, analyzer,
> > > false);
> > >        writer.addDocument(document);
> > >        writer.optimize();
> > >        writer.close();
> > >
> > > Now lets say that the comments can change and when they do I want to
> > update
> > > that document to contain the newly updated comments.
> > >
> > > So I would have to go back and check my index to see if that book
> already
> > > exists.
> > > Query q = new QueryParser("article", analyzer).parse(querystr);
> > > int hitsPerPage = 10;
> > > IndexSearcher searcher = new IndexSearcher(index);
> > > TopDocCollector collector = new TopDocCollector(hitsPerPage);
> > > searcher.search(q, collector);
> > > ScoreDoc[] hits = collector.topDocs().scoreDocs;
> > > if (hits!= null && hits.length > 0) {
> > >  // ?
> > >  // Then this already exists and I just want to update the comments
> > section
> > > }
> > >
> > > Does that make sense?  Am I going about this wrong?
> > >
> > > Billy
> > >
> > >
> > > ________________________________________
> > > From: Tim Williams [williamstw@gmail.com]
> > > Sent: Friday, April 17, 2009 6:05 PM
> > > To: java-user@lucene.apache.org
> > > Subject: Re: IndexWriter update method
> > >
> > > On Fri, Apr 17, 2009 at 7:27 PM, Newman, Billy <Billy.Newman@itt.com>
> > > wrote:
> > > > I am looking for info on how to use the IndexWriter.update method.  A
> > > short example of how to add a document and then later update would
> > > > be very helpful.  I get lost because I can add a document with just
> the
> > > document, but I need a document and a Term.  I am not really sure
> > > > what a Term is since I did not use a Term to create the document nor
> do
> > I
> > > see it in any of the examples of searching/adding.
> > >
> > > When you index the document, add an ID field that is unique.  Then
> > > when you go to update the document the "Term" will be the ID of the
> > > document you wish to update.  For example, you might add a URL as the
> > > unique ID, then to update it might look something like:
> > >
> > > writer.update(new Term("id","http://apache.org/lucene/index.htm"),
> doc)
> > >
> > >
> > > --tim
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> > > This e-mail and any files transmitted with it may be proprietary and
> are
> > > intended solely for the use of the individual or entity to whom they
> are
> > > addressed. If you have received this e-mail in error please notify the
> > > sender.
> > > Please note that any views or opinions presented in this e-mail are
> > solely
> > > those of the author and do not necessarily represent those of ITT
> > > Corporation. The recipient should check this e-mail and any attachments
> > for
> > > the presence of viruses. ITT accepts no liability for any damage caused
> > by
> > > any virus transmitted by this e-mail.
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--0015174be18a72523204680cff26--

From java-user-return-39841-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 09:17:30 2009
Return-Path: <java-user-return-39841-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63410 invoked from network); 21 Apr 2009 09:17:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 09:17:30 -0000
Received: (qmail 49189 invoked by uid 500); 21 Apr 2009 09:17:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49099 invoked by uid 500); 21 Apr 2009 09:17:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49089 invoked by uid 99); 21 Apr 2009 09:17:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 09:17:27 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cdoronc@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 09:17:20 +0000
Received: by ewy27 with SMTP id 27so2377512ewy.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 02:16:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=9JNpYWhdg84Ch9ioc7s/eMDaMbCszkmNswfVQEJkfFQ=;
        b=FQUfbeIsR7cnGUeigkN0ZSaY5i0BhgQ/b8JR7ixiQgziwU7mZ2N4FaAWjedNK05xUz
         D3CY8oB2PvzEE/Ga0+H4gaQ4rHrpK6XSAYmQN1o7NPxQ4IPlh3EG9gxDhNxN+nXjL9au
         h3PBzdVwKOkJeFyF/oz8UwBkBXcMaDwDqgQjY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=fVm4Oq1WtpPRFzWXfF3xuM52r4FPaLvZavdLJ9WFbB0jUuIRJrW53dMRxSTKfQuCe0
         nc9xVPIZOTpYX5a1b+pR7dOwKgaO9vIhUDOpKk8MuVYVuyd4V9WiOZHGK1GrnzSUSCfA
         iYrWwYiHKcJ37bMWrgkEomgKJd/5fMRE9rwd4=
MIME-Version: 1.0
Received: by 10.210.109.10 with SMTP id h10mr4724591ebc.45.1240305418773; Tue, 
	21 Apr 2009 02:16:58 -0700 (PDT)
In-Reply-To: <d36c28c30904190439g477f57e9s52c48ecffca5881e@mail.gmail.com>
References: <d36c28c30904190439g477f57e9s52c48ecffca5881e@mail.gmail.com>
Date: Tue, 21 Apr 2009 12:16:58 +0300
Message-ID: <e05f0fd10904210216q3c0ed85egb097dde96a0e5ab3@mail.gmail.com>
Subject: Re: changing term freq in indexing time
From: Doron Cohen <cdoronc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1e2c4e626de04680d1b09
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1e2c4e626de04680d1b09
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Depending on the problem you are trying to solve there may be other
solutions to it, not requiring setting wrong (?) values for term
frequencies.
If you can explain what you are trying to solve, people on the list may
be able to suggest such alternatives.
- Doron

On Sun, Apr 19, 2009 at 2:39 PM, liat oren <oren.liat@gmail.com> wrote:

> Hi,
>
> I would like to be able to set the term freq to differnt values at index
> time, or at search time.
>
> So if a document has the following text: 1 2, the freq of 1 will get 100
> and
> the freq of 2 will get 200. I want to avoid expanding it by writing 1 100
> times.
>
> I looked at Similarity class and wanted to override it, but the tf function
> gets only freq, so I don't know for which term this freq relates to, thus I
> can't change the value.
>
> Thanks,
> Liat
>

--000e0cd1e2c4e626de04680d1b09--

From java-user-return-39842-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 09:40:42 2009
Return-Path: <java-user-return-39842-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77578 invoked from network); 21 Apr 2009 09:40:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 09:40:42 -0000
Received: (qmail 71426 invoked by uid 500); 21 Apr 2009 09:40:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71338 invoked by uid 500); 21 Apr 2009 09:40:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71328 invoked by uid 99); 21 Apr 2009 09:40:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 09:40:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of oren.liat@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 09:40:31 +0000
Received: by ey-out-2122.google.com with SMTP id 22so202319eye.53
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 02:40:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=2vo3di2bgSOxfPTAXV1fU/FLGA/CLvdWoTd3KRDhhxA=;
        b=GCZGhNKpzVXPNf1S7VD1BJveB5Cu0Z2hRgR4HNANvv3QIgykaQD+KsAW2w5Cv65C/l
         A35XCZrbloxMZro+RNFsRyggKHmOPqLTtYFqsLxKUC7jajqK3v6PYfh32SZYrRAnErmQ
         ABpRr9Ih4FE5Ppj/iaoeWJtm+0pLdxSCa+iCg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=aYoHC9er6qQrel5lAYujadYZUCZ0e5Oda58im2Cip6C96hBkNIQAdBXQkY6EeGb5Jv
         zFSMXALTLxSH3GxIThKTVAb8eEhuhPVXauDCpKHtWwU5DZnO2NKZG6RTs9p9HUMiYIlk
         4lrqPW0uXLLs+gxHx+et6l4sNWgPDEH6Zi17w=
MIME-Version: 1.0
Received: by 10.210.17.2 with SMTP id 2mr4749556ebq.22.1240306811303; Tue, 21 
	Apr 2009 02:40:11 -0700 (PDT)
In-Reply-To: <e05f0fd10904210216q3c0ed85egb097dde96a0e5ab3@mail.gmail.com>
References: <d36c28c30904190439g477f57e9s52c48ecffca5881e@mail.gmail.com>
	 <e05f0fd10904210216q3c0ed85egb097dde96a0e5ab3@mail.gmail.com>
Date: Tue, 21 Apr 2009 12:40:11 +0300
Message-ID: <d36c28c30904210240p1271d5aahf39081570c4f7376@mail.gmail.com>
Subject: Re: changing term freq in indexing time
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174bf266e6769504680d6e57
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174bf266e6769504680d6e57
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Ok, I will explain the full 'problem' and then explain how I approach it:

Lets divide it into three steps:

1. I have a 'dictionary' of words - for every word, I have a list of worlds,
which are ids of text documents that the word appears in.
So, for example, for the word 'dog', I have '1 1600 36000' in the "worlds"
field (which are tokenized whin indexed) - which means that the word dog
appears in worlds 1, 1600 and 36000.

2. This index is used to choose synonyms for the word dog - using the
"worlds" field - I do a search on this index, giving the query "'1 1600
36000" as in input and thus get the words that are close to the word "dog".
I take the 10 closest words.

3. These 10 synonyms are then used to expand the query.

Basically, I have 2 problems in this process:

a. In the process of finding the synonyms, I would like that the frequency
of the word in each of the worlds will be taken into account. so that if
'dog' appeared 3 times in world 1, 10 times in world 1600 and 4 times in
world 36000, then it will be taken into account.
I wanted to avoid "expanding" the field to be "1 1 1 1600 1600 1600 1600
1600 1600 1600 1600 1600 1600 36000 36000 36000 36000". Accordingly I wanted
to be able to set the freq by myself.

b. In the process of using the synonyms, I wanted to be able to set a
'penalty' factor to the synonyms, together with giving differnt weight to
differnt synonyms, according to theur score. I looked at an old thread -
Search for synonyms - implemenetation for review :
.
http://mail-archives.apache.org/mod_mbox/lucene-java-user/200603.mbox/%3c39B0FB508E5D7540ACA5AD57225E150D39203D@xmail.me.corp.entopia.com%3e

I don;t know if its part of lucene now. I didn't quite understand how to use
it.
Is there a better way to approach it?

I hope I explained it well.
Thanks,
Liat



2009/4/21 Doron Cohen <cdoronc@gmail.com>

> Depending on the problem you are trying to solve there may be other
> solutions to it, not requiring setting wrong (?) values for term
> frequencies.
> If you can explain what you are trying to solve, people on the list may
> be able to suggest such alternatives.
> - Doron
>
> On Sun, Apr 19, 2009 at 2:39 PM, liat oren <oren.liat@gmail.com> wrote:
>
> > Hi,
> >
> > I would like to be able to set the term freq to differnt values at index
> > time, or at search time.
> >
> > So if a document has the following text: 1 2, the freq of 1 will get 100
> > and
> > the freq of 2 will get 200. I want to avoid expanding it by writing 1 100
> > times.
> >
> > I looked at Similarity class and wanted to override it, but the tf
> function
> > gets only freq, so I don't know for which term this freq relates to, thus
> I
> > can't change the value.
> >
> > Thanks,
> > Liat
> >
>

--0015174bf266e6769504680d6e57--

From java-user-return-39843-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 11:14:43 2009
Return-Path: <java-user-return-39843-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23022 invoked from network); 21 Apr 2009 11:14:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 11:14:42 -0000
Received: (qmail 75414 invoked by uid 500); 21 Apr 2009 11:14:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75349 invoked by uid 500); 21 Apr 2009 11:14:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75339 invoked by uid 99); 21 Apr 2009 11:14:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 11:14:40 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [62.99.145.3] (HELO mx.inode.at) (62.99.145.3)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 11:14:32 +0000
Received: from [85.126.198.254] (port=3033 helo=[192.168.1.16])
	by smartmx-03.inode.at with esmtpsa (TLS1.0:DHE_RSA_AES_256_CBC_SHA1:32)
	(Exim 4.69)
	(envelope-from <e0425863@student.tuwien.ac.at>)
	id 1LwDvV-00027S-Az
	for java-user@lucene.apache.org; Tue, 21 Apr 2009 13:14:09 +0200
Message-ID: <49EDAA7D.20806@student.tuwien.ac.at>
Date: Tue, 21 Apr 2009 13:14:05 +0200
From: =?ISO-8859-15?Q?Thomas_P=F6nitz?= <e0425863@student.tuwien.ac.at>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Creating document fields by providing termvector directly (bypassing
 the analyzing/tokenizing stage)
Content-Type: text/plain; charset=ISO-8859-15; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I have the same problem as discussed here: 
http://mail-archives.apache.org/mod_mbox/lucene-java-user/200511.mbox/%3C200511021310.18686.rj@last.fm%3E

I want to specify termvectors directly instead of constructing a dummy 
string like "a a a b b c" that will be transformed to a[3] b[2] c[1].
The old discussion had no real solution but it is also a bit outdated, 
maybe someone has a better idea now.

Greets, Thomas

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39844-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 11:50:15 2009
Return-Path: <java-user-return-39844-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30219 invoked from network); 21 Apr 2009 11:50:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 11:50:15 -0000
Received: (qmail 25396 invoked by uid 500); 21 Apr 2009 11:50:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25270 invoked by uid 500); 21 Apr 2009 11:50:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25243 invoked by uid 99); 21 Apr 2009 11:50:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 11:50:11 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Ray.Lukas@idearc.com designates 151.138.253.24 as permitted sender)
Received: from [151.138.253.24] (HELO dfw2w2ssmtp7.idearc.com) (151.138.253.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 11:50:00 +0000
Received: from dfw2w2smail8.na1.vis.verizon.com ([158.95.223.63]) by dfw2w2ssmtp7.idearc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 21 Apr 2009 06:49:38 -0500
Received: from dfw2w2smail5.na1.vis.verizon.com ([158.95.223.25]) by dfw2w2smail8.na1.vis.verizon.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 21 Apr 2009 06:49:38 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: ebook resources - including lucene in action
Date: Tue, 21 Apr 2009 06:49:37 -0500
Message-ID: <6165226BDD41964D80E23DDFF26DD5C70B787DA0@dfw2w2smail5.na1.vis.verizon.com>
In-Reply-To: <383038D1-4F81-474C-9C81-F9E5986D1B48@ehatchersolutions.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: ebook resources - including lucene in action
Thread-Index: AcnCCoR2qwWRWAieRHOB+M8qWBXpgwAaAAyg
References: <1240207086.d47619b92cebc6ebfa07969ab5370ae6@mail.in.com> <383038D1-4F81-474C-9C81-F9E5986D1B48@ehatchersolutions.com>
From: "Lukas, Ray" <Ray.Lukas@idearc.com>
To: <java-user@lucene.apache.org>,
	<solr-user@lucene.apache.org>
Cc: "wu fuheng" <wufuheng@gmail.com>,
	"nutch-user" <nutch-user@lucene.apache.org>,
	<core-user@hadoop.apache.org>
X-OriginalArrivalTime: 21 Apr 2009 11:49:38.0306 (UTC) FILETIME=[3FBDA620:01C9C277]
X-Virus-Checked: Checked by ClamAV on apache.org

Erik is right!!
We should bane together and bring legal action against these dirtballs..
Do you like it when someone steals your work, takes credit for it, and
turns a profit off of it.
More than giving their lives to write this content, they are also
contributors to the very software that we use, and depend on. It is not
easy writing a book, Lucene in Action is a pretty good book and I
shutter to think of the massive effort it took, and is taking to
create.. This is a major source of income that has been earn by, and
deserved by, these authors/contributors. Stealing this work is not only
a sin, it is a total disrespect for the very people we count on.=20
Certainly the internet provider of this site can be notified and made to
shut it down. These dirtball people are making money off of the work
that they have stolen.. How can this be right..=20
Open source software is a major assets for our industry and these people
have attacked it. They should, and justice indeed demands that, they
feel some pain.
We use this software, which has been freely written and freely given to
us to use. All the contributors ask is the right to earn a living, a
right that they more than deserver considering the contribution that
they have made. Speaking just for myself, I hope that they earn a good
living. For me, speaking for myself, and I doubt seriously if I am alone
in this, most of my projects could not be done without these open source
resources (TomCat, Lucene, Nutch, PostGres, MySql, Drools, etc).. Where
would we be without these.. Do you know how much the licensing fees
would be for these things from a commercial vendor? I just got a quote
for an enterprise license for one of these from a commercial vendor at
500K. I will let you speak for yourselves. The people that created these
systems deserve a certain amount of respect and justice. They are
stealing and harming the very people that make our projects and the
companies we work for possible.=20
Is a simple 30 or 40 dollars in recognition for what these guys have
done to much to ask? To do what is right...=20
Ray
-----Original Message-----
From: Erik Hatcher [mailto:erik@ehatchersolutions.com]=20
Sent: Monday, April 20, 2009 6:50 PM
To: solr-user@lucene.apache.org
Cc: wu fuheng; nutch-user; java-user@lucene.apache.org;
core-user@hadoop.apache.org; solr-user@lucene.apache.org
Subject: Re: ebook resources - including lucene in action

It is not legal to share purchased e-books in this manner.  Please =20
purchase copies of the books you read, otherwise authors have very =20
little incentive to dedicate months (14 months in the case of Lucene =20
in Action, first edition) of their lives to writing this content.

	Erik

On Apr 20, 2009, at 1:58 AM, Saurabh Bhutyani wrote:

> Check out this site: www.downloadsearchengine.comIt allows to search =20
> and download pdf ebooks, ppts, doc, mp3, torrents, rapidshare links =20
> etc. Original message From:wu fuheng< wufuheng@gmail.com >Date: 20 =20
> Apr 09 09:28:56Subject:ebook resources  including lucene in =20
> actionTo: nutchuser@lucene.apache.orgwelcome to download ....


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39845-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 12:04:01 2009
Return-Path: <java-user-return-39845-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33202 invoked from network); 21 Apr 2009 12:04:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 12:04:01 -0000
Received: (qmail 52286 invoked by uid 500); 21 Apr 2009 12:03:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52164 invoked by uid 500); 21 Apr 2009 12:03:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52137 invoked by uid 99); 21 Apr 2009 12:03:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 12:03:59 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anshumg@gmail.com designates 209.85.198.225 as permitted sender)
Received: from [209.85.198.225] (HELO rv-out-0506.google.com) (209.85.198.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 12:03:52 +0000
Received: by rv-out-0506.google.com with SMTP id b25so1830724rvf.5
        for <multiple recipients>; Tue, 21 Apr 2009 05:03:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:cc:content-type;
        bh=wiSK1G0/oCszVzHzkItsO4TpMhieY0PY4Y47o2nAdfw=;
        b=O9Jbd9TCIYFgiPIth2MlxwIJdzoDrDV/gbct1G7rU1R9cLsrZ19/oNN9o6uCwLHPrE
         JHc6uLsldXTQZdHL9f5q1gNdJX7E2m+pgbyXzrRM0ZBJmvj7mNd8doaOkNwhEk9v4LKB
         +LUd3EdWwANnMHyNQF6ji9HOzT8jh11Frt6yw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        b=S9rlzwTxCVbyjwExf28ixJEL6ZsnAy3raEmirz34QLZL3SEREV/IjIN/1kkDQ1zG5V
         Vc2XksTtflHyDsvbRGmJ/rcPFo34EjpmQT+g/dRUS46t7+5I9yadJpoj0AEGm1JNXyu5
         lEy4j9X1jYpmTtSSe+RU9Jv+lkIzjz3ceTUkA=
MIME-Version: 1.0
Received: by 10.140.134.10 with SMTP id h10mr2891591rvd.93.1240315411750; Tue, 
	21 Apr 2009 05:03:31 -0700 (PDT)
In-Reply-To: <6165226BDD41964D80E23DDFF26DD5C70B787DA0@dfw2w2smail5.na1.vis.verizon.com>
References: <1240207086.d47619b92cebc6ebfa07969ab5370ae6@mail.in.com>
	 <383038D1-4F81-474C-9C81-F9E5986D1B48@ehatchersolutions.com>
	 <6165226BDD41964D80E23DDFF26DD5C70B787DA0@dfw2w2smail5.na1.vis.verizon.com>
Date: Tue, 21 Apr 2009 17:33:31 +0530
Message-ID: <867513fe0904210503i3d25fe96w7aa7332258618bdd@mail.gmail.com>
Subject: Re: ebook resources - including lucene in action
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Cc: solr-user@lucene.apache.org, wu fuheng <wufuheng@gmail.com>, 
	nutch-user <nutch-user@lucene.apache.org>, core-user@hadoop.apache.org
Content-Type: multipart/alternative; boundary=000e0cd2955486e0a204680f6f85
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd2955486e0a204680f6f85
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

All that is said is so right. Moreover, though I doubt, in case someone can
not really shell out that much money, they could have asked Otis/Erik or the
list to provide with some sort of a discount code for the same. Each cent
paid for the book is very well deserved.
There should be sharing of such websites here, but not to pick pirated
versions of these amazing works but for people here to jointly take action
against such a thing. Let us rightfully support open source.

--
Anshum Gupta
Naukri Labs!
while(1) { source="open"; }
http://ai-cafe.blogspot.com


The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Tue, Apr 21, 2009 at 5:19 PM, Lukas, Ray <Ray.Lukas@idearc.com> wrote:

> Erik is right!!
> We should bane together and bring legal action against these dirtballs..
> Do you like it when someone steals your work, takes credit for it, and
> turns a profit off of it.
> More than giving their lives to write this content, they are also
> contributors to the very software that we use, and depend on. It is not
> easy writing a book, Lucene in Action is a pretty good book and I
> shutter to think of the massive effort it took, and is taking to
> create.. This is a major source of income that has been earn by, and
> deserved by, these authors/contributors. Stealing this work is not only
> a sin, it is a total disrespect for the very people we count on.
> Certainly the internet provider of this site can be notified and made to
> shut it down. These dirtball people are making money off of the work
> that they have stolen.. How can this be right..
> Open source software is a major assets for our industry and these people
> have attacked it. They should, and justice indeed demands that, they
> feel some pain.
> We use this software, which has been freely written and freely given to
> us to use. All the contributors ask is the right to earn a living, a
> right that they more than deserver considering the contribution that
> they have made. Speaking just for myself, I hope that they earn a good
> living. For me, speaking for myself, and I doubt seriously if I am alone
> in this, most of my projects could not be done without these open source
> resources (TomCat, Lucene, Nutch, PostGres, MySql, Drools, etc).. Where
> would we be without these.. Do you know how much the licensing fees
> would be for these things from a commercial vendor? I just got a quote
> for an enterprise license for one of these from a commercial vendor at
> 500K. I will let you speak for yourselves. The people that created these
> systems deserve a certain amount of respect and justice. They are
> stealing and harming the very people that make our projects and the
> companies we work for possible.
> Is a simple 30 or 40 dollars in recognition for what these guys have
> done to much to ask? To do what is right...
> Ray
> -----Original Message-----
> From: Erik Hatcher [mailto:erik@ehatchersolutions.com]
> Sent: Monday, April 20, 2009 6:50 PM
> To: solr-user@lucene.apache.org
> Cc: wu fuheng; nutch-user; java-user@lucene.apache.org;
> core-user@hadoop.apache.org; solr-user@lucene.apache.org
> Subject: Re: ebook resources - including lucene in action
>
> It is not legal to share purchased e-books in this manner.  Please
> purchase copies of the books you read, otherwise authors have very
> little incentive to dedicate months (14 months in the case of Lucene
> in Action, first edition) of their lives to writing this content.
>
>        Erik
>
> On Apr 20, 2009, at 1:58 AM, Saurabh Bhutyani wrote:
>
> > Check out this site: www.downloadsearchengine.comIt allows to search
> > and download pdf ebooks, ppts, doc, mp3, torrents, rapidshare links
> > etc. Original message From:wu fuheng< wufuheng@gmail.com >Date: 20
> > Apr 09 09:28:56Subject:ebook resources  including lucene in
> > actionTo: nutchuser@lucene.apache.orgwelcome to download ....
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd2955486e0a204680f6f85--

From java-user-return-39846-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 12:09:18 2009
Return-Path: <java-user-return-39846-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34277 invoked from network); 21 Apr 2009 12:09:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 12:09:17 -0000
Received: (qmail 62114 invoked by uid 500); 21 Apr 2009 12:09:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62043 invoked by uid 500); 21 Apr 2009 12:09:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62033 invoked by uid 99); 21 Apr 2009 12:09:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 12:09:15 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of cdoronc@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 12:09:06 +0000
Received: by ewy27 with SMTP id 27so2446993ewy.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 05:08:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=d85T52yyZ6DIjiliOOY/TEHdGRhz9NccTXrlgb2q0/I=;
        b=uz/rVS9CGatjBT6kUe+tLCFkCRgBuaCxVo6wRBxxjJ/4EJd8cZd4S4ponm2CCnvE7N
         /7VRgFzl7sj24NeiUzP4AsNu5VaJ8oELSFYhSeGDG6ybUMC/bBp5TiEvuMF+5IvcIEHg
         P5gJCMRjpoBJoe5nxfa8UXg5ltsWTMo6pS/xw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=OVgK8P6V0Sh1It0CtsgurFXaxB/G2SD8AcfoznQt4hmXm0DIm8gb+iS2vfabW8WKav
         yq6z4oAz2e2NNq2GygLC/uviBnb4ZuX30ap5O9KB8jjhfe5BZiceDGin+UGOLAxTrd0R
         VVg6XbPH8e+FJoldPF7NkhTQDDQ1mraqevv/k=
MIME-Version: 1.0
Received: by 10.210.21.6 with SMTP id 6mr4905385ebu.26.1240315726257; Tue, 21 
	Apr 2009 05:08:46 -0700 (PDT)
In-Reply-To: <d36c28c30904210240p1271d5aahf39081570c4f7376@mail.gmail.com>
References: <d36c28c30904190439g477f57e9s52c48ecffca5881e@mail.gmail.com>
	 <e05f0fd10904210216q3c0ed85egb097dde96a0e5ab3@mail.gmail.com>
	 <d36c28c30904210240p1271d5aahf39081570c4f7376@mail.gmail.com>
Date: Tue, 21 Apr 2009 15:08:46 +0300
Message-ID: <e05f0fd10904210508q59bd86b1j479aac3b1be41f43@mail.gmail.com>
Subject: Re: changing term freq in indexing time
From: Doron Cohen <cdoronc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1ea2a45df0404680f8213
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1ea2a45df0404680f8213
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Liat, there are two packages under Lucene's contrib that deals with
Synonyms - that is contrib/memory and contrib/wordnet - which you
may find useful. I never used these two but they seem relevant to what
you are trying to achieve.

Anyhow, it seems you compute the synonyms for word w are those
that appear in the same set of documents ('worlds') as w, and you find
this set by (a) indexing an inverse of the collection (docs become words
and words become docs) and (b) using docs(w) as query do find syns(w).

I assume that your 'worlds' are small, each containing only a small
set of a few related words, otherwise I would have two
concerns with this approach: (a) scalability (b) in a large doc (world) this
approach ignores the vicinity of words which seems to me important
to their likelihood as synonyms

Assuming you are okay here, and going back to original question of
altering the term frequency, perhaps taking the (search) scores of the
returned synonyms (which you find by search) is better than just
using their frequency? If you find this approach valid, then at least for
some queries you should be able to use queries boosts. For example
create a BooleanQuery, add to it a TermQuery for each synonym,
but set the boost of the TermQuery according to the synonnym score.
This is also where you could "punish" synnonyms comparing to the
original word. This will only help with queries with contruction API
that takes (sub) queries as input (so it will not help with a PhraseQuery).

- Doron

On Tue, Apr 21, 2009 at 12:40 PM, liat oren <oren.liat@gmail.com> wrote:

> Ok, I will explain the full 'problem' and then explain how I approach it:
>
> Lets divide it into three steps:
>
> 1. I have a 'dictionary' of words - for every word, I have a list of
> worlds,
> which are ids of text documents that the word appears in.
> So, for example, for the word 'dog', I have '1 1600 36000' in the "worlds"
> field (which are tokenized whin indexed) - which means that the word dog
> appears in worlds 1, 1600 and 36000.
>
> 2. This index is used to choose synonyms for the word dog - using the
> "worlds" field - I do a search on this index, giving the query "'1 1600
> 36000" as in input and thus get the words that are close to the word "dog".
> I take the 10 closest words.
>
> 3. These 10 synonyms are then used to expand the query.
>
> Basically, I have 2 problems in this process:
>
> a. In the process of finding the synonyms, I would like that the frequency
> of the word in each of the worlds will be taken into account. so that if
> 'dog' appeared 3 times in world 1, 10 times in world 1600 and 4 times in
> world 36000, then it will be taken into account.
> I wanted to avoid "expanding" the field to be "1 1 1 1600 1600 1600 1600
> 1600 1600 1600 1600 1600 1600 36000 36000 36000 36000". Accordingly I
> wanted
> to be able to set the freq by myself.
>
> b. In the process of using the synonyms, I wanted to be able to set a
> 'penalty' factor to the synonyms, together with giving differnt weight to
> differnt synonyms, according to theur score. I looked at an old thread -
> Search for synonyms - implemenetation for review :
> .
>
> http://mail-archives.apache.org/mod_mbox/lucene-java-user/200603.mbox/%3c39B0FB508E5D7540ACA5AD57225E150D39203D@xmail.me.corp.entopia.com%3e
>
> I don;t know if its part of lucene now. I didn't quite understand how to
> use
> it.
> Is there a better way to approach it?
>
> I hope I explained it well.
> Thanks,
> Liat
>
>
>
> 2009/4/21 Doron Cohen <cdoronc@gmail.com>
>
> > Depending on the problem you are trying to solve there may be other
> > solutions to it, not requiring setting wrong (?) values for term
> > frequencies.
> > If you can explain what you are trying to solve, people on the list may
> > be able to suggest such alternatives.
> > - Doron
> >
> > On Sun, Apr 19, 2009 at 2:39 PM, liat oren <oren.liat@gmail.com> wrote:
> >
> > > Hi,
> > >
> > > I would like to be able to set the term freq to differnt values at
> index
> > > time, or at search time.
> > >
> > > So if a document has the following text: 1 2, the freq of 1 will get
> 100
> > > and
> > > the freq of 2 will get 200. I want to avoid expanding it by writing 1
> 100
> > > times.
> > >
> > > I looked at Similarity class and wanted to override it, but the tf
> > function
> > > gets only freq, so I don't know for which term this freq relates to,
> thus
> > I
> > > can't change the value.
> > >
> > > Thanks,
> > > Liat
> > >
> >
>

--000e0cd1ea2a45df0404680f8213--

From java-user-return-39847-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 13:13:33 2009
Return-Path: <java-user-return-39847-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71871 invoked from network); 21 Apr 2009 13:13:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 13:13:33 -0000
Received: (qmail 73473 invoked by uid 500); 21 Apr 2009 13:13:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73405 invoked by uid 500); 21 Apr 2009 13:13:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73239 invoked by uid 99); 21 Apr 2009 13:13:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 13:13:26 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [151.190.254.13] (HELO edge.itt.com) (151.190.254.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 13:13:18 +0000
Received: from fwexhub3.itt.net (10.32.76.113) by edge.itt.com (10.32.16.13)
 with Microsoft SMTP Server (TLS) id 8.1.340.0; Tue, 21 Apr 2009 09:13:10
 -0400
Received: from IIWCBO-EHUB1.iiw.de.ittind.com (10.244.2.24) by
 fwexhub3.itt.net (10.32.76.113) with Microsoft SMTP Server (TLS) id
 8.1.340.0; Tue, 21 Apr 2009 09:12:55 -0400
Received: from iiwcbo-emb1.iiw.de.ittind.com ([10.244.2.29]) by
 IIWCBO-Ehub1.iiw.de.ittind.com ([::1]) with mapi; Tue, 21 Apr 2009 09:12:54
 -0400
From: "Newman, Billy" <Billy.Newman@itt.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Tue, 21 Apr 2009 09:12:52 -0400
Subject: RE: IndexWriter update method
Thread-Topic: IndexWriter update method
Thread-Index: AcnCYORmKehOL0/CS9GpRbqU6KfyLwAIagBg
Message-ID: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D368AB247@IIWCBO-EMB1.iiw.de.ittind.com>
References: <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79B@IIWCBO-EMB1.iiw.de.ittind.com>
	 <499888440904171705s467e3bap95598f3f870c20b3@mail.gmail.com>
	 <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D3697D79D@IIWCBO-EMB1.iiw.de.ittind.com>
	 <359a92830904171907j2b8fdb91kbd762c905240b3df@mail.gmail.com>
	 <F0DB6EA8DC0F594B83F2CA60C7E4E8BA2D368AB230@IIWCBO-EMB1.iiw.de.ittind.com>
	 <359a92830904201628o2fa6684cr99561a97f0442002@mail.gmail.com>
 <e05f0fd10904210209obecd8c1s56731755d90ba963@mail.gmail.com>
In-Reply-To: <e05f0fd10904210209obecd8c1s56731755d90ba963@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Yeah I was hoping to change the code to use the update method after I upgra=
ded from 1.4.3 but doesn't look feasible.   I will just continue to find th=
e doc and delete it, then re-insert it.  Thanks for all the help guys!

-----Original Message-----
From: Doron Cohen [mailto:cdoronc@gmail.com]=20
Sent: Tuesday, April 21, 2009 3:09 AM
To: java-user@lucene.apache.org
Subject: Re: IndexWriter update method

*IndexWriter.deleteDocuments<http://lucene.apache.org/java/2_4_1/api/core/o=
rg/apache/lucene/index/IndexWriter.html#deleteDocuments%28org.apache.lucene=
.search.Query%29>
*(Query<http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/sear=
ch/Query.html>
 query) may be handy too
(but note that it will delete *all* docs that match the query).
Doron

On Tue, Apr 21, 2009 at 2:28 AM, Erick Erickson <erickerickson@gmail.com>wr=
ote:

> I don't think you *can* create a Term that spans two fields. Perhaps
> you'd be better off just doing a search, getting the doc ID back then
> adding a new version of the document.
>
> You *could* think about reindexing your corpus and indexing an
> additional field that was the concatenation of the two fields you
> want to update by if that's a better solution.
>
> Best
> Erick
>
> On Mon, Apr 20, 2009 at 11:40 AM, Newman, Billy <Billy.Newman@itt.com
> >wrote:
>
> > What if you're unique id is a composite of two field when you create th=
e
> > document?
> >
> > I.E.
> > doc.add(new Field("partno", "123345",
> > Field.Store.whatever, Field.Index.UN_TOKENIZED);
> > doc.add(new Field("storeLoc", "Springfield",
> > Field.Store.whatever, Field.Index.UN_TOKENIZED);
> >
> > How do you create a Term for this?  Is this possible?  Is this the
> correct
> > way to create a document that has two fields?  If so I am a little lost
> on
> > how to create a term to correctly find this.
> >
> > Thanks,
> > Billy
> >
> > -----Original Message-----
> > From: Erick Erickson [mailto:erickerickson@gmail.com]
> > Sent: Friday, April 17, 2009 8:08 PM
> > To: java-user@lucene.apache.org
> > Subject: Re: IndexWriter update method
> >
> > What you're missing is that the example has no unique ID, it wasn't
> created
> > with update in mind.
> >
> > There's no hidden magic for Lucene knowing *what* document you want
> > to have updated, you have to provide it yourself, and it should be
> unique.
> >
> > Imagine a parts catalog, or an index of a directory tree. In the parts
> > catalog,
> > you could identify the document by its part number, so you'd probably
> index
> > it something like doc.add(new Field("partno", "123345",
> > Field.Store.whatever, Field.Index.UN_TOKENIZED);
> > Indexing a directory tree you could use the complete file path similarl=
y.
> >
> > Now, each document will have one (and only one) partno, and it'll be
> unique
> > (you really
> > don't want to tokenize this).
> >
> > To update, you'd form your term on the field "partno" and value "123345=
",
> > thus uniquely
> > identifying the document you want replaced, and use that term in your
> > update
> > statement.
> > Think of the Term as a unique key for the document that *you've*
> > deliberately put there.
> >
> > I'm pretty sure (but not positive) that if you update a document where
> the
> > term doesn't
> > have any matches, you'll get a simple insert, but I won't guarantee it.
> >
> > HTH
> > Erick
> >
> >
> > On Fri, Apr 17, 2009 at 9:28 PM, Newman, Billy <Billy.Newman@itt.com>
> > wrote:
> >
> > > Ok I am still confused.
> > >
> > > Looking at the examples to index a document I would do something like
> the
> > > following:
> > >        Document document =3D new Document();
> > >        document.add(Field.UnStored("article", article));
> > >        document.add(Field.Text("comments", comments));
> > >        Analyzer analyzer  =3D new StandardAnalyzer();
> > >        IndexWriter writer =3D new IndexWriter(indexDirectory, analyze=
r,
> > > false);
> > >        writer.addDocument(document);
> > >        writer.optimize();
> > >        writer.close();
> > >
> > > Now lets say that the comments can change and when they do I want to
> > update
> > > that document to contain the newly updated comments.
> > >
> > > So I would have to go back and check my index to see if that book
> already
> > > exists.
> > > Query q =3D new QueryParser("article", analyzer).parse(querystr);
> > > int hitsPerPage =3D 10;
> > > IndexSearcher searcher =3D new IndexSearcher(index);
> > > TopDocCollector collector =3D new TopDocCollector(hitsPerPage);
> > > searcher.search(q, collector);
> > > ScoreDoc[] hits =3D collector.topDocs().scoreDocs;
> > > if (hits!=3D null && hits.length > 0) {
> > >  // ?
> > >  // Then this already exists and I just want to update the comments
> > section
> > > }
> > >
> > > Does that make sense?  Am I going about this wrong?
> > >
> > > Billy
> > >
> > >
> > > ________________________________________
> > > From: Tim Williams [williamstw@gmail.com]
> > > Sent: Friday, April 17, 2009 6:05 PM
> > > To: java-user@lucene.apache.org
> > > Subject: Re: IndexWriter update method
> > >
> > > On Fri, Apr 17, 2009 at 7:27 PM, Newman, Billy <Billy.Newman@itt.com>
> > > wrote:
> > > > I am looking for info on how to use the IndexWriter.update method. =
 A
> > > short example of how to add a document and then later update would
> > > > be very helpful.  I get lost because I can add a document with just
> the
> > > document, but I need a document and a Term.  I am not really sure
> > > > what a Term is since I did not use a Term to create the document no=
r
> do
> > I
> > > see it in any of the examples of searching/adding.
> > >
> > > When you index the document, add an ID field that is unique.  Then
> > > when you go to update the document the "Term" will be the ID of the
> > > document you wish to update.  For example, you might add a URL as the
> > > unique ID, then to update it might look something like:
> > >
> > > writer.update(new Term("id","http://apache.org/lucene/index.htm"),
> doc)
> > >
> > >
> > > --tim
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> > > This e-mail and any files transmitted with it may be proprietary and
> are
> > > intended solely for the use of the individual or entity to whom they
> are
> > > addressed. If you have received this e-mail in error please notify th=
e
> > > sender.
> > > Please note that any views or opinions presented in this e-mail are
> > solely
> > > those of the author and do not necessarily represent those of ITT
> > > Corporation. The recipient should check this e-mail and any attachmen=
ts
> > for
> > > the presence of viruses. ITT accepts no liability for any damage caus=
ed
> > by
> > > any virus transmitted by this e-mail.
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39848-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 13:44:59 2009
Return-Path: <java-user-return-39848-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1067 invoked from network); 21 Apr 2009 13:44:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 13:44:58 -0000
Received: (qmail 31718 invoked by uid 500); 21 Apr 2009 13:44:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31624 invoked by uid 500); 21 Apr 2009 13:44:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31614 invoked by uid 99); 21 Apr 2009 13:44:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 13:44:56 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 13:44:49 +0000
Received: by ewy27 with SMTP id 27so2494867ewy.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 06:44:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=YaXdMMo0+MQuELj78K5Ine3U/tSAJMCq/9Iv8iaYx6A=;
        b=GS0TwUmLSEUqeaDlFIhPd4uJ/GsJrgcy7aSe5MKCouWao+pHG/QMIZ/aNci4X4fhmH
         EjO3AkUpdFHFDRyDSAZ8ufAZ48jw/cidjbHljTGHtPDjgIrqmt0acq/Y2a3if1YA+lza
         q2qEJDL902KdWKmwaYAAtj5mnBVBcKT3HIpE0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Gm8Arh02WqwLW36H/9YgZLJsycDp1u4yJCGg5n0ce4vY7TUtpkK8At0DB0GDhOHA9F
         qLfVxeLx1pHZgMrsHMWCnO5GghsACwrD2koV75PamnZCoIpyLMp1oIr7iw4ijAIK0m/6
         UZnDUf+eaGUbDGW/XoQarUUGKHmt0LJMZ46H4=
MIME-Version: 1.0
Received: by 10.210.71.12 with SMTP id t12mr4075306eba.42.1240321467556; Tue, 
	21 Apr 2009 06:44:27 -0700 (PDT)
In-Reply-To: <e05f0fd10904210508q59bd86b1j479aac3b1be41f43@mail.gmail.com>
References: <d36c28c30904190439g477f57e9s52c48ecffca5881e@mail.gmail.com>
	 <e05f0fd10904210216q3c0ed85egb097dde96a0e5ab3@mail.gmail.com>
	 <d36c28c30904210240p1271d5aahf39081570c4f7376@mail.gmail.com>
	 <e05f0fd10904210508q59bd86b1j479aac3b1be41f43@mail.gmail.com>
Date: Tue, 21 Apr 2009 16:44:27 +0300
Message-ID: <d36c28c30904210644x2ba3c6f6mbd5c306def48078b@mail.gmail.com>
Subject: Re: changing term freq in indexing time
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1d55a7b2548046810d807
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1d55a7b2548046810d807
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Doron,

Thank you very much for the elaborated answer!

About the Synonyms, I can't use Wordnet as I have my own list of synonyms. I
will look at contrib/memory and see what it does.

You understood correctly the process of using the inverse doc. About the two
problems you mentioned: scalability and ignoring the vicinity of words -
scalability - this is the reason I wanted to set the frequencies of the
terms. The use of the frequencies will be used at this stage, not at the
stage of using the synonyms. When I use the sysnonyms, I want to use the
score as you suggested below.
Here, I have for every word, in which worlds they appear. Currently every
world appears once in a word. However, I would like it to appear the number
if times as the frequency of the word in the world. In order to avoid
writing the world several times in the world field, I would like to be able
to set the freq of the specific world accordng to the freq of the word at
this world without actually writing it x times (for scalability and index
size and performance issues)
So if dog appears 10 times in world 1 and 5 times in world 2, and cat
appears 5 times in world 1, then I want these frequencies to be taken into
account when computing how the word dog and cat are close. BUT I don't want
to write world 1 10 times in word dog and 5 times in word cat, but only once
and to update the termVector so that the frequency will get 10 and 5
respectively.
So the *generation* of the synonyms will take into account the frequencies

The vicinity of words - is there any better way to take it in account?

About the suggestion of using term boosting that will use the score of the
synonyms - if I want to query "big white dogs" and I have the following
synonyms:
big - big (1.0), large (0.9), huge (0.6)
white - white (1.0), color (0.5) offwhite (0.8)
dog - dog (1.0)
So this is the way to do it? :

   BooleanQuery bq = new  BooleanQuery();
          TermQuery tq = new TermQuery(new Term("text", "big"));
          tq.setBoost((float)1.0);
                   bq.add(bq, false, false);
   tq = new TermQuery(new Term(("text", "large"));
             tq.setBoost((float)0.9);
                             bq.add(bq, false);
  tq = new TermQuery(new Term(("text", "huge"));
             tq.setBoost((float)0.6);
                             bq.add(bq, false);

 tq = new TermQuery(new Term(("text", "white"));
             tq.setBoost((float)1.0);
                             bq.add(bq, false);
 tq = new TermQuery(new Term(("text", "color"));
             tq.setBoost((float)0.5);
                             bq.add(bq, false);
// etc
   IndexSearcher searcher = new IndexSearcher("TestSearchIndex");
                   Hits hits = searcher.search(bq);


how the use of booleanQuery will also look at the position of the words? I
remember I read about the score that takes into account also  the position
of the term, but I didn't see this factor in the score formula
Thanks again, it is very helpful,
Liat
2009/4/21 Doron Cohen <cdoronc@gmail.com>

> Hi Liat, there are two packages under Lucene's contrib that deals with
> Synonyms - that is contrib/memory and contrib/wordnet - which you
> may find useful. I never used these two but they seem relevant to what
> you are trying to achieve.
>
> Anyhow, it seems you compute the synonyms for word w are those
> that appear in the same set of documents ('worlds') as w, and you find
> this set by (a) indexing an inverse of the collection (docs become words
> and words become docs) and (b) using docs(w) as query do find syns(w).
>
> I assume that your 'worlds' are small, each containing only a small
> set of a few related words, otherwise I would have two
> concerns with this approach: (a) scalability (b) in a large doc (world)
> this
> approach ignores the vicinity of words which seems to me important
> to their likelihood as synonyms
>
> Assuming you are okay here, and going back to original question of
> altering the term frequency, perhaps taking the (search) scores of the
> returned synonyms (which you find by search) is better than just
> using their frequency? If you find this approach valid, then at least for
> some queries you should be able to use queries boosts. For example
> create a BooleanQuery, add to it a TermQuery for each synonym,
> but set the boost of the TermQuery according to the synonnym score.
> This is also where you could "punish" synnonyms comparing to the
> original word. This will only help with queries with contruction API
> that takes (sub) queries as input (so it will not help with a PhraseQuery).
>
> - Doron
>
> On Tue, Apr 21, 2009 at 12:40 PM, liat oren <oren.liat@gmail.com> wrote:
>
> > Ok, I will explain the full 'problem' and then explain how I approach it:
> >
> > Lets divide it into three steps:
> >
> > 1. I have a 'dictionary' of words - for every word, I have a list of
> > worlds,
> > which are ids of text documents that the word appears in.
> > So, for example, for the word 'dog', I have '1 1600 36000' in the
> "worlds"
> > field (which are tokenized whin indexed) - which means that the word dog
> > appears in worlds 1, 1600 and 36000.
> >
> > 2. This index is used to choose synonyms for the word dog - using the
> > "worlds" field - I do a search on this index, giving the query "'1 1600
> > 36000" as in input and thus get the words that are close to the word
> "dog".
> > I take the 10 closest words.
> >
> > 3. These 10 synonyms are then used to expand the query.
> >
> > Basically, I have 2 problems in this process:
> >
> > a. In the process of finding the synonyms, I would like that the
> frequency
> > of the word in each of the worlds will be taken into account. so that if
> > 'dog' appeared 3 times in world 1, 10 times in world 1600 and 4 times in
> > world 36000, then it will be taken into account.
> > I wanted to avoid "expanding" the field to be "1 1 1 1600 1600 1600 1600
> > 1600 1600 1600 1600 1600 1600 36000 36000 36000 36000". Accordingly I
> > wanted
> > to be able to set the freq by myself.
> >
> > b. In the process of using the synonyms, I wanted to be able to set a
> > 'penalty' factor to the synonyms, together with giving differnt weight to
> > differnt synonyms, according to theur score. I looked at an old thread -
> > Search for synonyms - implemenetation for review :
> > .
> >
> >
> http://mail-archives.apache.org/mod_mbox/lucene-java-user/200603.mbox/%3c39B0FB508E5D7540ACA5AD57225E150D39203D@xmail.me.corp.entopia.com%3e
> >
> > I don;t know if its part of lucene now. I didn't quite understand how to
> > use
> > it.
> > Is there a better way to approach it?
> >
> > I hope I explained it well.
> > Thanks,
> > Liat
> >
> >
> >
> > 2009/4/21 Doron Cohen <cdoronc@gmail.com>
> >
> > > Depending on the problem you are trying to solve there may be other
> > > solutions to it, not requiring setting wrong (?) values for term
> > > frequencies.
> > > If you can explain what you are trying to solve, people on the list may
> > > be able to suggest such alternatives.
> > > - Doron
> > >
> > > On Sun, Apr 19, 2009 at 2:39 PM, liat oren <oren.liat@gmail.com>
> wrote:
> > >
> > > > Hi,
> > > >
> > > > I would like to be able to set the term freq to differnt values at
> > index
> > > > time, or at search time.
> > > >
> > > > So if a document has the following text: 1 2, the freq of 1 will get
> > 100
> > > > and
> > > > the freq of 2 will get 200. I want to avoid expanding it by writing 1
> > 100
> > > > times.
> > > >
> > > > I looked at Similarity class and wanted to override it, but the tf
> > > function
> > > > gets only freq, so I don't know for which term this freq relates to,
> > thus
> > > I
> > > > can't change the value.
> > > >
> > > > Thanks,
> > > > Liat
> > > >
> > >
> >
>

--000e0cd1d55a7b2548046810d807--

From java-user-return-39849-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 13:55:28 2009
Return-Path: <java-user-return-39849-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13132 invoked from network); 21 Apr 2009 13:55:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 13:55:27 -0000
Received: (qmail 56283 invoked by uid 500); 21 Apr 2009 13:55:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56216 invoked by uid 500); 21 Apr 2009 13:55:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56206 invoked by uid 99); 21 Apr 2009 13:55:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 13:55:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 13:55:15 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: RE: Faceting, Sort and DocIDSet
Date: Tue, 21 Apr 2009 09:54:50 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2896@mail02.tveyes.com>
In-Reply-To: <23143797.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Faceting, Sort and DocIDSet
thread-index: AcnB8qk/zkfPKcO9T3WWVfXRR4mMoQAkpnCA
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC266E@mail02.tveyes.com> <23113784.post@talk.nabble.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2743@mail02.tveyes.com> <8f0ad1f30904200726n18b00ae7rcd52f629491a8e62@mail.gmail.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2762@mail02.tveyes.com> <23143797.post@talk.nabble.com>
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Karsten,

You're right, 300 facets would be a lot. Hehe. I have one facet with
about three hundred potential values. What I've done is create an
FacetManager who, in another thread, sets up an map of ~300 OpenBitSets.
One bitset for each possible value of the facet.

Then, rather than using an iterative cardinality comparison, I use a
HitCollector to create an set of counters.=20

public void collect(int doc, float score) {
   //we don't care about score, all we care about is docID;
   //we need to find out if this document is in any of our facets... if
it is, increment a counter
   for(SearchFacet sfTemp : arrayOfSearchFacetsValues) {
      if(sfTemp.getBitSet().fastGet(doc)) {
         //this is a hit!
         long lCount =3D htFacetResults.get(sfTemp.getTerm().text());
         htFacetResults.put(sfTemp.getTerm().text(), lCount+1);
			=09
         //this code is designed for mutually exclusive=20
         //facet values... in that scenario, a hit here means
         //that we can't have a hit anywhere else, so we should
         //break.
         break;
      }
   }
}

Here I seem to be running into a performance issue. It seems that when a
resultset is small (~10,000) this method greatly outperforms the
iterating cardinality check. However, when the resultset is large
(300,000) the HitCollector takes twice as long to process the resultset
as the other solution.

Our total index typically contains about 100M documents. This is broken
up into four monthly indexes each containing 250K documents. And a
typical search returns < 120,000 results. Lousy searches return more
results (IE "obama" returns nearly 800,000 documents).

At the moment we're using ParalellMultiSearcher. When I do a search,
across four montly indexes, ordered by INDEXORDER what I get is all of
the hits that happened on the first of any month, then all the hits that
happened on the second of any month. Does 'starts' behave the same way
in ParallelMultiSearcher?

Thanks for all your input!

-Dave

-----Original Message-----
From: Karsten F. [mailto:karsten-lucene@fiz-technik.de]=20
Sent: Monday, April 20, 2009 4:00 PM
To: java-user@lucene.apache.org
Subject: RE: Faceting, Sort and DocIDSet


Hi David,

correct: you should avoid reading the content of a document inside a
hitcollector.
Normaly that means to cache all you need in main memory. Very simple and
fast is a facet with only 255 possible values and exactly one value per
document. In this case you need only an byte[IndexReader.maxDoc()] array
in
cache and an int[256] array for collecting the results
(we have 5 GByte to run lucene with a couple of facets).

About "facet". For me a facet corresponds to a field in lucene. So 300
facets are quite a lot.
Or did you mean two facets with 150 values each?

To find a good solution for your 100M Document, I have three questions:
 - How many hits per search?
 - More then one value of the facet per document/how many in average?

INDEXORDER means document number.=20
MultiSearcher works also fine:
If you have one index for each year and for each of this indices the
indexorder in order of date, also the MultiSearcher will have correct
INDEXORDER:
Take a look to the variable "int[] starts" in MultiSearcher.


David Seltzer wrote:
>=20
>=20
> Is INDEXORDER based on the DocumentID within each individual index? If
so
> then the results could be interleaved. Anyone know how this behaves?
>=20
>=20

--=20
View this message in context:
http://www.nabble.com/Faceting%2C-Sort-and-DocIDSet-tp23099854p23143797.
html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39850-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 14:30:53 2009
Return-Path: <java-user-return-39850-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40428 invoked from network); 21 Apr 2009 14:30:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 14:30:53 -0000
Received: (qmail 31617 invoked by uid 500); 21 Apr 2009 14:30:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31564 invoked by uid 500); 21 Apr 2009 14:30:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31554 invoked by uid 99); 21 Apr 2009 14:30:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 14:30:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 14:30:42 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LwGzN-000450-RJ
	for java-user@lucene.apache.org; Tue, 21 Apr 2009 07:30:21 -0700
Message-ID: <23157398.post@talk.nabble.com>
Date: Tue, 21 Apr 2009 07:30:21 -0700 (PDT)
From: Rads2029 <radha84@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Proximity and Percentage match search in Lucene
In-Reply-To: <45e5f8bb0904190522v14beed5bx4c18d64c1a234f7f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: radha84@gmail.com
References: <45e5f8bb0904190522v14beed5bx4c18d64c1a234f7f@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi all,

does anybody have a solution to the below query?

regards,
radha

Rads2029 wrote:
> 
>  What I need is  the following :
> If my document field is ( ab,bc,cd,ef) and Search tokens are (ab,bc,cd).
> 
>  Given the following :
>  I should get a hit even if all of the search tokens aren't present
>  If the tokens are found they should be found within a distance x of
> each other ( proximity
> search)
>>
>> I need the percentage match of the search tokens with the document field.
>>
>> Currently this is my query :
>> 1) I form all possible permutation of the search tokens
>> 2) do a spanNearQuery of each permutation
>> 3)  Do a DisjunctionMaxQuery on the spannearqueries.
>>
>> This is how I compute % match  :
>> % match =  ( Score by running the query on the document field ) /
>> 		( score by running the query on a document field created out of search
>> tokens )
>>
>> The numerator gives me the actual score with the search tokens run on the
>> field.
>> Denominator gives  me the  best possible or maximum possible score with
>> the current search
> tokens
>>
>> For this example << If my document field is ( ab,bc,cd,ef) and Search
>> tokens are
> (ab,bc,cd).>> I expect a % match of around 90%.
>>
>> However I get a match of only around 50% without a boost. Using a boost
>> infact reduces
> my percentage.
>>
>> I even overrode the queryNorm method to return a one, still the
>> percentage did not increase.
> *
> Is there any way of implementing this using the current set of
> implementation classes in Lucene and not making complex changes to the
> structure by itself.
> ( which is what i gather has to be done from the previous replies)
> 
> Can anyone suggest an alternative way of implementing this requirement
> using the existing bunch of classes in Lucene and not necessarily
> using the ones I have used*
> 
> 

-- 
View this message in context: http://www.nabble.com/Proximity-and-Percentage-match-search-in-Lucene-tp23122481p23157398.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39851-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 14:35:39 2009
Return-Path: <java-user-return-39851-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42391 invoked from network); 21 Apr 2009 14:35:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 14:35:39 -0000
Received: (qmail 39451 invoked by uid 500); 21 Apr 2009 14:35:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39368 invoked by uid 500); 21 Apr 2009 14:35:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39358 invoked by uid 99); 21 Apr 2009 14:35:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 14:35:36 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.221.136 as permitted sender)
Received: from [209.85.221.136] (HELO mail-qy0-f136.google.com) (209.85.221.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 14:35:26 +0000
Received: by qyk42 with SMTP id 42so3390850qyk.29
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 07:35:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=gSKbK9QVbpR+XRPM4R/yjuIzI/zJ4HZ7JDQ9tohZ/Dk=;
        b=MmNSnwL3B6SLVWWuNPWTRdGLPFvrUzfdsuftT6nDrrqdH3cLAW8FS30U5WmOxfiA2Z
         r6ML9ZlQFkaBHXvQmb7NoGHGnmXLEjfdkVOpVuSlCohhUz6y7XvX9WIL7l34ZHO43VOq
         QyyzAAdsQfwOfQOQ9sZEKw793wTDvVfjklHy4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=AG+itONHDhA1vTOJd1rvcempMuO+5Iyl0BfJKg3ZXaxMvJF7BEOpP0+KzdnDaRxMUD
         pjWHJyP+u3kZUCX8eNF1mA81khITtJ2qKlcRlDmqyyJpqlDlv3AfOE3yEPVJvh8UfbFM
         wtFVVN6apYIHTm8lSnsE8QDv0UuMAKGeUn5DY=
MIME-Version: 1.0
Received: by 10.220.96.71 with SMTP id g7mr8558607vcn.5.1240324505702; Tue, 21 
	Apr 2009 07:35:05 -0700 (PDT)
In-Reply-To: <D262A1FB331DC344AA0B896F390D5569016E3E8C@exchhyd.machcorp.lan>
References: <D262A1FB331DC344AA0B896F390D5569016E3E8C@exchhyd.machcorp.lan>
Date: Tue, 21 Apr 2009 10:35:05 -0400
Message-ID: <359a92830904210735g24df775cx4bfa11774ac6161c@mail.gmail.com>
Subject: Re: How to search special characters in LUcene
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6464d289193470468118d46
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6464d289193470468118d46
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Take a look at DutchAnalyzer. The problem you'll have is if you're indexing
this document along with a bunch of documents from other languages.
You could search the mail archive for extensive discussions of  indexing/
searching documents from several languages.

Best
Erick

On Tue, Apr 21, 2009 at 2:40 AM, Uday Kumar Maddigatla <ukma@mach.com>wrote=
:

> HI,
>
>
>
> I'm new to the lucene. I downloaded lucene 2.4.1.
>
>
>
> I have one xml file which contains few special characters like '=E5', '=
=F8,' =B0'
> etc.(these are Danish language elements).
>
>
>
> How can I search these things.
>
>
>
>
>
> Uday Kumar  Reddy Maddigatla
>
> Software Engineer(Progrator|gatetrade)
>
> MACH India(Operations)
>
> Mobile: + 91-9963000377
>
> Uday.Maddigatla@ness.com <mailto:Uday.Maddigatla@ness.com>
>
> ukma@mach.com <mailto:ukma@mach.com>
>
> www.ness.com
>
>
>
>
>
>

--0016e6464d289193470468118d46--

From java-user-return-39852-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 14:40:53 2009
Return-Path: <java-user-return-39852-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46462 invoked from network); 21 Apr 2009 14:40:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 14:40:53 -0000
Received: (qmail 60275 invoked by uid 500); 21 Apr 2009 14:40:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60244 invoked by uid 500); 21 Apr 2009 14:40:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60234 invoked by uid 99); 21 Apr 2009 14:40:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 14:40:50 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of eransevi@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 14:40:43 +0000
Received: by ewy27 with SMTP id 27so2526684ewy.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 07:40:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Q0rBdbTsqAFVWGddlIkVpcWTbXRAsIkP5ST/2fqngpg=;
        b=wTH0iMjitIhAithvvouvH7il+vtnEDSPSzsPrBzPtqgXQRM5m+221qkgfUGf4CH/zp
         E/z6AB3OvgBIDO0fxyDV1C4P98QPemw57ylgLDx97IC4iVfKwB+E5Zf5C4Q6VeHrEXMy
         YA6tg5mnO8opT9bzb+cMe2sRYcxGxBLIjTyo8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=AL4WgoF7oenfXjd3a3yDLVfAzuWavBAo//GM7Pzq3qirQWCd2vFBst1O7miYqcHtMG
         oBfZ7EKHC4LrTtia3m4PS+ZX3wOgyFrexQ01NT8v8on49AJ2zcaxjc0LKlFAYFhCIhzy
         3iyFPHdB7GLQ1kn40GxS0ElRE1LdSLK0CjIZw=
MIME-Version: 1.0
Received: by 10.210.128.10 with SMTP id a10mr7170959ebd.15.1240324821540; Tue, 
	21 Apr 2009 07:40:21 -0700 (PDT)
In-Reply-To: <d36c28c30904210644x2ba3c6f6mbd5c306def48078b@mail.gmail.com>
References: <d36c28c30904190439g477f57e9s52c48ecffca5881e@mail.gmail.com>
	 <e05f0fd10904210216q3c0ed85egb097dde96a0e5ab3@mail.gmail.com>
	 <d36c28c30904210240p1271d5aahf39081570c4f7376@mail.gmail.com>
	 <e05f0fd10904210508q59bd86b1j479aac3b1be41f43@mail.gmail.com>
	 <d36c28c30904210644x2ba3c6f6mbd5c306def48078b@mail.gmail.com>
Date: Tue, 21 Apr 2009 17:40:21 +0300
Message-ID: <74f928500904210740s76e3d63evf6b1629e979858e1@mail.gmail.com>
Subject: Re: changing term freq in indexing time
From: Eran Sevi <eransevi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174789b464e011046811a0d7
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174789b464e011046811a0d7
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

You might want to take a look at Payloads. If you know the frequency of the
words in each world in advance than during tokenization for each world you
could save the frequency as the payload.

During searches you could use BoostingTermQuery to take the frequency into
account.

Eran.
On Tue, Apr 21, 2009 at 4:44 PM, liat oren <oren.liat@gmail.com> wrote:

> Hi Doron,
>
> Thank you very much for the elaborated answer!
>
> About the Synonyms, I can't use Wordnet as I have my own list of synonyms.
> I
> will look at contrib/memory and see what it does.
>
> You understood correctly the process of using the inverse doc. About the
> two
> problems you mentioned: scalability and ignoring the vicinity of words -
> scalability - this is the reason I wanted to set the frequencies of the
> terms. The use of the frequencies will be used at this stage, not at the
> stage of using the synonyms. When I use the sysnonyms, I want to use the
> score as you suggested below.
> Here, I have for every word, in which worlds they appear. Currently every
> world appears once in a word. However, I would like it to appear the number
> if times as the frequency of the word in the world. In order to avoid
> writing the world several times in the world field, I would like to be able
> to set the freq of the specific world accordng to the freq of the word at
> this world without actually writing it x times (for scalability and index
> size and performance issues)
> So if dog appears 10 times in world 1 and 5 times in world 2, and cat
> appears 5 times in world 1, then I want these frequencies to be taken into
> account when computing how the word dog and cat are close. BUT I don't want
> to write world 1 10 times in word dog and 5 times in word cat, but only
> once
> and to update the termVector so that the frequency will get 10 and 5
> respectively.
> So the *generation* of the synonyms will take into account the frequencies
>
> The vicinity of words - is there any better way to take it in account?
>
> About the suggestion of using term boosting that will use the score of the
> synonyms - if I want to query "big white dogs" and I have the following
> synonyms:
> big - big (1.0), large (0.9), huge (0.6)
> white - white (1.0), color (0.5) offwhite (0.8)
> dog - dog (1.0)
> So this is the way to do it? :
>
>   BooleanQuery bq = new  BooleanQuery();
>          TermQuery tq = new TermQuery(new Term("text", "big"));
>          tq.setBoost((float)1.0);
>                   bq.add(bq, false, false);
>   tq = new TermQuery(new Term(("text", "large"));
>             tq.setBoost((float)0.9);
>                             bq.add(bq, false);
>  tq = new TermQuery(new Term(("text", "huge"));
>             tq.setBoost((float)0.6);
>                             bq.add(bq, false);
>
>  tq = new TermQuery(new Term(("text", "white"));
>             tq.setBoost((float)1.0);
>                             bq.add(bq, false);
>  tq = new TermQuery(new Term(("text", "color"));
>             tq.setBoost((float)0.5);
>                             bq.add(bq, false);
> // etc
>   IndexSearcher searcher = new IndexSearcher("TestSearchIndex");
>                   Hits hits = searcher.search(bq);
>
>
> how the use of booleanQuery will also look at the position of the words? I
> remember I read about the score that takes into account also  the position
> of the term, but I didn't see this factor in the score formula
> Thanks again, it is very helpful,
>  Liat
> 2009/4/21 Doron Cohen <cdoronc@gmail.com>
>
> > Hi Liat, there are two packages under Lucene's contrib that deals with
> > Synonyms - that is contrib/memory and contrib/wordnet - which you
> > may find useful. I never used these two but they seem relevant to what
> > you are trying to achieve.
> >
> > Anyhow, it seems you compute the synonyms for word w are those
> > that appear in the same set of documents ('worlds') as w, and you find
> > this set by (a) indexing an inverse of the collection (docs become words
> > and words become docs) and (b) using docs(w) as query do find syns(w).
> >
> > I assume that your 'worlds' are small, each containing only a small
> > set of a few related words, otherwise I would have two
> > concerns with this approach: (a) scalability (b) in a large doc (world)
> > this
> > approach ignores the vicinity of words which seems to me important
> > to their likelihood as synonyms
> >
> > Assuming you are okay here, and going back to original question of
> > altering the term frequency, perhaps taking the (search) scores of the
> > returned synonyms (which you find by search) is better than just
> > using their frequency? If you find this approach valid, then at least for
> > some queries you should be able to use queries boosts. For example
> > create a BooleanQuery, add to it a TermQuery for each synonym,
> > but set the boost of the TermQuery according to the synonnym score.
> > This is also where you could "punish" synnonyms comparing to the
> > original word. This will only help with queries with contruction API
> > that takes (sub) queries as input (so it will not help with a
> PhraseQuery).
> >
> > - Doron
> >
> > On Tue, Apr 21, 2009 at 12:40 PM, liat oren <oren.liat@gmail.com> wrote:
> >
> > > Ok, I will explain the full 'problem' and then explain how I approach
> it:
> > >
> > > Lets divide it into three steps:
> > >
> > > 1. I have a 'dictionary' of words - for every word, I have a list of
> > > worlds,
> > > which are ids of text documents that the word appears in.
> > > So, for example, for the word 'dog', I have '1 1600 36000' in the
> > "worlds"
> > > field (which are tokenized whin indexed) - which means that the word
> dog
> > > appears in worlds 1, 1600 and 36000.
> > >
> > > 2. This index is used to choose synonyms for the word dog - using the
> > > "worlds" field - I do a search on this index, giving the query "'1 1600
> > > 36000" as in input and thus get the words that are close to the word
> > "dog".
> > > I take the 10 closest words.
> > >
> > > 3. These 10 synonyms are then used to expand the query.
> > >
> > > Basically, I have 2 problems in this process:
> > >
> > > a. In the process of finding the synonyms, I would like that the
> > frequency
> > > of the word in each of the worlds will be taken into account. so that
> if
> > > 'dog' appeared 3 times in world 1, 10 times in world 1600 and 4 times
> in
> > > world 36000, then it will be taken into account.
> > > I wanted to avoid "expanding" the field to be "1 1 1 1600 1600 1600
> 1600
> > > 1600 1600 1600 1600 1600 1600 36000 36000 36000 36000". Accordingly I
> > > wanted
> > > to be able to set the freq by myself.
> > >
> > > b. In the process of using the synonyms, I wanted to be able to set a
> > > 'penalty' factor to the synonyms, together with giving differnt weight
> to
> > > differnt synonyms, according to theur score. I looked at an old thread
> -
> > > Search for synonyms - implemenetation for review :
> > > .
> > >
> > >
> >
> http://mail-archives.apache.org/mod_mbox/lucene-java-user/200603.mbox/%3c39B0FB508E5D7540ACA5AD57225E150D39203D@xmail.me.corp.entopia.com%3e
> > >
> > > I don;t know if its part of lucene now. I didn't quite understand how
> to
> > > use
> > > it.
> > > Is there a better way to approach it?
> > >
> > > I hope I explained it well.
> > > Thanks,
> > > Liat
> > >
> > >
> > >
> > > 2009/4/21 Doron Cohen <cdoronc@gmail.com>
> > >
> > > > Depending on the problem you are trying to solve there may be other
> > > > solutions to it, not requiring setting wrong (?) values for term
> > > > frequencies.
> > > > If you can explain what you are trying to solve, people on the list
> may
> > > > be able to suggest such alternatives.
> > > > - Doron
> > > >
> > > > On Sun, Apr 19, 2009 at 2:39 PM, liat oren <oren.liat@gmail.com>
> > wrote:
> > > >
> > > > > Hi,
> > > > >
> > > > > I would like to be able to set the term freq to differnt values at
> > > index
> > > > > time, or at search time.
> > > > >
> > > > > So if a document has the following text: 1 2, the freq of 1 will
> get
> > > 100
> > > > > and
> > > > > the freq of 2 will get 200. I want to avoid expanding it by writing
> 1
> > > 100
> > > > > times.
> > > > >
> > > > > I looked at Similarity class and wanted to override it, but the tf
> > > > function
> > > > > gets only freq, so I don't know for which term this freq relates
> to,
> > > thus
> > > > I
> > > > > can't change the value.
> > > > >
> > > > > Thanks,
> > > > > Liat
> > > > >
> > > >
> > >
> >
>

--0015174789b464e011046811a0d7--

From java-user-return-39853-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 15:02:20 2009
Return-Path: <java-user-return-39853-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62412 invoked from network); 21 Apr 2009 15:02:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 15:02:20 -0000
Received: (qmail 7765 invoked by uid 500); 21 Apr 2009 15:02:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7715 invoked by uid 500); 21 Apr 2009 15:02:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7705 invoked by uid 99); 21 Apr 2009 15:02:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 15:02:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of woudstra.m@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 15:02:10 +0000
Received: by fxm2 with SMTP id 2so2842499fxm.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 08:01:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=kl5VMMfCY7MSUG+rLW9bauLnUa9lSQSCmuTewfwv0sY=;
        b=LpI/O835qcNwh6pTbIj8REF7LhXHFwqtREItO+uFwBOYJ8WID7BFM9wuwlcidO1ZLS
         8Ad4+++vmxpjsr4EWDHfEzifYZ2IfU7qc1b8IfLp/85HZyxXmdQdVMK9wn7IOfpCzwfm
         g/MJ5DYiqY556/clJ3y5vRd4Znxiu0LT1HgC0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=OFzYTZl6EaaHBCYEPvVCwVr+0sgtRCohnqf6A/6DylSmKTtouAfA0nEQ95t6mt9qEj
         JyJlEgWUBeXt8ZIsrr6nEgemr4sMqcaxAnToqLkgjVQNZt1WBG4MaPH6hf4jzEgn8i8O
         vAvFyvQRloqmnvQBGHM+w1dXDajlPNyJkf2vA=
MIME-Version: 1.0
Received: by 10.204.116.8 with SMTP id k8mr6587353bkq.110.1240326109245; Tue, 
	21 Apr 2009 08:01:49 -0700 (PDT)
Date: Tue, 21 Apr 2009 17:01:48 +0200
Message-ID: <b300aae70904210801y6a6471e1x872ea71ae89047f8@mail.gmail.com>
Subject: MergeException
From: Martine Woudstra <woudstra.m@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,

I'm using Lucene 2.4.1. for building an ngram index. Indexing works
well until I try to open the index built so far with Luke. A
MergeException is thrown, see below. Opening an index with Luke during
indexing never caused problems with Lucene 2.3. Anyone familiar with
this problem?

Thanks in advance,

Martine van der Heijden


Exception in thread "Lucene Merge Thread #3067"
org.apache.lucene.index.MergePolicy$MergeException:
java.io.FileNotFoundException: D:\indexngram\_k0z.fnm (Het systeem kan
het opgegeven bestand niet vinden)
	at org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
Caused by: java.io.FileNotFoundException: D:\indexngram\_k0z.fnm (Het
systeem kan het opgegeven bestand niet vinden)
	at java.io.RandomAccessFile.open(Native Method)
	at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
	at org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
	at org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
	at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
	at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:482)
	at org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.java:221)
	at org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:184)
	at org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.java:204)
	at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4263)
	at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
	at org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39854-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 16:02:18 2009
Return-Path: <java-user-return-39854-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95219 invoked from network); 21 Apr 2009 16:02:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 16:02:18 -0000
Received: (qmail 44200 invoked by uid 500); 21 Apr 2009 16:02:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44134 invoked by uid 500); 21 Apr 2009 16:02:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44122 invoked by uid 99); 21 Apr 2009 16:02:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:02:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:02:08 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: Servlets Sharing Resources
Date: Tue, 21 Apr 2009 12:01:46 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Servlets Sharing Resources
thread-index: AcnCmniWxzykPlohRxyYTpvAxQ6cig==
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,

Sorry for the slightly off-topic question, but I've just run into a gap
in my understanding of Servlet programming.

The question: Is it possible for two servlets to share access to an
instance of IndexSearcher or an IndexReader? I'm thinking about setting
up a Search servlet to provide XML search results and a Statistics
servlet to provide numeric statistics based on the same data.

I imagine the right way to do it is to make both servlets child classes
of a manager class, but I'm not sure how that would look. I'm also not
sure how to configure tomcat in this scenario?

-Dave

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39855-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 16:14:34 2009
Return-Path: <java-user-return-39855-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 313 invoked from network); 21 Apr 2009 16:14:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 16:14:34 -0000
Received: (qmail 89602 invoked by uid 500); 21 Apr 2009 16:14:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89550 invoked by uid 500); 21 Apr 2009 16:14:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89540 invoked by uid 99); 21 Apr 2009 16:14:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:14:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mindas@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:14:23 +0000
Received: by ewy27 with SMTP id 27so2579372ewy.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 09:14:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=7ScxkSMrFO6z8IsIf4g9prL7XfjllhFGfLYTMxu7UmE=;
        b=N51CXY+KCJ539KFPm7vZKTrxeInG0Ksr65PBoIDH7TKGSrLyd0M+5N0rangr9dmMdq
         EgZ38r/OoeN92va66r0elNuxO4RnvMLYwfP1EiVXoKRq7+J57lIedi+B+WlvCZVy0xse
         KGunUM/c/6iD44IXWpGN8r2j9i41aL50UDKBE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=PlCpjJRBLC19xyOx9CQ9mnLBo6CpIvZ9wN706bDbmay5hcJ6M+buKOq5DOJ2VPL1Af
         Zfsw8kLFdd63R6Ry1Z0ItuN0xVOf0xJXcyT/UP4k1bOTuwKu+qgON1GSRHoaiCiBgwK8
         hwPFARGOf8X3NNF9ZomnwsIqnmBHEtkGZTnoo=
MIME-Version: 1.0
Received: by 10.210.37.16 with SMTP id k16mr7241322ebk.63.1240330443413; Tue, 
	21 Apr 2009 09:14:03 -0700 (PDT)
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com>
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com>
Date: Tue, 21 Apr 2009 17:14:03 +0100
Message-ID: <a4d7dcf50904210914s266f619au5e15d3f9097daa31@mail.gmail.com>
Subject: Re: Servlets Sharing Resources
From: =?ISO-8859-13?Q?Mindaugas_=DEak=F0auskas?= <mindas@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Servlets are stateless and they must extend
javax.servlet.http.HttpServlet, therefore I'm afraid the idea of
manager class is probably unrealistic.

The stuff you want to achieve normally works by either placing objects
into the HTTP session (user-bound) or attaching them to your
application context (application-bound).

Regards,
Mindaugas

On Tue, Apr 21, 2009 at 5:01 PM, David Seltzer <dseltzer@tveyes.com> wrote:
> Hi All,
>
> Sorry for the slightly off-topic question, but I've just run into a gap
> in my understanding of Servlet programming.
>
> The question: Is it possible for two servlets to share access to an
> instance of IndexSearcher or an IndexReader? I'm thinking about setting
> up a Search servlet to provide XML search results and a Statistics
> servlet to provide numeric statistics based on the same data.
>
> I imagine the right way to do it is to make both servlets child classes
> of a manager class, but I'm not sure how that would look. I'm also not
> sure how to configure tomcat in this scenario?
>
> -Dave
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39856-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 16:24:32 2009
Return-Path: <java-user-return-39856-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2264 invoked from network); 21 Apr 2009 16:24:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 16:24:32 -0000
Received: (qmail 9577 invoked by uid 500); 21 Apr 2009 16:24:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9504 invoked by uid 500); 21 Apr 2009 16:24:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9494 invoked by uid 99); 21 Apr 2009 16:24:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:24:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:24:23 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: base64
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: RE: Servlets Sharing Resources
Date: Tue, 21 Apr 2009 12:23:55 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28E0@mail02.tveyes.com>
In-Reply-To: <a4d7dcf50904210914s266f619au5e15d3f9097daa31@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Servlets Sharing Resources
thread-index: AcnCnEKm+LXt+CkJQgaBZTQGJ//kZAAAIeEg
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com> <a4d7dcf50904210914s266f619au5e15d3f9097daa31@mail.gmail.com>
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

VGhhbmtzIE1pbmR1YWdhcywNCg0KU28gaW4gVG9tY2F0LCBpcyB0aGVyZSBhIHdheSB0byBzdG9y
ZSBhIHZhcmlhYmxlIG91dHNpZGUgYW4gaW5kaXZpZHVhbCBTZXJ2bGV0IGluIHRoZSBTZXJ2bGV0
Q29udGV4dD8gVGhlIEFQSSBzaG93cyBTZXJ2bGV0Q29udGV4dC5zZXRBdHRyaWJ1dGUgYW5kIFNl
cnZlbGV0Q29udGV4dC5nZXRBdHRyaWJ0dWUuIFdvdWxkIHRoYXQgYmUgYSB3YXkgdG8gbWFrZSBh
biBvYmplY3QgYXBwbGljYXRpb24tYm91bmQ/DQoNCi1EYXZlDQoNCi0tLS0tT3JpZ2luYWwgTWVz
c2FnZS0tLS0tDQpGcm9tOiBNaW5kYXVnYXMgxb1ha8WhYXVza2FzIFttYWlsdG86bWluZGFzQGdt
YWlsLmNvbV0gDQpTZW50OiBUdWVzZGF5LCBBcHJpbCAyMSwgMjAwOSAxMjoxNCBQTQ0KVG86IGph
dmEtdXNlckBsdWNlbmUuYXBhY2hlLm9yZw0KU3ViamVjdDogUmU6IFNlcnZsZXRzIFNoYXJpbmcg
UmVzb3VyY2VzDQoNCkhpLA0KDQpTZXJ2bGV0cyBhcmUgc3RhdGVsZXNzIGFuZCB0aGV5IG11c3Qg
ZXh0ZW5kDQpqYXZheC5zZXJ2bGV0Lmh0dHAuSHR0cFNlcnZsZXQsIHRoZXJlZm9yZSBJJ20gYWZy
YWlkIHRoZSBpZGVhIG9mDQptYW5hZ2VyIGNsYXNzIGlzIHByb2JhYmx5IHVucmVhbGlzdGljLg0K
DQpUaGUgc3R1ZmYgeW91IHdhbnQgdG8gYWNoaWV2ZSBub3JtYWxseSB3b3JrcyBieSBlaXRoZXIg
cGxhY2luZyBvYmplY3RzDQppbnRvIHRoZSBIVFRQIHNlc3Npb24gKHVzZXItYm91bmQpIG9yIGF0
dGFjaGluZyB0aGVtIHRvIHlvdXINCmFwcGxpY2F0aW9uIGNvbnRleHQgKGFwcGxpY2F0aW9uLWJv
dW5kKS4NCg0KUmVnYXJkcywNCk1pbmRhdWdhcw0KDQpPbiBUdWUsIEFwciAyMSwgMjAwOSBhdCA1
OjAxIFBNLCBEYXZpZCBTZWx0emVyIDxkc2VsdHplckB0dmV5ZXMuY29tPiB3cm90ZToNCj4gSGkg
QWxsLA0KPg0KPiBTb3JyeSBmb3IgdGhlIHNsaWdodGx5IG9mZi10b3BpYyBxdWVzdGlvbiwgYnV0
IEkndmUganVzdCBydW4gaW50byBhIGdhcA0KPiBpbiBteSB1bmRlcnN0YW5kaW5nIG9mIFNlcnZs
ZXQgcHJvZ3JhbW1pbmcuDQo+DQo+IFRoZSBxdWVzdGlvbjogSXMgaXQgcG9zc2libGUgZm9yIHR3
byBzZXJ2bGV0cyB0byBzaGFyZSBhY2Nlc3MgdG8gYW4NCj4gaW5zdGFuY2Ugb2YgSW5kZXhTZWFy
Y2hlciBvciBhbiBJbmRleFJlYWRlcj8gSSdtIHRoaW5raW5nIGFib3V0IHNldHRpbmcNCj4gdXAg
YSBTZWFyY2ggc2VydmxldCB0byBwcm92aWRlIFhNTCBzZWFyY2ggcmVzdWx0cyBhbmQgYSBTdGF0
aXN0aWNzDQo+IHNlcnZsZXQgdG8gcHJvdmlkZSBudW1lcmljIHN0YXRpc3RpY3MgYmFzZWQgb24g
dGhlIHNhbWUgZGF0YS4NCj4NCj4gSSBpbWFnaW5lIHRoZSByaWdodCB3YXkgdG8gZG8gaXQgaXMg
dG8gbWFrZSBib3RoIHNlcnZsZXRzIGNoaWxkIGNsYXNzZXMNCj4gb2YgYSBtYW5hZ2VyIGNsYXNz
LCBidXQgSSdtIG5vdCBzdXJlIGhvdyB0aGF0IHdvdWxkIGxvb2suIEknbSBhbHNvIG5vdA0KPiBz
dXJlIGhvdyB0byBjb25maWd1cmUgdG9tY2F0IGluIHRoaXMgc2NlbmFyaW8/DQo+DQo+IC1EYXZl
DQo+DQo+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQ0KPiBUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXIt
dW5zdWJzY3JpYmVAbHVjZW5lLmFwYWNoZS5vcmcNCj4gRm9yIGFkZGl0aW9uYWwgY29tbWFuZHMs
IGUtbWFpbDogamF2YS11c2VyLWhlbHBAbHVjZW5lLmFwYWNoZS5vcmcNCj4NCj4NCg0KLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tDQpUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVAbHVj
ZW5lLmFwYWNoZS5vcmcNCkZvciBhZGRpdGlvbmFsIGNvbW1hbmRzLCBlLW1haWw6IGphdmEtdXNl
ci1oZWxwQGx1Y2VuZS5hcGFjaGUub3JnDQoNCg==


From java-user-return-39857-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 16:41:39 2009
Return-Path: <java-user-return-39857-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7290 invoked from network); 21 Apr 2009 16:41:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 16:41:38 -0000
Received: (qmail 36382 invoked by uid 500); 21 Apr 2009 16:41:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36353 invoked by uid 500); 21 Apr 2009 16:41:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36343 invoked by uid 99); 21 Apr 2009 16:41:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:41:35 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [87.248.110.141] (HELO n24.bullet.mail.ukl.yahoo.com) (87.248.110.141)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 21 Apr 2009 16:41:26 +0000
Received: from [217.146.182.178] by n24.bullet.mail.ukl.yahoo.com with NNFMP; 21 Apr 2009 16:41:12 -0000
Received: from [87.248.110.113] by t4.bullet.ukl.yahoo.com with NNFMP; 21 Apr 2009 16:41:04 -0000
Received: from [127.0.0.1] by omp218.mail.ukl.yahoo.com with NNFMP; 21 Apr 2009 16:41:00 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 605861.41813.bm@omp218.mail.ukl.yahoo.com
Received: (qmail 16473 invoked by uid 60001); 21 Apr 2009 16:41:04 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1240332064; bh=aXtrO5OZSBCZ1yYjdFNbp7AHJkFem5NjMFfad3ktp84=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=21170C5Emd8J2TkfXo8Eo5pxE7NYJ4GN05N+kD4u9yex6RiV1jodKa+bsjhO0pI5FzVD/zk47lLzEqoN4knWnQgGjwKDiSghQ5CxScnx3/j+pddHWg9pqBT90zSnlZTnEOw/ItUaPwh40gTVKAIjOQWxgdsQtammOGym4ugvqJY=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=BxBn3MbOcIaYaV52WTR5hozAgn9g3GTTKlhG4SYg2ea2VVG9dnAiwXn8W6Mh2HIdsfxlAG9qgNbXlzscdgsaJri3IpVjMFjf+0XCvvae8B0Owa7GZF+h5a15dsUabgxkV+arFOy6q11dLnjws3Uni0rQnOF362iscJNypup1hPc=;
Message-ID: <736459.16418.qm@web24704.mail.ird.yahoo.com>
X-YMail-OSG: OXmXyjMVM1mW7VlXdRXXs1Tagy0qdSjFMgYdIPA107XfvMhENA.1k1DSNN9bLCC2LYdEjm.wJIHWhoHMkOfcegpe_7GO2s7U4A9jRSol_SaDbqAUHpbtb1ImEseN61E3IIk5HUiwsWUwU7mwsMjhMf88bHVsPqw0ccafcJoahIjfByiwJSTpOGAvEZNMVlPJ5JkODA209kyay1sBlJEARGn4p.eiWMZTK9JA4RIa_Ocj.qNd6pz8oPpFRv3Smhjl0ZrPQl8vYWAZGwCJ_jwIgtM4y9K86sHud6Yuy0pRI8FLahF2pldRw.ZHB93WphW4k1Rkb3ytbYONjXVgi45AFJU-
Received: from [193.36.230.96] by web24704.mail.ird.yahoo.com via HTTP; Tue, 21 Apr 2009 09:41:04 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com> <a4d7dcf50904210914s266f619au5e15d3f9097daa31@mail.gmail.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28E0@mail02.tveyes.com>
Date: Tue, 21 Apr 2009 09:41:04 -0700 (PDT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: Servlets Sharing Resources
To: java-user@lucene.apache.org
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28E0@mail02.tveyes.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org


Spring is pretty useful for managing and sharing resources - see what looks=
 like a related example here: http://croarkin.blogspot.com/2008/05/injectin=
g-spring-bean-into-servlet.html=0A=0A=0ACheers,=0AMark=0A=0A=0A=0A----- Ori=
ginal Message ----=0AFrom: David Seltzer <dseltzer@TVEyes.com>=0ATo: java-u=
ser@lucene.apache.org=0ASent: Tuesday, 21 April, 2009 17:23:55=0ASubject: R=
E: Servlets Sharing Resources=0A=0AThanks Minduagas,=0A=0ASo in Tomcat, is =
there a way to store a variable outside an individual Servlet in the Servle=
tContext? The API shows ServletContext.setAttribute and ServeletContext.get=
Attribtue. Would that be a way to make an object application-bound?=0A=0A-D=
ave=0A=0A-----Original Message-----=0AFrom: Mindaugas =C5=BDak=C5=A1auskas =
[mailto:mindas@gmail.com] =0ASent: Tuesday, April 21, 2009 12:14 PM=0ATo: j=
ava-user@lucene.apache.org=0ASubject: Re: Servlets Sharing Resources=0A=0AH=
i,=0A=0AServlets are stateless and they must extend=0Ajavax.servlet.http.Ht=
tpServlet, therefore I'm afraid the idea of=0Amanager class is probably unr=
ealistic.=0A=0AThe stuff you want to achieve normally works by either placi=
ng objects=0Ainto the HTTP session (user-bound) or attaching them to your=
=0Aapplication context (application-bound).=0A=0ARegards,=0AMindaugas=0A=0A=
On Tue, Apr 21, 2009 at 5:01 PM, David Seltzer <dseltzer@tveyes.com> wrote:=
=0A> Hi All,=0A>=0A> Sorry for the slightly off-topic question, but I've ju=
st run into a gap=0A> in my understanding of Servlet programming.=0A>=0A> T=
he question: Is it possible for two servlets to share access to an=0A> inst=
ance of IndexSearcher or an IndexReader? I'm thinking about setting=0A> up =
a Search servlet to provide XML search results and a Statistics=0A> servlet=
 to provide numeric statistics based on the same data.=0A>=0A> I imagine th=
e right way to do it is to make both servlets child classes=0A> of a manage=
r class, but I'm not sure how that would look. I'm also not=0A> sure how to=
 configure tomcat in this scenario?=0A>=0A> -Dave=0A>=0A> -----------------=
----------------------------------------------------=0A> To unsubscribe, e-=
mail: java-user-unsubscribe@lucene.apache.org=0A> For additional commands, =
e-mail: java-user-help@lucene.apache.org=0A>=0A>=0A=0A---------------------=
------------------------------------------------=0ATo unsubscribe, e-mail: =
java-user-unsubscribe@lucene.apache.org=0AFor additional commands, e-mail: =
java-user-help@lucene.apache.org=0A=0A=0A      


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39858-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 16:48:22 2009
Return-Path: <java-user-return-39858-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9817 invoked from network); 21 Apr 2009 16:48:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 16:48:22 -0000
Received: (qmail 45283 invoked by uid 500); 21 Apr 2009 16:48:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45192 invoked by uid 500); 21 Apr 2009 16:48:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45182 invoked by uid 99); 21 Apr 2009 16:48:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:48:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mindas@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:48:11 +0000
Received: by ey-out-2122.google.com with SMTP id 22so242264eye.53
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 09:47:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=lHHXkXDyqHs9/EvY9Qy+BFKg7F7slhENKr+aQtpysSM=;
        b=wGvTohAgZjv2q3dWJR+rgaClDrcePRGGL3GRND29wTMOSUgnE8/RqP/PjrR73sUzjF
         RVInuGv6yYVpTiDOXjT6oqGJRpKeMQ0ep7S7ntk5oXYwiqZDaVmykYzihF0GZDHqNNVI
         JaxwDAmz3qG/bcbwSZzACxPcFuinWcRhK5X20=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=LIy9Ob0UjbZ4majjWKpuQMe3oDA4dIADM2b6H3ASAschvNl+0i/UeIE+uXkJBXjnp7
         djhmioUhvPko6B3fn/QY2mZNrNthOnMWyxsUSIo11rwOTGb84eJeXeb+/IRIpJr0wtLY
         31fXkNnlujyxla+IsPG0HVKaM57dy9wOx/Zfo=
MIME-Version: 1.0
Received: by 10.210.53.5 with SMTP id b5mr3028659eba.95.1240332470552; Tue, 21 
	Apr 2009 09:47:50 -0700 (PDT)
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28E0@mail02.tveyes.com>
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com>
	 <a4d7dcf50904210914s266f619au5e15d3f9097daa31@mail.gmail.com>
	 <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28E0@mail02.tveyes.com>
Date: Tue, 21 Apr 2009 17:47:50 +0100
Message-ID: <a4d7dcf50904210947j1213558eocba8535024af28db@mail.gmail.com>
Subject: Re: Servlets Sharing Resources
From: =?ISO-8859-13?Q?Mindaugas_=DEak=F0auskas?= <mindas@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Generally speaking, yes - this is the most straightforward way of
storing application-bound data.
Somewhat related explanation available here:
http://www.coderanch.com/t/358143/Servlets/java/servlet-context-vs-session

Regards,
Mindaugas

On Tue, Apr 21, 2009 at 5:23 PM, David Seltzer <dseltzer@tveyes.com> wrote:
> Thanks Minduagas,
>
> So in Tomcat, is there a way to store a variable outside an individual Servlet in the ServletContext? The API shows ServletContext.setAttribute and ServeletContext.getAttribtue. Would that be a way to make an object application-bound?
>
> -Dave

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39859-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 16:51:07 2009
Return-Path: <java-user-return-39859-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10237 invoked from network); 21 Apr 2009 16:51:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 16:51:07 -0000
Received: (qmail 48060 invoked by uid 500); 21 Apr 2009 16:51:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47969 invoked by uid 500); 21 Apr 2009 16:51:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47958 invoked by uid 99); 21 Apr 2009 16:51:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:51:04 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: unknown (athena.apache.org: error in processing during lookup of pjaol@pjaol.com)
Received: from [209.85.217.164] (HELO mail-gx0-f164.google.com) (209.85.217.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:50:57 +0000
Received: by gxk8 with SMTP id 8so5528017gxk.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 09:50:36 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.137.14 with SMTP id k14mr8273338ybd.53.1240332636094; Tue, 
	21 Apr 2009 09:50:36 -0700 (PDT)
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com>
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com>
Date: Tue, 21 Apr 2009 12:50:36 -0400
Message-ID: <1e33aedb0904210950y3722169ald1a1b5720d2f5e45@mail.gmail.com>
Subject: Re: Servlets Sharing Resources
From: "patrick o'leary" <pjaol@pjaol.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd56b482d838e0468137254
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd56b482d838e0468137254
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Why not have 1 servlet and based on a parameter / url, serve 2 different
outputs?

if(request.getString("asXML") !=null)
   showXML();
else
   showOtherStuff();

Save yourself the hassle of dealing with jndi / contexts / spring or
SingleTons

On Tue, Apr 21, 2009 at 12:01 PM, David Seltzer <dseltzer@tveyes.com> wrote:

> Hi All,
>
> Sorry for the slightly off-topic question, but I've just run into a gap
> in my understanding of Servlet programming.
>
> The question: Is it possible for two servlets to share access to an
> instance of IndexSearcher or an IndexReader? I'm thinking about setting
> up a Search servlet to provide XML search results and a Statistics
> servlet to provide numeric statistics based on the same data.
>
> I imagine the right way to do it is to make both servlets child classes
> of a manager class, but I'm not sure how that would look. I'm also not
> sure how to configure tomcat in this scenario?
>
> -Dave
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd56b482d838e0468137254--

From java-user-return-39860-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 16:56:44 2009
Return-Path: <java-user-return-39860-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12033 invoked from network); 21 Apr 2009 16:56:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 16:56:44 -0000
Received: (qmail 54313 invoked by uid 500); 21 Apr 2009 16:56:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54241 invoked by uid 500); 21 Apr 2009 16:56:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54231 invoked by uid 99); 21 Apr 2009 16:56:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:56:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:56:34 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: RE: Servlets Sharing Resources
Date: Tue, 21 Apr 2009 12:56:12 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28F1@mail02.tveyes.com>
In-Reply-To: <1e33aedb0904210950y3722169ald1a1b5720d2f5e45@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Servlets Sharing Resources
thread-index: AcnCoVzkg389BCzmSIqutldpkJA7dQAAA0Lg
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com> <1e33aedb0904210950y3722169ald1a1b5720d2f5e45@mail.gmail.com>
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

That certainly seems like the simple way to solve the problem. I was
just wondering if I was overlooking a simple way to do this via web.xml
servlet-mapping. I was trying to avoid having everything hit the same
doGet().

-----Original Message-----
From: patrick o'leary [mailto:pjaol@pjaol.com]=20
Sent: Tuesday, April 21, 2009 12:51 PM
To: java-user@lucene.apache.org
Subject: Re: Servlets Sharing Resources

Why not have 1 servlet and based on a parameter / url, serve 2 different
outputs?

if(request.getString("asXML") !=3Dnull)
   showXML();
else
   showOtherStuff();

Save yourself the hassle of dealing with jndi / contexts / spring or
SingleTons

On Tue, Apr 21, 2009 at 12:01 PM, David Seltzer <dseltzer@tveyes.com>
wrote:

> Hi All,
>
> Sorry for the slightly off-topic question, but I've just run into a
gap
> in my understanding of Servlet programming.
>
> The question: Is it possible for two servlets to share access to an
> instance of IndexSearcher or an IndexReader? I'm thinking about
setting
> up a Search servlet to provide XML search results and a Statistics
> servlet to provide numeric statistics based on the same data.
>
> I imagine the right way to do it is to make both servlets child
classes
> of a manager class, but I'm not sure how that would look. I'm also not
> sure how to configure tomcat in this scenario?
>
> -Dave
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39861-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 16:59:26 2009
Return-Path: <java-user-return-39861-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14969 invoked from network); 21 Apr 2009 16:59:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 16:59:26 -0000
Received: (qmail 61439 invoked by uid 500); 21 Apr 2009 16:59:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61373 invoked by uid 500); 21 Apr 2009 16:59:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61363 invoked by uid 99); 21 Apr 2009 16:59:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:59:23 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [162.129.8.141] (HELO ipex1.johnshopkins.edu) (162.129.8.141)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 16:59:15 +0000
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: At8BALyX7UkKol/s/2dsb2JhbAAIxQWHSIhNg3oG
X-IronPort-AV: E=Sophos;i="4.40,225,1238990400"; 
   d="scan'208";a="206022974"
Received: from wireless.hltcoe.jhu.edu (HELO [127.0.0.1]) ([10.162.95.236])
  by ipex1.johnshopkins.edu with ESMTP; 21 Apr 2009 12:58:52 -0400
Message-ID: <49EDFB49.60908@stanford.edu>
Date: Tue, 21 Apr 2009 09:58:49 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Why is CustomScoreQuery limited to ValueSourceQuery type?
References: <49E91253.4030506@stanford.edu> <e05f0fd10904210047m218a0628wf57070729841e2a9@mail.gmail.com>
In-Reply-To: <e05f0fd10904210047m218a0628wf57070729841e2a9@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Antivirus: avast! (VPS 090421-0, 04/21/2009), Outbound message
X-Antivirus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

On 4/21/2009 12:47 AM, Doron Cohen wrote:
> CustomScoreQuery expects the VSQs to have a score for document matching the
> (main) subQuery - this does not hold for arbitrary queries.

Sure, but it could easily assign 0.0 scores for sub-queries that didn't
match, no?

Steve

> On Sat, Apr 18, 2009 at 2:35 AM, Steven Bethard <bethard@stanford.edu>wrote:
> 
>> CustomScoreQuery only allows the secondary queries to be of type
>> ValueSourceQuery instead of allowing them to be any type of Query. Why
>> is that? Is there something that makes it hard to implement for
>> arbitrary queries?
>>
>> Steve
>>
>> P.S. I played around with this briefly, and simply replacing all
>> ValueSourceQuery references with Query references yields only one simple
>> compile error, where ValueSourceQuery.createWeight() is being used
>> instead of Query.weight() for some reason.
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39862-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 17:09:53 2009
Return-Path: <java-user-return-39862-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21159 invoked from network); 21 Apr 2009 17:09:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 17:09:53 -0000
Received: (qmail 86823 invoked by uid 500); 21 Apr 2009 17:09:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86746 invoked by uid 500); 21 Apr 2009 17:09:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86736 invoked by uid 99); 21 Apr 2009 17:09:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 17:09:50 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cdoronc@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 17:09:43 +0000
Received: by ey-out-2122.google.com with SMTP id 22so244420eye.53
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 10:09:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=j8vzO62FCACHawcg+2DGYmy8QQ+akJFcJAOnTYHdx6Q=;
        b=kHrclFROGX8XkRO1OjumlFgMqNcpyFBH5H54VSIJQqK+J5MywUyM3TOORhJFCHFWJw
         KWH5TQRekLI7/9b+0z59K6naCBy8i4UMDnVBsjgnf1SID9fH6OyuQCICRc10rhaQNl+t
         9V9fX0IdORDpksdgyhjpGDwMw54W3scnTUiIg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=m9es11zxNjI2fB3+MvFGhVGUxrzAQBZ8jrcTcOCDC0SFfGrjNHM8Hk4kMB0pgDK73d
         4B+yYS+RGQduMMuWKCvslEt31L1rsJL4w28d2aU9CIP8HsSNzP2tNU7TPXPrELhuPn4M
         reujB7hwqPsh7QnG8BvUnv+GK1hlFi2P5MeAI=
MIME-Version: 1.0
Received: by 10.210.30.1 with SMTP id d1mr5195336ebd.89.1240333761641; Tue, 21 
	Apr 2009 10:09:21 -0700 (PDT)
In-Reply-To: <49EDFB49.60908@stanford.edu>
References: <49E91253.4030506@stanford.edu>
	 <e05f0fd10904210047m218a0628wf57070729841e2a9@mail.gmail.com>
	 <49EDFB49.60908@stanford.edu>
Date: Tue, 21 Apr 2009 20:09:21 +0300
Message-ID: <e05f0fd10904211009u4996bccer52b4f7fd9ef7dceb@mail.gmail.com>
Subject: Re: Why is CustomScoreQuery limited to ValueSourceQuery type?
From: Doron Cohen <cdoronc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174bdea043fbb2046813b537
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174bdea043fbb2046813b537
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

It could, but (historically and) currently it doesn't... :)
I actually have code for this.
Would you like open a JIRA issue for this - I'll attach my wrapper there?

Doron

On Tue, Apr 21, 2009 at 7:58 PM, Steven Bethard <bethard@stanford.edu>wrote:

> On 4/21/2009 12:47 AM, Doron Cohen wrote:
> > CustomScoreQuery expects the VSQs to have a score for document matching
> the
> > (main) subQuery - this does not hold for arbitrary queries.
>
> Sure, but it could easily assign 0.0 scores for sub-queries that didn't
> match, no?
>
> Steve
>
> > On Sat, Apr 18, 2009 at 2:35 AM, Steven Bethard <bethard@stanford.edu
> >wrote:
> >
> >> CustomScoreQuery only allows the secondary queries to be of type
> >> ValueSourceQuery instead of allowing them to be any type of Query. Why
> >> is that? Is there something that makes it hard to implement for
> >> arbitrary queries?
> >>
> >> Steve
> >>
> >> P.S. I played around with this briefly, and simply replacing all
> >> ValueSourceQuery references with Query references yields only one simple
> >> compile error, where ValueSourceQuery.createWeight() is being used
> >> instead of Query.weight() for some reason.
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174bdea043fbb2046813b537--

From java-user-return-39863-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 17:16:09 2009
Return-Path: <java-user-return-39863-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24472 invoked from network); 21 Apr 2009 17:16:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 17:16:09 -0000
Received: (qmail 1776 invoked by uid 500); 21 Apr 2009 17:16:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1698 invoked by uid 500); 21 Apr 2009 17:16:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1688 invoked by uid 99); 21 Apr 2009 17:16:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 17:16:06 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of pjaol@pjaol.com)
Received: from [74.125.44.28] (HELO yx-out-2324.google.com) (74.125.44.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 17:15:58 +0000
Received: by yx-out-2324.google.com with SMTP id 8so829577yxm.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 10:15:36 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.9.17 with SMTP id m17mr8818994ybi.86.1240334136699; Tue, 
	21 Apr 2009 10:15:36 -0700 (PDT)
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28F1@mail02.tveyes.com>
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com>
	 <1e33aedb0904210950y3722169ald1a1b5720d2f5e45@mail.gmail.com>
	 <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28F1@mail02.tveyes.com>
Date: Tue, 21 Apr 2009 13:15:36 -0400
Message-ID: <1e33aedb0904211015l776e372bwc71d3f25e6228b21@mail.gmail.com>
Subject: Re: Servlets Sharing Resources
From: "patrick o'leary" <pjaol@pjaol.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd47b069eedd8046813cbf6
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd47b069eedd8046813cbf6
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Not every servlet container will support the same cross context methodology.
Most would say you're approach is an EJB with a life cycle outside of the
interaction layer.

But honestly, you'll just spend the next few hours googling, pulling out
hair, buying a book on jboss
and then curse it, and do it this way in the end..



On Tue, Apr 21, 2009 at 12:56 PM, David Seltzer <dseltzer@tveyes.com> wrote:

> That certainly seems like the simple way to solve the problem. I was
> just wondering if I was overlooking a simple way to do this via web.xml
> servlet-mapping. I was trying to avoid having everything hit the same
> doGet().
>
> -----Original Message-----
> From: patrick o'leary [mailto:pjaol@pjaol.com]
> Sent: Tuesday, April 21, 2009 12:51 PM
> To: java-user@lucene.apache.org
> Subject: Re: Servlets Sharing Resources
>
> Why not have 1 servlet and based on a parameter / url, serve 2 different
> outputs?
>
> if(request.getString("asXML") !=null)
>   showXML();
> else
>   showOtherStuff();
>
> Save yourself the hassle of dealing with jndi / contexts / spring or
> SingleTons
>
> On Tue, Apr 21, 2009 at 12:01 PM, David Seltzer <dseltzer@tveyes.com>
> wrote:
>
> > Hi All,
> >
> > Sorry for the slightly off-topic question, but I've just run into a
> gap
> > in my understanding of Servlet programming.
> >
> > The question: Is it possible for two servlets to share access to an
> > instance of IndexSearcher or an IndexReader? I'm thinking about
> setting
> > up a Search servlet to provide XML search results and a Statistics
> > servlet to provide numeric statistics based on the same data.
> >
> > I imagine the right way to do it is to make both servlets child
> classes
> > of a manager class, but I'm not sure how that would look. I'm also not
> > sure how to configure tomcat in this scenario?
> >
> > -Dave
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd47b069eedd8046813cbf6--

From java-user-return-39864-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 18:29:36 2009
Return-Path: <java-user-return-39864-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40273 invoked from network); 21 Apr 2009 18:29:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 18:29:36 -0000
Received: (qmail 53416 invoked by uid 500); 21 Apr 2009 18:29:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53377 invoked by uid 500); 21 Apr 2009 18:29:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53367 invoked by uid 99); 21 Apr 2009 18:29:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 18:29:33 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 18:29:26 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: RE: Servlets Sharing Resources
Date: Tue, 21 Apr 2009 14:29:02 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC291E@mail02.tveyes.com>
In-Reply-To: <1e33aedb0904211015l776e372bwc71d3f25e6228b21@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Servlets Sharing Resources
thread-index: AcnCpNxAcU2n/JohSVqh9sbOAOVU+gACYagQ
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com> <1e33aedb0904210950y3722169ald1a1b5720d2f5e45@mail.gmail.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28F1@mail02.tveyes.com> <1e33aedb0904211015l776e372bwc71d3f25e6228b21@mail.gmail.com>
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

> But honestly, you'll just spend the next few hours googling, pulling
out
> hair, buying a book on jboss
> and then curse it, and do it this way in the end..

Spoken like a man who's been there. Hehe... Who hasn't...

I'm going to try storing a persistent manager class in the
ServletContext so I can access it from the various servlets. It's not a
100% solution, but I think it'll strike the right balance between
madness and a series of increasingly annoying if-statements. :-)

Unless there's a reason that's a bad idea... The only thing I can think
of is that I need to make sure that one servlet is responsible for
setting it up and disposing of it.

-Dave

-----Original Message-----
From: patrick o'leary [mailto:pjaol@pjaol.com]=20
Sent: Tuesday, April 21, 2009 1:16 PM
To: java-user@lucene.apache.org
Subject: Re: Servlets Sharing Resources

Not every servlet container will support the same cross context
methodology.
Most would say you're approach is an EJB with a life cycle outside of
the
interaction layer.

But honestly, you'll just spend the next few hours googling, pulling out
hair, buying a book on jboss
and then curse it, and do it this way in the end..



On Tue, Apr 21, 2009 at 12:56 PM, David Seltzer <dseltzer@tveyes.com>
wrote:

> That certainly seems like the simple way to solve the problem. I was
> just wondering if I was overlooking a simple way to do this via
web.xml
> servlet-mapping. I was trying to avoid having everything hit the same
> doGet().
>
> -----Original Message-----
> From: patrick o'leary [mailto:pjaol@pjaol.com]
> Sent: Tuesday, April 21, 2009 12:51 PM
> To: java-user@lucene.apache.org
> Subject: Re: Servlets Sharing Resources
>
> Why not have 1 servlet and based on a parameter / url, serve 2
different
> outputs?
>
> if(request.getString("asXML") !=3Dnull)
>   showXML();
> else
>   showOtherStuff();
>
> Save yourself the hassle of dealing with jndi / contexts / spring or
> SingleTons
>
> On Tue, Apr 21, 2009 at 12:01 PM, David Seltzer <dseltzer@tveyes.com>
> wrote:
>
> > Hi All,
> >
> > Sorry for the slightly off-topic question, but I've just run into a
> gap
> > in my understanding of Servlet programming.
> >
> > The question: Is it possible for two servlets to share access to an
> > instance of IndexSearcher or an IndexReader? I'm thinking about
> setting
> > up a Search servlet to provide XML search results and a Statistics
> > servlet to provide numeric statistics based on the same data.
> >
> > I imagine the right way to do it is to make both servlets child
> classes
> > of a manager class, but I'm not sure how that would look. I'm also
not
> > sure how to configure tomcat in this scenario?
> >
> > -Dave
> >
> >
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39865-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 19:02:32 2009
Return-Path: <java-user-return-39865-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67571 invoked from network); 21 Apr 2009 19:02:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 19:02:32 -0000
Received: (qmail 12006 invoked by uid 500); 21 Apr 2009 19:02:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11934 invoked by uid 500); 21 Apr 2009 19:02:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11924 invoked by uid 99); 21 Apr 2009 19:02:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 19:02:30 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [69.20.117.148] (HELO server107.appriver.com) (69.20.117.148)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 19:02:20 +0000
Received: by server107.appriver.com (CommuniGate Pro PIPE 5.2.0)
  with PIPE id 147338968; Tue, 21 Apr 2009 15:01:59 -0400
Received: from [207.97.230.78] (HELO FE04.exg3.exghost.com)
  by server107.appriver.com (CommuniGate Pro SMTP 5.2.0)
  with ESMTP id 147338945 for java-user@lucene.apache.org; Tue, 21 Apr 2009 15:01:58 -0400
Received: from FE04.exg3.exghost.com ([207.97.230.78]) by FE04.exg3.exghost.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 21 Apr 2009 15:01:57 -0400
Received: from localhost ([207.97.202.204]) by FE04.exg3.exghost.com over TLS secured channel with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 21 Apr 2009 15:01:57 -0400
Date: Wed, 22 Apr 2009 00:31:53 +0530 (IST)
From: Harini Raghavan <harini.raghavan@insideview.com>
To: java-user@lucene.apache.org
Message-ID: <19095367.691240340442108.JavaMail.harini@harini-laptop>
In-Reply-To: <15981458.671240340381284.JavaMail.harini@harini-laptop>
Subject: Share Index on NFS
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 21 Apr 2009 19:01:57.0732 (UTC) FILETIME=[A4D7F240:01C9C2B3]
X-Policy: GLOBAL - insideview.com
X-Primary: harini.raghavan@insideview.com
X-Note: This Email was scanned by AppRiver SecureTide
X-ALLOW: harini.raghavan@insideview.com ALLOWED
X-Virus-Scan: V-
X-Note: Spam Tests Failed: 
X-Country-Path: UNITED STATES->UNITED STATES->UNITED STATES->UNITED STATES
X-Note-Sending-IP: 207.97.230.78
X-Note-Reverse-DNS: fe04.exg3.exghost.com
X-Note-WHTLIST: harini.raghavan@insideview.com
X-Note: User Rule Hits: 
X-Note: Global Rule Hits: 108 109 110 111 115 116 193 
X-Note: Mail Class: ALLOWEDSENDER
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Everyone,

We are planning to distribute searches on the index and have a single indexing node. We want to mount the index on NFS so that it can be shared by the indexer and searcher nodes. To optimize several of our search workflows, we are caching the IndexSearcher and refreshing it every hour. Also to improve the performance of some complex workflows, we are caching the Lucene document ids. We are trying to set the deletion policy to ExpirationTimeDeletionPolicy to make use of the Lucene's NFS support. But since our IndexSearcher and doc id cache are refreshed only every 60 mins, we set the expiration time to 80 mins. But this resulted in too many files being created in the index directory. We got more than 1000 files in the index in less than 10 mins.

This makes me wonder if the expiration time deletion policy fix will work in our scenario. Should we be going fo some other solution to use NFS store?

Thanks,
Harini


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39866-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 20:10:45 2009
Return-Path: <java-user-return-39866-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7654 invoked from network); 21 Apr 2009 20:10:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 20:10:44 -0000
Received: (qmail 44602 invoked by uid 500); 21 Apr 2009 20:10:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44530 invoked by uid 500); 21 Apr 2009 20:10:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44520 invoked by uid 99); 21 Apr 2009 20:10:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:10:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [134.96.191.147] (HELO smtp.dfki.de) (134.96.191.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:10:33 +0000
Received: from smtp.dfki.de (localhost [127.0.0.1])
	by imss.7 (Postfix) with ESMTP id 36E253144B
	for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 22:10:12 +0200 (CEST)
Received: from mail.dfki.de (lnv-104.sb.dfki.de [134.96.191.146])
	by smtp.dfki.de (Postfix) with ESMTP id DD6CB312CD
	for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 22:10:11 +0200 (CEST)
Received: from [192.168.178.47] (BAH0e66.bah.pppool.de [77.135.14.102])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.dfki.de (Postfix) with ESMTPSA id 9D4A5310D3
	for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 22:10:11 +0200 (CEST)
Message-Id: <60792372-8911-43AB-9A9E-BB9A9E897FB2@activemath.org>
From: Paul Libbrecht <paul@activemath.org>
To: java-user@lucene.apache.org
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC291E@mail02.tveyes.com>
Content-Type: multipart/signed; boundary=Apple-Mail-220-44404987; micalg=sha1; protocol="application/pkcs7-signature"
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Servlets Sharing Resources
Date: Tue, 21 Apr 2009 22:10:09 +0200
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28D0@mail02.tveyes.com> <1e33aedb0904210950y3722169ald1a1b5720d2f5e45@mail.gmail.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC28F1@mail02.tveyes.com> <1e33aedb0904211015l776e372bwc71d3f25e6228b21@mail.gmail.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC291E@mail02.tveyes.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail-220-44404987
Content-Type: text/plain;
	charset=ISO-8859-1;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: quoted-printable

Various servlets or various webapps?
Various servlets is trivial, indeed using ServletContext.getAttribute().
Various webapps is more difficult:
- you need to set cross context so that context.getContext("/=20
otherpath") is accessible (a config of context in tomcat)
- you need classes to be shared (put jars in lib in tomcat)

Instead of context.getAttribute() you can always use statics....

paul


Le 21-avr.-09 =E0 20:29, David Seltzer a =E9crit :

> I'm going to try storing a persistent manager class in the
> ServletContext so I can access it from the various servlets. It's =20
> not a
> 100% solution, but I think it'll strike the right balance between
> madness and a series of increasingly annoying if-statements. :-)
>
> Unless there's a reason that's a bad idea... The only thing I can =20
> think
> of is that I need to make sure that one servlet is responsible for
> setting it up and disposing of it.


--Apple-Mail-220-44404987
Content-Disposition: attachment;
	filename=smime.p7s
Content-Type: application/pkcs7-signature;
	name=smime.p7s
Content-Transfer-Encoding: base64

MIAGCSqGSIb3DQEHAqCAMIACAQExCzAJBgUrDgMCGgUAMIAGCSqGSIb3DQEHAQAAoIIFzjCCAocw
ggHwoAMCAQICEFwkG9LgbGf8Fuu/5kCXRScwDQYJKoZIhvcNAQEFBQAwYjELMAkGA1UEBhMCWkEx
JTAjBgNVBAoTHFRoYXd0ZSBDb25zdWx0aW5nIChQdHkpIEx0ZC4xLDAqBgNVBAMTI1RoYXd0ZSBQ
ZXJzb25hbCBGcmVlbWFpbCBJc3N1aW5nIENBMB4XDTA4MDYwMzE1MTgyOVoXDTA5MDYwMzE1MTgy
OVowcDEaMBgGA1UEBBMRTGliYnJlY2h0IEdvdXJkZXQxDTALBgNVBCoTBFBhdWwxHzAdBgNVBAMT
FlBhdWwgTGliYnJlY2h0IEdvdXJkZXQxIjAgBgkqhkiG9w0BCQEWE3BhdWxAYWN0aXZlbWF0aC5v
cmcwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMAHqTEgekG5Iyctn3tSRSfsPoZL+vkFavzl
w/xbbiQ4vWuoCZFVNHvLcFO2rfWoFLaRbcueLsmagsJwA1uxAj4tj/neoawadD+jZ3a98BkqBhIu
4hsC1poLDyvcbUOdKga9DXQ/pk/CorFvR7OOC1INrBtbDi7ycUYaUL7ZkpBFAgMBAAGjMDAuMB4G
A1UdEQQXMBWBE3BhdWxAYWN0aXZlbWF0aC5vcmcwDAYDVR0TAQH/BAIwADANBgkqhkiG9w0BAQUF
AAOBgQAt7uUnq0yd+jIo9/zYyj+NPyCh3v8CX8MW2qalj37t1YUR82o5/1O5z0sXj7+hQmSEWH7N
BgptwNvhNoKWTYo5c8HBsAMvvv1ruSXYKlsRvPBfewHEEo2KgH73SImj2w7a8owq3t0KLVCPP7d4
RXnrXJf6nuXlsvfFFEd6aIN7VjCCAz8wggKooAMCAQICAQ0wDQYJKoZIhvcNAQEFBQAwgdExCzAJ
BgNVBAYTAlpBMRUwEwYDVQQIEwxXZXN0ZXJuIENhcGUxEjAQBgNVBAcTCUNhcGUgVG93bjEaMBgG
A1UEChMRVGhhd3RlIENvbnN1bHRpbmcxKDAmBgNVBAsTH0NlcnRpZmljYXRpb24gU2VydmljZXMg
RGl2aXNpb24xJDAiBgNVBAMTG1RoYXd0ZSBQZXJzb25hbCBGcmVlbWFpbCBDQTErMCkGCSqGSIb3
DQEJARYccGVyc29uYWwtZnJlZW1haWxAdGhhd3RlLmNvbTAeFw0wMzA3MTcwMDAwMDBaFw0xMzA3
MTYyMzU5NTlaMGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQKExxUaGF3dGUgQ29uc3VsdGluZyAoUHR5
KSBMdGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwgRnJlZW1haWwgSXNzdWluZyBDQTCBnzAN
BgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAxKY8VXNV+065yplaHmjAdQRwnd/p/6Me7L3N9VvyGna9
fww6YfK/Uc4B1OVQCjDXAmNaLIkVcI7dyfArhVqqP3FWy688Cwfn8R+RNiQqE88r1fOCdz0Dviv+
uxg+B79AgAJk16emu59l0cUqVIUPSAR/p7bRPGEEQB5kGXJgt/sCAwEAAaOBlDCBkTASBgNVHRMB
Af8ECDAGAQH/AgEAMEMGA1UdHwQ8MDowOKA2oDSGMmh0dHA6Ly9jcmwudGhhd3RlLmNvbS9UaGF3
dGVQZXJzb25hbEZyZWVtYWlsQ0EuY3JsMAsGA1UdDwQEAwIBBjApBgNVHREEIjAgpB4wHDEaMBgG
A1UEAxMRUHJpdmF0ZUxhYmVsMi0xMzgwDQYJKoZIhvcNAQEFBQADgYEASIzRUIPqCy7MDaNmrGcP
f6+svsIXoUOWlJ1/TCG4+DYfqi2fNi/A9BxQIJNwPP2t4WFiw9k6GX6EsZkbAMUaC4J0niVQlGLH
2ydxVyWN3amcOY6MIE9lX5Xa9/eH1sYITq726jTlEBpbNU1341YheILcIRk13iSx0x1G/11fZU8x
ggKPMIICiwIBATB2MGIxCzAJBgNVBAYTAlpBMSUwIwYDVQQKExxUaGF3dGUgQ29uc3VsdGluZyAo
UHR5KSBMdGQuMSwwKgYDVQQDEyNUaGF3dGUgUGVyc29uYWwgRnJlZW1haWwgSXNzdWluZyBDQQIQ
XCQb0uBsZ/wW67/mQJdFJzAJBgUrDgMCGgUAoIIBbzAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcB
MBwGCSqGSIb3DQEJBTEPFw0wOTA0MjEyMDEwMTBaMCMGCSqGSIb3DQEJBDEWBBTSd6ox6FnDScss
Z+6taaQdVhh2kTCBhQYJKwYBBAGCNxAEMXgwdjBiMQswCQYDVQQGEwJaQTElMCMGA1UEChMcVGhh
d3RlIENvbnN1bHRpbmcgKFB0eSkgTHRkLjEsMCoGA1UEAxMjVGhhd3RlIFBlcnNvbmFsIEZyZWVt
YWlsIElzc3VpbmcgQ0ECEFwkG9LgbGf8Fuu/5kCXRScwgYcGCyqGSIb3DQEJEAILMXigdjBiMQsw
CQYDVQQGEwJaQTElMCMGA1UEChMcVGhhd3RlIENvbnN1bHRpbmcgKFB0eSkgTHRkLjEsMCoGA1UE
AxMjVGhhd3RlIFBlcnNvbmFsIEZyZWVtYWlsIElzc3VpbmcgQ0ECEFwkG9LgbGf8Fuu/5kCXRScw
DQYJKoZIhvcNAQEBBQAEgYC03lJuM6ijZijPB5K9BWx9c+nlLbE9kTG0xHZkCJ64AcJo0GyMMF0J
Jle/4oGvjsk5kQJvSc3KfhIseWG8KrrzGOtn1DvYkVEZm6jcCkVeeNQOIm729N03ZYQFFMdIDZzl
4onM90RG2I/eaHOQWqo8PPzxZQCc0lyNA+7zl9VoSwAAAAAAAA==

--Apple-Mail-220-44404987--

From java-user-return-39867-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 20:27:10 2009
Return-Path: <java-user-return-39867-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13930 invoked from network); 21 Apr 2009 20:27:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 20:27:10 -0000
Received: (qmail 88548 invoked by uid 500); 21 Apr 2009 20:27:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88512 invoked by uid 500); 21 Apr 2009 20:27:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88502 invoked by uid 99); 21 Apr 2009 20:27:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:27:07 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [87.233.177.133] (HELO core.aduna-software.com) (87.233.177.133)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:26:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by core.aduna-software.com (Postfix) with ESMTP id 92162AA037B
	for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 22:26:25 +0200 (CEST)
X-Virus-Scanned: amavisd-new at 
X-Spam-Score: -2.491
X-Spam-Level: 
Received: from core.aduna-software.com ([127.0.0.1])
	by localhost (core.aduna-software.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id F2I3rQyGA2zq for <java-user@lucene.apache.org>;
	Tue, 21 Apr 2009 22:26:20 +0200 (CEST)
Received: from [192.168.1.101] (53578B7E.cable.casema.nl [83.87.139.126])
	by core.aduna-software.com (Postfix) with ESMTP id BF1B9AA037A
	for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 22:26:20 +0200 (CEST)
Message-ID: <49EE2BF4.8090304@aduna-software.com>
Date: Tue, 21 Apr 2009 22:26:28 +0200
From: Christiaan Fluit <christiaan.fluit@aduna-software.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: MergeException
References: <b300aae70904210801y6a6471e1x872ea71ae89047f8@mail.gmail.com>
In-Reply-To: <b300aae70904210801y6a6471e1x872ea71ae89047f8@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Flag: NO
X-Old-Spam-Status: No, score=-2.491 tagged_above=-10 required=4 tests=[AWL=0.008,
	BAYES_00=-2.599, RDNS_DYNAMIC=0.1]

I have experienced similar problems (see the "semi-infinite loop during 
merging" thread - still working out the problem): the merger gets into 
an infinite loop and causes my drive to be filled with temporary files 
that are not deleted, until it runs out of space. Sometimes it exits 
with a MergeException wrapping one of a variety of IOExceptions (e.g. a 
FileNotFoundException), sometimes it just keeps on consuming all 
available CPU time.

I think the "_k0z.fnm" file name indicates that a lot of segments have 
already been created, as it starts iterating with _0, _1, ... I don't 
want to jump to conclusions immediately, but this is consistent with a 
merger gone loose.

Was your drive full as well afterwards?

Regards,

Chris
--

Martine Woudstra wrote:
> Hi all,
> 
> I'm using Lucene 2.4.1. for building an ngram index. Indexing works
> well until I try to open the index built so far with Luke. A
> MergeException is thrown, see below. Opening an index with Luke during
> indexing never caused problems with Lucene 2.3. Anyone familiar with
> this problem?
> 
> Thanks in advance,
> 
> Martine van der Heijden
> 
> 
> Exception in thread "Lucene Merge Thread #3067"
> org.apache.lucene.index.MergePolicy$MergeException:
> java.io.FileNotFoundException: D:\indexngram\_k0z.fnm (Het systeem kan
> het opgegeven bestand niet vinden)
> 	at org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:309)
> 	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:286)
> Caused by: java.io.FileNotFoundException: D:\indexngram\_k0z.fnm (Het
> systeem kan het opgegeven bestand niet vinden)
> 	at java.io.RandomAccessFile.open(Native Method)
> 	at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
> 	at org.apache.lucene.store.FSDirectory$FSIndexInput$Descriptor.<init>(FSDirectory.java:552)
> 	at org.apache.lucene.store.FSDirectory$FSIndexInput.<init>(FSDirectory.java:582)
> 	at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:488)
> 	at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:482)
> 	at org.apache.lucene.index.CompoundFileWriter.copyFile(CompoundFileWriter.java:221)
> 	at org.apache.lucene.index.CompoundFileWriter.close(CompoundFileWriter.java:184)
> 	at org.apache.lucene.index.SegmentMerger.createCompoundFile(SegmentMerger.java:204)
> 	at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4263)
> 	at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3884)
> 	at org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:205)
> 	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:260)
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39868-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 20:44:02 2009
Return-Path: <java-user-return-39868-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19370 invoked from network); 21 Apr 2009 20:44:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 20:44:02 -0000
Received: (qmail 26586 invoked by uid 500); 21 Apr 2009 20:44:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26543 invoked by uid 500); 21 Apr 2009 20:44:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26533 invoked by uid 99); 21 Apr 2009 20:44:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:44:00 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.198.237] (HELO rv-out-0506.google.com) (209.85.198.237)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:43:53 +0000
Received: by rv-out-0506.google.com with SMTP id l9so1081178rvb.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 13:43:32 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.13.14 with SMTP id 14mr4882604wfm.275.1240346612057; Tue, 
	21 Apr 2009 13:43:32 -0700 (PDT)
In-Reply-To: <b300aae70904210801y6a6471e1x872ea71ae89047f8@mail.gmail.com>
References: <b300aae70904210801y6a6471e1x872ea71ae89047f8@mail.gmail.com>
Date: Tue, 21 Apr 2009 16:43:32 -0400
Message-ID: <9ac0c6aa0904211343o41bd94f9t99940e6191c75e21@mail.gmail.com>
Subject: Re: MergeException
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Are you opening the index with Luke while indexing is still running?

Also, I don't understand why Luke would be causing any merging to
occur.  Or: did you ask Luke to optimize your index?

Mike

On Tue, Apr 21, 2009 at 11:01 AM, Martine Woudstra <woudstra.m@gmail.com> w=
rote:
> Hi all,
>
> I'm using Lucene 2.4.1. for building an ngram index. Indexing works
> well until I try to open the index built so far with Luke. A
> MergeException is thrown, see below. Opening an index with Luke during
> indexing never caused problems with Lucene 2.3. Anyone familiar with
> this problem?
>
> Thanks in advance,
>
> Martine van der Heijden
>
>
> Exception in thread "Lucene Merge Thread #3067"
> org.apache.lucene.index.MergePolicy$MergeException:
> java.io.FileNotFoundException: D:\indexngram\_k0z.fnm (Het systeem kan
> het opgegeven bestand niet vinden)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.ConcurrentMergeScheduler.handle=
MergeException(ConcurrentMergeScheduler.java:309)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.ConcurrentMergeScheduler$MergeT=
hread.run(ConcurrentMergeScheduler.java:286)
> Caused by: java.io.FileNotFoundException: D:\indexngram\_k0z.fnm (Het
> systeem kan het opgegeven bestand niet vinden)
> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.open(Native Method)
> =A0 =A0 =A0 =A0at java.io.RandomAccessFile.<init>(RandomAccessFile.java:2=
12)
> =A0 =A0 =A0 =A0at org.apache.lucene.store.FSDirectory$FSIndexInput$Descri=
ptor.<init>(FSDirectory.java:552)
> =A0 =A0 =A0 =A0at org.apache.lucene.store.FSDirectory$FSIndexInput.<init>=
(FSDirectory.java:582)
> =A0 =A0 =A0 =A0at org.apache.lucene.store.FSDirectory.openInput(FSDirecto=
ry.java:488)
> =A0 =A0 =A0 =A0at org.apache.lucene.store.FSDirectory.openInput(FSDirecto=
ry.java:482)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.CompoundFileWriter.copyFile(Com=
poundFileWriter.java:221)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.CompoundFileWriter.close(Compou=
ndFileWriter.java:184)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.SegmentMerger.createCompoundFil=
e(SegmentMerger.java:204)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWr=
iter.java:4263)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.merge(IndexWriter.j=
ava:3884)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.ConcurrentMergeScheduler.doMerg=
e(ConcurrentMergeScheduler.java:205)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.ConcurrentMergeScheduler$MergeT=
hread.run(ConcurrentMergeScheduler.java:260)
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39869-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 20:45:06 2009
Return-Path: <java-user-return-39869-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19710 invoked from network); 21 Apr 2009 20:45:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 20:45:06 -0000
Received: (qmail 29606 invoked by uid 500); 21 Apr 2009 20:45:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29552 invoked by uid 500); 21 Apr 2009 20:45:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29501 invoked by uid 99); 21 Apr 2009 20:45:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:45:03 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.198.235] (HELO rv-out-0506.google.com) (209.85.198.235)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:44:56 +0000
Received: by rv-out-0506.google.com with SMTP id l9so1081546rvb.5
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 13:44:36 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.128.3 with SMTP id a3mr4885201wfd.206.1240346676420; Tue, 
	21 Apr 2009 13:44:36 -0700 (PDT)
In-Reply-To: <49EE2BF4.8090304@aduna-software.com>
References: <b300aae70904210801y6a6471e1x872ea71ae89047f8@mail.gmail.com>
	 <49EE2BF4.8090304@aduna-software.com>
Date: Tue, 21 Apr 2009 16:44:36 -0400
Message-ID: <9ac0c6aa0904211344u2db79574h6dd12ffe532d9927@mail.gmail.com>
Subject: Re: MergeException
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, Apr 21, 2009 at 4:26 PM, Christiaan Fluit
<christiaan.fluit@aduna-software.com> wrote:
> I have experienced similar problems (see the "semi-infinite loop during
> merging" thread - still working out the problem): the merger gets into an
> infinite loop and causes my drive to be filled with temporary files that are
> not deleted, until it runs out of space.

Christiaan, I responded on that thread on where to sprinkle prints...
any update?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39870-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 20:47:17 2009
Return-Path: <java-user-return-39870-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20300 invoked from network); 21 Apr 2009 20:47:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 20:47:17 -0000
Received: (qmail 33074 invoked by uid 500); 21 Apr 2009 20:47:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32987 invoked by uid 500); 21 Apr 2009 20:47:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32977 invoked by uid 99); 21 Apr 2009 20:47:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:47:14 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.173] (HELO wf-out-1314.google.com) (209.85.200.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:47:06 +0000
Received: by wf-out-1314.google.com with SMTP id 29so2072220wff.20
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 13:46:45 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.9.11 with SMTP id m11mr4937660wfi.44.1240346805660; Tue, 
	21 Apr 2009 13:46:45 -0700 (PDT)
In-Reply-To: <23145720.post@talk.nabble.com>
References: <23089805.post@talk.nabble.com> <23092183.post@talk.nabble.com>
	 <9ac0c6aa0904170046x68fa5ad1j23eb5ab6fe7c7cf9@mail.gmail.com>
	 <23093956.post@talk.nabble.com>
	 <9ac0c6aa0904170238y7b2e52a3x368b95c3ea81fa71@mail.gmail.com>
	 <23145720.post@talk.nabble.com>
Date: Tue, 21 Apr 2009 16:46:45 -0400
Message-ID: <9ac0c6aa0904211346x5e78b7b4l6db2ba5909d6177@mail.gmail.com>
Subject: Re: readModifiedUTF8String stuck
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Mon, Apr 20, 2009 at 6:07 PM, MakMak <powgri@gmail.com> wrote:

> =A0 I made a standalone tool like you suggested which prints out the size=
 of
> each doc in the index, none of the docs are more than 1MB !!! The queries
> are the same. They repeat throughout the test. We give about 6GB of heap =
to
> the application and yes we are on 64 bit JVM.

OK.

Any luck running CheckIndex?  Can you run w/ verbose GC, to see if GC
is running...?

> I hit upon another such issue here
> http://www.nabble.com/Lucene-2.2.0-in-64-bit-JVM:-IndexReader-is-hung-td2=
2667471.html
> http://www.nabble.com/Lucene-2.2.0-in-64-bit-JVM:-IndexReader-is-hung-td2=
2667471.html
> Do you think this may be related? There was no resolution on this thread
> though. We only upgraded lucene version and I am absolutely certain nothi=
ng
> else changed.

They could be related.  They sound very similar.

> One more thing, we tried to reproduce the customer environment here exact=
ly
> like they have it there. The only difference is, the index on the custome=
r's
> end resides in a SAN.

Are you not able to repro the issue locally?  So the SAN is the only
known difference?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39871-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 20:58:25 2009
Return-Path: <java-user-return-39871-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23400 invoked from network); 21 Apr 2009 20:58:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 20:58:25 -0000
Received: (qmail 54155 invoked by uid 500); 21 Apr 2009 20:58:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54079 invoked by uid 500); 21 Apr 2009 20:58:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54069 invoked by uid 99); 21 Apr 2009 20:58:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:58:22 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of unnutz@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 20:58:16 +0000
Received: by fg-out-1718.google.com with SMTP id l27so686344fgb.4
        for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 13:57:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:from:date:message-id
         :subject:to:content-type;
        bh=gK4w5zgBGFVEryk24DcnI9Y5isDqLKvBQwwHXlqugNM=;
        b=oP7SGNehY57P8X2d4p9pqhbwu4ibB1dcFKjXNbKZ4tpZ8pY6DTXwhu6ZyUveWZeAiz
         K+eVdBqVcENmCkgXU26KvD/FuEvNnDzRQgRuXQuK41Sc7RPHrWicpW7SC5Rtnsol9pmC
         GKKamXWLJ7yRL/nKyJd5sHpYFW7Vzj2DmI8oE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:from:date:message-id:subject:to:content-type;
        b=u9eSY2X0u9If1IaZSuM50v6jedb+TVPA5Zlx06hdLpEzXYRyOjddLufcJiGfqDx8m2
         kUg7yQfBFSK1LMvEOxKZ5p1Mc6A9VN30FhbBpQo6XnfA1f8kSm0v5UxlA7Wyfpeq+MOw
         hsR7Jsbpd7Wg5j4gl6CaJqfwWXByV26CM50i0=
MIME-Version: 1.0
Received: by 10.86.36.17 with SMTP id j17mr4844830fgj.38.1240347475040; Tue, 
	21 Apr 2009 13:57:55 -0700 (PDT)
From: Artyom Sokolov <unnutz@gmail.com>
Date: Wed, 22 Apr 2009 01:57:40 +0500
Message-ID: <edd377170904211357g373089e8y9f0788a38b525618@mail.gmail.com>
Subject: Appropriate analyzer
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd24492a5db40046816e656
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd24492a5db40046816e656
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hello.

Currently I'm trying to find something like an analyzer to solve the
problem.

Actually, what I need is next: search on a query string step-by-step,
trimming last char on each step. Small example:

In index we've: abc, abcdef, xyz
When search on abcdefgh the most relevant result should be abcdef, while
searching on abcde the best one is abc.

Thanks.

Sincerely,
Artyom Sokolov

--000e0cd24492a5db40046816e656--

From java-user-return-39872-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 21:54:24 2009
Return-Path: <java-user-return-39872-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57094 invoked from network); 21 Apr 2009 21:54:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 21:54:24 -0000
Received: (qmail 56536 invoked by uid 500); 21 Apr 2009 21:54:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56460 invoked by uid 500); 21 Apr 2009 21:54:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56450 invoked by uid 99); 21 Apr 2009 21:54:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 21:54:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [87.233.177.133] (HELO core.aduna-software.com) (87.233.177.133)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 21:54:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by core.aduna-software.com (Postfix) with ESMTP id 95910AA037B
	for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 23:53:52 +0200 (CEST)
X-Virus-Scanned: amavisd-new at 
X-Spam-Score: -2.495
X-Spam-Level: 
Received: from core.aduna-software.com ([127.0.0.1])
	by localhost (core.aduna-software.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id iaAIB3hvNK3m for <java-user@lucene.apache.org>;
	Tue, 21 Apr 2009 23:53:48 +0200 (CEST)
Received: from [192.168.1.101] (53578B7E.cable.casema.nl [83.87.139.126])
	by core.aduna-software.com (Postfix) with ESMTP id C9BE8AA037A
	for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 23:53:47 +0200 (CEST)
Message-ID: <49EE4069.3050104@aduna-software.com>
Date: Tue, 21 Apr 2009 23:53:45 +0200
From: Christiaan Fluit <christiaan.fluit@aduna-software.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: MergeException
References: <b300aae70904210801y6a6471e1x872ea71ae89047f8@mail.gmail.com>	 <49EE2BF4.8090304@aduna-software.com> <9ac0c6aa0904211344u2db79574h6dd12ffe532d9927@mail.gmail.com>
In-Reply-To: <9ac0c6aa0904211344u2db79574h6dd12ffe532d9927@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Flag: NO
X-Old-Spam-Status: No, score=-2.495 tagged_above=-10 required=4 tests=[AWL=0.004,
	BAYES_00=-2.599, RDNS_DYNAMIC=0.1]

Michael McCandless wrote:
> On Tue, Apr 21, 2009 at 4:26 PM, Christiaan Fluit
> <christiaan.fluit@aduna-software.com> wrote:
>> I have experienced similar problems (see the "semi-infinite loop during
>> merging" thread - still working out the problem): the merger gets into an
>> infinite loop and causes my drive to be filled with temporary files that are
>> not deleted, until it runs out of space.
> 
> Christiaan, I responded on that thread on where to sprinkle prints...
> any update?

I have some new results. I will post them in the original thread.


Regards,

Chris
--

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39873-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 22:01:04 2009
Return-Path: <java-user-return-39873-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63460 invoked from network); 21 Apr 2009 22:01:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 22:01:03 -0000
Received: (qmail 77936 invoked by uid 500); 21 Apr 2009 22:01:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77868 invoked by uid 500); 21 Apr 2009 22:01:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77858 invoked by uid 99); 21 Apr 2009 22:01:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 22:01:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [87.233.177.133] (HELO core.aduna-software.com) (87.233.177.133)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 22:00:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by core.aduna-software.com (Postfix) with ESMTP id 29F02AA037B
	for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 00:00:32 +0200 (CEST)
X-Virus-Scanned: amavisd-new at 
X-Spam-Score: -2.498
X-Spam-Level: 
Received: from core.aduna-software.com ([127.0.0.1])
	by localhost (core.aduna-software.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id SxSb2ALhBibR for <java-user@lucene.apache.org>;
	Wed, 22 Apr 2009 00:00:27 +0200 (CEST)
Received: from [192.168.1.101] (53578B7E.cable.casema.nl [83.87.139.126])
	by core.aduna-software.com (Postfix) with ESMTP id 78868AA037A
	for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 00:00:27 +0200 (CEST)
Message-ID: <49EE41F9.3030007@aduna-software.com>
Date: Wed, 22 Apr 2009 00:00:25 +0200
From: Christiaan Fluit <christiaan.fluit@aduna-software.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: semi-infinite loop during merging
References: <49E4573E.7070208@aduna-software.com>	 <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>	 <49E6FD9F.5080104@aduna-software.com> <9ac0c6aa0904160510l6cf559c6yfc6b0c1deadbf1de@mail.gmail.com>
In-Reply-To: <9ac0c6aa0904160510l6cf559c6yfc6b0c1deadbf1de@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Flag: NO
X-Old-Spam-Status: No, score=-2.498 tagged_above=-10 required=4 tests=[AWL=0.001,
	BAYES_00=-2.599, RDNS_DYNAMIC=0.1]

Michael McCandless wrote:
> One question: are you using IndexWriter.close(false)?  I wonder if
> there's some path whereby the merges fail to abort (and simply keep
> retrying) if you do that...

No, I don't.

> More inlined below...
> 
> On Thu, Apr 16, 2009 at 5:42 AM, Christiaan Fluit
> <christiaan.fluit@aduna-software.com> wrote:
>> I spent a lot of time on getting the stacktraces, but JET seems to make this
>> impossible. Ctrl-Break, connecting with JConsole, even a "Dump Threads"
>> button in my UI that uses Threads.getAllStacktraces were not able to produce
>> a dump of all threads.
> 
> Sigh.
> 
>> I just got an additional confirmation that the problem also occurs with the
>> Java build, but unfortunately the client's data is too sensitive to share it
>> with me.
> 
> Could they "kill -QUIT" or  Ctrl-Break when it's happening?

The confirmation was received recently but the problem occurred a while 
ago and can't be reproduced now.

>> One option is to hack the Lucene 2.4.1 code to print out some additional
>> debug info. Do you known some println's that would help?
> 
> How about adding this at the top of IndexWriter.handleMergeException:
> 
>   if (infoStream != null) {
>     message("handleMergeException: merge=" +
> merge.segString(directory) + " exc=" + t);
>   }
> 
> ?
> 
> You could also sprinkle prints in between where message("merge:
> total"...) occurs and the call to commitMerge, in
> IndexWriter.mergeMiddle.  The mystery here is why you see these two
> lines in a row:
> 
>   IW 0 [CrawlThread]: merge: total 18586 docs
>   IW 0 [CrawlThread]: LMP: findMerges: 10 segments
> 
> That first line is supposed to be followed by a "commitMerge: ..."
> line.  I suspect some exception (maybe a MergeAbortedException) is
> being hit, leading to the commit not happening.
> 
>> Also I suspect that JET-compiled code is able to do Thread.dumpStack (but
>> not Thread.getAllStackTraces), so what are good locations for doing that?
>> E.g. IndexWriter.merge, etc.
> 
> This would be great -- I would add that in handleMergeException as well.

A test run with the modified code just completed minutes ago.

I modified IndexWriter in two places. IW.handleMergeException starts 
with the following code:

   if (infoStream != null) {
     message("handleMergeException: merge=" + merge.segString(directory)
         + " exc=" + t);
		
     message("dumping current stack");
     new Exception("Stack trace").printStackTrace(infoStream);
		
     message("dumping throwable");
     t.printStackTrace(infoStream);
   }

To IW.mergeMiddle I added eight message(String) invocations:

[...]
   try {
     [...]

     message("IW: checkAborted");
     merge.checkAborted(directory);
     message("IW: checkAborted done");

     // This is where all the work happens:
     message("IW: mergedDocCount");
     mergedDocCount = merge.info.docCount = 
merger.merge(merge.mergeDocStores);
     message("IW: mergedDocCount done");

     assert mergedDocCount == totDocCount;
     } finally {
       // close readers before we attempt to delete
       // now-obsolete segments
       if (merger != null) {
     	message("IW: closeReaders");
         merger.closeReaders();
   	message("IW: closeReaders done");
       }
     }

     message("IW: commitMerge");
     if (!commitMerge(merge, merger, mergedDocCount))
       // commitMerge will return false if this merge was aborted
       return 0;
     message("IW: commitMerge done");
[...]

This gives the following output:

[...]
IFD [CrawlThread]: delete "_9.fnm"
IFD [CrawlThread]: delete "_9.frq"
IFD [CrawlThread]: delete "_9.prx"
IFD [CrawlThread]: delete "_9.tis"
IFD [CrawlThread]: delete "_9.tii"
IFD [CrawlThread]: delete "_9.nrm"
IFD [CrawlThread]: delete "_9.tvx"
IFD [CrawlThread]: delete "_9.tvf"
IFD [CrawlThread]: delete "_9.tvd"
IFD [CrawlThread]: delete "_9.fdx"
IFD [CrawlThread]: delete "_9.fdt"
IW 1 [CrawlThread]: LMP: findMerges: 10 segments
IW 1 [CrawlThread]: LMP:   level 6.9529195 to 7.7029195: 10 segments
IW 1 [CrawlThread]: LMP:     0 to 10: add this merge
IW 1 [CrawlThread]: add merge to pendingMerges: _0:c2201 _1:c1806 
_2:c1023 _3:c430 _4:c1166 _5:c812 _6:c1737 _7:c2946 _8:c3129 _9:c3429 
[total 1 pending]
IW 1 [CrawlThread]: now merge
   merge=_0:c2201 _1:c1806 _2:c1023 _3:c430 _4:c1166 _5:c812 _6:c1737 
_7:c2946 _8:c3129 _9:c3429 into _a
   merge=org.apache.lucene.index.MergePolicy$OneMerge@14171768
   index=_0:c2201 _1:c1806 _2:c1023 _3:c430 _4:c1166 _5:c812 _6:c1737 
_7:c2946 _8:c3129 _9:c3429
IW 1 [CrawlThread]: merging _0:c2201 _1:c1806 _2:c1023 _3:c430 _4:c1166 
_5:c812 _6:c1737 _7:c2946 _8:c3129 _9:c3429 into _a
IW 1 [CrawlThread]: merge: total 18678 docs
IW 1 [CrawlThread]: IW: checkAborted
IW 1 [CrawlThread]: IW: checkAborted done
IW 1 [CrawlThread]: IW: mergedDocCount
IW 1 [CrawlThread]: IW: mergedDocCount done
IW 1 [CrawlThread]: IW: closeReaders
IW 1 [CrawlThread]: IW: closeReaders done
IW 1 [CrawlThread]: IW: commitMerge
IW 1 [CrawlThread]: LMP: findMerges: 10 segments
IW 1 [CrawlThread]: LMP:   level 6.9529195 to 7.7029195: 10 segments
IW 1 [CrawlThread]: LMP:     0 to 10: add this merge
IW 1 [CrawlThread]: add merge to pendingMerges: _0:c2201 _1:c1806 
_2:c1023 _3:c430 _4:c1166 _5:c812 _6:c1737 _7:c2946 _8:c3129 _9:c3429 
[total 1 pending]
... and this goes on and on.

It seems that it gets up to the point to commit, but the "IW: 
commitMerge done" message is never reached.

Furthermore, no exceptions are printed to the output, so 
handleMergeException does not seem to have been invoked.

Should I add more debug statements elsewhere?


Kind regards,

Chris
--

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39874-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 22:25:57 2009
Return-Path: <java-user-return-39874-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80377 invoked from network); 21 Apr 2009 22:25:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 22:25:56 -0000
Received: (qmail 19964 invoked by uid 500); 21 Apr 2009 22:25:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19880 invoked by uid 500); 21 Apr 2009 22:25:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19870 invoked by uid 99); 21 Apr 2009 22:25:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 22:25:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 22:25:45 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LwOP6-0000Dx-ST
	for java-user@lucene.apache.org; Tue, 21 Apr 2009 15:25:24 -0700
Message-ID: <23166111.post@talk.nabble.com>
Date: Tue, 21 Apr 2009 15:25:24 -0700 (PDT)
From: MakMak <powgri@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: readModifiedUTF8String stuck
In-Reply-To: <9ac0c6aa0904211346x5e78b7b4l6db2ba5909d6177@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: powgri@gmail.com
References: <23089805.post@talk.nabble.com> <23092183.post@talk.nabble.com> <9ac0c6aa0904170046x68fa5ad1j23eb5ab6fe7c7cf9@mail.gmail.com> <23093956.post@talk.nabble.com> <9ac0c6aa0904170238y7b2e52a3x368b95c3ea81fa71@mail.gmail.com> <23145720.post@talk.nabble.com> <9ac0c6aa0904211346x5e78b7b4l6db2ba5909d6177@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org



Mike,

   Ran CheckIndex. This is what it prints out:

cantOpenSegments: false
numBadSegments: 0
numSegments: 14
segmentFormat: FORMAT_HAS_PROX [Lucene 2.4]
segmentsFileName: segments_2od
totLoseDocCount: 0
clean: true
toolOutOfDate: false


So I guess everything is fine ..!=20

Our application is a very resource intensive application. We have everythin=
g
in the RAM for best possible response time and granularity of our
authorization model. We give around 6GB of RAM for the application. During
stress tests the RAM consumption gets used up to "2% free". But this has
always been the case when we were on 2.3.2. With 2.4.1 is when we started
hitting upon these stuck threads.


There are other differences between the customer and our setup apart from
SAN like http/https, webservices enabled/disabled etc but these shouldnt
have anything to do with this problem.

Currently we are trying to bring the indexes  out of the SAN and into the
local filesystem to see if these issues remain. Will keep you posted.=20

Anymore hints?

-thanks a ton for all the help


Michael McCandless-2 wrote:
>=20
> On Mon, Apr 20, 2009 at 6:07 PM, MakMak <powgri@gmail.com> wrote:
>=20
>> =C2=A0 I made a standalone tool like you suggested which prints out the =
size
>> of
>> each doc in the index, none of the docs are more than 1MB !!! The querie=
s
>> are the same. They repeat throughout the test. We give about 6GB of heap
>> to
>> the application and yes we are on 64 bit JVM.
>=20
> OK.
>=20
> Any luck running CheckIndex?  Can you run w/ verbose GC, to see if GC
> is running...?
>=20
>> I hit upon another such issue here
>> http://www.nabble.com/Lucene-2.2.0-in-64-bit-JVM:-IndexReader-is-hung-td=
22667471.html
>> http://www.nabble.com/Lucene-2.2.0-in-64-bit-JVM:-IndexReader-is-hung-td=
22667471.html
>> Do you think this may be related? There was no resolution on this thread
>> though. We only upgraded lucene version and I am absolutely certain
>> nothing
>> else changed.
>=20
> They could be related.  They sound very similar.
>=20
>> One more thing, we tried to reproduce the customer environment here
>> exactly
>> like they have it there. The only difference is, the index on the
>> customer's
>> end resides in a SAN.
>=20
> Are you not able to repro the issue locally?  So the SAN is the only
> known difference?
>=20
> Mike
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/readModifiedUTF8String-=
stuck-tp23089805p23166111.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39875-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 22:41:27 2009
Return-Path: <java-user-return-39875-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85307 invoked from network); 21 Apr 2009 22:41:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 22:41:27 -0000
Received: (qmail 50629 invoked by uid 500); 21 Apr 2009 22:41:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50595 invoked by uid 500); 21 Apr 2009 22:41:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50585 invoked by uid 99); 21 Apr 2009 22:41:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 22:41:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [87.233.177.133] (HELO core.aduna-software.com) (87.233.177.133)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 22:41:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by core.aduna-software.com (Postfix) with ESMTP id 0BB73AA037B
	for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 00:40:56 +0200 (CEST)
X-Virus-Scanned: amavisd-new at 
X-Spam-Score: -2.501
X-Spam-Level: 
Received: from core.aduna-software.com ([127.0.0.1])
	by localhost (core.aduna-software.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id JFZy7gyEJTYs for <java-user@lucene.apache.org>;
	Wed, 22 Apr 2009 00:40:51 +0200 (CEST)
Received: from [192.168.1.101] (53578B7E.cable.casema.nl [83.87.139.126])
	by core.aduna-software.com (Postfix) with ESMTP id 69B1EAA037A
	for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 00:40:51 +0200 (CEST)
Message-ID: <49EE4B71.8030105@aduna-software.com>
Date: Wed, 22 Apr 2009 00:40:49 +0200
From: Christiaan Fluit <christiaan.fluit@aduna-software.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: semi-infinite loop during merging
References: <49E4573E.7070208@aduna-software.com>	 <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>	 <49E6FD9F.5080104@aduna-software.com> <9ac0c6aa0904160510l6cf559c6yfc6b0c1deadbf1de@mail.gmail.com> <49EE41F9.3030007@aduna-software.com>
In-Reply-To: <49EE41F9.3030007@aduna-software.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Flag: NO
X-Old-Spam-Status: No, score=-2.501 tagged_above=-10 required=4 tests=[AWL=-0.002,
	BAYES_00=-2.599, RDNS_DYNAMIC=0.1]

Christiaan Fluit wrote:
> It seems that it gets up to the point to commit, but the "IW: 
> commitMerge done" message is never reached.
> 
> Furthermore, no exceptions are printed to the output, so 
> handleMergeException does not seem to have been invoked.
> 
> Should I add more debug statements elsewhere?

I may be on to something already.

I just looked at the commitMerge code and was surprised to see that the 
commitMerge message that is almost at the beginning wasn't printed. Then 
I saw the "if (hitOOM) return false;" part that takes place before that. 
I think that this can only mean that an OOME was encountered at some 
point in time.

Now, the fact is that in my indexing code I do a catch(Throwable) in 
several places. I do this particularly because JET handles OOMEs in a 
very, very nasty way. Often you will just get an error dialog and then 
it quits the entire application. Therefore, my client code catches, logs 
and swallows the OOME before the JET runtime can intercept it. 
*Usually*, the application can then recover gracefully and continue 
processing the rest of the information.

Catching a OOME that results from the operation of a text extraction 
library is one thing (and a fact of life really), but perhaps there are 
also OOME's that occur during Lucene processing.

I remember seeing those in the past with the original Java code, when 
very large Strings were being tokenized and I got an OOME with a deep 
Lucene stacktrace. I copied one such stacktrace that I have saved at the 
end of this mail.

I see some caught and swallowed OOME's in my log file but unfortunately 
they are without a stacktrace - probably again a JET issue. I can run 
the normal Java build though to see if such OOMEs occur on this dataset.

Now, I wonder:

- when the IW is in auto-commit mode, can the failed processing of a 
Document due to an OOME have an impact on the processing of subsequent 
Documents or the merge/optimize operations? Can the index(writer) become 
corrupt and result in problems such as these?

- even though the commitMerge returns false, it should probably not get 
into an infinite loop. Is this an internal Lucene problem or is there 
something I can/should do about it myself?

- more generally, what is the recommended behavior when I get an OOME 
during Lucene processing, particularly IW.addDocument? Should the IW be 
able to recover by itself or is there some sort of rollback I need to 
perform? Again, note that my index is in auto-commit mode (though I had 
hoped to let go of that too, it's only for historic reasons).


Regards,

Chris
--

java.lang.OutOfMemoryError: Java heap space
	at 
org.apache.lucene.index.DocumentsWriter.getPostings(DocumentsWriter.java:3069)
	at 
org.apache.lucene.index.DocumentsWriter$ThreadState$FieldData.addPosition(DocumentsWriter.java:1696)
	at 
org.apache.lucene.index.DocumentsWriter$ThreadState$FieldData.invertField(DocumentsWriter.java:1525)
	at 
org.apache.lucene.index.DocumentsWriter$ThreadState$FieldData.processField(DocumentsWriter.java:1412)
	at 
org.apache.lucene.index.DocumentsWriter$ThreadState.processDocument(DocumentsWriter.java:1121)
	at 
org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:2442)
	at 
org.apache.lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:2424)
	at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1464)
	at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1442)
	at info.aduna...........

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39876-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 22:48:16 2009
Return-Path: <java-user-return-39876-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87125 invoked from network); 21 Apr 2009 22:48:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 22:48:16 -0000
Received: (qmail 64574 invoked by uid 500); 21 Apr 2009 22:48:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64512 invoked by uid 500); 21 Apr 2009 22:48:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64502 invoked by uid 99); 21 Apr 2009 22:48:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 22:48:14 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 22:48:05 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LwOkg-000111-0L
	for java-user@lucene.apache.org; Tue, 21 Apr 2009 15:47:42 -0700
Message-ID: <23166323.post@talk.nabble.com>
Date: Tue, 21 Apr 2009 15:47:41 -0700 (PDT)
From: AlexElba <ramalex1@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Appropriate analyzer
In-Reply-To: <edd377170904211357g373089e8y9f0788a38b525618@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ramalex1@yahoo.com
References: <edd377170904211357g373089e8y9f0788a38b525618@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org



try to use RegexQuery



Artyom Sokolov wrote:
> 
> Hello.
> 
> Currently I'm trying to find something like an analyzer to solve the
> problem.
> 
> Actually, what I need is next: search on a query string step-by-step,
> trimming last char on each step. Small example:
> 
> In index we've: abc, abcdef, xyz
> When search on abcdefgh the most relevant result should be abcdef, while
> searching on abcde the best one is abc.
> 
> Thanks.
> 
> Sincerely,
> Artyom Sokolov
> 
> 

-- 
View this message in context: http://www.nabble.com/Appropriate-analyzer-tp23164855p23166323.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39877-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 22:53:10 2009
Return-Path: <java-user-return-39877-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88861 invoked from network); 21 Apr 2009 22:53:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 22:53:10 -0000
Received: (qmail 73691 invoked by uid 500); 21 Apr 2009 22:53:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73610 invoked by uid 500); 21 Apr 2009 22:53:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73600 invoked by uid 99); 21 Apr 2009 22:53:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 22:53:07 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of preetham@cisco.com designates 171.71.176.117 as permitted sender)
Received: from [171.71.176.117] (HELO sj-iport-6.cisco.com) (171.71.176.117)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 22:52:57 +0000
X-IronPort-AV: E=Sophos;i="4.40,226,1238976000"; 
   d="scan'208";a="290405374"
Received: from sj-dkim-4.cisco.com ([171.71.179.196])
  by sj-iport-6.cisco.com with ESMTP; 21 Apr 2009 22:52:36 +0000
Received: from sj-core-5.cisco.com (sj-core-5.cisco.com [171.71.177.238])
	by sj-dkim-4.cisco.com (8.12.11/8.12.11) with ESMTP id n3LMqaNZ017614
	for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 15:52:36 -0700
Received: from xbh-sjc-221.amer.cisco.com (xbh-sjc-221.cisco.com [128.107.191.63])
	by sj-core-5.cisco.com (8.13.8/8.13.8) with ESMTP id n3LMqaoi022343
	for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 22:52:36 GMT
Received: from xfe-sjc-212.amer.cisco.com ([171.70.151.187]) by xbh-sjc-221.amer.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 21 Apr 2009 15:52:36 -0700
Received: from [171.69.42.163] ([171.69.42.163]) by xfe-sjc-212.amer.cisco.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 21 Apr 2009 15:52:36 -0700
Message-ID: <49EE4E33.30901@cisco.com>
Date: Tue, 21 Apr 2009 15:52:35 -0700
From: Preetham Kajekar <preetham@cisco.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Getting Top n term for a given field for a given time period
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 21 Apr 2009 22:52:36.0385 (UTC) FILETIME=[DD52D110:01C9C2D3]
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; l=379; t=1240354356; x=1241218356;
	c=relaxed/simple; s=sjdkim4002;
	h=Content-Type:From:Subject:Content-Transfer-Encoding:MIME-Version;
	d=cisco.com; i=preetham@cisco.com;
	z=From:=20Preetham=20Kajekar=20<preetham@cisco.com>
	|Subject:=20Getting=20Top=20n=20term=20for=20a=20given=20fi
	eld=20for=20a=20given=20time=20period
	|Sender:=20;
	bh=4JYVCxsqGMEdnHh0yFwllkrHjh/pKjkQPNBMOLmmQTQ=;
	b=OkFjfevtWPVRnUsKcNTl4SNjkhmWBhNisFsCWG0bxYc7u+ecljlxgywNPr
	cHMVeebTbiOmN5tUezR7n7TJN5n7N2mLzWn7tqTDPvWMGXsXzjejjq5P40ff
	6/gf9asbpM;
Authentication-Results: sj-dkim-4; header.From=preetham@cisco.com; dkim=pass (
	sig from cisco.com/sjdkim4002 verified; ); 
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,
I have a lucene index which has 20 mil documents. Each document has a 
timestamp field and a source field. I am interested in finding the top n 
sources for a given hour (based on the timestamp). I know we can get the 
top n sources fields easily using the IndexReader API, but was wondering 
if I can get that top n for a certain period of time ?

Thx,
~preetham



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39878-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 21 23:07:57 2009
Return-Path: <java-user-return-39878-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95358 invoked from network); 21 Apr 2009 23:07:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Apr 2009 23:07:57 -0000
Received: (qmail 92794 invoked by uid 500); 21 Apr 2009 23:07:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92705 invoked by uid 500); 21 Apr 2009 23:07:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92695 invoked by uid 99); 21 Apr 2009 23:07:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 21 Apr 2009 23:07:55 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [72.255.0.201] (HELO s-utl01-dcpop.stsn.net) (72.255.0.201)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 21 Apr 2009 23:07:47 +0000
Received: from s-utl01-dcpop.stsn.net ([127.0.0.1])
 by s-utl01-dcpop.stsn.net (SMSSMTP 4.1.2.20) with SMTP id M2009042119072425524
 for <java-user@lucene.apache.org>; Tue, 21 Apr 2009 19:07:24 -0400
X-Spam-Level: 
Received: from [127.0.0.1] ([10.77.75.155])
	by s-utl01-dcpop.stsn.net
	for java-user@lucene.apache.org;
	Tue, 21 Apr 2009 19:07:23 -0400
Message-ID: <49EE519C.70402@stanford.edu>
Date: Tue, 21 Apr 2009 16:07:08 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Why is CustomScoreQuery limited to ValueSourceQuery type?
References: <49E91253.4030506@stanford.edu>	 <e05f0fd10904210047m218a0628wf57070729841e2a9@mail.gmail.com>	 <49EDFB49.60908@stanford.edu> <e05f0fd10904211009u4996bccer52b4f7fd9ef7dceb@mail.gmail.com>
In-Reply-To: <e05f0fd10904211009u4996bccer52b4f7fd9ef7dceb@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Antivirus: avast! (VPS 090421-0, 04/21/2009), Outbound message
X-Antivirus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=0.0 required=9.9
	tests=ALL_TRUSTED: -2.867,BAYES_00: -1.665,SARE_TOCC_USER: 0.011

On 4/21/2009 10:09 AM, Doron Cohen wrote:
> It could, but (historically and) currently it doesn't... :)
> I actually have code for this.
> Would you like open a JIRA issue for this - I'll attach my wrapper there?

Done.

https://issues.apache.org/jira/browse/LUCENE-1608

Steve

> On Tue, Apr 21, 2009 at 7:58 PM, Steven Bethard <bethard@stanford.edu>wrote:
> 
>> On 4/21/2009 12:47 AM, Doron Cohen wrote:
>>> CustomScoreQuery expects the VSQs to have a score for document matching
>> the
>>> (main) subQuery - this does not hold for arbitrary queries.
>> Sure, but it could easily assign 0.0 scores for sub-queries that didn't
>> match, no?
>>
>> Steve
>>
>>> On Sat, Apr 18, 2009 at 2:35 AM, Steven Bethard <bethard@stanford.edu
>>> wrote:
>>>
>>>> CustomScoreQuery only allows the secondary queries to be of type
>>>> ValueSourceQuery instead of allowing them to be any type of Query. Why
>>>> is that? Is there something that makes it hard to implement for
>>>> arbitrary queries?
>>>>
>>>> Steve
>>>>
>>>> P.S. I played around with this briefly, and simply replacing all
>>>> ValueSourceQuery references with Query references yields only one simple
>>>> compile error, where ValueSourceQuery.createWeight() is being used
>>>> instead of Query.weight() for some reason.
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39879-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 06:58:23 2009
Return-Path: <java-user-return-39879-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23544 invoked from network); 22 Apr 2009 06:58:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 06:58:19 -0000
Received: (qmail 34654 invoked by uid 500); 22 Apr 2009 06:58:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34582 invoked by uid 500); 22 Apr 2009 06:58:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34572 invoked by uid 99); 22 Apr 2009 06:58:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 06:58:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 06:58:08 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LwWOx-0001Z8-Cf
	for java-user@lucene.apache.org; Tue, 21 Apr 2009 23:57:47 -0700
Message-ID: <23170710.post@talk.nabble.com>
Date: Tue, 21 Apr 2009 23:57:47 -0700 (PDT)
From: uday kumar maddigatla <ukma@mach.com>
To: java-user@lucene.apache.org
Subject: Re: How to search special characters in LUcene
In-Reply-To: <359a92830904210735g24df775cx4bfa11774ac6161c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: ukma@mach.com
References: <D262A1FB331DC344AA0B896F390D5569016E3E8C@exchhyd.machcorp.lan> <359a92830904210735g24df775cx4bfa11774ac6161c@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi=20

Thanks for your reply.

I'm able to see the DutchAnalyzer.

When i'm indexing my documents i given instace of DutchAnalyzer as an
argument to IndexWriter Class.

After this when i search for the=20
http://www.nabble.com/file/p23170710/IndexFiles.java IndexFiles.java
contains the danish elements .. Still it is not able to identify.

Please tell me how to use DutchAnalzer in my application. Sample example or
series of steps helps me.

I also attached my index file(.java file).

Please help me in this. please..

Erick Erickson wrote:
>=20
> Take a look at DutchAnalyzer. The problem you'll have is if you're
> indexing
> this document along with a bunch of documents from other languages.
> You could search the mail archive for extensive discussions of  indexing/
> searching documents from several languages.
>=20
> Best
> Erick
>=20
> On Tue, Apr 21, 2009 at 2:40 AM, Uday Kumar Maddigatla
> <ukma@mach.com>wrote:
>=20
>> HI,
>>
>>
>>
>> I'm new to the lucene. I downloaded lucene 2.4.1.
>>
>>
>>
>> I have one xml file which contains few special characters like '=C3=A5',=
 '=C3=B8,'
>> =C2=B0'
>> etc.(these are Danish language elements).
>>
>>
>>
>> How can I search these things.
>>
>>
>>
>>
>>
>> Uday Kumar  Reddy Maddigatla
>>
>> Software Engineer(Progrator|gatetrade)
>>
>> MACH India(Operations)
>>
>> Mobile: + 91-9963000377
>>
>> Uday.Maddigatla@ness.com <mailto:Uday.Maddigatla@ness.com>
>>
>> ukma@mach.com <mailto:ukma@mach.com>
>>
>> www.ness.com
>>
>>
>>
>>
>>
>>
>=20
>=20

--=20
View this message in context: http://www.nabble.com/How-to-search-special-c=
haracters-in-LUcene-tp23150039p23170710.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39880-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 08:28:12 2009
Return-Path: <java-user-return-39880-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53868 invoked from network); 22 Apr 2009 08:28:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 08:28:12 -0000
Received: (qmail 50333 invoked by uid 500); 22 Apr 2009 08:28:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50280 invoked by uid 500); 22 Apr 2009 08:28:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50270 invoked by uid 99); 22 Apr 2009 08:28:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 08:28:09 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [83.171.202.81] (HELO outmail01.vivodinet.gr) (83.171.202.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 08:28:00 +0000
Received: from [192.168.0.71] (dsl-83-171-245-188.customers.vivodi.gr [83.171.245.188])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by outmail01.vivodinet.gr (Postfix) with ESMTP id 50D7A257AE4
	for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 11:27:36 +0300 (EEST)
Message-ID: <49EED4F8.4060007@eworx.gr>
Date: Wed, 22 Apr 2009 11:27:36 +0300
From: John Cherouvim <jc@eworx.gr>
User-Agent: Thunderbird 1.5.0.14 (Windows/20071210)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: SpellChecker locks folder
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: clamav-milter 0.95 at multi-med
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

Hello

After I call the SpellChecker.indexDictionary method the directory which 
contained the lucene index is locked. I cannot rename of delete the 
folder (windows).

In the source of SpellChecker lines 352-353 I see that after the 
indexing is done the index is reopened:
searcher.close();
searcher = new IndexSearcher(this.spellIndex);

Why does that second line exist at all?

thanks
Ioannis


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39881-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 10:06:41 2009
Return-Path: <java-user-return-39881-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95665 invoked from network); 22 Apr 2009 10:06:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 10:06:40 -0000
Received: (qmail 75375 invoked by uid 500); 22 Apr 2009 10:06:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75279 invoked by uid 500); 22 Apr 2009 10:06:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75269 invoked by uid 99); 22 Apr 2009 10:06:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 10:06:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 10:06:30 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LwZLF-0000rG-AH
	for java-user@lucene.apache.org; Wed, 22 Apr 2009 03:06:09 -0700
Message-ID: <23173324.post@talk.nabble.com>
Date: Wed, 22 Apr 2009 03:06:09 -0700 (PDT)
From: "Karsten F." <karsten-lucene@fiz-technik.de>
To: java-user@lucene.apache.org
Subject: RE: Faceting, Sort and DocIDSet
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2896@mail02.tveyes.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: karsten-lucene@fiz-technik.de
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC266E@mail02.tveyes.com> <23113784.post@talk.nabble.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2743@mail02.tveyes.com> <8f0ad1f30904200726n18b00ae7rcd52f629491a8e62@mail.gmail.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2762@mail02.tveyes.com> <23143797.post@talk.nabble.com> <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2896@mail02.tveyes.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Dave,

facets: 
in you case a solution with one
int[IndexReader.maxDoc()]
fits. For each document number you can store an integer which represents the
facet value.
This is what org.apache.solr.request.UnInvertedField will store in your
case.
(*John* : is there something similar in com.browseengine ? )

But UnInvertedField is designed for fields with more then one value per doc.
Possible to implement directly the solution with int[IndexReader.maxDoc()]
is more easy.
The implementation with int[IndexReader.maxDoc()] should be 150 times faster
then your current solution (and use only 16:300 of your main memory).
But I still wonder that your solution is slow, did you ever use a profiler? 
Enough Xmx? Swapping? Possible your implementation of htFacetResults.get is
slow? Possible same waiting because of synchronized code?
But btw.: Your implementation is not thread save: Think about two
htFacetResults.get before one htFacetResults.put

INDEXORDER:
For INDEXORDER the MultiSearcher and ParallelMultiSearcher use the docNumber
for each index as score.
So the result is 
1. Doc with docNum 1 from first Index
2. Doc with docNum 1 from second Index
..
n. Doc with docNum m from first Index
n+1. Doc with docNum m from second Index
..

I did not know this before. And I was surprised, because the docNum use the
"starts"-Array but the score does not.
So you can use a BitSet to collect the hits. The bits itself are in correct
order.
(and you could index and search without frequencies).

Best regrads
  Karsten


David Seltzer wrote:
> 
> Karsten,
> 
> You're right, 300 facets would be a lot. Hehe. I have one facet with
> about three hundred potential values. What I've done is create an
> FacetManager who, in another thread, sets up an map of ~300 OpenBitSets.
> One bitset for each possible value of the facet.
> 
> Then, rather than using an iterative cardinality comparison, I use a
> HitCollector to create an set of counters. 
> 
> public void collect(int doc, float score) {
>    //we don't care about score, all we care about is docID;
>    //we need to find out if this document is in any of our facets... if
> it is, increment a counter
>    for(SearchFacet sfTemp : arrayOfSearchFacetsValues) {
>       if(sfTemp.getBitSet().fastGet(doc)) {
>          //this is a hit!
>          long lCount = htFacetResults.get(sfTemp.getTerm().text());
>          htFacetResults.put(sfTemp.getTerm().text(), lCount+1);
> 				
>          //this code is designed for mutually exclusive 
>          //facet values... in that scenario, a hit here means
>          //that we can't have a hit anywhere else, so we should
>          //break.
>          break;
>       }
>    }
> }
> 
> Here I seem to be running into a performance issue. It seems that when a
> resultset is small (~10,000) this method greatly outperforms the
> iterating cardinality check. However, when the resultset is large
> (300,000) the HitCollector takes twice as long to process the resultset
> as the other solution.
> 
> Our total index typically contains about 100M documents. This is broken
> up into four monthly indexes each containing 250K documents. And a
> typical search returns < 120,000 results. Lousy searches return more
> results (IE "obama" returns nearly 800,000 documents).
> 
> At the moment we're using ParalellMultiSearcher. When I do a search,
> across four montly indexes, ordered by INDEXORDER what I get is all of
> the hits that happened on the first of any month, then all the hits that
> happened on the second of any month. Does 'starts' behave the same way
> in ParallelMultiSearcher?
> 
> Thanks for all your input!
> 
> -Dave
> 
> 

-- 
View this message in context: http://www.nabble.com/Faceting%2C-Sort-and-DocIDSet-tp23099854p23173324.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39882-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 10:52:55 2009
Return-Path: <java-user-return-39882-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15707 invoked from network); 22 Apr 2009 10:52:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 10:52:55 -0000
Received: (qmail 44025 invoked by uid 500); 22 Apr 2009 10:52:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43979 invoked by uid 500); 22 Apr 2009 10:52:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43969 invoked by uid 99); 22 Apr 2009 10:52:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 10:52:53 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 10:52:44 +0000
Received: by ewy27 with SMTP id 27so2966651ewy.5
        for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 03:52:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Hq/bSeS/lW6b658VDboVfcciuIA6L726Nedu/0aeLwY=;
        b=CsoumxQZZx6iaKyli03oUnFXNn/Ta0A20X6+CqLT+SzG0SZ3pS8yJ64hoUQQu93zrR
         WWrGjoG3gcm0PCc4NTPagUZSzXm58FkQU2EMaSF90dSg/QRC/rOhZTAVptsCDwKPFIF9
         oaZySh21WizDn9yafiUyn8gXTkQm2AR8e88XM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=XpR9hbVMQGFul6VRs106elXo9bvNFtbi65X+1CGLlupyETVGEMk0PeYkk7fbxaAzNl
         tpf906cJlm4gNsvKM30zQZXvrh7+/s9td/95IQaRhgTjo6fiZMq1fl63/WuTIHLYdKis
         iSetDQxpP1JpCQinoVmJ5xPJkrkNxsdcRHK4o=
MIME-Version: 1.0
Received: by 10.210.120.17 with SMTP id s17mr8175000ebc.99.1240397544221; Wed, 
	22 Apr 2009 03:52:24 -0700 (PDT)
In-Reply-To: <74f928500904210740s76e3d63evf6b1629e979858e1@mail.gmail.com>
References: <d36c28c30904190439g477f57e9s52c48ecffca5881e@mail.gmail.com>
	 <e05f0fd10904210216q3c0ed85egb097dde96a0e5ab3@mail.gmail.com>
	 <d36c28c30904210240p1271d5aahf39081570c4f7376@mail.gmail.com>
	 <e05f0fd10904210508q59bd86b1j479aac3b1be41f43@mail.gmail.com>
	 <d36c28c30904210644x2ba3c6f6mbd5c306def48078b@mail.gmail.com>
	 <74f928500904210740s76e3d63evf6b1629e979858e1@mail.gmail.com>
Date: Wed, 22 Apr 2009 13:52:24 +0300
Message-ID: <d36c28c30904220352o57066e8egd3928a2390905f90@mail.gmail.com>
Subject: Re: changing term freq in indexing time
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c368e00f4580468228f20
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c368e00f4580468228f20
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks Eran, I tried it, adding the classes I copied below and tried to run
the following
code:

[Also I have below a question about the usage of synonyms and BooleanQuery.]

  DoubleMap wordMap = new DoubleMap();
  wordMap.insert("1", 1, 5); // for word "1" we have the world 1, 5 times
  wordMap.insert("1", 2, 2);// for word "1" we have the world 2, 2 times
  wordMap.insert("1", 3, 7);
  wordMap.insert("1", 4, 1);
  wordMap.insert("2", 3, 1); // for word "2" we have the world 3, 1 time
  wordMap.insert("2", 5, 1);
  wordMap.insert("2", 6, 1);
  wordMap.insert("3", 3, 1);
  wordMap.insert("3", 4, 1);
  wordMap.insert("3", 8, 1);
  ioManager io = new ioManager();
  io.index(wordMap, "TestSearchIndex", "", "1");

  IndexSearcher searcher = new IndexSearcher("TestSearchIndex");
  searcher.setSimilarity(new WordsSimilarity()); // WordsSimilarity is
written below
  Query btq = new BoostingTermQuery(new Term(WordIndex.FIELD_WORLDS, "3 3 2
1"));
  Hits wordsHits = searcher.search(btq);

>From some reason the hits size is 0 and none of the methods overriden in
WordsSimilarity is called (I put a breakpoint and it didn;t get there during
search time)

public class *WordsAnalyzer* extends Analyzer
{
 public Map<String, Map<String, Integer>> wordsWorldsFreq = new
HashMap<String, Map<String, Integer>>();
 public Map<String, Integer> worldsFreq = new HashMap<String, Integer>();
 public WordsAnalyzer()
 {
 }
 public WordsAnalyzer(Map<String, Integer> worldsFreq) throws IOException
 {
  this.worldsFreq = worldsFreq;
 }
 public TokenStream tokenStream(String fieldName, Reader reader)
 {
  return new WordsFilter(new StandardTokenizer(reader), worldsFreq);
 }
}

public class *WordsFilter* extends TokenFilter
{
 public Map<String, Integer> worldsFreq;
 public WordsFilter(TokenStream in, Map<String, Integer> worldsFreq)
 {
  super(in);
  this.worldsFreq = worldsFreq;
 }
 public final Token next(Token result) throws IOException
 {
  byte payLoad = 1;
  try
  {
   result = input.next(result);
   if(result != null)
   {
    String word = String.copyValueOf(result.termBuffer(), 0,
result.termLength());
    payLoad = Byte.parseByte(worldsFreq.get(word).toString());
    result.setPayload(new Payload(new byte[] { Byte.valueOf(payLoad) }));
    return result;
   }
   else
   {
    return null;
   }
  }
  catch(Exception e)
  {
   e.printStackTrace();
   System.out.println(result.termBuffer() + " " + payLoad);
   FileUtil.writeToFile("IndexProblems.txt", "WordsFilter problem for " +
result.termBuffer() + " " + payLoad + " : " + e.getStackTrace());
   return null;
  }
 }
}
*****
public class *WordsSimilarity* extends DefaultSimilarity
{
 public WordsSimilarity()
 {
 }
 public float tf(float freq)
 {
  return super.tf(freq); // just wanted to check whether it is called
 }
 public float scorePayload(byte[] payload, int offset, int length)
 {
  //  if(length == 1)
  //  {
  return payload[offset];
  //  }
 }
}

**
*******
************
For the synonyms with the weights, I tried the following code:
   BooleanQuery bq = new BooleanQuery();
   TermQuery tq = new TermQuery(new Term(WordIndex.FIELD_WORLDS, "3"));
   tq.setBoost((float) 1.0);
   bq.add(bq, BooleanClause.Occur.MUST);
   tq = new TermQuery(new Term(WordIndex.FIELD_WORLDS, "2"));
   tq.setBoost((float) 0.5);
   bq.add(bq, BooleanClause.Occur.SHOULD);
   IndexSearcher searcher1 = new IndexSearcher("TestSearchIndex");
   Hits hits1 = searcher1.search(bq);

And got the error: any idea what is the problem?

at org.apache.lucene.search.BooleanQuery.rewrite(BooleanQuery.java:385)
 at org.apache.lucene.search.BooleanQuery.rewrite(BooleanQuery.java:385)
Process exited.

Thanks,
Liat


2009/4/21 Eran Sevi <eransevi@gmail.com>

> Hi,
>
> You might want to take a look at Payloads. If you know the frequency of the
> words in each world in advance than during tokenization for each world you
> could save the frequency as the payload.
>
> During searches you could use BoostingTermQuery to take the frequency into
> account.
>
> Eran.
>  On Tue, Apr 21, 2009 at 4:44 PM, liat oren <oren.liat@gmail.com> wrote:
>
> > Hi Doron,
> >
> > Thank you very much for the elaborated answer!
> >
> > About the Synonyms, I can't use Wordnet as I have my own list of
> synonyms.
> > I
> > will look at contrib/memory and see what it does.
> >
> > You understood correctly the process of using the inverse doc. About the
> > two
> > problems you mentioned: scalability and ignoring the vicinity of words -
> > scalability - this is the reason I wanted to set the frequencies of the
> > terms. The use of the frequencies will be used at this stage, not at the
> > stage of using the synonyms. When I use the sysnonyms, I want to use the
> > score as you suggested below.
> > Here, I have for every word, in which worlds they appear. Currently every
> > world appears once in a word. However, I would like it to appear the
> number
> > if times as the frequency of the word in the world. In order to avoid
> > writing the world several times in the world field, I would like to be
> able
> > to set the freq of the specific world accordng to the freq of the word at
> > this world without actually writing it x times (for scalability and index
> > size and performance issues)
> > So if dog appears 10 times in world 1 and 5 times in world 2, and cat
> > appears 5 times in world 1, then I want these frequencies to be taken
> into
> > account when computing how the word dog and cat are close. BUT I don't
> want
> > to write world 1 10 times in word dog and 5 times in word cat, but only
> > once
> > and to update the termVector so that the frequency will get 10 and 5
> > respectively.
> > So the *generation* of the synonyms will take into account the
> frequencies
> >
> > The vicinity of words - is there any better way to take it in account?
> >
> > About the suggestion of using term boosting that will use the score of
> the
> > synonyms - if I want to query "big white dogs" and I have the following
> > synonyms:
> > big - big (1.0), large (0.9), huge (0.6)
> > white - white (1.0), color (0.5) offwhite (0.8)
> > dog - dog (1.0)
> > So this is the way to do it? :
> >
> >   BooleanQuery bq = new  BooleanQuery();
> >          TermQuery tq = new TermQuery(new Term("text", "big"));
> >          tq.setBoost((float)1.0);
> >                   bq.add(bq, false, false);
> >   tq = new TermQuery(new Term(("text", "large"));
> >             tq.setBoost((float)0.9);
> >                             bq.add(bq, false);
> >  tq = new TermQuery(new Term(("text", "huge"));
> >             tq.setBoost((float)0.6);
> >                             bq.add(bq, false);
> >
> >  tq = new TermQuery(new Term(("text", "white"));
> >             tq.setBoost((float)1.0);
> >                             bq.add(bq, false);
> >  tq = new TermQuery(new Term(("text", "color"));
> >             tq.setBoost((float)0.5);
> >                             bq.add(bq, false);
> > // etc
> >   IndexSearcher searcher = new IndexSearcher("TestSearchIndex");
> >                   Hits hits = searcher.search(bq);
> >
> >
> > how the use of booleanQuery will also look at the position of the words?
> I
> > remember I read about the score that takes into account also  the
> position
> > of the term, but I didn't see this factor in the score formula
> > Thanks again, it is very helpful,
> >  Liat
> > 2009/4/21 Doron Cohen <cdoronc@gmail.com>
> >
> > > Hi Liat, there are two packages under Lucene's contrib that deals with
> > > Synonyms - that is contrib/memory and contrib/wordnet - which you
> > > may find useful. I never used these two but they seem relevant to what
> > > you are trying to achieve.
> > >
> > > Anyhow, it seems you compute the synonyms for word w are those
> > > that appear in the same set of documents ('worlds') as w, and you find
> > > this set by (a) indexing an inverse of the collection (docs become
> words
> > > and words become docs) and (b) using docs(w) as query do find syns(w).
> > >
> > > I assume that your 'worlds' are small, each containing only a small
> > > set of a few related words, otherwise I would have two
> > > concerns with this approach: (a) scalability (b) in a large doc (world)
> > > this
> > > approach ignores the vicinity of words which seems to me important
> > > to their likelihood as synonyms
> > >
> > > Assuming you are okay here, and going back to original question of
> > > altering the term frequency, perhaps taking the (search) scores of the
> > > returned synonyms (which you find by search) is better than just
> > > using their frequency? If you find this approach valid, then at least
> for
> > > some queries you should be able to use queries boosts. For example
> > > create a BooleanQuery, add to it a TermQuery for each synonym,
> > > but set the boost of the TermQuery according to the synonnym score.
> > > This is also where you could "punish" synnonyms comparing to the
> > > original word. This will only help with queries with contruction API
> > > that takes (sub) queries as input (so it will not help with a
> > PhraseQuery).
> > >
> > > - Doron
> > >
> > > On Tue, Apr 21, 2009 at 12:40 PM, liat oren <oren.liat@gmail.com>
> wrote:
> > >
> > > > Ok, I will explain the full 'problem' and then explain how I approach
> > it:
> > > >
> > > > Lets divide it into three steps:
> > > >
> > > > 1. I have a 'dictionary' of words - for every word, I have a list of
> > > > worlds,
> > > > which are ids of text documents that the word appears in.
> > > > So, for example, for the word 'dog', I have '1 1600 36000' in the
> > > "worlds"
> > > > field (which are tokenized whin indexed) - which means that the word
> > dog
> > > > appears in worlds 1, 1600 and 36000.
> > > >
> > > > 2. This index is used to choose synonyms for the word dog - using the
> > > > "worlds" field - I do a search on this index, giving the query "'1
> 1600
> > > > 36000" as in input and thus get the words that are close to the word
> > > "dog".
> > > > I take the 10 closest words.
> > > >
> > > > 3. These 10 synonyms are then used to expand the query.
> > > >
> > > > Basically, I have 2 problems in this process:
> > > >
> > > > a. In the process of finding the synonyms, I would like that the
> > > frequency
> > > > of the word in each of the worlds will be taken into account. so that
> > if
> > > > 'dog' appeared 3 times in world 1, 10 times in world 1600 and 4 times
> > in
> > > > world 36000, then it will be taken into account.
> > > > I wanted to avoid "expanding" the field to be "1 1 1 1600 1600 1600
> > 1600
> > > > 1600 1600 1600 1600 1600 1600 36000 36000 36000 36000". Accordingly I
> > > > wanted
> > > > to be able to set the freq by myself.
> > > >
> > > > b. In the process of using the synonyms, I wanted to be able to set a
> > > > 'penalty' factor to the synonyms, together with giving differnt
> weight
> > to
> > > > differnt synonyms, according to theur score. I looked at an old
> thread
> > -
> > > > Search for synonyms - implemenetation for review :
> > > > .
> > > >
> > > >
> > >
> >
> http://mail-archives.apache.org/mod_mbox/lucene-java-user/200603.mbox/%3c39B0FB508E5D7540ACA5AD57225E150D39203D@xmail.me.corp.entopia.com%3e
> > > >
> > > > I don;t know if its part of lucene now. I didn't quite understand how
> > to
> > > > use
> > > > it.
> > > > Is there a better way to approach it?
> > > >
> > > > I hope I explained it well.
> > > > Thanks,
> > > > Liat
> > > >
> > > >
> > > >
> > > > 2009/4/21 Doron Cohen <cdoronc@gmail.com>
> > > >
> > > > > Depending on the problem you are trying to solve there may be other
> > > > > solutions to it, not requiring setting wrong (?) values for term
> > > > > frequencies.
> > > > > If you can explain what you are trying to solve, people on the list
> > may
> > > > > be able to suggest such alternatives.
> > > > > - Doron
> > > > >
> > > > > On Sun, Apr 19, 2009 at 2:39 PM, liat oren <oren.liat@gmail.com>
> > > wrote:
> > > > >
> > > > > > Hi,
> > > > > >
> > > > > > I would like to be able to set the term freq to differnt values
> at
> > > > index
> > > > > > time, or at search time.
> > > > > >
> > > > > > So if a document has the following text: 1 2, the freq of 1 will
> > get
> > > > 100
> > > > > > and
> > > > > > the freq of 2 will get 200. I want to avoid expanding it by
> writing
> > 1
> > > > 100
> > > > > > times.
> > > > > >
> > > > > > I looked at Similarity class and wanted to override it, but the
> tf
> > > > > function
> > > > > > gets only freq, so I don't know for which term this freq relates
> > to,
> > > > thus
> > > > > I
> > > > > > can't change the value.
> > > > > >
> > > > > > Thanks,
> > > > > > Liat
> > > > > >
> > > > >
> > > >
> > >
> >
>

--0015174c368e00f4580468228f20--

From java-user-return-39883-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 12:45:01 2009
Return-Path: <java-user-return-39883-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58295 invoked from network); 22 Apr 2009 12:45:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 12:45:00 -0000
Received: (qmail 97026 invoked by uid 500); 22 Apr 2009 12:44:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96962 invoked by uid 500); 22 Apr 2009 12:44:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96952 invoked by uid 99); 22 Apr 2009 12:44:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 12:44:58 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.221.136 as permitted sender)
Received: from [209.85.221.136] (HELO mail-qy0-f136.google.com) (209.85.221.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 12:44:49 +0000
Received: by qyk42 with SMTP id 42so4287159qyk.29
        for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 05:44:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=F5jphWyUhTRydT8gFuE6IdUh8hhYaMTBauPgL018LYA=;
        b=EXWHllEZACCMEwYHTE94mql4q4Gipd9kk2mjaLWOMCEZile9YFxooxSdwHON4Ziaes
         yAug/pCCVlbS8369EENqpjTDOjqO/Gc3sWsxk0VxYpbuTmeTLD+w/zGdrM397a2u8GuO
         wle/XznmXHhQ/yOJarSMT0nKRXNlP5gu6iTKI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=CxU78sD3pr/bfBysiJNruetE4echpJddSEIHP7+eDuS2RkvptYpQyLMy3onljxJ0yt
         KdcQ8PN2ftxA/gxOibb++QGwwaeh05rbcBf38yXSgr1+mbTiE8AKqHGoxqWO87PFc9B7
         zeVZoHvJYTtJPIC5t1bvFu64WttVjng1+1nWc=
MIME-Version: 1.0
Received: by 10.220.45.131 with SMTP id e3mr11034656vcf.89.1240404269008; Wed, 
	22 Apr 2009 05:44:29 -0700 (PDT)
In-Reply-To: <edd377170904211357g373089e8y9f0788a38b525618@mail.gmail.com>
References: <edd377170904211357g373089e8y9f0788a38b525618@mail.gmail.com>
Date: Wed, 22 Apr 2009 08:44:28 -0400
Message-ID: <359a92830904220544o7e5f0c4bv1de9ad799d7ad3bb@mail.gmail.com>
Subject: Re: Appropriate analyzer
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6470526d50a490468241fac
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6470526d50a490468241fac
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

*If* your terms are simple (that is, not wildcarded), you may get
some joy from TermEnum. The idea here would be to find the
longest term *already in your index* that satisfies your need and
use that to form a simple TermQuery....

Essentially using TernEnum.skipTo on successively shorter
strings until it returned true...

Best
Erick

On Tue, Apr 21, 2009 at 4:57 PM, Artyom Sokolov <unnutz@gmail.com> wrote:

> Hello.
>
> Currently I'm trying to find something like an analyzer to solve the
> problem.
>
> Actually, what I need is next: search on a query string step-by-step,
> trimming last char on each step. Small example:
>
> In index we've: abc, abcdef, xyz
> When search on abcdefgh the most relevant result should be abcdef, while
> searching on abcde the best one is abc.
>
> Thanks.
>
> Sincerely,
> Artyom Sokolov
>

--0016e6470526d50a490468241fac--

From java-user-return-39884-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 12:51:45 2009
Return-Path: <java-user-return-39884-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59829 invoked from network); 22 Apr 2009 12:51:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 12:51:45 -0000
Received: (qmail 14120 invoked by uid 500); 22 Apr 2009 12:51:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14065 invoked by uid 500); 22 Apr 2009 12:51:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14055 invoked by uid 99); 22 Apr 2009 12:51:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 12:51:42 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 12:51:33 +0000
Received: by qw-out-2122.google.com with SMTP id 5so1718587qwd.53
        for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 05:51:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=/MBILWRK3z2cH5zT68Yc4vyZQoJXjodcVSbHhiBo8LU=;
        b=M3QvTxRGRHouLr7+cwW+BNiNr+AGfRZrmQ+J+yB4zdzKPWsfksaca5rVo3Si+zj1K2
         K08pp0n7CdBHNhR1ldCR1KaLGdPxgR0xJZS8nPQY7jMdkG3J1bSTBLsWh53VxtWgiEAL
         +pqnJHNt9XCBnUkipNLbHzehIZI5SAoMrrc14=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=HCt5j0N/JW1ZyQI8UFgpperBMyiLT4RW5f5xMUy/5swPvDWz8sQkoyiKmHlIyAaUFi
         0TyUYCq8oCtdEgXrBu7RhNl/eszfodL/5/qCcSLkW0aL6cm7GiIfMFZapxFzvAIA+3bA
         9Ft/kq8I/1yArxV47f1xoTiD3OY7DYD/GG4g8=
MIME-Version: 1.0
Received: by 10.220.90.138 with SMTP id i10mr10817840vcm.72.1240404672496; 
	Wed, 22 Apr 2009 05:51:12 -0700 (PDT)
In-Reply-To: <23170710.post@talk.nabble.com>
References: <D262A1FB331DC344AA0B896F390D5569016E3E8C@exchhyd.machcorp.lan>
	 <359a92830904210735g24df775cx4bfa11774ac6161c@mail.gmail.com>
	 <23170710.post@talk.nabble.com>
Date: Wed, 22 Apr 2009 08:51:12 -0400
Message-ID: <359a92830904220551x23da922ftdbae71d18210538@mail.gmail.com>
Subject: Re: How to search special characters in LUcene
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64611d4e1c4c8046824377d
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64611d4e1c4c8046824377d
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Are you *also* using the DutchAnalyzer for your *query*?

Please show us the index and search code (simplified as much
as possible), then we'll be able to provide better suggestions.

Also, tell us a bit more about your goals here. Is this an
index entirely of Dutch documents? Or is it a mixed-language
index?

Think about getting a copy of Luke and
1> examining your index to see what's *really* there
2> examining the effects of using different parsers on
     your *query*.

Best
Erick

On Wed, Apr 22, 2009 at 2:57 AM, uday kumar maddigatla <ukma@mach.com>wrote=
:

>
> Hi
>
> Thanks for your reply.
>
> I'm able to see the DutchAnalyzer.
>
> When i'm indexing my documents i given instace of DutchAnalyzer as an
> argument to IndexWriter Class.
>
> After this when i search for the
> http://www.nabble.com/file/p23170710/IndexFiles.java IndexFiles.java
> contains the danish elements .. Still it is not able to identify.
>
> Please tell me how to use DutchAnalzer in my application. Sample example =
or
> series of steps helps me.
>
> I also attached my index file(.java file).
>
> Please help me in this. please..
>
> Erick Erickson wrote:
> >
> > Take a look at DutchAnalyzer. The problem you'll have is if you're
> > indexing
> > this document along with a bunch of documents from other languages.
> > You could search the mail archive for extensive discussions of  indexin=
g/
> > searching documents from several languages.
> >
> > Best
> > Erick
> >
> > On Tue, Apr 21, 2009 at 2:40 AM, Uday Kumar Maddigatla
> > <ukma@mach.com>wrote:
> >
> >> HI,
> >>
> >>
> >>
> >> I'm new to the lucene. I downloaded lucene 2.4.1.
> >>
> >>
> >>
> >> I have one xml file which contains few special characters like '=E5', =
'=F8,'
> >> =B0'
> >> etc.(these are Danish language elements).
> >>
> >>
> >>
> >> How can I search these things.
> >>
> >>
> >>
> >>
> >>
> >> Uday Kumar  Reddy Maddigatla
> >>
> >> Software Engineer(Progrator|gatetrade)
> >>
> >> MACH India(Operations)
> >>
> >> Mobile: + 91-9963000377
> >>
> >> Uday.Maddigatla@ness.com <mailto:Uday.Maddigatla@ness.com>
> >>
> >> ukma@mach.com <mailto:ukma@mach.com>
> >>
> >> www.ness.com
> >>
> >>
> >>
> >>
> >>
> >>
> >
> >
>
> --
> View this message in context:
> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp231500=
39p23170710.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64611d4e1c4c8046824377d--

From java-user-return-39885-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 12:53:06 2009
Return-Path: <java-user-return-39885-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60044 invoked from network); 22 Apr 2009 12:53:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 12:53:03 -0000
Received: (qmail 19583 invoked by uid 500); 22 Apr 2009 12:53:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19533 invoked by uid 500); 22 Apr 2009 12:53:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19523 invoked by uid 99); 22 Apr 2009 12:53:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 12:53:00 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of eransevi@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 12:52:52 +0000
Received: by ewy27 with SMTP id 27so3020379ewy.5
        for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 05:52:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=L4sY7ftDPr7fLCrdQHKYBnn0Uqpq11yoNxBXtfWN3Jw=;
        b=OCHMOLrIXSRczYfGFE06bno0Crzl4T2GAthdsIt86K6JPgvLaowcbyL/exBD3N3HSv
         ZnGSY7+4uqx28/In603sTy1YVLPUH1YfgrxuzErhOqQLMUCkmyA5+vqVPGNyXfhXxkKH
         kwV8xQoCchpWg60eJ+yQ1qRVU8YSN9mXwHBTc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=feu3nJQd8meIdf7nFy89DbQe7/m8gEGPUXiJmLN9OBowB9FLA0H0JNNJyNlFRl97hh
         JrApwSFux1jcgEhm1rhT5BXwf86c6lttTSWJaMZqVFieEe38n9hrGwqrBCybTTgazujt
         fQCZ8pAsoc5rUtKCy+KIaTGyd3ukM87VeF7rc=
MIME-Version: 1.0
Received: by 10.210.46.4 with SMTP id t4mr8339195ebt.24.1240404751887; Wed, 22 
	Apr 2009 05:52:31 -0700 (PDT)
In-Reply-To: <d36c28c30904220352o57066e8egd3928a2390905f90@mail.gmail.com>
References: <d36c28c30904190439g477f57e9s52c48ecffca5881e@mail.gmail.com>
	 <e05f0fd10904210216q3c0ed85egb097dde96a0e5ab3@mail.gmail.com>
	 <d36c28c30904210240p1271d5aahf39081570c4f7376@mail.gmail.com>
	 <e05f0fd10904210508q59bd86b1j479aac3b1be41f43@mail.gmail.com>
	 <d36c28c30904210644x2ba3c6f6mbd5c306def48078b@mail.gmail.com>
	 <74f928500904210740s76e3d63evf6b1629e979858e1@mail.gmail.com>
	 <d36c28c30904220352o57066e8egd3928a2390905f90@mail.gmail.com>
Date: Wed, 22 Apr 2009 15:52:31 +0300
Message-ID: <74f928500904220552g5189e12ahe19581fa739447e8@mail.gmail.com>
Subject: Re: changing term freq in indexing time
From: Eran Sevi <eransevi@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c363e9d2e480468243ca9
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c363e9d2e480468243ca9
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,
I'm no expert on the subject but it seems like you're searching for one term
that should be "3 3 2 1" (why do you write "3" two times anyway?).
I think you should try a regulalr boolean query where each sub-query is a
BoostingTermQuery on one term only. These queries should be used with
Occur.MUST if you want the word to be in all these worlds.
Maybe you should search the archives on the proper use of Boosting*Query.
Regarding the synonyms - it looks quite OK to me. Maybe you should try to
use ony Occur.MUST for all TermQuery instances. A simple debugging should
also give you some clue about what is the problem.
Good luck, Eran.

On Wed, Apr 22, 2009 at 1:52 PM, liat oren <oren.liat@gmail.com> wrote:

> Thanks Eran, I tried it, adding the classes I copied below and tried to run
> the following
> code:
>
> [Also I have below a question about the usage of synonyms and
> BooleanQuery.]
>
>  DoubleMap wordMap = new DoubleMap();
>  wordMap.insert("1", 1, 5); // for word "1" we have the world 1, 5 times
>  wordMap.insert("1", 2, 2);// for word "1" we have the world 2, 2 times
>  wordMap.insert("1", 3, 7);
>  wordMap.insert("1", 4, 1);
>  wordMap.insert("2", 3, 1); // for word "2" we have the world 3, 1 time
>  wordMap.insert("2", 5, 1);
>  wordMap.insert("2", 6, 1);
>  wordMap.insert("3", 3, 1);
>  wordMap.insert("3", 4, 1);
>  wordMap.insert("3", 8, 1);
>  ioManager io = new ioManager();
>  io.index(wordMap, "TestSearchIndex", "", "1");
>
>  IndexSearcher searcher = new IndexSearcher("TestSearchIndex");
>  searcher.setSimilarity(new WordsSimilarity()); // WordsSimilarity is
> written below
>  Query btq = new BoostingTermQuery(new Term(WordIndex.FIELD_WORLDS, "3 3 2
> 1"));
>  Hits wordsHits = searcher.search(btq);
>
> From some reason the hits size is 0 and none of the methods overriden in
> WordsSimilarity is called (I put a breakpoint and it didn;t get there
> during
> search time)
>
> public class *WordsAnalyzer* extends Analyzer
> {
>  public Map<String, Map<String, Integer>> wordsWorldsFreq = new
> HashMap<String, Map<String, Integer>>();
>  public Map<String, Integer> worldsFreq = new HashMap<String, Integer>();
>  public WordsAnalyzer()
>  {
>  }
>  public WordsAnalyzer(Map<String, Integer> worldsFreq) throws IOException
>  {
>  this.worldsFreq = worldsFreq;
>  }
>  public TokenStream tokenStream(String fieldName, Reader reader)
>  {
>  return new WordsFilter(new StandardTokenizer(reader), worldsFreq);
>  }
> }
>
> public class *WordsFilter* extends TokenFilter
> {
>  public Map<String, Integer> worldsFreq;
>  public WordsFilter(TokenStream in, Map<String, Integer> worldsFreq)
>  {
>  super(in);
>  this.worldsFreq = worldsFreq;
>  }
>  public final Token next(Token result) throws IOException
>  {
>  byte payLoad = 1;
>  try
>  {
>   result = input.next(result);
>   if(result != null)
>   {
>    String word = String.copyValueOf(result.termBuffer(), 0,
> result.termLength());
>    payLoad = Byte.parseByte(worldsFreq.get(word).toString());
>    result.setPayload(new Payload(new byte[] { Byte.valueOf(payLoad) }));
>    return result;
>   }
>   else
>   {
>    return null;
>   }
>  }
>  catch(Exception e)
>  {
>   e.printStackTrace();
>   System.out.println(result.termBuffer() + " " + payLoad);
>   FileUtil.writeToFile("IndexProblems.txt", "WordsFilter problem for " +
> result.termBuffer() + " " + payLoad + " : " + e.getStackTrace());
>   return null;
>  }
>  }
> }
> *****
> public class *WordsSimilarity* extends DefaultSimilarity
> {
>  public WordsSimilarity()
>  {
>  }
>  public float tf(float freq)
>  {
>  return super.tf(freq); // just wanted to check whether it is called
>  }
>  public float scorePayload(byte[] payload, int offset, int length)
>  {
>  //  if(length == 1)
>  //  {
>  return payload[offset];
>  //  }
>  }
> }
>
> **
> *******
> ************
> For the synonyms with the weights, I tried the following code:
>   BooleanQuery bq = new BooleanQuery();
>   TermQuery tq = new TermQuery(new Term(WordIndex.FIELD_WORLDS, "3"));
>   tq.setBoost((float) 1.0);
>   bq.add(bq, BooleanClause.Occur.MUST);
>   tq = new TermQuery(new Term(WordIndex.FIELD_WORLDS, "2"));
>   tq.setBoost((float) 0.5);
>   bq.add(bq, BooleanClause.Occur.SHOULD);
>   IndexSearcher searcher1 = new IndexSearcher("TestSearchIndex");
>   Hits hits1 = searcher1.search(bq);
>
> And got the error: any idea what is the problem?
>
> at org.apache.lucene.search.BooleanQuery.rewrite(BooleanQuery.java:385)
>  at org.apache.lucene.search.BooleanQuery.rewrite(BooleanQuery.java:385)
> Process exited.
>
> Thanks,
> Liat
>
>
> 2009/4/21 Eran Sevi <eransevi@gmail.com>
>
> > Hi,
> >
> > You might want to take a look at Payloads. If you know the frequency of
> the
> > words in each world in advance than during tokenization for each world
> you
> > could save the frequency as the payload.
> >
> > During searches you could use BoostingTermQuery to take the frequency
> into
> > account.
> >
> > Eran.
> >  On Tue, Apr 21, 2009 at 4:44 PM, liat oren <oren.liat@gmail.com> wrote:
> >
> > > Hi Doron,
> > >
> > > Thank you very much for the elaborated answer!
> > >
> > > About the Synonyms, I can't use Wordnet as I have my own list of
> > synonyms.
> > > I
> > > will look at contrib/memory and see what it does.
> > >
> > > You understood correctly the process of using the inverse doc. About
> the
> > > two
> > > problems you mentioned: scalability and ignoring the vicinity of words
> -
> > > scalability - this is the reason I wanted to set the frequencies of the
> > > terms. The use of the frequencies will be used at this stage, not at
> the
> > > stage of using the synonyms. When I use the sysnonyms, I want to use
> the
> > > score as you suggested below.
> > > Here, I have for every word, in which worlds they appear. Currently
> every
> > > world appears once in a word. However, I would like it to appear the
> > number
> > > if times as the frequency of the word in the world. In order to avoid
> > > writing the world several times in the world field, I would like to be
> > able
> > > to set the freq of the specific world accordng to the freq of the word
> at
> > > this world without actually writing it x times (for scalability and
> index
> > > size and performance issues)
> > > So if dog appears 10 times in world 1 and 5 times in world 2, and cat
> > > appears 5 times in world 1, then I want these frequencies to be taken
> > into
> > > account when computing how the word dog and cat are close. BUT I don't
> > want
> > > to write world 1 10 times in word dog and 5 times in word cat, but only
> > > once
> > > and to update the termVector so that the frequency will get 10 and 5
> > > respectively.
> > > So the *generation* of the synonyms will take into account the
> > frequencies
> > >
> > > The vicinity of words - is there any better way to take it in account?
> > >
> > > About the suggestion of using term boosting that will use the score of
> > the
> > > synonyms - if I want to query "big white dogs" and I have the following
> > > synonyms:
> > > big - big (1.0), large (0.9), huge (0.6)
> > > white - white (1.0), color (0.5) offwhite (0.8)
> > > dog - dog (1.0)
> > > So this is the way to do it? :
> > >
> > >   BooleanQuery bq = new  BooleanQuery();
> > >          TermQuery tq = new TermQuery(new Term("text", "big"));
> > >          tq.setBoost((float)1.0);
> > >                   bq.add(bq, false, false);
> > >   tq = new TermQuery(new Term(("text", "large"));
> > >             tq.setBoost((float)0.9);
> > >                             bq.add(bq, false);
> > >  tq = new TermQuery(new Term(("text", "huge"));
> > >             tq.setBoost((float)0.6);
> > >                             bq.add(bq, false);
> > >
> > >  tq = new TermQuery(new Term(("text", "white"));
> > >             tq.setBoost((float)1.0);
> > >                             bq.add(bq, false);
> > >  tq = new TermQuery(new Term(("text", "color"));
> > >             tq.setBoost((float)0.5);
> > >                             bq.add(bq, false);
> > > // etc
> > >   IndexSearcher searcher = new IndexSearcher("TestSearchIndex");
> > >                   Hits hits = searcher.search(bq);
> > >
> > >
> > > how the use of booleanQuery will also look at the position of the
> words?
> > I
> > > remember I read about the score that takes into account also  the
> > position
> > > of the term, but I didn't see this factor in the score formula
> > > Thanks again, it is very helpful,
> > >  Liat
> > > 2009/4/21 Doron Cohen <cdoronc@gmail.com>
> > >
> > > > Hi Liat, there are two packages under Lucene's contrib that deals
> with
> > > > Synonyms - that is contrib/memory and contrib/wordnet - which you
> > > > may find useful. I never used these two but they seem relevant to
> what
> > > > you are trying to achieve.
> > > >
> > > > Anyhow, it seems you compute the synonyms for word w are those
> > > > that appear in the same set of documents ('worlds') as w, and you
> find
> > > > this set by (a) indexing an inverse of the collection (docs become
> > words
> > > > and words become docs) and (b) using docs(w) as query do find
> syns(w).
> > > >
> > > > I assume that your 'worlds' are small, each containing only a small
> > > > set of a few related words, otherwise I would have two
> > > > concerns with this approach: (a) scalability (b) in a large doc
> (world)
> > > > this
> > > > approach ignores the vicinity of words which seems to me important
> > > > to their likelihood as synonyms
> > > >
> > > > Assuming you are okay here, and going back to original question of
> > > > altering the term frequency, perhaps taking the (search) scores of
> the
> > > > returned synonyms (which you find by search) is better than just
> > > > using their frequency? If you find this approach valid, then at least
> > for
> > > > some queries you should be able to use queries boosts. For example
> > > > create a BooleanQuery, add to it a TermQuery for each synonym,
> > > > but set the boost of the TermQuery according to the synonnym score.
> > > > This is also where you could "punish" synnonyms comparing to the
> > > > original word. This will only help with queries with contruction API
> > > > that takes (sub) queries as input (so it will not help with a
> > > PhraseQuery).
> > > >
> > > > - Doron
> > > >
> > > > On Tue, Apr 21, 2009 at 12:40 PM, liat oren <oren.liat@gmail.com>
> > wrote:
> > > >
> > > > > Ok, I will explain the full 'problem' and then explain how I
> approach
> > > it:
> > > > >
> > > > > Lets divide it into three steps:
> > > > >
> > > > > 1. I have a 'dictionary' of words - for every word, I have a list
> of
> > > > > worlds,
> > > > > which are ids of text documents that the word appears in.
> > > > > So, for example, for the word 'dog', I have '1 1600 36000' in the
> > > > "worlds"
> > > > > field (which are tokenized whin indexed) - which means that the
> word
> > > dog
> > > > > appears in worlds 1, 1600 and 36000.
> > > > >
> > > > > 2. This index is used to choose synonyms for the word dog - using
> the
> > > > > "worlds" field - I do a search on this index, giving the query "'1
> > 1600
> > > > > 36000" as in input and thus get the words that are close to the
> word
> > > > "dog".
> > > > > I take the 10 closest words.
> > > > >
> > > > > 3. These 10 synonyms are then used to expand the query.
> > > > >
> > > > > Basically, I have 2 problems in this process:
> > > > >
> > > > > a. In the process of finding the synonyms, I would like that the
> > > > frequency
> > > > > of the word in each of the worlds will be taken into account. so
> that
> > > if
> > > > > 'dog' appeared 3 times in world 1, 10 times in world 1600 and 4
> times
> > > in
> > > > > world 36000, then it will be taken into account.
> > > > > I wanted to avoid "expanding" the field to be "1 1 1 1600 1600 1600
> > > 1600
> > > > > 1600 1600 1600 1600 1600 1600 36000 36000 36000 36000". Accordingly
> I
> > > > > wanted
> > > > > to be able to set the freq by myself.
> > > > >
> > > > > b. In the process of using the synonyms, I wanted to be able to set
> a
> > > > > 'penalty' factor to the synonyms, together with giving differnt
> > weight
> > > to
> > > > > differnt synonyms, according to theur score. I looked at an old
> > thread
> > > -
> > > > > Search for synonyms - implemenetation for review :
> > > > > .
> > > > >
> > > > >
> > > >
> > >
> >
> http://mail-archives.apache.org/mod_mbox/lucene-java-user/200603.mbox/%3c39B0FB508E5D7540ACA5AD57225E150D39203D@xmail.me.corp.entopia.com%3e
> > > > >
> > > > > I don;t know if its part of lucene now. I didn't quite understand
> how
> > > to
> > > > > use
> > > > > it.
> > > > > Is there a better way to approach it?
> > > > >
> > > > > I hope I explained it well.
> > > > > Thanks,
> > > > > Liat
> > > > >
> > > > >
> > > > >
> > > > > 2009/4/21 Doron Cohen <cdoronc@gmail.com>
> > > > >
> > > > > > Depending on the problem you are trying to solve there may be
> other
> > > > > > solutions to it, not requiring setting wrong (?) values for term
> > > > > > frequencies.
> > > > > > If you can explain what you are trying to solve, people on the
> list
> > > may
> > > > > > be able to suggest such alternatives.
> > > > > > - Doron
> > > > > >
> > > > > > On Sun, Apr 19, 2009 at 2:39 PM, liat oren <oren.liat@gmail.com>
> > > > wrote:
> > > > > >
> > > > > > > Hi,
> > > > > > >
> > > > > > > I would like to be able to set the term freq to differnt values
> > at
> > > > > index
> > > > > > > time, or at search time.
> > > > > > >
> > > > > > > So if a document has the following text: 1 2, the freq of 1
> will
> > > get
> > > > > 100
> > > > > > > and
> > > > > > > the freq of 2 will get 200. I want to avoid expanding it by
> > writing
> > > 1
> > > > > 100
> > > > > > > times.
> > > > > > >
> > > > > > > I looked at Similarity class and wanted to override it, but the
> > tf
> > > > > > function
> > > > > > > gets only freq, so I don't know for which term this freq
> relates
> > > to,
> > > > > thus
> > > > > > I
> > > > > > > can't change the value.
> > > > > > >
> > > > > > > Thanks,
> > > > > > > Liat
> > > > > > >
> > > > > >
> > > > >
> > > >
> > >
> >
>

--0015174c363e9d2e480468243ca9--

From java-user-return-39886-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 13:37:43 2009
Return-Path: <java-user-return-39886-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81004 invoked from network); 22 Apr 2009 13:37:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 13:37:43 -0000
Received: (qmail 98955 invoked by uid 500); 22 Apr 2009 13:37:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98884 invoked by uid 500); 22 Apr 2009 13:37:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98874 invoked by uid 99); 22 Apr 2009 13:37:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 13:37:39 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 13:37:33 +0000
Received: by ewy27 with SMTP id 27so3046293ewy.5
        for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 06:37:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=lThpd1JUX5Is1QDX0UulVg3xEh4yTmXbEsmdoJxIqzI=;
        b=BGs2eg6sJGxz0fsRF8ck94E1wDnVCTSOkRMpsaCoXqZz7q3Ty2nswld8wN8GME82t6
         ZnH1IXK/W5hsxlREv5uZklaswppKLCXjX9g/ibEAHdfC/ThyIvdhhHhJg94rSvHgEv+H
         +KHBvlD7YI0FLEdxB07G8rtSQW8cD1ay5zfM4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=slfilcu6Pd8eGzgqsjlWv6vF/970CrQM2araKecHjU70hpO+eqiZqrOryCXfYg45Jm
         nlKQG5Lz82UAToUIC+JaE8Ot5PY7wrxcDTMN653U/vYkX9CxcC/AsSaIxl9pigmOYPS4
         9/s1oS56miucJGk406nvcyZLZhyAX3NfVQc+k=
MIME-Version: 1.0
Received: by 10.210.53.5 with SMTP id b5mr4144044eba.95.1240407431539; Wed, 22 
	Apr 2009 06:37:11 -0700 (PDT)
In-Reply-To: <74f928500904220552g5189e12ahe19581fa739447e8@mail.gmail.com>
References: <d36c28c30904190439g477f57e9s52c48ecffca5881e@mail.gmail.com>
	 <e05f0fd10904210216q3c0ed85egb097dde96a0e5ab3@mail.gmail.com>
	 <d36c28c30904210240p1271d5aahf39081570c4f7376@mail.gmail.com>
	 <e05f0fd10904210508q59bd86b1j479aac3b1be41f43@mail.gmail.com>
	 <d36c28c30904210644x2ba3c6f6mbd5c306def48078b@mail.gmail.com>
	 <74f928500904210740s76e3d63evf6b1629e979858e1@mail.gmail.com>
	 <d36c28c30904220352o57066e8egd3928a2390905f90@mail.gmail.com>
	 <74f928500904220552g5189e12ahe19581fa739447e8@mail.gmail.com>
Date: Wed, 22 Apr 2009 16:37:11 +0300
Message-ID: <d36c28c30904220637r102429c1m1cdb45924005879f@mail.gmail.com>
Subject: Re: changing term freq in indexing time
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174be18a556d38046824dc4a
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174be18a556d38046824dc4a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

The reason I am searching "3 3 2 1" and not "3 2 1" is the reason I asked
the question - it is important to include also these frequencies into
account when generating these scores.
Look at it as if - if a word appears more frequently in a text, is it more
important.

I managed to make the boosting work, but it seems like it has a very minor
factor within the scoring formula.

I tried this one:
   BooleanQuery bq = new BooleanQuery();
   TermQuery tq = new TermQuery(new Term(WordIndex.FIELD_WORLDS, "3"));
   tq.setBoost((float) 1.0);
   bq.add(tq, BooleanClause.Occur.MUST);
   tq = new TermQuery(new Term(WordIndex.FIELD_WORLDS, "6"));
   tq.setBoost((float) 5);
   bq.add(tq, BooleanClause.Occur.SHOULD);

and then with boost 0.5 for "6".
The change in the score was very minor

********************************************************
**** 0.03954939 3 ***** - the score (normalized)
0.73506767 = (MATCH) sum of:
  0.035917655 = (MATCH) weight(worlds:3 in 1), product of:
    0.10084726 = queryWeight(worlds:3), product of:
      0.71231794 = idf(docFreq=3, numDocs=3)
      0.14157619 = queryNorm
    0.35615897 = (MATCH) fieldWeight(worlds:3 in 1), product of:
      1.0 = tf(termFreq(worlds:3)=1)
      0.71231794 = idf(docFreq=3, numDocs=3)
      0.5 = fieldNorm(field=worlds, doc=1)
  0.69915 = (MATCH) weight(worlds:6^5.0 in 1), product of:
  *  0.99490196 = queryWeight(worlds:6^5.0), product of:
      5.0 = boost
*      1.4054651 = idf(docFreq=1, numDocs=3)
      0.14157619 = queryNorm
    0.70273256 = (MATCH) fieldWeight(worlds:6 in 1), product of:
      1.0 = tf(termFreq(worlds:6)=1)
      1.4054651 = idf(docFreq=1, numDocs=3)
      0.5 = fieldNorm(field=worlds, doc=1)

compares to
********************************************************
**** 0.03954939 3 ***** - the score
0.74707216 = (MATCH) sum of:
  0.25354254 = (MATCH) weight(worlds:3 in 1), product of:
    0.71188027 = queryWeight(worlds:3), product of:
      0.71231794 = idf(docFreq=3, numDocs=3)
      0.9993856 = queryNorm
    0.35615897 = (MATCH) fieldWeight(worlds:3 in 1), product of:
      1.0 = tf(termFreq(worlds:3)=1)
      0.71231794 = idf(docFreq=3, numDocs=3)
      0.5 = fieldNorm(field=worlds, doc=1)
  0.49352962 = (MATCH) weight(worlds:6^0.5 in 1), product of:
   * 0.7023008 = queryWeight(worlds:6^0.5), product of:
      0.5 = boost
*      1.4054651 = idf(docFreq=1, numDocs=3)
      0.9993856 = queryNorm
    0.70273256 = (MATCH) fieldWeight(worlds:6 in 1), product of:
      1.0 = tf(termFreq(worlds:6)=1)
      1.4054651 = idf(docFreq=1, numDocs=3)
      0.5 = fieldNorm(field=worlds, doc=1)
Any idea why is it?
It is not possible to set the frequencies during index time (this will give
a much bigger affect)?

Thanks,
Liat
2009/4/22 Eran Sevi <eransevi@gmail.com>

> Hi,
> I'm no expert on the subject but it seems like you're searching for one
> term
> that should be "3 3 2 1" (why do you write "3" two times anyway?).
> I think you should try a regulalr boolean query where each sub-query is a
> BoostingTermQuery on one term only. These queries should be used with
> Occur.MUST if you want the word to be in all these worlds.
> Maybe you should search the archives on the proper use of Boosting*Query.
> Regarding the synonyms - it looks quite OK to me. Maybe you should try to
> use ony Occur.MUST for all TermQuery instances. A simple debugging should
> also give you some clue about what is the problem.
> Good luck, Eran.
>
> On Wed, Apr 22, 2009 at 1:52 PM, liat oren <oren.liat@gmail.com> wrote:
>
> > Thanks Eran, I tried it, adding the classes I copied below and tried to
> run
> > the following
> > code:
> >
> > [Also I have below a question about the usage of synonyms and
> > BooleanQuery.]
> >
> >  DoubleMap wordMap = new DoubleMap();
> >  wordMap.insert("1", 1, 5); // for word "1" we have the world 1, 5 times
> >  wordMap.insert("1", 2, 2);// for word "1" we have the world 2, 2 times
> >  wordMap.insert("1", 3, 7);
> >  wordMap.insert("1", 4, 1);
> >  wordMap.insert("2", 3, 1); // for word "2" we have the world 3, 1 time
> >  wordMap.insert("2", 5, 1);
> >  wordMap.insert("2", 6, 1);
> >  wordMap.insert("3", 3, 1);
> >  wordMap.insert("3", 4, 1);
> >  wordMap.insert("3", 8, 1);
> >  ioManager io = new ioManager();
> >  io.index(wordMap, "TestSearchIndex", "", "1");
> >
> >  IndexSearcher searcher = new IndexSearcher("TestSearchIndex");
> >  searcher.setSimilarity(new WordsSimilarity()); // WordsSimilarity is
> > written below
> >  Query btq = new BoostingTermQuery(new Term(WordIndex.FIELD_WORLDS, "3 3
> 2
> > 1"));
> >  Hits wordsHits = searcher.search(btq);
> >
> > From some reason the hits size is 0 and none of the methods overriden in
> > WordsSimilarity is called (I put a breakpoint and it didn;t get there
> > during
> > search time)
> >
> > public class *WordsAnalyzer* extends Analyzer
> > {
> >  public Map<String, Map<String, Integer>> wordsWorldsFreq = new
> > HashMap<String, Map<String, Integer>>();
> >  public Map<String, Integer> worldsFreq = new HashMap<String, Integer>();
> >  public WordsAnalyzer()
> >  {
> >  }
> >  public WordsAnalyzer(Map<String, Integer> worldsFreq) throws IOException
> >  {
> >  this.worldsFreq = worldsFreq;
> >  }
> >  public TokenStream tokenStream(String fieldName, Reader reader)
> >  {
> >  return new WordsFilter(new StandardTokenizer(reader), worldsFreq);
> >  }
> > }
> >
> > public class *WordsFilter* extends TokenFilter
> > {
> >  public Map<String, Integer> worldsFreq;
> >  public WordsFilter(TokenStream in, Map<String, Integer> worldsFreq)
> >  {
> >  super(in);
> >  this.worldsFreq = worldsFreq;
> >  }
> >  public final Token next(Token result) throws IOException
> >  {
> >  byte payLoad = 1;
> >  try
> >  {
> >   result = input.next(result);
> >   if(result != null)
> >   {
> >    String word = String.copyValueOf(result.termBuffer(), 0,
> > result.termLength());
> >    payLoad = Byte.parseByte(worldsFreq.get(word).toString());
> >    result.setPayload(new Payload(new byte[] { Byte.valueOf(payLoad) }));
> >    return result;
> >   }
> >   else
> >   {
> >    return null;
> >   }
> >  }
> >  catch(Exception e)
> >  {
> >   e.printStackTrace();
> >   System.out.println(result.termBuffer() + " " + payLoad);
> >   FileUtil.writeToFile("IndexProblems.txt", "WordsFilter problem for " +
> > result.termBuffer() + " " + payLoad + " : " + e.getStackTrace());
> >   return null;
> >  }
> >  }
> > }
> > *****
> > public class *WordsSimilarity* extends DefaultSimilarity
> > {
> >  public WordsSimilarity()
> >  {
> >  }
> >  public float tf(float freq)
> >  {
> >  return super.tf(freq); // just wanted to check whether it is called
> >  }
> >  public float scorePayload(byte[] payload, int offset, int length)
> >  {
> >  //  if(length == 1)
> >  //  {
> >  return payload[offset];
> >  //  }
> >  }
> > }
> >
> > **
> > *******
> > ************
> > For the synonyms with the weights, I tried the following code:
> >   BooleanQuery bq = new BooleanQuery();
> >   TermQuery tq = new TermQuery(new Term(WordIndex.FIELD_WORLDS, "3"));
> >   tq.setBoost((float) 1.0);
> >   bq.add(bq, BooleanClause.Occur.MUST);
> >   tq = new TermQuery(new Term(WordIndex.FIELD_WORLDS, "2"));
> >   tq.setBoost((float) 0.5);
> >   bq.add(bq, BooleanClause.Occur.SHOULD);
> >   IndexSearcher searcher1 = new IndexSearcher("TestSearchIndex");
> >   Hits hits1 = searcher1.search(bq);
> >
> > And got the error: any idea what is the problem?
> >
> > at org.apache.lucene.search.BooleanQuery.rewrite(BooleanQuery.java:385)
> >  at org.apache.lucene.search.BooleanQuery.rewrite(BooleanQuery.java:385)
> > Process exited.
> >
> > Thanks,
> > Liat
> >
> >
> > 2009/4/21 Eran Sevi <eransevi@gmail.com>
> >
> > > Hi,
> > >
> > > You might want to take a look at Payloads. If you know the frequency of
> > the
> > > words in each world in advance than during tokenization for each world
> > you
> > > could save the frequency as the payload.
> > >
> > > During searches you could use BoostingTermQuery to take the frequency
> > into
> > > account.
> > >
> > > Eran.
> > >  On Tue, Apr 21, 2009 at 4:44 PM, liat oren <oren.liat@gmail.com>
> wrote:
> > >
> > > > Hi Doron,
> > > >
> > > > Thank you very much for the elaborated answer!
> > > >
> > > > About the Synonyms, I can't use Wordnet as I have my own list of
> > > synonyms.
> > > > I
> > > > will look at contrib/memory and see what it does.
> > > >
> > > > You understood correctly the process of using the inverse doc. About
> > the
> > > > two
> > > > problems you mentioned: scalability and ignoring the vicinity of
> words
> > -
> > > > scalability - this is the reason I wanted to set the frequencies of
> the
> > > > terms. The use of the frequencies will be used at this stage, not at
> > the
> > > > stage of using the synonyms. When I use the sysnonyms, I want to use
> > the
> > > > score as you suggested below.
> > > > Here, I have for every word, in which worlds they appear. Currently
> > every
> > > > world appears once in a word. However, I would like it to appear the
> > > number
> > > > if times as the frequency of the word in the world. In order to avoid
> > > > writing the world several times in the world field, I would like to
> be
> > > able
> > > > to set the freq of the specific world accordng to the freq of the
> word
> > at
> > > > this world without actually writing it x times (for scalability and
> > index
> > > > size and performance issues)
> > > > So if dog appears 10 times in world 1 and 5 times in world 2, and cat
> > > > appears 5 times in world 1, then I want these frequencies to be taken
> > > into
> > > > account when computing how the word dog and cat are close. BUT I
> don't
> > > want
> > > > to write world 1 10 times in word dog and 5 times in word cat, but
> only
> > > > once
> > > > and to update the termVector so that the frequency will get 10 and 5
> > > > respectively.
> > > > So the *generation* of the synonyms will take into account the
> > > frequencies
> > > >
> > > > The vicinity of words - is there any better way to take it in
> account?
> > > >
> > > > About the suggestion of using term boosting that will use the score
> of
> > > the
> > > > synonyms - if I want to query "big white dogs" and I have the
> following
> > > > synonyms:
> > > > big - big (1.0), large (0.9), huge (0.6)
> > > > white - white (1.0), color (0.5) offwhite (0.8)
> > > > dog - dog (1.0)
> > > > So this is the way to do it? :
> > > >
> > > >   BooleanQuery bq = new  BooleanQuery();
> > > >          TermQuery tq = new TermQuery(new Term("text", "big"));
> > > >          tq.setBoost((float)1.0);
> > > >                   bq.add(bq, false, false);
> > > >   tq = new TermQuery(new Term(("text", "large"));
> > > >             tq.setBoost((float)0.9);
> > > >                             bq.add(bq, false);
> > > >  tq = new TermQuery(new Term(("text", "huge"));
> > > >             tq.setBoost((float)0.6);
> > > >                             bq.add(bq, false);
> > > >
> > > >  tq = new TermQuery(new Term(("text", "white"));
> > > >             tq.setBoost((float)1.0);
> > > >                             bq.add(bq, false);
> > > >  tq = new TermQuery(new Term(("text", "color"));
> > > >             tq.setBoost((float)0.5);
> > > >                             bq.add(bq, false);
> > > > // etc
> > > >   IndexSearcher searcher = new IndexSearcher("TestSearchIndex");
> > > >                   Hits hits = searcher.search(bq);
> > > >
> > > >
> > > > how the use of booleanQuery will also look at the position of the
> > words?
> > > I
> > > > remember I read about the score that takes into account also  the
> > > position
> > > > of the term, but I didn't see this factor in the score formula
> > > > Thanks again, it is very helpful,
> > > >  Liat
> > > > 2009/4/21 Doron Cohen <cdoronc@gmail.com>
> > > >
> > > > > Hi Liat, there are two packages under Lucene's contrib that deals
> > with
> > > > > Synonyms - that is contrib/memory and contrib/wordnet - which you
> > > > > may find useful. I never used these two but they seem relevant to
> > what
> > > > > you are trying to achieve.
> > > > >
> > > > > Anyhow, it seems you compute the synonyms for word w are those
> > > > > that appear in the same set of documents ('worlds') as w, and you
> > find
> > > > > this set by (a) indexing an inverse of the collection (docs become
> > > words
> > > > > and words become docs) and (b) using docs(w) as query do find
> > syns(w).
> > > > >
> > > > > I assume that your 'worlds' are small, each containing only a small
> > > > > set of a few related words, otherwise I would have two
> > > > > concerns with this approach: (a) scalability (b) in a large doc
> > (world)
> > > > > this
> > > > > approach ignores the vicinity of words which seems to me important
> > > > > to their likelihood as synonyms
> > > > >
> > > > > Assuming you are okay here, and going back to original question of
> > > > > altering the term frequency, perhaps taking the (search) scores of
> > the
> > > > > returned synonyms (which you find by search) is better than just
> > > > > using their frequency? If you find this approach valid, then at
> least
> > > for
> > > > > some queries you should be able to use queries boosts. For example
> > > > > create a BooleanQuery, add to it a TermQuery for each synonym,
> > > > > but set the boost of the TermQuery according to the synonnym score.
> > > > > This is also where you could "punish" synnonyms comparing to the
> > > > > original word. This will only help with queries with contruction
> API
> > > > > that takes (sub) queries as input (so it will not help with a
> > > > PhraseQuery).
> > > > >
> > > > > - Doron
> > > > >
> > > > > On Tue, Apr 21, 2009 at 12:40 PM, liat oren <oren.liat@gmail.com>
> > > wrote:
> > > > >
> > > > > > Ok, I will explain the full 'problem' and then explain how I
> > approach
> > > > it:
> > > > > >
> > > > > > Lets divide it into three steps:
> > > > > >
> > > > > > 1. I have a 'dictionary' of words - for every word, I have a list
> > of
> > > > > > worlds,
> > > > > > which are ids of text documents that the word appears in.
> > > > > > So, for example, for the word 'dog', I have '1 1600 36000' in the
> > > > > "worlds"
> > > > > > field (which are tokenized whin indexed) - which means that the
> > word
> > > > dog
> > > > > > appears in worlds 1, 1600 and 36000.
> > > > > >
> > > > > > 2. This index is used to choose synonyms for the word dog - using
> > the
> > > > > > "worlds" field - I do a search on this index, giving the query
> "'1
> > > 1600
> > > > > > 36000" as in input and thus get the words that are close to the
> > word
> > > > > "dog".
> > > > > > I take the 10 closest words.
> > > > > >
> > > > > > 3. These 10 synonyms are then used to expand the query.
> > > > > >
> > > > > > Basically, I have 2 problems in this process:
> > > > > >
> > > > > > a. In the process of finding the synonyms, I would like that the
> > > > > frequency
> > > > > > of the word in each of the worlds will be taken into account. so
> > that
> > > > if
> > > > > > 'dog' appeared 3 times in world 1, 10 times in world 1600 and 4
> > times
> > > > in
> > > > > > world 36000, then it will be taken into account.
> > > > > > I wanted to avoid "expanding" the field to be "1 1 1 1600 1600
> 1600
> > > > 1600
> > > > > > 1600 1600 1600 1600 1600 1600 36000 36000 36000 36000".
> Accordingly
> > I
> > > > > > wanted
> > > > > > to be able to set the freq by myself.
> > > > > >
> > > > > > b. In the process of using the synonyms, I wanted to be able to
> set
> > a
> > > > > > 'penalty' factor to the synonyms, together with giving differnt
> > > weight
> > > > to
> > > > > > differnt synonyms, according to theur score. I looked at an old
> > > thread
> > > > -
> > > > > > Search for synonyms - implemenetation for review :
> > > > > > .
> > > > > >
> > > > > >
> > > > >
> > > >
> > >
> >
> http://mail-archives.apache.org/mod_mbox/lucene-java-user/200603.mbox/%3c39B0FB508E5D7540ACA5AD57225E150D39203D@xmail.me.corp.entopia.com%3e
> > > > > >
> > > > > > I don;t know if its part of lucene now. I didn't quite understand
> > how
> > > > to
> > > > > > use
> > > > > > it.
> > > > > > Is there a better way to approach it?
> > > > > >
> > > > > > I hope I explained it well.
> > > > > > Thanks,
> > > > > > Liat
> > > > > >
> > > > > >
> > > > > >
> > > > > > 2009/4/21 Doron Cohen <cdoronc@gmail.com>
> > > > > >
> > > > > > > Depending on the problem you are trying to solve there may be
> > other
> > > > > > > solutions to it, not requiring setting wrong (?) values for
> term
> > > > > > > frequencies.
> > > > > > > If you can explain what you are trying to solve, people on the
> > list
> > > > may
> > > > > > > be able to suggest such alternatives.
> > > > > > > - Doron
> > > > > > >
> > > > > > > On Sun, Apr 19, 2009 at 2:39 PM, liat oren <
> oren.liat@gmail.com>
> > > > > wrote:
> > > > > > >
> > > > > > > > Hi,
> > > > > > > >
> > > > > > > > I would like to be able to set the term freq to differnt
> values
> > > at
> > > > > > index
> > > > > > > > time, or at search time.
> > > > > > > >
> > > > > > > > So if a document has the following text: 1 2, the freq of 1
> > will
> > > > get
> > > > > > 100
> > > > > > > > and
> > > > > > > > the freq of 2 will get 200. I want to avoid expanding it by
> > > writing
> > > > 1
> > > > > > 100
> > > > > > > > times.
> > > > > > > >
> > > > > > > > I looked at Similarity class and wanted to override it, but
> the
> > > tf
> > > > > > > function
> > > > > > > > gets only freq, so I don't know for which term this freq
> > relates
> > > > to,
> > > > > > thus
> > > > > > > I
> > > > > > > > can't change the value.
> > > > > > > >
> > > > > > > > Thanks,
> > > > > > > > Liat
> > > > > > > >
> > > > > > >
> > > > > >
> > > > >
> > > >
> > >
> >
>

--0015174be18a556d38046824dc4a--

From java-user-return-39887-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 14:12:39 2009
Return-Path: <java-user-return-39887-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7141 invoked from network); 22 Apr 2009 14:12:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 14:12:36 -0000
Received: (qmail 64411 invoked by uid 500); 22 Apr 2009 14:12:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64301 invoked by uid 500); 22 Apr 2009 14:12:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64281 invoked by uid 99); 22 Apr 2009 14:12:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 14:12:31 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.74] (HELO spunkymail-a7.g.dreamhost.com) (208.97.132.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 14:12:21 +0000
Received: from [192.168.0.102] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a7.g.dreamhost.com (Postfix) with ESMTP id E9B4A5B681;
	Wed, 22 Apr 2009 07:11:59 -0700 (PDT)
Message-Id: <793E996E-A98F-465F-BD8E-B9EDFEACBB5E@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org, solr-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Fwd: ApacheCon
Date: Wed, 22 Apr 2009 10:11:59 -0400
References: <747D5D4A-1FF9-4ACA-B7F3-26E11A9D524C@apache.org>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org



Begin forwarded message:

>
> We are having a discussion general@lucene.apache.org about Lucene  
> related content for ApacheCon.  You may want to check it out and see
> http://wiki.apache.org/jakarta-lucene/LuceneAtApacheConUs2009
>
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39888-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 15:17:26 2009
Return-Path: <java-user-return-39888-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66459 invoked from network); 22 Apr 2009 15:17:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 15:17:26 -0000
Received: (qmail 39472 invoked by uid 500); 22 Apr 2009 15:17:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39404 invoked by uid 500); 22 Apr 2009 15:17:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39394 invoked by uid 99); 22 Apr 2009 15:17:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 15:17:23 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a17.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 15:17:13 +0000
Received: from [192.168.0.102] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a17.g.dreamhost.com (Postfix) with ESMTP id 006C673613
	for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 08:16:51 -0700 (PDT)
Message-Id: <E561A23B-1247-4F26-A5AB-93AA03943529@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <49ED8646.6040508@cis.strath.ac.uk>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: Using Payloads
Date: Wed, 22 Apr 2009 11:16:50 -0400
References: <49ED8646.6040508@cis.strath.ac.uk>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org


On Apr 21, 2009, at 4:39 AM, Murat Yakici wrote:

> Hi,
> I started playing with the experimental payload functionality. I  
> have written an analyzer which adds a payload (some sort of a score/ 
> boost) for each term occurance. The payload/score for each term is  
> dependent on the document that the term comes from (I guess this is  
> the typoical use case). So say term t1 may have a payload of 5 in  
> doc1 and 34 in doc5. The parameter for calculating the payload  
> changes after each indexWriter.addDocument(..) method call in a  
> while loop. I am assuming that the indexWriter.addDocument(..)  
> methods are thread safe. Can I confirm this?
>
Yes, addDoc is thread safe.  Are you seeing an issue or just checking?


--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39889-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 17:21:07 2009
Return-Path: <java-user-return-39889-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42629 invoked from network); 22 Apr 2009 17:21:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 17:21:06 -0000
Received: (qmail 42010 invoked by uid 500); 22 Apr 2009 17:21:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41915 invoked by uid 500); 22 Apr 2009 17:21:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41905 invoked by uid 99); 22 Apr 2009 17:21:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 17:21:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Murat.Yakici@cis.strath.ac.uk designates 130.159.196.96 as permitted sender)
Received: from [130.159.196.96] (HELO smtphost.cis.strath.ac.uk) (130.159.196.96)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 17:20:54 +0000
Received: from webmail.cis.strath.ac.uk (www-data@ramsay.cis.strath.ac.uk [130.159.196.85])
	by arnott.cis.strath.ac.uk (8.14.2/8.14.2/Debian-2build1) with ESMTP id n3MHKO7F011927
	for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 18:20:24 +0100
Received: from 93.97.155.28
        (SquirrelMail authenticated user murat)
        by webmail.cis.strath.ac.uk with HTTP;
        Wed, 22 Apr 2009 18:20:25 +0100 (BST)
Message-ID: <55375.93.97.155.28.1240420825.squirrel@webmail.cis.strath.ac.uk>
In-Reply-To: <E561A23B-1247-4F26-A5AB-93AA03943529@apache.org>
References: <49ED8646.6040508@cis.strath.ac.uk>
    <E561A23B-1247-4F26-A5AB-93AA03943529@apache.org>
Date: Wed, 22 Apr 2009 18:20:25 +0100 (BST)
Subject: Re: Using Payloads
From: "Murat Yakici" <Murat.Yakici@cis.strath.ac.uk>
To: java-user@lucene.apache.org
User-Agent: SquirrelMail/1.4.13
MIME-Version: 1.0
Content-Type: text/plain;charset=iso-8859-15
Content-Transfer-Encoding: 8bit
X-Priority: 3 (Normal)
Importance: Normal
X-CIS-MailScanner-SpamCheck: SpamAssassin score=-1.44, ALL_TRUSTED
X-Scanned-By: MIMEDefang on 130.159.196.96
X-Virus-Checked: Checked by ClamAV on apache.org


No, just checking. I will let you everyone know I see one.

Cheers,
Murat

>
> On Apr 21, 2009, at 4:39 AM, Murat Yakici wrote:
>
>> Hi,
>> I started playing with the experimental payload functionality. I
>> have written an analyzer which adds a payload (some sort of a score/
>> boost) for each term occurance. The payload/score for each term is
>> dependent on the document that the term comes from (I guess this is
>> the typoical use case). So say term t1 may have a payload of 5 in
>> doc1 and 34 in doc5. The parameter for calculating the payload
>> changes after each indexWriter.addDocument(..) method call in a
>> while loop. I am assuming that the indexWriter.addDocument(..)
>> methods are thread safe. Can I confirm this?
>>
> Yes, addDoc is thread safe.  Are you seeing an issue or just checking?
>
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)
> using Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


Murat Yakici
Department of Computer & Information Sciences
University of Strathclyde
Glasgow, UK
-------------------------------------------
The University of Strathclyde is a charitable body, registered in Scotland,
with registration number SC015263.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39890-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 20:15:46 2009
Return-Path: <java-user-return-39890-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73122 invoked from network); 22 Apr 2009 20:15:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 20:15:46 -0000
Received: (qmail 19443 invoked by uid 500); 22 Apr 2009 20:15:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19370 invoked by uid 500); 22 Apr 2009 20:15:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19360 invoked by uid 99); 22 Apr 2009 20:15:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 20:15:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 20:15:35 +0000
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-MimeOLE: Produced By Microsoft Exchange V6.5
x-cr-puzzleid: {460B182A-0DD3-48BB-A28A-9E7F26DD67F7}
Content-class: urn:content-classes:message
x-cr-hashedpuzzle: BLdg BMin BNkW CR4B CUId D5Qk EITN EYiE Ej8y FiVp F+lm GYsc Hyxm JPyY J7zH K7te;1;agBhAHYAYQAtAHUAcwBlAHIAQABsAHUAYwBlAG4AZQAuAGEAcABhAGMAaABlAC4AbwByAGcA;Sosha1_v1;7;{460B182A-0DD3-48BB-A28A-9E7F26DD67F7};ZABzAGUAbAB0AHoAZQByAEAAdAB2AGUAeQBlAHMALgBjAG8AbQA=;Wed, 22 Apr 2009 20:15:09 GMT;QgBvAG8AbABlAGEAbgAgAEwAbwBnAGkAYwAgAGkAbgBzAGkAZABlACAAYQAgAFEAdQBlAHIAeQBXAHIAYQBwAHAAZQByAEYAaQBsAHQAZQByAA==
Subject: Boolean Logic inside a QueryWrapperFilter
Date: Wed, 22 Apr 2009 16:15:09 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2A86@mail02.tveyes.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Boolean Logic inside a QueryWrapperFilter
thread-index: AcnDhwjmEhLtS8++RwqeH3rbfKw8zQ==
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Everyone,=20

I have some code that dynamically creates a Boolean query designed to
work as a filter. After the query runs I end up with this filter.=20

Filter: QueryWrapperFilter(+(-SourceID:100)
+spanNear([ArticleContent:nuclear, ArticleContent:proliferation], 30,
false))

My expectation is that this should limit the resultset to only results
that matches 'nuclear' NEAR 'proliferation' and are not tagged with
SourceID 100. Can anyone think of a reason that this would exclude all
content?

There are plenty of legitimate hits.

Is the +(-SourceID:100) a problem?

Thanks!

-Dave



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39891-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 20:38:42 2009
Return-Path: <java-user-return-39891-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78561 invoked from network); 22 Apr 2009 20:38:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 20:38:41 -0000
Received: (qmail 56060 invoked by uid 500); 22 Apr 2009 20:38:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55988 invoked by uid 500); 22 Apr 2009 20:38:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55978 invoked by uid 99); 22 Apr 2009 20:38:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 20:38:39 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.12.71] (HELO mx2.syr.edu) (128.230.12.71)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 20:38:29 +0000
Received: from suex07-hub-02.ad.syr.edu (suex07-hub-02.ad.syr.edu [128.230.108.196])
	by mx2.syr.edu (8.14.3/8.14.3) with ESMTP id n3MKc8fM010043
	for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 16:38:08 -0400
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-02.ad.syr.edu ([fe80::813b:49a2:a4d5:6367%10]) with mapi; Wed, 22
 Apr 2009 16:38:08 -0400
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Wed, 22 Apr 2009 16:38:06 -0400
Subject: RE: Boolean Logic inside a QueryWrapperFilter
Thread-Topic: Boolean Logic inside a QueryWrapperFilter
Thread-Index: AcnDhwjmEhLtS8++RwqeH3rbfKw8zQAAO1+A
Message-ID: <2D127F11DC79714E9B6A43AC9458147F13FCA43C@suex07-mbx-03.ad.syr.edu>
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2A86@mail02.tveyes.com>
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2A86@mail02.tveyes.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.7400:2.4.4,1.2.40,4.0.166 definitions=2009-04-22_16:2009-04-20,2009-04-22,2009-04-22 signatures=0
X-Proofpoint-Spam-Reason: safe
X-Virus-Checked: Checked by ClamAV on apache.org

Hi David,

On 4/22/2009 at 4:15 PM, David Seltzer wrote:
> I have some code that dynamically creates a Boolean query designed to
> work as a filter. After the query runs I end up with this filter.
>=20
> Filter: QueryWrapperFilter(+(-SourceID:100)
> +spanNear([ArticleContent:nuclear, ArticleContent:proliferation], 30,
> false))
>=20
> My expectation is that this should limit the resultset to only results
> that matches 'nuclear' NEAR 'proliferation' and are not tagged with
> SourceID 100. Can anyone think of a reason that this would exclude all
> content?
>=20
> There are plenty of legitimate hits.
>=20
> Is the +(-SourceID:100) a problem?

Prohibited clauses need a non-prohibited sibling clause in order to functio=
n.

+(-SourceID:100) means:

  /+/ : only match docs from:
     /-SourceID:100/ : do not match docs with SourceID:100, from:
        //: (the empty set)

That last line is the key here: you're excluding docs from a set that was e=
mpty to begin with.

You can remedy this either by removing the required clause around the prohi=
bited clause, i.e.:

 Filter: QueryWrapperFilter(-SourceID:100
                            +spanNear([ArticleContent:nuclear,
                                       ArticleContent:proliferation],
                                      30, false))

or by adding a MatchAllDocsQuery to the required clause containing the proh=
ibited clause:

 Filter: QueryWrapperFilter(+(-SourceID:100 *:*)
                            +spanNear([ArticleContent:nuclear,
                                       ArticleContent:proliferation],
                                      30, false))

Steve


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39892-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 21:08:36 2009
Return-Path: <java-user-return-39892-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92975 invoked from network); 22 Apr 2009 21:08:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 21:08:36 -0000
Received: (qmail 11379 invoked by uid 500); 22 Apr 2009 21:08:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11305 invoked by uid 500); 22 Apr 2009 21:08:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11295 invoked by uid 99); 22 Apr 2009 21:08:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 21:08:34 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rgupta18@sapient.com designates 125.21.183.230 as permitted sender)
Received: from [125.21.183.230] (HELO DELHUB1.sapient.com) (125.21.183.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 21:08:27 +0000
Received: from DELMAIL.sapient.com ([fe80::5d22:dc47:2d82:19f6]) by
 DELHUB1.sapient.com ([fe80::5053:86e4:2436:9ddb%13]) with mapi; Thu, 23 Apr
 2009 02:38:05 +0530
From: Rangan Gupta <rgupta18@sapient.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Thu, 23 Apr 2009 02:36:41 +0530
Subject: Question around LOM | Lucene Ontology
Thread-Topic: Question around LOM | Lucene Ontology
Thread-Index: AcnDjjvM6YN2S+NMR/6lQr8b6PooqA==
Message-ID: <1F107F05A6AE2E4183CA74D4277F60670993579EA7@DELMAIL.sapient.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_000_1F107F05A6AE2E4183CA74D4277F60670993579EA7DELMAILsapien_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_1F107F05A6AE2E4183CA74D4277F60670993579EA7DELMAILsapien_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi
Am a newbie to Lucene and hence this question about how to implement Ontolo=
gy based search using Lucene (LOM).
It would be useful to guide to any useful books, white papers etc. detailin=
g out the same.
Thanks
R



--_000_1F107F05A6AE2E4183CA74D4277F60670993579EA7DELMAILsapien_--

From java-user-return-39893-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 21:26:43 2009
Return-Path: <java-user-return-39893-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4595 invoked from network); 22 Apr 2009 21:26:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 21:26:43 -0000
Received: (qmail 32470 invoked by uid 500); 22 Apr 2009 21:26:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32387 invoked by uid 500); 22 Apr 2009 21:26:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32377 invoked by uid 99); 22 Apr 2009 21:26:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 21:26:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cdoronc@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 21:26:34 +0000
Received: by ewy27 with SMTP id 27so221949ewy.5
        for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 14:26:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=hCGWqvHPLYl5SWfgDhSkNR9bN1n1AN9/9qnhuG3Efm4=;
        b=Ltxj5Y9W+WEgMhA7E2PUSEq3PjgorZpGFYdka7KjUgYmqDeH2sd3DUvqf9y9dCrk2G
         RiK2YL+H0PMqKrT8B9fLhWO12ykSlXK9gvIvekWtF7MEJTNp/YO5TgZrrmiyY/R0tDFE
         +rYkUPtvbjxKyJ5E5M7BVXbZupw5Ep7U2VLzY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=kM5wHteDtZGnNKy0XxCT+nYDu3I46JXYg9rJyM+vNJSEQ4yCKVfwACoNKJrmdLhSqy
         m4ZYpvAq8iyxGkZ3XXWgOkOaGII0pGqbG0NflVSfGBCDAgUPlc3Jlm0X7KAML+SMZu2b
         56q6Ssaj1c8MFlNisaiWdmED8+VPVPwOHcW5A=
MIME-Version: 1.0
Received: by 10.210.30.1 with SMTP id d1mr6785116ebd.89.1240435572729; Wed, 22 
	Apr 2009 14:26:12 -0700 (PDT)
In-Reply-To: <49EE519C.70402@stanford.edu>
References: <49E91253.4030506@stanford.edu>
	 <e05f0fd10904210047m218a0628wf57070729841e2a9@mail.gmail.com>
	 <49EDFB49.60908@stanford.edu>
	 <e05f0fd10904211009u4996bccer52b4f7fd9ef7dceb@mail.gmail.com>
	 <49EE519C.70402@stanford.edu>
Date: Thu, 23 Apr 2009 00:26:12 +0300
Message-ID: <e05f0fd10904221426q32beedd8q3b485a769b2706c@mail.gmail.com>
Subject: Re: Why is CustomScoreQuery limited to ValueSourceQuery type?
From: Doron Cohen <cdoronc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174bdea0ade85004682b69df
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174bdea0ade85004682b69df
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Steve, I added a patch in https://issues.apache.org/jira/browse/LUCENE-1608,

which allows to wrap any query in a value source, and then create a value
source query out of it.
Let us know how this works for you...
Doron

On Wed, Apr 22, 2009 at 2:07 AM, Steven Bethard <bethard@stanford.edu>wrote:

> On 4/21/2009 10:09 AM, Doron Cohen wrote:
> > It could, but (historically and) currently it doesn't... :)
> > I actually have code for this.
> > Would you like open a JIRA issue for this - I'll attach my wrapper there?
>
> Done.
>
> https://issues.apache.org/jira/browse/LUCENE-1608
>
> Steve
>
> > On Tue, Apr 21, 2009 at 7:58 PM, Steven Bethard <bethard@stanford.edu
> >wrote:
> >
> >> On 4/21/2009 12:47 AM, Doron Cohen wrote:
> >>> CustomScoreQuery expects the VSQs to have a score for document matching
> >> the
> >>> (main) subQuery - this does not hold for arbitrary queries.
> >> Sure, but it could easily assign 0.0 scores for sub-queries that didn't
> >> match, no?
> >>
> >> Steve
> >>
> >>> On Sat, Apr 18, 2009 at 2:35 AM, Steven Bethard <bethard@stanford.edu
> >>> wrote:
> >>>
> >>>> CustomScoreQuery only allows the secondary queries to be of type
> >>>> ValueSourceQuery instead of allowing them to be any type of Query. Why
> >>>> is that? Is there something that makes it hard to implement for
> >>>> arbitrary queries?
> >>>>
> >>>> Steve
> >>>>
> >>>> P.S. I played around with this briefly, and simply replacing all
> >>>> ValueSourceQuery references with Query references yields only one
> simple
> >>>> compile error, where ValueSourceQuery.createWeight() is being used
> >>>> instead of Query.weight() for some reason.
>
>
>

--0015174bdea0ade85004682b69df--

From java-user-return-39894-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 22 22:31:54 2009
Return-Path: <java-user-return-39894-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45025 invoked from network); 22 Apr 2009 22:31:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Apr 2009 22:31:54 -0000
Received: (qmail 39923 invoked by uid 500); 22 Apr 2009 22:31:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39848 invoked by uid 500); 22 Apr 2009 22:31:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39838 invoked by uid 99); 22 Apr 2009 22:31:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 22:31:51 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of john.wang@gmail.com designates 74.125.44.28 as permitted sender)
Received: from [74.125.44.28] (HELO yx-out-2324.google.com) (74.125.44.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 22 Apr 2009 22:31:41 +0000
Received: by yx-out-2324.google.com with SMTP id 8so139782yxm.5
        for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 15:31:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=jf9oaJw0HoXL3mv9gvFN0tMpT3V+0vzgaLwOa54/3Lg=;
        b=Cu8p8BoVR2PSt/hYNcX5BVxPwViQTm3H8a+KvS4xELD/xA36mojf+ya8TkPXP59h06
         4Zh5zoCItU/FNnwh+XrnuEscuRthCO13Dw+KANvgwvkmMl3uUhKl128eViKZpWTpuEzA
         Zhr7RSyR18OYSwdNJ4NUirMDi842Eo3CcvPFo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=vwjOqizc9as/MKCdKoOkIb4JcewPui14ZHd6/NNsZvleJ64sWPNydmIx96PGfgDzgo
         sZNxyzGDqbYD/u+BIvWWlmuVLnxj41wEezPYe60mmLC1WNVZF01U/yoIr9YUbs7E8VcF
         KUbycpKM4WP0QpK//XyqxDgp3OOAe1rRdtUj0=
MIME-Version: 1.0
Received: by 10.100.13.2 with SMTP id 2mr342357anm.132.1240439480466; Wed, 22 
	Apr 2009 15:31:20 -0700 (PDT)
In-Reply-To: <23173324.post@talk.nabble.com>
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC266E@mail02.tveyes.com>
	 <23113784.post@talk.nabble.com>
	 <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2743@mail02.tveyes.com>
	 <8f0ad1f30904200726n18b00ae7rcd52f629491a8e62@mail.gmail.com>
	 <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2762@mail02.tveyes.com>
	 <23143797.post@talk.nabble.com>
	 <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2896@mail02.tveyes.com>
	 <23173324.post@talk.nabble.com>
Date: Wed, 22 Apr 2009 15:31:20 -0700
Message-ID: <8837fb770904221531i20878d9cl32efcf214865c26b@mail.gmail.com>
Subject: Re: Faceting, Sort and DocIDSet
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e644c766993c5e04682c52c3
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e644c766993c5e04682c52c3
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Karsten:

    Yes, you kinda need that for faceting to work. Take a look at
FacetDataCache class.

-John

On Wed, Apr 22, 2009 at 3:06 AM, Karsten F.
<karsten-lucene@fiz-technik.de>wrote:

>
> Hi Dave,
>
> facets:
> in you case a solution with one
> int[IndexReader.maxDoc()]
> fits. For each document number you can store an integer which represents
> the
> facet value.
> This is what org.apache.solr.request.UnInvertedField will store in your
> case.
> (*John* : is there something similar in com.browseengine ? )
>
> But UnInvertedField is designed for fields with more then one value per
> doc.
> Possible to implement directly the solution with int[IndexReader.maxDoc()]
> is more easy.
> The implementation with int[IndexReader.maxDoc()] should be 150 times
> faster
> then your current solution (and use only 16:300 of your main memory).
> But I still wonder that your solution is slow, did you ever use a profiler?
> Enough Xmx? Swapping? Possible your implementation of htFacetResults.get is
> slow? Possible same waiting because of synchronized code?
> But btw.: Your implementation is not thread save: Think about two
> htFacetResults.get before one htFacetResults.put
>
> INDEXORDER:
> For INDEXORDER the MultiSearcher and ParallelMultiSearcher use the
> docNumber
> for each index as score.
> So the result is
> 1. Doc with docNum 1 from first Index
> 2. Doc with docNum 1 from second Index
> ..
> n. Doc with docNum m from first Index
> n+1. Doc with docNum m from second Index
> ..
>
> I did not know this before. And I was surprised, because the docNum use the
> "starts"-Array but the score does not.
> So you can use a BitSet to collect the hits. The bits itself are in correct
> order.
> (and you could index and search without frequencies).
>
> Best regrads
>  Karsten
>
>
> David Seltzer wrote:
> >
> > Karsten,
> >
> > You're right, 300 facets would be a lot. Hehe. I have one facet with
> > about three hundred potential values. What I've done is create an
> > FacetManager who, in another thread, sets up an map of ~300 OpenBitSets.
> > One bitset for each possible value of the facet.
> >
> > Then, rather than using an iterative cardinality comparison, I use a
> > HitCollector to create an set of counters.
> >
> > public void collect(int doc, float score) {
> >    //we don't care about score, all we care about is docID;
> >    //we need to find out if this document is in any of our facets... if
> > it is, increment a counter
> >    for(SearchFacet sfTemp : arrayOfSearchFacetsValues) {
> >       if(sfTemp.getBitSet().fastGet(doc)) {
> >          //this is a hit!
> >          long lCount = htFacetResults.get(sfTemp.getTerm().text());
> >          htFacetResults.put(sfTemp.getTerm().text(), lCount+1);
> >
> >          //this code is designed for mutually exclusive
> >          //facet values... in that scenario, a hit here means
> >          //that we can't have a hit anywhere else, so we should
> >          //break.
> >          break;
> >       }
> >    }
> > }
> >
> > Here I seem to be running into a performance issue. It seems that when a
> > resultset is small (~10,000) this method greatly outperforms the
> > iterating cardinality check. However, when the resultset is large
> > (300,000) the HitCollector takes twice as long to process the resultset
> > as the other solution.
> >
> > Our total index typically contains about 100M documents. This is broken
> > up into four monthly indexes each containing 250K documents. And a
> > typical search returns < 120,000 results. Lousy searches return more
> > results (IE "obama" returns nearly 800,000 documents).
> >
> > At the moment we're using ParalellMultiSearcher. When I do a search,
> > across four montly indexes, ordered by INDEXORDER what I get is all of
> > the hits that happened on the first of any month, then all the hits that
> > happened on the second of any month. Does 'starts' behave the same way
> > in ParallelMultiSearcher?
> >
> > Thanks for all your input!
> >
> > -Dave
> >
> >
>
> --
> View this message in context:
> http://www.nabble.com/Faceting%2C-Sort-and-DocIDSet-tp23099854p23173324.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e644c766993c5e04682c52c3--

From java-user-return-39895-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 05:43:34 2009
Return-Path: <java-user-return-39895-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25025 invoked from network); 23 Apr 2009 05:43:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 05:43:34 -0000
Received: (qmail 59839 invoked by uid 500); 23 Apr 2009 05:43:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59751 invoked by uid 500); 23 Apr 2009 05:43:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59741 invoked by uid 99); 23 Apr 2009 05:43:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 05:43:30 +0000
X-ASF-Spam-Status: No, hits=0.5 required=10.0
	tests=FUZZY_CREDIT,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 05:43:22 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lwri9-0003GZ-C6
	for java-user@lucene.apache.org; Wed, 22 Apr 2009 22:43:01 -0700
Message-ID: <23190555.post@talk.nabble.com>
Date: Wed, 22 Apr 2009 22:43:01 -0700 (PDT)
From: uday kumar maddigatla <ukma@mach.com>
To: java-user@lucene.apache.org
Subject: Re: How to search special characters in LUcene
In-Reply-To: <359a92830904220551x23da922ftdbae71d18210538@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: ukma@mach.com
References: <D262A1FB331DC344AA0B896F390D5569016E3E8C@exchhyd.machcorp.lan> <359a92830904210735g24df775cx4bfa11774ac6161c@mail.gmail.com> <23170710.post@talk.nabble.com> <359a92830904220551x23da922ftdbae71d18210538@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


HI=20

Here are the details about my goals.
1. I want to use this lucene for mixed languages.
2. I want to make indexes of the documents which are either english or
danish etc.
I'm attaching my IndexFiles.java file.

When i'm searching i'm giving the index path location  as well as doucmets
folder.

If i use StandardAnalyzer as an argument to IndexWriter's method it is able
to search the english characters.

How can i use DutchAnalyzer in order to make this IndexFiles.java to index
the danish elements.

In my Code which i attached, you can see 'C:\test3'. This is my location
where i want to store my indexes.

I'm giving documents folder location as comand line argument.

In my document the content will be like this

<com:Note><![CDATA[Kreditnota til udligning af faktura nr. 13927 pga skal
opsplittes
hhv. byggeplads og skat
Vedr.           :   Amtsg=C3=A5rden =C3=85rhus, Lyseng All=C3=A9 1, 8270 H=
=C3=B8jbjerg
Bygning B
SES Journal nr. :   42895-0001
SES Navision nr.:   Navision 9800124
SES Ansvarlig   :   Martin Kr=C3=B8ldrup Nielsen
SES r=C3=A5dgiver    :   Friis & Moltke A/S
Hermed fremsendes faktura p=C3=A5 ekstra t=C3=B8mrerarbejde.
Byggeplads Amtsg=C3=A5rden B-4
jvf. vedlagte specifikation - aftaleseddel nr. 12.]]></com:Note>

i"m searching the word like r=C3=A5dgiver . When i see the result it is cle=
arly
searching for r dgiver. It is omitting the danish element.

Please help me in this.



Erick Erickson wrote:
>=20
> Are you *also* using the DutchAnalyzer for your *query*?
>=20
> Please show us the index and search code (simplified as much
> as possible), then we'll be able to provide better suggestions.
>=20
> Also, tell us a bit more about your goals here. Is this an
> index entirely of Dutch documents? Or is it a mixed-language
> index?
>=20
> Think about getting a copy of Luke and
> 1> examining your index to see what's *really* there
> 2> examining the effects of using different parsers on
>      your *query*.
>=20
> Best
> Erick
>=20
> On Wed, Apr 22, 2009 at 2:57 AM, uday kumar maddigatla
> <ukma@mach.com>wrote:
>=20
>>
>> Hi
>>
>> Thanks for your reply.
>>
>> I'm able to see the DutchAnalyzer.
>>
>> When i'm indexing my documents i given instace of DutchAnalyzer as an
>> argument to IndexWriter Class.
>>
>> After this when i search for the
>> http://www.nabble.com/file/p23170710/IndexFiles.java IndexFiles.java
>> contains the danish elements .. Still it is not able to identify.
>>
>> Please tell me how to use DutchAnalzer in my application. Sample example
>> or
>> series of steps helps me.
>>
>> I also attached my index file(.java file).
>>
>> Please help me in this. please..
>>
>> Erick Erickson wrote:
>> >
>> > Take a look at DutchAnalyzer. The problem you'll have is if you're
>> > indexing
>> > this document along with a bunch of documents from other languages.
>> > You could search the mail archive for extensive discussions of=20
>> indexing/
>> > searching documents from several languages.
>> >
>> > Best
>> > Erick
>> >
>> > On Tue, Apr 21, 2009 at 2:40 AM, Uday Kumar Maddigatla
>> > <ukma@mach.com>wrote:
>> >
>> >> HI,
>> >>
>> >>
>> >>
>> >> I'm new to the lucene. I downloaded lucene 2.4.1.
>> >>
>> >>
>> >>
>> >> I have one xml file which contains few special characters like '=C3=
=A5',
>> '=C3=B8,'
>> >> =C2=B0'
>> >> etc.(these are Danish language elements).
>> >>
>> >>
>> >>
>> >> How can I search these things.
>> >>
>> >>
>> >>
>> >>
>> >>
>> >> Uday Kumar  Reddy Maddigatla
>> >>
>> >> Software Engineer(Progrator|gatetrade)
>> >>
>> >> MACH India(Operations)
>> >>
>> >> Mobile: + 91-9963000377
>> >>
>> >> Uday.Maddigatla@ness.com <mailto:Uday.Maddigatla@ness.com>
>> >>
>> >> ukma@mach.com <mailto:ukma@mach.com>
>> >>
>> >> www.ness.com
>> >>
>> >>
>> >>
>> >>
>> >>
>> >>
>> >
>> >
>>
>> --
>> View this message in context:
>> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp23150=
039p23170710.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
>=20
http://www.nabble.com/file/p23190555/IndexFiles.java IndexFiles.java=20
http://www.nabble.com/file/p23190555/SearchFiles.java SearchFiles.java=20
http://www.nabble.com/file/p23190555/IndexFiles.java IndexFiles.java=20
http://www.nabble.com/file/p23190555/IndexFiles.java IndexFiles.java=20
--=20
View this message in context: http://www.nabble.com/How-to-search-special-c=
haracters-in-LUcene-tp23150039p23190555.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39896-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 05:44:02 2009
Return-Path: <java-user-return-39896-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25257 invoked from network); 23 Apr 2009 05:44:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 05:44:02 -0000
Received: (qmail 61539 invoked by uid 500); 23 Apr 2009 05:44:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61463 invoked by uid 500); 23 Apr 2009 05:43:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61453 invoked by uid 99); 23 Apr 2009 05:43:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 05:43:59 +0000
X-ASF-Spam-Status: No, hits=0.5 required=10.0
	tests=FUZZY_CREDIT,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 05:43:51 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lwric-0003H9-P0
	for java-user@lucene.apache.org; Wed, 22 Apr 2009 22:43:30 -0700
Message-ID: <23190583.post@talk.nabble.com>
Date: Wed, 22 Apr 2009 22:43:30 -0700 (PDT)
From: uday kumar maddigatla <ukma@mach.com>
To: java-user@lucene.apache.org
Subject: Re: How to search special characters in LUcene
In-Reply-To: <359a92830904220551x23da922ftdbae71d18210538@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: ukma@mach.com
References: <D262A1FB331DC344AA0B896F390D5569016E3E8C@exchhyd.machcorp.lan> <359a92830904210735g24df775cx4bfa11774ac6161c@mail.gmail.com> <23170710.post@talk.nabble.com> <359a92830904220551x23da922ftdbae71d18210538@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


HI=20

Here are the details about my goals.
1. I want to use this lucene for mixed languages.
2. I want to make indexes of the documents which are either english or
danish etc.
I'm attaching my IndexFiles.java file.

When i'm searching i'm giving the index path location  as well as doucmets
folder.

If i use StandardAnalyzer as an argument to IndexWriter's method it is able
to search the english characters.

How can i use DutchAnalyzer in order to make this IndexFiles.java to index
the danish elements.

In my Code which i attached, you can see 'C:\test3'. This is my location
where i want to store my indexes.

I'm giving documents folder location as comand line argument.

In my document the content will be like this

<com:Note><![CDATA[Kreditnota til udligning af faktura nr. 13927 pga skal
opsplittes
hhv. byggeplads og skat
Vedr.           :   Amtsg=C3=A5rden =C3=85rhus, Lyseng All=C3=A9 1, 8270 H=
=C3=B8jbjerg
Bygning B
SES Journal nr. :   42895-0001
SES Navision nr.:   Navision 9800124
SES Ansvarlig   :   Martin Kr=C3=B8ldrup Nielsen
SES r=C3=A5dgiver    :   Friis & Moltke A/S
Hermed fremsendes faktura p=C3=A5 ekstra t=C3=B8mrerarbejde.
Byggeplads Amtsg=C3=A5rden B-4
jvf. vedlagte specifikation - aftaleseddel nr. 12.]]></com:Note>

i"m searching the word like r=C3=A5dgiver . When i see the result it is cle=
arly
searching for r dgiver. It is omitting the danish element.

Please help me in this.



Erick Erickson wrote:
>=20
> Are you *also* using the DutchAnalyzer for your *query*?
>=20
> Please show us the index and search code (simplified as much
> as possible), then we'll be able to provide better suggestions.
>=20
> Also, tell us a bit more about your goals here. Is this an
> index entirely of Dutch documents? Or is it a mixed-language
> index?
>=20
> Think about getting a copy of Luke and
> 1> examining your index to see what's *really* there
> 2> examining the effects of using different parsers on
>      your *query*.
>=20
> Best
> Erick
>=20
> On Wed, Apr 22, 2009 at 2:57 AM, uday kumar maddigatla
> <ukma@mach.com>wrote:
>=20
>>
>> Hi
>>
>> Thanks for your reply.
>>
>> I'm able to see the DutchAnalyzer.
>>
>> When i'm indexing my documents i given instace of DutchAnalyzer as an
>> argument to IndexWriter Class.
>>
>> After this when i search for the
>> http://www.nabble.com/file/p23170710/IndexFiles.java IndexFiles.java
>> contains the danish elements .. Still it is not able to identify.
>>
>> Please tell me how to use DutchAnalzer in my application. Sample example
>> or
>> series of steps helps me.
>>
>> I also attached my index file(.java file).
>>
>> Please help me in this. please..
>>
>> Erick Erickson wrote:
>> >
>> > Take a look at DutchAnalyzer. The problem you'll have is if you're
>> > indexing
>> > this document along with a bunch of documents from other languages.
>> > You could search the mail archive for extensive discussions of=20
>> indexing/
>> > searching documents from several languages.
>> >
>> > Best
>> > Erick
>> >
>> > On Tue, Apr 21, 2009 at 2:40 AM, Uday Kumar Maddigatla
>> > <ukma@mach.com>wrote:
>> >
>> >> HI,
>> >>
>> >>
>> >>
>> >> I'm new to the lucene. I downloaded lucene 2.4.1.
>> >>
>> >>
>> >>
>> >> I have one xml file which contains few special characters like '=C3=
=A5',
>> '=C3=B8,'
>> >> =C2=B0'
>> >> etc.(these are Danish language elements).
>> >>
>> >>
>> >>
>> >> How can I search these things.
>> >>
>> >>
>> >>
>> >>
>> >>
>> >> Uday Kumar  Reddy Maddigatla
>> >>
>> >> Software Engineer(Progrator|gatetrade)
>> >>
>> >> MACH India(Operations)
>> >>
>> >> Mobile: + 91-9963000377
>> >>
>> >> Uday.Maddigatla@ness.com <mailto:Uday.Maddigatla@ness.com>
>> >>
>> >> ukma@mach.com <mailto:ukma@mach.com>
>> >>
>> >> www.ness.com
>> >>
>> >>
>> >>
>> >>
>> >>
>> >>
>> >
>> >
>>
>> --
>> View this message in context:
>> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp23150=
039p23170710.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
>=20
http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java=20
http://www.nabble.com/file/p23190583/SearchFiles.java SearchFiles.java=20
http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java=20
http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java=20
--=20
View this message in context: http://www.nabble.com/How-to-search-special-c=
haracters-in-LUcene-tp23150039p23190583.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39897-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 07:00:25 2009
Return-Path: <java-user-return-39897-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65557 invoked from network); 23 Apr 2009 07:00:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 07:00:25 -0000
Received: (qmail 41998 invoked by uid 500); 23 Apr 2009 07:00:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41932 invoked by uid 500); 23 Apr 2009 07:00:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41922 invoked by uid 99); 23 Apr 2009 07:00:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 07:00:22 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of oren.liat@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 07:00:15 +0000
Received: by ey-out-2122.google.com with SMTP id 22so81112eye.53
        for <java-user@lucene.apache.org>; Wed, 22 Apr 2009 23:59:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=DgpC7Xkx4/xyVTYa5PUmp5nl5aZEbHKpRUEfnCcn5iY=;
        b=h69XIcUM1WeDkL2Uckm7B/fUXyUwxdwJua4JSUuKguSSi8C3YyxVXST1x6W+knEk1E
         mA+gw2HQSpaUP5jxobM1RD1ZWsrTcwJsLYbr/7oKLoUspZQpxJdRKwhnR+mrWg0czwLI
         QeDYQ6UArN7ut2nUeeYPrpTh2zr16+Fhq8g4o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=A0kSfEO+XdAkGctx9OxO1Zksa+JD1sP+++EX8P7XVmAAZcnj4mGQVEJ0bzYBE9MRb0
         vLjyWvnUVrkMjfWXObrNC9xTQ895iybeUlxtVuqysbGwbp4zvYeUo0juCB/24fpS9jVq
         IL8XtcmXlc4q0e6kg8PM7ITPUpLhHJxvIzOm4=
MIME-Version: 1.0
Received: by 10.210.87.19 with SMTP id k19mr7247952ebb.19.1240469994284; Wed, 
	22 Apr 2009 23:59:54 -0700 (PDT)
In-Reply-To: <49ED8646.6040508@cis.strath.ac.uk>
References: <49ED8646.6040508@cis.strath.ac.uk>
Date: Thu, 23 Apr 2009 09:59:54 +0300
Message-ID: <d36c28c30904222359m74c810b6p83bdea1af5345bc8@mail.gmail.com>
Subject: Re: Using Payloads
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c3c605d262d0468336d4a
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c3c605d262d0468336d4a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Dear Murat,

I saw your question and wondered how did you implement these changes?
The requirement below are the same ones as I am trying to code now.
Did you modify the source code itself or only used Lucene's jar and just
override code?

I would very much apprecicate if you could give me a short explanation on
how was it done.

Thanks a lot,
Liat

2009/4/21 Murat Yakici <murat.yakici@cis.strath.ac.uk>

> Hi,
> I started playing with the experimental payload functionality. I have
> written an analyzer which adds a payload (some sort of a score/boost) for
> each term occurance. The payload/score for each term is dependent on the
> document that the term comes from (I guess this is the typoical use case).
> So say term t1 may have a payload of 5 in doc1 and 34 in doc5. The parameter
> for calculating the payload changes after each indexWriter.addDocument(..)
> method call in a while loop. I am assuming that the
> indexWriter.addDocument(..) methods are thread safe. Can I confirm this?
>
> Cheers,
>
> --
> Murat Yakici
> Department of Computer & Information Sciences
> University of Strathclyde
> Glasgow, UK
> -------------------------------------------
> The University of Strathclyde is a charitable body, registered in Scotland,
> with registration number SC015263.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174c3c605d262d0468336d4a--

From java-user-return-39898-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 10:03:19 2009
Return-Path: <java-user-return-39898-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56392 invoked from network); 23 Apr 2009 10:03:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 10:03:19 -0000
Received: (qmail 74687 invoked by uid 500); 23 Apr 2009 10:03:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74633 invoked by uid 500); 23 Apr 2009 10:03:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74623 invoked by uid 99); 23 Apr 2009 10:03:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 10:03:16 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.172] (HELO wf-out-1314.google.com) (209.85.200.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 10:03:08 +0000
Received: by wf-out-1314.google.com with SMTP id 24so348125wfg.20
        for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 03:02:47 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.143.165.19 with SMTP id s19mr299185wfo.117.1240480967202; Thu, 
	23 Apr 2009 03:02:47 -0700 (PDT)
In-Reply-To: <49EE4B71.8030105@aduna-software.com>
References: <49E4573E.7070208@aduna-software.com>
	 <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>
	 <49E6FD9F.5080104@aduna-software.com>
	 <9ac0c6aa0904160510l6cf559c6yfc6b0c1deadbf1de@mail.gmail.com>
	 <49EE41F9.3030007@aduna-software.com>
	 <49EE4B71.8030105@aduna-software.com>
Date: Thu, 23 Apr 2009 06:02:47 -0400
Message-ID: <9ac0c6aa0904230302p568892f2p1cf365f4a1d61207@mail.gmail.com>
Subject: Re: semi-infinite loop during merging
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, Apr 21, 2009 at 6:40 PM, Christiaan Fluit
<christiaan.fluit@aduna-software.com> wrote:

> I may be on to something already.
>
> I just looked at the commitMerge code and was surprised to see that the
> commitMerge message that is almost at the beginning wasn't printed. Then I
> saw the "if (hitOOM) return false;" part that takes place before that. I
> think that this can only mean that an OOME was encountered at some point in
> time.

Very interesting!  I like this theory...

> Now, the fact is that in my indexing code I do a catch(Throwable) in several
> places. I do this particularly because JET handles OOMEs in a very, very
> nasty way. Often you will just get an error dialog and then it quits the
> entire application. Therefore, my client code catches, logs and swallows the
> OOME before the JET runtime can intercept it. *Usually*, the application can
> then recover gracefully and continue processing the rest of the information.
>
> Catching a OOME that results from the operation of a text extraction library
> is one thing (and a fact of life really), but perhaps there are also OOME's
> that occur during Lucene processing.
>
> I remember seeing those in the past with the original Java code, when very
> large Strings were being tokenized and I got an OOME with a deep Lucene
> stacktrace. I copied one such stacktrace that I have saved at the end of
> this mail.
>
> I see some caught and swallowed OOME's in my log file but unfortunately they
> are without a stacktrace - probably again a JET issue. I can run the normal
> Java build though to see if such OOMEs occur on this dataset.
>
> Now, I wonder:
>
> - when the IW is in auto-commit mode, can the failed processing of a
> Document due to an OOME have an impact on the processing of subsequent
> Documents or the merge/optimize operations? Can the index(writer) become
> corrupt and result in problems such as these?

On hitting OOME, Lucene refuses to commit any further changes to the
index.  Ie, you must at that point abandon the writer
(writer.rollback()).  We do this as a defense against the possibility
that an OOME might otherwise cause index corruption.

> - even though the commitMerge returns false, it should probably not get into
> an infinite loop. Is this an internal Lucene problem or is there something I
> can/should do about it myself?

Yes, something is wrong with Lucene's handling of OOME.  It certainly
should not lead to infinite merge attempts.  I'll dig (once back from
vacation) to see if I can find this path.  Likely we need to prevent
launching of new merges after an OOME.  I think you must've happened
to hit OOME when a merge was running.

> - more generally, what is the recommended behavior when I get an OOME during
> Lucene processing, particularly IW.addDocument? Should the IW be able to
> recover by itself or is there some sort of rollback I need to perform?

You need to call writer.rollback().

> Again, note that my index is in auto-commit mode (though I had hoped to let
> go of that too, it's only for historic reasons).

I think being in autoCommit mode shouldn't affect this, ie likely
you'd hit the infinite loop with autoCommit=false too.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39899-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 13:35:29 2009
Return-Path: <java-user-return-39899-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69965 invoked from network); 23 Apr 2009 13:35:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 13:35:29 -0000
Received: (qmail 3258 invoked by uid 500); 23 Apr 2009 13:35:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3198 invoked by uid 500); 23 Apr 2009 13:35:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3188 invoked by uid 99); 23 Apr 2009 13:35:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 13:35:27 +0000
X-ASF-Spam-Status: No, hits=2.7 required=10.0
	tests=FUZZY_CREDIT,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.221.136 as permitted sender)
Received: from [209.85.221.136] (HELO mail-qy0-f136.google.com) (209.85.221.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 13:35:18 +0000
Received: by qyk42 with SMTP id 42so1024917qyk.29
        for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 06:34:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=GteAWfUYu8MgyeaFaxn4WuFjSoSIlIbBlK09HdjA7pE=;
        b=uCBNSI0kET9SAN4y9K5izcTaldEeTOFLrwT2HBaYaQp1L2oKoCpvwB6P86FNf80+IO
         9EFOVvFTeuDHkMR2Fj5gLCKNwSjzJvMRSkNbJ51EBU9TfYB8Ecn8y+UfEoz8jY+FIL6F
         efw5i84nUJu3tO63anXxBPd8LPrN+6TVcpWLc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=dRXGMMsTg62MCX+SMem8UBo556RynnNmGQndz13TcIc9DGUmDeXqnSKpXZfcazkTnU
         PHPU9McL9xVOlYMt0sSzYmDGCoHtae7lS8y/7/62uXWITNntEDKZlAdbuAdrAv+pZvj9
         GuldXRbGUonM+z7DqgWIopKRZVrm6ZSLndFRA=
MIME-Version: 1.0
Received: by 10.220.94.137 with SMTP id z9mr2233840vcm.52.1240493695820; Thu, 
	23 Apr 2009 06:34:55 -0700 (PDT)
In-Reply-To: <23190583.post@talk.nabble.com>
References: <D262A1FB331DC344AA0B896F390D5569016E3E8C@exchhyd.machcorp.lan>
	 <359a92830904210735g24df775cx4bfa11774ac6161c@mail.gmail.com>
	 <23170710.post@talk.nabble.com>
	 <359a92830904220551x23da922ftdbae71d18210538@mail.gmail.com>
	 <23190583.post@talk.nabble.com>
Date: Thu, 23 Apr 2009 09:34:55 -0400
Message-ID: <359a92830904230634x2f13ef20r1b0e1599531f8dd9@mail.gmail.com>
Subject: Re: How to search special characters in LUcene
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e647605215e63c046838f2be
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e647605215e63c046838f2be
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

OK, this is a much different problem than you were originally
asking about, effectively "how to index/search mixed language
documents".

This topic has been discussed multiple times on the user list, I
think your first step should be to search the archive. I *was*
going to find the old searchable mail archive, but those clever folks
at Lucid Imagination have something new, see:

http://www.lucidimagination.com/search/p:lucene?q=3Dmultiple+languages

Once you've had a chance to look that over I think you'll be off and
running.

Best
Erick

On Thu, Apr 23, 2009 at 1:43 AM, uday kumar maddigatla <ukma@mach.com>wrote=
:

>
> HI
>
> Here are the details about my goals.
> 1. I want to use this lucene for mixed languages.
> 2. I want to make indexes of the documents which are either english or
> danish etc.
> I'm attaching my IndexFiles.java file.
>
> When i'm searching i'm giving the index path location  as well as doucmet=
s
> folder.
>
> If i use StandardAnalyzer as an argument to IndexWriter's method it is ab=
le
> to search the english characters.
>
> How can i use DutchAnalyzer in order to make this IndexFiles.java to inde=
x
> the danish elements.
>
> In my Code which i attached, you can see 'C:\test3'. This is my location
> where i want to store my indexes.
>
> I'm giving documents folder location as comand line argument.
>
> In my document the content will be like this
>
> <com:Note><![CDATA[Kreditnota til udligning af faktura nr. 13927 pga skal
> opsplittes
> hhv. byggeplads og skat
> Vedr.           :   Amtsg=E5rden =C5rhus, Lyseng All=E9 1, 8270 H=F8jbjer=
g
> Bygning B
> SES Journal nr. :   42895-0001
> SES Navision nr.:   Navision 9800124
> SES Ansvarlig   :   Martin Kr=F8ldrup Nielsen
> SES r=E5dgiver    :   Friis & Moltke A/S
> Hermed fremsendes faktura p=E5 ekstra t=F8mrerarbejde.
> Byggeplads Amtsg=E5rden B-4
> jvf. vedlagte specifikation - aftaleseddel nr. 12.]]></com:Note>
>
> i"m searching the word like r=E5dgiver . When i see the result it is clea=
rly
> searching for r dgiver. It is omitting the danish element.
>
> Please help me in this.
>
>
>
> Erick Erickson wrote:
> >
> > Are you *also* using the DutchAnalyzer for your *query*?
> >
> > Please show us the index and search code (simplified as much
> > as possible), then we'll be able to provide better suggestions.
> >
> > Also, tell us a bit more about your goals here. Is this an
> > index entirely of Dutch documents? Or is it a mixed-language
> > index?
> >
> > Think about getting a copy of Luke and
> > 1> examining your index to see what's *really* there
> > 2> examining the effects of using different parsers on
> >      your *query*.
> >
> > Best
> > Erick
> >
> > On Wed, Apr 22, 2009 at 2:57 AM, uday kumar maddigatla
> > <ukma@mach.com>wrote:
> >
> >>
> >> Hi
> >>
> >> Thanks for your reply.
> >>
> >> I'm able to see the DutchAnalyzer.
> >>
> >> When i'm indexing my documents i given instace of DutchAnalyzer as an
> >> argument to IndexWriter Class.
> >>
> >> After this when i search for the
> >> http://www.nabble.com/file/p23170710/IndexFiles.java IndexFiles.java
> >> contains the danish elements .. Still it is not able to identify.
> >>
> >> Please tell me how to use DutchAnalzer in my application. Sample examp=
le
> >> or
> >> series of steps helps me.
> >>
> >> I also attached my index file(.java file).
> >>
> >> Please help me in this. please..
> >>
> >> Erick Erickson wrote:
> >> >
> >> > Take a look at DutchAnalyzer. The problem you'll have is if you're
> >> > indexing
> >> > this document along with a bunch of documents from other languages.
> >> > You could search the mail archive for extensive discussions of
> >> indexing/
> >> > searching documents from several languages.
> >> >
> >> > Best
> >> > Erick
> >> >
> >> > On Tue, Apr 21, 2009 at 2:40 AM, Uday Kumar Maddigatla
> >> > <ukma@mach.com>wrote:
> >> >
> >> >> HI,
> >> >>
> >> >>
> >> >>
> >> >> I'm new to the lucene. I downloaded lucene 2.4.1.
> >> >>
> >> >>
> >> >>
> >> >> I have one xml file which contains few special characters like '=E5=
',
> >> '=F8,'
> >> >> =B0'
> >> >> etc.(these are Danish language elements).
> >> >>
> >> >>
> >> >>
> >> >> How can I search these things.
> >> >>
> >> >>
> >> >>
> >> >>
> >> >>
> >> >> Uday Kumar  Reddy Maddigatla
> >> >>
> >> >> Software Engineer(Progrator|gatetrade)
> >> >>
> >> >> MACH India(Operations)
> >> >>
> >> >> Mobile: + 91-9963000377
> >> >>
> >> >> Uday.Maddigatla@ness.com <mailto:Uday.Maddigatla@ness.com>
> >> >>
> >> >> ukma@mach.com <mailto:ukma@mach.com>
> >> >>
> >> >> www.ness.com
> >> >>
> >> >>
> >> >>
> >> >>
> >> >>
> >> >>
> >> >
> >> >
> >>
> >> --
> >> View this message in context:
> >>
> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp231500=
39p23170710.html
> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> >
> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
> http://www.nabble.com/file/p23190583/SearchFiles.java SearchFiles.java
> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
> --
> View this message in context:
> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp231500=
39p23190583.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e647605215e63c046838f2be--

From java-user-return-39900-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 15:42:40 2009
Return-Path: <java-user-return-39900-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54429 invoked from network); 23 Apr 2009 15:42:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 15:42:40 -0000
Received: (qmail 66664 invoked by uid 500); 23 Apr 2009 15:42:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66599 invoked by uid 500); 23 Apr 2009 15:42:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66589 invoked by uid 99); 23 Apr 2009 15:42:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 15:42:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [62.213.161.134] (HELO pmx.sirma.bg) (62.213.161.134)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 15:42:29 +0000
X-Virus-Scanned: Sirma Antivirus System
Received: from [192.168.128.140] (ivasilev.sirma.int [192.168.128.140])
	by pmx.sirma.bg (Sirma mail system) with ESMTP id 8A762244C96
	for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 18:42:08 +0300 (EEST)
Message-ID: <49F08C50.20507@sirma.bg>
Date: Thu, 23 Apr 2009 18:42:08 +0300
From: Ivan Vasilev <ivasilev@sirma.bg>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: LUCENE MAIL LIST <java-user@lucene.apache.org>
Subject: SpanQuery wildcards?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hy Guys,

Does anybody knows if there is way to use wild cards in SpanQuery?
My idea is for example instead of query - content:"expansive 
computer"~10 - we to use query - content:"exp* comp*"~10. And the 
results of first query to be subset of those of second one.
I tried with parsing the above with different Analyzers but with no 
positive result. I also tried with different variants of SpanNearQuery 
but again with no result.

Is it possible at all?

Best Regards,
Ivan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39901-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 15:54:43 2009
Return-Path: <java-user-return-39901-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62549 invoked from network); 23 Apr 2009 15:54:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 15:54:43 -0000
Received: (qmail 92631 invoked by uid 500); 23 Apr 2009 15:54:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92585 invoked by uid 500); 23 Apr 2009 15:54:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92575 invoked by uid 99); 23 Apr 2009 15:54:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 15:54:41 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.18.82] (HELO smtp1.syr.edu) (128.230.18.82)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 15:54:32 +0000
Received: from suex07-hub-02.ad.syr.edu (suex07-hub-02.ad.syr.edu [128.230.108.196])
	by smtp1.syr.edu (8.14.3/8.14.3) with ESMTP id n3NFsANV002396
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=FAIL)
	for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 11:54:10 -0400
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-02.ad.syr.edu ([fe80::813b:49a2:a4d5:6367%10]) with mapi; Thu, 23
 Apr 2009 11:54:10 -0400
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Thu, 23 Apr 2009 11:54:08 -0400
Subject: RE: SpanQuery wildcards?
Thread-Topic: SpanQuery wildcards?
Thread-Index: AcnEKidjH3rmqF5VQO+zmpTo80YOQQAAMZ1A
Message-ID: <2D127F11DC79714E9B6A43AC9458147F13FCA440@suex07-mbx-03.ad.syr.edu>
References: <49F08C50.20507@sirma.bg>
In-Reply-To: <49F08C50.20507@sirma.bg>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.7400:2.4.4,1.2.40,4.0.166 definitions=2009-04-23_08:2009-04-23,2009-04-23,2009-04-23 signatures=0
X-Proofpoint-Spam-Reason: safe
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Ivan, SpanRegexQuery should work - just use ".*" instead of "*". - Steve

> -----Original Message-----
> From: Ivan Vasilev [mailto:ivasilev@sirma.bg]
> Sent: Thursday, April 23, 2009 11:42 AM
> To: LUCENE MAIL LIST
> Subject: SpanQuery wildcards?
>=20
> Hy Guys,
>=20
> Does anybody knows if there is way to use wild cards in SpanQuery?
> My idea is for example instead of query - content:"expansive
> computer"~10 - we to use query - content:"exp* comp*"~10. And the
> results of first query to be subset of those of second one.
> I tried with parsing the above with different Analyzers but with no
> positive result. I also tried with different variants of SpanNearQuery
> but again with no result.
>=20
> Is it possible at all?
>=20
> Best Regards,
> Ivan
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39902-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 16:12:37 2009
Return-Path: <java-user-return-39902-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75961 invoked from network); 23 Apr 2009 16:12:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 16:12:37 -0000
Received: (qmail 24967 invoked by uid 500); 23 Apr 2009 16:12:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24938 invoked by uid 500); 23 Apr 2009 16:12:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24928 invoked by uid 99); 23 Apr 2009 16:12:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 16:12:34 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [87.248.110.138] (HELO n21.bullet.mail.ukl.yahoo.com) (87.248.110.138)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 23 Apr 2009 16:12:23 +0000
Received: from [217.146.182.179] by n21.bullet.mail.ukl.yahoo.com with NNFMP; 23 Apr 2009 16:12:01 -0000
Received: from [87.248.110.107] by t5.bullet.ukl.yahoo.com with NNFMP; 23 Apr 2009 16:12:01 -0000
Received: from [127.0.0.1] by omp212.mail.ukl.yahoo.com with NNFMP; 23 Apr 2009 16:12:01 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 64061.91610.bm@omp212.mail.ukl.yahoo.com
Received: (qmail 35517 invoked by uid 60001); 23 Apr 2009 16:12:00 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1240503120; bh=5ARcuOAK4W5uhzxNsvN8qqP4TbmJ9FbUdaqSlgGwtsA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=ovmJhc6hWK33Oh0XZDh9fY6zRiK+I/j+XOBljE3SpsKZKMb14lwF1BDFqz+C3XhFM252RpoHv2WWuAqrWfNpSTFrzU3bl3ROUnq6pNBee0aAQl/xUqeNx5C0m6q+/bH1t3W6namsjJLTnyy/9BPz/3nnY8QlQsgK7RFa6RhZyMk=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=tynpQ59vLGj1R7laU+qR93KL7Lpo+G2nMu7v+BDUEB8kwQrohjZIPh4sfW4W2QxMUOhUNGvStqxKLp9MANVFXzYNZMLAFGtD8T+A8VIRqJU22DkK9NcmVIO1//CX18twAo8r0jCEHK51H01l+j07vYnZnge5RWy9wQl5gda1W0I=;
Message-ID: <808550.31183.qm@web24706.mail.ird.yahoo.com>
X-YMail-OSG: YXyWO6YVM1l2uN7HAF1eeyk5qGOoOJlNRdixxRnbPr2a3skNNPJfoNGpZXknEweVLkltoRtMfGG4dUrJ_xt9U9iwDIcuY_1fpiV49l.OjiexHazWep_EKkqFAgpfOEErcMop_3uRIgmN574xHMqRQQ7FLD_tY_5GoG9Q3xZH_EoroJ5qtGMON4PH5VsguTIOz4A4LmAqBcLLSinunSbKfkv9WPvE6sz_P9x.n6XvDYkdeWcVse3ZQaX8JwHRkAtETzTMtyAbniHKHAx5mk0svoxSdcyj1VopVZ359phAY0Ag4sm.ChvXkeOJCvWozNzmn8.Jlu7cnp4oK8mR0Imgk84-
Received: from [193.36.230.96] by web24706.mail.ird.yahoo.com via HTTP; Thu, 23 Apr 2009 09:11:57 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <49F08C50.20507@sirma.bg> <2D127F11DC79714E9B6A43AC9458147F13FCA440@suex07-mbx-03.ad.syr.edu>
Date: Thu, 23 Apr 2009 09:11:57 -0700 (PDT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: SpanQuery wildcards?
To: java-user@lucene.apache.org
In-Reply-To: <2D127F11DC79714E9B6A43AC9458147F13FCA440@suex07-mbx-03.ad.syr.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org


Related:  https://issues.apache.org/jira/browse/LUCENE-1486=0A=0A=0A=0A----=
- Original Message ----=0AFrom: Steven A Rowe <sarowe@syr.edu>=0ATo: "java-=
user@lucene.apache.org" <java-user@lucene.apache.org>=0ASent: Thursday, 23 =
April, 2009 16:54:08=0ASubject: RE: SpanQuery wildcards?=0A=0AHi Ivan, Span=
RegexQuery should work - just use ".*" instead of "*". - Steve=0A=0A> -----=
Original Message-----=0A> From: Ivan Vasilev [mailto:ivasilev@sirma.bg]=0A>=
 Sent: Thursday, April 23, 2009 11:42 AM=0A> To: LUCENE MAIL LIST=0A> Subje=
ct: SpanQuery wildcards?=0A> =0A> Hy Guys,=0A> =0A> Does anybody knows if t=
here is way to use wild cards in SpanQuery?=0A> My idea is for example inst=
ead of query - content:"expansive=0A> computer"~10 - we to use query - cont=
ent:"exp* comp*"~10. And the=0A> results of first query to be subset of tho=
se of second one.=0A> I tried with parsing the above with different Analyze=
rs but with no=0A> positive result. I also tried with different variants of=
 SpanNearQuery=0A> but again with no result.=0A> =0A> Is it possible at all=
?=0A> =0A> Best Regards,=0A> Ivan=0A> =0A> --------------------------------=
-------------------------------------=0A> To unsubscribe, e-mail: java-user=
-unsubscribe@lucene.apache.org=0A> For additional commands, e-mail: java-us=
er-help@lucene.apache.org=0A=0A=0A-----------------------------------------=
----------------------------=0ATo unsubscribe, e-mail: java-user-unsubscrib=
e@lucene.apache.org=0AFor additional commands, e-mail: java-user-help@lucen=
e.apache.org=0A=0A=0A      


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39903-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 18:13:56 2009
Return-Path: <java-user-return-39903-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52701 invoked from network); 23 Apr 2009 18:13:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 18:13:56 -0000
Received: (qmail 50493 invoked by uid 500); 23 Apr 2009 18:13:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50435 invoked by uid 500); 23 Apr 2009 18:13:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50425 invoked by uid 99); 23 Apr 2009 18:13:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 18:13:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [171.67.219.89] (HELO smtp-roam.stanford.edu) (171.67.219.89)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 18:13:44 +0000
Received: from smtp-roam.stanford.edu (localhost.localdomain [127.0.0.1])
	by localhost (Postfix) with SMTP id E243377A84
	for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 11:13:20 -0700 (PDT)
Received: from [192.168.1.100] (adsl-76-202-117-34.dsl.pltn13.sbcglobal.net [76.202.117.34])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: bethard)
	by smtp-roam.stanford.edu (Postfix) with ESMTPSA id 3622F77941
	for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 11:13:20 -0700 (PDT)
Message-ID: <49F0AFBB.3050905@stanford.edu>
Date: Thu, 23 Apr 2009 11:13:15 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Why is CustomScoreQuery limited to ValueSourceQuery type?
References: <49E91253.4030506@stanford.edu>	 <e05f0fd10904210047m218a0628wf57070729841e2a9@mail.gmail.com>	 <49EDFB49.60908@stanford.edu>	 <e05f0fd10904211009u4996bccer52b4f7fd9ef7dceb@mail.gmail.com>	 <49EE519C.70402@stanford.edu> <e05f0fd10904221426q32beedd8q3b485a769b2706c@mail.gmail.com>
In-Reply-To: <e05f0fd10904221426q32beedd8q3b485a769b2706c@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On 4/22/2009 2:26 PM, Doron Cohen wrote:
> Steve, I added a patch in https://issues.apache.org/jira/browse/LUCENE-1608,
> 
> which allows to wrap any query in a value source, and then create a value
> source query out of it.
> Let us know how this works for you...

Thanks! I'll try this out in the next few days and let you know how it goes.

Steve

> On Wed, Apr 22, 2009 at 2:07 AM, Steven Bethard <bethard@stanford.edu>wrote:
> 
>> On 4/21/2009 10:09 AM, Doron Cohen wrote:
>>> It could, but (historically and) currently it doesn't... :)
>>> I actually have code for this.
>>> Would you like open a JIRA issue for this - I'll attach my wrapper there?
>> Done.
>>
>> https://issues.apache.org/jira/browse/LUCENE-1608
>>
>> Steve
>>
>>> On Tue, Apr 21, 2009 at 7:58 PM, Steven Bethard <bethard@stanford.edu
>>> wrote:
>>>
>>>> On 4/21/2009 12:47 AM, Doron Cohen wrote:
>>>>> CustomScoreQuery expects the VSQs to have a score for document matching
>>>> the
>>>>> (main) subQuery - this does not hold for arbitrary queries.
>>>> Sure, but it could easily assign 0.0 scores for sub-queries that didn't
>>>> match, no?
>>>>
>>>> Steve
>>>>
>>>>> On Sat, Apr 18, 2009 at 2:35 AM, Steven Bethard <bethard@stanford.edu
>>>>> wrote:
>>>>>
>>>>>> CustomScoreQuery only allows the secondary queries to be of type
>>>>>> ValueSourceQuery instead of allowing them to be any type of Query. Why
>>>>>> is that? Is there something that makes it hard to implement for
>>>>>> arbitrary queries?
>>>>>>
>>>>>> Steve
>>>>>>
>>>>>> P.S. I played around with this briefly, and simply replacing all
>>>>>> ValueSourceQuery references with Query references yields only one
>> simple
>>>>>> compile error, where ValueSourceQuery.createWeight() is being used
>>>>>> instead of Query.weight() for some reason.
>>
>>
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39904-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 19:26:45 2009
Return-Path: <java-user-return-39904-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93408 invoked from network); 23 Apr 2009 19:26:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 19:26:45 -0000
Received: (qmail 59803 invoked by uid 500); 23 Apr 2009 19:26:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59728 invoked by uid 500); 23 Apr 2009 19:26:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59718 invoked by uid 99); 23 Apr 2009 19:26:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 19:26:42 +0000
X-ASF-Spam-Status: No, hits=2.4 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [65.55.88.12] (HELO TX2EHSOBE004.bigfish.com) (65.55.88.12)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 19:26:30 +0000
Received: from mail164-tx2-R.bigfish.com (10.9.14.247) by
 TX2EHSOBE004.bigfish.com (10.9.40.24) with Microsoft SMTP Server id
 8.1.340.0; Thu, 23 Apr 2009 19:26:07 +0000
Received: from mail164-tx2 (localhost.localdomain [127.0.0.1])	by
 mail164-tx2-R.bigfish.com (Postfix) with ESMTP id EAB487C84B0	for
 <java-user@lucene.apache.org>; Thu, 23 Apr 2009 19:26:07 +0000 (UTC)
X-BigFish: VPS-3(zz1803O14c3M936eQ9058uzz1202hzz43bkz2dh6bh43j)
Received: by mail164-tx2 (MessageSwitch) id 1240514760664508_25546; Thu, 23
 Apr 2009 19:26:00 +0000 (UCT)
Received: from us-voo-smtp05.internal.sungard.corp (unknown [216.83.166.46])
	(using TLSv1 with cipher RC4-MD5 (128/128 bits))	(No client certificate
 requested)	by mail164-tx2.bigfish.com (Postfix) with ESMTP id 75A132A8070	for
 <java-user@lucene.apache.org>; Thu, 23 Apr 2009 19:25:34 +0000 (UTC)
Received: from us-voo-smtp11.internal.sungard.corp ([168.162.128.53]) by
 us-voo-smtp05.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 15:25:33 -0400
Received: from VOO-EXCHANGE08.internal.sungard.corp ([168.162.128.69]) by
 us-voo-smtp11.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 15:25:32 -0400
Received: from VOO-EXCHANGE04.internal.sungard.corp ([168.162.128.66]) by
 VOO-EXCHANGE08.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 15:25:32 -0400
X-MIMEOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C9C449.34EDABCA"
Subject: Error: there are more terms than documents...
Date: Thu, 23 Apr 2009 15:25:04 -0400
Message-ID: <036829964E44B44F80A0D168BB9849E1018C61FA@VOO-EXCHANGE04.internal.sungard.corp>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: Error: there are more terms than documents...
Thread-Index: AcnESTRfesxt77WSSKmNaGdkgPRVPA==
From: <Bill.Chesky@sungard.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 23 Apr 2009 19:25:32.0279 (UTC) FILETIME=[44CE3070:01C9C449]
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C9C449.34EDABCA
Content-Type: text/plain; charset="US-ASCII"
Content-Transfer-Encoding: quoted-printable

Hello,

=20

I'm getting a strange error when I make a Lucene (2.2.0) query w/ the
following call:

=20

java.lang.RuntimeException: there are more terms than documents in field
"objectId", but it's impossible to sort on tokenized fields

      at
org.apache.lucene.search.FieldCacheImpl$10.createValue(FieldCacheImpl.ja
va:377)

      at
org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:72
)

      at
org.apache.lucene.search.FieldCacheImpl.getStringIndex(FieldCacheImpl.ja
va:350)

      at
org.apache.lucene.search.FieldCacheImpl$11.createValue(FieldCacheImpl.ja
va:461)

      at
org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:72
)

      at
org.apache.lucene.search.FieldCacheImpl.getAuto(FieldCacheImpl.java:424)

      at
org.apache.lucene.search.FieldSortedHitQueue.comparatorAuto(FieldSortedH
itQueue.java:338)

      at
org.apache.lucene.search.FieldSortedHitQueue$1.createValue(FieldSortedHi
tQueue.java:172)

      at
org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:72
)

      at
org.apache.lucene.search.FieldSortedHitQueue.getCachedComparator(FieldSo
rtedHitQueue.java:155)

      at
org.apache.lucene.search.FieldSortedHitQueue.<init>(FieldSortedHitQueue.
java:56)

      at
org.apache.lucene.search.TopFieldDocCollector.<init>(TopFieldDocCollecto
r.java:41)

      at
org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:122)

      at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:74)

      at org.apache.lucene.search.Hits.<init>(Hits.java:61)

      at org.apache.lucene.search.Searcher.search(Searcher.java:55)

=20

The strange thing is that I've read the javadoc for the Sort object
where it says:

The fields used to determine sort order must be carefully chosen.
Documents must contain a single term in such a field, and the value of
the term should indicate the document's relative position in a given
sort order. The field must be indexed, but should not be tokenized, and
does not need to be stored (unless you happen to want it back with the
rest of your document data). In other words:=20

document.add (new Field ("byNumber", Integer.toString(x),
Field.Store.NO, Field.Index.UN_TOKENIZED));

Therefore when I create my "objectId" field in my document I use the
call:

=20

doc.add(new Field("objectId", s.getObjectId(), Field.Store.NO,
Field.Index.UN_TOKENIZED));

=20

Note: s.getObjectId() returns a String.

=20

After the index is created and I print out a typical document (using the
Document.toString() method) I get this:

=20

Document<stored/uncompressed,indexed

<id:1146513> stored/uncompressed,indexed

<_hibernate_class:com.mycompany.metadb.orm.Series> indexed

<RestrictionLevel:1> indexed,

tokenized<keywords:com.mycompany.metadbsync.index.SeriesTokenStream@134a
b4e> indexed,

tokenized<characteristics:com.
mycompany.metadbsync.index.CharacteristicTokenStream@daa825> indexed

<objectId:DF.SES.AA.derek.Public_01> indexed

<Name:Public 01> indexed

<UserID:derek> indexed

<Data Class:Defined Formulas> indexed

<Location:AA> indexed

<Client:SES> indexed

<DIM1:DF> indexed

<DIM2:SES> indexed

<DIM3:AA> indexed

<DIM4:derek> indexed

<DIM5:Public_01> indexed

<Type:Formula>>

=20

So it looks like it got created correctly.

=20

For what it's worth the query call looks like this:

=20

Hits hits =3D seriesIndexSearcher.search(query, new Sort("objectId"));

=20

The actual query is a Boolean query with lots of TermQuery clauses and
sub clauses.  The term queries are against various of the other fields
shown above, including some of the tokenized fields. =20

 =20

Any help appreciated.

=20

regards,

=20

Bill Chesky

=20

PS. Just as an aside, what does it mean for a field to be stored or not
stored.  Looking at the output above, the 'id' field is stored and the
'objectId' is not.  Yet both of them get displayed by the
Document.toString() method.  So even the objectId field got "stored" at
least in the sense that I understand the term (otherwise how did it get
displayed) so I'm obviously missing something about what "stored" means
in the Lucene context.

=20


------_=_NextPart_001_01C9C449.34EDABCA--

From java-user-return-39905-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 19:41:50 2009
Return-Path: <java-user-return-39905-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98633 invoked from network); 23 Apr 2009 19:41:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 19:41:50 -0000
Received: (qmail 87449 invoked by uid 500); 23 Apr 2009 19:41:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87379 invoked by uid 500); 23 Apr 2009 19:41:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87368 invoked by uid 99); 23 Apr 2009 19:41:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 19:41:48 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [207.46.51.80] (HELO SG2EHSOBE003.bigfish.com) (207.46.51.80)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 19:41:38 +0000
Received: from mail91-sin-R.bigfish.com (10.3.40.3) by
 SG2EHSOBE003.bigfish.com (10.3.40.23) with Microsoft SMTP Server id
 8.1.340.0; Thu, 23 Apr 2009 19:41:16 +0000
Received: from mail91-sin (localhost.localdomain [127.0.0.1])	by
 mail91-sin-R.bigfish.com (Postfix) with ESMTP id 4902611A81E4	for
 <java-user@lucene.apache.org>; Thu, 23 Apr 2009 19:41:16 +0000 (UTC)
X-BigFish: VPS-3(zz1803O14c3M936eQ9058uzz1202hzz43bkz2dh6bh43j62h)
X-Spam-TCS-SCL: 1:0
Received: by mail91-sin (MessageSwitch) id 1240515674956404_28653; Thu, 23 Apr
 2009 19:41:14 +0000 (UCT)
Received: from us-voo-smtp04.internal.sungard.corp (unknown [216.83.166.45])
	(using TLSv1 with cipher RC4-MD5 (128/128 bits))	(No client certificate
 requested)	by mail91-sin.bigfish.com (Postfix) with ESMTP id 4AD801528046	for
 <java-user@lucene.apache.org>; Thu, 23 Apr 2009 19:41:13 +0000 (UTC)
Received: from us-voo-smtp11.internal.sungard.corp ([168.162.128.53]) by
 us-voo-smtp04.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 15:40:48 -0400
Received: from VOO-EXCHANGE07.internal.sungard.corp ([168.162.128.75]) by
 us-voo-smtp11.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 15:40:47 -0400
Received: from VOO-EXCHANGE04.internal.sungard.corp ([168.162.128.66]) by
 VOO-EXCHANGE07.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 15:40:46 -0400
X-MIMEOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="US-ASCII"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Error: there are more terms than documents...
Date: Thu, 23 Apr 2009 15:39:56 -0400
Message-ID: <036829964E44B44F80A0D168BB9849E1018C6212@VOO-EXCHANGE04.internal.sungard.corp>
In-Reply-To: <036829964E44B44F80A0D168BB9849E1018C61FA@VOO-EXCHANGE04.internal.sungard.corp>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: Error: there are more terms than documents...
Thread-Index: AcnESTRfesxt77WSSKmNaGdkgPRVPAAAYbGA
From: <Bill.Chesky@sungard.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 23 Apr 2009 19:40:46.0194 (UTC) FILETIME=[658A8D20:01C9C44B]
X-Virus-Checked: Checked by ClamAV on apache.org

Sorry for that terrible formatting.  Let me try again.
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D
Hello,

I'm getting a strange error when I make a Lucene (2.2.0) query:

java.lang.RuntimeException: there are more terms than documents in field
"objectId", but it's impossible to sort on tokenized fields

The strange thing is that I've read the javadoc for the Sort object
where it says:

=3D=3D=3D=3D
The fields used to determine sort order must be carefully chosen.
Documents must contain a single term in such a field, and the value of
the term should indicate the document's relative position in a given
sort order. The field must be indexed, but should not be tokenized, and
does not need to be stored (unless you happen to want it back with the
rest of your document data). In other words:=20

document.add (new Field ("byNumber", Integer.toString(x),
Field.Store.NO, Field.Index.UN_TOKENIZED));
=3D=3D=3D=3D

Therefore when I create my "objectId" field in my document I use the
call:

doc.add(new Field("objectId", s.getObjectId(), Field.Store.NO,
Field.Index.UN_TOKENIZED));

Note: s.getObjectId() returns a String.

After the index is created and I print out a typical document (using the
Document.toString() method) I get this:

Document<stored/uncompressed,indexed
<id:1146513> stored/uncompressed,indexed
<_hibernate_class:com.mycompany.metadb.orm.Series> indexed
<RestrictionLevel:1> indexed,
tokenized<keywords:com.mycompany.metadbsync.index.SeriesTokenStream@134a
b4e> indexed,
tokenized<characteristics:com.
mycompany.metadbsync.index.CharacteristicTokenStream@daa825> indexed
<objectId:DF.SES.AA.derek.Public_01> indexed
<Name:Public 01> indexed
<UserID:derek> indexed
<Data Class:Defined Formulas> indexed
<Location:AA> indexed
<Client:SES> indexed
<DIM1:DF> indexed
<DIM2:SES> indexed
<DIM3:AA> indexed
<DIM4:derek> indexed
<DIM5:Public_01> indexed
<Type:Formula>>

So it looks like it got created correctly.

For what it's worth the query call looks like this:

Hits hits =3D seriesIndexSearcher.search(query, new Sort("objectId"));

The actual query is a Boolean query with lots of TermQuery clauses and
sub clauses.  The term queries are against various of the other fields
shown above, including some of the tokenized fields. =20

Any help appreciated.

regards,

Bill Chesky

PS. Just as an aside, what does it mean for a field to be stored or not
stored.  Looking at the output above, the 'id' field is stored and the
'objectId' is not.  Yet both of them get displayed by the
Document.toString() method.  So even the objectId field got "stored" at
least in the sense that I understand the term (otherwise how did it get
displayed) so I'm obviously missing something about what "stored" means
in the Lucene context.

=20



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39906-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 20:01:28 2009
Return-Path: <java-user-return-39906-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6932 invoked from network); 23 Apr 2009 20:01:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 20:01:28 -0000
Received: (qmail 28616 invoked by uid 500); 23 Apr 2009 20:01:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28537 invoked by uid 500); 23 Apr 2009 20:01:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28527 invoked by uid 99); 23 Apr 2009 20:01:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:01:25 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of cdoronc@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:01:17 +0000
Received: by ewy27 with SMTP id 27so760368ewy.5
        for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 13:00:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=wHXL1PnyCxS959J9Hj+M9KedjPR49YyxOPMpD8jD3g0=;
        b=UgqVuc8lJKkEgCKuWv6hclL5m/7F/rrkUcYkeh2ygs+7cygOfKyWmJ80WhCIGidz5c
         Vn2Gt5KUnNfZGKfOXghwVBT677Glq0/X2D69YBMSZSt3c2fsLrXcI/Qmwp8BTOpcoTNX
         hoY99FC0bjWoZNdZkSuaNw/i1WrmKcaPMf0EU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ijB1MaJdJaxhftr60P55rcm1G0qbyMq5Pq+UJEzRhNV73VwDgitl3X6nTaHPGAEehj
         hwGG7PKAag56mhyDO5FA2Y1c53jA8kiKBgH6UE8v27In8uc61WYvtbjNc5NDdveHCCeN
         sR2iwC6mLF5UfQGNUwMoWJqi/noG0eCYW+AgE=
MIME-Version: 1.0
Received: by 10.210.10.8 with SMTP id 8mr1447842ebj.13.1240516857480; Thu, 23 
	Apr 2009 13:00:57 -0700 (PDT)
In-Reply-To: <036829964E44B44F80A0D168BB9849E1018C6212@VOO-EXCHANGE04.internal.sungard.corp>
References: <036829964E44B44F80A0D168BB9849E1018C61FA@VOO-EXCHANGE04.internal.sungard.corp>
	 <036829964E44B44F80A0D168BB9849E1018C6212@VOO-EXCHANGE04.internal.sungard.corp>
Date: Thu, 23 Apr 2009 23:00:57 +0300
Message-ID: <e05f0fd10904231300u7cadf7c3pe559d1c0ce2dd93c@mail.gmail.com>
Subject: Re: Error: there are more terms than documents...
From: Doron Cohen <cdoronc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174bde46a0c77d04683e560a
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174bde46a0c77d04683e560a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

On Thu, Apr 23, 2009 at 10:39 PM, <Bill.Chesky@sungard.com> wrote:

> I'm getting a strange error when I make a Lucene (2.2.0) query:
>
> java.lang.RuntimeException: there are more terms than documents in field
> "objectId", but it's impossible to sort on tokenized fields
>

Is it possible that, for at least one document, multiple "objectId" fields
were created?
This would also create this problem.

PS. Just as an aside, what does it mean for a field to be stored or not
> stored.  Looking at the output above, the 'id' field is stored and the
> 'objectId' is not.  Yet both of them get displayed by the
> Document.toString() method.  So even the objectId field got "stored" at
> least in the sense that I understand the term (otherwise how did it get
> displayed) so I'm obviously missing something about what "stored" means
> in the Lucene context.
>

The printed document object is the same document object that was created
for indexing. But when a document is read from the index (via IndexReader
API)
it will only contain the stored fields. For instance, assume that at search
time you
would like to get the URL of a result document and display it to the user.
For this
you can at indexing time add the URL to a stored field.

Doron

--0015174bde46a0c77d04683e560a--

From java-user-return-39907-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 20:02:35 2009
Return-Path: <java-user-return-39907-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7122 invoked from network); 23 Apr 2009 20:02:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 20:02:35 -0000
Received: (qmail 30583 invoked by uid 500); 23 Apr 2009 20:02:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30459 invoked by uid 500); 23 Apr 2009 20:02:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30412 invoked by uid 99); 23 Apr 2009 20:02:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:02:31 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.218.179] (HELO mail-bw0-f179.google.com) (209.85.218.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:02:20 +0000
Received: by bwz27 with SMTP id 27so810307bwz.5
        for <multiple recipients>; Thu, 23 Apr 2009 13:01:59 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.223.112.202 with SMTP id x10mr429828fap.68.1240516918620; Thu, 
	23 Apr 2009 13:01:58 -0700 (PDT)
Date: Thu, 23 Apr 2009 22:01:58 +0200
Message-ID: <7e536b1f0904231301u3e251b6ayb266086f09cff4ad@mail.gmail.com>
Subject: Change boost of documents / single fields / external scoring ?
From: Marcus Herou <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org, solr-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c599a345b23804683e5ade
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c599a345b23804683e5ade
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi.

Confusing subject eh ? Trying to become a little clearer in a few sentences.

We have a Solr/Lucene index where each document is a Blog Entry. We have
just implemented the PageRank algorithm for Blogs and are about to add a
column to the index called score and perhaps adjust the document boost.

We have as well decided that it is the blog itself and not the individual
pages that are to be ranked so all entries belonging to one blog will
receive the same score.

I have not found a way to apply a document score without actually
re-indexing all fields in the affected entries (could very well be 100% at
every PageRank recalculation) and this will of course take hell of a long
time to reindex which effectively will render the process useless since it
would take a week or of reindexing as of current and will take more and more
time. (100M blog entries as of current and rapidly increasing).

Guess we have run into the issue where we have some "static" data which we
do not want to touch at all but we want to update certain "dynamic" fields.

Lucene is not a database I know but is there a way to implement external
search-time scoring or update individual fields ? Would there be a
possibilty to do some kind of join (parallell searches separate index types)
? or send the result to a separate sorting algorithm ? Hmmm.... Perhaps a
subclass of Sort ? Grasping at straws here folks...

Hope anyone of the core experts can help us.

Cheers

//Marcus Herou



-- 
Marcus Herou CTO and co-founder Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com/
http://blogg.tailsweep.com/

--001636c599a345b23804683e5ade--

From java-user-return-39908-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 20:31:13 2009
Return-Path: <java-user-return-39908-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16380 invoked from network); 23 Apr 2009 20:31:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 20:31:12 -0000
Received: (qmail 79844 invoked by uid 500); 23 Apr 2009 20:31:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79745 invoked by uid 500); 23 Apr 2009 20:31:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79725 invoked by uid 99); 23 Apr 2009 20:31:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:31:08 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.218.179] (HELO mail-bw0-f179.google.com) (209.85.218.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:30:57 +0000
Received: by bwz27 with SMTP id 27so824984bwz.5
        for <multiple recipients>; Thu, 23 Apr 2009 13:30:36 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.223.103.133 with SMTP id k5mr499949fao.23.1240518636544; Thu, 
	23 Apr 2009 13:30:36 -0700 (PDT)
In-Reply-To: <7e536b1f0904231301u3e251b6ayb266086f09cff4ad@mail.gmail.com>
References: <7e536b1f0904231301u3e251b6ayb266086f09cff4ad@mail.gmail.com>
Date: Thu, 23 Apr 2009 22:30:36 +0200
Message-ID: <7e536b1f0904231330k38bd7269h25634ee405219058@mail.gmail.com>
Subject: Re: Change boost of documents / single fields / external scoring ?
From: Marcus Herou <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org, solr-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c5a758ab27ab04683ec08f
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5a758ab27ab04683ec08f
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Could an ExternalFileField help me ?
http://lucene.apache.org/solr/api/org/apache/solr/schema/ExternalFileField.html

On Thu, Apr 23, 2009 at 10:01 PM, Marcus Herou
<marcus.herou@tailsweep.com>wrote:

> Hi.
>
> Confusing subject eh ? Trying to become a little clearer in a few
> sentences.
>
> We have a Solr/Lucene index where each document is a Blog Entry. We have
> just implemented the PageRank algorithm for Blogs and are about to add a
> column to the index called score and perhaps adjust the document boost.
>
> We have as well decided that it is the blog itself and not the individual
> pages that are to be ranked so all entries belonging to one blog will
> receive the same score.
>
> I have not found a way to apply a document score without actually
> re-indexing all fields in the affected entries (could very well be 100% at
> every PageRank recalculation) and this will of course take hell of a long
> time to reindex which effectively will render the process useless since it
> would take a week or of reindexing as of current and will take more and more
> time. (100M blog entries as of current and rapidly increasing).
>
> Guess we have run into the issue where we have some "static" data which we
> do not want to touch at all but we want to update certain "dynamic" fields.
>
> Lucene is not a database I know but is there a way to implement external
> search-time scoring or update individual fields ? Would there be a
> possibilty to do some kind of join (parallell searches separate index types)
> ? or send the result to a separate sorting algorithm ? Hmmm.... Perhaps a
> subclass of Sort ? Grasping at straws here folks...
>
> Hope anyone of the core experts can help us.
>
> Cheers
>
> //Marcus Herou
>
>
>
> --
> Marcus Herou CTO and co-founder Tailsweep AB
> +46702561312
> marcus.herou@tailsweep.com
> http://www.tailsweep.com/
> http://blogg.tailsweep.com/
>



-- 
Marcus Herou CTO and co-founder Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com/
http://blogg.tailsweep.com/

--001636c5a758ab27ab04683ec08f--

From java-user-return-39909-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 20:32:39 2009
Return-Path: <java-user-return-39909-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16612 invoked from network); 23 Apr 2009 20:32:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 20:32:39 -0000
Received: (qmail 83697 invoked by uid 500); 23 Apr 2009 20:32:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83617 invoked by uid 500); 23 Apr 2009 20:32:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83607 invoked by uid 99); 23 Apr 2009 20:32:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:32:36 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [213.199.154.16] (HELO IE1EHSOBE006.bigfish.com) (213.199.154.16)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:32:27 +0000
Received: from mail11-dub-R.bigfish.com (10.5.252.3) by
 IE1EHSOBE006.bigfish.com (10.5.252.26) with Microsoft SMTP Server id
 8.1.340.0; Thu, 23 Apr 2009 20:32:03 +0000
Received: from mail11-dub (localhost.localdomain [127.0.0.1])	by
 mail11-dub-R.bigfish.com (Postfix) with ESMTP id 038DA348084	for
 <java-user@lucene.apache.org>; Thu, 23 Apr 2009 20:32:04 +0000 (UTC)
X-BigFish: VPS-23(zz1432R1447R1805Mzz1202hzzz2dh6bh43j62h)
X-Spam-TCS-SCL: 1:0
Received: by mail11-dub (MessageSwitch) id 1240518721455932_31268; Thu, 23 Apr
 2009 20:32:01 +0000 (UCT)
Received: from us-voo-smtp04.internal.sungard.corp (unknown [216.83.166.45])
	(using TLSv1 with cipher RC4-MD5 (128/128 bits))	(No client certificate
 requested)	by mail11-dub.bigfish.com (Postfix) with ESMTP id 3236B12C804E	for
 <java-user@lucene.apache.org>; Thu, 23 Apr 2009 20:32:01 +0000 (UTC)
Received: from us-voo-smtp12.internal.sungard.corp ([168.162.128.54]) by
 us-voo-smtp04.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 16:31:48 -0400
Received: from VOO-EXCHANGE06.internal.sungard.corp ([168.162.128.74]) by
 us-voo-smtp12.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 16:31:48 -0400
Received: from VOO-EXCHANGE04.internal.sungard.corp ([168.162.128.66]) by
 VOO-EXCHANGE06.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 16:31:33 -0400
X-MIMEOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="US-ASCII"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Error: there are more terms than documents...
Date: Thu, 23 Apr 2009 16:31:04 -0400
Message-ID: <036829964E44B44F80A0D168BB9849E1018C624B@VOO-EXCHANGE04.internal.sungard.corp>
In-Reply-To: <e05f0fd10904231300u7cadf7c3pe559d1c0ce2dd93c@mail.gmail.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: Error: there are more terms than documents...
Thread-Index: AcnETlAO8TAZH58/RMys91dVvLCNLgAARmlg
From: <Bill.Chesky@sungard.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 23 Apr 2009 20:31:33.0541 (UTC) FILETIME=[7DE6CD50:01C9C452]
X-Virus-Checked: Checked by ClamAV on apache.org

Doron, thanks for the reply.

> Is it possible that, for at least one document, multiple "objectId"
fields
> were created?
> This would also create this problem.

I read that online as well.  I don't think so.  We do have an update
process that updates the index.  During the update process we have the
call:

// create new doc object ... objectId will always be the same as before
but // other fields may change
Document doc =3D getDocument(s); =20
// replace old doc for objectId w/ new
indexWriter.updateDocument(new Term("objectId", s.getObjectId()), doc);

However, the getDocument() method is the same method that we use to
create a brand new document when building the index from scratch.  And
I'm sure we only create the "objectId" field once in that method. =20

Unless maybe I'm misunderstanding something about the
IndexWriter.updateDocument() method.  I thought it would delete all
documents that matched the Term passed and add a new one.

Unless maybe there is an issue with my Term argument passed to
updateDocument and it's really not matching the way I think it is and so
we end of with two different documents with the same value in the
"objectId" field.  Could this situation cause the exception?

> The printed document object is the same document object that was
created
> for indexing. But when a document is read from the index (via
IndexReader
> API)
> it will only contain the stored fields. For instance, assume that at
search
> time you would like to get the URL of a result document and display it
to the user.
> For this
> you can at indexing time add the URL to a stored field.
>
> Doron

Ah I think I understand.  I was printing those docs out as I stored
them.  That makes total sense now.  Thanks for the help.

regards,

Bill


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39910-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 20:39:17 2009
Return-Path: <java-user-return-39910-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20903 invoked from network); 23 Apr 2009 20:39:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 20:39:17 -0000
Received: (qmail 4693 invoked by uid 500); 23 Apr 2009 20:39:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4662 invoked by uid 500); 23 Apr 2009 20:39:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4652 invoked by uid 99); 23 Apr 2009 20:39:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:39:15 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.218.179] (HELO mail-bw0-f179.google.com) (209.85.218.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:39:06 +0000
Received: by bwz27 with SMTP id 27so828746bwz.5
        for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 13:38:43 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.223.114.68 with SMTP id d4mr454920faq.86.1240519123343; Thu, 
	23 Apr 2009 13:38:43 -0700 (PDT)
In-Reply-To: <49E23210.5000209@stanford.edu>
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>
	 <49E23210.5000209@stanford.edu>
Date: Thu, 23 Apr 2009 22:38:43 +0200
Message-ID: <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>
Subject: Re: exponential boosts
From: Marcus Herou <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org, bethard@stanford.edu
Content-Type: multipart/alternative; boundary=001636c5b184af1a4904683eddbe
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5b184af1a4904683eddbe
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi.

I think we are doing similar things, at least I am trying to implement
document boosting with pagerank. Having issues of howto appky the scoring of
specific docs without actually reindex them. I feel something should be done
at query time which looks at external data but do not know howto implement
that. Do you ?

Kindly

//Marcus



On Sun, Apr 12, 2009 at 8:25 PM, Steven Bethard <bethard@stanford.edu>wrote:

> On 4/10/2009 5:13 PM, Steven Bethard wrote:
> > On 4/10/2009 12:56 PM, Steven Bethard wrote:
> >> I need to have a scoring model of the form:
> >>
> >>     s1(d, q)^a1 * s2(d, q)^a2 * ... * sN(d, q)^aN
> >>
> >> where "d" is a document, "q" is a query, "sK" is a scoring function, and
> >> "aK" is the exponential boost factor for that scoring function.
> [snip]
> > My third thought was to create a wrapper class that takes a Query and an
> > exponential boost factor. The wrapper class would delegate to the Query
> > for all methods except .weight(). For .weight(), it would return a
> > Weight wrapper that delegated to the Weight for all methods except
> > .getValue(). For .getValue(), it would return the original value, raised
> > to the appropriate exponent. But will that really work, or am I going to
> > mess up the normalization or something else?
>
> I've started playing around with this route. I'm not 100% sure I've
> implemented all the Query and Weight methods correctly (the
> documentation for these is pretty terse), but assuming I have it right,
> that should give me the ability to create the "s(d, q)^a" terms, by just
> coming up with a Query for each term, and then wrapping it in my wrapper
> class to add the exponential boost.
>
> So to finish up the scoring, I want to create a Query that takes all the
> sub-queries and just multiplies their scores together. This seems like
> something Lucene must already be doing somewhere. I looked at
> BooleanQuery hoping maybe that was already doing something like this,
> but BooleanWeight.getValue() just seems to return the boost factor, so I
> guess not.
>
> So does anyone know of an existing Query class that will simply multiply
> its sub-queries together?
>
> More generally, is there any other documentation about Lucene's scoring
> mechanisms than the following? There isn't quite enough detail (or I
> don't know how to read it) to answer my questions here.
>
> http://lucene.apache.org/java/2_4_1/scoring.html
>
> http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/package-summary.html
>
> Also, I seem to have gotten very little response to my questions here,
> perhaps because they are asking about the expert interfaces? Is there a
> better place to ask such questions?
>
> Thanks,
>
> Steve
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Marcus Herou CTO and co-founder Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com/
http://blogg.tailsweep.com/

--001636c5b184af1a4904683eddbe--

From java-user-return-39912-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 20:58:56 2009
Return-Path: <java-user-return-39912-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28946 invoked from network); 23 Apr 2009 20:58:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 20:58:56 -0000
Received: (qmail 41225 invoked by uid 500); 23 Apr 2009 20:58:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41146 invoked by uid 500); 23 Apr 2009 20:58:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41136 invoked by uid 99); 23 Apr 2009 20:58:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:58:54 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cdoronc@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:58:47 +0000
Received: by fg-out-1718.google.com with SMTP id e12so67364fga.4
        for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 13:58:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=grfpz7Tbf0ce/bx+HGAKmxwvsDtNLSJE7yzzCUUr6fc=;
        b=ommJ2ZF1FlChfPzPO4BayLkl9I5TWDVgb39jdJLJQ/iWsQcw4Wt54pcHA67GxyYSgX
         2dECdwAfOcQoUIq0SvMcQj3RmeyfLqlmvs/rN7rJi4Un1Y3srR7/lefx89vltBOfJJXQ
         1EFiyF6k6U69YaCXvP62szH2gNpQZXLmBWDEs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=OpRyXTQ7LCFXY7ynfC32bGQ6mwRpOgZBpFX/xzz8RUYSnajxk3VY0+V/D9sfVQBak0
         Jm0vhpY0O3E8pKs1sR2EDgP1gRvgZoBkgbwdIVDbKn4SNAucQr/Ew1HF13pitoMpFxH+
         +rPawyMhFSIpb9FZxZjWW+JE6AGLnCJKda7LA=
MIME-Version: 1.0
Received: by 10.86.82.6 with SMTP id f6mr444583fgb.77.1240520306049; Thu, 23 
	Apr 2009 13:58:26 -0700 (PDT)
In-Reply-To: <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>
	 <49E23210.5000209@stanford.edu>
	 <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>
Date: Thu, 23 Apr 2009 23:58:26 +0300
Message-ID: <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>
Subject: Re: exponential boosts
From: Doron Cohen <cdoronc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd298442dc19d04683f2475
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd298442dc19d04683f2475
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

>
> I think we are doing similar things, at least I am trying to implement
> document boosting with pagerank. Having issues of howto appky the scoring
> of
> specific docs without actually reindex them. I feel something should be
> done
> at query time which looks at external data but do not know howto implement
> that. Do you ?
>

Have you considered CustomScoreQuery in o.a.l.search.function ? It should
allow
incorporating external scores.

Doron

--000e0cd298442dc19d04683f2475--

From java-user-return-39911-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 21:02:26 2009
Return-Path: <java-user-return-39911-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31039 invoked from network); 23 Apr 2009 21:02:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 21:02:26 -0000
Received: (qmail 29465 invoked by uid 500); 23 Apr 2009 20:55:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29377 invoked by uid 500); 23 Apr 2009 20:55:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29367 invoked by uid 99); 23 Apr 2009 20:55:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:55:05 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [213.199.154.16] (HELO IE1EHSOBE003.bigfish.com) (213.199.154.16)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 20:54:55 +0000
Received: from mail30-dub-R.bigfish.com (10.5.252.3) by
 IE1EHSOBE003.bigfish.com (10.5.252.23) with Microsoft SMTP Server id
 8.1.340.0; Thu, 23 Apr 2009 20:54:34 +0000
Received: from mail30-dub (localhost.localdomain [127.0.0.1])	by
 mail30-dub-R.bigfish.com (Postfix) with ESMTP id C66FF1B08155	for
 <java-user@lucene.apache.org>; Thu, 23 Apr 2009 20:54:33 +0000 (UTC)
X-BigFish: VPS-8(zz1447Rzz1202hzzz2dh6bh43j61h)
X-Spam-TCS-SCL: 0:0
Received: by mail30-dub (MessageSwitch) id 1240520072595408_21768; Thu, 23 Apr
 2009 20:54:32 +0000 (UCT)
Received: from us-voo-smtp04.internal.sungard.corp (unknown [216.83.166.45])
	(using TLSv1 with cipher RC4-MD5 (128/128 bits))	(No client certificate
 requested)	by mail30-dub.bigfish.com (Postfix) with ESMTP id 5C6E41008054	for
 <java-user@lucene.apache.org>; Thu, 23 Apr 2009 20:54:29 +0000 (UTC)
Received: from us-voo-smtp11.internal.sungard.corp ([168.162.128.53]) by
 us-voo-smtp04.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 16:54:19 -0400
Received: from VOO-EXCHANGE05.internal.sungard.corp ([168.162.128.70]) by
 us-voo-smtp11.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 16:54:19 -0400
Received: from VOO-EXCHANGE04.internal.sungard.corp ([168.162.128.66]) by
 VOO-EXCHANGE05.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 23 Apr 2009 16:53:56 -0400
X-MIMEOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="US-ASCII"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Error: there are more terms than documents...
Date: Thu, 23 Apr 2009 16:52:56 -0400
Message-ID: <036829964E44B44F80A0D168BB9849E1018C625F@VOO-EXCHANGE04.internal.sungard.corp>
In-Reply-To: <036829964E44B44F80A0D168BB9849E1018C624B@VOO-EXCHANGE04.internal.sungard.corp>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: Error: there are more terms than documents...
Thread-Index: AcnETlAO8TAZH58/RMys91dVvLCNLgAARmlgAAFDG9A=
From: <Bill.Chesky@sungard.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 23 Apr 2009 20:53:57.0004 (UTC) FILETIME=[9EAAFCC0:01C9C455]
X-Virus-Checked: Checked by ClamAV on apache.org

I figured it out.  We are using Hibernate Search and in my ORM class I
am doing the following:

@Field(index=3DIndex.TOKENIZED,store=3DStore.YES)
protected String objectId;

So when I persisted a new object to our database I was inadvertently
creating a document in the Lucene index with the tokenized and stored
field "objectId".  This is a left over from when we were letting
Hibernate Search build our index for us.  We're now building the index
ourselves so I think if I just remove this, it should work ok.

Thanks for the help, Doron.

Bill


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39913-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 21:21:05 2009
Return-Path: <java-user-return-39913-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33259 invoked from network); 23 Apr 2009 21:21:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 21:21:05 -0000
Received: (qmail 57804 invoked by uid 500); 23 Apr 2009 21:08:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57785 invoked by uid 500); 23 Apr 2009 21:08:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57775 invoked by uid 99); 23 Apr 2009 21:08:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:08:03 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:07:54 +0000
Received: by mail-fx0-f158.google.com with SMTP id 2so843399fxm.5
        for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 14:07:32 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.223.103.133 with SMTP id k5mr509584fao.23.1240520852443; Thu, 
	23 Apr 2009 14:07:32 -0700 (PDT)
In-Reply-To: <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>
	 <49E23210.5000209@stanford.edu>
	 <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>
	 <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>
Date: Thu, 23 Apr 2009 23:07:32 +0200
Message-ID: <7e536b1f0904231407v1083b060obb8a6173eb06227a@mail.gmail.com>
Subject: Re: exponential boosts
From: Marcus Herou <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c5a758bf13a904683f447a
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5a758bf13a904683f447a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Yes I have considered it for 30 minutes :)

How do one apply that in the real world ?

If the only thing I get access to is the actual docId would it not be really
expensive to get the Document itself from the index and later use some field
in it as external lookup in some optimized structure for this ?

Example, pseudo:

*public* *float* customScore(*int* doc, *float* subQueryScore, *float*
valSrcScore)
{
        *Document document = indexSearcher.doc(doc);
        float score = MyOptimalHashStructure.getScore(document.get("someId"));
        return score**subQueryScore*;*
}

This would not scale well right ? I mean gathering scores through 100M docs
would take some time I guess ? Or even 1M docs...

Please push me in the right direction.

Cheers

//Marcus






On Thu, Apr 23, 2009 at 10:58 PM, Doron Cohen <cdoronc@gmail.com> wrote:

> >
> > I think we are doing similar things, at least I am trying to implement
> > document boosting with pagerank. Having issues of howto appky the scoring
> > of
> > specific docs without actually reindex them. I feel something should be
> > done
> > at query time which looks at external data but do not know howto
> implement
> > that. Do you ?
> >
>
> Have you considered CustomScoreQuery in o.a.l.search.function ? It should
> allow
> incorporating external scores.
>
> Doron
>



-- 
Marcus Herou CTO and co-founder Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com/
http://blogg.tailsweep.com/

--001636c5a758bf13a904683f447a--

From java-user-return-39914-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 21:21:05 2009
Return-Path: <java-user-return-39914-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33391 invoked from network); 23 Apr 2009 21:21:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 21:21:05 -0000
Received: (qmail 57984 invoked by uid 500); 23 Apr 2009 21:08:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57964 invoked by uid 500); 23 Apr 2009 21:08:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57954 invoked by uid 99); 23 Apr 2009 21:08:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:08:44 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:08:33 +0000
Received: by fxm2 with SMTP id 2so844128fxm.5
        for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 14:08:13 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.223.111.71 with SMTP id r7mr447328fap.59.1240520893246; Thu, 
	23 Apr 2009 14:08:13 -0700 (PDT)
In-Reply-To: <7e536b1f0904231407v1083b060obb8a6173eb06227a@mail.gmail.com>
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>
	 <49E23210.5000209@stanford.edu>
	 <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>
	 <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>
	 <7e536b1f0904231407v1083b060obb8a6173eb06227a@mail.gmail.com>
Date: Thu, 23 Apr 2009 23:08:13 +0200
Message-ID: <7e536b1f0904231408g77a4416gd9f2d1fb6ff3e091@mail.gmail.com>
Subject: Re: exponential boosts
From: Marcus Herou <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c5b2f02dac8c04683f4786
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5b2f02dac8c04683f4786
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

But perhaps one could use a FieldCache somehow ?

/M

On Thu, Apr 23, 2009 at 11:07 PM, Marcus Herou
<marcus.herou@tailsweep.com>wrote:

> Yes I have considered it for 30 minutes :)
>
> How do one apply that in the real world ?
>
> If the only thing I get access to is the actual docId would it not be
> really expensive to get the Document itself from the index and later use
> some field in it as external lookup in some optimized structure for this ?
>
> Example, pseudo:
>
> *public* *float* customScore(*int* doc, *float* subQueryScore, *float* valSrcScore)
>
> {
>         *Document document = indexSearcher.doc(doc);
>         float score = MyOptimalHashStructure.getScore(document.get("someId"));
>         return score**subQueryScore*;*
>
> }
>
> This would not scale well right ? I mean gathering scores through 100M docs
> would take some time I guess ? Or even 1M docs...
>
> Please push me in the right direction.
>
> Cheers
>
> //Marcus
>
>
>
>
>
>
>
> On Thu, Apr 23, 2009 at 10:58 PM, Doron Cohen <cdoronc@gmail.com> wrote:
>
>> >
>> > I think we are doing similar things, at least I am trying to implement
>> > document boosting with pagerank. Having issues of howto appky the
>> scoring
>> > of
>> > specific docs without actually reindex them. I feel something should be
>> > done
>> > at query time which looks at external data but do not know howto
>> implement
>> > that. Do you ?
>> >
>>
>> Have you considered CustomScoreQuery in o.a.l.search.function ? It should
>> allow
>> incorporating external scores.
>>
>> Doron
>>
>
>
>
> --
> Marcus Herou CTO and co-founder Tailsweep AB
> +46702561312
> marcus.herou@tailsweep.com
> http://www.tailsweep.com/
> http://blogg.tailsweep.com/
>



-- 
Marcus Herou CTO and co-founder Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com/
http://blogg.tailsweep.com/

--001636c5b2f02dac8c04683f4786--

From java-user-return-39915-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 21:23:23 2009
Return-Path: <java-user-return-39915-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36616 invoked from network); 23 Apr 2009 21:23:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 21:23:23 -0000
Received: (qmail 89035 invoked by uid 500); 23 Apr 2009 21:23:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88994 invoked by uid 500); 23 Apr 2009 21:23:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88972 invoked by uid 99); 23 Apr 2009 21:23:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:23:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [171.67.219.89] (HELO smtp-roam.stanford.edu) (171.67.219.89)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:23:13 +0000
Received: from smtp-roam.stanford.edu (localhost.localdomain [127.0.0.1])
	by localhost (Postfix) with SMTP id 515E0779A4
	for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 14:22:51 -0700 (PDT)
Received: from [10.32.8.169] (DN0a2008a9.SUNet [10.32.8.169])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: bethard)
	by smtp-roam.stanford.edu (Postfix) with ESMTPSA id 2009C77970
	for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 14:22:51 -0700 (PDT)
Message-ID: <49F0DC26.1030109@stanford.edu>
Date: Thu, 23 Apr 2009 14:22:46 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: exponential boosts
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>	 <49E23210.5000209@stanford.edu>	 <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com> <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>
In-Reply-To: <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On 4/23/2009 1:58 PM, Doron Cohen wrote:
>> I think we are doing similar things, at least I am trying to implement
>> document boosting with pagerank. Having issues of howto appky the scoring
>> of
>> specific docs without actually reindex them. I feel something should be
>> done
>> at query time which looks at external data but do not know howto implement
>> that. Do you ?
>>
> 
> Have you considered CustomScoreQuery in o.a.l.search.function ? It should
> allow
> incorporating external scores.

Yeah, PageRank is relatively easy to incorporate with a CustomScoreQuery
and a FieldScoreQuery. Just add a field to your index containing the
float value of your document's PageRank, and then specify that field
when you create the FieldScoreQuery that you provide to the
CustomScoreQuery constructor.

If you want to keep the PageRank scores in a separate index (that's what
I do currently), it's easy enough to combine two parallel indexes using
a ParallelReader.

Steve

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39916-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 21:28:57 2009
Return-Path: <java-user-return-39916-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40919 invoked from network); 23 Apr 2009 21:28:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 21:28:57 -0000
Received: (qmail 1301 invoked by uid 500); 23 Apr 2009 21:28:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1231 invoked by uid 500); 23 Apr 2009 21:28:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1221 invoked by uid 99); 23 Apr 2009 21:28:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:28:54 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=FUZZY_CPILL,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [171.67.219.89] (HELO smtp-roam.stanford.edu) (171.67.219.89)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:28:43 +0000
Received: from smtp-roam.stanford.edu (localhost.localdomain [127.0.0.1])
	by localhost (Postfix) with SMTP id 1A09B77970
	for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 14:28:20 -0700 (PDT)
Received: from [10.32.8.169] (DN0a2008a9.SUNet [10.32.8.169])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: bethard)
	by smtp-roam.stanford.edu (Postfix) with ESMTPSA id D6C527794C
	for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 14:28:19 -0700 (PDT)
Message-ID: <49F0DD6F.6070606@stanford.edu>
Date: Thu, 23 Apr 2009 14:28:15 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: exponential boosts
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>	 <49E23210.5000209@stanford.edu>	 <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>	 <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>	 <7e536b1f0904231407v1083b060obb8a6173eb06227a@mail.gmail.com> <7e536b1f0904231408g77a4416gd9f2d1fb6ff3e091@mail.gmail.com>
In-Reply-To: <7e536b1f0904231408g77a4416gd9f2d1fb6ff3e091@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On 4/23/2009 2:08 PM, Marcus Herou wrote:
> But perhaps one could use a FieldCache somehow ?

Some code snippets that may help. I add the PageRank value as a field of
the documents I index with Lucene like this:

    Document document = new Document();
    double pageRank = this.pageRanks.getCount(article.getId());
    document.add(new Field(
        PAGE_RANK_FIELD_NAME, Float.toString((float)pageRank),
        Field.Store.YES, Field.Index.NOT_ANALYZED));

Then when I want to get the value back, I use a FieldScoreQuery, which
just returns the field value as the document score, like this:

  new FieldScoreQuery(PAGE_RANK_FIELD_NAME, FieldScoreQuery.Type.FLOAT);

If you want to combine the PageRank score with another Query score, then
you can look at CustomScoreQuery to do so.

Steve

> On Thu, Apr 23, 2009 at 11:07 PM, Marcus Herou
> <marcus.herou@tailsweep.com>wrote:
> 
>> Yes I have considered it for 30 minutes :)
>>
>> How do one apply that in the real world ?
>>
>> If the only thing I get access to is the actual docId would it not be
>> really expensive to get the Document itself from the index and later use
>> some field in it as external lookup in some optimized structure for this ?
>>
>> Example, pseudo:
>>
>> *public* *float* customScore(*int* doc, *float* subQueryScore, *float* valSrcScore)
>>
>> {
>>         *Document document = indexSearcher.doc(doc);
>>         float score = MyOptimalHashStructure.getScore(document.get("someId"));
>>         return score**subQueryScore*;*
>>
>> }
>>
>> This would not scale well right ? I mean gathering scores through 100M docs
>> would take some time I guess ? Or even 1M docs...
>>
>> Please push me in the right direction.
>>
>> Cheers
>>
>> //Marcus
>>
>>
>>
>>
>>
>>
>>
>> On Thu, Apr 23, 2009 at 10:58 PM, Doron Cohen <cdoronc@gmail.com> wrote:
>>
>>>> I think we are doing similar things, at least I am trying to implement
>>>> document boosting with pagerank. Having issues of howto appky the
>>> scoring
>>>> of
>>>> specific docs without actually reindex them. I feel something should be
>>>> done
>>>> at query time which looks at external data but do not know howto
>>> implement
>>>> that. Do you ?
>>>>
>>> Have you considered CustomScoreQuery in o.a.l.search.function ? It should
>>> allow
>>> incorporating external scores.
>>>
>>> Doron
>>>
>>
>>
>> --
>> Marcus Herou CTO and co-founder Tailsweep AB
>> +46702561312
>> marcus.herou@tailsweep.com
>> http://www.tailsweep.com/
>> http://blogg.tailsweep.com/
>>
> 
> 
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39917-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 21:43:09 2009
Return-Path: <java-user-return-39917-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52282 invoked from network); 23 Apr 2009 21:43:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 21:43:09 -0000
Received: (qmail 23520 invoked by uid 500); 23 Apr 2009 21:43:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23453 invoked by uid 500); 23 Apr 2009 21:43:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23443 invoked by uid 99); 23 Apr 2009 21:43:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:43:06 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:42:57 +0000
Received: by fxm2 with SMTP id 2so859527fxm.5
        for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 14:42:35 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.223.111.71 with SMTP id r7mr454716fap.59.1240522955702; Thu, 
	23 Apr 2009 14:42:35 -0700 (PDT)
In-Reply-To: <49F0DD6F.6070606@stanford.edu>
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>
	 <49E23210.5000209@stanford.edu>
	 <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>
	 <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>
	 <7e536b1f0904231407v1083b060obb8a6173eb06227a@mail.gmail.com>
	 <7e536b1f0904231408g77a4416gd9f2d1fb6ff3e091@mail.gmail.com>
	 <49F0DD6F.6070606@stanford.edu>
Date: Thu, 23 Apr 2009 23:42:35 +0200
Message-ID: <7e536b1f0904231442m23b47439qbef74b5bb8eb4636@mail.gmail.com>
Subject: Re: exponential boosts
From: Marcus Herou <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c5b2f01c440b04683fc261
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5b2f01c440b04683fc261
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks! (I started my reply and then saw that you added code snippets)

I think we are narrowing down the problem to the updating issue of the
PageRank score.

So what you basically are saying is that:

1. You have an index which contains data that is more or less static (no
updates) or you have another update interval than the PR interval.
2. A PR index which is rebuilt (from scratch ?) every X days/weeks/months.

Commenting inline.

Cheers and thanks for everything.

//Marcus

On Thu, Apr 23, 2009 at 11:28 PM, Steven Bethard <bethard@stanford.edu>wrote:

> On 4/23/2009 2:08 PM, Marcus Herou wrote:
> > But perhaps one could use a FieldCache somehow ?
>
> Some code snippets that may help. I add the PageRank value as a field of
> the documents I index with Lucene like this:
>
>    Document document = new Document();
>    double pageRank = this.pageRanks.getCount(article.getId());
>    document.add(new Field(
>        PAGE_RANK_FIELD_NAME, Float.toString((float)pageRank),
>        Field.Store.YES, Field.Index.NOT_ANALYZED));


Just as I do but I store the score/PageRank in the "main" index which is a
pain in the ass since I want to be able to update the score field quite
frequently at least every week.

>
>
> Then when I want to get the value back, I use a FieldScoreQuery, which
> just returns the field value as the document score, like this:
>
>  new FieldScoreQuery(PAGE_RANK_FIELD_NAME, FieldScoreQuery.Type.FLOAT);


Great. Never seen that query type before. Will it use that fields score
solely as the base for rank ? Can it be combinable with other Query types or
am I missing something ?
What if I instead sorted on that column ? which is most efficient ?
Example: searcher.search(q, null, 100000, new Sort("score", true));
Then we get to the issue of how to open two indexes and use one
IndexSearcher across them and perhaps a MultiFieldQueryParser to produce the
Query.
Pointers ?


>
>
> If you want to combine the PageRank score with another Query score, then
> you can look at CustomScoreQuery to do so.

You mean by perhaps combining it with user supplied boost like field:term^4
?
Will the score passed in be the score of the FieldScoreQuery if used or the
built in one ?


>
>
> Steve
>
> > On Thu, Apr 23, 2009 at 11:07 PM, Marcus Herou
> > <marcus.herou@tailsweep.com>wrote:
> >
> >> Yes I have considered it for 30 minutes :)
> >>
> >> How do one apply that in the real world ?
> >>
> >> If the only thing I get access to is the actual docId would it not be
> >> really expensive to get the Document itself from the index and later use
> >> some field in it as external lookup in some optimized structure for this
> ?
> >>
> >> Example, pseudo:
> >>
> >> *public* *float* customScore(*int* doc, *float* subQueryScore, *float*
> valSrcScore)
> >>
> >> {
> >>         *Document document = indexSearcher.doc(doc);
> >>         float score =
> MyOptimalHashStructure.getScore(document.get("someId"));
> >>         return score**subQueryScore*;*
> >>
> >> }
> >>
> >> This would not scale well right ? I mean gathering scores through 100M
> docs
> >> would take some time I guess ? Or even 1M docs...
> >>
> >> Please push me in the right direction.
> >>
> >> Cheers
> >>
> >> //Marcus
> >>
> >>
> >>
> >>
> >>
> >>
> >>
> >> On Thu, Apr 23, 2009 at 10:58 PM, Doron Cohen <cdoronc@gmail.com>
> wrote:
> >>
> >>>> I think we are doing similar things, at least I am trying to implement
> >>>> document boosting with pagerank. Having issues of howto appky the
> >>> scoring
> >>>> of
> >>>> specific docs without actually reindex them. I feel something should
> be
> >>>> done
> >>>> at query time which looks at external data but do not know howto
> >>> implement
> >>>> that. Do you ?
> >>>>
> >>> Have you considered CustomScoreQuery in o.a.l.search.function ? It
> should
> >>> allow
> >>> incorporating external scores.
> >>>
> >>> Doron
> >>>
> >>
> >>
> >> --
> >> Marcus Herou CTO and co-founder Tailsweep AB
> >> +46702561312
> >> marcus.herou@tailsweep.com
> >> http://www.tailsweep.com/
> >> http://blogg.tailsweep.com/
> >>
> >
> >
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Marcus Herou CTO and co-founder Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com/
http://blogg.tailsweep.com/

--001636c5b2f01c440b04683fc261--

From java-user-return-39918-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 23 21:48:01 2009
Return-Path: <java-user-return-39918-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57232 invoked from network); 23 Apr 2009 21:48:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Apr 2009 21:48:01 -0000
Received: (qmail 39975 invoked by uid 500); 23 Apr 2009 21:47:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39918 invoked by uid 500); 23 Apr 2009 21:47:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39908 invoked by uid 99); 23 Apr 2009 21:47:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:47:59 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.218.179] (HELO mail-bw0-f179.google.com) (209.85.218.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 23 Apr 2009 21:47:48 +0000
Received: by bwz27 with SMTP id 27so860843bwz.5
        for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 14:47:27 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.223.121.6 with SMTP id f6mr475601far.77.1240523247034; Thu, 23 
	Apr 2009 14:47:27 -0700 (PDT)
In-Reply-To: <7e536b1f0904231442m23b47439qbef74b5bb8eb4636@mail.gmail.com>
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>
	 <49E23210.5000209@stanford.edu>
	 <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>
	 <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>
	 <7e536b1f0904231407v1083b060obb8a6173eb06227a@mail.gmail.com>
	 <7e536b1f0904231408g77a4416gd9f2d1fb6ff3e091@mail.gmail.com>
	 <49F0DD6F.6070606@stanford.edu>
	 <7e536b1f0904231442m23b47439qbef74b5bb8eb4636@mail.gmail.com>
Date: Thu, 23 Apr 2009 23:47:26 +0200
Message-ID: <7e536b1f0904231447y35d18598r2f2b750b79f1346@mail.gmail.com>
Subject: Re: exponential boosts
From: Marcus Herou <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c5bb7179a05904683fd3de
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5bb7179a05904683fd3de
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Never mind of how to open the ParallellReader stuff (I am an idiot): RTFM:
http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/index/ParallelReader.html

But the rest is of course interesting :)

/M

On Thu, Apr 23, 2009 at 11:42 PM, Marcus Herou
<marcus.herou@tailsweep.com>wrote:

> Thanks! (I started my reply and then saw that you added code snippets)
>
> I think we are narrowing down the problem to the updating issue of the
> PageRank score.
>
> So what you basically are saying is that:
>
> 1. You have an index which contains data that is more or less static (no
> updates) or you have another update interval than the PR interval.
> 2. A PR index which is rebuilt (from scratch ?) every X days/weeks/months.
>
> Commenting inline.
>
> Cheers and thanks for everything.
>
> //Marcus
>
> On Thu, Apr 23, 2009 at 11:28 PM, Steven Bethard <bethard@stanford.edu>wrote:
>
>> On 4/23/2009 2:08 PM, Marcus Herou wrote:
>> > But perhaps one could use a FieldCache somehow ?
>>
>> Some code snippets that may help. I add the PageRank value as a field of
>> the documents I index with Lucene like this:
>>
>>    Document document = new Document();
>>    double pageRank = this.pageRanks.getCount(article.getId());
>>    document.add(new Field(
>>        PAGE_RANK_FIELD_NAME, Float.toString((float)pageRank),
>>        Field.Store.YES, Field.Index.NOT_ANALYZED));
>
>
> Just as I do but I store the score/PageRank in the "main" index which is a
> pain in the ass since I want to be able to update the score field quite
> frequently at least every week.
>
>>
>>
>> Then when I want to get the value back, I use a FieldScoreQuery, which
>> just returns the field value as the document score, like this:
>>
>>  new FieldScoreQuery(PAGE_RANK_FIELD_NAME, FieldScoreQuery.Type.FLOAT);
>
>
> Great. Never seen that query type before. Will it use that fields score
> solely as the base for rank ? Can it be combinable with other Query types or
> am I missing something ?
> What if I instead sorted on that column ? which is most efficient ?
> Example: searcher.search(q, null, 100000, new Sort("score", true));
> Then we get to the issue of how to open two indexes and use one
> IndexSearcher across them and perhaps a MultiFieldQueryParser to produce the
> Query.
> Pointers ?
>
>
>>
>>
>> If you want to combine the PageRank score with another Query score, then
>> you can look at CustomScoreQuery to do so.
>
> You mean by perhaps combining it with user supplied boost like field:term^4
> ?
> Will the score passed in be the score of the FieldScoreQuery if used or the
> built in one ?
>
>
>>
>>
>> Steve
>>
>> > On Thu, Apr 23, 2009 at 11:07 PM, Marcus Herou
>> > <marcus.herou@tailsweep.com>wrote:
>> >
>> >> Yes I have considered it for 30 minutes :)
>> >>
>> >> How do one apply that in the real world ?
>> >>
>> >> If the only thing I get access to is the actual docId would it not be
>> >> really expensive to get the Document itself from the index and later
>> use
>> >> some field in it as external lookup in some optimized structure for
>> this ?
>> >>
>> >> Example, pseudo:
>> >>
>> >> *public* *float* customScore(*int* doc, *float* subQueryScore, *float*
>> valSrcScore)
>> >>
>> >> {
>> >>         *Document document = indexSearcher.doc(doc);
>> >>         float score =
>> MyOptimalHashStructure.getScore(document.get("someId"));
>> >>         return score**subQueryScore*;*
>> >>
>> >> }
>> >>
>> >> This would not scale well right ? I mean gathering scores through 100M
>> docs
>> >> would take some time I guess ? Or even 1M docs...
>> >>
>> >> Please push me in the right direction.
>> >>
>> >> Cheers
>> >>
>> >> //Marcus
>> >>
>> >>
>> >>
>> >>
>> >>
>> >>
>> >>
>> >> On Thu, Apr 23, 2009 at 10:58 PM, Doron Cohen <cdoronc@gmail.com>
>> wrote:
>> >>
>> >>>> I think we are doing similar things, at least I am trying to
>> implement
>> >>>> document boosting with pagerank. Having issues of howto appky the
>> >>> scoring
>> >>>> of
>> >>>> specific docs without actually reindex them. I feel something should
>> be
>> >>>> done
>> >>>> at query time which looks at external data but do not know howto
>> >>> implement
>> >>>> that. Do you ?
>> >>>>
>> >>> Have you considered CustomScoreQuery in o.a.l.search.function ? It
>> should
>> >>> allow
>> >>> incorporating external scores.
>> >>>
>> >>> Doron
>> >>>
>> >>
>> >>
>> >> --
>> >> Marcus Herou CTO and co-founder Tailsweep AB
>> >> +46702561312
>> >> marcus.herou@tailsweep.com
>> >> http://www.tailsweep.com/
>> >> http://blogg.tailsweep.com/
>> >>
>> >
>> >
>> >
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> --
> Marcus Herou CTO and co-founder Tailsweep AB
> +46702561312
> marcus.herou@tailsweep.com
> http://www.tailsweep.com/
> http://blogg.tailsweep.com/
>



-- 
Marcus Herou CTO and co-founder Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com/
http://blogg.tailsweep.com/

--001636c5bb7179a05904683fd3de--

From java-user-return-39919-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 01:14:34 2009
Return-Path: <java-user-return-39919-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60513 invoked from network); 24 Apr 2009 01:14:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 01:14:33 -0000
Received: (qmail 45766 invoked by uid 500); 24 Apr 2009 01:14:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45679 invoked by uid 500); 24 Apr 2009 01:14:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45669 invoked by uid 99); 24 Apr 2009 01:14:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 01:14:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [171.67.219.89] (HELO smtp-roam.stanford.edu) (171.67.219.89)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 01:14:21 +0000
Received: from smtp-roam.stanford.edu (localhost.localdomain [127.0.0.1])
	by localhost (Postfix) with SMTP id A154C77AC9
	for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 18:13:58 -0700 (PDT)
Received: from [192.168.1.100] (adsl-76-220-111-235.dsl.pltn13.sbcglobal.net [76.220.111.235])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: bethard)
	by smtp-roam.stanford.edu (Postfix) with ESMTPSA id 34B8A77987
	for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 18:13:58 -0700 (PDT)
Message-ID: <49F11251.2040109@stanford.edu>
Date: Thu, 23 Apr 2009 18:13:53 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: exponential boosts
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>	 <49E23210.5000209@stanford.edu>	 <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>	 <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>	 <7e536b1f0904231407v1083b060obb8a6173eb06227a@mail.gmail.com>	 <7e536b1f0904231408g77a4416gd9f2d1fb6ff3e091@mail.gmail.com>	 <49F0DD6F.6070606@stanford.edu> <7e536b1f0904231442m23b47439qbef74b5bb8eb4636@mail.gmail.com>
In-Reply-To: <7e536b1f0904231442m23b47439qbef74b5bb8eb4636@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On 4/23/2009 2:42 PM, Marcus Herou wrote:
> So what you basically are saying is that:
> 
> 1. You have an index which contains data that is more or less static (no
> updates) or you have another update interval than the PR interval.
> 2. A PR index which is rebuilt (from scratch ?) every X days/weeks/months.

Yep, that's the basic idea. That way, you can rebuild the PageRank index
without touching the other index.

>> Then when I want to get the value back, I use a FieldScoreQuery, which
>> just returns the field value as the document score, like this:
>>
>>  new FieldScoreQuery(PAGE_RANK_FIELD_NAME, FieldScoreQuery.Type.FLOAT);
> 
> Great. Never seen that query type before. Will it use that fields score
> solely as the base for rank ? Can it be combinable with other Query types or
> am I missing something ?

To combine it with other query types, use a CustomScoreQuery, something
like:

  new CustomScoreQuery(otherQuery, pageRankFieldScoreQuery)

You may want to subclass CustomScoreQuery and do something more
interesting than the default, which is just to multiply the two scores
together, I believe. Check the CustomScoreQuery docs for the full details:

> What if I instead sorted on that column ? which is most efficient ?
> Example: searcher.search(q, null, 100000, new Sort("score", true));
> Then we get to the issue of how to open two indexes and use one
> IndexSearcher across them and perhaps a MultiFieldQueryParser to produce the
> Query.

I've never used a Sort before, so someone else will have to answer this bit.

>> If you want to combine the PageRank score with another Query score, then
>> you can look at CustomScoreQuery to do so.
> 
> You mean by perhaps combining it with user supplied boost like field:term^4
> ?
> Will the score passed in be the score of the FieldScoreQuery if used or the
> built in one ?

See above. I believe the default CustomScoreQuery behavior is two just
multiply the two query scores together, so you'd get something like:

  otherQueryScore * PageRank

for the CustomScoreQuery above.

Steve

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39920-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 05:39:02 2009
Return-Path: <java-user-return-39920-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79252 invoked from network); 24 Apr 2009 05:39:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 05:39:02 -0000
Received: (qmail 47161 invoked by uid 500); 24 Apr 2009 05:39:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47075 invoked by uid 500); 24 Apr 2009 05:38:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47065 invoked by uid 99); 24 Apr 2009 05:38:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 05:38:59 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.218.179] (HELO mail-bw0-f179.google.com) (209.85.218.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 05:38:49 +0000
Received: by bwz27 with SMTP id 27so987953bwz.5
        for <java-user@lucene.apache.org>; Thu, 23 Apr 2009 22:38:28 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.223.113.9 with SMTP id y9mr569563fap.61.1240551508484; Thu, 23 
	Apr 2009 22:38:28 -0700 (PDT)
In-Reply-To: <49F11251.2040109@stanford.edu>
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>
	 <49E23210.5000209@stanford.edu>
	 <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>
	 <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>
	 <7e536b1f0904231407v1083b060obb8a6173eb06227a@mail.gmail.com>
	 <7e536b1f0904231408g77a4416gd9f2d1fb6ff3e091@mail.gmail.com>
	 <49F0DD6F.6070606@stanford.edu>
	 <7e536b1f0904231442m23b47439qbef74b5bb8eb4636@mail.gmail.com>
	 <49F11251.2040109@stanford.edu>
Date: Fri, 24 Apr 2009 07:38:28 +0200
Message-ID: <7e536b1f0904232238m69252361nca4d5640985f159a@mail.gmail.com>
Subject: Re: exponential boosts
From: Marcus Herou <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c923d7fd22560468466743
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c923d7fd22560468466743
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thank you Steve, now it's implementation time...

I'll be back :)

/M

On Fri, Apr 24, 2009 at 3:13 AM, Steven Bethard <bethard@stanford.edu>wrote:

> On 4/23/2009 2:42 PM, Marcus Herou wrote:
> > So what you basically are saying is that:
> >
> > 1. You have an index which contains data that is more or less static (no
> > updates) or you have another update interval than the PR interval.
> > 2. A PR index which is rebuilt (from scratch ?) every X
> days/weeks/months.
>
> Yep, that's the basic idea. That way, you can rebuild the PageRank index
> without touching the other index.
>
> >> Then when I want to get the value back, I use a FieldScoreQuery, which
> >> just returns the field value as the document score, like this:
> >>
> >>  new FieldScoreQuery(PAGE_RANK_FIELD_NAME, FieldScoreQuery.Type.FLOAT);
> >
> > Great. Never seen that query type before. Will it use that fields score
> > solely as the base for rank ? Can it be combinable with other Query types
> or
> > am I missing something ?
>
> To combine it with other query types, use a CustomScoreQuery, something
> like:
>
>  new CustomScoreQuery(otherQuery, pageRankFieldScoreQuery)
>
> You may want to subclass CustomScoreQuery and do something more
> interesting than the default, which is just to multiply the two scores
> together, I believe. Check the CustomScoreQuery docs for the full details:
>
> > What if I instead sorted on that column ? which is most efficient ?
> > Example: searcher.search(q, null, 100000, new Sort("score", true));
> > Then we get to the issue of how to open two indexes and use one
> > IndexSearcher across them and perhaps a MultiFieldQueryParser to produce
> the
> > Query.
>
> I've never used a Sort before, so someone else will have to answer this
> bit.
>
> >> If you want to combine the PageRank score with another Query score, then
> >> you can look at CustomScoreQuery to do so.
> >
> > You mean by perhaps combining it with user supplied boost like
> field:term^4
> > ?
> > Will the score passed in be the score of the FieldScoreQuery if used or
> the
> > built in one ?
>
> See above. I believe the default CustomScoreQuery behavior is two just
> multiply the two query scores together, so you'd get something like:
>
>  otherQueryScore * PageRank
>
> for the CustomScoreQuery above.
>
> Steve
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Marcus Herou CTO and co-founder Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com/
http://blogg.tailsweep.com/

--001636c923d7fd22560468466743--

From java-user-return-39921-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 07:53:38 2009
Return-Path: <java-user-return-39921-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60283 invoked from network); 24 Apr 2009 07:53:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 07:53:38 -0000
Received: (qmail 17466 invoked by uid 500); 24 Apr 2009 07:53:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17390 invoked by uid 500); 24 Apr 2009 07:53:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17380 invoked by uid 99); 24 Apr 2009 07:53:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 07:53:35 +0000
X-ASF-Spam-Status: No, hits=0.5 required=10.0
	tests=FUZZY_CREDIT,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 07:53:27 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LxGDa-0001hH-J4
	for java-user@lucene.apache.org; Fri, 24 Apr 2009 00:53:06 -0700
Message-ID: <23211629.post@talk.nabble.com>
Date: Fri, 24 Apr 2009 00:53:06 -0700 (PDT)
From: uday kumar maddigatla <ukma@mach.com>
To: java-user@lucene.apache.org
Subject: Re: How to search special characters in LUcene
In-Reply-To: <359a92830904230634x2f13ef20r1b0e1599531f8dd9@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: ukma@mach.com
References: <D262A1FB331DC344AA0B896F390D5569016E3E8C@exchhyd.machcorp.lan> <359a92830904210735g24df775cx4bfa11774ac6161c@mail.gmail.com> <23170710.post@talk.nabble.com> <359a92830904220551x23da922ftdbae71d18210538@mail.gmail.com> <23190583.post@talk.nabble.com> <359a92830904230634x2f13ef20r1b0e1599531f8dd9@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Thanks for your reply.

After gone threw with the site which you given... i understood that
StandardAnalyzer is enough to handle these special characters.

i'm attaching one class called AnalysisDemo.java. By executing that class
i'm able to say the above sentance(i.e StandardAnalyzer is enough).

Here is the out put when i ran the above java file.
Analzying "Vedr.           :   Amtsg=C3=A5rden =C3=85rhus, Lyseng All=C3=A9=
 1, 8270
H=C3=B8jbjerg"
=09org.apache.lucene.analysis.WhitespaceAnalyzer:
=09=09[Vedr.] [:] [Amtsg=C3=A5rden] [=C3=85rhus,] [Lyseng] [All=C3=A9] [1,]=
 [8270] [H=C3=B8jbjerg]=20

=09org.apache.lucene.analysis.SimpleAnalyzer:
=09=09[vedr] [amtsg=C3=A5rden] [=C3=A5rhus] [lyseng] [all=C3=A9] [h=C3=B8jb=
jerg]=20

=09org.apache.lucene.analysis.StopAnalyzer:
=09=09[vedr] [amtsg=C3=A5rden] [=C3=A5rhus] [lyseng] [all=C3=A9] [h=C3=B8jb=
jerg]=20

=09org.apache.lucene.analysis.standard.StandardAnalyzer:
=09=09[vedr] [amtsg=C3=A5rden] [=C3=A5rhus] [lyseng] [all=C3=A9] [1] [8270]=
 [h=C3=B8jbjerg]=20

=09org.apache.lucene.analysis.snowball.SnowballAnalyzer:
=09=09[vedr] [amtsg=C3=A5rden] [=C3=A5rhus] [lyseng] [all=C3=A9] [1] [8270]=
 [h=C3=B8jbjerg]=20

By the above out put we can say that StandardAnalyzer is enough to get rid
of danish elements.

But only problem is when i'm searching the any term which includes the
danish elements(like h=C3=B8jbjerg...)

it is unable to find out.=20

Even i checked with LUKE. In that  i given my sample text which contains th=
e
danish elements and selected the StandardAnalyzer as analyser. when i click
analyze in that it cleary making index of danish words.

and also i givne one try on luke by loading my index directory in to luke.
after loading my index i searched for a word which contains the danish
element, But this time it was failed. It was shown nothing(i.e o resluts).

As in my sense the problem might be making the indexes or in searching the
item.


I gone threw the site which you given. From that i'm able to do this kind o=
f
reaserch work.

Please help me in this.


Erick Erickson wrote:
>=20
> OK, this is a much different problem than you were originally
> asking about, effectively "how to index/search mixed language
> documents".
>=20
> This topic has been discussed multiple times on the user list, I
> think your first step should be to search the archive. I *was*
> going to find the old searchable mail archive, but those clever folks
> at Lucid Imagination have something new, see:
>=20
> http://www.lucidimagination.com/search/p:lucene?q=3Dmultiple+languages
>=20
> Once you've had a chance to look that over I think you'll be off and
> running.
>=20
> Best
> Erick
>=20
> On Thu, Apr 23, 2009 at 1:43 AM, uday kumar maddigatla
> <ukma@mach.com>wrote:
>=20
>>
>> HI
>>
>> Here are the details about my goals.
>> 1. I want to use this lucene for mixed languages.
>> 2. I want to make indexes of the documents which are either english or
>> danish etc.
>> I'm attaching my IndexFiles.java file.
>>
>> When i'm searching i'm giving the index path location  as well as
>> doucmets
>> folder.
>>
>> If i use StandardAnalyzer as an argument to IndexWriter's method it is
>> able
>> to search the english characters.
>>
>> How can i use DutchAnalyzer in order to make this IndexFiles.java to
>> index
>> the danish elements.
>>
>> In my Code which i attached, you can see 'C:\test3'. This is my location
>> where i want to store my indexes.
>>
>> I'm giving documents folder location as comand line argument.
>>
>> In my document the content will be like this
>>
>> <com:Note><![CDATA[Kreditnota til udligning af faktura nr. 13927 pga ska=
l
>> opsplittes
>> hhv. byggeplads og skat
>> Vedr.           :   Amtsg=C3=A5rden =C3=85rhus, Lyseng All=C3=A9 1, 8270=
 H=C3=B8jbjerg
>> Bygning B
>> SES Journal nr. :   42895-0001
>> SES Navision nr.:   Navision 9800124
>> SES Ansvarlig   :   Martin Kr=C3=B8ldrup Nielsen
>> SES r=C3=A5dgiver    :   Friis & Moltke A/S
>> Hermed fremsendes faktura p=C3=A5 ekstra t=C3=B8mrerarbejde.
>> Byggeplads Amtsg=C3=A5rden B-4
>> jvf. vedlagte specifikation - aftaleseddel nr. 12.]]></com:Note>
>>
>> i"m searching the word like r=C3=A5dgiver . When i see the result it is
>> clearly
>> searching for r dgiver. It is omitting the danish element.
>>
>> Please help me in this.
>>
>>
>>
>> Erick Erickson wrote:
>> >
>> > Are you *also* using the DutchAnalyzer for your *query*?
>> >
>> > Please show us the index and search code (simplified as much
>> > as possible), then we'll be able to provide better suggestions.
>> >
>> > Also, tell us a bit more about your goals here. Is this an
>> > index entirely of Dutch documents? Or is it a mixed-language
>> > index?
>> >
>> > Think about getting a copy of Luke and
>> > 1> examining your index to see what's *really* there
>> > 2> examining the effects of using different parsers on
>> >      your *query*.
>> >
>> > Best
>> > Erick
>> >
>> > On Wed, Apr 22, 2009 at 2:57 AM, uday kumar maddigatla
>> > <ukma@mach.com>wrote:
>> >
>> >>
>> >> Hi
>> >>
>> >> Thanks for your reply.
>> >>
>> >> I'm able to see the DutchAnalyzer.
>> >>
>> >> When i'm indexing my documents i given instace of DutchAnalyzer as an
>> >> argument to IndexWriter Class.
>> >>
>> >> After this when i search for the
>> >> http://www.nabble.com/file/p23170710/IndexFiles.java IndexFiles.java
>> >> contains the danish elements .. Still it is not able to identify.
>> >>
>> >> Please tell me how to use DutchAnalzer in my application. Sample
>> example
>> >> or
>> >> series of steps helps me.
>> >>
>> >> I also attached my index file(.java file).
>> >>
>> >> Please help me in this. please..
>> >>
>> >> Erick Erickson wrote:
>> >> >
>> >> > Take a look at DutchAnalyzer. The problem you'll have is if you're
>> >> > indexing
>> >> > this document along with a bunch of documents from other languages.
>> >> > You could search the mail archive for extensive discussions of
>> >> indexing/
>> >> > searching documents from several languages.
>> >> >
>> >> > Best
>> >> > Erick
>> >> >
>> >> > On Tue, Apr 21, 2009 at 2:40 AM, Uday Kumar Maddigatla
>> >> > <ukma@mach.com>wrote:
>> >> >
>> >> >> HI,
>> >> >>
>> >> >>
>> >> >>
>> >> >> I'm new to the lucene. I downloaded lucene 2.4.1.
>> >> >>
>> >> >>
>> >> >>
>> >> >> I have one xml file which contains few special characters like '=
=C3=A5',
>> >> '=C3=B8,'
>> >> >> =C2=B0'
>> >> >> etc.(these are Danish language elements).
>> >> >>
>> >> >>
>> >> >>
>> >> >> How can I search these things.
>> >> >>
>> >> >>
>> >> >>
>> >> >>
>> >> >>
>> >> >> Uday Kumar  Reddy Maddigatla
>> >> >>
>> >> >> Software Engineer(Progrator|gatetrade)
>> >> >>
>> >> >> MACH India(Operations)
>> >> >>
>> >> >> Mobile: + 91-9963000377
>> >> >>
>> >> >> Uday.Maddigatla@ness.com <mailto:Uday.Maddigatla@ness.com>
>> >> >>
>> >> >> ukma@mach.com <mailto:ukma@mach.com>
>> >> >>
>> >> >> www.ness.com
>> >> >>
>> >> >>
>> >> >>
>> >> >>
>> >> >>
>> >> >>
>> >> >
>> >> >
>> >>
>> >> --
>> >> View this message in context:
>> >>
>> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp23150=
039p23170710.html
>> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>> >
>> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
>> http://www.nabble.com/file/p23190583/SearchFiles.java SearchFiles.java
>> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
>> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
>> --
>> View this message in context:
>> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp23150=
039p23190583.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
>=20
http://www.nabble.com/file/p23211629/AnalysisDemo.java AnalysisDemo.java=20
--=20
View this message in context: http://www.nabble.com/How-to-search-special-c=
haracters-in-LUcene-tp23150039p23211629.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39922-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 10:17:04 2009
Return-Path: <java-user-return-39922-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23709 invoked from network); 24 Apr 2009 10:17:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 10:17:04 -0000
Received: (qmail 70590 invoked by uid 500); 24 Apr 2009 10:17:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70541 invoked by uid 500); 24 Apr 2009 10:17:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70531 invoked by uid 99); 24 Apr 2009 10:17:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 10:17:01 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cdoronc@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 10:16:54 +0000
Received: by ewy27 with SMTP id 27so986716ewy.5
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 03:16:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=kKHP6bE744g8+KYfKhQUF634GK4ST42PA5WW0sNlqoU=;
        b=gLZ8mMlKHDTBc2ypmdCN7CWkpzUCnkJNfbCsUpslDNtYZjlRh8yH2aWiiToQNYe02P
         bVYSFGabdmp9YvEKuNaNmVJjiAOMw6DaQFqynaO9qkciA+vqSzfZjQpk9nb3VXVzEl38
         sVtMMAyJ9XfvdVGCLWpcycPpft1V1H4MxV/5A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=J6d5SraDC6WEppN/agizwv8pmpjFYUuwcWHaX8viK56oybTJWPRUUC9oI1Yz+Tbfvt
         w5h3nRusdHjtBBIs4s3tYbUfMpyNbd+puA5y/wK1Cg5zh1bSCObSr0F1jQ5TiGt8rhHH
         lPAKSJwDPCkf2WI/P5FnqzYuI0j+vPxOgllKo=
MIME-Version: 1.0
Received: by 10.210.27.20 with SMTP id a20mr2071512eba.78.1240568193411; Fri, 
	24 Apr 2009 03:16:33 -0700 (PDT)
In-Reply-To: <49F0DD6F.6070606@stanford.edu>
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>
	 <49E23210.5000209@stanford.edu>
	 <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>
	 <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>
	 <7e536b1f0904231407v1083b060obb8a6173eb06227a@mail.gmail.com>
	 <7e536b1f0904231408g77a4416gd9f2d1fb6ff3e091@mail.gmail.com>
	 <49F0DD6F.6070606@stanford.edu>
Date: Fri, 24 Apr 2009 13:16:33 +0300
Message-ID: <e05f0fd10904240316n2bcc9f6jfbf0cab27c99804d@mail.gmail.com>
Subject: Re: exponential boosts
From: Doron Cohen <cdoronc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c0df07cec6a04684a4a74
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c0df07cec6a04684a4a74
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

On Fri, Apr 24, 2009 at 12:28 AM, Steven Bethard <bethard@stanford.edu>wrote:

> On 4/23/2009 2:08 PM, Marcus Herou wrote:
> > But perhaps one could use a FieldCache somehow ?
>
> Some code snippets that may help. I add the PageRank value as a field of
> the documents I index with Lucene like this:
>
>    Document document = new Document();
>    double pageRank = this.pageRanks.getCount(article.getId());
>    document.add(new Field(
>        PAGE_RANK_FIELD_NAME, Float.toString((float)pageRank),
>        Field.Store.YES, Field.Index.NOT_ANALYZED));


Note that there's no need to store this field - it is the indexed
value which is  being used.

Also, note an additional approach: page-ranks could be maintained
externally,
conceptually an array: float[] pageRank, where pageRank[docid] is the PR
of that doc. This has the challenge of matching with index docids and so
will not
work well in a dynamic env where docs are deleted and hence docids are
changed.
But, if your setting is static in terms of docids, this would allow you to
update the
PRs without re-indexing the entire collection. To take this path, extend
ValueSource over this array, and construct a ValueSourceQuery over that
value source.
This ValueSourceQuery will now be your pageRankQuery, passed to
CustomScoreQuery.

Doron

--0015174c0df07cec6a04684a4a74--

From java-user-return-39923-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 10:23:24 2009
Return-Path: <java-user-return-39923-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27843 invoked from network); 24 Apr 2009 10:23:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 10:23:24 -0000
Received: (qmail 83023 invoked by uid 500); 24 Apr 2009 10:23:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82948 invoked by uid 500); 24 Apr 2009 10:23:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82938 invoked by uid 99); 24 Apr 2009 10:23:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 10:23:21 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of cdoronc@gmail.com designates 74.125.78.25 as permitted sender)
Received: from [74.125.78.25] (HELO ey-out-2122.google.com) (74.125.78.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 10:23:14 +0000
Received: by ey-out-2122.google.com with SMTP id 22so212569eye.53
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 03:22:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=BHzpG0A1J7lm7eyXBgtNIIds1ksquWOAAjf9TfE6Xe0=;
        b=IIUrgdrGvH5kt2ubnrr4ZNGr0x0EtTcTclj5zjBuPKJdIruvfE4iYA09Yq1fHEmwL+
         gxzMkKDG/9RvtoWC1wahQ9kzy0W5Ok6Azb17rHSWh1uN964VZOXvNZQvhn5NbMYCEbvg
         3xA/XtOK0Qr9Vl9X+NvuYlVWC3NWE4AUrdLvk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=L8ZkHw8CkFdpj6744QJphwXRmXJ4QBmTFmyu6p5yQ/5MhqNj+NzkEOnJ+Cc6bi1fR3
         TR3cYBZ8UxS8ExtHbJvNNatQ6MTVcG5IXbitwHTDvZkQYIOLUnOiqGxEfsC/1FaP+1oy
         bCiehjYqGjkAJ9SFVs7fW5Ttr7bzwSLNsiFKc=
MIME-Version: 1.0
Received: by 10.210.13.17 with SMTP id 17mr1092668ebm.32.1240568573569; Fri, 
	24 Apr 2009 03:22:53 -0700 (PDT)
In-Reply-To: <036829964E44B44F80A0D168BB9849E1018C625F@VOO-EXCHANGE04.internal.sungard.corp>
References: <036829964E44B44F80A0D168BB9849E1018C624B@VOO-EXCHANGE04.internal.sungard.corp>
	 <036829964E44B44F80A0D168BB9849E1018C625F@VOO-EXCHANGE04.internal.sungard.corp>
Date: Fri, 24 Apr 2009 13:22:53 +0300
Message-ID: <e05f0fd10904240322j5a30af3fvd6b496db98244adb@mail.gmail.com>
Subject: Re: Error: there are more terms than documents...
From: Doron Cohen <cdoronc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c3cca25acbe04684a612e
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c3cca25acbe04684a612e
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

On Thu, Apr 23, 2009 at 11:52 PM, <Bill.Chesky@sungard.com> wrote:

> I figured it out.  We are using Hibernate Search and in my ORM class I
> am doing the following:
>
> @Field(index=Index.TOKENIZED,store=Store.YES)
> protected String objectId;
>
> So when I persisted a new object to our database I was inadvertently
> creating a document in the Lucene index with the tokenized and stored
> field "objectId".  This is a left over from when we were letting
> Hibernate Search build our index for us.  We're now building the index
> ourselves so I think if I just remove this, it should work ok.


Great!

Doron

--0015174c3cca25acbe04684a612e--

From java-user-return-39924-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 13:48:21 2009
Return-Path: <java-user-return-39924-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17261 invoked from network); 24 Apr 2009 13:48:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 13:48:21 -0000
Received: (qmail 40527 invoked by uid 500); 24 Apr 2009 13:48:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40455 invoked by uid 500); 24 Apr 2009 13:48:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40445 invoked by uid 99); 24 Apr 2009 13:48:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 13:48:18 +0000
X-ASF-Spam-Status: No, hits=2.7 required=10.0
	tests=FUZZY_CREDIT,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 74.125.92.27 as permitted sender)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 13:48:07 +0000
Received: by qw-out-2122.google.com with SMTP id 5so925051qwd.53
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 06:47:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=pV2JyJFL48/YSQ4Dz9Af0J6CuhUvF3dRzwMb2BwWnAo=;
        b=RqSZWEIVt8uTmrgPONCkkf6/jQuJQzgDJ/36UQY0wchReHYKrw0uK+WAjVUm9eEPYy
         cw+0dBwYaBn6WJzjvycc/YnROpv5Ba6AlmaWbqo45bnujgI+rH5Rfuw997b87IkfFAHb
         7biy2LVKClAnaI5LSsST4nDhNKkMddmd8rGm8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=cJtAAXPOIUTQLYVrOKbbbBeyhSJF8sTVPu9DCWMTbdQWsqnuGQucNSMK3CKXSAN4TT
         qQFncRepx2rHacaBzzl6eX+ac3UdjatqO+YaPQDN4yThCfwvNxI28SUBrlMLe6j8GYV/
         MxNj19ACCT4gqHKrb9eX+ItUw1jwASMbCsm2Q=
MIME-Version: 1.0
Received: by 10.220.45.131 with SMTP id e3mr4512960vcf.89.1240580865167; Fri, 
	24 Apr 2009 06:47:45 -0700 (PDT)
In-Reply-To: <23211629.post@talk.nabble.com>
References: <D262A1FB331DC344AA0B896F390D5569016E3E8C@exchhyd.machcorp.lan>
	 <359a92830904210735g24df775cx4bfa11774ac6161c@mail.gmail.com>
	 <23170710.post@talk.nabble.com>
	 <359a92830904220551x23da922ftdbae71d18210538@mail.gmail.com>
	 <23190583.post@talk.nabble.com>
	 <359a92830904230634x2f13ef20r1b0e1599531f8dd9@mail.gmail.com>
	 <23211629.post@talk.nabble.com>
Date: Fri, 24 Apr 2009 09:47:45 -0400
Message-ID: <359a92830904240647r3d73ebb3x6ae84bb209dbc462@mail.gmail.com>
Subject: Re: How to search special characters in LUcene
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6470526c898eb04684d3d6e
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6470526c898eb04684d3d6e
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

I'm puzzled why you say

"By the above out put we can say that StandardAnalyzer is
enough to get rid  of danish elements."

It does NOT get rid of the accents, according to your own output.
If your goal is to go ahead and index multiple language documents
in a single index then search it, I'd recommend using the
ISOLatin1AccentFilter. Compare the output of an analyzer like:

public class MyAnalyzer extends StandardAnalyzer {
    public TokenStream tokenStream(String s, Reader reader) {
        return new ISOLatin1AccentFilter(super.tokenStream(s, reader));
    }
}
 and you'll see that all the accents disappear, which will play much
more nicely with queries that don't have accents.

Best
Erick

On Fri, Apr 24, 2009 at 3:53 AM, uday kumar maddigatla <ukma@mach.com>wrote=
:

>
> Hi Thanks for your reply.
>
> After gone threw with the site which you given... i understood that
> StandardAnalyzer is enough to handle these special characters.
>
> i'm attaching one class called AnalysisDemo.java. By executing that class
> i'm able to say the above sentance(i.e StandardAnalyzer is enough).
>
> Here is the out put when i ran the above java file.
> Analzying "Vedr.           :   Amtsg=E5rden =C5rhus, Lyseng All=E9 1, 827=
0
> H=F8jbjerg"
>        org.apache.lucene.analysis.WhitespaceAnalyzer:
>                [Vedr.] [:] [Amtsg=E5rden] [=C5rhus,] [Lyseng] [All=E9] [1=
,]
> [8270] [H=F8jbjerg]
>
>        org.apache.lucene.analysis.SimpleAnalyzer:
>                [vedr] [amtsg=E5rden] [=E5rhus] [lyseng] [all=E9] [h=F8jbj=
erg]
>
>        org.apache.lucene.analysis.StopAnalyzer:
>                [vedr] [amtsg=E5rden] [=E5rhus] [lyseng] [all=E9] [h=F8jbj=
erg]
>
>        org.apache.lucene.analysis.standard.StandardAnalyzer:
>                [vedr] [amtsg=E5rden] [=E5rhus] [lyseng] [all=E9] [1] [827=
0]
> [h=F8jbjerg]
>
>        org.apache.lucene.analysis.snowball.SnowballAnalyzer:
>                [vedr] [amtsg=E5rden] [=E5rhus] [lyseng] [all=E9] [1] [827=
0]
> [h=F8jbjerg]
>
> By the above out put we can say that StandardAnalyzer is enough to get ri=
d
> of danish elements.
>
> But only problem is when i'm searching the any term which includes the
> danish elements(like h=F8jbjerg...)
>
> it is unable to find out.
>
> Even i checked with LUKE. In that  i given my sample text which contains
> the
> danish elements and selected the StandardAnalyzer as analyser. when i cli=
ck
> analyze in that it cleary making index of danish words.
>
> and also i givne one try on luke by loading my index directory in to luke=
.
> after loading my index i searched for a word which contains the danish
> element, But this time it was failed. It was shown nothing(i.e o resluts)=
.
>
> As in my sense the problem might be making the indexes or in searching th=
e
> item.
>
>
> I gone threw the site which you given. From that i'm able to do this kind
> of
> reaserch work.
>
> Please help me in this.
>
>
> Erick Erickson wrote:
> >
> > OK, this is a much different problem than you were originally
> > asking about, effectively "how to index/search mixed language
> > documents".
> >
> > This topic has been discussed multiple times on the user list, I
> > think your first step should be to search the archive. I *was*
> > going to find the old searchable mail archive, but those clever folks
> > at Lucid Imagination have something new, see:
> >
> > http://www.lucidimagination.com/search/p:lucene?q=3Dmultiple+languages
> >
> > Once you've had a chance to look that over I think you'll be off and
> > running.
> >
> > Best
> > Erick
> >
> > On Thu, Apr 23, 2009 at 1:43 AM, uday kumar maddigatla
> > <ukma@mach.com>wrote:
> >
> >>
> >> HI
> >>
> >> Here are the details about my goals.
> >> 1. I want to use this lucene for mixed languages.
> >> 2. I want to make indexes of the documents which are either english or
> >> danish etc.
> >> I'm attaching my IndexFiles.java file.
> >>
> >> When i'm searching i'm giving the index path location  as well as
> >> doucmets
> >> folder.
> >>
> >> If i use StandardAnalyzer as an argument to IndexWriter's method it is
> >> able
> >> to search the english characters.
> >>
> >> How can i use DutchAnalyzer in order to make this IndexFiles.java to
> >> index
> >> the danish elements.
> >>
> >> In my Code which i attached, you can see 'C:\test3'. This is my locati=
on
> >> where i want to store my indexes.
> >>
> >> I'm giving documents folder location as comand line argument.
> >>
> >> In my document the content will be like this
> >>
> >> <com:Note><![CDATA[Kreditnota til udligning af faktura nr. 13927 pga
> skal
> >> opsplittes
> >> hhv. byggeplads og skat
> >> Vedr.           :   Amtsg=E5rden =C5rhus, Lyseng All=E9 1, 8270 H=F8jb=
jerg
> >> Bygning B
> >> SES Journal nr. :   42895-0001
> >> SES Navision nr.:   Navision 9800124
> >> SES Ansvarlig   :   Martin Kr=F8ldrup Nielsen
> >> SES r=E5dgiver    :   Friis & Moltke A/S
> >> Hermed fremsendes faktura p=E5 ekstra t=F8mrerarbejde.
> >> Byggeplads Amtsg=E5rden B-4
> >> jvf. vedlagte specifikation - aftaleseddel nr. 12.]]></com:Note>
> >>
> >> i"m searching the word like r=E5dgiver . When i see the result it is
> >> clearly
> >> searching for r dgiver. It is omitting the danish element.
> >>
> >> Please help me in this.
> >>
> >>
> >>
> >> Erick Erickson wrote:
> >> >
> >> > Are you *also* using the DutchAnalyzer for your *query*?
> >> >
> >> > Please show us the index and search code (simplified as much
> >> > as possible), then we'll be able to provide better suggestions.
> >> >
> >> > Also, tell us a bit more about your goals here. Is this an
> >> > index entirely of Dutch documents? Or is it a mixed-language
> >> > index?
> >> >
> >> > Think about getting a copy of Luke and
> >> > 1> examining your index to see what's *really* there
> >> > 2> examining the effects of using different parsers on
> >> >      your *query*.
> >> >
> >> > Best
> >> > Erick
> >> >
> >> > On Wed, Apr 22, 2009 at 2:57 AM, uday kumar maddigatla
> >> > <ukma@mach.com>wrote:
> >> >
> >> >>
> >> >> Hi
> >> >>
> >> >> Thanks for your reply.
> >> >>
> >> >> I'm able to see the DutchAnalyzer.
> >> >>
> >> >> When i'm indexing my documents i given instace of DutchAnalyzer as =
an
> >> >> argument to IndexWriter Class.
> >> >>
> >> >> After this when i search for the
> >> >> http://www.nabble.com/file/p23170710/IndexFiles.java IndexFiles.jav=
a
> >> >> contains the danish elements .. Still it is not able to identify.
> >> >>
> >> >> Please tell me how to use DutchAnalzer in my application. Sample
> >> example
> >> >> or
> >> >> series of steps helps me.
> >> >>
> >> >> I also attached my index file(.java file).
> >> >>
> >> >> Please help me in this. please..
> >> >>
> >> >> Erick Erickson wrote:
> >> >> >
> >> >> > Take a look at DutchAnalyzer. The problem you'll have is if you'r=
e
> >> >> > indexing
> >> >> > this document along with a bunch of documents from other language=
s.
> >> >> > You could search the mail archive for extensive discussions of
> >> >> indexing/
> >> >> > searching documents from several languages.
> >> >> >
> >> >> > Best
> >> >> > Erick
> >> >> >
> >> >> > On Tue, Apr 21, 2009 at 2:40 AM, Uday Kumar Maddigatla
> >> >> > <ukma@mach.com>wrote:
> >> >> >
> >> >> >> HI,
> >> >> >>
> >> >> >>
> >> >> >>
> >> >> >> I'm new to the lucene. I downloaded lucene 2.4.1.
> >> >> >>
> >> >> >>
> >> >> >>
> >> >> >> I have one xml file which contains few special characters like
> '=E5',
> >> >> '=F8,'
> >> >> >> =B0'
> >> >> >> etc.(these are Danish language elements).
> >> >> >>
> >> >> >>
> >> >> >>
> >> >> >> How can I search these things.
> >> >> >>
> >> >> >>
> >> >> >>
> >> >> >>
> >> >> >>
> >> >> >> Uday Kumar  Reddy Maddigatla
> >> >> >>
> >> >> >> Software Engineer(Progrator|gatetrade)
> >> >> >>
> >> >> >> MACH India(Operations)
> >> >> >>
> >> >> >> Mobile: + 91-9963000377
> >> >> >>
> >> >> >> Uday.Maddigatla@ness.com <mailto:Uday.Maddigatla@ness.com>
> >> >> >>
> >> >> >> ukma@mach.com <mailto:ukma@mach.com>
> >> >> >>
> >> >> >> www.ness.com
> >> >> >>
> >> >> >>
> >> >> >>
> >> >> >>
> >> >> >>
> >> >> >>
> >> >> >
> >> >> >
> >> >>
> >> >> --
> >> >> View this message in context:
> >> >>
> >>
> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp231500=
39p23170710.html
> >> >> Sent from the Lucene - Java Users mailing list archive at Nabble.co=
m.
> >> >>
> >> >>
> >> >> -------------------------------------------------------------------=
--
> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >>
> >> >>
> >> >
> >> >
> >> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
> >> http://www.nabble.com/file/p23190583/SearchFiles.java SearchFiles.java
> >> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
> >> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
> >> --
> >> View this message in context:
> >>
> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp231500=
39p23190583.html
> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> >
> http://www.nabble.com/file/p23211629/AnalysisDemo.java AnalysisDemo.java
> --
> View this message in context:
> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp231500=
39p23211629.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6470526c898eb04684d3d6e--

From java-user-return-39925-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 14:24:00 2009
Return-Path: <java-user-return-39925-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44245 invoked from network); 24 Apr 2009 14:24:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 14:24:00 -0000
Received: (qmail 10569 invoked by uid 500); 24 Apr 2009 14:23:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10525 invoked by uid 500); 24 Apr 2009 14:23:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10512 invoked by uid 99); 24 Apr 2009 14:23:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 14:23:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [62.213.161.134] (HELO pmx.sirma.bg) (62.213.161.134)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 14:23:49 +0000
X-Virus-Scanned: Sirma Antivirus System
Received: from [192.168.128.140] (ivasilev.sirma.int [192.168.128.140])
	by pmx.sirma.bg (Sirma mail system) with ESMTP id 41BFC244CBF
	for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 17:23:29 +0300 (EEST)
Message-ID: <49F1CB61.4030108@sirma.bg>
Date: Fri, 24 Apr 2009 17:23:29 +0300
From: Ivan Vasilev <ivasilev@sirma.bg>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: SpanQuery wildcards?
References: <49F08C50.20507@sirma.bg>
In-Reply-To: <49F08C50.20507@sirma.bg>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Guys for the answers!

Steven, I tried with the ".*" instead of "*" but it did not worked as 
desired. The ".*" does not replace any symbol(s) in the query. I tested 
with different Analyzers. Depending on Analyzer it is omitted or ".*" 
are treated just as normal symbols.

Mark, your class ComplexPhraseQueryParser attached in 
https://issues.apache.org/jira/browse/LUCENE-1486 really does the job. 
Do you know if it interferes the performance? Also do you know if it 
could lead to Exceptions like TooManyClauses Exception or similar?
If your class does not impact the performance and not cause such 
Exceptions, then it should replace the Lucene's QueryParser, isn't it? 
Otherwise before parsing query we should do some preliminary estimation 
if it is Span query with wildcards and use the ComplexPhraseQueryParser 
only in that case.

Best Regards,
Ivan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39926-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 15:57:38 2009
Return-Path: <java-user-return-39926-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95878 invoked from network); 24 Apr 2009 15:57:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 15:57:38 -0000
Received: (qmail 14805 invoked by uid 500); 24 Apr 2009 15:57:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14772 invoked by uid 500); 24 Apr 2009 15:57:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14748 invoked by uid 99); 24 Apr 2009 15:57:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 15:57:34 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.26 as permitted sender)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 15:57:24 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 24571322376
	for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 11:57:04 -0400 (EDT)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Fri, 24 Apr 2009 11:57:04 -0400
X-Sasl-enc: 5vEWDppOxfPEP+sv858S/8HcEG7r4Iu69ylB8iwH7hJw 1240588623
Received: from [192.168.2.50] (cpc2-leed4-0-0-cust912.leed.cable.ntl.com [81.105.111.145])
	by mail.messagingengine.com (Postfix) with ESMTPA id 91AF766D9
	for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 11:57:03 -0400 (EDT)
Message-ID: <49F1E14C.7080308@fastmail.fm>
Date: Fri, 24 Apr 2009 16:57:00 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: no segments* file found: files: Error on opening index
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi I was using a RAMDirectory and this was working fine but have now 
moved over to a  filesystem directory to preserve space, the directory 
is just initialized once
    directory = new RAMDirectory();
    directory = 
FSDirectory.getDirectory(Platform.getPlatformLicenseFolder()+ "/" + 
TAG_BROWSER_INDEX);

but I create an IndexReader as required
     IndexReader ir = IndexReader.open(directory);
and then close it when Ive finished with it.

but sometimes it is failing with
    no segments* file found: files:
interestingly no file is specified in the error message whereas other 
reporters of this message show a reference to an actual file in the message.

My code is multithreaded so Im wondering if the problem is that two 
thread have both opened an IndexReader, or one thread is using an 
IndexWriter to add a document, whilst another is trying to read. But I 
wasnt aware either of these cases was not allowed, any ideas ?

thanks Paul



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39927-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 16:09:57 2009
Return-Path: <java-user-return-39927-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1125 invoked from network); 24 Apr 2009 16:09:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 16:09:57 -0000
Received: (qmail 43787 invoked by uid 500); 24 Apr 2009 16:09:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43729 invoked by uid 500); 24 Apr 2009 16:09:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43718 invoked by uid 99); 24 Apr 2009 16:09:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 16:09:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.61] (HELO web50307.mail.re2.yahoo.com) (206.190.38.61)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 24 Apr 2009 16:09:43 +0000
Received: (qmail 59867 invoked by uid 60001); 24 Apr 2009 16:09:22 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1240589362; bh=KBmId7NoqegtI7bGKHKZo0zloRtIva8ukrGYoVr7yt8=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=i4ENNdis8QGcwolXQcKn2gf+fTLZJj1Xp6KJsKJYdW8cKGrXclii4vzVoo4NiWc9xZXealb7XYA4QAzEnAmbRm7RPo80u+RSzneLx7Ld86LWh4AMc55p9nJxmxb/vCTqpPPZ5FKT72KVbuKy49xohLHLZrEA/thwmszCpjuHpY4=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=i9863PKoNSESzE3KGCNSFPnl0nEzYj8W1CPWl6W51Cehuq5mo9qg1ajcSXKWFJKL/D9u7Y9NmWy75xsHswot23BMF09yh259J78hnmEJtMYauZt4AxOElJnuKxefT5gmZbOyjzvumBZxl5h26XZqOryWsiKpSAOm9XYR9k1CWAE=;
Message-ID: <703951.59256.qm@web50307.mail.re2.yahoo.com>
X-YMail-OSG: BNTlrlEVM1mrC4kbWIRC9_.th4FdvFBVlJjALyPgsp_DAMdv_MolYKnys8AD5ZVKGiw6XkESjDJH4QHCQ0c0KpTuxnrtLZN53Cop3J_.HtMTomNCfJKRvS9yxUjJgddj5NB50CttQoPTzL9KAitCT.FoPc98d4Aa4qFgQiKDp1fWUNWi9CQ7qZ89FyHRvrbIiWz3g.Sis3Q9hAb4_AdEwttDGUr.Odt9f3e_MxTKETTTiNyEYxIGOswvmmfLYDqjw0VI6fy0ftIt02hWePUps_iXR8WU6KMVr8kcf_Y5MO.mVHQCwR51QwA0
Received: from [74.73.31.128] by web50307.mail.re2.yahoo.com via HTTP; Fri, 24 Apr 2009 09:09:22 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <F8A04958BB57B64096F9BE6B9572564304C73BB9@FMD3VS012.fda.gov> <273311.72887.qm@web50310.mail.re2.yahoo.com> <F8A04958BB57B64096F9BE6B9572564304C73BBA@FMD3VS012.fda.gov>
Date: Fri, 24 Apr 2009 09:09:22 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Wordnet indexing error
To: java-user@lucene.apache.org
In-Reply-To: <F8A04958BB57B64096F9BE6B9572564304C73BBA@FMD3VS012.fda.gov>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org


Nothing that marries WordNet with Lucene other than that syns stuff exists in Lucene contrib (but it may exist on SourceForce, in Google Code, etc.).  There are several WordNet java libraries you could use to combing WN and Lucene:

   http://www.simpy.com/user/otis/search/wordnet

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch



----- Original Message ----
> From: "Sudarsan, Sithu D." <Sithu.Sudarsan@fda.hhs.gov>
> To: java-user@lucene.apache.org
> Sent: Friday, April 10, 2009 9:51:39 AM
> Subject: RE: Wordnet indexing error
> 
> 
> Thanks Otis,
> 
> Yes, we figured that out! Since, we do not intend to migrate to 2.4 yet,
> we used the syns2index source code from svn. The problem is now taken
> care.
> 
> This part is for all: 
> 
> This brings us to the next question: 
> 
> 1. Is there some contrib code available for using hypernyms and such, in
> addition to synonyms from Wordnet?
> 2. Is there some code to add user defined dictionary/ontology, as an
> additional layer to Wordnet (some sort of multi-level)?
> 
> Thank you all in advance,
> 
> Sincerely,
> Sithu 
> 
> -----Original Message-----
> From: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com] 
> Sent: Thursday, April 09, 2009 1:06 AM
> To: java-user@lucene.apache.org
> Subject: Re: Wordnet indexing error
> 
> 
> Hi,
> 
> The simplest thing to do is to grab the latest Lucene and the latest jar
> for that Wordnet (syns2index) code.  That should work for you (that
> UnIndexed method is an old method that doesn't exist any more).
> 
> 
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
> 
> 
> 
> ----- Original Message ----
> > From: "Sudarsan, Sithu D." 
> > To: java-user@lucene.apache.org
> > Sent: Wednesday, April 8, 2009 7:01:16 PM
> > Subject: Wordnet indexing error
> > 
> > Hi All,
> > 
> > We're using Lucene 2.3.2 on Windows. When we try to generate index for
> > WordNet2.0 using Syns2Index class, while indexing, the following error
> > is thrown:
> > 
> > Java.lang.NoSuchMethodError:
> >
> org.apache.lucene.document.Field.UnIndexed(Ljava/lang/String;Ljava/lang/
> > String;)Lorg/apache/lucene/document/Field;
> > 
> > Our code is looks like this:
> > 
> > String[] filelocations = {"path/to/prolog/file", "path/to/index"};
> > try{
> >      Syns2Index.main(filelocations);
> > } catch ....
> > 
> > 
> > The error typically happens at about line number 130000 in the wn_s.pl
> > file.
> > 
> > No luck with WordNet3.0 as well. We get the same error.
> > 
> > Any fix or solutions? 
> > 
> > Thanks in advance,
> > Sithu D Sudarsan
> > 
> > sithu.sudarsan@fda.hhs.gov
> > sdsudarsan@ualr.edu
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39928-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 16:15:43 2009
Return-Path: <java-user-return-39928-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5523 invoked from network); 24 Apr 2009 16:15:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 16:15:43 -0000
Received: (qmail 52843 invoked by uid 500); 24 Apr 2009 16:15:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52788 invoked by uid 500); 24 Apr 2009 16:15:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52778 invoked by uid 99); 24 Apr 2009 16:15:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 16:15:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.55] (HELO web50301.mail.re2.yahoo.com) (206.190.38.55)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 24 Apr 2009 16:15:30 +0000
Received: (qmail 94710 invoked by uid 60001); 24 Apr 2009 16:15:08 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1240589708; bh=OWXJFXRY6FGFp3az/DVprIiRuTOaFNXwkqIYKU3dtuM=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=5SkH6ASSXhoLvcBq4paFz4o35UqXxspq1GVY+IEJv+Fjhu33s4szl/8xkSyP8yXBgFA8HmcyAthkFBapz98zr1E5iyeG6QR+NWmf881e9BuJ3BraHR9G5wKDdBG0oPaPuJ6CQeWks733XPDqWmWs+n2ZXfp1rBIE8epVTbv/YRU=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=iWxn4aoVIz4NLTIq8N02gY4Fn1yblESPLGiQ+SWEpK9s+AU4qpyIZj0QTbLWbZMZQRMPo4/u4FB0jjvdJnbA5u61SLOAK1f6wz23khA68/bhun5z0bzt6da+Ip0Nfv6FBVuzi7MpZRdufi/yl1912TmU2eh0zCr6XmSm4pHnb50=;
Message-ID: <785513.90606.qm@web50301.mail.re2.yahoo.com>
X-YMail-OSG: hli4BeQVM1k_QffaBm9VHw2B4ysPCQBL77_nyonavOWEOwYMMNAxkVQpQwAKdemrCzr3_5iB9WeTSj3FF5QmHcvga_0jnR_ZW4.ygfVsEw1JtFllO2sIif5rs3uMxoB.Mx4EMqyc0b0WC.k1tRa1ALf3q6_ybyNygznmDSseVVsqHVqWCk4uY.us23Fs6u.K1NxT8HpLAaExgh1KsBUNiaAU3GibhOTh5Ou1_SgRYHYeOR8OfTi6r7t.berlQn0cQPvIHbn1g.4IYXIO3X_zHWZuYI4FjnYVvOra5HExpECgf5aBrd5AKcY7
Received: from [74.73.31.128] by web50301.mail.re2.yahoo.com via HTTP; Fri, 24 Apr 2009 09:15:08 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <531416.74512.qm@web110211.mail.gq1.yahoo.com>
Date: Fri, 24 Apr 2009 09:15:08 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Index in text format
To: java-user@lucene.apache.org
In-Reply-To: <531416.74512.qm@web110211.mail.gq1.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org


No.  But you could look at an existing index, pull out one Document at a time, pull out any stored Field values from each Document, and write those to a text file.  You'd have to write the code for this yourself.


Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch



----- Original Message ----
> From: Andy <andykan1984@yahoo.com>
> To: java-user@lucene.apache.org
> Sent: Thursday, April 9, 2009 3:56:44 PM
> Subject: Index in text format
> 
> Is there a way to have lucene to write index in a txt file?


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39929-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 16:37:24 2009
Return-Path: <java-user-return-39929-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17862 invoked from network); 24 Apr 2009 16:37:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 16:37:23 -0000
Received: (qmail 94212 invoked by uid 500); 24 Apr 2009 16:37:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94132 invoked by uid 500); 24 Apr 2009 16:37:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94122 invoked by uid 99); 24 Apr 2009 16:37:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 16:37:20 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.217.164] (HELO mail-gx0-f164.google.com) (209.85.217.164)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 16:37:12 +0000
Received: by gxk8 with SMTP id 8so2496316gxk.5
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 09:36:37 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.205.13 with SMTP id c13mr4064522ybg.39.1240590997882; Fri, 
	24 Apr 2009 09:36:37 -0700 (PDT)
Date: Fri, 24 Apr 2009 13:36:37 -0300
Message-ID: <ed88cb980904240936n67029511x9d759b2da8ff4b74@mail.gmail.com>
Subject: Low-memory searcher
From: Douglas Campos <douglas@theros.info>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd48300bd86e204684f99c6
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd48300bd86e204684f99c6
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

Hi!

Is there any way to reduce memory footprint doing a search over a very large
index (20G). I've getting OOMs with 512m heap!

cheers

-- 
Douglas Campos
Theros Consulting
+55 11 9267 4540
+55 11 3020 8168

--000e0cd48300bd86e204684f99c6--

From java-user-return-39930-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 16:38:00 2009
Return-Path: <java-user-return-39930-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18014 invoked from network); 24 Apr 2009 16:38:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 16:38:00 -0000
Received: (qmail 95995 invoked by uid 500); 24 Apr 2009 16:37:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95926 invoked by uid 500); 24 Apr 2009 16:37:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95916 invoked by uid 99); 24 Apr 2009 16:37:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 16:37:57 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.26 as permitted sender)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 16:37:49 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id A4BCA322B44
	for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 12:37:28 -0400 (EDT)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Fri, 24 Apr 2009 12:37:28 -0400
X-Sasl-enc: cNAEtTSLmmRUD0vVlcUQtFT+6+TYbPC/zCrBLhQqv8ge 1240591048
Received: from [192.168.2.50] (cpc2-leed4-0-0-cust912.leed.cable.ntl.com [81.105.111.145])
	by mail.messagingengine.com (Postfix) with ESMTPA id 394B63255D
	for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 12:37:28 -0400 (EDT)
Message-ID: <49F1EAC5.3080003@fastmail.fm>
Date: Fri, 24 Apr 2009 17:37:25 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Stable version ogf Lucene 2.9
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi

I would like to upgrade to Lucene 2.9, I can see the daily builds on 
Hudson, should I just take the last work that worked, or ar ethere any 
particular builds that have been tested and hence are possibly more stable.

thanks Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39931-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 16:52:57 2009
Return-Path: <java-user-return-39931-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30526 invoked from network); 24 Apr 2009 16:52:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 16:52:57 -0000
Received: (qmail 28166 invoked by uid 500); 24 Apr 2009 16:52:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28104 invoked by uid 500); 24 Apr 2009 16:52:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27806 invoked by uid 99); 24 Apr 2009 16:52:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 16:52:53 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [87.248.110.139] (HELO n22.bullet.mail.ukl.yahoo.com) (87.248.110.139)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 24 Apr 2009 16:52:43 +0000
Received: from [217.146.182.177] by n22.bullet.mail.ukl.yahoo.com with NNFMP; 24 Apr 2009 16:52:21 -0000
Received: from [87.248.110.115] by t3.bullet.ukl.yahoo.com with NNFMP; 24 Apr 2009 16:52:21 -0000
Received: from [127.0.0.1] by omp220.mail.ukl.yahoo.com with NNFMP; 24 Apr 2009 16:52:24 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 76187.51867.bm@omp220.mail.ukl.yahoo.com
Received: (qmail 7052 invoked by uid 60001); 24 Apr 2009 16:52:21 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1240591941; bh=KkM7kAUq+hJBbHWVAuO1AyrRR2b9a6ULvRjosIwzuRM=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=aY/R9MmLOKWlm/shOHRktJr83zzT4KHuSc4bTHsK64YtbPsMpJ7Hs9BEmxuGl/uI9wRF1R4yFOFt90BgyDpo9TnClybVuJVI8keE1hBadd5G+VX+OoEfsUYnq2MnkPl8dQzkq3BQm3WrG1XB39WIbgZO93MfmOC5Q53izC6wQKg=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=akrPIGoKqLRhw2BLGpTtR36If1EohLMhCUYXNzzsooVUWgh0t1ET1HWQC+2JJDXplU5SQrNVfojGbt5lmL7685qdD+tYcsImmln3czYVLC6w05FMhsrm0kE8da1EV6MnsXBvoAxxb5fC3gL8rHGWNAZqeqVtqOypcPGxYtetuaU=;
Message-ID: <483364.6240.qm@web24715.mail.ird.yahoo.com>
X-YMail-OSG: QkRzzHwVM1mVTpqbgg_ce2y7yNv96LM39f0V2wQs8c8BGyggAlPBIAVBSOp6fWUj3wny1.Uk.UTRdN12GD1CbnUD_5HbUXtv8JspLI2zQR7ccCwzOeWXCsU71b7uufwR47tVKXTABuSAIZCg9II3lSbW1jow1Ln3M5WB3nGEaRcdjVmEKg66QyEeyl8dOmbQRLKGnko3qO_Z68BaSTMWoZs23SidsykS9I6QK9onJuEBrm_bBzxqH.HIdKVRTBCoa6.LRo8n2jXarQV4Rojke4vZp_QNcJQsMQxva44vvSD8TwoU1sU9tWwKHAchIW9iGtJsCBi42jfKhekvcUNoodU-
Received: from [193.36.230.96] by web24715.mail.ird.yahoo.com via HTTP; Fri, 24 Apr 2009 09:52:21 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <ed88cb980904240936n67029511x9d759b2da8ff4b74@mail.gmail.com>
Date: Fri, 24 Apr 2009 09:52:21 -0700 (PDT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: Low-memory searcher
To: java-user@lucene.apache.org
In-Reply-To: <ed88cb980904240936n67029511x9d759b2da8ff4b74@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org


See IndexReader.setTermInfosIndexDivisor() for a way to help reduce memory =
usage without needing to re-index.=0A=0AIf you have indexed fields with omi=
tNorms off (the default) you will be paying a 1 byte per field per document=
 memory cost and may need to look at re-indexing=0A=0ACheers=0AMark=0A=0A=
=0A=0A----- Original Message ----=0AFrom: Douglas Campos <douglas@theros.in=
fo>=0ATo: java-user@lucene.apache.org=0ASent: Friday, 24 April, 2009 17:36:=
37=0ASubject: Low-memory searcher=0A=0AHi!=0A=0AIs there any way to reduce =
memory footprint doing a search over a very large=0Aindex (20G). I've getti=
ng OOMs with 512m heap!=0A=0Acheers=0A=0A-- =0ADouglas Campos=0ATheros Cons=
ulting=0A+55 11 9267 4540=0A+55 11 3020 8168=0A=0A=0A=0A      


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39933-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 17:23:21 2009
Return-Path: <java-user-return-39933-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43549 invoked from network); 24 Apr 2009 17:23:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 17:23:21 -0000
Received: (qmail 85116 invoked by uid 500); 24 Apr 2009 17:23:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85052 invoked by uid 500); 24 Apr 2009 17:23:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85000 invoked by uid 99); 24 Apr 2009 17:23:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 17:23:17 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.200.171] (HELO wf-out-1314.google.com) (209.85.200.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 17:23:08 +0000
Received: by wf-out-1314.google.com with SMTP id 24so933294wfg.20
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 10:22:46 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.186.15 with SMTP id j15mr777178wff.205.1240593765072; Fri, 
	24 Apr 2009 10:22:45 -0700 (PDT)
In-Reply-To: <49EE4E33.30901@cisco.com>
References: <49EE4E33.30901@cisco.com>
Date: Fri, 24 Apr 2009 13:22:45 -0400
Message-ID: <9ac0c6aa0904241022h6f83983ao9227319e5cbef073@mail.gmail.com>
Subject: Re: Getting Top n term for a given field for a given time period
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Make a RangeFilter that visits only docs in your time period, then run
a search w/ a custom HitCollector that looks at the source of each doc
and tallies up the results?  For performance, you'll probably need to
load the source using FieldCache (FieldCache.DEFAULT.getStrings(...)).

Or, use Solr's faceted search, or http://www.browseengine.com, or some
other facets impl, to tally up the sources.

Mike

On Tue, Apr 21, 2009 at 6:52 PM, Preetham Kajekar <preetham@cisco.com> wrote:
>
> Hi,
> I have a lucene index which has 20 mil documents. Each document has a
> timestamp field and a source field. I am interested in finding the top n
> sources for a given hour (based on the timestamp). I know we can get the top
> n sources fields easily using the IndexReader API, but was wondering if I
> can get that top n for a certain period of time ?
>
> Thx,
> ~preetham
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39932-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 17:25:34 2009
Return-Path: <java-user-return-39932-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44989 invoked from network); 24 Apr 2009 17:25:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 17:25:25 -0000
Received: (qmail 54930 invoked by uid 500); 24 Apr 2009 17:14:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46009 invoked by uid 500); 24 Apr 2009 17:14:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42460 invoked by uid 99); 24 Apr 2009 17:13:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 17:13:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [171.67.219.89] (HELO smtp-roam.stanford.edu) (171.67.219.89)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 17:13:19 +0000
Received: from smtp-roam.stanford.edu (localhost.localdomain [127.0.0.1])
	by localhost (Postfix) with SMTP id 9615377A4B
	for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 10:12:54 -0700 (PDT)
Received: from [192.168.1.100] (adsl-76-220-111-235.dsl.pltn13.sbcglobal.net [76.220.111.235])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: bethard)
	by smtp-roam.stanford.edu (Postfix) with ESMTPSA id CC23377AF4
	for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 10:12:53 -0700 (PDT)
Message-ID: <49F1F312.40907@stanford.edu>
Date: Fri, 24 Apr 2009 10:12:50 -0700
From: Steven Bethard <bethard@stanford.edu>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: exponential boosts
References: <49DFA47C.3010906@stanford.edu> <49DFE0B8.4080208@stanford.edu>	 <49E23210.5000209@stanford.edu>	 <7e536b1f0904231338u49b32551rbe9c2f89f4f58a7b@mail.gmail.com>	 <e05f0fd10904231358v2ec49ddand9fbe2fa9d0508b1@mail.gmail.com>	 <7e536b1f0904231407v1083b060obb8a6173eb06227a@mail.gmail.com>	 <7e536b1f0904231408g77a4416gd9f2d1fb6ff3e091@mail.gmail.com>	 <49F0DD6F.6070606@stanford.edu> <e05f0fd10904240316n2bcc9f6jfbf0cab27c99804d@mail.gmail.com>
In-Reply-To: <e05f0fd10904240316n2bcc9f6jfbf0cab27c99804d@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On 4/24/2009 3:16 AM, Doron Cohen wrote:
> On Fri, Apr 24, 2009 at 12:28 AM, Steven Bethard <bethard@stanford.edu>wrote:
> 
>> On 4/23/2009 2:08 PM, Marcus Herou wrote:
>>> But perhaps one could use a FieldCache somehow ?
>> Some code snippets that may help. I add the PageRank value as a field of
>> the documents I index with Lucene like this:
>>
>>    Document document = new Document();
>>    double pageRank = this.pageRanks.getCount(article.getId());
>>    document.add(new Field(
>>        PAGE_RANK_FIELD_NAME, Float.toString((float)pageRank),
>>        Field.Store.YES, Field.Index.NOT_ANALYZED));
> 
> 
> Note that there's no need to store this field - it is the indexed
> value which is  being used.

Thanks, that's good to know. I debated this for a while, but couldn't
tell for certain from the documentation.

Steve

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39934-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 17:25:45 2009
Return-Path: <java-user-return-39934-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47796 invoked from network); 24 Apr 2009 17:25:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 17:25:45 -0000
Received: (qmail 90524 invoked by uid 500); 24 Apr 2009 17:25:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90469 invoked by uid 500); 24 Apr 2009 17:25:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90459 invoked by uid 99); 24 Apr 2009 17:25:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 17:25:43 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.175] (HELO wf-out-1314.google.com) (209.85.200.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 17:25:35 +0000
Received: by wf-out-1314.google.com with SMTP id 24so933992wfg.20
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 10:25:15 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.211.7 with SMTP id j7mr780198wfg.28.1240593915301; Fri, 24 
	Apr 2009 10:25:15 -0700 (PDT)
In-Reply-To: <19095367.691240340442108.JavaMail.harini@harini-laptop>
References: <15981458.671240340381284.JavaMail.harini@harini-laptop>
	 <19095367.691240340442108.JavaMail.harini@harini-laptop>
Date: Fri, 24 Apr 2009 13:25:15 -0400
Message-ID: <9ac0c6aa0904241025p5992371cod13809e942d4009e@mail.gmail.com>
Subject: Re: Share Index on NFS
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Can you describe how you change the index?  EG are you committing very
frequently?

It's odd to get 1000+ files in the index in 10 minutes unless you are
committing frequently.

If so, you may need a smarter deletion policy that stays in touch w/
the readers to know precisely which commit point they are using so
that only those ones (and not every commit point < 80 minutes old)
need to be saved.

Mike

On Tue, Apr 21, 2009 at 3:01 PM, Harini Raghavan
<harini.raghavan@insideview.com> wrote:
> Hi Everyone,
>
> We are planning to distribute searches on the index and have a single ind=
exing node. We want to mount the index on NFS so that it can be shared by t=
he indexer and searcher nodes. To optimize several of our search workflows,=
 we are caching the IndexSearcher and refreshing it every hour. Also to imp=
rove the performance of some complex workflows, we are caching the Lucene d=
ocument ids. We are trying to set the deletion policy to ExpirationTimeDele=
tionPolicy to make use of the Lucene's NFS support. But since our IndexSear=
cher and doc id cache are refreshed only every 60 mins, we set the expirati=
on time to 80 mins. But this resulted in too many files being created in th=
e index directory. We got more than 1000 files in the index in less than 10=
 mins.
>
> This makes me wonder if the expiration time deletion policy fix will work=
 in our scenario. Should we be going fo some other solution to use NFS stor=
e?
>
> Thanks,
> Harini
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39935-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 17:30:26 2009
Return-Path: <java-user-return-39935-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54508 invoked from network); 24 Apr 2009 17:30:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 17:30:26 -0000
Received: (qmail 2846 invoked by uid 500); 24 Apr 2009 17:30:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2772 invoked by uid 500); 24 Apr 2009 17:30:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2762 invoked by uid 99); 24 Apr 2009 17:30:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 17:30:23 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.168] (HELO wf-out-1314.google.com) (209.85.200.168)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 17:30:17 +0000
Received: by wf-out-1314.google.com with SMTP id 24so935202wfg.20
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 10:29:55 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.230.9 with SMTP id c9mr785126wfh.101.1240594195675; Fri, 
	24 Apr 2009 10:29:55 -0700 (PDT)
In-Reply-To: <49EDAA7D.20806@student.tuwien.ac.at>
References: <49EDAA7D.20806@student.tuwien.ac.at>
Date: Fri, 24 Apr 2009 13:29:55 -0400
Message-ID: <9ac0c6aa0904241029s1e67e92ahb4ff2d50b256811d@mail.gmail.com>
Subject: Re: Creating document fields by providing termvector directly 
	(bypassing the analyzing/tokenizing stage)
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I don't think there's an easy way to jump straight from term + freq
per doc to a Lucene index.

Mike

On Tue, Apr 21, 2009 at 7:14 AM, Thomas P=F6nitz
<e0425863@student.tuwien.ac.at> wrote:
> Hi,
>
> I have the same problem as discussed here:
> http://mail-archives.apache.org/mod_mbox/lucene-java-user/200511.mbox/%3C=
200511021310.18686.rj@last.fm%3E
>
> I want to specify termvectors directly instead of constructing a dummy
> string like "a a a b b c" that will be transformed to a[3] b[2] c[1].
> The old discussion had no real solution but it is also a bit outdated, ma=
ybe
> someone has a better idea now.
>
> Greets, Thomas
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39936-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 20:32:09 2009
Return-Path: <java-user-return-39936-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47478 invoked from network); 24 Apr 2009 20:32:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 20:32:09 -0000
Received: (qmail 45571 invoked by uid 500); 24 Apr 2009 20:32:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45474 invoked by uid 500); 24 Apr 2009 20:32:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45464 invoked by uid 99); 24 Apr 2009 20:32:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 20:32:06 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [64.202.165.183] (HELO smtpauth03.prod.mesa1.secureserver.net) (64.202.165.183)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 24 Apr 2009 20:31:57 +0000
Received: (qmail 7990 invoked from network); 24 Apr 2009 20:31:34 -0000
Received: from unknown (64.202.165.183)
  by smtpauth03.prod.mesa1.secureserver.net (64.202.165.183) with ESMTP; 24 Apr 2009 20:31:33 -0000
Message-ID: <49F2219F.30909@getopt.org>
Date: Fri, 24 Apr 2009 22:31:27 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Index in text format
References: <531416.74512.qm@web110211.mail.gq1.yahoo.com> <785513.90606.qm@web50301.mail.re2.yahoo.com>
In-Reply-To: <785513.90606.qm@web50301.mail.re2.yahoo.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Otis Gospodnetic wrote:
> No.  But you could look at an existing index, pull out one Document at a time, pull out any stored Field values from each Document, and write those to a text file.  You'd have to write the code for this yourself.

Actually, the latest version of Luke (http://www.getopt.org/luke) can 
export all stored fields from all documents into an XML file.

-- 
Best regards,
Andrzej Bialecki     <><
  ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39937-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 20:38:10 2009
Return-Path: <java-user-return-39937-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48953 invoked from network); 24 Apr 2009 20:38:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 20:38:09 -0000
Received: (qmail 56945 invoked by uid 500); 24 Apr 2009 20:38:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56864 invoked by uid 500); 24 Apr 2009 20:38:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56854 invoked by uid 99); 24 Apr 2009 20:38:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 20:38:07 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.198.237] (HELO rv-out-0506.google.com) (209.85.198.237)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 20:38:00 +0000
Received: by rv-out-0506.google.com with SMTP id l9so1172587rvb.5
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 13:37:38 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.179.2 with SMTP id b2mr861694wff.46.1240605458334; Fri, 24 
	Apr 2009 13:37:38 -0700 (PDT)
In-Reply-To: <23166111.post@talk.nabble.com>
References: <23089805.post@talk.nabble.com> <23092183.post@talk.nabble.com>
	 <9ac0c6aa0904170046x68fa5ad1j23eb5ab6fe7c7cf9@mail.gmail.com>
	 <23093956.post@talk.nabble.com>
	 <9ac0c6aa0904170238y7b2e52a3x368b95c3ea81fa71@mail.gmail.com>
	 <23145720.post@talk.nabble.com>
	 <9ac0c6aa0904211346x5e78b7b4l6db2ba5909d6177@mail.gmail.com>
	 <23166111.post@talk.nabble.com>
Date: Fri, 24 Apr 2009 16:37:38 -0400
Message-ID: <9ac0c6aa0904241337t7ac3476al667807db1521881f@mail.gmail.com>
Subject: Re: readModifiedUTF8String stuck
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, Apr 21, 2009 at 6:25 PM, MakMak <powgri@gmail.com> wrote:
> =A0 Ran CheckIndex. This is what it prints out:
>
> cantOpenSegments: false
> numBadSegments: 0
> numSegments: 14
> segmentFormat: FORMAT_HAS_PROX [Lucene 2.4]
> segmentsFileName: segments_2od
> totLoseDocCount: 0
> clean: true
> toolOutOfDate: false

Actually, CheckIndex has a main method that prints much more detail.
But still it sounds like there are no problems with your index.

Have you tried reindexing?  I'd be curious to know if the problem goes
away with a fresh index.

I wonder if somehow Lucene is asking for a ridiculously immense string
to be created (and that's why you're hung inside String's ctor.

> Our application is a very resource intensive application. We have everyth=
ing
> in the RAM for best possible response time and granularity of our
> authorization model. We give around 6GB of RAM for the application. Durin=
g
> stress tests the RAM consumption gets used up to "2% free". But this has
> always been the case when we were on 2.3.2. With 2.4.1 is when we started
> hitting upon these stuck threads.
>
>
> There are other differences between the customer and our setup apart from
> SAN like http/https, webservices enabled/disabled etc but these shouldnt
> have anything to do with this problem.
>
> Currently we are trying to bring the indexes =A0out of the SAN and into t=
he
> local filesystem to see if these issues remain. Will keep you posted.

OK keep us posted...

> Anymore hints?

Are you able to reproduce the issue locally?  If so we can start
sprinkling prints...?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39938-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 20:46:58 2009
Return-Path: <java-user-return-39938-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51295 invoked from network); 24 Apr 2009 20:46:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 20:46:57 -0000
Received: (qmail 72089 invoked by uid 500); 24 Apr 2009 20:46:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72001 invoked by uid 500); 24 Apr 2009 20:46:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71991 invoked by uid 99); 24 Apr 2009 20:46:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 20:46:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 20:46:46 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LxSHx-0003UG-Cz
	for java-user@lucene.apache.org; Fri, 24 Apr 2009 13:46:25 -0700
Message-ID: <23224598.post@talk.nabble.com>
Date: Fri, 24 Apr 2009 13:46:25 -0700 (PDT)
From: MakMak <powgri@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: readModifiedUTF8String stuck
In-Reply-To: <9ac0c6aa0904241337t7ac3476al667807db1521881f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: powgri@gmail.com
References: <23089805.post@talk.nabble.com> <23092183.post@talk.nabble.com> <9ac0c6aa0904170046x68fa5ad1j23eb5ab6fe7c7cf9@mail.gmail.com> <23093956.post@talk.nabble.com> <9ac0c6aa0904170238y7b2e52a3x368b95c3ea81fa71@mail.gmail.com> <23145720.post@talk.nabble.com> <9ac0c6aa0904211346x5e78b7b4l6db2ba5909d6177@mail.gmail.com> <23166111.post@talk.nabble.com> <9ac0c6aa0904241337t7ac3476al667807db1521881f@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


- We had a 2.3.2 index earlier. We have reindexed using 2.4.1 now.
- SAN is ruled out. This occurs even with local file system.
- One more point, this occurs with very high load on the application. about
2-3 requests per second, the search part of each request is within
milliseconds. the page size is 25, 25 documents are loaded per search
request to be shown to the user.
- I will try to reproduce this locally.



Michael McCandless-2 wrote:
>=20
> On Tue, Apr 21, 2009 at 6:25 PM, MakMak <powgri@gmail.com> wrote:
>> =C2=A0 Ran CheckIndex. This is what it prints out:
>>
>> cantOpenSegments: false
>> numBadSegments: 0
>> numSegments: 14
>> segmentFormat: FORMAT_HAS_PROX [Lucene 2.4]
>> segmentsFileName: segments_2od
>> totLoseDocCount: 0
>> clean: true
>> toolOutOfDate: false
>=20
> Actually, CheckIndex has a main method that prints much more detail.
> But still it sounds like there are no problems with your index.
>=20
> Have you tried reindexing?  I'd be curious to know if the problem goes
> away with a fresh index.
>=20
> I wonder if somehow Lucene is asking for a ridiculously immense string
> to be created (and that's why you're hung inside String's ctor.
>=20
>> Our application is a very resource intensive application. We have
>> everything
>> in the RAM for best possible response time and granularity of our
>> authorization model. We give around 6GB of RAM for the application.
>> During
>> stress tests the RAM consumption gets used up to "2% free". But this has
>> always been the case when we were on 2.3.2. With 2.4.1 is when we starte=
d
>> hitting upon these stuck threads.
>>
>>
>> There are other differences between the customer and our setup apart fro=
m
>> SAN like http/https, webservices enabled/disabled etc but these shouldnt
>> have anything to do with this problem.
>>
>> Currently we are trying to bring the indexes =C2=A0out of the SAN and in=
to the
>> local filesystem to see if these issues remain. Will keep you posted.
>=20
> OK keep us posted...
>=20
>> Anymore hints?
>=20
> Are you able to reproduce the issue locally?  If so we can start
> sprinkling prints...?
>=20
> Mike
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/readModifiedUTF8String-=
stuck-tp23089805p23224598.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39939-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 20:56:22 2009
Return-Path: <java-user-return-39939-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55093 invoked from network); 24 Apr 2009 20:56:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 20:56:22 -0000
Received: (qmail 92773 invoked by uid 500); 24 Apr 2009 20:56:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92707 invoked by uid 500); 24 Apr 2009 20:56:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92697 invoked by uid 99); 24 Apr 2009 20:56:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 20:56:20 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of MMastroianni@glgroup.com)
Received: from [216.32.180.12] (HELO VA3EHSOBE002.bigfish.com) (216.32.180.12)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 20:56:10 +0000
Received: from mail196-va3-R.bigfish.com (10.7.14.250) by
 VA3EHSOBE002.bigfish.com (10.7.40.22) with Microsoft SMTP Server id
 8.1.340.0; Fri, 24 Apr 2009 20:55:48 +0000
Received: from mail196-va3 (localhost.localdomain [127.0.0.1])	by
 mail196-va3-R.bigfish.com (Postfix) with ESMTP id C4D8CCD0412	for
 <java-user@lucene.apache.org>; Fri, 24 Apr 2009 20:55:48 +0000 (UTC)
X-BigFish: VPS-11(zzfadRa0dJzz1202hzzz32i6bh61h)
X-Spam-TCS-SCL: 0:0
X-FB-SS: 5,
Received: by mail196-va3 (MessageSwitch) id 1240606547115869_21712; Fri, 24
 Apr 2009 20:55:47 +0000 (UCT)
Received: from GLGNYEXSMTP01.glgroup.com (glgnyexsmtp01.glgroup.com
 [38.112.210.160])	by mail196-va3.bigfish.com (Postfix) with ESMTP id
 148A1808054	for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 20:55:47
 +0000 (UTC)
Received: from GLGNYEXBE02.glgroup.com ([10.45.50.82]) by
 GLGNYEXSMTP01.glgroup.com with Microsoft SMTPSVC(6.0.3790.3959);	 Fri, 24 Apr
 2009 16:55:04 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C9C51E.F088FA26"
Subject: kamikaze
Date: Fri, 24 Apr 2009 16:56:57 -0400
Message-ID: <9008E1E80EE8A340BACCA3DFF41B21562A4C9A@GLGNYEXBE02.glgroup.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: kamikaze
thread-index: AcnFHzTRwZqewxUAQK6Iqe8DMnTr9A==
From: Michael Mastroianni <MMastroianni@glgroup.com>
To: <java-user@lucene.apache.org>
CC: "Stavros Macrakis" <SMacrakis@glgroup.com>,
	"Tom Emerson" <TEmerson@glgroup.com>
X-OriginalArrivalTime: 24 Apr 2009 20:55:04.0115 (UTC) FILETIME=[F1151030:01C9C51E]
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C9C51E.F088FA26
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi--

 =


Has anyone here used kamikaze much? I'm interested in using it in
situations where I'll have several docidsets of >2M, plus several in the
10s of thousands. =


 =


On prototype basis, I got something running nicely using OpenBitSet, but
I can't use that much memory for my real application.

 =


regards,

Michael Mastroianni



This e-mail message, and any attachments, is intended only for the use of t=
he individual or entity identified in the alias address of this message and=
 may contain information that is confidential, privileged and subject to le=
gal restrictions and penalties regarding its unauthorized disclosure and us=
e. Any unauthorized review, copying, disclosure, use or distribution is str=
ictly prohibited. If you have received this e-mail message in error, please=
 notify the sender immediately by reply e-mail and delete this message, and=
 any attachments, from your system. Thank you.


------_=_NextPart_001_01C9C51E.F088FA26--

From java-user-return-39940-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 21:02:40 2009
Return-Path: <java-user-return-39940-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56883 invoked from network); 24 Apr 2009 21:02:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 21:02:40 -0000
Received: (qmail 9807 invoked by uid 500); 24 Apr 2009 21:02:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9752 invoked by uid 500); 24 Apr 2009 21:02:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9742 invoked by uid 99); 24 Apr 2009 21:02:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 21:02:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [87.233.177.133] (HELO core.aduna-software.com) (87.233.177.133)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 21:02:28 +0000
Received: from localhost (localhost [127.0.0.1])
	by core.aduna-software.com (Postfix) with ESMTP id CDE2B128001
	for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 23:02:07 +0200 (CEST)
X-Virus-Scanned: amavisd-new at 
X-Spam-Score: -2.504
X-Spam-Level: 
Received: from core.aduna-software.com ([127.0.0.1])
	by localhost (core.aduna-software.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id do44iidGvGnL for <java-user@lucene.apache.org>;
	Fri, 24 Apr 2009 23:02:03 +0200 (CEST)
Received: from [192.168.1.101] (53578B7E.cable.casema.nl [83.87.139.126])
	by core.aduna-software.com (Postfix) with ESMTP id 321F9AA037A
	for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 23:02:03 +0200 (CEST)
Message-ID: <49F228C8.3020002@aduna-software.com>
Date: Fri, 24 Apr 2009 23:02:00 +0200
From: Christiaan Fluit <christiaan.fluit@aduna-software.com>
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: semi-infinite loop during merging
References: <49E4573E.7070208@aduna-software.com>	 <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>	 <49E6FD9F.5080104@aduna-software.com>	 <9ac0c6aa0904160510l6cf559c6yfc6b0c1deadbf1de@mail.gmail.com>	 <49EE41F9.3030007@aduna-software.com>	 <49EE4B71.8030105@aduna-software.com> <9ac0c6aa0904230302p568892f2p1cf365f4a1d61207@mail.gmail.com>
In-Reply-To: <9ac0c6aa0904230302p568892f2p1cf365f4a1d61207@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Flag: NO
X-Old-Spam-Status: No, score=-2.504 tagged_above=-10 required=4 tests=[AWL=-0.005,
	BAYES_00=-2.599, RDNS_DYNAMIC=0.1]

Michael McCandless wrote:
>> - even though the commitMerge returns false, it should probably not get into
>> an infinite loop. Is this an internal Lucene problem or is there something I
>> can/should do about it myself?
> 
> Yes, something is wrong with Lucene's handling of OOME.  It certainly
> should not lead to infinite merge attempts.  I'll dig (once back from
> vacation) to see if I can find this path.  Likely we need to prevent
> launching of new merges after an OOME.  I think you must've happened
> to hit OOME when a merge was running.

I have some more info.

I added message(String) invocations in all places where the IW.hitOOM 
flag is set, to see which method turns it on. It turned out to be 
addDocument (twice). These OOME's only happen with the JET build, which 
explains why the Java build does not show the exploding index behavior: 
the hitOOM flag is simply never set and the merge is allowed to proceed 
normally.

The flag is definitely not set while the IW is merging, nor do any 
OOME's appear in my log files during merging. Therefore, there must be a 
problem in how the merge operation responds to the flag being set.

Rollback does not work for me, as my IW is in auto-commit mode. It gives 
an IllegalStateException when I invoke it.

A workaround that does work for me is to close and reopen the 
IndexWriter immediately after an OOME occurs.

Let me know if I can be of any more help.


Regards,

Chris
--

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39941-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 21:08:18 2009
Return-Path: <java-user-return-39941-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58385 invoked from network); 24 Apr 2009 21:08:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 21:08:18 -0000
Received: (qmail 19419 invoked by uid 500); 24 Apr 2009 21:08:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19355 invoked by uid 500); 24 Apr 2009 21:08:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19345 invoked by uid 99); 24 Apr 2009 21:08:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 21:08:15 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [67.195.8.180] (HELO web110204.mail.gq1.yahoo.com) (67.195.8.180)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 24 Apr 2009 21:08:07 +0000
Received: (qmail 14882 invoked by uid 60001); 24 Apr 2009 21:07:46 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1240607266; bh=vS4wJ5srDl/5/ZNAjmpQQwzN8s+Vv9QxYXasdQWW2Ag=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Reply-To:Subject:To:MIME-Version:Content-Type; b=xBvZbCDpar0rBY6hR9bEo5KQM5KePm9VMK79ko9ItHbxBz956x+qNlhGT9gj+JHDaQdFmFYWPsHZaPe6Zo1e1xibqcnYp9wHPVriKKVaMVy2tN90I1POVJbGvXsFCAvFdrTROUD46B5jvlbV2O3Zq3xkuabONk7k13IGD4Hns90=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Reply-To:Subject:To:MIME-Version:Content-Type;
  b=rVrZB3wTC8Y68Y5vcUyCx4GkkXeXSvObt5QsYhHeUTP9CzqHEAfGs4vkjXsaU4PksCZIInIsJl5eQMzwIPs0QP5+bx+uVpVCPrda7DCoYjs83Ozb5VoN4v3dt2t9dXAr55r45rxLlZ0rLQc2S9c8hme68e0GgK4sTZJ7YlB4rBQ=;
Message-ID: <412131.14777.qm@web110204.mail.gq1.yahoo.com>
X-YMail-OSG: aQVNDEMVM1lpDQodSSah23EGvvsPzw1YCoqMdp7ZoF3vLuVQ74HrROv0STBuyBuPk1m6k5rYaa4Fm3ktLM7qUaBE1bxTcSpN1iXerh1W5DXIZodVy841u.uda7yQwF6SqbU0FBQlCfzBPO2EZoUQSrzuWOkHGqdE1A7jCREe0bp3M4K6Cj0b859IA6T206LzwT5kIGI0nspFZfg7jPrgr.MzBEbBv3jmbHzybT87ERSbaGp4GrtgWN5KhtbGOFFWfhbnzH4W_qYJ5Ww0NbGsaCsWOf8Vtn2etVcNa7vbs0iBAas6y48-
Received: from [78.135.23.204] by web110204.mail.gq1.yahoo.com via HTTP; Fri, 24 Apr 2009 14:07:45 PDT
X-Mailer: YahooMailClassic/5.2.19 YahooMailWebService/0.7.289.1
Date: Fri, 24 Apr 2009 14:07:45 -0700 (PDT)
From: andykan1984@yahoo.com
Reply-To: andykan1984@yahoo.com
Subject: Piece of coded needed
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1609859927-1240607265=:14777"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1609859927-1240607265=:14777
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Hi every body

I know it may seem stupid, but I'm in the middle of a research and I need a=
 piece of code in lucene to give me a weight matrix of a text collection an=
d a given query:

W i,j =3D (f i,j)x(idf i)=20
AND=A0=A0=A0 for the query:=A0=20
W i,q =3D (0.5 + (0.5xfreq i,q)/Max(freq i,q))x (idf i )

where:

f i,j =3D Normilize frequency =3D freq i,j / Max(freq j)
freq i,j =3D frequency of (k i) in document j (d j)

=0Aidf i=3D log(N/(n i))=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=
=A0=A0=A0=A0 idf=3D Inverse Document Frequency
N =3D total number of documents in the collection
n i =3D number of documents which has the TERM i (k i)

could any body help?
Many thanks in advance
best wishes to all


=0A=0A=0A      
--0-1609859927-1240607265=:14777--

From java-user-return-39942-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 21:09:56 2009
Return-Path: <java-user-return-39942-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58743 invoked from network); 24 Apr 2009 21:09:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 21:09:56 -0000
Received: (qmail 22056 invoked by uid 500); 24 Apr 2009 21:09:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21954 invoked by uid 500); 24 Apr 2009 21:09:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21944 invoked by uid 99); 24 Apr 2009 21:09:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 21:09:53 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [67.195.8.188] (HELO web110212.mail.gq1.yahoo.com) (67.195.8.188)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 24 Apr 2009 21:09:44 +0000
Received: (qmail 49702 invoked by uid 60001); 24 Apr 2009 21:09:21 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1240607361; bh=GUvEubf2NnNkZpfmdh+q0AvDp8Vh6a3NvDhtbpVtSjY=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=M72k8Q+5rzHewpfB9//I7yylarIH+SRZma73adGpKatt/aYvk+bSBFAmYpKKyjggqmt3dAYbHqbOpnOuqZ67KzKvlKvjHF77SMJL6cbba+HQoH0+bbXe4bxlhtl3gXmm6ObBSm71OvVL/6FiwApc3EPJlUw/LoF+LUpw3cX5PI8=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=Xb0d12VqQuqm4bsMNQ63FwRXk0L/PqPVXxp4MEGr9DW9F+oGJj4gEpQMW4WOr8vxKhOZ/5ypHPDSw4D4XGq1gXSEG7jNTVko50xxWzquw43YugthDXewIl/flSwLwH9ztQDWS0yMdtXv1UAh+06oJXQ3dNun/5DsCAyN+YjQaAs=;
Message-ID: <748902.49386.qm@web110212.mail.gq1.yahoo.com>
X-YMail-OSG: UkKaqTAVM1lttlY0bzrrzeSm0F_hKAQ9QWnrYTbiMhbfI3B_ZQzeBeVPVt6EK60bECk4Nk9HtbBrGFmPVULrJY.GvA0bs9Skz1aQ5OvCP.lfB.zFPqoVLOhtCPMPQUrDQGYaaQtkU5LPyQs_OCegzRUIQvhj_VKxMHCkIIg6UNESrqhUjxsBph1PicDtlzcYUMfBPEOpRunTxxsi78aIO4AiAe7UbK.kocYxSdPuYubstkh2KAjKUux3okW3BpJBRq2VLM2BaWiO_PxLQeWDyzqSHrWvqLeHmjX3ECZlpqMlJSnfsCzM6L_WdubdZPwUamSIM7A8AjMT4w6Syrbb
Received: from [78.135.23.204] by web110212.mail.gq1.yahoo.com via HTTP; Fri, 24 Apr 2009 14:09:21 PDT
X-Mailer: YahooMailClassic/5.2.19 YahooMailWebService/0.7.289.1
Date: Fri, 24 Apr 2009 14:09:21 -0700 (PDT)
From: Andy <andykan1984@yahoo.com>
Subject: Piece of coded needed
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-221240263-1240607361=:49386"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-221240263-1240607361=:49386
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable



--- On Sat, 4/25/09, andykan1984@yahoo.com <andykan1984@yahoo.com> wrote:

From: andykan1984@yahoo.com <andykan1984@yahoo.com>
Subject: Piece of coded needed
To: java-user@lucene.apache.org
Date: Saturday, April 25, 2009, 1:37 AM

Hi every body

I know it may seem stupid, but I'm in the middle of a research and I need a=
 piece of code in lucene to give me a weight matrix of a text collection an=
d a given query:

W i,j =3D (f i,j)x(idf i)=20
AND=A0=A0=A0 for the query:=A0=20
W i,q =3D (0.5 + (0.5xfreq i,q)/Max(freq i,q))x (idf i )

where:

f i,j =3D Normilize frequency =3D freq i,j / Max(freq j)
freq i,j =3D frequency of (k i) in document j (d j)

=0Aidf i=3D log(N/(n i))=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=A0=
=A0=A0=A0=A0 idf=3D Inverse Document Frequency
N =3D total number of documents in the collection
n i =3D number of documents which has the TERM i (k i)

could any body help?
Many thanks in advance
best wishes to all



=0A=0A      =0A=0A=0A      
--0-221240263-1240607361=:49386--

From java-user-return-39943-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 21:12:09 2009
Return-Path: <java-user-return-39943-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59668 invoked from network); 24 Apr 2009 21:12:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 21:12:08 -0000
Received: (qmail 30033 invoked by uid 500); 24 Apr 2009 21:12:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29981 invoked by uid 500); 24 Apr 2009 21:12:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29971 invoked by uid 99); 24 Apr 2009 21:12:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 21:12:06 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.175] (HELO wf-out-1314.google.com) (209.85.200.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 21:11:59 +0000
Received: by wf-out-1314.google.com with SMTP id 24so988719wfg.20
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 14:11:38 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.141.21 with SMTP id o21mr878650wfd.322.1240607498238; Fri, 
	24 Apr 2009 14:11:38 -0700 (PDT)
In-Reply-To: <49F228C8.3020002@aduna-software.com>
References: <49E4573E.7070208@aduna-software.com>
	 <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>
	 <49E6FD9F.5080104@aduna-software.com>
	 <9ac0c6aa0904160510l6cf559c6yfc6b0c1deadbf1de@mail.gmail.com>
	 <49EE41F9.3030007@aduna-software.com>
	 <49EE4B71.8030105@aduna-software.com>
	 <9ac0c6aa0904230302p568892f2p1cf365f4a1d61207@mail.gmail.com>
	 <49F228C8.3020002@aduna-software.com>
Date: Fri, 24 Apr 2009 17:11:38 -0400
Message-ID: <9ac0c6aa0904241411h168d8edaid96d5bc07075bf69@mail.gmail.com>
Subject: Re: semi-infinite loop during merging
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 24, 2009 at 5:02 PM, Christiaan Fluit
<christiaan.fluit@aduna-software.com> wrote:

> Rollback does not work for me, as my IW is in auto-commit mode. It gives an
> IllegalStateException when I invoke it.
>
> A workaround that does work for me is to close and reopen the IndexWriter
> immediately after an OOME occurs.

Ahh, right: that's (close the writer) the correct workaround (when
autoCommit=true).  Though... it'd be best to not hit OOME so often.

> I added message(String) invocations in all places where the IW.hitOOM flag
> is set, to see which method turns it on. It turned out to be addDocument
> (twice). These OOME's only happen with the JET build, which explains why the
> Java build does not show the exploding index behavior: the hitOOM flag is
> simply never set and the merge is allowed to proceed normally.

Why does JET hit OOME but straight JRE doesn't?

> The flag is definitely not set while the IW is merging, nor do any OOME's
> appear in my log files during merging. Therefore, there must be a problem in
> how the merge operation responds to the flag being set.

OK; likely a merge eventually tried to start after the OOME.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39944-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 21:17:34 2009
Return-Path: <java-user-return-39944-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61426 invoked from network); 24 Apr 2009 21:17:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 21:17:34 -0000
Received: (qmail 37825 invoked by uid 500); 24 Apr 2009 21:17:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37747 invoked by uid 500); 24 Apr 2009 21:17:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37737 invoked by uid 99); 24 Apr 2009 21:17:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 21:17:32 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.198.228] (HELO rv-out-0506.google.com) (209.85.198.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 21:17:25 +0000
Received: by rv-out-0506.google.com with SMTP id l9so1182603rvb.5
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 14:17:03 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.179.2 with SMTP id b2mr870956wff.46.1240607823730; Fri, 24 
	Apr 2009 14:17:03 -0700 (PDT)
In-Reply-To: <23224598.post@talk.nabble.com>
References: <23089805.post@talk.nabble.com> <23092183.post@talk.nabble.com>
	 <9ac0c6aa0904170046x68fa5ad1j23eb5ab6fe7c7cf9@mail.gmail.com>
	 <23093956.post@talk.nabble.com>
	 <9ac0c6aa0904170238y7b2e52a3x368b95c3ea81fa71@mail.gmail.com>
	 <23145720.post@talk.nabble.com>
	 <9ac0c6aa0904211346x5e78b7b4l6db2ba5909d6177@mail.gmail.com>
	 <23166111.post@talk.nabble.com>
	 <9ac0c6aa0904241337t7ac3476al667807db1521881f@mail.gmail.com>
	 <23224598.post@talk.nabble.com>
Date: Fri, 24 Apr 2009 17:17:03 -0400
Message-ID: <9ac0c6aa0904241417xe6873f5p54c4fbbcc602a1f8@mail.gmail.com>
Subject: Re: readModifiedUTF8String stuck
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Apr 24, 2009 at 4:46 PM, MakMak <powgri@gmail.com> wrote:
>
> - We had a 2.3.2 index earlier. We have reindexed using 2.4.1 now.

So the hang still happens with 2.4.1?

> - SAN is ruled out. This occurs even with local file system.

OK.

Have you confirmed things are really hung, vs just taking a long time?
 EG if you dump the thread traces several times in a row, that same
thread (stuck in String.init) has exactly the same trace?

> - One more point, this occurs with very high load on the application. about
> 2-3 requests per second, the search part of each request is within
> milliseconds. the page size is 25, 25 documents are loaded per search
> request to be shown to the user.

When the hang happens, is the JRE consuming CPU?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39945-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 22:02:39 2009
Return-Path: <java-user-return-39945-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85910 invoked from network); 24 Apr 2009 22:02:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 22:02:39 -0000
Received: (qmail 85195 invoked by uid 500); 24 Apr 2009 22:02:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85122 invoked by uid 500); 24 Apr 2009 22:02:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85112 invoked by uid 99); 24 Apr 2009 22:02:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 22:02:36 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.200.171] (HELO wf-out-1314.google.com) (209.85.200.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 22:02:29 +0000
Received: by wf-out-1314.google.com with SMTP id 24so999227wfg.20
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 15:02:08 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.142.77.11 with SMTP id z11mr819974wfa.277.1240610528367; Fri, 
	24 Apr 2009 15:02:08 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904241411h168d8edaid96d5bc07075bf69@mail.gmail.com>
References: <49E4573E.7070208@aduna-software.com>
	 <9ac0c6aa0904140306t4235c120n73629596899256bc@mail.gmail.com>
	 <49E6FD9F.5080104@aduna-software.com>
	 <9ac0c6aa0904160510l6cf559c6yfc6b0c1deadbf1de@mail.gmail.com>
	 <49EE41F9.3030007@aduna-software.com>
	 <49EE4B71.8030105@aduna-software.com>
	 <9ac0c6aa0904230302p568892f2p1cf365f4a1d61207@mail.gmail.com>
	 <49F228C8.3020002@aduna-software.com>
	 <9ac0c6aa0904241411h168d8edaid96d5bc07075bf69@mail.gmail.com>
Date: Fri, 24 Apr 2009 18:02:08 -0400
Message-ID: <9ac0c6aa0904241502u1e8e781an889114eb978b4dcf@mail.gmail.com>
Subject: Re: semi-infinite loop during merging
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

OK I opened https://issues.apache.org/jira/browse/LUCENE-1611.

Christiaan, could you try out that patch to see if it fixes the
semi-infinite merging?  Thanks.  (You'll need to back-port to 2.4.1,
but it's a very small patch so hopefully not a problem).

Mike

On Fri, Apr 24, 2009 at 5:11 PM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> On Fri, Apr 24, 2009 at 5:02 PM, Christiaan Fluit
> <christiaan.fluit@aduna-software.com> wrote:
>
>> Rollback does not work for me, as my IW is in auto-commit mode. It gives=
 an
>> IllegalStateException when I invoke it.
>>
>> A workaround that does work for me is to close and reopen the IndexWrite=
r
>> immediately after an OOME occurs.
>
> Ahh, right: that's (close the writer) the correct workaround (when
> autoCommit=3Dtrue). =A0Though... it'd be best to not hit OOME so often.
>
>> I added message(String) invocations in all places where the IW.hitOOM fl=
ag
>> is set, to see which method turns it on. It turned out to be addDocument
>> (twice). These OOME's only happen with the JET build, which explains why=
 the
>> Java build does not show the exploding index behavior: the hitOOM flag i=
s
>> simply never set and the merge is allowed to proceed normally.
>
> Why does JET hit OOME but straight JRE doesn't?
>
>> The flag is definitely not set while the IW is merging, nor do any OOME'=
s
>> appear in my log files during merging. Therefore, there must be a proble=
m in
>> how the merge operation responds to the flag being set.
>
> OK; likely a merge eventually tried to start after the OOME.
>
> Mike
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39946-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Apr 24 23:50:04 2009
Return-Path: <java-user-return-39946-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9504 invoked from network); 24 Apr 2009 23:50:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Apr 2009 23:50:03 -0000
Received: (qmail 83512 invoked by uid 500); 24 Apr 2009 23:50:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83424 invoked by uid 500); 24 Apr 2009 23:50:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83414 invoked by uid 99); 24 Apr 2009 23:50:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 23:50:01 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.132.241 as permitted sender)
Received: from [209.85.132.241] (HELO an-out-0708.google.com) (209.85.132.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 24 Apr 2009 23:49:54 +0000
Received: by an-out-0708.google.com with SMTP id b6so792835ana.5
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 16:49:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=9AW4vvzK43vvvN2xvJ90fOQ7ilHL7A4gTndbN+EggNg=;
        b=c9MeKApygMUP/YFYdyYcxcp2v71JXMSY3FCbf6b+H+qLrB+/0fgs3xdw0pogPYxrDj
         nY2AAXuuYAuq+P0isyyWPJ11HHzj3M1EangFDuLZmcsCcRfusvPkOndPvIbfa3A4WomI
         7MKT753vgpb7Ayz4MxT6PZCD8LkXuYjDjEPh4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=oRfJjqjFVWBEH6NT5NIJLaM7LDX5WgfoSCgO4IkK9zndGvbGuHqkUsItkJkT9k8gMH
         7tw3JxQt0Cx3sYHWU+4KVPhjT5rKe5DiJTt8+9PoJXsSfZy4Kt1eKXqPIa1ckE7S7+jR
         VHoUyP7lnn9EbtO2PnfV4po2N1C/zWUMgMVvk=
MIME-Version: 1.0
Received: by 10.100.248.16 with SMTP id v16mr4043831anh.60.1240616973899; Fri, 
	24 Apr 2009 16:49:33 -0700 (PDT)
In-Reply-To: <9008E1E80EE8A340BACCA3DFF41B21562A4C9A@GLGNYEXBE02.glgroup.com>
References: <9008E1E80EE8A340BACCA3DFF41B21562A4C9A@GLGNYEXBE02.glgroup.com>
Date: Fri, 24 Apr 2009 16:49:33 -0700
Message-ID: <8837fb770904241649i6beb28e5i770eca9c50b5d8e5@mail.gmail.com>
Subject: Re: kamikaze
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016369201d008186a046855a660
X-Virus-Checked: Checked by ClamAV on apache.org

--0016369201d008186a046855a660
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Michael:
    We are using it internally here at LinkedIn for both our search engine
as well as our social graph engine. And we have a team developing actively
on it. Let us know how we can help you.

-John

On Fri, Apr 24, 2009 at 1:56 PM, Michael Mastroianni <
MMastroianni@glgroup.com> wrote:

> Hi--
>
>
>
> Has anyone here used kamikaze much? I'm interested in using it in
> situations where I'll have several docidsets of >2M, plus several in the
> 10s of thousands.
>
>
>
> On prototype basis, I got something running nicely using OpenBitSet, but
> I can't use that much memory for my real application.
>
>
>
> regards,
>
> Michael Mastroianni
>
>
>
> This e-mail message, and any attachments, is intended only for the use of
> the individual or entity identified in the alias address of this message and
> may contain information that is confidential, privileged and subject to
> legal restrictions and penalties regarding its unauthorized disclosure and
> use. Any unauthorized review, copying, disclosure, use or distribution is
> strictly prohibited. If you have received this e-mail message in error,
> please notify the sender immediately by reply e-mail and delete this
> message, and any attachments, from your system. Thank you.
>
>

--0016369201d008186a046855a660--

From java-user-return-39947-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 25 03:02:45 2009
Return-Path: <java-user-return-39947-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3650 invoked from network); 25 Apr 2009 03:02:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Apr 2009 03:02:45 -0000
Received: (qmail 78928 invoked by uid 500); 25 Apr 2009 03:02:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78840 invoked by uid 500); 25 Apr 2009 03:02:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78830 invoked by uid 99); 25 Apr 2009 03:02:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Apr 2009 03:02:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Apr 2009 03:02:34 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LxY9d-00015M-La
	for java-user@lucene.apache.org; Fri, 24 Apr 2009 20:02:13 -0700
Message-ID: <23227963.post@talk.nabble.com>
Date: Fri, 24 Apr 2009 20:02:13 -0700 (PDT)
From: blazingwolf7 <blazingwolf7@gmail.com>
To: java-user@lucene.apache.org
Subject: Query did not return results
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: blazingwolf7@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I created a query that will find a match inside documents. Example of text
match "terror india"
And documents with this exact match does exists.

My query generated is like this: (title:"terror india"^4 content:"terror
india"^3 site:"terror india")
But why does it not return any results?
can anyone help me with this? Thanks in advance
-- 
View this message in context: http://www.nabble.com/Query-did-not-return-results-tp23227963p23227963.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39948-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 25 03:40:41 2009
Return-Path: <java-user-return-39948-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10660 invoked from network); 25 Apr 2009 03:40:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Apr 2009 03:40:41 -0000
Received: (qmail 5358 invoked by uid 500); 25 Apr 2009 03:40:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5272 invoked by uid 500); 25 Apr 2009 03:40:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5262 invoked by uid 99); 25 Apr 2009 03:40:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Apr 2009 03:40:38 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of john.wang@gmail.com designates 209.85.132.250 as permitted sender)
Received: from [209.85.132.250] (HELO an-out-0708.google.com) (209.85.132.250)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Apr 2009 03:40:29 +0000
Received: by an-out-0708.google.com with SMTP id b6so828675ana.5
        for <java-user@lucene.apache.org>; Fri, 24 Apr 2009 20:40:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=X/awT+xcGO0pdanK4D9k09linzZ/IRR/6qXp6grvQXs=;
        b=IG7QiiHzw92HSl7NThNqhtnutPrjcUPtbPcPeuk5cPrUA34WyQzbfYbPmbdzjUHAJu
         p110QWpf6+y/GmdpW10cbpUAe9MzXxVKbJXYjcpQ9u4R9AFVEioZMe8ED7JW0OctcIc5
         8IAE1BXDuSqVikhskZzwEG/0ysJVDumR0nHCE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=DepwKbCFdiJHaym1rDevSPpioqohkTVndGokHdP4gF7oyedDqO8TAOqk/hng9otRXE
         rfCBPTx7z8LPMTUJjD6tNXMHUEfRnqUgF4M2kdriaEdMJ0lBH0A1tXlOIg2nfJjXVtCM
         cbspTcQNTYNaaI+5A838jzcL9eqrdM+6Xim10=
MIME-Version: 1.0
Received: by 10.100.248.4 with SMTP id v4mr4157199anh.121.1240630808311; Fri, 
	24 Apr 2009 20:40:08 -0700 (PDT)
In-Reply-To: <23227963.post@talk.nabble.com>
References: <23227963.post@talk.nabble.com>
Date: Fri, 24 Apr 2009 20:40:08 -0700
Message-ID: <8837fb770904242040h24b30b0awd574bee52ed71238@mail.gmail.com>
Subject: Re: Query did not return results
From: John Wang <john.wang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163698966fa07c61046858de54
X-Virus-Checked: Checked by ClamAV on apache.org

--00163698966fa07c61046858de54
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

What analyzers are you using for both query and indexing?Can you also post
some code on you indexed?

-John

On Fri, Apr 24, 2009 at 8:02 PM, blazingwolf7 <blazingwolf7@gmail.com>wrote:

>
> Hi,
>
> I created a query that will find a match inside documents. Example of text
> match "terror india"
> And documents with this exact match does exists.
>
> My query generated is like this: (title:"terror india"^4 content:"terror
> india"^3 site:"terror india")
> But why does it not return any results?
> can anyone help me with this? Thanks in advance
> --
> View this message in context:
> http://www.nabble.com/Query-did-not-return-results-tp23227963p23227963.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00163698966fa07c61046858de54--

From java-user-return-39949-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 25 06:46:17 2009
Return-Path: <java-user-return-39949-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77020 invoked from network); 25 Apr 2009 06:46:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Apr 2009 06:46:17 -0000
Received: (qmail 4778 invoked by uid 500); 25 Apr 2009 06:46:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4715 invoked by uid 500); 25 Apr 2009 06:46:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4705 invoked by uid 99); 25 Apr 2009 06:46:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Apr 2009 06:46:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Apr 2009 06:46:06 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lxbdx-0007eb-Uo
	for java-user@lucene.apache.org; Fri, 24 Apr 2009 23:45:45 -0700
Message-ID: <23229158.post@talk.nabble.com>
Date: Fri, 24 Apr 2009 23:45:45 -0700 (PDT)
From: blazingwolf7 <blazingwolf7@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Query did not return results
In-Reply-To: <8837fb770904242040h24b30b0awd574bee52ed71238@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: blazingwolf7@gmail.com
References: <23227963.post@talk.nabble.com> <8837fb770904242040h24b30b0awd574bee52ed71238@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


I am using the standard analyzer. 

This problem only happen when I set the query to BooleanClause.Occur.SHOULD
instead of BooleanClause.Occur.MUST while creating the query

John Wang wrote:
> 
> What analyzers are you using for both query and indexing?Can you also post
> some code on you indexed?
> 
> -John
> 
> On Fri, Apr 24, 2009 at 8:02 PM, blazingwolf7
> <blazingwolf7@gmail.com>wrote:
> 
>>
>> Hi,
>>
>> I created a query that will find a match inside documents. Example of
>> text
>> match "terror india"
>> And documents with this exact match does exists.
>>
>> My query generated is like this: (title:"terror india"^4 content:"terror
>> india"^3 site:"terror india")
>> But why does it not return any results?
>> can anyone help me with this? Thanks in advance
>> --
>> View this message in context:
>> http://www.nabble.com/Query-did-not-return-results-tp23227963p23227963.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Query-did-not-return-results-tp23227963p23229158.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39950-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 25 09:48:44 2009
Return-Path: <java-user-return-39950-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20198 invoked from network); 25 Apr 2009 09:48:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Apr 2009 09:48:43 -0000
Received: (qmail 4514 invoked by uid 500); 25 Apr 2009 09:48:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4421 invoked by uid 500); 25 Apr 2009 09:48:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4411 invoked by uid 99); 25 Apr 2009 09:48:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Apr 2009 09:48:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of radha84@gmail.com designates 74.125.92.27 as permitted sender)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Apr 2009 09:48:33 +0000
Received: by qw-out-2122.google.com with SMTP id 5so1274640qwd.53
        for <java-user@lucene.apache.org>; Sat, 25 Apr 2009 02:48:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=nIhaTnA5UBNKa20kNzK7Al2B1fdAzSqCoUvlo1m8Zdk=;
        b=fGQag3z2Mv4jgmbAoEZfvpcF8HeKR6ccXCfXnSWcqEVzAQUSuVEMKLmlJdz0AgNjBy
         jOfq8kjurRHaLSf3LhgRoq6sjdbNKTdl5aA8rslncrsLPbC0ZQw6kVRWFEySDTq6dGFb
         a68QnSvG/lwZjf7+O7mmpMTob9M3Sfz7MoIyU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=i0eLdoxeyFOaTtgWOvxAde152itnEEBUjKiXiCVY2qLSCQeRYCr9loTAXvAZFYICGl
         f1ImGKn3m+YAIUV7jSh9vGwCpfJ/qEkUrcZf1ZpQJezoRz90qx3xH96TKZ03CjtkeyL6
         AAwPFqfZrLDE56H1BX6vrrQq1KZrK/GcW8KBE=
MIME-Version: 1.0
Received: by 10.220.95.14 with SMTP id b14mr6605779vcn.35.1240652892413; Sat, 
	25 Apr 2009 02:48:12 -0700 (PDT)
Date: Sat, 25 Apr 2009 15:18:12 +0530
Message-ID: <45e5f8bb0904250248r7fd8af0ahb164e506ac1bfc39@mail.gmail.com>
Subject: Proximity and Percentage match search in Lucene
From: Radha Sreedharan <radha84@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

  What I need is  the following :
> If my document field is ( ab,bc,cd,ef) and Search tokens are (ab,bc,cd).
>
>  Given the following :
>  I should get a hit even if all of the search tokens aren't present
>  If the tokens are found they should be found within a distance x of
> each other ( proximity
> search)
>>
>> I need the percentage match of the search tokens with the document field.
>>
>> Currently this is my query :
>> 1) I form all possible permutation of the search tokens
>> 2) do a spanNearQuery of each permutation
>> 3)  Do a DisjunctionMaxQuery on the spannearqueries.
>>
>> This is how I compute % match  :
>> % match =  ( Score by running the query on the document field ) /
>>              ( score by running the query on a document field created out of search
>> tokens )
>>
>> The numerator gives me the actual score with the search tokens run on the
>> field.
>> Denominator gives  me the  best possible or maximum possible score with
>> the current search
> tokens
>>
>> For this example << If my document field is ( ab,bc,cd,ef) and Search
>> tokens are
> (ab,bc,cd).>> I expect a % match of around 90%.
>>
>> However I get a match of only around 50% without a boost. Using a boost
>> infact reduces
> my percentage.
>>
>> I even overrode the queryNorm method to return a one, still the
>> percentage did not increase.
> *
> Is there any way of implementing this using the current set of
> implementation classes in Lucene and not making complex changes to the
> structure by itself.
> ( which is what i gather has to be done from the previous replies)
>
> Can anyone suggest an alternative way of implementing this requirement
> using the existing bunch of classes in Lucene and not necessarily
> using the ones I have used*

Regards,
Radha

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39951-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Apr 25 12:41:40 2009
Return-Path: <java-user-return-39951-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5347 invoked from network); 25 Apr 2009 12:41:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Apr 2009 12:41:40 -0000
Received: (qmail 3288 invoked by uid 500); 25 Apr 2009 12:41:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3206 invoked by uid 500); 25 Apr 2009 12:41:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3196 invoked by uid 99); 25 Apr 2009 12:41:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Apr 2009 12:41:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Murat.Yakici@cis.strath.ac.uk designates 130.159.196.96 as permitted sender)
Received: from [130.159.196.96] (HELO smtphost.cis.strath.ac.uk) (130.159.196.96)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 25 Apr 2009 12:41:29 +0000
Received: from webmail.cis.strath.ac.uk (www-data@ramsay.cis.strath.ac.uk [130.159.196.85])
	by arnott.cis.strath.ac.uk (8.14.2/8.14.2/Debian-2build1) with ESMTP id n3PCf6g9017977
	for <java-user@lucene.apache.org>; Sat, 25 Apr 2009 13:41:06 +0100
Received: from 93.97.155.28
        (SquirrelMail authenticated user murat)
        by webmail.cis.strath.ac.uk with HTTP;
        Sat, 25 Apr 2009 13:41:06 +0100 (BST)
Message-ID: <53517.93.97.155.28.1240663266.squirrel@webmail.cis.strath.ac.uk>
In-Reply-To: <d36c28c30904222359m74c810b6p83bdea1af5345bc8@mail.gmail.com>
References: <49ED8646.6040508@cis.strath.ac.uk>
    <d36c28c30904222359m74c810b6p83bdea1af5345bc8@mail.gmail.com>
Date: Sat, 25 Apr 2009 13:41:06 +0100 (BST)
Subject: Re: Using Payloads
From: "Murat Yakici" <Murat.Yakici@cis.strath.ac.uk>
To: java-user@lucene.apache.org
User-Agent: SquirrelMail/1.4.13
MIME-Version: 1.0
Content-Type: text/plain;charset=iso-8859-15
Content-Transfer-Encoding: 8bit
X-Priority: 3 (Normal)
Importance: Normal
X-CIS-MailScanner-SpamCheck: SpamAssassin score=-1.44, ALL_TRUSTED
X-Scanned-By: MIMEDefang on 130.159.196.96
X-Virus-Checked: Checked by ClamAV on apache.org



Here is what I am doing, not so magical... There are two classes, an
analyzer and an a TokenStream in which I can inject my document dependent
data to be stored as payload.


private PayloadAnalyzer panalyzer = new PayloadAnalyzer();

    private class PayloadAnalyzer extends Analyzer {

        private PayloadTokenStream payToken = null;
        private int score;

        public synchronized void setScore(int s) {
            score=s;
        }

      public final TokenStream tokenStream(String field, Reader reader) {
         payToken = new PayloadTokenStream(new LowerCaseTokenizer(reader));
         payToken.setScore(score);
         return payToken;
        }
    }

    private class PayloadTokenStream extends TokenStream {

        private Tokenizer tok = null;
        private int score;

        public PayloadTokenStream(Tokenizer tokenizer) {
            tok = tokenizer;
        }

        public void setScore(int s) {
            score = s;
        }

        public Token next(Token t) throws IOException {
            t = tok.next(t);
            if (t != null) {
                //t.setTermBuffer("can change");
                //Do something with the data
                byte[] bytes = ("score:"+ score).getBytes();
                t.setPayload(new Payload(bytes));
            }
            return t;
        }

        public void reset(Reader input) throws IOException {
            tok.reset(input);
        }

        public void close() throws IOException {
            tok.close();
        }
    }


    public void doIndex() {
        try {
            File index = new File("./TestPayloadIndex");
            IndexWriter iwriter = new IndexWriter(index,
                     panalyzer,
                     IndexWriter.MaxFieldLength.UNLIMITED);

            Document d = new Document();
            d.add(new Field("content",
               "Everyone, someone, myTerm, yourTerm", Field.Store.YES,
                Field.Index.ANALYZED, Field.TermVector.YES));
            //We set the score for the term of the document that will be
analyzed.
            /*I was worried about this part - document dependent score
which may be utilized*/
            panalyzer.setScore(5);
            iwriter.addDocument(d, panalyzer);
            /*-----------------*/
            ...
            iwriter.commit();
            iwriter.optimize();
            iwriter.close();

            //Now read the index
            IndexReader ireader = IndexReader.open(index);
            TermPositions tpos = ireader.termPositions(
                                  new Term("content","myterm"));//Note
LowercaseTokenizer
            while (tpos.next()) {
                int pos;
                for(int i=0;i<tpos.freq();i++){
                    pos=tpos.nextPosition();
                    if (tpos.isPayloadAvailable()) {
                        byte[] data = new byte[tpos.getPayloadLength()];
                        tpos.getPayload(data, 0);
                       //Utilise payloads;
                    }
                }
            }

            tpos.close();
        } catch (CorruptIndexException ex) {
           //
        } catch (LockObtainFailedException ex) {
            //
        } catch (IOException ex) {
            //
        }
    }

I wish it was designed better... Please let me know if you guys have a
better idea.

Cheers,
Murat

> Dear Murat,
>
> I saw your question and wondered how did you implement these changes?
> The requirement below are the same ones as I am trying to code now.
> Did you modify the source code itself or only used Lucene's jar and just
> override code?
>
> I would very much apprecicate if you could give me a short explanation on
> how was it done.
>
> Thanks a lot,
> Liat
>
> 2009/4/21 Murat Yakici <murat.yakici@cis.strath.ac.uk>
>
>> Hi,
>> I started playing with the experimental payload functionality. I have
>> written an analyzer which adds a payload (some sort of a score/boost)
>> for
>> each term occurance. The payload/score for each term is dependent on the
>> document that the term comes from (I guess this is the typoical use
>> case).
>> So say term t1 may have a payload of 5 in doc1 and 34 in doc5. The
>> parameter
>> for calculating the payload changes after each
>> indexWriter.addDocument(..)
>> method call in a while loop. I am assuming that the
>> indexWriter.addDocument(..) methods are thread safe. Can I confirm this?
>>
>> Cheers,
>>
>> --
>> Murat Yakici
>> Department of Computer & Information Sciences
>> University of Strathclyde
>> Glasgow, UK
>> -------------------------------------------
>> The University of Strathclyde is a charitable body, registered in
>> Scotland,
>> with registration number SC015263.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>


Murat Yakici
Department of Computer & Information Sciences
University of Strathclyde
Glasgow, UK
-------------------------------------------
The University of Strathclyde is a charitable body, registered in Scotland,
with registration number SC015263.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39952-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 26 09:06:35 2009
Return-Path: <java-user-return-39952-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58763 invoked from network); 26 Apr 2009 09:06:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Apr 2009 09:06:35 -0000
Received: (qmail 78162 invoked by uid 500); 26 Apr 2009 09:06:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78078 invoked by uid 500); 26 Apr 2009 09:06:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78068 invoked by uid 99); 26 Apr 2009 09:06:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Apr 2009 09:06:32 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Apr 2009 09:06:23 +0000
Received: by ewy27 with SMTP id 27so1747589ewy.5
        for <java-user@lucene.apache.org>; Sun, 26 Apr 2009 02:06:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ny+cXEtnxmJEO2+aiOr8+k8uM8ZN7B0OpXPH3H4gPLE=;
        b=veC9hlBKPZ5zabxBje4NWihR8HrMWfk3GndWNxEIEWAqzxYYMX0Ml9QLDcMqELQSsl
         K5W/YQEX4PdI5u+NPeGt9iLGp9hLRRQpS8d4nVd2MPD/sfHJ7cLzj3vXEXufnmxh/Iwz
         dW/U+6aaHJdihSoy5n0DDlZuZ7oWsKui8j1Go=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=hURyah/UtDKc8AX32PjJGIb+tMFYJKGRtL5TFpD3kECKRHlKkJ+OyMN7lsM+GK+9wL
         Nud/C0rjBvdp6edUD8ra/b79WmP3hpeMAhO7lTkH6OHUeM3+A6GM8o9MY8581Po652I4
         lyY5ruk/TXcAJ6VhNLIVWsBGaqdldBS8933+0=
MIME-Version: 1.0
Received: by 10.210.81.10 with SMTP id e10mr4380967ebb.86.1240736762522; Sun, 
	26 Apr 2009 02:06:02 -0700 (PDT)
In-Reply-To: <53517.93.97.155.28.1240663266.squirrel@webmail.cis.strath.ac.uk>
References: <49ED8646.6040508@cis.strath.ac.uk>
	 <d36c28c30904222359m74c810b6p83bdea1af5345bc8@mail.gmail.com>
	 <53517.93.97.155.28.1240663266.squirrel@webmail.cis.strath.ac.uk>
Date: Sun, 26 Apr 2009 12:06:02 +0300
Message-ID: <d36c28c30904260206v623a9c20p3c61d1e5f937ac7c@mail.gmail.com>
Subject: Re: Using Payloads
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174be610fd6e8904687189f2
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174be610fd6e8904687189f2
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks, Murat.
It was very useful - I also tried to override IndexWriter and
DocumentsWriter instead, but it didn't work well. DocumentsWriter  can't be
overriden.

So, I didn't find a better way to make the changes.

My needs are having for every term in different documents different values.
So, like you set the boost at the document level, I would like to set the
boost for different terms within differnt documents.

For that matter, I made some changes in the code you sent - (I coloured the
changes in red):

Below you can find an example for the use of it

**********
 private class PayloadAnalyzer extends Analyzer
 {
  private PayloadTokenStream payToken = null;
  private int score;
  *private Map<String, Integer> scoresMap = new HashMap<String, Integer>();*
  public synchronized void setScore(int s)
  {
   score = s;
  }
*  public synchronized void setMapScores(Map<String, Integer> scoresMap)
  {
   this.scoresMap = scoresMap;
  }*
  public final TokenStream tokenStream(String field, Reader reader)
  {
   payToken = new PayloadTokenStream(new WhitespaceTokenizer(reader)); //new
LowerCaseTokenizer(reader));
   payToken.setScore(score);
   payToken.setMapScores(scoresMap);
   return payToken;
  }
 }
 private class PayloadTokenStream extends TokenStream
 {
  private Tokenizer tok = null;
  private int score;
  *private Map<String, Integer> scoresMap = new HashMap<String, Integer>();*
  public PayloadTokenStream(Tokenizer tokenizer)
  {
   tok = tokenizer;
  }
  public void setScore(int s)
  {
   score = s;
  }
 * public synchronized void setMapScores(Map<String, Integer> scoresMap)
  {
   this.scoresMap = scoresMap;
  }*
  public Token next(Token t) throws IOException
  {
   t = tok.next(t);
   if(t != null)
   {
    //t.setTermBuffer("can change");
    //Do something with the data
    byte[] bytes = ("score:" + score).getBytes();
    //    t.setPayload(new Payload(bytes));
*    String word = String.copyValueOf(t.termBuffer(), 0, t.termLength());
    int score = scoresMap.get(word);
    byte payLoad = Byte.parseByte(String.valueOf(score));
    t.setPayload(new Payload(new byte[] { Byte.valueOf(payLoad) }));*
   }
   return t;
  }
  public void reset(Reader input) throws IOException
  {
   tok.reset(input);
  }
  public void close() throws IOException
  {
   tok.close();
  }
 }
**********************************
*Example for the use of payloads:*

  PayloadAnalyzer panalyzer = new PayloadAnalyzer();
  File index = new File("" + "TestSearchIndex");
  IndexWriter iwriter = new IndexWriter(index, panalyzer);
  Document d = new Document();
  d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
Field.Index.TOKENIZED, Field.TermVector.YES));
  d.add(new Field("id", "1^3", Field.Store.YES, Field.Index.UN_TOKENIZED,
Field.TermVector.NO));
  Map<String, Integer> mapScores = new HashMap<String, Integer>();
  mapScores.put("word1", 3);
  mapScores.put("word2", 1);
  mapScores.put("word3", 1);
  panalyzer.setMapScores(mapScores);
  iwriter.addDocument(d, panalyzer);
  d = new Document();
  d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
Field.Index.TOKENIZED, Field.TermVector.YES));
  d.add(new Field("id", "2^3", Field.Store.YES, Field.Index.UN_TOKENIZED,
Field.TermVector.NO));
  //We set the score for the term of the document that will be
analyzed.
  /*I was worried about this part - document dependent score
  which may be utilized*/
  mapScores = new HashMap<String, Integer>();
  mapScores.put("word1", 1);
  mapScores.put("word2", 3);
  mapScores.put("word3", 1);
  panalyzer.setMapScores(mapScores);
  iwriter.addDocument(d, panalyzer);
  /*-----------------*/
  //  iwriter.commit();
  iwriter.optimize();
  iwriter.close();
  BooleanQuery bq = new BooleanQuery();
  BoostingTermQuery tq = new BoostingTermQuery(new Term("text", "word1"));
  tq.setBoost((float) 1.0);
  bq.add(tq, BooleanClause.Occur.MUST);
  tq = new BoostingTermQuery(new Term("text", "word2"));
  tq.setBoost((float) 3);
  bq.add(tq, BooleanClause.Occur.SHOULD);
  tq = new BoostingTermQuery(new Term("text", "word3"));
  tq.setBoost((float) 1);
  bq.add(tq, BooleanClause.Occur.SHOULD);
  IndexSearcher searcher1 = new IndexSearcher("TestSearchIndex");
  searcher1.setSimilarity(new WordsSimilarity());
  TopDocs topDocs = searcher1.search(bq, null, 3);
  Hits hits1 = searcher1.search(bq);
  for(int j = 0; j < hits1.length(); j++)
  {
   Explanation explanation = searcher1.explain(bq, j);
   System.out.println("**** " + hits1.score(j) + " " +
hits1.doc(j).getField("id").stringValue() + " *****");
   System.out.println(explanation.toString());
   explanation.getValue();
   System.out.println("********************************************************");
   System.out.println("Score " + topDocs.scoreDocs[j].score + " doc " +
searcher1.doc(topDocs.scoreDocs[j].doc).getField("id").stringValue());
   System.out.println("********************************************************");
  }

If you try the same query with differnt boosting, you will get a different
order for the documents.

Does it look ok?

Thanks again!
Liat
2009/4/25 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>

>
>
> Here is what I am doing, not so magical... There are two classes, an
> analyzer and an a TokenStream in which I can inject my document dependent
> data to be stored as payload.
>
>
> private PayloadAnalyzer panalyzer = new PayloadAnalyzer();
>
>    private class PayloadAnalyzer extends Analyzer {
>
>        private PayloadTokenStream payToken = null;
>        private int score;
>
>        public synchronized void setScore(int s) {
>            score=s;
>        }
>
>      public final TokenStream tokenStream(String field, Reader reader) {
>         payToken = new PayloadTokenStream(new LowerCaseTokenizer(reader));
>         payToken.setScore(score);
>         return payToken;
>        }
>    }
>
>    private class PayloadTokenStream extends TokenStream {
>
>        private Tokenizer tok = null;
>        private int score;
>
>        public PayloadTokenStream(Tokenizer tokenizer) {
>            tok = tokenizer;
>        }
>
>        public void setScore(int s) {
>            score = s;
>        }
>
>        public Token next(Token t) throws IOException {
>            t = tok.next(t);
>            if (t != null) {
>                //t.setTermBuffer("can change");
>                //Do something with the data
>                byte[] bytes = ("score:"+ score).getBytes();
>                t.setPayload(new Payload(bytes));
>            }
>            return t;
>        }
>
>        public void reset(Reader input) throws IOException {
>            tok.reset(input);
>        }
>
>        public void close() throws IOException {
>            tok.close();
>        }
>    }
>
>
>    public void doIndex() {
>        try {
>            File index = new File("./TestPayloadIndex");
>            IndexWriter iwriter = new IndexWriter(index,
>                     panalyzer,
>                     IndexWriter.MaxFieldLength.UNLIMITED);
>
>            Document d = new Document();
>            d.add(new Field("content",
>               "Everyone, someone, myTerm, yourTerm", Field.Store.YES,
>                Field.Index.ANALYZED, Field.TermVector.YES));
>            //We set the score for the term of the document that will be
> analyzed.
>            /*I was worried about this part - document dependent score
> which may be utilized*/
>            panalyzer.setScore(5);
>            iwriter.addDocument(d, panalyzer);
>            /*-----------------*/
>            ...
>            iwriter.commit();
>            iwriter.optimize();
>            iwriter.close();
>
>            //Now read the index
>            IndexReader ireader = IndexReader.open(index);
>            TermPositions tpos = ireader.termPositions(
>                                  new Term("content","myterm"));//Note
> LowercaseTokenizer
>            while (tpos.next()) {
>                int pos;
>                for(int i=0;i<tpos.freq();i++){
>                    pos=tpos.nextPosition();
>                    if (tpos.isPayloadAvailable()) {
>                        byte[] data = new byte[tpos.getPayloadLength()];
>                        tpos.getPayload(data, 0);
>                       //Utilise payloads;
>                    }
>                }
>            }
>
>            tpos.close();
>        } catch (CorruptIndexException ex) {
>           //
>        } catch (LockObtainFailedException ex) {
>            //
>        } catch (IOException ex) {
>            //
>        }
>    }
>
> I wish it was designed better... Please let me know if you guys have a
> better idea.
>
> Cheers,
> Murat
>
> > Dear Murat,
> >
> > I saw your question and wondered how did you implement these changes?
> > The requirement below are the same ones as I am trying to code now.
> > Did you modify the source code itself or only used Lucene's jar and just
> > override code?
> >
> > I would very much apprecicate if you could give me a short explanation on
> > how was it done.
> >
> > Thanks a lot,
> > Liat
> >
> > 2009/4/21 Murat Yakici <murat.yakici@cis.strath.ac.uk>
> >
> >> Hi,
> >> I started playing with the experimental payload functionality. I have
> >> written an analyzer which adds a payload (some sort of a score/boost)
> >> for
> >> each term occurance. The payload/score for each term is dependent on the
> >> document that the term comes from (I guess this is the typoical use
> >> case).
> >> So say term t1 may have a payload of 5 in doc1 and 34 in doc5. The
> >> parameter
> >> for calculating the payload changes after each
> >> indexWriter.addDocument(..)
> >> method call in a while loop. I am assuming that the
> >> indexWriter.addDocument(..) methods are thread safe. Can I confirm this?
> >>
> >> Cheers,
> >>
> >> --
> >> Murat Yakici
> >> Department of Computer & Information Sciences
> >> University of Strathclyde
> >> Glasgow, UK
> >> -------------------------------------------
> >> The University of Strathclyde is a charitable body, registered in
> >> Scotland,
> >> with registration number SC015263.
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
>
> Murat Yakici
> Department of Computer & Information Sciences
> University of Strathclyde
> Glasgow, UK
> -------------------------------------------
> The University of Strathclyde is a charitable body, registered in Scotland,
> with registration number SC015263.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174be610fd6e8904687189f2--

From java-user-return-39953-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 26 11:28:19 2009
Return-Path: <java-user-return-39953-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93546 invoked from network); 26 Apr 2009 11:28:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Apr 2009 11:28:19 -0000
Received: (qmail 12308 invoked by uid 500); 26 Apr 2009 11:28:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12226 invoked by uid 500); 26 Apr 2009 11:28:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12216 invoked by uid 99); 26 Apr 2009 11:28:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Apr 2009 11:28:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Murat.Yakici@cis.strath.ac.uk designates 130.159.196.96 as permitted sender)
Received: from [130.159.196.96] (HELO smtphost.cis.strath.ac.uk) (130.159.196.96)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Apr 2009 11:28:08 +0000
Received: from webmail.cis.strath.ac.uk (www-data@ramsay.cis.strath.ac.uk [130.159.196.85])
	by arnott.cis.strath.ac.uk (8.14.2/8.14.2/Debian-2build1) with ESMTP id n3QBRiTK032183
	for <java-user@lucene.apache.org>; Sun, 26 Apr 2009 12:27:44 +0100
Received: from 93.97.155.28
        (SquirrelMail authenticated user murat)
        by webmail.cis.strath.ac.uk with HTTP;
        Sun, 26 Apr 2009 12:27:44 +0100 (BST)
Message-ID: <58055.93.97.155.28.1240745264.squirrel@webmail.cis.strath.ac.uk>
In-Reply-To: <d36c28c30904260206v623a9c20p3c61d1e5f937ac7c@mail.gmail.com>
References: <49ED8646.6040508@cis.strath.ac.uk>
    <d36c28c30904222359m74c810b6p83bdea1af5345bc8@mail.gmail.com>
    <53517.93.97.155.28.1240663266.squirrel@webmail.cis.strath.ac.uk>
    <d36c28c30904260206v623a9c20p3c61d1e5f937ac7c@mail.gmail.com>
Date: Sun, 26 Apr 2009 12:27:44 +0100 (BST)
Subject: Re: Using Payloads
From: "Murat Yakici" <Murat.Yakici@cis.strath.ac.uk>
To: java-user@lucene.apache.org
User-Agent: SquirrelMail/1.4.13
MIME-Version: 1.0
Content-Type: text/plain;charset=iso-8859-15
Content-Transfer-Encoding: 8bit
X-Priority: 3 (Normal)
Importance: Normal
X-CIS-MailScanner-SpamCheck: SpamAssassin score=-1.44, ALL_TRUSTED
X-Scanned-By: MIMEDefang on 130.159.196.96
X-Virus-Checked: Checked by ClamAV on apache.org


Yes, this is more or less what I had in mind. However, for this approach
one requires some *prior knowledge* of the vocabulary of the document (or
the collection) to produce that score before even it gets analyzed, isn't
it? And this is the paradox that I have been thinking. If you have that
knowledge, that's fine. In addition, for applications that only require a
small term window to generate a score (such as term in context score) this
can be implemented very easy.

It is possible to inject the document dependent boost/score generation
*logic* (an interface would do) to the Tokenizer/TokenStream. However, I
am afraid this may have an indexing time penalty. If your window size is
the document itself, you will be doing the same job twice (calculating the
num of times a term occurs in doc X, index time weights etc.). IndexWriter
already does these somewhere down deep.


Simply put, I want to add some scores to documents/terms, but I can't
generate that score before I observe the document/terms. If I do that I
would replicate some of the work that is being already done by
IndexWriter.

If I remember it correctly, there is also some intention to add document
payloads functionality. I have the same concerns on this. So I think we
need a clear view on the topic. Where is the payload work moving? How we
can generate a score without duplicating some of the work that IndexWriter
is doing?   I guess Michael Busch is working on document payloads for
release 3.0. I would appreciate if someone can enlighten us on how that
would work and can be utilised, in particularly during the analysis phase?


Cheers,
Murat

> Thanks, Murat.
> It was very useful - I also tried to override IndexWriter and
> DocumentsWriter instead, but it didn't work well. DocumentsWriter  can't
> be
> overriden.
>
> So, I didn't find a better way to make the changes.
>
> My needs are having for every term in different documents different
> values.
> So, like you set the boost at the document level, I would like to set the
> boost for different terms within differnt documents.
>
> For that matter, I made some changes in the code you sent - (I coloured
> the
> changes in red):
>
> Below you can find an example for the use of it
>
> **********
>  private class PayloadAnalyzer extends Analyzer
>  {
>   private PayloadTokenStream payToken = null;
>   private int score;
>   *private Map<String, Integer> scoresMap = new HashMap<String,
> Integer>();*
>   public synchronized void setScore(int s)
>   {
>    score = s;
>   }
> *  public synchronized void setMapScores(Map<String, Integer> scoresMap)
>   {
>    this.scoresMap = scoresMap;
>   }*
>   public final TokenStream tokenStream(String field, Reader reader)
>   {
>    payToken = new PayloadTokenStream(new WhitespaceTokenizer(reader));
> //new
> LowerCaseTokenizer(reader));
>    payToken.setScore(score);
>    payToken.setMapScores(scoresMap);
>    return payToken;
>   }
>  }
>  private class PayloadTokenStream extends TokenStream
>  {
>   private Tokenizer tok = null;
>   private int score;
>   *private Map<String, Integer> scoresMap = new HashMap<String,
> Integer>();*
>   public PayloadTokenStream(Tokenizer tokenizer)
>   {
>    tok = tokenizer;
>   }
>   public void setScore(int s)
>   {
>    score = s;
>   }
>  * public synchronized void setMapScores(Map<String, Integer> scoresMap)
>   {
>    this.scoresMap = scoresMap;
>   }*
>   public Token next(Token t) throws IOException
>   {
>    t = tok.next(t);
>    if(t != null)
>    {
>     //t.setTermBuffer("can change");
>     //Do something with the data
>     byte[] bytes = ("score:" + score).getBytes();
>     //    t.setPayload(new Payload(bytes));
> *    String word = String.copyValueOf(t.termBuffer(), 0, t.termLength());
>     int score = scoresMap.get(word);
>     byte payLoad = Byte.parseByte(String.valueOf(score));
>     t.setPayload(new Payload(new byte[] { Byte.valueOf(payLoad) }));*
>    }
>    return t;
>   }
>   public void reset(Reader input) throws IOException
>   {
>    tok.reset(input);
>   }
>   public void close() throws IOException
>   {
>    tok.close();
>   }
>  }
> **********************************
> *Example for the use of payloads:*
>
>   PayloadAnalyzer panalyzer = new PayloadAnalyzer();
>   File index = new File("" + "TestSearchIndex");
>   IndexWriter iwriter = new IndexWriter(index, panalyzer);
>   Document d = new Document();
>   d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
> Field.Index.TOKENIZED, Field.TermVector.YES));
>   d.add(new Field("id", "1^3", Field.Store.YES, Field.Index.UN_TOKENIZED,
> Field.TermVector.NO));
>   Map<String, Integer> mapScores = new HashMap<String, Integer>();
>   mapScores.put("word1", 3);
>   mapScores.put("word2", 1);
>   mapScores.put("word3", 1);
>   panalyzer.setMapScores(mapScores);
>   iwriter.addDocument(d, panalyzer);
>   d = new Document();
>   d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
> Field.Index.TOKENIZED, Field.TermVector.YES));
>   d.add(new Field("id", "2^3", Field.Store.YES, Field.Index.UN_TOKENIZED,
> Field.TermVector.NO));
>   //We set the score for the term of the document that will be
> analyzed.
>   /*I was worried about this part - document dependent score
>   which may be utilized*/
>   mapScores = new HashMap<String, Integer>();
>   mapScores.put("word1", 1);
>   mapScores.put("word2", 3);
>   mapScores.put("word3", 1);
>   panalyzer.setMapScores(mapScores);
>   iwriter.addDocument(d, panalyzer);
>   /*-----------------*/
>   //  iwriter.commit();
>   iwriter.optimize();
>   iwriter.close();
>   BooleanQuery bq = new BooleanQuery();
>   BoostingTermQuery tq = new BoostingTermQuery(new Term("text", "word1"));
>   tq.setBoost((float) 1.0);
>   bq.add(tq, BooleanClause.Occur.MUST);
>   tq = new BoostingTermQuery(new Term("text", "word2"));
>   tq.setBoost((float) 3);
>   bq.add(tq, BooleanClause.Occur.SHOULD);
>   tq = new BoostingTermQuery(new Term("text", "word3"));
>   tq.setBoost((float) 1);
>   bq.add(tq, BooleanClause.Occur.SHOULD);
>   IndexSearcher searcher1 = new IndexSearcher("TestSearchIndex");
>   searcher1.setSimilarity(new WordsSimilarity());
>   TopDocs topDocs = searcher1.search(bq, null, 3);
>   Hits hits1 = searcher1.search(bq);
>   for(int j = 0; j < hits1.length(); j++)
>   {
>    Explanation explanation = searcher1.explain(bq, j);
>    System.out.println("**** " + hits1.score(j) + " " +
> hits1.doc(j).getField("id").stringValue() + " *****");
>    System.out.println(explanation.toString());
>    explanation.getValue();
>    System.out.println("********************************************************");
>    System.out.println("Score " + topDocs.scoreDocs[j].score + " doc " +
> searcher1.doc(topDocs.scoreDocs[j].doc).getField("id").stringValue());
>    System.out.println("********************************************************");
>   }
>
> If you try the same query with differnt boosting, you will get a different
> order for the documents.
>
> Does it look ok?
>
> Thanks again!
> Liat
> 2009/4/25 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
>
>>
>>
>> Here is what I am doing, not so magical... There are two classes, an
>> analyzer and an a TokenStream in which I can inject my document
>> dependent
>> data to be stored as payload.
>>
>>
>> private PayloadAnalyzer panalyzer = new PayloadAnalyzer();
>>
>>    private class PayloadAnalyzer extends Analyzer {
>>
>>        private PayloadTokenStream payToken = null;
>>        private int score;
>>
>>        public synchronized void setScore(int s) {
>>            score=s;
>>        }
>>
>>      public final TokenStream tokenStream(String field, Reader reader) {
>>         payToken = new PayloadTokenStream(new
>> LowerCaseTokenizer(reader));
>>         payToken.setScore(score);
>>         return payToken;
>>        }
>>    }
>>
>>    private class PayloadTokenStream extends TokenStream {
>>
>>        private Tokenizer tok = null;
>>        private int score;
>>
>>        public PayloadTokenStream(Tokenizer tokenizer) {
>>            tok = tokenizer;
>>        }
>>
>>        public void setScore(int s) {
>>            score = s;
>>        }
>>
>>        public Token next(Token t) throws IOException {
>>            t = tok.next(t);
>>            if (t != null) {
>>                //t.setTermBuffer("can change");
>>                //Do something with the data
>>                byte[] bytes = ("score:"+ score).getBytes();
>>                t.setPayload(new Payload(bytes));
>>            }
>>            return t;
>>        }
>>
>>        public void reset(Reader input) throws IOException {
>>            tok.reset(input);
>>        }
>>
>>        public void close() throws IOException {
>>            tok.close();
>>        }
>>    }
>>
>>
>>    public void doIndex() {
>>        try {
>>            File index = new File("./TestPayloadIndex");
>>            IndexWriter iwriter = new IndexWriter(index,
>>                     panalyzer,
>>                     IndexWriter.MaxFieldLength.UNLIMITED);
>>
>>            Document d = new Document();
>>            d.add(new Field("content",
>>               "Everyone, someone, myTerm, yourTerm", Field.Store.YES,
>>                Field.Index.ANALYZED, Field.TermVector.YES));
>>            //We set the score for the term of the document that will be
>> analyzed.
>>            /*I was worried about this part - document dependent score
>> which may be utilized*/
>>            panalyzer.setScore(5);
>>            iwriter.addDocument(d, panalyzer);
>>            /*-----------------*/
>>            ...
>>            iwriter.commit();
>>            iwriter.optimize();
>>            iwriter.close();
>>
>>            //Now read the index
>>            IndexReader ireader = IndexReader.open(index);
>>            TermPositions tpos = ireader.termPositions(
>>                                  new Term("content","myterm"));//Note
>> LowercaseTokenizer
>>            while (tpos.next()) {
>>                int pos;
>>                for(int i=0;i<tpos.freq();i++){
>>                    pos=tpos.nextPosition();
>>                    if (tpos.isPayloadAvailable()) {
>>                        byte[] data = new byte[tpos.getPayloadLength()];
>>                        tpos.getPayload(data, 0);
>>                       //Utilise payloads;
>>                    }
>>                }
>>            }
>>
>>            tpos.close();
>>        } catch (CorruptIndexException ex) {
>>           //
>>        } catch (LockObtainFailedException ex) {
>>            //
>>        } catch (IOException ex) {
>>            //
>>        }
>>    }
>>
>> I wish it was designed better... Please let me know if you guys have a
>> better idea.
>>
>> Cheers,
>> Murat
>>
>> > Dear Murat,
>> >
>> > I saw your question and wondered how did you implement these changes?
>> > The requirement below are the same ones as I am trying to code now.
>> > Did you modify the source code itself or only used Lucene's jar and
>> just
>> > override code?
>> >
>> > I would very much apprecicate if you could give me a short explanation
>> on
>> > how was it done.
>> >
>> > Thanks a lot,
>> > Liat
>> >
>> > 2009/4/21 Murat Yakici <murat.yakici@cis.strath.ac.uk>
>> >
>> >> Hi,
>> >> I started playing with the experimental payload functionality. I have
>> >> written an analyzer which adds a payload (some sort of a score/boost)
>> >> for
>> >> each term occurance. The payload/score for each term is dependent on
>> the
>> >> document that the term comes from (I guess this is the typoical use
>> >> case).
>> >> So say term t1 may have a payload of 5 in doc1 and 34 in doc5. The
>> >> parameter
>> >> for calculating the payload changes after each
>> >> indexWriter.addDocument(..)
>> >> method call in a while loop. I am assuming that the
>> >> indexWriter.addDocument(..) methods are thread safe. Can I confirm
>> this?
>> >>
>> >> Cheers,
>> >>
>> >> --
>> >> Murat Yakici
>> >> Department of Computer & Information Sciences
>> >> University of Strathclyde
>> >> Glasgow, UK
>> >> -------------------------------------------
>> >> The University of Strathclyde is a charitable body, registered in
>> >> Scotland,
>> >> with registration number SC015263.
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>>
>>
>> Murat Yakici
>> Department of Computer & Information Sciences
>> University of Strathclyde
>> Glasgow, UK
>> -------------------------------------------
>> The University of Strathclyde is a charitable body, registered in
>> Scotland,
>> with registration number SC015263.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>


Murat Yakici
Department of Computer & Information Sciences
University of Strathclyde
Glasgow, UK
-------------------------------------------
The University of Strathclyde is a charitable body, registered in Scotland,
with registration number SC015263.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39954-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 26 12:14:29 2009
Return-Path: <java-user-return-39954-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 471 invoked from network); 26 Apr 2009 12:14:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Apr 2009 12:14:29 -0000
Received: (qmail 30585 invoked by uid 500); 26 Apr 2009 12:14:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30496 invoked by uid 500); 26 Apr 2009 12:14:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30486 invoked by uid 99); 26 Apr 2009 12:14:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Apr 2009 12:14:26 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of oren.liat@gmail.com designates 74.125.78.25 as permitted sender)
Received: from [74.125.78.25] (HELO ey-out-2122.google.com) (74.125.78.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Apr 2009 12:14:20 +0000
Received: by ey-out-2122.google.com with SMTP id 22so386073eye.53
        for <java-user@lucene.apache.org>; Sun, 26 Apr 2009 05:13:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=AUoxTftwda/4Y2z4ASoeAXzNjcf7ZRMLMkmPfpBPfUo=;
        b=Ntk6OgWtU2IrfrpjijEsd6cLC8+B3QmZXIv+rLgMzTYIFgSGH8vidojg+fZN+l6oBT
         ECQR5vV4Ima50L1VCBb2//vowjqKL+N2WMtSpQI6VzzVl6e7PhPHjhW8FOWo5FtUEbIA
         kQFat7XMWPwajQ6zcrop/V8i3GYFXxgXkk2T0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=iquyK6LUVkut26cHP5uq1WZgQzYmUZ0aP1+mVbwv17R3+XAIgCKp9G8ISjqsUj3ANo
         2M/QbuJbVPbyCa0IRjm/3ZJ0Ve14Y99rI7bFTVOQSyUT/q7nU6Xf8GKhyWAyQm9I0K+I
         pJrw//wNTtruumwBkx61rwJeOC64WOyiWc+Tc=
MIME-Version: 1.0
Received: by 10.210.133.2 with SMTP id g2mr2415587ebd.2.1240748037672; Sun, 26 
	Apr 2009 05:13:57 -0700 (PDT)
In-Reply-To: <58055.93.97.155.28.1240745264.squirrel@webmail.cis.strath.ac.uk>
References: <49ED8646.6040508@cis.strath.ac.uk>
	 <d36c28c30904222359m74c810b6p83bdea1af5345bc8@mail.gmail.com>
	 <53517.93.97.155.28.1240663266.squirrel@webmail.cis.strath.ac.uk>
	 <d36c28c30904260206v623a9c20p3c61d1e5f937ac7c@mail.gmail.com>
	 <58055.93.97.155.28.1240745264.squirrel@webmail.cis.strath.ac.uk>
Date: Sun, 26 Apr 2009 15:13:57 +0300
Message-ID: <d36c28c30904260513p129d38b9yeac5830e5b888e2f@mail.gmail.com>
Subject: Re: Using Payloads
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c1d940a8e960468742a12
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c1d940a8e960468742a12
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Yes, for this specific part, I have this prior knowledge which is based on a
training set.
About the things you raise here, there are two things you might mean, I am
not sure:

1. If you don't have that "prior" knowledge, then all it means you need to
modify the formula of the score, no? to give more weight to factors you
think to be more significant.
The TermFreqVector will have the term frequencies and you will be able to
edit the score formula so it will fit your needs.

Or

2. Enable us to add statictics factors while indexing

Question - why do you want to edit these while indexing and not using them
at "search" time in the way you desire? At this stage you already have all
the statistics - frequencies of all terms within and outside documents


As for my solution:
I tried to add documents to the index and for every document I have a
differnt map of factors for every term.
However, I get an exception: Exception in thread "main"
java.util.ConcurrentModificationException
It seems like two threads - one reads the map, one edits it (probably for
the next document), bump into each other.

I tried to put the read part and write part in two different synchronied
methods, but it still shows the same exception.

Any idea how can it be solved?

Best,
Liat


2009/4/26 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>

>
> Yes, this is more or less what I had in mind. However, for this approach
> one requires some *prior knowledge* of the vocabulary of the document (or
> the collection) to produce that score before even it gets analyzed, isn't
> it? And this is the paradox that I have been thinking. If you have that
> knowledge, that's fine. In addition, for applications that only require a
> small term window to generate a score (such as term in context score) this
> can be implemented very easy.
>
> It is possible to inject the document dependent boost/score generation
> *logic* (an interface would do) to the Tokenizer/TokenStream. However, I
> am afraid this may have an indexing time penalty. If your window size is
> the document itself, you will be doing the same job twice (calculating the
> num of times a term occurs in doc X, index time weights etc.). IndexWriter
> already does these somewhere down deep.
>
>
> Simply put, I want to add some scores to documents/terms, but I can't
> generate that score before I observe the document/terms. If I do that I
> would replicate some of the work that is being already done by
> IndexWriter.
>
> If I remember it correctly, there is also some intention to add document
> payloads functionality. I have the same concerns on this. So I think we
> need a clear view on the topic. Where is the payload work moving? How we
> can generate a score without duplicating some of the work that IndexWriter
> is doing?   I guess Michael Busch is working on document payloads for
> release 3.0. I would appreciate if someone can enlighten us on how that
> would work and can be utilised, in particularly during the analysis phase?
>
>
> Cheers,
> Murat
>
> > Thanks, Murat.
> > It was very useful - I also tried to override IndexWriter and
> > DocumentsWriter instead, but it didn't work well. DocumentsWriter  can't
> > be
> > overriden.
> >
> > So, I didn't find a better way to make the changes.
> >
> > My needs are having for every term in different documents different
> > values.
> > So, like you set the boost at the document level, I would like to set the
> > boost for different terms within differnt documents.
> >
> > For that matter, I made some changes in the code you sent - (I coloured
> > the
> > changes in red):
> >
> > Below you can find an example for the use of it
> >
> > **********
> >  private class PayloadAnalyzer extends Analyzer
> >  {
> >   private PayloadTokenStream payToken = null;
> >   private int score;
> >   *private Map<String, Integer> scoresMap = new HashMap<String,
> > Integer>();*
> >   public synchronized void setScore(int s)
> >   {
> >    score = s;
> >   }
> > *  public synchronized void setMapScores(Map<String, Integer> scoresMap)
> >   {
> >    this.scoresMap = scoresMap;
> >   }*
> >   public final TokenStream tokenStream(String field, Reader reader)
> >   {
> >    payToken = new PayloadTokenStream(new WhitespaceTokenizer(reader));
> > //new
> > LowerCaseTokenizer(reader));
> >    payToken.setScore(score);
> >    payToken.setMapScores(scoresMap);
> >    return payToken;
> >   }
> >  }
> >  private class PayloadTokenStream extends TokenStream
> >  {
> >   private Tokenizer tok = null;
> >   private int score;
> >   *private Map<String, Integer> scoresMap = new HashMap<String,
> > Integer>();*
> >   public PayloadTokenStream(Tokenizer tokenizer)
> >   {
> >    tok = tokenizer;
> >   }
> >   public void setScore(int s)
> >   {
> >    score = s;
> >   }
> >  * public synchronized void setMapScores(Map<String, Integer> scoresMap)
> >   {
> >    this.scoresMap = scoresMap;
> >   }*
> >   public Token next(Token t) throws IOException
> >   {
> >    t = tok.next(t);
> >    if(t != null)
> >    {
> >     //t.setTermBuffer("can change");
> >     //Do something with the data
> >     byte[] bytes = ("score:" + score).getBytes();
> >     //    t.setPayload(new Payload(bytes));
> > *    String word = String.copyValueOf(t.termBuffer(), 0, t.termLength());
> >     int score = scoresMap.get(word);
> >     byte payLoad = Byte.parseByte(String.valueOf(score));
> >     t.setPayload(new Payload(new byte[] { Byte.valueOf(payLoad) }));*
> >    }
> >    return t;
> >   }
> >   public void reset(Reader input) throws IOException
> >   {
> >    tok.reset(input);
> >   }
> >   public void close() throws IOException
> >   {
> >    tok.close();
> >   }
> >  }
> > **********************************
> > *Example for the use of payloads:*
> >
> >   PayloadAnalyzer panalyzer = new PayloadAnalyzer();
> >   File index = new File("" + "TestSearchIndex");
> >   IndexWriter iwriter = new IndexWriter(index, panalyzer);
> >   Document d = new Document();
> >   d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
> > Field.Index.TOKENIZED, Field.TermVector.YES));
> >   d.add(new Field("id", "1^3", Field.Store.YES, Field.Index.UN_TOKENIZED,
> > Field.TermVector.NO <http://field.termvector.no/>));
> >   Map<String, Integer> mapScores = new HashMap<String, Integer>();
> >   mapScores.put("word1", 3);
> >   mapScores.put("word2", 1);
> >   mapScores.put("word3", 1);
> >   panalyzer.setMapScores(mapScores);
> >   iwriter.addDocument(d, panalyzer);
> >   d = new Document();
> >   d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
> > Field.Index.TOKENIZED, Field.TermVector.YES));
> >   d.add(new Field("id", "2^3", Field.Store.YES, Field.Index.UN_TOKENIZED,
> > Field.TermVector.NO <http://field.termvector.no/>));
> >   //We set the score for the term of the document that will be
> > analyzed.
> >   /*I was worried about this part - document dependent score
> >   which may be utilized*/
> >   mapScores = new HashMap<String, Integer>();
> >   mapScores.put("word1", 1);
> >   mapScores.put("word2", 3);
> >   mapScores.put("word3", 1);
> >   panalyzer.setMapScores(mapScores);
> >   iwriter.addDocument(d, panalyzer);
> >   /*-----------------*/
> >   //  iwriter.commit();
> >   iwriter.optimize();
> >   iwriter.close();
> >   BooleanQuery bq = new BooleanQuery();
> >   BoostingTermQuery tq = new BoostingTermQuery(new Term("text",
> "word1"));
> >   tq.setBoost((float) 1.0);
> >   bq.add(tq, BooleanClause.Occur.MUST);
> >   tq = new BoostingTermQuery(new Term("text", "word2"));
> >   tq.setBoost((float) 3);
> >   bq.add(tq, BooleanClause.Occur.SHOULD);
> >   tq = new BoostingTermQuery(new Term("text", "word3"));
> >   tq.setBoost((float) 1);
> >   bq.add(tq, BooleanClause.Occur.SHOULD);
> >   IndexSearcher searcher1 = new IndexSearcher("TestSearchIndex");
> >   searcher1.setSimilarity(new WordsSimilarity());
> >   TopDocs topDocs = searcher1.search(bq, null, 3);
> >   Hits hits1 = searcher1.search(bq);
> >   for(int j = 0; j < hits1.length(); j++)
> >   {
> >    Explanation explanation = searcher1.explain(bq, j);
> >    System.out.println("**** " + hits1.score(j) + " " +
> > hits1.doc(j).getField("id").stringValue() + " *****");
> >    System.out.println(explanation.toString());
> >    explanation.getValue();
> >
>  System.out.println("********************************************************");
> >    System.out.println("Score " + topDocs.scoreDocs[j].score + " doc " +
> > searcher1.doc(topDocs.scoreDocs[j].doc).getField("id").stringValue());
> >
>  System.out.println("********************************************************");
> >   }
> >
> > If you try the same query with differnt boosting, you will get a
> different
> > order for the documents.
> >
> > Does it look ok?
> >
> > Thanks again!
> > Liat
> > 2009/4/25 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
> >
> >>
> >>
> >> Here is what I am doing, not so magical... There are two classes, an
> >> analyzer and an a TokenStream in which I can inject my document
> >> dependent
> >> data to be stored as payload.
> >>
> >>
> >> private PayloadAnalyzer panalyzer = new PayloadAnalyzer();
> >>
> >>    private class PayloadAnalyzer extends Analyzer {
> >>
> >>        private PayloadTokenStream payToken = null;
> >>        private int score;
> >>
> >>        public synchronized void setScore(int s) {
> >>            score=s;
> >>        }
> >>
> >>      public final TokenStream tokenStream(String field, Reader reader) {
> >>         payToken = new PayloadTokenStream(new
> >> LowerCaseTokenizer(reader));
> >>         payToken.setScore(score);
> >>         return payToken;
> >>        }
> >>    }
> >>
> >>    private class PayloadTokenStream extends TokenStream {
> >>
> >>        private Tokenizer tok = null;
> >>        private int score;
> >>
> >>        public PayloadTokenStream(Tokenizer tokenizer) {
> >>            tok = tokenizer;
> >>        }
> >>
> >>        public void setScore(int s) {
> >>            score = s;
> >>        }
> >>
> >>        public Token next(Token t) throws IOException {
> >>            t = tok.next(t);
> >>            if (t != null) {
> >>                //t.setTermBuffer("can change");
> >>                //Do something with the data
> >>                byte[] bytes = ("score:"+ score).getBytes();
> >>                t.setPayload(new Payload(bytes));
> >>            }
> >>            return t;
> >>        }
> >>
> >>        public void reset(Reader input) throws IOException {
> >>            tok.reset(input);
> >>        }
> >>
> >>        public void close() throws IOException {
> >>            tok.close();
> >>        }
> >>    }
> >>
> >>
> >>    public void doIndex() {
> >>        try {
> >>            File index = new File("./TestPayloadIndex");
> >>            IndexWriter iwriter = new IndexWriter(index,
> >>                     panalyzer,
> >>                     IndexWriter.MaxFieldLength.UNLIMITED);
> >>
> >>            Document d = new Document();
> >>            d.add(new Field("content",
> >>               "Everyone, someone, myTerm, yourTerm", Field.Store.YES,
> >>                Field.Index.ANALYZED, Field.TermVector.YES));
> >>            //We set the score for the term of the document that will be
> >> analyzed.
> >>            /*I was worried about this part - document dependent score
> >> which may be utilized*/
> >>            panalyzer.setScore(5);
> >>            iwriter.addDocument(d, panalyzer);
> >>            /*-----------------*/
> >>            ...
> >>            iwriter.commit();
> >>            iwriter.optimize();
> >>            iwriter.close();
> >>
> >>            //Now read the index
> >>            IndexReader ireader = IndexReader.open(index);
> >>            TermPositions tpos = ireader.termPositions(
> >>                                  new Term("content","myterm"));//Note
> >> LowercaseTokenizer
> >>            while (tpos.next()) {
> >>                int pos;
> >>                for(int i=0;i<tpos.freq();i++){
> >>                    pos=tpos.nextPosition();
> >>                    if (tpos.isPayloadAvailable()) {
> >>                        byte[] data = new byte[tpos.getPayloadLength()];
> >>                        tpos.getPayload(data, 0);
> >>                       //Utilise payloads;
> >>                    }
> >>                }
> >>            }
> >>
> >>            tpos.close();
> >>        } catch (CorruptIndexException ex) {
> >>           //
> >>        } catch (LockObtainFailedException ex) {
> >>            //
> >>        } catch (IOException ex) {
> >>            //
> >>        }
> >>    }
> >>
> >> I wish it was designed better... Please let me know if you guys have a
> >> better idea.
> >>
> >> Cheers,
> >> Murat
> >>
> >> > Dear Murat,
> >> >
> >> > I saw your question and wondered how did you implement these changes?
> >> > The requirement below are the same ones as I am trying to code now.
> >> > Did you modify the source code itself or only used Lucene's jar and
> >> just
> >> > override code?
> >> >
> >> > I would very much apprecicate if you could give me a short explanation
> >> on
> >> > how was it done.
> >> >
> >> > Thanks a lot,
> >> > Liat
> >> >
> >> > 2009/4/21 Murat Yakici <murat.yakici@cis.strath.ac.uk>
> >> >
> >> >> Hi,
> >> >> I started playing with the experimental payload functionality. I have
> >> >> written an analyzer which adds a payload (some sort of a score/boost)
> >> >> for
> >> >> each term occurance. The payload/score for each term is dependent on
> >> the
> >> >> document that the term comes from (I guess this is the typoical use
> >> >> case).
> >> >> So say term t1 may have a payload of 5 in doc1 and 34 in doc5. The
> >> >> parameter
> >> >> for calculating the payload changes after each
> >> >> indexWriter.addDocument(..)
> >> >> method call in a while loop. I am assuming that the
> >> >> indexWriter.addDocument(..) methods are thread safe. Can I confirm
> >> this?
> >> >>
> >> >> Cheers,
> >> >>
> >> >> --
> >> >> Murat Yakici
> >> >> Department of Computer & Information Sciences
> >> >> University of Strathclyde
> >> >> Glasgow, UK
> >> >> -------------------------------------------
> >> >> The University of Strathclyde is a charitable body, registered in
> >> >> Scotland,
> >> >> with registration number SC015263.
> >> >>
> >> >>
> >> >> ---------------------------------------------------------------------
> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >>
> >> >>
> >> >
> >>
> >>
> >> Murat Yakici
> >> Department of Computer & Information Sciences
> >> University of Strathclyde
> >> Glasgow, UK
> >> -------------------------------------------
> >> The University of Strathclyde is a charitable body, registered in
> >> Scotland,
> >> with registration number SC015263.
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
>
> Murat Yakici
> Department of Computer & Information Sciences
> University of Strathclyde
> Glasgow, UK
> -------------------------------------------
> The University of Strathclyde is a charitable body, registered in Scotland,
> with registration number SC015263.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174c1d940a8e960468742a12--

From java-user-return-39955-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 26 12:29:52 2009
Return-Path: <java-user-return-39955-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10345 invoked from network); 26 Apr 2009 12:29:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Apr 2009 12:29:52 -0000
Received: (qmail 40680 invoked by uid 500); 26 Apr 2009 12:29:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40613 invoked by uid 500); 26 Apr 2009 12:29:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40603 invoked by uid 99); 26 Apr 2009 12:29:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Apr 2009 12:29:49 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of twelve02@googlemail.com designates 209.85.128.186 as permitted sender)
Received: from [209.85.128.186] (HELO fk-out-0910.google.com) (209.85.128.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Apr 2009 12:29:38 +0000
Received: by fk-out-0910.google.com with SMTP id 18so881376fkq.5
        for <java-user@lucene.apache.org>; Sun, 26 Apr 2009 05:29:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=629a3WKQOhtjGsXW0QQ83E2WSzLQFqIHomba2buD6LQ=;
        b=j38s+1TfKmbre6Xc0s3sqqw6zIfyTaZy1OaqioFqh4CZOTrhnBep9wY9/5JTAQ5vTj
         l3TaBOuno0g8psjkzsVMoNOhEH+pLhu7FdagYmDRCP+g2HZfGt4wgrbqXrr8ItpEhdZR
         bIoCTKvbH7CpEGtyhGC48FpSJvFDoaMdoX1hc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=he9Mz/XHlj2PfJIFk9ue3/SBHta+khbn9eBVDkoxDs/Ro0zW+ewMbqym132C7lrfqB
         PAyw5caf2zEWeF6KsJe6ih+sSB6PdDCbYbHtdwnBz0BVkoeQbI3f17JLkOCLrcCY76Wa
         0MB+Ecb0nhwuuT9zaMbTMwIspawgwhvniwWtY=
MIME-Version: 1.0
Received: by 10.204.57.81 with SMTP id b17mr4123081bkh.212.1240748956769; Sun, 
	26 Apr 2009 05:29:16 -0700 (PDT)
In-Reply-To: <f18c9dde0903180111w7595b9f3wa52292f22c08db0d@mail.gmail.com>
References: <7284f6e20903172309lb2bc562i1428196fa5c1e5ba@mail.gmail.com>
	 <91315D35-754E-435F-B7B6-DCE095BD0D95@activemath.org>
	 <7284f6e20903180034m29bed47m8bb6ce40468eb089@mail.gmail.com>
	 <E346D512-5EC8-4B4A-A783-20FD8DAE78F3@activemath.org>
	 <f18c9dde0903180111w7595b9f3wa52292f22c08db0d@mail.gmail.com>
Date: Sun, 26 Apr 2009 14:29:16 +0200
Message-ID: <ecef1a880904260529h78d75182uda9a15bb1bca72ed@mail.gmail.com>
Subject: Re: lsi as indexing algorithm with lucene
From: Dominik Jednoralski <twelve02@googlemail.com>
To: java-user@lucene.apache.org, simon.willnauer@gmail.com
Content-Type: multipart/alternative; boundary=00504502b630d2ddb50468746048
X-Virus-Checked: Checked by ClamAV on apache.org

--00504502b630d2ddb50468746048
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

I'm the guy who has written the bachelor on this. Sorry it took a while to
publish it to the community, but I had to improve it before publishing. The
topic of the thesis was to augment the Lucene-driven search facility of the
Intelligent Tutoring System ActiveMath by latent semantics. Semantic result=
s
came from the SemanticVectors software package by Dominic Widdows

http://code.google.com/p/semanticvectors/

and have been used to 'blow up' an index query in a way Mr Libbrecht, my
supervisor, described above.

I wonder if my blog is an appropriate location for my thesis, so please fee=
l
free to redistribute it.

http://www.twelve02.de/publications/jednoralski_bachelorthesis_latent_seman=
tics_for_activemath.pdf


Best

Dominik Jednoralski


2009/3/18 Simon Willnauer <simon.willnauer@googlemail.com>

> Hi,
>
> On Wed, Mar 18, 2009 at 8:59 AM, Paul Libbrecht <paul@activemath.org>
> wrote:
> > Depending on your corpus, a semantic vector enabled search engine
> definitely
> > is more semantic than one without.
> >
> > The general approach I have with these is:
> >
> > - get a query
> > - expand each terms of the query with the fuzzification of
> semantic-vectors
> > (e.g. if requested for termA, add termB and termC with their
> > semantic-distance as a boost factor)
> > - run query get results with higher rank for termA if found, then for
> termB
> > and termC
> >
> > My student Dominik Jednoralski has written a bachelor thesis on that.
> > I'll forward the request to send you this.
> If it is possible could you post a link where everybody can reach the
> thesis of your student?
> I guess it could be interesting for a couple of people on this list
> and a benefit for your student as well.
>
> simon
> >
> > Join the semanticVectors' list where the original author also talks.
> >
> > paul
> >
> >
> > Le 18-mars-09 =E0 08:34, nitin gopi a =E9crit :
> >
> >> hi Paul, I am new to this field of search engine. My aim is to develop
> >> a semantic search engine. Initially  I was trying to develop that by
> >> using LSI. But since it is patented that is why there are no many
> >> implementation attempts. I want  to ask is it possible to create a
> >> search engine using lucene and semantic vector which is semantically
> >> better than lucene?
> >>
> >> On 3/18/09, Paul Libbrecht <paul@activemath.org> wrote:
> >>>
> >>> Nitin,
> >>>
> >>> LSI is patented so it's not been a flurry of implementation attempts.
> >>> However, SemanticVectors is a library that does similar approaches to
> >>> LSA/LSI for indexing and is based on Lucene's term-vectors.
> >>>
> >>> paul
> >>>
> >>>
> >>> Le 18-mars-09 =E0 07:09, nitin gopi a =E9crit :
> >>>
> >>>> hi all , has any body tried to use LSI(latent semantic indexing) for
> >>>> indexing in lucene?
> >>>
> >>>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00504502b630d2ddb50468746048--

From java-user-return-39956-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Apr 26 18:58:01 2009
Return-Path: <java-user-return-39956-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20429 invoked from network); 26 Apr 2009 18:58:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Apr 2009 18:58:01 -0000
Received: (qmail 29675 invoked by uid 500); 26 Apr 2009 18:57:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29591 invoked by uid 500); 26 Apr 2009 18:57:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29581 invoked by uid 99); 26 Apr 2009 18:57:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Apr 2009 18:57:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Murat.Yakici@cis.strath.ac.uk designates 130.159.196.96 as permitted sender)
Received: from [130.159.196.96] (HELO smtphost.cis.strath.ac.uk) (130.159.196.96)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 26 Apr 2009 18:57:51 +0000
Received: from webmail.cis.strath.ac.uk (www-data@ramsay.cis.strath.ac.uk [130.159.196.85])
	by arnott.cis.strath.ac.uk (8.14.2/8.14.2/Debian-2build1) with ESMTP id n3QIvSme030722
	for <java-user@lucene.apache.org>; Sun, 26 Apr 2009 19:57:28 +0100
Received: from 93.97.155.28
        (SquirrelMail authenticated user murat)
        by webmail.cis.strath.ac.uk with HTTP;
        Sun, 26 Apr 2009 19:57:28 +0100 (BST)
Message-ID: <51398.93.97.155.28.1240772248.squirrel@webmail.cis.strath.ac.uk>
In-Reply-To: <d36c28c30904260513p129d38b9yeac5830e5b888e2f@mail.gmail.com>
References: <49ED8646.6040508@cis.strath.ac.uk>
    <d36c28c30904222359m74c810b6p83bdea1af5345bc8@mail.gmail.com>
    <53517.93.97.155.28.1240663266.squirrel@webmail.cis.strath.ac.uk>
    <d36c28c30904260206v623a9c20p3c61d1e5f937ac7c@mail.gmail.com>
    <58055.93.97.155.28.1240745264.squirrel@webmail.cis.strath.ac.uk>
    <d36c28c30904260513p129d38b9yeac5830e5b888e2f@mail.gmail.com>
Date: Sun, 26 Apr 2009 19:57:28 +0100 (BST)
Subject: Re: Using Payloads
From: "Murat Yakici" <Murat.Yakici@cis.strath.ac.uk>
To: java-user@lucene.apache.org
User-Agent: SquirrelMail/1.4.13
MIME-Version: 1.0
Content-Type: text/plain;charset=iso-8859-15
Content-Transfer-Encoding: 8bit
X-Priority: 3 (Normal)
Importance: Normal
X-CIS-MailScanner-SpamCheck: SpamAssassin score=-1.44, ALL_TRUSTED
X-Scanned-By: MIMEDefang on 130.159.196.96
X-Virus-Checked: Checked by ClamAV on apache.org



See my comments:

> Yes, for this specific part, I have this prior knowledge which is based on
> a
> training set.
> About the things you raise here, there are two things you might mean, I am
> not sure:
>
> 1. If you don't have that "prior" knowledge, then all it means you need to
> modify the formula of the score, no? to give more weight to factors you
> think to be more significant.
> The TermFreqVector will have the term frequencies and you will be able to
> edit the score formula so it will fit your needs.
>
Although I like the TermFreqVector approach, the API and everything, it is
slower than using TermEnum and TermDocs. I don't have solid statistics,
but I confirmed the fact during my development work on a 80+ core SG
server. I wish TermFreqVector approach could load abit faster.



> Or
>
> 2. Enable us to add statistics factors while indexing

This is what I am talking about, *Indexing time*.

>
> Question - why do you want to edit these while indexing and not using them
> at "search" time in the way you desire? At this stage you already have all
> the statistics - frequencies of all terms within and outside documents

First of all you don't have all the statistics. Because, there are some
statistics that you simple can't calculate (or more correctly you
shouldn't be due to performance) during the query scoring time. It will be
an overkill.

>
>
> As for my solution:
> I tried to add documents to the index and for every document I have a
> differnt map of factors for every term.
> However, I get an exception: Exception in thread "main"
> java.util.ConcurrentModificationException
> It seems like two threads - one reads the map, one edits it (probably for
> the next document), bump into each other.
>

Are you using a single Thread to do all the indexing or multiple threads
adding document to the index? You need to explain the situation a bit
more.

Murat

> I tried to put the read part and write part in two different synchronied
> methods, but it still shows the same exception.
>
> Any idea how can it be solved?
>
> Best,
> Liat
>
>
> 2009/4/26 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
>
>>
>> Yes, this is more or less what I had in mind. However, for this approach
>> one requires some *prior knowledge* of the vocabulary of the document
>> (or
>> the collection) to produce that score before even it gets analyzed,
>> isn't
>> it? And this is the paradox that I have been thinking. If you have that
>> knowledge, that's fine. In addition, for applications that only require
>> a
>> small term window to generate a score (such as term in context score)
>> this
>> can be implemented very easy.
>>
>> It is possible to inject the document dependent boost/score generation
>> *logic* (an interface would do) to the Tokenizer/TokenStream. However, I
>> am afraid this may have an indexing time penalty. If your window size is
>> the document itself, you will be doing the same job twice (calculating
>> the
>> num of times a term occurs in doc X, index time weights etc.).
>> IndexWriter
>> already does these somewhere down deep.
>>
>>
>> Simply put, I want to add some scores to documents/terms, but I can't
>> generate that score before I observe the document/terms. If I do that I
>> would replicate some of the work that is being already done by
>> IndexWriter.
>>
>> If I remember it correctly, there is also some intention to add document
>> payloads functionality. I have the same concerns on this. So I think we
>> need a clear view on the topic. Where is the payload work moving? How we
>> can generate a score without duplicating some of the work that
>> IndexWriter
>> is doing?   I guess Michael Busch is working on document payloads for
>> release 3.0. I would appreciate if someone can enlighten us on how that
>> would work and can be utilised, in particularly during the analysis
>> phase?
>>
>>
>> Cheers,
>> Murat
>>
>> > Thanks, Murat.
>> > It was very useful - I also tried to override IndexWriter and
>> > DocumentsWriter instead, but it didn't work well. DocumentsWriter
>> can't
>> > be
>> > overriden.
>> >
>> > So, I didn't find a better way to make the changes.
>> >
>> > My needs are having for every term in different documents different
>> > values.
>> > So, like you set the boost at the document level, I would like to set
>> the
>> > boost for different terms within differnt documents.
>> >
>> > For that matter, I made some changes in the code you sent - (I
>> coloured
>> > the
>> > changes in red):
>> >
>> > Below you can find an example for the use of it
>> >
>> > **********
>> >  private class PayloadAnalyzer extends Analyzer
>> >  {
>> >   private PayloadTokenStream payToken = null;
>> >   private int score;
>> >   *private Map<String, Integer> scoresMap = new HashMap<String,
>> > Integer>();*
>> >   public synchronized void setScore(int s)
>> >   {
>> >    score = s;
>> >   }
>> > *  public synchronized void setMapScores(Map<String, Integer>
>> scoresMap)
>> >   {
>> >    this.scoresMap = scoresMap;
>> >   }*
>> >   public final TokenStream tokenStream(String field, Reader reader)
>> >   {
>> >    payToken = new PayloadTokenStream(new WhitespaceTokenizer(reader));
>> > //new
>> > LowerCaseTokenizer(reader));
>> >    payToken.setScore(score);
>> >    payToken.setMapScores(scoresMap);
>> >    return payToken;
>> >   }
>> >  }
>> >  private class PayloadTokenStream extends TokenStream
>> >  {
>> >   private Tokenizer tok = null;
>> >   private int score;
>> >   *private Map<String, Integer> scoresMap = new HashMap<String,
>> > Integer>();*
>> >   public PayloadTokenStream(Tokenizer tokenizer)
>> >   {
>> >    tok = tokenizer;
>> >   }
>> >   public void setScore(int s)
>> >   {
>> >    score = s;
>> >   }
>> >  * public synchronized void setMapScores(Map<String, Integer>
>> scoresMap)
>> >   {
>> >    this.scoresMap = scoresMap;
>> >   }*
>> >   public Token next(Token t) throws IOException
>> >   {
>> >    t = tok.next(t);
>> >    if(t != null)
>> >    {
>> >     //t.setTermBuffer("can change");
>> >     //Do something with the data
>> >     byte[] bytes = ("score:" + score).getBytes();
>> >     //    t.setPayload(new Payload(bytes));
>> > *    String word = String.copyValueOf(t.termBuffer(), 0,
>> t.termLength());
>> >     int score = scoresMap.get(word);
>> >     byte payLoad = Byte.parseByte(String.valueOf(score));
>> >     t.setPayload(new Payload(new byte[] { Byte.valueOf(payLoad) }));*
>> >    }
>> >    return t;
>> >   }
>> >   public void reset(Reader input) throws IOException
>> >   {
>> >    tok.reset(input);
>> >   }
>> >   public void close() throws IOException
>> >   {
>> >    tok.close();
>> >   }
>> >  }
>> > **********************************
>> > *Example for the use of payloads:*
>> >
>> >   PayloadAnalyzer panalyzer = new PayloadAnalyzer();
>> >   File index = new File("" + "TestSearchIndex");
>> >   IndexWriter iwriter = new IndexWriter(index, panalyzer);
>> >   Document d = new Document();
>> >   d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
>> > Field.Index.TOKENIZED, Field.TermVector.YES));
>> >   d.add(new Field("id", "1^3", Field.Store.YES,
>> Field.Index.UN_TOKENIZED,
>> > Field.TermVector.NO <http://field.termvector.no/>));
>> >   Map<String, Integer> mapScores = new HashMap<String, Integer>();
>> >   mapScores.put("word1", 3);
>> >   mapScores.put("word2", 1);
>> >   mapScores.put("word3", 1);
>> >   panalyzer.setMapScores(mapScores);
>> >   iwriter.addDocument(d, panalyzer);
>> >   d = new Document();
>> >   d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
>> > Field.Index.TOKENIZED, Field.TermVector.YES));
>> >   d.add(new Field("id", "2^3", Field.Store.YES,
>> Field.Index.UN_TOKENIZED,
>> > Field.TermVector.NO <http://field.termvector.no/>));
>> >   //We set the score for the term of the document that will be
>> > analyzed.
>> >   /*I was worried about this part - document dependent score
>> >   which may be utilized*/
>> >   mapScores = new HashMap<String, Integer>();
>> >   mapScores.put("word1", 1);
>> >   mapScores.put("word2", 3);
>> >   mapScores.put("word3", 1);
>> >   panalyzer.setMapScores(mapScores);
>> >   iwriter.addDocument(d, panalyzer);
>> >   /*-----------------*/
>> >   //  iwriter.commit();
>> >   iwriter.optimize();
>> >   iwriter.close();
>> >   BooleanQuery bq = new BooleanQuery();
>> >   BoostingTermQuery tq = new BoostingTermQuery(new Term("text",
>> "word1"));
>> >   tq.setBoost((float) 1.0);
>> >   bq.add(tq, BooleanClause.Occur.MUST);
>> >   tq = new BoostingTermQuery(new Term("text", "word2"));
>> >   tq.setBoost((float) 3);
>> >   bq.add(tq, BooleanClause.Occur.SHOULD);
>> >   tq = new BoostingTermQuery(new Term("text", "word3"));
>> >   tq.setBoost((float) 1);
>> >   bq.add(tq, BooleanClause.Occur.SHOULD);
>> >   IndexSearcher searcher1 = new IndexSearcher("TestSearchIndex");
>> >   searcher1.setSimilarity(new WordsSimilarity());
>> >   TopDocs topDocs = searcher1.search(bq, null, 3);
>> >   Hits hits1 = searcher1.search(bq);
>> >   for(int j = 0; j < hits1.length(); j++)
>> >   {
>> >    Explanation explanation = searcher1.explain(bq, j);
>> >    System.out.println("**** " + hits1.score(j) + " " +
>> > hits1.doc(j).getField("id").stringValue() + " *****");
>> >    System.out.println(explanation.toString());
>> >    explanation.getValue();
>> >
>>  System.out.println("********************************************************");
>> >    System.out.println("Score " + topDocs.scoreDocs[j].score + " doc "
>> +
>> > searcher1.doc(topDocs.scoreDocs[j].doc).getField("id").stringValue());
>> >
>>  System.out.println("********************************************************");
>> >   }
>> >
>> > If you try the same query with differnt boosting, you will get a
>> different
>> > order for the documents.
>> >
>> > Does it look ok?
>> >
>> > Thanks again!
>> > Liat
>> > 2009/4/25 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
>> >
>> >>
>> >>
>> >> Here is what I am doing, not so magical... There are two classes, an
>> >> analyzer and an a TokenStream in which I can inject my document
>> >> dependent
>> >> data to be stored as payload.
>> >>
>> >>
>> >> private PayloadAnalyzer panalyzer = new PayloadAnalyzer();
>> >>
>> >>    private class PayloadAnalyzer extends Analyzer {
>> >>
>> >>        private PayloadTokenStream payToken = null;
>> >>        private int score;
>> >>
>> >>        public synchronized void setScore(int s) {
>> >>            score=s;
>> >>        }
>> >>
>> >>      public final TokenStream tokenStream(String field, Reader
>> reader) {
>> >>         payToken = new PayloadTokenStream(new
>> >> LowerCaseTokenizer(reader));
>> >>         payToken.setScore(score);
>> >>         return payToken;
>> >>        }
>> >>    }
>> >>
>> >>    private class PayloadTokenStream extends TokenStream {
>> >>
>> >>        private Tokenizer tok = null;
>> >>        private int score;
>> >>
>> >>        public PayloadTokenStream(Tokenizer tokenizer) {
>> >>            tok = tokenizer;
>> >>        }
>> >>
>> >>        public void setScore(int s) {
>> >>            score = s;
>> >>        }
>> >>
>> >>        public Token next(Token t) throws IOException {
>> >>            t = tok.next(t);
>> >>            if (t != null) {
>> >>                //t.setTermBuffer("can change");
>> >>                //Do something with the data
>> >>                byte[] bytes = ("score:"+ score).getBytes();
>> >>                t.setPayload(new Payload(bytes));
>> >>            }
>> >>            return t;
>> >>        }
>> >>
>> >>        public void reset(Reader input) throws IOException {
>> >>            tok.reset(input);
>> >>        }
>> >>
>> >>        public void close() throws IOException {
>> >>            tok.close();
>> >>        }
>> >>    }
>> >>
>> >>
>> >>    public void doIndex() {
>> >>        try {
>> >>            File index = new File("./TestPayloadIndex");
>> >>            IndexWriter iwriter = new IndexWriter(index,
>> >>                     panalyzer,
>> >>                     IndexWriter.MaxFieldLength.UNLIMITED);
>> >>
>> >>            Document d = new Document();
>> >>            d.add(new Field("content",
>> >>               "Everyone, someone, myTerm, yourTerm", Field.Store.YES,
>> >>                Field.Index.ANALYZED, Field.TermVector.YES));
>> >>            //We set the score for the term of the document that will
>> be
>> >> analyzed.
>> >>            /*I was worried about this part - document dependent score
>> >> which may be utilized*/
>> >>            panalyzer.setScore(5);
>> >>            iwriter.addDocument(d, panalyzer);
>> >>            /*-----------------*/
>> >>            ...
>> >>            iwriter.commit();
>> >>            iwriter.optimize();
>> >>            iwriter.close();
>> >>
>> >>            //Now read the index
>> >>            IndexReader ireader = IndexReader.open(index);
>> >>            TermPositions tpos = ireader.termPositions(
>> >>                                  new Term("content","myterm"));//Note
>> >> LowercaseTokenizer
>> >>            while (tpos.next()) {
>> >>                int pos;
>> >>                for(int i=0;i<tpos.freq();i++){
>> >>                    pos=tpos.nextPosition();
>> >>                    if (tpos.isPayloadAvailable()) {
>> >>                        byte[] data = new
>> byte[tpos.getPayloadLength()];
>> >>                        tpos.getPayload(data, 0);
>> >>                       //Utilise payloads;
>> >>                    }
>> >>                }
>> >>            }
>> >>
>> >>            tpos.close();
>> >>        } catch (CorruptIndexException ex) {
>> >>           //
>> >>        } catch (LockObtainFailedException ex) {
>> >>            //
>> >>        } catch (IOException ex) {
>> >>            //
>> >>        }
>> >>    }
>> >>
>> >> I wish it was designed better... Please let me know if you guys have
>> a
>> >> better idea.
>> >>
>> >> Cheers,
>> >> Murat
>> >>
>> >> > Dear Murat,
>> >> >
>> >> > I saw your question and wondered how did you implement these
>> changes?
>> >> > The requirement below are the same ones as I am trying to code now.
>> >> > Did you modify the source code itself or only used Lucene's jar and
>> >> just
>> >> > override code?
>> >> >
>> >> > I would very much apprecicate if you could give me a short
>> explanation
>> >> on
>> >> > how was it done.
>> >> >
>> >> > Thanks a lot,
>> >> > Liat
>> >> >
>> >> > 2009/4/21 Murat Yakici <murat.yakici@cis.strath.ac.uk>
>> >> >
>> >> >> Hi,
>> >> >> I started playing with the experimental payload functionality. I
>> have
>> >> >> written an analyzer which adds a payload (some sort of a
>> score/boost)
>> >> >> for
>> >> >> each term occurance. The payload/score for each term is dependent
>> on
>> >> the
>> >> >> document that the term comes from (I guess this is the typoical
>> use
>> >> >> case).
>> >> >> So say term t1 may have a payload of 5 in doc1 and 34 in doc5. The
>> >> >> parameter
>> >> >> for calculating the payload changes after each
>> >> >> indexWriter.addDocument(..)
>> >> >> method call in a while loop. I am assuming that the
>> >> >> indexWriter.addDocument(..) methods are thread safe. Can I confirm
>> >> this?
>> >> >>
>> >> >> Cheers,
>> >> >>
>> >> >> --
>> >> >> Murat Yakici
>> >> >> Department of Computer & Information Sciences
>> >> >> University of Strathclyde
>> >> >> Glasgow, UK
>> >> >> -------------------------------------------
>> >> >> The University of Strathclyde is a charitable body, registered in
>> >> >> Scotland,
>> >> >> with registration number SC015263.
>> >> >>
>> >> >>
>> >> >> ---------------------------------------------------------------------
>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >> >>
>> >> >>
>> >> >
>> >>
>> >>
>> >> Murat Yakici
>> >> Department of Computer & Information Sciences
>> >> University of Strathclyde
>> >> Glasgow, UK
>> >> -------------------------------------------
>> >> The University of Strathclyde is a charitable body, registered in
>> >> Scotland,
>> >> with registration number SC015263.
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>>
>>
>> Murat Yakici
>> Department of Computer & Information Sciences
>> University of Strathclyde
>> Glasgow, UK
>> -------------------------------------------
>> The University of Strathclyde is a charitable body, registered in
>> Scotland,
>> with registration number SC015263.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>


Murat Yakici
Department of Computer & Information Sciences
University of Strathclyde
Glasgow, UK
-------------------------------------------
The University of Strathclyde is a charitable body, registered in Scotland,
with registration number SC015263.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39957-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 03:41:49 2009
Return-Path: <java-user-return-39957-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81916 invoked from network); 27 Apr 2009 03:41:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 03:41:46 -0000
Received: (qmail 81163 invoked by uid 500); 27 Apr 2009 03:41:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81078 invoked by uid 500); 27 Apr 2009 03:41:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81068 invoked by uid 99); 27 Apr 2009 03:41:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 03:41:43 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 03:41:35 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LyHiU-0001bN-9U
	for java-user@lucene.apache.org; Sun, 26 Apr 2009 20:41:14 -0700
Message-ID: <23249637.post@talk.nabble.com>
Date: Sun, 26 Apr 2009 20:41:14 -0700 (PDT)
From: samd <sdoyle_2@yahoo.com>
To: java-user@lucene.apache.org
Subject: Getting values with low scores
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sdoyle_2@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


I have 2500 documents and need to have a matches with the very lowest rank
returned
How can I get this? It is very important.

When I look at the index in look I see the fields with my values but they
all have low rank.
When I search they don't show in the results. 
-- 
View this message in context: http://www.nabble.com/Getting-values-with-low-scores-tp23249637p23249637.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39958-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 09:13:01 2009
Return-Path: <java-user-return-39958-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97662 invoked from network); 27 Apr 2009 09:13:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 09:13:01 -0000
Received: (qmail 21719 invoked by uid 500); 27 Apr 2009 09:12:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21653 invoked by uid 500); 27 Apr 2009 09:12:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21640 invoked by uid 99); 27 Apr 2009 09:12:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 09:12:58 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of oren.liat@gmail.com designates 74.125.78.27 as permitted sender)
Received: from [74.125.78.27] (HELO ey-out-2122.google.com) (74.125.78.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 09:12:48 +0000
Received: by ey-out-2122.google.com with SMTP id 22so454775eye.53
        for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 02:12:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=x1qEACffzbOxelLYuyRMddUAWeQSB2JBcZhtppNsfRU=;
        b=KdG0Dn2uNuDxyvuMa2z+n6TJKASVkcTxNua1cn1gYuhmAx7LpHHNE1SSiRG9BRA6Ia
         A3LafOT8HDrNI9pwoAQ4ccZLUGagAG+Eqdx/sBDm27qFCW47Dan1KqvDE0ukZSdJCdrD
         aHqba6PGr9S3RRT3OI8Vwe4YnXSxqLJu5BC+U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=w5Dp2aAz7iLosNYp8blwlsI1F8fGNvkHG6ytz3/ZdmPGxGZt63D7nFYmnDgRJbHfzb
         +Bn0LI78+k7I8pbHbfJLp2uEr8euUv/VcgFkhwuZcpBsP8n3EBhbM/3AmBN22yXx7PuJ
         mYZT3yKR/YNXIXqbaKE06LkgFGP4rjLvOTW/g=
MIME-Version: 1.0
Received: by 10.210.63.2 with SMTP id l2mr2449157eba.67.1240823547852; Mon, 27 
	Apr 2009 02:12:27 -0700 (PDT)
In-Reply-To: <51398.93.97.155.28.1240772248.squirrel@webmail.cis.strath.ac.uk>
References: <49ED8646.6040508@cis.strath.ac.uk>
	 <d36c28c30904222359m74c810b6p83bdea1af5345bc8@mail.gmail.com>
	 <53517.93.97.155.28.1240663266.squirrel@webmail.cis.strath.ac.uk>
	 <d36c28c30904260206v623a9c20p3c61d1e5f937ac7c@mail.gmail.com>
	 <58055.93.97.155.28.1240745264.squirrel@webmail.cis.strath.ac.uk>
	 <d36c28c30904260513p129d38b9yeac5830e5b888e2f@mail.gmail.com>
	 <51398.93.97.155.28.1240772248.squirrel@webmail.cis.strath.ac.uk>
Date: Mon, 27 Apr 2009 12:12:27 +0300
Message-ID: <d36c28c30904270212t661b995aie2d35f89444de65e@mail.gmail.com>
Subject: Re: Using Payloads
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c3e88cc7e88046885be9e
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c3e88cc7e88046885be9e
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Yes, I agree with you - I also tried this approach in the past and it was
terribely slow - looping on the term vectors.

What I have done - is dividing indexes into steps - which of course, if can
be avoided, it will be more than great!!

As for my problem -  it was a code problems, I sloved it, thanks.
Is it recommended to use multi-thread in order to index?

Best,
Liat
2009/4/26 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>

>
>
> See my comments:
>
> > Yes, for this specific part, I have this prior knowledge which is based
> on
> > a
> > training set.
> > About the things you raise here, there are two things you might mean, I
> am
> > not sure:
> >
> > 1. If you don't have that "prior" knowledge, then all it means you need
> to
> > modify the formula of the score, no? to give more weight to factors you
> > think to be more significant.
> > The TermFreqVector will have the term frequencies and you will be able to
> > edit the score formula so it will fit your needs.
> >
> Although I like the TermFreqVector approach, the API and everything, it is
> slower than using TermEnum and TermDocs. I don't have solid statistics,
> but I confirmed the fact during my development work on a 80+ core SG
> server. I wish TermFreqVector approach could load abit faster.
>
>
>
> > Or
> >
> > 2. Enable us to add statistics factors while indexing
>
> This is what I am talking about, *Indexing time*.
>
> >
> > Question - why do you want to edit these while indexing and not using
> them
> > at "search" time in the way you desire? At this stage you already have
> all
> > the statistics - frequencies of all terms within and outside documents
>
> First of all you don't have all the statistics. Because, there are some
> statistics that you simple can't calculate (or more correctly you
> shouldn't be due to performance) during the query scoring time. It will be
> an overkill.
>
> >
> >
> > As for my solution:
> > I tried to add documents to the index and for every document I have a
> > differnt map of factors for every term.
> > However, I get an exception: Exception in thread "main"
> > java.util.ConcurrentModificationException
> > It seems like two threads - one reads the map, one edits it (probably for
> > the next document), bump into each other.
> >
>
> Are you using a single Thread to do all the indexing or multiple threads
> adding document to the index? You need to explain the situation a bit
> more.
>
> Murat
>
> > I tried to put the read part and write part in two different synchronied
> > methods, but it still shows the same exception.
> >
> > Any idea how can it be solved?
> >
> > Best,
> > Liat
> >
> >
> > 2009/4/26 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
> >
> >>
> >> Yes, this is more or less what I had in mind. However, for this approach
> >> one requires some *prior knowledge* of the vocabulary of the document
> >> (or
> >> the collection) to produce that score before even it gets analyzed,
> >> isn't
> >> it? And this is the paradox that I have been thinking. If you have that
> >> knowledge, that's fine. In addition, for applications that only require
> >> a
> >> small term window to generate a score (such as term in context score)
> >> this
> >> can be implemented very easy.
> >>
> >> It is possible to inject the document dependent boost/score generation
> >> *logic* (an interface would do) to the Tokenizer/TokenStream. However, I
> >> am afraid this may have an indexing time penalty. If your window size is
> >> the document itself, you will be doing the same job twice (calculating
> >> the
> >> num of times a term occurs in doc X, index time weights etc.).
> >> IndexWriter
> >> already does these somewhere down deep.
> >>
> >>
> >> Simply put, I want to add some scores to documents/terms, but I can't
> >> generate that score before I observe the document/terms. If I do that I
> >> would replicate some of the work that is being already done by
> >> IndexWriter.
> >>
> >> If I remember it correctly, there is also some intention to add document
> >> payloads functionality. I have the same concerns on this. So I think we
> >> need a clear view on the topic. Where is the payload work moving? How we
> >> can generate a score without duplicating some of the work that
> >> IndexWriter
> >> is doing?   I guess Michael Busch is working on document payloads for
> >> release 3.0. I would appreciate if someone can enlighten us on how that
> >> would work and can be utilised, in particularly during the analysis
> >> phase?
> >>
> >>
> >> Cheers,
> >> Murat
> >>
> >> > Thanks, Murat.
> >> > It was very useful - I also tried to override IndexWriter and
> >> > DocumentsWriter instead, but it didn't work well. DocumentsWriter
> >> can't
> >> > be
> >> > overriden.
> >> >
> >> > So, I didn't find a better way to make the changes.
> >> >
> >> > My needs are having for every term in different documents different
> >> > values.
> >> > So, like you set the boost at the document level, I would like to set
> >> the
> >> > boost for different terms within differnt documents.
> >> >
> >> > For that matter, I made some changes in the code you sent - (I
> >> coloured
> >> > the
> >> > changes in red):
> >> >
> >> > Below you can find an example for the use of it
> >> >
> >> > **********
> >> >  private class PayloadAnalyzer extends Analyzer
> >> >  {
> >> >   private PayloadTokenStream payToken = null;
> >> >   private int score;
> >> >   *private Map<String, Integer> scoresMap = new HashMap<String,
> >> > Integer>();*
> >> >   public synchronized void setScore(int s)
> >> >   {
> >> >    score = s;
> >> >   }
> >> > *  public synchronized void setMapScores(Map<String, Integer>
> >> scoresMap)
> >> >   {
> >> >    this.scoresMap = scoresMap;
> >> >   }*
> >> >   public final TokenStream tokenStream(String field, Reader reader)
> >> >   {
> >> >    payToken = new PayloadTokenStream(new WhitespaceTokenizer(reader));
> >> > //new
> >> > LowerCaseTokenizer(reader));
> >> >    payToken.setScore(score);
> >> >    payToken.setMapScores(scoresMap);
> >> >    return payToken;
> >> >   }
> >> >  }
> >> >  private class PayloadTokenStream extends TokenStream
> >> >  {
> >> >   private Tokenizer tok = null;
> >> >   private int score;
> >> >   *private Map<String, Integer> scoresMap = new HashMap<String,
> >> > Integer>();*
> >> >   public PayloadTokenStream(Tokenizer tokenizer)
> >> >   {
> >> >    tok = tokenizer;
> >> >   }
> >> >   public void setScore(int s)
> >> >   {
> >> >    score = s;
> >> >   }
> >> >  * public synchronized void setMapScores(Map<String, Integer>
> >> scoresMap)
> >> >   {
> >> >    this.scoresMap = scoresMap;
> >> >   }*
> >> >   public Token next(Token t) throws IOException
> >> >   {
> >> >    t = tok.next(t);
> >> >    if(t != null)
> >> >    {
> >> >     //t.setTermBuffer("can change");
> >> >     //Do something with the data
> >> >     byte[] bytes = ("score:" + score).getBytes();
> >> >     //    t.setPayload(new Payload(bytes));
> >> > *    String word = String.copyValueOf(t.termBuffer(), 0,
> >> t.termLength());
> >> >     int score = scoresMap.get(word);
> >> >     byte payLoad = Byte.parseByte(String.valueOf(score));
> >> >     t.setPayload(new Payload(new byte[] { Byte.valueOf(payLoad) }));*
> >> >    }
> >> >    return t;
> >> >   }
> >> >   public void reset(Reader input) throws IOException
> >> >   {
> >> >    tok.reset(input);
> >> >   }
> >> >   public void close() throws IOException
> >> >   {
> >> >    tok.close();
> >> >   }
> >> >  }
> >> > **********************************
> >> > *Example for the use of payloads:*
> >> >
> >> >   PayloadAnalyzer panalyzer = new PayloadAnalyzer();
> >> >   File index = new File("" + "TestSearchIndex");
> >> >   IndexWriter iwriter = new IndexWriter(index, panalyzer);
> >> >   Document d = new Document();
> >> >   d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
> >> > Field.Index.TOKENIZED, Field.TermVector.YES));
> >> >   d.add(new Field("id", "1^3", Field.Store.YES,
> >> Field.Index.UN_TOKENIZED,
> >> > Field.TermVector.NO <http://field.termvector.no/> <
> http://field.termvector.no/>));
> >> >   Map<String, Integer> mapScores = new HashMap<String, Integer>();
> >> >   mapScores.put("word1", 3);
> >> >   mapScores.put("word2", 1);
> >> >   mapScores.put("word3", 1);
> >> >   panalyzer.setMapScores(mapScores);
> >> >   iwriter.addDocument(d, panalyzer);
> >> >   d = new Document();
> >> >   d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
> >> > Field.Index.TOKENIZED, Field.TermVector.YES));
> >> >   d.add(new Field("id", "2^3", Field.Store.YES,
> >> Field.Index.UN_TOKENIZED,
> >> > Field.TermVector.NO <http://field.termvector.no/> <
> http://field.termvector.no/>));
>  >> >   //We set the score for the term of the document that will be
> >> > analyzed.
> >> >   /*I was worried about this part - document dependent score
> >> >   which may be utilized*/
> >> >   mapScores = new HashMap<String, Integer>();
> >> >   mapScores.put("word1", 1);
> >> >   mapScores.put("word2", 3);
> >> >   mapScores.put("word3", 1);
> >> >   panalyzer.setMapScores(mapScores);
> >> >   iwriter.addDocument(d, panalyzer);
> >> >   /*-----------------*/
> >> >   //  iwriter.commit();
> >> >   iwriter.optimize();
> >> >   iwriter.close();
> >> >   BooleanQuery bq = new BooleanQuery();
> >> >   BoostingTermQuery tq = new BoostingTermQuery(new Term("text",
> >> "word1"));
> >> >   tq.setBoost((float) 1.0);
> >> >   bq.add(tq, BooleanClause.Occur.MUST);
> >> >   tq = new BoostingTermQuery(new Term("text", "word2"));
> >> >   tq.setBoost((float) 3);
> >> >   bq.add(tq, BooleanClause.Occur.SHOULD);
> >> >   tq = new BoostingTermQuery(new Term("text", "word3"));
> >> >   tq.setBoost((float) 1);
> >> >   bq.add(tq, BooleanClause.Occur.SHOULD);
> >> >   IndexSearcher searcher1 = new IndexSearcher("TestSearchIndex");
> >> >   searcher1.setSimilarity(new WordsSimilarity());
> >> >   TopDocs topDocs = searcher1.search(bq, null, 3);
> >> >   Hits hits1 = searcher1.search(bq);
> >> >   for(int j = 0; j < hits1.length(); j++)
> >> >   {
> >> >    Explanation explanation = searcher1.explain(bq, j);
> >> >    System.out.println("**** " + hits1.score(j) + " " +
> >> > hits1.doc(j).getField("id").stringValue() + " *****");
> >> >    System.out.println(explanation.toString());
> >> >    explanation.getValue();
> >> >
> >>
>  System.out.println("********************************************************");
> >> >    System.out.println("Score " + topDocs.scoreDocs[j].score + " doc "
> >> +
> >> > searcher1.doc(topDocs.scoreDocs[j].doc).getField("id").stringValue());
> >> >
> >>
>  System.out.println("********************************************************");
> >> >   }
> >> >
> >> > If you try the same query with differnt boosting, you will get a
> >> different
> >> > order for the documents.
> >> >
> >> > Does it look ok?
> >> >
> >> > Thanks again!
> >> > Liat
> >> > 2009/4/25 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
> >> >
> >> >>
> >> >>
> >> >> Here is what I am doing, not so magical... There are two classes, an
> >> >> analyzer and an a TokenStream in which I can inject my document
> >> >> dependent
> >> >> data to be stored as payload.
> >> >>
> >> >>
> >> >> private PayloadAnalyzer panalyzer = new PayloadAnalyzer();
> >> >>
> >> >>    private class PayloadAnalyzer extends Analyzer {
> >> >>
> >> >>        private PayloadTokenStream payToken = null;
> >> >>        private int score;
> >> >>
> >> >>        public synchronized void setScore(int s) {
> >> >>            score=s;
> >> >>        }
> >> >>
> >> >>      public final TokenStream tokenStream(String field, Reader
> >> reader) {
> >> >>         payToken = new PayloadTokenStream(new
> >> >> LowerCaseTokenizer(reader));
> >> >>         payToken.setScore(score);
> >> >>         return payToken;
> >> >>        }
> >> >>    }
> >> >>
> >> >>    private class PayloadTokenStream extends TokenStream {
> >> >>
> >> >>        private Tokenizer tok = null;
> >> >>        private int score;
> >> >>
> >> >>        public PayloadTokenStream(Tokenizer tokenizer) {
> >> >>            tok = tokenizer;
> >> >>        }
> >> >>
> >> >>        public void setScore(int s) {
> >> >>            score = s;
> >> >>        }
> >> >>
> >> >>        public Token next(Token t) throws IOException {
> >> >>            t = tok.next(t);
> >> >>            if (t != null) {
> >> >>                //t.setTermBuffer("can change");
> >> >>                //Do something with the data
> >> >>                byte[] bytes = ("score:"+ score).getBytes();
> >> >>                t.setPayload(new Payload(bytes));
> >> >>            }
> >> >>            return t;
> >> >>        }
> >> >>
> >> >>        public void reset(Reader input) throws IOException {
> >> >>            tok.reset(input);
> >> >>        }
> >> >>
> >> >>        public void close() throws IOException {
> >> >>            tok.close();
> >> >>        }
> >> >>    }
> >> >>
> >> >>
> >> >>    public void doIndex() {
> >> >>        try {
> >> >>            File index = new File("./TestPayloadIndex");
> >> >>            IndexWriter iwriter = new IndexWriter(index,
> >> >>                     panalyzer,
> >> >>                     IndexWriter.MaxFieldLength.UNLIMITED);
> >> >>
> >> >>            Document d = new Document();
> >> >>            d.add(new Field("content",
> >> >>               "Everyone, someone, myTerm, yourTerm", Field.Store.YES,
> >> >>                Field.Index.ANALYZED, Field.TermVector.YES));
> >> >>            //We set the score for the term of the document that will
> >> be
> >> >> analyzed.
> >> >>            /*I was worried about this part - document dependent score
> >> >> which may be utilized*/
> >> >>            panalyzer.setScore(5);
> >> >>            iwriter.addDocument(d, panalyzer);
> >> >>            /*-----------------*/
> >> >>            ...
> >> >>            iwriter.commit();
> >> >>            iwriter.optimize();
> >> >>            iwriter.close();
> >> >>
> >> >>            //Now read the index
> >> >>            IndexReader ireader = IndexReader.open(index);
> >> >>            TermPositions tpos = ireader.termPositions(
> >> >>                                  new Term("content","myterm"));//Note
> >> >> LowercaseTokenizer
> >> >>            while (tpos.next()) {
> >> >>                int pos;
> >> >>                for(int i=0;i<tpos.freq();i++){
> >> >>                    pos=tpos.nextPosition();
> >> >>                    if (tpos.isPayloadAvailable()) {
> >> >>                        byte[] data = new
> >> byte[tpos.getPayloadLength()];
> >> >>                        tpos.getPayload(data, 0);
> >> >>                       //Utilise payloads;
> >> >>                    }
> >> >>                }
> >> >>            }
> >> >>
> >> >>            tpos.close();
> >> >>        } catch (CorruptIndexException ex) {
> >> >>           //
> >> >>        } catch (LockObtainFailedException ex) {
> >> >>            //
> >> >>        } catch (IOException ex) {
> >> >>            //
> >> >>        }
> >> >>    }
> >> >>
> >> >> I wish it was designed better... Please let me know if you guys have
> >> a
> >> >> better idea.
> >> >>
> >> >> Cheers,
> >> >> Murat
> >> >>
> >> >> > Dear Murat,
> >> >> >
> >> >> > I saw your question and wondered how did you implement these
> >> changes?
> >> >> > The requirement below are the same ones as I am trying to code now.
> >> >> > Did you modify the source code itself or only used Lucene's jar and
> >> >> just
> >> >> > override code?
> >> >> >
> >> >> > I would very much apprecicate if you could give me a short
> >> explanation
> >> >> on
> >> >> > how was it done.
> >> >> >
> >> >> > Thanks a lot,
> >> >> > Liat
> >> >> >
> >> >> > 2009/4/21 Murat Yakici <murat.yakici@cis.strath.ac.uk>
> >> >> >
> >> >> >> Hi,
> >> >> >> I started playing with the experimental payload functionality. I
> >> have
> >> >> >> written an analyzer which adds a payload (some sort of a
> >> score/boost)
> >> >> >> for
> >> >> >> each term occurance. The payload/score for each term is dependent
> >> on
> >> >> the
> >> >> >> document that the term comes from (I guess this is the typoical
> >> use
> >> >> >> case).
> >> >> >> So say term t1 may have a payload of 5 in doc1 and 34 in doc5. The
> >> >> >> parameter
> >> >> >> for calculating the payload changes after each
> >> >> >> indexWriter.addDocument(..)
> >> >> >> method call in a while loop. I am assuming that the
> >> >> >> indexWriter.addDocument(..) methods are thread safe. Can I confirm
> >> >> this?
> >> >> >>
> >> >> >> Cheers,
> >> >> >>
> >> >> >> --
> >> >> >> Murat Yakici
> >> >> >> Department of Computer & Information Sciences
> >> >> >> University of Strathclyde
> >> >> >> Glasgow, UK
> >> >> >> -------------------------------------------
> >> >> >> The University of Strathclyde is a charitable body, registered in
> >> >> >> Scotland,
> >> >> >> with registration number SC015263.
> >> >> >>
> >> >> >>
> >> >> >>
> ---------------------------------------------------------------------
> >> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >> >>
> >> >> >>
> >> >> >
> >> >>
> >> >>
> >> >> Murat Yakici
> >> >> Department of Computer & Information Sciences
> >> >> University of Strathclyde
> >> >> Glasgow, UK
> >> >> -------------------------------------------
> >> >> The University of Strathclyde is a charitable body, registered in
> >> >> Scotland,
> >> >> with registration number SC015263.
> >> >>
> >> >>
> >> >> ---------------------------------------------------------------------
> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >>
> >> >>
> >> >
> >>
> >>
> >> Murat Yakici
> >> Department of Computer & Information Sciences
> >> University of Strathclyde
> >> Glasgow, UK
> >> -------------------------------------------
> >> The University of Strathclyde is a charitable body, registered in
> >> Scotland,
> >> with registration number SC015263.
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
>
> Murat Yakici
> Department of Computer & Information Sciences
> University of Strathclyde
> Glasgow, UK
> -------------------------------------------
> The University of Strathclyde is a charitable body, registered in Scotland,
> with registration number SC015263.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174c3e88cc7e88046885be9e--

From java-user-return-39959-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 09:41:34 2009
Return-Path: <java-user-return-39959-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14691 invoked from network); 27 Apr 2009 09:41:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 09:41:34 -0000
Received: (qmail 74556 invoked by uid 500); 27 Apr 2009 09:41:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74471 invoked by uid 500); 27 Apr 2009 09:41:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74461 invoked by uid 99); 27 Apr 2009 09:41:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 09:41:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of murat.yakici@cis.strath.ac.uk designates 130.159.196.96 as permitted sender)
Received: from [130.159.196.96] (HELO smtphost.cis.strath.ac.uk) (130.159.196.96)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 09:41:22 +0000
Received: from [130.159.185.12] (pc-hotdesk.cis.strath.ac.uk [130.159.185.12])
	by arnott.cis.strath.ac.uk (8.14.2/8.14.2/Debian-2build1) with ESMTP id n3R9eulr020270
	for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 10:40:56 +0100
Message-ID: <49F57DA8.2010805@cis.strath.ac.uk>
Date: Mon, 27 Apr 2009 10:40:56 +0100
From: Murat Yakici <murat.yakici@cis.strath.ac.uk>
User-Agent: Thunderbird 2.0.0.12 (Windows/20080213)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Using Payloads
References: <49ED8646.6040508@cis.strath.ac.uk>	 <d36c28c30904222359m74c810b6p83bdea1af5345bc8@mail.gmail.com>	 <53517.93.97.155.28.1240663266.squirrel@webmail.cis.strath.ac.uk>	 <d36c28c30904260206v623a9c20p3c61d1e5f937ac7c@mail.gmail.com>	 <58055.93.97.155.28.1240745264.squirrel@webmail.cis.strath.ac.uk>	 <d36c28c30904260513p129d38b9yeac5830e5b888e2f@mail.gmail.com>	 <51398.93.97.155.28.1240772248.squirrel@webmail.cis.strath.ac.uk> <d36c28c30904270212t661b995aie2d35f89444de65e@mail.gmail.com>
In-Reply-To: <d36c28c30904270212t661b995aie2d35f89444de65e@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-CIS-MailScanner-SpamCheck: SpamAssassin score=-1.44, ALL_TRUSTED
X-Scanned-By: MIMEDefang on 130.159.196.96
X-Virus-Checked: Checked by ClamAV on apache.org

See http://wiki.apache.org/lucene-java/ImproveIndexingSpeed
and http://wiki.apache.org/lucene-java/ImproveSearchingSpeed
and http://wiki.apache.org/lucene-java/ConcurrentAccessToIndex

Murat Yakici
Department of Computer & Information Sciences
University of Strathclyde
Glasgow, UK
-------------------------------------------
The University of Strathclyde is a charitable body, registered in Scotland, 
with registration number SC015263.



liat oren wrote:
> Yes, I agree with you - I also tried this approach in the past and it was
> terribely slow - looping on the term vectors.
>
> What I have done - is dividing indexes into steps - which of course, if can
> be avoided, it will be more than great!!
>
> As for my problem -  it was a code problems, I sloved it, thanks.
> Is it recommended to use multi-thread in order to index?
>
> Best,
> Liat
> 2009/4/26 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
>
>   
>> See my comments:
>>
>>     
>>> Yes, for this specific part, I have this prior knowledge which is based
>>>       
>> on
>>     
>>> a
>>> training set.
>>> About the things you raise here, there are two things you might mean, I
>>>       
>> am
>>     
>>> not sure:
>>>
>>> 1. If you don't have that "prior" knowledge, then all it means you need
>>>       
>> to
>>     
>>> modify the formula of the score, no? to give more weight to factors you
>>> think to be more significant.
>>> The TermFreqVector will have the term frequencies and you will be able to
>>> edit the score formula so it will fit your needs.
>>>
>>>       
>> Although I like the TermFreqVector approach, the API and everything, it is
>> slower than using TermEnum and TermDocs. I don't have solid statistics,
>> but I confirmed the fact during my development work on a 80+ core SG
>> server. I wish TermFreqVector approach could load abit faster.
>>
>>
>>
>>     
>>> Or
>>>
>>> 2. Enable us to add statistics factors while indexing
>>>       
>> This is what I am talking about, *Indexing time*.
>>
>>     
>>> Question - why do you want to edit these while indexing and not using
>>>       
>> them
>>     
>>> at "search" time in the way you desire? At this stage you already have
>>>       
>> all
>>     
>>> the statistics - frequencies of all terms within and outside documents
>>>       
>> First of all you don't have all the statistics. Because, there are some
>> statistics that you simple can't calculate (or more correctly you
>> shouldn't be due to performance) during the query scoring time. It will be
>> an overkill.
>>
>>     
>>> As for my solution:
>>> I tried to add documents to the index and for every document I have a
>>> differnt map of factors for every term.
>>> However, I get an exception: Exception in thread "main"
>>> java.util.ConcurrentModificationException
>>> It seems like two threads - one reads the map, one edits it (probably for
>>> the next document), bump into each other.
>>>
>>>       
>> Are you using a single Thread to do all the indexing or multiple threads
>> adding document to the index? You need to explain the situation a bit
>> more.
>>
>> Murat
>>
>>     
>>> I tried to put the read part and write part in two different synchronied
>>> methods, but it still shows the same exception.
>>>
>>> Any idea how can it be solved?
>>>
>>> Best,
>>> Liat
>>>
>>>
>>> 2009/4/26 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
>>>
>>>       
>>>> Yes, this is more or less what I had in mind. However, for this approach
>>>> one requires some *prior knowledge* of the vocabulary of the document
>>>> (or
>>>> the collection) to produce that score before even it gets analyzed,
>>>> isn't
>>>> it? And this is the paradox that I have been thinking. If you have that
>>>> knowledge, that's fine. In addition, for applications that only require
>>>> a
>>>> small term window to generate a score (such as term in context score)
>>>> this
>>>> can be implemented very easy.
>>>>
>>>> It is possible to inject the document dependent boost/score generation
>>>> *logic* (an interface would do) to the Tokenizer/TokenStream. However, I
>>>> am afraid this may have an indexing time penalty. If your window size is
>>>> the document itself, you will be doing the same job twice (calculating
>>>> the
>>>> num of times a term occurs in doc X, index time weights etc.).
>>>> IndexWriter
>>>> already does these somewhere down deep.
>>>>
>>>>
>>>> Simply put, I want to add some scores to documents/terms, but I can't
>>>> generate that score before I observe the document/terms. If I do that I
>>>> would replicate some of the work that is being already done by
>>>> IndexWriter.
>>>>
>>>> If I remember it correctly, there is also some intention to add document
>>>> payloads functionality. I have the same concerns on this. So I think we
>>>> need a clear view on the topic. Where is the payload work moving? How we
>>>> can generate a score without duplicating some of the work that
>>>> IndexWriter
>>>> is doing?   I guess Michael Busch is working on document payloads for
>>>> release 3.0. I would appreciate if someone can enlighten us on how that
>>>> would work and can be utilised, in particularly during the analysis
>>>> phase?
>>>>
>>>>
>>>> Cheers,
>>>> Murat
>>>>
>>>>         
>>>>> Thanks, Murat.
>>>>> It was very useful - I also tried to override IndexWriter and
>>>>> DocumentsWriter instead, but it didn't work well. DocumentsWriter
>>>>>           
>>>> can't
>>>>         
>>>>> be
>>>>> overriden.
>>>>>
>>>>> So, I didn't find a better way to make the changes.
>>>>>
>>>>> My needs are having for every term in different documents different
>>>>> values.
>>>>> So, like you set the boost at the document level, I would like to set
>>>>>           
>>>> the
>>>>         
>>>>> boost for different terms within differnt documents.
>>>>>
>>>>> For that matter, I made some changes in the code you sent - (I
>>>>>           
>>>> coloured
>>>>         
>>>>> the
>>>>> changes in red):
>>>>>
>>>>> Below you can find an example for the use of it
>>>>>
>>>>> **********
>>>>>  private class PayloadAnalyzer extends Analyzer
>>>>>  {
>>>>>   private PayloadTokenStream payToken = null;
>>>>>   private int score;
>>>>>   *private Map<String, Integer> scoresMap = new HashMap<String,
>>>>> Integer>();*
>>>>>   public synchronized void setScore(int s)
>>>>>   {
>>>>>    score = s;
>>>>>   }
>>>>> *  public synchronized void setMapScores(Map<String, Integer>
>>>>>           
>>>> scoresMap)
>>>>         
>>>>>   {
>>>>>    this.scoresMap = scoresMap;
>>>>>   }*
>>>>>   public final TokenStream tokenStream(String field, Reader reader)
>>>>>   {
>>>>>    payToken = new PayloadTokenStream(new WhitespaceTokenizer(reader));
>>>>> //new
>>>>> LowerCaseTokenizer(reader));
>>>>>    payToken.setScore(score);
>>>>>    payToken.setMapScores(scoresMap);
>>>>>    return payToken;
>>>>>   }
>>>>>  }
>>>>>  private class PayloadTokenStream extends TokenStream
>>>>>  {
>>>>>   private Tokenizer tok = null;
>>>>>   private int score;
>>>>>   *private Map<String, Integer> scoresMap = new HashMap<String,
>>>>> Integer>();*
>>>>>   public PayloadTokenStream(Tokenizer tokenizer)
>>>>>   {
>>>>>    tok = tokenizer;
>>>>>   }
>>>>>   public void setScore(int s)
>>>>>   {
>>>>>    score = s;
>>>>>   }
>>>>>  * public synchronized void setMapScores(Map<String, Integer>
>>>>>           
>>>> scoresMap)
>>>>         
>>>>>   {
>>>>>    this.scoresMap = scoresMap;
>>>>>   }*
>>>>>   public Token next(Token t) throws IOException
>>>>>   {
>>>>>    t = tok.next(t);
>>>>>    if(t != null)
>>>>>    {
>>>>>     //t.setTermBuffer("can change");
>>>>>     //Do something with the data
>>>>>     byte[] bytes = ("score:" + score).getBytes();
>>>>>     //    t.setPayload(new Payload(bytes));
>>>>> *    String word = String.copyValueOf(t.termBuffer(), 0,
>>>>>           
>>>> t.termLength());
>>>>         
>>>>>     int score = scoresMap.get(word);
>>>>>     byte payLoad = Byte.parseByte(String.valueOf(score));
>>>>>     t.setPayload(new Payload(new byte[] { Byte.valueOf(payLoad) }));*
>>>>>    }
>>>>>    return t;
>>>>>   }
>>>>>   public void reset(Reader input) throws IOException
>>>>>   {
>>>>>    tok.reset(input);
>>>>>   }
>>>>>   public void close() throws IOException
>>>>>   {
>>>>>    tok.close();
>>>>>   }
>>>>>  }
>>>>> **********************************
>>>>> *Example for the use of payloads:*
>>>>>
>>>>>   PayloadAnalyzer panalyzer = new PayloadAnalyzer();
>>>>>   File index = new File("" + "TestSearchIndex");
>>>>>   IndexWriter iwriter = new IndexWriter(index, panalyzer);
>>>>>   Document d = new Document();
>>>>>   d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
>>>>> Field.Index.TOKENIZED, Field.TermVector.YES));
>>>>>   d.add(new Field("id", "1^3", Field.Store.YES,
>>>>>           
>>>> Field.Index.UN_TOKENIZED,
>>>>         
>>>>> Field.TermVector.NO <http://field.termvector.no/> <
>>>>>           
>> http://field.termvector.no/>));
>>     
>>>>>   Map<String, Integer> mapScores = new HashMap<String, Integer>();
>>>>>   mapScores.put("word1", 3);
>>>>>   mapScores.put("word2", 1);
>>>>>   mapScores.put("word3", 1);
>>>>>   panalyzer.setMapScores(mapScores);
>>>>>   iwriter.addDocument(d, panalyzer);
>>>>>   d = new Document();
>>>>>   d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
>>>>> Field.Index.TOKENIZED, Field.TermVector.YES));
>>>>>   d.add(new Field("id", "2^3", Field.Store.YES,
>>>>>           
>>>> Field.Index.UN_TOKENIZED,
>>>>         
>>>>> Field.TermVector.NO <http://field.termvector.no/> <
>>>>>           
>> http://field.termvector.no/>));
>>  >> >   //We set the score for the term of the document that will be
>>     
>>>>> analyzed.
>>>>>   /*I was worried about this part - document dependent score
>>>>>   which may be utilized*/
>>>>>   mapScores = new HashMap<String, Integer>();
>>>>>   mapScores.put("word1", 1);
>>>>>   mapScores.put("word2", 3);
>>>>>   mapScores.put("word3", 1);
>>>>>   panalyzer.setMapScores(mapScores);
>>>>>   iwriter.addDocument(d, panalyzer);
>>>>>   /*-----------------*/
>>>>>   //  iwriter.commit();
>>>>>   iwriter.optimize();
>>>>>   iwriter.close();
>>>>>   BooleanQuery bq = new BooleanQuery();
>>>>>   BoostingTermQuery tq = new BoostingTermQuery(new Term("text",
>>>>>           
>>>> "word1"));
>>>>         
>>>>>   tq.setBoost((float) 1.0);
>>>>>   bq.add(tq, BooleanClause.Occur.MUST);
>>>>>   tq = new BoostingTermQuery(new Term("text", "word2"));
>>>>>   tq.setBoost((float) 3);
>>>>>   bq.add(tq, BooleanClause.Occur.SHOULD);
>>>>>   tq = new BoostingTermQuery(new Term("text", "word3"));
>>>>>   tq.setBoost((float) 1);
>>>>>   bq.add(tq, BooleanClause.Occur.SHOULD);
>>>>>   IndexSearcher searcher1 = new IndexSearcher("TestSearchIndex");
>>>>>   searcher1.setSimilarity(new WordsSimilarity());
>>>>>   TopDocs topDocs = searcher1.search(bq, null, 3);
>>>>>   Hits hits1 = searcher1.search(bq);
>>>>>   for(int j = 0; j < hits1.length(); j++)
>>>>>   {
>>>>>    Explanation explanation = searcher1.explain(bq, j);
>>>>>    System.out.println("**** " + hits1.score(j) + " " +
>>>>> hits1.doc(j).getField("id").stringValue() + " *****");
>>>>>    System.out.println(explanation.toString());
>>>>>    explanation.getValue();
>>>>>
>>>>>           
>>  System.out.println("********************************************************");
>>     
>>>>>    System.out.println("Score " + topDocs.scoreDocs[j].score + " doc "
>>>>>           
>>>> +
>>>>         
>>>>> searcher1.doc(topDocs.scoreDocs[j].doc).getField("id").stringValue());
>>>>>
>>>>>           
>>  System.out.println("********************************************************");
>>     
>>>>>   }
>>>>>
>>>>> If you try the same query with differnt boosting, you will get a
>>>>>           
>>>> different
>>>>         
>>>>> order for the documents.
>>>>>
>>>>> Does it look ok?
>>>>>
>>>>> Thanks again!
>>>>> Liat
>>>>> 2009/4/25 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
>>>>>
>>>>>           
>>>>>> Here is what I am doing, not so magical... There are two classes, an
>>>>>> analyzer and an a TokenStream in which I can inject my document
>>>>>> dependent
>>>>>> data to be stored as payload.
>>>>>>
>>>>>>
>>>>>> private PayloadAnalyzer panalyzer = new PayloadAnalyzer();
>>>>>>
>>>>>>    private class PayloadAnalyzer extends Analyzer {
>>>>>>
>>>>>>        private PayloadTokenStream payToken = null;
>>>>>>        private int score;
>>>>>>
>>>>>>        public synchronized void setScore(int s) {
>>>>>>            score=s;
>>>>>>        }
>>>>>>
>>>>>>      public final TokenStream tokenStream(String field, Reader
>>>>>>             
>>>> reader) {
>>>>         
>>>>>>         payToken = new PayloadTokenStream(new
>>>>>> LowerCaseTokenizer(reader));
>>>>>>         payToken.setScore(score);
>>>>>>         return payToken;
>>>>>>        }
>>>>>>    }
>>>>>>
>>>>>>    private class PayloadTokenStream extends TokenStream {
>>>>>>
>>>>>>        private Tokenizer tok = null;
>>>>>>        private int score;
>>>>>>
>>>>>>        public PayloadTokenStream(Tokenizer tokenizer) {
>>>>>>            tok = tokenizer;
>>>>>>        }
>>>>>>
>>>>>>        public void setScore(int s) {
>>>>>>            score = s;
>>>>>>        }
>>>>>>
>>>>>>        public Token next(Token t) throws IOException {
>>>>>>            t = tok.next(t);
>>>>>>            if (t != null) {
>>>>>>                //t.setTermBuffer("can change");
>>>>>>                //Do something with the data
>>>>>>                byte[] bytes = ("score:"+ score).getBytes();
>>>>>>                t.setPayload(new Payload(bytes));
>>>>>>            }
>>>>>>            return t;
>>>>>>        }
>>>>>>
>>>>>>        public void reset(Reader input) throws IOException {
>>>>>>            tok.reset(input);
>>>>>>        }
>>>>>>
>>>>>>        public void close() throws IOException {
>>>>>>            tok.close();
>>>>>>        }
>>>>>>    }
>>>>>>
>>>>>>
>>>>>>    public void doIndex() {
>>>>>>        try {
>>>>>>            File index = new File("./TestPayloadIndex");
>>>>>>            IndexWriter iwriter = new IndexWriter(index,
>>>>>>                     panalyzer,
>>>>>>                     IndexWriter.MaxFieldLength.UNLIMITED);
>>>>>>
>>>>>>            Document d = new Document();
>>>>>>            d.add(new Field("content",
>>>>>>               "Everyone, someone, myTerm, yourTerm", Field.Store.YES,
>>>>>>                Field.Index.ANALYZED, Field.TermVector.YES));
>>>>>>            //We set the score for the term of the document that will
>>>>>>             
>>>> be
>>>>         
>>>>>> analyzed.
>>>>>>            /*I was worried about this part - document dependent score
>>>>>> which may be utilized*/
>>>>>>            panalyzer.setScore(5);
>>>>>>            iwriter.addDocument(d, panalyzer);
>>>>>>            /*-----------------*/
>>>>>>            ...
>>>>>>            iwriter.commit();
>>>>>>            iwriter.optimize();
>>>>>>            iwriter.close();
>>>>>>
>>>>>>            //Now read the index
>>>>>>            IndexReader ireader = IndexReader.open(index);
>>>>>>            TermPositions tpos = ireader.termPositions(
>>>>>>                                  new Term("content","myterm"));//Note
>>>>>> LowercaseTokenizer
>>>>>>            while (tpos.next()) {
>>>>>>                int pos;
>>>>>>                for(int i=0;i<tpos.freq();i++){
>>>>>>                    pos=tpos.nextPosition();
>>>>>>                    if (tpos.isPayloadAvailable()) {
>>>>>>                        byte[] data = new
>>>>>>             
>>>> byte[tpos.getPayloadLength()];
>>>>         
>>>>>>                        tpos.getPayload(data, 0);
>>>>>>                       //Utilise payloads;
>>>>>>                    }
>>>>>>                }
>>>>>>            }
>>>>>>
>>>>>>            tpos.close();
>>>>>>        } catch (CorruptIndexException ex) {
>>>>>>           //
>>>>>>        } catch (LockObtainFailedException ex) {
>>>>>>            //
>>>>>>        } catch (IOException ex) {
>>>>>>            //
>>>>>>        }
>>>>>>    }
>>>>>>
>>>>>> I wish it was designed better... Please let me know if you guys have
>>>>>>             
>>>> a
>>>>         
>>>>>> better idea.
>>>>>>
>>>>>> Cheers,
>>>>>> Murat
>>>>>>
>>>>>>             
>>>>>>> Dear Murat,
>>>>>>>
>>>>>>> I saw your question and wondered how did you implement these
>>>>>>>               
>>>> changes?
>>>>         
>>>>>>> The requirement below are the same ones as I am trying to code now.
>>>>>>> Did you modify the source code itself or only used Lucene's jar and
>>>>>>>               
>>>>>> just
>>>>>>             
>>>>>>> override code?
>>>>>>>
>>>>>>> I would very much apprecicate if you could give me a short
>>>>>>>               
>>>> explanation
>>>>         
>>>>>> on
>>>>>>             
>>>>>>> how was it done.
>>>>>>>
>>>>>>> Thanks a lot,
>>>>>>> Liat
>>>>>>>
>>>>>>> 2009/4/21 Murat Yakici <murat.yakici@cis.strath.ac.uk>
>>>>>>>
>>>>>>>               
>>>>>>>> Hi,
>>>>>>>> I started playing with the experimental payload functionality. I
>>>>>>>>                 
>>>> have
>>>>         
>>>>>>>> written an analyzer which adds a payload (some sort of a
>>>>>>>>                 
>>>> score/boost)
>>>>         
>>>>>>>> for
>>>>>>>> each term occurance. The payload/score for each term is dependent
>>>>>>>>                 
>>>> on
>>>>         
>>>>>> the
>>>>>>             
>>>>>>>> document that the term comes from (I guess this is the typoical
>>>>>>>>                 
>>>> use
>>>>         
>>>>>>>> case).
>>>>>>>> So say term t1 may have a payload of 5 in doc1 and 34 in doc5. The
>>>>>>>> parameter
>>>>>>>> for calculating the payload changes after each
>>>>>>>> indexWriter.addDocument(..)
>>>>>>>> method call in a while loop. I am assuming that the
>>>>>>>> indexWriter.addDocument(..) methods are thread safe. Can I confirm
>>>>>>>>                 
>>>>>> this?
>>>>>>             
>>>>>>>> Cheers,
>>>>>>>>
>>>>>>>> --
>>>>>>>> Murat Yakici
>>>>>>>> Department of Computer & Information Sciences
>>>>>>>> University of Strathclyde
>>>>>>>> Glasgow, UK
>>>>>>>> -------------------------------------------
>>>>>>>> The University of Strathclyde is a charitable body, registered in
>>>>>>>> Scotland,
>>>>>>>> with registration number SC015263.
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>                 
>> ---------------------------------------------------------------------
>>     
>>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>>
>>>>>>>>
>>>>>>>>                 
>>>>>> Murat Yakici
>>>>>> Department of Computer & Information Sciences
>>>>>> University of Strathclyde
>>>>>> Glasgow, UK
>>>>>> -------------------------------------------
>>>>>> The University of Strathclyde is a charitable body, registered in
>>>>>> Scotland,
>>>>>> with registration number SC015263.
>>>>>>
>>>>>>
>>>>>> ---------------------------------------------------------------------
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>>>             
>>>> Murat Yakici
>>>> Department of Computer & Information Sciences
>>>> University of Strathclyde
>>>> Glasgow, UK
>>>> -------------------------------------------
>>>> The University of Strathclyde is a charitable body, registered in
>>>> Scotland,
>>>> with registration number SC015263.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>         
>> Murat Yakici
>> Department of Computer & Information Sciences
>> University of Strathclyde
>> Glasgow, UK
>> -------------------------------------------
>> The University of Strathclyde is a charitable body, registered in Scotland,
>> with registration number SC015263.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39960-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 10:02:07 2009
Return-Path: <java-user-return-39960-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24900 invoked from network); 27 Apr 2009 10:02:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 10:02:07 -0000
Received: (qmail 96427 invoked by uid 500); 27 Apr 2009 10:02:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96361 invoked by uid 500); 27 Apr 2009 10:02:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96351 invoked by uid 99); 27 Apr 2009 10:02:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 10:02:04 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.27 as permitted sender)
Received: from [66.111.4.27] (HELO out3.smtp.messagingengine.com) (66.111.4.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 10:01:55 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id C890C3208B7
	for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 06:01:34 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute1.internal (MEProxy); Mon, 27 Apr 2009 06:01:34 -0400
X-Sasl-enc: p0AflWLY0mA/x5aTZ6PEF1mIxbpYf3o5LJ68HVD/UIC+ 1240826494
Received: from [192.168.2.50] (cpc2-leed4-0-0-cust912.leed.cable.ntl.com [81.105.111.145])
	by mail.messagingengine.com (Postfix) with ESMTPA id 6A60630EE3
	for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 06:01:34 -0400 (EDT)
Message-ID: <49F58284.3030606@fastmail.fm>
Date: Mon, 27 Apr 2009 11:01:40 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: no segments* file found: files: Error on opening index
References: <49F1E14C.7080308@fastmail.fm>
In-Reply-To: <49F1E14C.7080308@fastmail.fm>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Paul Taylor wrote:
> Hi I was using a RAMDirectory and this was working fine but have now 
> moved over to a  filesystem directory to preserve space, the directory 
> is just initialized once
>    directory = new RAMDirectory();
>    directory = 
> FSDirectory.getDirectory(Platform.getPlatformLicenseFolder()+ "/" + 
> TAG_BROWSER_INDEX);
>
> but I create an IndexReader as required
>     IndexReader ir = IndexReader.open(directory);
> and then close it when Ive finished with it.
>
> but sometimes it is failing with
>    no segments* file found: files:
> interestingly no file is specified in the error message whereas other 
> reporters of this message show a reference to an actual file in the 
> message.
>
> My code is multithreaded so I'm wondering if the problem is that two 
> thread have both opened an IndexReader, or one thread is using an 
> IndexWriter to add a document, whilst another is trying to read. But I 
> wasnt aware either of these cases was not allowed, any ideas ?
>
> thanks Paul
>
Hi, anybody have an idea about this, Im sure Im not the only one to 
encounter this.

Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39961-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 10:13:06 2009
Return-Path: <java-user-return-39961-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32219 invoked from network); 27 Apr 2009 10:13:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 10:13:06 -0000
Received: (qmail 13851 invoked by uid 500); 27 Apr 2009 10:13:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13794 invoked by uid 500); 27 Apr 2009 10:13:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13784 invoked by uid 99); 27 Apr 2009 10:13:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 10:13:03 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 10:12:54 +0000
Received: by ewy27 with SMTP id 27so2160564ewy.5
        for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 03:12:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=c9X4NUg37GnBgKDXDFApNmZ98gvtXKY/uI2ZtWU7GzQ=;
        b=Llodg+8ebqYzSB5H3elLfk1f5G1FmZi82+KobHLZg6HXhmT/QZoJfH7p8Aw+EKFqdI
         T2jlOcCWN3H3ZuBvaC6lxZ8TVqSITm9wgJb4CS5vCVFiZT7K5JS0WE0By1/pk8ttHm6K
         NvO0lASSsWFH3KvYQIvg3bzlan9kqRp1D3hLI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ZeqGUDUsg0mtwDKy3W2xF5KOKRP93xiPbA3Pm1Gvv2fEPjSRBtQmtro9LFMJfycD1m
         bajKZr4wLnLEMQDCvLc9aokK14890vdcnBXxMJaj4UVUS5hPq6uTx6A2sgPNWOQ0t8xi
         jtzPiwVG7U/yXpr+PKBL6oCk2o//pq4Z+pE5c=
MIME-Version: 1.0
Received: by 10.210.105.8 with SMTP id d8mr4583940ebc.55.1240827153693; Mon, 
	27 Apr 2009 03:12:33 -0700 (PDT)
In-Reply-To: <49F57DA8.2010805@cis.strath.ac.uk>
References: <49ED8646.6040508@cis.strath.ac.uk>
	 <d36c28c30904222359m74c810b6p83bdea1af5345bc8@mail.gmail.com>
	 <53517.93.97.155.28.1240663266.squirrel@webmail.cis.strath.ac.uk>
	 <d36c28c30904260206v623a9c20p3c61d1e5f937ac7c@mail.gmail.com>
	 <58055.93.97.155.28.1240745264.squirrel@webmail.cis.strath.ac.uk>
	 <d36c28c30904260513p129d38b9yeac5830e5b888e2f@mail.gmail.com>
	 <51398.93.97.155.28.1240772248.squirrel@webmail.cis.strath.ac.uk>
	 <d36c28c30904270212t661b995aie2d35f89444de65e@mail.gmail.com>
	 <49F57DA8.2010805@cis.strath.ac.uk>
Date: Mon, 27 Apr 2009 13:12:33 +0300
Message-ID: <d36c28c30904270312u8959b74wb5e316a6f37225df@mail.gmail.com>
Subject: Re: Using Payloads
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174beee4b93d5f0468869572
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174beee4b93d5f0468869572
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Thanks a lot!
I will deffenitely will go thoroughly over these

2009/4/27 Murat Yakici <murat.yakici@cis.strath.ac.uk>

> See http://wiki.apache.org/lucene-java/ImproveIndexingSpeed
> and http://wiki.apache.org/lucene-java/ImproveSearchingSpeed
> and http://wiki.apache.org/lucene-java/ConcurrentAccessToIndex
>
> Murat Yakici
> Department of Computer & Information Sciences
> University of Strathclyde
> Glasgow, UK
> -------------------------------------------
> The University of Strathclyde is a charitable body, registered in Scotland,
> with registration number SC015263.
>
>
>
>  liat oren wrote:
>
>> Yes, I agree with you - I also tried this approach in the past and it was
>> terribely slow - looping on the term vectors.
>>
>> What I have done - is dividing indexes into steps - which of course, if
>> can
>> be avoided, it will be more than great!!
>>
>> As for my problem -  it was a code problems, I sloved it, thanks.
>> Is it recommended to use multi-thread in order to index?
>>
>> Best,
>> Liat
>> 2009/4/26 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
>>
>>
>>
>>> See my comments:
>>>
>>>
>>>
>>>> Yes, for this specific part, I have this prior knowledge which is based
>>>>
>>>>
>>> on
>>>
>>>
>>>> a
>>>> training set.
>>>> About the things you raise here, there are two things you might mean, I
>>>>
>>>>
>>> am
>>>
>>>
>>>> not sure:
>>>>
>>>> 1. If you don't have that "prior" knowledge, then all it means you need
>>>>
>>>>
>>> to
>>>
>>>
>>>> modify the formula of the score, no? to give more weight to factors you
>>>> think to be more significant.
>>>> The TermFreqVector will have the term frequencies and you will be able
>>>> to
>>>> edit the score formula so it will fit your needs.
>>>>
>>>>
>>>>
>>> Although I like the TermFreqVector approach, the API and everything, it
>>> is
>>> slower than using TermEnum and TermDocs. I don't have solid statistics,
>>> but I confirmed the fact during my development work on a 80+ core SG
>>> server. I wish TermFreqVector approach could load abit faster.
>>>
>>>
>>>
>>>
>>>
>>>> Or
>>>>
>>>> 2. Enable us to add statistics factors while indexing
>>>>
>>>>
>>> This is what I am talking about, *Indexing time*.
>>>
>>>
>>>
>>>> Question - why do you want to edit these while indexing and not using
>>>>
>>>>
>>> them
>>>
>>>
>>>> at "search" time in the way you desire? At this stage you already have
>>>>
>>>>
>>> all
>>>
>>>
>>>> the statistics - frequencies of all terms within and outside documents
>>>>
>>>>
>>> First of all you don't have all the statistics. Because, there are some
>>> statistics that you simple can't calculate (or more correctly you
>>> shouldn't be due to performance) during the query scoring time. It will
>>> be
>>> an overkill.
>>>
>>>
>>>
>>>> As for my solution:
>>>> I tried to add documents to the index and for every document I have a
>>>> differnt map of factors for every term.
>>>> However, I get an exception: Exception in thread "main"
>>>> java.util.ConcurrentModificationException
>>>> It seems like two threads - one reads the map, one edits it (probably
>>>> for
>>>> the next document), bump into each other.
>>>>
>>>>
>>>>
>>> Are you using a single Thread to do all the indexing or multiple threads
>>> adding document to the index? You need to explain the situation a bit
>>> more.
>>>
>>> Murat
>>>
>>>
>>>
>>>> I tried to put the read part and write part in two different synchronied
>>>> methods, but it still shows the same exception.
>>>>
>>>> Any idea how can it be solved?
>>>>
>>>> Best,
>>>> Liat
>>>>
>>>>
>>>> 2009/4/26 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
>>>>
>>>>
>>>>
>>>>> Yes, this is more or less what I had in mind. However, for this
>>>>> approach
>>>>> one requires some *prior knowledge* of the vocabulary of the document
>>>>> (or
>>>>> the collection) to produce that score before even it gets analyzed,
>>>>> isn't
>>>>> it? And this is the paradox that I have been thinking. If you have that
>>>>> knowledge, that's fine. In addition, for applications that only require
>>>>> a
>>>>> small term window to generate a score (such as term in context score)
>>>>> this
>>>>> can be implemented very easy.
>>>>>
>>>>> It is possible to inject the document dependent boost/score generation
>>>>> *logic* (an interface would do) to the Tokenizer/TokenStream. However,
>>>>> I
>>>>> am afraid this may have an indexing time penalty. If your window size
>>>>> is
>>>>> the document itself, you will be doing the same job twice (calculating
>>>>> the
>>>>> num of times a term occurs in doc X, index time weights etc.).
>>>>> IndexWriter
>>>>> already does these somewhere down deep.
>>>>>
>>>>>
>>>>> Simply put, I want to add some scores to documents/terms, but I can't
>>>>> generate that score before I observe the document/terms. If I do that I
>>>>> would replicate some of the work that is being already done by
>>>>> IndexWriter.
>>>>>
>>>>> If I remember it correctly, there is also some intention to add
>>>>> document
>>>>> payloads functionality. I have the same concerns on this. So I think we
>>>>> need a clear view on the topic. Where is the payload work moving? How
>>>>> we
>>>>> can generate a score without duplicating some of the work that
>>>>> IndexWriter
>>>>> is doing?   I guess Michael Busch is working on document payloads for
>>>>> release 3.0. I would appreciate if someone can enlighten us on how that
>>>>> would work and can be utilised, in particularly during the analysis
>>>>> phase?
>>>>>
>>>>>
>>>>> Cheers,
>>>>> Murat
>>>>>
>>>>>
>>>>>
>>>>>> Thanks, Murat.
>>>>>> It was very useful - I also tried to override IndexWriter and
>>>>>> DocumentsWriter instead, but it didn't work well. DocumentsWriter
>>>>>>
>>>>>>
>>>>> can't
>>>>>
>>>>>
>>>>>> be
>>>>>> overriden.
>>>>>>
>>>>>> So, I didn't find a better way to make the changes.
>>>>>>
>>>>>> My needs are having for every term in different documents different
>>>>>> values.
>>>>>> So, like you set the boost at the document level, I would like to set
>>>>>>
>>>>>>
>>>>> the
>>>>>
>>>>>
>>>>>> boost for different terms within differnt documents.
>>>>>>
>>>>>> For that matter, I made some changes in the code you sent - (I
>>>>>>
>>>>>>
>>>>> coloured
>>>>>
>>>>>
>>>>>> the
>>>>>> changes in red):
>>>>>>
>>>>>> Below you can find an example for the use of it
>>>>>>
>>>>>> **********
>>>>>>  private class PayloadAnalyzer extends Analyzer
>>>>>>  {
>>>>>>  private PayloadTokenStream payToken = null;
>>>>>>  private int score;
>>>>>>  *private Map<String, Integer> scoresMap = new HashMap<String,
>>>>>> Integer>();*
>>>>>>  public synchronized void setScore(int s)
>>>>>>  {
>>>>>>   score = s;
>>>>>>  }
>>>>>> *  public synchronized void setMapScores(Map<String, Integer>
>>>>>>
>>>>>>
>>>>> scoresMap)
>>>>>
>>>>>
>>>>>>  {
>>>>>>   this.scoresMap = scoresMap;
>>>>>>  }*
>>>>>>  public final TokenStream tokenStream(String field, Reader reader)
>>>>>>  {
>>>>>>   payToken = new PayloadTokenStream(new WhitespaceTokenizer(reader));
>>>>>> //new
>>>>>> LowerCaseTokenizer(reader));
>>>>>>   payToken.setScore(score);
>>>>>>   payToken.setMapScores(scoresMap);
>>>>>>   return payToken;
>>>>>>  }
>>>>>>  }
>>>>>>  private class PayloadTokenStream extends TokenStream
>>>>>>  {
>>>>>>  private Tokenizer tok = null;
>>>>>>  private int score;
>>>>>>  *private Map<String, Integer> scoresMap = new HashMap<String,
>>>>>> Integer>();*
>>>>>>  public PayloadTokenStream(Tokenizer tokenizer)
>>>>>>  {
>>>>>>   tok = tokenizer;
>>>>>>  }
>>>>>>  public void setScore(int s)
>>>>>>  {
>>>>>>   score = s;
>>>>>>  }
>>>>>>  * public synchronized void setMapScores(Map<String, Integer>
>>>>>>
>>>>>>
>>>>> scoresMap)
>>>>>
>>>>>
>>>>>>  {
>>>>>>   this.scoresMap = scoresMap;
>>>>>>  }*
>>>>>>  public Token next(Token t) throws IOException
>>>>>>  {
>>>>>>   t = tok.next(t);
>>>>>>   if(t != null)
>>>>>>   {
>>>>>>    //t.setTermBuffer("can change");
>>>>>>    //Do something with the data
>>>>>>    byte[] bytes = ("score:" + score).getBytes();
>>>>>>    //    t.setPayload(new Payload(bytes));
>>>>>> *    String word = String.copyValueOf(t.termBuffer(), 0,
>>>>>>
>>>>>>
>>>>> t.termLength());
>>>>>
>>>>>
>>>>>>    int score = scoresMap.get(word);
>>>>>>    byte payLoad = Byte.parseByte(String.valueOf(score));
>>>>>>    t.setPayload(new Payload(new byte[] { Byte.valueOf(payLoad) }));*
>>>>>>   }
>>>>>>   return t;
>>>>>>  }
>>>>>>  public void reset(Reader input) throws IOException
>>>>>>  {
>>>>>>   tok.reset(input);
>>>>>>  }
>>>>>>  public void close() throws IOException
>>>>>>  {
>>>>>>   tok.close();
>>>>>>  }
>>>>>>  }
>>>>>> **********************************
>>>>>> *Example for the use of payloads:*
>>>>>>
>>>>>>  PayloadAnalyzer panalyzer = new PayloadAnalyzer();
>>>>>>  File index = new File("" + "TestSearchIndex");
>>>>>>  IndexWriter iwriter = new IndexWriter(index, panalyzer);
>>>>>>  Document d = new Document();
>>>>>>  d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
>>>>>> Field.Index.TOKENIZED, Field.TermVector.YES));
>>>>>>  d.add(new Field("id", "1^3", Field.Store.YES,
>>>>>>
>>>>>>
>>>>> Field.Index.UN_TOKENIZED,
>>>>>
>>>>>
>>>>>> Field.TermVector.NO <http://field.termvector.no/> <
>>>>>> http://field.termvector.no/> <
>>>>>>
>>>>>>
>>>>> http://field.termvector.no/>));
>>>
>>>
>>>>   Map<String, Integer> mapScores = new HashMap<String, Integer>();
>>>>>>  mapScores.put("word1", 3);
>>>>>>  mapScores.put("word2", 1);
>>>>>>  mapScores.put("word3", 1);
>>>>>>  panalyzer.setMapScores(mapScores);
>>>>>>  iwriter.addDocument(d, panalyzer);
>>>>>>  d = new Document();
>>>>>>  d.add(new Field("text", "word1 word2 word3", Field.Store.YES,
>>>>>> Field.Index.TOKENIZED, Field.TermVector.YES));
>>>>>>  d.add(new Field("id", "2^3", Field.Store.YES,
>>>>>>
>>>>>>
>>>>> Field.Index.UN_TOKENIZED,
>>>>>
>>>>>
>>>>>> Field.TermVector.NO <http://field.termvector.no/> <
>>>>>> http://field.termvector.no/> <
>>>>>>
>>>>>>
>>>>> http://field.termvector.no/>));
>>>  >> >   //We set the score for the term of the document that will be
>>>
>>>
>>>>  analyzed.
>>>>>>  /*I was worried about this part - document dependent score
>>>>>>  which may be utilized*/
>>>>>>  mapScores = new HashMap<String, Integer>();
>>>>>>  mapScores.put("word1", 1);
>>>>>>  mapScores.put("word2", 3);
>>>>>>  mapScores.put("word3", 1);
>>>>>>  panalyzer.setMapScores(mapScores);
>>>>>>  iwriter.addDocument(d, panalyzer);
>>>>>>  /*-----------------*/
>>>>>>  //  iwriter.commit();
>>>>>>  iwriter.optimize();
>>>>>>  iwriter.close();
>>>>>>  BooleanQuery bq = new BooleanQuery();
>>>>>>  BoostingTermQuery tq = new BoostingTermQuery(new Term("text",
>>>>>>
>>>>>>
>>>>> "word1"));
>>>>>
>>>>>
>>>>>>  tq.setBoost((float) 1.0);
>>>>>>  bq.add(tq, BooleanClause.Occur.MUST);
>>>>>>  tq = new BoostingTermQuery(new Term("text", "word2"));
>>>>>>  tq.setBoost((float) 3);
>>>>>>  bq.add(tq, BooleanClause.Occur.SHOULD);
>>>>>>  tq = new BoostingTermQuery(new Term("text", "word3"));
>>>>>>  tq.setBoost((float) 1);
>>>>>>  bq.add(tq, BooleanClause.Occur.SHOULD);
>>>>>>  IndexSearcher searcher1 = new IndexSearcher("TestSearchIndex");
>>>>>>  searcher1.setSimilarity(new WordsSimilarity());
>>>>>>  TopDocs topDocs = searcher1.search(bq, null, 3);
>>>>>>  Hits hits1 = searcher1.search(bq);
>>>>>>  for(int j = 0; j < hits1.length(); j++)
>>>>>>  {
>>>>>>   Explanation explanation = searcher1.explain(bq, j);
>>>>>>   System.out.println("**** " + hits1.score(j) + " " +
>>>>>> hits1.doc(j).getField("id").stringValue() + " *****");
>>>>>>   System.out.println(explanation.toString());
>>>>>>   explanation.getValue();
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>  System.out.println("********************************************************");
>>>
>>>
>>>>    System.out.println("Score " + topDocs.scoreDocs[j].score + " doc "
>>>>>>
>>>>>>
>>>>> +
>>>>>
>>>>>
>>>>>> searcher1.doc(topDocs.scoreDocs[j].doc).getField("id").stringValue());
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>  System.out.println("********************************************************");
>>>
>>>
>>>>   }
>>>>>>
>>>>>> If you try the same query with differnt boosting, you will get a
>>>>>>
>>>>>>
>>>>> different
>>>>>
>>>>>
>>>>>> order for the documents.
>>>>>>
>>>>>> Does it look ok?
>>>>>>
>>>>>> Thanks again!
>>>>>> Liat
>>>>>> 2009/4/25 Murat Yakici <Murat.Yakici@cis.strath.ac.uk>
>>>>>>
>>>>>>
>>>>>>
>>>>>>> Here is what I am doing, not so magical... There are two classes, an
>>>>>>> analyzer and an a TokenStream in which I can inject my document
>>>>>>> dependent
>>>>>>> data to be stored as payload.
>>>>>>>
>>>>>>>
>>>>>>> private PayloadAnalyzer panalyzer = new PayloadAnalyzer();
>>>>>>>
>>>>>>>   private class PayloadAnalyzer extends Analyzer {
>>>>>>>
>>>>>>>       private PayloadTokenStream payToken = null;
>>>>>>>       private int score;
>>>>>>>
>>>>>>>       public synchronized void setScore(int s) {
>>>>>>>           score=s;
>>>>>>>       }
>>>>>>>
>>>>>>>     public final TokenStream tokenStream(String field, Reader
>>>>>>>
>>>>>>>
>>>>>> reader) {
>>>>>
>>>>>
>>>>>>        payToken = new PayloadTokenStream(new
>>>>>>> LowerCaseTokenizer(reader));
>>>>>>>        payToken.setScore(score);
>>>>>>>        return payToken;
>>>>>>>       }
>>>>>>>   }
>>>>>>>
>>>>>>>   private class PayloadTokenStream extends TokenStream {
>>>>>>>
>>>>>>>       private Tokenizer tok = null;
>>>>>>>       private int score;
>>>>>>>
>>>>>>>       public PayloadTokenStream(Tokenizer tokenizer) {
>>>>>>>           tok = tokenizer;
>>>>>>>       }
>>>>>>>
>>>>>>>       public void setScore(int s) {
>>>>>>>           score = s;
>>>>>>>       }
>>>>>>>
>>>>>>>       public Token next(Token t) throws IOException {
>>>>>>>           t = tok.next(t);
>>>>>>>           if (t != null) {
>>>>>>>               //t.setTermBuffer("can change");
>>>>>>>               //Do something with the data
>>>>>>>               byte[] bytes = ("score:"+ score).getBytes();
>>>>>>>               t.setPayload(new Payload(bytes));
>>>>>>>           }
>>>>>>>           return t;
>>>>>>>       }
>>>>>>>
>>>>>>>       public void reset(Reader input) throws IOException {
>>>>>>>           tok.reset(input);
>>>>>>>       }
>>>>>>>
>>>>>>>       public void close() throws IOException {
>>>>>>>           tok.close();
>>>>>>>       }
>>>>>>>   }
>>>>>>>
>>>>>>>
>>>>>>>   public void doIndex() {
>>>>>>>       try {
>>>>>>>           File index = new File("./TestPayloadIndex");
>>>>>>>           IndexWriter iwriter = new IndexWriter(index,
>>>>>>>                    panalyzer,
>>>>>>>                    IndexWriter.MaxFieldLength.UNLIMITED);
>>>>>>>
>>>>>>>           Document d = new Document();
>>>>>>>           d.add(new Field("content",
>>>>>>>              "Everyone, someone, myTerm, yourTerm", Field.Store.YES,
>>>>>>>               Field.Index.ANALYZED, Field.TermVector.YES));
>>>>>>>           //We set the score for the term of the document that will
>>>>>>>
>>>>>>>
>>>>>> be
>>>>>
>>>>>
>>>>>> analyzed.
>>>>>>>           /*I was worried about this part - document dependent score
>>>>>>> which may be utilized*/
>>>>>>>           panalyzer.setScore(5);
>>>>>>>           iwriter.addDocument(d, panalyzer);
>>>>>>>           /*-----------------*/
>>>>>>>           ...
>>>>>>>           iwriter.commit();
>>>>>>>           iwriter.optimize();
>>>>>>>           iwriter.close();
>>>>>>>
>>>>>>>           //Now read the index
>>>>>>>           IndexReader ireader = IndexReader.open(index);
>>>>>>>           TermPositions tpos = ireader.termPositions(
>>>>>>>                                 new Term("content","myterm"));//Note
>>>>>>> LowercaseTokenizer
>>>>>>>           while (tpos.next()) {
>>>>>>>               int pos;
>>>>>>>               for(int i=0;i<tpos.freq();i++){
>>>>>>>                   pos=tpos.nextPosition();
>>>>>>>                   if (tpos.isPayloadAvailable()) {
>>>>>>>                       byte[] data = new
>>>>>>>
>>>>>>>
>>>>>> byte[tpos.getPayloadLength()];
>>>>>
>>>>>
>>>>>>                       tpos.getPayload(data, 0);
>>>>>>>                      //Utilise payloads;
>>>>>>>                   }
>>>>>>>               }
>>>>>>>           }
>>>>>>>
>>>>>>>           tpos.close();
>>>>>>>       } catch (CorruptIndexException ex) {
>>>>>>>          //
>>>>>>>       } catch (LockObtainFailedException ex) {
>>>>>>>           //
>>>>>>>       } catch (IOException ex) {
>>>>>>>           //
>>>>>>>       }
>>>>>>>   }
>>>>>>>
>>>>>>> I wish it was designed better... Please let me know if you guys have
>>>>>>>
>>>>>>>
>>>>>> a
>>>>>
>>>>>
>>>>>> better idea.
>>>>>>>
>>>>>>> Cheers,
>>>>>>> Murat
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>> Dear Murat,
>>>>>>>>
>>>>>>>> I saw your question and wondered how did you implement these
>>>>>>>>
>>>>>>>>
>>>>>>> changes?
>>>>>
>>>>>
>>>>>>  The requirement below are the same ones as I am trying to code now.
>>>>>>>> Did you modify the source code itself or only used Lucene's jar and
>>>>>>>>
>>>>>>>>
>>>>>>> just
>>>>>>>
>>>>>>>
>>>>>>>> override code?
>>>>>>>>
>>>>>>>> I would very much apprecicate if you could give me a short
>>>>>>>>
>>>>>>>>
>>>>>>> explanation
>>>>>
>>>>>
>>>>>> on
>>>>>>>
>>>>>>>
>>>>>>>> how was it done.
>>>>>>>>
>>>>>>>> Thanks a lot,
>>>>>>>> Liat
>>>>>>>>
>>>>>>>> 2009/4/21 Murat Yakici <murat.yakici@cis.strath.ac.uk>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>> Hi,
>>>>>>>>> I started playing with the experimental payload functionality. I
>>>>>>>>>
>>>>>>>>>
>>>>>>>> have
>>>>>
>>>>>
>>>>>>  written an analyzer which adds a payload (some sort of a
>>>>>>>>>
>>>>>>>>>
>>>>>>>> score/boost)
>>>>>
>>>>>
>>>>>>  for
>>>>>>>>> each term occurance. The payload/score for each term is dependent
>>>>>>>>>
>>>>>>>>>
>>>>>>>> on
>>>>>
>>>>>
>>>>>> the
>>>>>>>
>>>>>>>
>>>>>>>> document that the term comes from (I guess this is the typoical
>>>>>>>>>
>>>>>>>>>
>>>>>>>> use
>>>>>
>>>>>
>>>>>>  case).
>>>>>>>>> So say term t1 may have a payload of 5 in doc1 and 34 in doc5. The
>>>>>>>>> parameter
>>>>>>>>> for calculating the payload changes after each
>>>>>>>>> indexWriter.addDocument(..)
>>>>>>>>> method call in a while loop. I am assuming that the
>>>>>>>>> indexWriter.addDocument(..) methods are thread safe. Can I confirm
>>>>>>>>>
>>>>>>>>>
>>>>>>>> this?
>>>>>>>
>>>>>>>
>>>>>>>> Cheers,
>>>>>>>>>
>>>>>>>>> --
>>>>>>>>> Murat Yakici
>>>>>>>>> Department of Computer & Information Sciences
>>>>>>>>> University of Strathclyde
>>>>>>>>> Glasgow, UK
>>>>>>>>> -------------------------------------------
>>>>>>>>> The University of Strathclyde is a charitable body, registered in
>>>>>>>>> Scotland,
>>>>>>>>> with registration number SC015263.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>> ---------------------------------------------------------------------
>>>
>>>
>>>>   To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>> Murat Yakici
>>>>>>> Department of Computer & Information Sciences
>>>>>>> University of Strathclyde
>>>>>>> Glasgow, UK
>>>>>>> -------------------------------------------
>>>>>>> The University of Strathclyde is a charitable body, registered in
>>>>>>> Scotland,
>>>>>>> with registration number SC015263.
>>>>>>>
>>>>>>>
>>>>>>> ---------------------------------------------------------------------
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>> Murat Yakici
>>>>> Department of Computer & Information Sciences
>>>>> University of Strathclyde
>>>>> Glasgow, UK
>>>>> -------------------------------------------
>>>>> The University of Strathclyde is a charitable body, registered in
>>>>> Scotland,
>>>>> with registration number SC015263.
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>>
>>>>>
>>>> Murat Yakici
>>> Department of Computer & Information Sciences
>>> University of Strathclyde
>>> Glasgow, UK
>>> -------------------------------------------
>>> The University of Strathclyde is a charitable body, registered in
>>> Scotland,
>>> with registration number SC015263.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>>
>>
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174beee4b93d5f0468869572--

From java-user-return-39962-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 10:32:10 2009
Return-Path: <java-user-return-39962-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47151 invoked from network); 27 Apr 2009 10:32:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 10:32:10 -0000
Received: (qmail 37923 invoked by uid 500); 27 Apr 2009 10:32:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37871 invoked by uid 500); 27 Apr 2009 10:32:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37861 invoked by uid 99); 27 Apr 2009 10:32:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 10:32:07 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 10:31:58 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LyO7d-0008Io-LU
	for java-user@lucene.apache.org; Mon, 27 Apr 2009 03:31:37 -0700
Message-ID: <23253549.post@talk.nabble.com>
Date: Mon, 27 Apr 2009 03:31:37 -0700 (PDT)
From: blazingwolf7 <blazingwolf7@gmail.com>
To: java-user@lucene.apache.org
Subject: Why Lucene phrase searching fail?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: blazingwolf7@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


hi,

I am trying to perform a search using Lucene. The keyword : "national india"
This phrase exists inside the content. I try searching it using Lucene and
it fail to return any results. Then I try to search it using Luke, with the
quotes and it also fail to return results.

Why is that happening? Can anyone advise me on this?
-- 
View this message in context: http://www.nabble.com/Why-Lucene-phrase-searching-fail--tp23253549p23253549.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39963-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 10:42:47 2009
Return-Path: <java-user-return-39963-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48842 invoked from network); 27 Apr 2009 10:42:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 10:42:47 -0000
Received: (qmail 44795 invoked by uid 500); 27 Apr 2009 10:42:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44693 invoked by uid 500); 27 Apr 2009 10:42:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44675 invoked by uid 99); 27 Apr 2009 10:42:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 10:42:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.218.227 as permitted sender)
Received: from [209.85.218.227] (HELO mail-bw0-f227.google.com) (209.85.218.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 10:42:35 +0000
Received: by bwz27 with SMTP id 27so2469285bwz.5
        for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 03:42:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=W9jPW77NvyyftMPkeF2BWcSBEtLDbEjJAXHrYmyTC+g=;
        b=Q8dc6TSmZzq1uZN5llA4jTBzKXMzy+SUJxMt35ScfeZHkS575B6YA8EpJRFIVTM+OF
         gEevCIwB/QTh7H/c0fFGxV/gP8zB5GK3qemLfsoKOVE0/95OG/1K0stKov5Zb1U6gqQ3
         SUCfc1oMbiQfYVIF/xNH82V3KnsKbq/lKjxbs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=sKV4BMtgAKldnD/O516PVL1Y0sVEVw4U4ShqsB96MAvoWokuj6nsx1J/h3e98MPtrH
         TVlaoK5TIJ7N130r0j0Vlc+GiIr2egd39DurIvmFWwa+8bbHCF+SzGDiNhYbAWDdZZg2
         172v85OmLv6JefY2zfIQPCZV5D4bjwtSkZmnk=
MIME-Version: 1.0
Received: by 10.204.97.204 with SMTP id m12mr5214866bkn.22.1240828933115; Mon, 
	27 Apr 2009 03:42:13 -0700 (PDT)
In-Reply-To: <23253549.post@talk.nabble.com>
References: <23253549.post@talk.nabble.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Mon, 27 Apr 2009 11:41:58 +0100
Message-ID: <8c4e68610904270341y8d1ded6q98e0bec392beb3aa@mail.gmail.com>
Subject: Re: Why Lucene phrase searching fail?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

What does query.toString() say?  Are you using standard analyzers with
standard lowercasing, stop words etc?

Knocking up a very simple program/index that demonstrates the problem
usually helps: either it will work and help you spot the problem with
your existing code, or if you post it here someone will spot the
problem.


--
Ian.


On Mon, Apr 27, 2009 at 11:31 AM, blazingwolf7 <blazingwolf7@gmail.com> wrote:
>
> hi,
>
> I am trying to perform a search using Lucene. The keyword : "national india"
> This phrase exists inside the content. I try searching it using Lucene and
> it fail to return any results. Then I try to search it using Luke, with the
> quotes and it also fail to return results.
>
> Why is that happening? Can anyone advise me on this?
> --
> View this message in context: http://www.nabble.com/Why-Lucene-phrase-searching-fail--tp23253549p23253549.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39964-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 11:08:28 2009
Return-Path: <java-user-return-39964-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56898 invoked from network); 27 Apr 2009 11:08:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 11:08:27 -0000
Received: (qmail 75304 invoked by uid 500); 27 Apr 2009 11:08:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75224 invoked by uid 500); 27 Apr 2009 11:08:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75214 invoked by uid 99); 27 Apr 2009 11:08:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 11:08:25 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [74.125.44.30] (HELO yx-out-2324.google.com) (74.125.44.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 11:08:17 +0000
Received: by yx-out-2324.google.com with SMTP id 8so1205927yxm.5
        for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 04:07:55 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.134.8 with SMTP id l8mr8704841ybn.163.1240830475838; Mon, 
	27 Apr 2009 04:07:55 -0700 (PDT)
In-Reply-To: <49F58284.3030606@fastmail.fm>
References: <49F1E14C.7080308@fastmail.fm> <49F58284.3030606@fastmail.fm>
Date: Mon, 27 Apr 2009 07:07:55 -0400
Message-ID: <9ac0c6aa0904270407j5f4850b3m303423995a8da58c@mail.gmail.com>
Subject: Re: no segments* file found: files: Error on opening index
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

It's fine if one thread is changing the index (w/ IndexWriter) while
other threads are opening IndexReaders.

Though, if you have IndexWriter opening with "create=3Dtrue" at the same
time that an IndexReader is attempting to open the index, that would
explain this.  Is it possible that's happening?

The fact that you see no files listed in the exception's message means
the directory was empty at the time IndexReader was being openened.

Mike

On Mon, Apr 27, 2009 at 6:01 AM, Paul Taylor <paul_t100@fastmail.fm> wrote:
> Paul Taylor wrote:
>>
>> Hi I was using a RAMDirectory and this was working fine but have now mov=
ed
>> over to a =A0filesystem directory to preserve space, the directory is ju=
st
>> initialized once
>> =A0 directory =3D new RAMDirectory();
>> =A0 directory =3D
>> FSDirectory.getDirectory(Platform.getPlatformLicenseFolder()+ "/" +
>> TAG_BROWSER_INDEX);
>>
>> but I create an IndexReader as required
>> =A0 =A0IndexReader ir =3D IndexReader.open(directory);
>> and then close it when Ive finished with it.
>>
>> but sometimes it is failing with
>> =A0 no segments* file found: files:
>> interestingly no file is specified in the error message whereas other
>> reporters of this message show a reference to an actual file in the mess=
age.
>>
>> My code is multithreaded so I'm wondering if the problem is that two
>> thread have both opened an IndexReader, or one thread is using an
>> IndexWriter to add a document, whilst another is trying to read. But I w=
asnt
>> aware either of these cases was not allowed, any ideas ?
>>
>> thanks Paul
>>
> Hi, anybody have an idea about this, Im sure Im not the only one to
> encounter this.
>
> Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39965-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 11:20:20 2009
Return-Path: <java-user-return-39965-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60420 invoked from network); 27 Apr 2009 11:20:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 11:20:20 -0000
Received: (qmail 91461 invoked by uid 500); 27 Apr 2009 11:20:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91403 invoked by uid 500); 27 Apr 2009 11:20:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91393 invoked by uid 99); 27 Apr 2009 11:20:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 11:20:17 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.27 as permitted sender)
Received: from [66.111.4.27] (HELO out3.smtp.messagingengine.com) (66.111.4.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 11:20:09 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 3B7DE323DA8;
	Mon, 27 Apr 2009 07:19:49 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute1.internal (MEProxy); Mon, 27 Apr 2009 07:19:49 -0400
X-Sasl-enc: 6HUHt57CWSwKX3Ki3/brjnlvzCq18BTJmyai37hBnAUs 1240831188
Received: from [192.168.2.50] (cpc2-leed4-0-0-cust912.leed.cable.ntl.com [81.105.111.145])
	by mail.messagingengine.com (Postfix) with ESMTPA id B915B380F8;
	Mon, 27 Apr 2009 07:19:48 -0400 (EDT)
Message-ID: <49F594DA.1050100@fastmail.fm>
Date: Mon, 27 Apr 2009 12:19:54 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: Michael McCandless <lucene@mikemccandless.com>
CC: java-user@lucene.apache.org
Subject: Re: no segments* file found: files: Error on opening index
References: <49F1E14C.7080308@fastmail.fm> <49F58284.3030606@fastmail.fm> <9ac0c6aa0904270407j5f4850b3m303423995a8da58c@mail.gmail.com>
In-Reply-To: <9ac0c6aa0904270407j5f4850b3m303423995a8da58c@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Michael McCandless wrote:
> It's fine if one thread is changing the index (w/ IndexWriter) while
> other threads are opening IndexReaders.
>
> Though, if you have IndexWriter opening with "create=true" at the same
> time that an IndexReader is attempting to open the index, that would
> explain this.  Is it possible that's happening?
>
> The fact that you see no files listed in the exception's message means
> the directory was empty at the time IndexReader was being openened.
>
> Mike
>   
Hi Mike,

Its now occurred to me that the IndexWriter code might have decided that 
so many records needed modifying that it would be better to recreate the 
index from scratch  rather than modify it, so if an Indexreader accessed 
it at the time it would be empty. is there a way I can get the 
IndexReader to wait for the IndexWriter to complete.

Paul


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39966-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 11:25:20 2009
Return-Path: <java-user-return-39966-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62234 invoked from network); 27 Apr 2009 11:25:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 11:25:19 -0000
Received: (qmail 5168 invoked by uid 500); 27 Apr 2009 11:25:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5129 invoked by uid 500); 27 Apr 2009 11:25:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5119 invoked by uid 99); 27 Apr 2009 11:25:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 11:25:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of koji@r.email.ne.jp designates 202.224.39.198 as permitted sender)
Received: from [202.224.39.198] (HELO mail2.asahi-net.or.jp) (202.224.39.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 11:25:08 +0000
Received: from koji-sekiguchi-no-macbook.local (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	by mail2.asahi-net.or.jp (Postfix) with ESMTP id A3B477604B
	for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 20:24:44 +0900 (JST)
Message-ID: <49F595FC.2060902@r.email.ne.jp>
Date: Mon, 27 Apr 2009 20:24:44 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.21 (Macintosh/20090302)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Why Lucene phrase searching fail?
References: <23253549.post@talk.nabble.com> <8c4e68610904270341y8d1ded6q98e0bec392beb3aa@mail.gmail.com>
In-Reply-To: <8c4e68610904270341y8d1ded6q98e0bec392beb3aa@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Another possible factor, if you are using omitTf feature, it causes 
phrase query doesn't work.

Koji

Ian Lea wrote:
> What does query.toString() say?  Are you using standard analyzers with
> standard lowercasing, stop words etc?
>
> Knocking up a very simple program/index that demonstrates the problem
> usually helps: either it will work and help you spot the problem with
> your existing code, or if you post it here someone will spot the
> problem.
>
>
> --
> Ian.
>
>
> On Mon, Apr 27, 2009 at 11:31 AM, blazingwolf7 <blazingwolf7@gmail.com> wrote:
>   
>> hi,
>>
>> I am trying to perform a search using Lucene. The keyword : "national india"
>> This phrase exists inside the content. I try searching it using Lucene and
>> it fail to return any results. Then I try to search it using Luke, with the
>> quotes and it also fail to return results.
>>
>> Why is that happening? Can anyone advise me on this?
>> --
>> View this message in context: http://www.nabble.com/Why-Lucene-phrase-searching-fail--tp23253549p23253549.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39967-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 11:26:16 2009
Return-Path: <java-user-return-39967-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62885 invoked from network); 27 Apr 2009 11:26:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 11:26:16 -0000
Received: (qmail 9911 invoked by uid 500); 27 Apr 2009 11:26:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9858 invoked by uid 500); 27 Apr 2009 11:26:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9848 invoked by uid 99); 27 Apr 2009 11:26:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 11:26:13 +0000
X-ASF-Spam-Status: No, hits=0.5 required=10.0
	tests=FUZZY_CREDIT,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 11:26:03 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LyOxy-00023S-Go
	for java-user@lucene.apache.org; Mon, 27 Apr 2009 04:25:42 -0700
Message-ID: <23254287.post@talk.nabble.com>
Date: Mon, 27 Apr 2009 04:25:42 -0700 (PDT)
From: uday kumar maddigatla <ukma@mach.com>
To: java-user@lucene.apache.org
Subject: Re: How to search special characters in LUcene
In-Reply-To: <359a92830904240647r3d73ebb3x6ae84bb209dbc462@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: ukma@mach.com
References: <D262A1FB331DC344AA0B896F390D5569016E3E8C@exchhyd.machcorp.lan> <359a92830904210735g24df775cx4bfa11774ac6161c@mail.gmail.com> <23170710.post@talk.nabble.com> <359a92830904220551x23da922ftdbae71d18210538@mail.gmail.com> <23190583.post@talk.nabble.com> <359a92830904230634x2f13ef20r1b0e1599531f8dd9@mail.gmail.com> <23211629.post@talk.nabble.com> <359a92830904240647r3d73ebb3x6ae84bb209dbc462@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


hi
thanks for your reply. Please suggest me what to do now.

i want to index the document which contains multiple languages.


I really waiting for this to complete with your help.

Please,please help me

Erick Erickson wrote:
>=20
> I'm puzzled why you say
>=20
> "By the above out put we can say that StandardAnalyzer is
> enough to get rid  of danish elements."
>=20
> It does NOT get rid of the accents, according to your own output.
> If your goal is to go ahead and index multiple language documents
> in a single index then search it, I'd recommend using the
> ISOLatin1AccentFilter. Compare the output of an analyzer like:
>=20
> public class MyAnalyzer extends StandardAnalyzer {
>     public TokenStream tokenStream(String s, Reader reader) {
>         return new ISOLatin1AccentFilter(super.tokenStream(s, reader));
>     }
> }
>  and you'll see that all the accents disappear, which will play much
> more nicely with queries that don't have accents.
>=20
> Best
> Erick
>=20
> On Fri, Apr 24, 2009 at 3:53 AM, uday kumar maddigatla
> <ukma@mach.com>wrote:
>=20
>>
>> Hi Thanks for your reply.
>>
>> After gone threw with the site which you given... i understood that
>> StandardAnalyzer is enough to handle these special characters.
>>
>> i'm attaching one class called AnalysisDemo.java. By executing that clas=
s
>> i'm able to say the above sentance(i.e StandardAnalyzer is enough).
>>
>> Here is the out put when i ran the above java file.
>> Analzying "Vedr.           :   Amtsg=C3=A5rden =C3=85rhus, Lyseng All=C3=
=A9 1, 8270
>> H=C3=B8jbjerg"
>>        org.apache.lucene.analysis.WhitespaceAnalyzer:
>>                [Vedr.] [:] [Amtsg=C3=A5rden] [=C3=85rhus,] [Lyseng] [All=
=C3=A9] [1,]
>> [8270] [H=C3=B8jbjerg]
>>
>>        org.apache.lucene.analysis.SimpleAnalyzer:
>>                [vedr] [amtsg=C3=A5rden] [=C3=A5rhus] [lyseng] [all=C3=A9=
] [h=C3=B8jbjerg]
>>
>>        org.apache.lucene.analysis.StopAnalyzer:
>>                [vedr] [amtsg=C3=A5rden] [=C3=A5rhus] [lyseng] [all=C3=A9=
] [h=C3=B8jbjerg]
>>
>>        org.apache.lucene.analysis.standard.StandardAnalyzer:
>>                [vedr] [amtsg=C3=A5rden] [=C3=A5rhus] [lyseng] [all=C3=A9=
] [1] [8270]
>> [h=C3=B8jbjerg]
>>
>>        org.apache.lucene.analysis.snowball.SnowballAnalyzer:
>>                [vedr] [amtsg=C3=A5rden] [=C3=A5rhus] [lyseng] [all=C3=A9=
] [1] [8270]
>> [h=C3=B8jbjerg]
>>
>> By the above out put we can say that StandardAnalyzer is enough to get
>> rid
>> of danish elements.
>>
>> But only problem is when i'm searching the any term which includes the
>> danish elements(like h=C3=B8jbjerg...)
>>
>> it is unable to find out.
>>
>> Even i checked with LUKE. In that  i given my sample text which contains
>> the
>> danish elements and selected the StandardAnalyzer as analyser. when i
>> click
>> analyze in that it cleary making index of danish words.
>>
>> and also i givne one try on luke by loading my index directory in to
>> luke.
>> after loading my index i searched for a word which contains the danish
>> element, But this time it was failed. It was shown nothing(i.e o
>> resluts).
>>
>> As in my sense the problem might be making the indexes or in searching
>> the
>> item.
>>
>>
>> I gone threw the site which you given. From that i'm able to do this kin=
d
>> of
>> reaserch work.
>>
>> Please help me in this.
>>
>>
>> Erick Erickson wrote:
>> >
>> > OK, this is a much different problem than you were originally
>> > asking about, effectively "how to index/search mixed language
>> > documents".
>> >
>> > This topic has been discussed multiple times on the user list, I
>> > think your first step should be to search the archive. I *was*
>> > going to find the old searchable mail archive, but those clever folks
>> > at Lucid Imagination have something new, see:
>> >
>> > http://www.lucidimagination.com/search/p:lucene?q=3Dmultiple+languages
>> >
>> > Once you've had a chance to look that over I think you'll be off and
>> > running.
>> >
>> > Best
>> > Erick
>> >
>> > On Thu, Apr 23, 2009 at 1:43 AM, uday kumar maddigatla
>> > <ukma@mach.com>wrote:
>> >
>> >>
>> >> HI
>> >>
>> >> Here are the details about my goals.
>> >> 1. I want to use this lucene for mixed languages.
>> >> 2. I want to make indexes of the documents which are either english o=
r
>> >> danish etc.
>> >> I'm attaching my IndexFiles.java file.
>> >>
>> >> When i'm searching i'm giving the index path location  as well as
>> >> doucmets
>> >> folder.
>> >>
>> >> If i use StandardAnalyzer as an argument to IndexWriter's method it i=
s
>> >> able
>> >> to search the english characters.
>> >>
>> >> How can i use DutchAnalyzer in order to make this IndexFiles.java to
>> >> index
>> >> the danish elements.
>> >>
>> >> In my Code which i attached, you can see 'C:\test3'. This is my
>> location
>> >> where i want to store my indexes.
>> >>
>> >> I'm giving documents folder location as comand line argument.
>> >>
>> >> In my document the content will be like this
>> >>
>> >> <com:Note><![CDATA[Kreditnota til udligning af faktura nr. 13927 pga
>> skal
>> >> opsplittes
>> >> hhv. byggeplads og skat
>> >> Vedr.           :   Amtsg=C3=A5rden =C3=85rhus, Lyseng All=C3=A9 1, 8=
270 H=C3=B8jbjerg
>> >> Bygning B
>> >> SES Journal nr. :   42895-0001
>> >> SES Navision nr.:   Navision 9800124
>> >> SES Ansvarlig   :   Martin Kr=C3=B8ldrup Nielsen
>> >> SES r=C3=A5dgiver    :   Friis & Moltke A/S
>> >> Hermed fremsendes faktura p=C3=A5 ekstra t=C3=B8mrerarbejde.
>> >> Byggeplads Amtsg=C3=A5rden B-4
>> >> jvf. vedlagte specifikation - aftaleseddel nr. 12.]]></com:Note>
>> >>
>> >> i"m searching the word like r=C3=A5dgiver . When i see the result it =
is
>> >> clearly
>> >> searching for r dgiver. It is omitting the danish element.
>> >>
>> >> Please help me in this.
>> >>
>> >>
>> >>
>> >> Erick Erickson wrote:
>> >> >
>> >> > Are you *also* using the DutchAnalyzer for your *query*?
>> >> >
>> >> > Please show us the index and search code (simplified as much
>> >> > as possible), then we'll be able to provide better suggestions.
>> >> >
>> >> > Also, tell us a bit more about your goals here. Is this an
>> >> > index entirely of Dutch documents? Or is it a mixed-language
>> >> > index?
>> >> >
>> >> > Think about getting a copy of Luke and
>> >> > 1> examining your index to see what's *really* there
>> >> > 2> examining the effects of using different parsers on
>> >> >      your *query*.
>> >> >
>> >> > Best
>> >> > Erick
>> >> >
>> >> > On Wed, Apr 22, 2009 at 2:57 AM, uday kumar maddigatla
>> >> > <ukma@mach.com>wrote:
>> >> >
>> >> >>
>> >> >> Hi
>> >> >>
>> >> >> Thanks for your reply.
>> >> >>
>> >> >> I'm able to see the DutchAnalyzer.
>> >> >>
>> >> >> When i'm indexing my documents i given instace of DutchAnalyzer as
>> an
>> >> >> argument to IndexWriter Class.
>> >> >>
>> >> >> After this when i search for the
>> >> >> http://www.nabble.com/file/p23170710/IndexFiles.java
>> IndexFiles.java
>> >> >> contains the danish elements .. Still it is not able to identify.
>> >> >>
>> >> >> Please tell me how to use DutchAnalzer in my application. Sample
>> >> example
>> >> >> or
>> >> >> series of steps helps me.
>> >> >>
>> >> >> I also attached my index file(.java file).
>> >> >>
>> >> >> Please help me in this. please..
>> >> >>
>> >> >> Erick Erickson wrote:
>> >> >> >
>> >> >> > Take a look at DutchAnalyzer. The problem you'll have is if
>> you're
>> >> >> > indexing
>> >> >> > this document along with a bunch of documents from other
>> languages.
>> >> >> > You could search the mail archive for extensive discussions of
>> >> >> indexing/
>> >> >> > searching documents from several languages.
>> >> >> >
>> >> >> > Best
>> >> >> > Erick
>> >> >> >
>> >> >> > On Tue, Apr 21, 2009 at 2:40 AM, Uday Kumar Maddigatla
>> >> >> > <ukma@mach.com>wrote:
>> >> >> >
>> >> >> >> HI,
>> >> >> >>
>> >> >> >>
>> >> >> >>
>> >> >> >> I'm new to the lucene. I downloaded lucene 2.4.1.
>> >> >> >>
>> >> >> >>
>> >> >> >>
>> >> >> >> I have one xml file which contains few special characters like
>> '=C3=A5',
>> >> >> '=C3=B8,'
>> >> >> >> =C2=B0'
>> >> >> >> etc.(these are Danish language elements).
>> >> >> >>
>> >> >> >>
>> >> >> >>
>> >> >> >> How can I search these things.
>> >> >> >>
>> >> >> >>
>> >> >> >>
>> >> >> >>
>> >> >> >>
>> >> >> >> Uday Kumar  Reddy Maddigatla
>> >> >> >>
>> >> >> >> Software Engineer(Progrator|gatetrade)
>> >> >> >>
>> >> >> >> MACH India(Operations)
>> >> >> >>
>> >> >> >> Mobile: + 91-9963000377
>> >> >> >>
>> >> >> >> Uday.Maddigatla@ness.com <mailto:Uday.Maddigatla@ness.com>
>> >> >> >>
>> >> >> >> ukma@mach.com <mailto:ukma@mach.com>
>> >> >> >>
>> >> >> >> www.ness.com
>> >> >> >>
>> >> >> >>
>> >> >> >>
>> >> >> >>
>> >> >> >>
>> >> >> >>
>> >> >> >
>> >> >> >
>> >> >>
>> >> >> --
>> >> >> View this message in context:
>> >> >>
>> >>
>> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp23150=
039p23170710.html
>> >> >> Sent from the Lucene - Java Users mailing list archive at
>> Nabble.com.
>> >> >>
>> >> >>
>> >> >>
>> ---------------------------------------------------------------------
>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >> >>
>> >> >>
>> >> >
>> >> >
>> >> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
>> >> http://www.nabble.com/file/p23190583/SearchFiles.java SearchFiles.jav=
a
>> >> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
>> >> http://www.nabble.com/file/p23190583/IndexFiles.java IndexFiles.java
>> >> --
>> >> View this message in context:
>> >>
>> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp23150=
039p23190583.html
>> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>> >
>> http://www.nabble.com/file/p23211629/AnalysisDemo.java AnalysisDemo.java
>> --
>> View this message in context:
>> http://www.nabble.com/How-to-search-special-characters-in-LUcene-tp23150=
039p23211629.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
>=20

--=20
View this message in context: http://www.nabble.com/How-to-search-special-c=
haracters-in-LUcene-tp23150039p23254287.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39968-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 11:33:44 2009
Return-Path: <java-user-return-39968-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65167 invoked from network); 27 Apr 2009 11:33:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 11:33:43 -0000
Received: (qmail 20336 invoked by uid 500); 27 Apr 2009 11:33:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20270 invoked by uid 500); 27 Apr 2009 11:33:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20260 invoked by uid 99); 27 Apr 2009 11:33:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 11:33:41 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of adam.saltiel@gmail.com designates 209.85.218.227 as permitted sender)
Received: from [209.85.218.227] (HELO mail-bw0-f227.google.com) (209.85.218.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 11:33:32 +0000
Received: by bwz27 with SMTP id 27so2499679bwz.5
        for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 04:33:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=2w917VpLekRQbLsqsgJvyKIKO120TTSM67ZVtGNfO4c=;
        b=D78gkH0BYywG+PpOn4yJqcWfcyJKNeXouWSnk+1QIx8+G1UVgoS7O4i1SrPtMQiZEu
         0s34TYq6I2l1XF9/OyI74096dv57EyyDQgGbHjfnwuDZ15VRQJPybCK9T8PHVydF+12B
         pdtAYe9P+2Z8FbTUw2TVBoVTnufi2A69quP3M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=iUx3bePyegs7iGHl5YuOmDsVMhdYznRS56vHIeRwR4gFfF7NWpysgx02Vpw5RGuRwh
         sDqHdy6UWSNMp5s9ULFt1eDAG2eikiQRxMlpj4nGUEoSpgHNpKSgZ1vxhlrC3xJH//vs
         3mNZaIH891Uj3/kKroejRwaL0BFA/mCME08G8=
MIME-Version: 1.0
Received: by 10.239.179.19 with SMTP id b19mr256880hbg.2.1240831988708; Mon, 
	27 Apr 2009 04:33:08 -0700 (PDT)
In-Reply-To: <ecef1a880904260529h78d75182uda9a15bb1bca72ed@mail.gmail.com>
References: <7284f6e20903172309lb2bc562i1428196fa5c1e5ba@mail.gmail.com>
	 <91315D35-754E-435F-B7B6-DCE095BD0D95@activemath.org>
	 <7284f6e20903180034m29bed47m8bb6ce40468eb089@mail.gmail.com>
	 <E346D512-5EC8-4B4A-A783-20FD8DAE78F3@activemath.org>
	 <f18c9dde0903180111w7595b9f3wa52292f22c08db0d@mail.gmail.com>
	 <ecef1a880904260529h78d75182uda9a15bb1bca72ed@mail.gmail.com>
Date: Mon, 27 Apr 2009 12:33:08 +0100
Message-ID: <e8aa138c0904270433p1f6b81d1u5a39256ef34faa61@mail.gmail.com>
Subject: Re: lsi as indexing algorithm with lucene
From: adasal <adam.saltiel@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364d313de9b740046887b527
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364d313de9b740046887b527
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hello all,
following the link to SemanticVectors - related research there is this
link:-
Magnus Sahlgren. An introduction to random
indexing.<http://www.sics.se/%7Emange/papers/RI_intro.pdf>
I would like to point out that Magnus Sahlgren has completed a PHd in this
area which is both very readable and very informative.
There are also other Java implementations of Random Indexing using sparse
arrays, one referenced from the SICS site, sometimes it is helpful to look
at alternatives as examples offered can be illuminating.
Adam Saltiel

2009/4/26 Dominik Jednoralski <twelve02@googlemail.com>

> Hi,
>
> I'm the guy who has written the bachelor on this. Sorry it took a while t=
o
> publish it to the community, but I had to improve it before publishing. T=
he
> topic of the thesis was to augment the Lucene-driven search facility of t=
he
> Intelligent Tutoring System ActiveMath by latent semantics. Semantic
> results
> came from the SemanticVectors software package by Dominic Widdows
>
> http://code.google.com/p/semanticvectors/
>
> and have been used to 'blow up' an index query in a way Mr Libbrecht, my
> supervisor, described above.
>
> I wonder if my blog is an appropriate location for my thesis, so please
> feel
> free to redistribute it.
>
>
> http://www.twelve02.de/publications/jednoralski_bachelorthesis_latent_sem=
antics_for_activemath.pdf
>
>
> Best
>
> Dominik Jednoralski
>
>
> 2009/3/18 Simon Willnauer <simon.willnauer@googlemail.com>
>
> > Hi,
> >
> > On Wed, Mar 18, 2009 at 8:59 AM, Paul Libbrecht <paul@activemath.org>
> > wrote:
> > > Depending on your corpus, a semantic vector enabled search engine
> > definitely
> > > is more semantic than one without.
> > >
> > > The general approach I have with these is:
> > >
> > > - get a query
> > > - expand each terms of the query with the fuzzification of
> > semantic-vectors
> > > (e.g. if requested for termA, add termB and termC with their
> > > semantic-distance as a boost factor)
> > > - run query get results with higher rank for termA if found, then for
> > termB
> > > and termC
> > >
> > > My student Dominik Jednoralski has written a bachelor thesis on that.
> > > I'll forward the request to send you this.
> > If it is possible could you post a link where everybody can reach the
> > thesis of your student?
> > I guess it could be interesting for a couple of people on this list
> > and a benefit for your student as well.
> >
> > simon
> > >
> > > Join the semanticVectors' list where the original author also talks.
> > >
> > > paul
> > >
> > >
> > > Le 18-mars-09 =C3=A0 08:34, nitin gopi a =C3=A9crit :
> > >
> > >> hi Paul, I am new to this field of search engine. My aim is to devel=
op
> > >> a semantic search engine. Initially  I was trying to develop that by
> > >> using LSI. But since it is patented that is why there are no many
> > >> implementation attempts. I want  to ask is it possible to create a
> > >> search engine using lucene and semantic vector which is semantically
> > >> better than lucene?
> > >>
> > >> On 3/18/09, Paul Libbrecht <paul@activemath.org> wrote:
> > >>>
> > >>> Nitin,
> > >>>
> > >>> LSI is patented so it's not been a flurry of implementation attempt=
s.
> > >>> However, SemanticVectors is a library that does similar approaches =
to
> > >>> LSA/LSI for indexing and is based on Lucene's term-vectors.
> > >>>
> > >>> paul
> > >>>
> > >>>
> > >>> Le 18-mars-09 =C3=A0 07:09, nitin gopi a =C3=A9crit :
> > >>>
> > >>>> hi all , has any body tried to use LSI(latent semantic indexing) f=
or
> > >>>> indexing in lucene?
> > >>>
> > >>>
> > >>
> > >> --------------------------------------------------------------------=
-
> > >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>
> > >
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--0016364d313de9b740046887b527--

From java-user-return-39969-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 12:26:16 2009
Return-Path: <java-user-return-39969-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94380 invoked from network); 27 Apr 2009 12:26:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 12:26:14 -0000
Received: (qmail 99659 invoked by uid 500); 27 Apr 2009 12:26:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99617 invoked by uid 500); 27 Apr 2009 12:26:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 20011 invoked by uid 99); 27 Apr 2009 11:32:30 -0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=FB_WORD1_END_DOLLAR,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Message-Id: <A1069B16-F8F4-433B-9F17-42BBE1FBC142@cs.vu.nl>
From: Laura Hollink <laurah@cs.vu.nl>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: no results for query with special characters
Date: Mon, 27 Apr 2009 13:32:01 +0200
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I have built an index using the standardAnalyser, and am now querying =20=

that index, also with standardAnalyser. However, I get results I don't =20=

understand.

I know there are a few documents about Brazil in my corpus. My corpus =20=

is in Dutch, and the Dutch term used is "Brazili=EB".

I query the index in three ways for the string "Brazili=EB"
1) by entering a query in the command line
2) by hardcoding the query in my java code
3) by reading in a query file, with one query in it.

The first two give me documents back, but the latter doesn't.

###CODE SNIPPET####

QueryParser parser =3D new QueryParser("skos:prefLabel",new =20
StandardAnalyzer());//the field that I need is called skos:prefLabel.
Directory fsDir =3D FSDirectory.getDirectory(indexDir, false);
IndexSearcher is =3D new IndexSearcher(fsDir);

//1) Query is command line argument
Query query =3D parser.parse(queryarg);
System.out.println(query.toString());
Hits hits =3D is.search(query);
System.out.println(hits.length());

//2) Query is hardcoded
query =3D parser.parse("Brazili=EB");
System.out.println(query.toString());
hits =3D is.search(query);
System.out.println(hits.length());

//3) Query is in separate queryfile called testquery.txt
query =3D parser.parse(queries[0]); //queries is a String[] in which I =20=

read all (in this case only one) queries from the file testquery.txt
System.out.println(query.toString());
hits =3D is.search(query);
System.out.println(hits.length());

#################


Now when I execute my code with:
java MyQueryPoser2 Brazili=EB

I get:
skos:prefLabel:brazili?
4
skos:prefLabel:brazili?
4
skos:prefLabel:brazili
0

The parsed queries are different and the resultlists are different for =20=

the three methods. Why doesn't the query from file give my any results?

I am working on a mac. Could this be due to some special file encoding?

The queryfile does contain the right string:
lauras-macbook-pro:MetLucene laura$ cat testquery.txt
Brazili=EB


thanks for any help.

Laura


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39970-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 13:13:14 2009
Return-Path: <java-user-return-39970-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10925 invoked from network); 27 Apr 2009 13:13:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 13:13:14 -0000
Received: (qmail 70237 invoked by uid 500); 27 Apr 2009 13:13:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70161 invoked by uid 500); 27 Apr 2009 13:13:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70151 invoked by uid 99); 27 Apr 2009 13:13:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 13:13:11 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 13:13:02 +0000
Received: by qw-out-2122.google.com with SMTP id 5so1942110qwd.53
        for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 06:12:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=o7oGYljtczRcMQy79O/feTv1aDwoEsdVRG9JQM7KEsc=;
        b=JK79TuKwwCheAtJL3p0m+oi96XJJfOS1iBuar0+JeNYWS55UnSFWYV5vMXtqO1eWWC
         sHRnsQ/Q5iLaTpqP4pC535DUJz3SOQqhJbzs2YRvOLM32oqTcOT71eYq2qxHGgy0ibe+
         C5t3cShiSRxpfYk0ywcWqcQNqBN/z1lW+gmvo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Lwauw4FdgriHisn8/f4vOE2Npe3ulfofavmZq15KcFhK3aC5GN/JmXzrRjQa+SFGeA
         oB6cevihFdu2nBTjYRhzKV75TvO8PQIqfFYXfgOZZHjXqhrt/3ENWLBx0yacJah967/7
         Zb6Ho7ws2zEzMV4VuJK1YuMAJavwQKLeRCpcA=
MIME-Version: 1.0
Received: by 10.220.73.6 with SMTP id o6mr10684145vcj.49.1240837961583; Mon, 
	27 Apr 2009 06:12:41 -0700 (PDT)
In-Reply-To: <23249637.post@talk.nabble.com>
References: <23249637.post@talk.nabble.com>
Date: Mon, 27 Apr 2009 09:12:41 -0400
Message-ID: <359a92830904270612s48ed4246t7ab89aa4d3b77138@mail.gmail.com>
Subject: Re: Getting values with low scores
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364edc54ec8b660468891939
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364edc54ec8b660468891939
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Well, you can always implement your own HitCollector and just take
the end of the list.

But perhaps a fuller explanation of why you need to do this would
lead to a better answer....

Best
Erick

On Sun, Apr 26, 2009 at 11:41 PM, samd <sdoyle_2@yahoo.com> wrote:

>
> I have 2500 documents and need to have a matches with the very lowest rank
> returned
> How can I get this? It is very important.
>
> When I look at the index in look I see the fields with my values but they
> all have low rank.
> When I search they don't show in the results.
> --
> View this message in context:
> http://www.nabble.com/Getting-values-with-low-scores-tp23249637p23249637.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016364edc54ec8b660468891939--

From java-user-return-39971-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 13:25:31 2009
Return-Path: <java-user-return-39971-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18303 invoked from network); 27 Apr 2009 13:25:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 13:25:31 -0000
Received: (qmail 93869 invoked by uid 500); 27 Apr 2009 13:25:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93821 invoked by uid 500); 27 Apr 2009 13:25:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93810 invoked by uid 99); 27 Apr 2009 13:25:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 13:25:28 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=FB_WORD1_END_DOLLAR,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 209.85.218.227 as permitted sender)
Received: from [209.85.218.227] (HELO mail-bw0-f227.google.com) (209.85.218.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 13:25:22 +0000
Received: by bwz27 with SMTP id 27so2572464bwz.5
        for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 06:25:00 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=oM0ReGgHyHxFCo+kl7cJ4Lr8Mdeq21PBqaQKO7LKL/o=;
        b=a/FOa8KzRmNealv6SWjAK+SDEVu4BnJdllRKLQylaXRNKNsLkLPS4s0aRNDCzBmfAt
         MkVoun4016e590CEnmpBpOJdfmyDrykfw/nDXtG5q2MsY5Ou66kYFC9EUFe8p2U5d/HN
         W6bPQVVHGwQ/vQJ4kSyi29b9gAZ6+Ezlshccg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=xIz48eqwJLaTPvkqqDaBpQehi6uwYyoAiW7DKDxRhGZxzCVo1nfaVY4sBPXG0x54gD
         Kwm1iRL/IvI1coSFvNK6AC+2Jmhs/jvFV2Ru8HtM9Cy5mFmaF0rnKzOVJyjWgGcvpjMa
         /ipC/+sMVbMtxS3Pvk1GzTIliEyIlgbH1WPY8=
MIME-Version: 1.0
Received: by 10.204.120.3 with SMTP id b3mr5270805bkr.58.1240838700400; Mon, 
	27 Apr 2009 06:25:00 -0700 (PDT)
In-Reply-To: <A1069B16-F8F4-433B-9F17-42BBE1FBC142@cs.vu.nl>
References: <A1069B16-F8F4-433B-9F17-42BBE1FBC142@cs.vu.nl>
From: Ian Lea <ian.lea@gmail.com>
Date: Mon, 27 Apr 2009 14:24:45 +0100
Message-ID: <8c4e68610904270624r244ccb7uea48bb9e6dfb583@mail.gmail.com>
Subject: Re: no results for query with special characters
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi


The problem may well lie with the reading of the queries from disk
into your program.
Using an InputStreamReader with correct encoding (UTF-8?) should solve it.


--
Ian.


On Mon, Apr 27, 2009 at 12:32 PM, Laura Hollink <laurah@cs.vu.nl> wrote:
> Hi,
>
> I have built an index using the standardAnalyser, and am now querying tha=
t
> index, also with standardAnalyser. However, I get results I don't
> understand.
>
> I know there are a few documents about Brazil in my corpus. My corpus is =
in
> Dutch, and the Dutch term used is "Brazili=EB".
>
> I query the index in three ways for the string "Brazili=EB"
> 1) by entering a query in the command line
> 2) by hardcoding the query in my java code
> 3) by reading in a query file, with one query in it.
>
> The first two give me documents back, but the latter doesn't.
>
> ###CODE SNIPPET####
>
> QueryParser parser =3D new QueryParser("skos:prefLabel",new
> StandardAnalyzer());//the field that I need is called skos:prefLabel.
> Directory fsDir =3D FSDirectory.getDirectory(indexDir, false);
> IndexSearcher is =3D new IndexSearcher(fsDir);
>
> //1) Query is command line argument
> Query query =3D parser.parse(queryarg);
> System.out.println(query.toString());
> Hits hits =3D is.search(query);
> System.out.println(hits.length());
>
> //2) Query is hardcoded
> query =3D parser.parse("Brazili=EB");
> System.out.println(query.toString());
> hits =3D is.search(query);
> System.out.println(hits.length());
>
> //3) Query is in separate queryfile called testquery.txt
> query =3D parser.parse(queries[0]); //queries is a String[] in which I re=
ad
> all (in this case only one) queries from the file testquery.txt
> System.out.println(query.toString());
> hits =3D is.search(query);
> System.out.println(hits.length());
>
> #################
>
>
> Now when I execute my code with:
> java MyQueryPoser2 Brazili=EB
>
> I get:
> skos:prefLabel:brazili?
> 4
> skos:prefLabel:brazili?
> 4
> skos:prefLabel:brazili
> 0
>
> The parsed queries are different and the resultlists are different for th=
e
> three methods. Why doesn't the query from file give my any results?
>
> I am working on a mac. Could this be due to some special file encoding?
>
> The queryfile does contain the right string:
> lauras-macbook-pro:MetLucene laura$ cat testquery.txt
> Brazili=EB
>
>
> thanks for any help.
>
> Laura
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39972-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 14:35:10 2009
Return-Path: <java-user-return-39972-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64217 invoked from network); 27 Apr 2009 14:35:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 14:35:10 -0000
Received: (qmail 72904 invoked by uid 500); 27 Apr 2009 14:35:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72842 invoked by uid 500); 27 Apr 2009 14:35:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72832 invoked by uid 99); 27 Apr 2009 14:35:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 14:35:07 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 14:34:58 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LyRun-0002Ri-GW
	for java-user@lucene.apache.org; Mon, 27 Apr 2009 07:34:37 -0700
Message-ID: <23257672.post@talk.nabble.com>
Date: Mon, 27 Apr 2009 07:34:37 -0700 (PDT)
From: samd <sdoyle_2@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Getting values with low scores
In-Reply-To: <359a92830904270612s48ed4246t7ab89aa4d3b77138@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sdoyle_2@yahoo.com
References: <23249637.post@talk.nabble.com> <359a92830904270612s48ed4246t7ab89aa4d3b77138@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Because no matter how low the rank they should still be available in search
results for our case.
For example, if you want to search based on an event name. It shouldn't
matter if an event name is of low rank or not, you still want to find a
match.


Erick Erickson wrote:
> 
> Well, you can always implement your own HitCollector and just take
> the end of the list.
> 
> But perhaps a fuller explanation of why you need to do this would
> lead to a better answer....
> 
> Best
> Erick
> 
> On Sun, Apr 26, 2009 at 11:41 PM, samd <sdoyle_2@yahoo.com> wrote:
> 
>>
>> I have 2500 documents and need to have a matches with the very lowest
>> rank
>> returned
>> How can I get this? It is very important.
>>
>> When I look at the index in look I see the fields with my values but they
>> all have low rank.
>> When I search they don't show in the results.
>> --
>> View this message in context:
>> http://www.nabble.com/Getting-values-with-low-scores-tp23249637p23249637.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Getting-values-with-low-scores-tp23249637p23257672.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39973-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 14:36:14 2009
Return-Path: <java-user-return-39973-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64519 invoked from network); 27 Apr 2009 14:36:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 14:36:14 -0000
Received: (qmail 76800 invoked by uid 500); 27 Apr 2009 14:36:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76755 invoked by uid 500); 27 Apr 2009 14:36:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76745 invoked by uid 99); 27 Apr 2009 14:36:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 14:36:11 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 14:36:03 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LyRvq-0002V2-RA
	for java-user@lucene.apache.org; Mon, 27 Apr 2009 07:35:42 -0700
Message-ID: <23257675.post@talk.nabble.com>
Date: Mon, 27 Apr 2009 07:35:42 -0700 (PDT)
From: samd <sdoyle_2@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Getting values with low scores
In-Reply-To: <359a92830904270612s48ed4246t7ab89aa4d3b77138@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sdoyle_2@yahoo.com
References: <23249637.post@talk.nabble.com> <359a92830904270612s48ed4246t7ab89aa4d3b77138@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


One more thing, it's not just about ranking pieces, it's about all no matter
what the rank should be available.


Erick Erickson wrote:
> 
> Well, you can always implement your own HitCollector and just take
> the end of the list.
> 
> But perhaps a fuller explanation of why you need to do this would
> lead to a better answer....
> 
> Best
> Erick
> 
> On Sun, Apr 26, 2009 at 11:41 PM, samd <sdoyle_2@yahoo.com> wrote:
> 
>>
>> I have 2500 documents and need to have a matches with the very lowest
>> rank
>> returned
>> How can I get this? It is very important.
>>
>> When I look at the index in look I see the fields with my values but they
>> all have low rank.
>> When I search they don't show in the results.
>> --
>> View this message in context:
>> http://www.nabble.com/Getting-values-with-low-scores-tp23249637p23249637.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Getting-values-with-low-scores-tp23249637p23257675.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39974-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 15:30:34 2009
Return-Path: <java-user-return-39974-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88372 invoked from network); 27 Apr 2009 15:30:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 15:30:34 -0000
Received: (qmail 99109 invoked by uid 500); 27 Apr 2009 15:30:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99057 invoked by uid 500); 27 Apr 2009 15:30:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99047 invoked by uid 99); 27 Apr 2009 15:30:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 15:30:31 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of MMastroianni@glgroup.com)
Received: from [216.32.180.11] (HELO VA3EHSOBE001.bigfish.com) (216.32.180.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 15:30:22 +0000
Received: from mail26-va3-R.bigfish.com (10.7.14.254) by
 VA3EHSOBE001.bigfish.com (10.7.40.21) with Microsoft SMTP Server id
 8.1.340.0; Mon, 27 Apr 2009 15:30:00 +0000
Received: from mail26-va3 (localhost.localdomain [127.0.0.1])	by
 mail26-va3-R.bigfish.com (Postfix) with ESMTP id 16D0E34823B	for
 <java-user@lucene.apache.org>; Mon, 27 Apr 2009 15:30:01 +0000 (UTC)
X-BigFish: VPS-48(zz542NfadR1432Ra0dJ98dR1805M936fK9371P4f15k10e6izz1202hzz5a6ciz32i6bh61h)
X-Spam-TCS-SCL: 0:0
X-FB-SS: 5,
Received: by mail26-va3 (MessageSwitch) id 1240846199427362_8930; Mon, 27 Apr
 2009 15:29:59 +0000 (UCT)
Received: from GLGNYEXSMTP01.glgroup.com (glgnyexsmtp01.glgroup.com
 [38.112.210.160])	by mail26-va3.bigfish.com (Postfix) with ESMTP id
 5DB551198053	for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 15:29:59
 +0000 (UTC)
Received: from GLGNYEXBE02.glgroup.com ([10.45.50.82]) by
 GLGNYEXSMTP01.glgroup.com with Microsoft SMTPSVC(6.0.3790.3959);	 Mon, 27 Apr
 2009 11:29:59 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: kamikaze
Date: Mon, 27 Apr 2009 11:31:57 -0400
Message-ID: <9008E1E80EE8A340BACCA3DFF41B21562A4D51@GLGNYEXBE02.glgroup.com>
In-Reply-To: <8837fb770904241649i6beb28e5i770eca9c50b5d8e5@mail.gmail.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: kamikaze
thread-index: AcnFN2WPuLcnHdgERHeB60J/2VcL8gCFXtXg
From: Michael Mastroianni <MMastroianni@glgroup.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 27 Apr 2009 15:29:59.0240 (UTC) FILETIME=[06829480:01C9C74D]
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks. =


I have a couple quick questions. =

1. when I call 	    	DocSetFactory.getDocSetInstance(0, -1, -1,
DocSetFactory.FOCUS.SPACE);

with very large numbers instead of -1, I get OpenBitSets back, which I
found surprising (I get p4 sets back when I pass in the -1 values).

Also, is there any way of creating a plain old DocIdSet out of an
OrDocIdSet or AndDocIdSet, so I don't have to carry around the internal
ArrayList objects?

I couldn't see any way of doing that in the code or docs, but I could
easily be missing something.

regards,
Michael

-----Original Message-----
From: John Wang [mailto:john.wang@gmail.com] =

Sent: Friday, April 24, 2009 7:50 PM
To: java-user@lucene.apache.org
Subject: Re: kamikaze

Hi Michael:
    We are using it internally here at LinkedIn for both our search
engine
as well as our social graph engine. And we have a team developing
actively
on it. Let us know how we can help you.

-John

On Fri, Apr 24, 2009 at 1:56 PM, Michael Mastroianni <
MMastroianni@glgroup.com> wrote:

> Hi--
>
>
>
> Has anyone here used kamikaze much? I'm interested in using it in
> situations where I'll have several docidsets of >2M, plus several in
the
> 10s of thousands.
>
>
>
> On prototype basis, I got something running nicely using OpenBitSet,
but
> I can't use that much memory for my real application.
>
>
>
> regards,
>
> Michael Mastroianni
>
>
>
> This e-mail message, and any attachments, is intended only for the use
of
> the individual or entity identified in the alias address of this
message and
> may contain information that is confidential, privileged and subject
to
> legal restrictions and penalties regarding its unauthorized disclosure
and
> use. Any unauthorized review, copying, disclosure, use or distribution
is
> strictly prohibited. If you have received this e-mail message in
error,
> please notify the sender immediately by reply e-mail and delete this
> message, and any attachments, from your system. Thank you.
>
>

This e-mail message, and any attachments, is intended only for the use of t=
he individual or entity identified in the alias address of this message and=
 may contain information that is confidential, privileged and subject to le=
gal restrictions and penalties regarding its unauthorized disclosure and us=
e. Any unauthorized review, copying, disclosure, use or distribution is str=
ictly prohibited. If you have received this e-mail message in error, please=
 notify the sender immediately by reply e-mail and delete this message, and=
 any attachments, from your system. Thank you.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39975-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 16:29:47 2009
Return-Path: <java-user-return-39975-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12416 invoked from network); 27 Apr 2009 16:29:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 16:29:47 -0000
Received: (qmail 21116 invoked by uid 500); 27 Apr 2009 16:29:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21054 invoked by uid 500); 27 Apr 2009 16:29:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21044 invoked by uid 99); 27 Apr 2009 16:29:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 16:29:45 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.146.182 as permitted sender)
Received: from [209.85.146.182] (HELO wa-out-1112.google.com) (209.85.146.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 16:29:35 +0000
Received: by wa-out-1112.google.com with SMTP id l35so6136waf.5
        for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 09:29:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=epWDlWMdd/HhwoDd0kPRILqMRo6h7Nc5Scwvp5NrFuk=;
        b=IB/bkbQZVVSo1n24CE2UCR0pF+u1KDQYbKwj0aEks3HIguvLXhK/FfwwXyUNO61AB1
         yCwLK2vqfNeohXIOXEnGoquRYHPQ6aJ/BBEs99voWY34SzFweeZlee5whPcM847YiyU9
         WO5nUhQ7oGx9PWlzW4kEa5VfFrLd1KwG5OtTw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=DwbSsLS75kQDxech8P15L9moAgMVs7eZMdO3CmMzwVxZXe+RR5S9XEFeQW45kiNRo4
         lTBlqomyd/zhruayaaarB0lAC/EswZ65fxwJSRV7iYCDrpjC25IYm/Eb/ZEkt8n1hsrp
         OGBjeNrhAUksb9SmxmZEzNQleDEZdmg1yh01k=
MIME-Version: 1.0
Received: by 10.220.45.131 with SMTP id e3mr10593240vcf.89.1240849753113; Mon, 
	27 Apr 2009 09:29:13 -0700 (PDT)
In-Reply-To: <23257675.post@talk.nabble.com>
References: <23249637.post@talk.nabble.com>
	 <359a92830904270612s48ed4246t7ab89aa4d3b77138@mail.gmail.com>
	 <23257675.post@talk.nabble.com>
Date: Mon, 27 Apr 2009 12:29:13 -0400
Message-ID: <359a92830904270929h113f3c2cv2d8f5bad043892c4@mail.gmail.com>
Subject: Re: Getting values with low scores
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6470526c1087504688bd80f
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6470526c1087504688bd80f
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

I'm really having a hard time understanding what your requirements
are. To have all the results available for event, just search on that
field (assuming you have an "event" field for each of your docs).
Use a HitCollector to get all of the rather than the (deprecated)
Hits object, I'd suggest TopDocCollector.

If you require multiple terms on multiple fields, just search with
OR clauses.

The above clearly shows that I don't understand your problem at all,
so how about a few examples?

Best
Erick

On Mon, Apr 27, 2009 at 10:35 AM, samd <sdoyle_2@yahoo.com> wrote:

>
> One more thing, it's not just about ranking pieces, it's about all no
> matter
> what the rank should be available.
>
>
> Erick Erickson wrote:
> >
> > Well, you can always implement your own HitCollector and just take
> > the end of the list.
> >
> > But perhaps a fuller explanation of why you need to do this would
> > lead to a better answer....
> >
> > Best
> > Erick
> >
> > On Sun, Apr 26, 2009 at 11:41 PM, samd <sdoyle_2@yahoo.com> wrote:
> >
> >>
> >> I have 2500 documents and need to have a matches with the very lowest
> >> rank
> >> returned
> >> How can I get this? It is very important.
> >>
> >> When I look at the index in look I see the fields with my values but
> they
> >> all have low rank.
> >> When I search they don't show in the results.
> >> --
> >> View this message in context:
> >>
> http://www.nabble.com/Getting-values-with-low-scores-tp23249637p23249637.html
> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> >
>
> --
> View this message in context:
> http://www.nabble.com/Getting-values-with-low-scores-tp23249637p23257675.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6470526c1087504688bd80f--

From java-user-return-39976-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 16:53:35 2009
Return-Path: <java-user-return-39976-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23467 invoked from network); 27 Apr 2009 16:53:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 16:53:35 -0000
Received: (qmail 78608 invoked by uid 500); 27 Apr 2009 16:53:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78548 invoked by uid 500); 27 Apr 2009 16:53:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78538 invoked by uid 99); 27 Apr 2009 16:53:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 16:53:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rakesh.usenet@gmail.com designates 209.85.198.231 as permitted sender)
Received: from [209.85.198.231] (HELO rv-out-0506.google.com) (209.85.198.231)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 16:53:25 +0000
Received: by rv-out-0506.google.com with SMTP id l9so19467rvb.5
        for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 09:53:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=rYdfiFxLJjcHV7vKOdpfucRR4onePCyR9PkY0IievFw=;
        b=x+/boQJi6gcIOmuXpNoP3/Gm5BiyikO1itKnvWbmQHSE1xFMi6Kg8xMNiRobhVpQqQ
         GSkxH79TgrqL93xMbVo09wq3NjeudnuIzl+R/U3Lo8paXBKUHnZSV1xSHhxSOqna2RDZ
         RzUAxTy3K1FAfbY++NsFi8EE9koj0CuY2QgdA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=A+nk9fQZY5TyiAZopzZ2labNKcVDO2PaZOm0NxKD2weuthp1JZqnRt9Y/5Rp8DWrhY
         OsgndBwtBL1SK6brQqPfboRRZ1vhy+1PYt4oBl2qcwYP5lJ8Guhr480seg6jsIxl4XJc
         kgK1aPAoFt3DEgBYpKNb3jROyCuKxBaLPzTXY=
MIME-Version: 1.0
Received: by 10.220.91.205 with SMTP id o13mr10830337vcm.92.1240851183140; 
	Mon, 27 Apr 2009 09:53:03 -0700 (PDT)
Date: Mon, 27 Apr 2009 12:53:03 -0400
Message-ID: <aed435370904270953h54f3e7dam759829d954e171aa@mail.gmail.com>
Subject: Searcher#setSimilarity clarifications
From: Rakesh Sinha <rakesh.usenet@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I am looking into setting custom scoring sing Similarity
(org.apache.lucene.search.Similarity) . Searcher has a method to set
similarity as follows - searcher.setSimilarity(Similarity) and
retrieve the same too. I am looking at a case where I can have just
one Searcher instance and use different similarities for different
queries (since searcher is multi-threaded ).

results = searcher.search( similarity, "myfield:mysearchstring" );

and be ensured that the right similarity is applied for the right
fields to be searched for.  Right now - it would go along the lines of
searcher.setSimilarity(Similarity)  and then followed by the
searcher.search ( .. ) so I cannot do concurrent searches (unless they
are on different searcher instances altogether). Any suggestions
regarding this ? Thanks.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39977-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 17:21:13 2009
Return-Path: <java-user-return-39977-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42706 invoked from network); 27 Apr 2009 17:21:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 17:21:13 -0000
Received: (qmail 26160 invoked by uid 500); 27 Apr 2009 17:21:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26104 invoked by uid 500); 27 Apr 2009 17:21:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26001 invoked by uid 99); 27 Apr 2009 17:21:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 17:21:10 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 17:21:01 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LyUVU-00024d-Gx
	for java-user@lucene.apache.org; Mon, 27 Apr 2009 10:20:40 -0700
Message-ID: <23260994.post@talk.nabble.com>
Date: Mon, 27 Apr 2009 10:20:40 -0700 (PDT)
From: samd <sdoyle_2@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Getting values with low scores
In-Reply-To: <359a92830904270929h113f3c2cv2d8f5bad043892c4@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sdoyle_2@yahoo.com
References: <23249637.post@talk.nabble.com> <359a92830904270612s48ed4246t7ab89aa4d3b77138@mail.gmail.com> <23257675.post@talk.nabble.com> <359a92830904270929h113f3c2cv2d8f5bad043892c4@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


As it turns out it was more an issue with the tokenization and how fields
were being stored which contain numeric values. I need to be sure that
fields are tokenized on numeric values as well.

Thanks


Erick Erickson wrote:
> 
> I'm really having a hard time understanding what your requirements
> are. To have all the results available for event, just search on that
> field (assuming you have an "event" field for each of your docs).
> Use a HitCollector to get all of the rather than the (deprecated)
> Hits object, I'd suggest TopDocCollector.
> 
> If you require multiple terms on multiple fields, just search with
> OR clauses.
> 
> The above clearly shows that I don't understand your problem at all,
> so how about a few examples?
> 
> Best
> Erick
> 
> On Mon, Apr 27, 2009 at 10:35 AM, samd <sdoyle_2@yahoo.com> wrote:
> 
>>
>> One more thing, it's not just about ranking pieces, it's about all no
>> matter
>> what the rank should be available.
>>
>>
>> Erick Erickson wrote:
>> >
>> > Well, you can always implement your own HitCollector and just take
>> > the end of the list.
>> >
>> > But perhaps a fuller explanation of why you need to do this would
>> > lead to a better answer....
>> >
>> > Best
>> > Erick
>> >
>> > On Sun, Apr 26, 2009 at 11:41 PM, samd <sdoyle_2@yahoo.com> wrote:
>> >
>> >>
>> >> I have 2500 documents and need to have a matches with the very lowest
>> >> rank
>> >> returned
>> >> How can I get this? It is very important.
>> >>
>> >> When I look at the index in look I see the fields with my values but
>> they
>> >> all have low rank.
>> >> When I search they don't show in the results.
>> >> --
>> >> View this message in context:
>> >>
>> http://www.nabble.com/Getting-values-with-low-scores-tp23249637p23249637.html
>> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>> >
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Getting-values-with-low-scores-tp23249637p23257675.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Getting-values-with-low-scores-tp23249637p23260994.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39978-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 19:42:52 2009
Return-Path: <java-user-return-39978-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32516 invoked from network); 27 Apr 2009 19:42:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 19:42:52 -0000
Received: (qmail 47748 invoked by uid 500); 27 Apr 2009 19:42:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47701 invoked by uid 500); 27 Apr 2009 19:42:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47691 invoked by uid 99); 27 Apr 2009 19:42:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 19:42:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [160.79.251.45] (HELO mail02.tveyes.com) (160.79.251.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 19:42:43 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: Yet another NFS Question...
Date: Mon, 27 Apr 2009 15:42:17 -0400
Message-ID: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2D60@mail02.tveyes.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Yet another NFS Question...
thread-index: AcnHcEVYdWuJwYi+QmSxUjF+/SvwPw==
From: "David Seltzer" <dseltzer@TVEyes.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi everyone,

There has been a lot of discussion regarding Lucene+NFS pitfalls. I'm
not sure how to proceed with a more distributed operation.

I'm trying to take the indexing load off of our search server. I can do
this either by building a new server which hosts the Indexer and the
Index, or a server which hosts the Searcher and the Index. The two boxes
will be connected via NFS.

In our system there are no updates or deletes. Just lots of "add" and
"optimize" calls.=20

What is the best way to handle this sort of situation? My inclination is
build a new Search Server (with fast HDDs and lots of Memory for tomcat)
and leave the indexer on the old server connected via NFS.

Thanks!

-Dave


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39979-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 20:13:10 2009
Return-Path: <java-user-return-39979-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41690 invoked from network); 27 Apr 2009 20:13:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 20:13:08 -0000
Received: (qmail 93052 invoked by uid 500); 27 Apr 2009 20:13:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93000 invoked by uid 500); 27 Apr 2009 20:13:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92990 invoked by uid 99); 27 Apr 2009 20:13:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 20:13:06 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [74.125.46.30] (HELO yw-out-2324.google.com) (74.125.46.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 20:12:58 +0000
Received: by yw-out-2324.google.com with SMTP id 2so75493ywt.5
        for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 13:12:36 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.74.3 with SMTP id b3mr9554234ybl.1.1240863156685; Mon, 27 
	Apr 2009 13:12:36 -0700 (PDT)
In-Reply-To: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2D60@mail02.tveyes.com>
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2D60@mail02.tveyes.com>
Date: Mon, 27 Apr 2009 16:12:36 -0400
Message-ID: <9ac0c6aa0904271312j5c4a5159q7e27d76fb106ce44@mail.gmail.com>
Subject: Re: Yet another NFS Question...
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

"In theory" either solution will work, from Lucene's standpoint.  But
this is not well-explored territory: you are a pioneer!  Please report
back on your results :)

Usually (and this may be different in your app), search performance
trumps indexing performance, so my guess is you'd want the index
hosted on the same machine doing searching.  If you do it this way,
it's possible you won't need a custom IndexDeletionPolicy, because the
searchers will hold open files via the local filesystem which should
properly protect them when an NFS client (the indexer machine) tries
to delete them.

Mike

On Mon, Apr 27, 2009 at 3:42 PM, David Seltzer <dseltzer@tveyes.com> wrote:
> Hi everyone,
>
> There has been a lot of discussion regarding Lucene+NFS pitfalls. I'm
> not sure how to proceed with a more distributed operation.
>
> I'm trying to take the indexing load off of our search server. I can do
> this either by building a new server which hosts the Indexer and the
> Index, or a server which hosts the Searcher and the Index. The two boxes
> will be connected via NFS.
>
> In our system there are no updates or deletes. Just lots of "add" and
> "optimize" calls.
>
> What is the best way to handle this sort of situation? My inclination is
> build a new Search Server (with fast HDDs and lots of Memory for tomcat)
> and leave the indexer on the old server connected via NFS.
>
> Thanks!
>
> -Dave
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39980-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 20:19:43 2009
Return-Path: <java-user-return-39980-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43436 invoked from network); 27 Apr 2009 20:19:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 20:19:43 -0000
Received: (qmail 1151 invoked by uid 500); 27 Apr 2009 20:19:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1077 invoked by uid 500); 27 Apr 2009 20:19:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1067 invoked by uid 99); 27 Apr 2009 20:19:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 20:19:41 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [150.148.0.65] (HELO ironport4.fda.gov) (150.148.0.65)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 20:19:33 +0000
X-SBRS: None
X-MID: 130973583
Received: from fmd3tj002.fda.gov ([10.160.10.77])
  by ironport4.fda.gov with ESMTP; 27 Apr 2009 16:19:12 -0400
Received: from FMD3VS012.fda.gov ([10.160.10.62]) by FMD3TJ002.fda.gov with Microsoft SMTPSVC(6.0.3790.3959);
	 Mon, 27 Apr 2009 16:19:12 -0400
X-MIMEOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Yet another NFS Question...
Date: Mon, 27 Apr 2009 16:19:11 -0400
Message-ID: <F8A04958BB57B64096F9BE6B9572564304C73BDB@FMD3VS012.fda.gov>
In-Reply-To: <9ac0c6aa0904271312j5c4a5159q7e27d76fb106ce44@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Yet another NFS Question...
Thread-Index: AcnHdJVNxVm+I0HTS1+Zwq/xtfWlFQAAIBIw
References: <3CA90CC651AE3F4BAEDF8A5B78639C8C02BC2D60@mail02.tveyes.com> <9ac0c6aa0904271312j5c4a5159q7e27d76fb106ce44@mail.gmail.com>
From: "Sudarsan, Sithu D." <Sithu.Sudarsan@fda.hhs.gov>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 27 Apr 2009 20:19:12.0158 (UTC) FILETIME=[6DA7BBE0:01C9C775]
X-Virus-Checked: Checked by ClamAV on apache.org

>What is the best way to handle this sort of situation? My inclination
is
> build a new Search Server (with fast HDDs and lots of Memory for
tomcat)
> and leave the indexer on the old server connected via NFS.=20

- Our current development is on similar lines. Almost no deletes, but
only lots of ADDDDD...

- Our approach is similar to yours. Without multi-level searches (which
we are currently trying to implement), I'm not able to comment on
performance at this point.=20
Sincerely,
Sithu D Sudarsan
-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: Monday, April 27, 2009 4:13 PM
To: java-user@lucene.apache.org
Subject: Re: Yet another NFS Question...

"In theory" either solution will work, from Lucene's standpoint.  But
this is not well-explored territory: you are a pioneer!  Please report
back on your results :)

Usually (and this may be different in your app), search performance
trumps indexing performance, so my guess is you'd want the index
hosted on the same machine doing searching.  If you do it this way,
it's possible you won't need a custom IndexDeletionPolicy, because the
searchers will hold open files via the local filesystem which should
properly protect them when an NFS client (the indexer machine) tries
to delete them.

Mike

On Mon, Apr 27, 2009 at 3:42 PM, David Seltzer <dseltzer@tveyes.com>
wrote:
> Hi everyone,
>
> There has been a lot of discussion regarding Lucene+NFS pitfalls. I'm
> not sure how to proceed with a more distributed operation.
>
> I'm trying to take the indexing load off of our search server. I can
do
> this either by building a new server which hosts the Indexer and the
> Index, or a server which hosts the Searcher and the Index. The two
boxes
> will be connected via NFS.
>
> In our system there are no updates or deletes. Just lots of "add" and
> "optimize" calls.
>
> What is the best way to handle this sort of situation? My inclination
is
> build a new Search Server (with fast HDDs and lots of Memory for
tomcat)
> and leave the indexer on the old server connected via NFS.
>
> Thanks!
>
> -Dave
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39981-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 20:24:27 2009
Return-Path: <java-user-return-39981-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45529 invoked from network); 27 Apr 2009 20:24:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 20:24:27 -0000
Received: (qmail 13026 invoked by uid 500); 27 Apr 2009 20:24:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12947 invoked by uid 500); 27 Apr 2009 20:24:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12937 invoked by uid 99); 27 Apr 2009 20:24:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 20:24:24 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [150.148.0.65] (HELO ironport5.fda.gov) (150.148.0.65)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 20:24:15 +0000
X-SBRS: None
X-MID: 119374100
Received: from fmd3tj002.fda.gov ([10.160.10.77])
  by ironport5.fda.gov with ESMTP; 27 Apr 2009 16:23:54 -0400
Received: from FMD3VS012.fda.gov ([10.160.10.62]) by FMD3TJ002.fda.gov with Microsoft SMTPSVC(6.0.3790.3959);
	 Mon, 27 Apr 2009 16:23:54 -0400
X-MIMEOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Wordnet indexing error
Date: Mon, 27 Apr 2009 16:23:53 -0400
Message-ID: <F8A04958BB57B64096F9BE6B9572564304C73BDE@FMD3VS012.fda.gov>
In-Reply-To: <703951.59256.qm@web50307.mail.re2.yahoo.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Wordnet indexing error
Thread-Index: AcnE9x7Hp82lXvq4SiaZiXWb3Dc7rwCfueww
References: <F8A04958BB57B64096F9BE6B9572564304C73BB9@FMD3VS012.fda.gov> <273311.72887.qm@web50310.mail.re2.yahoo.com> <F8A04958BB57B64096F9BE6B9572564304C73BBA@FMD3VS012.fda.gov> <703951.59256.qm@web50307.mail.re2.yahoo.com>
From: "Sudarsan, Sithu D." <Sithu.Sudarsan@fda.hhs.gov>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 27 Apr 2009 20:23:54.0730 (UTC) FILETIME=[1614CCA0:01C9C776]
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Otis!

I've got java APIs that could be used.=20


Sincerely,
Sithu D Sudarsan

Off: 301-796-2587

sithu.sudarsan@fda.hhs.gov
sdsudarsan@ualr.edu

-----Original Message-----
From: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com]=20
Sent: Friday, April 24, 2009 12:09 PM
To: java-user@lucene.apache.org
Subject: Re: Wordnet indexing error


Nothing that marries WordNet with Lucene other than that syns stuff
exists in Lucene contrib (but it may exist on SourceForce, in Google
Code, etc.).  There are several WordNet java libraries you could use to
combing WN and Lucene:

   http://www.simpy.com/user/otis/search/wordnet

Otis
--
Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch



----- Original Message ----
> From: "Sudarsan, Sithu D." <Sithu.Sudarsan@fda.hhs.gov>
> To: java-user@lucene.apache.org
> Sent: Friday, April 10, 2009 9:51:39 AM
> Subject: RE: Wordnet indexing error
>=20
>=20
> Thanks Otis,
>=20
> Yes, we figured that out! Since, we do not intend to migrate to 2.4
yet,
> we used the syns2index source code from svn. The problem is now taken
> care.
>=20
> This part is for all:=20
>=20
> This brings us to the next question:=20
>=20
> 1. Is there some contrib code available for using hypernyms and such,
in
> addition to synonyms from Wordnet?
> 2. Is there some code to add user defined dictionary/ontology, as an
> additional layer to Wordnet (some sort of multi-level)?
>=20
> Thank you all in advance,
>=20
> Sincerely,
> Sithu=20
>=20
> -----Original Message-----
> From: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com]=20
> Sent: Thursday, April 09, 2009 1:06 AM
> To: java-user@lucene.apache.org
> Subject: Re: Wordnet indexing error
>=20
>=20
> Hi,
>=20
> The simplest thing to do is to grab the latest Lucene and the latest
jar
> for that Wordnet (syns2index) code.  That should work for you (that
> UnIndexed method is an old method that doesn't exist any more).
>=20
>=20
> Otis
> --
> Sematext -- http://sematext.com/ -- Lucene - Solr - Nutch
>=20
>=20
>=20
> ----- Original Message ----
> > From: "Sudarsan, Sithu D."=20
> > To: java-user@lucene.apache.org
> > Sent: Wednesday, April 8, 2009 7:01:16 PM
> > Subject: Wordnet indexing error
> >=20
> > Hi All,
> >=20
> > We're using Lucene 2.3.2 on Windows. When we try to generate index
for
> > WordNet2.0 using Syns2Index class, while indexing, the following
error
> > is thrown:
> >=20
> > Java.lang.NoSuchMethodError:
> >
>
org.apache.lucene.document.Field.UnIndexed(Ljava/lang/String;Ljava/lang/
> > String;)Lorg/apache/lucene/document/Field;
> >=20
> > Our code is looks like this:
> >=20
> > String[] filelocations =3D {"path/to/prolog/file", "path/to/index"};
> > try{
> >      Syns2Index.main(filelocations);
> > } catch ....
> >=20
> >=20
> > The error typically happens at about line number 130000 in the
wn_s.pl
> > file.
> >=20
> > No luck with WordNet3.0 as well. We get the same error.
> >=20
> > Any fix or solutions?=20
> >=20
> > Thanks in advance,
> > Sithu D Sudarsan
> >=20
> > sithu.sudarsan@fda.hhs.gov
> > sdsudarsan@ualr.edu
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39982-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 21:48:32 2009
Return-Path: <java-user-return-39982-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95144 invoked from network); 27 Apr 2009 21:48:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 21:48:32 -0000
Received: (qmail 98407 invoked by uid 500); 27 Apr 2009 21:48:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98318 invoked by uid 500); 27 Apr 2009 21:48:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98308 invoked by uid 99); 27 Apr 2009 21:48:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 21:48:30 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED
X-Spam-Check-By: apache.org
Received-SPF: unknown (athena.apache.org: error in processing during lookup of MMastroianni@glgroup.com)
Received: from [207.46.51.80] (HELO SG2EHSOBE001.bigfish.com) (207.46.51.80)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 21:48:22 +0000
Received: from mail1-sin-R.bigfish.com (10.3.40.3) by SG2EHSOBE001.bigfish.com
 (10.3.40.21) with Microsoft SMTP Server id 8.1.340.0; Mon, 27 Apr 2009
 21:48:00 +0000
Received: from mail1-sin (localhost.localdomain [127.0.0.1])	by
 mail1-sin-R.bigfish.com (Postfix) with ESMTP id 2F1381B380D4	for
 <java-user@lucene.apache.org>; Mon, 27 Apr 2009 21:48:00 +0000 (UTC)
X-BigFish: VPS-47(zz542NfadR1432Ra0dJ98dR168aJ1805M936fK9371P4f15k8b9bk10e6izz1202hzz5a6ciz32i6bh61h)
X-Spam-TCS-SCL: 0:0
Received: by mail1-sin (MessageSwitch) id 1240868878322960_17659; Mon, 27 Apr
 2009 21:47:58 +0000 (UCT)
Received: from GLGNYEXSMTP02.glgroup.com (glgnyexsmtp02.glgroup.com
 [38.112.210.163])	by mail1-sin.bigfish.com (Postfix) with ESMTP id
 A7A31290056	for <java-user@lucene.apache.org>; Mon, 27 Apr 2009 21:47:57
 +0000 (UTC)
Received: from GLGNYEXBE02.glgroup.com ([10.45.50.82]) by
 GLGNYEXSMTP02.glgroup.com with Microsoft SMTPSVC(6.0.3790.3959);	 Mon, 27 Apr
 2009 17:47:55 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: kamikaze
Date: Mon, 27 Apr 2009 17:49:54 -0400
Message-ID: <9008E1E80EE8A340BACCA3DFF41B21562A4E18@GLGNYEXBE02.glgroup.com>
In-Reply-To: <8837fb770904241649i6beb28e5i770eca9c50b5d8e5@mail.gmail.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: kamikaze
thread-index: AcnFN2WPuLcnHdgERHeB60J/2VcL8gCSrEoA
From: Michael Mastroianni <MMastroianni@glgroup.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 27 Apr 2009 21:47:55.0961 (UTC) FILETIME=[D2E39A90:01C9C781]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi--

I just got kamikaze somewhat integrated into a project of mine. I'm
having problems growing the DocIdSets, though. Up to the point where the
first regrow happens, everything is fine. Once the regrow happens, I get
an ArrayOutOfBoundsException. The following unit test will exhibit this
behavior. If I change the third param of getDocSetInstance to be
something lower, I get a p4Doc, if I leave it as is, I get an OpenBitSet
doc, in either case, I get the same crash. Do I need to initialize the
docs in some way other than just creating them?

regards,
Michael

import org.apache.lucene.search.DocIdSet;
import org.apache.lucene.util.OpenBitSet;


import com.kamikaze.docidset.api.DocSet;
import com.kamikaze.docidset.impl.AndDocIdSet;
import com.kamikaze.docidset.impl.OrDocIdSet;
import com.kamikaze.docidset.utils.DocSetFactory;

import junit.framework.TestCase;


public class KamikazeTest extends TestCase
{
    public void testGrowingP4()
    {
        DocSet doc =3D
            DocSetFactory.getDocSetInstance(0, 350000, 3000000,
DocSetFactory.FOCUS.SPACE);
        Random rand =3D new Random(System.currentTimeMillis());
        int maxDoc =3D 350000;
        doc.addDoc(rand.nextInt(maxDoc));
        int i =3D 0;
        try
        {
            while(i < 256)
            {
                int nextDoc =3D rand.nextInt(maxDoc);
                doc.addDoc(nextDoc);
                ++i;
            }               =

        }
        catch(Exception e)
        {
            return;
        }
        assertTrue(false);
    }
}

-----Original Message-----
From: John Wang [mailto:john.wang@gmail.com] =

Sent: Friday, April 24, 2009 7:50 PM
To: java-user@lucene.apache.org
Subject: Re: kamikaze

Hi Michael:
    We are using it internally here at LinkedIn for both our search
engine
as well as our social graph engine. And we have a team developing
actively
on it. Let us know how we can help you.

-John

On Fri, Apr 24, 2009 at 1:56 PM, Michael Mastroianni <
MMastroianni@glgroup.com> wrote:

> Hi--
>
>
>
> Has anyone here used kamikaze much? I'm interested in using it in
> situations where I'll have several docidsets of >2M, plus several in
the
> 10s of thousands.
>
>
>
> On prototype basis, I got something running nicely using OpenBitSet,
but
> I can't use that much memory for my real application.
>
>
>
> regards,
>
> Michael Mastroianni
>
>
>
> This e-mail message, and any attachments, is intended only for the use
of
> the individual or entity identified in the alias address of this
message and
> may contain information that is confidential, privileged and subject
to
> legal restrictions and penalties regarding its unauthorized disclosure
and
> use. Any unauthorized review, copying, disclosure, use or distribution
is
> strictly prohibited. If you have received this e-mail message in
error,
> please notify the sender immediately by reply e-mail and delete this
> message, and any attachments, from your system. Thank you.
>
>

This e-mail message, and any attachments, is intended only for the use of t=
he individual or entity identified in the alias address of this message and=
 may contain information that is confidential, privileged and subject to le=
gal restrictions and penalties regarding its unauthorized disclosure and us=
e. Any unauthorized review, copying, disclosure, use or distribution is str=
ictly prohibited. If you have received this e-mail message in error, please=
 notify the sender immediately by reply e-mail and delete this message, and=
 any attachments, from your system. Thank you.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39983-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Apr 27 23:33:35 2009
Return-Path: <java-user-return-39983-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35897 invoked from network); 27 Apr 2009 23:33:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Apr 2009 23:33:34 -0000
Received: (qmail 54739 invoked by uid 500); 27 Apr 2009 23:33:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54653 invoked by uid 500); 27 Apr 2009 23:33:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54639 invoked by uid 99); 27 Apr 2009 23:33:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 23:33:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [203.217.22.128] (HELO file1.syd.nuix.com) (203.217.22.128)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 27 Apr 2009 23:33:22 +0000
Received: from [192.168.222.60] (monolith.syd.nuix.com [192.168.222.60])
	by file1.syd.nuix.com (Postfix) with ESMTP id 180AB4A8852
	for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 09:32:57 +1000 (EST)
Message-ID: <49F6412F.3000904@nuix.com>
Date: Tue, 28 Apr 2009 09:35:11 +1000
From: Daniel Noll <daniel@nuix.com>
Organization: Nuix Pty Ltd
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: Lucene Mailing List <java-user@lucene.apache.org>
Subject: ArrayIndexOutOfBoundsException from TermInfosReader.get (2.3.2)
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all.

One of our users has seen an error like this:

> java.lang.ArrayIndexOutOfBoundsException: -1030685
> 	at org.apache.lucene.index.TermInfosReader.get(TermInfosReader.java:210)
> 	at org.apache.lucene.index.SegmentTermDocs.seek(SegmentTermDocs.java:54)
> 	at org.apache.lucene.index.IndexReader.termDocs(IndexReader.java:668)
> 	at org.apache.lucene.search.TermQuery$TermWeight.scorer(TermQuery.java:64)
> 	at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:143)
> 	at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:113)
> 	at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:100)
> 	at org.apache.lucene.search.Hits.<init>(Hits.java:67)

I believe this was from Lucene 2.3.2.

I can't see any records on JIRA related to this being fixed, and the 
problem hasn't been reproduced locally so it isn't easy to try 2.4.1 and 
see if it has been fixed, but was there a bug along these lines in 2.3.2?

Daniel


-- 
Daniel Noll                            Forensic and eDiscovery Software
Senior Developer                              The world's most advanced
Nuix                                                email data analysis
http://nuix.com/                                and eDiscovery software

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39984-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 01:55:52 2009
Return-Path: <java-user-return-39984-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99412 invoked from network); 28 Apr 2009 01:55:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 01:55:51 -0000
Received: (qmail 80350 invoked by uid 500); 28 Apr 2009 01:55:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80282 invoked by uid 500); 28 Apr 2009 01:55:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80272 invoked by uid 99); 28 Apr 2009 01:55:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 01:55:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 01:55:40 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LycXX-0000Co-43
	for java-user@lucene.apache.org; Mon, 27 Apr 2009 18:55:19 -0700
Message-ID: <23268494.post@talk.nabble.com>
Date: Mon, 27 Apr 2009 18:55:19 -0700 (PDT)
From: blazingwolf7 <blazingwolf7@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Why Lucene phrase searching fail?
In-Reply-To: <23253549.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: blazingwolf7@gmail.com
References: <23253549.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


When i print out the query, it will be like this:
(url:"terror india"^2.0 anchor:"terror india"^0.0 content:"terror india"
title:"terror india"^1.5 host:"terror india"^2.0 site:"terror india"^10.0)

I dont understand at all, only phrase query got problem, even my sloop has
no problem at all. I have exact match in my content, so it should return at
least 1 document
-- 
View this message in context: http://www.nabble.com/Why-Lucene-phrase-searching-fail--tp23253549p23268494.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39985-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 08:19:28 2009
Return-Path: <java-user-return-39985-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40343 invoked from network); 28 Apr 2009 08:19:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 08:19:28 -0000
Received: (qmail 6954 invoked by uid 500); 28 Apr 2009 08:19:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6920 invoked by uid 500); 28 Apr 2009 08:19:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6910 invoked by uid 99); 28 Apr 2009 08:19:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 08:19:25 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jdevroed@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 08:19:16 +0000
Received: by fxm2 with SMTP id 2so438707fxm.5
        for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 01:18:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=azs8yJfdDV+FoRJuZY9oWIK64vLmXXrDEnAioQgC+hI=;
        b=TBaiVQPjCRZcoMo8Wgh++tFni6WTzeXYkAiYUoYptPelGrcX9RrPMhSfwsvaHTJoAa
         NrWayrgAiEKnYK1bnthAlbTwbjp7qntcE0YCvHMT1RorDZzOG7nSHvyHOrWrYPnp0ljU
         ESrkfPxRAS6aEd4PKNks1l6+mk3V371QYE+8k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=d8lCuGeHwsw1PfMP9hHCaApK1Env2ZrvnM+axVCUIGfqq0f0cPuUp3pKkrTfdvEBRp
         0IcDVsAcsERUyIhyLoJfWNVvL4kenXjZNaf6xyoIfrOFBaui3Y7HAP34amvgzCac0V4b
         wfVhGtZZe2r/x6YnwezNMCrYMjvZ8KFEXjErk=
MIME-Version: 1.0
Received: by 10.204.116.139 with SMTP id m11mr6198490bkq.101.1240906735688; 
	Tue, 28 Apr 2009 01:18:55 -0700 (PDT)
Date: Tue, 28 Apr 2009 10:18:55 +0200
Message-ID: <3ba836b80904280118p50ceb88cn61708152bb22994@mail.gmail.com>
Subject: Getting matched words for PhraseQuery or SpanNearQuery
From: Jaco <jdevroed@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c5a2442e1e940468991d4f
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5a2442e1e940468991d4f
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hello,

I am pretty new to the Lucene API, and there's something I can't figure out
from the docs and from the mailing list archives. I hope somebody can point
me into the right direction. Here's my case: for text analysis purposes I am
doing PhraseQueries and SpanNearQueries. Using the highlighter, I can
extract text snippets with matching words marked.

What I really am looking for is to extract information on each match to the
query, if possible including position information in the text. For example,
if the text I am searching in is [a b c a d e f a b], and my query is [a b],
then I want to know where the words [a b] were matched together in the text
due to the use of the PhraseQuery/SpanNearQuery ([a b] will get me two
occurrences in the documents text).

As far as I can find out, the highlighter is capable of marking the
individual words causing the hit, but it can't show me which words together
form one 'hit' to the search text. Is there a way to do this with the Lucene
API? Any help would be appreciated!

Thanks in advance, bye,

Jaco.

PS this is a follow up for this thread in the Solr user mailing list:
http://markmail.org/thread/cokya3rsmzsjocdh

--001636c5a2442e1e940468991d4f--

From java-user-return-39986-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 08:22:49 2009
Return-Path: <java-user-return-39986-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41176 invoked from network); 28 Apr 2009 08:22:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 08:22:46 -0000
Received: (qmail 12034 invoked by uid 500); 28 Apr 2009 08:22:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11939 invoked by uid 500); 28 Apr 2009 08:22:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11694 invoked by uid 99); 28 Apr 2009 08:22:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 08:22:45 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [74.125.46.31] (HELO yw-out-2324.google.com) (74.125.46.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 08:22:37 +0000
Received: by yw-out-2324.google.com with SMTP id 2so227722ywt.5
        for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 01:22:15 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.122.7 with SMTP id z7mr10562910ybm.140.1240906935691; Tue, 
	28 Apr 2009 01:22:15 -0700 (PDT)
In-Reply-To: <49F6412F.3000904@nuix.com>
References: <49F6412F.3000904@nuix.com>
Date: Tue, 28 Apr 2009 04:22:15 -0400
Message-ID: <9ac0c6aa0904280122q47cbd7c8y95de702eb15924e8@mail.gmail.com>
Subject: Re: ArrayIndexOutOfBoundsException from TermInfosReader.get (2.3.2)
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

This doesn't ring a bell (ie sounds like something new).

It's quite spooky.  Any hints on what led to this?  It looks like,
somehow, enumOffset is that massive negative number (-1030685), in
this code from TermInfosReader.java:

    // optimize sequential access: first try scanning cached enum w/o seeki=
ng
    SegmentTermEnum enumerator =3D getEnum();
    if (enumerator.term() !=3D null                 // term is at or past c=
urrent
	&& ((enumerator.prev() !=3D null && term.compareTo(enumerator.prev())> 0)
	    || term.compareTo(enumerator.term()) >=3D 0)) {
      int enumOffset =3D (int)(enumerator.position/totalIndexInterval)+1;
      if (indexTerms.length =3D=3D enumOffset	  // but before end of block
	  || term.compareTo(indexTerms[enumOffset]) < 0)
	return scanEnum(term);			  // no need to seek
    }

The only way I can see enumOffset becoming negative is if the
indexInterval stored in the tis file was negative, which is weird.

Can your user run CheckIndex on this index?  Can they also separately
run their app with assertions enabled for org.apache.lucene.*?  (This
turns on more interesting checks).

Is this easily repeated?

Mike

On Mon, Apr 27, 2009 at 7:35 PM, Daniel Noll <daniel@nuix.com> wrote:
> Hi all.
>
> One of our users has seen an error like this:
>
>> java.lang.ArrayIndexOutOfBoundsException: -1030685
>> =A0 =A0 =A0 =A0at
>> org.apache.lucene.index.TermInfosReader.get(TermInfosReader.java:210)
>> =A0 =A0 =A0 =A0at
>> org.apache.lucene.index.SegmentTermDocs.seek(SegmentTermDocs.java:54)
>> =A0 =A0 =A0 =A0at
>> org.apache.lucene.index.IndexReader.termDocs(IndexReader.java:668)
>> =A0 =A0 =A0 =A0at
>> org.apache.lucene.search.TermQuery$TermWeight.scorer(TermQuery.java:64)
>> =A0 =A0 =A0 =A0at
>> org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:143)
>> =A0 =A0 =A0 =A0at
>> org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:113)
>> =A0 =A0 =A0 =A0at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:10=
0)
>> =A0 =A0 =A0 =A0at org.apache.lucene.search.Hits.<init>(Hits.java:67)
>
> I believe this was from Lucene 2.3.2.
>
> I can't see any records on JIRA related to this being fixed, and the prob=
lem
> hasn't been reproduced locally so it isn't easy to try 2.4.1 and see if i=
t
> has been fixed, but was there a bug along these lines in 2.3.2?
>
> Daniel
>
>
> --
> Daniel Noll =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Forens=
ic and eDiscovery Software
> Senior Developer =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0The world's most advanced
> Nuix =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A0 =A0 =A0 =A0email data analysis
> http://nuix.com/ =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0and eDiscovery software
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39987-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 08:31:22 2009
Return-Path: <java-user-return-39987-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44704 invoked from network); 28 Apr 2009 08:31:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 08:31:22 -0000
Received: (qmail 34514 invoked by uid 500); 28 Apr 2009 08:31:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34471 invoked by uid 500); 28 Apr 2009 08:31:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34461 invoked by uid 99); 28 Apr 2009 08:31:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 08:31:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.218.179 as permitted sender)
Received: from [209.85.218.179] (HELO mail-bw0-f179.google.com) (209.85.218.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 08:31:11 +0000
Received: by bwz27 with SMTP id 27so446404bwz.5
        for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 01:30:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=mwv+zl6q1806u/5FaF7Q11tuegc4gTGVt22Rf6NPNmY=;
        b=INpJ8Br0bssuZlRH3N0dAb+657WDuQVyAogzbxcM/GZNuEJuS8sY+dLWO4SZ7KrL3h
         K93bL4iexRduwoCZHg0FquKsivzyKYuY6PqoajefGFG84xv05OBP1dPvjuZmZxvLXstf
         l+LLyoeki0TwXIMQaHkl26iQYRg4cb1EBIEmM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=pklNQAsAyO7/7i18w6zdGor0e2/LkuEW8CY3QQggvRkGKMLHu1tcGtXoQLKoFT4Yub
         NfhFlSlDTGPkzZr5MZG73t+dLmFcw2uT5rgKWksKNvuIu802++BY97bkjiWdsp441cx2
         mzqcOFrTCJDlx6cVPnDBwQQB2xM0el8JTxL1M=
MIME-Version: 1.0
Received: by 10.204.77.67 with SMTP id f3mr6250508bkk.75.1240907450841; Tue, 
	28 Apr 2009 01:30:50 -0700 (PDT)
In-Reply-To: <23268494.post@talk.nabble.com>
References: <23253549.post@talk.nabble.com> <23268494.post@talk.nabble.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Tue, 28 Apr 2009 09:30:35 +0100
Message-ID: <8c4e68610904280130j32687b0cl7f710eaf678bf188@mail.gmail.com>
Subject: Re: Why Lucene phrase searching fail?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Looks fine to me, but you haven't told us what analyzers you are
using, whether you are using omitTf, suggested as a possibility by
Koji, or anything else.

Answer Koji, read the "Why am I getting no hits / incorrect hits?"
section of the FAQ and if still stuck, post here the simplest possible
self contained example program that demonstrates the problem.  And
tell us what version of lucene you are using.


--
Ian.

On Tue, Apr 28, 2009 at 2:55 AM, blazingwolf7 <blazingwolf7@gmail.com> wrote:
>
> When i print out the query, it will be like this:
> (url:"terror india"^2.0 anchor:"terror india"^0.0 content:"terror india"
> title:"terror india"^1.5 host:"terror india"^2.0 site:"terror india"^10.0)
>
> I dont understand at all, only phrase query got problem, even my sloop has
> no problem at all. I have exact match in my content, so it should return at
> least 1 document
> --

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39988-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 12:22:15 2009
Return-Path: <java-user-return-39988-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44923 invoked from network); 28 Apr 2009 12:22:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 12:22:15 -0000
Received: (qmail 95986 invoked by uid 500); 28 Apr 2009 12:22:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95909 invoked by uid 500); 28 Apr 2009 12:22:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95894 invoked by uid 99); 28 Apr 2009 12:22:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 12:22:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.198.227 as permitted sender)
Received: from [209.85.198.227] (HELO rv-out-0506.google.com) (209.85.198.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 12:22:02 +0000
Received: by rv-out-0506.google.com with SMTP id l9so353156rvb.5
        for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 05:21:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=hflpI9mPK/imv2n23lOmamea21sZLTT74+ounbiT8k4=;
        b=Z8B7sXNhUBAttqbYRF6yATAX/HIUpnTYQehmRQT9weXEvZd8JHvB/eKb80dlZvEAtE
         57jnrMzPH2J9MStP6c9D4Vd0RGqQzOFvqe/UeP4bhBbxla4P9SgyDiSnnebCC6Jz7fnE
         z/gOQoBwmUuEd0GnL8zSK9iBge2ap1geT6VE0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=p21cIutEkGu86/ez0nA1HHr/I6299OmyEETE8fjdVZA2nf2J7cdCLBBPTzeXflvLXy
         3lzWkSMYuLmLNRuYT8W+q1mkoD7em/7aUTWSTG/t5NVKi8wrSFCmvzSw3WHPONLS1/WP
         MR4nOF9hmb0z95ulXK3Iui/zRawpgc4OfjEpA=
Received: by 10.114.170.2 with SMTP id s2mr3084476wae.5.1240921301350;
        Tue, 28 Apr 2009 05:21:41 -0700 (PDT)
Received: from ?192.168.1.120? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id z20sm19253878pod.19.2009.04.28.05.21.39
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 28 Apr 2009 05:21:40 -0700 (PDT)
Message-ID: <49F6F4D4.6050200@gmail.com>
Date: Tue, 28 Apr 2009 08:21:40 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.21 (X11/20090409)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Getting matched words for PhraseQuery or SpanNearQuery
References: <3ba836b80904280118p50ceb88cn61708152bb22994@mail.gmail.com>
In-Reply-To: <3ba836b80904280118p50ceb88cn61708152bb22994@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

The Span Highlighter gets positions by attempting to convert a standard 
Lucne Query to a SpanQuery approximate, and then calling getSpans on the 
span query to find start end positions (getSpans is called against a 
fast single document MemoryIndex). You might check out 
WeightedSpanTermExtractor in the Highlighter package. It may be a bit 
hard to navigate for a new user though.

- Mark

Jaco wrote:
> Hello,
>
> I am pretty new to the Lucene API, and there's something I can't figure out
> from the docs and from the mailing list archives. I hope somebody can point
> me into the right direction. Here's my case: for text analysis purposes I am
> doing PhraseQueries and SpanNearQueries. Using the highlighter, I can
> extract text snippets with matching words marked.
>
> What I really am looking for is to extract information on each match to the
> query, if possible including position information in the text. For example,
> if the text I am searching in is [a b c a d e f a b], and my query is [a b],
> then I want to know where the words [a b] were matched together in the text
> due to the use of the PhraseQuery/SpanNearQuery ([a b] will get me two
> occurrences in the documents text).
>
> As far as I can find out, the highlighter is capable of marking the
> individual words causing the hit, but it can't show me which words together
> form one 'hit' to the search text. Is there a way to do this with the Lucene
> API? Any help would be appreciated!
>
> Thanks in advance, bye,
>
> Jaco.
>
> PS this is a follow up for this thread in the Solr user mailing list:
> http://markmail.org/thread/cokya3rsmzsjocdh
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39989-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 12:26:49 2009
Return-Path: <java-user-return-39989-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46613 invoked from network); 28 Apr 2009 12:26:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 12:26:48 -0000
Received: (qmail 6369 invoked by uid 500); 28 Apr 2009 12:26:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6308 invoked by uid 500); 28 Apr 2009 12:26:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6298 invoked by uid 99); 28 Apr 2009 12:26:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 12:26:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [67.195.8.116] (HELO web110511.mail.gq1.yahoo.com) (67.195.8.116)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 28 Apr 2009 12:26:36 +0000
Received: (qmail 40576 invoked by uid 60001); 28 Apr 2009 12:26:15 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1240921575; bh=PINhnbsxcvYKGQjHBNpMiXw84xioubQEymWn894HMFE=; h=Message-ID:Received:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=U3j2so1fgXXAXV/48MngXekSCLHKzDsj+gR0nWcry0PGxHl6yYLsbgeBXRVvYfW7utjt/K2/Nn2Vrv6kawxJXxyBfJfIrY3HMYhuBaTQEzxDAZK3vavhruqzYcuHY9n5Qpjgq7t4NlyrGGliImApfBQCuRVD+ZynTuQqiwvHR+s=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:Received:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=d6+lwlnjxIlSEBLDfaStPPWb/3+S8BVfpOqQIMAYzRkeZpQovyiTp3axL0Y/Xn6MZ0Wgt7IRo+tYiU4+CKy9MKGDIGpGskL4UnP7RhUHPYMrECXRiIX19d5wOSE9s/vHiGMrtSyeig2S1uYOHYgOTtc64eGU/LMKqgF2CXQD8Sg=;
Message-ID: <63717.39355.qm@web110511.mail.gq1.yahoo.com>
Received: from [59.188.246.38] by web110511.mail.gq1.yahoo.com via HTTP; Tue, 28 Apr 2009 20:26:15 CST
Date: Tue, 28 Apr 2009 20:26:15 +0800 (CST)
From: CM Wong <cmwong2@yahoo.com>
Subject: NOT_ANALYZED field
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

In my simple program I have an ID field which is NON_ANALYZED. I find that if
the field contains only numeric characters (e.g. id="00023"), I can
successsfully search for the doc. (search for "id:00023")

But if the field contains non-numeric characates (e.g. id="nJK00023") then the
search returns nothing. (search for "id:nJK00023")

Is there anything wrong with my program?

Regards,
CM


Send instant messages to your online friends http://uk.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39990-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 12:31:50 2009
Return-Path: <java-user-return-39990-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50166 invoked from network); 28 Apr 2009 12:31:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 12:31:50 -0000
Received: (qmail 26297 invoked by uid 500); 28 Apr 2009 12:31:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26229 invoked by uid 500); 28 Apr 2009 12:31:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26215 invoked by uid 99); 28 Apr 2009 12:31:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 12:31:48 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 12:31:41 +0000
Received: by qw-out-2122.google.com with SMTP id 5so451063qwd.53
        for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 05:31:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=xDIaEb8+GlPaVvQotTGhSddRj/VJ9nof/O5Elmecm8k=;
        b=ejReyfERb2dsMYzyWxOX+0zQeeYdiVu7KJoEFk4455ze2p7S+ETY/fYPgKTlkMYYVS
         hn2jkDggBm+Mj8fJwj70yi4uAO/whb+SD8RfBerYlmGlHhzjHYNYVidym4KzLBvwJv/k
         hONTUpNBCaaq6R5/CvFL6cXGMuuGc9C1TC9HE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=PhMxcMFEHPWGbf7uklasxN2RPZ2EMDX+h/2AjJ+jV2mQyH36DKHsRcL0E4BIrtYwvx
         6kz0tbGYNPp/03oig5quhVpUcIdjkadmaoTsdffv9pFz+4RncSrUdkP/zHTTbXRsbVu7
         +3g98KxPaJmZi0Tmh3APEt45uVGPP+NBJH/sc=
MIME-Version: 1.0
Received: by 10.220.97.137 with SMTP id l9mr12902132vcn.98.1240921880225; Tue, 
	28 Apr 2009 05:31:20 -0700 (PDT)
In-Reply-To: <63717.39355.qm@web110511.mail.gq1.yahoo.com>
References: <63717.39355.qm@web110511.mail.gq1.yahoo.com>
Date: Tue, 28 Apr 2009 08:31:20 -0400
Message-ID: <359a92830904280531l53d12c1akcb8571693819a7e8@mail.gmail.com>
Subject: Re: NOT_ANALYZED field
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6464ec0dd69e104689ca3d9
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6464ec0dd69e104689ca3d9
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Well, you haven't shown us your program, so it's hard to tell<G>....

But my first uninformed guess would be that the case of your search
doesn't exactly match the case you indexed when you add letters
to your IDs.

We need to see the search code particularly, including the
analyzers you use (a snippet would do to start). The index code
would be useful too.

Best
Erick

On Tue, Apr 28, 2009 at 8:26 AM, CM Wong <cmwong2@yahoo.com> wrote:

>
> Hi,
>
> In my simple program I have an ID field which is NON_ANALYZED. I find that
> if
> the field contains only numeric characters (e.g. id="00023"), I can
> successsfully search for the doc. (search for "id:00023")
>
> But if the field contains non-numeric characates (e.g. id="nJK00023") then
> the
> search returns nothing. (search for "id:nJK00023")
>
> Is there anything wrong with my program?
>
> Regards,
> CM
>
>
> Send instant messages to your online friends http://uk.messenger.yahoo.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6464ec0dd69e104689ca3d9--

From java-user-return-39991-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 12:33:32 2009
Return-Path: <java-user-return-39991-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50819 invoked from network); 28 Apr 2009 12:33:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 12:33:32 -0000
Received: (qmail 31325 invoked by uid 500); 28 Apr 2009 12:33:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31297 invoked by uid 500); 28 Apr 2009 12:33:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 54169 invoked by uid 99); 28 Apr 2009 11:53:39 -0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
From: Mike Streeton <mike.streeton@connexica.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Tue, 28 Apr 2009 12:53:01 +0100
Subject: Read past EOF
Thread-Topic: Read past EOF
Thread-Index: AcnH9+H3CNz6XckXSRWwn9YubNCgcQ==
Message-ID: <DFE6314F5CE91344A74BD2AA612C93B69EF4ECB877@biscuit.ARDENTIASEARCH.local>
Accept-Language: en-US, en-GB
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, en-GB
Content-Type: multipart/alternative;
	boundary="_000_DFE6314F5CE91344A74BD2AA612C93B69EF4ECB877biscuitARDENT_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_DFE6314F5CE91344A74BD2AA612C93B69EF4ECB877biscuitARDENT_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

I have an index that works fine on Lucene 2.3.2 but fails to open in 2.4.1,=
 it always fails with an Read past EOF. The index does contain some field n=
ames with german umlaut characters in

Any ideas?

Many Thanks

Mike

CheckIndex v2.3.2


NOTE: testing will be more thorough if you run java with '-ea:org.apache.lu=
cene', so assertions are enabled

Opening index @ C:/index/german

Segments file=3Dsegments_9 numSegments=3D1 version=3DFORMAT_SHARED_DOC_STOR=
E [Lucene 2.3]
  1 of 1: name=3D_3 docCount=3D235535
    compound=3Dtrue
    numFiles=3D1
    size (MB)=3D301.684
    no deletions
    test: open reader.........OK
    test: fields, norms.......OK [70 fields]
    test: terms, freq, prox...OK [1475862 terms; 25448796 terms/docs pairs;=
 28642994 tokens]
    test: stored fields.......OK [13560464 total field count; avg 57.573 fi=
elds per doc]
    test: term vectors........OK [0 total vector count; avg 0 term/freq vec=
tor fields per doc]

No problems were detected with this index.

CheckIndex v2.4.1


NOTE: testing will be more thorough if you run java with '-ea:org.apache.lu=
cene...', so assertions are enabled

Opening index @ C:/index/german

Segments file=3Dsegments_9 numSegments=3D1 version=3DFORMAT_SHARED_DOC_STOR=
E [Lucene 2.3]
  1 of 1: name=3D_3 docCount=3D235535
    compound=3Dtrue
    hasProx=3Dtrue
    numFiles=3D1
    size (MB)=3D301.684
    no deletions
    test: open reader.........FAILED
    WARNING: fixIndex() would remove reference to this segment; full except=
ion:
java.io.IOException: read past EOF
      at org.apache.lucene.store.BufferedIndexInput.refill(Unknown Source)
      at org.apache.lucene.store.BufferedIndexInput.readBytes(Unknown Sourc=
e)
      at org.apache.lucene.store.BufferedIndexInput.readBytes(Unknown Sourc=
e)
      at org.apache.lucene.store.IndexInput.readString(Unknown Source)
      at org.apache.lucene.index.FieldInfos.read(Unknown Source)
      at org.apache.lucene.index.FieldInfos.<init>(Unknown Source)
      at org.apache.lucene.index.SegmentReader.initialize(Unknown Source)
      at org.apache.lucene.index.SegmentReader.get(Unknown Source)
      at org.apache.lucene.index.SegmentReader.get(Unknown Source)
      at org.apache.lucene.index.CheckIndex.checkIndex(Unknown Source)
      at org.apache.lucene.index.CheckIndex.main(Unknown Source)

WARNING: 1 broken segments (containing 235535 documents) detected
WARNING: would write new segments file, and 235535 documents would be lost,=
 if -fix were specified


--_000_DFE6314F5CE91344A74BD2AA612C93B69EF4ECB877biscuitARDENT_--

From java-user-return-39992-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 12:34:24 2009
Return-Path: <java-user-return-39992-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51157 invoked from network); 28 Apr 2009 12:34:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 12:34:24 -0000
Received: (qmail 36449 invoked by uid 500); 28 Apr 2009 12:34:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36403 invoked by uid 500); 28 Apr 2009 12:34:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36393 invoked by uid 99); 28 Apr 2009 12:34:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 12:34:21 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [80.190.230.99] (HELO mail.troja.net) (80.190.230.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 12:34:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id C81AD51C96
	for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 14:33:50 +0200 (CEST)
Received: from mail.troja.net ([127.0.0.1])
 by localhost (cyca.troja.net [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 32516-05 for <java-user@lucene.apache.org>;
 Tue, 28 Apr 2009 14:33:49 +0200 (CEST)
Received: from VEGA (unknown [134.102.249.78])
	(using SSLv3 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTP id 0E0BD51C41
	for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 14:33:49 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <63717.39355.qm@web110511.mail.gq1.yahoo.com>
Subject: RE: NOT_ANALYZED field
Date: Tue, 28 Apr 2009 14:33:48 +0200
Message-ID: <7A535703E5C244BD9A3BC2664F90EAA3@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <63717.39355.qm@web110511.mail.gq1.yahoo.com>
Thread-Index: AcnH/JrTeDoL9VdgTv+Fh3xu0tkuoQAAFgVA
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

That is normal. Fields that are not analyzed are indexed as single tokens.
The anaylzer does not only tokenize the text, it also transforms it (e.g. to
lower case). If you enter your search using the query parser, the entered
search terms are analyzed! And for full text engines, the analyzer for
querying and searching must be the same. So it is normal, that your search
will not return results (in your example, it would work, if the id would be
indexed in lower case, because the analyzer on top of your query string
lowercases the term).

So not-analyzed fields should be directly queried using TermQuery(....),
e.g. to find the document with an untokenized id.

If you really want to use query parser, think about PerFieldAnalyzerWrapper
using KeywordTokenizer for the id field.

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: CM Wong [mailto:cmwong2@yahoo.com]
> Sent: Tuesday, April 28, 2009 2:26 PM
> To: java-user@lucene.apache.org
> Subject: NOT_ANALYZED field
> 
> 
> Hi,
> 
> In my simple program I have an ID field which is NON_ANALYZED. I find that
> if
> the field contains only numeric characters (e.g. id="00023"), I can
> successsfully search for the doc. (search for "id:00023")
> 
> But if the field contains non-numeric characates (e.g. id="nJK00023") then
> the
> search returns nothing. (search for "id:nJK00023")
> 
> Is there anything wrong with my program?
> 
> Regards,
> CM
> 
> 
> Send instant messages to your online friends http://uk.messenger.yahoo.com
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39993-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 12:45:29 2009
Return-Path: <java-user-return-39993-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55788 invoked from network); 28 Apr 2009 12:45:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 12:45:29 -0000
Received: (qmail 62513 invoked by uid 500); 28 Apr 2009 12:45:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62462 invoked by uid 500); 28 Apr 2009 12:45:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 47397 invoked by uid 99); 28 Apr 2009 12:37:34 -0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
From: Mike Streeton <mike.streeton@connexica.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Tue, 28 Apr 2009 13:37:05 +0100
Subject: RE: Read past EOF
Thread-Topic: Read past EOF
Thread-Index: AcnH9+H3CNz6XckXSRWwn9YubNCgcQABfZpw
Message-ID: <DFE6314F5CE91344A74BD2AA612C93B69EF4ECB886@biscuit.ARDENTIASEARCH.local>
References: <DFE6314F5CE91344A74BD2AA612C93B69EF4ECB877@biscuit.ARDENTIASEARCH.local>
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B69EF4ECB877@biscuit.ARDENTIASEARCH.local>
Accept-Language: en-US, en-GB
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, en-GB
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

An update, I have managed to get it to not fail by debugging and changing t=
he value of org.apache.lucene.store.InputIndex.preUTF8Strings =3D true. The=
 value is always false when it fails.

Mike=20

-----Original Message-----
From: Mike Streeton [mailto:mike.streeton@connexica.com]=20
Sent: 28 April 2009 12:53
To: java-user@lucene.apache.org
Subject: Read past EOF

I have an index that works fine on Lucene 2.3.2 but fails to open in 2.4.1,=
 it always fails with an Read past EOF. The index does contain some field n=
ames with german umlaut characters in

Any ideas?

Many Thanks

Mike

CheckIndex v2.3.2


NOTE: testing will be more thorough if you run java with '-ea:org.apache.lu=
cene', so assertions are enabled

Opening index @ C:/index/german

Segments file=3Dsegments_9 numSegments=3D1 version=3DFORMAT_SHARED_DOC_STOR=
E [Lucene 2.3]
  1 of 1: name=3D_3 docCount=3D235535
    compound=3Dtrue
    numFiles=3D1
    size (MB)=3D301.684
    no deletions
    test: open reader.........OK
    test: fields, norms.......OK [70 fields]
    test: terms, freq, prox...OK [1475862 terms; 25448796 terms/docs pairs;=
 28642994 tokens]
    test: stored fields.......OK [13560464 total field count; avg 57.573 fi=
elds per doc]
    test: term vectors........OK [0 total vector count; avg 0 term/freq vec=
tor fields per doc]

No problems were detected with this index.

CheckIndex v2.4.1


NOTE: testing will be more thorough if you run java with '-ea:org.apache.lu=
cene...', so assertions are enabled

Opening index @ C:/index/german

Segments file=3Dsegments_9 numSegments=3D1 version=3DFORMAT_SHARED_DOC_STOR=
E [Lucene 2.3]
  1 of 1: name=3D_3 docCount=3D235535
    compound=3Dtrue
    hasProx=3Dtrue
    numFiles=3D1
    size (MB)=3D301.684
    no deletions
    test: open reader.........FAILED
    WARNING: fixIndex() would remove reference to this segment; full except=
ion:
java.io.IOException: read past EOF
      at org.apache.lucene.store.BufferedIndexInput.refill(Unknown Source)
      at org.apache.lucene.store.BufferedIndexInput.readBytes(Unknown Sourc=
e)
      at org.apache.lucene.store.BufferedIndexInput.readBytes(Unknown Sourc=
e)
      at org.apache.lucene.store.IndexInput.readString(Unknown Source)
      at org.apache.lucene.index.FieldInfos.read(Unknown Source)
      at org.apache.lucene.index.FieldInfos.<init>(Unknown Source)
      at org.apache.lucene.index.SegmentReader.initialize(Unknown Source)
      at org.apache.lucene.index.SegmentReader.get(Unknown Source)
      at org.apache.lucene.index.SegmentReader.get(Unknown Source)
      at org.apache.lucene.index.CheckIndex.checkIndex(Unknown Source)
      at org.apache.lucene.index.CheckIndex.main(Unknown Source)

WARNING: 1 broken segments (containing 235535 documents) detected
WARNING: would write new segments file, and 235535 documents would be lost,=
 if -fix were specified


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39994-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 14:15:50 2009
Return-Path: <java-user-return-39994-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99642 invoked from network); 28 Apr 2009 14:15:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 14:15:50 -0000
Received: (qmail 47737 invoked by uid 500); 28 Apr 2009 14:15:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47705 invoked by uid 500); 28 Apr 2009 14:15:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47695 invoked by uid 99); 28 Apr 2009 14:15:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 14:15:47 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 14:15:38 +0000
Received: by qw-out-2122.google.com with SMTP id 5so498895qwd.53
        for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 07:15:16 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.205.13 with SMTP id c13mr12339447ybg.101.1240928116054; 
	Tue, 28 Apr 2009 07:15:16 -0700 (PDT)
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B69EF4ECB877@biscuit.ARDENTIASEARCH.local>
References: <AcnH9+H3CNz6XckXSRWwn9YubNCgcQ==>
	 <DFE6314F5CE91344A74BD2AA612C93B69EF4ECB877@biscuit.ARDENTIASEARCH.local>
Date: Tue, 28 Apr 2009 10:15:16 -0400
Message-ID: <9ac0c6aa0904280715m6f762016id7c2de7acb627d8@mail.gmail.com>
Subject: Re: Read past EOF
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Ugh, indeed FieldInfos fails to properly read 2.3.x indices if the
field name contains non-ascii characters.  I'll open an issue, make a
test case and work out a fix.  Hmm.

Thanks for raising this!

Mike

On Tue, Apr 28, 2009 at 7:53 AM, Mike Streeton
<mike.streeton@connexica.com> wrote:
> I have an index that works fine on Lucene 2.3.2 but fails to open in 2.4.=
1, it always fails with an Read past EOF. The index does contain some field=
 names with german umlaut characters in
>
> Any ideas?
>
> Many Thanks
>
> Mike
>
> CheckIndex v2.3.2
>
>
> NOTE: testing will be more thorough if you run java with '-ea:org.apache.=
lucene', so assertions are enabled
>
> Opening index @ C:/index/german
>
> Segments file=3Dsegments_9 numSegments=3D1 version=3DFORMAT_SHARED_DOC_ST=
ORE [Lucene 2.3]
> =A01 of 1: name=3D_3 docCount=3D235535
> =A0 =A0compound=3Dtrue
> =A0 =A0numFiles=3D1
> =A0 =A0size (MB)=3D301.684
> =A0 =A0no deletions
> =A0 =A0test: open reader.........OK
> =A0 =A0test: fields, norms.......OK [70 fields]
> =A0 =A0test: terms, freq, prox...OK [1475862 terms; 25448796 terms/docs p=
airs; 28642994 tokens]
> =A0 =A0test: stored fields.......OK [13560464 total field count; avg 57.5=
73 fields per doc]
> =A0 =A0test: term vectors........OK [0 total vector count; avg 0 term/fre=
q vector fields per doc]
>
> No problems were detected with this index.
>
> CheckIndex v2.4.1
>
>
> NOTE: testing will be more thorough if you run java with '-ea:org.apache.=
lucene...', so assertions are enabled
>
> Opening index @ C:/index/german
>
> Segments file=3Dsegments_9 numSegments=3D1 version=3DFORMAT_SHARED_DOC_ST=
ORE [Lucene 2.3]
> =A01 of 1: name=3D_3 docCount=3D235535
> =A0 =A0compound=3Dtrue
> =A0 =A0hasProx=3Dtrue
> =A0 =A0numFiles=3D1
> =A0 =A0size (MB)=3D301.684
> =A0 =A0no deletions
> =A0 =A0test: open reader.........FAILED
> =A0 =A0WARNING: fixIndex() would remove reference to this segment; full e=
xception:
> java.io.IOException: read past EOF
> =A0 =A0 =A0at org.apache.lucene.store.BufferedIndexInput.refill(Unknown S=
ource)
> =A0 =A0 =A0at org.apache.lucene.store.BufferedIndexInput.readBytes(Unknow=
n Source)
> =A0 =A0 =A0at org.apache.lucene.store.BufferedIndexInput.readBytes(Unknow=
n Source)
> =A0 =A0 =A0at org.apache.lucene.store.IndexInput.readString(Unknown Sourc=
e)
> =A0 =A0 =A0at org.apache.lucene.index.FieldInfos.read(Unknown Source)
> =A0 =A0 =A0at org.apache.lucene.index.FieldInfos.<init>(Unknown Source)
> =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.initialize(Unknown So=
urce)
> =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.get(Unknown Source)
> =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.get(Unknown Source)
> =A0 =A0 =A0at org.apache.lucene.index.CheckIndex.checkIndex(Unknown Sourc=
e)
> =A0 =A0 =A0at org.apache.lucene.index.CheckIndex.main(Unknown Source)
>
> WARNING: 1 broken segments (containing 235535 documents) detected
> WARNING: would write new segments file, and 235535 documents would be los=
t, if -fix were specified
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39995-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 14:31:30 2009
Return-Path: <java-user-return-39995-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8935 invoked from network); 28 Apr 2009 14:31:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 14:31:30 -0000
Received: (qmail 79314 invoked by uid 500); 28 Apr 2009 14:31:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79256 invoked by uid 500); 28 Apr 2009 14:31:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79246 invoked by uid 99); 28 Apr 2009 14:31:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 14:31:27 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of cdoronc@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 14:31:19 +0000
Received: by ewy27 with SMTP id 27so646741ewy.5
        for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 07:30:59 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=9r8A5QugR6uK4+9m1kzOyTCh9tPg4U0iiy9fvNm8Asc=;
        b=R6zosZoxzkdEMIOo8uVxdm3bOrO35sCwmwf+CAMJeLP/Y0VA5W8HSdiHjkxdj2PteN
         AjITCBrPLSUiECTN8wZvoodPa4C/+r0y74w0EwVtF62WPPyDJsCrfLziFBEkHX4DkZnR
         gHo8IrRexo4Sl+RWidnWUBHxBHv8FXpBnSpQM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=S79mw85dTJX24lMlzYhXa7AcqfKky1ESHiW8tsLSc+A4uUqiE30mFpSBNqyGe9mvgE
         3F34c2gJhATCssNTMnVElFG0VxPoPBkh4bIaYh3rI+WjGtR59Dhje1d0fr5PsjZzGis5
         /Cq2VyN0fWwxT8cU5tFToEZtR89rkPV2SVfSQ=
MIME-Version: 1.0
Received: by 10.210.58.17 with SMTP id g17mr6327332eba.57.1240929058904; Tue, 
	28 Apr 2009 07:30:58 -0700 (PDT)
In-Reply-To: <aed435370904270953h54f3e7dam759829d954e171aa@mail.gmail.com>
References: <aed435370904270953h54f3e7dam759829d954e171aa@mail.gmail.com>
Date: Tue, 28 Apr 2009 17:30:58 +0300
Message-ID: <e05f0fd10904280730k2b9769cfg25f60f6a56e58c1b@mail.gmail.com>
Subject: Re: Searcher#setSimilarity clarifications
From: Doron Cohen <cdoronc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c0ecabf5b6304689e4f20
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c0ecabf5b6304689e4f20
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Searcher is quite light.
It is the index reader that is heavier.
So create a single index reader, for each of the similarities
to be use concurrently, create a searcher over that single
reader, set its similarity, and so on.

Doron

On Mon, Apr 27, 2009 at 7:53 PM, Rakesh Sinha <rakesh.usenet@gmail.com>wrote:

> I am looking into setting custom scoring sing Similarity
> (org.apache.lucene.search.Similarity) . Searcher has a method to set
> similarity as follows - searcher.setSimilarity(Similarity) and
> retrieve the same too. I am looking at a case where I can have just
> one Searcher instance and use different similarities for different
> queries (since searcher is multi-threaded ).
>
> results = searcher.search( similarity, "myfield:mysearchstring" );
>
> and be ensured that the right similarity is applied for the right
> fields to be searched for.  Right now - it would go along the lines of
> searcher.setSimilarity(Similarity)  and then followed by the
> searcher.search ( .. ) so I cannot do concurrent searches (unless they
> are on different searcher instances altogether). Any suggestions
> regarding this ? Thanks.
>

--0015174c0ecabf5b6304689e4f20--

From java-user-return-39996-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 19:36:55 2009
Return-Path: <java-user-return-39996-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75683 invoked from network); 28 Apr 2009 19:36:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 19:36:55 -0000
Received: (qmail 92141 invoked by uid 500); 28 Apr 2009 19:36:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92099 invoked by uid 500); 28 Apr 2009 19:36:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92036 invoked by uid 99); 28 Apr 2009 19:36:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 19:36:49 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jdevroed@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 19:36:40 +0000
Received: by ey-out-2122.google.com with SMTP id 22so197710eye.53
        for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 12:36:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=szCE37tOos2Eg8H32S/XnA9QulxGq3M1szDeTMQsPG8=;
        b=bOU7zwGsMiFyDyNRbd0fgVF6YNv8+Df9M+pDNL26dExj4dJ+jRKG+DRV/Tvtn85DzM
         jjwZlXF1fHGt4h9OFVAFzu/uULEPt0tWV+DlqOM8tTzBwcHQE0a5AsMXbqv2QEQa1R/s
         N0x8jOlYWpABQykiM/p0vbyKN6YmG33a/CBrA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=AmeadwK4F7k/nsVYhVZHtRVwA+1E6J5Nnmao/QwRCBSaZv22VQg18jM0jNgw/VoBL1
         bqBZgROX61AbCPi19S4tvgHVkn5o8cIxZMxTFhvuYgl4KbEaO8/7xePy74fy1DmH8LE1
         BYxlHGEpHUCCh3sneZLZ31f9jfIqOSdXkHZhA=
MIME-Version: 1.0
Received: by 10.216.45.73 with SMTP id o51mr974632web.10.1240947378257; Tue, 
	28 Apr 2009 12:36:18 -0700 (PDT)
In-Reply-To: <49F6F4D4.6050200@gmail.com>
References: <3ba836b80904280118p50ceb88cn61708152bb22994@mail.gmail.com>
	 <49F6F4D4.6050200@gmail.com>
Date: Tue, 28 Apr 2009 21:36:18 +0200
Message-ID: <3ba836b80904281236u43446421n97d344ee196c8e1f@mail.gmail.com>
Subject: Re: Getting matched words for PhraseQuery or SpanNearQuery
From: Jaco <jdevroed@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016364ef53caa805a0468a29394
X-Virus-Checked: Checked by ClamAV on apache.org

--0016364ef53caa805a0468a29394
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi Mark,

Thanks for that - after wading through some source code in the highlighter
package and reading more docs I managed to get out the info I needed by
getting the start and end token position of each span found and subsequently
getting the words back out of the TokenStream that I initially created.

Thanks again, bye,

Jaco.

2009/4/28 Mark Miller <markrmiller@gmail.com>

> The Span Highlighter gets positions by attempting to convert a standard
> Lucne Query to a SpanQuery approximate, and then calling getSpans on the
> span query to find start end positions (getSpans is called against a fast
> single document MemoryIndex). You might check out WeightedSpanTermExtractor
> in the Highlighter package. It may be a bit hard to navigate for a new user
> though.
>
> - Mark
>
>
> Jaco wrote:
>
>> Hello,
>>
>> I am pretty new to the Lucene API, and there's something I can't figure
>> out
>> from the docs and from the mailing list archives. I hope somebody can
>> point
>> me into the right direction. Here's my case: for text analysis purposes I
>> am
>> doing PhraseQueries and SpanNearQueries. Using the highlighter, I can
>> extract text snippets with matching words marked.
>>
>> What I really am looking for is to extract information on each match to
>> the
>> query, if possible including position information in the text. For
>> example,
>> if the text I am searching in is [a b c a d e f a b], and my query is [a
>> b],
>> then I want to know where the words [a b] were matched together in the
>> text
>> due to the use of the PhraseQuery/SpanNearQuery ([a b] will get me two
>> occurrences in the documents text).
>>
>> As far as I can find out, the highlighter is capable of marking the
>> individual words causing the hit, but it can't show me which words
>> together
>> form one 'hit' to the search text. Is there a way to do this with the
>> Lucene
>> API? Any help would be appreciated!
>>
>> Thanks in advance, bye,
>>
>> Jaco.
>>
>> PS this is a follow up for this thread in the Solr user mailing list:
>> http://markmail.org/thread/cokya3rsmzsjocdh
>>
>>
>>
>
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016364ef53caa805a0468a29394--

From java-user-return-39997-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 22:36:11 2009
Return-Path: <java-user-return-39997-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55460 invoked from network); 28 Apr 2009 22:36:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 22:36:11 -0000
Received: (qmail 32710 invoked by uid 500); 28 Apr 2009 22:36:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32624 invoked by uid 500); 28 Apr 2009 22:36:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32614 invoked by uid 99); 28 Apr 2009 22:36:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 22:36:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 22:36:01 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 3E48971C43C; Tue, 28 Apr 2009 15:35:40 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 3C44B71C3C4
	for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 15:35:40 -0700 (PDT)
Date: Tue, 28 Apr 2009 15:35:40 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Appropriate analyzer
In-Reply-To: <23166323.post@talk.nabble.com>
Message-ID: <Pine.LNX.4.64.0904281528510.30171@radix.cryptio.net>
References: <edd377170904211357g373089e8y9f0788a38b525618@mail.gmail.com>
 <23166323.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: try to use RegexQuery

Except that his input string is longer then the terms he wants to match 
on.  

It sounds like what you are looking for is essentially a simplified use 
case of the "longest matching sub-phrase" problem...
http://www.nabble.com/Dictionary-lookup-possibilities-to22977277.html#a23087470

...except that you have the special case where (unless you simplified your 
example) you only care about the "longest matching prefix"

you could write an anaylyser that splits the input on each character, and 
then concats it's offset

Input: abcdef
Output: a_1, b_2, c_3, d_4, e_5, f_6

...in which case you use that analyzer when indexing; but at query time 
you use that anlyzer to build a BooleanQuery (instead of a PhraseQuery 
like QueryParser would do by default) and now a search for "abcdef" will 
match "abcde" with a higher score then "abcd" but it won't match "bcdef" 
at all.

Out of curiousity: what's your specific use case?  I've never heard of 
anyone wanting to match on something character-by-character like this 
(usually it's the reverse: people want "abcd" to match "abcde")

: > Actually, what I need is next: search on a query string step-by-step,
: > trimming last char on each step. Small example:
: > 
: > In index we've: abc, abcdef, xyz
: > When search on abcdefgh the most relevant result should be abcdef, while
: > searching on abcde the best one is abc.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39998-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 22:44:15 2009
Return-Path: <java-user-return-39998-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57622 invoked from network); 28 Apr 2009 22:44:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 22:44:14 -0000
Received: (qmail 41719 invoked by uid 500); 28 Apr 2009 22:44:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41630 invoked by uid 500); 28 Apr 2009 22:44:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41620 invoked by uid 99); 28 Apr 2009 22:44:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 22:44:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 22:44:04 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id A7B0D71C530; Tue, 28 Apr 2009 15:43:43 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id A516D71C4D5
	for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 15:43:43 -0700 (PDT)
Date: Tue, 28 Apr 2009 15:43:43 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Proximity and Percentage match search in Lucene
In-Reply-To: <45e5f8bb0904190522v14beed5bx4c18d64c1a234f7f@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0904281540210.30171@radix.cryptio.net>
References: <45e5f8bb0904190522v14beed5bx4c18d64c1a234f7f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


Radha: replying/reforwarding the same message over and over doesn't tend 
to be a useful way to encourage additional replies.  if you do have 
something to add to an existing discussion that you've started, you should 
at least do it as a reply to the orriginal discussion so people have the 
full context...
  http://www.nabble.com/Need-help-%3A-SpanNearQuery-to23077372.html

I'm really not sure that anyone has any new additional info to offer you.  
this is a particularly hard problem, that doesn't have a very efficient 
solution that i know of.  it sounds like you've already tried the obvious 
solution, but aren't happy with the scores produced -- if you can't get 
the scores you want by tweaking the Similarity options available, then 
implementing custom Query/Scorer classes is really the only remaining 
option.


: Date: Sun, 19 Apr 2009 17:52:27 +0530
: From: Radha Sreedharan <radha84@gmail.com>
: Reply-To: java-user@lucene.apache.org
: To: java-user@lucene.apache.org
: Subject: Proximity and Percentage match search in Lucene
: 
:  What I need is  the following :
: If my document field is ( ab,bc,cd,ef) and Search tokens are (ab,bc,cd).
: 
:  Given the following :
:  I should get a hit even if all of the search tokens aren't present
:  If the tokens are found they should be found within a distance x of
: each other ( proximity
: search)
: >
: > I need the percentage match of the search tokens with the document field.
: >
: > Currently this is my query :
: > 1) I form all possible permutation of the search tokens
: > 2) do a spanNearQuery of each permutation
: > 3)  Do a DisjunctionMaxQuery on the spannearqueries.
: >
: > This is how I compute % match  :
: > % match =  ( Score by running the query on the document field ) /
: > 		( score by running the query on a document field created out of search tokens )
: >
: > The numerator gives me the actual score with the search tokens run on the field.
: > Denominator gives  me the  best possible or maximum possible score with the current search
: tokens
: >
: > For this example << If my document field is ( ab,bc,cd,ef) and Search tokens are
: (ab,bc,cd).>> I expect a % match of around 90%.
: >
: > However I get a match of only around 50% without a boost. Using a boost infact reduces
: my percentage.
: >
: > I even overrode the queryNorm method to return a one, still the percentage did not increase.
: *
: Is there any way of implementing this using the current set of
: implementation classes in Lucene and not making complex changes to the
: structure by itself.
: ( which is what i gather has to be done from the previous replies)
: 
: Can anyone suggest an alternative way of implementing this requirement
: using the existing bunch of classes in Lucene and not necessarily
: using the ones I have used*
: 



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-39999-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Apr 28 23:11:36 2009
Return-Path: <java-user-return-39999-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63259 invoked from network); 28 Apr 2009 23:11:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Apr 2009 23:11:36 -0000
Received: (qmail 64174 invoked by uid 500); 28 Apr 2009 23:11:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64112 invoked by uid 500); 28 Apr 2009 23:11:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64102 invoked by uid 99); 28 Apr 2009 23:11:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 23:11:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 28 Apr 2009 23:11:27 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id DCC3E71C2BF; Tue, 28 Apr 2009 16:11:06 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id DA20771C2B1
	for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 16:11:06 -0700 (PDT)
Date: Tue, 28 Apr 2009 16:11:06 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: sub-scores for all clauses in a BooleanQuery
In-Reply-To: <49E8F2B2.3080401@stanford.edu>
Message-ID: <Pine.LNX.4.64.0904281556180.30171@radix.cryptio.net>
References: <49E8F2B2.3080401@stanford.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: I've also tried getting the scores by walking the clauses of the
: BooleanQuery, but that doesn't seem to work either, because the
: queryNorm is off. For example, here's an original explanation for a
: 3-clause query, where one clause doesn't match:

a simple solution would be to eliminate the queryNorm completely (you can 
override it in your Similarity class) ... depending on your use case you 
might not need it at all.

: So how can I get the correct sub-scores for *all* clauses of a
: BooleanQuery, regardless of whether they matched or not?

well, first off: if a clause didn't match, then by definition there is no 
score to get from that clause ... but i'm guessing what you ment to say is 
how do you get the sub-scores from all of the clauses that *did* match, 
and know which clauses *didn't* match.

i haven't tried this, but i think something like this would work...

Weight tmp = yourBooleanQuery.weight(yourSearcher);
float norm = yourSearcher.getSimilarity().queryNorm(tmp.sumOfSquaredWeights());
for (BooleanClause c : yourBooleanQuery.getClauses()) {
   Weight w = c.getQuery().weight(yourSearcher);
   w.normalize(norm);
   doSomethingWithExplain(w.explain(yourReader, yourDocId));
}




-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40000-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 01:01:05 2009
Return-Path: <java-user-return-40000-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2942 invoked from network); 29 Apr 2009 01:01:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 01:01:04 -0000
Received: (qmail 50689 invoked by uid 500); 29 Apr 2009 01:01:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50617 invoked by uid 500); 29 Apr 2009 01:01:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50606 invoked by uid 99); 29 Apr 2009 01:01:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 01:01:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 01:00:50 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LyyA1-0007Ns-HG
	for java-user@lucene.apache.org; Tue, 28 Apr 2009 18:00:29 -0700
Message-ID: <23288825.post@talk.nabble.com>
Date: Tue, 28 Apr 2009 18:00:29 -0700 (PDT)
From: molz <anmol.bhasin@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: kamikaze
In-Reply-To: <9008E1E80EE8A340BACCA3DFF41B21562A4E18@GLGNYEXBE02.glgroup.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: anmol.bhasin@gmail.com
References: <9008E1E80EE8A340BACCA3DFF41B21562A4C9A@GLGNYEXBE02.glgroup.com> <8837fb770904241649i6beb28e5i770eca9c50b5d8e5@mail.gmail.com> <9008E1E80EE8A340BACCA3DFF41B21562A4E18@GLGNYEXBE02.glgroup.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Micheal,

Thanks for trying out Kamikaze for starters. So I guess there are a few
issues here

1. getDocSetInstance(int min, max, count,DocSetFactory.FOCUS) assumes that
count < max. I guess thats an API check we should add anyways to improve
usability. That is not to say that it will not work if count > max but we
have not done the due diligence on that one.

2. The way you are inserting the elements is not quite right. The addDoc
method assumes you insert the elements in a sorted fashion. Calling
doc.addDoc(rand.nextInt(maxDoc) does not quite ensure you are loading the
docSet in a sorted fashion. This is specially useful in BitSet and P4D set
cases as P4D encodes only delta values between conscutive integers.

3. I would recommend using FOCUS.OPTIMAL for best performance/space
tradeoff, albeit SPACE should work too, if you find any issues with that let
us know, we will be glad to fix it.

4. Finally, I believe you want to just get a plain vanilla docSet from one
of the OR/AND sets. This would be cool to do, however the idea with Boolean
Sets are that they are never really materialized, they are iterated over on
the fly. I believe we could do an enhancement to construct the docSet on the
fly while iterating the Boolean DocSet but as of now there is no established
way of doing that.

Hope I covered all your concerns. I rewrote and run your test case like this

public class KamikazeTest extends TestCase
{
    public void testGrowingP4()
    {
        DocSet doc =
            DocSetFactory.getDocSetInstance(0, 35000000, 200000,
DocSetFactory.FOCUS.SPACE);
        Random rand = new Random(System.currentTimeMillis());
       // int maxDoc = 3500000;
        //doc.addDoc(0);
        
        int i = 0;
        try
        {
            while(i < 500000)
            {
                int nextDoc = i;
                doc.addDoc(nextDoc);
                i+=rand.nextInt(50);
            }              
        }
        catch(Exception e)
        {
            e.printStackTrace();
            return;
        }
        assertTrue(true);
       
    }
    
   
} 

Thanks,
Anmol

Software Engineer
Anmol Bhasin
www.linkedin.com



Michael Mastroianni wrote:
> 
> Hi--
> 
> I just got kamikaze somewhat integrated into a project of mine. I'm
> having problems growing the DocIdSets, though. Up to the point where the
> first regrow happens, everything is fine. Once the regrow happens, I get
> an ArrayOutOfBoundsException. The following unit test will exhibit this
> behavior. If I change the third param of getDocSetInstance to be
> something lower, I get a p4Doc, if I leave it as is, I get an OpenBitSet
> doc, in either case, I get the same crash. Do I need to initialize the
> docs in some way other than just creating them?
> 
> regards,
> Michael
> 
> import org.apache.lucene.search.DocIdSet;
> import org.apache.lucene.util.OpenBitSet;
> 
> 
> import com.kamikaze.docidset.api.DocSet;
> import com.kamikaze.docidset.impl.AndDocIdSet;
> import com.kamikaze.docidset.impl.OrDocIdSet;
> import com.kamikaze.docidset.utils.DocSetFactory;
> 
> import junit.framework.TestCase;
> 
> 
> public class KamikazeTest extends TestCase
> {
>     public void testGrowingP4()
>     {
>         DocSet doc =
>             DocSetFactory.getDocSetInstance(0, 350000, 3000000,
> DocSetFactory.FOCUS.SPACE);
>         Random rand = new Random(System.currentTimeMillis());
>         int maxDoc = 350000;
>         doc.addDoc(rand.nextInt(maxDoc));
>         int i = 0;
>         try
>         {
>             while(i < 256)
>             {
>                 int nextDoc = rand.nextInt(maxDoc);
>                 doc.addDoc(nextDoc);
>                 ++i;
>             }               
>         }
>         catch(Exception e)
>         {
>             return;
>         }
>         assertTrue(false);
>     }
> }
> 
> -----Original Message-----
> From: John Wang [mailto:john.wang@gmail.com] 
> Sent: Friday, April 24, 2009 7:50 PM
> To: java-user@lucene.apache.org
> Subject: Re: kamikaze
> 
> Hi Michael:
>     We are using it internally here at LinkedIn for both our search
> engine
> as well as our social graph engine. And we have a team developing
> actively
> on it. Let us know how we can help you.
> 
> -John
> 
> On Fri, Apr 24, 2009 at 1:56 PM, Michael Mastroianni <
> MMastroianni@glgroup.com> wrote:
> 
>> Hi--
>>
>>
>>
>> Has anyone here used kamikaze much? I'm interested in using it in
>> situations where I'll have several docidsets of >2M, plus several in
> the
>> 10s of thousands.
>>
>>
>>
>> On prototype basis, I got something running nicely using OpenBitSet,
> but
>> I can't use that much memory for my real application.
>>
>>
>>
>> regards,
>>
>> Michael Mastroianni
>>
>>
>>
>> This e-mail message, and any attachments, is intended only for the use
> of
>> the individual or entity identified in the alias address of this
> message and
>> may contain information that is confidential, privileged and subject
> to
>> legal restrictions and penalties regarding its unauthorized disclosure
> and
>> use. Any unauthorized review, copying, disclosure, use or distribution
> is
>> strictly prohibited. If you have received this e-mail message in
> error,
>> please notify the sender immediately by reply e-mail and delete this
>> message, and any attachments, from your system. Thank you.
>>
>>
> 
> This e-mail message, and any attachments, is intended only for the use of
> the individual or entity identified in the alias address of this message
> and may contain information that is confidential, privileged and subject
> to legal restrictions and penalties regarding its unauthorized disclosure
> and use. Any unauthorized review, copying, disclosure, use or distribution
> is strictly prohibited. If you have received this e-mail message in error,
> please notify the sender immediately by reply e-mail and delete this
> message, and any attachments, from your system. Thank you.
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/kamikaze-tp23224760p23288825.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40001-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 01:49:42 2009
Return-Path: <java-user-return-40001-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29941 invoked from network); 29 Apr 2009 01:49:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 01:49:42 -0000
Received: (qmail 94236 invoked by uid 500); 29 Apr 2009 01:49:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94159 invoked by uid 500); 29 Apr 2009 01:49:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94149 invoked by uid 99); 29 Apr 2009 01:49:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 01:49:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ihasmax@gmail.com designates 209.85.221.127 as permitted sender)
Received: from [209.85.221.127] (HELO mail-qy0-f127.google.com) (209.85.221.127)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 01:49:33 +0000
Received: by qyk33 with SMTP id 33so504888qyk.29
        for <java-user@lucene.apache.org>; Tue, 28 Apr 2009 18:49:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=8LQQp+pTVx7GSEp3q06WgMHk4awY4iTaRMXn46kh8xU=;
        b=iH9A1pzJmCAJ1V1LXdwvLdzzwTmpzICeuEqDjFmSytRkvvQLZGSvTdNoUzHnZFSQIV
         RxeMdmDzXnQMpl5NhnFhSN2Qen3+02yzKaT76m6Uf5ERTteZAlKzb5unSFX015hhLkVR
         QbhO0QV7uTfJiQ6EpiOmIP3JalZsHITQxtlPc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=eEDX8XnR488ogf0VKKocIhOVFcJfxDtSmgTvk5pC/g5yyXW7giyjH0QvdGipaYaEHW
         jbO0bNofNEhxF/QgvZUk++QH7318/8eOPDwusHdJoHH/CmAMlD//fQCc/UegBoFaI0ed
         gzpAUja1XtyhE+RSCWtO9g8W0/f/sEJofdSTw=
MIME-Version: 1.0
Received: by 10.224.28.129 with SMTP id m1mr9036932qac.85.1240969752586; Tue, 
	28 Apr 2009 18:49:12 -0700 (PDT)
Date: Tue, 28 Apr 2009 20:49:12 -0500
Message-ID: <3836ec640904281849s271e7ad0k380d6978c9117a76@mail.gmail.com>
Subject: Phrase Highlighting
From: Max Lynch <ihasmax@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015175cb21e47aaf60468a7c9ba
X-Virus-Checked: Checked by ClamAV on apache.org

--0015175cb21e47aaf60468a7c9ba
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,
I am trying to find out exactly when a word I'm looking for in a document is
found.  I've talked to a few people on IRC and it seems like the best way is
to use a highlighter.  What I have right now is a system where I put each
word the highlighter is called with into a list so I then know which words
were found.  However, I am doing searches with phrases, like "John Smith",
yet the highlighter processes "John" and "Smith" separately.  I have found
several old mailing list references that deal with this issue but I haven't
found one that I can understand.

How can I make the highlighter handle my entire phrase instead of each word
in the phrase?

Thanks,
Max

--0015175cb21e47aaf60468a7c9ba--

From java-user-return-40002-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 04:26:37 2009
Return-Path: <java-user-return-40002-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74691 invoked from network); 29 Apr 2009 04:26:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 04:26:37 -0000
Received: (qmail 18721 invoked by uid 500); 29 Apr 2009 04:26:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18636 invoked by uid 500); 29 Apr 2009 04:26:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18624 invoked by uid 99); 29 Apr 2009 04:26:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 04:26:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [67.195.8.115] (HELO web110510.mail.gq1.yahoo.com) (67.195.8.115)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 29 Apr 2009 04:26:24 +0000
Received: (qmail 69328 invoked by uid 60001); 29 Apr 2009 04:26:03 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1240979163; bh=gVN7CQBwgLxjR4tizGkuXtrmvkxf3LtCpybGIxR9Oz8=; h=Message-ID:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=4DEwlLj/vEyTQrzG3Nh9jyDaoIIbewBMCDGvH8jafFihWVEcup2MRkZDhUVRB77Q1dFKdehQlXJ+IrI5yxk7qtRBybRMKKA28o1fBLUUjJG/whHVaqCg7Pvm+PfcFX4SSEiV0zfoFig2NFn+f/yH8YOy8J8hFBrKmJizULrHQiQ=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=N38px3v+Yf8GK8MrSNMPV42lGEk6+/N5bHdD6Vqp4TvkyWQ1NKlpeUG9FtVcXvSLfp3yVQ4o7g2X0+1F2EiGFFcfFGhIUyc9Ue94kHhhsUCFvX83phNwnR6ez0sM2V3VR0EkUzWpgj/8GGhhxbDezuW3XsP9Sh4PvsVycls74JQ=;
Message-ID: <557579.68778.qm@web110510.mail.gq1.yahoo.com>
Received: from [118.142.11.178] by web110510.mail.gq1.yahoo.com via HTTP; Wed, 29 Apr 2009 12:26:03 CST
Date: Wed, 29 Apr 2009 12:26:03 +0800 (CST)
From: CM Wong <cmwong2@yahoo.com>
Subject: RE: NOT_ANALYZED field
To: java-user@lucene.apache.org
In-Reply-To: <7A535703E5C244BD9A3BC2664F90EAA3@VEGA>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks a lot. I am now indexing my id in lowercase and my problem is solved.

Regards,
CM


--- Uwe Schindler <uwe@thetaphi.de> wrote:

> That is normal. Fields that are not analyzed are indexed as single tokens.
> The anaylzer does not only tokenize the text, it also transforms it (e.g. to
> lower case). If you enter your search using the query parser, the entered
> search terms are analyzed! And for full text engines, the analyzer for
> querying and searching must be the same. So it is normal, that your search
> will not return results (in your example, it would work, if the id would be
> indexed in lower case, because the analyzer on top of your query string
> lowercases the term).
> 
> So not-analyzed fields should be directly queried using TermQuery(....),
> e.g. to find the document with an untokenized id.
> 
> If you really want to use query parser, think about PerFieldAnalyzerWrapper
> using KeywordTokenizer for the id field.
> 
> Uwe
> 
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
> 
> 
> > -----Original Message-----
> > From: CM Wong [mailto:cmwong2@yahoo.com]
> > Sent: Tuesday, April 28, 2009 2:26 PM
> > To: java-user@lucene.apache.org
> > Subject: NOT_ANALYZED field
> > 
> > 
> > Hi,
> > 
> > In my simple program I have an ID field which is NON_ANALYZED. I find that
> > if
> > the field contains only numeric characters (e.g. id="00023"), I can
> > successsfully search for the doc. (search for "id:00023")
> > 
> > But if the field contains non-numeric characates (e.g. id="nJK00023") then
> > the
> > search returns nothing. (search for "id:nJK00023")
> > 
> > Is there anything wrong with my program?
> > 
> > Regards,
> > CM


Send instant messages to your online friends http://uk.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40003-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 09:24:04 2009
Return-Path: <java-user-return-40003-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81339 invoked from network); 29 Apr 2009 09:24:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 09:24:04 -0000
Received: (qmail 25681 invoked by uid 500); 29 Apr 2009 09:24:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25635 invoked by uid 500); 29 Apr 2009 09:24:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25625 invoked by uid 99); 29 Apr 2009 09:24:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 09:24:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [193.196.199.1] (HELO relay1.uniklinik-freiburg.de) (193.196.199.1)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 09:23:51 +0000
Received: from vscanmailb.ukl.uni-freiburg.de (vscanmailb.uniklinik-freiburg.de [193.196.199.48])
	by relay1.uniklinik-freiburg.de (Email) with SMTP id 8F860E603A
	for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 11:23:30 +0200 (CEST)
Received: From perazin ([132.230.10.215]) by vscanmailb.ukl.uni-freiburg.de (WebShield SMTP v4.5 MR3)
	id 1240997024687; Wed, 29 Apr 2009 11:23:44 +0200
From: "Jan Paetzold" <jan.paetzold@uniklinik-freiburg.de>
To: <java-user@lucene.apache.org>
Subject: lucene score and float precision
Date: Wed, 29 Apr 2009 11:23:30 +0200
Message-ID: <4655F93B69E345CB9B187A7C5C09AC6A@perazin>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: AcnIrCjSV6sOrTtsTcKzvDjiacZ+kg==
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

in some cases we have the problem that for a document the ScoreDoc score
differs at the last digit of the float from the score reported by the
explanation functionality of lucene. For example: 

ScoreDoc: 16.770466 -- Explanation: 16.770468 = (MATCH) sum of: ...
ScoreDoc: 21.118656 -- Explanation: 21.118654 = (MATCH) sum of: ...

The explanation function reports a score as expected, compared to the other
results of the search, while the ScoreDoc score is a bit to low or to high. 

Does anyone have an idea? 


regards,
Jan



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40004-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 09:28:01 2009
Return-Path: <java-user-return-40004-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83599 invoked from network); 29 Apr 2009 09:28:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 09:28:00 -0000
Received: (qmail 30171 invoked by uid 500); 29 Apr 2009 09:27:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30113 invoked by uid 500); 29 Apr 2009 09:27:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30103 invoked by uid 99); 29 Apr 2009 09:27:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 09:27:58 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [74.125.46.31] (HELO yw-out-2324.google.com) (74.125.46.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 09:27:49 +0000
Received: by yw-out-2324.google.com with SMTP id 2so567745ywt.5
        for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 02:27:28 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.128.7 with SMTP id f7mr1074699ybn.116.1240997248258; Wed, 
	29 Apr 2009 02:27:28 -0700 (PDT)
In-Reply-To: <3836ec640904281849s271e7ad0k380d6978c9117a76@mail.gmail.com>
References: <3836ec640904281849s271e7ad0k380d6978c9117a76@mail.gmail.com>
Date: Wed, 29 Apr 2009 05:27:28 -0400
Message-ID: <9ac0c6aa0904290227k4cb08938ic55503688ac02bd8@mail.gmail.com>
Subject: Re: Phrase Highlighting
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

You should switch to the SpanScorer (in o.a.l.search.highlighter).
That fragment scorer should only match true phrase matches.

Mike

On Tue, Apr 28, 2009 at 9:49 PM, Max Lynch <ihasmax@gmail.com> wrote:
> Hi,
> I am trying to find out exactly when a word I'm looking for in a document=
 is
> found. =A0I've talked to a few people on IRC and it seems like the best w=
ay is
> to use a highlighter. =A0What I have right now is a system where I put ea=
ch
> word the highlighter is called with into a list so I then know which word=
s
> were found. =A0However, I am doing searches with phrases, like "John Smit=
h",
> yet the highlighter processes "John" and "Smith" separately. =A0I have fo=
und
> several old mailing list references that deal with this issue but I haven=
't
> found one that I can understand.
>
> How can I make the highlighter handle my entire phrase instead of each wo=
rd
> in the phrase?
>
> Thanks,
> Max
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40005-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 09:30:49 2009
Return-Path: <java-user-return-40005-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84962 invoked from network); 29 Apr 2009 09:30:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 09:30:49 -0000
Received: (qmail 33046 invoked by uid 500); 29 Apr 2009 09:30:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32990 invoked by uid 500); 29 Apr 2009 09:30:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32980 invoked by uid 99); 29 Apr 2009 09:30:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 09:30:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 09:30:37 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lz67M-0000TS-Ub
	for java-user@lucene.apache.org; Wed, 29 Apr 2009 02:30:16 -0700
Message-ID: <23293723.post@talk.nabble.com>
Date: Wed, 29 Apr 2009 02:30:16 -0700 (PDT)
From: "joseph.christopher" <joseph@kottsoftware.com>
To: java-user@lucene.apache.org
Subject: How to het the score in percentage
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: joseph@kottsoftware.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Experts,

We are in a procees of changing our existing fuzzy search engine to lucene, 
but we are facing a roadblock 
here ie, in our existing system we are showing the search score in
percenetage but lucene provides the search score in numbers which is derived
from some internal logic. Can anybody give some tips for converting the
lucene score to percentage or is there any way to retrive the score as
percentage from lucene search. 

Thanks in advance.


-- 
View this message in context: http://www.nabble.com/How-to-het-the-score-in-percentage-tp23293723p23293723.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40006-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 09:34:26 2009
Return-Path: <java-user-return-40006-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88025 invoked from network); 29 Apr 2009 09:34:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 09:34:26 -0000
Received: (qmail 37568 invoked by uid 500); 29 Apr 2009 09:34:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37488 invoked by uid 500); 29 Apr 2009 09:34:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37478 invoked by uid 99); 29 Apr 2009 09:34:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 09:34:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 09:34:15 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lz6As-0000aR-FU
	for java-user@lucene.apache.org; Wed, 29 Apr 2009 02:33:54 -0700
Message-ID: <23293764.post@talk.nabble.com>
Date: Wed, 29 Apr 2009 02:33:54 -0700 (PDT)
From: "joseph.christopher" <joseph@kottsoftware.com>
To: java-user@lucene.apache.org
Subject: Getting search score in percentage
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: joseph@kottsoftware.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Experts,

We are in a procees of changing our existing fuzzy search engine to lucene, 
but we are facing a roadblock 
here ie, in our existing system we are showing the search score in
percenetage but lucene provides the search score in numbers which is derived
from some internal logic. Can anybody give some tips for converting the
lucene score to percentage or is there any way to retrive the score as
percentage from lucene search. 

Thanks in advance.


-- 
View this message in context: http://www.nabble.com/Getting-search-score-in-percentage-tp23293764p23293764.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40007-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 09:53:31 2009
Return-Path: <java-user-return-40007-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96760 invoked from network); 29 Apr 2009 09:53:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 09:53:30 -0000
Received: (qmail 63082 invoked by uid 500); 29 Apr 2009 09:53:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63010 invoked by uid 500); 29 Apr 2009 09:53:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63000 invoked by uid 99); 29 Apr 2009 09:53:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 09:53:28 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 09:53:20 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id 41A9D32EF6B;
	Wed, 29 Apr 2009 05:52:59 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute2.internal (MEProxy); Wed, 29 Apr 2009 05:52:59 -0400
X-Sasl-enc: 7h/BBiJbtgyPAmR3CtzmxeCukBetSmDnjwK636hh6kVj 1240998778
Received: from [192.168.2.50] (cpc2-leed4-0-0-cust912.leed.cable.ntl.com [81.105.111.145])
	by mail.messagingengine.com (Postfix) with ESMTPA id B4EFD2724C;
	Wed, 29 Apr 2009 05:52:58 -0400 (EDT)
Message-ID: <49F82380.4090206@fastmail.fm>
Date: Wed, 29 Apr 2009 10:53:04 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: Michael McCandless <lucene@mikemccandless.com>
CC: Lucene Users <java-user@lucene.apache.org>
Subject: Re: no segments* file found: files: Error on opening index
References: <49F1E14C.7080308@fastmail.fm> <49F58284.3030606@fastmail.fm>	 <9ac0c6aa0904270407j5f4850b3m303423995a8da58c@mail.gmail.com>	 <49F594DA.1050100@fastmail.fm> <9ac0c6aa0904270727o36eb374ekc2d2bc196cd05be3@mail.gmail.com>
In-Reply-To: <9ac0c6aa0904270727o36eb374ekc2d2bc196cd05be3@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Michael McCandless wrote:
> Lucene doesn't have anything builtin to handle this.
>
> It's probably best to put synchronization into your code in such a
> case?  It's presumably also not great if your IndexReader opens an
> empty index since searches will find no results.  Ie, you should
> probably only reopen the IndexReader after all docs have been
> reindexed?
>
> Or you could catch a failure to open the IndexReader and retry, but
> that's not great since differentiating a true failure isn't easy.
>
> Mike
>
>   
I can synchronize the reindex method but I dont think that will help 
because the problem is with the readers, the trouble is that I have 
various threads, and sometimes IndexReaders are being opened in reponse 
to something done on the GUI, without being aware that a reindex is 
being done. I think I need to get any IndexReader opens to wait for any 
reindexing to complete using something in the Concurrent Package. Or 
alternatively I was wondering if the reindex could be done on a 
different folder, so Indexreaders opened in the meantime work on the old 
index, than once the reindexd has completed I can swap the directory 
that the reader looks at to the new one.


Which do you think would work ?
Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40008-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 10:09:38 2009
Return-Path: <java-user-return-40008-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6377 invoked from network); 29 Apr 2009 10:09:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 10:09:38 -0000
Received: (qmail 88709 invoked by uid 500); 29 Apr 2009 10:09:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88648 invoked by uid 500); 29 Apr 2009 10:09:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88638 invoked by uid 99); 29 Apr 2009 10:09:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 10:09:35 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.217.167] (HELO mail-gx0-f167.google.com) (209.85.217.167)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 10:09:28 +0000
Received: by gxk11 with SMTP id 11so2124623gxk.5
        for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 03:09:07 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.128.7 with SMTP id f7mr1136994ybn.116.1240999747018; Wed, 
	29 Apr 2009 03:09:07 -0700 (PDT)
In-Reply-To: <49F82380.4090206@fastmail.fm>
References: <49F1E14C.7080308@fastmail.fm> <49F58284.3030606@fastmail.fm>
	 <9ac0c6aa0904270407j5f4850b3m303423995a8da58c@mail.gmail.com>
	 <49F594DA.1050100@fastmail.fm>
	 <9ac0c6aa0904270727o36eb374ekc2d2bc196cd05be3@mail.gmail.com>
	 <49F82380.4090206@fastmail.fm>
Date: Wed, 29 Apr 2009 06:09:06 -0400
Message-ID: <9ac0c6aa0904290309o56482fa9ge5ec0e4d821e15f4@mail.gmail.com>
Subject: Re: no segments* file found: files: Error on opening index
From: Michael McCandless <lucene@mikemccandless.com>
To: paul_t100@fastmail.fm
Cc: Lucene Users <java-user@lucene.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Are you sure you can't make the reader reopen block on a reindex?  Or
skip reopen if reindex is in process?

(Because that's the simplest solution).

If not, I think the next best solution is likely to allow multiple
commit points in the index.  You'll need a custom deletion policy that
always keeps the "last commit point that's safe to reopen" in the
index.  Then a reindex can gleefully proceed since the last "safe to
reopen" commit point will not be deleted.  If a reader wants to
reopen, you ask it to reopen on that "last safe commit point".

But these APIs (reopen to a commit point) are only available in 2.9
trunk.  You can emulate this in prior releases by using separate
indexing directories in the filesystem.

Mike

On Wed, Apr 29, 2009 at 5:53 AM, Paul Taylor <paul_t100@fastmail.fm> wrote:
> Michael McCandless wrote:
>>
>> Lucene doesn't have anything builtin to handle this.
>>
>> It's probably best to put synchronization into your code in such a
>> case? =A0It's presumably also not great if your IndexReader opens an
>> empty index since searches will find no results. =A0Ie, you should
>> probably only reopen the IndexReader after all docs have been
>> reindexed?
>>
>> Or you could catch a failure to open the IndexReader and retry, but
>> that's not great since differentiating a true failure isn't easy.
>>
>> Mike
>>
>>
>
> I can synchronize the reindex method but I dont think that will help beca=
use
> the problem is with the readers, the trouble is that I have various threa=
ds,
> and sometimes IndexReaders are being opened in reponse to something done =
on
> the GUI, without being aware that a reindex is being done. I think I need=
 to
> get any IndexReader opens to wait for any reindexing to complete using
> something in the Concurrent Package. Or alternatively I was wondering if =
the
> reindex could be done on a different folder, so Indexreaders opened in th=
e
> meantime work on the old index, than once the reindexd has completed I ca=
n
> swap the directory that the reader looks at to the new one.
>
>
> Which do you think would work ?
> Paul
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40009-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 13:20:54 2009
Return-Path: <java-user-return-40009-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73649 invoked from network); 29 Apr 2009 13:20:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 13:20:54 -0000
Received: (qmail 36798 invoked by uid 500); 29 Apr 2009 13:20:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36744 invoked by uid 500); 29 Apr 2009 13:20:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36734 invoked by uid 99); 29 Apr 2009 13:20:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 13:20:51 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 13:20:42 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id 42307336411;
	Wed, 29 Apr 2009 09:20:21 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute2.internal (MEProxy); Wed, 29 Apr 2009 09:20:21 -0400
X-Sasl-enc: ycu99q3Au897J7wgXNc5G6QWK8+EPznDg/9KPOKbBkBq 1241011220
Received: from [192.168.2.50] (cpc2-leed4-0-0-cust912.leed.cable.ntl.com [81.105.111.145])
	by mail.messagingengine.com (Postfix) with ESMTPA id 9E14F5915E;
	Wed, 29 Apr 2009 09:20:20 -0400 (EDT)
Message-ID: <49F8541A.8030605@fastmail.fm>
Date: Wed, 29 Apr 2009 14:20:26 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.21 (Windows/20090302)
MIME-Version: 1.0
To: Michael McCandless <lucene@mikemccandless.com>
CC: Lucene Users <java-user@lucene.apache.org>
Subject: Re: no segments* file found: files: Error on opening index
References: <49F1E14C.7080308@fastmail.fm> <49F58284.3030606@fastmail.fm>	 <9ac0c6aa0904270407j5f4850b3m303423995a8da58c@mail.gmail.com>	 <49F594DA.1050100@fastmail.fm>	 <9ac0c6aa0904270727o36eb374ekc2d2bc196cd05be3@mail.gmail.com>	 <49F82380.4090206@fastmail.fm> <9ac0c6aa0904290309o56482fa9ge5ec0e4d821e15f4@mail.gmail.com>
In-Reply-To: <9ac0c6aa0904290309o56482fa9ge5ec0e4d821e15f4@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Michael McCandless wrote:
> Are you sure you can't make the reader reopen block on a reindex?  Or
> skip reopen if reindex is in process?
>
> (Because that's the simplest solution).
>   
Thats what Im suggesting in principle, I just need to work out the best 
way to do it because the reader reopen has no idea whether a reindex is 
occurring athe moment, I have to introduce some concurrency code to 
achive this.
> If not, I think the next best solution is likely to allow multiple
> commit points in the index.  You'll need a custom deletion policy that
> always keeps the "last commit point that's safe to reopen" in the
> index.  Then a reindex can gleefully proceed since the last "safe to
> reopen" commit point will not be deleted.  If a reader wants to
> reopen, you ask it to reopen on that "last safe commit point".
>
> But these APIs (reopen to a commit point) are only available in 2.9
> trunk.  You can emulate this in prior releases by using separate
> indexing directories in the filesystem.
>   
I had already upgraded to 2.9, so I'll have a look at this as well. For 
me I would want it to work so that before a reindex starts it creates a 
commit point on the existing index, so a that any index readers created 
in the meantime will work on the last one

Paul


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40010-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 13:43:05 2009
Return-Path: <java-user-return-40010-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87762 invoked from network); 29 Apr 2009 13:43:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 13:43:05 -0000
Received: (qmail 71570 invoked by uid 500); 29 Apr 2009 13:43:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71519 invoked by uid 500); 29 Apr 2009 13:43:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71509 invoked by uid 99); 29 Apr 2009 13:43:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 13:43:02 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW
X-Spam-Check-By: apache.org
Received-SPF: unknown (athena.apache.org: error in processing during lookup of MMastroianni@glgroup.com)
Received: from [216.32.180.12] (HELO VA3EHSOBE002.bigfish.com) (216.32.180.12)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 13:42:51 +0000
Received: from mail192-va3-R.bigfish.com (10.7.14.244) by
 VA3EHSOBE002.bigfish.com (10.7.40.22) with Microsoft SMTP Server id
 8.1.340.0; Wed, 29 Apr 2009 13:42:30 +0000
Received: from mail192-va3 (localhost.localdomain [127.0.0.1])	by
 mail192-va3-R.bigfish.com (Postfix) with ESMTP id 830D4AA8188	for
 <java-user@lucene.apache.org>; Wed, 29 Apr 2009 13:42:30 +0000 (UTC)
X-BigFish: VPS-71(zz542NfadR1432Ra0dJ62a3L98dR168aJ4015L148cM1447R1805M1442J936fJ9371P4f15k8b9bk10e6izz1202hzz5a6ciz32i6bh61h)
X-Spam-TCS-SCL: 0:0
Received: by mail192-va3 (MessageSwitch) id 1241012546793267_12423; Wed, 29
 Apr 2009 13:42:26 +0000 (UCT)
Received: from GLGNYEXSMTP02.glgroup.com (glgnyexsmtp02.glgroup.com
 [38.112.210.163])	by mail192-va3.bigfish.com (Postfix) with ESMTP id
 AF256868055	for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 13:42:26
 +0000 (UTC)
Received: from GLGNYEXBE02.glgroup.com ([10.45.50.82]) by
 GLGNYEXSMTP02.glgroup.com with Microsoft SMTPSVC(6.0.3790.3959);	 Wed, 29 Apr
 2009 09:42:26 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: kamikaze
Date: Wed, 29 Apr 2009 09:44:26 -0400
Message-ID: <9008E1E80EE8A340BACCA3DFF41B21562A4F5E@GLGNYEXBE02.glgroup.com>
In-Reply-To: <23288825.post@talk.nabble.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: kamikaze
thread-index: AcnIZft9Hs1X51GaTJ+8gQga0TS0PAAaTohA
From: Michael Mastroianni <MMastroianni@glgroup.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 29 Apr 2009 13:42:26.0303 (UTC) FILETIME=[551608F0:01C9C8D0]
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks for the response (and the library, of course :)). I figured out
the order thing by looking at your tests (I should have done that
first). It might be a good idea to have a ctor that takes a sorted array
of ints, since it looks like in situations where you are, for  instance,
loading a docset from a hitcollector, you have to store things that way
anyway.

I have another question about the boolean docsets. If I have an
AndDocIdSet with a bunch of OrDocIdSets inside it, and any of those
contain an empty basic DocSet, the iterator on the AndDocIdSet will blow
up on calls to next(). I'm not sure whether this is by design or a bug,
but it might be a good thing to put in the javadoc. I can reproduce this
behavior with the following junit test. Is this something you are aware
of?

regards,
Michael



	public void testPartialEmptyAnd() throws IOException
	{
		try
		{
			DocSet ds1 =3D new P4DDocIdSet();
			DocSet ds2 =3D new P4DDocIdSet();
			ds2.addDoc(42);
			ds2.addDoc(43);
			ds2.addDoc(44);
			ArrayList<DocIdSet> docs =3D new
ArrayList<DocIdSet>();
			docs.add(ds1);
			docs.add(ds2);
			OrDocIdSet orlist1 =3D new OrDocIdSet(docs);
			DocSet ds3 =3D new P4DDocIdSet();
			DocSet ds4 =3D new P4DDocIdSet();
			ds4.addDoc(42);
			ds4.addDoc(43);
			ds4.addDoc(44);
			ArrayList<DocIdSet> docs2 =3D new
ArrayList<DocIdSet>();
			docs2.add(ds3);
			docs2.add(ds4);
			OrDocIdSet orlist2 =3D new OrDocIdSet(docs2);
			ArrayList<DocIdSet> docs3 =3D new
ArrayList<DocIdSet>();
			docs3.add(orlist1);
			docs3.add(orlist2);
			AndDocIdSet andlist =3D new AndDocIdSet(docs3);
			=

			DocIdSetIterator iter =3D andlist.iterator();
			@SuppressWarnings("unused")
			int docId =3D -1;
			while(iter.next())
			{
				docId =3D iter.doc();
			}			=

		}
		catch(Exception e)
		{
			System.out.println(e.getMessage());
			return;
		}
		assertTrue(false);
	}

-----Original Message-----
From: molz [mailto:anmol.bhasin@gmail.com] =

Sent: Tuesday, April 28, 2009 9:00 PM
To: java-user@lucene.apache.org
Subject: RE: kamikaze


Hi Micheal,

Thanks for trying out Kamikaze for starters. So I guess there are a few
issues here

1. getDocSetInstance(int min, max, count,DocSetFactory.FOCUS) assumes
that
count < max. I guess thats an API check we should add anyways to improve
usability. That is not to say that it will not work if count > max but
we
have not done the due diligence on that one.

2. The way you are inserting the elements is not quite right. The addDoc
method assumes you insert the elements in a sorted fashion. Calling
doc.addDoc(rand.nextInt(maxDoc) does not quite ensure you are loading
the
docSet in a sorted fashion. This is specially useful in BitSet and P4D
set
cases as P4D encodes only delta values between conscutive integers.

3. I would recommend using FOCUS.OPTIMAL for best performance/space
tradeoff, albeit SPACE should work too, if you find any issues with that
let
us know, we will be glad to fix it.

4. Finally, I believe you want to just get a plain vanilla docSet from
one
of the OR/AND sets. This would be cool to do, however the idea with
Boolean
Sets are that they are never really materialized, they are iterated over
on
the fly. I believe we could do an enhancement to construct the docSet on
the
fly while iterating the Boolean DocSet but as of now there is no
established
way of doing that.

Hope I covered all your concerns. I rewrote and run your test case like
this

public class KamikazeTest extends TestCase
{
    public void testGrowingP4()
    {
        DocSet doc =3D
            DocSetFactory.getDocSetInstance(0, 35000000, 200000,
DocSetFactory.FOCUS.SPACE);
        Random rand =3D new Random(System.currentTimeMillis());
       // int maxDoc =3D 3500000;
        //doc.addDoc(0);
        =

        int i =3D 0;
        try
        {
            while(i < 500000)
            {
                int nextDoc =3D i;
                doc.addDoc(nextDoc);
                i+=3Drand.nextInt(50);
            }              =

        }
        catch(Exception e)
        {
            e.printStackTrace();
            return;
        }
        assertTrue(true);
       =

    }
    =

   =

} =


Thanks,
Anmol

Software Engineer
Anmol Bhasin
www.linkedin.com



Michael Mastroianni wrote:
> =

> Hi--
> =

> I just got kamikaze somewhat integrated into a project of mine. I'm
> having problems growing the DocIdSets, though. Up to the point where
the
> first regrow happens, everything is fine. Once the regrow happens, I
get
> an ArrayOutOfBoundsException. The following unit test will exhibit
this
> behavior. If I change the third param of getDocSetInstance to be
> something lower, I get a p4Doc, if I leave it as is, I get an
OpenBitSet
> doc, in either case, I get the same crash. Do I need to initialize the
> docs in some way other than just creating them?
> =

> regards,
> Michael
> =

> import org.apache.lucene.search.DocIdSet;
> import org.apache.lucene.util.OpenBitSet;
> =

> =

> import com.kamikaze.docidset.api.DocSet;
> import com.kamikaze.docidset.impl.AndDocIdSet;
> import com.kamikaze.docidset.impl.OrDocIdSet;
> import com.kamikaze.docidset.utils.DocSetFactory;
> =

> import junit.framework.TestCase;
> =

> =

> public class KamikazeTest extends TestCase
> {
>     public void testGrowingP4()
>     {
>         DocSet doc =3D
>             DocSetFactory.getDocSetInstance(0, 350000, 3000000,
> DocSetFactory.FOCUS.SPACE);
>         Random rand =3D new Random(System.currentTimeMillis());
>         int maxDoc =3D 350000;
>         doc.addDoc(rand.nextInt(maxDoc));
>         int i =3D 0;
>         try
>         {
>             while(i < 256)
>             {
>                 int nextDoc =3D rand.nextInt(maxDoc);
>                 doc.addDoc(nextDoc);
>                 ++i;
>             }               =

>         }
>         catch(Exception e)
>         {
>             return;
>         }
>         assertTrue(false);
>     }
> }
> =

> -----Original Message-----
> From: John Wang [mailto:john.wang@gmail.com] =

> Sent: Friday, April 24, 2009 7:50 PM
> To: java-user@lucene.apache.org
> Subject: Re: kamikaze
> =

> Hi Michael:
>     We are using it internally here at LinkedIn for both our search
> engine
> as well as our social graph engine. And we have a team developing
> actively
> on it. Let us know how we can help you.
> =

> -John
> =

> On Fri, Apr 24, 2009 at 1:56 PM, Michael Mastroianni <
> MMastroianni@glgroup.com> wrote:
> =

>> Hi--
>>
>>
>>
>> Has anyone here used kamikaze much? I'm interested in using it in
>> situations where I'll have several docidsets of >2M, plus several in
> the
>> 10s of thousands.
>>
>>
>>
>> On prototype basis, I got something running nicely using OpenBitSet,
> but
>> I can't use that much memory for my real application.
>>
>>
>>
>> regards,
>>
>> Michael Mastroianni
>>
>>
>>
>> This e-mail message, and any attachments, is intended only for the
use
> of
>> the individual or entity identified in the alias address of this
> message and
>> may contain information that is confidential, privileged and subject
> to
>> legal restrictions and penalties regarding its unauthorized
disclosure
> and
>> use. Any unauthorized review, copying, disclosure, use or
distribution
> is
>> strictly prohibited. If you have received this e-mail message in
> error,
>> please notify the sender immediately by reply e-mail and delete this
>> message, and any attachments, from your system. Thank you.
>>
>>
> =

> This e-mail message, and any attachments, is intended only for the use
of
> the individual or entity identified in the alias address of this
message
> and may contain information that is confidential, privileged and
subject
> to legal restrictions and penalties regarding its unauthorized
disclosure
> and use. Any unauthorized review, copying, disclosure, use or
distribution
> is strictly prohibited. If you have received this e-mail message in
error,
> please notify the sender immediately by reply e-mail and delete this
> message, and any attachments, from your system. Thank you.
> =

> =

> =

> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> =

> =

> =


-- =

View this message in context:
http://www.nabble.com/kamikaze-tp23224760p23288825.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



This e-mail message, and any attachments, is intended only for the use of t=
he individual or entity identified in the alias address of this message and=
 may contain information that is confidential, privileged and subject to le=
gal restrictions and penalties regarding its unauthorized disclosure and us=
e. Any unauthorized review, copying, disclosure, use or distribution is str=
ictly prohibited. If you have received this e-mail message in error, please=
 notify the sender immediately by reply e-mail and delete this message, and=
 any attachments, from your system. Thank you.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40011-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 15:46:55 2009
Return-Path: <java-user-return-40011-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78824 invoked from network); 29 Apr 2009 15:46:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 15:46:54 -0000
Received: (qmail 72900 invoked by uid 500); 29 Apr 2009 15:46:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72784 invoked by uid 500); 29 Apr 2009 15:46:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72743 invoked by uid 99); 29 Apr 2009 15:46:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 15:46:46 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.18.71] (HELO mx3.syr.edu) (128.230.18.71)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 15:46:36 +0000
Received: from suex07-hub-02.ad.syr.edu (suex07-hub-02.ad.syr.edu [128.230.108.196])
	by mx3.syr.edu (8.14.3/8.14.3) with ESMTP id n3TFkEGY009669
	for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 11:46:14 -0400
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-02.ad.syr.edu ([fe80::813b:49a2:a4d5:6367%10]) with mapi; Wed, 29
 Apr 2009 11:46:14 -0400
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Wed, 29 Apr 2009 11:46:13 -0400
Subject: RE: Getting search score in percentage
Thread-Topic: Getting search score in percentage
Thread-Index: AcnIrbO6mpD3eZ/1QbSPckndJ9DtHQAMyq2g
Message-ID: <2D127F11DC79714E9B6A43AC9458147F13FCA46A@suex07-mbx-03.ad.syr.edu>
References: <23293764.post@talk.nabble.com>
In-Reply-To: <23293764.post@talk.nabble.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.7400:2.4.4,1.2.40,4.0.166 definitions=2009-04-29_06:2009-04-28,2009-04-29,2009-04-29 signatures=0
X-Proofpoint-Spam-Reason: safe
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Joseph,

On 4/29/2009 at 5:34 AM, joseph.christopher wrote:
> We are in a procees of changing our existing fuzzy search engine to
> lucene, but we are facing a roadblock here ie, in our existing system
> we are showing the search score in percenetage but lucene provides the
> search score in numbers which is derived from some internal logic. Can
> anybody give some tips for converting the lucene score to percentage or
> is there any way to retrive the score as percentage from lucene search.

You may be interested in the answer to the Lucene FAQ "Can I filter by scor=
e?":

<http://wiki.apache.org/lucene-java/LuceneFAQ#head-912c1f237bb0025918535318=
2948e5935f0c2f03>

Chris Hostetter's response to a similar question on this list from December=
 2004 (linked from the above FAQ) looks right on point to me:

<http://article.gmane.org/gmane.comp.jakarta.lucene.user/10810>

Steve


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40012-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 16:13:03 2009
Return-Path: <java-user-return-40012-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87187 invoked from network); 29 Apr 2009 16:13:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 16:13:03 -0000
Received: (qmail 560 invoked by uid 500); 29 Apr 2009 16:13:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 510 invoked by uid 500); 29 Apr 2009 16:13:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 500 invoked by uid 99); 29 Apr 2009 16:13:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 16:13:01 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 16:12:53 +0000
Received: by ewy27 with SMTP id 27so1452222ewy.5
        for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 09:12:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=SorAvA/8wjW6G21xhwx0YyRefcNW7QpFUn8NDh3qouM=;
        b=lqlWWDJdhP4Zkrvrkq59o4Jdv6e6qTnxg8iFnJ75popGFvDNzh6hOiqIcz4B9rYwNB
         G+p6faZoekhwBtc9sn2Oy1j9BT/JvZxmq/kzpwmhMV+FS/tLaTEQarV7yc8Dpy2Uc2K2
         JCEBxdgOpYa1rZsNkW8xhEjYzsHaNP8y7mJIg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=YURx6ZLYxPDRnbJkY1K4tapKJW2BaP6IPRiVR88azx9bU7GEAcG84RkI+gcsPWhsw4
         QzxiD9BqkPw7tznm8JkJxkx/Gxme0OG7XEiutJgZ+QvYVZG/ySLNuojIt8m9Eaw/nfXl
         k1+HVgC5GIDvjOM7uU9slrqxAB17f6Z9ijOUA=
MIME-Version: 1.0
Received: by 10.220.86.204 with SMTP id t12mr1005482vcl.32.1241021550678; Wed, 
	29 Apr 2009 09:12:30 -0700 (PDT)
In-Reply-To: <23293723.post@talk.nabble.com>
References: <23293723.post@talk.nabble.com>
Date: Wed, 29 Apr 2009 12:12:30 -0400
Message-ID: <359a92830904290912kb6a46b4vb4161d4acf6c1832@mail.gmail.com>
Subject: Re: How to het the score in percentage
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64ec9daafd7540468b3d88d
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64ec9daafd7540468b3d88d
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Would a TopDocCollector work for you? You can get a TopDoc
object from that collector, from which you can get the max score.
That, along with the score provided for each doc should give you
a percentage.

Best
Erick

On Wed, Apr 29, 2009 at 5:30 AM, joseph.christopher <joseph@kottsoftware.com
> wrote:

>
> Hi Experts,
>
> We are in a procees of changing our existing fuzzy search engine to lucene,
> but we are facing a roadblock
> here ie, in our existing system we are showing the search score in
> percenetage but lucene provides the search score in numbers which is
> derived
> from some internal logic. Can anybody give some tips for converting the
> lucene score to percentage or is there any way to retrive the score as
> percentage from lucene search.
>
> Thanks in advance.
>
>
> --
> View this message in context:
> http://www.nabble.com/How-to-het-the-score-in-percentage-tp23293723p23293723.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64ec9daafd7540468b3d88d--

From java-user-return-40013-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 17:03:35 2009
Return-Path: <java-user-return-40013-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7323 invoked from network); 29 Apr 2009 17:03:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 17:03:35 -0000
Received: (qmail 66721 invoked by uid 500); 29 Apr 2009 17:03:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66623 invoked by uid 500); 29 Apr 2009 17:03:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66613 invoked by uid 99); 29 Apr 2009 17:03:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 17:03:32 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [213.199.154.16] (HELO IE1EHSOBE004.bigfish.com) (213.199.154.16)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 17:03:23 +0000
Received: from mail20-dub-R.bigfish.com (10.5.252.3) by
 IE1EHSOBE004.bigfish.com (10.5.252.24) with Microsoft SMTP Server id
 8.1.340.0; Wed, 29 Apr 2009 17:03:00 +0000
Received: from mail20-dub (localhost.localdomain [127.0.0.1])	by
 mail20-dub-R.bigfish.com (Postfix) with ESMTP id 6324D5601EB	for
 <java-user@lucene.apache.org>; Wed, 29 Apr 2009 17:03:00 +0000 (UTC)
X-BigFish: VPS-5(zz15bfOzz1202hzzz2dh6bh43j61h)
X-Spam-TCS-SCL: 0:0
Received: by mail20-dub (MessageSwitch) id 1241024579634777_7342; Wed, 29 Apr
 2009 17:02:59 +0000 (UCT)
Received: from us-voo-smtp05.internal.sungard.corp (unknown [216.83.166.46])
	(using TLSv1 with cipher RC4-MD5 (128/128 bits))	(No client certificate
 requested)	by mail20-dub.bigfish.com (Postfix) with ESMTP id 1B8A61048051	for
 <java-user@lucene.apache.org>; Wed, 29 Apr 2009 17:02:58 +0000 (UTC)
Received: from us-voo-smtp12.internal.sungard.corp ([168.162.128.54]) by
 us-voo-smtp05.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 29 Apr 2009 13:02:44 -0400
Received: from VOO-EXCHANGE05.internal.sungard.corp ([168.162.128.69]) by
 us-voo-smtp12.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 29 Apr 2009 13:02:44 -0400
Received: from VOO-EXCHANGE04.internal.sungard.corp ([168.162.128.74]) by
 VOO-EXCHANGE05.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 29 Apr 2009 13:02:10 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: Search result ordering
Date: Wed, 29 Apr 2009 13:01:13 -0400
Message-ID: <036829964E44B44F80A0D168BB9849E1018C6F04@VOO-EXCHANGE04.internal.sungard.corp>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: Search result ordering
thread-index: AcnI7Bpg+WmodOyrTYK4QiGfncfakg==
From: <Bill.Chesky@sungard.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 29 Apr 2009 17:02:10.0874 (UTC) FILETIME=[3C7271A0:01C9C8EC]
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

I have a few questions about the ordering of search results:

1) Given a query, are the Documents contained in the Hits object that is
returned by IndexSearcher.search(Query query) guaranteed to be in the
same order from one call to the next (assuming the index has not been
updated in the meantime)?
2) Assuming I don't use the IndexSearcher.search(Query query, Sort sort)
method, is the ordering of Documents in the Hits object predictable at
all?
3) Short of using the IndexSearcher.search(Query query, Sort sort), is
there any way to influence the ordering of the Documents in the Hits
object?  E.g. is there anything that I can do when creating and/or
updating the index that will guarantee a certain ordering of results at
query time?

For what it's worth, we're using Lucene in conjuction w/ a relational
database.  Our index has an 'id' field that maps to a row in a
relational database table.  Since Lucene queries are so quick we've
found performance to be much better if we do a pure Lucene query to find
the docs we need then do a simple SQL query with a "where id in (...)"
clause.   We've also wrapped this in an interface that implements a
relational-like limit/offset functionality.  So it's important to us
that at the very least the query returns results in the same order each
time.  Ideally, we'd like to order the results on a String field we have
on each document.  This actually works, however it slows things down a
bit.  This is understandable, course -- and I'm actually very impressed
how quickly it does perform -- however, we're trying to squeeze as many
cycles as possible out it to give the best user experience.   Just
wondering if there is anything else we might try.

thanks,

Bill



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40014-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 17:27:41 2009
Return-Path: <java-user-return-40014-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17839 invoked from network); 29 Apr 2009 17:27:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 17:27:41 -0000
Received: (qmail 9585 invoked by uid 500); 29 Apr 2009 17:27:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9520 invoked by uid 500); 29 Apr 2009 17:27:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9510 invoked by uid 99); 29 Apr 2009 17:27:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 17:27:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.217.167] (HELO mail-gx0-f167.google.com) (209.85.217.167)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 17:27:30 +0000
Received: by gxk11 with SMTP id 11so2554586gxk.5
        for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 10:27:08 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.6.16 with SMTP id j16mr1814777ybi.75.1241026027844; Wed, 
	29 Apr 2009 10:27:07 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904280715m6f762016id7c2de7acb627d8@mail.gmail.com>
References: <DFE6314F5CE91344A74BD2AA612C93B69EF4ECB877@biscuit.ARDENTIASEARCH.local>
	 <9ac0c6aa0904280715m6f762016id7c2de7acb627d8@mail.gmail.com>
Date: Wed, 29 Apr 2009 13:27:07 -0400
Message-ID: <9ac0c6aa0904291027i802955duffbf7bd00e5bd96a@mail.gmail.com>
Subject: Re: Read past EOF
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I've opened https://issues.apache.org/jira/browse/LUCENE-1623 for this.

Mike

On Tue, Apr 28, 2009 at 10:15 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> Ugh, indeed FieldInfos fails to properly read 2.3.x indices if the
> field name contains non-ascii characters. =A0I'll open an issue, make a
> test case and work out a fix. =A0Hmm.
>
> Thanks for raising this!
>
> Mike
>
> On Tue, Apr 28, 2009 at 7:53 AM, Mike Streeton
> <mike.streeton@connexica.com> wrote:
>> I have an index that works fine on Lucene 2.3.2 but fails to open in 2.4=
.1, it always fails with an Read past EOF. The index does contain some fiel=
d names with german umlaut characters in
>>
>> Any ideas?
>>
>> Many Thanks
>>
>> Mike
>>
>> CheckIndex v2.3.2
>>
>>
>> NOTE: testing will be more thorough if you run java with '-ea:org.apache=
.lucene', so assertions are enabled
>>
>> Opening index @ C:/index/german
>>
>> Segments file=3Dsegments_9 numSegments=3D1 version=3DFORMAT_SHARED_DOC_S=
TORE [Lucene 2.3]
>> =A01 of 1: name=3D_3 docCount=3D235535
>> =A0 =A0compound=3Dtrue
>> =A0 =A0numFiles=3D1
>> =A0 =A0size (MB)=3D301.684
>> =A0 =A0no deletions
>> =A0 =A0test: open reader.........OK
>> =A0 =A0test: fields, norms.......OK [70 fields]
>> =A0 =A0test: terms, freq, prox...OK [1475862 terms; 25448796 terms/docs =
pairs; 28642994 tokens]
>> =A0 =A0test: stored fields.......OK [13560464 total field count; avg 57.=
573 fields per doc]
>> =A0 =A0test: term vectors........OK [0 total vector count; avg 0 term/fr=
eq vector fields per doc]
>>
>> No problems were detected with this index.
>>
>> CheckIndex v2.4.1
>>
>>
>> NOTE: testing will be more thorough if you run java with '-ea:org.apache=
.lucene...', so assertions are enabled
>>
>> Opening index @ C:/index/german
>>
>> Segments file=3Dsegments_9 numSegments=3D1 version=3DFORMAT_SHARED_DOC_S=
TORE [Lucene 2.3]
>> =A01 of 1: name=3D_3 docCount=3D235535
>> =A0 =A0compound=3Dtrue
>> =A0 =A0hasProx=3Dtrue
>> =A0 =A0numFiles=3D1
>> =A0 =A0size (MB)=3D301.684
>> =A0 =A0no deletions
>> =A0 =A0test: open reader.........FAILED
>> =A0 =A0WARNING: fixIndex() would remove reference to this segment; full =
exception:
>> java.io.IOException: read past EOF
>> =A0 =A0 =A0at org.apache.lucene.store.BufferedIndexInput.refill(Unknown =
Source)
>> =A0 =A0 =A0at org.apache.lucene.store.BufferedIndexInput.readBytes(Unkno=
wn Source)
>> =A0 =A0 =A0at org.apache.lucene.store.BufferedIndexInput.readBytes(Unkno=
wn Source)
>> =A0 =A0 =A0at org.apache.lucene.store.IndexInput.readString(Unknown Sour=
ce)
>> =A0 =A0 =A0at org.apache.lucene.index.FieldInfos.read(Unknown Source)
>> =A0 =A0 =A0at org.apache.lucene.index.FieldInfos.<init>(Unknown Source)
>> =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.initialize(Unknown S=
ource)
>> =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.get(Unknown Source)
>> =A0 =A0 =A0at org.apache.lucene.index.SegmentReader.get(Unknown Source)
>> =A0 =A0 =A0at org.apache.lucene.index.CheckIndex.checkIndex(Unknown Sour=
ce)
>> =A0 =A0 =A0at org.apache.lucene.index.CheckIndex.main(Unknown Source)
>>
>> WARNING: 1 broken segments (containing 235535 documents) detected
>> WARNING: would write new segments file, and 235535 documents would be lo=
st, if -fix were specified
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40015-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 17:46:36 2009
Return-Path: <java-user-return-40015-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27669 invoked from network); 29 Apr 2009 17:46:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 17:46:36 -0000
Received: (qmail 34669 invoked by uid 500); 29 Apr 2009 17:46:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34599 invoked by uid 500); 29 Apr 2009 17:46:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34589 invoked by uid 99); 29 Apr 2009 17:46:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 17:46:34 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.221.127 as permitted sender)
Received: from [209.85.221.127] (HELO mail-qy0-f127.google.com) (209.85.221.127)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 17:46:27 +0000
Received: by qyk33 with SMTP id 33so1186362qyk.29
        for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 10:46:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=VAlepUdpp6fIthpx8ZK0XhyoFFYBa4OOMmLrzARwdlU=;
        b=oMrXXEs26oP05vXp4aQHtzIMUPNmAq4IiIIIQuAwwTZYXeEHyw02YlpZ5RAl/aJWDu
         zFe8QKzKipglQpZuuOdMkWdi3fKuo8Vjgov9VLFRAGqoWFEqRjeSAot8oz7gOW7M2+iJ
         CnhvKlZ6anNNJ3LxX7dKRixRsIPwxKlGkXolk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Rp6bVr/gUR40THvyEHIBcblUhVI2TVezUS1WAk/MImNbvwuX0XjqY7lheTIxZTrY3v
         SJu8IVtOafq4xtU8d97s/Bel8zTfQlc7+IxFpDiSEFMQNXh3klwBlKI+jENw9ETOA6tm
         mJwH58hm56CeQptRivsM2dszqAMMhzfms45kE=
MIME-Version: 1.0
Received: by 10.220.86.204 with SMTP id t12mr1174029vcl.32.1241027165990; Wed, 
	29 Apr 2009 10:46:05 -0700 (PDT)
In-Reply-To: <036829964E44B44F80A0D168BB9849E1018C6F04@VOO-EXCHANGE04.internal.sungard.corp>
References: <036829964E44B44F80A0D168BB9849E1018C6F04@VOO-EXCHANGE04.internal.sungard.corp>
Date: Wed, 29 Apr 2009 13:46:05 -0400
Message-ID: <359a92830904291046l1a300980m50e5064b89866213@mail.gmail.com>
Subject: Re: Search result ordering
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64ec9da62b0980468b52739
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64ec9da62b0980468b52739
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

People (including me) use Lucene to page through results all the time,
so I'm pretty sure you're OK.

so here's my answers...
(1) yes.
(2) Well, the default sort is by score so if you want some other
     ordering you have to sort.
(3) You can boost things at index time, but I don't think that's at all
     relevant. What order are you trying to enforce that you know
     enough about at index time to specify?

Do note, though, that Hits is deprecated. The problem is that
Hits was intended to be reasonable *only* when accessing the first
few documents. If you're paging far into the result set, be aware that
using Hits will re-execute the entire query every 100 (200?) results you
throw away. Think about one of the HitCollectors
(perhaps TopDocCollector) instead.

Best
Erick


On Wed, Apr 29, 2009 at 1:01 PM, <Bill.Chesky@sungard.com> wrote:

> Hello,
>
> I have a few questions about the ordering of search results:
>
> 1) Given a query, are the Documents contained in the Hits object that is
> returned by IndexSearcher.search(Query query) guaranteed to be in the
> same order from one call to the next (assuming the index has not been
> updated in the meantime)?
> 2) Assuming I don't use the IndexSearcher.search(Query query, Sort sort)
> method, is the ordering of Documents in the Hits object predictable at
> all?
> 3) Short of using the IndexSearcher.search(Query query, Sort sort), is
> there any way to influence the ordering of the Documents in the Hits
> object?  E.g. is there anything that I can do when creating and/or
> updating the index that will guarantee a certain ordering of results at
> query time?
>
> For what it's worth, we're using Lucene in conjuction w/ a relational
> database.  Our index has an 'id' field that maps to a row in a
> relational database table.  Since Lucene queries are so quick we've
> found performance to be much better if we do a pure Lucene query to find
> the docs we need then do a simple SQL query with a "where id in (...)"
> clause.   We've also wrapped this in an interface that implements a
> relational-like limit/offset functionality.  So it's important to us
> that at the very least the query returns results in the same order each
> time.  Ideally, we'd like to order the results on a String field we have
> on each document.  This actually works, however it slows things down a
> bit.  This is understandable, course -- and I'm actually very impressed
> how quickly it does perform -- however, we're trying to squeeze as many
> cycles as possible out it to give the best user experience.   Just
> wondering if there is anything else we might try.
>
> thanks,
>
> Bill
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64ec9da62b0980468b52739--

From java-user-return-40016-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 19:21:30 2009
Return-Path: <java-user-return-40016-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85832 invoked from network); 29 Apr 2009 19:21:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 19:21:30 -0000
Received: (qmail 84791 invoked by uid 500); 29 Apr 2009 19:21:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84740 invoked by uid 500); 29 Apr 2009 19:21:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84730 invoked by uid 99); 29 Apr 2009 19:21:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 19:21:27 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [213.199.154.16] (HELO IE1EHSOBE001.bigfish.com) (213.199.154.16)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 19:21:16 +0000
Received: from mail59-dub-R.bigfish.com (10.5.252.3) by
 IE1EHSOBE001.bigfish.com (10.5.252.21) with Microsoft SMTP Server id
 8.1.340.0; Wed, 29 Apr 2009 19:20:55 +0000
Received: from mail59-dub (localhost.localdomain [127.0.0.1])	by
 mail59-dub-R.bigfish.com (Postfix) with ESMTP id 74617BB01FF	for
 <java-user@lucene.apache.org>; Wed, 29 Apr 2009 19:20:55 +0000 (UTC)
X-BigFish: VPS-76(zz542N1432R62a3L15bfO98dR14ffO936eQ1447R1805M936fJ9371P10d1Izz1202hzz5a6ciz2dh6bh43j61h)
X-Spam-TCS-SCL: 0:0
Received: by mail59-dub (MessageSwitch) id 124103285440869_17430; Wed, 29 Apr
 2009 19:20:54 +0000 (UCT)
Received: from us-voo-smtp04.internal.sungard.corp (unknown [216.83.166.45])
	(using TLSv1 with cipher RC4-MD5 (128/128 bits))	(No client certificate
 requested)	by mail59-dub.bigfish.com (Postfix) with ESMTP id C4EBACE0050	for
 <java-user@lucene.apache.org>; Wed, 29 Apr 2009 19:20:53 +0000 (UTC)
Received: from us-voo-smtp11.internal.sungard.corp ([168.162.128.53]) by
 us-voo-smtp04.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 29 Apr 2009 15:20:18 -0400
Received: from VOO-EXCHANGE08.internal.sungard.corp ([168.162.128.66]) by
 us-voo-smtp11.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 29 Apr 2009 15:20:14 -0400
Received: from VOO-EXCHANGE04.internal.sungard.corp ([168.162.128.74]) by
 VOO-EXCHANGE08.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 29 Apr 2009 15:20:14 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Search result ordering
Date: Wed, 29 Apr 2009 15:19:38 -0400
Message-ID: <036829964E44B44F80A0D168BB9849E1019B9E73@VOO-EXCHANGE04.internal.sungard.corp>
In-Reply-To: <359a92830904291046l1a300980m50e5064b89866213@mail.gmail.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: Search result ordering
thread-index: AcnI8nR0FZzhOzP4RWGVXPvNYcFBQAAAxytA
From: <Bill.Chesky@sungard.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 29 Apr 2009 19:20:14.0256 (UTC) FILETIME=[85BA3B00:01C9C8FF]
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Erick,

Basically, the ideal ordering is an alphabetical one based on a String =
value that is known at index creation.  I was just wondering if there =
was anything I could do at index creation time that might help me =
enforce that ordering at query time (without using a Sort).  To be =
honest, I haven't had to deal much w/ scoring in my work w/ Lucene.  Our =
app just searches based on some set of criteria and the results returned =
are all pretty much equal.  However, we want to list them alphabetically =
so they don't appear in a jumbled, seemingly random order. =20

Your comment about boost and scoring prompted me to read up a bit on it =
and it got me wondering if maybe boost could be used somehow.  E.g. once =
all the docs have been added to the index and I know the order I want, I =
could go back and set the boost for each document accordingly.  But =
maybe this is a na=EFve or innapriate use of boost.

Thanks for the tip on Hits.  We're using 2.2.0 and should probably =
upgrade.  We're at a point in development, though, where we want to keep =
new variables to a minimum.  Interestingly I don't see much of a =
difference when paging through hits 1-10 vs. hits 300-310.  They all =
seem to take about the same time to evaluate.  I'll try using one of the =
HitCollectors as you suggest to see if it makes a difference.

regards,

--
Bill Chesky=20

-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]=20
Sent: Wednesday, April 29, 2009 1:46 PM
To: java-user@lucene.apache.org
Subject: Re: Search result ordering

People (including me) use Lucene to page through results all the time,
so I'm pretty sure you're OK.

so here's my answers...
(1) yes.
(2) Well, the default sort is by score so if you want some other
     ordering you have to sort.
(3) You can boost things at index time, but I don't think that's at all
     relevant. What order are you trying to enforce that you know
     enough about at index time to specify?

Do note, though, that Hits is deprecated. The problem is that
Hits was intended to be reasonable *only* when accessing the first
few documents. If you're paging far into the result set, be aware that
using Hits will re-execute the entire query every 100 (200?) results you
throw away. Think about one of the HitCollectors
(perhaps TopDocCollector) instead.

Best
Erick


On Wed, Apr 29, 2009 at 1:01 PM, <Bill.Chesky@sungard.com> wrote:

> Hello,
>
> I have a few questions about the ordering of search results:
>
> 1) Given a query, are the Documents contained in the Hits object that =
is
> returned by IndexSearcher.search(Query query) guaranteed to be in the
> same order from one call to the next (assuming the index has not been
> updated in the meantime)?
> 2) Assuming I don't use the IndexSearcher.search(Query query, Sort =
sort)
> method, is the ordering of Documents in the Hits object predictable at
> all?
> 3) Short of using the IndexSearcher.search(Query query, Sort sort), is
> there any way to influence the ordering of the Documents in the Hits
> object?  E.g. is there anything that I can do when creating and/or
> updating the index that will guarantee a certain ordering of results =
at
> query time?
>
> For what it's worth, we're using Lucene in conjuction w/ a relational
> database.  Our index has an 'id' field that maps to a row in a
> relational database table.  Since Lucene queries are so quick we've
> found performance to be much better if we do a pure Lucene query to =
find
> the docs we need then do a simple SQL query with a "where id in (...)"
> clause.   We've also wrapped this in an interface that implements a
> relational-like limit/offset functionality.  So it's important to us
> that at the very least the query returns results in the same order =
each
> time.  Ideally, we'd like to order the results on a String field we =
have
> on each document.  This actually works, however it slows things down a
> bit.  This is understandable, course -- and I'm actually very =
impressed
> how quickly it does perform -- however, we're trying to squeeze as =
many
> cycles as possible out it to give the best user experience.   Just
> wondering if there is anything else we might try.
>
> thanks,
>
> Bill
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40017-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 20:23:02 2009
Return-Path: <java-user-return-40017-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15218 invoked from network); 29 Apr 2009 20:23:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 20:23:02 -0000
Received: (qmail 8156 invoked by uid 500); 29 Apr 2009 20:23:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8116 invoked by uid 500); 29 Apr 2009 20:22:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8106 invoked by uid 99); 29 Apr 2009 20:22:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 20:22:59 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 20:22:53 +0000
Received: by ewy27 with SMTP id 27so1611841ewy.5
        for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 13:22:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=l+/WyPFJ1COr8IeYqR+cv9tSbCnQzO1a6YkAOR4L3wU=;
        b=HWQO13W7XizsMPsf75TKna2Ns8/F9NC9BmklfFJRz4q7IuO6O9DwfGVw7ftyGdP6He
         Pr2PzZSZubnXqeGm75eNWC+nsAJ/rmbMUeu8WK6SDDUcVOVz6tqh6lBVPrzLUFHkO7RC
         7zVr2kkXLrxSg0Uw3YZ1iNY5kHQZdak9zTCTg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=lZJ5nTaQCerOcUCYJl/7TtlEL6RTu9Bx9oLdQUqASMf7dp3dRHuN9F33r9tQGLbR7O
         cEfFftvtKE5LKf194vMib6WiP9bE5ar4T2IM5s3ov73xWPdmhSl6W7yImH2N/4bz02pO
         GBDBZVuhr1PGclpRjckp+xNKrh025EMwNnfwc=
MIME-Version: 1.0
Received: by 10.220.95.202 with SMTP id e10mr1501902vcn.12.1241036550123; Wed, 
	29 Apr 2009 13:22:30 -0700 (PDT)
In-Reply-To: <036829964E44B44F80A0D168BB9849E1019B9E73@VOO-EXCHANGE04.internal.sungard.corp>
References: <359a92830904291046l1a300980m50e5064b89866213@mail.gmail.com>
	 <036829964E44B44F80A0D168BB9849E1019B9E73@VOO-EXCHANGE04.internal.sungard.corp>
Date: Wed, 29 Apr 2009 16:22:30 -0400
Message-ID: <359a92830904291322u82cca08xcb5212b1424151c9@mail.gmail.com>
Subject: Re: Search result ordering
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64eacb4b939970468b7560a
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64eacb4b939970468b7560a
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

I really doubt boosting at index time will help. All that expresses is
that "this document's title (say) is more important *when calculating score=
*
than other documents with a smaller title boost".

But since you're not searching on your key (I assume), boosting
at index time would be irrelevant to score calculations that didn't
search on your key. I doubt you want to go there...

So I think you're really back to sorting on your key, I don't know
of any other way to get what you want.

Unless you want to be really adventurous and your index is pretty
static (or at least you can regenerate the whole thing "often enough").
NOTE: this scheme *will not work* if you expect to add to and/or
update your index without rebuilding it from scratch.

In a nutshell, pre-sort your corpus and add the docs in the order
of your key. Now for your index, the following holds true:

if (key1 < key2) then (id1 < id2).

where id is the Lucene-assigned doc ID.

You can then sort the documents by INDEXORDER (see the Sort
API in the javadocs), which should, at least, be very fast and use
a minimal amount of memory. Whether this is enough of a gain
over just sorting on your key to justify the complexity I leave
as an exercise for the reader <G>.

I should stress, though, that it won't work if you alter your index
*at all* after you build it. Updating a document is really a delete/add
so after updating, that document would be at the end every time.
Similarly if you add new documents, each and every one will
be after the last document in your original index.

I suppose I should also ask whether you're really seeing
performance issues or whether this is theoretical. I'm a big
advocate of avoiding optimizations until you have a reasonable
certainty that you need it. Premature optimization and all that.

Best
Erick

On Wed, Apr 29, 2009 at 3:19 PM, <Bill.Chesky@sungard.com> wrote:

> Thanks Erick,
>
> Basically, the ideal ordering is an alphabetical one based on a String
> value that is known at index creation.  I was just wondering if there was
> anything I could do at index creation time that might help me enforce tha=
t
> ordering at query time (without using a Sort).  To be honest, I haven't h=
ad
> to deal much w/ scoring in my work w/ Lucene.  Our app just searches base=
d
> on some set of criteria and the results returned are all pretty much equa=
l.
>  However, we want to list them alphabetically so they don't appear in a
> jumbled, seemingly random order.
>
> Your comment about boost and scoring prompted me to read up a bit on it a=
nd
> it got me wondering if maybe boost could be used somehow.  E.g. once all =
the
> docs have been added to the index and I know the order I want, I could go
> back and set the boost for each document accordingly.  But maybe this is =
a
> na=EFve or innapriate use of boost.
>
> Thanks for the tip on Hits.  We're using 2.2.0 and should probably upgrad=
e.
>  We're at a point in development, though, where we want to keep new
> variables to a minimum.  Interestingly I don't see much of a difference w=
hen
> paging through hits 1-10 vs. hits 300-310.  They all seem to take about t=
he
> same time to evaluate.  I'll try using one of the HitCollectors as you
> suggest to see if it makes a difference.
>
> regards,
>
> --
> Bill Chesky
>
> -----Original Message-----
> From: Erick Erickson [mailto:erickerickson@gmail.com]
> Sent: Wednesday, April 29, 2009 1:46 PM
> To: java-user@lucene.apache.org
> Subject: Re: Search result ordering
>
> People (including me) use Lucene to page through results all the time,
> so I'm pretty sure you're OK.
>
> so here's my answers...
> (1) yes.
> (2) Well, the default sort is by score so if you want some other
>     ordering you have to sort.
> (3) You can boost things at index time, but I don't think that's at all
>     relevant. What order are you trying to enforce that you know
>     enough about at index time to specify?
>
> Do note, though, that Hits is deprecated. The problem is that
> Hits was intended to be reasonable *only* when accessing the first
> few documents. If you're paging far into the result set, be aware that
> using Hits will re-execute the entire query every 100 (200?) results you
> throw away. Think about one of the HitCollectors
> (perhaps TopDocCollector) instead.
>
> Best
> Erick
>
>
> On Wed, Apr 29, 2009 at 1:01 PM, <Bill.Chesky@sungard.com> wrote:
>
> > Hello,
> >
> > I have a few questions about the ordering of search results:
> >
> > 1) Given a query, are the Documents contained in the Hits object that i=
s
> > returned by IndexSearcher.search(Query query) guaranteed to be in the
> > same order from one call to the next (assuming the index has not been
> > updated in the meantime)?
> > 2) Assuming I don't use the IndexSearcher.search(Query query, Sort sort=
)
> > method, is the ordering of Documents in the Hits object predictable at
> > all?
> > 3) Short of using the IndexSearcher.search(Query query, Sort sort), is
> > there any way to influence the ordering of the Documents in the Hits
> > object?  E.g. is there anything that I can do when creating and/or
> > updating the index that will guarantee a certain ordering of results at
> > query time?
> >
> > For what it's worth, we're using Lucene in conjuction w/ a relational
> > database.  Our index has an 'id' field that maps to a row in a
> > relational database table.  Since Lucene queries are so quick we've
> > found performance to be much better if we do a pure Lucene query to fin=
d
> > the docs we need then do a simple SQL query with a "where id in (...)"
> > clause.   We've also wrapped this in an interface that implements a
> > relational-like limit/offset functionality.  So it's important to us
> > that at the very least the query returns results in the same order each
> > time.  Ideally, we'd like to order the results on a String field we hav=
e
> > on each document.  This actually works, however it slows things down a
> > bit.  This is understandable, course -- and I'm actually very impressed
> > how quickly it does perform -- however, we're trying to squeeze as many
> > cycles as possible out it to give the best user experience.   Just
> > wondering if there is anything else we might try.
> >
> > thanks,
> >
> > Bill
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64eacb4b939970468b7560a--

From java-user-return-40018-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 20:27:11 2009
Return-Path: <java-user-return-40018-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16508 invoked from network); 29 Apr 2009 20:27:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 20:27:11 -0000
Received: (qmail 17064 invoked by uid 500); 29 Apr 2009 20:27:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16980 invoked by uid 500); 29 Apr 2009 20:27:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16970 invoked by uid 99); 29 Apr 2009 20:27:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 20:27:08 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of MMastroianni@glgroup.com)
Received: from [216.32.181.12] (HELO WA4EHSOBE002.bigfish.com) (216.32.181.12)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 20:26:57 +0000
Received: from mail216-wa4-R.bigfish.com (10.8.14.253) by
 WA4EHSOBE002.bigfish.com (10.8.40.22) with Microsoft SMTP Server id
 8.1.340.0; Wed, 29 Apr 2009 20:26:35 +0000
Received: from mail216-wa4 (localhost.localdomain [127.0.0.1])	by
 mail216-wa4-R.bigfish.com (Postfix) with ESMTP id 9F01F172025D	for
 <java-user@lucene.apache.org>; Wed, 29 Apr 2009 20:26:35 +0000 (UTC)
X-BigFish: VPS-56(zz542NfadR1432Ra0dJ62a3L98dR168aJ4015L148cM1805M936fJ9371P4f15k19c2k8b9bk10e6izz1202hzz5a6ciz32i6bh61h)
X-Spam-TCS-SCL: 0:0
Received: by mail216-wa4 (MessageSwitch) id 1241036791996532_3214; Wed, 29 Apr
 2009 20:26:31 +0000 (UCT)
Received: from GLGNYEXSMTP02.glgroup.com (glgnyexsmtp02.glgroup.com
 [38.112.210.163])	by mail216-wa4.bigfish.com (Postfix) with ESMTP id
 AF46EC20060	for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 20:26:31
 +0000 (UTC)
Received: from GLGNYEXBE02.glgroup.com ([10.45.50.82]) by
 GLGNYEXSMTP02.glgroup.com with Microsoft SMTPSVC(6.0.3790.3959);	 Wed, 29 Apr
 2009 16:25:38 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: kamikaze
Date: Wed, 29 Apr 2009 16:27:38 -0400
Message-ID: <9008E1E80EE8A340BACCA3DFF41B21562A5007@GLGNYEXBE02.glgroup.com>
In-Reply-To: <23288825.post@talk.nabble.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: kamikaze
thread-index: AcnIZft9Hs1X51GaTJ+8gQga0TS0PAAoszRA
From: Michael Mastroianni <MMastroianni@glgroup.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 29 Apr 2009 20:25:38.0471 (UTC) FILETIME=[A8BDEB70:01C9C908]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Anmol--

I think I may have found a problem in AndDocIdSet. I got it to pass some
simple tests, and was in the process of integration, when some of my
tests started to fail right after I had replaced a bunch of OpenBitSet
intersections with creating a list of P4DocIdSets and then creating an
AndDocIdSet from the list. I've created a unit test which I think
illustrates the problem:

regards,
Michael

import java.io.IOException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashSet;
import java.util.Random;

import org.apache.lucene.search.DocIdSet;
import org.apache.lucene.search.DocIdSetIterator;
import org.apache.lucene.util.OpenBitSet;


import com.kamikaze.docidset.api.DocSet;
import com.kamikaze.docidset.impl.AndDocIdSet;
import com.kamikaze.docidset.impl.OrDocIdSet;
import com.kamikaze.docidset.impl.P4DDocIdSet;
import com.kamikaze.docidset.utils.DocSetFactory;


import junit.framework.TestCase;

public class KamikazeTest extends TestCase
{
	public static OpenBitSet createObs(ArrayList<Integer> ints, int
maxDoc)
	{
		OpenBitSet obs =3D new OpenBitSet(maxDoc);
		for (Integer integer : ints) =

		{
			obs.set(integer);
		}
		return obs;
	}
	=

	public static DocSet createDocSet(ArrayList<Integer> ints)
	{
		DocSet ret =3D new P4DDocIdSet();
		for (Integer integer : ints) =

		{
			ret.addDoc(integer);
		}
		return ret;
	}
	=

	public void testMultipleIntersections()
	{
		ArrayList<OpenBitSet> obs =3D new ArrayList<OpenBitSet>();
		ArrayList<DocIdSet> docs =3D new ArrayList<DocIdSet>();
	    Random rand =3D new Random(System.currentTimeMillis());
		int maxDoc =3D 350000;
		{
			int numdocs =3D rand.nextInt(maxDoc);
			ArrayList<Integer> nums =3D new
ArrayList<Integer>();
			HashSet<Integer> seen =3D new HashSet<Integer>();
			for (int j =3D 0; j < numdocs; j++) =

		    {
				int nextDoc =3D rand.nextInt(maxDoc);
				if(seen.contains(nextDoc))
				{
					while(seen.contains(nextDoc))
					{
						nextDoc =3D
rand.nextInt(maxDoc);
					}
				}
				nums.add(nextDoc);
		    }
			Collections.sort(nums);
			obs.add(createObs(nums, maxDoc));
			docs.add(createDocSet(nums));
		}
		OpenBitSet base =3D obs.get(0);
		for(int i =3D 1; i < obs.size(); ++i)
		{
			base.intersect(obs.get(i));
		}
		=

		AndDocIdSet ands =3D new AndDocIdSet(docs);
		long card1 =3D base.cardinality();
		long card2 =3D ands.size();
		=

        assertTrue(card1 =3D=3D card2);
        //When I run this, it fails every time, where I =

        //would expect openBitSet and AndDocIdSet to produce
        //the same cardinalities from this run of intersections
        //one example run got card1=3D101946 and card2=3D120384
        //card2 was larger on all runs i did
	}
}

-----Original Message-----
From: molz [mailto:anmol.bhasin@gmail.com] =

Sent: Tuesday, April 28, 2009 9:00 PM
To: java-user@lucene.apache.org
Subject: RE: kamikaze


Hi Micheal,

Thanks for trying out Kamikaze for starters. So I guess there are a few
issues here

1. getDocSetInstance(int min, max, count,DocSetFactory.FOCUS) assumes
that
count < max. I guess thats an API check we should add anyways to improve
usability. That is not to say that it will not work if count > max but
we
have not done the due diligence on that one.

2. The way you are inserting the elements is not quite right. The addDoc
method assumes you insert the elements in a sorted fashion. Calling
doc.addDoc(rand.nextInt(maxDoc) does not quite ensure you are loading
the
docSet in a sorted fashion. This is specially useful in BitSet and P4D
set
cases as P4D encodes only delta values between conscutive integers.

3. I would recommend using FOCUS.OPTIMAL for best performance/space
tradeoff, albeit SPACE should work too, if you find any issues with that
let
us know, we will be glad to fix it.

4. Finally, I believe you want to just get a plain vanilla docSet from
one
of the OR/AND sets. This would be cool to do, however the idea with
Boolean
Sets are that they are never really materialized, they are iterated over
on
the fly. I believe we could do an enhancement to construct the docSet on
the
fly while iterating the Boolean DocSet but as of now there is no
established
way of doing that.

Hope I covered all your concerns. I rewrote and run your test case like
this

public class KamikazeTest extends TestCase
{
    public void testGrowingP4()
    {
        DocSet doc =3D
            DocSetFactory.getDocSetInstance(0, 35000000, 200000,
DocSetFactory.FOCUS.SPACE);
        Random rand =3D new Random(System.currentTimeMillis());
       // int maxDoc =3D 3500000;
        //doc.addDoc(0);
        =

        int i =3D 0;
        try
        {
            while(i < 500000)
            {
                int nextDoc =3D i;
                doc.addDoc(nextDoc);
                i+=3Drand.nextInt(50);
            }              =

        }
        catch(Exception e)
        {
            e.printStackTrace();
            return;
        }
        assertTrue(true);
       =

    }
    =

   =

} =


Thanks,
Anmol

Software Engineer
Anmol Bhasin
www.linkedin.com



Michael Mastroianni wrote:
> =

> Hi--
> =

> I just got kamikaze somewhat integrated into a project of mine. I'm
> having problems growing the DocIdSets, though. Up to the point where
the
> first regrow happens, everything is fine. Once the regrow happens, I
get
> an ArrayOutOfBoundsException. The following unit test will exhibit
this
> behavior. If I change the third param of getDocSetInstance to be
> something lower, I get a p4Doc, if I leave it as is, I get an
OpenBitSet
> doc, in either case, I get the same crash. Do I need to initialize the
> docs in some way other than just creating them?
> =

> regards,
> Michael
> =

> import org.apache.lucene.search.DocIdSet;
> import org.apache.lucene.util.OpenBitSet;
> =

> =

> import com.kamikaze.docidset.api.DocSet;
> import com.kamikaze.docidset.impl.AndDocIdSet;
> import com.kamikaze.docidset.impl.OrDocIdSet;
> import com.kamikaze.docidset.utils.DocSetFactory;
> =

> import junit.framework.TestCase;
> =

> =

> public class KamikazeTest extends TestCase
> {
>     public void testGrowingP4()
>     {
>         DocSet doc =3D
>             DocSetFactory.getDocSetInstance(0, 350000, 3000000,
> DocSetFactory.FOCUS.SPACE);
>         Random rand =3D new Random(System.currentTimeMillis());
>         int maxDoc =3D 350000;
>         doc.addDoc(rand.nextInt(maxDoc));
>         int i =3D 0;
>         try
>         {
>             while(i < 256)
>             {
>                 int nextDoc =3D rand.nextInt(maxDoc);
>                 doc.addDoc(nextDoc);
>                 ++i;
>             }               =

>         }
>         catch(Exception e)
>         {
>             return;
>         }
>         assertTrue(false);
>     }
> }
> =

> -----Original Message-----
> From: John Wang [mailto:john.wang@gmail.com] =

> Sent: Friday, April 24, 2009 7:50 PM
> To: java-user@lucene.apache.org
> Subject: Re: kamikaze
> =

> Hi Michael:
>     We are using it internally here at LinkedIn for both our search
> engine
> as well as our social graph engine. And we have a team developing
> actively
> on it. Let us know how we can help you.
> =

> -John
> =

> On Fri, Apr 24, 2009 at 1:56 PM, Michael Mastroianni <
> MMastroianni@glgroup.com> wrote:
> =

>> Hi--
>>
>>
>>
>> Has anyone here used kamikaze much? I'm interested in using it in
>> situations where I'll have several docidsets of >2M, plus several in
> the
>> 10s of thousands.
>>
>>
>>
>> On prototype basis, I got something running nicely using OpenBitSet,
> but
>> I can't use that much memory for my real application.
>>
>>
>>
>> regards,
>>
>> Michael Mastroianni
>>
>>
>>
>> This e-mail message, and any attachments, is intended only for the
use
> of
>> the individual or entity identified in the alias address of this
> message and
>> may contain information that is confidential, privileged and subject
> to
>> legal restrictions and penalties regarding its unauthorized
disclosure
> and
>> use. Any unauthorized review, copying, disclosure, use or
distribution
> is
>> strictly prohibited. If you have received this e-mail message in
> error,
>> please notify the sender immediately by reply e-mail and delete this
>> message, and any attachments, from your system. Thank you.
>>
>>
> =

> This e-mail message, and any attachments, is intended only for the use
of
> the individual or entity identified in the alias address of this
message
> and may contain information that is confidential, privileged and
subject
> to legal restrictions and penalties regarding its unauthorized
disclosure
> and use. Any unauthorized review, copying, disclosure, use or
distribution
> is strictly prohibited. If you have received this e-mail message in
error,
> please notify the sender immediately by reply e-mail and delete this
> message, and any attachments, from your system. Thank you.
> =

> =

> =

> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> =

> =

> =


-- =

View this message in context:
http://www.nabble.com/kamikaze-tp23224760p23288825.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



This e-mail message, and any attachments, is intended only for the use of t=
he individual or entity identified in the alias address of this message and=
 may contain information that is confidential, privileged and subject to le=
gal restrictions and penalties regarding its unauthorized disclosure and us=
e. Any unauthorized review, copying, disclosure, use or distribution is str=
ictly prohibited. If you have received this e-mail message in error, please=
 notify the sender immediately by reply e-mail and delete this message, and=
 any attachments, from your system. Thank you.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40019-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 21:21:35 2009
Return-Path: <java-user-return-40019-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36265 invoked from network); 29 Apr 2009 21:21:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 21:21:32 -0000
Received: (qmail 98191 invoked by uid 500); 29 Apr 2009 21:21:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98105 invoked by uid 500); 29 Apr 2009 21:21:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98095 invoked by uid 99); 29 Apr 2009 21:21:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 21:21:30 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of MMastroianni@glgroup.com)
Received: from [216.32.181.13] (HELO WA4EHSOBE003.bigfish.com) (216.32.181.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 21:21:18 +0000
Received: from mail218-wa4-R.bigfish.com (10.8.14.243) by
 WA4EHSOBE003.bigfish.com (10.8.40.23) with Microsoft SMTP Server id
 8.1.340.0; Wed, 29 Apr 2009 21:20:56 +0000
Received: from mail218-wa4 (localhost.localdomain [127.0.0.1])	by
 mail218-wa4-R.bigfish.com (Postfix) with ESMTP id A7084208318	for
 <java-user@lucene.apache.org>; Wed, 29 Apr 2009 21:20:56 +0000 (UTC)
X-BigFish: VPS-56(zz542NfadR1432Ra0dJ62a3L98dR168aJ4015L148cM1805M936fJ9371P4f15k19c2k8b9bk10e6izz1202hzz5a6ciz32i6bh61h)
X-Spam-TCS-SCL: 0:0
X-FB-SS: 5,
Received: by mail218-wa4 (MessageSwitch) id 1241040053687126_10166; Wed, 29
 Apr 2009 21:20:53 +0000 (UCT)
Received: from GLGNYEXSMTP01.glgroup.com (glgnyexsmtp01.glgroup.com
 [38.112.210.160])	by mail218-wa4.bigfish.com (Postfix) with ESMTP id
 7A12F860050	for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 21:20:53
 +0000 (UTC)
Received: from GLGNYEXBE02.glgroup.com ([10.45.50.82]) by
 GLGNYEXSMTP01.glgroup.com with Microsoft SMTPSVC(6.0.3790.3959);	 Wed, 29 Apr
 2009 17:20:53 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: kamikaze
Date: Wed, 29 Apr 2009 17:22:53 -0400
Message-ID: <9008E1E80EE8A340BACCA3DFF41B21562A5017@GLGNYEXBE02.glgroup.com>
In-Reply-To: <9008E1E80EE8A340BACCA3DFF41B21562A5007@GLGNYEXBE02.glgroup.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: kamikaze
thread-index: AcnIZft9Hs1X51GaTJ+8gQga0TS0PAAoszRAAAHqcqA=
From: Michael Mastroianni <MMastroianni@glgroup.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 29 Apr 2009 21:20:53.0210 (UTC) FILETIME=[607AF3A0:01C9C910]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Anmol--
Sorry, there was a typo in the main function of my unit test: here is a
correct version (the utility functions remain the same).

	public void testMultipleIntersections()
	{
		ArrayList<OpenBitSet> obs =3D new ArrayList<OpenBitSet>();
		ArrayList<DocIdSet> docs =3D new ArrayList<DocIdSet>();
	    Random rand =3D new Random(System.currentTimeMillis());
		int maxDoc =3D 350000;
		for(int i=3D0; i < 3; ++i)
		{
			int numdocs =3D rand.nextInt(maxDoc);
			ArrayList<Integer> nums =3D new
ArrayList<Integer>();
			HashSet<Integer> seen =3D new HashSet<Integer>();
			for (int j =3D 0; j < numdocs; j++) =

		    {
				int nextDoc =3D rand.nextInt(maxDoc);
				if(seen.contains(nextDoc))
				{
					while(seen.contains(nextDoc))
					{
						nextDoc =3D
rand.nextInt(maxDoc);
					}
				}
				nums.add(nextDoc);
				seen.add(nextDoc);
		    }
			Collections.sort(nums);
			obs.add(createObs(nums, maxDoc));
			docs.add(createDocSet(nums));
		}
		OpenBitSet base =3D obs.get(0);
		for(int i =3D 1; i < obs.size(); ++i)
		{
			base.intersect(obs.get(i));
		}
		=

		AndDocIdSet ands =3D new AndDocIdSet(docs);
		long card1 =3D base.cardinality();
		long card2 =3D ands.size();
		=

		assertEquals(card1, card2);
	}



-----Original Message-----
From: Michael Mastroianni [mailto:MMastroianni@glgroup.com] =

Sent: Wednesday, April 29, 2009 4:28 PM
To: java-user@lucene.apache.org
Subject: RE: kamikaze

Hi Anmol--

I think I may have found a problem in AndDocIdSet. I got it to pass some
simple tests, and was in the process of integration, when some of my
tests started to fail right after I had replaced a bunch of OpenBitSet
intersections with creating a list of P4DocIdSets and then creating an
AndDocIdSet from the list. I've created a unit test which I think
illustrates the problem:

regards,
Michael

import java.io.IOException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashSet;
import java.util.Random;

import org.apache.lucene.search.DocIdSet;
import org.apache.lucene.search.DocIdSetIterator;
import org.apache.lucene.util.OpenBitSet;


import com.kamikaze.docidset.api.DocSet;
import com.kamikaze.docidset.impl.AndDocIdSet;
import com.kamikaze.docidset.impl.OrDocIdSet;
import com.kamikaze.docidset.impl.P4DDocIdSet;
import com.kamikaze.docidset.utils.DocSetFactory;


import junit.framework.TestCase;

public class KamikazeTest extends TestCase
{
	public static OpenBitSet createObs(ArrayList<Integer> ints, int
maxDoc)
	{
		OpenBitSet obs =3D new OpenBitSet(maxDoc);
		for (Integer integer : ints) =

		{
			obs.set(integer);
		}
		return obs;
	}
	=

	public static DocSet createDocSet(ArrayList<Integer> ints)
	{
		DocSet ret =3D new P4DDocIdSet();
		for (Integer integer : ints) =

		{
			ret.addDoc(integer);
		}
		return ret;
	}
	=

	public void testMultipleIntersections()
	{
		ArrayList<OpenBitSet> obs =3D new ArrayList<OpenBitSet>();
		ArrayList<DocIdSet> docs =3D new ArrayList<DocIdSet>();
	    Random rand =3D new Random(System.currentTimeMillis());
		int maxDoc =3D 350000;
		{
			int numdocs =3D rand.nextInt(maxDoc);
			ArrayList<Integer> nums =3D new
ArrayList<Integer>();
			HashSet<Integer> seen =3D new HashSet<Integer>();
			for (int j =3D 0; j < numdocs; j++) =

		    {
				int nextDoc =3D rand.nextInt(maxDoc);
				if(seen.contains(nextDoc))
				{
					while(seen.contains(nextDoc))
					{
						nextDoc =3D
rand.nextInt(maxDoc);
					}
				}
				nums.add(nextDoc);
		    }
			Collections.sort(nums);
			obs.add(createObs(nums, maxDoc));
			docs.add(createDocSet(nums));
		}
		OpenBitSet base =3D obs.get(0);
		for(int i =3D 1; i < obs.size(); ++i)
		{
			base.intersect(obs.get(i));
		}
		=

		AndDocIdSet ands =3D new AndDocIdSet(docs);
		long card1 =3D base.cardinality();
		long card2 =3D ands.size();
		=

        assertTrue(card1 =3D=3D card2);
        //When I run this, it fails every time, where I =

        //would expect openBitSet and AndDocIdSet to produce
        //the same cardinalities from this run of intersections
        //one example run got card1=3D101946 and card2=3D120384
        //card2 was larger on all runs i did
	}
}

-----Original Message-----
From: molz [mailto:anmol.bhasin@gmail.com] =

Sent: Tuesday, April 28, 2009 9:00 PM
To: java-user@lucene.apache.org
Subject: RE: kamikaze


Hi Micheal,

Thanks for trying out Kamikaze for starters. So I guess there are a few
issues here

1. getDocSetInstance(int min, max, count,DocSetFactory.FOCUS) assumes
that
count < max. I guess thats an API check we should add anyways to improve
usability. That is not to say that it will not work if count > max but
we
have not done the due diligence on that one.

2. The way you are inserting the elements is not quite right. The addDoc
method assumes you insert the elements in a sorted fashion. Calling
doc.addDoc(rand.nextInt(maxDoc) does not quite ensure you are loading
the
docSet in a sorted fashion. This is specially useful in BitSet and P4D
set
cases as P4D encodes only delta values between conscutive integers.

3. I would recommend using FOCUS.OPTIMAL for best performance/space
tradeoff, albeit SPACE should work too, if you find any issues with that
let
us know, we will be glad to fix it.

4. Finally, I believe you want to just get a plain vanilla docSet from
one
of the OR/AND sets. This would be cool to do, however the idea with
Boolean
Sets are that they are never really materialized, they are iterated over
on
the fly. I believe we could do an enhancement to construct the docSet on
the
fly while iterating the Boolean DocSet but as of now there is no
established
way of doing that.

Hope I covered all your concerns. I rewrote and run your test case like
this

public class KamikazeTest extends TestCase
{
    public void testGrowingP4()
    {
        DocSet doc =3D
            DocSetFactory.getDocSetInstance(0, 35000000, 200000,
DocSetFactory.FOCUS.SPACE);
        Random rand =3D new Random(System.currentTimeMillis());
       // int maxDoc =3D 3500000;
        //doc.addDoc(0);
        =

        int i =3D 0;
        try
        {
            while(i < 500000)
            {
                int nextDoc =3D i;
                doc.addDoc(nextDoc);
                i+=3Drand.nextInt(50);
            }              =

        }
        catch(Exception e)
        {
            e.printStackTrace();
            return;
        }
        assertTrue(true);
       =

    }
    =

   =

} =


Thanks,
Anmol

Software Engineer
Anmol Bhasin
www.linkedin.com



Michael Mastroianni wrote:
> =

> Hi--
> =

> I just got kamikaze somewhat integrated into a project of mine. I'm
> having problems growing the DocIdSets, though. Up to the point where
the
> first regrow happens, everything is fine. Once the regrow happens, I
get
> an ArrayOutOfBoundsException. The following unit test will exhibit
this
> behavior. If I change the third param of getDocSetInstance to be
> something lower, I get a p4Doc, if I leave it as is, I get an
OpenBitSet
> doc, in either case, I get the same crash. Do I need to initialize the
> docs in some way other than just creating them?
> =

> regards,
> Michael
> =

> import org.apache.lucene.search.DocIdSet;
> import org.apache.lucene.util.OpenBitSet;
> =

> =

> import com.kamikaze.docidset.api.DocSet;
> import com.kamikaze.docidset.impl.AndDocIdSet;
> import com.kamikaze.docidset.impl.OrDocIdSet;
> import com.kamikaze.docidset.utils.DocSetFactory;
> =

> import junit.framework.TestCase;
> =

> =

> public class KamikazeTest extends TestCase
> {
>     public void testGrowingP4()
>     {
>         DocSet doc =3D
>             DocSetFactory.getDocSetInstance(0, 350000, 3000000,
> DocSetFactory.FOCUS.SPACE);
>         Random rand =3D new Random(System.currentTimeMillis());
>         int maxDoc =3D 350000;
>         doc.addDoc(rand.nextInt(maxDoc));
>         int i =3D 0;
>         try
>         {
>             while(i < 256)
>             {
>                 int nextDoc =3D rand.nextInt(maxDoc);
>                 doc.addDoc(nextDoc);
>                 ++i;
>             }               =

>         }
>         catch(Exception e)
>         {
>             return;
>         }
>         assertTrue(false);
>     }
> }
> =

> -----Original Message-----
> From: John Wang [mailto:john.wang@gmail.com] =

> Sent: Friday, April 24, 2009 7:50 PM
> To: java-user@lucene.apache.org
> Subject: Re: kamikaze
> =

> Hi Michael:
>     We are using it internally here at LinkedIn for both our search
> engine
> as well as our social graph engine. And we have a team developing
> actively
> on it. Let us know how we can help you.
> =

> -John
> =

> On Fri, Apr 24, 2009 at 1:56 PM, Michael Mastroianni <
> MMastroianni@glgroup.com> wrote:
> =

>> Hi--
>>
>>
>>
>> Has anyone here used kamikaze much? I'm interested in using it in
>> situations where I'll have several docidsets of >2M, plus several in
> the
>> 10s of thousands.
>>
>>
>>
>> On prototype basis, I got something running nicely using OpenBitSet,
> but
>> I can't use that much memory for my real application.
>>
>>
>>
>> regards,
>>
>> Michael Mastroianni
>>
>>
>>
>> This e-mail message, and any attachments, is intended only for the
use
> of
>> the individual or entity identified in the alias address of this
> message and
>> may contain information that is confidential, privileged and subject
> to
>> legal restrictions and penalties regarding its unauthorized
disclosure
> and
>> use. Any unauthorized review, copying, disclosure, use or
distribution
> is
>> strictly prohibited. If you have received this e-mail message in
> error,
>> please notify the sender immediately by reply e-mail and delete this
>> message, and any attachments, from your system. Thank you.
>>
>>
> =

> This e-mail message, and any attachments, is intended only for the use
of
> the individual or entity identified in the alias address of this
message
> and may contain information that is confidential, privileged and
subject
> to legal restrictions and penalties regarding its unauthorized
disclosure
> and use. Any unauthorized review, copying, disclosure, use or
distribution
> is strictly prohibited. If you have received this e-mail message in
error,
> please notify the sender immediately by reply e-mail and delete this
> message, and any attachments, from your system. Thank you.
> =

> =

> =

> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> =

> =

> =


-- =

View this message in context:
http://www.nabble.com/kamikaze-tp23224760p23288825.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



This e-mail message, and any attachments, is intended only for the use
of the individual or entity identified in the alias address of this
message and may contain information that is confidential, privileged and
subject to legal restrictions and penalties regarding its unauthorized
disclosure and use. Any unauthorized review, copying, disclosure, use or
distribution is strictly prohibited. If you have received this e-mail
message in error, please notify the sender immediately by reply e-mail
and delete this message, and any attachments, from your system. Thank
you.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



This e-mail message, and any attachments, is intended only for the use of t=
he individual or entity identified in the alias address of this message and=
 may contain information that is confidential, privileged and subject to le=
gal restrictions and penalties regarding its unauthorized disclosure and us=
e. Any unauthorized review, copying, disclosure, use or distribution is str=
ictly prohibited. If you have received this e-mail message in error, please=
 notify the sender immediately by reply e-mail and delete this message, and=
 any attachments, from your system. Thank you.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40020-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 21:24:38 2009
Return-Path: <java-user-return-40020-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38648 invoked from network); 29 Apr 2009 21:24:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 21:24:37 -0000
Received: (qmail 3313 invoked by uid 500); 29 Apr 2009 21:24:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3230 invoked by uid 500); 29 Apr 2009 21:24:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3215 invoked by uid 99); 29 Apr 2009 21:24:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 21:24:35 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [216.32.181.15] (HELO WA4EHSOBE005.bigfish.com) (216.32.181.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 21:24:25 +0000
Received: from mail155-wa4-R.bigfish.com (10.8.14.245) by
 WA4EHSOBE005.bigfish.com (10.8.40.25) with Microsoft SMTP Server id
 8.1.340.0; Wed, 29 Apr 2009 21:24:04 +0000
Received: from mail155-wa4 (localhost.localdomain [127.0.0.1])	by
 mail155-wa4-R.bigfish.com (Postfix) with ESMTP id 9705F162829B	for
 <java-user@lucene.apache.org>; Wed, 29 Apr 2009 21:24:04 +0000 (UTC)
X-BigFish: VPS-81(zz14c3M542N1432R62a3L15bfO98dR14ffO936eQ1447R1805M936fJ9371P10d1Izz1202hzz5a6ciz2dh6bh43j61h)
X-Spam-TCS-SCL: 0:0
X-FB-SS: 5,
Received: by mail155-wa4 (MessageSwitch) id 1241040241747099_28712; Wed, 29
 Apr 2009 21:24:01 +0000 (UCT)
Received: from us-voo-smtp05.internal.sungard.corp (unknown [216.83.166.46])
	(using TLSv1 with cipher RC4-MD5 (128/128 bits))	(No client certificate
 requested)	by mail155-wa4.bigfish.com (Postfix) with ESMTP id 76713147005A
	for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 21:24:01 +0000 (UTC)
Received: from us-voo-smtp12.internal.sungard.corp ([168.162.128.54]) by
 us-voo-smtp05.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 29 Apr 2009 17:24:00 -0400
Received: from VOO-EXCHANGE06.internal.sungard.corp ([168.162.128.70]) by
 us-voo-smtp12.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 29 Apr 2009 17:24:00 -0400
Received: from VOO-EXCHANGE04.internal.sungard.corp ([168.162.128.74]) by
 VOO-EXCHANGE06.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 29 Apr 2009 17:23:56 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Search result ordering
Date: Wed, 29 Apr 2009 17:23:10 -0400
Message-ID: <036829964E44B44F80A0D168BB9849E1019B9F2A@VOO-EXCHANGE04.internal.sungard.corp>
In-Reply-To: <359a92830904291322u82cca08xcb5212b1424151c9@mail.gmail.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: Search result ordering
thread-index: AcnJCFHirvNYLUhLRIi7IwRmnuUbJgABxYHw
From: <Bill.Chesky@sungard.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 29 Apr 2009 21:23:56.0120 (UTC) FILETIME=[CD80CD80:01C9C910]
X-Virus-Checked: Checked by ClamAV on apache.org

Unfortunately we do periodically add Documents to our index.  However, I =
wasn't aware of the Lucene-assigned doc ID or Sort.INDEXORDER.  This is =
good information to know.  Who knows, we might be able to refactor =
things to use this method. =20

Regarding performance, yes I have actually seen some differences.  With =
no sort at all the query is lightning fast, like a tenth of a second.  =
With the String sort it varies from about 1.5 - 3 seconds.  I also tried =
sorting on an integer field.  This consistently takes about 1 second.  =
These numbers are not terrible.  Again, I'm pretty impressed how fast it =
completes with a sort given how many hits we get sometimes.  Just trying =
to see if we could squeeze some more cycles out of it.

Thanks for the help.

regards,

Bill Chesky

-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]=20
Sent: Wednesday, April 29, 2009 4:23 PM
To: java-user@lucene.apache.org
Subject: Re: Search result ordering

I really doubt boosting at index time will help. All that expresses is
that "this document's title (say) is more important *when calculating =
score*
than other documents with a smaller title boost".

But since you're not searching on your key (I assume), boosting
at index time would be irrelevant to score calculations that didn't
search on your key. I doubt you want to go there...

So I think you're really back to sorting on your key, I don't know
of any other way to get what you want.

Unless you want to be really adventurous and your index is pretty
static (or at least you can regenerate the whole thing "often enough").
NOTE: this scheme *will not work* if you expect to add to and/or
update your index without rebuilding it from scratch.

In a nutshell, pre-sort your corpus and add the docs in the order
of your key. Now for your index, the following holds true:

if (key1 < key2) then (id1 < id2).

where id is the Lucene-assigned doc ID.

You can then sort the documents by INDEXORDER (see the Sort
API in the javadocs), which should, at least, be very fast and use
a minimal amount of memory. Whether this is enough of a gain
over just sorting on your key to justify the complexity I leave
as an exercise for the reader <G>.

I should stress, though, that it won't work if you alter your index
*at all* after you build it. Updating a document is really a delete/add
so after updating, that document would be at the end every time.
Similarly if you add new documents, each and every one will
be after the last document in your original index.

I suppose I should also ask whether you're really seeing
performance issues or whether this is theoretical. I'm a big
advocate of avoiding optimizations until you have a reasonable
certainty that you need it. Premature optimization and all that.

Best
Erick

On Wed, Apr 29, 2009 at 3:19 PM, <Bill.Chesky@sungard.com> wrote:

> Thanks Erick,
>
> Basically, the ideal ordering is an alphabetical one based on a String
> value that is known at index creation.  I was just wondering if there =
was
> anything I could do at index creation time that might help me enforce =
that
> ordering at query time (without using a Sort).  To be honest, I =
haven't had
> to deal much w/ scoring in my work w/ Lucene.  Our app just searches =
based
> on some set of criteria and the results returned are all pretty much =
equal.
>  However, we want to list them alphabetically so they don't appear in =
a
> jumbled, seemingly random order.
>
> Your comment about boost and scoring prompted me to read up a bit on =
it and
> it got me wondering if maybe boost could be used somehow.  E.g. once =
all the
> docs have been added to the index and I know the order I want, I could =
go
> back and set the boost for each document accordingly.  But maybe this =
is a
> na=EFve or innapriate use of boost.
>
> Thanks for the tip on Hits.  We're using 2.2.0 and should probably =
upgrade.
>  We're at a point in development, though, where we want to keep new
> variables to a minimum.  Interestingly I don't see much of a =
difference when
> paging through hits 1-10 vs. hits 300-310.  They all seem to take =
about the
> same time to evaluate.  I'll try using one of the HitCollectors as you
> suggest to see if it makes a difference.
>
> regards,
>
> --
> Bill Chesky
>
> -----Original Message-----
> From: Erick Erickson [mailto:erickerickson@gmail.com]
> Sent: Wednesday, April 29, 2009 1:46 PM
> To: java-user@lucene.apache.org
> Subject: Re: Search result ordering
>
> People (including me) use Lucene to page through results all the time,
> so I'm pretty sure you're OK.
>
> so here's my answers...
> (1) yes.
> (2) Well, the default sort is by score so if you want some other
>     ordering you have to sort.
> (3) You can boost things at index time, but I don't think that's at =
all
>     relevant. What order are you trying to enforce that you know
>     enough about at index time to specify?
>
> Do note, though, that Hits is deprecated. The problem is that
> Hits was intended to be reasonable *only* when accessing the first
> few documents. If you're paging far into the result set, be aware that
> using Hits will re-execute the entire query every 100 (200?) results =
you
> throw away. Think about one of the HitCollectors
> (perhaps TopDocCollector) instead.
>
> Best
> Erick
>
>
> On Wed, Apr 29, 2009 at 1:01 PM, <Bill.Chesky@sungard.com> wrote:
>
> > Hello,
> >
> > I have a few questions about the ordering of search results:
> >
> > 1) Given a query, are the Documents contained in the Hits object =
that is
> > returned by IndexSearcher.search(Query query) guaranteed to be in =
the
> > same order from one call to the next (assuming the index has not =
been
> > updated in the meantime)?
> > 2) Assuming I don't use the IndexSearcher.search(Query query, Sort =
sort)
> > method, is the ordering of Documents in the Hits object predictable =
at
> > all?
> > 3) Short of using the IndexSearcher.search(Query query, Sort sort), =
is
> > there any way to influence the ordering of the Documents in the Hits
> > object?  E.g. is there anything that I can do when creating and/or
> > updating the index that will guarantee a certain ordering of results =
at
> > query time?
> >
> > For what it's worth, we're using Lucene in conjuction w/ a =
relational
> > database.  Our index has an 'id' field that maps to a row in a
> > relational database table.  Since Lucene queries are so quick we've
> > found performance to be much better if we do a pure Lucene query to =
find
> > the docs we need then do a simple SQL query with a "where id in =
(...)"
> > clause.   We've also wrapped this in an interface that implements a
> > relational-like limit/offset functionality.  So it's important to us
> > that at the very least the query returns results in the same order =
each
> > time.  Ideally, we'd like to order the results on a String field we =
have
> > on each document.  This actually works, however it slows things down =
a
> > bit.  This is understandable, course -- and I'm actually very =
impressed
> > how quickly it does perform -- however, we're trying to squeeze as =
many
> > cycles as possible out it to give the best user experience.   Just
> > wondering if there is anything else we might try.
> >
> > thanks,
> >
> > Bill
> >
> >
> >
> > =
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40021-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Apr 29 21:58:53 2009
Return-Path: <java-user-return-40021-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59360 invoked from network); 29 Apr 2009 21:58:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Apr 2009 21:58:53 -0000
Received: (qmail 50936 invoked by uid 500); 29 Apr 2009 21:58:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50863 invoked by uid 500); 29 Apr 2009 21:58:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50853 invoked by uid 99); 29 Apr 2009 21:58:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 21:58:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 29 Apr 2009 21:58:41 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LzHnI-0006GU-EA
	for java-user@lucene.apache.org; Wed, 29 Apr 2009 14:58:20 -0700
Message-ID: <23302407.post@talk.nabble.com>
Date: Wed, 29 Apr 2009 14:58:20 -0700 (PDT)
From: molz <anmol.bhasin@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: kamikaze
In-Reply-To: <9008E1E80EE8A340BACCA3DFF41B21562A4F5E@GLGNYEXBE02.glgroup.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: anmol.bhasin@gmail.com
References: <9008E1E80EE8A340BACCA3DFF41B21562A4C9A@GLGNYEXBE02.glgroup.com> <8837fb770904241649i6beb28e5i770eca9c50b5d8e5@mail.gmail.com> <9008E1E80EE8A340BACCA3DFF41B21562A4E18@GLGNYEXBE02.glgroup.com> <23288825.post@talk.nabble.com> <9008E1E80EE8A340BACCA3DFF41B21562A4F5E@GLGNYEXBE02.glgroup.com>
X-Virus-Checked: Checked by ClamAV on apache.org



Hi Michael,

Ah! I think we may have hit a regression bug here. We have identified the
problem, the fix is rather simple and we were already in the process of
getting a performance enhancement out in a day or two. Would it be useful to
you if push in the bug fix as a part of that release. Alternately, we can
provide a patch with the fix and you could take a snapshot (which is
generally a bad idea :). Simple workaround is to avoid adding empty docsets
to the OrDocSet which is clearly suboptimal but works.

Anmol



Michael Mastroianni wrote:
> 
> Thanks for the response (and the library, of course :)). I figured out
> the order thing by looking at your tests (I should have done that
> first). It might be a good idea to have a ctor that takes a sorted array
> of ints, since it looks like in situations where you are, for  instance,
> loading a docset from a hitcollector, you have to store things that way
> anyway.
> 
> I have another question about the boolean docsets. If I have an
> AndDocIdSet with a bunch of OrDocIdSets inside it, and any of those
> contain an empty basic DocSet, the iterator on the AndDocIdSet will blow
> up on calls to next(). I'm not sure whether this is by design or a bug,
> but it might be a good thing to put in the javadoc. I can reproduce this
> behavior with the following junit test. Is this something you are aware
> of?
> 
> regards,
> Michael
> 
> 
> 
> 	public void testPartialEmptyAnd() throws IOException
> 	{
> 		try
> 		{
> 			DocSet ds1 = new P4DDocIdSet();
> 			DocSet ds2 = new P4DDocIdSet();
> 			ds2.addDoc(42);
> 			ds2.addDoc(43);
> 			ds2.addDoc(44);
> 			ArrayList<DocIdSet> docs = new
> ArrayList<DocIdSet>();
> 			docs.add(ds1);
> 			docs.add(ds2);
> 			OrDocIdSet orlist1 = new OrDocIdSet(docs);
> 			DocSet ds3 = new P4DDocIdSet();
> 			DocSet ds4 = new P4DDocIdSet();
> 			ds4.addDoc(42);
> 			ds4.addDoc(43);
> 			ds4.addDoc(44);
> 			ArrayList<DocIdSet> docs2 = new
> ArrayList<DocIdSet>();
> 			docs2.add(ds3);
> 			docs2.add(ds4);
> 			OrDocIdSet orlist2 = new OrDocIdSet(docs2);
> 			ArrayList<DocIdSet> docs3 = new
> ArrayList<DocIdSet>();
> 			docs3.add(orlist1);
> 			docs3.add(orlist2);
> 			AndDocIdSet andlist = new AndDocIdSet(docs3);
> 			
> 			DocIdSetIterator iter = andlist.iterator();
> 			@SuppressWarnings("unused")
> 			int docId = -1;
> 			while(iter.next())
> 			{
> 				docId = iter.doc();
> 			}			
> 		}
> 		catch(Exception e)
> 		{
> 			System.out.println(e.getMessage());
> 			return;
> 		}
> 		assertTrue(false);
> 	}
> 
> -----Original Message-----
> From: molz [mailto:anmol.bhasin@gmail.com] 
> Sent: Tuesday, April 28, 2009 9:00 PM
> To: java-user@lucene.apache.org
> Subject: RE: kamikaze
> 
> 
> Hi Micheal,
> 
> Thanks for trying out Kamikaze for starters. So I guess there are a few
> issues here
> 
> 1. getDocSetInstance(int min, max, count,DocSetFactory.FOCUS) assumes
> that
> count < max. I guess thats an API check we should add anyways to improve
> usability. That is not to say that it will not work if count > max but
> we
> have not done the due diligence on that one.
> 
> 2. The way you are inserting the elements is not quite right. The addDoc
> method assumes you insert the elements in a sorted fashion. Calling
> doc.addDoc(rand.nextInt(maxDoc) does not quite ensure you are loading
> the
> docSet in a sorted fashion. This is specially useful in BitSet and P4D
> set
> cases as P4D encodes only delta values between conscutive integers.
> 
> 3. I would recommend using FOCUS.OPTIMAL for best performance/space
> tradeoff, albeit SPACE should work too, if you find any issues with that
> let
> us know, we will be glad to fix it.
> 
> 4. Finally, I believe you want to just get a plain vanilla docSet from
> one
> of the OR/AND sets. This would be cool to do, however the idea with
> Boolean
> Sets are that they are never really materialized, they are iterated over
> on
> the fly. I believe we could do an enhancement to construct the docSet on
> the
> fly while iterating the Boolean DocSet but as of now there is no
> established
> way of doing that.
> 
> Hope I covered all your concerns. I rewrote and run your test case like
> this
> 
> public class KamikazeTest extends TestCase
> {
>     public void testGrowingP4()
>     {
>         DocSet doc =
>             DocSetFactory.getDocSetInstance(0, 35000000, 200000,
> DocSetFactory.FOCUS.SPACE);
>         Random rand = new Random(System.currentTimeMillis());
>        // int maxDoc = 3500000;
>         //doc.addDoc(0);
>         
>         int i = 0;
>         try
>         {
>             while(i < 500000)
>             {
>                 int nextDoc = i;
>                 doc.addDoc(nextDoc);
>                 i+=rand.nextInt(50);
>             }              
>         }
>         catch(Exception e)
>         {
>             e.printStackTrace();
>             return;
>         }
>         assertTrue(true);
>        
>     }
>     
>    
> } 
> 
> Thanks,
> Anmol
> 
> Software Engineer
> Anmol Bhasin
> www.linkedin.com
> 
> 
> 
> Michael Mastroianni wrote:
>> 
>> Hi--
>> 
>> I just got kamikaze somewhat integrated into a project of mine. I'm
>> having problems growing the DocIdSets, though. Up to the point where
> the
>> first regrow happens, everything is fine. Once the regrow happens, I
> get
>> an ArrayOutOfBoundsException. The following unit test will exhibit
> this
>> behavior. If I change the third param of getDocSetInstance to be
>> something lower, I get a p4Doc, if I leave it as is, I get an
> OpenBitSet
>> doc, in either case, I get the same crash. Do I need to initialize the
>> docs in some way other than just creating them?
>> 
>> regards,
>> Michael
>> 
>> import org.apache.lucene.search.DocIdSet;
>> import org.apache.lucene.util.OpenBitSet;
>> 
>> 
>> import com.kamikaze.docidset.api.DocSet;
>> import com.kamikaze.docidset.impl.AndDocIdSet;
>> import com.kamikaze.docidset.impl.OrDocIdSet;
>> import com.kamikaze.docidset.utils.DocSetFactory;
>> 
>> import junit.framework.TestCase;
>> 
>> 
>> public class KamikazeTest extends TestCase
>> {
>>     public void testGrowingP4()
>>     {
>>         DocSet doc =
>>             DocSetFactory.getDocSetInstance(0, 350000, 3000000,
>> DocSetFactory.FOCUS.SPACE);
>>         Random rand = new Random(System.currentTimeMillis());
>>         int maxDoc = 350000;
>>         doc.addDoc(rand.nextInt(maxDoc));
>>         int i = 0;
>>         try
>>         {
>>             while(i < 256)
>>             {
>>                 int nextDoc = rand.nextInt(maxDoc);
>>                 doc.addDoc(nextDoc);
>>                 ++i;
>>             }               
>>         }
>>         catch(Exception e)
>>         {
>>             return;
>>         }
>>         assertTrue(false);
>>     }
>> }
>> 
>> -----Original Message-----
>> From: John Wang [mailto:john.wang@gmail.com] 
>> Sent: Friday, April 24, 2009 7:50 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: kamikaze
>> 
>> Hi Michael:
>>     We are using it internally here at LinkedIn for both our search
>> engine
>> as well as our social graph engine. And we have a team developing
>> actively
>> on it. Let us know how we can help you.
>> 
>> -John
>> 
>> On Fri, Apr 24, 2009 at 1:56 PM, Michael Mastroianni <
>> MMastroianni@glgroup.com> wrote:
>> 
>>> Hi--
>>>
>>>
>>>
>>> Has anyone here used kamikaze much? I'm interested in using it in
>>> situations where I'll have several docidsets of >2M, plus several in
>> the
>>> 10s of thousands.
>>>
>>>
>>>
>>> On prototype basis, I got something running nicely using OpenBitSet,
>> but
>>> I can't use that much memory for my real application.
>>>
>>>
>>>
>>> regards,
>>>
>>> Michael Mastroianni
>>>
>>>
>>>
>>> This e-mail message, and any attachments, is intended only for the
> use
>> of
>>> the individual or entity identified in the alias address of this
>> message and
>>> may contain information that is confidential, privileged and subject
>> to
>>> legal restrictions and penalties regarding its unauthorized
> disclosure
>> and
>>> use. Any unauthorized review, copying, disclosure, use or
> distribution
>> is
>>> strictly prohibited. If you have received this e-mail message in
>> error,
>>> please notify the sender immediately by reply e-mail and delete this
>>> message, and any attachments, from your system. Thank you.
>>>
>>>
>> 
>> This e-mail message, and any attachments, is intended only for the use
> of
>> the individual or entity identified in the alias address of this
> message
>> and may contain information that is confidential, privileged and
> subject
>> to legal restrictions and penalties regarding its unauthorized
> disclosure
>> and use. Any unauthorized review, copying, disclosure, use or
> distribution
>> is strictly prohibited. If you have received this e-mail message in
> error,
>> please notify the sender immediately by reply e-mail and delete this
>> message, and any attachments, from your system. Thank you.
>> 
>> 
>> 
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> 
>> 
>> 
> 
> -- 
> View this message in context:
> http://www.nabble.com/kamikaze-tp23224760p23288825.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
> This e-mail message, and any attachments, is intended only for the use of
> the individual or entity identified in the alias address of this message
> and may contain information that is confidential, privileged and subject
> to legal restrictions and penalties regarding its unauthorized disclosure
> and use. Any unauthorized review, copying, disclosure, use or distribution
> is strictly prohibited. If you have received this e-mail message in error,
> please notify the sender immediately by reply e-mail and delete this
> message, and any attachments, from your system. Thank you.
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/kamikaze-tp23224760p23302407.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40022-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 02:58:49 2009
Return-Path: <java-user-return-40022-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72367 invoked from network); 30 Apr 2009 02:58:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 02:58:48 -0000
Received: (qmail 81783 invoked by uid 500); 30 Apr 2009 02:58:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81711 invoked by uid 500); 30 Apr 2009 02:58:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81701 invoked by uid 99); 30 Apr 2009 02:58:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 02:58:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 02:58:36 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LzMTX-0007Fj-NE
	for java-user@lucene.apache.org; Wed, 29 Apr 2009 19:58:15 -0700
Message-ID: <23307098.post@talk.nabble.com>
Date: Wed, 29 Apr 2009 19:58:15 -0700 (PDT)
From: molz <anmol.bhasin@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: kamikaze
In-Reply-To: <23302407.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: anmol.bhasin@gmail.com
References: <9008E1E80EE8A340BACCA3DFF41B21562A4C9A@GLGNYEXBE02.glgroup.com> <8837fb770904241649i6beb28e5i770eca9c50b5d8e5@mail.gmail.com> <9008E1E80EE8A340BACCA3DFF41B21562A4E18@GLGNYEXBE02.glgroup.com> <23288825.post@talk.nabble.com> <9008E1E80EE8A340BACCA3DFF41B21562A4F5E@GLGNYEXBE02.glgroup.com> <23302407.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


  
Hi Michael,

2 Questions. 

1. What version of Kamikaze are you running with?
2. Can you try the snippet below and let me know if it fails ? I ran it 20
times and it did not fail. Maybe there is some difference in the utitlity
methods you have ? I am still trying to track down if anything is off at my
end but does not seem to be.

    public void testMultipleIntersections() 
    { 
            ArrayList<OpenBitSet> obs = new ArrayList<OpenBitSet>(); 
            ArrayList<DocIdSet> docs = new ArrayList<DocIdSet>(); 
        Random rand = new Random(System.currentTimeMillis()); 
            int maxDoc = 350000; 
            for(int i=0; i < 3; ++i) 
            { 
                    int numdocs = rand.nextInt(maxDoc); 
                    ArrayList<Integer> nums = new 
ArrayList<Integer>(); 
                    HashSet<Integer> seen = new HashSet<Integer>(); 
                    for (int j = 0; j < numdocs; j++) 
                { 
                            int nextDoc = rand.nextInt(maxDoc); 
                            if(seen.contains(nextDoc)) 
                            { 
                                    while(seen.contains(nextDoc)) 
                                    { 
                                            nextDoc = 
rand.nextInt(maxDoc); 
                                    } 
                            } 
                            nums.add(nextDoc); 
                            seen.add(nextDoc); 
                } 
                    Collections.sort(nums); 
                    obs.add(createObs(nums, maxDoc)); 
                    docs.add(createDocSet(nums)); 
            } 
            OpenBitSet base = obs.get(0); 
            for(int i = 1; i < obs.size(); ++i) 
            { 
                    base.intersect(obs.get(i)); 
            } 
            
            AndDocIdSet ands = new AndDocIdSet(docs); 
            long card1 = base.cardinality(); 
            long card2 = ands.size(); 
            System.out.println(card1+":"+card2);
            assertEquals(card1, card2); 
    } 


    private OpenBitSet createObs(ArrayList<Integer> nums, int maxDoc) {
      OpenBitSet bitSet = new OpenBitSet(maxDoc);
      for(int num:nums)
        bitSet.set(num);
      return bitSet;
    }
    
    private DocIdSet createDocSet(ArrayList<Integer> nums) {
      DocSet p4d = DocSetFactory.getDocSetInstance(0, 35000000, 200000,
          DocSetFactory.FOCUS.OPTIMAL);
      for(int num:nums)
       p4d.addDoc(num);
      return p4d;
    }

I even tried with the following 

  private DocIdSet createDocSet(ArrayList<Integer> nums) {
      P4DDocIdSet p4d = new P4DDocIdSet();
      for(int num:nums)
       p4d.addDoc(num);
      return p4d;
    }


 The NPE you mention in the previous emails has been identified as a bug and
will be fixed in the next release (in a day or two). 

Thanks,
Anmol


-- 
View this message in context: http://www.nabble.com/kamikaze-tp23224760p23307098.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40023-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 04:16:03 2009
Return-Path: <java-user-return-40023-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94242 invoked from network); 30 Apr 2009 04:16:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 04:16:02 -0000
Received: (qmail 52110 invoked by uid 500); 30 Apr 2009 04:16:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52074 invoked by uid 500); 30 Apr 2009 04:15:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52064 invoked by uid 99); 30 Apr 2009 04:15:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 04:15:59 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ihasmax@gmail.com designates 209.85.221.127 as permitted sender)
Received: from [209.85.221.127] (HELO mail-qy0-f127.google.com) (209.85.221.127)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 04:15:53 +0000
Received: by qyk33 with SMTP id 33so1725334qyk.29
        for <java-user@lucene.apache.org>; Wed, 29 Apr 2009 21:15:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=1IWC9JqPvgpyi5Cu6y+bdFRPhMmqZUCxFr3YPmXCJJM=;
        b=WAvkjtY2V9jZkD1fqREmMyHaLk7lK4MY59auhUW+Jq9ly2yRmDbgSScT02iwK9Q9W7
         pF8zmDj0qumqcVWNdpfc0X2UGeSJ/PKVUo26i3WevinEB5HX02EqWdLsEkQ1ZsmoQQ2K
         9mnd9UROwe5oHjJNXiZ+cEeGRGlQpOO59cciQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=quHrFooxYwMqSHbmNBhoIj+Z4AMfXrR4YIJV+psSRLKcWjZqmsGPLPdn773iGyTIZc
         lAxxUYiThCw/N2hU6ZnKg5QobgtyitAt2fWz3r0muYmLAlmFIkbnvrL71esS9EsKA9bp
         MOSGMqOYkbw34kknuovA6Gq9mwqbb8REI4lhA=
MIME-Version: 1.0
Received: by 10.224.60.138 with SMTP id p10mr1381526qah.232.1241064932191; 
	Wed, 29 Apr 2009 21:15:32 -0700 (PDT)
In-Reply-To: <9ac0c6aa0904290227k4cb08938ic55503688ac02bd8@mail.gmail.com>
References: <3836ec640904281849s271e7ad0k380d6978c9117a76@mail.gmail.com>
	 <9ac0c6aa0904290227k4cb08938ic55503688ac02bd8@mail.gmail.com>
Date: Wed, 29 Apr 2009 23:15:32 -0500
Message-ID: <3836ec640904292115v4a49f532ofe54a3c221f42100@mail.gmail.com>
Subject: Re: Phrase Highlighting
From: Max Lynch <ihasmax@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015175cdec46d2f820468bdf273
X-Virus-Checked: Checked by ClamAV on apache.org

--0015175cdec46d2f820468bdf273
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

You should switch to the SpanScorer (in o.a.l.search.highlighter).
> That fragment scorer should only match true phrase matches.
>
> Mike
>

Thanks Mike.  I gave it a try and it wasn't working how I expected.  I am
using pylucene right now so I can ask them if the implementation is
different.  I'm messing around with the lucene unit tests to see exactly how
the scorer should work.

In the mean time, If I am interested in finding out exactly how many times a
term was found in a document, what is the best way to go about this?  The
way I am doing it right now is using a highlighter and just incrementing
counters when a word is found that I'm interested.  I just came across
FieldSortedTermVectorMapper that could do something similar.  Is
FieldSortedTermVectorMapper something I could use for this?  Is there a
better option?

Thanks,
Max

--0015175cdec46d2f820468bdf273--

From java-user-return-40024-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 07:29:53 2009
Return-Path: <java-user-return-40024-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67905 invoked from network); 30 Apr 2009 07:29:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 07:29:53 -0000
Received: (qmail 79715 invoked by uid 500); 30 Apr 2009 07:29:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79623 invoked by uid 500); 30 Apr 2009 07:29:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79613 invoked by uid 99); 30 Apr 2009 07:29:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 07:29:50 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 07:29:44 +0000
Received: by ewy27 with SMTP id 27so1859783ewy.5
        for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 00:29:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=i4dX1Fm3gA4QfYdPyBTlGfkLoGoRY9w7uHlT9KfmieY=;
        b=HDTYG1pouJOvvSPgfe7RvT8ZVmirlr5qF4OHIRVhPmLl2T61sP+1RrgP+1wry9XS0m
         u87rVmwXohbk0p5K2TRJasSqnzUR4N1FdAqs6hk2+3QUSIOyGqBOWn4wySc8Y+412R1x
         A8QZxCy043bj/3NoyNacNKvBFlDnRdpU8Ik5g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=Xm/TlD8V847Thp9zOa8by6kHuEXzwziVBAdKzd51x5xLekHarCDLiAT1xR39z9aFfr
         1f/9pCl5VjauFUOwAf0AcXgjvEYjquo+a3auCHNEnjxbMMGJDcvYkCJzsjnFa6wD9OY7
         AUQAgplpkZKL1eWMR3iquflBlaCagmZcsUP1I=
MIME-Version: 1.0
Received: by 10.210.129.10 with SMTP id b10mr1907395ebd.84.1241076562862; Thu, 
	30 Apr 2009 00:29:22 -0700 (PDT)
Date: Thu, 30 Apr 2009 10:29:22 +0300
Message-ID: <d36c28c30904300029t6414e3fapf4a36619baeabed9@mail.gmail.com>
Subject: Indexing becomes slow with time
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c16eaab24240468c0a797
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c16eaab24240468c0a797
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Hi,

I noticed that when I start to index, it indexes 7 documents a second. After
30 minutes it goes down to 3 documents a second.
After two hours it becomes very slow (I stopped it when it arrived to 320MB
and did 1 document in almost a minute)

As you can see, it happens only after 2000, 3000 documnet.
Should I split them into more indexes?


Thanks,
Liat

--0015174c16eaab24240468c0a797--

From java-user-return-40025-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 08:31:20 2009
Return-Path: <java-user-return-40025-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87670 invoked from network); 30 Apr 2009 08:31:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 08:31:20 -0000
Received: (qmail 46667 invoked by uid 500); 30 Apr 2009 08:31:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46595 invoked by uid 500); 30 Apr 2009 08:31:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46585 invoked by uid 99); 30 Apr 2009 08:31:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 08:31:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.220.158 as permitted sender)
Received: from [209.85.220.158] (HELO mail-fx0-f158.google.com) (209.85.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 08:31:10 +0000
Received: by fxm2 with SMTP id 2so1942789fxm.5
        for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 01:30:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=2hxyi+oMCZnG5NwmYMgv/gl8EEBTWl3O16tNybpVNP8=;
        b=xwyzfVAx8N0BBWqrHQ/Tk5zZFzYhpu/2xKyXkCjZm3RZndEtAfiJijmt22DpDOQJxg
         OoTq2eLzwEi6PHr+CFT32QI4dR0HoEgMkVIFG5e+hmGBnzHEzISTFHjhpuJWrDC0I+lo
         eYQ/N8Y5PW60jCLhLxI4StrAYnQihD9Pc8bWs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=liaPeNJS47NboAdDGtDncKyk/S+nkrzX/DFj1aTPOyDiJgErL8zh7AqpyQLJApa1rO
         uLTIeVxljsFkN1sONE4uCp1nyeNODCkzOavfjTJ5lhcxkfMQPEz4xPEbVgkQmZuLNb1A
         T77u+DqRgafT5bRUDxU6OfOzh3U6OAGaUI9d4=
MIME-Version: 1.0
Received: by 10.204.118.12 with SMTP id t12mr1198900bkq.158.1241080249109; 
	Thu, 30 Apr 2009 01:30:49 -0700 (PDT)
In-Reply-To: <d36c28c30904300029t6414e3fapf4a36619baeabed9@mail.gmail.com>
References: <d36c28c30904300029t6414e3fapf4a36619baeabed9@mail.gmail.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Thu, 30 Apr 2009 09:30:29 +0100
Message-ID: <8c4e68610904300130m44a7e41ekb830af82bbe5f8dd@mail.gmail.com>
Subject: Re: Indexing becomes slow with time
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Are you maybe running optimize after every n documents?  There are
lots of tips in
http://wiki.apache.org/lucene-java/ImproveIndexingSpeed.


--
Ian.


On Thu, Apr 30, 2009 at 8:29 AM, liat oren <oren.liat@gmail.com> wrote:
> Hi,
>
> I noticed that when I start to index, it indexes 7 documents a second. After
> 30 minutes it goes down to 3 documents a second.
> After two hours it becomes very slow (I stopped it when it arrived to 320MB
> and did 1 document in almost a minute)
>
> As you can see, it happens only after 2000, 3000 documnet.
> Should I split them into more indexes?
>
>
> Thanks,
> Liat
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40026-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 10:17:01 2009
Return-Path: <java-user-return-40026-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46580 invoked from network); 30 Apr 2009 10:17:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 10:17:01 -0000
Received: (qmail 74069 invoked by uid 500); 30 Apr 2009 10:16:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74007 invoked by uid 500); 30 Apr 2009 10:16:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73995 invoked by uid 99); 30 Apr 2009 10:16:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 10:16:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.217.215] (HELO mail-gx0-f215.google.com) (209.85.217.215)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 10:16:50 +0000
Received: by gxk11 with SMTP id 11so3394006gxk.5
        for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 03:16:28 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.128.1 with SMTP id f1mr3324556ybn.36.1241086588722; Thu, 
	30 Apr 2009 03:16:28 -0700 (PDT)
In-Reply-To: <3836ec640904292115v4a49f532ofe54a3c221f42100@mail.gmail.com>
References: <3836ec640904281849s271e7ad0k380d6978c9117a76@mail.gmail.com>
	 <9ac0c6aa0904290227k4cb08938ic55503688ac02bd8@mail.gmail.com>
	 <3836ec640904292115v4a49f532ofe54a3c221f42100@mail.gmail.com>
Date: Thu, 30 Apr 2009 06:16:28 -0400
Message-ID: <9ac0c6aa0904300316t1eb4ab0fma543adac285ecafa@mail.gmail.com>
Subject: Re: Phrase Highlighting
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Apr 30, 2009 at 12:15 AM, Max Lynch <ihasmax@gmail.com> wrote:
> You should switch to the SpanScorer (in o.a.l.search.highlighter).
>> That fragment scorer should only match true phrase matches.
>>
>> Mike
>>
>
> Thanks Mike. =A0I gave it a try and it wasn't working how I expected. =A0=
I am
> using pylucene right now so I can ask them if the implementation is
> different. =A0I'm messing around with the lucene unit tests to see exactl=
y how
> the scorer should work.

Can you give more details on what's not working right?

> In the mean time, If I am interested in finding out exactly how many time=
s a
> term was found in a document, what is the best way to go about this? =A0T=
he
> way I am doing it right now is using a highlighter and just incrementing
> counters when a word is found that I'm interested. =A0I just came across
> FieldSortedTermVectorMapper that could do something similar. =A0Is
> FieldSortedTermVectorMapper something I could use for this? =A0Is there a
> better option?

This (getting more details per-doc on why a doc matches) is an often
requested feature, that Lucene does not make easy today.

Is it really just single terms you need to measure?  (eg, not "how
many times did phrase XYZ occur in the doc").  If so, then getting the
term vectors and locating your term in there, should work.  This is
probably OK if you just do it for each of the hits on the page (like
10 hits), but will be way too slow if you try to do it for say all
docs that matched the query.

Otherwise, iterating through matches as found by the highlighter's
SpanScorer is probably best for now.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40027-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 10:39:36 2009
Return-Path: <java-user-return-40027-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57494 invoked from network); 30 Apr 2009 10:39:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 10:39:34 -0000
Received: (qmail 85182 invoked by uid 500); 30 Apr 2009 10:24:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85162 invoked by uid 500); 30 Apr 2009 10:24:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85152 invoked by uid 99); 30 Apr 2009 10:24:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 10:24:21 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of oren.liat@gmail.com designates 209.85.219.179 as permitted sender)
Received: from [209.85.219.179] (HELO mail-ew0-f179.google.com) (209.85.219.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 10:24:12 +0000
Received: by ewy27 with SMTP id 27so1939828ewy.5
        for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 03:23:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=t0JNOeZQqv55XcXm5ODtDymiCfTEykK5ExxG0UG28WE=;
        b=fNzq/TfSQQbAANaP+/LtiGu0n5MbSNSBwdCT7u/cdf9WRf1d6aLHvVc8VKMxKjOFfO
         2bkDVuvaQGzBrP6fI7gfpeGKDsk/L7tUOIKi+mUV7eXrs6LS1SCU6plPyHTrO8yKzSXD
         O+sZsxJhparT/jCtnm0KayvT6uZvAsIKJCF4k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=v4yKTL7hLbNeW/OpHCkb1J7WZsUL0FIel+wN7K+OokIeeO8+YijLJUCUNT4Cbm8JTd
         HrcpeIWNmnZSo7ms4nT4soMSNCIM8jZ2JFGQRxeyGC0JFueTBwJdprgVapfc8S84Gqpm
         GQ2xo2xikmRFJFwhBpbqCgz4/rUBiZLe0aCFw=
MIME-Version: 1.0
Received: by 10.210.112.1 with SMTP id k1mr1486317ebc.29.1241087032583; Thu, 
	30 Apr 2009 03:23:52 -0700 (PDT)
In-Reply-To: <8c4e68610904300130m44a7e41ekb830af82bbe5f8dd@mail.gmail.com>
References: <d36c28c30904300029t6414e3fapf4a36619baeabed9@mail.gmail.com>
	 <8c4e68610904300130m44a7e41ekb830af82bbe5f8dd@mail.gmail.com>
Date: Thu, 30 Apr 2009 13:23:52 +0300
Message-ID: <d36c28c30904300323pc0c551fm354e9e4a6b6fb3c2@mail.gmail.com>
Subject: Re: Indexing becomes slow with time
From: liat oren <oren.liat@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174bea74b668910468c3175c
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174bea74b668910468c3175c
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Yes, I do run optimize...

I did start looking at these tips in the last few days, but didn't think the
optimize makes it so slow.

Thanks!

2009/4/30 Ian Lea <ian.lea@gmail.com>

> Are you maybe running optimize after every n documents?  There are
> lots of tips in
> http://wiki.apache.org/lucene-java/ImproveIndexingSpeed.
>
>
> --
> Ian.
>
>
> On Thu, Apr 30, 2009 at 8:29 AM, liat oren <oren.liat@gmail.com> wrote:
> > Hi,
> >
> > I noticed that when I start to index, it indexes 7 documents a second.
> After
> > 30 minutes it goes down to 3 documents a second.
> > After two hours it becomes very slow (I stopped it when it arrived to
> 320MB
> > and did 1 document in almost a minute)
> >
> > As you can see, it happens only after 2000, 3000 documnet.
> > Should I split them into more indexes?
> >
> >
> > Thanks,
> > Liat
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174bea74b668910468c3175c--

From java-user-return-40028-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 10:47:22 2009
Return-Path: <java-user-return-40028-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65931 invoked from network); 30 Apr 2009 10:47:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 10:47:22 -0000
Received: (qmail 31486 invoked by uid 500); 30 Apr 2009 10:47:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31416 invoked by uid 500); 30 Apr 2009 10:47:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31406 invoked by uid 99); 30 Apr 2009 10:47:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 10:47:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 10:47:10 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1LzTn0-0007If-4Y
	for java-user@lucene.apache.org; Thu, 30 Apr 2009 03:46:50 -0700
Message-ID: <23313810.post@talk.nabble.com>
Date: Thu, 30 Apr 2009 03:46:50 -0700 (PDT)
From: Huntsman84 <tpgarcia84@gmail.com>
To: java-user@lucene.apache.org
Subject: Searching for partial matches
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: tpgarcia84@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello, 

 

I am new to Lucene, and I don't know if it is possible to obtain results
providing part of the keyword. 

 

For example, if I try to search "in", it should return all matches with
"string", "meaning", "trinity"... 

 

Am I expecting too much? 

 

Thank you so much!

-- 
View this message in context: http://www.nabble.com/Searching-for-partial-matches-tp23313810p23313810.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40029-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 11:10:33 2009
Return-Path: <java-user-return-40029-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71722 invoked from network); 30 Apr 2009 11:10:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 11:10:32 -0000
Received: (qmail 61188 invoked by uid 500); 30 Apr 2009 11:10:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61112 invoked by uid 500); 30 Apr 2009 11:10:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61102 invoked by uid 99); 30 Apr 2009 11:10:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 11:10:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.218.179 as permitted sender)
Received: from [209.85.218.179] (HELO mail-bw0-f179.google.com) (209.85.218.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 11:10:21 +0000
Received: by bwz27 with SMTP id 27so2034823bwz.5
        for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 04:10:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=cv08QW/QEnuPl1nBfNogswXA+AUxEpWvXO5YjjcIfh8=;
        b=k4lBOseAi1lnBDqjUHdQ9i/9sgMHEtv62KjujdvlEKhBgHetGGVRRYe4sB3NfLx/mi
         oSuFiM09lKygnCPLpxJSawhYHNjr4bmXNQK6BlHH0Md+XibK0CWCZ70CBdK2H3yRpZEt
         njyGvlMQqjEtC92CzOT1JXti6EdTDM70TbLPM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=nStjscBM2SqzrEUMrZxkPH2PTy5HOLItpyPco3V2l9j6nfY4Io+YERxudif9/C0Oo2
         KtVUH5KZWCBKF6sW8ahSbhhMJCLbEQPNfR6NhNHsP0Rlo/DES7Bg+1/bsriSExUx2TTS
         RexwoplFrXKbBHXXzNLFQBYITggaO88b5Rxow=
MIME-Version: 1.0
Received: by 10.204.118.69 with SMTP id u5mr1342820bkq.77.1241089801199; Thu, 
	30 Apr 2009 04:10:01 -0700 (PDT)
In-Reply-To: <23313810.post@talk.nabble.com>
References: <23313810.post@talk.nabble.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Thu, 30 Apr 2009 12:09:41 +0100
Message-ID: <8c4e68610904300409u6852af5exc67cb29bcf3e15fc@mail.gmail.com>
Subject: Re: Searching for partial matches
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi


This is possible.  There is an entry on wildcards in the FAQ.  See
also RegexQuery and search the mailing lists for ngrams.

Depending on your setup and requirements you may need to be aware of
the performance implications of wild card searching, particularly
leading wildcards as will be required for the example you give.  See
the FAQ and javadocs for WildcardQuery.


--
Ian.

On Thu, Apr 30, 2009 at 11:46 AM, Huntsman84 <tpgarcia84@gmail.com> wrote:
>
> Hello,
>
>
>
> I am new to Lucene, and I don't know if it is possible to obtain results
> providing part of the keyword.
>
>
>
> For example, if I try to search "in", it should return all matches with
> "string", "meaning", "trinity"...
>
>
>
> Am I expecting too much?
>
>
>
> Thank you so much!

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40030-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 12:53:42 2009
Return-Path: <java-user-return-40030-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8354 invoked from network); 30 Apr 2009 12:53:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 12:53:40 -0000
Received: (qmail 94421 invoked by uid 500); 30 Apr 2009 12:53:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94374 invoked by uid 500); 30 Apr 2009 12:53:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94364 invoked by uid 99); 30 Apr 2009 12:53:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 12:53:38 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of MMastroianni@glgroup.com)
Received: from [216.32.181.12] (HELO WA4EHSOBE002.bigfish.com) (216.32.181.12)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 12:53:27 +0000
Received: from mail152-wa4-R.bigfish.com (10.8.14.238) by
 WA4EHSOBE002.bigfish.com (10.8.40.22) with Microsoft SMTP Server id
 8.1.340.0; Thu, 30 Apr 2009 12:53:06 +0000
Received: from mail152-wa4 (localhost.localdomain [127.0.0.1])	by
 mail152-wa4-R.bigfish.com (Postfix) with ESMTP id A5173120410	for
 <java-user@lucene.apache.org>; Thu, 30 Apr 2009 12:53:05 +0000 (UTC)
X-BigFish: VPS-28(zz542NfadRa0dJ62a3L4015L936fJ9371P19c2k8b9bkzz1202hzz5a6ciz32i6bh61h)
X-Spam-TCS-SCL: 0:0
Received: by mail152-wa4 (MessageSwitch) id 1241095980487970_10308; Thu, 30
 Apr 2009 12:53:00 +0000 (UCT)
Received: from GLGNYEXSMTP02.glgroup.com (glgnyexsmtp02.glgroup.com
 [38.112.210.163])	by mail152-wa4.bigfish.com (Postfix) with ESMTP id
 B98CA1AE0095	for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 12:52:30
 +0000 (UTC)
Received: from GLGNYEXBE02.glgroup.com ([10.45.50.82]) by
 GLGNYEXSMTP02.glgroup.com with Microsoft SMTPSVC(6.0.3790.3959);	 Thu, 30 Apr
 2009 08:52:22 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: kamikaze
Date: Thu, 30 Apr 2009 08:54:23 -0400
Message-ID: <9008E1E80EE8A340BACCA3DFF41B21562A5046@GLGNYEXBE02.glgroup.com>
In-Reply-To: <23307098.post@talk.nabble.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: kamikaze
thread-index: AcnJP5ZKfEqAbL9USk6vktl0GnSINwAUqynw
From: Michael Mastroianni <MMastroianni@glgroup.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 30 Apr 2009 12:52:22.0474 (UTC) FILETIME=[8113DAA0:01C9C992]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Anmol--

1. I'm using a recent snapshot of your svn repo (I tried using the jar
file, but line numbers were turned off, and I couldn't debug at all: I
can try with the jar file from your most recent release and see how it
turns out) from something like 3 days ago.

2. I just tried the snippet you sent and it failed, with the following
error
junit.framework.AssertionFailedError: expected:<4679> but was:<13498>

on the first try.

regards, =

Michael
-----Original Message-----
From: molz [mailto:anmol.bhasin@gmail.com] =

Sent: Wednesday, April 29, 2009 10:58 PM
To: java-user@lucene.apache.org
Subject: RE: kamikaze


  =

Hi Michael,

2 Questions. =


1. What version of Kamikaze are you running with?
2. Can you try the snippet below and let me know if it fails ? I ran it
20
times and it did not fail. Maybe there is some difference in the
utitlity
methods you have ? I am still trying to track down if anything is off at
my
end but does not seem to be.

    public void testMultipleIntersections() =

    { =

            ArrayList<OpenBitSet> obs =3D new ArrayList<OpenBitSet>(); =

            ArrayList<DocIdSet> docs =3D new ArrayList<DocIdSet>(); =

        Random rand =3D new Random(System.currentTimeMillis()); =

            int maxDoc =3D 350000; =

            for(int i=3D0; i < 3; ++i) =

            { =

                    int numdocs =3D rand.nextInt(maxDoc); =

                    ArrayList<Integer> nums =3D new =

ArrayList<Integer>(); =

                    HashSet<Integer> seen =3D new HashSet<Integer>(); =

                    for (int j =3D 0; j < numdocs; j++) =

                { =

                            int nextDoc =3D rand.nextInt(maxDoc); =

                            if(seen.contains(nextDoc)) =

                            { =

                                    while(seen.contains(nextDoc)) =

                                    { =

                                            nextDoc =3D =

rand.nextInt(maxDoc); =

                                    } =

                            } =

                            nums.add(nextDoc); =

                            seen.add(nextDoc); =

                } =

                    Collections.sort(nums); =

                    obs.add(createObs(nums, maxDoc)); =

                    docs.add(createDocSet(nums)); =

            } =

            OpenBitSet base =3D obs.get(0); =

            for(int i =3D 1; i < obs.size(); ++i) =

            { =

                    base.intersect(obs.get(i)); =

            } =

            =

            AndDocIdSet ands =3D new AndDocIdSet(docs); =

            long card1 =3D base.cardinality(); =

            long card2 =3D ands.size(); =

            System.out.println(card1+":"+card2);
            assertEquals(card1, card2); =

    } =



    private OpenBitSet createObs(ArrayList<Integer> nums, int maxDoc) {
      OpenBitSet bitSet =3D new OpenBitSet(maxDoc);
      for(int num:nums)
        bitSet.set(num);
      return bitSet;
    }
    =

    private DocIdSet createDocSet(ArrayList<Integer> nums) {
      DocSet p4d =3D DocSetFactory.getDocSetInstance(0, 35000000, 200000,
          DocSetFactory.FOCUS.OPTIMAL);
      for(int num:nums)
       p4d.addDoc(num);
      return p4d;
    }

I even tried with the following =


  private DocIdSet createDocSet(ArrayList<Integer> nums) {
      P4DDocIdSet p4d =3D new P4DDocIdSet();
      for(int num:nums)
       p4d.addDoc(num);
      return p4d;
    }


 The NPE you mention in the previous emails has been identified as a bug
and
will be fixed in the next release (in a day or two). =


Thanks,
Anmol


-- =

View this message in context:
http://www.nabble.com/kamikaze-tp23224760p23307098.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



This e-mail message, and any attachments, is intended only for the use of t=
he individual or entity identified in the alias address of this message and=
 may contain information that is confidential, privileged and subject to le=
gal restrictions and penalties regarding its unauthorized disclosure and us=
e. Any unauthorized review, copying, disclosure, use or distribution is str=
ictly prohibited. If you have received this e-mail message in error, please=
 notify the sender immediately by reply e-mail and delete this message, and=
 any attachments, from your system. Thank you.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40031-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 13:22:49 2009
Return-Path: <java-user-return-40031-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16943 invoked from network); 30 Apr 2009 13:22:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 13:22:45 -0000
Received: (qmail 37607 invoked by uid 500); 30 Apr 2009 13:22:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37534 invoked by uid 500); 30 Apr 2009 13:22:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37524 invoked by uid 99); 30 Apr 2009 13:22:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 13:22:40 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED
X-Spam-Check-By: apache.org
Received-SPF: unknown (nike.apache.org: error in processing during lookup of MMastroianni@glgroup.com)
Received: from [207.46.51.80] (HELO SG2EHSOBE002.bigfish.com) (207.46.51.80)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 13:22:30 +0000
Received: from mail9-sin-R.bigfish.com (10.3.40.3) by SG2EHSOBE002.bigfish.com
 (10.3.40.22) with Microsoft SMTP Server id 8.1.340.0; Thu, 30 Apr 2009
 13:22:07 +0000
Received: from mail9-sin (localhost.localdomain [127.0.0.1])	by
 mail9-sin-R.bigfish.com (Postfix) with ESMTP id C0378E58159	for
 <java-user@lucene.apache.org>; Thu, 30 Apr 2009 13:22:04 +0000 (UTC)
X-BigFish: VPS-43(zz542NfadRa0dJ62a3L1419M4015L148cM936fJ9371P1444M19c2k8b9bkzz1202hzz5a6ciz32i6bh61h)
X-Spam-TCS-SCL: 0:0
Received: by mail9-sin (MessageSwitch) id 1241097722789279_7202; Thu, 30 Apr
 2009 13:22:02 +0000 (UCT)
Received: from GLGNYEXSMTP01.glgroup.com (glgnyexsmtp01.glgroup.com
 [38.112.210.160])	by mail9-sin.bigfish.com (Postfix) with ESMTP id
 01441360057	for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 13:21:59
 +0000 (UTC)
Received: from GLGNYEXBE02.glgroup.com ([10.45.50.82]) by
 GLGNYEXSMTP01.glgroup.com with Microsoft SMTPSVC(6.0.3790.3959);	 Thu, 30 Apr
 2009 09:21:56 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: kamikaze
Date: Thu, 30 Apr 2009 09:23:57 -0400
Message-ID: <9008E1E80EE8A340BACCA3DFF41B21562A505D@GLGNYEXBE02.glgroup.com>
In-Reply-To: <23307098.post@talk.nabble.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: kamikaze
thread-index: AcnJP5ZKfEqAbL9USk6vktl0GnSINwAVs9yg
From: Michael Mastroianni <MMastroianni@glgroup.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 30 Apr 2009 13:21:56.0848 (UTC) FILETIME=[A2AFD700:01C9C996]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Anmol--

Thanks for bringing up the version I was using: when I switched back to
the official jar file, this test passed. The correctness problem only
seems to exist in the snapshot I grabbed.

The only reason I started using a snapshot was that the jar file had
line numbers turned off in the compilation, and no source attachment.
Would it be possible for you to make a version of the jar file with line
numbers turned on, and a source attachment, for your next release?
Without that, it's pretty nearly impossible to debug problems like the
NPE regression.

regards,
Michael

-----Original Message-----
From: molz [mailto:anmol.bhasin@gmail.com] =

Sent: Wednesday, April 29, 2009 10:58 PM
To: java-user@lucene.apache.org
Subject: RE: kamikaze


  =

Hi Michael,

2 Questions. =


1. What version of Kamikaze are you running with?
2. Can you try the snippet below and let me know if it fails ? I ran it
20
times and it did not fail. Maybe there is some difference in the
utitlity
methods you have ? I am still trying to track down if anything is off at
my
end but does not seem to be.

    public void testMultipleIntersections() =

    { =

            ArrayList<OpenBitSet> obs =3D new ArrayList<OpenBitSet>(); =

            ArrayList<DocIdSet> docs =3D new ArrayList<DocIdSet>(); =

        Random rand =3D new Random(System.currentTimeMillis()); =

            int maxDoc =3D 350000; =

            for(int i=3D0; i < 3; ++i) =

            { =

                    int numdocs =3D rand.nextInt(maxDoc); =

                    ArrayList<Integer> nums =3D new =

ArrayList<Integer>(); =

                    HashSet<Integer> seen =3D new HashSet<Integer>(); =

                    for (int j =3D 0; j < numdocs; j++) =

                { =

                            int nextDoc =3D rand.nextInt(maxDoc); =

                            if(seen.contains(nextDoc)) =

                            { =

                                    while(seen.contains(nextDoc)) =

                                    { =

                                            nextDoc =3D =

rand.nextInt(maxDoc); =

                                    } =

                            } =

                            nums.add(nextDoc); =

                            seen.add(nextDoc); =

                } =

                    Collections.sort(nums); =

                    obs.add(createObs(nums, maxDoc)); =

                    docs.add(createDocSet(nums)); =

            } =

            OpenBitSet base =3D obs.get(0); =

            for(int i =3D 1; i < obs.size(); ++i) =

            { =

                    base.intersect(obs.get(i)); =

            } =

            =

            AndDocIdSet ands =3D new AndDocIdSet(docs); =

            long card1 =3D base.cardinality(); =

            long card2 =3D ands.size(); =

            System.out.println(card1+":"+card2);
            assertEquals(card1, card2); =

    } =



    private OpenBitSet createObs(ArrayList<Integer> nums, int maxDoc) {
      OpenBitSet bitSet =3D new OpenBitSet(maxDoc);
      for(int num:nums)
        bitSet.set(num);
      return bitSet;
    }
    =

    private DocIdSet createDocSet(ArrayList<Integer> nums) {
      DocSet p4d =3D DocSetFactory.getDocSetInstance(0, 35000000, 200000,
          DocSetFactory.FOCUS.OPTIMAL);
      for(int num:nums)
       p4d.addDoc(num);
      return p4d;
    }

I even tried with the following =


  private DocIdSet createDocSet(ArrayList<Integer> nums) {
      P4DDocIdSet p4d =3D new P4DDocIdSet();
      for(int num:nums)
       p4d.addDoc(num);
      return p4d;
    }


 The NPE you mention in the previous emails has been identified as a bug
and
will be fixed in the next release (in a day or two). =


Thanks,
Anmol


-- =

View this message in context:
http://www.nabble.com/kamikaze-tp23224760p23307098.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



This e-mail message, and any attachments, is intended only for the use of t=
he individual or entity identified in the alias address of this message and=
 may contain information that is confidential, privileged and subject to le=
gal restrictions and penalties regarding its unauthorized disclosure and us=
e. Any unauthorized review, copying, disclosure, use or distribution is str=
ictly prohibited. If you have received this e-mail message in error, please=
 notify the sender immediately by reply e-mail and delete this message, and=
 any attachments, from your system. Thank you.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40032-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 13:46:52 2009
Return-Path: <java-user-return-40032-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33976 invoked from network); 30 Apr 2009 13:46:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 13:46:52 -0000
Received: (qmail 85556 invoked by uid 500); 30 Apr 2009 13:46:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85501 invoked by uid 500); 30 Apr 2009 13:46:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85491 invoked by uid 99); 30 Apr 2009 13:46:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 13:46:50 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.221.127 as permitted sender)
Received: from [209.85.221.127] (HELO mail-qy0-f127.google.com) (209.85.221.127)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 13:46:43 +0000
Received: by qyk33 with SMTP id 33so2062128qyk.29
        for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 06:46:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=DoSK/7L30B4mFduSLJMEKpzIAIYyrcuFBdrGKMIg71M=;
        b=O4if9dawff3nuhGfECEYQdb5LLipOyRFL7dZHEKe0YZVkOS86MfFOkINjJvSpu4d4L
         Z4DChfhgtPD2JpDjNvWW43AlmNoWRMdLBscX+2z/nlxc1v25gn+h8/X3ArvLXbQsDlhy
         mWOJ8OV9ZcobVQ/0JiIZ9OuzolB7Pcwt9rxAo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=pbN96PVY7u14K5RZ0+8Vxjb2FT7LqtwpXerww6jBVQXQ9c2meU9VVF2zenN+Rg6KzU
         PnGCCMmi7yoAWsCZx/P3sAOkf2jHBGdFjySv6gHyhzCVYOlXvrw54sv1laTEvTnSP2sx
         lhhqK26hVG/TOaR3+iGg94Iu40dlsvPAuQylA=
MIME-Version: 1.0
Received: by 10.220.45.131 with SMTP id e3mr3243291vcf.89.1241099181889; Thu, 
	30 Apr 2009 06:46:21 -0700 (PDT)
In-Reply-To: <d36c28c30904300323pc0c551fm354e9e4a6b6fb3c2@mail.gmail.com>
References: <d36c28c30904300029t6414e3fapf4a36619baeabed9@mail.gmail.com>
	 <8c4e68610904300130m44a7e41ekb830af82bbe5f8dd@mail.gmail.com>
	 <d36c28c30904300323pc0c551fm354e9e4a6b6fb3c2@mail.gmail.com>
Date: Thu, 30 Apr 2009 09:46:21 -0400
Message-ID: <359a92830904300646v3120eed8if0768103a707228b@mail.gmail.com>
Subject: Re: Indexing becomes slow with time
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6470526de18550468c5eb24
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6470526de18550468c5eb24
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

This is surprising behavior, which is another way of saying that,
given what you've said so far, this shouldn't be happening. I'd
really look at system metrics, like whether you're swapping
etc. In particular you might want to try varying how big you
allow your memory footprint to grow before you flush, this is
in the doc Ian pointed out under *
Flush by RAM usage instead of document count*

There's no need to periodically optimize, just do that at the end
if you must.

Best
Erick

On Thu, Apr 30, 2009 at 6:23 AM, liat oren <oren.liat@gmail.com> wrote:

> Yes, I do run optimize...
>
> I did start looking at these tips in the last few days, but didn't think
> the
> optimize makes it so slow.
>
> Thanks!
>
> 2009/4/30 Ian Lea <ian.lea@gmail.com>
>
> > Are you maybe running optimize after every n documents?  There are
> > lots of tips in
> > http://wiki.apache.org/lucene-java/ImproveIndexingSpeed.
> >
> >
> > --
> > Ian.
> >
> >
> > On Thu, Apr 30, 2009 at 8:29 AM, liat oren <oren.liat@gmail.com> wrote:
> > > Hi,
> > >
> > > I noticed that when I start to index, it indexes 7 documents a second.
> > After
> > > 30 minutes it goes down to 3 documents a second.
> > > After two hours it becomes very slow (I stopped it when it arrived to
> > 320MB
> > > and did 1 document in almost a minute)
> > >
> > > As you can see, it happens only after 2000, 3000 documnet.
> > > Should I split them into more indexes?
> > >
> > >
> > > Thanks,
> > > Liat
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--0016e6470526de18550468c5eb24--

From java-user-return-40033-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 15:45:48 2009
Return-Path: <java-user-return-40033-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10393 invoked from network); 30 Apr 2009 15:45:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 15:45:47 -0000
Received: (qmail 61082 invoked by uid 500); 30 Apr 2009 15:32:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53438 invoked by uid 500); 30 Apr 2009 15:32:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51395 invoked by uid 99); 30 Apr 2009 15:29:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 15:29:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [129.187.254.102] (HELO mailrelay2.lrz-muenchen.de) (129.187.254.102)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 15:29:15 +0000
Received: from ares.ze.tum.de (ares.ze.tum.de [129.187.39.25]) by mailout.lrz-muenchen.de with ESMTP for java-user@lucene.apache.org; Thu, 30 Apr 2009 17:28:28 +0200
To: java-user@lucene.apache.org
CC: 
From: Kamal Najib <kamal.najib@mytum.de>
Subject: =?iso-8859-1?q?=5B_no_subject_=5D?=
Date: Thu, 30 Apr 2009 17:28:27 +0200
Mime-version: 1.0
Content-type: Multipart/mixed; boundary="===============0481555878571350384=="
Message-Id: <iss.bb8178fe.3960.49f9c39c.44d43.37@mailout.lrz-muenchen.de>
X-Virus-Checked: Checked by ClamAV on apache.org

--===============0481555878571350384==
Content-Type: text/plain; charset="iso-8859-1"
MIME-Version: 1.0
Content-Transfer-Encoding: quoted-printable

Hi, =

A am new in Lucene and I want to get the similarity between two vectors of =
strings,is there a method, who do that? =

for example assume the vectors: =

Vector1 :<"term1","term2","term3"> =

Vector2:<"term4","term5","term5"> =

is there a method to get the similarity between them in lucene,or is there =
any other way to do it? =

for esample: getTheSymilarity(Vector1,Vector2). =

Thanks in advance. =

kamal.  =


--=20


--===============0481555878571350384==
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--===============0481555878571350384==--

From java-user-return-40034-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 16:45:51 2009
Return-Path: <java-user-return-40034-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34306 invoked from network); 30 Apr 2009 16:45:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 16:45:51 -0000
Received: (qmail 82568 invoked by uid 500); 30 Apr 2009 16:44:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82041 invoked by uid 500); 30 Apr 2009 16:44:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81213 invoked by uid 99); 30 Apr 2009 16:37:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 16:37:15 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [207.46.51.80] (HELO SG2EHSOBE003.bigfish.com) (207.46.51.80)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 16:37:06 +0000
Received: from mail207-sin-R.bigfish.com (10.3.40.3) by
 SG2EHSOBE003.bigfish.com (10.3.40.23) with Microsoft SMTP Server id
 8.1.340.0; Thu, 30 Apr 2009 16:36:42 +0000
Received: from mail207-sin (localhost.localdomain [127.0.0.1])	by
 mail207-sin-R.bigfish.com (Postfix) with ESMTP id E709CBC81D7	for
 <java-user@lucene.apache.org>; Thu, 30 Apr 2009 16:36:42 +0000 (UTC)
X-BigFish: VPS-12(zz14c3M936eQzz1202hzzz2dh6bh43j)
Received: by mail207-sin (MessageSwitch) id 1241109401543632_26901; Thu, 30
 Apr 2009 16:36:41 +0000 (UCT)
Received: from us-voo-smtp05.internal.sungard.corp (unknown [216.83.166.46])
	(using TLSv1 with cipher RC4-MD5 (128/128 bits))	(No client certificate
 requested)	by mail207-sin.bigfish.com (Postfix) with ESMTP id ECE101738059
	for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 16:36:40 +0000 (UTC)
Received: from us-voo-smtp11.internal.sungard.corp ([168.162.128.53]) by
 us-voo-smtp05.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 30 Apr 2009 12:36:37 -0400
Received: from VOO-EXCHANGE01.internal.sungard.corp ([168.162.128.81]) by
 us-voo-smtp11.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 30 Apr 2009 12:36:37 -0400
Received: from VOO-EXCHANGE04.internal.sungard.corp ([168.162.128.74]) by
 VOO-EXCHANGE01.internal.sungard.corp with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 30 Apr 2009 12:36:18 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: IndexSearcher and out of memory error
Date: Thu, 30 Apr 2009 12:35:43 -0400
Message-ID: <036829964E44B44F80A0D168BB9849E1019BA118@VOO-EXCHANGE04.internal.sungard.corp>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: IndexSearcher and out of memory error
thread-index: AcnJsbSz/HQTml/ORJCBd5Hj+l0EzQ==
From: <Bill.Chesky@sungard.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 30 Apr 2009 16:36:18.0168 (UTC) FILETIME=[C9600F80:01C9C9B1]
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

I'm using Lucene 2.2.0.  I've got a query class that wraps an
IndexSearcher object.  Right now, we create a new IndexSearcher each
time my query class gets instantiated and then it gets used throughout
the life of the query class.  Multiple queries get made against the
IndexSearcher object during this time.  Typically, the query class gets
instantiated many times, queries are made against it and then it gets
garbage collected.  Over time, however, what we are seeing is that
performance degredation occurs and then eventually queries that once
worked end up throwing OutOfMemory exceptions. =20

I have read in the forums that the recommended practice is to only
create one IndexSearcher and keep it open for the life of the app.  In
fact, we used to have it this way, where the query class kept a static
reference to the IndexSearcher that only got initialized once (the first
time the query class got instantiated).  However, a colleague found (I
have not actually tested this myself) that when the index got updated
(from an outside process kicked off by a scheduler) that the new Docs
added to the index were not visible to the IndexSearcher.  This is why
we went to creating a new IndexSearcher for each query class.

My questions are:
1) Does it make sense that we'd be having memory issues the way we are
doing it?  If so, why?
2) Or is this a memory leak bug in 2.2.0?  Note: I am calling
IndexSearcher.close() when I'm done with the query class and I'm still
seeing the OutOfMemoryException.
3) Given that we need to update the index periodically, is there a
recommended solution for this?

FWIW, the code looks something like:

private IndexSearcher searcher =3D null;

public MyQueryClass
{
...
	String indexPath =3D ... // initialize index path
	searcher =3D new IndexSearcher(FSDirectory.getDirectory(new
File(indexPath)));
...
}

private Hits evaluateLucene(org.apache.lucene.search.Query query, Sort
sort)
{
	Hits result =3D null;
       =20
	try
	{
		if (sort =3D=3D null)
		{
			result =3D searcher.search(query);
		}
		else
		{
			result =3D searcher.search(query, sort);
		}
	}=20
	catch (IOException e)
	{
		throw new RuntimeException(e);
	}

	return result;
}

public void close()
{
	try
	{
		seriesIndexSearcher.close();
	}=20
	catch (IOException e)
	{
		throw new RuntimeException(e);
	}
}

Note: all callers to 'evaluateLucene' just have a local Hits object that
presumably gets garbage collected when they go out of scope.

I am calling the MyQueryClass.close() method from the instaniator of the
MyQueryClass instance in a finally clause.

regards,

Bill=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40035-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 18:54:00 2009
Return-Path: <java-user-return-40035-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23312 invoked from network); 30 Apr 2009 18:54:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 18:54:00 -0000
Received: (qmail 92508 invoked by uid 500); 30 Apr 2009 18:32:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92487 invoked by uid 500); 30 Apr 2009 18:32:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92477 invoked by uid 99); 30 Apr 2009 18:32:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 18:32:40 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW
X-Spam-Check-By: apache.org
Received-SPF: unknown (athena.apache.org: error in processing during lookup of MMastroianni@glgroup.com)
Received: from [65.55.88.12] (HELO TX2EHSOBE003.bigfish.com) (65.55.88.12)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 18:32:30 +0000
Received: from mail57-tx2-R.bigfish.com (10.9.14.249) by
 TX2EHSOBE003.bigfish.com (10.9.40.23) with Microsoft SMTP Server id
 8.1.340.0; Thu, 30 Apr 2009 18:32:06 +0000
Received: from mail57-tx2 (localhost.localdomain [127.0.0.1])	by
 mail57-tx2-R.bigfish.com (Postfix) with ESMTP id 2E9BA2A82E4	for
 <java-user@lucene.apache.org>; Thu, 30 Apr 2009 18:32:06 +0000 (UTC)
X-BigFish: VPS-37(zz542NfadRa0dJ62a3L936eQ4015L936fJ9371P19c2k8b9bkzz1233h1202hzz5a6ciz32i6bh)
X-FB-SS: 5,13,
Received: by mail57-tx2 (MessageSwitch) id 1241116324329504_30735; Thu, 30 Apr
 2009 18:32:04 +0000 (UCT)
Received: from GLGNYEXSMTP01.glgroup.com (glgnyexsmtp01.glgroup.com
 [38.112.210.160])	by mail57-tx2.bigfish.com (Postfix) with ESMTP id
 33B0C910059	for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 18:32:04
 +0000 (UTC)
Received: from GLGNYEXBE02.glgroup.com ([10.45.50.82]) by
 GLGNYEXSMTP01.glgroup.com with Microsoft SMTPSVC(6.0.3790.3959);	 Thu, 30 Apr
 2009 14:32:04 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: kamikaze
Date: Thu, 30 Apr 2009 14:34:05 -0400
Message-ID: <9008E1E80EE8A340BACCA3DFF41B21562A50EE@GLGNYEXBE02.glgroup.com>
In-Reply-To: <23307098.post@talk.nabble.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: kamikaze
thread-index: AcnJP5ZKfEqAbL9USk6vktl0GnSINwAgk8iQ
From: Michael Mastroianni <MMastroianni@glgroup.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 30 Apr 2009 18:32:04.0196 (UTC) FILETIME=[F587D240:01C9C9C1]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi-- Using the 1.0.7 jar file, I am having problems with occasional
ArrayIndexOutOfBoundsExceptions and StackOverFlowErrors when trying to
do a find in a P4DocIdSet. Here is a unit test that I can reliably get
to generate a StackOverFlowError. Have you seen this before? Since I'm
using the jar file, I can't really do much debugging of this one.

regards,
Michael


    public void testForOutOfBounds()
    {
        Random rand =3D new Random(System.currentTimeMillis());
        int maxDoc =3D 350000;
        ArrayList<Integer> nums =3D new ArrayList<Integer>();
        HashSet<Integer> seen =3D new HashSet<Integer>();
        for(int i=3D0; i < 68; ++i)
        {
            int nextDoc =3D rand.nextInt(maxDoc);
            if(seen.contains(nextDoc))
            {
                while(seen.contains(nextDoc))
                {
                    nextDoc =3D rand.nextInt(maxDoc);
                }
            }
            nums.add(nextDoc);
            seen.add(nextDoc);
        }
        Collections.sort(nums);
        DocSet docs =3D new P4DDocIdSet();
        for (Integer integer : nums) =

        {
            docs.addDoc(integer);
        }
        boolean got =3D docs.find(403);
    }

-----Original Message-----
From: molz [mailto:anmol.bhasin@gmail.com] =

Sent: Wednesday, April 29, 2009 10:58 PM
To: java-user@lucene.apache.org
Subject: RE: kamikaze


  =

Hi Michael,

2 Questions. =


1. What version of Kamikaze are you running with?
2. Can you try the snippet below and let me know if it fails ? I ran it
20
times and it did not fail. Maybe there is some difference in the
utitlity
methods you have ? I am still trying to track down if anything is off at
my
end but does not seem to be.

    public void testMultipleIntersections() =

    { =

            ArrayList<OpenBitSet> obs =3D new ArrayList<OpenBitSet>(); =

            ArrayList<DocIdSet> docs =3D new ArrayList<DocIdSet>(); =

        Random rand =3D new Random(System.currentTimeMillis()); =

            int maxDoc =3D 350000; =

            for(int i=3D0; i < 3; ++i) =

            { =

                    int numdocs =3D rand.nextInt(maxDoc); =

                    ArrayList<Integer> nums =3D new =

ArrayList<Integer>(); =

                    HashSet<Integer> seen =3D new HashSet<Integer>(); =

                    for (int j =3D 0; j < numdocs; j++) =

                { =

                            int nextDoc =3D rand.nextInt(maxDoc); =

                            if(seen.contains(nextDoc)) =

                            { =

                                    while(seen.contains(nextDoc)) =

                                    { =

                                            nextDoc =3D =

rand.nextInt(maxDoc); =

                                    } =

                            } =

                            nums.add(nextDoc); =

                            seen.add(nextDoc); =

                } =

                    Collections.sort(nums); =

                    obs.add(createObs(nums, maxDoc)); =

                    docs.add(createDocSet(nums)); =

            } =

            OpenBitSet base =3D obs.get(0); =

            for(int i =3D 1; i < obs.size(); ++i) =

            { =

                    base.intersect(obs.get(i)); =

            } =

            =

            AndDocIdSet ands =3D new AndDocIdSet(docs); =

            long card1 =3D base.cardinality(); =

            long card2 =3D ands.size(); =

            System.out.println(card1+":"+card2);
            assertEquals(card1, card2); =

    } =



    private OpenBitSet createObs(ArrayList<Integer> nums, int maxDoc) {
      OpenBitSet bitSet =3D new OpenBitSet(maxDoc);
      for(int num:nums)
        bitSet.set(num);
      return bitSet;
    }
    =

    private DocIdSet createDocSet(ArrayList<Integer> nums) {
      DocSet p4d =3D DocSetFactory.getDocSetInstance(0, 35000000, 200000,
          DocSetFactory.FOCUS.OPTIMAL);
      for(int num:nums)
       p4d.addDoc(num);
      return p4d;
    }

I even tried with the following =


  private DocIdSet createDocSet(ArrayList<Integer> nums) {
      P4DDocIdSet p4d =3D new P4DDocIdSet();
      for(int num:nums)
       p4d.addDoc(num);
      return p4d;
    }


 The NPE you mention in the previous emails has been identified as a bug
and
will be fixed in the next release (in a day or two). =


Thanks,
Anmol


-- =

View this message in context:
http://www.nabble.com/kamikaze-tp23224760p23307098.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



This e-mail message, and any attachments, is intended only for the use of t=
he individual or entity identified in the alias address of this message and=
 may contain information that is confidential, privileged and subject to le=
gal restrictions and penalties regarding its unauthorized disclosure and us=
e. Any unauthorized review, copying, disclosure, use or distribution is str=
ictly prohibited. If you have received this e-mail message in error, please=
 notify the sender immediately by reply e-mail and delete this message, and=
 any attachments, from your system. Thank you.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40036-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 19:19:27 2009
Return-Path: <java-user-return-40036-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40313 invoked from network); 30 Apr 2009 19:19:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 19:19:27 -0000
Received: (qmail 62549 invoked by uid 500); 30 Apr 2009 19:19:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62471 invoked by uid 500); 30 Apr 2009 19:19:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62461 invoked by uid 99); 30 Apr 2009 19:19:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 19:19:25 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [212.82.104.174] (HELO web24701.mail.ird.yahoo.com) (212.82.104.174)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 30 Apr 2009 19:19:15 +0000
Received: (qmail 10661 invoked by uid 60001); 30 Apr 2009 17:10:29 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1241111429; bh=RUnfXGVhaHHZLWSaDGwCDTSGTcD95jhL2zslGLIHfL8=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=xdbFkG6n++1EI59kgiBp2o78i+/0JhVCcfnMxYwMMmi9RgCimO6j+lla7IOzghx69juohBQ35NPUCcR37421cwu14MEK4DajdpD07kwWcBGtgLffiedZyIIkTpa2ugA3ywIx5E6cIXPT9zhiq6NVFRQr7vDBRoi2NKyEy4osebQ=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=CMnNi6fIHHzrgdf+vlNFRwtGNDrj+1+tTqcTatHNjR0/wtTnpuiD3/I8hXKp4tbPUqEWrzZT7aQKYp+kfRzyilRSfIp6CcUsYQtpjvkpKord3HOeAObKnXFE8007Qz4VFzpAG1Cn6x4yNc+ie8Gg1zOfErujeDO06EkXplBuft8=;
Message-ID: <346572.6789.qm@web24701.mail.ird.yahoo.com>
X-YMail-OSG: rGPj760VM1nua8ZFIQ4i11AxkEqb4HMbJDvDhZpU3R.P_R_kAPHZBuAcDtE4c05VUtGH76bfdrSz4uC3trz.HnslHEO3Kxz94qxRee6VSi5k30wDq0BZqC_AuawjIc3OSzcm6SrxiIsXZKaNE8LolZLmgjq7BxopbZeMSXB6IWWGUavhpJj0ZFEAeJ7BVPRu6exe7y786UA3wUDHOuU.1IXmQsU3VbHaOeENdplMNEci2APTpfGVoSWyHFcVaK3Ihdmn.1qPcd3.bIPyMsVRmocLJZw2qxWjb2u1Yf11HMvXOV3yy4_gH28DbDSEQKRNqSgLpzXIDHxIzglflHAMuUA-
Received: from [193.36.230.96] by web24701.mail.ird.yahoo.com via HTTP; Thu, 30 Apr 2009 10:10:28 PDT
X-Mailer: YahooMailRC/1277.35 YahooMailWebService/0.7.289.1
References: <d36c28c30904300029t6414e3fapf4a36619baeabed9@mail.gmail.com>  <8c4e68610904300130m44a7e41ekb830af82bbe5f8dd@mail.gmail.com>  <d36c28c30904300323pc0c551fm354e9e4a6b6fb3c2@mail.gmail.com> <359a92830904300646v3120eed8if0768103a707228b@mail.gmail.com>
Date: Thu, 30 Apr 2009 10:10:28 -0700 (PDT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: Indexing becomes slow with time
To: java-user@lucene.apache.org
In-Reply-To: <359a92830904300646v3120eed8if0768103a707228b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org


If you're CPU-bound - I've had issues before with GC in long-running indexi=
ng tasks loading very large volumes (100s of millions) of docs. I was seein=
g lots of CPU usage tied up in GC.=0A=0AI solved all these problems by firi=
ng batches of indexing activity off in seperate processes then immediately =
killing them after use. This is the most effective form of garbage collecti=
on you can get...=0AI don't see any advantage (other than hotspotting) of k=
eeping any of the resources created during an indexing batch after that bat=
ch has been committed. Why burn CPU cycles garbage collecting when you know=
 there is nothing of value to be retained?=0A=0AClearly this may not be an =
approach where batches of updates are committed very frequently (i.e. when =
measured in seconds not minutes) but for heavy ingest this approach can sit=
 quite happily alongside a seperate long-running process used for servicing=
 searches without loading the search process with the task of garbage colle=
cting the indexing debris. The search process can periodically reopen Index=
Reader to see the new segments created in other indexing processes.=0A=0ACh=
eers=0AMark=0A=0A=0A=0A=0A----- Original Message ----=0AFrom: Erick Erickso=
n <erickerickson@gmail.com>=0ATo: java-user@lucene.apache.org=0ASent: Thurs=
day, 30 April, 2009 14:46:21=0ASubject: Re: Indexing becomes slow with time=
=0A=0AThis is surprising behavior, which is another way of saying that,=0Ag=
iven what you've said so far, this shouldn't be happening. I'd=0Areally loo=
k at system metrics, like whether you're swapping=0Aetc. In particular you =
might want to try varying how big you=0Aallow your memory footprint to grow=
 before you flush, this is=0Ain the doc Ian pointed out under *=0AFlush by =
RAM usage instead of document count*=0A=0AThere's no need to periodically o=
ptimize, just do that at the end=0Aif you must.=0A=0ABest=0AErick=0A=0AOn T=
hu, Apr 30, 2009 at 6:23 AM, liat oren <oren.liat@gmail.com> wrote:=0A=0A> =
Yes, I do run optimize...=0A>=0A> I did start looking at these tips in the =
last few days, but didn't think=0A> the=0A> optimize makes it so slow.=0A>=
=0A> Thanks!=0A>=0A> 2009/4/30 Ian Lea <ian.lea@gmail.com>=0A>=0A> > Are yo=
u maybe running optimize after every n documents?  There are=0A> > lots of =
tips in=0A> > http://wiki.apache.org/lucene-java/ImproveIndexingSpeed.=0A> =
>=0A> >=0A> > --=0A> > Ian.=0A> >=0A> >=0A> > On Thu, Apr 30, 2009 at 8:29 =
AM, liat oren <oren.liat@gmail.com> wrote:=0A> > > Hi,=0A> > >=0A> > > I no=
ticed that when I start to index, it indexes 7 documents a second.=0A> > Af=
ter=0A> > > 30 minutes it goes down to 3 documents a second.=0A> > > After =
two hours it becomes very slow (I stopped it when it arrived to=0A> > 320MB=
=0A> > > and did 1 document in almost a minute)=0A> > >=0A> > > As you can =
see, it happens only after 2000, 3000 documnet.=0A> > > Should I split them=
 into more indexes?=0A> > >=0A> > >=0A> > > Thanks,=0A> > > Liat=0A> > >=0A=
> >=0A> > -----------------------------------------------------------------=
----=0A> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org=
=0A> > For additional commands, e-mail: java-user-help@lucene.apache.org=0A=
> >=0A> >=0A>=0A=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40037-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 19:33:34 2009
Return-Path: <java-user-return-40037-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48758 invoked from network); 30 Apr 2009 19:33:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 19:33:34 -0000
Received: (qmail 81291 invoked by uid 500); 30 Apr 2009 19:33:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81222 invoked by uid 500); 30 Apr 2009 19:33:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81212 invoked by uid 99); 30 Apr 2009 19:33:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 19:33:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 19:33:22 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lzc0D-0006xN-0Z
	for java-user@lucene.apache.org; Thu, 30 Apr 2009 12:33:01 -0700
Message-ID: <23322582.post@talk.nabble.com>
Date: Thu, 30 Apr 2009 12:33:01 -0700 (PDT)
From: molz <anmol.bhasin@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: kamikaze
In-Reply-To: <9008E1E80EE8A340BACCA3DFF41B21562A50EE@GLGNYEXBE02.glgroup.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: anmol.bhasin@gmail.com
References: <9008E1E80EE8A340BACCA3DFF41B21562A4C9A@GLGNYEXBE02.glgroup.com> <8837fb770904241649i6beb28e5i770eca9c50b5d8e5@mail.gmail.com> <9008E1E80EE8A340BACCA3DFF41B21562A4E18@GLGNYEXBE02.glgroup.com> <23288825.post@talk.nabble.com> <9008E1E80EE8A340BACCA3DFF41B21562A4F5E@GLGNYEXBE02.glgroup.com> <23302407.post@talk.nabble.com> <23307098.post@talk.nabble.com> <9008E1E80EE8A340BACCA3DFF41B21562A50EE@GLGNYEXBE02.glgroup.com>
X-Virus-Checked: Checked by ClamAV on apache.org



Hi,

That method needs to be deprecated. Please use findWithIndex() instead. I
will deprecate that method in the next release. Also, I will enable line
numbers in it.

Anmol




Michael Mastroianni wrote:
> 
> Hi-- Using the 1.0.7 jar file, I am having problems with occasional
> ArrayIndexOutOfBoundsExceptions and StackOverFlowErrors when trying to
> do a find in a P4DocIdSet. Here is a unit test that I can reliably get
> to generate a StackOverFlowError. Have you seen this before? Since I'm
> using the jar file, I can't really do much debugging of this one.
> 
> regards,
> Michael
> 
> 
>     public void testForOutOfBounds()
>     {
>         Random rand = new Random(System.currentTimeMillis());
>         int maxDoc = 350000;
>         ArrayList<Integer> nums = new ArrayList<Integer>();
>         HashSet<Integer> seen = new HashSet<Integer>();
>         for(int i=0; i < 68; ++i)
>         {
>             int nextDoc = rand.nextInt(maxDoc);
>             if(seen.contains(nextDoc))
>             {
>                 while(seen.contains(nextDoc))
>                 {
>                     nextDoc = rand.nextInt(maxDoc);
>                 }
>             }
>             nums.add(nextDoc);
>             seen.add(nextDoc);
>         }
>         Collections.sort(nums);
>         DocSet docs = new P4DDocIdSet();
>         for (Integer integer : nums) 
>         {
>             docs.addDoc(integer);
>         }
>         boolean got = docs.find(403);
>     }
> 
> -----Original Message-----
> From: molz [mailto:anmol.bhasin@gmail.com] 
> Sent: Wednesday, April 29, 2009 10:58 PM
> To: java-user@lucene.apache.org
> Subject: RE: kamikaze
> 
> 
>   
> Hi Michael,
> 
> 2 Questions. 
> 
> 1. What version of Kamikaze are you running with?
> 2. Can you try the snippet below and let me know if it fails ? I ran it
> 20
> times and it did not fail. Maybe there is some difference in the
> utitlity
> methods you have ? I am still trying to track down if anything is off at
> my
> end but does not seem to be.
> 
>     public void testMultipleIntersections() 
>     { 
>             ArrayList<OpenBitSet> obs = new ArrayList<OpenBitSet>(); 
>             ArrayList<DocIdSet> docs = new ArrayList<DocIdSet>(); 
>         Random rand = new Random(System.currentTimeMillis()); 
>             int maxDoc = 350000; 
>             for(int i=0; i < 3; ++i) 
>             { 
>                     int numdocs = rand.nextInt(maxDoc); 
>                     ArrayList<Integer> nums = new 
> ArrayList<Integer>(); 
>                     HashSet<Integer> seen = new HashSet<Integer>(); 
>                     for (int j = 0; j < numdocs; j++) 
>                 { 
>                             int nextDoc = rand.nextInt(maxDoc); 
>                             if(seen.contains(nextDoc)) 
>                             { 
>                                     while(seen.contains(nextDoc)) 
>                                     { 
>                                             nextDoc = 
> rand.nextInt(maxDoc); 
>                                     } 
>                             } 
>                             nums.add(nextDoc); 
>                             seen.add(nextDoc); 
>                 } 
>                     Collections.sort(nums); 
>                     obs.add(createObs(nums, maxDoc)); 
>                     docs.add(createDocSet(nums)); 
>             } 
>             OpenBitSet base = obs.get(0); 
>             for(int i = 1; i < obs.size(); ++i) 
>             { 
>                     base.intersect(obs.get(i)); 
>             } 
>             
>             AndDocIdSet ands = new AndDocIdSet(docs); 
>             long card1 = base.cardinality(); 
>             long card2 = ands.size(); 
>             System.out.println(card1+":"+card2);
>             assertEquals(card1, card2); 
>     } 
> 
> 
>     private OpenBitSet createObs(ArrayList<Integer> nums, int maxDoc) {
>       OpenBitSet bitSet = new OpenBitSet(maxDoc);
>       for(int num:nums)
>         bitSet.set(num);
>       return bitSet;
>     }
>     
>     private DocIdSet createDocSet(ArrayList<Integer> nums) {
>       DocSet p4d = DocSetFactory.getDocSetInstance(0, 35000000, 200000,
>           DocSetFactory.FOCUS.OPTIMAL);
>       for(int num:nums)
>        p4d.addDoc(num);
>       return p4d;
>     }
> 
> I even tried with the following 
> 
>   private DocIdSet createDocSet(ArrayList<Integer> nums) {
>       P4DDocIdSet p4d = new P4DDocIdSet();
>       for(int num:nums)
>        p4d.addDoc(num);
>       return p4d;
>     }
> 
> 
>  The NPE you mention in the previous emails has been identified as a bug
> and
> will be fixed in the next release (in a day or two). 
> 
> Thanks,
> Anmol
> 
> 
> -- 
> View this message in context:
> http://www.nabble.com/kamikaze-tp23224760p23307098.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
> This e-mail message, and any attachments, is intended only for the use of
> the individual or entity identified in the alias address of this message
> and may contain information that is confidential, privileged and subject
> to legal restrictions and penalties regarding its unauthorized disclosure
> and use. Any unauthorized review, copying, disclosure, use or distribution
> is strictly prohibited. If you have received this e-mail message in error,
> please notify the sender immediately by reply e-mail and delete this
> message, and any attachments, from your system. Thank you.
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/kamikaze-tp23224760p23322582.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40038-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 19:47:01 2009
Return-Path: <java-user-return-40038-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56490 invoked from network); 30 Apr 2009 19:47:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 19:47:00 -0000
Received: (qmail 97477 invoked by uid 500); 30 Apr 2009 19:46:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97405 invoked by uid 500); 30 Apr 2009 19:46:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97395 invoked by uid 99); 30 Apr 2009 19:46:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 19:46:57 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED
X-Spam-Check-By: apache.org
Received-SPF: unknown (athena.apache.org: error in processing during lookup of MMastroianni@glgroup.com)
Received: from [213.199.154.16] (HELO IE1EHSOBE004.bigfish.com) (213.199.154.16)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 19:46:47 +0000
Received: from mail40-dub-R.bigfish.com (10.5.252.3) by
 IE1EHSOBE004.bigfish.com (10.5.252.24) with Microsoft SMTP Server id
 8.1.340.0; Thu, 30 Apr 2009 19:46:25 +0000
Received: from mail40-dub (localhost.localdomain [127.0.0.1])	by
 mail40-dub-R.bigfish.com (Postfix) with ESMTP id CEC7EBE8133	for
 <java-user@lucene.apache.org>; Thu, 30 Apr 2009 19:46:25 +0000 (UTC)
X-BigFish: VPS-62(zz542NfadR1432Ra0dJ62a3L98dR936eQ4015L1805M936fJ9371P19c2k8b9bkzz1233h1202hzz5a6ciz32i6bh61h)
X-Spam-TCS-SCL: 0:0
Received: by mail40-dub (MessageSwitch) id 1241120783430020_2419; Thu, 30 Apr
 2009 19:46:23 +0000 (UCT)
Received: from GLGNYEXSMTP01.glgroup.com (glgnyexsmtp01.glgroup.com
 [38.112.210.160])	by mail40-dub.bigfish.com (Postfix) with ESMTP id
 EF0941C6005B	for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 19:46:22
 +0000 (UTC)
Received: from GLGNYEXBE02.glgroup.com ([10.45.50.82]) by
 GLGNYEXSMTP01.glgroup.com with Microsoft SMTPSVC(6.0.3790.3959);	 Thu, 30 Apr
 2009 15:46:22 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: kamikaze
Date: Thu, 30 Apr 2009 15:48:23 -0400
Message-ID: <9008E1E80EE8A340BACCA3DFF41B21562A50FF@GLGNYEXBE02.glgroup.com>
In-Reply-To: <23322582.post@talk.nabble.com>
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Thread-Topic: kamikaze
thread-index: AcnJyo/uIylmFptTQDymFKUy1tfYMQAAfBAA
From: Michael Mastroianni <MMastroianni@glgroup.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 30 Apr 2009 19:46:22.0159 (UTC) FILETIME=[56AEFDF0:01C9C9CC]
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks, Anmol. Just so I'm clear on this: findWithIndex(foo) returns -1
if foo is not found, and some positive integer if it is?

regards,
Michael

-----Original Message-----
From: molz [mailto:anmol.bhasin@gmail.com] =

Sent: Thursday, April 30, 2009 3:33 PM
To: java-user@lucene.apache.org
Subject: RE: kamikaze



Hi,

That method needs to be deprecated. Please use findWithIndex() instead.
I
will deprecate that method in the next release. Also, I will enable line
numbers in it.

Anmol




Michael Mastroianni wrote:
> =

> Hi-- Using the 1.0.7 jar file, I am having problems with occasional
> ArrayIndexOutOfBoundsExceptions and StackOverFlowErrors when trying to
> do a find in a P4DocIdSet. Here is a unit test that I can reliably get
> to generate a StackOverFlowError. Have you seen this before? Since I'm
> using the jar file, I can't really do much debugging of this one.
> =

> regards,
> Michael
> =

> =

>     public void testForOutOfBounds()
>     {
>         Random rand =3D new Random(System.currentTimeMillis());
>         int maxDoc =3D 350000;
>         ArrayList<Integer> nums =3D new ArrayList<Integer>();
>         HashSet<Integer> seen =3D new HashSet<Integer>();
>         for(int i=3D0; i < 68; ++i)
>         {
>             int nextDoc =3D rand.nextInt(maxDoc);
>             if(seen.contains(nextDoc))
>             {
>                 while(seen.contains(nextDoc))
>                 {
>                     nextDoc =3D rand.nextInt(maxDoc);
>                 }
>             }
>             nums.add(nextDoc);
>             seen.add(nextDoc);
>         }
>         Collections.sort(nums);
>         DocSet docs =3D new P4DDocIdSet();
>         for (Integer integer : nums) =

>         {
>             docs.addDoc(integer);
>         }
>         boolean got =3D docs.find(403);
>     }
> =

> -----Original Message-----
> From: molz [mailto:anmol.bhasin@gmail.com] =

> Sent: Wednesday, April 29, 2009 10:58 PM
> To: java-user@lucene.apache.org
> Subject: RE: kamikaze
> =

> =

>   =

> Hi Michael,
> =

> 2 Questions. =

> =

> 1. What version of Kamikaze are you running with?
> 2. Can you try the snippet below and let me know if it fails ? I ran
it
> 20
> times and it did not fail. Maybe there is some difference in the
> utitlity
> methods you have ? I am still trying to track down if anything is off
at
> my
> end but does not seem to be.
> =

>     public void testMultipleIntersections() =

>     { =

>             ArrayList<OpenBitSet> obs =3D new ArrayList<OpenBitSet>(); =

>             ArrayList<DocIdSet> docs =3D new ArrayList<DocIdSet>(); =

>         Random rand =3D new Random(System.currentTimeMillis()); =

>             int maxDoc =3D 350000; =

>             for(int i=3D0; i < 3; ++i) =

>             { =

>                     int numdocs =3D rand.nextInt(maxDoc); =

>                     ArrayList<Integer> nums =3D new =

> ArrayList<Integer>(); =

>                     HashSet<Integer> seen =3D new HashSet<Integer>(); =

>                     for (int j =3D 0; j < numdocs; j++) =

>                 { =

>                             int nextDoc =3D rand.nextInt(maxDoc); =

>                             if(seen.contains(nextDoc)) =

>                             { =

>                                     while(seen.contains(nextDoc)) =

>                                     { =

>                                             nextDoc =3D =

> rand.nextInt(maxDoc); =

>                                     } =

>                             } =

>                             nums.add(nextDoc); =

>                             seen.add(nextDoc); =

>                 } =

>                     Collections.sort(nums); =

>                     obs.add(createObs(nums, maxDoc)); =

>                     docs.add(createDocSet(nums)); =

>             } =

>             OpenBitSet base =3D obs.get(0); =

>             for(int i =3D 1; i < obs.size(); ++i) =

>             { =

>                     base.intersect(obs.get(i)); =

>             } =

>             =

>             AndDocIdSet ands =3D new AndDocIdSet(docs); =

>             long card1 =3D base.cardinality(); =

>             long card2 =3D ands.size(); =

>             System.out.println(card1+":"+card2);
>             assertEquals(card1, card2); =

>     } =

> =

> =

>     private OpenBitSet createObs(ArrayList<Integer> nums, int maxDoc)
{
>       OpenBitSet bitSet =3D new OpenBitSet(maxDoc);
>       for(int num:nums)
>         bitSet.set(num);
>       return bitSet;
>     }
>     =

>     private DocIdSet createDocSet(ArrayList<Integer> nums) {
>       DocSet p4d =3D DocSetFactory.getDocSetInstance(0, 35000000,
200000,
>           DocSetFactory.FOCUS.OPTIMAL);
>       for(int num:nums)
>        p4d.addDoc(num);
>       return p4d;
>     }
> =

> I even tried with the following =

> =

>   private DocIdSet createDocSet(ArrayList<Integer> nums) {
>       P4DDocIdSet p4d =3D new P4DDocIdSet();
>       for(int num:nums)
>        p4d.addDoc(num);
>       return p4d;
>     }
> =

> =

>  The NPE you mention in the previous emails has been identified as a
bug
> and
> will be fixed in the next release (in a day or two). =

> =

> Thanks,
> Anmol
> =

> =

> -- =

> View this message in context:
> http://www.nabble.com/kamikaze-tp23224760p23307098.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> =

> =

> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> =

> =

> =

> This e-mail message, and any attachments, is intended only for the use
of
> the individual or entity identified in the alias address of this
message
> and may contain information that is confidential, privileged and
subject
> to legal restrictions and penalties regarding its unauthorized
disclosure
> and use. Any unauthorized review, copying, disclosure, use or
distribution
> is strictly prohibited. If you have received this e-mail message in
error,
> please notify the sender immediately by reply e-mail and delete this
> message, and any attachments, from your system. Thank you.
> =

> =

> =

> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> =

> =

> =


-- =

View this message in context:
http://www.nabble.com/kamikaze-tp23224760p23322582.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



This e-mail message, and any attachments, is intended only for the use of t=
he individual or entity identified in the alias address of this message and=
 may contain information that is confidential, privileged and subject to le=
gal restrictions and penalties regarding its unauthorized disclosure and us=
e. Any unauthorized review, copying, disclosure, use or distribution is str=
ictly prohibited. If you have received this e-mail message in error, please=
 notify the sender immediately by reply e-mail and delete this message, and=
 any attachments, from your system. Thank you.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40039-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 20:01:20 2009
Return-Path: <java-user-return-40039-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65106 invoked from network); 30 Apr 2009 20:01:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 20:01:20 -0000
Received: (qmail 29708 invoked by uid 500); 30 Apr 2009 20:01:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29673 invoked by uid 500); 30 Apr 2009 20:01:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29663 invoked by uid 99); 30 Apr 2009 20:01:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 20:01:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [129.187.254.102] (HELO mailrelay2.lrz-muenchen.de) (129.187.254.102)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 20:01:07 +0000
Received: from klio.ze.tum.de (klio.ze.tum.de [129.187.39.43]) by mailout.lrz-muenchen.de with ESMTP for java-user@lucene.apache.org; Thu, 30 Apr 2009 22:00:20 +0200
To: java-user@lucene.apache.org
CC: 
From: Kamal Najib <kamal.najib@mytum.de>
Subject: =?iso-8859-1?q?How_to_get_the_similarity_between_two_string_vectors=3F?=
Date: Thu, 30 Apr 2009 22:00:17 +0200
Mime-version: 1.0
Content-type: Multipart/mixed; boundary="===============8993134167134014748=="
Message-Id: <iss.bb8178fe.1b35.49fa0354.87cd6.92@mailout.lrz-muenchen.de>
X-Virus-Checked: Checked by ClamAV on apache.org

--===============8993134167134014748==
Content-Type: text/plain; charset="iso-8859-1"
MIME-Version: 1.0
Content-Transfer-Encoding: quoted-printable

Hi,
I am new to Lucene and I want to get the similarity between two vectors of =
strings,is there a method, who do that?
for example if i have the vectors:
Vector1 :<"term1","term2","term3">
Vector2:<"term4","term5","term5">
is there a method to get the similarity between them in lucene,or is there =
any other way to do it?
for esample: MethodName(Vector1,Vector2).
Thanks in advance.
kamal. =

--=20


--===============8993134167134014748==
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--===============8993134167134014748==--

From java-user-return-40040-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 21:42:47 2009
Return-Path: <java-user-return-40040-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7638 invoked from network); 30 Apr 2009 21:42:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 21:42:47 -0000
Received: (qmail 50364 invoked by uid 500); 30 Apr 2009 21:42:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50309 invoked by uid 500); 30 Apr 2009 21:42:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50299 invoked by uid 99); 30 Apr 2009 21:42:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 21:42:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 21:42:34 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Lze1F-0003fT-23
	for java-user@lucene.apache.org; Thu, 30 Apr 2009 14:42:13 -0700
Message-ID: <23324860.post@talk.nabble.com>
Date: Thu, 30 Apr 2009 14:42:13 -0700 (PDT)
From: molz <anmol.bhasin@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: kamikaze
In-Reply-To: <9008E1E80EE8A340BACCA3DFF41B21562A50FF@GLGNYEXBE02.glgroup.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: anmol.bhasin@gmail.com
References: <9008E1E80EE8A340BACCA3DFF41B21562A4C9A@GLGNYEXBE02.glgroup.com> <8837fb770904241649i6beb28e5i770eca9c50b5d8e5@mail.gmail.com> <9008E1E80EE8A340BACCA3DFF41B21562A4E18@GLGNYEXBE02.glgroup.com> <23288825.post@talk.nabble.com> <9008E1E80EE8A340BACCA3DFF41B21562A4F5E@GLGNYEXBE02.glgroup.com> <23302407.post@talk.nabble.com> <23307098.post@talk.nabble.com> <9008E1E80EE8A340BACCA3DFF41B21562A50EE@GLGNYEXBE02.glgroup.com> <23322582.post@talk.nabble.com> <9008E1E80EE8A340BACCA3DFF41B21562A50FF@GLGNYEXBE02.glgroup.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Right on. 

-1 if not found, index in the sorted set if found. 

Anmol



Michael Mastroianni wrote:
> 
> Thanks, Anmol. Just so I'm clear on this: findWithIndex(foo) returns -1
> if foo is not found, and some positive integer if it is?
> 
> regards,
> Michael
> 
> -----Original Message-----
> From: molz [mailto:anmol.bhasin@gmail.com] 
> Sent: Thursday, April 30, 2009 3:33 PM
> To: java-user@lucene.apache.org
> Subject: RE: kamikaze
> 
> 
> 
> Hi,
> 
> That method needs to be deprecated. Please use findWithIndex() instead.
> I
> will deprecate that method in the next release. Also, I will enable line
> numbers in it.
> 
> Anmol
> 
> 
> 
> 
> Michael Mastroianni wrote:
>> 
>> Hi-- Using the 1.0.7 jar file, I am having problems with occasional
>> ArrayIndexOutOfBoundsExceptions and StackOverFlowErrors when trying to
>> do a find in a P4DocIdSet. Here is a unit test that I can reliably get
>> to generate a StackOverFlowError. Have you seen this before? Since I'm
>> using the jar file, I can't really do much debugging of this one.
>> 
>> regards,
>> Michael
>> 
>> 
>>     public void testForOutOfBounds()
>>     {
>>         Random rand = new Random(System.currentTimeMillis());
>>         int maxDoc = 350000;
>>         ArrayList<Integer> nums = new ArrayList<Integer>();
>>         HashSet<Integer> seen = new HashSet<Integer>();
>>         for(int i=0; i < 68; ++i)
>>         {
>>             int nextDoc = rand.nextInt(maxDoc);
>>             if(seen.contains(nextDoc))
>>             {
>>                 while(seen.contains(nextDoc))
>>                 {
>>                     nextDoc = rand.nextInt(maxDoc);
>>                 }
>>             }
>>             nums.add(nextDoc);
>>             seen.add(nextDoc);
>>         }
>>         Collections.sort(nums);
>>         DocSet docs = new P4DDocIdSet();
>>         for (Integer integer : nums) 
>>         {
>>             docs.addDoc(integer);
>>         }
>>         boolean got = docs.find(403);
>>     }
>> 
>> -----Original Message-----
>> From: molz [mailto:anmol.bhasin@gmail.com] 
>> Sent: Wednesday, April 29, 2009 10:58 PM
>> To: java-user@lucene.apache.org
>> Subject: RE: kamikaze
>> 
>> 
>>   
>> Hi Michael,
>> 
>> 2 Questions. 
>> 
>> 1. What version of Kamikaze are you running with?
>> 2. Can you try the snippet below and let me know if it fails ? I ran
> it
>> 20
>> times and it did not fail. Maybe there is some difference in the
>> utitlity
>> methods you have ? I am still trying to track down if anything is off
> at
>> my
>> end but does not seem to be.
>> 
>>     public void testMultipleIntersections() 
>>     { 
>>             ArrayList<OpenBitSet> obs = new ArrayList<OpenBitSet>(); 
>>             ArrayList<DocIdSet> docs = new ArrayList<DocIdSet>(); 
>>         Random rand = new Random(System.currentTimeMillis()); 
>>             int maxDoc = 350000; 
>>             for(int i=0; i < 3; ++i) 
>>             { 
>>                     int numdocs = rand.nextInt(maxDoc); 
>>                     ArrayList<Integer> nums = new 
>> ArrayList<Integer>(); 
>>                     HashSet<Integer> seen = new HashSet<Integer>(); 
>>                     for (int j = 0; j < numdocs; j++) 
>>                 { 
>>                             int nextDoc = rand.nextInt(maxDoc); 
>>                             if(seen.contains(nextDoc)) 
>>                             { 
>>                                     while(seen.contains(nextDoc)) 
>>                                     { 
>>                                             nextDoc = 
>> rand.nextInt(maxDoc); 
>>                                     } 
>>                             } 
>>                             nums.add(nextDoc); 
>>                             seen.add(nextDoc); 
>>                 } 
>>                     Collections.sort(nums); 
>>                     obs.add(createObs(nums, maxDoc)); 
>>                     docs.add(createDocSet(nums)); 
>>             } 
>>             OpenBitSet base = obs.get(0); 
>>             for(int i = 1; i < obs.size(); ++i) 
>>             { 
>>                     base.intersect(obs.get(i)); 
>>             } 
>>             
>>             AndDocIdSet ands = new AndDocIdSet(docs); 
>>             long card1 = base.cardinality(); 
>>             long card2 = ands.size(); 
>>             System.out.println(card1+":"+card2);
>>             assertEquals(card1, card2); 
>>     } 
>> 
>> 
>>     private OpenBitSet createObs(ArrayList<Integer> nums, int maxDoc)
> {
>>       OpenBitSet bitSet = new OpenBitSet(maxDoc);
>>       for(int num:nums)
>>         bitSet.set(num);
>>       return bitSet;
>>     }
>>     
>>     private DocIdSet createDocSet(ArrayList<Integer> nums) {
>>       DocSet p4d = DocSetFactory.getDocSetInstance(0, 35000000,
> 200000,
>>           DocSetFactory.FOCUS.OPTIMAL);
>>       for(int num:nums)
>>        p4d.addDoc(num);
>>       return p4d;
>>     }
>> 
>> I even tried with the following 
>> 
>>   private DocIdSet createDocSet(ArrayList<Integer> nums) {
>>       P4DDocIdSet p4d = new P4DDocIdSet();
>>       for(int num:nums)
>>        p4d.addDoc(num);
>>       return p4d;
>>     }
>> 
>> 
>>  The NPE you mention in the previous emails has been identified as a
> bug
>> and
>> will be fixed in the next release (in a day or two). 
>> 
>> Thanks,
>> Anmol
>> 
>> 
>> -- 
>> View this message in context:
>> http://www.nabble.com/kamikaze-tp23224760p23307098.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> 
>> 
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> 
>> 
>> 
>> This e-mail message, and any attachments, is intended only for the use
> of
>> the individual or entity identified in the alias address of this
> message
>> and may contain information that is confidential, privileged and
> subject
>> to legal restrictions and penalties regarding its unauthorized
> disclosure
>> and use. Any unauthorized review, copying, disclosure, use or
> distribution
>> is strictly prohibited. If you have received this e-mail message in
> error,
>> please notify the sender immediately by reply e-mail and delete this
>> message, and any attachments, from your system. Thank you.
>> 
>> 
>> 
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> 
>> 
>> 
> 
> -- 
> View this message in context:
> http://www.nabble.com/kamikaze-tp23224760p23322582.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
> This e-mail message, and any attachments, is intended only for the use of
> the individual or entity identified in the alias address of this message
> and may contain information that is confidential, privileged and subject
> to legal restrictions and penalties regarding its unauthorized disclosure
> and use. Any unauthorized review, copying, disclosure, use or distribution
> is strictly prohibited. If you have received this e-mail message in error,
> please notify the sender immediately by reply e-mail and delete this
> message, and any attachments, from your system. Thank you.
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/kamikaze-tp23224760p23324860.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40041-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 22:36:46 2009
Return-Path: <java-user-return-40041-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30083 invoked from network); 30 Apr 2009 22:36:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 22:36:46 -0000
Received: (qmail 17072 invoked by uid 500); 30 Apr 2009 22:36:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17040 invoked by uid 500); 30 Apr 2009 22:36:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17030 invoked by uid 99); 30 Apr 2009 22:36:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 22:36:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mmasters@gmail.com designates 209.85.132.250 as permitted sender)
Received: from [209.85.132.250] (HELO an-out-0708.google.com) (209.85.132.250)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 22:36:35 +0000
Received: by an-out-0708.google.com with SMTP id b6so1147229ana.5
        for <java-user@lucene.apache.org>; Thu, 30 Apr 2009 15:36:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=wouCiCljhgIdxnVpLx/CQPKmwRF8oTt7bArwP91To5w=;
        b=pUf1YGSy+ZGL/3ATHuYrLErfDLmyiXyCSIapJ9IYroSmcaCModZaSKfwrCsVLEk5wu
         gFHXxBoPIFciBpHglPBOPkW80gh4ab38QhY0J1hjCFUmUeqiStJO8BizDpw2qIxzVN09
         N9a8sQW1+fhjyzJ2sPxW60a4yc1czK7A/sFQY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=naq6ukBMaw0IT8JwvMipNZM/k5JvqELfg56wlWme997lzF3eSUBO/gZyf6FSrbOoI7
         j/vftcAgiE2JoOpxuHuzTDQBldjvxXKZ4fuHKW/cSmzIyvhHJk4Oql9lbWmSj0xWei02
         cuH8fcMgULkeNIKgWTy55LJ8npVd4QuIpkJlI=
MIME-Version: 1.0
Received: by 10.100.142.19 with SMTP id p19mr4303491and.85.1241130973406; Thu, 
	30 Apr 2009 15:36:13 -0700 (PDT)
Date: Thu, 30 Apr 2009 16:36:13 -0600
Message-ID: <5b8626350904301536nc7c620dl5adf778b8ad9f070@mail.gmail.com>
Subject: dbsight
From: Michael Masters <mmasters@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I posted this on java-dev@lucene.apache.org and it was suggested that
I pose this question here:

Hello Everyone,

I just started to use lucene recently. Great project BTW. I was
wondering if anyone has suggested making an open source version of
dbsight (www.dbsight.net/). I've just started using it and I think it
would be awesome if it was open source. Does anyone know of a project
that's like this that is OS?

If not, then how can I propose a project that does a similar thing?

Thanks,
Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40042-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 23:38:24 2009
Return-Path: <java-user-return-40042-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43444 invoked from network); 30 Apr 2009 23:38:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 23:38:24 -0000
Received: (qmail 58689 invoked by uid 500); 30 Apr 2009 23:38:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58622 invoked by uid 500); 30 Apr 2009 23:38:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58612 invoked by uid 99); 30 Apr 2009 23:38:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 23:38:22 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [216.37.94.62] (HELO hiltoncluster2.worldspice.net) (216.37.94.62)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 23:38:11 +0000
Received: (qmail 13880 invoked by uid 0); 30 Apr 2009 23:37:47 -0000
Received: by simscan 1.4.0 ppid: 12999, pid: 13145, t: 16.6135s
         scanners: clamav: 0.94.2/m:49/d:8985 spam: 3.2.5
X-Spam-Checker-Version: SpamAssassin 3.2.5-hilton_748 (2008-06-10) on
	hiltoncluster2.hiltonsmtp.worldspice.net
X-Spam-Level: 
Received: from unknown (HELO ?10.0.1.2?) (mailing-list@lucene.grantingersoll.com@65.88.177.2)
  by hiltonsmtp.worldspice.net with ESMTPA; 30 Apr 2009 23:37:30 -0000
Message-Id: <8247F475-D00A-437F-B5E2-9A7C4355E875@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <23324860.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: kamikaze
Date: Thu, 30 Apr 2009 16:37:26 -0700
References: <9008E1E80EE8A340BACCA3DFF41B21562A4C9A@GLGNYEXBE02.glgroup.com> <8837fb770904241649i6beb28e5i770eca9c50b5d8e5@mail.gmail.com> <9008E1E80EE8A340BACCA3DFF41B21562A4E18@GLGNYEXBE02.glgroup.com> <23288825.post@talk.nabble.com> <9008E1E80EE8A340BACCA3DFF41B21562A4F5E@GLGNYEXBE02.glgroup.com> <23302407.post@talk.nabble.com> <23307098.post@talk.nabble.com> <9008E1E80EE8A340BACCA3DFF41B21562A50EE@GLGNYEXBE02.glgroup.com> <23322582.post@talk.nabble.com> <9008E1E80EE8A340BACCA3DFF41B21562A50FF@GLGNYEXBE02.glgroup.com> <23324860.post@talk.nabble.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=0.4 Bayes=0.1618 required=6.5 autolearn=no version=3.2.5-hilton_748 report=
	*  1.1 HTTP_1 BODY: HTTP_1
	* -0.7 BAYES_20 BODY: Bayesian spam probability is 5 to 20%
	*      [score: 0.1618]

Does Kamikaze have a mailing list?  It seems like, to me anyway, this  
conversation would be more appropriate for that list as it is about  
Kamikaze, not Lucene.

-Grant

On Apr 30, 2009, at 2:42 PM, molz wrote:

>
> Right on.
>
> -1 if not found, index in the sorted set if found.
>
> Anmol
>
>
>
> Michael Mastroianni wrote:
>>
>> Thanks, Anmol. Just so I'm clear on this: findWithIndex(foo)  
>> returns -1
>> if foo is not found, and some positive integer if it is?
>>
>> regards,
>> Michael
>>
>> -----Original Message-----
>> From: molz [mailto:anmol.bhasin@gmail.com]
>> Sent: Thursday, April 30, 2009 3:33 PM
>> To: java-user@lucene.apache.org
>> Subject: RE: kamikaze
>>
>>
>>
>> Hi,
>>
>> That method needs to be deprecated. Please use findWithIndex()  
>> instead.
>> I
>> will deprecate that method in the next release. Also, I will enable  
>> line
>> numbers in it.
>>
>> Anmol
>>
>>
>>
>>
>> Michael Mastroianni wrote:
>>>
>>> Hi-- Using the 1.0.7 jar file, I am having problems with occasional
>>> ArrayIndexOutOfBoundsExceptions and StackOverFlowErrors when  
>>> trying to
>>> do a find in a P4DocIdSet. Here is a unit test that I can reliably  
>>> get
>>> to generate a StackOverFlowError. Have you seen this before? Since  
>>> I'm
>>> using the jar file, I can't really do much debugging of this one.
>>>
>>> regards,
>>> Michael
>>>
>>>
>>>    public void testForOutOfBounds()
>>>    {
>>>        Random rand = new Random(System.currentTimeMillis());
>>>        int maxDoc = 350000;
>>>        ArrayList<Integer> nums = new ArrayList<Integer>();
>>>        HashSet<Integer> seen = new HashSet<Integer>();
>>>        for(int i=0; i < 68; ++i)
>>>        {
>>>            int nextDoc = rand.nextInt(maxDoc);
>>>            if(seen.contains(nextDoc))
>>>            {
>>>                while(seen.contains(nextDoc))
>>>                {
>>>                    nextDoc = rand.nextInt(maxDoc);
>>>                }
>>>            }
>>>            nums.add(nextDoc);
>>>            seen.add(nextDoc);
>>>        }
>>>        Collections.sort(nums);
>>>        DocSet docs = new P4DDocIdSet();
>>>        for (Integer integer : nums)
>>>        {
>>>            docs.addDoc(integer);
>>>        }
>>>        boolean got = docs.find(403);
>>>    }
>>>
>>> -----Original Message-----
>>> From: molz [mailto:anmol.bhasin@gmail.com]
>>> Sent: Wednesday, April 29, 2009 10:58 PM
>>> To: java-user@lucene.apache.org
>>> Subject: RE: kamikaze
>>>
>>>
>>>
>>> Hi Michael,
>>>
>>> 2 Questions.
>>>
>>> 1. What version of Kamikaze are you running with?
>>> 2. Can you try the snippet below and let me know if it fails ? I ran
>> it
>>> 20
>>> times and it did not fail. Maybe there is some difference in the
>>> utitlity
>>> methods you have ? I am still trying to track down if anything is  
>>> off
>> at
>>> my
>>> end but does not seem to be.
>>>
>>>    public void testMultipleIntersections()
>>>    {
>>>            ArrayList<OpenBitSet> obs = new ArrayList<OpenBitSet>();
>>>            ArrayList<DocIdSet> docs = new ArrayList<DocIdSet>();
>>>        Random rand = new Random(System.currentTimeMillis());
>>>            int maxDoc = 350000;
>>>            for(int i=0; i < 3; ++i)
>>>            {
>>>                    int numdocs = rand.nextInt(maxDoc);
>>>                    ArrayList<Integer> nums = new
>>> ArrayList<Integer>();
>>>                    HashSet<Integer> seen = new HashSet<Integer>();
>>>                    for (int j = 0; j < numdocs; j++)
>>>                {
>>>                            int nextDoc = rand.nextInt(maxDoc);
>>>                            if(seen.contains(nextDoc))
>>>                            {
>>>                                    while(seen.contains(nextDoc))
>>>                                    {
>>>                                            nextDoc =
>>> rand.nextInt(maxDoc);
>>>                                    }
>>>                            }
>>>                            nums.add(nextDoc);
>>>                            seen.add(nextDoc);
>>>                }
>>>                    Collections.sort(nums);
>>>                    obs.add(createObs(nums, maxDoc));
>>>                    docs.add(createDocSet(nums));
>>>            }
>>>            OpenBitSet base = obs.get(0);
>>>            for(int i = 1; i < obs.size(); ++i)
>>>            {
>>>                    base.intersect(obs.get(i));
>>>            }
>>>
>>>            AndDocIdSet ands = new AndDocIdSet(docs);
>>>            long card1 = base.cardinality();
>>>            long card2 = ands.size();
>>>            System.out.println(card1+":"+card2);
>>>            assertEquals(card1, card2);
>>>    }
>>>
>>>
>>>    private OpenBitSet createObs(ArrayList<Integer> nums, int maxDoc)
>> {
>>>      OpenBitSet bitSet = new OpenBitSet(maxDoc);
>>>      for(int num:nums)
>>>        bitSet.set(num);
>>>      return bitSet;
>>>    }
>>>
>>>    private DocIdSet createDocSet(ArrayList<Integer> nums) {
>>>      DocSet p4d = DocSetFactory.getDocSetInstance(0, 35000000,
>> 200000,
>>>          DocSetFactory.FOCUS.OPTIMAL);
>>>      for(int num:nums)
>>>       p4d.addDoc(num);
>>>      return p4d;
>>>    }
>>>
>>> I even tried with the following
>>>
>>>  private DocIdSet createDocSet(ArrayList<Integer> nums) {
>>>      P4DDocIdSet p4d = new P4DDocIdSet();
>>>      for(int num:nums)
>>>       p4d.addDoc(num);
>>>      return p4d;
>>>    }
>>>
>>>
>>> The NPE you mention in the previous emails has been identified as a
>> bug
>>> and
>>> will be fixed in the next release (in a day or two).
>>>
>>> Thanks,
>>> Anmol
>>>
>>>
>>> -- 
>>> View this message in context:
>>> http://www.nabble.com/kamikaze-tp23224760p23307098.html
>>> Sent from the Lucene - Java Users mailing list archive at  
>>> Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>> This e-mail message, and any attachments, is intended only for the  
>>> use
>> of
>>> the individual or entity identified in the alias address of this
>> message
>>> and may contain information that is confidential, privileged and
>> subject
>>> to legal restrictions and penalties regarding its unauthorized
>> disclosure
>>> and use. Any unauthorized review, copying, disclosure, use or
>> distribution
>>> is strictly prohibited. If you have received this e-mail message in
>> error,
>>> please notify the sender immediately by reply e-mail and delete this
>>> message, and any attachments, from your system. Thank you.
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> -- 
>> View this message in context:
>> http://www.nabble.com/kamikaze-tp23224760p23322582.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>> This e-mail message, and any attachments, is intended only for the  
>> use of
>> the individual or entity identified in the alias address of this  
>> message
>> and may contain information that is confidential, privileged and  
>> subject
>> to legal restrictions and penalties regarding its unauthorized  
>> disclosure
>> and use. Any unauthorized review, copying, disclosure, use or  
>> distribution
>> is strictly prohibited. If you have received this e-mail message in  
>> error,
>> please notify the sender immediately by reply e-mail and delete this
>> message, and any attachments, from your system. Thank you.
>>
>>
>>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40043-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 23:40:22 2009
Return-Path: <java-user-return-40043-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43620 invoked from network); 30 Apr 2009 23:40:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 23:40:20 -0000
Received: (qmail 60509 invoked by uid 500); 30 Apr 2009 23:40:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60443 invoked by uid 500); 30 Apr 2009 23:40:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60433 invoked by uid 99); 30 Apr 2009 23:40:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 23:40:18 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [216.37.94.62] (HELO hiltoncluster2.worldspice.net) (216.37.94.62)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 23:40:08 +0000
Received: (qmail 17435 invoked by uid 0); 30 Apr 2009 23:39:44 -0000
Received: by simscan 1.4.0 ppid: 17135, pid: 17257, t: 6.9309s
         scanners: clamav: 0.94.2/m:49/d:8985 spam: 3.2.5
X-Spam-Checker-Version: SpamAssassin 3.2.5-hilton_748 (2008-06-10) on
	hiltoncluster2.hiltonsmtp.worldspice.net
X-Spam-Level: 
Received: from unknown (HELO ?10.0.1.2?) (mailing-list@lucene.grantingersoll.com@65.88.177.2)
  by hiltonsmtp.worldspice.net with ESMTPA; 30 Apr 2009 23:39:37 -0000
Message-Id: <F89AE1CD-5D1C-4645-89A2-F71EFDEDF3D2@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <iss.bb8178fe.1b35.49fa0354.87cd6.92@mailout.lrz-muenchen.de>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: How to get the similarity between two string vectors?
Date: Thu, 30 Apr 2009 16:39:33 -0700
References: <iss.bb8178fe.1b35.49fa0354.87cd6.92@mailout.lrz-muenchen.de>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=0.4 Bayes=0.1591 required=6.5 autolearn=no version=3.2.5-hilton_748 report=
	*  1.1 HTTP_1 BODY: HTTP_1
	* -0.7 BAYES_20 BODY: Bayesian spam probability is 5 to 20%
	*      [score: 0.1591]

Yes and no.  You can have a look at More Like This in the contrib  
package.  Additionally, you can just get the TermVectors out of Lucene  
and write your own.  You could use a MemoryIndex which contains one  
document and represent the other document as a query and the "search".

But, no, there isn't a MethodName(Vector1, Vector2) option.

-Grant

On Apr 30, 2009, at 1:00 PM, Kamal Najib wrote:

> Hi,
> I am new to Lucene and I want to get the similarity between two  
> vectors of strings,is there a method, who do that?
> for example if i have the vectors:
> Vector1 :<"term1","term2","term3">
> Vector2:<"term4","term5","term5">
> is there a method to get the similarity between them in lucene,or is  
> there any other way to do it?
> for esample: MethodName(Vector1,Vector2).
> Thanks in advance.
> kamal.
> -- 
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-40044-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Apr 30 23:42:58 2009
Return-Path: <java-user-return-40044-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44227 invoked from network); 30 Apr 2009 23:42:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Apr 2009 23:42:58 -0000
Received: (qmail 64297 invoked by uid 500); 30 Apr 2009 23:42:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64211 invoked by uid 500); 30 Apr 2009 23:42:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64201 invoked by uid 99); 30 Apr 2009 23:42:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 23:42:55 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [216.37.94.58] (HELO hiltonsmtp.worldspice.net) (216.37.94.58)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 30 Apr 2009 23:42:45 +0000
Received: (qmail 30173 invoked by uid 0); 30 Apr 2009 23:42:22 -0000
Received: by simscan 1.4.0 ppid: 29952, pid: 30050, t: 2.5095s
         scanners: clamav: 0.94.1/m:50/d:9101 spam: 3.2.5
X-Spam-Checker-Version: SpamAssassin 3.2.5-hilton_748 (2008-06-10) on
	hiltoncluster1.hiltonsmtp.worldspice.net
X-Spam-Level: 
Received: from unknown (HELO ?10.0.1.2?) (mailing-list@lucene.grantingersoll.com@65.88.177.2)
  by hiltonsmtp.worldspice.net with ESMTPA; 30 Apr 2009 23:42:19 -0000
Message-Id: <A64BB737-5F40-4D48-9D75-C4345F5AA496@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <5b8626350904301536nc7c620dl5adf778b8ad9f070@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v930.3)
Subject: Re: dbsight
Date: Thu, 30 Apr 2009 16:42:14 -0700
References: <5b8626350904301536nc7c620dl5adf778b8ad9f070@mail.gmail.com>
X-Mailer: Apple Mail (2.930.3)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-0.0 Bayes=0.0163 required=6.5 autolearn=no version=3.2.5-hilton_748 report=
	*  1.1 HTTP_1 BODY: HTTP_1
	* -1.1 BAYES_05 BODY: Bayesian spam probability is 1 to 5%
	*      [score: 0.0163]

Solr (http://lucene.apache.org/solr) can import from a DB, if that is  
what you are after.  I haven't done a full feature comparison between  
DB Sight and Solr, but it appears there is a fair amount of overlap  
based on the front page.

HTH,
Grant

On Apr 30, 2009, at 3:36 PM, Michael Masters wrote:

> I posted this on java-dev@lucene.apache.org and it was suggested that
> I pose this question here:
>
> Hello Everyone,
>
> I just started to use lucene recently. Great project BTW. I was
> wondering if anyone has suggested making an open source version of
> dbsight (www.dbsight.net/). I've just started using it and I think it
> would be awesome if it was open source. Does anyone know of a project
> that's like this that is OS?
>
> If not, then how can I propose a project that does a similar thing?
>
> Thanks,
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


